Linear part:
exp(exp(g,x_32),y) = exp(exp(g,y),x_32)
Completing equations...
Completed equations:
exp(exp(g,x_32),y) = exp(exp(g,y),x_32)
Convergent part:
Completing equations...
Completed equations:
Process:
{1}let pkA: bitstring = pub(skA) in
{2}out(c, pkA);
{3}let pkB: bitstring = pub(skB) in
{4}out(c, pkB);
{5}let pkC: bitstring = pub(skC) in
{6}out(c, pkC);
(
    {7}!
    {8}in(c, (Cli: host,Disco: host,Sess: host));
    {9}let v_516: bool = (Cli = A) in
    (
        {10}if v_516 then
        (
            {11}let skCli: bitstring = skA in
            {12}let pkCli: bitstring = pub(skCli) in
            {13}let v_517: bool = (Disco = A) in
            (
                {14}if v_517 then
                (
                    {15}let pkDisco: bitstring = pub(skA) in
                    {16}let v_518: bool = (Sess = A) in
                    (
                        {17}if v_518 then
                        (
                            {18}let pkSess: bitstring = pub(skA) in
                            {19}out(c, GetEndpointRequest);
                            {20}in(c, (=GetEndpointResponse,=pkSess,=None,SP: bitstring,UP: bitstring));
                            {21}new Nc: bitstring;
                            {22}let m1: bitstring = (OpenSecureChannelRequest,pkCli,Nc) in
                            {23}out(c, (pkCli,m1));
                            {24}in(c, em2: bitstring);
                            {25}let m2: bitstring = em2 in
                            {26}let (=OpenSecureChannelResponse,Ns: bitstring,ST: bitstring,TTL: bitstring) = m2 in
                            {27}let Kcli: bitstring = h((Nc,Ns)) in
                            {28}out(c, senc(mCli(pkCli,pkSess),Kcli))
                        )
                        else
                            {29}let v_519: bool = (Sess = B) in
                            (
                                {30}if v_519 then
                                (
                                    {31}let pkSess_520: bitstring = pub(skB) in
                                    {32}out(c, GetEndpointRequest);
                                    {33}in(c, (=GetEndpointResponse,=pkSess_520,=None,SP_521: bitstring,UP_522: bitstring));
                                    {34}new Nc_523: bitstring;
                                    {35}let m1_524: bitstring = (OpenSecureChannelRequest,pkCli,Nc_523) in
                                    {36}out(c, (pkCli,m1_524));
                                    {37}in(c, em2_525: bitstring);
                                    {38}let m2_526: bitstring = em2_525 in
                                    {39}let (=OpenSecureChannelResponse,Ns_527: bitstring,ST_528: bitstring,TTL_529: bitstring) = m2_526 in
                                    {40}let Kcli_530: bitstring = h((Nc_523,Ns_527)) in
                                    {41}out(c, senc(mCli(pkCli,pkSess_520),Kcli_530))
                                )
                                else
                                    {42}let v_531: bool = (Sess = C) in
                                    (
                                        {43}if v_531 then
                                        (
                                            {44}let pkSess_532: bitstring = pub(skC) in
                                            {45}out(c, GetEndpointRequest);
                                            {46}in(c, (=GetEndpointResponse,=pkSess_532,=None,SP_533: bitstring,UP_534: bitstring));
                                            {47}new Nc_535: bitstring;
                                            {48}let m1_536: bitstring = (OpenSecureChannelRequest,pkCli,Nc_535) in
                                            {49}out(c, (pkCli,m1_536));
                                            {50}in(c, em2_537: bitstring);
                                            {51}let m2_538: bitstring = em2_537 in
                                            {52}let (=OpenSecureChannelResponse,Ns_539: bitstring,ST_540: bitstring,TTL_541: bitstring) = m2_538 in
                                            {53}let Kcli_542: bitstring = h((Nc_535,Ns_539)) in
                                            {54}out(c, senc(mCli(pkCli,pkSess_532),Kcli_542))
                                        )
                                        else
                                            {55}let pkSess_543: bitstring = pub(sk(Sess)) in
                                            {56}out(c, GetEndpointRequest);
                                            {57}in(c, (=GetEndpointResponse,=pkSess_543,=None,SP_544: bitstring,UP_545: bitstring));
                                            {58}new Nc_546: bitstring;
                                            {59}let m1_547: bitstring = (OpenSecureChannelRequest,pkCli,Nc_546) in
                                            {60}out(c, (pkCli,m1_547));
                                            {61}in(c, em2_548: bitstring);
                                            {62}let m2_549: bitstring = em2_548 in
                                            {63}let (=OpenSecureChannelResponse,Ns_550: bitstring,ST_551: bitstring,TTL_552: bitstring) = m2_549 in
                                            {64}let Kcli_553: bitstring = h((Nc_546,Ns_550)) in
                                            {65}out(c, senc(mCli(pkCli,pkSess_543),Kcli_553))
                                    )
                                    else
                                        {66}let pkSess_554: bitstring = fail-any in
                                        {67}out(c, GetEndpointRequest);
                                        {68}in(c, (=GetEndpointResponse,=pkSess_554,=None,SP_555: bitstring,UP_556: bitstring));
                                        {69}new Nc_557: bitstring;
                                        {70}let m1_558: bitstring = (OpenSecureChannelRequest,pkCli,Nc_557) in
                                        {71}out(c, (pkCli,m1_558));
                                        {72}in(c, em2_559: bitstring);
                                        {73}let m2_560: bitstring = em2_559 in
                                        {74}let (=OpenSecureChannelResponse,Ns_561: bitstring,ST_562: bitstring,TTL_563: bitstring) = m2_560 in
                                        {75}let Kcli_564: bitstring = h((Nc_557,Ns_561)) in
                                        {76}out(c, senc(mCli(pkCli,pkSess_554),Kcli_564))
                            )
                            else
                                {77}let pkSess_565: bitstring = fail-any in
                                {78}out(c, GetEndpointRequest);
                                {79}in(c, (=GetEndpointResponse,=pkSess_565,=None,SP_566: bitstring,UP_567: bitstring));
                                {80}new Nc_568: bitstring;
                                {81}let m1_569: bitstring = (OpenSecureChannelRequest,pkCli,Nc_568) in
                                {82}out(c, (pkCli,m1_569));
                                {83}in(c, em2_570: bitstring);
                                {84}let m2_571: bitstring = em2_570 in
                                {85}let (=OpenSecureChannelResponse,Ns_572: bitstring,ST_573: bitstring,TTL_574: bitstring) = m2_571 in
                                {86}let Kcli_575: bitstring = h((Nc_568,Ns_572)) in
                                {87}out(c, senc(mCli(pkCli,pkSess_565),Kcli_575))
                    )
                    else
                        {88}let pkSess_576: bitstring = fail-any in
                        {89}out(c, GetEndpointRequest);
                        {90}in(c, (=GetEndpointResponse,=pkSess_576,=None,SP_577: bitstring,UP_578: bitstring));
                        {91}new Nc_579: bitstring;
                        {92}let m1_580: bitstring = (OpenSecureChannelRequest,pkCli,Nc_579) in
                        {93}out(c, (pkCli,m1_580));
                        {94}in(c, em2_581: bitstring);
                        {95}let m2_582: bitstring = em2_581 in
                        {96}let (=OpenSecureChannelResponse,Ns_583: bitstring,ST_584: bitstring,TTL_585: bitstring) = m2_582 in
                        {97}let Kcli_586: bitstring = h((Nc_579,Ns_583)) in
                        {98}out(c, senc(mCli(pkCli,pkSess_576),Kcli_586))
                )
                else
                    {99}let v_587: bool = (Disco = B) in
                    (
                        {100}if v_587 then
                        (
                            {101}let pkDisco_588: bitstring = pub(skB) in
                            {102}let v_589: bool = (Sess = A) in
                            (
                                {103}if v_589 then
                                (
                                    {104}let pkSess_590: bitstring = pub(skA) in
                                    {105}out(c, GetEndpointRequest);
                                    {106}in(c, (=GetEndpointResponse,=pkSess_590,=None,SP_591: bitstring,UP_592: bitstring));
                                    {107}new Nc_593: bitstring;
                                    {108}let m1_594: bitstring = (OpenSecureChannelRequest,pkCli,Nc_593) in
                                    {109}out(c, (pkCli,m1_594));
                                    {110}in(c, em2_595: bitstring);
                                    {111}let m2_596: bitstring = em2_595 in
                                    {112}let (=OpenSecureChannelResponse,Ns_597: bitstring,ST_598: bitstring,TTL_599: bitstring) = m2_596 in
                                    {113}let Kcli_600: bitstring = h((Nc_593,Ns_597)) in
                                    {114}out(c, senc(mCli(pkCli,pkSess_590),Kcli_600))
                                )
                                else
                                    {115}let v_601: bool = (Sess = B) in
                                    (
                                        {116}if v_601 then
                                        (
                                            {117}let pkSess_602: bitstring = pub(skB) in
                                            {118}out(c, GetEndpointRequest);
                                            {119}in(c, (=GetEndpointResponse,=pkSess_602,=None,SP_603: bitstring,UP_604: bitstring));
                                            {120}new Nc_605: bitstring;
                                            {121}let m1_606: bitstring = (OpenSecureChannelRequest,pkCli,Nc_605) in
                                            {122}out(c, (pkCli,m1_606));
                                            {123}in(c, em2_607: bitstring);
                                            {124}let m2_608: bitstring = em2_607 in
                                            {125}let (=OpenSecureChannelResponse,Ns_609: bitstring,ST_610: bitstring,TTL_611: bitstring) = m2_608 in
                                            {126}let Kcli_612: bitstring = h((Nc_605,Ns_609)) in
                                            {127}out(c, senc(mCli(pkCli,pkSess_602),Kcli_612))
                                        )
                                        else
                                            {128}let v_613: bool = (Sess = C) in
                                            (
                                                {129}if v_613 then
                                                (
                                                    {130}let pkSess_614: bitstring = pub(skC) in
                                                    {131}out(c, GetEndpointRequest);
                                                    {132}in(c, (=GetEndpointResponse,=pkSess_614,=None,SP_615: bitstring,UP_616: bitstring));
                                                    {133}new Nc_617: bitstring;
                                                    {134}let m1_618: bitstring = (OpenSecureChannelRequest,pkCli,Nc_617) in
                                                    {135}out(c, (pkCli,m1_618));
                                                    {136}in(c, em2_619: bitstring);
                                                    {137}let m2_620: bitstring = em2_619 in
                                                    {138}let (=OpenSecureChannelResponse,Ns_621: bitstring,ST_622: bitstring,TTL_623: bitstring) = m2_620 in
                                                    {139}let Kcli_624: bitstring = h((Nc_617,Ns_621)) in
                                                    {140}out(c, senc(mCli(pkCli,pkSess_614),Kcli_624))
                                                )
                                                else
                                                    {141}let pkSess_625: bitstring = pub(sk(Sess)) in
                                                    {142}out(c, GetEndpointRequest);
                                                    {143}in(c, (=GetEndpointResponse,=pkSess_625,=None,SP_626: bitstring,UP_627: bitstring));
                                                    {144}new Nc_628: bitstring;
                                                    {145}let m1_629: bitstring = (OpenSecureChannelRequest,pkCli,Nc_628) in
                                                    {146}out(c, (pkCli,m1_629));
                                                    {147}in(c, em2_630: bitstring);
                                                    {148}let m2_631: bitstring = em2_630 in
                                                    {149}let (=OpenSecureChannelResponse,Ns_632: bitstring,ST_633: bitstring,TTL_634: bitstring) = m2_631 in
                                                    {150}let Kcli_635: bitstring = h((Nc_628,Ns_632)) in
                                                    {151}out(c, senc(mCli(pkCli,pkSess_625),Kcli_635))
                                            )
                                            else
                                                {152}let pkSess_636: bitstring = fail-any in
                                                {153}out(c, GetEndpointRequest);
                                                {154}in(c, (=GetEndpointResponse,=pkSess_636,=None,SP_637: bitstring,UP_638: bitstring));
                                                {155}new Nc_639: bitstring;
                                                {156}let m1_640: bitstring = (OpenSecureChannelRequest,pkCli,Nc_639) in
                                                {157}out(c, (pkCli,m1_640));
                                                {158}in(c, em2_641: bitstring);
                                                {159}let m2_642: bitstring = em2_641 in
                                                {160}let (=OpenSecureChannelResponse,Ns_643: bitstring,ST_644: bitstring,TTL_645: bitstring) = m2_642 in
                                                {161}let Kcli_646: bitstring = h((Nc_639,Ns_643)) in
                                                {162}out(c, senc(mCli(pkCli,pkSess_636),Kcli_646))
                                    )
                                    else
                                        {163}let pkSess_647: bitstring = fail-any in
                                        {164}out(c, GetEndpointRequest);
                                        {165}in(c, (=GetEndpointResponse,=pkSess_647,=None,SP_648: bitstring,UP_649: bitstring));
                                        {166}new Nc_650: bitstring;
                                        {167}let m1_651: bitstring = (OpenSecureChannelRequest,pkCli,Nc_650) in
                                        {168}out(c, (pkCli,m1_651));
                                        {169}in(c, em2_652: bitstring);
                                        {170}let m2_653: bitstring = em2_652 in
                                        {171}let (=OpenSecureChannelResponse,Ns_654: bitstring,ST_655: bitstring,TTL_656: bitstring) = m2_653 in
                                        {172}let Kcli_657: bitstring = h((Nc_650,Ns_654)) in
                                        {173}out(c, senc(mCli(pkCli,pkSess_647),Kcli_657))
                            )
                            else
                                {174}let pkSess_658: bitstring = fail-any in
                                {175}out(c, GetEndpointRequest);
                                {176}in(c, (=GetEndpointResponse,=pkSess_658,=None,SP_659: bitstring,UP_660: bitstring));
                                {177}new Nc_661: bitstring;
                                {178}let m1_662: bitstring = (OpenSecureChannelRequest,pkCli,Nc_661) in
                                {179}out(c, (pkCli,m1_662));
                                {180}in(c, em2_663: bitstring);
                                {181}let m2_664: bitstring = em2_663 in
                                {182}let (=OpenSecureChannelResponse,Ns_665: bitstring,ST_666: bitstring,TTL_667: bitstring) = m2_664 in
                                {183}let Kcli_668: bitstring = h((Nc_661,Ns_665)) in
                                {184}out(c, senc(mCli(pkCli,pkSess_658),Kcli_668))
                        )
                        else
                            {185}let v_669: bool = (Disco = C) in
                            (
                                {186}if v_669 then
                                (
                                    {187}let pkDisco_670: bitstring = pub(skC) in
                                    {188}let v_671: bool = (Sess = A) in
                                    (
                                        {189}if v_671 then
                                        (
                                            {190}let pkSess_672: bitstring = pub(skA) in
                                            {191}out(c, GetEndpointRequest);
                                            {192}in(c, (=GetEndpointResponse,=pkSess_672,=None,SP_673: bitstring,UP_674: bitstring));
                                            {193}new Nc_675: bitstring;
                                            {194}let m1_676: bitstring = (OpenSecureChannelRequest,pkCli,Nc_675) in
                                            {195}out(c, (pkCli,m1_676));
                                            {196}in(c, em2_677: bitstring);
                                            {197}let m2_678: bitstring = em2_677 in
                                            {198}let (=OpenSecureChannelResponse,Ns_679: bitstring,ST_680: bitstring,TTL_681: bitstring) = m2_678 in
                                            {199}let Kcli_682: bitstring = h((Nc_675,Ns_679)) in
                                            {200}out(c, senc(mCli(pkCli,pkSess_672),Kcli_682))
                                        )
                                        else
                                            {201}let v_683: bool = (Sess = B) in
                                            (
                                                {202}if v_683 then
                                                (
                                                    {203}let pkSess_684: bitstring = pub(skB) in
                                                    {204}out(c, GetEndpointRequest);
                                                    {205}in(c, (=GetEndpointResponse,=pkSess_684,=None,SP_685: bitstring,UP_686: bitstring));
                                                    {206}new Nc_687: bitstring;
                                                    {207}let m1_688: bitstring = (OpenSecureChannelRequest,pkCli,Nc_687) in
                                                    {208}out(c, (pkCli,m1_688));
                                                    {209}in(c, em2_689: bitstring);
                                                    {210}let m2_690: bitstring = em2_689 in
                                                    {211}let (=OpenSecureChannelResponse,Ns_691: bitstring,ST_692: bitstring,TTL_693: bitstring) = m2_690 in
                                                    {212}let Kcli_694: bitstring = h((Nc_687,Ns_691)) in
                                                    {213}out(c, senc(mCli(pkCli,pkSess_684),Kcli_694))
                                                )
                                                else
                                                    {214}let v_695: bool = (Sess = C) in
                                                    (
                                                        {215}if v_695 then
                                                        (
                                                            {216}let pkSess_696: bitstring = pub(skC) in
                                                            {217}out(c, GetEndpointRequest);
                                                            {218}in(c, (=GetEndpointResponse,=pkSess_696,=None,SP_697: bitstring,UP_698: bitstring));
                                                            {219}new Nc_699: bitstring;
                                                            {220}let m1_700: bitstring = (OpenSecureChannelRequest,pkCli,Nc_699) in
                                                            {221}out(c, (pkCli,m1_700));
                                                            {222}in(c, em2_701: bitstring);
                                                            {223}let m2_702: bitstring = em2_701 in
                                                            {224}let (=OpenSecureChannelResponse,Ns_703: bitstring,ST_704: bitstring,TTL_705: bitstring) = m2_702 in
                                                            {225}let Kcli_706: bitstring = h((Nc_699,Ns_703)) in
                                                            {226}out(c, senc(mCli(pkCli,pkSess_696),Kcli_706))
                                                        )
                                                        else
                                                            {227}let pkSess_707: bitstring = pub(sk(Sess)) in
                                                            {228}out(c, GetEndpointRequest);
                                                            {229}in(c, (=GetEndpointResponse,=pkSess_707,=None,SP_708: bitstring,UP_709: bitstring));
                                                            {230}new Nc_710: bitstring;
                                                            {231}let m1_711: bitstring = (OpenSecureChannelRequest,pkCli,Nc_710) in
                                                            {232}out(c, (pkCli,m1_711));
                                                            {233}in(c, em2_712: bitstring);
                                                            {234}let m2_713: bitstring = em2_712 in
                                                            {235}let (=OpenSecureChannelResponse,Ns_714: bitstring,ST_715: bitstring,TTL_716: bitstring) = m2_713 in
                                                            {236}let Kcli_717: bitstring = h((Nc_710,Ns_714)) in
                                                            {237}out(c, senc(mCli(pkCli,pkSess_707),Kcli_717))
                                                    )
                                                    else
                                                        {238}let pkSess_718: bitstring = fail-any in
                                                        {239}out(c, GetEndpointRequest);
                                                        {240}in(c, (=GetEndpointResponse,=pkSess_718,=None,SP_719: bitstring,UP_720: bitstring));
                                                        {241}new Nc_721: bitstring;
                                                        {242}let m1_722: bitstring = (OpenSecureChannelRequest,pkCli,Nc_721) in
                                                        {243}out(c, (pkCli,m1_722));
                                                        {244}in(c, em2_723: bitstring);
                                                        {245}let m2_724: bitstring = em2_723 in
                                                        {246}let (=OpenSecureChannelResponse,Ns_725: bitstring,ST_726: bitstring,TTL_727: bitstring) = m2_724 in
                                                        {247}let Kcli_728: bitstring = h((Nc_721,Ns_725)) in
                                                        {248}out(c, senc(mCli(pkCli,pkSess_718),Kcli_728))
                                            )
                                            else
                                                {249}let pkSess_729: bitstring = fail-any in
                                                {250}out(c, GetEndpointRequest);
                                                {251}in(c, (=GetEndpointResponse,=pkSess_729,=None,SP_730: bitstring,UP_731: bitstring));
                                                {252}new Nc_732: bitstring;
                                                {253}let m1_733: bitstring = (OpenSecureChannelRequest,pkCli,Nc_732) in
                                                {254}out(c, (pkCli,m1_733));
                                                {255}in(c, em2_734: bitstring);
                                                {256}let m2_735: bitstring = em2_734 in
                                                {257}let (=OpenSecureChannelResponse,Ns_736: bitstring,ST_737: bitstring,TTL_738: bitstring) = m2_735 in
                                                {258}let Kcli_739: bitstring = h((Nc_732,Ns_736)) in
                                                {259}out(c, senc(mCli(pkCli,pkSess_729),Kcli_739))
                                    )
                                    else
                                        {260}let pkSess_740: bitstring = fail-any in
                                        {261}out(c, GetEndpointRequest);
                                        {262}in(c, (=GetEndpointResponse,=pkSess_740,=None,SP_741: bitstring,UP_742: bitstring));
                                        {263}new Nc_743: bitstring;
                                        {264}let m1_744: bitstring = (OpenSecureChannelRequest,pkCli,Nc_743) in
                                        {265}out(c, (pkCli,m1_744));
                                        {266}in(c, em2_745: bitstring);
                                        {267}let m2_746: bitstring = em2_745 in
                                        {268}let (=OpenSecureChannelResponse,Ns_747: bitstring,ST_748: bitstring,TTL_749: bitstring) = m2_746 in
                                        {269}let Kcli_750: bitstring = h((Nc_743,Ns_747)) in
                                        {270}out(c, senc(mCli(pkCli,pkSess_740),Kcli_750))
                                )
                                else
                                    {271}let pkDisco_751: bitstring = pub(sk(Disco)) in
                                    {272}let v_752: bool = (Sess = A) in
                                    (
                                        {273}if v_752 then
                                        (
                                            {274}let pkSess_753: bitstring = pub(skA) in
                                            {275}out(c, GetEndpointRequest);
                                            {276}in(c, (=GetEndpointResponse,=pkSess_753,=None,SP_754: bitstring,UP_755: bitstring));
                                            {277}new Nc_756: bitstring;
                                            {278}let m1_757: bitstring = (OpenSecureChannelRequest,pkCli,Nc_756) in
                                            {279}out(c, (pkCli,m1_757));
                                            {280}in(c, em2_758: bitstring);
                                            {281}let m2_759: bitstring = em2_758 in
                                            {282}let (=OpenSecureChannelResponse,Ns_760: bitstring,ST_761: bitstring,TTL_762: bitstring) = m2_759 in
                                            {283}let Kcli_763: bitstring = h((Nc_756,Ns_760)) in
                                            {284}out(c, senc(mCli(pkCli,pkSess_753),Kcli_763))
                                        )
                                        else
                                            {285}let v_764: bool = (Sess = B) in
                                            (
                                                {286}if v_764 then
                                                (
                                                    {287}let pkSess_765: bitstring = pub(skB) in
                                                    {288}out(c, GetEndpointRequest);
                                                    {289}in(c, (=GetEndpointResponse,=pkSess_765,=None,SP_766: bitstring,UP_767: bitstring));
                                                    {290}new Nc_768: bitstring;
                                                    {291}let m1_769: bitstring = (OpenSecureChannelRequest,pkCli,Nc_768) in
                                                    {292}out(c, (pkCli,m1_769));
                                                    {293}in(c, em2_770: bitstring);
                                                    {294}let m2_771: bitstring = em2_770 in
                                                    {295}let (=OpenSecureChannelResponse,Ns_772: bitstring,ST_773: bitstring,TTL_774: bitstring) = m2_771 in
                                                    {296}let Kcli_775: bitstring = h((Nc_768,Ns_772)) in
                                                    {297}out(c, senc(mCli(pkCli,pkSess_765),Kcli_775))
                                                )
                                                else
                                                    {298}let v_776: bool = (Sess = C) in
                                                    (
                                                        {299}if v_776 then
                                                        (
                                                            {300}let pkSess_777: bitstring = pub(skC) in
                                                            {301}out(c, GetEndpointRequest);
                                                            {302}in(c, (=GetEndpointResponse,=pkSess_777,=None,SP_778: bitstring,UP_779: bitstring));
                                                            {303}new Nc_780: bitstring;
                                                            {304}let m1_781: bitstring = (OpenSecureChannelRequest,pkCli,Nc_780) in
                                                            {305}out(c, (pkCli,m1_781));
                                                            {306}in(c, em2_782: bitstring);
                                                            {307}let m2_783: bitstring = em2_782 in
                                                            {308}let (=OpenSecureChannelResponse,Ns_784: bitstring,ST_785: bitstring,TTL_786: bitstring) = m2_783 in
                                                            {309}let Kcli_787: bitstring = h((Nc_780,Ns_784)) in
                                                            {310}out(c, senc(mCli(pkCli,pkSess_777),Kcli_787))
                                                        )
                                                        else
                                                            {311}let pkSess_788: bitstring = pub(sk(Sess)) in
                                                            {312}out(c, GetEndpointRequest);
                                                            {313}in(c, (=GetEndpointResponse,=pkSess_788,=None,SP_789: bitstring,UP_790: bitstring));
                                                            {314}new Nc_791: bitstring;
                                                            {315}let m1_792: bitstring = (OpenSecureChannelRequest,pkCli,Nc_791) in
                                                            {316}out(c, (pkCli,m1_792));
                                                            {317}in(c, em2_793: bitstring);
                                                            {318}let m2_794: bitstring = em2_793 in
                                                            {319}let (=OpenSecureChannelResponse,Ns_795: bitstring,ST_796: bitstring,TTL_797: bitstring) = m2_794 in
                                                            {320}let Kcli_798: bitstring = h((Nc_791,Ns_795)) in
                                                            {321}out(c, senc(mCli(pkCli,pkSess_788),Kcli_798))
                                                    )
                                                    else
                                                        {322}let pkSess_799: bitstring = fail-any in
                                                        {323}out(c, GetEndpointRequest);
                                                        {324}in(c, (=GetEndpointResponse,=pkSess_799,=None,SP_800: bitstring,UP_801: bitstring));
                                                        {325}new Nc_802: bitstring;
                                                        {326}let m1_803: bitstring = (OpenSecureChannelRequest,pkCli,Nc_802) in
                                                        {327}out(c, (pkCli,m1_803));
                                                        {328}in(c, em2_804: bitstring);
                                                        {329}let m2_805: bitstring = em2_804 in
                                                        {330}let (=OpenSecureChannelResponse,Ns_806: bitstring,ST_807: bitstring,TTL_808: bitstring) = m2_805 in
                                                        {331}let Kcli_809: bitstring = h((Nc_802,Ns_806)) in
                                                        {332}out(c, senc(mCli(pkCli,pkSess_799),Kcli_809))
                                            )
                                            else
                                                {333}let pkSess_810: bitstring = fail-any in
                                                {334}out(c, GetEndpointRequest);
                                                {335}in(c, (=GetEndpointResponse,=pkSess_810,=None,SP_811: bitstring,UP_812: bitstring));
                                                {336}new Nc_813: bitstring;
                                                {337}let m1_814: bitstring = (OpenSecureChannelRequest,pkCli,Nc_813) in
                                                {338}out(c, (pkCli,m1_814));
                                                {339}in(c, em2_815: bitstring);
                                                {340}let m2_816: bitstring = em2_815 in
                                                {341}let (=OpenSecureChannelResponse,Ns_817: bitstring,ST_818: bitstring,TTL_819: bitstring) = m2_816 in
                                                {342}let Kcli_820: bitstring = h((Nc_813,Ns_817)) in
                                                {343}out(c, senc(mCli(pkCli,pkSess_810),Kcli_820))
                                    )
                                    else
                                        {344}let pkSess_821: bitstring = fail-any in
                                        {345}out(c, GetEndpointRequest);
                                        {346}in(c, (=GetEndpointResponse,=pkSess_821,=None,SP_822: bitstring,UP_823: bitstring));
                                        {347}new Nc_824: bitstring;
                                        {348}let m1_825: bitstring = (OpenSecureChannelRequest,pkCli,Nc_824) in
                                        {349}out(c, (pkCli,m1_825));
                                        {350}in(c, em2_826: bitstring);
                                        {351}let m2_827: bitstring = em2_826 in
                                        {352}let (=OpenSecureChannelResponse,Ns_828: bitstring,ST_829: bitstring,TTL_830: bitstring) = m2_827 in
                                        {353}let Kcli_831: bitstring = h((Nc_824,Ns_828)) in
                                        {354}out(c, senc(mCli(pkCli,pkSess_821),Kcli_831))
                            )
                            else
                                {355}let pkDisco_832: bitstring = fail-any in
                                {356}let v_833: bool = (Sess = A) in
                                (
                                    {357}if v_833 then
                                    (
                                        {358}let pkSess_834: bitstring = pub(skA) in
                                        {359}out(c, GetEndpointRequest);
                                        {360}in(c, (=GetEndpointResponse,=pkSess_834,=None,SP_835: bitstring,UP_836: bitstring));
                                        {361}new Nc_837: bitstring;
                                        {362}let m1_838: bitstring = (OpenSecureChannelRequest,pkCli,Nc_837) in
                                        {363}out(c, (pkCli,m1_838));
                                        {364}in(c, em2_839: bitstring);
                                        {365}let m2_840: bitstring = em2_839 in
                                        {366}let (=OpenSecureChannelResponse,Ns_841: bitstring,ST_842: bitstring,TTL_843: bitstring) = m2_840 in
                                        {367}let Kcli_844: bitstring = h((Nc_837,Ns_841)) in
                                        {368}out(c, senc(mCli(pkCli,pkSess_834),Kcli_844))
                                    )
                                    else
                                        {369}let v_845: bool = (Sess = B) in
                                        (
                                            {370}if v_845 then
                                            (
                                                {371}let pkSess_846: bitstring = pub(skB) in
                                                {372}out(c, GetEndpointRequest);
                                                {373}in(c, (=GetEndpointResponse,=pkSess_846,=None,SP_847: bitstring,UP_848: bitstring));
                                                {374}new Nc_849: bitstring;
                                                {375}let m1_850: bitstring = (OpenSecureChannelRequest,pkCli,Nc_849) in
                                                {376}out(c, (pkCli,m1_850));
                                                {377}in(c, em2_851: bitstring);
                                                {378}let m2_852: bitstring = em2_851 in
                                                {379}let (=OpenSecureChannelResponse,Ns_853: bitstring,ST_854: bitstring,TTL_855: bitstring) = m2_852 in
                                                {380}let Kcli_856: bitstring = h((Nc_849,Ns_853)) in
                                                {381}out(c, senc(mCli(pkCli,pkSess_846),Kcli_856))
                                            )
                                            else
                                                {382}let v_857: bool = (Sess = C) in
                                                (
                                                    {383}if v_857 then
                                                    (
                                                        {384}let pkSess_858: bitstring = pub(skC) in
                                                        {385}out(c, GetEndpointRequest);
                                                        {386}in(c, (=GetEndpointResponse,=pkSess_858,=None,SP_859: bitstring,UP_860: bitstring));
                                                        {387}new Nc_861: bitstring;
                                                        {388}let m1_862: bitstring = (OpenSecureChannelRequest,pkCli,Nc_861) in
                                                        {389}out(c, (pkCli,m1_862));
                                                        {390}in(c, em2_863: bitstring);
                                                        {391}let m2_864: bitstring = em2_863 in
                                                        {392}let (=OpenSecureChannelResponse,Ns_865: bitstring,ST_866: bitstring,TTL_867: bitstring) = m2_864 in
                                                        {393}let Kcli_868: bitstring = h((Nc_861,Ns_865)) in
                                                        {394}out(c, senc(mCli(pkCli,pkSess_858),Kcli_868))
                                                    )
                                                    else
                                                        {395}let pkSess_869: bitstring = pub(sk(Sess)) in
                                                        {396}out(c, GetEndpointRequest);
                                                        {397}in(c, (=GetEndpointResponse,=pkSess_869,=None,SP_870: bitstring,UP_871: bitstring));
                                                        {398}new Nc_872: bitstring;
                                                        {399}let m1_873: bitstring = (OpenSecureChannelRequest,pkCli,Nc_872) in
                                                        {400}out(c, (pkCli,m1_873));
                                                        {401}in(c, em2_874: bitstring);
                                                        {402}let m2_875: bitstring = em2_874 in
                                                        {403}let (=OpenSecureChannelResponse,Ns_876: bitstring,ST_877: bitstring,TTL_878: bitstring) = m2_875 in
                                                        {404}let Kcli_879: bitstring = h((Nc_872,Ns_876)) in
                                                        {405}out(c, senc(mCli(pkCli,pkSess_869),Kcli_879))
                                                )
                                                else
                                                    {406}let pkSess_880: bitstring = fail-any in
                                                    {407}out(c, GetEndpointRequest);
                                                    {408}in(c, (=GetEndpointResponse,=pkSess_880,=None,SP_881: bitstring,UP_882: bitstring));
                                                    {409}new Nc_883: bitstring;
                                                    {410}let m1_884: bitstring = (OpenSecureChannelRequest,pkCli,Nc_883) in
                                                    {411}out(c, (pkCli,m1_884));
                                                    {412}in(c, em2_885: bitstring);
                                                    {413}let m2_886: bitstring = em2_885 in
                                                    {414}let (=OpenSecureChannelResponse,Ns_887: bitstring,ST_888: bitstring,TTL_889: bitstring) = m2_886 in
                                                    {415}let Kcli_890: bitstring = h((Nc_883,Ns_887)) in
                                                    {416}out(c, senc(mCli(pkCli,pkSess_880),Kcli_890))
                                        )
                                        else
                                            {417}let pkSess_891: bitstring = fail-any in
                                            {418}out(c, GetEndpointRequest);
                                            {419}in(c, (=GetEndpointResponse,=pkSess_891,=None,SP_892: bitstring,UP_893: bitstring));
                                            {420}new Nc_894: bitstring;
                                            {421}let m1_895: bitstring = (OpenSecureChannelRequest,pkCli,Nc_894) in
                                            {422}out(c, (pkCli,m1_895));
                                            {423}in(c, em2_896: bitstring);
                                            {424}let m2_897: bitstring = em2_896 in
                                            {425}let (=OpenSecureChannelResponse,Ns_898: bitstring,ST_899: bitstring,TTL_900: bitstring) = m2_897 in
                                            {426}let Kcli_901: bitstring = h((Nc_894,Ns_898)) in
                                            {427}out(c, senc(mCli(pkCli,pkSess_891),Kcli_901))
                                )
                                else
                                    {428}let pkSess_902: bitstring = fail-any in
                                    {429}out(c, GetEndpointRequest);
                                    {430}in(c, (=GetEndpointResponse,=pkSess_902,=None,SP_903: bitstring,UP_904: bitstring));
                                    {431}new Nc_905: bitstring;
                                    {432}let m1_906: bitstring = (OpenSecureChannelRequest,pkCli,Nc_905) in
                                    {433}out(c, (pkCli,m1_906));
                                    {434}in(c, em2_907: bitstring);
                                    {435}let m2_908: bitstring = em2_907 in
                                    {436}let (=OpenSecureChannelResponse,Ns_909: bitstring,ST_910: bitstring,TTL_911: bitstring) = m2_908 in
                                    {437}let Kcli_912: bitstring = h((Nc_905,Ns_909)) in
                                    {438}out(c, senc(mCli(pkCli,pkSess_902),Kcli_912))
                    )
                    else
                        {439}let pkDisco_913: bitstring = fail-any in
                        {440}let v_914: bool = (Sess = A) in
                        (
                            {441}if v_914 then
                            (
                                {442}let pkSess_915: bitstring = pub(skA) in
                                {443}out(c, GetEndpointRequest);
                                {444}in(c, (=GetEndpointResponse,=pkSess_915,=None,SP_916: bitstring,UP_917: bitstring));
                                {445}new Nc_918: bitstring;
                                {446}let m1_919: bitstring = (OpenSecureChannelRequest,pkCli,Nc_918) in
                                {447}out(c, (pkCli,m1_919));
                                {448}in(c, em2_920: bitstring);
                                {449}let m2_921: bitstring = em2_920 in
                                {450}let (=OpenSecureChannelResponse,Ns_922: bitstring,ST_923: bitstring,TTL_924: bitstring) = m2_921 in
                                {451}let Kcli_925: bitstring = h((Nc_918,Ns_922)) in
                                {452}out(c, senc(mCli(pkCli,pkSess_915),Kcli_925))
                            )
                            else
                                {453}let v_926: bool = (Sess = B) in
                                (
                                    {454}if v_926 then
                                    (
                                        {455}let pkSess_927: bitstring = pub(skB) in
                                        {456}out(c, GetEndpointRequest);
                                        {457}in(c, (=GetEndpointResponse,=pkSess_927,=None,SP_928: bitstring,UP_929: bitstring));
                                        {458}new Nc_930: bitstring;
                                        {459}let m1_931: bitstring = (OpenSecureChannelRequest,pkCli,Nc_930) in
                                        {460}out(c, (pkCli,m1_931));
                                        {461}in(c, em2_932: bitstring);
                                        {462}let m2_933: bitstring = em2_932 in
                                        {463}let (=OpenSecureChannelResponse,Ns_934: bitstring,ST_935: bitstring,TTL_936: bitstring) = m2_933 in
                                        {464}let Kcli_937: bitstring = h((Nc_930,Ns_934)) in
                                        {465}out(c, senc(mCli(pkCli,pkSess_927),Kcli_937))
                                    )
                                    else
                                        {466}let v_938: bool = (Sess = C) in
                                        (
                                            {467}if v_938 then
                                            (
                                                {468}let pkSess_939: bitstring = pub(skC) in
                                                {469}out(c, GetEndpointRequest);
                                                {470}in(c, (=GetEndpointResponse,=pkSess_939,=None,SP_940: bitstring,UP_941: bitstring));
                                                {471}new Nc_942: bitstring;
                                                {472}let m1_943: bitstring = (OpenSecureChannelRequest,pkCli,Nc_942) in
                                                {473}out(c, (pkCli,m1_943));
                                                {474}in(c, em2_944: bitstring);
                                                {475}let m2_945: bitstring = em2_944 in
                                                {476}let (=OpenSecureChannelResponse,Ns_946: bitstring,ST_947: bitstring,TTL_948: bitstring) = m2_945 in
                                                {477}let Kcli_949: bitstring = h((Nc_942,Ns_946)) in
                                                {478}out(c, senc(mCli(pkCli,pkSess_939),Kcli_949))
                                            )
                                            else
                                                {479}let pkSess_950: bitstring = pub(sk(Sess)) in
                                                {480}out(c, GetEndpointRequest);
                                                {481}in(c, (=GetEndpointResponse,=pkSess_950,=None,SP_951: bitstring,UP_952: bitstring));
                                                {482}new Nc_953: bitstring;
                                                {483}let m1_954: bitstring = (OpenSecureChannelRequest,pkCli,Nc_953) in
                                                {484}out(c, (pkCli,m1_954));
                                                {485}in(c, em2_955: bitstring);
                                                {486}let m2_956: bitstring = em2_955 in
                                                {487}let (=OpenSecureChannelResponse,Ns_957: bitstring,ST_958: bitstring,TTL_959: bitstring) = m2_956 in
                                                {488}let Kcli_960: bitstring = h((Nc_953,Ns_957)) in
                                                {489}out(c, senc(mCli(pkCli,pkSess_950),Kcli_960))
                                        )
                                        else
                                            {490}let pkSess_961: bitstring = fail-any in
                                            {491}out(c, GetEndpointRequest);
                                            {492}in(c, (=GetEndpointResponse,=pkSess_961,=None,SP_962: bitstring,UP_963: bitstring));
                                            {493}new Nc_964: bitstring;
                                            {494}let m1_965: bitstring = (OpenSecureChannelRequest,pkCli,Nc_964) in
                                            {495}out(c, (pkCli,m1_965));
                                            {496}in(c, em2_966: bitstring);
                                            {497}let m2_967: bitstring = em2_966 in
                                            {498}let (=OpenSecureChannelResponse,Ns_968: bitstring,ST_969: bitstring,TTL_970: bitstring) = m2_967 in
                                            {499}let Kcli_971: bitstring = h((Nc_964,Ns_968)) in
                                            {500}out(c, senc(mCli(pkCli,pkSess_961),Kcli_971))
                                )
                                else
                                    {501}let pkSess_972: bitstring = fail-any in
                                    {502}out(c, GetEndpointRequest);
                                    {503}in(c, (=GetEndpointResponse,=pkSess_972,=None,SP_973: bitstring,UP_974: bitstring));
                                    {504}new Nc_975: bitstring;
                                    {505}let m1_976: bitstring = (OpenSecureChannelRequest,pkCli,Nc_975) in
                                    {506}out(c, (pkCli,m1_976));
                                    {507}in(c, em2_977: bitstring);
                                    {508}let m2_978: bitstring = em2_977 in
                                    {509}let (=OpenSecureChannelResponse,Ns_979: bitstring,ST_980: bitstring,TTL_981: bitstring) = m2_978 in
                                    {510}let Kcli_982: bitstring = h((Nc_975,Ns_979)) in
                                    {511}out(c, senc(mCli(pkCli,pkSess_972),Kcli_982))
                        )
                        else
                            {512}let pkSess_983: bitstring = fail-any in
                            {513}out(c, GetEndpointRequest);
                            {514}in(c, (=GetEndpointResponse,=pkSess_983,=None,SP_984: bitstring,UP_985: bitstring));
                            {515}new Nc_986: bitstring;
                            {516}let m1_987: bitstring = (OpenSecureChannelRequest,pkCli,Nc_986) in
                            {517}out(c, (pkCli,m1_987));
                            {518}in(c, em2_988: bitstring);
                            {519}let m2_989: bitstring = em2_988 in
                            {520}let (=OpenSecureChannelResponse,Ns_990: bitstring,ST_991: bitstring,TTL_992: bitstring) = m2_989 in
                            {521}let Kcli_993: bitstring = h((Nc_986,Ns_990)) in
                            {522}out(c, senc(mCli(pkCli,pkSess_983),Kcli_993))
            )
            else
                {523}let pkDisco_994: bitstring = fail-any in
                {524}let v_995: bool = (Sess = A) in
                (
                    {525}if v_995 then
                    (
                        {526}let pkSess_996: bitstring = pub(skA) in
                        {527}out(c, GetEndpointRequest);
                        {528}in(c, (=GetEndpointResponse,=pkSess_996,=None,SP_997: bitstring,UP_998: bitstring));
                        {529}new Nc_999: bitstring;
                        {530}let m1_1000: bitstring = (OpenSecureChannelRequest,pkCli,Nc_999) in
                        {531}out(c, (pkCli,m1_1000));
                        {532}in(c, em2_1001: bitstring);
                        {533}let m2_1002: bitstring = em2_1001 in
                        {534}let (=OpenSecureChannelResponse,Ns_1003: bitstring,ST_1004: bitstring,TTL_1005: bitstring) = m2_1002 in
                        {535}let Kcli_1006: bitstring = h((Nc_999,Ns_1003)) in
                        {536}out(c, senc(mCli(pkCli,pkSess_996),Kcli_1006))
                    )
                    else
                        {537}let v_1007: bool = (Sess = B) in
                        (
                            {538}if v_1007 then
                            (
                                {539}let pkSess_1008: bitstring = pub(skB) in
                                {540}out(c, GetEndpointRequest);
                                {541}in(c, (=GetEndpointResponse,=pkSess_1008,=None,SP_1009: bitstring,UP_1010: bitstring));
                                {542}new Nc_1011: bitstring;
                                {543}let m1_1012: bitstring = (OpenSecureChannelRequest,pkCli,Nc_1011) in
                                {544}out(c, (pkCli,m1_1012));
                                {545}in(c, em2_1013: bitstring);
                                {546}let m2_1014: bitstring = em2_1013 in
                                {547}let (=OpenSecureChannelResponse,Ns_1015: bitstring,ST_1016: bitstring,TTL_1017: bitstring) = m2_1014 in
                                {548}let Kcli_1018: bitstring = h((Nc_1011,Ns_1015)) in
                                {549}out(c, senc(mCli(pkCli,pkSess_1008),Kcli_1018))
                            )
                            else
                                {550}let v_1019: bool = (Sess = C) in
                                (
                                    {551}if v_1019 then
                                    (
                                        {552}let pkSess_1020: bitstring = pub(skC) in
                                        {553}out(c, GetEndpointRequest);
                                        {554}in(c, (=GetEndpointResponse,=pkSess_1020,=None,SP_1021: bitstring,UP_1022: bitstring));
                                        {555}new Nc_1023: bitstring;
                                        {556}let m1_1024: bitstring = (OpenSecureChannelRequest,pkCli,Nc_1023) in
                                        {557}out(c, (pkCli,m1_1024));
                                        {558}in(c, em2_1025: bitstring);
                                        {559}let m2_1026: bitstring = em2_1025 in
                                        {560}let (=OpenSecureChannelResponse,Ns_1027: bitstring,ST_1028: bitstring,TTL_1029: bitstring) = m2_1026 in
                                        {561}let Kcli_1030: bitstring = h((Nc_1023,Ns_1027)) in
                                        {562}out(c, senc(mCli(pkCli,pkSess_1020),Kcli_1030))
                                    )
                                    else
                                        {563}let pkSess_1031: bitstring = pub(sk(Sess)) in
                                        {564}out(c, GetEndpointRequest);
                                        {565}in(c, (=GetEndpointResponse,=pkSess_1031,=None,SP_1032: bitstring,UP_1033: bitstring));
                                        {566}new Nc_1034: bitstring;
                                        {567}let m1_1035: bitstring = (OpenSecureChannelRequest,pkCli,Nc_1034) in
                                        {568}out(c, (pkCli,m1_1035));
                                        {569}in(c, em2_1036: bitstring);
                                        {570}let m2_1037: bitstring = em2_1036 in
                                        {571}let (=OpenSecureChannelResponse,Ns_1038: bitstring,ST_1039: bitstring,TTL_1040: bitstring) = m2_1037 in
                                        {572}let Kcli_1041: bitstring = h((Nc_1034,Ns_1038)) in
                                        {573}out(c, senc(mCli(pkCli,pkSess_1031),Kcli_1041))
                                )
                                else
                                    {574}let pkSess_1042: bitstring = fail-any in
                                    {575}out(c, GetEndpointRequest);
                                    {576}in(c, (=GetEndpointResponse,=pkSess_1042,=None,SP_1043: bitstring,UP_1044: bitstring));
                                    {577}new Nc_1045: bitstring;
                                    {578}let m1_1046: bitstring = (OpenSecureChannelRequest,pkCli,Nc_1045) in
                                    {579}out(c, (pkCli,m1_1046));
                                    {580}in(c, em2_1047: bitstring);
                                    {581}let m2_1048: bitstring = em2_1047 in
                                    {582}let (=OpenSecureChannelResponse,Ns_1049: bitstring,ST_1050: bitstring,TTL_1051: bitstring) = m2_1048 in
                                    {583}let Kcli_1052: bitstring = h((Nc_1045,Ns_1049)) in
                                    {584}out(c, senc(mCli(pkCli,pkSess_1042),Kcli_1052))
                        )
                        else
                            {585}let pkSess_1053: bitstring = fail-any in
                            {586}out(c, GetEndpointRequest);
                            {587}in(c, (=GetEndpointResponse,=pkSess_1053,=None,SP_1054: bitstring,UP_1055: bitstring));
                            {588}new Nc_1056: bitstring;
                            {589}let m1_1057: bitstring = (OpenSecureChannelRequest,pkCli,Nc_1056) in
                            {590}out(c, (pkCli,m1_1057));
                            {591}in(c, em2_1058: bitstring);
                            {592}let m2_1059: bitstring = em2_1058 in
                            {593}let (=OpenSecureChannelResponse,Ns_1060: bitstring,ST_1061: bitstring,TTL_1062: bitstring) = m2_1059 in
                            {594}let Kcli_1063: bitstring = h((Nc_1056,Ns_1060)) in
                            {595}out(c, senc(mCli(pkCli,pkSess_1053),Kcli_1063))
                )
                else
                    {596}let pkSess_1064: bitstring = fail-any in
                    {597}out(c, GetEndpointRequest);
                    {598}in(c, (=GetEndpointResponse,=pkSess_1064,=None,SP_1065: bitstring,UP_1066: bitstring));
                    {599}new Nc_1067: bitstring;
                    {600}let m1_1068: bitstring = (OpenSecureChannelRequest,pkCli,Nc_1067) in
                    {601}out(c, (pkCli,m1_1068));
                    {602}in(c, em2_1069: bitstring);
                    {603}let m2_1070: bitstring = em2_1069 in
                    {604}let (=OpenSecureChannelResponse,Ns_1071: bitstring,ST_1072: bitstring,TTL_1073: bitstring) = m2_1070 in
                    {605}let Kcli_1074: bitstring = h((Nc_1067,Ns_1071)) in
                    {606}out(c, senc(mCli(pkCli,pkSess_1064),Kcli_1074))
        )
        else
            {607}let v_1075: bool = (Cli = B) in
            (
                {608}if v_1075 then
                (
                    {609}let skCli_1076: bitstring = skB in
                    {610}let pkCli_1077: bitstring = pub(skCli_1076) in
                    {611}let v_1078: bool = (Disco = A) in
                    (
                        {612}if v_1078 then
                        (
                            {613}let pkDisco_1079: bitstring = pub(skA) in
                            {614}let v_1080: bool = (Sess = A) in
                            (
                                {615}if v_1080 then
                                (
                                    {616}let pkSess_1081: bitstring = pub(skA) in
                                    {617}out(c, GetEndpointRequest);
                                    {618}in(c, (=GetEndpointResponse,=pkSess_1081,=None,SP_1082: bitstring,UP_1083: bitstring));
                                    {619}new Nc_1084: bitstring;
                                    {620}let m1_1085: bitstring = (OpenSecureChannelRequest,pkCli_1077,Nc_1084) in
                                    {621}out(c, (pkCli_1077,m1_1085));
                                    {622}in(c, em2_1086: bitstring);
                                    {623}let m2_1087: bitstring = em2_1086 in
                                    {624}let (=OpenSecureChannelResponse,Ns_1088: bitstring,ST_1089: bitstring,TTL_1090: bitstring) = m2_1087 in
                                    {625}let Kcli_1091: bitstring = h((Nc_1084,Ns_1088)) in
                                    {626}out(c, senc(mCli(pkCli_1077,pkSess_1081),Kcli_1091))
                                )
                                else
                                    {627}let v_1092: bool = (Sess = B) in
                                    (
                                        {628}if v_1092 then
                                        (
                                            {629}let pkSess_1093: bitstring = pub(skB) in
                                            {630}out(c, GetEndpointRequest);
                                            {631}in(c, (=GetEndpointResponse,=pkSess_1093,=None,SP_1094: bitstring,UP_1095: bitstring));
                                            {632}new Nc_1096: bitstring;
                                            {633}let m1_1097: bitstring = (OpenSecureChannelRequest,pkCli_1077,Nc_1096) in
                                            {634}out(c, (pkCli_1077,m1_1097));
                                            {635}in(c, em2_1098: bitstring);
                                            {636}let m2_1099: bitstring = em2_1098 in
                                            {637}let (=OpenSecureChannelResponse,Ns_1100: bitstring,ST_1101: bitstring,TTL_1102: bitstring) = m2_1099 in
                                            {638}let Kcli_1103: bitstring = h((Nc_1096,Ns_1100)) in
                                            {639}out(c, senc(mCli(pkCli_1077,pkSess_1093),Kcli_1103))
                                        )
                                        else
                                            {640}let v_1104: bool = (Sess = C) in
                                            (
                                                {641}if v_1104 then
                                                (
                                                    {642}let pkSess_1105: bitstring = pub(skC) in
                                                    {643}out(c, GetEndpointRequest);
                                                    {644}in(c, (=GetEndpointResponse,=pkSess_1105,=None,SP_1106: bitstring,UP_1107: bitstring));
                                                    {645}new Nc_1108: bitstring;
                                                    {646}let m1_1109: bitstring = (OpenSecureChannelRequest,pkCli_1077,Nc_1108) in
                                                    {647}out(c, (pkCli_1077,m1_1109));
                                                    {648}in(c, em2_1110: bitstring);
                                                    {649}let m2_1111: bitstring = em2_1110 in
                                                    {650}let (=OpenSecureChannelResponse,Ns_1112: bitstring,ST_1113: bitstring,TTL_1114: bitstring) = m2_1111 in
                                                    {651}let Kcli_1115: bitstring = h((Nc_1108,Ns_1112)) in
                                                    {652}out(c, senc(mCli(pkCli_1077,pkSess_1105),Kcli_1115))
                                                )
                                                else
                                                    {653}let pkSess_1116: bitstring = pub(sk(Sess)) in
                                                    {654}out(c, GetEndpointRequest);
                                                    {655}in(c, (=GetEndpointResponse,=pkSess_1116,=None,SP_1117: bitstring,UP_1118: bitstring));
                                                    {656}new Nc_1119: bitstring;
                                                    {657}let m1_1120: bitstring = (OpenSecureChannelRequest,pkCli_1077,Nc_1119) in
                                                    {658}out(c, (pkCli_1077,m1_1120));
                                                    {659}in(c, em2_1121: bitstring);
                                                    {660}let m2_1122: bitstring = em2_1121 in
                                                    {661}let (=OpenSecureChannelResponse,Ns_1123: bitstring,ST_1124: bitstring,TTL_1125: bitstring) = m2_1122 in
                                                    {662}let Kcli_1126: bitstring = h((Nc_1119,Ns_1123)) in
                                                    {663}out(c, senc(mCli(pkCli_1077,pkSess_1116),Kcli_1126))
                                            )
                                            else
                                                {664}let pkSess_1127: bitstring = fail-any in
                                                {665}out(c, GetEndpointRequest);
                                                {666}in(c, (=GetEndpointResponse,=pkSess_1127,=None,SP_1128: bitstring,UP_1129: bitstring));
                                                {667}new Nc_1130: bitstring;
                                                {668}let m1_1131: bitstring = (OpenSecureChannelRequest,pkCli_1077,Nc_1130) in
                                                {669}out(c, (pkCli_1077,m1_1131));
                                                {670}in(c, em2_1132: bitstring);
                                                {671}let m2_1133: bitstring = em2_1132 in
                                                {672}let (=OpenSecureChannelResponse,Ns_1134: bitstring,ST_1135: bitstring,TTL_1136: bitstring) = m2_1133 in
                                                {673}let Kcli_1137: bitstring = h((Nc_1130,Ns_1134)) in
                                                {674}out(c, senc(mCli(pkCli_1077,pkSess_1127),Kcli_1137))
                                    )
                                    else
                                        {675}let pkSess_1138: bitstring = fail-any in
                                        {676}out(c, GetEndpointRequest);
                                        {677}in(c, (=GetEndpointResponse,=pkSess_1138,=None,SP_1139: bitstring,UP_1140: bitstring));
                                        {678}new Nc_1141: bitstring;
                                        {679}let m1_1142: bitstring = (OpenSecureChannelRequest,pkCli_1077,Nc_1141) in
                                        {680}out(c, (pkCli_1077,m1_1142));
                                        {681}in(c, em2_1143: bitstring);
                                        {682}let m2_1144: bitstring = em2_1143 in
                                        {683}let (=OpenSecureChannelResponse,Ns_1145: bitstring,ST_1146: bitstring,TTL_1147: bitstring) = m2_1144 in
                                        {684}let Kcli_1148: bitstring = h((Nc_1141,Ns_1145)) in
                                        {685}out(c, senc(mCli(pkCli_1077,pkSess_1138),Kcli_1148))
                            )
                            else
                                {686}let pkSess_1149: bitstring = fail-any in
                                {687}out(c, GetEndpointRequest);
                                {688}in(c, (=GetEndpointResponse,=pkSess_1149,=None,SP_1150: bitstring,UP_1151: bitstring));
                                {689}new Nc_1152: bitstring;
                                {690}let m1_1153: bitstring = (OpenSecureChannelRequest,pkCli_1077,Nc_1152) in
                                {691}out(c, (pkCli_1077,m1_1153));
                                {692}in(c, em2_1154: bitstring);
                                {693}let m2_1155: bitstring = em2_1154 in
                                {694}let (=OpenSecureChannelResponse,Ns_1156: bitstring,ST_1157: bitstring,TTL_1158: bitstring) = m2_1155 in
                                {695}let Kcli_1159: bitstring = h((Nc_1152,Ns_1156)) in
                                {696}out(c, senc(mCli(pkCli_1077,pkSess_1149),Kcli_1159))
                        )
                        else
                            {697}let v_1160: bool = (Disco = B) in
                            (
                                {698}if v_1160 then
                                (
                                    {699}let pkDisco_1161: bitstring = pub(skB) in
                                    {700}let v_1162: bool = (Sess = A) in
                                    (
                                        {701}if v_1162 then
                                        (
                                            {702}let pkSess_1163: bitstring = pub(skA) in
                                            {703}out(c, GetEndpointRequest);
                                            {704}in(c, (=GetEndpointResponse,=pkSess_1163,=None,SP_1164: bitstring,UP_1165: bitstring));
                                            {705}new Nc_1166: bitstring;
                                            {706}let m1_1167: bitstring = (OpenSecureChannelRequest,pkCli_1077,Nc_1166) in
                                            {707}out(c, (pkCli_1077,m1_1167));
                                            {708}in(c, em2_1168: bitstring);
                                            {709}let m2_1169: bitstring = em2_1168 in
                                            {710}let (=OpenSecureChannelResponse,Ns_1170: bitstring,ST_1171: bitstring,TTL_1172: bitstring) = m2_1169 in
                                            {711}let Kcli_1173: bitstring = h((Nc_1166,Ns_1170)) in
                                            {712}out(c, senc(mCli(pkCli_1077,pkSess_1163),Kcli_1173))
                                        )
                                        else
                                            {713}let v_1174: bool = (Sess = B) in
                                            (
                                                {714}if v_1174 then
                                                (
                                                    {715}let pkSess_1175: bitstring = pub(skB) in
                                                    {716}out(c, GetEndpointRequest);
                                                    {717}in(c, (=GetEndpointResponse,=pkSess_1175,=None,SP_1176: bitstring,UP_1177: bitstring));
                                                    {718}new Nc_1178: bitstring;
                                                    {719}let m1_1179: bitstring = (OpenSecureChannelRequest,pkCli_1077,Nc_1178) in
                                                    {720}out(c, (pkCli_1077,m1_1179));
                                                    {721}in(c, em2_1180: bitstring);
                                                    {722}let m2_1181: bitstring = em2_1180 in
                                                    {723}let (=OpenSecureChannelResponse,Ns_1182: bitstring,ST_1183: bitstring,TTL_1184: bitstring) = m2_1181 in
                                                    {724}let Kcli_1185: bitstring = h((Nc_1178,Ns_1182)) in
                                                    {725}out(c, senc(mCli(pkCli_1077,pkSess_1175),Kcli_1185))
                                                )
                                                else
                                                    {726}let v_1186: bool = (Sess = C) in
                                                    (
                                                        {727}if v_1186 then
                                                        (
                                                            {728}let pkSess_1187: bitstring = pub(skC) in
                                                            {729}out(c, GetEndpointRequest);
                                                            {730}in(c, (=GetEndpointResponse,=pkSess_1187,=None,SP_1188: bitstring,UP_1189: bitstring));
                                                            {731}new Nc_1190: bitstring;
                                                            {732}let m1_1191: bitstring = (OpenSecureChannelRequest,pkCli_1077,Nc_1190) in
                                                            {733}out(c, (pkCli_1077,m1_1191));
                                                            {734}in(c, em2_1192: bitstring);
                                                            {735}let m2_1193: bitstring = em2_1192 in
                                                            {736}let (=OpenSecureChannelResponse,Ns_1194: bitstring,ST_1195: bitstring,TTL_1196: bitstring) = m2_1193 in
                                                            {737}let Kcli_1197: bitstring = h((Nc_1190,Ns_1194)) in
                                                            {738}out(c, senc(mCli(pkCli_1077,pkSess_1187),Kcli_1197))
                                                        )
                                                        else
                                                            {739}let pkSess_1198: bitstring = pub(sk(Sess)) in
                                                            {740}out(c, GetEndpointRequest);
                                                            {741}in(c, (=GetEndpointResponse,=pkSess_1198,=None,SP_1199: bitstring,UP_1200: bitstring));
                                                            {742}new Nc_1201: bitstring;
                                                            {743}let m1_1202: bitstring = (OpenSecureChannelRequest,pkCli_1077,Nc_1201) in
                                                            {744}out(c, (pkCli_1077,m1_1202));
                                                            {745}in(c, em2_1203: bitstring);
                                                            {746}let m2_1204: bitstring = em2_1203 in
                                                            {747}let (=OpenSecureChannelResponse,Ns_1205: bitstring,ST_1206: bitstring,TTL_1207: bitstring) = m2_1204 in
                                                            {748}let Kcli_1208: bitstring = h((Nc_1201,Ns_1205)) in
                                                            {749}out(c, senc(mCli(pkCli_1077,pkSess_1198),Kcli_1208))
                                                    )
                                                    else
                                                        {750}let pkSess_1209: bitstring = fail-any in
                                                        {751}out(c, GetEndpointRequest);
                                                        {752}in(c, (=GetEndpointResponse,=pkSess_1209,=None,SP_1210: bitstring,UP_1211: bitstring));
                                                        {753}new Nc_1212: bitstring;
                                                        {754}let m1_1213: bitstring = (OpenSecureChannelRequest,pkCli_1077,Nc_1212) in
                                                        {755}out(c, (pkCli_1077,m1_1213));
                                                        {756}in(c, em2_1214: bitstring);
                                                        {757}let m2_1215: bitstring = em2_1214 in
                                                        {758}let (=OpenSecureChannelResponse,Ns_1216: bitstring,ST_1217: bitstring,TTL_1218: bitstring) = m2_1215 in
                                                        {759}let Kcli_1219: bitstring = h((Nc_1212,Ns_1216)) in
                                                        {760}out(c, senc(mCli(pkCli_1077,pkSess_1209),Kcli_1219))
                                            )
                                            else
                                                {761}let pkSess_1220: bitstring = fail-any in
                                                {762}out(c, GetEndpointRequest);
                                                {763}in(c, (=GetEndpointResponse,=pkSess_1220,=None,SP_1221: bitstring,UP_1222: bitstring));
                                                {764}new Nc_1223: bitstring;
                                                {765}let m1_1224: bitstring = (OpenSecureChannelRequest,pkCli_1077,Nc_1223) in
                                                {766}out(c, (pkCli_1077,m1_1224));
                                                {767}in(c, em2_1225: bitstring);
                                                {768}let m2_1226: bitstring = em2_1225 in
                                                {769}let (=OpenSecureChannelResponse,Ns_1227: bitstring,ST_1228: bitstring,TTL_1229: bitstring) = m2_1226 in
                                                {770}let Kcli_1230: bitstring = h((Nc_1223,Ns_1227)) in
                                                {771}out(c, senc(mCli(pkCli_1077,pkSess_1220),Kcli_1230))
                                    )
                                    else
                                        {772}let pkSess_1231: bitstring = fail-any in
                                        {773}out(c, GetEndpointRequest);
                                        {774}in(c, (=GetEndpointResponse,=pkSess_1231,=None,SP_1232: bitstring,UP_1233: bitstring));
                                        {775}new Nc_1234: bitstring;
                                        {776}let m1_1235: bitstring = (OpenSecureChannelRequest,pkCli_1077,Nc_1234) in
                                        {777}out(c, (pkCli_1077,m1_1235));
                                        {778}in(c, em2_1236: bitstring);
                                        {779}let m2_1237: bitstring = em2_1236 in
                                        {780}let (=OpenSecureChannelResponse,Ns_1238: bitstring,ST_1239: bitstring,TTL_1240: bitstring) = m2_1237 in
                                        {781}let Kcli_1241: bitstring = h((Nc_1234,Ns_1238)) in
                                        {782}out(c, senc(mCli(pkCli_1077,pkSess_1231),Kcli_1241))
                                )
                                else
                                    {783}let v_1242: bool = (Disco = C) in
                                    (
                                        {784}if v_1242 then
                                        (
                                            {785}let pkDisco_1243: bitstring = pub(skC) in
                                            {786}let v_1244: bool = (Sess = A) in
                                            (
                                                {787}if v_1244 then
                                                (
                                                    {788}let pkSess_1245: bitstring = pub(skA) in
                                                    {789}out(c, GetEndpointRequest);
                                                    {790}in(c, (=GetEndpointResponse,=pkSess_1245,=None,SP_1246: bitstring,UP_1247: bitstring));
                                                    {791}new Nc_1248: bitstring;
                                                    {792}let m1_1249: bitstring = (OpenSecureChannelRequest,pkCli_1077,Nc_1248) in
                                                    {793}out(c, (pkCli_1077,m1_1249));
                                                    {794}in(c, em2_1250: bitstring);
                                                    {795}let m2_1251: bitstring = em2_1250 in
                                                    {796}let (=OpenSecureChannelResponse,Ns_1252: bitstring,ST_1253: bitstring,TTL_1254: bitstring) = m2_1251 in
                                                    {797}let Kcli_1255: bitstring = h((Nc_1248,Ns_1252)) in
                                                    {798}out(c, senc(mCli(pkCli_1077,pkSess_1245),Kcli_1255))
                                                )
                                                else
                                                    {799}let v_1256: bool = (Sess = B) in
                                                    (
                                                        {800}if v_1256 then
                                                        (
                                                            {801}let pkSess_1257: bitstring = pub(skB) in
                                                            {802}out(c, GetEndpointRequest);
                                                            {803}in(c, (=GetEndpointResponse,=pkSess_1257,=None,SP_1258: bitstring,UP_1259: bitstring));
                                                            {804}new Nc_1260: bitstring;
                                                            {805}let m1_1261: bitstring = (OpenSecureChannelRequest,pkCli_1077,Nc_1260) in
                                                            {806}out(c, (pkCli_1077,m1_1261));
                                                            {807}in(c, em2_1262: bitstring);
                                                            {808}let m2_1263: bitstring = em2_1262 in
                                                            {809}let (=OpenSecureChannelResponse,Ns_1264: bitstring,ST_1265: bitstring,TTL_1266: bitstring) = m2_1263 in
                                                            {810}let Kcli_1267: bitstring = h((Nc_1260,Ns_1264)) in
                                                            {811}out(c, senc(mCli(pkCli_1077,pkSess_1257),Kcli_1267))
                                                        )
                                                        else
                                                            {812}let v_1268: bool = (Sess = C) in
                                                            (
                                                                {813}if v_1268 then
                                                                (
                                                                    {814}let pkSess_1269: bitstring = pub(skC) in
                                                                    {815}out(c, GetEndpointRequest);
                                                                    {816}in(c, (=GetEndpointResponse,=pkSess_1269,=None,SP_1270: bitstring,UP_1271: bitstring));
                                                                    {817}new Nc_1272: bitstring;
                                                                    {818}let m1_1273: bitstring = (OpenSecureChannelRequest,pkCli_1077,Nc_1272) in
                                                                    {819}out(c, (pkCli_1077,m1_1273));
                                                                    {820}in(c, em2_1274: bitstring);
                                                                    {821}let m2_1275: bitstring = em2_1274 in
                                                                    {822}let (=OpenSecureChannelResponse,Ns_1276: bitstring,ST_1277: bitstring,TTL_1278: bitstring) = m2_1275 in
                                                                    {823}let Kcli_1279: bitstring = h((Nc_1272,Ns_1276)) in
                                                                    {824}out(c, senc(mCli(pkCli_1077,pkSess_1269),Kcli_1279))
                                                                )
                                                                else
                                                                    {825}let pkSess_1280: bitstring = pub(sk(Sess)) in
                                                                    {826}out(c, GetEndpointRequest);
                                                                    {827}in(c, (=GetEndpointResponse,=pkSess_1280,=None,SP_1281: bitstring,UP_1282: bitstring));
                                                                    {828}new Nc_1283: bitstring;
                                                                    {829}let m1_1284: bitstring = (OpenSecureChannelRequest,pkCli_1077,Nc_1283) in
                                                                    {830}out(c, (pkCli_1077,m1_1284));
                                                                    {831}in(c, em2_1285: bitstring);
                                                                    {832}let m2_1286: bitstring = em2_1285 in
                                                                    {833}let (=OpenSecureChannelResponse,Ns_1287: bitstring,ST_1288: bitstring,TTL_1289: bitstring) = m2_1286 in
                                                                    {834}let Kcli_1290: bitstring = h((Nc_1283,Ns_1287)) in
                                                                    {835}out(c, senc(mCli(pkCli_1077,pkSess_1280),Kcli_1290))
                                                            )
                                                            else
                                                                {836}let pkSess_1291: bitstring = fail-any in
                                                                {837}out(c, GetEndpointRequest);
                                                                {838}in(c, (=GetEndpointResponse,=pkSess_1291,=None,SP_1292: bitstring,UP_1293: bitstring));
                                                                {839}new Nc_1294: bitstring;
                                                                {840}let m1_1295: bitstring = (OpenSecureChannelRequest,pkCli_1077,Nc_1294) in
                                                                {841}out(c, (pkCli_1077,m1_1295));
                                                                {842}in(c, em2_1296: bitstring);
                                                                {843}let m2_1297: bitstring = em2_1296 in
                                                                {844}let (=OpenSecureChannelResponse,Ns_1298: bitstring,ST_1299: bitstring,TTL_1300: bitstring) = m2_1297 in
                                                                {845}let Kcli_1301: bitstring = h((Nc_1294,Ns_1298)) in
                                                                {846}out(c, senc(mCli(pkCli_1077,pkSess_1291),Kcli_1301))
                                                    )
                                                    else
                                                        {847}let pkSess_1302: bitstring = fail-any in
                                                        {848}out(c, GetEndpointRequest);
                                                        {849}in(c, (=GetEndpointResponse,=pkSess_1302,=None,SP_1303: bitstring,UP_1304: bitstring));
                                                        {850}new Nc_1305: bitstring;
                                                        {851}let m1_1306: bitstring = (OpenSecureChannelRequest,pkCli_1077,Nc_1305) in
                                                        {852}out(c, (pkCli_1077,m1_1306));
                                                        {853}in(c, em2_1307: bitstring);
                                                        {854}let m2_1308: bitstring = em2_1307 in
                                                        {855}let (=OpenSecureChannelResponse,Ns_1309: bitstring,ST_1310: bitstring,TTL_1311: bitstring) = m2_1308 in
                                                        {856}let Kcli_1312: bitstring = h((Nc_1305,Ns_1309)) in
                                                        {857}out(c, senc(mCli(pkCli_1077,pkSess_1302),Kcli_1312))
                                            )
                                            else
                                                {858}let pkSess_1313: bitstring = fail-any in
                                                {859}out(c, GetEndpointRequest);
                                                {860}in(c, (=GetEndpointResponse,=pkSess_1313,=None,SP_1314: bitstring,UP_1315: bitstring));
                                                {861}new Nc_1316: bitstring;
                                                {862}let m1_1317: bitstring = (OpenSecureChannelRequest,pkCli_1077,Nc_1316) in
                                                {863}out(c, (pkCli_1077,m1_1317));
                                                {864}in(c, em2_1318: bitstring);
                                                {865}let m2_1319: bitstring = em2_1318 in
                                                {866}let (=OpenSecureChannelResponse,Ns_1320: bitstring,ST_1321: bitstring,TTL_1322: bitstring) = m2_1319 in
                                                {867}let Kcli_1323: bitstring = h((Nc_1316,Ns_1320)) in
                                                {868}out(c, senc(mCli(pkCli_1077,pkSess_1313),Kcli_1323))
                                        )
                                        else
                                            {869}let pkDisco_1324: bitstring = pub(sk(Disco)) in
                                            {870}let v_1325: bool = (Sess = A) in
                                            (
                                                {871}if v_1325 then
                                                (
                                                    {872}let pkSess_1326: bitstring = pub(skA) in
                                                    {873}out(c, GetEndpointRequest);
                                                    {874}in(c, (=GetEndpointResponse,=pkSess_1326,=None,SP_1327: bitstring,UP_1328: bitstring));
                                                    {875}new Nc_1329: bitstring;
                                                    {876}let m1_1330: bitstring = (OpenSecureChannelRequest,pkCli_1077,Nc_1329) in
                                                    {877}out(c, (pkCli_1077,m1_1330));
                                                    {878}in(c, em2_1331: bitstring);
                                                    {879}let m2_1332: bitstring = em2_1331 in
                                                    {880}let (=OpenSecureChannelResponse,Ns_1333: bitstring,ST_1334: bitstring,TTL_1335: bitstring) = m2_1332 in
                                                    {881}let Kcli_1336: bitstring = h((Nc_1329,Ns_1333)) in
                                                    {882}out(c, senc(mCli(pkCli_1077,pkSess_1326),Kcli_1336))
                                                )
                                                else
                                                    {883}let v_1337: bool = (Sess = B) in
                                                    (
                                                        {884}if v_1337 then
                                                        (
                                                            {885}let pkSess_1338: bitstring = pub(skB) in
                                                            {886}out(c, GetEndpointRequest);
                                                            {887}in(c, (=GetEndpointResponse,=pkSess_1338,=None,SP_1339: bitstring,UP_1340: bitstring));
                                                            {888}new Nc_1341: bitstring;
                                                            {889}let m1_1342: bitstring = (OpenSecureChannelRequest,pkCli_1077,Nc_1341) in
                                                            {890}out(c, (pkCli_1077,m1_1342));
                                                            {891}in(c, em2_1343: bitstring);
                                                            {892}let m2_1344: bitstring = em2_1343 in
                                                            {893}let (=OpenSecureChannelResponse,Ns_1345: bitstring,ST_1346: bitstring,TTL_1347: bitstring) = m2_1344 in
                                                            {894}let Kcli_1348: bitstring = h((Nc_1341,Ns_1345)) in
                                                            {895}out(c, senc(mCli(pkCli_1077,pkSess_1338),Kcli_1348))
                                                        )
                                                        else
                                                            {896}let v_1349: bool = (Sess = C) in
                                                            (
                                                                {897}if v_1349 then
                                                                (
                                                                    {898}let pkSess_1350: bitstring = pub(skC) in
                                                                    {899}out(c, GetEndpointRequest);
                                                                    {900}in(c, (=GetEndpointResponse,=pkSess_1350,=None,SP_1351: bitstring,UP_1352: bitstring));
                                                                    {901}new Nc_1353: bitstring;
                                                                    {902}let m1_1354: bitstring = (OpenSecureChannelRequest,pkCli_1077,Nc_1353) in
                                                                    {903}out(c, (pkCli_1077,m1_1354));
                                                                    {904}in(c, em2_1355: bitstring);
                                                                    {905}let m2_1356: bitstring = em2_1355 in
                                                                    {906}let (=OpenSecureChannelResponse,Ns_1357: bitstring,ST_1358: bitstring,TTL_1359: bitstring) = m2_1356 in
                                                                    {907}let Kcli_1360: bitstring = h((Nc_1353,Ns_1357)) in
                                                                    {908}out(c, senc(mCli(pkCli_1077,pkSess_1350),Kcli_1360))
                                                                )
                                                                else
                                                                    {909}let pkSess_1361: bitstring = pub(sk(Sess)) in
                                                                    {910}out(c, GetEndpointRequest);
                                                                    {911}in(c, (=GetEndpointResponse,=pkSess_1361,=None,SP_1362: bitstring,UP_1363: bitstring));
                                                                    {912}new Nc_1364: bitstring;
                                                                    {913}let m1_1365: bitstring = (OpenSecureChannelRequest,pkCli_1077,Nc_1364) in
                                                                    {914}out(c, (pkCli_1077,m1_1365));
                                                                    {915}in(c, em2_1366: bitstring);
                                                                    {916}let m2_1367: bitstring = em2_1366 in
                                                                    {917}let (=OpenSecureChannelResponse,Ns_1368: bitstring,ST_1369: bitstring,TTL_1370: bitstring) = m2_1367 in
                                                                    {918}let Kcli_1371: bitstring = h((Nc_1364,Ns_1368)) in
                                                                    {919}out(c, senc(mCli(pkCli_1077,pkSess_1361),Kcli_1371))
                                                            )
                                                            else
                                                                {920}let pkSess_1372: bitstring = fail-any in
                                                                {921}out(c, GetEndpointRequest);
                                                                {922}in(c, (=GetEndpointResponse,=pkSess_1372,=None,SP_1373: bitstring,UP_1374: bitstring));
                                                                {923}new Nc_1375: bitstring;
                                                                {924}let m1_1376: bitstring = (OpenSecureChannelRequest,pkCli_1077,Nc_1375) in
                                                                {925}out(c, (pkCli_1077,m1_1376));
                                                                {926}in(c, em2_1377: bitstring);
                                                                {927}let m2_1378: bitstring = em2_1377 in
                                                                {928}let (=OpenSecureChannelResponse,Ns_1379: bitstring,ST_1380: bitstring,TTL_1381: bitstring) = m2_1378 in
                                                                {929}let Kcli_1382: bitstring = h((Nc_1375,Ns_1379)) in
                                                                {930}out(c, senc(mCli(pkCli_1077,pkSess_1372),Kcli_1382))
                                                    )
                                                    else
                                                        {931}let pkSess_1383: bitstring = fail-any in
                                                        {932}out(c, GetEndpointRequest);
                                                        {933}in(c, (=GetEndpointResponse,=pkSess_1383,=None,SP_1384: bitstring,UP_1385: bitstring));
                                                        {934}new Nc_1386: bitstring;
                                                        {935}let m1_1387: bitstring = (OpenSecureChannelRequest,pkCli_1077,Nc_1386) in
                                                        {936}out(c, (pkCli_1077,m1_1387));
                                                        {937}in(c, em2_1388: bitstring);
                                                        {938}let m2_1389: bitstring = em2_1388 in
                                                        {939}let (=OpenSecureChannelResponse,Ns_1390: bitstring,ST_1391: bitstring,TTL_1392: bitstring) = m2_1389 in
                                                        {940}let Kcli_1393: bitstring = h((Nc_1386,Ns_1390)) in
                                                        {941}out(c, senc(mCli(pkCli_1077,pkSess_1383),Kcli_1393))
                                            )
                                            else
                                                {942}let pkSess_1394: bitstring = fail-any in
                                                {943}out(c, GetEndpointRequest);
                                                {944}in(c, (=GetEndpointResponse,=pkSess_1394,=None,SP_1395: bitstring,UP_1396: bitstring));
                                                {945}new Nc_1397: bitstring;
                                                {946}let m1_1398: bitstring = (OpenSecureChannelRequest,pkCli_1077,Nc_1397) in
                                                {947}out(c, (pkCli_1077,m1_1398));
                                                {948}in(c, em2_1399: bitstring);
                                                {949}let m2_1400: bitstring = em2_1399 in
                                                {950}let (=OpenSecureChannelResponse,Ns_1401: bitstring,ST_1402: bitstring,TTL_1403: bitstring) = m2_1400 in
                                                {951}let Kcli_1404: bitstring = h((Nc_1397,Ns_1401)) in
                                                {952}out(c, senc(mCli(pkCli_1077,pkSess_1394),Kcli_1404))
                                    )
                                    else
                                        {953}let pkDisco_1405: bitstring = fail-any in
                                        {954}let v_1406: bool = (Sess = A) in
                                        (
                                            {955}if v_1406 then
                                            (
                                                {956}let pkSess_1407: bitstring = pub(skA) in
                                                {957}out(c, GetEndpointRequest);
                                                {958}in(c, (=GetEndpointResponse,=pkSess_1407,=None,SP_1408: bitstring,UP_1409: bitstring));
                                                {959}new Nc_1410: bitstring;
                                                {960}let m1_1411: bitstring = (OpenSecureChannelRequest,pkCli_1077,Nc_1410) in
                                                {961}out(c, (pkCli_1077,m1_1411));
                                                {962}in(c, em2_1412: bitstring);
                                                {963}let m2_1413: bitstring = em2_1412 in
                                                {964}let (=OpenSecureChannelResponse,Ns_1414: bitstring,ST_1415: bitstring,TTL_1416: bitstring) = m2_1413 in
                                                {965}let Kcli_1417: bitstring = h((Nc_1410,Ns_1414)) in
                                                {966}out(c, senc(mCli(pkCli_1077,pkSess_1407),Kcli_1417))
                                            )
                                            else
                                                {967}let v_1418: bool = (Sess = B) in
                                                (
                                                    {968}if v_1418 then
                                                    (
                                                        {969}let pkSess_1419: bitstring = pub(skB) in
                                                        {970}out(c, GetEndpointRequest);
                                                        {971}in(c, (=GetEndpointResponse,=pkSess_1419,=None,SP_1420: bitstring,UP_1421: bitstring));
                                                        {972}new Nc_1422: bitstring;
                                                        {973}let m1_1423: bitstring = (OpenSecureChannelRequest,pkCli_1077,Nc_1422) in
                                                        {974}out(c, (pkCli_1077,m1_1423));
                                                        {975}in(c, em2_1424: bitstring);
                                                        {976}let m2_1425: bitstring = em2_1424 in
                                                        {977}let (=OpenSecureChannelResponse,Ns_1426: bitstring,ST_1427: bitstring,TTL_1428: bitstring) = m2_1425 in
                                                        {978}let Kcli_1429: bitstring = h((Nc_1422,Ns_1426)) in
                                                        {979}out(c, senc(mCli(pkCli_1077,pkSess_1419),Kcli_1429))
                                                    )
                                                    else
                                                        {980}let v_1430: bool = (Sess = C) in
                                                        (
                                                            {981}if v_1430 then
                                                            (
                                                                {982}let pkSess_1431: bitstring = pub(skC) in
                                                                {983}out(c, GetEndpointRequest);
                                                                {984}in(c, (=GetEndpointResponse,=pkSess_1431,=None,SP_1432: bitstring,UP_1433: bitstring));
                                                                {985}new Nc_1434: bitstring;
                                                                {986}let m1_1435: bitstring = (OpenSecureChannelRequest,pkCli_1077,Nc_1434) in
                                                                {987}out(c, (pkCli_1077,m1_1435));
                                                                {988}in(c, em2_1436: bitstring);
                                                                {989}let m2_1437: bitstring = em2_1436 in
                                                                {990}let (=OpenSecureChannelResponse,Ns_1438: bitstring,ST_1439: bitstring,TTL_1440: bitstring) = m2_1437 in
                                                                {991}let Kcli_1441: bitstring = h((Nc_1434,Ns_1438)) in
                                                                {992}out(c, senc(mCli(pkCli_1077,pkSess_1431),Kcli_1441))
                                                            )
                                                            else
                                                                {993}let pkSess_1442: bitstring = pub(sk(Sess)) in
                                                                {994}out(c, GetEndpointRequest);
                                                                {995}in(c, (=GetEndpointResponse,=pkSess_1442,=None,SP_1443: bitstring,UP_1444: bitstring));
                                                                {996}new Nc_1445: bitstring;
                                                                {997}let m1_1446: bitstring = (OpenSecureChannelRequest,pkCli_1077,Nc_1445) in
                                                                {998}out(c, (pkCli_1077,m1_1446));
                                                                {999}in(c, em2_1447: bitstring);
                                                                {1000}let m2_1448: bitstring = em2_1447 in
                                                                {1001}let (=OpenSecureChannelResponse,Ns_1449: bitstring,ST_1450: bitstring,TTL_1451: bitstring) = m2_1448 in
                                                                {1002}let Kcli_1452: bitstring = h((Nc_1445,Ns_1449)) in
                                                                {1003}out(c, senc(mCli(pkCli_1077,pkSess_1442),Kcli_1452))
                                                        )
                                                        else
                                                            {1004}let pkSess_1453: bitstring = fail-any in
                                                            {1005}out(c, GetEndpointRequest);
                                                            {1006}in(c, (=GetEndpointResponse,=pkSess_1453,=None,SP_1454: bitstring,UP_1455: bitstring));
                                                            {1007}new Nc_1456: bitstring;
                                                            {1008}let m1_1457: bitstring = (OpenSecureChannelRequest,pkCli_1077,Nc_1456) in
                                                            {1009}out(c, (pkCli_1077,m1_1457));
                                                            {1010}in(c, em2_1458: bitstring);
                                                            {1011}let m2_1459: bitstring = em2_1458 in
                                                            {1012}let (=OpenSecureChannelResponse,Ns_1460: bitstring,ST_1461: bitstring,TTL_1462: bitstring) = m2_1459 in
                                                            {1013}let Kcli_1463: bitstring = h((Nc_1456,Ns_1460)) in
                                                            {1014}out(c, senc(mCli(pkCli_1077,pkSess_1453),Kcli_1463))
                                                )
                                                else
                                                    {1015}let pkSess_1464: bitstring = fail-any in
                                                    {1016}out(c, GetEndpointRequest);
                                                    {1017}in(c, (=GetEndpointResponse,=pkSess_1464,=None,SP_1465: bitstring,UP_1466: bitstring));
                                                    {1018}new Nc_1467: bitstring;
                                                    {1019}let m1_1468: bitstring = (OpenSecureChannelRequest,pkCli_1077,Nc_1467) in
                                                    {1020}out(c, (pkCli_1077,m1_1468));
                                                    {1021}in(c, em2_1469: bitstring);
                                                    {1022}let m2_1470: bitstring = em2_1469 in
                                                    {1023}let (=OpenSecureChannelResponse,Ns_1471: bitstring,ST_1472: bitstring,TTL_1473: bitstring) = m2_1470 in
                                                    {1024}let Kcli_1474: bitstring = h((Nc_1467,Ns_1471)) in
                                                    {1025}out(c, senc(mCli(pkCli_1077,pkSess_1464),Kcli_1474))
                                        )
                                        else
                                            {1026}let pkSess_1475: bitstring = fail-any in
                                            {1027}out(c, GetEndpointRequest);
                                            {1028}in(c, (=GetEndpointResponse,=pkSess_1475,=None,SP_1476: bitstring,UP_1477: bitstring));
                                            {1029}new Nc_1478: bitstring;
                                            {1030}let m1_1479: bitstring = (OpenSecureChannelRequest,pkCli_1077,Nc_1478) in
                                            {1031}out(c, (pkCli_1077,m1_1479));
                                            {1032}in(c, em2_1480: bitstring);
                                            {1033}let m2_1481: bitstring = em2_1480 in
                                            {1034}let (=OpenSecureChannelResponse,Ns_1482: bitstring,ST_1483: bitstring,TTL_1484: bitstring) = m2_1481 in
                                            {1035}let Kcli_1485: bitstring = h((Nc_1478,Ns_1482)) in
                                            {1036}out(c, senc(mCli(pkCli_1077,pkSess_1475),Kcli_1485))
                            )
                            else
                                {1037}let pkDisco_1486: bitstring = fail-any in
                                {1038}let v_1487: bool = (Sess = A) in
                                (
                                    {1039}if v_1487 then
                                    (
                                        {1040}let pkSess_1488: bitstring = pub(skA) in
                                        {1041}out(c, GetEndpointRequest);
                                        {1042}in(c, (=GetEndpointResponse,=pkSess_1488,=None,SP_1489: bitstring,UP_1490: bitstring));
                                        {1043}new Nc_1491: bitstring;
                                        {1044}let m1_1492: bitstring = (OpenSecureChannelRequest,pkCli_1077,Nc_1491) in
                                        {1045}out(c, (pkCli_1077,m1_1492));
                                        {1046}in(c, em2_1493: bitstring);
                                        {1047}let m2_1494: bitstring = em2_1493 in
                                        {1048}let (=OpenSecureChannelResponse,Ns_1495: bitstring,ST_1496: bitstring,TTL_1497: bitstring) = m2_1494 in
                                        {1049}let Kcli_1498: bitstring = h((Nc_1491,Ns_1495)) in
                                        {1050}out(c, senc(mCli(pkCli_1077,pkSess_1488),Kcli_1498))
                                    )
                                    else
                                        {1051}let v_1499: bool = (Sess = B) in
                                        (
                                            {1052}if v_1499 then
                                            (
                                                {1053}let pkSess_1500: bitstring = pub(skB) in
                                                {1054}out(c, GetEndpointRequest);
                                                {1055}in(c, (=GetEndpointResponse,=pkSess_1500,=None,SP_1501: bitstring,UP_1502: bitstring));
                                                {1056}new Nc_1503: bitstring;
                                                {1057}let m1_1504: bitstring = (OpenSecureChannelRequest,pkCli_1077,Nc_1503) in
                                                {1058}out(c, (pkCli_1077,m1_1504));
                                                {1059}in(c, em2_1505: bitstring);
                                                {1060}let m2_1506: bitstring = em2_1505 in
                                                {1061}let (=OpenSecureChannelResponse,Ns_1507: bitstring,ST_1508: bitstring,TTL_1509: bitstring) = m2_1506 in
                                                {1062}let Kcli_1510: bitstring = h((Nc_1503,Ns_1507)) in
                                                {1063}out(c, senc(mCli(pkCli_1077,pkSess_1500),Kcli_1510))
                                            )
                                            else
                                                {1064}let v_1511: bool = (Sess = C) in
                                                (
                                                    {1065}if v_1511 then
                                                    (
                                                        {1066}let pkSess_1512: bitstring = pub(skC) in
                                                        {1067}out(c, GetEndpointRequest);
                                                        {1068}in(c, (=GetEndpointResponse,=pkSess_1512,=None,SP_1513: bitstring,UP_1514: bitstring));
                                                        {1069}new Nc_1515: bitstring;
                                                        {1070}let m1_1516: bitstring = (OpenSecureChannelRequest,pkCli_1077,Nc_1515) in
                                                        {1071}out(c, (pkCli_1077,m1_1516));
                                                        {1072}in(c, em2_1517: bitstring);
                                                        {1073}let m2_1518: bitstring = em2_1517 in
                                                        {1074}let (=OpenSecureChannelResponse,Ns_1519: bitstring,ST_1520: bitstring,TTL_1521: bitstring) = m2_1518 in
                                                        {1075}let Kcli_1522: bitstring = h((Nc_1515,Ns_1519)) in
                                                        {1076}out(c, senc(mCli(pkCli_1077,pkSess_1512),Kcli_1522))
                                                    )
                                                    else
                                                        {1077}let pkSess_1523: bitstring = pub(sk(Sess)) in
                                                        {1078}out(c, GetEndpointRequest);
                                                        {1079}in(c, (=GetEndpointResponse,=pkSess_1523,=None,SP_1524: bitstring,UP_1525: bitstring));
                                                        {1080}new Nc_1526: bitstring;
                                                        {1081}let m1_1527: bitstring = (OpenSecureChannelRequest,pkCli_1077,Nc_1526) in
                                                        {1082}out(c, (pkCli_1077,m1_1527));
                                                        {1083}in(c, em2_1528: bitstring);
                                                        {1084}let m2_1529: bitstring = em2_1528 in
                                                        {1085}let (=OpenSecureChannelResponse,Ns_1530: bitstring,ST_1531: bitstring,TTL_1532: bitstring) = m2_1529 in
                                                        {1086}let Kcli_1533: bitstring = h((Nc_1526,Ns_1530)) in
                                                        {1087}out(c, senc(mCli(pkCli_1077,pkSess_1523),Kcli_1533))
                                                )
                                                else
                                                    {1088}let pkSess_1534: bitstring = fail-any in
                                                    {1089}out(c, GetEndpointRequest);
                                                    {1090}in(c, (=GetEndpointResponse,=pkSess_1534,=None,SP_1535: bitstring,UP_1536: bitstring));
                                                    {1091}new Nc_1537: bitstring;
                                                    {1092}let m1_1538: bitstring = (OpenSecureChannelRequest,pkCli_1077,Nc_1537) in
                                                    {1093}out(c, (pkCli_1077,m1_1538));
                                                    {1094}in(c, em2_1539: bitstring);
                                                    {1095}let m2_1540: bitstring = em2_1539 in
                                                    {1096}let (=OpenSecureChannelResponse,Ns_1541: bitstring,ST_1542: bitstring,TTL_1543: bitstring) = m2_1540 in
                                                    {1097}let Kcli_1544: bitstring = h((Nc_1537,Ns_1541)) in
                                                    {1098}out(c, senc(mCli(pkCli_1077,pkSess_1534),Kcli_1544))
                                        )
                                        else
                                            {1099}let pkSess_1545: bitstring = fail-any in
                                            {1100}out(c, GetEndpointRequest);
                                            {1101}in(c, (=GetEndpointResponse,=pkSess_1545,=None,SP_1546: bitstring,UP_1547: bitstring));
                                            {1102}new Nc_1548: bitstring;
                                            {1103}let m1_1549: bitstring = (OpenSecureChannelRequest,pkCli_1077,Nc_1548) in
                                            {1104}out(c, (pkCli_1077,m1_1549));
                                            {1105}in(c, em2_1550: bitstring);
                                            {1106}let m2_1551: bitstring = em2_1550 in
                                            {1107}let (=OpenSecureChannelResponse,Ns_1552: bitstring,ST_1553: bitstring,TTL_1554: bitstring) = m2_1551 in
                                            {1108}let Kcli_1555: bitstring = h((Nc_1548,Ns_1552)) in
                                            {1109}out(c, senc(mCli(pkCli_1077,pkSess_1545),Kcli_1555))
                                )
                                else
                                    {1110}let pkSess_1556: bitstring = fail-any in
                                    {1111}out(c, GetEndpointRequest);
                                    {1112}in(c, (=GetEndpointResponse,=pkSess_1556,=None,SP_1557: bitstring,UP_1558: bitstring));
                                    {1113}new Nc_1559: bitstring;
                                    {1114}let m1_1560: bitstring = (OpenSecureChannelRequest,pkCli_1077,Nc_1559) in
                                    {1115}out(c, (pkCli_1077,m1_1560));
                                    {1116}in(c, em2_1561: bitstring);
                                    {1117}let m2_1562: bitstring = em2_1561 in
                                    {1118}let (=OpenSecureChannelResponse,Ns_1563: bitstring,ST_1564: bitstring,TTL_1565: bitstring) = m2_1562 in
                                    {1119}let Kcli_1566: bitstring = h((Nc_1559,Ns_1563)) in
                                    {1120}out(c, senc(mCli(pkCli_1077,pkSess_1556),Kcli_1566))
                    )
                    else
                        {1121}let pkDisco_1567: bitstring = fail-any in
                        {1122}let v_1568: bool = (Sess = A) in
                        (
                            {1123}if v_1568 then
                            (
                                {1124}let pkSess_1569: bitstring = pub(skA) in
                                {1125}out(c, GetEndpointRequest);
                                {1126}in(c, (=GetEndpointResponse,=pkSess_1569,=None,SP_1570: bitstring,UP_1571: bitstring));
                                {1127}new Nc_1572: bitstring;
                                {1128}let m1_1573: bitstring = (OpenSecureChannelRequest,pkCli_1077,Nc_1572) in
                                {1129}out(c, (pkCli_1077,m1_1573));
                                {1130}in(c, em2_1574: bitstring);
                                {1131}let m2_1575: bitstring = em2_1574 in
                                {1132}let (=OpenSecureChannelResponse,Ns_1576: bitstring,ST_1577: bitstring,TTL_1578: bitstring) = m2_1575 in
                                {1133}let Kcli_1579: bitstring = h((Nc_1572,Ns_1576)) in
                                {1134}out(c, senc(mCli(pkCli_1077,pkSess_1569),Kcli_1579))
                            )
                            else
                                {1135}let v_1580: bool = (Sess = B) in
                                (
                                    {1136}if v_1580 then
                                    (
                                        {1137}let pkSess_1581: bitstring = pub(skB) in
                                        {1138}out(c, GetEndpointRequest);
                                        {1139}in(c, (=GetEndpointResponse,=pkSess_1581,=None,SP_1582: bitstring,UP_1583: bitstring));
                                        {1140}new Nc_1584: bitstring;
                                        {1141}let m1_1585: bitstring = (OpenSecureChannelRequest,pkCli_1077,Nc_1584) in
                                        {1142}out(c, (pkCli_1077,m1_1585));
                                        {1143}in(c, em2_1586: bitstring);
                                        {1144}let m2_1587: bitstring = em2_1586 in
                                        {1145}let (=OpenSecureChannelResponse,Ns_1588: bitstring,ST_1589: bitstring,TTL_1590: bitstring) = m2_1587 in
                                        {1146}let Kcli_1591: bitstring = h((Nc_1584,Ns_1588)) in
                                        {1147}out(c, senc(mCli(pkCli_1077,pkSess_1581),Kcli_1591))
                                    )
                                    else
                                        {1148}let v_1592: bool = (Sess = C) in
                                        (
                                            {1149}if v_1592 then
                                            (
                                                {1150}let pkSess_1593: bitstring = pub(skC) in
                                                {1151}out(c, GetEndpointRequest);
                                                {1152}in(c, (=GetEndpointResponse,=pkSess_1593,=None,SP_1594: bitstring,UP_1595: bitstring));
                                                {1153}new Nc_1596: bitstring;
                                                {1154}let m1_1597: bitstring = (OpenSecureChannelRequest,pkCli_1077,Nc_1596) in
                                                {1155}out(c, (pkCli_1077,m1_1597));
                                                {1156}in(c, em2_1598: bitstring);
                                                {1157}let m2_1599: bitstring = em2_1598 in
                                                {1158}let (=OpenSecureChannelResponse,Ns_1600: bitstring,ST_1601: bitstring,TTL_1602: bitstring) = m2_1599 in
                                                {1159}let Kcli_1603: bitstring = h((Nc_1596,Ns_1600)) in
                                                {1160}out(c, senc(mCli(pkCli_1077,pkSess_1593),Kcli_1603))
                                            )
                                            else
                                                {1161}let pkSess_1604: bitstring = pub(sk(Sess)) in
                                                {1162}out(c, GetEndpointRequest);
                                                {1163}in(c, (=GetEndpointResponse,=pkSess_1604,=None,SP_1605: bitstring,UP_1606: bitstring));
                                                {1164}new Nc_1607: bitstring;
                                                {1165}let m1_1608: bitstring = (OpenSecureChannelRequest,pkCli_1077,Nc_1607) in
                                                {1166}out(c, (pkCli_1077,m1_1608));
                                                {1167}in(c, em2_1609: bitstring);
                                                {1168}let m2_1610: bitstring = em2_1609 in
                                                {1169}let (=OpenSecureChannelResponse,Ns_1611: bitstring,ST_1612: bitstring,TTL_1613: bitstring) = m2_1610 in
                                                {1170}let Kcli_1614: bitstring = h((Nc_1607,Ns_1611)) in
                                                {1171}out(c, senc(mCli(pkCli_1077,pkSess_1604),Kcli_1614))
                                        )
                                        else
                                            {1172}let pkSess_1615: bitstring = fail-any in
                                            {1173}out(c, GetEndpointRequest);
                                            {1174}in(c, (=GetEndpointResponse,=pkSess_1615,=None,SP_1616: bitstring,UP_1617: bitstring));
                                            {1175}new Nc_1618: bitstring;
                                            {1176}let m1_1619: bitstring = (OpenSecureChannelRequest,pkCli_1077,Nc_1618) in
                                            {1177}out(c, (pkCli_1077,m1_1619));
                                            {1178}in(c, em2_1620: bitstring);
                                            {1179}let m2_1621: bitstring = em2_1620 in
                                            {1180}let (=OpenSecureChannelResponse,Ns_1622: bitstring,ST_1623: bitstring,TTL_1624: bitstring) = m2_1621 in
                                            {1181}let Kcli_1625: bitstring = h((Nc_1618,Ns_1622)) in
                                            {1182}out(c, senc(mCli(pkCli_1077,pkSess_1615),Kcli_1625))
                                )
                                else
                                    {1183}let pkSess_1626: bitstring = fail-any in
                                    {1184}out(c, GetEndpointRequest);
                                    {1185}in(c, (=GetEndpointResponse,=pkSess_1626,=None,SP_1627: bitstring,UP_1628: bitstring));
                                    {1186}new Nc_1629: bitstring;
                                    {1187}let m1_1630: bitstring = (OpenSecureChannelRequest,pkCli_1077,Nc_1629) in
                                    {1188}out(c, (pkCli_1077,m1_1630));
                                    {1189}in(c, em2_1631: bitstring);
                                    {1190}let m2_1632: bitstring = em2_1631 in
                                    {1191}let (=OpenSecureChannelResponse,Ns_1633: bitstring,ST_1634: bitstring,TTL_1635: bitstring) = m2_1632 in
                                    {1192}let Kcli_1636: bitstring = h((Nc_1629,Ns_1633)) in
                                    {1193}out(c, senc(mCli(pkCli_1077,pkSess_1626),Kcli_1636))
                        )
                        else
                            {1194}let pkSess_1637: bitstring = fail-any in
                            {1195}out(c, GetEndpointRequest);
                            {1196}in(c, (=GetEndpointResponse,=pkSess_1637,=None,SP_1638: bitstring,UP_1639: bitstring));
                            {1197}new Nc_1640: bitstring;
                            {1198}let m1_1641: bitstring = (OpenSecureChannelRequest,pkCli_1077,Nc_1640) in
                            {1199}out(c, (pkCli_1077,m1_1641));
                            {1200}in(c, em2_1642: bitstring);
                            {1201}let m2_1643: bitstring = em2_1642 in
                            {1202}let (=OpenSecureChannelResponse,Ns_1644: bitstring,ST_1645: bitstring,TTL_1646: bitstring) = m2_1643 in
                            {1203}let Kcli_1647: bitstring = h((Nc_1640,Ns_1644)) in
                            {1204}out(c, senc(mCli(pkCli_1077,pkSess_1637),Kcli_1647))
                )
                else
                    {1205}let =true = (Cli = C) in
                    (
                        {1206}let skCli_1648: bitstring = skC in
                        {1207}let pkCli_1649: bitstring = pub(skCli_1648) in
                        {1208}let v_1650: bool = (Disco = A) in
                        (
                            {1209}if v_1650 then
                            (
                                {1210}let pkDisco_1651: bitstring = pub(skA) in
                                {1211}let v_1652: bool = (Sess = A) in
                                (
                                    {1212}if v_1652 then
                                    (
                                        {1213}let pkSess_1653: bitstring = pub(skA) in
                                        {1214}out(c, GetEndpointRequest);
                                        {1215}in(c, (=GetEndpointResponse,=pkSess_1653,=None,SP_1654: bitstring,UP_1655: bitstring));
                                        {1216}new Nc_1656: bitstring;
                                        {1217}let m1_1657: bitstring = (OpenSecureChannelRequest,pkCli_1649,Nc_1656) in
                                        {1218}out(c, (pkCli_1649,m1_1657));
                                        {1219}in(c, em2_1658: bitstring);
                                        {1220}let m2_1659: bitstring = em2_1658 in
                                        {1221}let (=OpenSecureChannelResponse,Ns_1660: bitstring,ST_1661: bitstring,TTL_1662: bitstring) = m2_1659 in
                                        {1222}let Kcli_1663: bitstring = h((Nc_1656,Ns_1660)) in
                                        {1223}out(c, senc(mCli(pkCli_1649,pkSess_1653),Kcli_1663))
                                    )
                                    else
                                        {1224}let v_1664: bool = (Sess = B) in
                                        (
                                            {1225}if v_1664 then
                                            (
                                                {1226}let pkSess_1665: bitstring = pub(skB) in
                                                {1227}out(c, GetEndpointRequest);
                                                {1228}in(c, (=GetEndpointResponse,=pkSess_1665,=None,SP_1666: bitstring,UP_1667: bitstring));
                                                {1229}new Nc_1668: bitstring;
                                                {1230}let m1_1669: bitstring = (OpenSecureChannelRequest,pkCli_1649,Nc_1668) in
                                                {1231}out(c, (pkCli_1649,m1_1669));
                                                {1232}in(c, em2_1670: bitstring);
                                                {1233}let m2_1671: bitstring = em2_1670 in
                                                {1234}let (=OpenSecureChannelResponse,Ns_1672: bitstring,ST_1673: bitstring,TTL_1674: bitstring) = m2_1671 in
                                                {1235}let Kcli_1675: bitstring = h((Nc_1668,Ns_1672)) in
                                                {1236}out(c, senc(mCli(pkCli_1649,pkSess_1665),Kcli_1675))
                                            )
                                            else
                                                {1237}let v_1676: bool = (Sess = C) in
                                                (
                                                    {1238}if v_1676 then
                                                    (
                                                        {1239}let pkSess_1677: bitstring = pub(skC) in
                                                        {1240}out(c, GetEndpointRequest);
                                                        {1241}in(c, (=GetEndpointResponse,=pkSess_1677,=None,SP_1678: bitstring,UP_1679: bitstring));
                                                        {1242}new Nc_1680: bitstring;
                                                        {1243}let m1_1681: bitstring = (OpenSecureChannelRequest,pkCli_1649,Nc_1680) in
                                                        {1244}out(c, (pkCli_1649,m1_1681));
                                                        {1245}in(c, em2_1682: bitstring);
                                                        {1246}let m2_1683: bitstring = em2_1682 in
                                                        {1247}let (=OpenSecureChannelResponse,Ns_1684: bitstring,ST_1685: bitstring,TTL_1686: bitstring) = m2_1683 in
                                                        {1248}let Kcli_1687: bitstring = h((Nc_1680,Ns_1684)) in
                                                        {1249}out(c, senc(mCli(pkCli_1649,pkSess_1677),Kcli_1687))
                                                    )
                                                    else
                                                        {1250}let pkSess_1688: bitstring = pub(sk(Sess)) in
                                                        {1251}out(c, GetEndpointRequest);
                                                        {1252}in(c, (=GetEndpointResponse,=pkSess_1688,=None,SP_1689: bitstring,UP_1690: bitstring));
                                                        {1253}new Nc_1691: bitstring;
                                                        {1254}let m1_1692: bitstring = (OpenSecureChannelRequest,pkCli_1649,Nc_1691) in
                                                        {1255}out(c, (pkCli_1649,m1_1692));
                                                        {1256}in(c, em2_1693: bitstring);
                                                        {1257}let m2_1694: bitstring = em2_1693 in
                                                        {1258}let (=OpenSecureChannelResponse,Ns_1695: bitstring,ST_1696: bitstring,TTL_1697: bitstring) = m2_1694 in
                                                        {1259}let Kcli_1698: bitstring = h((Nc_1691,Ns_1695)) in
                                                        {1260}out(c, senc(mCli(pkCli_1649,pkSess_1688),Kcli_1698))
                                                )
                                                else
                                                    {1261}let pkSess_1699: bitstring = fail-any in
                                                    {1262}out(c, GetEndpointRequest);
                                                    {1263}in(c, (=GetEndpointResponse,=pkSess_1699,=None,SP_1700: bitstring,UP_1701: bitstring));
                                                    {1264}new Nc_1702: bitstring;
                                                    {1265}let m1_1703: bitstring = (OpenSecureChannelRequest,pkCli_1649,Nc_1702) in
                                                    {1266}out(c, (pkCli_1649,m1_1703));
                                                    {1267}in(c, em2_1704: bitstring);
                                                    {1268}let m2_1705: bitstring = em2_1704 in
                                                    {1269}let (=OpenSecureChannelResponse,Ns_1706: bitstring,ST_1707: bitstring,TTL_1708: bitstring) = m2_1705 in
                                                    {1270}let Kcli_1709: bitstring = h((Nc_1702,Ns_1706)) in
                                                    {1271}out(c, senc(mCli(pkCli_1649,pkSess_1699),Kcli_1709))
                                        )
                                        else
                                            {1272}let pkSess_1710: bitstring = fail-any in
                                            {1273}out(c, GetEndpointRequest);
                                            {1274}in(c, (=GetEndpointResponse,=pkSess_1710,=None,SP_1711: bitstring,UP_1712: bitstring));
                                            {1275}new Nc_1713: bitstring;
                                            {1276}let m1_1714: bitstring = (OpenSecureChannelRequest,pkCli_1649,Nc_1713) in
                                            {1277}out(c, (pkCli_1649,m1_1714));
                                            {1278}in(c, em2_1715: bitstring);
                                            {1279}let m2_1716: bitstring = em2_1715 in
                                            {1280}let (=OpenSecureChannelResponse,Ns_1717: bitstring,ST_1718: bitstring,TTL_1719: bitstring) = m2_1716 in
                                            {1281}let Kcli_1720: bitstring = h((Nc_1713,Ns_1717)) in
                                            {1282}out(c, senc(mCli(pkCli_1649,pkSess_1710),Kcli_1720))
                                )
                                else
                                    {1283}let pkSess_1721: bitstring = fail-any in
                                    {1284}out(c, GetEndpointRequest);
                                    {1285}in(c, (=GetEndpointResponse,=pkSess_1721,=None,SP_1722: bitstring,UP_1723: bitstring));
                                    {1286}new Nc_1724: bitstring;
                                    {1287}let m1_1725: bitstring = (OpenSecureChannelRequest,pkCli_1649,Nc_1724) in
                                    {1288}out(c, (pkCli_1649,m1_1725));
                                    {1289}in(c, em2_1726: bitstring);
                                    {1290}let m2_1727: bitstring = em2_1726 in
                                    {1291}let (=OpenSecureChannelResponse,Ns_1728: bitstring,ST_1729: bitstring,TTL_1730: bitstring) = m2_1727 in
                                    {1292}let Kcli_1731: bitstring = h((Nc_1724,Ns_1728)) in
                                    {1293}out(c, senc(mCli(pkCli_1649,pkSess_1721),Kcli_1731))
                            )
                            else
                                {1294}let v_1732: bool = (Disco = B) in
                                (
                                    {1295}if v_1732 then
                                    (
                                        {1296}let pkDisco_1733: bitstring = pub(skB) in
                                        {1297}let v_1734: bool = (Sess = A) in
                                        (
                                            {1298}if v_1734 then
                                            (
                                                {1299}let pkSess_1735: bitstring = pub(skA) in
                                                {1300}out(c, GetEndpointRequest);
                                                {1301}in(c, (=GetEndpointResponse,=pkSess_1735,=None,SP_1736: bitstring,UP_1737: bitstring));
                                                {1302}new Nc_1738: bitstring;
                                                {1303}let m1_1739: bitstring = (OpenSecureChannelRequest,pkCli_1649,Nc_1738) in
                                                {1304}out(c, (pkCli_1649,m1_1739));
                                                {1305}in(c, em2_1740: bitstring);
                                                {1306}let m2_1741: bitstring = em2_1740 in
                                                {1307}let (=OpenSecureChannelResponse,Ns_1742: bitstring,ST_1743: bitstring,TTL_1744: bitstring) = m2_1741 in
                                                {1308}let Kcli_1745: bitstring = h((Nc_1738,Ns_1742)) in
                                                {1309}out(c, senc(mCli(pkCli_1649,pkSess_1735),Kcli_1745))
                                            )
                                            else
                                                {1310}let v_1746: bool = (Sess = B) in
                                                (
                                                    {1311}if v_1746 then
                                                    (
                                                        {1312}let pkSess_1747: bitstring = pub(skB) in
                                                        {1313}out(c, GetEndpointRequest);
                                                        {1314}in(c, (=GetEndpointResponse,=pkSess_1747,=None,SP_1748: bitstring,UP_1749: bitstring));
                                                        {1315}new Nc_1750: bitstring;
                                                        {1316}let m1_1751: bitstring = (OpenSecureChannelRequest,pkCli_1649,Nc_1750) in
                                                        {1317}out(c, (pkCli_1649,m1_1751));
                                                        {1318}in(c, em2_1752: bitstring);
                                                        {1319}let m2_1753: bitstring = em2_1752 in
                                                        {1320}let (=OpenSecureChannelResponse,Ns_1754: bitstring,ST_1755: bitstring,TTL_1756: bitstring) = m2_1753 in
                                                        {1321}let Kcli_1757: bitstring = h((Nc_1750,Ns_1754)) in
                                                        {1322}out(c, senc(mCli(pkCli_1649,pkSess_1747),Kcli_1757))
                                                    )
                                                    else
                                                        {1323}let v_1758: bool = (Sess = C) in
                                                        (
                                                            {1324}if v_1758 then
                                                            (
                                                                {1325}let pkSess_1759: bitstring = pub(skC) in
                                                                {1326}out(c, GetEndpointRequest);
                                                                {1327}in(c, (=GetEndpointResponse,=pkSess_1759,=None,SP_1760: bitstring,UP_1761: bitstring));
                                                                {1328}new Nc_1762: bitstring;
                                                                {1329}let m1_1763: bitstring = (OpenSecureChannelRequest,pkCli_1649,Nc_1762) in
                                                                {1330}out(c, (pkCli_1649,m1_1763));
                                                                {1331}in(c, em2_1764: bitstring);
                                                                {1332}let m2_1765: bitstring = em2_1764 in
                                                                {1333}let (=OpenSecureChannelResponse,Ns_1766: bitstring,ST_1767: bitstring,TTL_1768: bitstring) = m2_1765 in
                                                                {1334}let Kcli_1769: bitstring = h((Nc_1762,Ns_1766)) in
                                                                {1335}out(c, senc(mCli(pkCli_1649,pkSess_1759),Kcli_1769))
                                                            )
                                                            else
                                                                {1336}let pkSess_1770: bitstring = pub(sk(Sess)) in
                                                                {1337}out(c, GetEndpointRequest);
                                                                {1338}in(c, (=GetEndpointResponse,=pkSess_1770,=None,SP_1771: bitstring,UP_1772: bitstring));
                                                                {1339}new Nc_1773: bitstring;
                                                                {1340}let m1_1774: bitstring = (OpenSecureChannelRequest,pkCli_1649,Nc_1773) in
                                                                {1341}out(c, (pkCli_1649,m1_1774));
                                                                {1342}in(c, em2_1775: bitstring);
                                                                {1343}let m2_1776: bitstring = em2_1775 in
                                                                {1344}let (=OpenSecureChannelResponse,Ns_1777: bitstring,ST_1778: bitstring,TTL_1779: bitstring) = m2_1776 in
                                                                {1345}let Kcli_1780: bitstring = h((Nc_1773,Ns_1777)) in
                                                                {1346}out(c, senc(mCli(pkCli_1649,pkSess_1770),Kcli_1780))
                                                        )
                                                        else
                                                            {1347}let pkSess_1781: bitstring = fail-any in
                                                            {1348}out(c, GetEndpointRequest);
                                                            {1349}in(c, (=GetEndpointResponse,=pkSess_1781,=None,SP_1782: bitstring,UP_1783: bitstring));
                                                            {1350}new Nc_1784: bitstring;
                                                            {1351}let m1_1785: bitstring = (OpenSecureChannelRequest,pkCli_1649,Nc_1784) in
                                                            {1352}out(c, (pkCli_1649,m1_1785));
                                                            {1353}in(c, em2_1786: bitstring);
                                                            {1354}let m2_1787: bitstring = em2_1786 in
                                                            {1355}let (=OpenSecureChannelResponse,Ns_1788: bitstring,ST_1789: bitstring,TTL_1790: bitstring) = m2_1787 in
                                                            {1356}let Kcli_1791: bitstring = h((Nc_1784,Ns_1788)) in
                                                            {1357}out(c, senc(mCli(pkCli_1649,pkSess_1781),Kcli_1791))
                                                )
                                                else
                                                    {1358}let pkSess_1792: bitstring = fail-any in
                                                    {1359}out(c, GetEndpointRequest);
                                                    {1360}in(c, (=GetEndpointResponse,=pkSess_1792,=None,SP_1793: bitstring,UP_1794: bitstring));
                                                    {1361}new Nc_1795: bitstring;
                                                    {1362}let m1_1796: bitstring = (OpenSecureChannelRequest,pkCli_1649,Nc_1795) in
                                                    {1363}out(c, (pkCli_1649,m1_1796));
                                                    {1364}in(c, em2_1797: bitstring);
                                                    {1365}let m2_1798: bitstring = em2_1797 in
                                                    {1366}let (=OpenSecureChannelResponse,Ns_1799: bitstring,ST_1800: bitstring,TTL_1801: bitstring) = m2_1798 in
                                                    {1367}let Kcli_1802: bitstring = h((Nc_1795,Ns_1799)) in
                                                    {1368}out(c, senc(mCli(pkCli_1649,pkSess_1792),Kcli_1802))
                                        )
                                        else
                                            {1369}let pkSess_1803: bitstring = fail-any in
                                            {1370}out(c, GetEndpointRequest);
                                            {1371}in(c, (=GetEndpointResponse,=pkSess_1803,=None,SP_1804: bitstring,UP_1805: bitstring));
                                            {1372}new Nc_1806: bitstring;
                                            {1373}let m1_1807: bitstring = (OpenSecureChannelRequest,pkCli_1649,Nc_1806) in
                                            {1374}out(c, (pkCli_1649,m1_1807));
                                            {1375}in(c, em2_1808: bitstring);
                                            {1376}let m2_1809: bitstring = em2_1808 in
                                            {1377}let (=OpenSecureChannelResponse,Ns_1810: bitstring,ST_1811: bitstring,TTL_1812: bitstring) = m2_1809 in
                                            {1378}let Kcli_1813: bitstring = h((Nc_1806,Ns_1810)) in
                                            {1379}out(c, senc(mCli(pkCli_1649,pkSess_1803),Kcli_1813))
                                    )
                                    else
                                        {1380}let v_1814: bool = (Disco = C) in
                                        (
                                            {1381}if v_1814 then
                                            (
                                                {1382}let pkDisco_1815: bitstring = pub(skC) in
                                                {1383}let v_1816: bool = (Sess = A) in
                                                (
                                                    {1384}if v_1816 then
                                                    (
                                                        {1385}let pkSess_1817: bitstring = pub(skA) in
                                                        {1386}out(c, GetEndpointRequest);
                                                        {1387}in(c, (=GetEndpointResponse,=pkSess_1817,=None,SP_1818: bitstring,UP_1819: bitstring));
                                                        {1388}new Nc_1820: bitstring;
                                                        {1389}let m1_1821: bitstring = (OpenSecureChannelRequest,pkCli_1649,Nc_1820) in
                                                        {1390}out(c, (pkCli_1649,m1_1821));
                                                        {1391}in(c, em2_1822: bitstring);
                                                        {1392}let m2_1823: bitstring = em2_1822 in
                                                        {1393}let (=OpenSecureChannelResponse,Ns_1824: bitstring,ST_1825: bitstring,TTL_1826: bitstring) = m2_1823 in
                                                        {1394}let Kcli_1827: bitstring = h((Nc_1820,Ns_1824)) in
                                                        {1395}out(c, senc(mCli(pkCli_1649,pkSess_1817),Kcli_1827))
                                                    )
                                                    else
                                                        {1396}let v_1828: bool = (Sess = B) in
                                                        (
                                                            {1397}if v_1828 then
                                                            (
                                                                {1398}let pkSess_1829: bitstring = pub(skB) in
                                                                {1399}out(c, GetEndpointRequest);
                                                                {1400}in(c, (=GetEndpointResponse,=pkSess_1829,=None,SP_1830: bitstring,UP_1831: bitstring));
                                                                {1401}new Nc_1832: bitstring;
                                                                {1402}let m1_1833: bitstring = (OpenSecureChannelRequest,pkCli_1649,Nc_1832) in
                                                                {1403}out(c, (pkCli_1649,m1_1833));
                                                                {1404}in(c, em2_1834: bitstring);
                                                                {1405}let m2_1835: bitstring = em2_1834 in
                                                                {1406}let (=OpenSecureChannelResponse,Ns_1836: bitstring,ST_1837: bitstring,TTL_1838: bitstring) = m2_1835 in
                                                                {1407}let Kcli_1839: bitstring = h((Nc_1832,Ns_1836)) in
                                                                {1408}out(c, senc(mCli(pkCli_1649,pkSess_1829),Kcli_1839))
                                                            )
                                                            else
                                                                {1409}let v_1840: bool = (Sess = C) in
                                                                (
                                                                    {1410}if v_1840 then
                                                                    (
                                                                        {1411}let pkSess_1841: bitstring = pub(skC) in
                                                                        {1412}out(c, GetEndpointRequest);
                                                                        {1413}in(c, (=GetEndpointResponse,=pkSess_1841,=None,SP_1842: bitstring,UP_1843: bitstring));
                                                                        {1414}new Nc_1844: bitstring;
                                                                        {1415}let m1_1845: bitstring = (OpenSecureChannelRequest,pkCli_1649,Nc_1844) in
                                                                        {1416}out(c, (pkCli_1649,m1_1845));
                                                                        {1417}in(c, em2_1846: bitstring);
                                                                        {1418}let m2_1847: bitstring = em2_1846 in
                                                                        {1419}let (=OpenSecureChannelResponse,Ns_1848: bitstring,ST_1849: bitstring,TTL_1850: bitstring) = m2_1847 in
                                                                        {1420}let Kcli_1851: bitstring = h((Nc_1844,Ns_1848)) in
                                                                        {1421}out(c, senc(mCli(pkCli_1649,pkSess_1841),Kcli_1851))
                                                                    )
                                                                    else
                                                                        {1422}let pkSess_1852: bitstring = pub(sk(Sess)) in
                                                                        {1423}out(c, GetEndpointRequest);
                                                                        {1424}in(c, (=GetEndpointResponse,=pkSess_1852,=None,SP_1853: bitstring,UP_1854: bitstring));
                                                                        {1425}new Nc_1855: bitstring;
                                                                        {1426}let m1_1856: bitstring = (OpenSecureChannelRequest,pkCli_1649,Nc_1855) in
                                                                        {1427}out(c, (pkCli_1649,m1_1856));
                                                                        {1428}in(c, em2_1857: bitstring);
                                                                        {1429}let m2_1858: bitstring = em2_1857 in
                                                                        {1430}let (=OpenSecureChannelResponse,Ns_1859: bitstring,ST_1860: bitstring,TTL_1861: bitstring) = m2_1858 in
                                                                        {1431}let Kcli_1862: bitstring = h((Nc_1855,Ns_1859)) in
                                                                        {1432}out(c, senc(mCli(pkCli_1649,pkSess_1852),Kcli_1862))
                                                                )
                                                                else
                                                                    {1433}let pkSess_1863: bitstring = fail-any in
                                                                    {1434}out(c, GetEndpointRequest);
                                                                    {1435}in(c, (=GetEndpointResponse,=pkSess_1863,=None,SP_1864: bitstring,UP_1865: bitstring));
                                                                    {1436}new Nc_1866: bitstring;
                                                                    {1437}let m1_1867: bitstring = (OpenSecureChannelRequest,pkCli_1649,Nc_1866) in
                                                                    {1438}out(c, (pkCli_1649,m1_1867));
                                                                    {1439}in(c, em2_1868: bitstring);
                                                                    {1440}let m2_1869: bitstring = em2_1868 in
                                                                    {1441}let (=OpenSecureChannelResponse,Ns_1870: bitstring,ST_1871: bitstring,TTL_1872: bitstring) = m2_1869 in
                                                                    {1442}let Kcli_1873: bitstring = h((Nc_1866,Ns_1870)) in
                                                                    {1443}out(c, senc(mCli(pkCli_1649,pkSess_1863),Kcli_1873))
                                                        )
                                                        else
                                                            {1444}let pkSess_1874: bitstring = fail-any in
                                                            {1445}out(c, GetEndpointRequest);
                                                            {1446}in(c, (=GetEndpointResponse,=pkSess_1874,=None,SP_1875: bitstring,UP_1876: bitstring));
                                                            {1447}new Nc_1877: bitstring;
                                                            {1448}let m1_1878: bitstring = (OpenSecureChannelRequest,pkCli_1649,Nc_1877) in
                                                            {1449}out(c, (pkCli_1649,m1_1878));
                                                            {1450}in(c, em2_1879: bitstring);
                                                            {1451}let m2_1880: bitstring = em2_1879 in
                                                            {1452}let (=OpenSecureChannelResponse,Ns_1881: bitstring,ST_1882: bitstring,TTL_1883: bitstring) = m2_1880 in
                                                            {1453}let Kcli_1884: bitstring = h((Nc_1877,Ns_1881)) in
                                                            {1454}out(c, senc(mCli(pkCli_1649,pkSess_1874),Kcli_1884))
                                                )
                                                else
                                                    {1455}let pkSess_1885: bitstring = fail-any in
                                                    {1456}out(c, GetEndpointRequest);
                                                    {1457}in(c, (=GetEndpointResponse,=pkSess_1885,=None,SP_1886: bitstring,UP_1887: bitstring));
                                                    {1458}new Nc_1888: bitstring;
                                                    {1459}let m1_1889: bitstring = (OpenSecureChannelRequest,pkCli_1649,Nc_1888) in
                                                    {1460}out(c, (pkCli_1649,m1_1889));
                                                    {1461}in(c, em2_1890: bitstring);
                                                    {1462}let m2_1891: bitstring = em2_1890 in
                                                    {1463}let (=OpenSecureChannelResponse,Ns_1892: bitstring,ST_1893: bitstring,TTL_1894: bitstring) = m2_1891 in
                                                    {1464}let Kcli_1895: bitstring = h((Nc_1888,Ns_1892)) in
                                                    {1465}out(c, senc(mCli(pkCli_1649,pkSess_1885),Kcli_1895))
                                            )
                                            else
                                                {1466}let pkDisco_1896: bitstring = pub(sk(Disco)) in
                                                {1467}let v_1897: bool = (Sess = A) in
                                                (
                                                    {1468}if v_1897 then
                                                    (
                                                        {1469}let pkSess_1898: bitstring = pub(skA) in
                                                        {1470}out(c, GetEndpointRequest);
                                                        {1471}in(c, (=GetEndpointResponse,=pkSess_1898,=None,SP_1899: bitstring,UP_1900: bitstring));
                                                        {1472}new Nc_1901: bitstring;
                                                        {1473}let m1_1902: bitstring = (OpenSecureChannelRequest,pkCli_1649,Nc_1901) in
                                                        {1474}out(c, (pkCli_1649,m1_1902));
                                                        {1475}in(c, em2_1903: bitstring);
                                                        {1476}let m2_1904: bitstring = em2_1903 in
                                                        {1477}let (=OpenSecureChannelResponse,Ns_1905: bitstring,ST_1906: bitstring,TTL_1907: bitstring) = m2_1904 in
                                                        {1478}let Kcli_1908: bitstring = h((Nc_1901,Ns_1905)) in
                                                        {1479}out(c, senc(mCli(pkCli_1649,pkSess_1898),Kcli_1908))
                                                    )
                                                    else
                                                        {1480}let v_1909: bool = (Sess = B) in
                                                        (
                                                            {1481}if v_1909 then
                                                            (
                                                                {1482}let pkSess_1910: bitstring = pub(skB) in
                                                                {1483}out(c, GetEndpointRequest);
                                                                {1484}in(c, (=GetEndpointResponse,=pkSess_1910,=None,SP_1911: bitstring,UP_1912: bitstring));
                                                                {1485}new Nc_1913: bitstring;
                                                                {1486}let m1_1914: bitstring = (OpenSecureChannelRequest,pkCli_1649,Nc_1913) in
                                                                {1487}out(c, (pkCli_1649,m1_1914));
                                                                {1488}in(c, em2_1915: bitstring);
                                                                {1489}let m2_1916: bitstring = em2_1915 in
                                                                {1490}let (=OpenSecureChannelResponse,Ns_1917: bitstring,ST_1918: bitstring,TTL_1919: bitstring) = m2_1916 in
                                                                {1491}let Kcli_1920: bitstring = h((Nc_1913,Ns_1917)) in
                                                                {1492}out(c, senc(mCli(pkCli_1649,pkSess_1910),Kcli_1920))
                                                            )
                                                            else
                                                                {1493}let v_1921: bool = (Sess = C) in
                                                                (
                                                                    {1494}if v_1921 then
                                                                    (
                                                                        {1495}let pkSess_1922: bitstring = pub(skC) in
                                                                        {1496}out(c, GetEndpointRequest);
                                                                        {1497}in(c, (=GetEndpointResponse,=pkSess_1922,=None,SP_1923: bitstring,UP_1924: bitstring));
                                                                        {1498}new Nc_1925: bitstring;
                                                                        {1499}let m1_1926: bitstring = (OpenSecureChannelRequest,pkCli_1649,Nc_1925) in
                                                                        {1500}out(c, (pkCli_1649,m1_1926));
                                                                        {1501}in(c, em2_1927: bitstring);
                                                                        {1502}let m2_1928: bitstring = em2_1927 in
                                                                        {1503}let (=OpenSecureChannelResponse,Ns_1929: bitstring,ST_1930: bitstring,TTL_1931: bitstring) = m2_1928 in
                                                                        {1504}let Kcli_1932: bitstring = h((Nc_1925,Ns_1929)) in
                                                                        {1505}out(c, senc(mCli(pkCli_1649,pkSess_1922),Kcli_1932))
                                                                    )
                                                                    else
                                                                        {1506}let pkSess_1933: bitstring = pub(sk(Sess)) in
                                                                        {1507}out(c, GetEndpointRequest);
                                                                        {1508}in(c, (=GetEndpointResponse,=pkSess_1933,=None,SP_1934: bitstring,UP_1935: bitstring));
                                                                        {1509}new Nc_1936: bitstring;
                                                                        {1510}let m1_1937: bitstring = (OpenSecureChannelRequest,pkCli_1649,Nc_1936) in
                                                                        {1511}out(c, (pkCli_1649,m1_1937));
                                                                        {1512}in(c, em2_1938: bitstring);
                                                                        {1513}let m2_1939: bitstring = em2_1938 in
                                                                        {1514}let (=OpenSecureChannelResponse,Ns_1940: bitstring,ST_1941: bitstring,TTL_1942: bitstring) = m2_1939 in
                                                                        {1515}let Kcli_1943: bitstring = h((Nc_1936,Ns_1940)) in
                                                                        {1516}out(c, senc(mCli(pkCli_1649,pkSess_1933),Kcli_1943))
                                                                )
                                                                else
                                                                    {1517}let pkSess_1944: bitstring = fail-any in
                                                                    {1518}out(c, GetEndpointRequest);
                                                                    {1519}in(c, (=GetEndpointResponse,=pkSess_1944,=None,SP_1945: bitstring,UP_1946: bitstring));
                                                                    {1520}new Nc_1947: bitstring;
                                                                    {1521}let m1_1948: bitstring = (OpenSecureChannelRequest,pkCli_1649,Nc_1947) in
                                                                    {1522}out(c, (pkCli_1649,m1_1948));
                                                                    {1523}in(c, em2_1949: bitstring);
                                                                    {1524}let m2_1950: bitstring = em2_1949 in
                                                                    {1525}let (=OpenSecureChannelResponse,Ns_1951: bitstring,ST_1952: bitstring,TTL_1953: bitstring) = m2_1950 in
                                                                    {1526}let Kcli_1954: bitstring = h((Nc_1947,Ns_1951)) in
                                                                    {1527}out(c, senc(mCli(pkCli_1649,pkSess_1944),Kcli_1954))
                                                        )
                                                        else
                                                            {1528}let pkSess_1955: bitstring = fail-any in
                                                            {1529}out(c, GetEndpointRequest);
                                                            {1530}in(c, (=GetEndpointResponse,=pkSess_1955,=None,SP_1956: bitstring,UP_1957: bitstring));
                                                            {1531}new Nc_1958: bitstring;
                                                            {1532}let m1_1959: bitstring = (OpenSecureChannelRequest,pkCli_1649,Nc_1958) in
                                                            {1533}out(c, (pkCli_1649,m1_1959));
                                                            {1534}in(c, em2_1960: bitstring);
                                                            {1535}let m2_1961: bitstring = em2_1960 in
                                                            {1536}let (=OpenSecureChannelResponse,Ns_1962: bitstring,ST_1963: bitstring,TTL_1964: bitstring) = m2_1961 in
                                                            {1537}let Kcli_1965: bitstring = h((Nc_1958,Ns_1962)) in
                                                            {1538}out(c, senc(mCli(pkCli_1649,pkSess_1955),Kcli_1965))
                                                )
                                                else
                                                    {1539}let pkSess_1966: bitstring = fail-any in
                                                    {1540}out(c, GetEndpointRequest);
                                                    {1541}in(c, (=GetEndpointResponse,=pkSess_1966,=None,SP_1967: bitstring,UP_1968: bitstring));
                                                    {1542}new Nc_1969: bitstring;
                                                    {1543}let m1_1970: bitstring = (OpenSecureChannelRequest,pkCli_1649,Nc_1969) in
                                                    {1544}out(c, (pkCli_1649,m1_1970));
                                                    {1545}in(c, em2_1971: bitstring);
                                                    {1546}let m2_1972: bitstring = em2_1971 in
                                                    {1547}let (=OpenSecureChannelResponse,Ns_1973: bitstring,ST_1974: bitstring,TTL_1975: bitstring) = m2_1972 in
                                                    {1548}let Kcli_1976: bitstring = h((Nc_1969,Ns_1973)) in
                                                    {1549}out(c, senc(mCli(pkCli_1649,pkSess_1966),Kcli_1976))
                                        )
                                        else
                                            {1550}let pkDisco_1977: bitstring = fail-any in
                                            {1551}let v_1978: bool = (Sess = A) in
                                            (
                                                {1552}if v_1978 then
                                                (
                                                    {1553}let pkSess_1979: bitstring = pub(skA) in
                                                    {1554}out(c, GetEndpointRequest);
                                                    {1555}in(c, (=GetEndpointResponse,=pkSess_1979,=None,SP_1980: bitstring,UP_1981: bitstring));
                                                    {1556}new Nc_1982: bitstring;
                                                    {1557}let m1_1983: bitstring = (OpenSecureChannelRequest,pkCli_1649,Nc_1982) in
                                                    {1558}out(c, (pkCli_1649,m1_1983));
                                                    {1559}in(c, em2_1984: bitstring);
                                                    {1560}let m2_1985: bitstring = em2_1984 in
                                                    {1561}let (=OpenSecureChannelResponse,Ns_1986: bitstring,ST_1987: bitstring,TTL_1988: bitstring) = m2_1985 in
                                                    {1562}let Kcli_1989: bitstring = h((Nc_1982,Ns_1986)) in
                                                    {1563}out(c, senc(mCli(pkCli_1649,pkSess_1979),Kcli_1989))
                                                )
                                                else
                                                    {1564}let v_1990: bool = (Sess = B) in
                                                    (
                                                        {1565}if v_1990 then
                                                        (
                                                            {1566}let pkSess_1991: bitstring = pub(skB) in
                                                            {1567}out(c, GetEndpointRequest);
                                                            {1568}in(c, (=GetEndpointResponse,=pkSess_1991,=None,SP_1992: bitstring,UP_1993: bitstring));
                                                            {1569}new Nc_1994: bitstring;
                                                            {1570}let m1_1995: bitstring = (OpenSecureChannelRequest,pkCli_1649,Nc_1994) in
                                                            {1571}out(c, (pkCli_1649,m1_1995));
                                                            {1572}in(c, em2_1996: bitstring);
                                                            {1573}let m2_1997: bitstring = em2_1996 in
                                                            {1574}let (=OpenSecureChannelResponse,Ns_1998: bitstring,ST_1999: bitstring,TTL_2000: bitstring) = m2_1997 in
                                                            {1575}let Kcli_2001: bitstring = h((Nc_1994,Ns_1998)) in
                                                            {1576}out(c, senc(mCli(pkCli_1649,pkSess_1991),Kcli_2001))
                                                        )
                                                        else
                                                            {1577}let v_2002: bool = (Sess = C) in
                                                            (
                                                                {1578}if v_2002 then
                                                                (
                                                                    {1579}let pkSess_2003: bitstring = pub(skC) in
                                                                    {1580}out(c, GetEndpointRequest);
                                                                    {1581}in(c, (=GetEndpointResponse,=pkSess_2003,=None,SP_2004: bitstring,UP_2005: bitstring));
                                                                    {1582}new Nc_2006: bitstring;
                                                                    {1583}let m1_2007: bitstring = (OpenSecureChannelRequest,pkCli_1649,Nc_2006) in
                                                                    {1584}out(c, (pkCli_1649,m1_2007));
                                                                    {1585}in(c, em2_2008: bitstring);
                                                                    {1586}let m2_2009: bitstring = em2_2008 in
                                                                    {1587}let (=OpenSecureChannelResponse,Ns_2010: bitstring,ST_2011: bitstring,TTL_2012: bitstring) = m2_2009 in
                                                                    {1588}let Kcli_2013: bitstring = h((Nc_2006,Ns_2010)) in
                                                                    {1589}out(c, senc(mCli(pkCli_1649,pkSess_2003),Kcli_2013))
                                                                )
                                                                else
                                                                    {1590}let pkSess_2014: bitstring = pub(sk(Sess)) in
                                                                    {1591}out(c, GetEndpointRequest);
                                                                    {1592}in(c, (=GetEndpointResponse,=pkSess_2014,=None,SP_2015: bitstring,UP_2016: bitstring));
                                                                    {1593}new Nc_2017: bitstring;
                                                                    {1594}let m1_2018: bitstring = (OpenSecureChannelRequest,pkCli_1649,Nc_2017) in
                                                                    {1595}out(c, (pkCli_1649,m1_2018));
                                                                    {1596}in(c, em2_2019: bitstring);
                                                                    {1597}let m2_2020: bitstring = em2_2019 in
                                                                    {1598}let (=OpenSecureChannelResponse,Ns_2021: bitstring,ST_2022: bitstring,TTL_2023: bitstring) = m2_2020 in
                                                                    {1599}let Kcli_2024: bitstring = h((Nc_2017,Ns_2021)) in
                                                                    {1600}out(c, senc(mCli(pkCli_1649,pkSess_2014),Kcli_2024))
                                                            )
                                                            else
                                                                {1601}let pkSess_2025: bitstring = fail-any in
                                                                {1602}out(c, GetEndpointRequest);
                                                                {1603}in(c, (=GetEndpointResponse,=pkSess_2025,=None,SP_2026: bitstring,UP_2027: bitstring));
                                                                {1604}new Nc_2028: bitstring;
                                                                {1605}let m1_2029: bitstring = (OpenSecureChannelRequest,pkCli_1649,Nc_2028) in
                                                                {1606}out(c, (pkCli_1649,m1_2029));
                                                                {1607}in(c, em2_2030: bitstring);
                                                                {1608}let m2_2031: bitstring = em2_2030 in
                                                                {1609}let (=OpenSecureChannelResponse,Ns_2032: bitstring,ST_2033: bitstring,TTL_2034: bitstring) = m2_2031 in
                                                                {1610}let Kcli_2035: bitstring = h((Nc_2028,Ns_2032)) in
                                                                {1611}out(c, senc(mCli(pkCli_1649,pkSess_2025),Kcli_2035))
                                                    )
                                                    else
                                                        {1612}let pkSess_2036: bitstring = fail-any in
                                                        {1613}out(c, GetEndpointRequest);
                                                        {1614}in(c, (=GetEndpointResponse,=pkSess_2036,=None,SP_2037: bitstring,UP_2038: bitstring));
                                                        {1615}new Nc_2039: bitstring;
                                                        {1616}let m1_2040: bitstring = (OpenSecureChannelRequest,pkCli_1649,Nc_2039) in
                                                        {1617}out(c, (pkCli_1649,m1_2040));
                                                        {1618}in(c, em2_2041: bitstring);
                                                        {1619}let m2_2042: bitstring = em2_2041 in
                                                        {1620}let (=OpenSecureChannelResponse,Ns_2043: bitstring,ST_2044: bitstring,TTL_2045: bitstring) = m2_2042 in
                                                        {1621}let Kcli_2046: bitstring = h((Nc_2039,Ns_2043)) in
                                                        {1622}out(c, senc(mCli(pkCli_1649,pkSess_2036),Kcli_2046))
                                            )
                                            else
                                                {1623}let pkSess_2047: bitstring = fail-any in
                                                {1624}out(c, GetEndpointRequest);
                                                {1625}in(c, (=GetEndpointResponse,=pkSess_2047,=None,SP_2048: bitstring,UP_2049: bitstring));
                                                {1626}new Nc_2050: bitstring;
                                                {1627}let m1_2051: bitstring = (OpenSecureChannelRequest,pkCli_1649,Nc_2050) in
                                                {1628}out(c, (pkCli_1649,m1_2051));
                                                {1629}in(c, em2_2052: bitstring);
                                                {1630}let m2_2053: bitstring = em2_2052 in
                                                {1631}let (=OpenSecureChannelResponse,Ns_2054: bitstring,ST_2055: bitstring,TTL_2056: bitstring) = m2_2053 in
                                                {1632}let Kcli_2057: bitstring = h((Nc_2050,Ns_2054)) in
                                                {1633}out(c, senc(mCli(pkCli_1649,pkSess_2047),Kcli_2057))
                                )
                                else
                                    {1634}let pkDisco_2058: bitstring = fail-any in
                                    {1635}let v_2059: bool = (Sess = A) in
                                    (
                                        {1636}if v_2059 then
                                        (
                                            {1637}let pkSess_2060: bitstring = pub(skA) in
                                            {1638}out(c, GetEndpointRequest);
                                            {1639}in(c, (=GetEndpointResponse,=pkSess_2060,=None,SP_2061: bitstring,UP_2062: bitstring));
                                            {1640}new Nc_2063: bitstring;
                                            {1641}let m1_2064: bitstring = (OpenSecureChannelRequest,pkCli_1649,Nc_2063) in
                                            {1642}out(c, (pkCli_1649,m1_2064));
                                            {1643}in(c, em2_2065: bitstring);
                                            {1644}let m2_2066: bitstring = em2_2065 in
                                            {1645}let (=OpenSecureChannelResponse,Ns_2067: bitstring,ST_2068: bitstring,TTL_2069: bitstring) = m2_2066 in
                                            {1646}let Kcli_2070: bitstring = h((Nc_2063,Ns_2067)) in
                                            {1647}out(c, senc(mCli(pkCli_1649,pkSess_2060),Kcli_2070))
                                        )
                                        else
                                            {1648}let v_2071: bool = (Sess = B) in
                                            (
                                                {1649}if v_2071 then
                                                (
                                                    {1650}let pkSess_2072: bitstring = pub(skB) in
                                                    {1651}out(c, GetEndpointRequest);
                                                    {1652}in(c, (=GetEndpointResponse,=pkSess_2072,=None,SP_2073: bitstring,UP_2074: bitstring));
                                                    {1653}new Nc_2075: bitstring;
                                                    {1654}let m1_2076: bitstring = (OpenSecureChannelRequest,pkCli_1649,Nc_2075) in
                                                    {1655}out(c, (pkCli_1649,m1_2076));
                                                    {1656}in(c, em2_2077: bitstring);
                                                    {1657}let m2_2078: bitstring = em2_2077 in
                                                    {1658}let (=OpenSecureChannelResponse,Ns_2079: bitstring,ST_2080: bitstring,TTL_2081: bitstring) = m2_2078 in
                                                    {1659}let Kcli_2082: bitstring = h((Nc_2075,Ns_2079)) in
                                                    {1660}out(c, senc(mCli(pkCli_1649,pkSess_2072),Kcli_2082))
                                                )
                                                else
                                                    {1661}let v_2083: bool = (Sess = C) in
                                                    (
                                                        {1662}if v_2083 then
                                                        (
                                                            {1663}let pkSess_2084: bitstring = pub(skC) in
                                                            {1664}out(c, GetEndpointRequest);
                                                            {1665}in(c, (=GetEndpointResponse,=pkSess_2084,=None,SP_2085: bitstring,UP_2086: bitstring));
                                                            {1666}new Nc_2087: bitstring;
                                                            {1667}let m1_2088: bitstring = (OpenSecureChannelRequest,pkCli_1649,Nc_2087) in
                                                            {1668}out(c, (pkCli_1649,m1_2088));
                                                            {1669}in(c, em2_2089: bitstring);
                                                            {1670}let m2_2090: bitstring = em2_2089 in
                                                            {1671}let (=OpenSecureChannelResponse,Ns_2091: bitstring,ST_2092: bitstring,TTL_2093: bitstring) = m2_2090 in
                                                            {1672}let Kcli_2094: bitstring = h((Nc_2087,Ns_2091)) in
                                                            {1673}out(c, senc(mCli(pkCli_1649,pkSess_2084),Kcli_2094))
                                                        )
                                                        else
                                                            {1674}let pkSess_2095: bitstring = pub(sk(Sess)) in
                                                            {1675}out(c, GetEndpointRequest);
                                                            {1676}in(c, (=GetEndpointResponse,=pkSess_2095,=None,SP_2096: bitstring,UP_2097: bitstring));
                                                            {1677}new Nc_2098: bitstring;
                                                            {1678}let m1_2099: bitstring = (OpenSecureChannelRequest,pkCli_1649,Nc_2098) in
                                                            {1679}out(c, (pkCli_1649,m1_2099));
                                                            {1680}in(c, em2_2100: bitstring);
                                                            {1681}let m2_2101: bitstring = em2_2100 in
                                                            {1682}let (=OpenSecureChannelResponse,Ns_2102: bitstring,ST_2103: bitstring,TTL_2104: bitstring) = m2_2101 in
                                                            {1683}let Kcli_2105: bitstring = h((Nc_2098,Ns_2102)) in
                                                            {1684}out(c, senc(mCli(pkCli_1649,pkSess_2095),Kcli_2105))
                                                    )
                                                    else
                                                        {1685}let pkSess_2106: bitstring = fail-any in
                                                        {1686}out(c, GetEndpointRequest);
                                                        {1687}in(c, (=GetEndpointResponse,=pkSess_2106,=None,SP_2107: bitstring,UP_2108: bitstring));
                                                        {1688}new Nc_2109: bitstring;
                                                        {1689}let m1_2110: bitstring = (OpenSecureChannelRequest,pkCli_1649,Nc_2109) in
                                                        {1690}out(c, (pkCli_1649,m1_2110));
                                                        {1691}in(c, em2_2111: bitstring);
                                                        {1692}let m2_2112: bitstring = em2_2111 in
                                                        {1693}let (=OpenSecureChannelResponse,Ns_2113: bitstring,ST_2114: bitstring,TTL_2115: bitstring) = m2_2112 in
                                                        {1694}let Kcli_2116: bitstring = h((Nc_2109,Ns_2113)) in
                                                        {1695}out(c, senc(mCli(pkCli_1649,pkSess_2106),Kcli_2116))
                                            )
                                            else
                                                {1696}let pkSess_2117: bitstring = fail-any in
                                                {1697}out(c, GetEndpointRequest);
                                                {1698}in(c, (=GetEndpointResponse,=pkSess_2117,=None,SP_2118: bitstring,UP_2119: bitstring));
                                                {1699}new Nc_2120: bitstring;
                                                {1700}let m1_2121: bitstring = (OpenSecureChannelRequest,pkCli_1649,Nc_2120) in
                                                {1701}out(c, (pkCli_1649,m1_2121));
                                                {1702}in(c, em2_2122: bitstring);
                                                {1703}let m2_2123: bitstring = em2_2122 in
                                                {1704}let (=OpenSecureChannelResponse,Ns_2124: bitstring,ST_2125: bitstring,TTL_2126: bitstring) = m2_2123 in
                                                {1705}let Kcli_2127: bitstring = h((Nc_2120,Ns_2124)) in
                                                {1706}out(c, senc(mCli(pkCli_1649,pkSess_2117),Kcli_2127))
                                    )
                                    else
                                        {1707}let pkSess_2128: bitstring = fail-any in
                                        {1708}out(c, GetEndpointRequest);
                                        {1709}in(c, (=GetEndpointResponse,=pkSess_2128,=None,SP_2129: bitstring,UP_2130: bitstring));
                                        {1710}new Nc_2131: bitstring;
                                        {1711}let m1_2132: bitstring = (OpenSecureChannelRequest,pkCli_1649,Nc_2131) in
                                        {1712}out(c, (pkCli_1649,m1_2132));
                                        {1713}in(c, em2_2133: bitstring);
                                        {1714}let m2_2134: bitstring = em2_2133 in
                                        {1715}let (=OpenSecureChannelResponse,Ns_2135: bitstring,ST_2136: bitstring,TTL_2137: bitstring) = m2_2134 in
                                        {1716}let Kcli_2138: bitstring = h((Nc_2131,Ns_2135)) in
                                        {1717}out(c, senc(mCli(pkCli_1649,pkSess_2128),Kcli_2138))
                        )
                        else
                            {1718}let pkDisco_2139: bitstring = fail-any in
                            {1719}let v_2140: bool = (Sess = A) in
                            (
                                {1720}if v_2140 then
                                (
                                    {1721}let pkSess_2141: bitstring = pub(skA) in
                                    {1722}out(c, GetEndpointRequest);
                                    {1723}in(c, (=GetEndpointResponse,=pkSess_2141,=None,SP_2142: bitstring,UP_2143: bitstring));
                                    {1724}new Nc_2144: bitstring;
                                    {1725}let m1_2145: bitstring = (OpenSecureChannelRequest,pkCli_1649,Nc_2144) in
                                    {1726}out(c, (pkCli_1649,m1_2145));
                                    {1727}in(c, em2_2146: bitstring);
                                    {1728}let m2_2147: bitstring = em2_2146 in
                                    {1729}let (=OpenSecureChannelResponse,Ns_2148: bitstring,ST_2149: bitstring,TTL_2150: bitstring) = m2_2147 in
                                    {1730}let Kcli_2151: bitstring = h((Nc_2144,Ns_2148)) in
                                    {1731}out(c, senc(mCli(pkCli_1649,pkSess_2141),Kcli_2151))
                                )
                                else
                                    {1732}let v_2152: bool = (Sess = B) in
                                    (
                                        {1733}if v_2152 then
                                        (
                                            {1734}let pkSess_2153: bitstring = pub(skB) in
                                            {1735}out(c, GetEndpointRequest);
                                            {1736}in(c, (=GetEndpointResponse,=pkSess_2153,=None,SP_2154: bitstring,UP_2155: bitstring));
                                            {1737}new Nc_2156: bitstring;
                                            {1738}let m1_2157: bitstring = (OpenSecureChannelRequest,pkCli_1649,Nc_2156) in
                                            {1739}out(c, (pkCli_1649,m1_2157));
                                            {1740}in(c, em2_2158: bitstring);
                                            {1741}let m2_2159: bitstring = em2_2158 in
                                            {1742}let (=OpenSecureChannelResponse,Ns_2160: bitstring,ST_2161: bitstring,TTL_2162: bitstring) = m2_2159 in
                                            {1743}let Kcli_2163: bitstring = h((Nc_2156,Ns_2160)) in
                                            {1744}out(c, senc(mCli(pkCli_1649,pkSess_2153),Kcli_2163))
                                        )
                                        else
                                            {1745}let v_2164: bool = (Sess = C) in
                                            (
                                                {1746}if v_2164 then
                                                (
                                                    {1747}let pkSess_2165: bitstring = pub(skC) in
                                                    {1748}out(c, GetEndpointRequest);
                                                    {1749}in(c, (=GetEndpointResponse,=pkSess_2165,=None,SP_2166: bitstring,UP_2167: bitstring));
                                                    {1750}new Nc_2168: bitstring;
                                                    {1751}let m1_2169: bitstring = (OpenSecureChannelRequest,pkCli_1649,Nc_2168) in
                                                    {1752}out(c, (pkCli_1649,m1_2169));
                                                    {1753}in(c, em2_2170: bitstring);
                                                    {1754}let m2_2171: bitstring = em2_2170 in
                                                    {1755}let (=OpenSecureChannelResponse,Ns_2172: bitstring,ST_2173: bitstring,TTL_2174: bitstring) = m2_2171 in
                                                    {1756}let Kcli_2175: bitstring = h((Nc_2168,Ns_2172)) in
                                                    {1757}out(c, senc(mCli(pkCli_1649,pkSess_2165),Kcli_2175))
                                                )
                                                else
                                                    {1758}let pkSess_2176: bitstring = pub(sk(Sess)) in
                                                    {1759}out(c, GetEndpointRequest);
                                                    {1760}in(c, (=GetEndpointResponse,=pkSess_2176,=None,SP_2177: bitstring,UP_2178: bitstring));
                                                    {1761}new Nc_2179: bitstring;
                                                    {1762}let m1_2180: bitstring = (OpenSecureChannelRequest,pkCli_1649,Nc_2179) in
                                                    {1763}out(c, (pkCli_1649,m1_2180));
                                                    {1764}in(c, em2_2181: bitstring);
                                                    {1765}let m2_2182: bitstring = em2_2181 in
                                                    {1766}let (=OpenSecureChannelResponse,Ns_2183: bitstring,ST_2184: bitstring,TTL_2185: bitstring) = m2_2182 in
                                                    {1767}let Kcli_2186: bitstring = h((Nc_2179,Ns_2183)) in
                                                    {1768}out(c, senc(mCli(pkCli_1649,pkSess_2176),Kcli_2186))
                                            )
                                            else
                                                {1769}let pkSess_2187: bitstring = fail-any in
                                                {1770}out(c, GetEndpointRequest);
                                                {1771}in(c, (=GetEndpointResponse,=pkSess_2187,=None,SP_2188: bitstring,UP_2189: bitstring));
                                                {1772}new Nc_2190: bitstring;
                                                {1773}let m1_2191: bitstring = (OpenSecureChannelRequest,pkCli_1649,Nc_2190) in
                                                {1774}out(c, (pkCli_1649,m1_2191));
                                                {1775}in(c, em2_2192: bitstring);
                                                {1776}let m2_2193: bitstring = em2_2192 in
                                                {1777}let (=OpenSecureChannelResponse,Ns_2194: bitstring,ST_2195: bitstring,TTL_2196: bitstring) = m2_2193 in
                                                {1778}let Kcli_2197: bitstring = h((Nc_2190,Ns_2194)) in
                                                {1779}out(c, senc(mCli(pkCli_1649,pkSess_2187),Kcli_2197))
                                    )
                                    else
                                        {1780}let pkSess_2198: bitstring = fail-any in
                                        {1781}out(c, GetEndpointRequest);
                                        {1782}in(c, (=GetEndpointResponse,=pkSess_2198,=None,SP_2199: bitstring,UP_2200: bitstring));
                                        {1783}new Nc_2201: bitstring;
                                        {1784}let m1_2202: bitstring = (OpenSecureChannelRequest,pkCli_1649,Nc_2201) in
                                        {1785}out(c, (pkCli_1649,m1_2202));
                                        {1786}in(c, em2_2203: bitstring);
                                        {1787}let m2_2204: bitstring = em2_2203 in
                                        {1788}let (=OpenSecureChannelResponse,Ns_2205: bitstring,ST_2206: bitstring,TTL_2207: bitstring) = m2_2204 in
                                        {1789}let Kcli_2208: bitstring = h((Nc_2201,Ns_2205)) in
                                        {1790}out(c, senc(mCli(pkCli_1649,pkSess_2198),Kcli_2208))
                            )
                            else
                                {1791}let pkSess_2209: bitstring = fail-any in
                                {1792}out(c, GetEndpointRequest);
                                {1793}in(c, (=GetEndpointResponse,=pkSess_2209,=None,SP_2210: bitstring,UP_2211: bitstring));
                                {1794}new Nc_2212: bitstring;
                                {1795}let m1_2213: bitstring = (OpenSecureChannelRequest,pkCli_1649,Nc_2212) in
                                {1796}out(c, (pkCli_1649,m1_2213));
                                {1797}in(c, em2_2214: bitstring);
                                {1798}let m2_2215: bitstring = em2_2214 in
                                {1799}let (=OpenSecureChannelResponse,Ns_2216: bitstring,ST_2217: bitstring,TTL_2218: bitstring) = m2_2215 in
                                {1800}let Kcli_2219: bitstring = h((Nc_2212,Ns_2216)) in
                                {1801}out(c, senc(mCli(pkCli_1649,pkSess_2209),Kcli_2219))
                    )
                    else
                        {1802}let skCli_2220: bitstring = fail-any in
                        {1803}let pkCli_2221: bitstring = pub(skCli_2220) in
                        {1804}let v_2222: bool = (Disco = A) in
                        (
                            {1805}if v_2222 then
                            (
                                {1806}let pkDisco_2223: bitstring = pub(skA) in
                                {1807}let v_2224: bool = (Sess = A) in
                                (
                                    {1808}if v_2224 then
                                    (
                                        {1809}let pkSess_2225: bitstring = pub(skA) in
                                        {1810}out(c, GetEndpointRequest);
                                        {1811}in(c, (=GetEndpointResponse,=pkSess_2225,=None,SP_2226: bitstring,UP_2227: bitstring));
                                        {1812}new Nc_2228: bitstring;
                                        {1813}let m1_2229: bitstring = (OpenSecureChannelRequest,pkCli_2221,Nc_2228) in
                                        {1814}out(c, (pkCli_2221,m1_2229));
                                        {1815}in(c, em2_2230: bitstring);
                                        {1816}let m2_2231: bitstring = em2_2230 in
                                        {1817}let (=OpenSecureChannelResponse,Ns_2232: bitstring,ST_2233: bitstring,TTL_2234: bitstring) = m2_2231 in
                                        {1818}let Kcli_2235: bitstring = h((Nc_2228,Ns_2232)) in
                                        {1819}out(c, senc(mCli(pkCli_2221,pkSess_2225),Kcli_2235))
                                    )
                                    else
                                        {1820}let v_2236: bool = (Sess = B) in
                                        (
                                            {1821}if v_2236 then
                                            (
                                                {1822}let pkSess_2237: bitstring = pub(skB) in
                                                {1823}out(c, GetEndpointRequest);
                                                {1824}in(c, (=GetEndpointResponse,=pkSess_2237,=None,SP_2238: bitstring,UP_2239: bitstring));
                                                {1825}new Nc_2240: bitstring;
                                                {1826}let m1_2241: bitstring = (OpenSecureChannelRequest,pkCli_2221,Nc_2240) in
                                                {1827}out(c, (pkCli_2221,m1_2241));
                                                {1828}in(c, em2_2242: bitstring);
                                                {1829}let m2_2243: bitstring = em2_2242 in
                                                {1830}let (=OpenSecureChannelResponse,Ns_2244: bitstring,ST_2245: bitstring,TTL_2246: bitstring) = m2_2243 in
                                                {1831}let Kcli_2247: bitstring = h((Nc_2240,Ns_2244)) in
                                                {1832}out(c, senc(mCli(pkCli_2221,pkSess_2237),Kcli_2247))
                                            )
                                            else
                                                {1833}let v_2248: bool = (Sess = C) in
                                                (
                                                    {1834}if v_2248 then
                                                    (
                                                        {1835}let pkSess_2249: bitstring = pub(skC) in
                                                        {1836}out(c, GetEndpointRequest);
                                                        {1837}in(c, (=GetEndpointResponse,=pkSess_2249,=None,SP_2250: bitstring,UP_2251: bitstring));
                                                        {1838}new Nc_2252: bitstring;
                                                        {1839}let m1_2253: bitstring = (OpenSecureChannelRequest,pkCli_2221,Nc_2252) in
                                                        {1840}out(c, (pkCli_2221,m1_2253));
                                                        {1841}in(c, em2_2254: bitstring);
                                                        {1842}let m2_2255: bitstring = em2_2254 in
                                                        {1843}let (=OpenSecureChannelResponse,Ns_2256: bitstring,ST_2257: bitstring,TTL_2258: bitstring) = m2_2255 in
                                                        {1844}let Kcli_2259: bitstring = h((Nc_2252,Ns_2256)) in
                                                        {1845}out(c, senc(mCli(pkCli_2221,pkSess_2249),Kcli_2259))
                                                    )
                                                    else
                                                        {1846}let pkSess_2260: bitstring = pub(sk(Sess)) in
                                                        {1847}out(c, GetEndpointRequest);
                                                        {1848}in(c, (=GetEndpointResponse,=pkSess_2260,=None,SP_2261: bitstring,UP_2262: bitstring));
                                                        {1849}new Nc_2263: bitstring;
                                                        {1850}let m1_2264: bitstring = (OpenSecureChannelRequest,pkCli_2221,Nc_2263) in
                                                        {1851}out(c, (pkCli_2221,m1_2264));
                                                        {1852}in(c, em2_2265: bitstring);
                                                        {1853}let m2_2266: bitstring = em2_2265 in
                                                        {1854}let (=OpenSecureChannelResponse,Ns_2267: bitstring,ST_2268: bitstring,TTL_2269: bitstring) = m2_2266 in
                                                        {1855}let Kcli_2270: bitstring = h((Nc_2263,Ns_2267)) in
                                                        {1856}out(c, senc(mCli(pkCli_2221,pkSess_2260),Kcli_2270))
                                                )
                                                else
                                                    {1857}let pkSess_2271: bitstring = fail-any in
                                                    {1858}out(c, GetEndpointRequest);
                                                    {1859}in(c, (=GetEndpointResponse,=pkSess_2271,=None,SP_2272: bitstring,UP_2273: bitstring));
                                                    {1860}new Nc_2274: bitstring;
                                                    {1861}let m1_2275: bitstring = (OpenSecureChannelRequest,pkCli_2221,Nc_2274) in
                                                    {1862}out(c, (pkCli_2221,m1_2275));
                                                    {1863}in(c, em2_2276: bitstring);
                                                    {1864}let m2_2277: bitstring = em2_2276 in
                                                    {1865}let (=OpenSecureChannelResponse,Ns_2278: bitstring,ST_2279: bitstring,TTL_2280: bitstring) = m2_2277 in
                                                    {1866}let Kcli_2281: bitstring = h((Nc_2274,Ns_2278)) in
                                                    {1867}out(c, senc(mCli(pkCli_2221,pkSess_2271),Kcli_2281))
                                        )
                                        else
                                            {1868}let pkSess_2282: bitstring = fail-any in
                                            {1869}out(c, GetEndpointRequest);
                                            {1870}in(c, (=GetEndpointResponse,=pkSess_2282,=None,SP_2283: bitstring,UP_2284: bitstring));
                                            {1871}new Nc_2285: bitstring;
                                            {1872}let m1_2286: bitstring = (OpenSecureChannelRequest,pkCli_2221,Nc_2285) in
                                            {1873}out(c, (pkCli_2221,m1_2286));
                                            {1874}in(c, em2_2287: bitstring);
                                            {1875}let m2_2288: bitstring = em2_2287 in
                                            {1876}let (=OpenSecureChannelResponse,Ns_2289: bitstring,ST_2290: bitstring,TTL_2291: bitstring) = m2_2288 in
                                            {1877}let Kcli_2292: bitstring = h((Nc_2285,Ns_2289)) in
                                            {1878}out(c, senc(mCli(pkCli_2221,pkSess_2282),Kcli_2292))
                                )
                                else
                                    {1879}let pkSess_2293: bitstring = fail-any in
                                    {1880}out(c, GetEndpointRequest);
                                    {1881}in(c, (=GetEndpointResponse,=pkSess_2293,=None,SP_2294: bitstring,UP_2295: bitstring));
                                    {1882}new Nc_2296: bitstring;
                                    {1883}let m1_2297: bitstring = (OpenSecureChannelRequest,pkCli_2221,Nc_2296) in
                                    {1884}out(c, (pkCli_2221,m1_2297));
                                    {1885}in(c, em2_2298: bitstring);
                                    {1886}let m2_2299: bitstring = em2_2298 in
                                    {1887}let (=OpenSecureChannelResponse,Ns_2300: bitstring,ST_2301: bitstring,TTL_2302: bitstring) = m2_2299 in
                                    {1888}let Kcli_2303: bitstring = h((Nc_2296,Ns_2300)) in
                                    {1889}out(c, senc(mCli(pkCli_2221,pkSess_2293),Kcli_2303))
                            )
                            else
                                {1890}let v_2304: bool = (Disco = B) in
                                (
                                    {1891}if v_2304 then
                                    (
                                        {1892}let pkDisco_2305: bitstring = pub(skB) in
                                        {1893}let v_2306: bool = (Sess = A) in
                                        (
                                            {1894}if v_2306 then
                                            (
                                                {1895}let pkSess_2307: bitstring = pub(skA) in
                                                {1896}out(c, GetEndpointRequest);
                                                {1897}in(c, (=GetEndpointResponse,=pkSess_2307,=None,SP_2308: bitstring,UP_2309: bitstring));
                                                {1898}new Nc_2310: bitstring;
                                                {1899}let m1_2311: bitstring = (OpenSecureChannelRequest,pkCli_2221,Nc_2310) in
                                                {1900}out(c, (pkCli_2221,m1_2311));
                                                {1901}in(c, em2_2312: bitstring);
                                                {1902}let m2_2313: bitstring = em2_2312 in
                                                {1903}let (=OpenSecureChannelResponse,Ns_2314: bitstring,ST_2315: bitstring,TTL_2316: bitstring) = m2_2313 in
                                                {1904}let Kcli_2317: bitstring = h((Nc_2310,Ns_2314)) in
                                                {1905}out(c, senc(mCli(pkCli_2221,pkSess_2307),Kcli_2317))
                                            )
                                            else
                                                {1906}let v_2318: bool = (Sess = B) in
                                                (
                                                    {1907}if v_2318 then
                                                    (
                                                        {1908}let pkSess_2319: bitstring = pub(skB) in
                                                        {1909}out(c, GetEndpointRequest);
                                                        {1910}in(c, (=GetEndpointResponse,=pkSess_2319,=None,SP_2320: bitstring,UP_2321: bitstring));
                                                        {1911}new Nc_2322: bitstring;
                                                        {1912}let m1_2323: bitstring = (OpenSecureChannelRequest,pkCli_2221,Nc_2322) in
                                                        {1913}out(c, (pkCli_2221,m1_2323));
                                                        {1914}in(c, em2_2324: bitstring);
                                                        {1915}let m2_2325: bitstring = em2_2324 in
                                                        {1916}let (=OpenSecureChannelResponse,Ns_2326: bitstring,ST_2327: bitstring,TTL_2328: bitstring) = m2_2325 in
                                                        {1917}let Kcli_2329: bitstring = h((Nc_2322,Ns_2326)) in
                                                        {1918}out(c, senc(mCli(pkCli_2221,pkSess_2319),Kcli_2329))
                                                    )
                                                    else
                                                        {1919}let v_2330: bool = (Sess = C) in
                                                        (
                                                            {1920}if v_2330 then
                                                            (
                                                                {1921}let pkSess_2331: bitstring = pub(skC) in
                                                                {1922}out(c, GetEndpointRequest);
                                                                {1923}in(c, (=GetEndpointResponse,=pkSess_2331,=None,SP_2332: bitstring,UP_2333: bitstring));
                                                                {1924}new Nc_2334: bitstring;
                                                                {1925}let m1_2335: bitstring = (OpenSecureChannelRequest,pkCli_2221,Nc_2334) in
                                                                {1926}out(c, (pkCli_2221,m1_2335));
                                                                {1927}in(c, em2_2336: bitstring);
                                                                {1928}let m2_2337: bitstring = em2_2336 in
                                                                {1929}let (=OpenSecureChannelResponse,Ns_2338: bitstring,ST_2339: bitstring,TTL_2340: bitstring) = m2_2337 in
                                                                {1930}let Kcli_2341: bitstring = h((Nc_2334,Ns_2338)) in
                                                                {1931}out(c, senc(mCli(pkCli_2221,pkSess_2331),Kcli_2341))
                                                            )
                                                            else
                                                                {1932}let pkSess_2342: bitstring = pub(sk(Sess)) in
                                                                {1933}out(c, GetEndpointRequest);
                                                                {1934}in(c, (=GetEndpointResponse,=pkSess_2342,=None,SP_2343: bitstring,UP_2344: bitstring));
                                                                {1935}new Nc_2345: bitstring;
                                                                {1936}let m1_2346: bitstring = (OpenSecureChannelRequest,pkCli_2221,Nc_2345) in
                                                                {1937}out(c, (pkCli_2221,m1_2346));
                                                                {1938}in(c, em2_2347: bitstring);
                                                                {1939}let m2_2348: bitstring = em2_2347 in
                                                                {1940}let (=OpenSecureChannelResponse,Ns_2349: bitstring,ST_2350: bitstring,TTL_2351: bitstring) = m2_2348 in
                                                                {1941}let Kcli_2352: bitstring = h((Nc_2345,Ns_2349)) in
                                                                {1942}out(c, senc(mCli(pkCli_2221,pkSess_2342),Kcli_2352))
                                                        )
                                                        else
                                                            {1943}let pkSess_2353: bitstring = fail-any in
                                                            {1944}out(c, GetEndpointRequest);
                                                            {1945}in(c, (=GetEndpointResponse,=pkSess_2353,=None,SP_2354: bitstring,UP_2355: bitstring));
                                                            {1946}new Nc_2356: bitstring;
                                                            {1947}let m1_2357: bitstring = (OpenSecureChannelRequest,pkCli_2221,Nc_2356) in
                                                            {1948}out(c, (pkCli_2221,m1_2357));
                                                            {1949}in(c, em2_2358: bitstring);
                                                            {1950}let m2_2359: bitstring = em2_2358 in
                                                            {1951}let (=OpenSecureChannelResponse,Ns_2360: bitstring,ST_2361: bitstring,TTL_2362: bitstring) = m2_2359 in
                                                            {1952}let Kcli_2363: bitstring = h((Nc_2356,Ns_2360)) in
                                                            {1953}out(c, senc(mCli(pkCli_2221,pkSess_2353),Kcli_2363))
                                                )
                                                else
                                                    {1954}let pkSess_2364: bitstring = fail-any in
                                                    {1955}out(c, GetEndpointRequest);
                                                    {1956}in(c, (=GetEndpointResponse,=pkSess_2364,=None,SP_2365: bitstring,UP_2366: bitstring));
                                                    {1957}new Nc_2367: bitstring;
                                                    {1958}let m1_2368: bitstring = (OpenSecureChannelRequest,pkCli_2221,Nc_2367) in
                                                    {1959}out(c, (pkCli_2221,m1_2368));
                                                    {1960}in(c, em2_2369: bitstring);
                                                    {1961}let m2_2370: bitstring = em2_2369 in
                                                    {1962}let (=OpenSecureChannelResponse,Ns_2371: bitstring,ST_2372: bitstring,TTL_2373: bitstring) = m2_2370 in
                                                    {1963}let Kcli_2374: bitstring = h((Nc_2367,Ns_2371)) in
                                                    {1964}out(c, senc(mCli(pkCli_2221,pkSess_2364),Kcli_2374))
                                        )
                                        else
                                            {1965}let pkSess_2375: bitstring = fail-any in
                                            {1966}out(c, GetEndpointRequest);
                                            {1967}in(c, (=GetEndpointResponse,=pkSess_2375,=None,SP_2376: bitstring,UP_2377: bitstring));
                                            {1968}new Nc_2378: bitstring;
                                            {1969}let m1_2379: bitstring = (OpenSecureChannelRequest,pkCli_2221,Nc_2378) in
                                            {1970}out(c, (pkCli_2221,m1_2379));
                                            {1971}in(c, em2_2380: bitstring);
                                            {1972}let m2_2381: bitstring = em2_2380 in
                                            {1973}let (=OpenSecureChannelResponse,Ns_2382: bitstring,ST_2383: bitstring,TTL_2384: bitstring) = m2_2381 in
                                            {1974}let Kcli_2385: bitstring = h((Nc_2378,Ns_2382)) in
                                            {1975}out(c, senc(mCli(pkCli_2221,pkSess_2375),Kcli_2385))
                                    )
                                    else
                                        {1976}let v_2386: bool = (Disco = C) in
                                        (
                                            {1977}if v_2386 then
                                            (
                                                {1978}let pkDisco_2387: bitstring = pub(skC) in
                                                {1979}let v_2388: bool = (Sess = A) in
                                                (
                                                    {1980}if v_2388 then
                                                    (
                                                        {1981}let pkSess_2389: bitstring = pub(skA) in
                                                        {1982}out(c, GetEndpointRequest);
                                                        {1983}in(c, (=GetEndpointResponse,=pkSess_2389,=None,SP_2390: bitstring,UP_2391: bitstring));
                                                        {1984}new Nc_2392: bitstring;
                                                        {1985}let m1_2393: bitstring = (OpenSecureChannelRequest,pkCli_2221,Nc_2392) in
                                                        {1986}out(c, (pkCli_2221,m1_2393));
                                                        {1987}in(c, em2_2394: bitstring);
                                                        {1988}let m2_2395: bitstring = em2_2394 in
                                                        {1989}let (=OpenSecureChannelResponse,Ns_2396: bitstring,ST_2397: bitstring,TTL_2398: bitstring) = m2_2395 in
                                                        {1990}let Kcli_2399: bitstring = h((Nc_2392,Ns_2396)) in
                                                        {1991}out(c, senc(mCli(pkCli_2221,pkSess_2389),Kcli_2399))
                                                    )
                                                    else
                                                        {1992}let v_2400: bool = (Sess = B) in
                                                        (
                                                            {1993}if v_2400 then
                                                            (
                                                                {1994}let pkSess_2401: bitstring = pub(skB) in
                                                                {1995}out(c, GetEndpointRequest);
                                                                {1996}in(c, (=GetEndpointResponse,=pkSess_2401,=None,SP_2402: bitstring,UP_2403: bitstring));
                                                                {1997}new Nc_2404: bitstring;
                                                                {1998}let m1_2405: bitstring = (OpenSecureChannelRequest,pkCli_2221,Nc_2404) in
                                                                {1999}out(c, (pkCli_2221,m1_2405));
                                                                {2000}in(c, em2_2406: bitstring);
                                                                {2001}let m2_2407: bitstring = em2_2406 in
                                                                {2002}let (=OpenSecureChannelResponse,Ns_2408: bitstring,ST_2409: bitstring,TTL_2410: bitstring) = m2_2407 in
                                                                {2003}let Kcli_2411: bitstring = h((Nc_2404,Ns_2408)) in
                                                                {2004}out(c, senc(mCli(pkCli_2221,pkSess_2401),Kcli_2411))
                                                            )
                                                            else
                                                                {2005}let v_2412: bool = (Sess = C) in
                                                                (
                                                                    {2006}if v_2412 then
                                                                    (
                                                                        {2007}let pkSess_2413: bitstring = pub(skC) in
                                                                        {2008}out(c, GetEndpointRequest);
                                                                        {2009}in(c, (=GetEndpointResponse,=pkSess_2413,=None,SP_2414: bitstring,UP_2415: bitstring));
                                                                        {2010}new Nc_2416: bitstring;
                                                                        {2011}let m1_2417: bitstring = (OpenSecureChannelRequest,pkCli_2221,Nc_2416) in
                                                                        {2012}out(c, (pkCli_2221,m1_2417));
                                                                        {2013}in(c, em2_2418: bitstring);
                                                                        {2014}let m2_2419: bitstring = em2_2418 in
                                                                        {2015}let (=OpenSecureChannelResponse,Ns_2420: bitstring,ST_2421: bitstring,TTL_2422: bitstring) = m2_2419 in
                                                                        {2016}let Kcli_2423: bitstring = h((Nc_2416,Ns_2420)) in
                                                                        {2017}out(c, senc(mCli(pkCli_2221,pkSess_2413),Kcli_2423))
                                                                    )
                                                                    else
                                                                        {2018}let pkSess_2424: bitstring = pub(sk(Sess)) in
                                                                        {2019}out(c, GetEndpointRequest);
                                                                        {2020}in(c, (=GetEndpointResponse,=pkSess_2424,=None,SP_2425: bitstring,UP_2426: bitstring));
                                                                        {2021}new Nc_2427: bitstring;
                                                                        {2022}let m1_2428: bitstring = (OpenSecureChannelRequest,pkCli_2221,Nc_2427) in
                                                                        {2023}out(c, (pkCli_2221,m1_2428));
                                                                        {2024}in(c, em2_2429: bitstring);
                                                                        {2025}let m2_2430: bitstring = em2_2429 in
                                                                        {2026}let (=OpenSecureChannelResponse,Ns_2431: bitstring,ST_2432: bitstring,TTL_2433: bitstring) = m2_2430 in
                                                                        {2027}let Kcli_2434: bitstring = h((Nc_2427,Ns_2431)) in
                                                                        {2028}out(c, senc(mCli(pkCli_2221,pkSess_2424),Kcli_2434))
                                                                )
                                                                else
                                                                    {2029}let pkSess_2435: bitstring = fail-any in
                                                                    {2030}out(c, GetEndpointRequest);
                                                                    {2031}in(c, (=GetEndpointResponse,=pkSess_2435,=None,SP_2436: bitstring,UP_2437: bitstring));
                                                                    {2032}new Nc_2438: bitstring;
                                                                    {2033}let m1_2439: bitstring = (OpenSecureChannelRequest,pkCli_2221,Nc_2438) in
                                                                    {2034}out(c, (pkCli_2221,m1_2439));
                                                                    {2035}in(c, em2_2440: bitstring);
                                                                    {2036}let m2_2441: bitstring = em2_2440 in
                                                                    {2037}let (=OpenSecureChannelResponse,Ns_2442: bitstring,ST_2443: bitstring,TTL_2444: bitstring) = m2_2441 in
                                                                    {2038}let Kcli_2445: bitstring = h((Nc_2438,Ns_2442)) in
                                                                    {2039}out(c, senc(mCli(pkCli_2221,pkSess_2435),Kcli_2445))
                                                        )
                                                        else
                                                            {2040}let pkSess_2446: bitstring = fail-any in
                                                            {2041}out(c, GetEndpointRequest);
                                                            {2042}in(c, (=GetEndpointResponse,=pkSess_2446,=None,SP_2447: bitstring,UP_2448: bitstring));
                                                            {2043}new Nc_2449: bitstring;
                                                            {2044}let m1_2450: bitstring = (OpenSecureChannelRequest,pkCli_2221,Nc_2449) in
                                                            {2045}out(c, (pkCli_2221,m1_2450));
                                                            {2046}in(c, em2_2451: bitstring);
                                                            {2047}let m2_2452: bitstring = em2_2451 in
                                                            {2048}let (=OpenSecureChannelResponse,Ns_2453: bitstring,ST_2454: bitstring,TTL_2455: bitstring) = m2_2452 in
                                                            {2049}let Kcli_2456: bitstring = h((Nc_2449,Ns_2453)) in
                                                            {2050}out(c, senc(mCli(pkCli_2221,pkSess_2446),Kcli_2456))
                                                )
                                                else
                                                    {2051}let pkSess_2457: bitstring = fail-any in
                                                    {2052}out(c, GetEndpointRequest);
                                                    {2053}in(c, (=GetEndpointResponse,=pkSess_2457,=None,SP_2458: bitstring,UP_2459: bitstring));
                                                    {2054}new Nc_2460: bitstring;
                                                    {2055}let m1_2461: bitstring = (OpenSecureChannelRequest,pkCli_2221,Nc_2460) in
                                                    {2056}out(c, (pkCli_2221,m1_2461));
                                                    {2057}in(c, em2_2462: bitstring);
                                                    {2058}let m2_2463: bitstring = em2_2462 in
                                                    {2059}let (=OpenSecureChannelResponse,Ns_2464: bitstring,ST_2465: bitstring,TTL_2466: bitstring) = m2_2463 in
                                                    {2060}let Kcli_2467: bitstring = h((Nc_2460,Ns_2464)) in
                                                    {2061}out(c, senc(mCli(pkCli_2221,pkSess_2457),Kcli_2467))
                                            )
                                            else
                                                {2062}let pkDisco_2468: bitstring = pub(sk(Disco)) in
                                                {2063}let v_2469: bool = (Sess = A) in
                                                (
                                                    {2064}if v_2469 then
                                                    (
                                                        {2065}let pkSess_2470: bitstring = pub(skA) in
                                                        {2066}out(c, GetEndpointRequest);
                                                        {2067}in(c, (=GetEndpointResponse,=pkSess_2470,=None,SP_2471: bitstring,UP_2472: bitstring));
                                                        {2068}new Nc_2473: bitstring;
                                                        {2069}let m1_2474: bitstring = (OpenSecureChannelRequest,pkCli_2221,Nc_2473) in
                                                        {2070}out(c, (pkCli_2221,m1_2474));
                                                        {2071}in(c, em2_2475: bitstring);
                                                        {2072}let m2_2476: bitstring = em2_2475 in
                                                        {2073}let (=OpenSecureChannelResponse,Ns_2477: bitstring,ST_2478: bitstring,TTL_2479: bitstring) = m2_2476 in
                                                        {2074}let Kcli_2480: bitstring = h((Nc_2473,Ns_2477)) in
                                                        {2075}out(c, senc(mCli(pkCli_2221,pkSess_2470),Kcli_2480))
                                                    )
                                                    else
                                                        {2076}let v_2481: bool = (Sess = B) in
                                                        (
                                                            {2077}if v_2481 then
                                                            (
                                                                {2078}let pkSess_2482: bitstring = pub(skB) in
                                                                {2079}out(c, GetEndpointRequest);
                                                                {2080}in(c, (=GetEndpointResponse,=pkSess_2482,=None,SP_2483: bitstring,UP_2484: bitstring));
                                                                {2081}new Nc_2485: bitstring;
                                                                {2082}let m1_2486: bitstring = (OpenSecureChannelRequest,pkCli_2221,Nc_2485) in
                                                                {2083}out(c, (pkCli_2221,m1_2486));
                                                                {2084}in(c, em2_2487: bitstring);
                                                                {2085}let m2_2488: bitstring = em2_2487 in
                                                                {2086}let (=OpenSecureChannelResponse,Ns_2489: bitstring,ST_2490: bitstring,TTL_2491: bitstring) = m2_2488 in
                                                                {2087}let Kcli_2492: bitstring = h((Nc_2485,Ns_2489)) in
                                                                {2088}out(c, senc(mCli(pkCli_2221,pkSess_2482),Kcli_2492))
                                                            )
                                                            else
                                                                {2089}let v_2493: bool = (Sess = C) in
                                                                (
                                                                    {2090}if v_2493 then
                                                                    (
                                                                        {2091}let pkSess_2494: bitstring = pub(skC) in
                                                                        {2092}out(c, GetEndpointRequest);
                                                                        {2093}in(c, (=GetEndpointResponse,=pkSess_2494,=None,SP_2495: bitstring,UP_2496: bitstring));
                                                                        {2094}new Nc_2497: bitstring;
                                                                        {2095}let m1_2498: bitstring = (OpenSecureChannelRequest,pkCli_2221,Nc_2497) in
                                                                        {2096}out(c, (pkCli_2221,m1_2498));
                                                                        {2097}in(c, em2_2499: bitstring);
                                                                        {2098}let m2_2500: bitstring = em2_2499 in
                                                                        {2099}let (=OpenSecureChannelResponse,Ns_2501: bitstring,ST_2502: bitstring,TTL_2503: bitstring) = m2_2500 in
                                                                        {2100}let Kcli_2504: bitstring = h((Nc_2497,Ns_2501)) in
                                                                        {2101}out(c, senc(mCli(pkCli_2221,pkSess_2494),Kcli_2504))
                                                                    )
                                                                    else
                                                                        {2102}let pkSess_2505: bitstring = pub(sk(Sess)) in
                                                                        {2103}out(c, GetEndpointRequest);
                                                                        {2104}in(c, (=GetEndpointResponse,=pkSess_2505,=None,SP_2506: bitstring,UP_2507: bitstring));
                                                                        {2105}new Nc_2508: bitstring;
                                                                        {2106}let m1_2509: bitstring = (OpenSecureChannelRequest,pkCli_2221,Nc_2508) in
                                                                        {2107}out(c, (pkCli_2221,m1_2509));
                                                                        {2108}in(c, em2_2510: bitstring);
                                                                        {2109}let m2_2511: bitstring = em2_2510 in
                                                                        {2110}let (=OpenSecureChannelResponse,Ns_2512: bitstring,ST_2513: bitstring,TTL_2514: bitstring) = m2_2511 in
                                                                        {2111}let Kcli_2515: bitstring = h((Nc_2508,Ns_2512)) in
                                                                        {2112}out(c, senc(mCli(pkCli_2221,pkSess_2505),Kcli_2515))
                                                                )
                                                                else
                                                                    {2113}let pkSess_2516: bitstring = fail-any in
                                                                    {2114}out(c, GetEndpointRequest);
                                                                    {2115}in(c, (=GetEndpointResponse,=pkSess_2516,=None,SP_2517: bitstring,UP_2518: bitstring));
                                                                    {2116}new Nc_2519: bitstring;
                                                                    {2117}let m1_2520: bitstring = (OpenSecureChannelRequest,pkCli_2221,Nc_2519) in
                                                                    {2118}out(c, (pkCli_2221,m1_2520));
                                                                    {2119}in(c, em2_2521: bitstring);
                                                                    {2120}let m2_2522: bitstring = em2_2521 in
                                                                    {2121}let (=OpenSecureChannelResponse,Ns_2523: bitstring,ST_2524: bitstring,TTL_2525: bitstring) = m2_2522 in
                                                                    {2122}let Kcli_2526: bitstring = h((Nc_2519,Ns_2523)) in
                                                                    {2123}out(c, senc(mCli(pkCli_2221,pkSess_2516),Kcli_2526))
                                                        )
                                                        else
                                                            {2124}let pkSess_2527: bitstring = fail-any in
                                                            {2125}out(c, GetEndpointRequest);
                                                            {2126}in(c, (=GetEndpointResponse,=pkSess_2527,=None,SP_2528: bitstring,UP_2529: bitstring));
                                                            {2127}new Nc_2530: bitstring;
                                                            {2128}let m1_2531: bitstring = (OpenSecureChannelRequest,pkCli_2221,Nc_2530) in
                                                            {2129}out(c, (pkCli_2221,m1_2531));
                                                            {2130}in(c, em2_2532: bitstring);
                                                            {2131}let m2_2533: bitstring = em2_2532 in
                                                            {2132}let (=OpenSecureChannelResponse,Ns_2534: bitstring,ST_2535: bitstring,TTL_2536: bitstring) = m2_2533 in
                                                            {2133}let Kcli_2537: bitstring = h((Nc_2530,Ns_2534)) in
                                                            {2134}out(c, senc(mCli(pkCli_2221,pkSess_2527),Kcli_2537))
                                                )
                                                else
                                                    {2135}let pkSess_2538: bitstring = fail-any in
                                                    {2136}out(c, GetEndpointRequest);
                                                    {2137}in(c, (=GetEndpointResponse,=pkSess_2538,=None,SP_2539: bitstring,UP_2540: bitstring));
                                                    {2138}new Nc_2541: bitstring;
                                                    {2139}let m1_2542: bitstring = (OpenSecureChannelRequest,pkCli_2221,Nc_2541) in
                                                    {2140}out(c, (pkCli_2221,m1_2542));
                                                    {2141}in(c, em2_2543: bitstring);
                                                    {2142}let m2_2544: bitstring = em2_2543 in
                                                    {2143}let (=OpenSecureChannelResponse,Ns_2545: bitstring,ST_2546: bitstring,TTL_2547: bitstring) = m2_2544 in
                                                    {2144}let Kcli_2548: bitstring = h((Nc_2541,Ns_2545)) in
                                                    {2145}out(c, senc(mCli(pkCli_2221,pkSess_2538),Kcli_2548))
                                        )
                                        else
                                            {2146}let pkDisco_2549: bitstring = fail-any in
                                            {2147}let v_2550: bool = (Sess = A) in
                                            (
                                                {2148}if v_2550 then
                                                (
                                                    {2149}let pkSess_2551: bitstring = pub(skA) in
                                                    {2150}out(c, GetEndpointRequest);
                                                    {2151}in(c, (=GetEndpointResponse,=pkSess_2551,=None,SP_2552: bitstring,UP_2553: bitstring));
                                                    {2152}new Nc_2554: bitstring;
                                                    {2153}let m1_2555: bitstring = (OpenSecureChannelRequest,pkCli_2221,Nc_2554) in
                                                    {2154}out(c, (pkCli_2221,m1_2555));
                                                    {2155}in(c, em2_2556: bitstring);
                                                    {2156}let m2_2557: bitstring = em2_2556 in
                                                    {2157}let (=OpenSecureChannelResponse,Ns_2558: bitstring,ST_2559: bitstring,TTL_2560: bitstring) = m2_2557 in
                                                    {2158}let Kcli_2561: bitstring = h((Nc_2554,Ns_2558)) in
                                                    {2159}out(c, senc(mCli(pkCli_2221,pkSess_2551),Kcli_2561))
                                                )
                                                else
                                                    {2160}let v_2562: bool = (Sess = B) in
                                                    (
                                                        {2161}if v_2562 then
                                                        (
                                                            {2162}let pkSess_2563: bitstring = pub(skB) in
                                                            {2163}out(c, GetEndpointRequest);
                                                            {2164}in(c, (=GetEndpointResponse,=pkSess_2563,=None,SP_2564: bitstring,UP_2565: bitstring));
                                                            {2165}new Nc_2566: bitstring;
                                                            {2166}let m1_2567: bitstring = (OpenSecureChannelRequest,pkCli_2221,Nc_2566) in
                                                            {2167}out(c, (pkCli_2221,m1_2567));
                                                            {2168}in(c, em2_2568: bitstring);
                                                            {2169}let m2_2569: bitstring = em2_2568 in
                                                            {2170}let (=OpenSecureChannelResponse,Ns_2570: bitstring,ST_2571: bitstring,TTL_2572: bitstring) = m2_2569 in
                                                            {2171}let Kcli_2573: bitstring = h((Nc_2566,Ns_2570)) in
                                                            {2172}out(c, senc(mCli(pkCli_2221,pkSess_2563),Kcli_2573))
                                                        )
                                                        else
                                                            {2173}let v_2574: bool = (Sess = C) in
                                                            (
                                                                {2174}if v_2574 then
                                                                (
                                                                    {2175}let pkSess_2575: bitstring = pub(skC) in
                                                                    {2176}out(c, GetEndpointRequest);
                                                                    {2177}in(c, (=GetEndpointResponse,=pkSess_2575,=None,SP_2576: bitstring,UP_2577: bitstring));
                                                                    {2178}new Nc_2578: bitstring;
                                                                    {2179}let m1_2579: bitstring = (OpenSecureChannelRequest,pkCli_2221,Nc_2578) in
                                                                    {2180}out(c, (pkCli_2221,m1_2579));
                                                                    {2181}in(c, em2_2580: bitstring);
                                                                    {2182}let m2_2581: bitstring = em2_2580 in
                                                                    {2183}let (=OpenSecureChannelResponse,Ns_2582: bitstring,ST_2583: bitstring,TTL_2584: bitstring) = m2_2581 in
                                                                    {2184}let Kcli_2585: bitstring = h((Nc_2578,Ns_2582)) in
                                                                    {2185}out(c, senc(mCli(pkCli_2221,pkSess_2575),Kcli_2585))
                                                                )
                                                                else
                                                                    {2186}let pkSess_2586: bitstring = pub(sk(Sess)) in
                                                                    {2187}out(c, GetEndpointRequest);
                                                                    {2188}in(c, (=GetEndpointResponse,=pkSess_2586,=None,SP_2587: bitstring,UP_2588: bitstring));
                                                                    {2189}new Nc_2589: bitstring;
                                                                    {2190}let m1_2590: bitstring = (OpenSecureChannelRequest,pkCli_2221,Nc_2589) in
                                                                    {2191}out(c, (pkCli_2221,m1_2590));
                                                                    {2192}in(c, em2_2591: bitstring);
                                                                    {2193}let m2_2592: bitstring = em2_2591 in
                                                                    {2194}let (=OpenSecureChannelResponse,Ns_2593: bitstring,ST_2594: bitstring,TTL_2595: bitstring) = m2_2592 in
                                                                    {2195}let Kcli_2596: bitstring = h((Nc_2589,Ns_2593)) in
                                                                    {2196}out(c, senc(mCli(pkCli_2221,pkSess_2586),Kcli_2596))
                                                            )
                                                            else
                                                                {2197}let pkSess_2597: bitstring = fail-any in
                                                                {2198}out(c, GetEndpointRequest);
                                                                {2199}in(c, (=GetEndpointResponse,=pkSess_2597,=None,SP_2598: bitstring,UP_2599: bitstring));
                                                                {2200}new Nc_2600: bitstring;
                                                                {2201}let m1_2601: bitstring = (OpenSecureChannelRequest,pkCli_2221,Nc_2600) in
                                                                {2202}out(c, (pkCli_2221,m1_2601));
                                                                {2203}in(c, em2_2602: bitstring);
                                                                {2204}let m2_2603: bitstring = em2_2602 in
                                                                {2205}let (=OpenSecureChannelResponse,Ns_2604: bitstring,ST_2605: bitstring,TTL_2606: bitstring) = m2_2603 in
                                                                {2206}let Kcli_2607: bitstring = h((Nc_2600,Ns_2604)) in
                                                                {2207}out(c, senc(mCli(pkCli_2221,pkSess_2597),Kcli_2607))
                                                    )
                                                    else
                                                        {2208}let pkSess_2608: bitstring = fail-any in
                                                        {2209}out(c, GetEndpointRequest);
                                                        {2210}in(c, (=GetEndpointResponse,=pkSess_2608,=None,SP_2609: bitstring,UP_2610: bitstring));
                                                        {2211}new Nc_2611: bitstring;
                                                        {2212}let m1_2612: bitstring = (OpenSecureChannelRequest,pkCli_2221,Nc_2611) in
                                                        {2213}out(c, (pkCli_2221,m1_2612));
                                                        {2214}in(c, em2_2613: bitstring);
                                                        {2215}let m2_2614: bitstring = em2_2613 in
                                                        {2216}let (=OpenSecureChannelResponse,Ns_2615: bitstring,ST_2616: bitstring,TTL_2617: bitstring) = m2_2614 in
                                                        {2217}let Kcli_2618: bitstring = h((Nc_2611,Ns_2615)) in
                                                        {2218}out(c, senc(mCli(pkCli_2221,pkSess_2608),Kcli_2618))
                                            )
                                            else
                                                {2219}let pkSess_2619: bitstring = fail-any in
                                                {2220}out(c, GetEndpointRequest);
                                                {2221}in(c, (=GetEndpointResponse,=pkSess_2619,=None,SP_2620: bitstring,UP_2621: bitstring));
                                                {2222}new Nc_2622: bitstring;
                                                {2223}let m1_2623: bitstring = (OpenSecureChannelRequest,pkCli_2221,Nc_2622) in
                                                {2224}out(c, (pkCli_2221,m1_2623));
                                                {2225}in(c, em2_2624: bitstring);
                                                {2226}let m2_2625: bitstring = em2_2624 in
                                                {2227}let (=OpenSecureChannelResponse,Ns_2626: bitstring,ST_2627: bitstring,TTL_2628: bitstring) = m2_2625 in
                                                {2228}let Kcli_2629: bitstring = h((Nc_2622,Ns_2626)) in
                                                {2229}out(c, senc(mCli(pkCli_2221,pkSess_2619),Kcli_2629))
                                )
                                else
                                    {2230}let pkDisco_2630: bitstring = fail-any in
                                    {2231}let v_2631: bool = (Sess = A) in
                                    (
                                        {2232}if v_2631 then
                                        (
                                            {2233}let pkSess_2632: bitstring = pub(skA) in
                                            {2234}out(c, GetEndpointRequest);
                                            {2235}in(c, (=GetEndpointResponse,=pkSess_2632,=None,SP_2633: bitstring,UP_2634: bitstring));
                                            {2236}new Nc_2635: bitstring;
                                            {2237}let m1_2636: bitstring = (OpenSecureChannelRequest,pkCli_2221,Nc_2635) in
                                            {2238}out(c, (pkCli_2221,m1_2636));
                                            {2239}in(c, em2_2637: bitstring);
                                            {2240}let m2_2638: bitstring = em2_2637 in
                                            {2241}let (=OpenSecureChannelResponse,Ns_2639: bitstring,ST_2640: bitstring,TTL_2641: bitstring) = m2_2638 in
                                            {2242}let Kcli_2642: bitstring = h((Nc_2635,Ns_2639)) in
                                            {2243}out(c, senc(mCli(pkCli_2221,pkSess_2632),Kcli_2642))
                                        )
                                        else
                                            {2244}let v_2643: bool = (Sess = B) in
                                            (
                                                {2245}if v_2643 then
                                                (
                                                    {2246}let pkSess_2644: bitstring = pub(skB) in
                                                    {2247}out(c, GetEndpointRequest);
                                                    {2248}in(c, (=GetEndpointResponse,=pkSess_2644,=None,SP_2645: bitstring,UP_2646: bitstring));
                                                    {2249}new Nc_2647: bitstring;
                                                    {2250}let m1_2648: bitstring = (OpenSecureChannelRequest,pkCli_2221,Nc_2647) in
                                                    {2251}out(c, (pkCli_2221,m1_2648));
                                                    {2252}in(c, em2_2649: bitstring);
                                                    {2253}let m2_2650: bitstring = em2_2649 in
                                                    {2254}let (=OpenSecureChannelResponse,Ns_2651: bitstring,ST_2652: bitstring,TTL_2653: bitstring) = m2_2650 in
                                                    {2255}let Kcli_2654: bitstring = h((Nc_2647,Ns_2651)) in
                                                    {2256}out(c, senc(mCli(pkCli_2221,pkSess_2644),Kcli_2654))
                                                )
                                                else
                                                    {2257}let v_2655: bool = (Sess = C) in
                                                    (
                                                        {2258}if v_2655 then
                                                        (
                                                            {2259}let pkSess_2656: bitstring = pub(skC) in
                                                            {2260}out(c, GetEndpointRequest);
                                                            {2261}in(c, (=GetEndpointResponse,=pkSess_2656,=None,SP_2657: bitstring,UP_2658: bitstring));
                                                            {2262}new Nc_2659: bitstring;
                                                            {2263}let m1_2660: bitstring = (OpenSecureChannelRequest,pkCli_2221,Nc_2659) in
                                                            {2264}out(c, (pkCli_2221,m1_2660));
                                                            {2265}in(c, em2_2661: bitstring);
                                                            {2266}let m2_2662: bitstring = em2_2661 in
                                                            {2267}let (=OpenSecureChannelResponse,Ns_2663: bitstring,ST_2664: bitstring,TTL_2665: bitstring) = m2_2662 in
                                                            {2268}let Kcli_2666: bitstring = h((Nc_2659,Ns_2663)) in
                                                            {2269}out(c, senc(mCli(pkCli_2221,pkSess_2656),Kcli_2666))
                                                        )
                                                        else
                                                            {2270}let pkSess_2667: bitstring = pub(sk(Sess)) in
                                                            {2271}out(c, GetEndpointRequest);
                                                            {2272}in(c, (=GetEndpointResponse,=pkSess_2667,=None,SP_2668: bitstring,UP_2669: bitstring));
                                                            {2273}new Nc_2670: bitstring;
                                                            {2274}let m1_2671: bitstring = (OpenSecureChannelRequest,pkCli_2221,Nc_2670) in
                                                            {2275}out(c, (pkCli_2221,m1_2671));
                                                            {2276}in(c, em2_2672: bitstring);
                                                            {2277}let m2_2673: bitstring = em2_2672 in
                                                            {2278}let (=OpenSecureChannelResponse,Ns_2674: bitstring,ST_2675: bitstring,TTL_2676: bitstring) = m2_2673 in
                                                            {2279}let Kcli_2677: bitstring = h((Nc_2670,Ns_2674)) in
                                                            {2280}out(c, senc(mCli(pkCli_2221,pkSess_2667),Kcli_2677))
                                                    )
                                                    else
                                                        {2281}let pkSess_2678: bitstring = fail-any in
                                                        {2282}out(c, GetEndpointRequest);
                                                        {2283}in(c, (=GetEndpointResponse,=pkSess_2678,=None,SP_2679: bitstring,UP_2680: bitstring));
                                                        {2284}new Nc_2681: bitstring;
                                                        {2285}let m1_2682: bitstring = (OpenSecureChannelRequest,pkCli_2221,Nc_2681) in
                                                        {2286}out(c, (pkCli_2221,m1_2682));
                                                        {2287}in(c, em2_2683: bitstring);
                                                        {2288}let m2_2684: bitstring = em2_2683 in
                                                        {2289}let (=OpenSecureChannelResponse,Ns_2685: bitstring,ST_2686: bitstring,TTL_2687: bitstring) = m2_2684 in
                                                        {2290}let Kcli_2688: bitstring = h((Nc_2681,Ns_2685)) in
                                                        {2291}out(c, senc(mCli(pkCli_2221,pkSess_2678),Kcli_2688))
                                            )
                                            else
                                                {2292}let pkSess_2689: bitstring = fail-any in
                                                {2293}out(c, GetEndpointRequest);
                                                {2294}in(c, (=GetEndpointResponse,=pkSess_2689,=None,SP_2690: bitstring,UP_2691: bitstring));
                                                {2295}new Nc_2692: bitstring;
                                                {2296}let m1_2693: bitstring = (OpenSecureChannelRequest,pkCli_2221,Nc_2692) in
                                                {2297}out(c, (pkCli_2221,m1_2693));
                                                {2298}in(c, em2_2694: bitstring);
                                                {2299}let m2_2695: bitstring = em2_2694 in
                                                {2300}let (=OpenSecureChannelResponse,Ns_2696: bitstring,ST_2697: bitstring,TTL_2698: bitstring) = m2_2695 in
                                                {2301}let Kcli_2699: bitstring = h((Nc_2692,Ns_2696)) in
                                                {2302}out(c, senc(mCli(pkCli_2221,pkSess_2689),Kcli_2699))
                                    )
                                    else
                                        {2303}let pkSess_2700: bitstring = fail-any in
                                        {2304}out(c, GetEndpointRequest);
                                        {2305}in(c, (=GetEndpointResponse,=pkSess_2700,=None,SP_2701: bitstring,UP_2702: bitstring));
                                        {2306}new Nc_2703: bitstring;
                                        {2307}let m1_2704: bitstring = (OpenSecureChannelRequest,pkCli_2221,Nc_2703) in
                                        {2308}out(c, (pkCli_2221,m1_2704));
                                        {2309}in(c, em2_2705: bitstring);
                                        {2310}let m2_2706: bitstring = em2_2705 in
                                        {2311}let (=OpenSecureChannelResponse,Ns_2707: bitstring,ST_2708: bitstring,TTL_2709: bitstring) = m2_2706 in
                                        {2312}let Kcli_2710: bitstring = h((Nc_2703,Ns_2707)) in
                                        {2313}out(c, senc(mCli(pkCli_2221,pkSess_2700),Kcli_2710))
                        )
                        else
                            {2314}let pkDisco_2711: bitstring = fail-any in
                            {2315}let v_2712: bool = (Sess = A) in
                            (
                                {2316}if v_2712 then
                                (
                                    {2317}let pkSess_2713: bitstring = pub(skA) in
                                    {2318}out(c, GetEndpointRequest);
                                    {2319}in(c, (=GetEndpointResponse,=pkSess_2713,=None,SP_2714: bitstring,UP_2715: bitstring));
                                    {2320}new Nc_2716: bitstring;
                                    {2321}let m1_2717: bitstring = (OpenSecureChannelRequest,pkCli_2221,Nc_2716) in
                                    {2322}out(c, (pkCli_2221,m1_2717));
                                    {2323}in(c, em2_2718: bitstring);
                                    {2324}let m2_2719: bitstring = em2_2718 in
                                    {2325}let (=OpenSecureChannelResponse,Ns_2720: bitstring,ST_2721: bitstring,TTL_2722: bitstring) = m2_2719 in
                                    {2326}let Kcli_2723: bitstring = h((Nc_2716,Ns_2720)) in
                                    {2327}out(c, senc(mCli(pkCli_2221,pkSess_2713),Kcli_2723))
                                )
                                else
                                    {2328}let v_2724: bool = (Sess = B) in
                                    (
                                        {2329}if v_2724 then
                                        (
                                            {2330}let pkSess_2725: bitstring = pub(skB) in
                                            {2331}out(c, GetEndpointRequest);
                                            {2332}in(c, (=GetEndpointResponse,=pkSess_2725,=None,SP_2726: bitstring,UP_2727: bitstring));
                                            {2333}new Nc_2728: bitstring;
                                            {2334}let m1_2729: bitstring = (OpenSecureChannelRequest,pkCli_2221,Nc_2728) in
                                            {2335}out(c, (pkCli_2221,m1_2729));
                                            {2336}in(c, em2_2730: bitstring);
                                            {2337}let m2_2731: bitstring = em2_2730 in
                                            {2338}let (=OpenSecureChannelResponse,Ns_2732: bitstring,ST_2733: bitstring,TTL_2734: bitstring) = m2_2731 in
                                            {2339}let Kcli_2735: bitstring = h((Nc_2728,Ns_2732)) in
                                            {2340}out(c, senc(mCli(pkCli_2221,pkSess_2725),Kcli_2735))
                                        )
                                        else
                                            {2341}let v_2736: bool = (Sess = C) in
                                            (
                                                {2342}if v_2736 then
                                                (
                                                    {2343}let pkSess_2737: bitstring = pub(skC) in
                                                    {2344}out(c, GetEndpointRequest);
                                                    {2345}in(c, (=GetEndpointResponse,=pkSess_2737,=None,SP_2738: bitstring,UP_2739: bitstring));
                                                    {2346}new Nc_2740: bitstring;
                                                    {2347}let m1_2741: bitstring = (OpenSecureChannelRequest,pkCli_2221,Nc_2740) in
                                                    {2348}out(c, (pkCli_2221,m1_2741));
                                                    {2349}in(c, em2_2742: bitstring);
                                                    {2350}let m2_2743: bitstring = em2_2742 in
                                                    {2351}let (=OpenSecureChannelResponse,Ns_2744: bitstring,ST_2745: bitstring,TTL_2746: bitstring) = m2_2743 in
                                                    {2352}let Kcli_2747: bitstring = h((Nc_2740,Ns_2744)) in
                                                    {2353}out(c, senc(mCli(pkCli_2221,pkSess_2737),Kcli_2747))
                                                )
                                                else
                                                    {2354}let pkSess_2748: bitstring = pub(sk(Sess)) in
                                                    {2355}out(c, GetEndpointRequest);
                                                    {2356}in(c, (=GetEndpointResponse,=pkSess_2748,=None,SP_2749: bitstring,UP_2750: bitstring));
                                                    {2357}new Nc_2751: bitstring;
                                                    {2358}let m1_2752: bitstring = (OpenSecureChannelRequest,pkCli_2221,Nc_2751) in
                                                    {2359}out(c, (pkCli_2221,m1_2752));
                                                    {2360}in(c, em2_2753: bitstring);
                                                    {2361}let m2_2754: bitstring = em2_2753 in
                                                    {2362}let (=OpenSecureChannelResponse,Ns_2755: bitstring,ST_2756: bitstring,TTL_2757: bitstring) = m2_2754 in
                                                    {2363}let Kcli_2758: bitstring = h((Nc_2751,Ns_2755)) in
                                                    {2364}out(c, senc(mCli(pkCli_2221,pkSess_2748),Kcli_2758))
                                            )
                                            else
                                                {2365}let pkSess_2759: bitstring = fail-any in
                                                {2366}out(c, GetEndpointRequest);
                                                {2367}in(c, (=GetEndpointResponse,=pkSess_2759,=None,SP_2760: bitstring,UP_2761: bitstring));
                                                {2368}new Nc_2762: bitstring;
                                                {2369}let m1_2763: bitstring = (OpenSecureChannelRequest,pkCli_2221,Nc_2762) in
                                                {2370}out(c, (pkCli_2221,m1_2763));
                                                {2371}in(c, em2_2764: bitstring);
                                                {2372}let m2_2765: bitstring = em2_2764 in
                                                {2373}let (=OpenSecureChannelResponse,Ns_2766: bitstring,ST_2767: bitstring,TTL_2768: bitstring) = m2_2765 in
                                                {2374}let Kcli_2769: bitstring = h((Nc_2762,Ns_2766)) in
                                                {2375}out(c, senc(mCli(pkCli_2221,pkSess_2759),Kcli_2769))
                                    )
                                    else
                                        {2376}let pkSess_2770: bitstring = fail-any in
                                        {2377}out(c, GetEndpointRequest);
                                        {2378}in(c, (=GetEndpointResponse,=pkSess_2770,=None,SP_2771: bitstring,UP_2772: bitstring));
                                        {2379}new Nc_2773: bitstring;
                                        {2380}let m1_2774: bitstring = (OpenSecureChannelRequest,pkCli_2221,Nc_2773) in
                                        {2381}out(c, (pkCli_2221,m1_2774));
                                        {2382}in(c, em2_2775: bitstring);
                                        {2383}let m2_2776: bitstring = em2_2775 in
                                        {2384}let (=OpenSecureChannelResponse,Ns_2777: bitstring,ST_2778: bitstring,TTL_2779: bitstring) = m2_2776 in
                                        {2385}let Kcli_2780: bitstring = h((Nc_2773,Ns_2777)) in
                                        {2386}out(c, senc(mCli(pkCli_2221,pkSess_2770),Kcli_2780))
                            )
                            else
                                {2387}let pkSess_2781: bitstring = fail-any in
                                {2388}out(c, GetEndpointRequest);
                                {2389}in(c, (=GetEndpointResponse,=pkSess_2781,=None,SP_2782: bitstring,UP_2783: bitstring));
                                {2390}new Nc_2784: bitstring;
                                {2391}let m1_2785: bitstring = (OpenSecureChannelRequest,pkCli_2221,Nc_2784) in
                                {2392}out(c, (pkCli_2221,m1_2785));
                                {2393}in(c, em2_2786: bitstring);
                                {2394}let m2_2787: bitstring = em2_2786 in
                                {2395}let (=OpenSecureChannelResponse,Ns_2788: bitstring,ST_2789: bitstring,TTL_2790: bitstring) = m2_2787 in
                                {2396}let Kcli_2791: bitstring = h((Nc_2784,Ns_2788)) in
                                {2397}out(c, senc(mCli(pkCli_2221,pkSess_2781),Kcli_2791))
            )
            else
                {2398}let skCli_2792: bitstring = fail-any in
                {2399}let pkCli_2793: bitstring = pub(skCli_2792) in
                {2400}let v_2794: bool = (Disco = A) in
                (
                    {2401}if v_2794 then
                    (
                        {2402}let pkDisco_2795: bitstring = pub(skA) in
                        {2403}let v_2796: bool = (Sess = A) in
                        (
                            {2404}if v_2796 then
                            (
                                {2405}let pkSess_2797: bitstring = pub(skA) in
                                {2406}out(c, GetEndpointRequest);
                                {2407}in(c, (=GetEndpointResponse,=pkSess_2797,=None,SP_2798: bitstring,UP_2799: bitstring));
                                {2408}new Nc_2800: bitstring;
                                {2409}let m1_2801: bitstring = (OpenSecureChannelRequest,pkCli_2793,Nc_2800) in
                                {2410}out(c, (pkCli_2793,m1_2801));
                                {2411}in(c, em2_2802: bitstring);
                                {2412}let m2_2803: bitstring = em2_2802 in
                                {2413}let (=OpenSecureChannelResponse,Ns_2804: bitstring,ST_2805: bitstring,TTL_2806: bitstring) = m2_2803 in
                                {2414}let Kcli_2807: bitstring = h((Nc_2800,Ns_2804)) in
                                {2415}out(c, senc(mCli(pkCli_2793,pkSess_2797),Kcli_2807))
                            )
                            else
                                {2416}let v_2808: bool = (Sess = B) in
                                (
                                    {2417}if v_2808 then
                                    (
                                        {2418}let pkSess_2809: bitstring = pub(skB) in
                                        {2419}out(c, GetEndpointRequest);
                                        {2420}in(c, (=GetEndpointResponse,=pkSess_2809,=None,SP_2810: bitstring,UP_2811: bitstring));
                                        {2421}new Nc_2812: bitstring;
                                        {2422}let m1_2813: bitstring = (OpenSecureChannelRequest,pkCli_2793,Nc_2812) in
                                        {2423}out(c, (pkCli_2793,m1_2813));
                                        {2424}in(c, em2_2814: bitstring);
                                        {2425}let m2_2815: bitstring = em2_2814 in
                                        {2426}let (=OpenSecureChannelResponse,Ns_2816: bitstring,ST_2817: bitstring,TTL_2818: bitstring) = m2_2815 in
                                        {2427}let Kcli_2819: bitstring = h((Nc_2812,Ns_2816)) in
                                        {2428}out(c, senc(mCli(pkCli_2793,pkSess_2809),Kcli_2819))
                                    )
                                    else
                                        {2429}let v_2820: bool = (Sess = C) in
                                        (
                                            {2430}if v_2820 then
                                            (
                                                {2431}let pkSess_2821: bitstring = pub(skC) in
                                                {2432}out(c, GetEndpointRequest);
                                                {2433}in(c, (=GetEndpointResponse,=pkSess_2821,=None,SP_2822: bitstring,UP_2823: bitstring));
                                                {2434}new Nc_2824: bitstring;
                                                {2435}let m1_2825: bitstring = (OpenSecureChannelRequest,pkCli_2793,Nc_2824) in
                                                {2436}out(c, (pkCli_2793,m1_2825));
                                                {2437}in(c, em2_2826: bitstring);
                                                {2438}let m2_2827: bitstring = em2_2826 in
                                                {2439}let (=OpenSecureChannelResponse,Ns_2828: bitstring,ST_2829: bitstring,TTL_2830: bitstring) = m2_2827 in
                                                {2440}let Kcli_2831: bitstring = h((Nc_2824,Ns_2828)) in
                                                {2441}out(c, senc(mCli(pkCli_2793,pkSess_2821),Kcli_2831))
                                            )
                                            else
                                                {2442}let pkSess_2832: bitstring = pub(sk(Sess)) in
                                                {2443}out(c, GetEndpointRequest);
                                                {2444}in(c, (=GetEndpointResponse,=pkSess_2832,=None,SP_2833: bitstring,UP_2834: bitstring));
                                                {2445}new Nc_2835: bitstring;
                                                {2446}let m1_2836: bitstring = (OpenSecureChannelRequest,pkCli_2793,Nc_2835) in
                                                {2447}out(c, (pkCli_2793,m1_2836));
                                                {2448}in(c, em2_2837: bitstring);
                                                {2449}let m2_2838: bitstring = em2_2837 in
                                                {2450}let (=OpenSecureChannelResponse,Ns_2839: bitstring,ST_2840: bitstring,TTL_2841: bitstring) = m2_2838 in
                                                {2451}let Kcli_2842: bitstring = h((Nc_2835,Ns_2839)) in
                                                {2452}out(c, senc(mCli(pkCli_2793,pkSess_2832),Kcli_2842))
                                        )
                                        else
                                            {2453}let pkSess_2843: bitstring = fail-any in
                                            {2454}out(c, GetEndpointRequest);
                                            {2455}in(c, (=GetEndpointResponse,=pkSess_2843,=None,SP_2844: bitstring,UP_2845: bitstring));
                                            {2456}new Nc_2846: bitstring;
                                            {2457}let m1_2847: bitstring = (OpenSecureChannelRequest,pkCli_2793,Nc_2846) in
                                            {2458}out(c, (pkCli_2793,m1_2847));
                                            {2459}in(c, em2_2848: bitstring);
                                            {2460}let m2_2849: bitstring = em2_2848 in
                                            {2461}let (=OpenSecureChannelResponse,Ns_2850: bitstring,ST_2851: bitstring,TTL_2852: bitstring) = m2_2849 in
                                            {2462}let Kcli_2853: bitstring = h((Nc_2846,Ns_2850)) in
                                            {2463}out(c, senc(mCli(pkCli_2793,pkSess_2843),Kcli_2853))
                                )
                                else
                                    {2464}let pkSess_2854: bitstring = fail-any in
                                    {2465}out(c, GetEndpointRequest);
                                    {2466}in(c, (=GetEndpointResponse,=pkSess_2854,=None,SP_2855: bitstring,UP_2856: bitstring));
                                    {2467}new Nc_2857: bitstring;
                                    {2468}let m1_2858: bitstring = (OpenSecureChannelRequest,pkCli_2793,Nc_2857) in
                                    {2469}out(c, (pkCli_2793,m1_2858));
                                    {2470}in(c, em2_2859: bitstring);
                                    {2471}let m2_2860: bitstring = em2_2859 in
                                    {2472}let (=OpenSecureChannelResponse,Ns_2861: bitstring,ST_2862: bitstring,TTL_2863: bitstring) = m2_2860 in
                                    {2473}let Kcli_2864: bitstring = h((Nc_2857,Ns_2861)) in
                                    {2474}out(c, senc(mCli(pkCli_2793,pkSess_2854),Kcli_2864))
                        )
                        else
                            {2475}let pkSess_2865: bitstring = fail-any in
                            {2476}out(c, GetEndpointRequest);
                            {2477}in(c, (=GetEndpointResponse,=pkSess_2865,=None,SP_2866: bitstring,UP_2867: bitstring));
                            {2478}new Nc_2868: bitstring;
                            {2479}let m1_2869: bitstring = (OpenSecureChannelRequest,pkCli_2793,Nc_2868) in
                            {2480}out(c, (pkCli_2793,m1_2869));
                            {2481}in(c, em2_2870: bitstring);
                            {2482}let m2_2871: bitstring = em2_2870 in
                            {2483}let (=OpenSecureChannelResponse,Ns_2872: bitstring,ST_2873: bitstring,TTL_2874: bitstring) = m2_2871 in
                            {2484}let Kcli_2875: bitstring = h((Nc_2868,Ns_2872)) in
                            {2485}out(c, senc(mCli(pkCli_2793,pkSess_2865),Kcli_2875))
                    )
                    else
                        {2486}let v_2876: bool = (Disco = B) in
                        (
                            {2487}if v_2876 then
                            (
                                {2488}let pkDisco_2877: bitstring = pub(skB) in
                                {2489}let v_2878: bool = (Sess = A) in
                                (
                                    {2490}if v_2878 then
                                    (
                                        {2491}let pkSess_2879: bitstring = pub(skA) in
                                        {2492}out(c, GetEndpointRequest);
                                        {2493}in(c, (=GetEndpointResponse,=pkSess_2879,=None,SP_2880: bitstring,UP_2881: bitstring));
                                        {2494}new Nc_2882: bitstring;
                                        {2495}let m1_2883: bitstring = (OpenSecureChannelRequest,pkCli_2793,Nc_2882) in
                                        {2496}out(c, (pkCli_2793,m1_2883));
                                        {2497}in(c, em2_2884: bitstring);
                                        {2498}let m2_2885: bitstring = em2_2884 in
                                        {2499}let (=OpenSecureChannelResponse,Ns_2886: bitstring,ST_2887: bitstring,TTL_2888: bitstring) = m2_2885 in
                                        {2500}let Kcli_2889: bitstring = h((Nc_2882,Ns_2886)) in
                                        {2501}out(c, senc(mCli(pkCli_2793,pkSess_2879),Kcli_2889))
                                    )
                                    else
                                        {2502}let v_2890: bool = (Sess = B) in
                                        (
                                            {2503}if v_2890 then
                                            (
                                                {2504}let pkSess_2891: bitstring = pub(skB) in
                                                {2505}out(c, GetEndpointRequest);
                                                {2506}in(c, (=GetEndpointResponse,=pkSess_2891,=None,SP_2892: bitstring,UP_2893: bitstring));
                                                {2507}new Nc_2894: bitstring;
                                                {2508}let m1_2895: bitstring = (OpenSecureChannelRequest,pkCli_2793,Nc_2894) in
                                                {2509}out(c, (pkCli_2793,m1_2895));
                                                {2510}in(c, em2_2896: bitstring);
                                                {2511}let m2_2897: bitstring = em2_2896 in
                                                {2512}let (=OpenSecureChannelResponse,Ns_2898: bitstring,ST_2899: bitstring,TTL_2900: bitstring) = m2_2897 in
                                                {2513}let Kcli_2901: bitstring = h((Nc_2894,Ns_2898)) in
                                                {2514}out(c, senc(mCli(pkCli_2793,pkSess_2891),Kcli_2901))
                                            )
                                            else
                                                {2515}let v_2902: bool = (Sess = C) in
                                                (
                                                    {2516}if v_2902 then
                                                    (
                                                        {2517}let pkSess_2903: bitstring = pub(skC) in
                                                        {2518}out(c, GetEndpointRequest);
                                                        {2519}in(c, (=GetEndpointResponse,=pkSess_2903,=None,SP_2904: bitstring,UP_2905: bitstring));
                                                        {2520}new Nc_2906: bitstring;
                                                        {2521}let m1_2907: bitstring = (OpenSecureChannelRequest,pkCli_2793,Nc_2906) in
                                                        {2522}out(c, (pkCli_2793,m1_2907));
                                                        {2523}in(c, em2_2908: bitstring);
                                                        {2524}let m2_2909: bitstring = em2_2908 in
                                                        {2525}let (=OpenSecureChannelResponse,Ns_2910: bitstring,ST_2911: bitstring,TTL_2912: bitstring) = m2_2909 in
                                                        {2526}let Kcli_2913: bitstring = h((Nc_2906,Ns_2910)) in
                                                        {2527}out(c, senc(mCli(pkCli_2793,pkSess_2903),Kcli_2913))
                                                    )
                                                    else
                                                        {2528}let pkSess_2914: bitstring = pub(sk(Sess)) in
                                                        {2529}out(c, GetEndpointRequest);
                                                        {2530}in(c, (=GetEndpointResponse,=pkSess_2914,=None,SP_2915: bitstring,UP_2916: bitstring));
                                                        {2531}new Nc_2917: bitstring;
                                                        {2532}let m1_2918: bitstring = (OpenSecureChannelRequest,pkCli_2793,Nc_2917) in
                                                        {2533}out(c, (pkCli_2793,m1_2918));
                                                        {2534}in(c, em2_2919: bitstring);
                                                        {2535}let m2_2920: bitstring = em2_2919 in
                                                        {2536}let (=OpenSecureChannelResponse,Ns_2921: bitstring,ST_2922: bitstring,TTL_2923: bitstring) = m2_2920 in
                                                        {2537}let Kcli_2924: bitstring = h((Nc_2917,Ns_2921)) in
                                                        {2538}out(c, senc(mCli(pkCli_2793,pkSess_2914),Kcli_2924))
                                                )
                                                else
                                                    {2539}let pkSess_2925: bitstring = fail-any in
                                                    {2540}out(c, GetEndpointRequest);
                                                    {2541}in(c, (=GetEndpointResponse,=pkSess_2925,=None,SP_2926: bitstring,UP_2927: bitstring));
                                                    {2542}new Nc_2928: bitstring;
                                                    {2543}let m1_2929: bitstring = (OpenSecureChannelRequest,pkCli_2793,Nc_2928) in
                                                    {2544}out(c, (pkCli_2793,m1_2929));
                                                    {2545}in(c, em2_2930: bitstring);
                                                    {2546}let m2_2931: bitstring = em2_2930 in
                                                    {2547}let (=OpenSecureChannelResponse,Ns_2932: bitstring,ST_2933: bitstring,TTL_2934: bitstring) = m2_2931 in
                                                    {2548}let Kcli_2935: bitstring = h((Nc_2928,Ns_2932)) in
                                                    {2549}out(c, senc(mCli(pkCli_2793,pkSess_2925),Kcli_2935))
                                        )
                                        else
                                            {2550}let pkSess_2936: bitstring = fail-any in
                                            {2551}out(c, GetEndpointRequest);
                                            {2552}in(c, (=GetEndpointResponse,=pkSess_2936,=None,SP_2937: bitstring,UP_2938: bitstring));
                                            {2553}new Nc_2939: bitstring;
                                            {2554}let m1_2940: bitstring = (OpenSecureChannelRequest,pkCli_2793,Nc_2939) in
                                            {2555}out(c, (pkCli_2793,m1_2940));
                                            {2556}in(c, em2_2941: bitstring);
                                            {2557}let m2_2942: bitstring = em2_2941 in
                                            {2558}let (=OpenSecureChannelResponse,Ns_2943: bitstring,ST_2944: bitstring,TTL_2945: bitstring) = m2_2942 in
                                            {2559}let Kcli_2946: bitstring = h((Nc_2939,Ns_2943)) in
                                            {2560}out(c, senc(mCli(pkCli_2793,pkSess_2936),Kcli_2946))
                                )
                                else
                                    {2561}let pkSess_2947: bitstring = fail-any in
                                    {2562}out(c, GetEndpointRequest);
                                    {2563}in(c, (=GetEndpointResponse,=pkSess_2947,=None,SP_2948: bitstring,UP_2949: bitstring));
                                    {2564}new Nc_2950: bitstring;
                                    {2565}let m1_2951: bitstring = (OpenSecureChannelRequest,pkCli_2793,Nc_2950) in
                                    {2566}out(c, (pkCli_2793,m1_2951));
                                    {2567}in(c, em2_2952: bitstring);
                                    {2568}let m2_2953: bitstring = em2_2952 in
                                    {2569}let (=OpenSecureChannelResponse,Ns_2954: bitstring,ST_2955: bitstring,TTL_2956: bitstring) = m2_2953 in
                                    {2570}let Kcli_2957: bitstring = h((Nc_2950,Ns_2954)) in
                                    {2571}out(c, senc(mCli(pkCli_2793,pkSess_2947),Kcli_2957))
                            )
                            else
                                {2572}let v_2958: bool = (Disco = C) in
                                (
                                    {2573}if v_2958 then
                                    (
                                        {2574}let pkDisco_2959: bitstring = pub(skC) in
                                        {2575}let v_2960: bool = (Sess = A) in
                                        (
                                            {2576}if v_2960 then
                                            (
                                                {2577}let pkSess_2961: bitstring = pub(skA) in
                                                {2578}out(c, GetEndpointRequest);
                                                {2579}in(c, (=GetEndpointResponse,=pkSess_2961,=None,SP_2962: bitstring,UP_2963: bitstring));
                                                {2580}new Nc_2964: bitstring;
                                                {2581}let m1_2965: bitstring = (OpenSecureChannelRequest,pkCli_2793,Nc_2964) in
                                                {2582}out(c, (pkCli_2793,m1_2965));
                                                {2583}in(c, em2_2966: bitstring);
                                                {2584}let m2_2967: bitstring = em2_2966 in
                                                {2585}let (=OpenSecureChannelResponse,Ns_2968: bitstring,ST_2969: bitstring,TTL_2970: bitstring) = m2_2967 in
                                                {2586}let Kcli_2971: bitstring = h((Nc_2964,Ns_2968)) in
                                                {2587}out(c, senc(mCli(pkCli_2793,pkSess_2961),Kcli_2971))
                                            )
                                            else
                                                {2588}let v_2972: bool = (Sess = B) in
                                                (
                                                    {2589}if v_2972 then
                                                    (
                                                        {2590}let pkSess_2973: bitstring = pub(skB) in
                                                        {2591}out(c, GetEndpointRequest);
                                                        {2592}in(c, (=GetEndpointResponse,=pkSess_2973,=None,SP_2974: bitstring,UP_2975: bitstring));
                                                        {2593}new Nc_2976: bitstring;
                                                        {2594}let m1_2977: bitstring = (OpenSecureChannelRequest,pkCli_2793,Nc_2976) in
                                                        {2595}out(c, (pkCli_2793,m1_2977));
                                                        {2596}in(c, em2_2978: bitstring);
                                                        {2597}let m2_2979: bitstring = em2_2978 in
                                                        {2598}let (=OpenSecureChannelResponse,Ns_2980: bitstring,ST_2981: bitstring,TTL_2982: bitstring) = m2_2979 in
                                                        {2599}let Kcli_2983: bitstring = h((Nc_2976,Ns_2980)) in
                                                        {2600}out(c, senc(mCli(pkCli_2793,pkSess_2973),Kcli_2983))
                                                    )
                                                    else
                                                        {2601}let v_2984: bool = (Sess = C) in
                                                        (
                                                            {2602}if v_2984 then
                                                            (
                                                                {2603}let pkSess_2985: bitstring = pub(skC) in
                                                                {2604}out(c, GetEndpointRequest);
                                                                {2605}in(c, (=GetEndpointResponse,=pkSess_2985,=None,SP_2986: bitstring,UP_2987: bitstring));
                                                                {2606}new Nc_2988: bitstring;
                                                                {2607}let m1_2989: bitstring = (OpenSecureChannelRequest,pkCli_2793,Nc_2988) in
                                                                {2608}out(c, (pkCli_2793,m1_2989));
                                                                {2609}in(c, em2_2990: bitstring);
                                                                {2610}let m2_2991: bitstring = em2_2990 in
                                                                {2611}let (=OpenSecureChannelResponse,Ns_2992: bitstring,ST_2993: bitstring,TTL_2994: bitstring) = m2_2991 in
                                                                {2612}let Kcli_2995: bitstring = h((Nc_2988,Ns_2992)) in
                                                                {2613}out(c, senc(mCli(pkCli_2793,pkSess_2985),Kcli_2995))
                                                            )
                                                            else
                                                                {2614}let pkSess_2996: bitstring = pub(sk(Sess)) in
                                                                {2615}out(c, GetEndpointRequest);
                                                                {2616}in(c, (=GetEndpointResponse,=pkSess_2996,=None,SP_2997: bitstring,UP_2998: bitstring));
                                                                {2617}new Nc_2999: bitstring;
                                                                {2618}let m1_3000: bitstring = (OpenSecureChannelRequest,pkCli_2793,Nc_2999) in
                                                                {2619}out(c, (pkCli_2793,m1_3000));
                                                                {2620}in(c, em2_3001: bitstring);
                                                                {2621}let m2_3002: bitstring = em2_3001 in
                                                                {2622}let (=OpenSecureChannelResponse,Ns_3003: bitstring,ST_3004: bitstring,TTL_3005: bitstring) = m2_3002 in
                                                                {2623}let Kcli_3006: bitstring = h((Nc_2999,Ns_3003)) in
                                                                {2624}out(c, senc(mCli(pkCli_2793,pkSess_2996),Kcli_3006))
                                                        )
                                                        else
                                                            {2625}let pkSess_3007: bitstring = fail-any in
                                                            {2626}out(c, GetEndpointRequest);
                                                            {2627}in(c, (=GetEndpointResponse,=pkSess_3007,=None,SP_3008: bitstring,UP_3009: bitstring));
                                                            {2628}new Nc_3010: bitstring;
                                                            {2629}let m1_3011: bitstring = (OpenSecureChannelRequest,pkCli_2793,Nc_3010) in
                                                            {2630}out(c, (pkCli_2793,m1_3011));
                                                            {2631}in(c, em2_3012: bitstring);
                                                            {2632}let m2_3013: bitstring = em2_3012 in
                                                            {2633}let (=OpenSecureChannelResponse,Ns_3014: bitstring,ST_3015: bitstring,TTL_3016: bitstring) = m2_3013 in
                                                            {2634}let Kcli_3017: bitstring = h((Nc_3010,Ns_3014)) in
                                                            {2635}out(c, senc(mCli(pkCli_2793,pkSess_3007),Kcli_3017))
                                                )
                                                else
                                                    {2636}let pkSess_3018: bitstring = fail-any in
                                                    {2637}out(c, GetEndpointRequest);
                                                    {2638}in(c, (=GetEndpointResponse,=pkSess_3018,=None,SP_3019: bitstring,UP_3020: bitstring));
                                                    {2639}new Nc_3021: bitstring;
                                                    {2640}let m1_3022: bitstring = (OpenSecureChannelRequest,pkCli_2793,Nc_3021) in
                                                    {2641}out(c, (pkCli_2793,m1_3022));
                                                    {2642}in(c, em2_3023: bitstring);
                                                    {2643}let m2_3024: bitstring = em2_3023 in
                                                    {2644}let (=OpenSecureChannelResponse,Ns_3025: bitstring,ST_3026: bitstring,TTL_3027: bitstring) = m2_3024 in
                                                    {2645}let Kcli_3028: bitstring = h((Nc_3021,Ns_3025)) in
                                                    {2646}out(c, senc(mCli(pkCli_2793,pkSess_3018),Kcli_3028))
                                        )
                                        else
                                            {2647}let pkSess_3029: bitstring = fail-any in
                                            {2648}out(c, GetEndpointRequest);
                                            {2649}in(c, (=GetEndpointResponse,=pkSess_3029,=None,SP_3030: bitstring,UP_3031: bitstring));
                                            {2650}new Nc_3032: bitstring;
                                            {2651}let m1_3033: bitstring = (OpenSecureChannelRequest,pkCli_2793,Nc_3032) in
                                            {2652}out(c, (pkCli_2793,m1_3033));
                                            {2653}in(c, em2_3034: bitstring);
                                            {2654}let m2_3035: bitstring = em2_3034 in
                                            {2655}let (=OpenSecureChannelResponse,Ns_3036: bitstring,ST_3037: bitstring,TTL_3038: bitstring) = m2_3035 in
                                            {2656}let Kcli_3039: bitstring = h((Nc_3032,Ns_3036)) in
                                            {2657}out(c, senc(mCli(pkCli_2793,pkSess_3029),Kcli_3039))
                                    )
                                    else
                                        {2658}let pkDisco_3040: bitstring = pub(sk(Disco)) in
                                        {2659}let v_3041: bool = (Sess = A) in
                                        (
                                            {2660}if v_3041 then
                                            (
                                                {2661}let pkSess_3042: bitstring = pub(skA) in
                                                {2662}out(c, GetEndpointRequest);
                                                {2663}in(c, (=GetEndpointResponse,=pkSess_3042,=None,SP_3043: bitstring,UP_3044: bitstring));
                                                {2664}new Nc_3045: bitstring;
                                                {2665}let m1_3046: bitstring = (OpenSecureChannelRequest,pkCli_2793,Nc_3045) in
                                                {2666}out(c, (pkCli_2793,m1_3046));
                                                {2667}in(c, em2_3047: bitstring);
                                                {2668}let m2_3048: bitstring = em2_3047 in
                                                {2669}let (=OpenSecureChannelResponse,Ns_3049: bitstring,ST_3050: bitstring,TTL_3051: bitstring) = m2_3048 in
                                                {2670}let Kcli_3052: bitstring = h((Nc_3045,Ns_3049)) in
                                                {2671}out(c, senc(mCli(pkCli_2793,pkSess_3042),Kcli_3052))
                                            )
                                            else
                                                {2672}let v_3053: bool = (Sess = B) in
                                                (
                                                    {2673}if v_3053 then
                                                    (
                                                        {2674}let pkSess_3054: bitstring = pub(skB) in
                                                        {2675}out(c, GetEndpointRequest);
                                                        {2676}in(c, (=GetEndpointResponse,=pkSess_3054,=None,SP_3055: bitstring,UP_3056: bitstring));
                                                        {2677}new Nc_3057: bitstring;
                                                        {2678}let m1_3058: bitstring = (OpenSecureChannelRequest,pkCli_2793,Nc_3057) in
                                                        {2679}out(c, (pkCli_2793,m1_3058));
                                                        {2680}in(c, em2_3059: bitstring);
                                                        {2681}let m2_3060: bitstring = em2_3059 in
                                                        {2682}let (=OpenSecureChannelResponse,Ns_3061: bitstring,ST_3062: bitstring,TTL_3063: bitstring) = m2_3060 in
                                                        {2683}let Kcli_3064: bitstring = h((Nc_3057,Ns_3061)) in
                                                        {2684}out(c, senc(mCli(pkCli_2793,pkSess_3054),Kcli_3064))
                                                    )
                                                    else
                                                        {2685}let v_3065: bool = (Sess = C) in
                                                        (
                                                            {2686}if v_3065 then
                                                            (
                                                                {2687}let pkSess_3066: bitstring = pub(skC) in
                                                                {2688}out(c, GetEndpointRequest);
                                                                {2689}in(c, (=GetEndpointResponse,=pkSess_3066,=None,SP_3067: bitstring,UP_3068: bitstring));
                                                                {2690}new Nc_3069: bitstring;
                                                                {2691}let m1_3070: bitstring = (OpenSecureChannelRequest,pkCli_2793,Nc_3069) in
                                                                {2692}out(c, (pkCli_2793,m1_3070));
                                                                {2693}in(c, em2_3071: bitstring);
                                                                {2694}let m2_3072: bitstring = em2_3071 in
                                                                {2695}let (=OpenSecureChannelResponse,Ns_3073: bitstring,ST_3074: bitstring,TTL_3075: bitstring) = m2_3072 in
                                                                {2696}let Kcli_3076: bitstring = h((Nc_3069,Ns_3073)) in
                                                                {2697}out(c, senc(mCli(pkCli_2793,pkSess_3066),Kcli_3076))
                                                            )
                                                            else
                                                                {2698}let pkSess_3077: bitstring = pub(sk(Sess)) in
                                                                {2699}out(c, GetEndpointRequest);
                                                                {2700}in(c, (=GetEndpointResponse,=pkSess_3077,=None,SP_3078: bitstring,UP_3079: bitstring));
                                                                {2701}new Nc_3080: bitstring;
                                                                {2702}let m1_3081: bitstring = (OpenSecureChannelRequest,pkCli_2793,Nc_3080) in
                                                                {2703}out(c, (pkCli_2793,m1_3081));
                                                                {2704}in(c, em2_3082: bitstring);
                                                                {2705}let m2_3083: bitstring = em2_3082 in
                                                                {2706}let (=OpenSecureChannelResponse,Ns_3084: bitstring,ST_3085: bitstring,TTL_3086: bitstring) = m2_3083 in
                                                                {2707}let Kcli_3087: bitstring = h((Nc_3080,Ns_3084)) in
                                                                {2708}out(c, senc(mCli(pkCli_2793,pkSess_3077),Kcli_3087))
                                                        )
                                                        else
                                                            {2709}let pkSess_3088: bitstring = fail-any in
                                                            {2710}out(c, GetEndpointRequest);
                                                            {2711}in(c, (=GetEndpointResponse,=pkSess_3088,=None,SP_3089: bitstring,UP_3090: bitstring));
                                                            {2712}new Nc_3091: bitstring;
                                                            {2713}let m1_3092: bitstring = (OpenSecureChannelRequest,pkCli_2793,Nc_3091) in
                                                            {2714}out(c, (pkCli_2793,m1_3092));
                                                            {2715}in(c, em2_3093: bitstring);
                                                            {2716}let m2_3094: bitstring = em2_3093 in
                                                            {2717}let (=OpenSecureChannelResponse,Ns_3095: bitstring,ST_3096: bitstring,TTL_3097: bitstring) = m2_3094 in
                                                            {2718}let Kcli_3098: bitstring = h((Nc_3091,Ns_3095)) in
                                                            {2719}out(c, senc(mCli(pkCli_2793,pkSess_3088),Kcli_3098))
                                                )
                                                else
                                                    {2720}let pkSess_3099: bitstring = fail-any in
                                                    {2721}out(c, GetEndpointRequest);
                                                    {2722}in(c, (=GetEndpointResponse,=pkSess_3099,=None,SP_3100: bitstring,UP_3101: bitstring));
                                                    {2723}new Nc_3102: bitstring;
                                                    {2724}let m1_3103: bitstring = (OpenSecureChannelRequest,pkCli_2793,Nc_3102) in
                                                    {2725}out(c, (pkCli_2793,m1_3103));
                                                    {2726}in(c, em2_3104: bitstring);
                                                    {2727}let m2_3105: bitstring = em2_3104 in
                                                    {2728}let (=OpenSecureChannelResponse,Ns_3106: bitstring,ST_3107: bitstring,TTL_3108: bitstring) = m2_3105 in
                                                    {2729}let Kcli_3109: bitstring = h((Nc_3102,Ns_3106)) in
                                                    {2730}out(c, senc(mCli(pkCli_2793,pkSess_3099),Kcli_3109))
                                        )
                                        else
                                            {2731}let pkSess_3110: bitstring = fail-any in
                                            {2732}out(c, GetEndpointRequest);
                                            {2733}in(c, (=GetEndpointResponse,=pkSess_3110,=None,SP_3111: bitstring,UP_3112: bitstring));
                                            {2734}new Nc_3113: bitstring;
                                            {2735}let m1_3114: bitstring = (OpenSecureChannelRequest,pkCli_2793,Nc_3113) in
                                            {2736}out(c, (pkCli_2793,m1_3114));
                                            {2737}in(c, em2_3115: bitstring);
                                            {2738}let m2_3116: bitstring = em2_3115 in
                                            {2739}let (=OpenSecureChannelResponse,Ns_3117: bitstring,ST_3118: bitstring,TTL_3119: bitstring) = m2_3116 in
                                            {2740}let Kcli_3120: bitstring = h((Nc_3113,Ns_3117)) in
                                            {2741}out(c, senc(mCli(pkCli_2793,pkSess_3110),Kcli_3120))
                                )
                                else
                                    {2742}let pkDisco_3121: bitstring = fail-any in
                                    {2743}let v_3122: bool = (Sess = A) in
                                    (
                                        {2744}if v_3122 then
                                        (
                                            {2745}let pkSess_3123: bitstring = pub(skA) in
                                            {2746}out(c, GetEndpointRequest);
                                            {2747}in(c, (=GetEndpointResponse,=pkSess_3123,=None,SP_3124: bitstring,UP_3125: bitstring));
                                            {2748}new Nc_3126: bitstring;
                                            {2749}let m1_3127: bitstring = (OpenSecureChannelRequest,pkCli_2793,Nc_3126) in
                                            {2750}out(c, (pkCli_2793,m1_3127));
                                            {2751}in(c, em2_3128: bitstring);
                                            {2752}let m2_3129: bitstring = em2_3128 in
                                            {2753}let (=OpenSecureChannelResponse,Ns_3130: bitstring,ST_3131: bitstring,TTL_3132: bitstring) = m2_3129 in
                                            {2754}let Kcli_3133: bitstring = h((Nc_3126,Ns_3130)) in
                                            {2755}out(c, senc(mCli(pkCli_2793,pkSess_3123),Kcli_3133))
                                        )
                                        else
                                            {2756}let v_3134: bool = (Sess = B) in
                                            (
                                                {2757}if v_3134 then
                                                (
                                                    {2758}let pkSess_3135: bitstring = pub(skB) in
                                                    {2759}out(c, GetEndpointRequest);
                                                    {2760}in(c, (=GetEndpointResponse,=pkSess_3135,=None,SP_3136: bitstring,UP_3137: bitstring));
                                                    {2761}new Nc_3138: bitstring;
                                                    {2762}let m1_3139: bitstring = (OpenSecureChannelRequest,pkCli_2793,Nc_3138) in
                                                    {2763}out(c, (pkCli_2793,m1_3139));
                                                    {2764}in(c, em2_3140: bitstring);
                                                    {2765}let m2_3141: bitstring = em2_3140 in
                                                    {2766}let (=OpenSecureChannelResponse,Ns_3142: bitstring,ST_3143: bitstring,TTL_3144: bitstring) = m2_3141 in
                                                    {2767}let Kcli_3145: bitstring = h((Nc_3138,Ns_3142)) in
                                                    {2768}out(c, senc(mCli(pkCli_2793,pkSess_3135),Kcli_3145))
                                                )
                                                else
                                                    {2769}let v_3146: bool = (Sess = C) in
                                                    (
                                                        {2770}if v_3146 then
                                                        (
                                                            {2771}let pkSess_3147: bitstring = pub(skC) in
                                                            {2772}out(c, GetEndpointRequest);
                                                            {2773}in(c, (=GetEndpointResponse,=pkSess_3147,=None,SP_3148: bitstring,UP_3149: bitstring));
                                                            {2774}new Nc_3150: bitstring;
                                                            {2775}let m1_3151: bitstring = (OpenSecureChannelRequest,pkCli_2793,Nc_3150) in
                                                            {2776}out(c, (pkCli_2793,m1_3151));
                                                            {2777}in(c, em2_3152: bitstring);
                                                            {2778}let m2_3153: bitstring = em2_3152 in
                                                            {2779}let (=OpenSecureChannelResponse,Ns_3154: bitstring,ST_3155: bitstring,TTL_3156: bitstring) = m2_3153 in
                                                            {2780}let Kcli_3157: bitstring = h((Nc_3150,Ns_3154)) in
                                                            {2781}out(c, senc(mCli(pkCli_2793,pkSess_3147),Kcli_3157))
                                                        )
                                                        else
                                                            {2782}let pkSess_3158: bitstring = pub(sk(Sess)) in
                                                            {2783}out(c, GetEndpointRequest);
                                                            {2784}in(c, (=GetEndpointResponse,=pkSess_3158,=None,SP_3159: bitstring,UP_3160: bitstring));
                                                            {2785}new Nc_3161: bitstring;
                                                            {2786}let m1_3162: bitstring = (OpenSecureChannelRequest,pkCli_2793,Nc_3161) in
                                                            {2787}out(c, (pkCli_2793,m1_3162));
                                                            {2788}in(c, em2_3163: bitstring);
                                                            {2789}let m2_3164: bitstring = em2_3163 in
                                                            {2790}let (=OpenSecureChannelResponse,Ns_3165: bitstring,ST_3166: bitstring,TTL_3167: bitstring) = m2_3164 in
                                                            {2791}let Kcli_3168: bitstring = h((Nc_3161,Ns_3165)) in
                                                            {2792}out(c, senc(mCli(pkCli_2793,pkSess_3158),Kcli_3168))
                                                    )
                                                    else
                                                        {2793}let pkSess_3169: bitstring = fail-any in
                                                        {2794}out(c, GetEndpointRequest);
                                                        {2795}in(c, (=GetEndpointResponse,=pkSess_3169,=None,SP_3170: bitstring,UP_3171: bitstring));
                                                        {2796}new Nc_3172: bitstring;
                                                        {2797}let m1_3173: bitstring = (OpenSecureChannelRequest,pkCli_2793,Nc_3172) in
                                                        {2798}out(c, (pkCli_2793,m1_3173));
                                                        {2799}in(c, em2_3174: bitstring);
                                                        {2800}let m2_3175: bitstring = em2_3174 in
                                                        {2801}let (=OpenSecureChannelResponse,Ns_3176: bitstring,ST_3177: bitstring,TTL_3178: bitstring) = m2_3175 in
                                                        {2802}let Kcli_3179: bitstring = h((Nc_3172,Ns_3176)) in
                                                        {2803}out(c, senc(mCli(pkCli_2793,pkSess_3169),Kcli_3179))
                                            )
                                            else
                                                {2804}let pkSess_3180: bitstring = fail-any in
                                                {2805}out(c, GetEndpointRequest);
                                                {2806}in(c, (=GetEndpointResponse,=pkSess_3180,=None,SP_3181: bitstring,UP_3182: bitstring));
                                                {2807}new Nc_3183: bitstring;
                                                {2808}let m1_3184: bitstring = (OpenSecureChannelRequest,pkCli_2793,Nc_3183) in
                                                {2809}out(c, (pkCli_2793,m1_3184));
                                                {2810}in(c, em2_3185: bitstring);
                                                {2811}let m2_3186: bitstring = em2_3185 in
                                                {2812}let (=OpenSecureChannelResponse,Ns_3187: bitstring,ST_3188: bitstring,TTL_3189: bitstring) = m2_3186 in
                                                {2813}let Kcli_3190: bitstring = h((Nc_3183,Ns_3187)) in
                                                {2814}out(c, senc(mCli(pkCli_2793,pkSess_3180),Kcli_3190))
                                    )
                                    else
                                        {2815}let pkSess_3191: bitstring = fail-any in
                                        {2816}out(c, GetEndpointRequest);
                                        {2817}in(c, (=GetEndpointResponse,=pkSess_3191,=None,SP_3192: bitstring,UP_3193: bitstring));
                                        {2818}new Nc_3194: bitstring;
                                        {2819}let m1_3195: bitstring = (OpenSecureChannelRequest,pkCli_2793,Nc_3194) in
                                        {2820}out(c, (pkCli_2793,m1_3195));
                                        {2821}in(c, em2_3196: bitstring);
                                        {2822}let m2_3197: bitstring = em2_3196 in
                                        {2823}let (=OpenSecureChannelResponse,Ns_3198: bitstring,ST_3199: bitstring,TTL_3200: bitstring) = m2_3197 in
                                        {2824}let Kcli_3201: bitstring = h((Nc_3194,Ns_3198)) in
                                        {2825}out(c, senc(mCli(pkCli_2793,pkSess_3191),Kcli_3201))
                        )
                        else
                            {2826}let pkDisco_3202: bitstring = fail-any in
                            {2827}let v_3203: bool = (Sess = A) in
                            (
                                {2828}if v_3203 then
                                (
                                    {2829}let pkSess_3204: bitstring = pub(skA) in
                                    {2830}out(c, GetEndpointRequest);
                                    {2831}in(c, (=GetEndpointResponse,=pkSess_3204,=None,SP_3205: bitstring,UP_3206: bitstring));
                                    {2832}new Nc_3207: bitstring;
                                    {2833}let m1_3208: bitstring = (OpenSecureChannelRequest,pkCli_2793,Nc_3207) in
                                    {2834}out(c, (pkCli_2793,m1_3208));
                                    {2835}in(c, em2_3209: bitstring);
                                    {2836}let m2_3210: bitstring = em2_3209 in
                                    {2837}let (=OpenSecureChannelResponse,Ns_3211: bitstring,ST_3212: bitstring,TTL_3213: bitstring) = m2_3210 in
                                    {2838}let Kcli_3214: bitstring = h((Nc_3207,Ns_3211)) in
                                    {2839}out(c, senc(mCli(pkCli_2793,pkSess_3204),Kcli_3214))
                                )
                                else
                                    {2840}let v_3215: bool = (Sess = B) in
                                    (
                                        {2841}if v_3215 then
                                        (
                                            {2842}let pkSess_3216: bitstring = pub(skB) in
                                            {2843}out(c, GetEndpointRequest);
                                            {2844}in(c, (=GetEndpointResponse,=pkSess_3216,=None,SP_3217: bitstring,UP_3218: bitstring));
                                            {2845}new Nc_3219: bitstring;
                                            {2846}let m1_3220: bitstring = (OpenSecureChannelRequest,pkCli_2793,Nc_3219) in
                                            {2847}out(c, (pkCli_2793,m1_3220));
                                            {2848}in(c, em2_3221: bitstring);
                                            {2849}let m2_3222: bitstring = em2_3221 in
                                            {2850}let (=OpenSecureChannelResponse,Ns_3223: bitstring,ST_3224: bitstring,TTL_3225: bitstring) = m2_3222 in
                                            {2851}let Kcli_3226: bitstring = h((Nc_3219,Ns_3223)) in
                                            {2852}out(c, senc(mCli(pkCli_2793,pkSess_3216),Kcli_3226))
                                        )
                                        else
                                            {2853}let v_3227: bool = (Sess = C) in
                                            (
                                                {2854}if v_3227 then
                                                (
                                                    {2855}let pkSess_3228: bitstring = pub(skC) in
                                                    {2856}out(c, GetEndpointRequest);
                                                    {2857}in(c, (=GetEndpointResponse,=pkSess_3228,=None,SP_3229: bitstring,UP_3230: bitstring));
                                                    {2858}new Nc_3231: bitstring;
                                                    {2859}let m1_3232: bitstring = (OpenSecureChannelRequest,pkCli_2793,Nc_3231) in
                                                    {2860}out(c, (pkCli_2793,m1_3232));
                                                    {2861}in(c, em2_3233: bitstring);
                                                    {2862}let m2_3234: bitstring = em2_3233 in
                                                    {2863}let (=OpenSecureChannelResponse,Ns_3235: bitstring,ST_3236: bitstring,TTL_3237: bitstring) = m2_3234 in
                                                    {2864}let Kcli_3238: bitstring = h((Nc_3231,Ns_3235)) in
                                                    {2865}out(c, senc(mCli(pkCli_2793,pkSess_3228),Kcli_3238))
                                                )
                                                else
                                                    {2866}let pkSess_3239: bitstring = pub(sk(Sess)) in
                                                    {2867}out(c, GetEndpointRequest);
                                                    {2868}in(c, (=GetEndpointResponse,=pkSess_3239,=None,SP_3240: bitstring,UP_3241: bitstring));
                                                    {2869}new Nc_3242: bitstring;
                                                    {2870}let m1_3243: bitstring = (OpenSecureChannelRequest,pkCli_2793,Nc_3242) in
                                                    {2871}out(c, (pkCli_2793,m1_3243));
                                                    {2872}in(c, em2_3244: bitstring);
                                                    {2873}let m2_3245: bitstring = em2_3244 in
                                                    {2874}let (=OpenSecureChannelResponse,Ns_3246: bitstring,ST_3247: bitstring,TTL_3248: bitstring) = m2_3245 in
                                                    {2875}let Kcli_3249: bitstring = h((Nc_3242,Ns_3246)) in
                                                    {2876}out(c, senc(mCli(pkCli_2793,pkSess_3239),Kcli_3249))
                                            )
                                            else
                                                {2877}let pkSess_3250: bitstring = fail-any in
                                                {2878}out(c, GetEndpointRequest);
                                                {2879}in(c, (=GetEndpointResponse,=pkSess_3250,=None,SP_3251: bitstring,UP_3252: bitstring));
                                                {2880}new Nc_3253: bitstring;
                                                {2881}let m1_3254: bitstring = (OpenSecureChannelRequest,pkCli_2793,Nc_3253) in
                                                {2882}out(c, (pkCli_2793,m1_3254));
                                                {2883}in(c, em2_3255: bitstring);
                                                {2884}let m2_3256: bitstring = em2_3255 in
                                                {2885}let (=OpenSecureChannelResponse,Ns_3257: bitstring,ST_3258: bitstring,TTL_3259: bitstring) = m2_3256 in
                                                {2886}let Kcli_3260: bitstring = h((Nc_3253,Ns_3257)) in
                                                {2887}out(c, senc(mCli(pkCli_2793,pkSess_3250),Kcli_3260))
                                    )
                                    else
                                        {2888}let pkSess_3261: bitstring = fail-any in
                                        {2889}out(c, GetEndpointRequest);
                                        {2890}in(c, (=GetEndpointResponse,=pkSess_3261,=None,SP_3262: bitstring,UP_3263: bitstring));
                                        {2891}new Nc_3264: bitstring;
                                        {2892}let m1_3265: bitstring = (OpenSecureChannelRequest,pkCli_2793,Nc_3264) in
                                        {2893}out(c, (pkCli_2793,m1_3265));
                                        {2894}in(c, em2_3266: bitstring);
                                        {2895}let m2_3267: bitstring = em2_3266 in
                                        {2896}let (=OpenSecureChannelResponse,Ns_3268: bitstring,ST_3269: bitstring,TTL_3270: bitstring) = m2_3267 in
                                        {2897}let Kcli_3271: bitstring = h((Nc_3264,Ns_3268)) in
                                        {2898}out(c, senc(mCli(pkCli_2793,pkSess_3261),Kcli_3271))
                            )
                            else
                                {2899}let pkSess_3272: bitstring = fail-any in
                                {2900}out(c, GetEndpointRequest);
                                {2901}in(c, (=GetEndpointResponse,=pkSess_3272,=None,SP_3273: bitstring,UP_3274: bitstring));
                                {2902}new Nc_3275: bitstring;
                                {2903}let m1_3276: bitstring = (OpenSecureChannelRequest,pkCli_2793,Nc_3275) in
                                {2904}out(c, (pkCli_2793,m1_3276));
                                {2905}in(c, em2_3277: bitstring);
                                {2906}let m2_3278: bitstring = em2_3277 in
                                {2907}let (=OpenSecureChannelResponse,Ns_3279: bitstring,ST_3280: bitstring,TTL_3281: bitstring) = m2_3278 in
                                {2908}let Kcli_3282: bitstring = h((Nc_3275,Ns_3279)) in
                                {2909}out(c, senc(mCli(pkCli_2793,pkSess_3272),Kcli_3282))
                )
                else
                    {2910}let pkDisco_3283: bitstring = fail-any in
                    {2911}let v_3284: bool = (Sess = A) in
                    (
                        {2912}if v_3284 then
                        (
                            {2913}let pkSess_3285: bitstring = pub(skA) in
                            {2914}out(c, GetEndpointRequest);
                            {2915}in(c, (=GetEndpointResponse,=pkSess_3285,=None,SP_3286: bitstring,UP_3287: bitstring));
                            {2916}new Nc_3288: bitstring;
                            {2917}let m1_3289: bitstring = (OpenSecureChannelRequest,pkCli_2793,Nc_3288) in
                            {2918}out(c, (pkCli_2793,m1_3289));
                            {2919}in(c, em2_3290: bitstring);
                            {2920}let m2_3291: bitstring = em2_3290 in
                            {2921}let (=OpenSecureChannelResponse,Ns_3292: bitstring,ST_3293: bitstring,TTL_3294: bitstring) = m2_3291 in
                            {2922}let Kcli_3295: bitstring = h((Nc_3288,Ns_3292)) in
                            {2923}out(c, senc(mCli(pkCli_2793,pkSess_3285),Kcli_3295))
                        )
                        else
                            {2924}let v_3296: bool = (Sess = B) in
                            (
                                {2925}if v_3296 then
                                (
                                    {2926}let pkSess_3297: bitstring = pub(skB) in
                                    {2927}out(c, GetEndpointRequest);
                                    {2928}in(c, (=GetEndpointResponse,=pkSess_3297,=None,SP_3298: bitstring,UP_3299: bitstring));
                                    {2929}new Nc_3300: bitstring;
                                    {2930}let m1_3301: bitstring = (OpenSecureChannelRequest,pkCli_2793,Nc_3300) in
                                    {2931}out(c, (pkCli_2793,m1_3301));
                                    {2932}in(c, em2_3302: bitstring);
                                    {2933}let m2_3303: bitstring = em2_3302 in
                                    {2934}let (=OpenSecureChannelResponse,Ns_3304: bitstring,ST_3305: bitstring,TTL_3306: bitstring) = m2_3303 in
                                    {2935}let Kcli_3307: bitstring = h((Nc_3300,Ns_3304)) in
                                    {2936}out(c, senc(mCli(pkCli_2793,pkSess_3297),Kcli_3307))
                                )
                                else
                                    {2937}let v_3308: bool = (Sess = C) in
                                    (
                                        {2938}if v_3308 then
                                        (
                                            {2939}let pkSess_3309: bitstring = pub(skC) in
                                            {2940}out(c, GetEndpointRequest);
                                            {2941}in(c, (=GetEndpointResponse,=pkSess_3309,=None,SP_3310: bitstring,UP_3311: bitstring));
                                            {2942}new Nc_3312: bitstring;
                                            {2943}let m1_3313: bitstring = (OpenSecureChannelRequest,pkCli_2793,Nc_3312) in
                                            {2944}out(c, (pkCli_2793,m1_3313));
                                            {2945}in(c, em2_3314: bitstring);
                                            {2946}let m2_3315: bitstring = em2_3314 in
                                            {2947}let (=OpenSecureChannelResponse,Ns_3316: bitstring,ST_3317: bitstring,TTL_3318: bitstring) = m2_3315 in
                                            {2948}let Kcli_3319: bitstring = h((Nc_3312,Ns_3316)) in
                                            {2949}out(c, senc(mCli(pkCli_2793,pkSess_3309),Kcli_3319))
                                        )
                                        else
                                            {2950}let pkSess_3320: bitstring = pub(sk(Sess)) in
                                            {2951}out(c, GetEndpointRequest);
                                            {2952}in(c, (=GetEndpointResponse,=pkSess_3320,=None,SP_3321: bitstring,UP_3322: bitstring));
                                            {2953}new Nc_3323: bitstring;
                                            {2954}let m1_3324: bitstring = (OpenSecureChannelRequest,pkCli_2793,Nc_3323) in
                                            {2955}out(c, (pkCli_2793,m1_3324));
                                            {2956}in(c, em2_3325: bitstring);
                                            {2957}let m2_3326: bitstring = em2_3325 in
                                            {2958}let (=OpenSecureChannelResponse,Ns_3327: bitstring,ST_3328: bitstring,TTL_3329: bitstring) = m2_3326 in
                                            {2959}let Kcli_3330: bitstring = h((Nc_3323,Ns_3327)) in
                                            {2960}out(c, senc(mCli(pkCli_2793,pkSess_3320),Kcli_3330))
                                    )
                                    else
                                        {2961}let pkSess_3331: bitstring = fail-any in
                                        {2962}out(c, GetEndpointRequest);
                                        {2963}in(c, (=GetEndpointResponse,=pkSess_3331,=None,SP_3332: bitstring,UP_3333: bitstring));
                                        {2964}new Nc_3334: bitstring;
                                        {2965}let m1_3335: bitstring = (OpenSecureChannelRequest,pkCli_2793,Nc_3334) in
                                        {2966}out(c, (pkCli_2793,m1_3335));
                                        {2967}in(c, em2_3336: bitstring);
                                        {2968}let m2_3337: bitstring = em2_3336 in
                                        {2969}let (=OpenSecureChannelResponse,Ns_3338: bitstring,ST_3339: bitstring,TTL_3340: bitstring) = m2_3337 in
                                        {2970}let Kcli_3341: bitstring = h((Nc_3334,Ns_3338)) in
                                        {2971}out(c, senc(mCli(pkCli_2793,pkSess_3331),Kcli_3341))
                            )
                            else
                                {2972}let pkSess_3342: bitstring = fail-any in
                                {2973}out(c, GetEndpointRequest);
                                {2974}in(c, (=GetEndpointResponse,=pkSess_3342,=None,SP_3343: bitstring,UP_3344: bitstring));
                                {2975}new Nc_3345: bitstring;
                                {2976}let m1_3346: bitstring = (OpenSecureChannelRequest,pkCli_2793,Nc_3345) in
                                {2977}out(c, (pkCli_2793,m1_3346));
                                {2978}in(c, em2_3347: bitstring);
                                {2979}let m2_3348: bitstring = em2_3347 in
                                {2980}let (=OpenSecureChannelResponse,Ns_3349: bitstring,ST_3350: bitstring,TTL_3351: bitstring) = m2_3348 in
                                {2981}let Kcli_3352: bitstring = h((Nc_3345,Ns_3349)) in
                                {2982}out(c, senc(mCli(pkCli_2793,pkSess_3342),Kcli_3352))
                    )
                    else
                        {2983}let pkSess_3353: bitstring = fail-any in
                        {2984}out(c, GetEndpointRequest);
                        {2985}in(c, (=GetEndpointResponse,=pkSess_3353,=None,SP_3354: bitstring,UP_3355: bitstring));
                        {2986}new Nc_3356: bitstring;
                        {2987}let m1_3357: bitstring = (OpenSecureChannelRequest,pkCli_2793,Nc_3356) in
                        {2988}out(c, (pkCli_2793,m1_3357));
                        {2989}in(c, em2_3358: bitstring);
                        {2990}let m2_3359: bitstring = em2_3358 in
                        {2991}let (=OpenSecureChannelResponse,Ns_3360: bitstring,ST_3361: bitstring,TTL_3362: bitstring) = m2_3359 in
                        {2992}let Kcli_3363: bitstring = h((Nc_3356,Ns_3360)) in
                        {2993}out(c, senc(mCli(pkCli_2793,pkSess_3353),Kcli_3363))
    )
    else
        {2994}let skCli_3364: bitstring = fail-any in
        {2995}let pkCli_3365: bitstring = pub(skCli_3364) in
        {2996}let v_3366: bool = (Disco = A) in
        (
            {2997}if v_3366 then
            (
                {2998}let pkDisco_3367: bitstring = pub(skA) in
                {2999}let v_3368: bool = (Sess = A) in
                (
                    {3000}if v_3368 then
                    (
                        {3001}let pkSess_3369: bitstring = pub(skA) in
                        {3002}out(c, GetEndpointRequest);
                        {3003}in(c, (=GetEndpointResponse,=pkSess_3369,=None,SP_3370: bitstring,UP_3371: bitstring));
                        {3004}new Nc_3372: bitstring;
                        {3005}let m1_3373: bitstring = (OpenSecureChannelRequest,pkCli_3365,Nc_3372) in
                        {3006}out(c, (pkCli_3365,m1_3373));
                        {3007}in(c, em2_3374: bitstring);
                        {3008}let m2_3375: bitstring = em2_3374 in
                        {3009}let (=OpenSecureChannelResponse,Ns_3376: bitstring,ST_3377: bitstring,TTL_3378: bitstring) = m2_3375 in
                        {3010}let Kcli_3379: bitstring = h((Nc_3372,Ns_3376)) in
                        {3011}out(c, senc(mCli(pkCli_3365,pkSess_3369),Kcli_3379))
                    )
                    else
                        {3012}let v_3380: bool = (Sess = B) in
                        (
                            {3013}if v_3380 then
                            (
                                {3014}let pkSess_3381: bitstring = pub(skB) in
                                {3015}out(c, GetEndpointRequest);
                                {3016}in(c, (=GetEndpointResponse,=pkSess_3381,=None,SP_3382: bitstring,UP_3383: bitstring));
                                {3017}new Nc_3384: bitstring;
                                {3018}let m1_3385: bitstring = (OpenSecureChannelRequest,pkCli_3365,Nc_3384) in
                                {3019}out(c, (pkCli_3365,m1_3385));
                                {3020}in(c, em2_3386: bitstring);
                                {3021}let m2_3387: bitstring = em2_3386 in
                                {3022}let (=OpenSecureChannelResponse,Ns_3388: bitstring,ST_3389: bitstring,TTL_3390: bitstring) = m2_3387 in
                                {3023}let Kcli_3391: bitstring = h((Nc_3384,Ns_3388)) in
                                {3024}out(c, senc(mCli(pkCli_3365,pkSess_3381),Kcli_3391))
                            )
                            else
                                {3025}let v_3392: bool = (Sess = C) in
                                (
                                    {3026}if v_3392 then
                                    (
                                        {3027}let pkSess_3393: bitstring = pub(skC) in
                                        {3028}out(c, GetEndpointRequest);
                                        {3029}in(c, (=GetEndpointResponse,=pkSess_3393,=None,SP_3394: bitstring,UP_3395: bitstring));
                                        {3030}new Nc_3396: bitstring;
                                        {3031}let m1_3397: bitstring = (OpenSecureChannelRequest,pkCli_3365,Nc_3396) in
                                        {3032}out(c, (pkCli_3365,m1_3397));
                                        {3033}in(c, em2_3398: bitstring);
                                        {3034}let m2_3399: bitstring = em2_3398 in
                                        {3035}let (=OpenSecureChannelResponse,Ns_3400: bitstring,ST_3401: bitstring,TTL_3402: bitstring) = m2_3399 in
                                        {3036}let Kcli_3403: bitstring = h((Nc_3396,Ns_3400)) in
                                        {3037}out(c, senc(mCli(pkCli_3365,pkSess_3393),Kcli_3403))
                                    )
                                    else
                                        {3038}let pkSess_3404: bitstring = pub(sk(Sess)) in
                                        {3039}out(c, GetEndpointRequest);
                                        {3040}in(c, (=GetEndpointResponse,=pkSess_3404,=None,SP_3405: bitstring,UP_3406: bitstring));
                                        {3041}new Nc_3407: bitstring;
                                        {3042}let m1_3408: bitstring = (OpenSecureChannelRequest,pkCli_3365,Nc_3407) in
                                        {3043}out(c, (pkCli_3365,m1_3408));
                                        {3044}in(c, em2_3409: bitstring);
                                        {3045}let m2_3410: bitstring = em2_3409 in
                                        {3046}let (=OpenSecureChannelResponse,Ns_3411: bitstring,ST_3412: bitstring,TTL_3413: bitstring) = m2_3410 in
                                        {3047}let Kcli_3414: bitstring = h((Nc_3407,Ns_3411)) in
                                        {3048}out(c, senc(mCli(pkCli_3365,pkSess_3404),Kcli_3414))
                                )
                                else
                                    {3049}let pkSess_3415: bitstring = fail-any in
                                    {3050}out(c, GetEndpointRequest);
                                    {3051}in(c, (=GetEndpointResponse,=pkSess_3415,=None,SP_3416: bitstring,UP_3417: bitstring));
                                    {3052}new Nc_3418: bitstring;
                                    {3053}let m1_3419: bitstring = (OpenSecureChannelRequest,pkCli_3365,Nc_3418) in
                                    {3054}out(c, (pkCli_3365,m1_3419));
                                    {3055}in(c, em2_3420: bitstring);
                                    {3056}let m2_3421: bitstring = em2_3420 in
                                    {3057}let (=OpenSecureChannelResponse,Ns_3422: bitstring,ST_3423: bitstring,TTL_3424: bitstring) = m2_3421 in
                                    {3058}let Kcli_3425: bitstring = h((Nc_3418,Ns_3422)) in
                                    {3059}out(c, senc(mCli(pkCli_3365,pkSess_3415),Kcli_3425))
                        )
                        else
                            {3060}let pkSess_3426: bitstring = fail-any in
                            {3061}out(c, GetEndpointRequest);
                            {3062}in(c, (=GetEndpointResponse,=pkSess_3426,=None,SP_3427: bitstring,UP_3428: bitstring));
                            {3063}new Nc_3429: bitstring;
                            {3064}let m1_3430: bitstring = (OpenSecureChannelRequest,pkCli_3365,Nc_3429) in
                            {3065}out(c, (pkCli_3365,m1_3430));
                            {3066}in(c, em2_3431: bitstring);
                            {3067}let m2_3432: bitstring = em2_3431 in
                            {3068}let (=OpenSecureChannelResponse,Ns_3433: bitstring,ST_3434: bitstring,TTL_3435: bitstring) = m2_3432 in
                            {3069}let Kcli_3436: bitstring = h((Nc_3429,Ns_3433)) in
                            {3070}out(c, senc(mCli(pkCli_3365,pkSess_3426),Kcli_3436))
                )
                else
                    {3071}let pkSess_3437: bitstring = fail-any in
                    {3072}out(c, GetEndpointRequest);
                    {3073}in(c, (=GetEndpointResponse,=pkSess_3437,=None,SP_3438: bitstring,UP_3439: bitstring));
                    {3074}new Nc_3440: bitstring;
                    {3075}let m1_3441: bitstring = (OpenSecureChannelRequest,pkCli_3365,Nc_3440) in
                    {3076}out(c, (pkCli_3365,m1_3441));
                    {3077}in(c, em2_3442: bitstring);
                    {3078}let m2_3443: bitstring = em2_3442 in
                    {3079}let (=OpenSecureChannelResponse,Ns_3444: bitstring,ST_3445: bitstring,TTL_3446: bitstring) = m2_3443 in
                    {3080}let Kcli_3447: bitstring = h((Nc_3440,Ns_3444)) in
                    {3081}out(c, senc(mCli(pkCli_3365,pkSess_3437),Kcli_3447))
            )
            else
                {3082}let v_3448: bool = (Disco = B) in
                (
                    {3083}if v_3448 then
                    (
                        {3084}let pkDisco_3449: bitstring = pub(skB) in
                        {3085}let v_3450: bool = (Sess = A) in
                        (
                            {3086}if v_3450 then
                            (
                                {3087}let pkSess_3451: bitstring = pub(skA) in
                                {3088}out(c, GetEndpointRequest);
                                {3089}in(c, (=GetEndpointResponse,=pkSess_3451,=None,SP_3452: bitstring,UP_3453: bitstring));
                                {3090}new Nc_3454: bitstring;
                                {3091}let m1_3455: bitstring = (OpenSecureChannelRequest,pkCli_3365,Nc_3454) in
                                {3092}out(c, (pkCli_3365,m1_3455));
                                {3093}in(c, em2_3456: bitstring);
                                {3094}let m2_3457: bitstring = em2_3456 in
                                {3095}let (=OpenSecureChannelResponse,Ns_3458: bitstring,ST_3459: bitstring,TTL_3460: bitstring) = m2_3457 in
                                {3096}let Kcli_3461: bitstring = h((Nc_3454,Ns_3458)) in
                                {3097}out(c, senc(mCli(pkCli_3365,pkSess_3451),Kcli_3461))
                            )
                            else
                                {3098}let v_3462: bool = (Sess = B) in
                                (
                                    {3099}if v_3462 then
                                    (
                                        {3100}let pkSess_3463: bitstring = pub(skB) in
                                        {3101}out(c, GetEndpointRequest);
                                        {3102}in(c, (=GetEndpointResponse,=pkSess_3463,=None,SP_3464: bitstring,UP_3465: bitstring));
                                        {3103}new Nc_3466: bitstring;
                                        {3104}let m1_3467: bitstring = (OpenSecureChannelRequest,pkCli_3365,Nc_3466) in
                                        {3105}out(c, (pkCli_3365,m1_3467));
                                        {3106}in(c, em2_3468: bitstring);
                                        {3107}let m2_3469: bitstring = em2_3468 in
                                        {3108}let (=OpenSecureChannelResponse,Ns_3470: bitstring,ST_3471: bitstring,TTL_3472: bitstring) = m2_3469 in
                                        {3109}let Kcli_3473: bitstring = h((Nc_3466,Ns_3470)) in
                                        {3110}out(c, senc(mCli(pkCli_3365,pkSess_3463),Kcli_3473))
                                    )
                                    else
                                        {3111}let v_3474: bool = (Sess = C) in
                                        (
                                            {3112}if v_3474 then
                                            (
                                                {3113}let pkSess_3475: bitstring = pub(skC) in
                                                {3114}out(c, GetEndpointRequest);
                                                {3115}in(c, (=GetEndpointResponse,=pkSess_3475,=None,SP_3476: bitstring,UP_3477: bitstring));
                                                {3116}new Nc_3478: bitstring;
                                                {3117}let m1_3479: bitstring = (OpenSecureChannelRequest,pkCli_3365,Nc_3478) in
                                                {3118}out(c, (pkCli_3365,m1_3479));
                                                {3119}in(c, em2_3480: bitstring);
                                                {3120}let m2_3481: bitstring = em2_3480 in
                                                {3121}let (=OpenSecureChannelResponse,Ns_3482: bitstring,ST_3483: bitstring,TTL_3484: bitstring) = m2_3481 in
                                                {3122}let Kcli_3485: bitstring = h((Nc_3478,Ns_3482)) in
                                                {3123}out(c, senc(mCli(pkCli_3365,pkSess_3475),Kcli_3485))
                                            )
                                            else
                                                {3124}let pkSess_3486: bitstring = pub(sk(Sess)) in
                                                {3125}out(c, GetEndpointRequest);
                                                {3126}in(c, (=GetEndpointResponse,=pkSess_3486,=None,SP_3487: bitstring,UP_3488: bitstring));
                                                {3127}new Nc_3489: bitstring;
                                                {3128}let m1_3490: bitstring = (OpenSecureChannelRequest,pkCli_3365,Nc_3489) in
                                                {3129}out(c, (pkCli_3365,m1_3490));
                                                {3130}in(c, em2_3491: bitstring);
                                                {3131}let m2_3492: bitstring = em2_3491 in
                                                {3132}let (=OpenSecureChannelResponse,Ns_3493: bitstring,ST_3494: bitstring,TTL_3495: bitstring) = m2_3492 in
                                                {3133}let Kcli_3496: bitstring = h((Nc_3489,Ns_3493)) in
                                                {3134}out(c, senc(mCli(pkCli_3365,pkSess_3486),Kcli_3496))
                                        )
                                        else
                                            {3135}let pkSess_3497: bitstring = fail-any in
                                            {3136}out(c, GetEndpointRequest);
                                            {3137}in(c, (=GetEndpointResponse,=pkSess_3497,=None,SP_3498: bitstring,UP_3499: bitstring));
                                            {3138}new Nc_3500: bitstring;
                                            {3139}let m1_3501: bitstring = (OpenSecureChannelRequest,pkCli_3365,Nc_3500) in
                                            {3140}out(c, (pkCli_3365,m1_3501));
                                            {3141}in(c, em2_3502: bitstring);
                                            {3142}let m2_3503: bitstring = em2_3502 in
                                            {3143}let (=OpenSecureChannelResponse,Ns_3504: bitstring,ST_3505: bitstring,TTL_3506: bitstring) = m2_3503 in
                                            {3144}let Kcli_3507: bitstring = h((Nc_3500,Ns_3504)) in
                                            {3145}out(c, senc(mCli(pkCli_3365,pkSess_3497),Kcli_3507))
                                )
                                else
                                    {3146}let pkSess_3508: bitstring = fail-any in
                                    {3147}out(c, GetEndpointRequest);
                                    {3148}in(c, (=GetEndpointResponse,=pkSess_3508,=None,SP_3509: bitstring,UP_3510: bitstring));
                                    {3149}new Nc_3511: bitstring;
                                    {3150}let m1_3512: bitstring = (OpenSecureChannelRequest,pkCli_3365,Nc_3511) in
                                    {3151}out(c, (pkCli_3365,m1_3512));
                                    {3152}in(c, em2_3513: bitstring);
                                    {3153}let m2_3514: bitstring = em2_3513 in
                                    {3154}let (=OpenSecureChannelResponse,Ns_3515: bitstring,ST_3516: bitstring,TTL_3517: bitstring) = m2_3514 in
                                    {3155}let Kcli_3518: bitstring = h((Nc_3511,Ns_3515)) in
                                    {3156}out(c, senc(mCli(pkCli_3365,pkSess_3508),Kcli_3518))
                        )
                        else
                            {3157}let pkSess_3519: bitstring = fail-any in
                            {3158}out(c, GetEndpointRequest);
                            {3159}in(c, (=GetEndpointResponse,=pkSess_3519,=None,SP_3520: bitstring,UP_3521: bitstring));
                            {3160}new Nc_3522: bitstring;
                            {3161}let m1_3523: bitstring = (OpenSecureChannelRequest,pkCli_3365,Nc_3522) in
                            {3162}out(c, (pkCli_3365,m1_3523));
                            {3163}in(c, em2_3524: bitstring);
                            {3164}let m2_3525: bitstring = em2_3524 in
                            {3165}let (=OpenSecureChannelResponse,Ns_3526: bitstring,ST_3527: bitstring,TTL_3528: bitstring) = m2_3525 in
                            {3166}let Kcli_3529: bitstring = h((Nc_3522,Ns_3526)) in
                            {3167}out(c, senc(mCli(pkCli_3365,pkSess_3519),Kcli_3529))
                    )
                    else
                        {3168}let v_3530: bool = (Disco = C) in
                        (
                            {3169}if v_3530 then
                            (
                                {3170}let pkDisco_3531: bitstring = pub(skC) in
                                {3171}let v_3532: bool = (Sess = A) in
                                (
                                    {3172}if v_3532 then
                                    (
                                        {3173}let pkSess_3533: bitstring = pub(skA) in
                                        {3174}out(c, GetEndpointRequest);
                                        {3175}in(c, (=GetEndpointResponse,=pkSess_3533,=None,SP_3534: bitstring,UP_3535: bitstring));
                                        {3176}new Nc_3536: bitstring;
                                        {3177}let m1_3537: bitstring = (OpenSecureChannelRequest,pkCli_3365,Nc_3536) in
                                        {3178}out(c, (pkCli_3365,m1_3537));
                                        {3179}in(c, em2_3538: bitstring);
                                        {3180}let m2_3539: bitstring = em2_3538 in
                                        {3181}let (=OpenSecureChannelResponse,Ns_3540: bitstring,ST_3541: bitstring,TTL_3542: bitstring) = m2_3539 in
                                        {3182}let Kcli_3543: bitstring = h((Nc_3536,Ns_3540)) in
                                        {3183}out(c, senc(mCli(pkCli_3365,pkSess_3533),Kcli_3543))
                                    )
                                    else
                                        {3184}let v_3544: bool = (Sess = B) in
                                        (
                                            {3185}if v_3544 then
                                            (
                                                {3186}let pkSess_3545: bitstring = pub(skB) in
                                                {3187}out(c, GetEndpointRequest);
                                                {3188}in(c, (=GetEndpointResponse,=pkSess_3545,=None,SP_3546: bitstring,UP_3547: bitstring));
                                                {3189}new Nc_3548: bitstring;
                                                {3190}let m1_3549: bitstring = (OpenSecureChannelRequest,pkCli_3365,Nc_3548) in
                                                {3191}out(c, (pkCli_3365,m1_3549));
                                                {3192}in(c, em2_3550: bitstring);
                                                {3193}let m2_3551: bitstring = em2_3550 in
                                                {3194}let (=OpenSecureChannelResponse,Ns_3552: bitstring,ST_3553: bitstring,TTL_3554: bitstring) = m2_3551 in
                                                {3195}let Kcli_3555: bitstring = h((Nc_3548,Ns_3552)) in
                                                {3196}out(c, senc(mCli(pkCli_3365,pkSess_3545),Kcli_3555))
                                            )
                                            else
                                                {3197}let v_3556: bool = (Sess = C) in
                                                (
                                                    {3198}if v_3556 then
                                                    (
                                                        {3199}let pkSess_3557: bitstring = pub(skC) in
                                                        {3200}out(c, GetEndpointRequest);
                                                        {3201}in(c, (=GetEndpointResponse,=pkSess_3557,=None,SP_3558: bitstring,UP_3559: bitstring));
                                                        {3202}new Nc_3560: bitstring;
                                                        {3203}let m1_3561: bitstring = (OpenSecureChannelRequest,pkCli_3365,Nc_3560) in
                                                        {3204}out(c, (pkCli_3365,m1_3561));
                                                        {3205}in(c, em2_3562: bitstring);
                                                        {3206}let m2_3563: bitstring = em2_3562 in
                                                        {3207}let (=OpenSecureChannelResponse,Ns_3564: bitstring,ST_3565: bitstring,TTL_3566: bitstring) = m2_3563 in
                                                        {3208}let Kcli_3567: bitstring = h((Nc_3560,Ns_3564)) in
                                                        {3209}out(c, senc(mCli(pkCli_3365,pkSess_3557),Kcli_3567))
                                                    )
                                                    else
                                                        {3210}let pkSess_3568: bitstring = pub(sk(Sess)) in
                                                        {3211}out(c, GetEndpointRequest);
                                                        {3212}in(c, (=GetEndpointResponse,=pkSess_3568,=None,SP_3569: bitstring,UP_3570: bitstring));
                                                        {3213}new Nc_3571: bitstring;
                                                        {3214}let m1_3572: bitstring = (OpenSecureChannelRequest,pkCli_3365,Nc_3571) in
                                                        {3215}out(c, (pkCli_3365,m1_3572));
                                                        {3216}in(c, em2_3573: bitstring);
                                                        {3217}let m2_3574: bitstring = em2_3573 in
                                                        {3218}let (=OpenSecureChannelResponse,Ns_3575: bitstring,ST_3576: bitstring,TTL_3577: bitstring) = m2_3574 in
                                                        {3219}let Kcli_3578: bitstring = h((Nc_3571,Ns_3575)) in
                                                        {3220}out(c, senc(mCli(pkCli_3365,pkSess_3568),Kcli_3578))
                                                )
                                                else
                                                    {3221}let pkSess_3579: bitstring = fail-any in
                                                    {3222}out(c, GetEndpointRequest);
                                                    {3223}in(c, (=GetEndpointResponse,=pkSess_3579,=None,SP_3580: bitstring,UP_3581: bitstring));
                                                    {3224}new Nc_3582: bitstring;
                                                    {3225}let m1_3583: bitstring = (OpenSecureChannelRequest,pkCli_3365,Nc_3582) in
                                                    {3226}out(c, (pkCli_3365,m1_3583));
                                                    {3227}in(c, em2_3584: bitstring);
                                                    {3228}let m2_3585: bitstring = em2_3584 in
                                                    {3229}let (=OpenSecureChannelResponse,Ns_3586: bitstring,ST_3587: bitstring,TTL_3588: bitstring) = m2_3585 in
                                                    {3230}let Kcli_3589: bitstring = h((Nc_3582,Ns_3586)) in
                                                    {3231}out(c, senc(mCli(pkCli_3365,pkSess_3579),Kcli_3589))
                                        )
                                        else
                                            {3232}let pkSess_3590: bitstring = fail-any in
                                            {3233}out(c, GetEndpointRequest);
                                            {3234}in(c, (=GetEndpointResponse,=pkSess_3590,=None,SP_3591: bitstring,UP_3592: bitstring));
                                            {3235}new Nc_3593: bitstring;
                                            {3236}let m1_3594: bitstring = (OpenSecureChannelRequest,pkCli_3365,Nc_3593) in
                                            {3237}out(c, (pkCli_3365,m1_3594));
                                            {3238}in(c, em2_3595: bitstring);
                                            {3239}let m2_3596: bitstring = em2_3595 in
                                            {3240}let (=OpenSecureChannelResponse,Ns_3597: bitstring,ST_3598: bitstring,TTL_3599: bitstring) = m2_3596 in
                                            {3241}let Kcli_3600: bitstring = h((Nc_3593,Ns_3597)) in
                                            {3242}out(c, senc(mCli(pkCli_3365,pkSess_3590),Kcli_3600))
                                )
                                else
                                    {3243}let pkSess_3601: bitstring = fail-any in
                                    {3244}out(c, GetEndpointRequest);
                                    {3245}in(c, (=GetEndpointResponse,=pkSess_3601,=None,SP_3602: bitstring,UP_3603: bitstring));
                                    {3246}new Nc_3604: bitstring;
                                    {3247}let m1_3605: bitstring = (OpenSecureChannelRequest,pkCli_3365,Nc_3604) in
                                    {3248}out(c, (pkCli_3365,m1_3605));
                                    {3249}in(c, em2_3606: bitstring);
                                    {3250}let m2_3607: bitstring = em2_3606 in
                                    {3251}let (=OpenSecureChannelResponse,Ns_3608: bitstring,ST_3609: bitstring,TTL_3610: bitstring) = m2_3607 in
                                    {3252}let Kcli_3611: bitstring = h((Nc_3604,Ns_3608)) in
                                    {3253}out(c, senc(mCli(pkCli_3365,pkSess_3601),Kcli_3611))
                            )
                            else
                                {3254}let pkDisco_3612: bitstring = pub(sk(Disco)) in
                                {3255}let v_3613: bool = (Sess = A) in
                                (
                                    {3256}if v_3613 then
                                    (
                                        {3257}let pkSess_3614: bitstring = pub(skA) in
                                        {3258}out(c, GetEndpointRequest);
                                        {3259}in(c, (=GetEndpointResponse,=pkSess_3614,=None,SP_3615: bitstring,UP_3616: bitstring));
                                        {3260}new Nc_3617: bitstring;
                                        {3261}let m1_3618: bitstring = (OpenSecureChannelRequest,pkCli_3365,Nc_3617) in
                                        {3262}out(c, (pkCli_3365,m1_3618));
                                        {3263}in(c, em2_3619: bitstring);
                                        {3264}let m2_3620: bitstring = em2_3619 in
                                        {3265}let (=OpenSecureChannelResponse,Ns_3621: bitstring,ST_3622: bitstring,TTL_3623: bitstring) = m2_3620 in
                                        {3266}let Kcli_3624: bitstring = h((Nc_3617,Ns_3621)) in
                                        {3267}out(c, senc(mCli(pkCli_3365,pkSess_3614),Kcli_3624))
                                    )
                                    else
                                        {3268}let v_3625: bool = (Sess = B) in
                                        (
                                            {3269}if v_3625 then
                                            (
                                                {3270}let pkSess_3626: bitstring = pub(skB) in
                                                {3271}out(c, GetEndpointRequest);
                                                {3272}in(c, (=GetEndpointResponse,=pkSess_3626,=None,SP_3627: bitstring,UP_3628: bitstring));
                                                {3273}new Nc_3629: bitstring;
                                                {3274}let m1_3630: bitstring = (OpenSecureChannelRequest,pkCli_3365,Nc_3629) in
                                                {3275}out(c, (pkCli_3365,m1_3630));
                                                {3276}in(c, em2_3631: bitstring);
                                                {3277}let m2_3632: bitstring = em2_3631 in
                                                {3278}let (=OpenSecureChannelResponse,Ns_3633: bitstring,ST_3634: bitstring,TTL_3635: bitstring) = m2_3632 in
                                                {3279}let Kcli_3636: bitstring = h((Nc_3629,Ns_3633)) in
                                                {3280}out(c, senc(mCli(pkCli_3365,pkSess_3626),Kcli_3636))
                                            )
                                            else
                                                {3281}let v_3637: bool = (Sess = C) in
                                                (
                                                    {3282}if v_3637 then
                                                    (
                                                        {3283}let pkSess_3638: bitstring = pub(skC) in
                                                        {3284}out(c, GetEndpointRequest);
                                                        {3285}in(c, (=GetEndpointResponse,=pkSess_3638,=None,SP_3639: bitstring,UP_3640: bitstring));
                                                        {3286}new Nc_3641: bitstring;
                                                        {3287}let m1_3642: bitstring = (OpenSecureChannelRequest,pkCli_3365,Nc_3641) in
                                                        {3288}out(c, (pkCli_3365,m1_3642));
                                                        {3289}in(c, em2_3643: bitstring);
                                                        {3290}let m2_3644: bitstring = em2_3643 in
                                                        {3291}let (=OpenSecureChannelResponse,Ns_3645: bitstring,ST_3646: bitstring,TTL_3647: bitstring) = m2_3644 in
                                                        {3292}let Kcli_3648: bitstring = h((Nc_3641,Ns_3645)) in
                                                        {3293}out(c, senc(mCli(pkCli_3365,pkSess_3638),Kcli_3648))
                                                    )
                                                    else
                                                        {3294}let pkSess_3649: bitstring = pub(sk(Sess)) in
                                                        {3295}out(c, GetEndpointRequest);
                                                        {3296}in(c, (=GetEndpointResponse,=pkSess_3649,=None,SP_3650: bitstring,UP_3651: bitstring));
                                                        {3297}new Nc_3652: bitstring;
                                                        {3298}let m1_3653: bitstring = (OpenSecureChannelRequest,pkCli_3365,Nc_3652) in
                                                        {3299}out(c, (pkCli_3365,m1_3653));
                                                        {3300}in(c, em2_3654: bitstring);
                                                        {3301}let m2_3655: bitstring = em2_3654 in
                                                        {3302}let (=OpenSecureChannelResponse,Ns_3656: bitstring,ST_3657: bitstring,TTL_3658: bitstring) = m2_3655 in
                                                        {3303}let Kcli_3659: bitstring = h((Nc_3652,Ns_3656)) in
                                                        {3304}out(c, senc(mCli(pkCli_3365,pkSess_3649),Kcli_3659))
                                                )
                                                else
                                                    {3305}let pkSess_3660: bitstring = fail-any in
                                                    {3306}out(c, GetEndpointRequest);
                                                    {3307}in(c, (=GetEndpointResponse,=pkSess_3660,=None,SP_3661: bitstring,UP_3662: bitstring));
                                                    {3308}new Nc_3663: bitstring;
                                                    {3309}let m1_3664: bitstring = (OpenSecureChannelRequest,pkCli_3365,Nc_3663) in
                                                    {3310}out(c, (pkCli_3365,m1_3664));
                                                    {3311}in(c, em2_3665: bitstring);
                                                    {3312}let m2_3666: bitstring = em2_3665 in
                                                    {3313}let (=OpenSecureChannelResponse,Ns_3667: bitstring,ST_3668: bitstring,TTL_3669: bitstring) = m2_3666 in
                                                    {3314}let Kcli_3670: bitstring = h((Nc_3663,Ns_3667)) in
                                                    {3315}out(c, senc(mCli(pkCli_3365,pkSess_3660),Kcli_3670))
                                        )
                                        else
                                            {3316}let pkSess_3671: bitstring = fail-any in
                                            {3317}out(c, GetEndpointRequest);
                                            {3318}in(c, (=GetEndpointResponse,=pkSess_3671,=None,SP_3672: bitstring,UP_3673: bitstring));
                                            {3319}new Nc_3674: bitstring;
                                            {3320}let m1_3675: bitstring = (OpenSecureChannelRequest,pkCli_3365,Nc_3674) in
                                            {3321}out(c, (pkCli_3365,m1_3675));
                                            {3322}in(c, em2_3676: bitstring);
                                            {3323}let m2_3677: bitstring = em2_3676 in
                                            {3324}let (=OpenSecureChannelResponse,Ns_3678: bitstring,ST_3679: bitstring,TTL_3680: bitstring) = m2_3677 in
                                            {3325}let Kcli_3681: bitstring = h((Nc_3674,Ns_3678)) in
                                            {3326}out(c, senc(mCli(pkCli_3365,pkSess_3671),Kcli_3681))
                                )
                                else
                                    {3327}let pkSess_3682: bitstring = fail-any in
                                    {3328}out(c, GetEndpointRequest);
                                    {3329}in(c, (=GetEndpointResponse,=pkSess_3682,=None,SP_3683: bitstring,UP_3684: bitstring));
                                    {3330}new Nc_3685: bitstring;
                                    {3331}let m1_3686: bitstring = (OpenSecureChannelRequest,pkCli_3365,Nc_3685) in
                                    {3332}out(c, (pkCli_3365,m1_3686));
                                    {3333}in(c, em2_3687: bitstring);
                                    {3334}let m2_3688: bitstring = em2_3687 in
                                    {3335}let (=OpenSecureChannelResponse,Ns_3689: bitstring,ST_3690: bitstring,TTL_3691: bitstring) = m2_3688 in
                                    {3336}let Kcli_3692: bitstring = h((Nc_3685,Ns_3689)) in
                                    {3337}out(c, senc(mCli(pkCli_3365,pkSess_3682),Kcli_3692))
                        )
                        else
                            {3338}let pkDisco_3693: bitstring = fail-any in
                            {3339}let v_3694: bool = (Sess = A) in
                            (
                                {3340}if v_3694 then
                                (
                                    {3341}let pkSess_3695: bitstring = pub(skA) in
                                    {3342}out(c, GetEndpointRequest);
                                    {3343}in(c, (=GetEndpointResponse,=pkSess_3695,=None,SP_3696: bitstring,UP_3697: bitstring));
                                    {3344}new Nc_3698: bitstring;
                                    {3345}let m1_3699: bitstring = (OpenSecureChannelRequest,pkCli_3365,Nc_3698) in
                                    {3346}out(c, (pkCli_3365,m1_3699));
                                    {3347}in(c, em2_3700: bitstring);
                                    {3348}let m2_3701: bitstring = em2_3700 in
                                    {3349}let (=OpenSecureChannelResponse,Ns_3702: bitstring,ST_3703: bitstring,TTL_3704: bitstring) = m2_3701 in
                                    {3350}let Kcli_3705: bitstring = h((Nc_3698,Ns_3702)) in
                                    {3351}out(c, senc(mCli(pkCli_3365,pkSess_3695),Kcli_3705))
                                )
                                else
                                    {3352}let v_3706: bool = (Sess = B) in
                                    (
                                        {3353}if v_3706 then
                                        (
                                            {3354}let pkSess_3707: bitstring = pub(skB) in
                                            {3355}out(c, GetEndpointRequest);
                                            {3356}in(c, (=GetEndpointResponse,=pkSess_3707,=None,SP_3708: bitstring,UP_3709: bitstring));
                                            {3357}new Nc_3710: bitstring;
                                            {3358}let m1_3711: bitstring = (OpenSecureChannelRequest,pkCli_3365,Nc_3710) in
                                            {3359}out(c, (pkCli_3365,m1_3711));
                                            {3360}in(c, em2_3712: bitstring);
                                            {3361}let m2_3713: bitstring = em2_3712 in
                                            {3362}let (=OpenSecureChannelResponse,Ns_3714: bitstring,ST_3715: bitstring,TTL_3716: bitstring) = m2_3713 in
                                            {3363}let Kcli_3717: bitstring = h((Nc_3710,Ns_3714)) in
                                            {3364}out(c, senc(mCli(pkCli_3365,pkSess_3707),Kcli_3717))
                                        )
                                        else
                                            {3365}let v_3718: bool = (Sess = C) in
                                            (
                                                {3366}if v_3718 then
                                                (
                                                    {3367}let pkSess_3719: bitstring = pub(skC) in
                                                    {3368}out(c, GetEndpointRequest);
                                                    {3369}in(c, (=GetEndpointResponse,=pkSess_3719,=None,SP_3720: bitstring,UP_3721: bitstring));
                                                    {3370}new Nc_3722: bitstring;
                                                    {3371}let m1_3723: bitstring = (OpenSecureChannelRequest,pkCli_3365,Nc_3722) in
                                                    {3372}out(c, (pkCli_3365,m1_3723));
                                                    {3373}in(c, em2_3724: bitstring);
                                                    {3374}let m2_3725: bitstring = em2_3724 in
                                                    {3375}let (=OpenSecureChannelResponse,Ns_3726: bitstring,ST_3727: bitstring,TTL_3728: bitstring) = m2_3725 in
                                                    {3376}let Kcli_3729: bitstring = h((Nc_3722,Ns_3726)) in
                                                    {3377}out(c, senc(mCli(pkCli_3365,pkSess_3719),Kcli_3729))
                                                )
                                                else
                                                    {3378}let pkSess_3730: bitstring = pub(sk(Sess)) in
                                                    {3379}out(c, GetEndpointRequest);
                                                    {3380}in(c, (=GetEndpointResponse,=pkSess_3730,=None,SP_3731: bitstring,UP_3732: bitstring));
                                                    {3381}new Nc_3733: bitstring;
                                                    {3382}let m1_3734: bitstring = (OpenSecureChannelRequest,pkCli_3365,Nc_3733) in
                                                    {3383}out(c, (pkCli_3365,m1_3734));
                                                    {3384}in(c, em2_3735: bitstring);
                                                    {3385}let m2_3736: bitstring = em2_3735 in
                                                    {3386}let (=OpenSecureChannelResponse,Ns_3737: bitstring,ST_3738: bitstring,TTL_3739: bitstring) = m2_3736 in
                                                    {3387}let Kcli_3740: bitstring = h((Nc_3733,Ns_3737)) in
                                                    {3388}out(c, senc(mCli(pkCli_3365,pkSess_3730),Kcli_3740))
                                            )
                                            else
                                                {3389}let pkSess_3741: bitstring = fail-any in
                                                {3390}out(c, GetEndpointRequest);
                                                {3391}in(c, (=GetEndpointResponse,=pkSess_3741,=None,SP_3742: bitstring,UP_3743: bitstring));
                                                {3392}new Nc_3744: bitstring;
                                                {3393}let m1_3745: bitstring = (OpenSecureChannelRequest,pkCli_3365,Nc_3744) in
                                                {3394}out(c, (pkCli_3365,m1_3745));
                                                {3395}in(c, em2_3746: bitstring);
                                                {3396}let m2_3747: bitstring = em2_3746 in
                                                {3397}let (=OpenSecureChannelResponse,Ns_3748: bitstring,ST_3749: bitstring,TTL_3750: bitstring) = m2_3747 in
                                                {3398}let Kcli_3751: bitstring = h((Nc_3744,Ns_3748)) in
                                                {3399}out(c, senc(mCli(pkCli_3365,pkSess_3741),Kcli_3751))
                                    )
                                    else
                                        {3400}let pkSess_3752: bitstring = fail-any in
                                        {3401}out(c, GetEndpointRequest);
                                        {3402}in(c, (=GetEndpointResponse,=pkSess_3752,=None,SP_3753: bitstring,UP_3754: bitstring));
                                        {3403}new Nc_3755: bitstring;
                                        {3404}let m1_3756: bitstring = (OpenSecureChannelRequest,pkCli_3365,Nc_3755) in
                                        {3405}out(c, (pkCli_3365,m1_3756));
                                        {3406}in(c, em2_3757: bitstring);
                                        {3407}let m2_3758: bitstring = em2_3757 in
                                        {3408}let (=OpenSecureChannelResponse,Ns_3759: bitstring,ST_3760: bitstring,TTL_3761: bitstring) = m2_3758 in
                                        {3409}let Kcli_3762: bitstring = h((Nc_3755,Ns_3759)) in
                                        {3410}out(c, senc(mCli(pkCli_3365,pkSess_3752),Kcli_3762))
                            )
                            else
                                {3411}let pkSess_3763: bitstring = fail-any in
                                {3412}out(c, GetEndpointRequest);
                                {3413}in(c, (=GetEndpointResponse,=pkSess_3763,=None,SP_3764: bitstring,UP_3765: bitstring));
                                {3414}new Nc_3766: bitstring;
                                {3415}let m1_3767: bitstring = (OpenSecureChannelRequest,pkCli_3365,Nc_3766) in
                                {3416}out(c, (pkCli_3365,m1_3767));
                                {3417}in(c, em2_3768: bitstring);
                                {3418}let m2_3769: bitstring = em2_3768 in
                                {3419}let (=OpenSecureChannelResponse,Ns_3770: bitstring,ST_3771: bitstring,TTL_3772: bitstring) = m2_3769 in
                                {3420}let Kcli_3773: bitstring = h((Nc_3766,Ns_3770)) in
                                {3421}out(c, senc(mCli(pkCli_3365,pkSess_3763),Kcli_3773))
                )
                else
                    {3422}let pkDisco_3774: bitstring = fail-any in
                    {3423}let v_3775: bool = (Sess = A) in
                    (
                        {3424}if v_3775 then
                        (
                            {3425}let pkSess_3776: bitstring = pub(skA) in
                            {3426}out(c, GetEndpointRequest);
                            {3427}in(c, (=GetEndpointResponse,=pkSess_3776,=None,SP_3777: bitstring,UP_3778: bitstring));
                            {3428}new Nc_3779: bitstring;
                            {3429}let m1_3780: bitstring = (OpenSecureChannelRequest,pkCli_3365,Nc_3779) in
                            {3430}out(c, (pkCli_3365,m1_3780));
                            {3431}in(c, em2_3781: bitstring);
                            {3432}let m2_3782: bitstring = em2_3781 in
                            {3433}let (=OpenSecureChannelResponse,Ns_3783: bitstring,ST_3784: bitstring,TTL_3785: bitstring) = m2_3782 in
                            {3434}let Kcli_3786: bitstring = h((Nc_3779,Ns_3783)) in
                            {3435}out(c, senc(mCli(pkCli_3365,pkSess_3776),Kcli_3786))
                        )
                        else
                            {3436}let v_3787: bool = (Sess = B) in
                            (
                                {3437}if v_3787 then
                                (
                                    {3438}let pkSess_3788: bitstring = pub(skB) in
                                    {3439}out(c, GetEndpointRequest);
                                    {3440}in(c, (=GetEndpointResponse,=pkSess_3788,=None,SP_3789: bitstring,UP_3790: bitstring));
                                    {3441}new Nc_3791: bitstring;
                                    {3442}let m1_3792: bitstring = (OpenSecureChannelRequest,pkCli_3365,Nc_3791) in
                                    {3443}out(c, (pkCli_3365,m1_3792));
                                    {3444}in(c, em2_3793: bitstring);
                                    {3445}let m2_3794: bitstring = em2_3793 in
                                    {3446}let (=OpenSecureChannelResponse,Ns_3795: bitstring,ST_3796: bitstring,TTL_3797: bitstring) = m2_3794 in
                                    {3447}let Kcli_3798: bitstring = h((Nc_3791,Ns_3795)) in
                                    {3448}out(c, senc(mCli(pkCli_3365,pkSess_3788),Kcli_3798))
                                )
                                else
                                    {3449}let v_3799: bool = (Sess = C) in
                                    (
                                        {3450}if v_3799 then
                                        (
                                            {3451}let pkSess_3800: bitstring = pub(skC) in
                                            {3452}out(c, GetEndpointRequest);
                                            {3453}in(c, (=GetEndpointResponse,=pkSess_3800,=None,SP_3801: bitstring,UP_3802: bitstring));
                                            {3454}new Nc_3803: bitstring;
                                            {3455}let m1_3804: bitstring = (OpenSecureChannelRequest,pkCli_3365,Nc_3803) in
                                            {3456}out(c, (pkCli_3365,m1_3804));
                                            {3457}in(c, em2_3805: bitstring);
                                            {3458}let m2_3806: bitstring = em2_3805 in
                                            {3459}let (=OpenSecureChannelResponse,Ns_3807: bitstring,ST_3808: bitstring,TTL_3809: bitstring) = m2_3806 in
                                            {3460}let Kcli_3810: bitstring = h((Nc_3803,Ns_3807)) in
                                            {3461}out(c, senc(mCli(pkCli_3365,pkSess_3800),Kcli_3810))
                                        )
                                        else
                                            {3462}let pkSess_3811: bitstring = pub(sk(Sess)) in
                                            {3463}out(c, GetEndpointRequest);
                                            {3464}in(c, (=GetEndpointResponse,=pkSess_3811,=None,SP_3812: bitstring,UP_3813: bitstring));
                                            {3465}new Nc_3814: bitstring;
                                            {3466}let m1_3815: bitstring = (OpenSecureChannelRequest,pkCli_3365,Nc_3814) in
                                            {3467}out(c, (pkCli_3365,m1_3815));
                                            {3468}in(c, em2_3816: bitstring);
                                            {3469}let m2_3817: bitstring = em2_3816 in
                                            {3470}let (=OpenSecureChannelResponse,Ns_3818: bitstring,ST_3819: bitstring,TTL_3820: bitstring) = m2_3817 in
                                            {3471}let Kcli_3821: bitstring = h((Nc_3814,Ns_3818)) in
                                            {3472}out(c, senc(mCli(pkCli_3365,pkSess_3811),Kcli_3821))
                                    )
                                    else
                                        {3473}let pkSess_3822: bitstring = fail-any in
                                        {3474}out(c, GetEndpointRequest);
                                        {3475}in(c, (=GetEndpointResponse,=pkSess_3822,=None,SP_3823: bitstring,UP_3824: bitstring));
                                        {3476}new Nc_3825: bitstring;
                                        {3477}let m1_3826: bitstring = (OpenSecureChannelRequest,pkCli_3365,Nc_3825) in
                                        {3478}out(c, (pkCli_3365,m1_3826));
                                        {3479}in(c, em2_3827: bitstring);
                                        {3480}let m2_3828: bitstring = em2_3827 in
                                        {3481}let (=OpenSecureChannelResponse,Ns_3829: bitstring,ST_3830: bitstring,TTL_3831: bitstring) = m2_3828 in
                                        {3482}let Kcli_3832: bitstring = h((Nc_3825,Ns_3829)) in
                                        {3483}out(c, senc(mCli(pkCli_3365,pkSess_3822),Kcli_3832))
                            )
                            else
                                {3484}let pkSess_3833: bitstring = fail-any in
                                {3485}out(c, GetEndpointRequest);
                                {3486}in(c, (=GetEndpointResponse,=pkSess_3833,=None,SP_3834: bitstring,UP_3835: bitstring));
                                {3487}new Nc_3836: bitstring;
                                {3488}let m1_3837: bitstring = (OpenSecureChannelRequest,pkCli_3365,Nc_3836) in
                                {3489}out(c, (pkCli_3365,m1_3837));
                                {3490}in(c, em2_3838: bitstring);
                                {3491}let m2_3839: bitstring = em2_3838 in
                                {3492}let (=OpenSecureChannelResponse,Ns_3840: bitstring,ST_3841: bitstring,TTL_3842: bitstring) = m2_3839 in
                                {3493}let Kcli_3843: bitstring = h((Nc_3836,Ns_3840)) in
                                {3494}out(c, senc(mCli(pkCli_3365,pkSess_3833),Kcli_3843))
                    )
                    else
                        {3495}let pkSess_3844: bitstring = fail-any in
                        {3496}out(c, GetEndpointRequest);
                        {3497}in(c, (=GetEndpointResponse,=pkSess_3844,=None,SP_3845: bitstring,UP_3846: bitstring));
                        {3498}new Nc_3847: bitstring;
                        {3499}let m1_3848: bitstring = (OpenSecureChannelRequest,pkCli_3365,Nc_3847) in
                        {3500}out(c, (pkCli_3365,m1_3848));
                        {3501}in(c, em2_3849: bitstring);
                        {3502}let m2_3850: bitstring = em2_3849 in
                        {3503}let (=OpenSecureChannelResponse,Ns_3851: bitstring,ST_3852: bitstring,TTL_3853: bitstring) = m2_3850 in
                        {3504}let Kcli_3854: bitstring = h((Nc_3847,Ns_3851)) in
                        {3505}out(c, senc(mCli(pkCli_3365,pkSess_3844),Kcli_3854))
        )
        else
            {3506}let pkDisco_3855: bitstring = fail-any in
            {3507}let v_3856: bool = (Sess = A) in
            (
                {3508}if v_3856 then
                (
                    {3509}let pkSess_3857: bitstring = pub(skA) in
                    {3510}out(c, GetEndpointRequest);
                    {3511}in(c, (=GetEndpointResponse,=pkSess_3857,=None,SP_3858: bitstring,UP_3859: bitstring));
                    {3512}new Nc_3860: bitstring;
                    {3513}let m1_3861: bitstring = (OpenSecureChannelRequest,pkCli_3365,Nc_3860) in
                    {3514}out(c, (pkCli_3365,m1_3861));
                    {3515}in(c, em2_3862: bitstring);
                    {3516}let m2_3863: bitstring = em2_3862 in
                    {3517}let (=OpenSecureChannelResponse,Ns_3864: bitstring,ST_3865: bitstring,TTL_3866: bitstring) = m2_3863 in
                    {3518}let Kcli_3867: bitstring = h((Nc_3860,Ns_3864)) in
                    {3519}out(c, senc(mCli(pkCli_3365,pkSess_3857),Kcli_3867))
                )
                else
                    {3520}let v_3868: bool = (Sess = B) in
                    (
                        {3521}if v_3868 then
                        (
                            {3522}let pkSess_3869: bitstring = pub(skB) in
                            {3523}out(c, GetEndpointRequest);
                            {3524}in(c, (=GetEndpointResponse,=pkSess_3869,=None,SP_3870: bitstring,UP_3871: bitstring));
                            {3525}new Nc_3872: bitstring;
                            {3526}let m1_3873: bitstring = (OpenSecureChannelRequest,pkCli_3365,Nc_3872) in
                            {3527}out(c, (pkCli_3365,m1_3873));
                            {3528}in(c, em2_3874: bitstring);
                            {3529}let m2_3875: bitstring = em2_3874 in
                            {3530}let (=OpenSecureChannelResponse,Ns_3876: bitstring,ST_3877: bitstring,TTL_3878: bitstring) = m2_3875 in
                            {3531}let Kcli_3879: bitstring = h((Nc_3872,Ns_3876)) in
                            {3532}out(c, senc(mCli(pkCli_3365,pkSess_3869),Kcli_3879))
                        )
                        else
                            {3533}let v_3880: bool = (Sess = C) in
                            (
                                {3534}if v_3880 then
                                (
                                    {3535}let pkSess_3881: bitstring = pub(skC) in
                                    {3536}out(c, GetEndpointRequest);
                                    {3537}in(c, (=GetEndpointResponse,=pkSess_3881,=None,SP_3882: bitstring,UP_3883: bitstring));
                                    {3538}new Nc_3884: bitstring;
                                    {3539}let m1_3885: bitstring = (OpenSecureChannelRequest,pkCli_3365,Nc_3884) in
                                    {3540}out(c, (pkCli_3365,m1_3885));
                                    {3541}in(c, em2_3886: bitstring);
                                    {3542}let m2_3887: bitstring = em2_3886 in
                                    {3543}let (=OpenSecureChannelResponse,Ns_3888: bitstring,ST_3889: bitstring,TTL_3890: bitstring) = m2_3887 in
                                    {3544}let Kcli_3891: bitstring = h((Nc_3884,Ns_3888)) in
                                    {3545}out(c, senc(mCli(pkCli_3365,pkSess_3881),Kcli_3891))
                                )
                                else
                                    {3546}let pkSess_3892: bitstring = pub(sk(Sess)) in
                                    {3547}out(c, GetEndpointRequest);
                                    {3548}in(c, (=GetEndpointResponse,=pkSess_3892,=None,SP_3893: bitstring,UP_3894: bitstring));
                                    {3549}new Nc_3895: bitstring;
                                    {3550}let m1_3896: bitstring = (OpenSecureChannelRequest,pkCli_3365,Nc_3895) in
                                    {3551}out(c, (pkCli_3365,m1_3896));
                                    {3552}in(c, em2_3897: bitstring);
                                    {3553}let m2_3898: bitstring = em2_3897 in
                                    {3554}let (=OpenSecureChannelResponse,Ns_3899: bitstring,ST_3900: bitstring,TTL_3901: bitstring) = m2_3898 in
                                    {3555}let Kcli_3902: bitstring = h((Nc_3895,Ns_3899)) in
                                    {3556}out(c, senc(mCli(pkCli_3365,pkSess_3892),Kcli_3902))
                            )
                            else
                                {3557}let pkSess_3903: bitstring = fail-any in
                                {3558}out(c, GetEndpointRequest);
                                {3559}in(c, (=GetEndpointResponse,=pkSess_3903,=None,SP_3904: bitstring,UP_3905: bitstring));
                                {3560}new Nc_3906: bitstring;
                                {3561}let m1_3907: bitstring = (OpenSecureChannelRequest,pkCli_3365,Nc_3906) in
                                {3562}out(c, (pkCli_3365,m1_3907));
                                {3563}in(c, em2_3908: bitstring);
                                {3564}let m2_3909: bitstring = em2_3908 in
                                {3565}let (=OpenSecureChannelResponse,Ns_3910: bitstring,ST_3911: bitstring,TTL_3912: bitstring) = m2_3909 in
                                {3566}let Kcli_3913: bitstring = h((Nc_3906,Ns_3910)) in
                                {3567}out(c, senc(mCli(pkCli_3365,pkSess_3903),Kcli_3913))
                    )
                    else
                        {3568}let pkSess_3914: bitstring = fail-any in
                        {3569}out(c, GetEndpointRequest);
                        {3570}in(c, (=GetEndpointResponse,=pkSess_3914,=None,SP_3915: bitstring,UP_3916: bitstring));
                        {3571}new Nc_3917: bitstring;
                        {3572}let m1_3918: bitstring = (OpenSecureChannelRequest,pkCli_3365,Nc_3917) in
                        {3573}out(c, (pkCli_3365,m1_3918));
                        {3574}in(c, em2_3919: bitstring);
                        {3575}let m2_3920: bitstring = em2_3919 in
                        {3576}let (=OpenSecureChannelResponse,Ns_3921: bitstring,ST_3922: bitstring,TTL_3923: bitstring) = m2_3920 in
                        {3577}let Kcli_3924: bitstring = h((Nc_3917,Ns_3921)) in
                        {3578}out(c, senc(mCli(pkCli_3365,pkSess_3914),Kcli_3924))
            )
            else
                {3579}let pkSess_3925: bitstring = fail-any in
                {3580}out(c, GetEndpointRequest);
                {3581}in(c, (=GetEndpointResponse,=pkSess_3925,=None,SP_3926: bitstring,UP_3927: bitstring));
                {3582}new Nc_3928: bitstring;
                {3583}let m1_3929: bitstring = (OpenSecureChannelRequest,pkCli_3365,Nc_3928) in
                {3584}out(c, (pkCli_3365,m1_3929));
                {3585}in(c, em2_3930: bitstring);
                {3586}let m2_3931: bitstring = em2_3930 in
                {3587}let (=OpenSecureChannelResponse,Ns_3932: bitstring,ST_3933: bitstring,TTL_3934: bitstring) = m2_3931 in
                {3588}let Kcli_3935: bitstring = h((Nc_3928,Ns_3932)) in
                {3589}out(c, senc(mCli(pkCli_3365,pkSess_3925),Kcli_3935))
) | (
    {3590}!
    {3591}in(c, (Cli_3936: host,Disco_3937: host,Sess_3938: host));
    {3592}let v_3939: bool = (Disco_3937 = A) in
    (
        {3593}if v_3939 then
        (
            {3594}let skDisco: bitstring = skA in
            {3595}let pkDisco_3940: bitstring = pub(skDisco) in
            {3596}let v_3941: bool = (Cli_3936 = A) in
            (
                {3597}if v_3941 then
                (
                    {3598}let pkCli_3942: bitstring = pub(skA) in
                    {3599}let v_3943: bool = (Sess_3938 = A) in
                    (
                        {3600}if v_3943 then
                        (
                            {3601}let pkSess_3944: bitstring = pub(skA) in
                            {3602}in(c, =GetEndpointRequest);
                            {3603}new SP_3945: bitstring;
                            {3604}new UP_3946: bitstring;
                            {3605}out(c, (GetEndpointResponse,pkSess_3944,None,SP_3945,UP_3946))
                        )
                        else
                            {3606}let v_3947: bool = (Sess_3938 = B) in
                            (
                                {3607}if v_3947 then
                                (
                                    {3608}let pkSess_3948: bitstring = pub(skB) in
                                    {3609}in(c, =GetEndpointRequest);
                                    {3610}new SP_3949: bitstring;
                                    {3611}new UP_3950: bitstring;
                                    {3612}out(c, (GetEndpointResponse,pkSess_3948,None,SP_3949,UP_3950))
                                )
                                else
                                    {3613}let v_3951: bool = (Sess_3938 = C) in
                                    (
                                        {3614}if v_3951 then
                                        (
                                            {3615}let pkSess_3952: bitstring = pub(skC) in
                                            {3616}in(c, =GetEndpointRequest);
                                            {3617}new SP_3953: bitstring;
                                            {3618}new UP_3954: bitstring;
                                            {3619}out(c, (GetEndpointResponse,pkSess_3952,None,SP_3953,UP_3954))
                                        )
                                        else
                                            {3620}let pkSess_3955: bitstring = pub(sk(Sess_3938)) in
                                            {3621}in(c, =GetEndpointRequest);
                                            {3622}new SP_3956: bitstring;
                                            {3623}new UP_3957: bitstring;
                                            {3624}out(c, (GetEndpointResponse,pkSess_3955,None,SP_3956,UP_3957))
                                    )
                                    else
                                        {3625}let pkSess_3958: bitstring = fail-any in
                                        {3626}in(c, =GetEndpointRequest);
                                        {3627}new SP_3959: bitstring;
                                        {3628}new UP_3960: bitstring;
                                        {3629}out(c, (GetEndpointResponse,pkSess_3958,None,SP_3959,UP_3960))
                            )
                            else
                                {3630}let pkSess_3961: bitstring = fail-any in
                                {3631}in(c, =GetEndpointRequest);
                                {3632}new SP_3962: bitstring;
                                {3633}new UP_3963: bitstring;
                                {3634}out(c, (GetEndpointResponse,pkSess_3961,None,SP_3962,UP_3963))
                    )
                    else
                        {3635}let pkSess_3964: bitstring = fail-any in
                        {3636}in(c, =GetEndpointRequest);
                        {3637}new SP_3965: bitstring;
                        {3638}new UP_3966: bitstring;
                        {3639}out(c, (GetEndpointResponse,pkSess_3964,None,SP_3965,UP_3966))
                )
                else
                    {3640}let v_3967: bool = (Cli_3936 = B) in
                    (
                        {3641}if v_3967 then
                        (
                            {3642}let pkCli_3968: bitstring = pub(skB) in
                            {3643}let v_3969: bool = (Sess_3938 = A) in
                            (
                                {3644}if v_3969 then
                                (
                                    {3645}let pkSess_3970: bitstring = pub(skA) in
                                    {3646}in(c, =GetEndpointRequest);
                                    {3647}new SP_3971: bitstring;
                                    {3648}new UP_3972: bitstring;
                                    {3649}out(c, (GetEndpointResponse,pkSess_3970,None,SP_3971,UP_3972))
                                )
                                else
                                    {3650}let v_3973: bool = (Sess_3938 = B) in
                                    (
                                        {3651}if v_3973 then
                                        (
                                            {3652}let pkSess_3974: bitstring = pub(skB) in
                                            {3653}in(c, =GetEndpointRequest);
                                            {3654}new SP_3975: bitstring;
                                            {3655}new UP_3976: bitstring;
                                            {3656}out(c, (GetEndpointResponse,pkSess_3974,None,SP_3975,UP_3976))
                                        )
                                        else
                                            {3657}let v_3977: bool = (Sess_3938 = C) in
                                            (
                                                {3658}if v_3977 then
                                                (
                                                    {3659}let pkSess_3978: bitstring = pub(skC) in
                                                    {3660}in(c, =GetEndpointRequest);
                                                    {3661}new SP_3979: bitstring;
                                                    {3662}new UP_3980: bitstring;
                                                    {3663}out(c, (GetEndpointResponse,pkSess_3978,None,SP_3979,UP_3980))
                                                )
                                                else
                                                    {3664}let pkSess_3981: bitstring = pub(sk(Sess_3938)) in
                                                    {3665}in(c, =GetEndpointRequest);
                                                    {3666}new SP_3982: bitstring;
                                                    {3667}new UP_3983: bitstring;
                                                    {3668}out(c, (GetEndpointResponse,pkSess_3981,None,SP_3982,UP_3983))
                                            )
                                            else
                                                {3669}let pkSess_3984: bitstring = fail-any in
                                                {3670}in(c, =GetEndpointRequest);
                                                {3671}new SP_3985: bitstring;
                                                {3672}new UP_3986: bitstring;
                                                {3673}out(c, (GetEndpointResponse,pkSess_3984,None,SP_3985,UP_3986))
                                    )
                                    else
                                        {3674}let pkSess_3987: bitstring = fail-any in
                                        {3675}in(c, =GetEndpointRequest);
                                        {3676}new SP_3988: bitstring;
                                        {3677}new UP_3989: bitstring;
                                        {3678}out(c, (GetEndpointResponse,pkSess_3987,None,SP_3988,UP_3989))
                            )
                            else
                                {3679}let pkSess_3990: bitstring = fail-any in
                                {3680}in(c, =GetEndpointRequest);
                                {3681}new SP_3991: bitstring;
                                {3682}new UP_3992: bitstring;
                                {3683}out(c, (GetEndpointResponse,pkSess_3990,None,SP_3991,UP_3992))
                        )
                        else
                            {3684}let v_3993: bool = (Cli_3936 = C) in
                            (
                                {3685}if v_3993 then
                                (
                                    {3686}let pkCli_3994: bitstring = pub(skC) in
                                    {3687}let v_3995: bool = (Sess_3938 = A) in
                                    (
                                        {3688}if v_3995 then
                                        (
                                            {3689}let pkSess_3996: bitstring = pub(skA) in
                                            {3690}in(c, =GetEndpointRequest);
                                            {3691}new SP_3997: bitstring;
                                            {3692}new UP_3998: bitstring;
                                            {3693}out(c, (GetEndpointResponse,pkSess_3996,None,SP_3997,UP_3998))
                                        )
                                        else
                                            {3694}let v_3999: bool = (Sess_3938 = B) in
                                            (
                                                {3695}if v_3999 then
                                                (
                                                    {3696}let pkSess_4000: bitstring = pub(skB) in
                                                    {3697}in(c, =GetEndpointRequest);
                                                    {3698}new SP_4001: bitstring;
                                                    {3699}new UP_4002: bitstring;
                                                    {3700}out(c, (GetEndpointResponse,pkSess_4000,None,SP_4001,UP_4002))
                                                )
                                                else
                                                    {3701}let v_4003: bool = (Sess_3938 = C) in
                                                    (
                                                        {3702}if v_4003 then
                                                        (
                                                            {3703}let pkSess_4004: bitstring = pub(skC) in
                                                            {3704}in(c, =GetEndpointRequest);
                                                            {3705}new SP_4005: bitstring;
                                                            {3706}new UP_4006: bitstring;
                                                            {3707}out(c, (GetEndpointResponse,pkSess_4004,None,SP_4005,UP_4006))
                                                        )
                                                        else
                                                            {3708}let pkSess_4007: bitstring = pub(sk(Sess_3938)) in
                                                            {3709}in(c, =GetEndpointRequest);
                                                            {3710}new SP_4008: bitstring;
                                                            {3711}new UP_4009: bitstring;
                                                            {3712}out(c, (GetEndpointResponse,pkSess_4007,None,SP_4008,UP_4009))
                                                    )
                                                    else
                                                        {3713}let pkSess_4010: bitstring = fail-any in
                                                        {3714}in(c, =GetEndpointRequest);
                                                        {3715}new SP_4011: bitstring;
                                                        {3716}new UP_4012: bitstring;
                                                        {3717}out(c, (GetEndpointResponse,pkSess_4010,None,SP_4011,UP_4012))
                                            )
                                            else
                                                {3718}let pkSess_4013: bitstring = fail-any in
                                                {3719}in(c, =GetEndpointRequest);
                                                {3720}new SP_4014: bitstring;
                                                {3721}new UP_4015: bitstring;
                                                {3722}out(c, (GetEndpointResponse,pkSess_4013,None,SP_4014,UP_4015))
                                    )
                                    else
                                        {3723}let pkSess_4016: bitstring = fail-any in
                                        {3724}in(c, =GetEndpointRequest);
                                        {3725}new SP_4017: bitstring;
                                        {3726}new UP_4018: bitstring;
                                        {3727}out(c, (GetEndpointResponse,pkSess_4016,None,SP_4017,UP_4018))
                                )
                                else
                                    {3728}let pkCli_4019: bitstring = pub(sk(Cli_3936)) in
                                    {3729}let v_4020: bool = (Sess_3938 = A) in
                                    (
                                        {3730}if v_4020 then
                                        (
                                            {3731}let pkSess_4021: bitstring = pub(skA) in
                                            {3732}in(c, =GetEndpointRequest);
                                            {3733}new SP_4022: bitstring;
                                            {3734}new UP_4023: bitstring;
                                            {3735}out(c, (GetEndpointResponse,pkSess_4021,None,SP_4022,UP_4023))
                                        )
                                        else
                                            {3736}let v_4024: bool = (Sess_3938 = B) in
                                            (
                                                {3737}if v_4024 then
                                                (
                                                    {3738}let pkSess_4025: bitstring = pub(skB) in
                                                    {3739}in(c, =GetEndpointRequest);
                                                    {3740}new SP_4026: bitstring;
                                                    {3741}new UP_4027: bitstring;
                                                    {3742}out(c, (GetEndpointResponse,pkSess_4025,None,SP_4026,UP_4027))
                                                )
                                                else
                                                    {3743}let v_4028: bool = (Sess_3938 = C) in
                                                    (
                                                        {3744}if v_4028 then
                                                        (
                                                            {3745}let pkSess_4029: bitstring = pub(skC) in
                                                            {3746}in(c, =GetEndpointRequest);
                                                            {3747}new SP_4030: bitstring;
                                                            {3748}new UP_4031: bitstring;
                                                            {3749}out(c, (GetEndpointResponse,pkSess_4029,None,SP_4030,UP_4031))
                                                        )
                                                        else
                                                            {3750}let pkSess_4032: bitstring = pub(sk(Sess_3938)) in
                                                            {3751}in(c, =GetEndpointRequest);
                                                            {3752}new SP_4033: bitstring;
                                                            {3753}new UP_4034: bitstring;
                                                            {3754}out(c, (GetEndpointResponse,pkSess_4032,None,SP_4033,UP_4034))
                                                    )
                                                    else
                                                        {3755}let pkSess_4035: bitstring = fail-any in
                                                        {3756}in(c, =GetEndpointRequest);
                                                        {3757}new SP_4036: bitstring;
                                                        {3758}new UP_4037: bitstring;
                                                        {3759}out(c, (GetEndpointResponse,pkSess_4035,None,SP_4036,UP_4037))
                                            )
                                            else
                                                {3760}let pkSess_4038: bitstring = fail-any in
                                                {3761}in(c, =GetEndpointRequest);
                                                {3762}new SP_4039: bitstring;
                                                {3763}new UP_4040: bitstring;
                                                {3764}out(c, (GetEndpointResponse,pkSess_4038,None,SP_4039,UP_4040))
                                    )
                                    else
                                        {3765}let pkSess_4041: bitstring = fail-any in
                                        {3766}in(c, =GetEndpointRequest);
                                        {3767}new SP_4042: bitstring;
                                        {3768}new UP_4043: bitstring;
                                        {3769}out(c, (GetEndpointResponse,pkSess_4041,None,SP_4042,UP_4043))
                            )
                            else
                                {3770}let pkCli_4044: bitstring = fail-any in
                                {3771}let v_4045: bool = (Sess_3938 = A) in
                                (
                                    {3772}if v_4045 then
                                    (
                                        {3773}let pkSess_4046: bitstring = pub(skA) in
                                        {3774}in(c, =GetEndpointRequest);
                                        {3775}new SP_4047: bitstring;
                                        {3776}new UP_4048: bitstring;
                                        {3777}out(c, (GetEndpointResponse,pkSess_4046,None,SP_4047,UP_4048))
                                    )
                                    else
                                        {3778}let v_4049: bool = (Sess_3938 = B) in
                                        (
                                            {3779}if v_4049 then
                                            (
                                                {3780}let pkSess_4050: bitstring = pub(skB) in
                                                {3781}in(c, =GetEndpointRequest);
                                                {3782}new SP_4051: bitstring;
                                                {3783}new UP_4052: bitstring;
                                                {3784}out(c, (GetEndpointResponse,pkSess_4050,None,SP_4051,UP_4052))
                                            )
                                            else
                                                {3785}let v_4053: bool = (Sess_3938 = C) in
                                                (
                                                    {3786}if v_4053 then
                                                    (
                                                        {3787}let pkSess_4054: bitstring = pub(skC) in
                                                        {3788}in(c, =GetEndpointRequest);
                                                        {3789}new SP_4055: bitstring;
                                                        {3790}new UP_4056: bitstring;
                                                        {3791}out(c, (GetEndpointResponse,pkSess_4054,None,SP_4055,UP_4056))
                                                    )
                                                    else
                                                        {3792}let pkSess_4057: bitstring = pub(sk(Sess_3938)) in
                                                        {3793}in(c, =GetEndpointRequest);
                                                        {3794}new SP_4058: bitstring;
                                                        {3795}new UP_4059: bitstring;
                                                        {3796}out(c, (GetEndpointResponse,pkSess_4057,None,SP_4058,UP_4059))
                                                )
                                                else
                                                    {3797}let pkSess_4060: bitstring = fail-any in
                                                    {3798}in(c, =GetEndpointRequest);
                                                    {3799}new SP_4061: bitstring;
                                                    {3800}new UP_4062: bitstring;
                                                    {3801}out(c, (GetEndpointResponse,pkSess_4060,None,SP_4061,UP_4062))
                                        )
                                        else
                                            {3802}let pkSess_4063: bitstring = fail-any in
                                            {3803}in(c, =GetEndpointRequest);
                                            {3804}new SP_4064: bitstring;
                                            {3805}new UP_4065: bitstring;
                                            {3806}out(c, (GetEndpointResponse,pkSess_4063,None,SP_4064,UP_4065))
                                )
                                else
                                    {3807}let pkSess_4066: bitstring = fail-any in
                                    {3808}in(c, =GetEndpointRequest);
                                    {3809}new SP_4067: bitstring;
                                    {3810}new UP_4068: bitstring;
                                    {3811}out(c, (GetEndpointResponse,pkSess_4066,None,SP_4067,UP_4068))
                    )
                    else
                        {3812}let pkCli_4069: bitstring = fail-any in
                        {3813}let v_4070: bool = (Sess_3938 = A) in
                        (
                            {3814}if v_4070 then
                            (
                                {3815}let pkSess_4071: bitstring = pub(skA) in
                                {3816}in(c, =GetEndpointRequest);
                                {3817}new SP_4072: bitstring;
                                {3818}new UP_4073: bitstring;
                                {3819}out(c, (GetEndpointResponse,pkSess_4071,None,SP_4072,UP_4073))
                            )
                            else
                                {3820}let v_4074: bool = (Sess_3938 = B) in
                                (
                                    {3821}if v_4074 then
                                    (
                                        {3822}let pkSess_4075: bitstring = pub(skB) in
                                        {3823}in(c, =GetEndpointRequest);
                                        {3824}new SP_4076: bitstring;
                                        {3825}new UP_4077: bitstring;
                                        {3826}out(c, (GetEndpointResponse,pkSess_4075,None,SP_4076,UP_4077))
                                    )
                                    else
                                        {3827}let v_4078: bool = (Sess_3938 = C) in
                                        (
                                            {3828}if v_4078 then
                                            (
                                                {3829}let pkSess_4079: bitstring = pub(skC) in
                                                {3830}in(c, =GetEndpointRequest);
                                                {3831}new SP_4080: bitstring;
                                                {3832}new UP_4081: bitstring;
                                                {3833}out(c, (GetEndpointResponse,pkSess_4079,None,SP_4080,UP_4081))
                                            )
                                            else
                                                {3834}let pkSess_4082: bitstring = pub(sk(Sess_3938)) in
                                                {3835}in(c, =GetEndpointRequest);
                                                {3836}new SP_4083: bitstring;
                                                {3837}new UP_4084: bitstring;
                                                {3838}out(c, (GetEndpointResponse,pkSess_4082,None,SP_4083,UP_4084))
                                        )
                                        else
                                            {3839}let pkSess_4085: bitstring = fail-any in
                                            {3840}in(c, =GetEndpointRequest);
                                            {3841}new SP_4086: bitstring;
                                            {3842}new UP_4087: bitstring;
                                            {3843}out(c, (GetEndpointResponse,pkSess_4085,None,SP_4086,UP_4087))
                                )
                                else
                                    {3844}let pkSess_4088: bitstring = fail-any in
                                    {3845}in(c, =GetEndpointRequest);
                                    {3846}new SP_4089: bitstring;
                                    {3847}new UP_4090: bitstring;
                                    {3848}out(c, (GetEndpointResponse,pkSess_4088,None,SP_4089,UP_4090))
                        )
                        else
                            {3849}let pkSess_4091: bitstring = fail-any in
                            {3850}in(c, =GetEndpointRequest);
                            {3851}new SP_4092: bitstring;
                            {3852}new UP_4093: bitstring;
                            {3853}out(c, (GetEndpointResponse,pkSess_4091,None,SP_4092,UP_4093))
            )
            else
                {3854}let pkCli_4094: bitstring = fail-any in
                {3855}let v_4095: bool = (Sess_3938 = A) in
                (
                    {3856}if v_4095 then
                    (
                        {3857}let pkSess_4096: bitstring = pub(skA) in
                        {3858}in(c, =GetEndpointRequest);
                        {3859}new SP_4097: bitstring;
                        {3860}new UP_4098: bitstring;
                        {3861}out(c, (GetEndpointResponse,pkSess_4096,None,SP_4097,UP_4098))
                    )
                    else
                        {3862}let v_4099: bool = (Sess_3938 = B) in
                        (
                            {3863}if v_4099 then
                            (
                                {3864}let pkSess_4100: bitstring = pub(skB) in
                                {3865}in(c, =GetEndpointRequest);
                                {3866}new SP_4101: bitstring;
                                {3867}new UP_4102: bitstring;
                                {3868}out(c, (GetEndpointResponse,pkSess_4100,None,SP_4101,UP_4102))
                            )
                            else
                                {3869}let v_4103: bool = (Sess_3938 = C) in
                                (
                                    {3870}if v_4103 then
                                    (
                                        {3871}let pkSess_4104: bitstring = pub(skC) in
                                        {3872}in(c, =GetEndpointRequest);
                                        {3873}new SP_4105: bitstring;
                                        {3874}new UP_4106: bitstring;
                                        {3875}out(c, (GetEndpointResponse,pkSess_4104,None,SP_4105,UP_4106))
                                    )
                                    else
                                        {3876}let pkSess_4107: bitstring = pub(sk(Sess_3938)) in
                                        {3877}in(c, =GetEndpointRequest);
                                        {3878}new SP_4108: bitstring;
                                        {3879}new UP_4109: bitstring;
                                        {3880}out(c, (GetEndpointResponse,pkSess_4107,None,SP_4108,UP_4109))
                                )
                                else
                                    {3881}let pkSess_4110: bitstring = fail-any in
                                    {3882}in(c, =GetEndpointRequest);
                                    {3883}new SP_4111: bitstring;
                                    {3884}new UP_4112: bitstring;
                                    {3885}out(c, (GetEndpointResponse,pkSess_4110,None,SP_4111,UP_4112))
                        )
                        else
                            {3886}let pkSess_4113: bitstring = fail-any in
                            {3887}in(c, =GetEndpointRequest);
                            {3888}new SP_4114: bitstring;
                            {3889}new UP_4115: bitstring;
                            {3890}out(c, (GetEndpointResponse,pkSess_4113,None,SP_4114,UP_4115))
                )
                else
                    {3891}let pkSess_4116: bitstring = fail-any in
                    {3892}in(c, =GetEndpointRequest);
                    {3893}new SP_4117: bitstring;
                    {3894}new UP_4118: bitstring;
                    {3895}out(c, (GetEndpointResponse,pkSess_4116,None,SP_4117,UP_4118))
        )
        else
            {3896}let v_4119: bool = (Disco_3937 = B) in
            (
                {3897}if v_4119 then
                (
                    {3898}let skDisco_4120: bitstring = skB in
                    {3899}let pkDisco_4121: bitstring = pub(skDisco_4120) in
                    {3900}let v_4122: bool = (Cli_3936 = A) in
                    (
                        {3901}if v_4122 then
                        (
                            {3902}let pkCli_4123: bitstring = pub(skA) in
                            {3903}let v_4124: bool = (Sess_3938 = A) in
                            (
                                {3904}if v_4124 then
                                (
                                    {3905}let pkSess_4125: bitstring = pub(skA) in
                                    {3906}in(c, =GetEndpointRequest);
                                    {3907}new SP_4126: bitstring;
                                    {3908}new UP_4127: bitstring;
                                    {3909}out(c, (GetEndpointResponse,pkSess_4125,None,SP_4126,UP_4127))
                                )
                                else
                                    {3910}let v_4128: bool = (Sess_3938 = B) in
                                    (
                                        {3911}if v_4128 then
                                        (
                                            {3912}let pkSess_4129: bitstring = pub(skB) in
                                            {3913}in(c, =GetEndpointRequest);
                                            {3914}new SP_4130: bitstring;
                                            {3915}new UP_4131: bitstring;
                                            {3916}out(c, (GetEndpointResponse,pkSess_4129,None,SP_4130,UP_4131))
                                        )
                                        else
                                            {3917}let v_4132: bool = (Sess_3938 = C) in
                                            (
                                                {3918}if v_4132 then
                                                (
                                                    {3919}let pkSess_4133: bitstring = pub(skC) in
                                                    {3920}in(c, =GetEndpointRequest);
                                                    {3921}new SP_4134: bitstring;
                                                    {3922}new UP_4135: bitstring;
                                                    {3923}out(c, (GetEndpointResponse,pkSess_4133,None,SP_4134,UP_4135))
                                                )
                                                else
                                                    {3924}let pkSess_4136: bitstring = pub(sk(Sess_3938)) in
                                                    {3925}in(c, =GetEndpointRequest);
                                                    {3926}new SP_4137: bitstring;
                                                    {3927}new UP_4138: bitstring;
                                                    {3928}out(c, (GetEndpointResponse,pkSess_4136,None,SP_4137,UP_4138))
                                            )
                                            else
                                                {3929}let pkSess_4139: bitstring = fail-any in
                                                {3930}in(c, =GetEndpointRequest);
                                                {3931}new SP_4140: bitstring;
                                                {3932}new UP_4141: bitstring;
                                                {3933}out(c, (GetEndpointResponse,pkSess_4139,None,SP_4140,UP_4141))
                                    )
                                    else
                                        {3934}let pkSess_4142: bitstring = fail-any in
                                        {3935}in(c, =GetEndpointRequest);
                                        {3936}new SP_4143: bitstring;
                                        {3937}new UP_4144: bitstring;
                                        {3938}out(c, (GetEndpointResponse,pkSess_4142,None,SP_4143,UP_4144))
                            )
                            else
                                {3939}let pkSess_4145: bitstring = fail-any in
                                {3940}in(c, =GetEndpointRequest);
                                {3941}new SP_4146: bitstring;
                                {3942}new UP_4147: bitstring;
                                {3943}out(c, (GetEndpointResponse,pkSess_4145,None,SP_4146,UP_4147))
                        )
                        else
                            {3944}let v_4148: bool = (Cli_3936 = B) in
                            (
                                {3945}if v_4148 then
                                (
                                    {3946}let pkCli_4149: bitstring = pub(skB) in
                                    {3947}let v_4150: bool = (Sess_3938 = A) in
                                    (
                                        {3948}if v_4150 then
                                        (
                                            {3949}let pkSess_4151: bitstring = pub(skA) in
                                            {3950}in(c, =GetEndpointRequest);
                                            {3951}new SP_4152: bitstring;
                                            {3952}new UP_4153: bitstring;
                                            {3953}out(c, (GetEndpointResponse,pkSess_4151,None,SP_4152,UP_4153))
                                        )
                                        else
                                            {3954}let v_4154: bool = (Sess_3938 = B) in
                                            (
                                                {3955}if v_4154 then
                                                (
                                                    {3956}let pkSess_4155: bitstring = pub(skB) in
                                                    {3957}in(c, =GetEndpointRequest);
                                                    {3958}new SP_4156: bitstring;
                                                    {3959}new UP_4157: bitstring;
                                                    {3960}out(c, (GetEndpointResponse,pkSess_4155,None,SP_4156,UP_4157))
                                                )
                                                else
                                                    {3961}let v_4158: bool = (Sess_3938 = C) in
                                                    (
                                                        {3962}if v_4158 then
                                                        (
                                                            {3963}let pkSess_4159: bitstring = pub(skC) in
                                                            {3964}in(c, =GetEndpointRequest);
                                                            {3965}new SP_4160: bitstring;
                                                            {3966}new UP_4161: bitstring;
                                                            {3967}out(c, (GetEndpointResponse,pkSess_4159,None,SP_4160,UP_4161))
                                                        )
                                                        else
                                                            {3968}let pkSess_4162: bitstring = pub(sk(Sess_3938)) in
                                                            {3969}in(c, =GetEndpointRequest);
                                                            {3970}new SP_4163: bitstring;
                                                            {3971}new UP_4164: bitstring;
                                                            {3972}out(c, (GetEndpointResponse,pkSess_4162,None,SP_4163,UP_4164))
                                                    )
                                                    else
                                                        {3973}let pkSess_4165: bitstring = fail-any in
                                                        {3974}in(c, =GetEndpointRequest);
                                                        {3975}new SP_4166: bitstring;
                                                        {3976}new UP_4167: bitstring;
                                                        {3977}out(c, (GetEndpointResponse,pkSess_4165,None,SP_4166,UP_4167))
                                            )
                                            else
                                                {3978}let pkSess_4168: bitstring = fail-any in
                                                {3979}in(c, =GetEndpointRequest);
                                                {3980}new SP_4169: bitstring;
                                                {3981}new UP_4170: bitstring;
                                                {3982}out(c, (GetEndpointResponse,pkSess_4168,None,SP_4169,UP_4170))
                                    )
                                    else
                                        {3983}let pkSess_4171: bitstring = fail-any in
                                        {3984}in(c, =GetEndpointRequest);
                                        {3985}new SP_4172: bitstring;
                                        {3986}new UP_4173: bitstring;
                                        {3987}out(c, (GetEndpointResponse,pkSess_4171,None,SP_4172,UP_4173))
                                )
                                else
                                    {3988}let v_4174: bool = (Cli_3936 = C) in
                                    (
                                        {3989}if v_4174 then
                                        (
                                            {3990}let pkCli_4175: bitstring = pub(skC) in
                                            {3991}let v_4176: bool = (Sess_3938 = A) in
                                            (
                                                {3992}if v_4176 then
                                                (
                                                    {3993}let pkSess_4177: bitstring = pub(skA) in
                                                    {3994}in(c, =GetEndpointRequest);
                                                    {3995}new SP_4178: bitstring;
                                                    {3996}new UP_4179: bitstring;
                                                    {3997}out(c, (GetEndpointResponse,pkSess_4177,None,SP_4178,UP_4179))
                                                )
                                                else
                                                    {3998}let v_4180: bool = (Sess_3938 = B) in
                                                    (
                                                        {3999}if v_4180 then
                                                        (
                                                            {4000}let pkSess_4181: bitstring = pub(skB) in
                                                            {4001}in(c, =GetEndpointRequest);
                                                            {4002}new SP_4182: bitstring;
                                                            {4003}new UP_4183: bitstring;
                                                            {4004}out(c, (GetEndpointResponse,pkSess_4181,None,SP_4182,UP_4183))
                                                        )
                                                        else
                                                            {4005}let v_4184: bool = (Sess_3938 = C) in
                                                            (
                                                                {4006}if v_4184 then
                                                                (
                                                                    {4007}let pkSess_4185: bitstring = pub(skC) in
                                                                    {4008}in(c, =GetEndpointRequest);
                                                                    {4009}new SP_4186: bitstring;
                                                                    {4010}new UP_4187: bitstring;
                                                                    {4011}out(c, (GetEndpointResponse,pkSess_4185,None,SP_4186,UP_4187))
                                                                )
                                                                else
                                                                    {4012}let pkSess_4188: bitstring = pub(sk(Sess_3938)) in
                                                                    {4013}in(c, =GetEndpointRequest);
                                                                    {4014}new SP_4189: bitstring;
                                                                    {4015}new UP_4190: bitstring;
                                                                    {4016}out(c, (GetEndpointResponse,pkSess_4188,None,SP_4189,UP_4190))
                                                            )
                                                            else
                                                                {4017}let pkSess_4191: bitstring = fail-any in
                                                                {4018}in(c, =GetEndpointRequest);
                                                                {4019}new SP_4192: bitstring;
                                                                {4020}new UP_4193: bitstring;
                                                                {4021}out(c, (GetEndpointResponse,pkSess_4191,None,SP_4192,UP_4193))
                                                    )
                                                    else
                                                        {4022}let pkSess_4194: bitstring = fail-any in
                                                        {4023}in(c, =GetEndpointRequest);
                                                        {4024}new SP_4195: bitstring;
                                                        {4025}new UP_4196: bitstring;
                                                        {4026}out(c, (GetEndpointResponse,pkSess_4194,None,SP_4195,UP_4196))
                                            )
                                            else
                                                {4027}let pkSess_4197: bitstring = fail-any in
                                                {4028}in(c, =GetEndpointRequest);
                                                {4029}new SP_4198: bitstring;
                                                {4030}new UP_4199: bitstring;
                                                {4031}out(c, (GetEndpointResponse,pkSess_4197,None,SP_4198,UP_4199))
                                        )
                                        else
                                            {4032}let pkCli_4200: bitstring = pub(sk(Cli_3936)) in
                                            {4033}let v_4201: bool = (Sess_3938 = A) in
                                            (
                                                {4034}if v_4201 then
                                                (
                                                    {4035}let pkSess_4202: bitstring = pub(skA) in
                                                    {4036}in(c, =GetEndpointRequest);
                                                    {4037}new SP_4203: bitstring;
                                                    {4038}new UP_4204: bitstring;
                                                    {4039}out(c, (GetEndpointResponse,pkSess_4202,None,SP_4203,UP_4204))
                                                )
                                                else
                                                    {4040}let v_4205: bool = (Sess_3938 = B) in
                                                    (
                                                        {4041}if v_4205 then
                                                        (
                                                            {4042}let pkSess_4206: bitstring = pub(skB) in
                                                            {4043}in(c, =GetEndpointRequest);
                                                            {4044}new SP_4207: bitstring;
                                                            {4045}new UP_4208: bitstring;
                                                            {4046}out(c, (GetEndpointResponse,pkSess_4206,None,SP_4207,UP_4208))
                                                        )
                                                        else
                                                            {4047}let v_4209: bool = (Sess_3938 = C) in
                                                            (
                                                                {4048}if v_4209 then
                                                                (
                                                                    {4049}let pkSess_4210: bitstring = pub(skC) in
                                                                    {4050}in(c, =GetEndpointRequest);
                                                                    {4051}new SP_4211: bitstring;
                                                                    {4052}new UP_4212: bitstring;
                                                                    {4053}out(c, (GetEndpointResponse,pkSess_4210,None,SP_4211,UP_4212))
                                                                )
                                                                else
                                                                    {4054}let pkSess_4213: bitstring = pub(sk(Sess_3938)) in
                                                                    {4055}in(c, =GetEndpointRequest);
                                                                    {4056}new SP_4214: bitstring;
                                                                    {4057}new UP_4215: bitstring;
                                                                    {4058}out(c, (GetEndpointResponse,pkSess_4213,None,SP_4214,UP_4215))
                                                            )
                                                            else
                                                                {4059}let pkSess_4216: bitstring = fail-any in
                                                                {4060}in(c, =GetEndpointRequest);
                                                                {4061}new SP_4217: bitstring;
                                                                {4062}new UP_4218: bitstring;
                                                                {4063}out(c, (GetEndpointResponse,pkSess_4216,None,SP_4217,UP_4218))
                                                    )
                                                    else
                                                        {4064}let pkSess_4219: bitstring = fail-any in
                                                        {4065}in(c, =GetEndpointRequest);
                                                        {4066}new SP_4220: bitstring;
                                                        {4067}new UP_4221: bitstring;
                                                        {4068}out(c, (GetEndpointResponse,pkSess_4219,None,SP_4220,UP_4221))
                                            )
                                            else
                                                {4069}let pkSess_4222: bitstring = fail-any in
                                                {4070}in(c, =GetEndpointRequest);
                                                {4071}new SP_4223: bitstring;
                                                {4072}new UP_4224: bitstring;
                                                {4073}out(c, (GetEndpointResponse,pkSess_4222,None,SP_4223,UP_4224))
                                    )
                                    else
                                        {4074}let pkCli_4225: bitstring = fail-any in
                                        {4075}let v_4226: bool = (Sess_3938 = A) in
                                        (
                                            {4076}if v_4226 then
                                            (
                                                {4077}let pkSess_4227: bitstring = pub(skA) in
                                                {4078}in(c, =GetEndpointRequest);
                                                {4079}new SP_4228: bitstring;
                                                {4080}new UP_4229: bitstring;
                                                {4081}out(c, (GetEndpointResponse,pkSess_4227,None,SP_4228,UP_4229))
                                            )
                                            else
                                                {4082}let v_4230: bool = (Sess_3938 = B) in
                                                (
                                                    {4083}if v_4230 then
                                                    (
                                                        {4084}let pkSess_4231: bitstring = pub(skB) in
                                                        {4085}in(c, =GetEndpointRequest);
                                                        {4086}new SP_4232: bitstring;
                                                        {4087}new UP_4233: bitstring;
                                                        {4088}out(c, (GetEndpointResponse,pkSess_4231,None,SP_4232,UP_4233))
                                                    )
                                                    else
                                                        {4089}let v_4234: bool = (Sess_3938 = C) in
                                                        (
                                                            {4090}if v_4234 then
                                                            (
                                                                {4091}let pkSess_4235: bitstring = pub(skC) in
                                                                {4092}in(c, =GetEndpointRequest);
                                                                {4093}new SP_4236: bitstring;
                                                                {4094}new UP_4237: bitstring;
                                                                {4095}out(c, (GetEndpointResponse,pkSess_4235,None,SP_4236,UP_4237))
                                                            )
                                                            else
                                                                {4096}let pkSess_4238: bitstring = pub(sk(Sess_3938)) in
                                                                {4097}in(c, =GetEndpointRequest);
                                                                {4098}new SP_4239: bitstring;
                                                                {4099}new UP_4240: bitstring;
                                                                {4100}out(c, (GetEndpointResponse,pkSess_4238,None,SP_4239,UP_4240))
                                                        )
                                                        else
                                                            {4101}let pkSess_4241: bitstring = fail-any in
                                                            {4102}in(c, =GetEndpointRequest);
                                                            {4103}new SP_4242: bitstring;
                                                            {4104}new UP_4243: bitstring;
                                                            {4105}out(c, (GetEndpointResponse,pkSess_4241,None,SP_4242,UP_4243))
                                                )
                                                else
                                                    {4106}let pkSess_4244: bitstring = fail-any in
                                                    {4107}in(c, =GetEndpointRequest);
                                                    {4108}new SP_4245: bitstring;
                                                    {4109}new UP_4246: bitstring;
                                                    {4110}out(c, (GetEndpointResponse,pkSess_4244,None,SP_4245,UP_4246))
                                        )
                                        else
                                            {4111}let pkSess_4247: bitstring = fail-any in
                                            {4112}in(c, =GetEndpointRequest);
                                            {4113}new SP_4248: bitstring;
                                            {4114}new UP_4249: bitstring;
                                            {4115}out(c, (GetEndpointResponse,pkSess_4247,None,SP_4248,UP_4249))
                            )
                            else
                                {4116}let pkCli_4250: bitstring = fail-any in
                                {4117}let v_4251: bool = (Sess_3938 = A) in
                                (
                                    {4118}if v_4251 then
                                    (
                                        {4119}let pkSess_4252: bitstring = pub(skA) in
                                        {4120}in(c, =GetEndpointRequest);
                                        {4121}new SP_4253: bitstring;
                                        {4122}new UP_4254: bitstring;
                                        {4123}out(c, (GetEndpointResponse,pkSess_4252,None,SP_4253,UP_4254))
                                    )
                                    else
                                        {4124}let v_4255: bool = (Sess_3938 = B) in
                                        (
                                            {4125}if v_4255 then
                                            (
                                                {4126}let pkSess_4256: bitstring = pub(skB) in
                                                {4127}in(c, =GetEndpointRequest);
                                                {4128}new SP_4257: bitstring;
                                                {4129}new UP_4258: bitstring;
                                                {4130}out(c, (GetEndpointResponse,pkSess_4256,None,SP_4257,UP_4258))
                                            )
                                            else
                                                {4131}let v_4259: bool = (Sess_3938 = C) in
                                                (
                                                    {4132}if v_4259 then
                                                    (
                                                        {4133}let pkSess_4260: bitstring = pub(skC) in
                                                        {4134}in(c, =GetEndpointRequest);
                                                        {4135}new SP_4261: bitstring;
                                                        {4136}new UP_4262: bitstring;
                                                        {4137}out(c, (GetEndpointResponse,pkSess_4260,None,SP_4261,UP_4262))
                                                    )
                                                    else
                                                        {4138}let pkSess_4263: bitstring = pub(sk(Sess_3938)) in
                                                        {4139}in(c, =GetEndpointRequest);
                                                        {4140}new SP_4264: bitstring;
                                                        {4141}new UP_4265: bitstring;
                                                        {4142}out(c, (GetEndpointResponse,pkSess_4263,None,SP_4264,UP_4265))
                                                )
                                                else
                                                    {4143}let pkSess_4266: bitstring = fail-any in
                                                    {4144}in(c, =GetEndpointRequest);
                                                    {4145}new SP_4267: bitstring;
                                                    {4146}new UP_4268: bitstring;
                                                    {4147}out(c, (GetEndpointResponse,pkSess_4266,None,SP_4267,UP_4268))
                                        )
                                        else
                                            {4148}let pkSess_4269: bitstring = fail-any in
                                            {4149}in(c, =GetEndpointRequest);
                                            {4150}new SP_4270: bitstring;
                                            {4151}new UP_4271: bitstring;
                                            {4152}out(c, (GetEndpointResponse,pkSess_4269,None,SP_4270,UP_4271))
                                )
                                else
                                    {4153}let pkSess_4272: bitstring = fail-any in
                                    {4154}in(c, =GetEndpointRequest);
                                    {4155}new SP_4273: bitstring;
                                    {4156}new UP_4274: bitstring;
                                    {4157}out(c, (GetEndpointResponse,pkSess_4272,None,SP_4273,UP_4274))
                    )
                    else
                        {4158}let pkCli_4275: bitstring = fail-any in
                        {4159}let v_4276: bool = (Sess_3938 = A) in
                        (
                            {4160}if v_4276 then
                            (
                                {4161}let pkSess_4277: bitstring = pub(skA) in
                                {4162}in(c, =GetEndpointRequest);
                                {4163}new SP_4278: bitstring;
                                {4164}new UP_4279: bitstring;
                                {4165}out(c, (GetEndpointResponse,pkSess_4277,None,SP_4278,UP_4279))
                            )
                            else
                                {4166}let v_4280: bool = (Sess_3938 = B) in
                                (
                                    {4167}if v_4280 then
                                    (
                                        {4168}let pkSess_4281: bitstring = pub(skB) in
                                        {4169}in(c, =GetEndpointRequest);
                                        {4170}new SP_4282: bitstring;
                                        {4171}new UP_4283: bitstring;
                                        {4172}out(c, (GetEndpointResponse,pkSess_4281,None,SP_4282,UP_4283))
                                    )
                                    else
                                        {4173}let v_4284: bool = (Sess_3938 = C) in
                                        (
                                            {4174}if v_4284 then
                                            (
                                                {4175}let pkSess_4285: bitstring = pub(skC) in
                                                {4176}in(c, =GetEndpointRequest);
                                                {4177}new SP_4286: bitstring;
                                                {4178}new UP_4287: bitstring;
                                                {4179}out(c, (GetEndpointResponse,pkSess_4285,None,SP_4286,UP_4287))
                                            )
                                            else
                                                {4180}let pkSess_4288: bitstring = pub(sk(Sess_3938)) in
                                                {4181}in(c, =GetEndpointRequest);
                                                {4182}new SP_4289: bitstring;
                                                {4183}new UP_4290: bitstring;
                                                {4184}out(c, (GetEndpointResponse,pkSess_4288,None,SP_4289,UP_4290))
                                        )
                                        else
                                            {4185}let pkSess_4291: bitstring = fail-any in
                                            {4186}in(c, =GetEndpointRequest);
                                            {4187}new SP_4292: bitstring;
                                            {4188}new UP_4293: bitstring;
                                            {4189}out(c, (GetEndpointResponse,pkSess_4291,None,SP_4292,UP_4293))
                                )
                                else
                                    {4190}let pkSess_4294: bitstring = fail-any in
                                    {4191}in(c, =GetEndpointRequest);
                                    {4192}new SP_4295: bitstring;
                                    {4193}new UP_4296: bitstring;
                                    {4194}out(c, (GetEndpointResponse,pkSess_4294,None,SP_4295,UP_4296))
                        )
                        else
                            {4195}let pkSess_4297: bitstring = fail-any in
                            {4196}in(c, =GetEndpointRequest);
                            {4197}new SP_4298: bitstring;
                            {4198}new UP_4299: bitstring;
                            {4199}out(c, (GetEndpointResponse,pkSess_4297,None,SP_4298,UP_4299))
                )
                else
                    {4200}let =true = (Disco_3937 = C) in
                    (
                        {4201}let skDisco_4300: bitstring = skC in
                        {4202}let pkDisco_4301: bitstring = pub(skDisco_4300) in
                        {4203}let v_4302: bool = (Cli_3936 = A) in
                        (
                            {4204}if v_4302 then
                            (
                                {4205}let pkCli_4303: bitstring = pub(skA) in
                                {4206}let v_4304: bool = (Sess_3938 = A) in
                                (
                                    {4207}if v_4304 then
                                    (
                                        {4208}let pkSess_4305: bitstring = pub(skA) in
                                        {4209}in(c, =GetEndpointRequest);
                                        {4210}new SP_4306: bitstring;
                                        {4211}new UP_4307: bitstring;
                                        {4212}out(c, (GetEndpointResponse,pkSess_4305,None,SP_4306,UP_4307))
                                    )
                                    else
                                        {4213}let v_4308: bool = (Sess_3938 = B) in
                                        (
                                            {4214}if v_4308 then
                                            (
                                                {4215}let pkSess_4309: bitstring = pub(skB) in
                                                {4216}in(c, =GetEndpointRequest);
                                                {4217}new SP_4310: bitstring;
                                                {4218}new UP_4311: bitstring;
                                                {4219}out(c, (GetEndpointResponse,pkSess_4309,None,SP_4310,UP_4311))
                                            )
                                            else
                                                {4220}let v_4312: bool = (Sess_3938 = C) in
                                                (
                                                    {4221}if v_4312 then
                                                    (
                                                        {4222}let pkSess_4313: bitstring = pub(skC) in
                                                        {4223}in(c, =GetEndpointRequest);
                                                        {4224}new SP_4314: bitstring;
                                                        {4225}new UP_4315: bitstring;
                                                        {4226}out(c, (GetEndpointResponse,pkSess_4313,None,SP_4314,UP_4315))
                                                    )
                                                    else
                                                        {4227}let pkSess_4316: bitstring = pub(sk(Sess_3938)) in
                                                        {4228}in(c, =GetEndpointRequest);
                                                        {4229}new SP_4317: bitstring;
                                                        {4230}new UP_4318: bitstring;
                                                        {4231}out(c, (GetEndpointResponse,pkSess_4316,None,SP_4317,UP_4318))
                                                )
                                                else
                                                    {4232}let pkSess_4319: bitstring = fail-any in
                                                    {4233}in(c, =GetEndpointRequest);
                                                    {4234}new SP_4320: bitstring;
                                                    {4235}new UP_4321: bitstring;
                                                    {4236}out(c, (GetEndpointResponse,pkSess_4319,None,SP_4320,UP_4321))
                                        )
                                        else
                                            {4237}let pkSess_4322: bitstring = fail-any in
                                            {4238}in(c, =GetEndpointRequest);
                                            {4239}new SP_4323: bitstring;
                                            {4240}new UP_4324: bitstring;
                                            {4241}out(c, (GetEndpointResponse,pkSess_4322,None,SP_4323,UP_4324))
                                )
                                else
                                    {4242}let pkSess_4325: bitstring = fail-any in
                                    {4243}in(c, =GetEndpointRequest);
                                    {4244}new SP_4326: bitstring;
                                    {4245}new UP_4327: bitstring;
                                    {4246}out(c, (GetEndpointResponse,pkSess_4325,None,SP_4326,UP_4327))
                            )
                            else
                                {4247}let v_4328: bool = (Cli_3936 = B) in
                                (
                                    {4248}if v_4328 then
                                    (
                                        {4249}let pkCli_4329: bitstring = pub(skB) in
                                        {4250}let v_4330: bool = (Sess_3938 = A) in
                                        (
                                            {4251}if v_4330 then
                                            (
                                                {4252}let pkSess_4331: bitstring = pub(skA) in
                                                {4253}in(c, =GetEndpointRequest);
                                                {4254}new SP_4332: bitstring;
                                                {4255}new UP_4333: bitstring;
                                                {4256}out(c, (GetEndpointResponse,pkSess_4331,None,SP_4332,UP_4333))
                                            )
                                            else
                                                {4257}let v_4334: bool = (Sess_3938 = B) in
                                                (
                                                    {4258}if v_4334 then
                                                    (
                                                        {4259}let pkSess_4335: bitstring = pub(skB) in
                                                        {4260}in(c, =GetEndpointRequest);
                                                        {4261}new SP_4336: bitstring;
                                                        {4262}new UP_4337: bitstring;
                                                        {4263}out(c, (GetEndpointResponse,pkSess_4335,None,SP_4336,UP_4337))
                                                    )
                                                    else
                                                        {4264}let v_4338: bool = (Sess_3938 = C) in
                                                        (
                                                            {4265}if v_4338 then
                                                            (
                                                                {4266}let pkSess_4339: bitstring = pub(skC) in
                                                                {4267}in(c, =GetEndpointRequest);
                                                                {4268}new SP_4340: bitstring;
                                                                {4269}new UP_4341: bitstring;
                                                                {4270}out(c, (GetEndpointResponse,pkSess_4339,None,SP_4340,UP_4341))
                                                            )
                                                            else
                                                                {4271}let pkSess_4342: bitstring = pub(sk(Sess_3938)) in
                                                                {4272}in(c, =GetEndpointRequest);
                                                                {4273}new SP_4343: bitstring;
                                                                {4274}new UP_4344: bitstring;
                                                                {4275}out(c, (GetEndpointResponse,pkSess_4342,None,SP_4343,UP_4344))
                                                        )
                                                        else
                                                            {4276}let pkSess_4345: bitstring = fail-any in
                                                            {4277}in(c, =GetEndpointRequest);
                                                            {4278}new SP_4346: bitstring;
                                                            {4279}new UP_4347: bitstring;
                                                            {4280}out(c, (GetEndpointResponse,pkSess_4345,None,SP_4346,UP_4347))
                                                )
                                                else
                                                    {4281}let pkSess_4348: bitstring = fail-any in
                                                    {4282}in(c, =GetEndpointRequest);
                                                    {4283}new SP_4349: bitstring;
                                                    {4284}new UP_4350: bitstring;
                                                    {4285}out(c, (GetEndpointResponse,pkSess_4348,None,SP_4349,UP_4350))
                                        )
                                        else
                                            {4286}let pkSess_4351: bitstring = fail-any in
                                            {4287}in(c, =GetEndpointRequest);
                                            {4288}new SP_4352: bitstring;
                                            {4289}new UP_4353: bitstring;
                                            {4290}out(c, (GetEndpointResponse,pkSess_4351,None,SP_4352,UP_4353))
                                    )
                                    else
                                        {4291}let v_4354: bool = (Cli_3936 = C) in
                                        (
                                            {4292}if v_4354 then
                                            (
                                                {4293}let pkCli_4355: bitstring = pub(skC) in
                                                {4294}let v_4356: bool = (Sess_3938 = A) in
                                                (
                                                    {4295}if v_4356 then
                                                    (
                                                        {4296}let pkSess_4357: bitstring = pub(skA) in
                                                        {4297}in(c, =GetEndpointRequest);
                                                        {4298}new SP_4358: bitstring;
                                                        {4299}new UP_4359: bitstring;
                                                        {4300}out(c, (GetEndpointResponse,pkSess_4357,None,SP_4358,UP_4359))
                                                    )
                                                    else
                                                        {4301}let v_4360: bool = (Sess_3938 = B) in
                                                        (
                                                            {4302}if v_4360 then
                                                            (
                                                                {4303}let pkSess_4361: bitstring = pub(skB) in
                                                                {4304}in(c, =GetEndpointRequest);
                                                                {4305}new SP_4362: bitstring;
                                                                {4306}new UP_4363: bitstring;
                                                                {4307}out(c, (GetEndpointResponse,pkSess_4361,None,SP_4362,UP_4363))
                                                            )
                                                            else
                                                                {4308}let v_4364: bool = (Sess_3938 = C) in
                                                                (
                                                                    {4309}if v_4364 then
                                                                    (
                                                                        {4310}let pkSess_4365: bitstring = pub(skC) in
                                                                        {4311}in(c, =GetEndpointRequest);
                                                                        {4312}new SP_4366: bitstring;
                                                                        {4313}new UP_4367: bitstring;
                                                                        {4314}out(c, (GetEndpointResponse,pkSess_4365,None,SP_4366,UP_4367))
                                                                    )
                                                                    else
                                                                        {4315}let pkSess_4368: bitstring = pub(sk(Sess_3938)) in
                                                                        {4316}in(c, =GetEndpointRequest);
                                                                        {4317}new SP_4369: bitstring;
                                                                        {4318}new UP_4370: bitstring;
                                                                        {4319}out(c, (GetEndpointResponse,pkSess_4368,None,SP_4369,UP_4370))
                                                                )
                                                                else
                                                                    {4320}let pkSess_4371: bitstring = fail-any in
                                                                    {4321}in(c, =GetEndpointRequest);
                                                                    {4322}new SP_4372: bitstring;
                                                                    {4323}new UP_4373: bitstring;
                                                                    {4324}out(c, (GetEndpointResponse,pkSess_4371,None,SP_4372,UP_4373))
                                                        )
                                                        else
                                                            {4325}let pkSess_4374: bitstring = fail-any in
                                                            {4326}in(c, =GetEndpointRequest);
                                                            {4327}new SP_4375: bitstring;
                                                            {4328}new UP_4376: bitstring;
                                                            {4329}out(c, (GetEndpointResponse,pkSess_4374,None,SP_4375,UP_4376))
                                                )
                                                else
                                                    {4330}let pkSess_4377: bitstring = fail-any in
                                                    {4331}in(c, =GetEndpointRequest);
                                                    {4332}new SP_4378: bitstring;
                                                    {4333}new UP_4379: bitstring;
                                                    {4334}out(c, (GetEndpointResponse,pkSess_4377,None,SP_4378,UP_4379))
                                            )
                                            else
                                                {4335}let pkCli_4380: bitstring = pub(sk(Cli_3936)) in
                                                {4336}let v_4381: bool = (Sess_3938 = A) in
                                                (
                                                    {4337}if v_4381 then
                                                    (
                                                        {4338}let pkSess_4382: bitstring = pub(skA) in
                                                        {4339}in(c, =GetEndpointRequest);
                                                        {4340}new SP_4383: bitstring;
                                                        {4341}new UP_4384: bitstring;
                                                        {4342}out(c, (GetEndpointResponse,pkSess_4382,None,SP_4383,UP_4384))
                                                    )
                                                    else
                                                        {4343}let v_4385: bool = (Sess_3938 = B) in
                                                        (
                                                            {4344}if v_4385 then
                                                            (
                                                                {4345}let pkSess_4386: bitstring = pub(skB) in
                                                                {4346}in(c, =GetEndpointRequest);
                                                                {4347}new SP_4387: bitstring;
                                                                {4348}new UP_4388: bitstring;
                                                                {4349}out(c, (GetEndpointResponse,pkSess_4386,None,SP_4387,UP_4388))
                                                            )
                                                            else
                                                                {4350}let v_4389: bool = (Sess_3938 = C) in
                                                                (
                                                                    {4351}if v_4389 then
                                                                    (
                                                                        {4352}let pkSess_4390: bitstring = pub(skC) in
                                                                        {4353}in(c, =GetEndpointRequest);
                                                                        {4354}new SP_4391: bitstring;
                                                                        {4355}new UP_4392: bitstring;
                                                                        {4356}out(c, (GetEndpointResponse,pkSess_4390,None,SP_4391,UP_4392))
                                                                    )
                                                                    else
                                                                        {4357}let pkSess_4393: bitstring = pub(sk(Sess_3938)) in
                                                                        {4358}in(c, =GetEndpointRequest);
                                                                        {4359}new SP_4394: bitstring;
                                                                        {4360}new UP_4395: bitstring;
                                                                        {4361}out(c, (GetEndpointResponse,pkSess_4393,None,SP_4394,UP_4395))
                                                                )
                                                                else
                                                                    {4362}let pkSess_4396: bitstring = fail-any in
                                                                    {4363}in(c, =GetEndpointRequest);
                                                                    {4364}new SP_4397: bitstring;
                                                                    {4365}new UP_4398: bitstring;
                                                                    {4366}out(c, (GetEndpointResponse,pkSess_4396,None,SP_4397,UP_4398))
                                                        )
                                                        else
                                                            {4367}let pkSess_4399: bitstring = fail-any in
                                                            {4368}in(c, =GetEndpointRequest);
                                                            {4369}new SP_4400: bitstring;
                                                            {4370}new UP_4401: bitstring;
                                                            {4371}out(c, (GetEndpointResponse,pkSess_4399,None,SP_4400,UP_4401))
                                                )
                                                else
                                                    {4372}let pkSess_4402: bitstring = fail-any in
                                                    {4373}in(c, =GetEndpointRequest);
                                                    {4374}new SP_4403: bitstring;
                                                    {4375}new UP_4404: bitstring;
                                                    {4376}out(c, (GetEndpointResponse,pkSess_4402,None,SP_4403,UP_4404))
                                        )
                                        else
                                            {4377}let pkCli_4405: bitstring = fail-any in
                                            {4378}let v_4406: bool = (Sess_3938 = A) in
                                            (
                                                {4379}if v_4406 then
                                                (
                                                    {4380}let pkSess_4407: bitstring = pub(skA) in
                                                    {4381}in(c, =GetEndpointRequest);
                                                    {4382}new SP_4408: bitstring;
                                                    {4383}new UP_4409: bitstring;
                                                    {4384}out(c, (GetEndpointResponse,pkSess_4407,None,SP_4408,UP_4409))
                                                )
                                                else
                                                    {4385}let v_4410: bool = (Sess_3938 = B) in
                                                    (
                                                        {4386}if v_4410 then
                                                        (
                                                            {4387}let pkSess_4411: bitstring = pub(skB) in
                                                            {4388}in(c, =GetEndpointRequest);
                                                            {4389}new SP_4412: bitstring;
                                                            {4390}new UP_4413: bitstring;
                                                            {4391}out(c, (GetEndpointResponse,pkSess_4411,None,SP_4412,UP_4413))
                                                        )
                                                        else
                                                            {4392}let v_4414: bool = (Sess_3938 = C) in
                                                            (
                                                                {4393}if v_4414 then
                                                                (
                                                                    {4394}let pkSess_4415: bitstring = pub(skC) in
                                                                    {4395}in(c, =GetEndpointRequest);
                                                                    {4396}new SP_4416: bitstring;
                                                                    {4397}new UP_4417: bitstring;
                                                                    {4398}out(c, (GetEndpointResponse,pkSess_4415,None,SP_4416,UP_4417))
                                                                )
                                                                else
                                                                    {4399}let pkSess_4418: bitstring = pub(sk(Sess_3938)) in
                                                                    {4400}in(c, =GetEndpointRequest);
                                                                    {4401}new SP_4419: bitstring;
                                                                    {4402}new UP_4420: bitstring;
                                                                    {4403}out(c, (GetEndpointResponse,pkSess_4418,None,SP_4419,UP_4420))
                                                            )
                                                            else
                                                                {4404}let pkSess_4421: bitstring = fail-any in
                                                                {4405}in(c, =GetEndpointRequest);
                                                                {4406}new SP_4422: bitstring;
                                                                {4407}new UP_4423: bitstring;
                                                                {4408}out(c, (GetEndpointResponse,pkSess_4421,None,SP_4422,UP_4423))
                                                    )
                                                    else
                                                        {4409}let pkSess_4424: bitstring = fail-any in
                                                        {4410}in(c, =GetEndpointRequest);
                                                        {4411}new SP_4425: bitstring;
                                                        {4412}new UP_4426: bitstring;
                                                        {4413}out(c, (GetEndpointResponse,pkSess_4424,None,SP_4425,UP_4426))
                                            )
                                            else
                                                {4414}let pkSess_4427: bitstring = fail-any in
                                                {4415}in(c, =GetEndpointRequest);
                                                {4416}new SP_4428: bitstring;
                                                {4417}new UP_4429: bitstring;
                                                {4418}out(c, (GetEndpointResponse,pkSess_4427,None,SP_4428,UP_4429))
                                )
                                else
                                    {4419}let pkCli_4430: bitstring = fail-any in
                                    {4420}let v_4431: bool = (Sess_3938 = A) in
                                    (
                                        {4421}if v_4431 then
                                        (
                                            {4422}let pkSess_4432: bitstring = pub(skA) in
                                            {4423}in(c, =GetEndpointRequest);
                                            {4424}new SP_4433: bitstring;
                                            {4425}new UP_4434: bitstring;
                                            {4426}out(c, (GetEndpointResponse,pkSess_4432,None,SP_4433,UP_4434))
                                        )
                                        else
                                            {4427}let v_4435: bool = (Sess_3938 = B) in
                                            (
                                                {4428}if v_4435 then
                                                (
                                                    {4429}let pkSess_4436: bitstring = pub(skB) in
                                                    {4430}in(c, =GetEndpointRequest);
                                                    {4431}new SP_4437: bitstring;
                                                    {4432}new UP_4438: bitstring;
                                                    {4433}out(c, (GetEndpointResponse,pkSess_4436,None,SP_4437,UP_4438))
                                                )
                                                else
                                                    {4434}let v_4439: bool = (Sess_3938 = C) in
                                                    (
                                                        {4435}if v_4439 then
                                                        (
                                                            {4436}let pkSess_4440: bitstring = pub(skC) in
                                                            {4437}in(c, =GetEndpointRequest);
                                                            {4438}new SP_4441: bitstring;
                                                            {4439}new UP_4442: bitstring;
                                                            {4440}out(c, (GetEndpointResponse,pkSess_4440,None,SP_4441,UP_4442))
                                                        )
                                                        else
                                                            {4441}let pkSess_4443: bitstring = pub(sk(Sess_3938)) in
                                                            {4442}in(c, =GetEndpointRequest);
                                                            {4443}new SP_4444: bitstring;
                                                            {4444}new UP_4445: bitstring;
                                                            {4445}out(c, (GetEndpointResponse,pkSess_4443,None,SP_4444,UP_4445))
                                                    )
                                                    else
                                                        {4446}let pkSess_4446: bitstring = fail-any in
                                                        {4447}in(c, =GetEndpointRequest);
                                                        {4448}new SP_4447: bitstring;
                                                        {4449}new UP_4448: bitstring;
                                                        {4450}out(c, (GetEndpointResponse,pkSess_4446,None,SP_4447,UP_4448))
                                            )
                                            else
                                                {4451}let pkSess_4449: bitstring = fail-any in
                                                {4452}in(c, =GetEndpointRequest);
                                                {4453}new SP_4450: bitstring;
                                                {4454}new UP_4451: bitstring;
                                                {4455}out(c, (GetEndpointResponse,pkSess_4449,None,SP_4450,UP_4451))
                                    )
                                    else
                                        {4456}let pkSess_4452: bitstring = fail-any in
                                        {4457}in(c, =GetEndpointRequest);
                                        {4458}new SP_4453: bitstring;
                                        {4459}new UP_4454: bitstring;
                                        {4460}out(c, (GetEndpointResponse,pkSess_4452,None,SP_4453,UP_4454))
                        )
                        else
                            {4461}let pkCli_4455: bitstring = fail-any in
                            {4462}let v_4456: bool = (Sess_3938 = A) in
                            (
                                {4463}if v_4456 then
                                (
                                    {4464}let pkSess_4457: bitstring = pub(skA) in
                                    {4465}in(c, =GetEndpointRequest);
                                    {4466}new SP_4458: bitstring;
                                    {4467}new UP_4459: bitstring;
                                    {4468}out(c, (GetEndpointResponse,pkSess_4457,None,SP_4458,UP_4459))
                                )
                                else
                                    {4469}let v_4460: bool = (Sess_3938 = B) in
                                    (
                                        {4470}if v_4460 then
                                        (
                                            {4471}let pkSess_4461: bitstring = pub(skB) in
                                            {4472}in(c, =GetEndpointRequest);
                                            {4473}new SP_4462: bitstring;
                                            {4474}new UP_4463: bitstring;
                                            {4475}out(c, (GetEndpointResponse,pkSess_4461,None,SP_4462,UP_4463))
                                        )
                                        else
                                            {4476}let v_4464: bool = (Sess_3938 = C) in
                                            (
                                                {4477}if v_4464 then
                                                (
                                                    {4478}let pkSess_4465: bitstring = pub(skC) in
                                                    {4479}in(c, =GetEndpointRequest);
                                                    {4480}new SP_4466: bitstring;
                                                    {4481}new UP_4467: bitstring;
                                                    {4482}out(c, (GetEndpointResponse,pkSess_4465,None,SP_4466,UP_4467))
                                                )
                                                else
                                                    {4483}let pkSess_4468: bitstring = pub(sk(Sess_3938)) in
                                                    {4484}in(c, =GetEndpointRequest);
                                                    {4485}new SP_4469: bitstring;
                                                    {4486}new UP_4470: bitstring;
                                                    {4487}out(c, (GetEndpointResponse,pkSess_4468,None,SP_4469,UP_4470))
                                            )
                                            else
                                                {4488}let pkSess_4471: bitstring = fail-any in
                                                {4489}in(c, =GetEndpointRequest);
                                                {4490}new SP_4472: bitstring;
                                                {4491}new UP_4473: bitstring;
                                                {4492}out(c, (GetEndpointResponse,pkSess_4471,None,SP_4472,UP_4473))
                                    )
                                    else
                                        {4493}let pkSess_4474: bitstring = fail-any in
                                        {4494}in(c, =GetEndpointRequest);
                                        {4495}new SP_4475: bitstring;
                                        {4496}new UP_4476: bitstring;
                                        {4497}out(c, (GetEndpointResponse,pkSess_4474,None,SP_4475,UP_4476))
                            )
                            else
                                {4498}let pkSess_4477: bitstring = fail-any in
                                {4499}in(c, =GetEndpointRequest);
                                {4500}new SP_4478: bitstring;
                                {4501}new UP_4479: bitstring;
                                {4502}out(c, (GetEndpointResponse,pkSess_4477,None,SP_4478,UP_4479))
                    )
                    else
                        {4503}let skDisco_4480: bitstring = fail-any in
                        {4504}let pkDisco_4481: bitstring = pub(skDisco_4480) in
                        {4505}let v_4482: bool = (Cli_3936 = A) in
                        (
                            {4506}if v_4482 then
                            (
                                {4507}let pkCli_4483: bitstring = pub(skA) in
                                {4508}let v_4484: bool = (Sess_3938 = A) in
                                (
                                    {4509}if v_4484 then
                                    (
                                        {4510}let pkSess_4485: bitstring = pub(skA) in
                                        {4511}in(c, =GetEndpointRequest);
                                        {4512}new SP_4486: bitstring;
                                        {4513}new UP_4487: bitstring;
                                        {4514}out(c, (GetEndpointResponse,pkSess_4485,None,SP_4486,UP_4487))
                                    )
                                    else
                                        {4515}let v_4488: bool = (Sess_3938 = B) in
                                        (
                                            {4516}if v_4488 then
                                            (
                                                {4517}let pkSess_4489: bitstring = pub(skB) in
                                                {4518}in(c, =GetEndpointRequest);
                                                {4519}new SP_4490: bitstring;
                                                {4520}new UP_4491: bitstring;
                                                {4521}out(c, (GetEndpointResponse,pkSess_4489,None,SP_4490,UP_4491))
                                            )
                                            else
                                                {4522}let v_4492: bool = (Sess_3938 = C) in
                                                (
                                                    {4523}if v_4492 then
                                                    (
                                                        {4524}let pkSess_4493: bitstring = pub(skC) in
                                                        {4525}in(c, =GetEndpointRequest);
                                                        {4526}new SP_4494: bitstring;
                                                        {4527}new UP_4495: bitstring;
                                                        {4528}out(c, (GetEndpointResponse,pkSess_4493,None,SP_4494,UP_4495))
                                                    )
                                                    else
                                                        {4529}let pkSess_4496: bitstring = pub(sk(Sess_3938)) in
                                                        {4530}in(c, =GetEndpointRequest);
                                                        {4531}new SP_4497: bitstring;
                                                        {4532}new UP_4498: bitstring;
                                                        {4533}out(c, (GetEndpointResponse,pkSess_4496,None,SP_4497,UP_4498))
                                                )
                                                else
                                                    {4534}let pkSess_4499: bitstring = fail-any in
                                                    {4535}in(c, =GetEndpointRequest);
                                                    {4536}new SP_4500: bitstring;
                                                    {4537}new UP_4501: bitstring;
                                                    {4538}out(c, (GetEndpointResponse,pkSess_4499,None,SP_4500,UP_4501))
                                        )
                                        else
                                            {4539}let pkSess_4502: bitstring = fail-any in
                                            {4540}in(c, =GetEndpointRequest);
                                            {4541}new SP_4503: bitstring;
                                            {4542}new UP_4504: bitstring;
                                            {4543}out(c, (GetEndpointResponse,pkSess_4502,None,SP_4503,UP_4504))
                                )
                                else
                                    {4544}let pkSess_4505: bitstring = fail-any in
                                    {4545}in(c, =GetEndpointRequest);
                                    {4546}new SP_4506: bitstring;
                                    {4547}new UP_4507: bitstring;
                                    {4548}out(c, (GetEndpointResponse,pkSess_4505,None,SP_4506,UP_4507))
                            )
                            else
                                {4549}let v_4508: bool = (Cli_3936 = B) in
                                (
                                    {4550}if v_4508 then
                                    (
                                        {4551}let pkCli_4509: bitstring = pub(skB) in
                                        {4552}let v_4510: bool = (Sess_3938 = A) in
                                        (
                                            {4553}if v_4510 then
                                            (
                                                {4554}let pkSess_4511: bitstring = pub(skA) in
                                                {4555}in(c, =GetEndpointRequest);
                                                {4556}new SP_4512: bitstring;
                                                {4557}new UP_4513: bitstring;
                                                {4558}out(c, (GetEndpointResponse,pkSess_4511,None,SP_4512,UP_4513))
                                            )
                                            else
                                                {4559}let v_4514: bool = (Sess_3938 = B) in
                                                (
                                                    {4560}if v_4514 then
                                                    (
                                                        {4561}let pkSess_4515: bitstring = pub(skB) in
                                                        {4562}in(c, =GetEndpointRequest);
                                                        {4563}new SP_4516: bitstring;
                                                        {4564}new UP_4517: bitstring;
                                                        {4565}out(c, (GetEndpointResponse,pkSess_4515,None,SP_4516,UP_4517))
                                                    )
                                                    else
                                                        {4566}let v_4518: bool = (Sess_3938 = C) in
                                                        (
                                                            {4567}if v_4518 then
                                                            (
                                                                {4568}let pkSess_4519: bitstring = pub(skC) in
                                                                {4569}in(c, =GetEndpointRequest);
                                                                {4570}new SP_4520: bitstring;
                                                                {4571}new UP_4521: bitstring;
                                                                {4572}out(c, (GetEndpointResponse,pkSess_4519,None,SP_4520,UP_4521))
                                                            )
                                                            else
                                                                {4573}let pkSess_4522: bitstring = pub(sk(Sess_3938)) in
                                                                {4574}in(c, =GetEndpointRequest);
                                                                {4575}new SP_4523: bitstring;
                                                                {4576}new UP_4524: bitstring;
                                                                {4577}out(c, (GetEndpointResponse,pkSess_4522,None,SP_4523,UP_4524))
                                                        )
                                                        else
                                                            {4578}let pkSess_4525: bitstring = fail-any in
                                                            {4579}in(c, =GetEndpointRequest);
                                                            {4580}new SP_4526: bitstring;
                                                            {4581}new UP_4527: bitstring;
                                                            {4582}out(c, (GetEndpointResponse,pkSess_4525,None,SP_4526,UP_4527))
                                                )
                                                else
                                                    {4583}let pkSess_4528: bitstring = fail-any in
                                                    {4584}in(c, =GetEndpointRequest);
                                                    {4585}new SP_4529: bitstring;
                                                    {4586}new UP_4530: bitstring;
                                                    {4587}out(c, (GetEndpointResponse,pkSess_4528,None,SP_4529,UP_4530))
                                        )
                                        else
                                            {4588}let pkSess_4531: bitstring = fail-any in
                                            {4589}in(c, =GetEndpointRequest);
                                            {4590}new SP_4532: bitstring;
                                            {4591}new UP_4533: bitstring;
                                            {4592}out(c, (GetEndpointResponse,pkSess_4531,None,SP_4532,UP_4533))
                                    )
                                    else
                                        {4593}let v_4534: bool = (Cli_3936 = C) in
                                        (
                                            {4594}if v_4534 then
                                            (
                                                {4595}let pkCli_4535: bitstring = pub(skC) in
                                                {4596}let v_4536: bool = (Sess_3938 = A) in
                                                (
                                                    {4597}if v_4536 then
                                                    (
                                                        {4598}let pkSess_4537: bitstring = pub(skA) in
                                                        {4599}in(c, =GetEndpointRequest);
                                                        {4600}new SP_4538: bitstring;
                                                        {4601}new UP_4539: bitstring;
                                                        {4602}out(c, (GetEndpointResponse,pkSess_4537,None,SP_4538,UP_4539))
                                                    )
                                                    else
                                                        {4603}let v_4540: bool = (Sess_3938 = B) in
                                                        (
                                                            {4604}if v_4540 then
                                                            (
                                                                {4605}let pkSess_4541: bitstring = pub(skB) in
                                                                {4606}in(c, =GetEndpointRequest);
                                                                {4607}new SP_4542: bitstring;
                                                                {4608}new UP_4543: bitstring;
                                                                {4609}out(c, (GetEndpointResponse,pkSess_4541,None,SP_4542,UP_4543))
                                                            )
                                                            else
                                                                {4610}let v_4544: bool = (Sess_3938 = C) in
                                                                (
                                                                    {4611}if v_4544 then
                                                                    (
                                                                        {4612}let pkSess_4545: bitstring = pub(skC) in
                                                                        {4613}in(c, =GetEndpointRequest);
                                                                        {4614}new SP_4546: bitstring;
                                                                        {4615}new UP_4547: bitstring;
                                                                        {4616}out(c, (GetEndpointResponse,pkSess_4545,None,SP_4546,UP_4547))
                                                                    )
                                                                    else
                                                                        {4617}let pkSess_4548: bitstring = pub(sk(Sess_3938)) in
                                                                        {4618}in(c, =GetEndpointRequest);
                                                                        {4619}new SP_4549: bitstring;
                                                                        {4620}new UP_4550: bitstring;
                                                                        {4621}out(c, (GetEndpointResponse,pkSess_4548,None,SP_4549,UP_4550))
                                                                )
                                                                else
                                                                    {4622}let pkSess_4551: bitstring = fail-any in
                                                                    {4623}in(c, =GetEndpointRequest);
                                                                    {4624}new SP_4552: bitstring;
                                                                    {4625}new UP_4553: bitstring;
                                                                    {4626}out(c, (GetEndpointResponse,pkSess_4551,None,SP_4552,UP_4553))
                                                        )
                                                        else
                                                            {4627}let pkSess_4554: bitstring = fail-any in
                                                            {4628}in(c, =GetEndpointRequest);
                                                            {4629}new SP_4555: bitstring;
                                                            {4630}new UP_4556: bitstring;
                                                            {4631}out(c, (GetEndpointResponse,pkSess_4554,None,SP_4555,UP_4556))
                                                )
                                                else
                                                    {4632}let pkSess_4557: bitstring = fail-any in
                                                    {4633}in(c, =GetEndpointRequest);
                                                    {4634}new SP_4558: bitstring;
                                                    {4635}new UP_4559: bitstring;
                                                    {4636}out(c, (GetEndpointResponse,pkSess_4557,None,SP_4558,UP_4559))
                                            )
                                            else
                                                {4637}let pkCli_4560: bitstring = pub(sk(Cli_3936)) in
                                                {4638}let v_4561: bool = (Sess_3938 = A) in
                                                (
                                                    {4639}if v_4561 then
                                                    (
                                                        {4640}let pkSess_4562: bitstring = pub(skA) in
                                                        {4641}in(c, =GetEndpointRequest);
                                                        {4642}new SP_4563: bitstring;
                                                        {4643}new UP_4564: bitstring;
                                                        {4644}out(c, (GetEndpointResponse,pkSess_4562,None,SP_4563,UP_4564))
                                                    )
                                                    else
                                                        {4645}let v_4565: bool = (Sess_3938 = B) in
                                                        (
                                                            {4646}if v_4565 then
                                                            (
                                                                {4647}let pkSess_4566: bitstring = pub(skB) in
                                                                {4648}in(c, =GetEndpointRequest);
                                                                {4649}new SP_4567: bitstring;
                                                                {4650}new UP_4568: bitstring;
                                                                {4651}out(c, (GetEndpointResponse,pkSess_4566,None,SP_4567,UP_4568))
                                                            )
                                                            else
                                                                {4652}let v_4569: bool = (Sess_3938 = C) in
                                                                (
                                                                    {4653}if v_4569 then
                                                                    (
                                                                        {4654}let pkSess_4570: bitstring = pub(skC) in
                                                                        {4655}in(c, =GetEndpointRequest);
                                                                        {4656}new SP_4571: bitstring;
                                                                        {4657}new UP_4572: bitstring;
                                                                        {4658}out(c, (GetEndpointResponse,pkSess_4570,None,SP_4571,UP_4572))
                                                                    )
                                                                    else
                                                                        {4659}let pkSess_4573: bitstring = pub(sk(Sess_3938)) in
                                                                        {4660}in(c, =GetEndpointRequest);
                                                                        {4661}new SP_4574: bitstring;
                                                                        {4662}new UP_4575: bitstring;
                                                                        {4663}out(c, (GetEndpointResponse,pkSess_4573,None,SP_4574,UP_4575))
                                                                )
                                                                else
                                                                    {4664}let pkSess_4576: bitstring = fail-any in
                                                                    {4665}in(c, =GetEndpointRequest);
                                                                    {4666}new SP_4577: bitstring;
                                                                    {4667}new UP_4578: bitstring;
                                                                    {4668}out(c, (GetEndpointResponse,pkSess_4576,None,SP_4577,UP_4578))
                                                        )
                                                        else
                                                            {4669}let pkSess_4579: bitstring = fail-any in
                                                            {4670}in(c, =GetEndpointRequest);
                                                            {4671}new SP_4580: bitstring;
                                                            {4672}new UP_4581: bitstring;
                                                            {4673}out(c, (GetEndpointResponse,pkSess_4579,None,SP_4580,UP_4581))
                                                )
                                                else
                                                    {4674}let pkSess_4582: bitstring = fail-any in
                                                    {4675}in(c, =GetEndpointRequest);
                                                    {4676}new SP_4583: bitstring;
                                                    {4677}new UP_4584: bitstring;
                                                    {4678}out(c, (GetEndpointResponse,pkSess_4582,None,SP_4583,UP_4584))
                                        )
                                        else
                                            {4679}let pkCli_4585: bitstring = fail-any in
                                            {4680}let v_4586: bool = (Sess_3938 = A) in
                                            (
                                                {4681}if v_4586 then
                                                (
                                                    {4682}let pkSess_4587: bitstring = pub(skA) in
                                                    {4683}in(c, =GetEndpointRequest);
                                                    {4684}new SP_4588: bitstring;
                                                    {4685}new UP_4589: bitstring;
                                                    {4686}out(c, (GetEndpointResponse,pkSess_4587,None,SP_4588,UP_4589))
                                                )
                                                else
                                                    {4687}let v_4590: bool = (Sess_3938 = B) in
                                                    (
                                                        {4688}if v_4590 then
                                                        (
                                                            {4689}let pkSess_4591: bitstring = pub(skB) in
                                                            {4690}in(c, =GetEndpointRequest);
                                                            {4691}new SP_4592: bitstring;
                                                            {4692}new UP_4593: bitstring;
                                                            {4693}out(c, (GetEndpointResponse,pkSess_4591,None,SP_4592,UP_4593))
                                                        )
                                                        else
                                                            {4694}let v_4594: bool = (Sess_3938 = C) in
                                                            (
                                                                {4695}if v_4594 then
                                                                (
                                                                    {4696}let pkSess_4595: bitstring = pub(skC) in
                                                                    {4697}in(c, =GetEndpointRequest);
                                                                    {4698}new SP_4596: bitstring;
                                                                    {4699}new UP_4597: bitstring;
                                                                    {4700}out(c, (GetEndpointResponse,pkSess_4595,None,SP_4596,UP_4597))
                                                                )
                                                                else
                                                                    {4701}let pkSess_4598: bitstring = pub(sk(Sess_3938)) in
                                                                    {4702}in(c, =GetEndpointRequest);
                                                                    {4703}new SP_4599: bitstring;
                                                                    {4704}new UP_4600: bitstring;
                                                                    {4705}out(c, (GetEndpointResponse,pkSess_4598,None,SP_4599,UP_4600))
                                                            )
                                                            else
                                                                {4706}let pkSess_4601: bitstring = fail-any in
                                                                {4707}in(c, =GetEndpointRequest);
                                                                {4708}new SP_4602: bitstring;
                                                                {4709}new UP_4603: bitstring;
                                                                {4710}out(c, (GetEndpointResponse,pkSess_4601,None,SP_4602,UP_4603))
                                                    )
                                                    else
                                                        {4711}let pkSess_4604: bitstring = fail-any in
                                                        {4712}in(c, =GetEndpointRequest);
                                                        {4713}new SP_4605: bitstring;
                                                        {4714}new UP_4606: bitstring;
                                                        {4715}out(c, (GetEndpointResponse,pkSess_4604,None,SP_4605,UP_4606))
                                            )
                                            else
                                                {4716}let pkSess_4607: bitstring = fail-any in
                                                {4717}in(c, =GetEndpointRequest);
                                                {4718}new SP_4608: bitstring;
                                                {4719}new UP_4609: bitstring;
                                                {4720}out(c, (GetEndpointResponse,pkSess_4607,None,SP_4608,UP_4609))
                                )
                                else
                                    {4721}let pkCli_4610: bitstring = fail-any in
                                    {4722}let v_4611: bool = (Sess_3938 = A) in
                                    (
                                        {4723}if v_4611 then
                                        (
                                            {4724}let pkSess_4612: bitstring = pub(skA) in
                                            {4725}in(c, =GetEndpointRequest);
                                            {4726}new SP_4613: bitstring;
                                            {4727}new UP_4614: bitstring;
                                            {4728}out(c, (GetEndpointResponse,pkSess_4612,None,SP_4613,UP_4614))
                                        )
                                        else
                                            {4729}let v_4615: bool = (Sess_3938 = B) in
                                            (
                                                {4730}if v_4615 then
                                                (
                                                    {4731}let pkSess_4616: bitstring = pub(skB) in
                                                    {4732}in(c, =GetEndpointRequest);
                                                    {4733}new SP_4617: bitstring;
                                                    {4734}new UP_4618: bitstring;
                                                    {4735}out(c, (GetEndpointResponse,pkSess_4616,None,SP_4617,UP_4618))
                                                )
                                                else
                                                    {4736}let v_4619: bool = (Sess_3938 = C) in
                                                    (
                                                        {4737}if v_4619 then
                                                        (
                                                            {4738}let pkSess_4620: bitstring = pub(skC) in
                                                            {4739}in(c, =GetEndpointRequest);
                                                            {4740}new SP_4621: bitstring;
                                                            {4741}new UP_4622: bitstring;
                                                            {4742}out(c, (GetEndpointResponse,pkSess_4620,None,SP_4621,UP_4622))
                                                        )
                                                        else
                                                            {4743}let pkSess_4623: bitstring = pub(sk(Sess_3938)) in
                                                            {4744}in(c, =GetEndpointRequest);
                                                            {4745}new SP_4624: bitstring;
                                                            {4746}new UP_4625: bitstring;
                                                            {4747}out(c, (GetEndpointResponse,pkSess_4623,None,SP_4624,UP_4625))
                                                    )
                                                    else
                                                        {4748}let pkSess_4626: bitstring = fail-any in
                                                        {4749}in(c, =GetEndpointRequest);
                                                        {4750}new SP_4627: bitstring;
                                                        {4751}new UP_4628: bitstring;
                                                        {4752}out(c, (GetEndpointResponse,pkSess_4626,None,SP_4627,UP_4628))
                                            )
                                            else
                                                {4753}let pkSess_4629: bitstring = fail-any in
                                                {4754}in(c, =GetEndpointRequest);
                                                {4755}new SP_4630: bitstring;
                                                {4756}new UP_4631: bitstring;
                                                {4757}out(c, (GetEndpointResponse,pkSess_4629,None,SP_4630,UP_4631))
                                    )
                                    else
                                        {4758}let pkSess_4632: bitstring = fail-any in
                                        {4759}in(c, =GetEndpointRequest);
                                        {4760}new SP_4633: bitstring;
                                        {4761}new UP_4634: bitstring;
                                        {4762}out(c, (GetEndpointResponse,pkSess_4632,None,SP_4633,UP_4634))
                        )
                        else
                            {4763}let pkCli_4635: bitstring = fail-any in
                            {4764}let v_4636: bool = (Sess_3938 = A) in
                            (
                                {4765}if v_4636 then
                                (
                                    {4766}let pkSess_4637: bitstring = pub(skA) in
                                    {4767}in(c, =GetEndpointRequest);
                                    {4768}new SP_4638: bitstring;
                                    {4769}new UP_4639: bitstring;
                                    {4770}out(c, (GetEndpointResponse,pkSess_4637,None,SP_4638,UP_4639))
                                )
                                else
                                    {4771}let v_4640: bool = (Sess_3938 = B) in
                                    (
                                        {4772}if v_4640 then
                                        (
                                            {4773}let pkSess_4641: bitstring = pub(skB) in
                                            {4774}in(c, =GetEndpointRequest);
                                            {4775}new SP_4642: bitstring;
                                            {4776}new UP_4643: bitstring;
                                            {4777}out(c, (GetEndpointResponse,pkSess_4641,None,SP_4642,UP_4643))
                                        )
                                        else
                                            {4778}let v_4644: bool = (Sess_3938 = C) in
                                            (
                                                {4779}if v_4644 then
                                                (
                                                    {4780}let pkSess_4645: bitstring = pub(skC) in
                                                    {4781}in(c, =GetEndpointRequest);
                                                    {4782}new SP_4646: bitstring;
                                                    {4783}new UP_4647: bitstring;
                                                    {4784}out(c, (GetEndpointResponse,pkSess_4645,None,SP_4646,UP_4647))
                                                )
                                                else
                                                    {4785}let pkSess_4648: bitstring = pub(sk(Sess_3938)) in
                                                    {4786}in(c, =GetEndpointRequest);
                                                    {4787}new SP_4649: bitstring;
                                                    {4788}new UP_4650: bitstring;
                                                    {4789}out(c, (GetEndpointResponse,pkSess_4648,None,SP_4649,UP_4650))
                                            )
                                            else
                                                {4790}let pkSess_4651: bitstring = fail-any in
                                                {4791}in(c, =GetEndpointRequest);
                                                {4792}new SP_4652: bitstring;
                                                {4793}new UP_4653: bitstring;
                                                {4794}out(c, (GetEndpointResponse,pkSess_4651,None,SP_4652,UP_4653))
                                    )
                                    else
                                        {4795}let pkSess_4654: bitstring = fail-any in
                                        {4796}in(c, =GetEndpointRequest);
                                        {4797}new SP_4655: bitstring;
                                        {4798}new UP_4656: bitstring;
                                        {4799}out(c, (GetEndpointResponse,pkSess_4654,None,SP_4655,UP_4656))
                            )
                            else
                                {4800}let pkSess_4657: bitstring = fail-any in
                                {4801}in(c, =GetEndpointRequest);
                                {4802}new SP_4658: bitstring;
                                {4803}new UP_4659: bitstring;
                                {4804}out(c, (GetEndpointResponse,pkSess_4657,None,SP_4658,UP_4659))
            )
            else
                {4805}let skDisco_4660: bitstring = fail-any in
                {4806}let pkDisco_4661: bitstring = pub(skDisco_4660) in
                {4807}let v_4662: bool = (Cli_3936 = A) in
                (
                    {4808}if v_4662 then
                    (
                        {4809}let pkCli_4663: bitstring = pub(skA) in
                        {4810}let v_4664: bool = (Sess_3938 = A) in
                        (
                            {4811}if v_4664 then
                            (
                                {4812}let pkSess_4665: bitstring = pub(skA) in
                                {4813}in(c, =GetEndpointRequest);
                                {4814}new SP_4666: bitstring;
                                {4815}new UP_4667: bitstring;
                                {4816}out(c, (GetEndpointResponse,pkSess_4665,None,SP_4666,UP_4667))
                            )
                            else
                                {4817}let v_4668: bool = (Sess_3938 = B) in
                                (
                                    {4818}if v_4668 then
                                    (
                                        {4819}let pkSess_4669: bitstring = pub(skB) in
                                        {4820}in(c, =GetEndpointRequest);
                                        {4821}new SP_4670: bitstring;
                                        {4822}new UP_4671: bitstring;
                                        {4823}out(c, (GetEndpointResponse,pkSess_4669,None,SP_4670,UP_4671))
                                    )
                                    else
                                        {4824}let v_4672: bool = (Sess_3938 = C) in
                                        (
                                            {4825}if v_4672 then
                                            (
                                                {4826}let pkSess_4673: bitstring = pub(skC) in
                                                {4827}in(c, =GetEndpointRequest);
                                                {4828}new SP_4674: bitstring;
                                                {4829}new UP_4675: bitstring;
                                                {4830}out(c, (GetEndpointResponse,pkSess_4673,None,SP_4674,UP_4675))
                                            )
                                            else
                                                {4831}let pkSess_4676: bitstring = pub(sk(Sess_3938)) in
                                                {4832}in(c, =GetEndpointRequest);
                                                {4833}new SP_4677: bitstring;
                                                {4834}new UP_4678: bitstring;
                                                {4835}out(c, (GetEndpointResponse,pkSess_4676,None,SP_4677,UP_4678))
                                        )
                                        else
                                            {4836}let pkSess_4679: bitstring = fail-any in
                                            {4837}in(c, =GetEndpointRequest);
                                            {4838}new SP_4680: bitstring;
                                            {4839}new UP_4681: bitstring;
                                            {4840}out(c, (GetEndpointResponse,pkSess_4679,None,SP_4680,UP_4681))
                                )
                                else
                                    {4841}let pkSess_4682: bitstring = fail-any in
                                    {4842}in(c, =GetEndpointRequest);
                                    {4843}new SP_4683: bitstring;
                                    {4844}new UP_4684: bitstring;
                                    {4845}out(c, (GetEndpointResponse,pkSess_4682,None,SP_4683,UP_4684))
                        )
                        else
                            {4846}let pkSess_4685: bitstring = fail-any in
                            {4847}in(c, =GetEndpointRequest);
                            {4848}new SP_4686: bitstring;
                            {4849}new UP_4687: bitstring;
                            {4850}out(c, (GetEndpointResponse,pkSess_4685,None,SP_4686,UP_4687))
                    )
                    else
                        {4851}let v_4688: bool = (Cli_3936 = B) in
                        (
                            {4852}if v_4688 then
                            (
                                {4853}let pkCli_4689: bitstring = pub(skB) in
                                {4854}let v_4690: bool = (Sess_3938 = A) in
                                (
                                    {4855}if v_4690 then
                                    (
                                        {4856}let pkSess_4691: bitstring = pub(skA) in
                                        {4857}in(c, =GetEndpointRequest);
                                        {4858}new SP_4692: bitstring;
                                        {4859}new UP_4693: bitstring;
                                        {4860}out(c, (GetEndpointResponse,pkSess_4691,None,SP_4692,UP_4693))
                                    )
                                    else
                                        {4861}let v_4694: bool = (Sess_3938 = B) in
                                        (
                                            {4862}if v_4694 then
                                            (
                                                {4863}let pkSess_4695: bitstring = pub(skB) in
                                                {4864}in(c, =GetEndpointRequest);
                                                {4865}new SP_4696: bitstring;
                                                {4866}new UP_4697: bitstring;
                                                {4867}out(c, (GetEndpointResponse,pkSess_4695,None,SP_4696,UP_4697))
                                            )
                                            else
                                                {4868}let v_4698: bool = (Sess_3938 = C) in
                                                (
                                                    {4869}if v_4698 then
                                                    (
                                                        {4870}let pkSess_4699: bitstring = pub(skC) in
                                                        {4871}in(c, =GetEndpointRequest);
                                                        {4872}new SP_4700: bitstring;
                                                        {4873}new UP_4701: bitstring;
                                                        {4874}out(c, (GetEndpointResponse,pkSess_4699,None,SP_4700,UP_4701))
                                                    )
                                                    else
                                                        {4875}let pkSess_4702: bitstring = pub(sk(Sess_3938)) in
                                                        {4876}in(c, =GetEndpointRequest);
                                                        {4877}new SP_4703: bitstring;
                                                        {4878}new UP_4704: bitstring;
                                                        {4879}out(c, (GetEndpointResponse,pkSess_4702,None,SP_4703,UP_4704))
                                                )
                                                else
                                                    {4880}let pkSess_4705: bitstring = fail-any in
                                                    {4881}in(c, =GetEndpointRequest);
                                                    {4882}new SP_4706: bitstring;
                                                    {4883}new UP_4707: bitstring;
                                                    {4884}out(c, (GetEndpointResponse,pkSess_4705,None,SP_4706,UP_4707))
                                        )
                                        else
                                            {4885}let pkSess_4708: bitstring = fail-any in
                                            {4886}in(c, =GetEndpointRequest);
                                            {4887}new SP_4709: bitstring;
                                            {4888}new UP_4710: bitstring;
                                            {4889}out(c, (GetEndpointResponse,pkSess_4708,None,SP_4709,UP_4710))
                                )
                                else
                                    {4890}let pkSess_4711: bitstring = fail-any in
                                    {4891}in(c, =GetEndpointRequest);
                                    {4892}new SP_4712: bitstring;
                                    {4893}new UP_4713: bitstring;
                                    {4894}out(c, (GetEndpointResponse,pkSess_4711,None,SP_4712,UP_4713))
                            )
                            else
                                {4895}let v_4714: bool = (Cli_3936 = C) in
                                (
                                    {4896}if v_4714 then
                                    (
                                        {4897}let pkCli_4715: bitstring = pub(skC) in
                                        {4898}let v_4716: bool = (Sess_3938 = A) in
                                        (
                                            {4899}if v_4716 then
                                            (
                                                {4900}let pkSess_4717: bitstring = pub(skA) in
                                                {4901}in(c, =GetEndpointRequest);
                                                {4902}new SP_4718: bitstring;
                                                {4903}new UP_4719: bitstring;
                                                {4904}out(c, (GetEndpointResponse,pkSess_4717,None,SP_4718,UP_4719))
                                            )
                                            else
                                                {4905}let v_4720: bool = (Sess_3938 = B) in
                                                (
                                                    {4906}if v_4720 then
                                                    (
                                                        {4907}let pkSess_4721: bitstring = pub(skB) in
                                                        {4908}in(c, =GetEndpointRequest);
                                                        {4909}new SP_4722: bitstring;
                                                        {4910}new UP_4723: bitstring;
                                                        {4911}out(c, (GetEndpointResponse,pkSess_4721,None,SP_4722,UP_4723))
                                                    )
                                                    else
                                                        {4912}let v_4724: bool = (Sess_3938 = C) in
                                                        (
                                                            {4913}if v_4724 then
                                                            (
                                                                {4914}let pkSess_4725: bitstring = pub(skC) in
                                                                {4915}in(c, =GetEndpointRequest);
                                                                {4916}new SP_4726: bitstring;
                                                                {4917}new UP_4727: bitstring;
                                                                {4918}out(c, (GetEndpointResponse,pkSess_4725,None,SP_4726,UP_4727))
                                                            )
                                                            else
                                                                {4919}let pkSess_4728: bitstring = pub(sk(Sess_3938)) in
                                                                {4920}in(c, =GetEndpointRequest);
                                                                {4921}new SP_4729: bitstring;
                                                                {4922}new UP_4730: bitstring;
                                                                {4923}out(c, (GetEndpointResponse,pkSess_4728,None,SP_4729,UP_4730))
                                                        )
                                                        else
                                                            {4924}let pkSess_4731: bitstring = fail-any in
                                                            {4925}in(c, =GetEndpointRequest);
                                                            {4926}new SP_4732: bitstring;
                                                            {4927}new UP_4733: bitstring;
                                                            {4928}out(c, (GetEndpointResponse,pkSess_4731,None,SP_4732,UP_4733))
                                                )
                                                else
                                                    {4929}let pkSess_4734: bitstring = fail-any in
                                                    {4930}in(c, =GetEndpointRequest);
                                                    {4931}new SP_4735: bitstring;
                                                    {4932}new UP_4736: bitstring;
                                                    {4933}out(c, (GetEndpointResponse,pkSess_4734,None,SP_4735,UP_4736))
                                        )
                                        else
                                            {4934}let pkSess_4737: bitstring = fail-any in
                                            {4935}in(c, =GetEndpointRequest);
                                            {4936}new SP_4738: bitstring;
                                            {4937}new UP_4739: bitstring;
                                            {4938}out(c, (GetEndpointResponse,pkSess_4737,None,SP_4738,UP_4739))
                                    )
                                    else
                                        {4939}let pkCli_4740: bitstring = pub(sk(Cli_3936)) in
                                        {4940}let v_4741: bool = (Sess_3938 = A) in
                                        (
                                            {4941}if v_4741 then
                                            (
                                                {4942}let pkSess_4742: bitstring = pub(skA) in
                                                {4943}in(c, =GetEndpointRequest);
                                                {4944}new SP_4743: bitstring;
                                                {4945}new UP_4744: bitstring;
                                                {4946}out(c, (GetEndpointResponse,pkSess_4742,None,SP_4743,UP_4744))
                                            )
                                            else
                                                {4947}let v_4745: bool = (Sess_3938 = B) in
                                                (
                                                    {4948}if v_4745 then
                                                    (
                                                        {4949}let pkSess_4746: bitstring = pub(skB) in
                                                        {4950}in(c, =GetEndpointRequest);
                                                        {4951}new SP_4747: bitstring;
                                                        {4952}new UP_4748: bitstring;
                                                        {4953}out(c, (GetEndpointResponse,pkSess_4746,None,SP_4747,UP_4748))
                                                    )
                                                    else
                                                        {4954}let v_4749: bool = (Sess_3938 = C) in
                                                        (
                                                            {4955}if v_4749 then
                                                            (
                                                                {4956}let pkSess_4750: bitstring = pub(skC) in
                                                                {4957}in(c, =GetEndpointRequest);
                                                                {4958}new SP_4751: bitstring;
                                                                {4959}new UP_4752: bitstring;
                                                                {4960}out(c, (GetEndpointResponse,pkSess_4750,None,SP_4751,UP_4752))
                                                            )
                                                            else
                                                                {4961}let pkSess_4753: bitstring = pub(sk(Sess_3938)) in
                                                                {4962}in(c, =GetEndpointRequest);
                                                                {4963}new SP_4754: bitstring;
                                                                {4964}new UP_4755: bitstring;
                                                                {4965}out(c, (GetEndpointResponse,pkSess_4753,None,SP_4754,UP_4755))
                                                        )
                                                        else
                                                            {4966}let pkSess_4756: bitstring = fail-any in
                                                            {4967}in(c, =GetEndpointRequest);
                                                            {4968}new SP_4757: bitstring;
                                                            {4969}new UP_4758: bitstring;
                                                            {4970}out(c, (GetEndpointResponse,pkSess_4756,None,SP_4757,UP_4758))
                                                )
                                                else
                                                    {4971}let pkSess_4759: bitstring = fail-any in
                                                    {4972}in(c, =GetEndpointRequest);
                                                    {4973}new SP_4760: bitstring;
                                                    {4974}new UP_4761: bitstring;
                                                    {4975}out(c, (GetEndpointResponse,pkSess_4759,None,SP_4760,UP_4761))
                                        )
                                        else
                                            {4976}let pkSess_4762: bitstring = fail-any in
                                            {4977}in(c, =GetEndpointRequest);
                                            {4978}new SP_4763: bitstring;
                                            {4979}new UP_4764: bitstring;
                                            {4980}out(c, (GetEndpointResponse,pkSess_4762,None,SP_4763,UP_4764))
                                )
                                else
                                    {4981}let pkCli_4765: bitstring = fail-any in
                                    {4982}let v_4766: bool = (Sess_3938 = A) in
                                    (
                                        {4983}if v_4766 then
                                        (
                                            {4984}let pkSess_4767: bitstring = pub(skA) in
                                            {4985}in(c, =GetEndpointRequest);
                                            {4986}new SP_4768: bitstring;
                                            {4987}new UP_4769: bitstring;
                                            {4988}out(c, (GetEndpointResponse,pkSess_4767,None,SP_4768,UP_4769))
                                        )
                                        else
                                            {4989}let v_4770: bool = (Sess_3938 = B) in
                                            (
                                                {4990}if v_4770 then
                                                (
                                                    {4991}let pkSess_4771: bitstring = pub(skB) in
                                                    {4992}in(c, =GetEndpointRequest);
                                                    {4993}new SP_4772: bitstring;
                                                    {4994}new UP_4773: bitstring;
                                                    {4995}out(c, (GetEndpointResponse,pkSess_4771,None,SP_4772,UP_4773))
                                                )
                                                else
                                                    {4996}let v_4774: bool = (Sess_3938 = C) in
                                                    (
                                                        {4997}if v_4774 then
                                                        (
                                                            {4998}let pkSess_4775: bitstring = pub(skC) in
                                                            {4999}in(c, =GetEndpointRequest);
                                                            {5000}new SP_4776: bitstring;
                                                            {5001}new UP_4777: bitstring;
                                                            {5002}out(c, (GetEndpointResponse,pkSess_4775,None,SP_4776,UP_4777))
                                                        )
                                                        else
                                                            {5003}let pkSess_4778: bitstring = pub(sk(Sess_3938)) in
                                                            {5004}in(c, =GetEndpointRequest);
                                                            {5005}new SP_4779: bitstring;
                                                            {5006}new UP_4780: bitstring;
                                                            {5007}out(c, (GetEndpointResponse,pkSess_4778,None,SP_4779,UP_4780))
                                                    )
                                                    else
                                                        {5008}let pkSess_4781: bitstring = fail-any in
                                                        {5009}in(c, =GetEndpointRequest);
                                                        {5010}new SP_4782: bitstring;
                                                        {5011}new UP_4783: bitstring;
                                                        {5012}out(c, (GetEndpointResponse,pkSess_4781,None,SP_4782,UP_4783))
                                            )
                                            else
                                                {5013}let pkSess_4784: bitstring = fail-any in
                                                {5014}in(c, =GetEndpointRequest);
                                                {5015}new SP_4785: bitstring;
                                                {5016}new UP_4786: bitstring;
                                                {5017}out(c, (GetEndpointResponse,pkSess_4784,None,SP_4785,UP_4786))
                                    )
                                    else
                                        {5018}let pkSess_4787: bitstring = fail-any in
                                        {5019}in(c, =GetEndpointRequest);
                                        {5020}new SP_4788: bitstring;
                                        {5021}new UP_4789: bitstring;
                                        {5022}out(c, (GetEndpointResponse,pkSess_4787,None,SP_4788,UP_4789))
                        )
                        else
                            {5023}let pkCli_4790: bitstring = fail-any in
                            {5024}let v_4791: bool = (Sess_3938 = A) in
                            (
                                {5025}if v_4791 then
                                (
                                    {5026}let pkSess_4792: bitstring = pub(skA) in
                                    {5027}in(c, =GetEndpointRequest);
                                    {5028}new SP_4793: bitstring;
                                    {5029}new UP_4794: bitstring;
                                    {5030}out(c, (GetEndpointResponse,pkSess_4792,None,SP_4793,UP_4794))
                                )
                                else
                                    {5031}let v_4795: bool = (Sess_3938 = B) in
                                    (
                                        {5032}if v_4795 then
                                        (
                                            {5033}let pkSess_4796: bitstring = pub(skB) in
                                            {5034}in(c, =GetEndpointRequest);
                                            {5035}new SP_4797: bitstring;
                                            {5036}new UP_4798: bitstring;
                                            {5037}out(c, (GetEndpointResponse,pkSess_4796,None,SP_4797,UP_4798))
                                        )
                                        else
                                            {5038}let v_4799: bool = (Sess_3938 = C) in
                                            (
                                                {5039}if v_4799 then
                                                (
                                                    {5040}let pkSess_4800: bitstring = pub(skC) in
                                                    {5041}in(c, =GetEndpointRequest);
                                                    {5042}new SP_4801: bitstring;
                                                    {5043}new UP_4802: bitstring;
                                                    {5044}out(c, (GetEndpointResponse,pkSess_4800,None,SP_4801,UP_4802))
                                                )
                                                else
                                                    {5045}let pkSess_4803: bitstring = pub(sk(Sess_3938)) in
                                                    {5046}in(c, =GetEndpointRequest);
                                                    {5047}new SP_4804: bitstring;
                                                    {5048}new UP_4805: bitstring;
                                                    {5049}out(c, (GetEndpointResponse,pkSess_4803,None,SP_4804,UP_4805))
                                            )
                                            else
                                                {5050}let pkSess_4806: bitstring = fail-any in
                                                {5051}in(c, =GetEndpointRequest);
                                                {5052}new SP_4807: bitstring;
                                                {5053}new UP_4808: bitstring;
                                                {5054}out(c, (GetEndpointResponse,pkSess_4806,None,SP_4807,UP_4808))
                                    )
                                    else
                                        {5055}let pkSess_4809: bitstring = fail-any in
                                        {5056}in(c, =GetEndpointRequest);
                                        {5057}new SP_4810: bitstring;
                                        {5058}new UP_4811: bitstring;
                                        {5059}out(c, (GetEndpointResponse,pkSess_4809,None,SP_4810,UP_4811))
                            )
                            else
                                {5060}let pkSess_4812: bitstring = fail-any in
                                {5061}in(c, =GetEndpointRequest);
                                {5062}new SP_4813: bitstring;
                                {5063}new UP_4814: bitstring;
                                {5064}out(c, (GetEndpointResponse,pkSess_4812,None,SP_4813,UP_4814))
                )
                else
                    {5065}let pkCli_4815: bitstring = fail-any in
                    {5066}let v_4816: bool = (Sess_3938 = A) in
                    (
                        {5067}if v_4816 then
                        (
                            {5068}let pkSess_4817: bitstring = pub(skA) in
                            {5069}in(c, =GetEndpointRequest);
                            {5070}new SP_4818: bitstring;
                            {5071}new UP_4819: bitstring;
                            {5072}out(c, (GetEndpointResponse,pkSess_4817,None,SP_4818,UP_4819))
                        )
                        else
                            {5073}let v_4820: bool = (Sess_3938 = B) in
                            (
                                {5074}if v_4820 then
                                (
                                    {5075}let pkSess_4821: bitstring = pub(skB) in
                                    {5076}in(c, =GetEndpointRequest);
                                    {5077}new SP_4822: bitstring;
                                    {5078}new UP_4823: bitstring;
                                    {5079}out(c, (GetEndpointResponse,pkSess_4821,None,SP_4822,UP_4823))
                                )
                                else
                                    {5080}let v_4824: bool = (Sess_3938 = C) in
                                    (
                                        {5081}if v_4824 then
                                        (
                                            {5082}let pkSess_4825: bitstring = pub(skC) in
                                            {5083}in(c, =GetEndpointRequest);
                                            {5084}new SP_4826: bitstring;
                                            {5085}new UP_4827: bitstring;
                                            {5086}out(c, (GetEndpointResponse,pkSess_4825,None,SP_4826,UP_4827))
                                        )
                                        else
                                            {5087}let pkSess_4828: bitstring = pub(sk(Sess_3938)) in
                                            {5088}in(c, =GetEndpointRequest);
                                            {5089}new SP_4829: bitstring;
                                            {5090}new UP_4830: bitstring;
                                            {5091}out(c, (GetEndpointResponse,pkSess_4828,None,SP_4829,UP_4830))
                                    )
                                    else
                                        {5092}let pkSess_4831: bitstring = fail-any in
                                        {5093}in(c, =GetEndpointRequest);
                                        {5094}new SP_4832: bitstring;
                                        {5095}new UP_4833: bitstring;
                                        {5096}out(c, (GetEndpointResponse,pkSess_4831,None,SP_4832,UP_4833))
                            )
                            else
                                {5097}let pkSess_4834: bitstring = fail-any in
                                {5098}in(c, =GetEndpointRequest);
                                {5099}new SP_4835: bitstring;
                                {5100}new UP_4836: bitstring;
                                {5101}out(c, (GetEndpointResponse,pkSess_4834,None,SP_4835,UP_4836))
                    )
                    else
                        {5102}let pkSess_4837: bitstring = fail-any in
                        {5103}in(c, =GetEndpointRequest);
                        {5104}new SP_4838: bitstring;
                        {5105}new UP_4839: bitstring;
                        {5106}out(c, (GetEndpointResponse,pkSess_4837,None,SP_4838,UP_4839))
    )
    else
        {5107}let skDisco_4840: bitstring = fail-any in
        {5108}let pkDisco_4841: bitstring = pub(skDisco_4840) in
        {5109}let v_4842: bool = (Cli_3936 = A) in
        (
            {5110}if v_4842 then
            (
                {5111}let pkCli_4843: bitstring = pub(skA) in
                {5112}let v_4844: bool = (Sess_3938 = A) in
                (
                    {5113}if v_4844 then
                    (
                        {5114}let pkSess_4845: bitstring = pub(skA) in
                        {5115}in(c, =GetEndpointRequest);
                        {5116}new SP_4846: bitstring;
                        {5117}new UP_4847: bitstring;
                        {5118}out(c, (GetEndpointResponse,pkSess_4845,None,SP_4846,UP_4847))
                    )
                    else
                        {5119}let v_4848: bool = (Sess_3938 = B) in
                        (
                            {5120}if v_4848 then
                            (
                                {5121}let pkSess_4849: bitstring = pub(skB) in
                                {5122}in(c, =GetEndpointRequest);
                                {5123}new SP_4850: bitstring;
                                {5124}new UP_4851: bitstring;
                                {5125}out(c, (GetEndpointResponse,pkSess_4849,None,SP_4850,UP_4851))
                            )
                            else
                                {5126}let v_4852: bool = (Sess_3938 = C) in
                                (
                                    {5127}if v_4852 then
                                    (
                                        {5128}let pkSess_4853: bitstring = pub(skC) in
                                        {5129}in(c, =GetEndpointRequest);
                                        {5130}new SP_4854: bitstring;
                                        {5131}new UP_4855: bitstring;
                                        {5132}out(c, (GetEndpointResponse,pkSess_4853,None,SP_4854,UP_4855))
                                    )
                                    else
                                        {5133}let pkSess_4856: bitstring = pub(sk(Sess_3938)) in
                                        {5134}in(c, =GetEndpointRequest);
                                        {5135}new SP_4857: bitstring;
                                        {5136}new UP_4858: bitstring;
                                        {5137}out(c, (GetEndpointResponse,pkSess_4856,None,SP_4857,UP_4858))
                                )
                                else
                                    {5138}let pkSess_4859: bitstring = fail-any in
                                    {5139}in(c, =GetEndpointRequest);
                                    {5140}new SP_4860: bitstring;
                                    {5141}new UP_4861: bitstring;
                                    {5142}out(c, (GetEndpointResponse,pkSess_4859,None,SP_4860,UP_4861))
                        )
                        else
                            {5143}let pkSess_4862: bitstring = fail-any in
                            {5144}in(c, =GetEndpointRequest);
                            {5145}new SP_4863: bitstring;
                            {5146}new UP_4864: bitstring;
                            {5147}out(c, (GetEndpointResponse,pkSess_4862,None,SP_4863,UP_4864))
                )
                else
                    {5148}let pkSess_4865: bitstring = fail-any in
                    {5149}in(c, =GetEndpointRequest);
                    {5150}new SP_4866: bitstring;
                    {5151}new UP_4867: bitstring;
                    {5152}out(c, (GetEndpointResponse,pkSess_4865,None,SP_4866,UP_4867))
            )
            else
                {5153}let v_4868: bool = (Cli_3936 = B) in
                (
                    {5154}if v_4868 then
                    (
                        {5155}let pkCli_4869: bitstring = pub(skB) in
                        {5156}let v_4870: bool = (Sess_3938 = A) in
                        (
                            {5157}if v_4870 then
                            (
                                {5158}let pkSess_4871: bitstring = pub(skA) in
                                {5159}in(c, =GetEndpointRequest);
                                {5160}new SP_4872: bitstring;
                                {5161}new UP_4873: bitstring;
                                {5162}out(c, (GetEndpointResponse,pkSess_4871,None,SP_4872,UP_4873))
                            )
                            else
                                {5163}let v_4874: bool = (Sess_3938 = B) in
                                (
                                    {5164}if v_4874 then
                                    (
                                        {5165}let pkSess_4875: bitstring = pub(skB) in
                                        {5166}in(c, =GetEndpointRequest);
                                        {5167}new SP_4876: bitstring;
                                        {5168}new UP_4877: bitstring;
                                        {5169}out(c, (GetEndpointResponse,pkSess_4875,None,SP_4876,UP_4877))
                                    )
                                    else
                                        {5170}let v_4878: bool = (Sess_3938 = C) in
                                        (
                                            {5171}if v_4878 then
                                            (
                                                {5172}let pkSess_4879: bitstring = pub(skC) in
                                                {5173}in(c, =GetEndpointRequest);
                                                {5174}new SP_4880: bitstring;
                                                {5175}new UP_4881: bitstring;
                                                {5176}out(c, (GetEndpointResponse,pkSess_4879,None,SP_4880,UP_4881))
                                            )
                                            else
                                                {5177}let pkSess_4882: bitstring = pub(sk(Sess_3938)) in
                                                {5178}in(c, =GetEndpointRequest);
                                                {5179}new SP_4883: bitstring;
                                                {5180}new UP_4884: bitstring;
                                                {5181}out(c, (GetEndpointResponse,pkSess_4882,None,SP_4883,UP_4884))
                                        )
                                        else
                                            {5182}let pkSess_4885: bitstring = fail-any in
                                            {5183}in(c, =GetEndpointRequest);
                                            {5184}new SP_4886: bitstring;
                                            {5185}new UP_4887: bitstring;
                                            {5186}out(c, (GetEndpointResponse,pkSess_4885,None,SP_4886,UP_4887))
                                )
                                else
                                    {5187}let pkSess_4888: bitstring = fail-any in
                                    {5188}in(c, =GetEndpointRequest);
                                    {5189}new SP_4889: bitstring;
                                    {5190}new UP_4890: bitstring;
                                    {5191}out(c, (GetEndpointResponse,pkSess_4888,None,SP_4889,UP_4890))
                        )
                        else
                            {5192}let pkSess_4891: bitstring = fail-any in
                            {5193}in(c, =GetEndpointRequest);
                            {5194}new SP_4892: bitstring;
                            {5195}new UP_4893: bitstring;
                            {5196}out(c, (GetEndpointResponse,pkSess_4891,None,SP_4892,UP_4893))
                    )
                    else
                        {5197}let v_4894: bool = (Cli_3936 = C) in
                        (
                            {5198}if v_4894 then
                            (
                                {5199}let pkCli_4895: bitstring = pub(skC) in
                                {5200}let v_4896: bool = (Sess_3938 = A) in
                                (
                                    {5201}if v_4896 then
                                    (
                                        {5202}let pkSess_4897: bitstring = pub(skA) in
                                        {5203}in(c, =GetEndpointRequest);
                                        {5204}new SP_4898: bitstring;
                                        {5205}new UP_4899: bitstring;
                                        {5206}out(c, (GetEndpointResponse,pkSess_4897,None,SP_4898,UP_4899))
                                    )
                                    else
                                        {5207}let v_4900: bool = (Sess_3938 = B) in
                                        (
                                            {5208}if v_4900 then
                                            (
                                                {5209}let pkSess_4901: bitstring = pub(skB) in
                                                {5210}in(c, =GetEndpointRequest);
                                                {5211}new SP_4902: bitstring;
                                                {5212}new UP_4903: bitstring;
                                                {5213}out(c, (GetEndpointResponse,pkSess_4901,None,SP_4902,UP_4903))
                                            )
                                            else
                                                {5214}let v_4904: bool = (Sess_3938 = C) in
                                                (
                                                    {5215}if v_4904 then
                                                    (
                                                        {5216}let pkSess_4905: bitstring = pub(skC) in
                                                        {5217}in(c, =GetEndpointRequest);
                                                        {5218}new SP_4906: bitstring;
                                                        {5219}new UP_4907: bitstring;
                                                        {5220}out(c, (GetEndpointResponse,pkSess_4905,None,SP_4906,UP_4907))
                                                    )
                                                    else
                                                        {5221}let pkSess_4908: bitstring = pub(sk(Sess_3938)) in
                                                        {5222}in(c, =GetEndpointRequest);
                                                        {5223}new SP_4909: bitstring;
                                                        {5224}new UP_4910: bitstring;
                                                        {5225}out(c, (GetEndpointResponse,pkSess_4908,None,SP_4909,UP_4910))
                                                )
                                                else
                                                    {5226}let pkSess_4911: bitstring = fail-any in
                                                    {5227}in(c, =GetEndpointRequest);
                                                    {5228}new SP_4912: bitstring;
                                                    {5229}new UP_4913: bitstring;
                                                    {5230}out(c, (GetEndpointResponse,pkSess_4911,None,SP_4912,UP_4913))
                                        )
                                        else
                                            {5231}let pkSess_4914: bitstring = fail-any in
                                            {5232}in(c, =GetEndpointRequest);
                                            {5233}new SP_4915: bitstring;
                                            {5234}new UP_4916: bitstring;
                                            {5235}out(c, (GetEndpointResponse,pkSess_4914,None,SP_4915,UP_4916))
                                )
                                else
                                    {5236}let pkSess_4917: bitstring = fail-any in
                                    {5237}in(c, =GetEndpointRequest);
                                    {5238}new SP_4918: bitstring;
                                    {5239}new UP_4919: bitstring;
                                    {5240}out(c, (GetEndpointResponse,pkSess_4917,None,SP_4918,UP_4919))
                            )
                            else
                                {5241}let pkCli_4920: bitstring = pub(sk(Cli_3936)) in
                                {5242}let v_4921: bool = (Sess_3938 = A) in
                                (
                                    {5243}if v_4921 then
                                    (
                                        {5244}let pkSess_4922: bitstring = pub(skA) in
                                        {5245}in(c, =GetEndpointRequest);
                                        {5246}new SP_4923: bitstring;
                                        {5247}new UP_4924: bitstring;
                                        {5248}out(c, (GetEndpointResponse,pkSess_4922,None,SP_4923,UP_4924))
                                    )
                                    else
                                        {5249}let v_4925: bool = (Sess_3938 = B) in
                                        (
                                            {5250}if v_4925 then
                                            (
                                                {5251}let pkSess_4926: bitstring = pub(skB) in
                                                {5252}in(c, =GetEndpointRequest);
                                                {5253}new SP_4927: bitstring;
                                                {5254}new UP_4928: bitstring;
                                                {5255}out(c, (GetEndpointResponse,pkSess_4926,None,SP_4927,UP_4928))
                                            )
                                            else
                                                {5256}let v_4929: bool = (Sess_3938 = C) in
                                                (
                                                    {5257}if v_4929 then
                                                    (
                                                        {5258}let pkSess_4930: bitstring = pub(skC) in
                                                        {5259}in(c, =GetEndpointRequest);
                                                        {5260}new SP_4931: bitstring;
                                                        {5261}new UP_4932: bitstring;
                                                        {5262}out(c, (GetEndpointResponse,pkSess_4930,None,SP_4931,UP_4932))
                                                    )
                                                    else
                                                        {5263}let pkSess_4933: bitstring = pub(sk(Sess_3938)) in
                                                        {5264}in(c, =GetEndpointRequest);
                                                        {5265}new SP_4934: bitstring;
                                                        {5266}new UP_4935: bitstring;
                                                        {5267}out(c, (GetEndpointResponse,pkSess_4933,None,SP_4934,UP_4935))
                                                )
                                                else
                                                    {5268}let pkSess_4936: bitstring = fail-any in
                                                    {5269}in(c, =GetEndpointRequest);
                                                    {5270}new SP_4937: bitstring;
                                                    {5271}new UP_4938: bitstring;
                                                    {5272}out(c, (GetEndpointResponse,pkSess_4936,None,SP_4937,UP_4938))
                                        )
                                        else
                                            {5273}let pkSess_4939: bitstring = fail-any in
                                            {5274}in(c, =GetEndpointRequest);
                                            {5275}new SP_4940: bitstring;
                                            {5276}new UP_4941: bitstring;
                                            {5277}out(c, (GetEndpointResponse,pkSess_4939,None,SP_4940,UP_4941))
                                )
                                else
                                    {5278}let pkSess_4942: bitstring = fail-any in
                                    {5279}in(c, =GetEndpointRequest);
                                    {5280}new SP_4943: bitstring;
                                    {5281}new UP_4944: bitstring;
                                    {5282}out(c, (GetEndpointResponse,pkSess_4942,None,SP_4943,UP_4944))
                        )
                        else
                            {5283}let pkCli_4945: bitstring = fail-any in
                            {5284}let v_4946: bool = (Sess_3938 = A) in
                            (
                                {5285}if v_4946 then
                                (
                                    {5286}let pkSess_4947: bitstring = pub(skA) in
                                    {5287}in(c, =GetEndpointRequest);
                                    {5288}new SP_4948: bitstring;
                                    {5289}new UP_4949: bitstring;
                                    {5290}out(c, (GetEndpointResponse,pkSess_4947,None,SP_4948,UP_4949))
                                )
                                else
                                    {5291}let v_4950: bool = (Sess_3938 = B) in
                                    (
                                        {5292}if v_4950 then
                                        (
                                            {5293}let pkSess_4951: bitstring = pub(skB) in
                                            {5294}in(c, =GetEndpointRequest);
                                            {5295}new SP_4952: bitstring;
                                            {5296}new UP_4953: bitstring;
                                            {5297}out(c, (GetEndpointResponse,pkSess_4951,None,SP_4952,UP_4953))
                                        )
                                        else
                                            {5298}let v_4954: bool = (Sess_3938 = C) in
                                            (
                                                {5299}if v_4954 then
                                                (
                                                    {5300}let pkSess_4955: bitstring = pub(skC) in
                                                    {5301}in(c, =GetEndpointRequest);
                                                    {5302}new SP_4956: bitstring;
                                                    {5303}new UP_4957: bitstring;
                                                    {5304}out(c, (GetEndpointResponse,pkSess_4955,None,SP_4956,UP_4957))
                                                )
                                                else
                                                    {5305}let pkSess_4958: bitstring = pub(sk(Sess_3938)) in
                                                    {5306}in(c, =GetEndpointRequest);
                                                    {5307}new SP_4959: bitstring;
                                                    {5308}new UP_4960: bitstring;
                                                    {5309}out(c, (GetEndpointResponse,pkSess_4958,None,SP_4959,UP_4960))
                                            )
                                            else
                                                {5310}let pkSess_4961: bitstring = fail-any in
                                                {5311}in(c, =GetEndpointRequest);
                                                {5312}new SP_4962: bitstring;
                                                {5313}new UP_4963: bitstring;
                                                {5314}out(c, (GetEndpointResponse,pkSess_4961,None,SP_4962,UP_4963))
                                    )
                                    else
                                        {5315}let pkSess_4964: bitstring = fail-any in
                                        {5316}in(c, =GetEndpointRequest);
                                        {5317}new SP_4965: bitstring;
                                        {5318}new UP_4966: bitstring;
                                        {5319}out(c, (GetEndpointResponse,pkSess_4964,None,SP_4965,UP_4966))
                            )
                            else
                                {5320}let pkSess_4967: bitstring = fail-any in
                                {5321}in(c, =GetEndpointRequest);
                                {5322}new SP_4968: bitstring;
                                {5323}new UP_4969: bitstring;
                                {5324}out(c, (GetEndpointResponse,pkSess_4967,None,SP_4968,UP_4969))
                )
                else
                    {5325}let pkCli_4970: bitstring = fail-any in
                    {5326}let v_4971: bool = (Sess_3938 = A) in
                    (
                        {5327}if v_4971 then
                        (
                            {5328}let pkSess_4972: bitstring = pub(skA) in
                            {5329}in(c, =GetEndpointRequest);
                            {5330}new SP_4973: bitstring;
                            {5331}new UP_4974: bitstring;
                            {5332}out(c, (GetEndpointResponse,pkSess_4972,None,SP_4973,UP_4974))
                        )
                        else
                            {5333}let v_4975: bool = (Sess_3938 = B) in
                            (
                                {5334}if v_4975 then
                                (
                                    {5335}let pkSess_4976: bitstring = pub(skB) in
                                    {5336}in(c, =GetEndpointRequest);
                                    {5337}new SP_4977: bitstring;
                                    {5338}new UP_4978: bitstring;
                                    {5339}out(c, (GetEndpointResponse,pkSess_4976,None,SP_4977,UP_4978))
                                )
                                else
                                    {5340}let v_4979: bool = (Sess_3938 = C) in
                                    (
                                        {5341}if v_4979 then
                                        (
                                            {5342}let pkSess_4980: bitstring = pub(skC) in
                                            {5343}in(c, =GetEndpointRequest);
                                            {5344}new SP_4981: bitstring;
                                            {5345}new UP_4982: bitstring;
                                            {5346}out(c, (GetEndpointResponse,pkSess_4980,None,SP_4981,UP_4982))
                                        )
                                        else
                                            {5347}let pkSess_4983: bitstring = pub(sk(Sess_3938)) in
                                            {5348}in(c, =GetEndpointRequest);
                                            {5349}new SP_4984: bitstring;
                                            {5350}new UP_4985: bitstring;
                                            {5351}out(c, (GetEndpointResponse,pkSess_4983,None,SP_4984,UP_4985))
                                    )
                                    else
                                        {5352}let pkSess_4986: bitstring = fail-any in
                                        {5353}in(c, =GetEndpointRequest);
                                        {5354}new SP_4987: bitstring;
                                        {5355}new UP_4988: bitstring;
                                        {5356}out(c, (GetEndpointResponse,pkSess_4986,None,SP_4987,UP_4988))
                            )
                            else
                                {5357}let pkSess_4989: bitstring = fail-any in
                                {5358}in(c, =GetEndpointRequest);
                                {5359}new SP_4990: bitstring;
                                {5360}new UP_4991: bitstring;
                                {5361}out(c, (GetEndpointResponse,pkSess_4989,None,SP_4990,UP_4991))
                    )
                    else
                        {5362}let pkSess_4992: bitstring = fail-any in
                        {5363}in(c, =GetEndpointRequest);
                        {5364}new SP_4993: bitstring;
                        {5365}new UP_4994: bitstring;
                        {5366}out(c, (GetEndpointResponse,pkSess_4992,None,SP_4993,UP_4994))
        )
        else
            {5367}let pkCli_4995: bitstring = fail-any in
            {5368}let v_4996: bool = (Sess_3938 = A) in
            (
                {5369}if v_4996 then
                (
                    {5370}let pkSess_4997: bitstring = pub(skA) in
                    {5371}in(c, =GetEndpointRequest);
                    {5372}new SP_4998: bitstring;
                    {5373}new UP_4999: bitstring;
                    {5374}out(c, (GetEndpointResponse,pkSess_4997,None,SP_4998,UP_4999))
                )
                else
                    {5375}let v_5000: bool = (Sess_3938 = B) in
                    (
                        {5376}if v_5000 then
                        (
                            {5377}let pkSess_5001: bitstring = pub(skB) in
                            {5378}in(c, =GetEndpointRequest);
                            {5379}new SP_5002: bitstring;
                            {5380}new UP_5003: bitstring;
                            {5381}out(c, (GetEndpointResponse,pkSess_5001,None,SP_5002,UP_5003))
                        )
                        else
                            {5382}let v_5004: bool = (Sess_3938 = C) in
                            (
                                {5383}if v_5004 then
                                (
                                    {5384}let pkSess_5005: bitstring = pub(skC) in
                                    {5385}in(c, =GetEndpointRequest);
                                    {5386}new SP_5006: bitstring;
                                    {5387}new UP_5007: bitstring;
                                    {5388}out(c, (GetEndpointResponse,pkSess_5005,None,SP_5006,UP_5007))
                                )
                                else
                                    {5389}let pkSess_5008: bitstring = pub(sk(Sess_3938)) in
                                    {5390}in(c, =GetEndpointRequest);
                                    {5391}new SP_5009: bitstring;
                                    {5392}new UP_5010: bitstring;
                                    {5393}out(c, (GetEndpointResponse,pkSess_5008,None,SP_5009,UP_5010))
                            )
                            else
                                {5394}let pkSess_5011: bitstring = fail-any in
                                {5395}in(c, =GetEndpointRequest);
                                {5396}new SP_5012: bitstring;
                                {5397}new UP_5013: bitstring;
                                {5398}out(c, (GetEndpointResponse,pkSess_5011,None,SP_5012,UP_5013))
                    )
                    else
                        {5399}let pkSess_5014: bitstring = fail-any in
                        {5400}in(c, =GetEndpointRequest);
                        {5401}new SP_5015: bitstring;
                        {5402}new UP_5016: bitstring;
                        {5403}out(c, (GetEndpointResponse,pkSess_5014,None,SP_5015,UP_5016))
            )
            else
                {5404}let pkSess_5017: bitstring = fail-any in
                {5405}in(c, =GetEndpointRequest);
                {5406}new SP_5018: bitstring;
                {5407}new UP_5019: bitstring;
                {5408}out(c, (GetEndpointResponse,pkSess_5017,None,SP_5018,UP_5019))
) | (
    {5409}!
    {5410}in(c, (Cli_5020: host,Disco_5021: host,Sess_5022: host));
    {5411}let v_5023: bool = (Sess_5022 = A) in
    (
        {5412}if v_5023 then
        (
            {5413}let skSess: bitstring = skA in
            {5414}let pkSess_5024: bitstring = pub(skSess) in
            {5415}let v_5025: bool = (Cli_5020 = A) in
            (
                {5416}if v_5025 then
                (
                    {5417}let pkCli_5026: bitstring = pub(skA) in
                    {5418}let v_5027: bool = (Disco_5021 = A) in
                    (
                        {5419}if v_5027 then
                        (
                            {5420}let pkDisco_5028: bitstring = pub(skA) in
                            {5421}in(c, (=pkCli_5026,em1: bitstring));
                            {5422}let m1_5029: bitstring = em1 in
                            {5423}let (=OpenSecureChannelRequest,=pkCli_5026,Nc_5030: bitstring) = m1_5029 in
                            {5424}new Ns_5031: bitstring;
                            {5425}new ST_5032: bitstring;
                            {5426}new TTL_5033: bitstring;
                            {5427}let m2_5034: bitstring = (OpenSecureChannelResponse,Ns_5031,ST_5032,TTL_5033) in
                            {5428}out(c, m2_5034);
                            {5429}let Ksrv: bitstring = h((Ns_5031,Nc_5030)) in
                            {5430}out(c, senc(mSrv(pkCli_5026,pkSess_5024),Ksrv))
                        )
                        else
                            {5431}let v_5035: bool = (Disco_5021 = B) in
                            (
                                {5432}if v_5035 then
                                (
                                    {5433}let pkDisco_5036: bitstring = pub(skB) in
                                    {5434}in(c, (=pkCli_5026,em1_5037: bitstring));
                                    {5435}let m1_5038: bitstring = em1_5037 in
                                    {5436}let (=OpenSecureChannelRequest,=pkCli_5026,Nc_5039: bitstring) = m1_5038 in
                                    {5437}new Ns_5040: bitstring;
                                    {5438}new ST_5041: bitstring;
                                    {5439}new TTL_5042: bitstring;
                                    {5440}let m2_5043: bitstring = (OpenSecureChannelResponse,Ns_5040,ST_5041,TTL_5042) in
                                    {5441}out(c, m2_5043);
                                    {5442}let Ksrv_5044: bitstring = h((Ns_5040,Nc_5039)) in
                                    {5443}out(c, senc(mSrv(pkCli_5026,pkSess_5024),Ksrv_5044))
                                )
                                else
                                    {5444}let v_5045: bool = (Disco_5021 = C) in
                                    (
                                        {5445}if v_5045 then
                                        (
                                            {5446}let pkDisco_5046: bitstring = pub(skC) in
                                            {5447}in(c, (=pkCli_5026,em1_5047: bitstring));
                                            {5448}let m1_5048: bitstring = em1_5047 in
                                            {5449}let (=OpenSecureChannelRequest,=pkCli_5026,Nc_5049: bitstring) = m1_5048 in
                                            {5450}new Ns_5050: bitstring;
                                            {5451}new ST_5051: bitstring;
                                            {5452}new TTL_5052: bitstring;
                                            {5453}let m2_5053: bitstring = (OpenSecureChannelResponse,Ns_5050,ST_5051,TTL_5052) in
                                            {5454}out(c, m2_5053);
                                            {5455}let Ksrv_5054: bitstring = h((Ns_5050,Nc_5049)) in
                                            {5456}out(c, senc(mSrv(pkCli_5026,pkSess_5024),Ksrv_5054))
                                        )
                                        else
                                            {5457}let pkDisco_5055: bitstring = pub(sk(Disco_5021)) in
                                            {5458}in(c, (=pkCli_5026,em1_5056: bitstring));
                                            {5459}let m1_5057: bitstring = em1_5056 in
                                            {5460}let (=OpenSecureChannelRequest,=pkCli_5026,Nc_5058: bitstring) = m1_5057 in
                                            {5461}new Ns_5059: bitstring;
                                            {5462}new ST_5060: bitstring;
                                            {5463}new TTL_5061: bitstring;
                                            {5464}let m2_5062: bitstring = (OpenSecureChannelResponse,Ns_5059,ST_5060,TTL_5061) in
                                            {5465}out(c, m2_5062);
                                            {5466}let Ksrv_5063: bitstring = h((Ns_5059,Nc_5058)) in
                                            {5467}out(c, senc(mSrv(pkCli_5026,pkSess_5024),Ksrv_5063))
                                    )
                                    else
                                        {5468}let pkDisco_5064: bitstring = fail-any in
                                        {5469}in(c, (=pkCli_5026,em1_5065: bitstring));
                                        {5470}let m1_5066: bitstring = em1_5065 in
                                        {5471}let (=OpenSecureChannelRequest,=pkCli_5026,Nc_5067: bitstring) = m1_5066 in
                                        {5472}new Ns_5068: bitstring;
                                        {5473}new ST_5069: bitstring;
                                        {5474}new TTL_5070: bitstring;
                                        {5475}let m2_5071: bitstring = (OpenSecureChannelResponse,Ns_5068,ST_5069,TTL_5070) in
                                        {5476}out(c, m2_5071);
                                        {5477}let Ksrv_5072: bitstring = h((Ns_5068,Nc_5067)) in
                                        {5478}out(c, senc(mSrv(pkCli_5026,pkSess_5024),Ksrv_5072))
                            )
                            else
                                {5479}let pkDisco_5073: bitstring = fail-any in
                                {5480}in(c, (=pkCli_5026,em1_5074: bitstring));
                                {5481}let m1_5075: bitstring = em1_5074 in
                                {5482}let (=OpenSecureChannelRequest,=pkCli_5026,Nc_5076: bitstring) = m1_5075 in
                                {5483}new Ns_5077: bitstring;
                                {5484}new ST_5078: bitstring;
                                {5485}new TTL_5079: bitstring;
                                {5486}let m2_5080: bitstring = (OpenSecureChannelResponse,Ns_5077,ST_5078,TTL_5079) in
                                {5487}out(c, m2_5080);
                                {5488}let Ksrv_5081: bitstring = h((Ns_5077,Nc_5076)) in
                                {5489}out(c, senc(mSrv(pkCli_5026,pkSess_5024),Ksrv_5081))
                    )
                    else
                        {5490}let pkDisco_5082: bitstring = fail-any in
                        {5491}in(c, (=pkCli_5026,em1_5083: bitstring));
                        {5492}let m1_5084: bitstring = em1_5083 in
                        {5493}let (=OpenSecureChannelRequest,=pkCli_5026,Nc_5085: bitstring) = m1_5084 in
                        {5494}new Ns_5086: bitstring;
                        {5495}new ST_5087: bitstring;
                        {5496}new TTL_5088: bitstring;
                        {5497}let m2_5089: bitstring = (OpenSecureChannelResponse,Ns_5086,ST_5087,TTL_5088) in
                        {5498}out(c, m2_5089);
                        {5499}let Ksrv_5090: bitstring = h((Ns_5086,Nc_5085)) in
                        {5500}out(c, senc(mSrv(pkCli_5026,pkSess_5024),Ksrv_5090))
                )
                else
                    {5501}let v_5091: bool = (Cli_5020 = B) in
                    (
                        {5502}if v_5091 then
                        (
                            {5503}let pkCli_5092: bitstring = pub(skB) in
                            {5504}let v_5093: bool = (Disco_5021 = A) in
                            (
                                {5505}if v_5093 then
                                (
                                    {5506}let pkDisco_5094: bitstring = pub(skA) in
                                    {5507}in(c, (=pkCli_5092,em1_5095: bitstring));
                                    {5508}let m1_5096: bitstring = em1_5095 in
                                    {5509}let (=OpenSecureChannelRequest,=pkCli_5092,Nc_5097: bitstring) = m1_5096 in
                                    {5510}new Ns_5098: bitstring;
                                    {5511}new ST_5099: bitstring;
                                    {5512}new TTL_5100: bitstring;
                                    {5513}let m2_5101: bitstring = (OpenSecureChannelResponse,Ns_5098,ST_5099,TTL_5100) in
                                    {5514}out(c, m2_5101);
                                    {5515}let Ksrv_5102: bitstring = h((Ns_5098,Nc_5097)) in
                                    {5516}out(c, senc(mSrv(pkCli_5092,pkSess_5024),Ksrv_5102))
                                )
                                else
                                    {5517}let v_5103: bool = (Disco_5021 = B) in
                                    (
                                        {5518}if v_5103 then
                                        (
                                            {5519}let pkDisco_5104: bitstring = pub(skB) in
                                            {5520}in(c, (=pkCli_5092,em1_5105: bitstring));
                                            {5521}let m1_5106: bitstring = em1_5105 in
                                            {5522}let (=OpenSecureChannelRequest,=pkCli_5092,Nc_5107: bitstring) = m1_5106 in
                                            {5523}new Ns_5108: bitstring;
                                            {5524}new ST_5109: bitstring;
                                            {5525}new TTL_5110: bitstring;
                                            {5526}let m2_5111: bitstring = (OpenSecureChannelResponse,Ns_5108,ST_5109,TTL_5110) in
                                            {5527}out(c, m2_5111);
                                            {5528}let Ksrv_5112: bitstring = h((Ns_5108,Nc_5107)) in
                                            {5529}out(c, senc(mSrv(pkCli_5092,pkSess_5024),Ksrv_5112))
                                        )
                                        else
                                            {5530}let v_5113: bool = (Disco_5021 = C) in
                                            (
                                                {5531}if v_5113 then
                                                (
                                                    {5532}let pkDisco_5114: bitstring = pub(skC) in
                                                    {5533}in(c, (=pkCli_5092,em1_5115: bitstring));
                                                    {5534}let m1_5116: bitstring = em1_5115 in
                                                    {5535}let (=OpenSecureChannelRequest,=pkCli_5092,Nc_5117: bitstring) = m1_5116 in
                                                    {5536}new Ns_5118: bitstring;
                                                    {5537}new ST_5119: bitstring;
                                                    {5538}new TTL_5120: bitstring;
                                                    {5539}let m2_5121: bitstring = (OpenSecureChannelResponse,Ns_5118,ST_5119,TTL_5120) in
                                                    {5540}out(c, m2_5121);
                                                    {5541}let Ksrv_5122: bitstring = h((Ns_5118,Nc_5117)) in
                                                    {5542}out(c, senc(mSrv(pkCli_5092,pkSess_5024),Ksrv_5122))
                                                )
                                                else
                                                    {5543}let pkDisco_5123: bitstring = pub(sk(Disco_5021)) in
                                                    {5544}in(c, (=pkCli_5092,em1_5124: bitstring));
                                                    {5545}let m1_5125: bitstring = em1_5124 in
                                                    {5546}let (=OpenSecureChannelRequest,=pkCli_5092,Nc_5126: bitstring) = m1_5125 in
                                                    {5547}new Ns_5127: bitstring;
                                                    {5548}new ST_5128: bitstring;
                                                    {5549}new TTL_5129: bitstring;
                                                    {5550}let m2_5130: bitstring = (OpenSecureChannelResponse,Ns_5127,ST_5128,TTL_5129) in
                                                    {5551}out(c, m2_5130);
                                                    {5552}let Ksrv_5131: bitstring = h((Ns_5127,Nc_5126)) in
                                                    {5553}out(c, senc(mSrv(pkCli_5092,pkSess_5024),Ksrv_5131))
                                            )
                                            else
                                                {5554}let pkDisco_5132: bitstring = fail-any in
                                                {5555}in(c, (=pkCli_5092,em1_5133: bitstring));
                                                {5556}let m1_5134: bitstring = em1_5133 in
                                                {5557}let (=OpenSecureChannelRequest,=pkCli_5092,Nc_5135: bitstring) = m1_5134 in
                                                {5558}new Ns_5136: bitstring;
                                                {5559}new ST_5137: bitstring;
                                                {5560}new TTL_5138: bitstring;
                                                {5561}let m2_5139: bitstring = (OpenSecureChannelResponse,Ns_5136,ST_5137,TTL_5138) in
                                                {5562}out(c, m2_5139);
                                                {5563}let Ksrv_5140: bitstring = h((Ns_5136,Nc_5135)) in
                                                {5564}out(c, senc(mSrv(pkCli_5092,pkSess_5024),Ksrv_5140))
                                    )
                                    else
                                        {5565}let pkDisco_5141: bitstring = fail-any in
                                        {5566}in(c, (=pkCli_5092,em1_5142: bitstring));
                                        {5567}let m1_5143: bitstring = em1_5142 in
                                        {5568}let (=OpenSecureChannelRequest,=pkCli_5092,Nc_5144: bitstring) = m1_5143 in
                                        {5569}new Ns_5145: bitstring;
                                        {5570}new ST_5146: bitstring;
                                        {5571}new TTL_5147: bitstring;
                                        {5572}let m2_5148: bitstring = (OpenSecureChannelResponse,Ns_5145,ST_5146,TTL_5147) in
                                        {5573}out(c, m2_5148);
                                        {5574}let Ksrv_5149: bitstring = h((Ns_5145,Nc_5144)) in
                                        {5575}out(c, senc(mSrv(pkCli_5092,pkSess_5024),Ksrv_5149))
                            )
                            else
                                {5576}let pkDisco_5150: bitstring = fail-any in
                                {5577}in(c, (=pkCli_5092,em1_5151: bitstring));
                                {5578}let m1_5152: bitstring = em1_5151 in
                                {5579}let (=OpenSecureChannelRequest,=pkCli_5092,Nc_5153: bitstring) = m1_5152 in
                                {5580}new Ns_5154: bitstring;
                                {5581}new ST_5155: bitstring;
                                {5582}new TTL_5156: bitstring;
                                {5583}let m2_5157: bitstring = (OpenSecureChannelResponse,Ns_5154,ST_5155,TTL_5156) in
                                {5584}out(c, m2_5157);
                                {5585}let Ksrv_5158: bitstring = h((Ns_5154,Nc_5153)) in
                                {5586}out(c, senc(mSrv(pkCli_5092,pkSess_5024),Ksrv_5158))
                        )
                        else
                            {5587}let v_5159: bool = (Cli_5020 = C) in
                            (
                                {5588}if v_5159 then
                                (
                                    {5589}let pkCli_5160: bitstring = pub(skC) in
                                    {5590}let v_5161: bool = (Disco_5021 = A) in
                                    (
                                        {5591}if v_5161 then
                                        (
                                            {5592}let pkDisco_5162: bitstring = pub(skA) in
                                            {5593}in(c, (=pkCli_5160,em1_5163: bitstring));
                                            {5594}let m1_5164: bitstring = em1_5163 in
                                            {5595}let (=OpenSecureChannelRequest,=pkCli_5160,Nc_5165: bitstring) = m1_5164 in
                                            {5596}new Ns_5166: bitstring;
                                            {5597}new ST_5167: bitstring;
                                            {5598}new TTL_5168: bitstring;
                                            {5599}let m2_5169: bitstring = (OpenSecureChannelResponse,Ns_5166,ST_5167,TTL_5168) in
                                            {5600}out(c, m2_5169);
                                            {5601}let Ksrv_5170: bitstring = h((Ns_5166,Nc_5165)) in
                                            {5602}out(c, senc(mSrv(pkCli_5160,pkSess_5024),Ksrv_5170))
                                        )
                                        else
                                            {5603}let v_5171: bool = (Disco_5021 = B) in
                                            (
                                                {5604}if v_5171 then
                                                (
                                                    {5605}let pkDisco_5172: bitstring = pub(skB) in
                                                    {5606}in(c, (=pkCli_5160,em1_5173: bitstring));
                                                    {5607}let m1_5174: bitstring = em1_5173 in
                                                    {5608}let (=OpenSecureChannelRequest,=pkCli_5160,Nc_5175: bitstring) = m1_5174 in
                                                    {5609}new Ns_5176: bitstring;
                                                    {5610}new ST_5177: bitstring;
                                                    {5611}new TTL_5178: bitstring;
                                                    {5612}let m2_5179: bitstring = (OpenSecureChannelResponse,Ns_5176,ST_5177,TTL_5178) in
                                                    {5613}out(c, m2_5179);
                                                    {5614}let Ksrv_5180: bitstring = h((Ns_5176,Nc_5175)) in
                                                    {5615}out(c, senc(mSrv(pkCli_5160,pkSess_5024),Ksrv_5180))
                                                )
                                                else
                                                    {5616}let v_5181: bool = (Disco_5021 = C) in
                                                    (
                                                        {5617}if v_5181 then
                                                        (
                                                            {5618}let pkDisco_5182: bitstring = pub(skC) in
                                                            {5619}in(c, (=pkCli_5160,em1_5183: bitstring));
                                                            {5620}let m1_5184: bitstring = em1_5183 in
                                                            {5621}let (=OpenSecureChannelRequest,=pkCli_5160,Nc_5185: bitstring) = m1_5184 in
                                                            {5622}new Ns_5186: bitstring;
                                                            {5623}new ST_5187: bitstring;
                                                            {5624}new TTL_5188: bitstring;
                                                            {5625}let m2_5189: bitstring = (OpenSecureChannelResponse,Ns_5186,ST_5187,TTL_5188) in
                                                            {5626}out(c, m2_5189);
                                                            {5627}let Ksrv_5190: bitstring = h((Ns_5186,Nc_5185)) in
                                                            {5628}out(c, senc(mSrv(pkCli_5160,pkSess_5024),Ksrv_5190))
                                                        )
                                                        else
                                                            {5629}let pkDisco_5191: bitstring = pub(sk(Disco_5021)) in
                                                            {5630}in(c, (=pkCli_5160,em1_5192: bitstring));
                                                            {5631}let m1_5193: bitstring = em1_5192 in
                                                            {5632}let (=OpenSecureChannelRequest,=pkCli_5160,Nc_5194: bitstring) = m1_5193 in
                                                            {5633}new Ns_5195: bitstring;
                                                            {5634}new ST_5196: bitstring;
                                                            {5635}new TTL_5197: bitstring;
                                                            {5636}let m2_5198: bitstring = (OpenSecureChannelResponse,Ns_5195,ST_5196,TTL_5197) in
                                                            {5637}out(c, m2_5198);
                                                            {5638}let Ksrv_5199: bitstring = h((Ns_5195,Nc_5194)) in
                                                            {5639}out(c, senc(mSrv(pkCli_5160,pkSess_5024),Ksrv_5199))
                                                    )
                                                    else
                                                        {5640}let pkDisco_5200: bitstring = fail-any in
                                                        {5641}in(c, (=pkCli_5160,em1_5201: bitstring));
                                                        {5642}let m1_5202: bitstring = em1_5201 in
                                                        {5643}let (=OpenSecureChannelRequest,=pkCli_5160,Nc_5203: bitstring) = m1_5202 in
                                                        {5644}new Ns_5204: bitstring;
                                                        {5645}new ST_5205: bitstring;
                                                        {5646}new TTL_5206: bitstring;
                                                        {5647}let m2_5207: bitstring = (OpenSecureChannelResponse,Ns_5204,ST_5205,TTL_5206) in
                                                        {5648}out(c, m2_5207);
                                                        {5649}let Ksrv_5208: bitstring = h((Ns_5204,Nc_5203)) in
                                                        {5650}out(c, senc(mSrv(pkCli_5160,pkSess_5024),Ksrv_5208))
                                            )
                                            else
                                                {5651}let pkDisco_5209: bitstring = fail-any in
                                                {5652}in(c, (=pkCli_5160,em1_5210: bitstring));
                                                {5653}let m1_5211: bitstring = em1_5210 in
                                                {5654}let (=OpenSecureChannelRequest,=pkCli_5160,Nc_5212: bitstring) = m1_5211 in
                                                {5655}new Ns_5213: bitstring;
                                                {5656}new ST_5214: bitstring;
                                                {5657}new TTL_5215: bitstring;
                                                {5658}let m2_5216: bitstring = (OpenSecureChannelResponse,Ns_5213,ST_5214,TTL_5215) in
                                                {5659}out(c, m2_5216);
                                                {5660}let Ksrv_5217: bitstring = h((Ns_5213,Nc_5212)) in
                                                {5661}out(c, senc(mSrv(pkCli_5160,pkSess_5024),Ksrv_5217))
                                    )
                                    else
                                        {5662}let pkDisco_5218: bitstring = fail-any in
                                        {5663}in(c, (=pkCli_5160,em1_5219: bitstring));
                                        {5664}let m1_5220: bitstring = em1_5219 in
                                        {5665}let (=OpenSecureChannelRequest,=pkCli_5160,Nc_5221: bitstring) = m1_5220 in
                                        {5666}new Ns_5222: bitstring;
                                        {5667}new ST_5223: bitstring;
                                        {5668}new TTL_5224: bitstring;
                                        {5669}let m2_5225: bitstring = (OpenSecureChannelResponse,Ns_5222,ST_5223,TTL_5224) in
                                        {5670}out(c, m2_5225);
                                        {5671}let Ksrv_5226: bitstring = h((Ns_5222,Nc_5221)) in
                                        {5672}out(c, senc(mSrv(pkCli_5160,pkSess_5024),Ksrv_5226))
                                )
                                else
                                    {5673}let pkCli_5227: bitstring = pub(sk(Cli_5020)) in
                                    {5674}let v_5228: bool = (Disco_5021 = A) in
                                    (
                                        {5675}if v_5228 then
                                        (
                                            {5676}let pkDisco_5229: bitstring = pub(skA) in
                                            {5677}in(c, (=pkCli_5227,em1_5230: bitstring));
                                            {5678}let m1_5231: bitstring = em1_5230 in
                                            {5679}let (=OpenSecureChannelRequest,=pkCli_5227,Nc_5232: bitstring) = m1_5231 in
                                            {5680}new Ns_5233: bitstring;
                                            {5681}new ST_5234: bitstring;
                                            {5682}new TTL_5235: bitstring;
                                            {5683}let m2_5236: bitstring = (OpenSecureChannelResponse,Ns_5233,ST_5234,TTL_5235) in
                                            {5684}out(c, m2_5236);
                                            {5685}let Ksrv_5237: bitstring = h((Ns_5233,Nc_5232)) in
                                            {5686}out(c, senc(mSrv(pkCli_5227,pkSess_5024),Ksrv_5237))
                                        )
                                        else
                                            {5687}let v_5238: bool = (Disco_5021 = B) in
                                            (
                                                {5688}if v_5238 then
                                                (
                                                    {5689}let pkDisco_5239: bitstring = pub(skB) in
                                                    {5690}in(c, (=pkCli_5227,em1_5240: bitstring));
                                                    {5691}let m1_5241: bitstring = em1_5240 in
                                                    {5692}let (=OpenSecureChannelRequest,=pkCli_5227,Nc_5242: bitstring) = m1_5241 in
                                                    {5693}new Ns_5243: bitstring;
                                                    {5694}new ST_5244: bitstring;
                                                    {5695}new TTL_5245: bitstring;
                                                    {5696}let m2_5246: bitstring = (OpenSecureChannelResponse,Ns_5243,ST_5244,TTL_5245) in
                                                    {5697}out(c, m2_5246);
                                                    {5698}let Ksrv_5247: bitstring = h((Ns_5243,Nc_5242)) in
                                                    {5699}out(c, senc(mSrv(pkCli_5227,pkSess_5024),Ksrv_5247))
                                                )
                                                else
                                                    {5700}let v_5248: bool = (Disco_5021 = C) in
                                                    (
                                                        {5701}if v_5248 then
                                                        (
                                                            {5702}let pkDisco_5249: bitstring = pub(skC) in
                                                            {5703}in(c, (=pkCli_5227,em1_5250: bitstring));
                                                            {5704}let m1_5251: bitstring = em1_5250 in
                                                            {5705}let (=OpenSecureChannelRequest,=pkCli_5227,Nc_5252: bitstring) = m1_5251 in
                                                            {5706}new Ns_5253: bitstring;
                                                            {5707}new ST_5254: bitstring;
                                                            {5708}new TTL_5255: bitstring;
                                                            {5709}let m2_5256: bitstring = (OpenSecureChannelResponse,Ns_5253,ST_5254,TTL_5255) in
                                                            {5710}out(c, m2_5256);
                                                            {5711}let Ksrv_5257: bitstring = h((Ns_5253,Nc_5252)) in
                                                            {5712}out(c, senc(mSrv(pkCli_5227,pkSess_5024),Ksrv_5257))
                                                        )
                                                        else
                                                            {5713}let pkDisco_5258: bitstring = pub(sk(Disco_5021)) in
                                                            {5714}in(c, (=pkCli_5227,em1_5259: bitstring));
                                                            {5715}let m1_5260: bitstring = em1_5259 in
                                                            {5716}let (=OpenSecureChannelRequest,=pkCli_5227,Nc_5261: bitstring) = m1_5260 in
                                                            {5717}new Ns_5262: bitstring;
                                                            {5718}new ST_5263: bitstring;
                                                            {5719}new TTL_5264: bitstring;
                                                            {5720}let m2_5265: bitstring = (OpenSecureChannelResponse,Ns_5262,ST_5263,TTL_5264) in
                                                            {5721}out(c, m2_5265);
                                                            {5722}let Ksrv_5266: bitstring = h((Ns_5262,Nc_5261)) in
                                                            {5723}out(c, senc(mSrv(pkCli_5227,pkSess_5024),Ksrv_5266))
                                                    )
                                                    else
                                                        {5724}let pkDisco_5267: bitstring = fail-any in
                                                        {5725}in(c, (=pkCli_5227,em1_5268: bitstring));
                                                        {5726}let m1_5269: bitstring = em1_5268 in
                                                        {5727}let (=OpenSecureChannelRequest,=pkCli_5227,Nc_5270: bitstring) = m1_5269 in
                                                        {5728}new Ns_5271: bitstring;
                                                        {5729}new ST_5272: bitstring;
                                                        {5730}new TTL_5273: bitstring;
                                                        {5731}let m2_5274: bitstring = (OpenSecureChannelResponse,Ns_5271,ST_5272,TTL_5273) in
                                                        {5732}out(c, m2_5274);
                                                        {5733}let Ksrv_5275: bitstring = h((Ns_5271,Nc_5270)) in
                                                        {5734}out(c, senc(mSrv(pkCli_5227,pkSess_5024),Ksrv_5275))
                                            )
                                            else
                                                {5735}let pkDisco_5276: bitstring = fail-any in
                                                {5736}in(c, (=pkCli_5227,em1_5277: bitstring));
                                                {5737}let m1_5278: bitstring = em1_5277 in
                                                {5738}let (=OpenSecureChannelRequest,=pkCli_5227,Nc_5279: bitstring) = m1_5278 in
                                                {5739}new Ns_5280: bitstring;
                                                {5740}new ST_5281: bitstring;
                                                {5741}new TTL_5282: bitstring;
                                                {5742}let m2_5283: bitstring = (OpenSecureChannelResponse,Ns_5280,ST_5281,TTL_5282) in
                                                {5743}out(c, m2_5283);
                                                {5744}let Ksrv_5284: bitstring = h((Ns_5280,Nc_5279)) in
                                                {5745}out(c, senc(mSrv(pkCli_5227,pkSess_5024),Ksrv_5284))
                                    )
                                    else
                                        {5746}let pkDisco_5285: bitstring = fail-any in
                                        {5747}in(c, (=pkCli_5227,em1_5286: bitstring));
                                        {5748}let m1_5287: bitstring = em1_5286 in
                                        {5749}let (=OpenSecureChannelRequest,=pkCli_5227,Nc_5288: bitstring) = m1_5287 in
                                        {5750}new Ns_5289: bitstring;
                                        {5751}new ST_5290: bitstring;
                                        {5752}new TTL_5291: bitstring;
                                        {5753}let m2_5292: bitstring = (OpenSecureChannelResponse,Ns_5289,ST_5290,TTL_5291) in
                                        {5754}out(c, m2_5292);
                                        {5755}let Ksrv_5293: bitstring = h((Ns_5289,Nc_5288)) in
                                        {5756}out(c, senc(mSrv(pkCli_5227,pkSess_5024),Ksrv_5293))
                            )
                            else
                                {5757}let pkCli_5294: bitstring = fail-any in
                                {5758}let v_5295: bool = (Disco_5021 = A) in
                                (
                                    {5759}if v_5295 then
                                    (
                                        {5760}let pkDisco_5296: bitstring = pub(skA) in
                                        {5761}in(c, (=pkCli_5294,em1_5297: bitstring));
                                        {5762}let m1_5298: bitstring = em1_5297 in
                                        {5763}let (=OpenSecureChannelRequest,=pkCli_5294,Nc_5299: bitstring) = m1_5298 in
                                        {5764}new Ns_5300: bitstring;
                                        {5765}new ST_5301: bitstring;
                                        {5766}new TTL_5302: bitstring;
                                        {5767}let m2_5303: bitstring = (OpenSecureChannelResponse,Ns_5300,ST_5301,TTL_5302) in
                                        {5768}out(c, m2_5303);
                                        {5769}let Ksrv_5304: bitstring = h((Ns_5300,Nc_5299)) in
                                        {5770}out(c, senc(mSrv(pkCli_5294,pkSess_5024),Ksrv_5304))
                                    )
                                    else
                                        {5771}let v_5305: bool = (Disco_5021 = B) in
                                        (
                                            {5772}if v_5305 then
                                            (
                                                {5773}let pkDisco_5306: bitstring = pub(skB) in
                                                {5774}in(c, (=pkCli_5294,em1_5307: bitstring));
                                                {5775}let m1_5308: bitstring = em1_5307 in
                                                {5776}let (=OpenSecureChannelRequest,=pkCli_5294,Nc_5309: bitstring) = m1_5308 in
                                                {5777}new Ns_5310: bitstring;
                                                {5778}new ST_5311: bitstring;
                                                {5779}new TTL_5312: bitstring;
                                                {5780}let m2_5313: bitstring = (OpenSecureChannelResponse,Ns_5310,ST_5311,TTL_5312) in
                                                {5781}out(c, m2_5313);
                                                {5782}let Ksrv_5314: bitstring = h((Ns_5310,Nc_5309)) in
                                                {5783}out(c, senc(mSrv(pkCli_5294,pkSess_5024),Ksrv_5314))
                                            )
                                            else
                                                {5784}let v_5315: bool = (Disco_5021 = C) in
                                                (
                                                    {5785}if v_5315 then
                                                    (
                                                        {5786}let pkDisco_5316: bitstring = pub(skC) in
                                                        {5787}in(c, (=pkCli_5294,em1_5317: bitstring));
                                                        {5788}let m1_5318: bitstring = em1_5317 in
                                                        {5789}let (=OpenSecureChannelRequest,=pkCli_5294,Nc_5319: bitstring) = m1_5318 in
                                                        {5790}new Ns_5320: bitstring;
                                                        {5791}new ST_5321: bitstring;
                                                        {5792}new TTL_5322: bitstring;
                                                        {5793}let m2_5323: bitstring = (OpenSecureChannelResponse,Ns_5320,ST_5321,TTL_5322) in
                                                        {5794}out(c, m2_5323);
                                                        {5795}let Ksrv_5324: bitstring = h((Ns_5320,Nc_5319)) in
                                                        {5796}out(c, senc(mSrv(pkCli_5294,pkSess_5024),Ksrv_5324))
                                                    )
                                                    else
                                                        {5797}let pkDisco_5325: bitstring = pub(sk(Disco_5021)) in
                                                        {5798}in(c, (=pkCli_5294,em1_5326: bitstring));
                                                        {5799}let m1_5327: bitstring = em1_5326 in
                                                        {5800}let (=OpenSecureChannelRequest,=pkCli_5294,Nc_5328: bitstring) = m1_5327 in
                                                        {5801}new Ns_5329: bitstring;
                                                        {5802}new ST_5330: bitstring;
                                                        {5803}new TTL_5331: bitstring;
                                                        {5804}let m2_5332: bitstring = (OpenSecureChannelResponse,Ns_5329,ST_5330,TTL_5331) in
                                                        {5805}out(c, m2_5332);
                                                        {5806}let Ksrv_5333: bitstring = h((Ns_5329,Nc_5328)) in
                                                        {5807}out(c, senc(mSrv(pkCli_5294,pkSess_5024),Ksrv_5333))
                                                )
                                                else
                                                    {5808}let pkDisco_5334: bitstring = fail-any in
                                                    {5809}in(c, (=pkCli_5294,em1_5335: bitstring));
                                                    {5810}let m1_5336: bitstring = em1_5335 in
                                                    {5811}let (=OpenSecureChannelRequest,=pkCli_5294,Nc_5337: bitstring) = m1_5336 in
                                                    {5812}new Ns_5338: bitstring;
                                                    {5813}new ST_5339: bitstring;
                                                    {5814}new TTL_5340: bitstring;
                                                    {5815}let m2_5341: bitstring = (OpenSecureChannelResponse,Ns_5338,ST_5339,TTL_5340) in
                                                    {5816}out(c, m2_5341);
                                                    {5817}let Ksrv_5342: bitstring = h((Ns_5338,Nc_5337)) in
                                                    {5818}out(c, senc(mSrv(pkCli_5294,pkSess_5024),Ksrv_5342))
                                        )
                                        else
                                            {5819}let pkDisco_5343: bitstring = fail-any in
                                            {5820}in(c, (=pkCli_5294,em1_5344: bitstring));
                                            {5821}let m1_5345: bitstring = em1_5344 in
                                            {5822}let (=OpenSecureChannelRequest,=pkCli_5294,Nc_5346: bitstring) = m1_5345 in
                                            {5823}new Ns_5347: bitstring;
                                            {5824}new ST_5348: bitstring;
                                            {5825}new TTL_5349: bitstring;
                                            {5826}let m2_5350: bitstring = (OpenSecureChannelResponse,Ns_5347,ST_5348,TTL_5349) in
                                            {5827}out(c, m2_5350);
                                            {5828}let Ksrv_5351: bitstring = h((Ns_5347,Nc_5346)) in
                                            {5829}out(c, senc(mSrv(pkCli_5294,pkSess_5024),Ksrv_5351))
                                )
                                else
                                    {5830}let pkDisco_5352: bitstring = fail-any in
                                    {5831}in(c, (=pkCli_5294,em1_5353: bitstring));
                                    {5832}let m1_5354: bitstring = em1_5353 in
                                    {5833}let (=OpenSecureChannelRequest,=pkCli_5294,Nc_5355: bitstring) = m1_5354 in
                                    {5834}new Ns_5356: bitstring;
                                    {5835}new ST_5357: bitstring;
                                    {5836}new TTL_5358: bitstring;
                                    {5837}let m2_5359: bitstring = (OpenSecureChannelResponse,Ns_5356,ST_5357,TTL_5358) in
                                    {5838}out(c, m2_5359);
                                    {5839}let Ksrv_5360: bitstring = h((Ns_5356,Nc_5355)) in
                                    {5840}out(c, senc(mSrv(pkCli_5294,pkSess_5024),Ksrv_5360))
                    )
                    else
                        {5841}let pkCli_5361: bitstring = fail-any in
                        {5842}let v_5362: bool = (Disco_5021 = A) in
                        (
                            {5843}if v_5362 then
                            (
                                {5844}let pkDisco_5363: bitstring = pub(skA) in
                                {5845}in(c, (=pkCli_5361,em1_5364: bitstring));
                                {5846}let m1_5365: bitstring = em1_5364 in
                                {5847}let (=OpenSecureChannelRequest,=pkCli_5361,Nc_5366: bitstring) = m1_5365 in
                                {5848}new Ns_5367: bitstring;
                                {5849}new ST_5368: bitstring;
                                {5850}new TTL_5369: bitstring;
                                {5851}let m2_5370: bitstring = (OpenSecureChannelResponse,Ns_5367,ST_5368,TTL_5369) in
                                {5852}out(c, m2_5370);
                                {5853}let Ksrv_5371: bitstring = h((Ns_5367,Nc_5366)) in
                                {5854}out(c, senc(mSrv(pkCli_5361,pkSess_5024),Ksrv_5371))
                            )
                            else
                                {5855}let v_5372: bool = (Disco_5021 = B) in
                                (
                                    {5856}if v_5372 then
                                    (
                                        {5857}let pkDisco_5373: bitstring = pub(skB) in
                                        {5858}in(c, (=pkCli_5361,em1_5374: bitstring));
                                        {5859}let m1_5375: bitstring = em1_5374 in
                                        {5860}let (=OpenSecureChannelRequest,=pkCli_5361,Nc_5376: bitstring) = m1_5375 in
                                        {5861}new Ns_5377: bitstring;
                                        {5862}new ST_5378: bitstring;
                                        {5863}new TTL_5379: bitstring;
                                        {5864}let m2_5380: bitstring = (OpenSecureChannelResponse,Ns_5377,ST_5378,TTL_5379) in
                                        {5865}out(c, m2_5380);
                                        {5866}let Ksrv_5381: bitstring = h((Ns_5377,Nc_5376)) in
                                        {5867}out(c, senc(mSrv(pkCli_5361,pkSess_5024),Ksrv_5381))
                                    )
                                    else
                                        {5868}let v_5382: bool = (Disco_5021 = C) in
                                        (
                                            {5869}if v_5382 then
                                            (
                                                {5870}let pkDisco_5383: bitstring = pub(skC) in
                                                {5871}in(c, (=pkCli_5361,em1_5384: bitstring));
                                                {5872}let m1_5385: bitstring = em1_5384 in
                                                {5873}let (=OpenSecureChannelRequest,=pkCli_5361,Nc_5386: bitstring) = m1_5385 in
                                                {5874}new Ns_5387: bitstring;
                                                {5875}new ST_5388: bitstring;
                                                {5876}new TTL_5389: bitstring;
                                                {5877}let m2_5390: bitstring = (OpenSecureChannelResponse,Ns_5387,ST_5388,TTL_5389) in
                                                {5878}out(c, m2_5390);
                                                {5879}let Ksrv_5391: bitstring = h((Ns_5387,Nc_5386)) in
                                                {5880}out(c, senc(mSrv(pkCli_5361,pkSess_5024),Ksrv_5391))
                                            )
                                            else
                                                {5881}let pkDisco_5392: bitstring = pub(sk(Disco_5021)) in
                                                {5882}in(c, (=pkCli_5361,em1_5393: bitstring));
                                                {5883}let m1_5394: bitstring = em1_5393 in
                                                {5884}let (=OpenSecureChannelRequest,=pkCli_5361,Nc_5395: bitstring) = m1_5394 in
                                                {5885}new Ns_5396: bitstring;
                                                {5886}new ST_5397: bitstring;
                                                {5887}new TTL_5398: bitstring;
                                                {5888}let m2_5399: bitstring = (OpenSecureChannelResponse,Ns_5396,ST_5397,TTL_5398) in
                                                {5889}out(c, m2_5399);
                                                {5890}let Ksrv_5400: bitstring = h((Ns_5396,Nc_5395)) in
                                                {5891}out(c, senc(mSrv(pkCli_5361,pkSess_5024),Ksrv_5400))
                                        )
                                        else
                                            {5892}let pkDisco_5401: bitstring = fail-any in
                                            {5893}in(c, (=pkCli_5361,em1_5402: bitstring));
                                            {5894}let m1_5403: bitstring = em1_5402 in
                                            {5895}let (=OpenSecureChannelRequest,=pkCli_5361,Nc_5404: bitstring) = m1_5403 in
                                            {5896}new Ns_5405: bitstring;
                                            {5897}new ST_5406: bitstring;
                                            {5898}new TTL_5407: bitstring;
                                            {5899}let m2_5408: bitstring = (OpenSecureChannelResponse,Ns_5405,ST_5406,TTL_5407) in
                                            {5900}out(c, m2_5408);
                                            {5901}let Ksrv_5409: bitstring = h((Ns_5405,Nc_5404)) in
                                            {5902}out(c, senc(mSrv(pkCli_5361,pkSess_5024),Ksrv_5409))
                                )
                                else
                                    {5903}let pkDisco_5410: bitstring = fail-any in
                                    {5904}in(c, (=pkCli_5361,em1_5411: bitstring));
                                    {5905}let m1_5412: bitstring = em1_5411 in
                                    {5906}let (=OpenSecureChannelRequest,=pkCli_5361,Nc_5413: bitstring) = m1_5412 in
                                    {5907}new Ns_5414: bitstring;
                                    {5908}new ST_5415: bitstring;
                                    {5909}new TTL_5416: bitstring;
                                    {5910}let m2_5417: bitstring = (OpenSecureChannelResponse,Ns_5414,ST_5415,TTL_5416) in
                                    {5911}out(c, m2_5417);
                                    {5912}let Ksrv_5418: bitstring = h((Ns_5414,Nc_5413)) in
                                    {5913}out(c, senc(mSrv(pkCli_5361,pkSess_5024),Ksrv_5418))
                        )
                        else
                            {5914}let pkDisco_5419: bitstring = fail-any in
                            {5915}in(c, (=pkCli_5361,em1_5420: bitstring));
                            {5916}let m1_5421: bitstring = em1_5420 in
                            {5917}let (=OpenSecureChannelRequest,=pkCli_5361,Nc_5422: bitstring) = m1_5421 in
                            {5918}new Ns_5423: bitstring;
                            {5919}new ST_5424: bitstring;
                            {5920}new TTL_5425: bitstring;
                            {5921}let m2_5426: bitstring = (OpenSecureChannelResponse,Ns_5423,ST_5424,TTL_5425) in
                            {5922}out(c, m2_5426);
                            {5923}let Ksrv_5427: bitstring = h((Ns_5423,Nc_5422)) in
                            {5924}out(c, senc(mSrv(pkCli_5361,pkSess_5024),Ksrv_5427))
            )
            else
                {5925}let pkCli_5428: bitstring = fail-any in
                {5926}let v_5429: bool = (Disco_5021 = A) in
                (
                    {5927}if v_5429 then
                    (
                        {5928}let pkDisco_5430: bitstring = pub(skA) in
                        {5929}in(c, (=pkCli_5428,em1_5431: bitstring));
                        {5930}let m1_5432: bitstring = em1_5431 in
                        {5931}let (=OpenSecureChannelRequest,=pkCli_5428,Nc_5433: bitstring) = m1_5432 in
                        {5932}new Ns_5434: bitstring;
                        {5933}new ST_5435: bitstring;
                        {5934}new TTL_5436: bitstring;
                        {5935}let m2_5437: bitstring = (OpenSecureChannelResponse,Ns_5434,ST_5435,TTL_5436) in
                        {5936}out(c, m2_5437);
                        {5937}let Ksrv_5438: bitstring = h((Ns_5434,Nc_5433)) in
                        {5938}out(c, senc(mSrv(pkCli_5428,pkSess_5024),Ksrv_5438))
                    )
                    else
                        {5939}let v_5439: bool = (Disco_5021 = B) in
                        (
                            {5940}if v_5439 then
                            (
                                {5941}let pkDisco_5440: bitstring = pub(skB) in
                                {5942}in(c, (=pkCli_5428,em1_5441: bitstring));
                                {5943}let m1_5442: bitstring = em1_5441 in
                                {5944}let (=OpenSecureChannelRequest,=pkCli_5428,Nc_5443: bitstring) = m1_5442 in
                                {5945}new Ns_5444: bitstring;
                                {5946}new ST_5445: bitstring;
                                {5947}new TTL_5446: bitstring;
                                {5948}let m2_5447: bitstring = (OpenSecureChannelResponse,Ns_5444,ST_5445,TTL_5446) in
                                {5949}out(c, m2_5447);
                                {5950}let Ksrv_5448: bitstring = h((Ns_5444,Nc_5443)) in
                                {5951}out(c, senc(mSrv(pkCli_5428,pkSess_5024),Ksrv_5448))
                            )
                            else
                                {5952}let v_5449: bool = (Disco_5021 = C) in
                                (
                                    {5953}if v_5449 then
                                    (
                                        {5954}let pkDisco_5450: bitstring = pub(skC) in
                                        {5955}in(c, (=pkCli_5428,em1_5451: bitstring));
                                        {5956}let m1_5452: bitstring = em1_5451 in
                                        {5957}let (=OpenSecureChannelRequest,=pkCli_5428,Nc_5453: bitstring) = m1_5452 in
                                        {5958}new Ns_5454: bitstring;
                                        {5959}new ST_5455: bitstring;
                                        {5960}new TTL_5456: bitstring;
                                        {5961}let m2_5457: bitstring = (OpenSecureChannelResponse,Ns_5454,ST_5455,TTL_5456) in
                                        {5962}out(c, m2_5457);
                                        {5963}let Ksrv_5458: bitstring = h((Ns_5454,Nc_5453)) in
                                        {5964}out(c, senc(mSrv(pkCli_5428,pkSess_5024),Ksrv_5458))
                                    )
                                    else
                                        {5965}let pkDisco_5459: bitstring = pub(sk(Disco_5021)) in
                                        {5966}in(c, (=pkCli_5428,em1_5460: bitstring));
                                        {5967}let m1_5461: bitstring = em1_5460 in
                                        {5968}let (=OpenSecureChannelRequest,=pkCli_5428,Nc_5462: bitstring) = m1_5461 in
                                        {5969}new Ns_5463: bitstring;
                                        {5970}new ST_5464: bitstring;
                                        {5971}new TTL_5465: bitstring;
                                        {5972}let m2_5466: bitstring = (OpenSecureChannelResponse,Ns_5463,ST_5464,TTL_5465) in
                                        {5973}out(c, m2_5466);
                                        {5974}let Ksrv_5467: bitstring = h((Ns_5463,Nc_5462)) in
                                        {5975}out(c, senc(mSrv(pkCli_5428,pkSess_5024),Ksrv_5467))
                                )
                                else
                                    {5976}let pkDisco_5468: bitstring = fail-any in
                                    {5977}in(c, (=pkCli_5428,em1_5469: bitstring));
                                    {5978}let m1_5470: bitstring = em1_5469 in
                                    {5979}let (=OpenSecureChannelRequest,=pkCli_5428,Nc_5471: bitstring) = m1_5470 in
                                    {5980}new Ns_5472: bitstring;
                                    {5981}new ST_5473: bitstring;
                                    {5982}new TTL_5474: bitstring;
                                    {5983}let m2_5475: bitstring = (OpenSecureChannelResponse,Ns_5472,ST_5473,TTL_5474) in
                                    {5984}out(c, m2_5475);
                                    {5985}let Ksrv_5476: bitstring = h((Ns_5472,Nc_5471)) in
                                    {5986}out(c, senc(mSrv(pkCli_5428,pkSess_5024),Ksrv_5476))
                        )
                        else
                            {5987}let pkDisco_5477: bitstring = fail-any in
                            {5988}in(c, (=pkCli_5428,em1_5478: bitstring));
                            {5989}let m1_5479: bitstring = em1_5478 in
                            {5990}let (=OpenSecureChannelRequest,=pkCli_5428,Nc_5480: bitstring) = m1_5479 in
                            {5991}new Ns_5481: bitstring;
                            {5992}new ST_5482: bitstring;
                            {5993}new TTL_5483: bitstring;
                            {5994}let m2_5484: bitstring = (OpenSecureChannelResponse,Ns_5481,ST_5482,TTL_5483) in
                            {5995}out(c, m2_5484);
                            {5996}let Ksrv_5485: bitstring = h((Ns_5481,Nc_5480)) in
                            {5997}out(c, senc(mSrv(pkCli_5428,pkSess_5024),Ksrv_5485))
                )
                else
                    {5998}let pkDisco_5486: bitstring = fail-any in
                    {5999}in(c, (=pkCli_5428,em1_5487: bitstring));
                    {6000}let m1_5488: bitstring = em1_5487 in
                    {6001}let (=OpenSecureChannelRequest,=pkCli_5428,Nc_5489: bitstring) = m1_5488 in
                    {6002}new Ns_5490: bitstring;
                    {6003}new ST_5491: bitstring;
                    {6004}new TTL_5492: bitstring;
                    {6005}let m2_5493: bitstring = (OpenSecureChannelResponse,Ns_5490,ST_5491,TTL_5492) in
                    {6006}out(c, m2_5493);
                    {6007}let Ksrv_5494: bitstring = h((Ns_5490,Nc_5489)) in
                    {6008}out(c, senc(mSrv(pkCli_5428,pkSess_5024),Ksrv_5494))
        )
        else
            {6009}let v_5495: bool = (Sess_5022 = B) in
            (
                {6010}if v_5495 then
                (
                    {6011}let skSess_5496: bitstring = skB in
                    {6012}let pkSess_5497: bitstring = pub(skSess_5496) in
                    {6013}let v_5498: bool = (Cli_5020 = A) in
                    (
                        {6014}if v_5498 then
                        (
                            {6015}let pkCli_5499: bitstring = pub(skA) in
                            {6016}let v_5500: bool = (Disco_5021 = A) in
                            (
                                {6017}if v_5500 then
                                (
                                    {6018}let pkDisco_5501: bitstring = pub(skA) in
                                    {6019}in(c, (=pkCli_5499,em1_5502: bitstring));
                                    {6020}let m1_5503: bitstring = em1_5502 in
                                    {6021}let (=OpenSecureChannelRequest,=pkCli_5499,Nc_5504: bitstring) = m1_5503 in
                                    {6022}new Ns_5505: bitstring;
                                    {6023}new ST_5506: bitstring;
                                    {6024}new TTL_5507: bitstring;
                                    {6025}let m2_5508: bitstring = (OpenSecureChannelResponse,Ns_5505,ST_5506,TTL_5507) in
                                    {6026}out(c, m2_5508);
                                    {6027}let Ksrv_5509: bitstring = h((Ns_5505,Nc_5504)) in
                                    {6028}out(c, senc(mSrv(pkCli_5499,pkSess_5497),Ksrv_5509))
                                )
                                else
                                    {6029}let v_5510: bool = (Disco_5021 = B) in
                                    (
                                        {6030}if v_5510 then
                                        (
                                            {6031}let pkDisco_5511: bitstring = pub(skB) in
                                            {6032}in(c, (=pkCli_5499,em1_5512: bitstring));
                                            {6033}let m1_5513: bitstring = em1_5512 in
                                            {6034}let (=OpenSecureChannelRequest,=pkCli_5499,Nc_5514: bitstring) = m1_5513 in
                                            {6035}new Ns_5515: bitstring;
                                            {6036}new ST_5516: bitstring;
                                            {6037}new TTL_5517: bitstring;
                                            {6038}let m2_5518: bitstring = (OpenSecureChannelResponse,Ns_5515,ST_5516,TTL_5517) in
                                            {6039}out(c, m2_5518);
                                            {6040}let Ksrv_5519: bitstring = h((Ns_5515,Nc_5514)) in
                                            {6041}out(c, senc(mSrv(pkCli_5499,pkSess_5497),Ksrv_5519))
                                        )
                                        else
                                            {6042}let v_5520: bool = (Disco_5021 = C) in
                                            (
                                                {6043}if v_5520 then
                                                (
                                                    {6044}let pkDisco_5521: bitstring = pub(skC) in
                                                    {6045}in(c, (=pkCli_5499,em1_5522: bitstring));
                                                    {6046}let m1_5523: bitstring = em1_5522 in
                                                    {6047}let (=OpenSecureChannelRequest,=pkCli_5499,Nc_5524: bitstring) = m1_5523 in
                                                    {6048}new Ns_5525: bitstring;
                                                    {6049}new ST_5526: bitstring;
                                                    {6050}new TTL_5527: bitstring;
                                                    {6051}let m2_5528: bitstring = (OpenSecureChannelResponse,Ns_5525,ST_5526,TTL_5527) in
                                                    {6052}out(c, m2_5528);
                                                    {6053}let Ksrv_5529: bitstring = h((Ns_5525,Nc_5524)) in
                                                    {6054}out(c, senc(mSrv(pkCli_5499,pkSess_5497),Ksrv_5529))
                                                )
                                                else
                                                    {6055}let pkDisco_5530: bitstring = pub(sk(Disco_5021)) in
                                                    {6056}in(c, (=pkCli_5499,em1_5531: bitstring));
                                                    {6057}let m1_5532: bitstring = em1_5531 in
                                                    {6058}let (=OpenSecureChannelRequest,=pkCli_5499,Nc_5533: bitstring) = m1_5532 in
                                                    {6059}new Ns_5534: bitstring;
                                                    {6060}new ST_5535: bitstring;
                                                    {6061}new TTL_5536: bitstring;
                                                    {6062}let m2_5537: bitstring = (OpenSecureChannelResponse,Ns_5534,ST_5535,TTL_5536) in
                                                    {6063}out(c, m2_5537);
                                                    {6064}let Ksrv_5538: bitstring = h((Ns_5534,Nc_5533)) in
                                                    {6065}out(c, senc(mSrv(pkCli_5499,pkSess_5497),Ksrv_5538))
                                            )
                                            else
                                                {6066}let pkDisco_5539: bitstring = fail-any in
                                                {6067}in(c, (=pkCli_5499,em1_5540: bitstring));
                                                {6068}let m1_5541: bitstring = em1_5540 in
                                                {6069}let (=OpenSecureChannelRequest,=pkCli_5499,Nc_5542: bitstring) = m1_5541 in
                                                {6070}new Ns_5543: bitstring;
                                                {6071}new ST_5544: bitstring;
                                                {6072}new TTL_5545: bitstring;
                                                {6073}let m2_5546: bitstring = (OpenSecureChannelResponse,Ns_5543,ST_5544,TTL_5545) in
                                                {6074}out(c, m2_5546);
                                                {6075}let Ksrv_5547: bitstring = h((Ns_5543,Nc_5542)) in
                                                {6076}out(c, senc(mSrv(pkCli_5499,pkSess_5497),Ksrv_5547))
                                    )
                                    else
                                        {6077}let pkDisco_5548: bitstring = fail-any in
                                        {6078}in(c, (=pkCli_5499,em1_5549: bitstring));
                                        {6079}let m1_5550: bitstring = em1_5549 in
                                        {6080}let (=OpenSecureChannelRequest,=pkCli_5499,Nc_5551: bitstring) = m1_5550 in
                                        {6081}new Ns_5552: bitstring;
                                        {6082}new ST_5553: bitstring;
                                        {6083}new TTL_5554: bitstring;
                                        {6084}let m2_5555: bitstring = (OpenSecureChannelResponse,Ns_5552,ST_5553,TTL_5554) in
                                        {6085}out(c, m2_5555);
                                        {6086}let Ksrv_5556: bitstring = h((Ns_5552,Nc_5551)) in
                                        {6087}out(c, senc(mSrv(pkCli_5499,pkSess_5497),Ksrv_5556))
                            )
                            else
                                {6088}let pkDisco_5557: bitstring = fail-any in
                                {6089}in(c, (=pkCli_5499,em1_5558: bitstring));
                                {6090}let m1_5559: bitstring = em1_5558 in
                                {6091}let (=OpenSecureChannelRequest,=pkCli_5499,Nc_5560: bitstring) = m1_5559 in
                                {6092}new Ns_5561: bitstring;
                                {6093}new ST_5562: bitstring;
                                {6094}new TTL_5563: bitstring;
                                {6095}let m2_5564: bitstring = (OpenSecureChannelResponse,Ns_5561,ST_5562,TTL_5563) in
                                {6096}out(c, m2_5564);
                                {6097}let Ksrv_5565: bitstring = h((Ns_5561,Nc_5560)) in
                                {6098}out(c, senc(mSrv(pkCli_5499,pkSess_5497),Ksrv_5565))
                        )
                        else
                            {6099}let v_5566: bool = (Cli_5020 = B) in
                            (
                                {6100}if v_5566 then
                                (
                                    {6101}let pkCli_5567: bitstring = pub(skB) in
                                    {6102}let v_5568: bool = (Disco_5021 = A) in
                                    (
                                        {6103}if v_5568 then
                                        (
                                            {6104}let pkDisco_5569: bitstring = pub(skA) in
                                            {6105}in(c, (=pkCli_5567,em1_5570: bitstring));
                                            {6106}let m1_5571: bitstring = em1_5570 in
                                            {6107}let (=OpenSecureChannelRequest,=pkCli_5567,Nc_5572: bitstring) = m1_5571 in
                                            {6108}new Ns_5573: bitstring;
                                            {6109}new ST_5574: bitstring;
                                            {6110}new TTL_5575: bitstring;
                                            {6111}let m2_5576: bitstring = (OpenSecureChannelResponse,Ns_5573,ST_5574,TTL_5575) in
                                            {6112}out(c, m2_5576);
                                            {6113}let Ksrv_5577: bitstring = h((Ns_5573,Nc_5572)) in
                                            {6114}out(c, senc(mSrv(pkCli_5567,pkSess_5497),Ksrv_5577))
                                        )
                                        else
                                            {6115}let v_5578: bool = (Disco_5021 = B) in
                                            (
                                                {6116}if v_5578 then
                                                (
                                                    {6117}let pkDisco_5579: bitstring = pub(skB) in
                                                    {6118}in(c, (=pkCli_5567,em1_5580: bitstring));
                                                    {6119}let m1_5581: bitstring = em1_5580 in
                                                    {6120}let (=OpenSecureChannelRequest,=pkCli_5567,Nc_5582: bitstring) = m1_5581 in
                                                    {6121}new Ns_5583: bitstring;
                                                    {6122}new ST_5584: bitstring;
                                                    {6123}new TTL_5585: bitstring;
                                                    {6124}let m2_5586: bitstring = (OpenSecureChannelResponse,Ns_5583,ST_5584,TTL_5585) in
                                                    {6125}out(c, m2_5586);
                                                    {6126}let Ksrv_5587: bitstring = h((Ns_5583,Nc_5582)) in
                                                    {6127}out(c, senc(mSrv(pkCli_5567,pkSess_5497),Ksrv_5587))
                                                )
                                                else
                                                    {6128}let v_5588: bool = (Disco_5021 = C) in
                                                    (
                                                        {6129}if v_5588 then
                                                        (
                                                            {6130}let pkDisco_5589: bitstring = pub(skC) in
                                                            {6131}in(c, (=pkCli_5567,em1_5590: bitstring));
                                                            {6132}let m1_5591: bitstring = em1_5590 in
                                                            {6133}let (=OpenSecureChannelRequest,=pkCli_5567,Nc_5592: bitstring) = m1_5591 in
                                                            {6134}new Ns_5593: bitstring;
                                                            {6135}new ST_5594: bitstring;
                                                            {6136}new TTL_5595: bitstring;
                                                            {6137}let m2_5596: bitstring = (OpenSecureChannelResponse,Ns_5593,ST_5594,TTL_5595) in
                                                            {6138}out(c, m2_5596);
                                                            {6139}let Ksrv_5597: bitstring = h((Ns_5593,Nc_5592)) in
                                                            {6140}out(c, senc(mSrv(pkCli_5567,pkSess_5497),Ksrv_5597))
                                                        )
                                                        else
                                                            {6141}let pkDisco_5598: bitstring = pub(sk(Disco_5021)) in
                                                            {6142}in(c, (=pkCli_5567,em1_5599: bitstring));
                                                            {6143}let m1_5600: bitstring = em1_5599 in
                                                            {6144}let (=OpenSecureChannelRequest,=pkCli_5567,Nc_5601: bitstring) = m1_5600 in
                                                            {6145}new Ns_5602: bitstring;
                                                            {6146}new ST_5603: bitstring;
                                                            {6147}new TTL_5604: bitstring;
                                                            {6148}let m2_5605: bitstring = (OpenSecureChannelResponse,Ns_5602,ST_5603,TTL_5604) in
                                                            {6149}out(c, m2_5605);
                                                            {6150}let Ksrv_5606: bitstring = h((Ns_5602,Nc_5601)) in
                                                            {6151}out(c, senc(mSrv(pkCli_5567,pkSess_5497),Ksrv_5606))
                                                    )
                                                    else
                                                        {6152}let pkDisco_5607: bitstring = fail-any in
                                                        {6153}in(c, (=pkCli_5567,em1_5608: bitstring));
                                                        {6154}let m1_5609: bitstring = em1_5608 in
                                                        {6155}let (=OpenSecureChannelRequest,=pkCli_5567,Nc_5610: bitstring) = m1_5609 in
                                                        {6156}new Ns_5611: bitstring;
                                                        {6157}new ST_5612: bitstring;
                                                        {6158}new TTL_5613: bitstring;
                                                        {6159}let m2_5614: bitstring = (OpenSecureChannelResponse,Ns_5611,ST_5612,TTL_5613) in
                                                        {6160}out(c, m2_5614);
                                                        {6161}let Ksrv_5615: bitstring = h((Ns_5611,Nc_5610)) in
                                                        {6162}out(c, senc(mSrv(pkCli_5567,pkSess_5497),Ksrv_5615))
                                            )
                                            else
                                                {6163}let pkDisco_5616: bitstring = fail-any in
                                                {6164}in(c, (=pkCli_5567,em1_5617: bitstring));
                                                {6165}let m1_5618: bitstring = em1_5617 in
                                                {6166}let (=OpenSecureChannelRequest,=pkCli_5567,Nc_5619: bitstring) = m1_5618 in
                                                {6167}new Ns_5620: bitstring;
                                                {6168}new ST_5621: bitstring;
                                                {6169}new TTL_5622: bitstring;
                                                {6170}let m2_5623: bitstring = (OpenSecureChannelResponse,Ns_5620,ST_5621,TTL_5622) in
                                                {6171}out(c, m2_5623);
                                                {6172}let Ksrv_5624: bitstring = h((Ns_5620,Nc_5619)) in
                                                {6173}out(c, senc(mSrv(pkCli_5567,pkSess_5497),Ksrv_5624))
                                    )
                                    else
                                        {6174}let pkDisco_5625: bitstring = fail-any in
                                        {6175}in(c, (=pkCli_5567,em1_5626: bitstring));
                                        {6176}let m1_5627: bitstring = em1_5626 in
                                        {6177}let (=OpenSecureChannelRequest,=pkCli_5567,Nc_5628: bitstring) = m1_5627 in
                                        {6178}new Ns_5629: bitstring;
                                        {6179}new ST_5630: bitstring;
                                        {6180}new TTL_5631: bitstring;
                                        {6181}let m2_5632: bitstring = (OpenSecureChannelResponse,Ns_5629,ST_5630,TTL_5631) in
                                        {6182}out(c, m2_5632);
                                        {6183}let Ksrv_5633: bitstring = h((Ns_5629,Nc_5628)) in
                                        {6184}out(c, senc(mSrv(pkCli_5567,pkSess_5497),Ksrv_5633))
                                )
                                else
                                    {6185}let v_5634: bool = (Cli_5020 = C) in
                                    (
                                        {6186}if v_5634 then
                                        (
                                            {6187}let pkCli_5635: bitstring = pub(skC) in
                                            {6188}let v_5636: bool = (Disco_5021 = A) in
                                            (
                                                {6189}if v_5636 then
                                                (
                                                    {6190}let pkDisco_5637: bitstring = pub(skA) in
                                                    {6191}in(c, (=pkCli_5635,em1_5638: bitstring));
                                                    {6192}let m1_5639: bitstring = em1_5638 in
                                                    {6193}let (=OpenSecureChannelRequest,=pkCli_5635,Nc_5640: bitstring) = m1_5639 in
                                                    {6194}new Ns_5641: bitstring;
                                                    {6195}new ST_5642: bitstring;
                                                    {6196}new TTL_5643: bitstring;
                                                    {6197}let m2_5644: bitstring = (OpenSecureChannelResponse,Ns_5641,ST_5642,TTL_5643) in
                                                    {6198}out(c, m2_5644);
                                                    {6199}let Ksrv_5645: bitstring = h((Ns_5641,Nc_5640)) in
                                                    {6200}out(c, senc(mSrv(pkCli_5635,pkSess_5497),Ksrv_5645))
                                                )
                                                else
                                                    {6201}let v_5646: bool = (Disco_5021 = B) in
                                                    (
                                                        {6202}if v_5646 then
                                                        (
                                                            {6203}let pkDisco_5647: bitstring = pub(skB) in
                                                            {6204}in(c, (=pkCli_5635,em1_5648: bitstring));
                                                            {6205}let m1_5649: bitstring = em1_5648 in
                                                            {6206}let (=OpenSecureChannelRequest,=pkCli_5635,Nc_5650: bitstring) = m1_5649 in
                                                            {6207}new Ns_5651: bitstring;
                                                            {6208}new ST_5652: bitstring;
                                                            {6209}new TTL_5653: bitstring;
                                                            {6210}let m2_5654: bitstring = (OpenSecureChannelResponse,Ns_5651,ST_5652,TTL_5653) in
                                                            {6211}out(c, m2_5654);
                                                            {6212}let Ksrv_5655: bitstring = h((Ns_5651,Nc_5650)) in
                                                            {6213}out(c, senc(mSrv(pkCli_5635,pkSess_5497),Ksrv_5655))
                                                        )
                                                        else
                                                            {6214}let v_5656: bool = (Disco_5021 = C) in
                                                            (
                                                                {6215}if v_5656 then
                                                                (
                                                                    {6216}let pkDisco_5657: bitstring = pub(skC) in
                                                                    {6217}in(c, (=pkCli_5635,em1_5658: bitstring));
                                                                    {6218}let m1_5659: bitstring = em1_5658 in
                                                                    {6219}let (=OpenSecureChannelRequest,=pkCli_5635,Nc_5660: bitstring) = m1_5659 in
                                                                    {6220}new Ns_5661: bitstring;
                                                                    {6221}new ST_5662: bitstring;
                                                                    {6222}new TTL_5663: bitstring;
                                                                    {6223}let m2_5664: bitstring = (OpenSecureChannelResponse,Ns_5661,ST_5662,TTL_5663) in
                                                                    {6224}out(c, m2_5664);
                                                                    {6225}let Ksrv_5665: bitstring = h((Ns_5661,Nc_5660)) in
                                                                    {6226}out(c, senc(mSrv(pkCli_5635,pkSess_5497),Ksrv_5665))
                                                                )
                                                                else
                                                                    {6227}let pkDisco_5666: bitstring = pub(sk(Disco_5021)) in
                                                                    {6228}in(c, (=pkCli_5635,em1_5667: bitstring));
                                                                    {6229}let m1_5668: bitstring = em1_5667 in
                                                                    {6230}let (=OpenSecureChannelRequest,=pkCli_5635,Nc_5669: bitstring) = m1_5668 in
                                                                    {6231}new Ns_5670: bitstring;
                                                                    {6232}new ST_5671: bitstring;
                                                                    {6233}new TTL_5672: bitstring;
                                                                    {6234}let m2_5673: bitstring = (OpenSecureChannelResponse,Ns_5670,ST_5671,TTL_5672) in
                                                                    {6235}out(c, m2_5673);
                                                                    {6236}let Ksrv_5674: bitstring = h((Ns_5670,Nc_5669)) in
                                                                    {6237}out(c, senc(mSrv(pkCli_5635,pkSess_5497),Ksrv_5674))
                                                            )
                                                            else
                                                                {6238}let pkDisco_5675: bitstring = fail-any in
                                                                {6239}in(c, (=pkCli_5635,em1_5676: bitstring));
                                                                {6240}let m1_5677: bitstring = em1_5676 in
                                                                {6241}let (=OpenSecureChannelRequest,=pkCli_5635,Nc_5678: bitstring) = m1_5677 in
                                                                {6242}new Ns_5679: bitstring;
                                                                {6243}new ST_5680: bitstring;
                                                                {6244}new TTL_5681: bitstring;
                                                                {6245}let m2_5682: bitstring = (OpenSecureChannelResponse,Ns_5679,ST_5680,TTL_5681) in
                                                                {6246}out(c, m2_5682);
                                                                {6247}let Ksrv_5683: bitstring = h((Ns_5679,Nc_5678)) in
                                                                {6248}out(c, senc(mSrv(pkCli_5635,pkSess_5497),Ksrv_5683))
                                                    )
                                                    else
                                                        {6249}let pkDisco_5684: bitstring = fail-any in
                                                        {6250}in(c, (=pkCli_5635,em1_5685: bitstring));
                                                        {6251}let m1_5686: bitstring = em1_5685 in
                                                        {6252}let (=OpenSecureChannelRequest,=pkCli_5635,Nc_5687: bitstring) = m1_5686 in
                                                        {6253}new Ns_5688: bitstring;
                                                        {6254}new ST_5689: bitstring;
                                                        {6255}new TTL_5690: bitstring;
                                                        {6256}let m2_5691: bitstring = (OpenSecureChannelResponse,Ns_5688,ST_5689,TTL_5690) in
                                                        {6257}out(c, m2_5691);
                                                        {6258}let Ksrv_5692: bitstring = h((Ns_5688,Nc_5687)) in
                                                        {6259}out(c, senc(mSrv(pkCli_5635,pkSess_5497),Ksrv_5692))
                                            )
                                            else
                                                {6260}let pkDisco_5693: bitstring = fail-any in
                                                {6261}in(c, (=pkCli_5635,em1_5694: bitstring));
                                                {6262}let m1_5695: bitstring = em1_5694 in
                                                {6263}let (=OpenSecureChannelRequest,=pkCli_5635,Nc_5696: bitstring) = m1_5695 in
                                                {6264}new Ns_5697: bitstring;
                                                {6265}new ST_5698: bitstring;
                                                {6266}new TTL_5699: bitstring;
                                                {6267}let m2_5700: bitstring = (OpenSecureChannelResponse,Ns_5697,ST_5698,TTL_5699) in
                                                {6268}out(c, m2_5700);
                                                {6269}let Ksrv_5701: bitstring = h((Ns_5697,Nc_5696)) in
                                                {6270}out(c, senc(mSrv(pkCli_5635,pkSess_5497),Ksrv_5701))
                                        )
                                        else
                                            {6271}let pkCli_5702: bitstring = pub(sk(Cli_5020)) in
                                            {6272}let v_5703: bool = (Disco_5021 = A) in
                                            (
                                                {6273}if v_5703 then
                                                (
                                                    {6274}let pkDisco_5704: bitstring = pub(skA) in
                                                    {6275}in(c, (=pkCli_5702,em1_5705: bitstring));
                                                    {6276}let m1_5706: bitstring = em1_5705 in
                                                    {6277}let (=OpenSecureChannelRequest,=pkCli_5702,Nc_5707: bitstring) = m1_5706 in
                                                    {6278}new Ns_5708: bitstring;
                                                    {6279}new ST_5709: bitstring;
                                                    {6280}new TTL_5710: bitstring;
                                                    {6281}let m2_5711: bitstring = (OpenSecureChannelResponse,Ns_5708,ST_5709,TTL_5710) in
                                                    {6282}out(c, m2_5711);
                                                    {6283}let Ksrv_5712: bitstring = h((Ns_5708,Nc_5707)) in
                                                    {6284}out(c, senc(mSrv(pkCli_5702,pkSess_5497),Ksrv_5712))
                                                )
                                                else
                                                    {6285}let v_5713: bool = (Disco_5021 = B) in
                                                    (
                                                        {6286}if v_5713 then
                                                        (
                                                            {6287}let pkDisco_5714: bitstring = pub(skB) in
                                                            {6288}in(c, (=pkCli_5702,em1_5715: bitstring));
                                                            {6289}let m1_5716: bitstring = em1_5715 in
                                                            {6290}let (=OpenSecureChannelRequest,=pkCli_5702,Nc_5717: bitstring) = m1_5716 in
                                                            {6291}new Ns_5718: bitstring;
                                                            {6292}new ST_5719: bitstring;
                                                            {6293}new TTL_5720: bitstring;
                                                            {6294}let m2_5721: bitstring = (OpenSecureChannelResponse,Ns_5718,ST_5719,TTL_5720) in
                                                            {6295}out(c, m2_5721);
                                                            {6296}let Ksrv_5722: bitstring = h((Ns_5718,Nc_5717)) in
                                                            {6297}out(c, senc(mSrv(pkCli_5702,pkSess_5497),Ksrv_5722))
                                                        )
                                                        else
                                                            {6298}let v_5723: bool = (Disco_5021 = C) in
                                                            (
                                                                {6299}if v_5723 then
                                                                (
                                                                    {6300}let pkDisco_5724: bitstring = pub(skC) in
                                                                    {6301}in(c, (=pkCli_5702,em1_5725: bitstring));
                                                                    {6302}let m1_5726: bitstring = em1_5725 in
                                                                    {6303}let (=OpenSecureChannelRequest,=pkCli_5702,Nc_5727: bitstring) = m1_5726 in
                                                                    {6304}new Ns_5728: bitstring;
                                                                    {6305}new ST_5729: bitstring;
                                                                    {6306}new TTL_5730: bitstring;
                                                                    {6307}let m2_5731: bitstring = (OpenSecureChannelResponse,Ns_5728,ST_5729,TTL_5730) in
                                                                    {6308}out(c, m2_5731);
                                                                    {6309}let Ksrv_5732: bitstring = h((Ns_5728,Nc_5727)) in
                                                                    {6310}out(c, senc(mSrv(pkCli_5702,pkSess_5497),Ksrv_5732))
                                                                )
                                                                else
                                                                    {6311}let pkDisco_5733: bitstring = pub(sk(Disco_5021)) in
                                                                    {6312}in(c, (=pkCli_5702,em1_5734: bitstring));
                                                                    {6313}let m1_5735: bitstring = em1_5734 in
                                                                    {6314}let (=OpenSecureChannelRequest,=pkCli_5702,Nc_5736: bitstring) = m1_5735 in
                                                                    {6315}new Ns_5737: bitstring;
                                                                    {6316}new ST_5738: bitstring;
                                                                    {6317}new TTL_5739: bitstring;
                                                                    {6318}let m2_5740: bitstring = (OpenSecureChannelResponse,Ns_5737,ST_5738,TTL_5739) in
                                                                    {6319}out(c, m2_5740);
                                                                    {6320}let Ksrv_5741: bitstring = h((Ns_5737,Nc_5736)) in
                                                                    {6321}out(c, senc(mSrv(pkCli_5702,pkSess_5497),Ksrv_5741))
                                                            )
                                                            else
                                                                {6322}let pkDisco_5742: bitstring = fail-any in
                                                                {6323}in(c, (=pkCli_5702,em1_5743: bitstring));
                                                                {6324}let m1_5744: bitstring = em1_5743 in
                                                                {6325}let (=OpenSecureChannelRequest,=pkCli_5702,Nc_5745: bitstring) = m1_5744 in
                                                                {6326}new Ns_5746: bitstring;
                                                                {6327}new ST_5747: bitstring;
                                                                {6328}new TTL_5748: bitstring;
                                                                {6329}let m2_5749: bitstring = (OpenSecureChannelResponse,Ns_5746,ST_5747,TTL_5748) in
                                                                {6330}out(c, m2_5749);
                                                                {6331}let Ksrv_5750: bitstring = h((Ns_5746,Nc_5745)) in
                                                                {6332}out(c, senc(mSrv(pkCli_5702,pkSess_5497),Ksrv_5750))
                                                    )
                                                    else
                                                        {6333}let pkDisco_5751: bitstring = fail-any in
                                                        {6334}in(c, (=pkCli_5702,em1_5752: bitstring));
                                                        {6335}let m1_5753: bitstring = em1_5752 in
                                                        {6336}let (=OpenSecureChannelRequest,=pkCli_5702,Nc_5754: bitstring) = m1_5753 in
                                                        {6337}new Ns_5755: bitstring;
                                                        {6338}new ST_5756: bitstring;
                                                        {6339}new TTL_5757: bitstring;
                                                        {6340}let m2_5758: bitstring = (OpenSecureChannelResponse,Ns_5755,ST_5756,TTL_5757) in
                                                        {6341}out(c, m2_5758);
                                                        {6342}let Ksrv_5759: bitstring = h((Ns_5755,Nc_5754)) in
                                                        {6343}out(c, senc(mSrv(pkCli_5702,pkSess_5497),Ksrv_5759))
                                            )
                                            else
                                                {6344}let pkDisco_5760: bitstring = fail-any in
                                                {6345}in(c, (=pkCli_5702,em1_5761: bitstring));
                                                {6346}let m1_5762: bitstring = em1_5761 in
                                                {6347}let (=OpenSecureChannelRequest,=pkCli_5702,Nc_5763: bitstring) = m1_5762 in
                                                {6348}new Ns_5764: bitstring;
                                                {6349}new ST_5765: bitstring;
                                                {6350}new TTL_5766: bitstring;
                                                {6351}let m2_5767: bitstring = (OpenSecureChannelResponse,Ns_5764,ST_5765,TTL_5766) in
                                                {6352}out(c, m2_5767);
                                                {6353}let Ksrv_5768: bitstring = h((Ns_5764,Nc_5763)) in
                                                {6354}out(c, senc(mSrv(pkCli_5702,pkSess_5497),Ksrv_5768))
                                    )
                                    else
                                        {6355}let pkCli_5769: bitstring = fail-any in
                                        {6356}let v_5770: bool = (Disco_5021 = A) in
                                        (
                                            {6357}if v_5770 then
                                            (
                                                {6358}let pkDisco_5771: bitstring = pub(skA) in
                                                {6359}in(c, (=pkCli_5769,em1_5772: bitstring));
                                                {6360}let m1_5773: bitstring = em1_5772 in
                                                {6361}let (=OpenSecureChannelRequest,=pkCli_5769,Nc_5774: bitstring) = m1_5773 in
                                                {6362}new Ns_5775: bitstring;
                                                {6363}new ST_5776: bitstring;
                                                {6364}new TTL_5777: bitstring;
                                                {6365}let m2_5778: bitstring = (OpenSecureChannelResponse,Ns_5775,ST_5776,TTL_5777) in
                                                {6366}out(c, m2_5778);
                                                {6367}let Ksrv_5779: bitstring = h((Ns_5775,Nc_5774)) in
                                                {6368}out(c, senc(mSrv(pkCli_5769,pkSess_5497),Ksrv_5779))
                                            )
                                            else
                                                {6369}let v_5780: bool = (Disco_5021 = B) in
                                                (
                                                    {6370}if v_5780 then
                                                    (
                                                        {6371}let pkDisco_5781: bitstring = pub(skB) in
                                                        {6372}in(c, (=pkCli_5769,em1_5782: bitstring));
                                                        {6373}let m1_5783: bitstring = em1_5782 in
                                                        {6374}let (=OpenSecureChannelRequest,=pkCli_5769,Nc_5784: bitstring) = m1_5783 in
                                                        {6375}new Ns_5785: bitstring;
                                                        {6376}new ST_5786: bitstring;
                                                        {6377}new TTL_5787: bitstring;
                                                        {6378}let m2_5788: bitstring = (OpenSecureChannelResponse,Ns_5785,ST_5786,TTL_5787) in
                                                        {6379}out(c, m2_5788);
                                                        {6380}let Ksrv_5789: bitstring = h((Ns_5785,Nc_5784)) in
                                                        {6381}out(c, senc(mSrv(pkCli_5769,pkSess_5497),Ksrv_5789))
                                                    )
                                                    else
                                                        {6382}let v_5790: bool = (Disco_5021 = C) in
                                                        (
                                                            {6383}if v_5790 then
                                                            (
                                                                {6384}let pkDisco_5791: bitstring = pub(skC) in
                                                                {6385}in(c, (=pkCli_5769,em1_5792: bitstring));
                                                                {6386}let m1_5793: bitstring = em1_5792 in
                                                                {6387}let (=OpenSecureChannelRequest,=pkCli_5769,Nc_5794: bitstring) = m1_5793 in
                                                                {6388}new Ns_5795: bitstring;
                                                                {6389}new ST_5796: bitstring;
                                                                {6390}new TTL_5797: bitstring;
                                                                {6391}let m2_5798: bitstring = (OpenSecureChannelResponse,Ns_5795,ST_5796,TTL_5797) in
                                                                {6392}out(c, m2_5798);
                                                                {6393}let Ksrv_5799: bitstring = h((Ns_5795,Nc_5794)) in
                                                                {6394}out(c, senc(mSrv(pkCli_5769,pkSess_5497),Ksrv_5799))
                                                            )
                                                            else
                                                                {6395}let pkDisco_5800: bitstring = pub(sk(Disco_5021)) in
                                                                {6396}in(c, (=pkCli_5769,em1_5801: bitstring));
                                                                {6397}let m1_5802: bitstring = em1_5801 in
                                                                {6398}let (=OpenSecureChannelRequest,=pkCli_5769,Nc_5803: bitstring) = m1_5802 in
                                                                {6399}new Ns_5804: bitstring;
                                                                {6400}new ST_5805: bitstring;
                                                                {6401}new TTL_5806: bitstring;
                                                                {6402}let m2_5807: bitstring = (OpenSecureChannelResponse,Ns_5804,ST_5805,TTL_5806) in
                                                                {6403}out(c, m2_5807);
                                                                {6404}let Ksrv_5808: bitstring = h((Ns_5804,Nc_5803)) in
                                                                {6405}out(c, senc(mSrv(pkCli_5769,pkSess_5497),Ksrv_5808))
                                                        )
                                                        else
                                                            {6406}let pkDisco_5809: bitstring = fail-any in
                                                            {6407}in(c, (=pkCli_5769,em1_5810: bitstring));
                                                            {6408}let m1_5811: bitstring = em1_5810 in
                                                            {6409}let (=OpenSecureChannelRequest,=pkCli_5769,Nc_5812: bitstring) = m1_5811 in
                                                            {6410}new Ns_5813: bitstring;
                                                            {6411}new ST_5814: bitstring;
                                                            {6412}new TTL_5815: bitstring;
                                                            {6413}let m2_5816: bitstring = (OpenSecureChannelResponse,Ns_5813,ST_5814,TTL_5815) in
                                                            {6414}out(c, m2_5816);
                                                            {6415}let Ksrv_5817: bitstring = h((Ns_5813,Nc_5812)) in
                                                            {6416}out(c, senc(mSrv(pkCli_5769,pkSess_5497),Ksrv_5817))
                                                )
                                                else
                                                    {6417}let pkDisco_5818: bitstring = fail-any in
                                                    {6418}in(c, (=pkCli_5769,em1_5819: bitstring));
                                                    {6419}let m1_5820: bitstring = em1_5819 in
                                                    {6420}let (=OpenSecureChannelRequest,=pkCli_5769,Nc_5821: bitstring) = m1_5820 in
                                                    {6421}new Ns_5822: bitstring;
                                                    {6422}new ST_5823: bitstring;
                                                    {6423}new TTL_5824: bitstring;
                                                    {6424}let m2_5825: bitstring = (OpenSecureChannelResponse,Ns_5822,ST_5823,TTL_5824) in
                                                    {6425}out(c, m2_5825);
                                                    {6426}let Ksrv_5826: bitstring = h((Ns_5822,Nc_5821)) in
                                                    {6427}out(c, senc(mSrv(pkCli_5769,pkSess_5497),Ksrv_5826))
                                        )
                                        else
                                            {6428}let pkDisco_5827: bitstring = fail-any in
                                            {6429}in(c, (=pkCli_5769,em1_5828: bitstring));
                                            {6430}let m1_5829: bitstring = em1_5828 in
                                            {6431}let (=OpenSecureChannelRequest,=pkCli_5769,Nc_5830: bitstring) = m1_5829 in
                                            {6432}new Ns_5831: bitstring;
                                            {6433}new ST_5832: bitstring;
                                            {6434}new TTL_5833: bitstring;
                                            {6435}let m2_5834: bitstring = (OpenSecureChannelResponse,Ns_5831,ST_5832,TTL_5833) in
                                            {6436}out(c, m2_5834);
                                            {6437}let Ksrv_5835: bitstring = h((Ns_5831,Nc_5830)) in
                                            {6438}out(c, senc(mSrv(pkCli_5769,pkSess_5497),Ksrv_5835))
                            )
                            else
                                {6439}let pkCli_5836: bitstring = fail-any in
                                {6440}let v_5837: bool = (Disco_5021 = A) in
                                (
                                    {6441}if v_5837 then
                                    (
                                        {6442}let pkDisco_5838: bitstring = pub(skA) in
                                        {6443}in(c, (=pkCli_5836,em1_5839: bitstring));
                                        {6444}let m1_5840: bitstring = em1_5839 in
                                        {6445}let (=OpenSecureChannelRequest,=pkCli_5836,Nc_5841: bitstring) = m1_5840 in
                                        {6446}new Ns_5842: bitstring;
                                        {6447}new ST_5843: bitstring;
                                        {6448}new TTL_5844: bitstring;
                                        {6449}let m2_5845: bitstring = (OpenSecureChannelResponse,Ns_5842,ST_5843,TTL_5844) in
                                        {6450}out(c, m2_5845);
                                        {6451}let Ksrv_5846: bitstring = h((Ns_5842,Nc_5841)) in
                                        {6452}out(c, senc(mSrv(pkCli_5836,pkSess_5497),Ksrv_5846))
                                    )
                                    else
                                        {6453}let v_5847: bool = (Disco_5021 = B) in
                                        (
                                            {6454}if v_5847 then
                                            (
                                                {6455}let pkDisco_5848: bitstring = pub(skB) in
                                                {6456}in(c, (=pkCli_5836,em1_5849: bitstring));
                                                {6457}let m1_5850: bitstring = em1_5849 in
                                                {6458}let (=OpenSecureChannelRequest,=pkCli_5836,Nc_5851: bitstring) = m1_5850 in
                                                {6459}new Ns_5852: bitstring;
                                                {6460}new ST_5853: bitstring;
                                                {6461}new TTL_5854: bitstring;
                                                {6462}let m2_5855: bitstring = (OpenSecureChannelResponse,Ns_5852,ST_5853,TTL_5854) in
                                                {6463}out(c, m2_5855);
                                                {6464}let Ksrv_5856: bitstring = h((Ns_5852,Nc_5851)) in
                                                {6465}out(c, senc(mSrv(pkCli_5836,pkSess_5497),Ksrv_5856))
                                            )
                                            else
                                                {6466}let v_5857: bool = (Disco_5021 = C) in
                                                (
                                                    {6467}if v_5857 then
                                                    (
                                                        {6468}let pkDisco_5858: bitstring = pub(skC) in
                                                        {6469}in(c, (=pkCli_5836,em1_5859: bitstring));
                                                        {6470}let m1_5860: bitstring = em1_5859 in
                                                        {6471}let (=OpenSecureChannelRequest,=pkCli_5836,Nc_5861: bitstring) = m1_5860 in
                                                        {6472}new Ns_5862: bitstring;
                                                        {6473}new ST_5863: bitstring;
                                                        {6474}new TTL_5864: bitstring;
                                                        {6475}let m2_5865: bitstring = (OpenSecureChannelResponse,Ns_5862,ST_5863,TTL_5864) in
                                                        {6476}out(c, m2_5865);
                                                        {6477}let Ksrv_5866: bitstring = h((Ns_5862,Nc_5861)) in
                                                        {6478}out(c, senc(mSrv(pkCli_5836,pkSess_5497),Ksrv_5866))
                                                    )
                                                    else
                                                        {6479}let pkDisco_5867: bitstring = pub(sk(Disco_5021)) in
                                                        {6480}in(c, (=pkCli_5836,em1_5868: bitstring));
                                                        {6481}let m1_5869: bitstring = em1_5868 in
                                                        {6482}let (=OpenSecureChannelRequest,=pkCli_5836,Nc_5870: bitstring) = m1_5869 in
                                                        {6483}new Ns_5871: bitstring;
                                                        {6484}new ST_5872: bitstring;
                                                        {6485}new TTL_5873: bitstring;
                                                        {6486}let m2_5874: bitstring = (OpenSecureChannelResponse,Ns_5871,ST_5872,TTL_5873) in
                                                        {6487}out(c, m2_5874);
                                                        {6488}let Ksrv_5875: bitstring = h((Ns_5871,Nc_5870)) in
                                                        {6489}out(c, senc(mSrv(pkCli_5836,pkSess_5497),Ksrv_5875))
                                                )
                                                else
                                                    {6490}let pkDisco_5876: bitstring = fail-any in
                                                    {6491}in(c, (=pkCli_5836,em1_5877: bitstring));
                                                    {6492}let m1_5878: bitstring = em1_5877 in
                                                    {6493}let (=OpenSecureChannelRequest,=pkCli_5836,Nc_5879: bitstring) = m1_5878 in
                                                    {6494}new Ns_5880: bitstring;
                                                    {6495}new ST_5881: bitstring;
                                                    {6496}new TTL_5882: bitstring;
                                                    {6497}let m2_5883: bitstring = (OpenSecureChannelResponse,Ns_5880,ST_5881,TTL_5882) in
                                                    {6498}out(c, m2_5883);
                                                    {6499}let Ksrv_5884: bitstring = h((Ns_5880,Nc_5879)) in
                                                    {6500}out(c, senc(mSrv(pkCli_5836,pkSess_5497),Ksrv_5884))
                                        )
                                        else
                                            {6501}let pkDisco_5885: bitstring = fail-any in
                                            {6502}in(c, (=pkCli_5836,em1_5886: bitstring));
                                            {6503}let m1_5887: bitstring = em1_5886 in
                                            {6504}let (=OpenSecureChannelRequest,=pkCli_5836,Nc_5888: bitstring) = m1_5887 in
                                            {6505}new Ns_5889: bitstring;
                                            {6506}new ST_5890: bitstring;
                                            {6507}new TTL_5891: bitstring;
                                            {6508}let m2_5892: bitstring = (OpenSecureChannelResponse,Ns_5889,ST_5890,TTL_5891) in
                                            {6509}out(c, m2_5892);
                                            {6510}let Ksrv_5893: bitstring = h((Ns_5889,Nc_5888)) in
                                            {6511}out(c, senc(mSrv(pkCli_5836,pkSess_5497),Ksrv_5893))
                                )
                                else
                                    {6512}let pkDisco_5894: bitstring = fail-any in
                                    {6513}in(c, (=pkCli_5836,em1_5895: bitstring));
                                    {6514}let m1_5896: bitstring = em1_5895 in
                                    {6515}let (=OpenSecureChannelRequest,=pkCli_5836,Nc_5897: bitstring) = m1_5896 in
                                    {6516}new Ns_5898: bitstring;
                                    {6517}new ST_5899: bitstring;
                                    {6518}new TTL_5900: bitstring;
                                    {6519}let m2_5901: bitstring = (OpenSecureChannelResponse,Ns_5898,ST_5899,TTL_5900) in
                                    {6520}out(c, m2_5901);
                                    {6521}let Ksrv_5902: bitstring = h((Ns_5898,Nc_5897)) in
                                    {6522}out(c, senc(mSrv(pkCli_5836,pkSess_5497),Ksrv_5902))
                    )
                    else
                        {6523}let pkCli_5903: bitstring = fail-any in
                        {6524}let v_5904: bool = (Disco_5021 = A) in
                        (
                            {6525}if v_5904 then
                            (
                                {6526}let pkDisco_5905: bitstring = pub(skA) in
                                {6527}in(c, (=pkCli_5903,em1_5906: bitstring));
                                {6528}let m1_5907: bitstring = em1_5906 in
                                {6529}let (=OpenSecureChannelRequest,=pkCli_5903,Nc_5908: bitstring) = m1_5907 in
                                {6530}new Ns_5909: bitstring;
                                {6531}new ST_5910: bitstring;
                                {6532}new TTL_5911: bitstring;
                                {6533}let m2_5912: bitstring = (OpenSecureChannelResponse,Ns_5909,ST_5910,TTL_5911) in
                                {6534}out(c, m2_5912);
                                {6535}let Ksrv_5913: bitstring = h((Ns_5909,Nc_5908)) in
                                {6536}out(c, senc(mSrv(pkCli_5903,pkSess_5497),Ksrv_5913))
                            )
                            else
                                {6537}let v_5914: bool = (Disco_5021 = B) in
                                (
                                    {6538}if v_5914 then
                                    (
                                        {6539}let pkDisco_5915: bitstring = pub(skB) in
                                        {6540}in(c, (=pkCli_5903,em1_5916: bitstring));
                                        {6541}let m1_5917: bitstring = em1_5916 in
                                        {6542}let (=OpenSecureChannelRequest,=pkCli_5903,Nc_5918: bitstring) = m1_5917 in
                                        {6543}new Ns_5919: bitstring;
                                        {6544}new ST_5920: bitstring;
                                        {6545}new TTL_5921: bitstring;
                                        {6546}let m2_5922: bitstring = (OpenSecureChannelResponse,Ns_5919,ST_5920,TTL_5921) in
                                        {6547}out(c, m2_5922);
                                        {6548}let Ksrv_5923: bitstring = h((Ns_5919,Nc_5918)) in
                                        {6549}out(c, senc(mSrv(pkCli_5903,pkSess_5497),Ksrv_5923))
                                    )
                                    else
                                        {6550}let v_5924: bool = (Disco_5021 = C) in
                                        (
                                            {6551}if v_5924 then
                                            (
                                                {6552}let pkDisco_5925: bitstring = pub(skC) in
                                                {6553}in(c, (=pkCli_5903,em1_5926: bitstring));
                                                {6554}let m1_5927: bitstring = em1_5926 in
                                                {6555}let (=OpenSecureChannelRequest,=pkCli_5903,Nc_5928: bitstring) = m1_5927 in
                                                {6556}new Ns_5929: bitstring;
                                                {6557}new ST_5930: bitstring;
                                                {6558}new TTL_5931: bitstring;
                                                {6559}let m2_5932: bitstring = (OpenSecureChannelResponse,Ns_5929,ST_5930,TTL_5931) in
                                                {6560}out(c, m2_5932);
                                                {6561}let Ksrv_5933: bitstring = h((Ns_5929,Nc_5928)) in
                                                {6562}out(c, senc(mSrv(pkCli_5903,pkSess_5497),Ksrv_5933))
                                            )
                                            else
                                                {6563}let pkDisco_5934: bitstring = pub(sk(Disco_5021)) in
                                                {6564}in(c, (=pkCli_5903,em1_5935: bitstring));
                                                {6565}let m1_5936: bitstring = em1_5935 in
                                                {6566}let (=OpenSecureChannelRequest,=pkCli_5903,Nc_5937: bitstring) = m1_5936 in
                                                {6567}new Ns_5938: bitstring;
                                                {6568}new ST_5939: bitstring;
                                                {6569}new TTL_5940: bitstring;
                                                {6570}let m2_5941: bitstring = (OpenSecureChannelResponse,Ns_5938,ST_5939,TTL_5940) in
                                                {6571}out(c, m2_5941);
                                                {6572}let Ksrv_5942: bitstring = h((Ns_5938,Nc_5937)) in
                                                {6573}out(c, senc(mSrv(pkCli_5903,pkSess_5497),Ksrv_5942))
                                        )
                                        else
                                            {6574}let pkDisco_5943: bitstring = fail-any in
                                            {6575}in(c, (=pkCli_5903,em1_5944: bitstring));
                                            {6576}let m1_5945: bitstring = em1_5944 in
                                            {6577}let (=OpenSecureChannelRequest,=pkCli_5903,Nc_5946: bitstring) = m1_5945 in
                                            {6578}new Ns_5947: bitstring;
                                            {6579}new ST_5948: bitstring;
                                            {6580}new TTL_5949: bitstring;
                                            {6581}let m2_5950: bitstring = (OpenSecureChannelResponse,Ns_5947,ST_5948,TTL_5949) in
                                            {6582}out(c, m2_5950);
                                            {6583}let Ksrv_5951: bitstring = h((Ns_5947,Nc_5946)) in
                                            {6584}out(c, senc(mSrv(pkCli_5903,pkSess_5497),Ksrv_5951))
                                )
                                else
                                    {6585}let pkDisco_5952: bitstring = fail-any in
                                    {6586}in(c, (=pkCli_5903,em1_5953: bitstring));
                                    {6587}let m1_5954: bitstring = em1_5953 in
                                    {6588}let (=OpenSecureChannelRequest,=pkCli_5903,Nc_5955: bitstring) = m1_5954 in
                                    {6589}new Ns_5956: bitstring;
                                    {6590}new ST_5957: bitstring;
                                    {6591}new TTL_5958: bitstring;
                                    {6592}let m2_5959: bitstring = (OpenSecureChannelResponse,Ns_5956,ST_5957,TTL_5958) in
                                    {6593}out(c, m2_5959);
                                    {6594}let Ksrv_5960: bitstring = h((Ns_5956,Nc_5955)) in
                                    {6595}out(c, senc(mSrv(pkCli_5903,pkSess_5497),Ksrv_5960))
                        )
                        else
                            {6596}let pkDisco_5961: bitstring = fail-any in
                            {6597}in(c, (=pkCli_5903,em1_5962: bitstring));
                            {6598}let m1_5963: bitstring = em1_5962 in
                            {6599}let (=OpenSecureChannelRequest,=pkCli_5903,Nc_5964: bitstring) = m1_5963 in
                            {6600}new Ns_5965: bitstring;
                            {6601}new ST_5966: bitstring;
                            {6602}new TTL_5967: bitstring;
                            {6603}let m2_5968: bitstring = (OpenSecureChannelResponse,Ns_5965,ST_5966,TTL_5967) in
                            {6604}out(c, m2_5968);
                            {6605}let Ksrv_5969: bitstring = h((Ns_5965,Nc_5964)) in
                            {6606}out(c, senc(mSrv(pkCli_5903,pkSess_5497),Ksrv_5969))
                )
                else
                    {6607}let =true = (Sess_5022 = C) in
                    (
                        {6608}let skSess_5970: bitstring = skC in
                        {6609}let pkSess_5971: bitstring = pub(skSess_5970) in
                        {6610}let v_5972: bool = (Cli_5020 = A) in
                        (
                            {6611}if v_5972 then
                            (
                                {6612}let pkCli_5973: bitstring = pub(skA) in
                                {6613}let v_5974: bool = (Disco_5021 = A) in
                                (
                                    {6614}if v_5974 then
                                    (
                                        {6615}let pkDisco_5975: bitstring = pub(skA) in
                                        {6616}in(c, (=pkCli_5973,em1_5976: bitstring));
                                        {6617}let m1_5977: bitstring = em1_5976 in
                                        {6618}let (=OpenSecureChannelRequest,=pkCli_5973,Nc_5978: bitstring) = m1_5977 in
                                        {6619}new Ns_5979: bitstring;
                                        {6620}new ST_5980: bitstring;
                                        {6621}new TTL_5981: bitstring;
                                        {6622}let m2_5982: bitstring = (OpenSecureChannelResponse,Ns_5979,ST_5980,TTL_5981) in
                                        {6623}out(c, m2_5982);
                                        {6624}let Ksrv_5983: bitstring = h((Ns_5979,Nc_5978)) in
                                        {6625}out(c, senc(mSrv(pkCli_5973,pkSess_5971),Ksrv_5983))
                                    )
                                    else
                                        {6626}let v_5984: bool = (Disco_5021 = B) in
                                        (
                                            {6627}if v_5984 then
                                            (
                                                {6628}let pkDisco_5985: bitstring = pub(skB) in
                                                {6629}in(c, (=pkCli_5973,em1_5986: bitstring));
                                                {6630}let m1_5987: bitstring = em1_5986 in
                                                {6631}let (=OpenSecureChannelRequest,=pkCli_5973,Nc_5988: bitstring) = m1_5987 in
                                                {6632}new Ns_5989: bitstring;
                                                {6633}new ST_5990: bitstring;
                                                {6634}new TTL_5991: bitstring;
                                                {6635}let m2_5992: bitstring = (OpenSecureChannelResponse,Ns_5989,ST_5990,TTL_5991) in
                                                {6636}out(c, m2_5992);
                                                {6637}let Ksrv_5993: bitstring = h((Ns_5989,Nc_5988)) in
                                                {6638}out(c, senc(mSrv(pkCli_5973,pkSess_5971),Ksrv_5993))
                                            )
                                            else
                                                {6639}let v_5994: bool = (Disco_5021 = C) in
                                                (
                                                    {6640}if v_5994 then
                                                    (
                                                        {6641}let pkDisco_5995: bitstring = pub(skC) in
                                                        {6642}in(c, (=pkCli_5973,em1_5996: bitstring));
                                                        {6643}let m1_5997: bitstring = em1_5996 in
                                                        {6644}let (=OpenSecureChannelRequest,=pkCli_5973,Nc_5998: bitstring) = m1_5997 in
                                                        {6645}new Ns_5999: bitstring;
                                                        {6646}new ST_6000: bitstring;
                                                        {6647}new TTL_6001: bitstring;
                                                        {6648}let m2_6002: bitstring = (OpenSecureChannelResponse,Ns_5999,ST_6000,TTL_6001) in
                                                        {6649}out(c, m2_6002);
                                                        {6650}let Ksrv_6003: bitstring = h((Ns_5999,Nc_5998)) in
                                                        {6651}out(c, senc(mSrv(pkCli_5973,pkSess_5971),Ksrv_6003))
                                                    )
                                                    else
                                                        {6652}let pkDisco_6004: bitstring = pub(sk(Disco_5021)) in
                                                        {6653}in(c, (=pkCli_5973,em1_6005: bitstring));
                                                        {6654}let m1_6006: bitstring = em1_6005 in
                                                        {6655}let (=OpenSecureChannelRequest,=pkCli_5973,Nc_6007: bitstring) = m1_6006 in
                                                        {6656}new Ns_6008: bitstring;
                                                        {6657}new ST_6009: bitstring;
                                                        {6658}new TTL_6010: bitstring;
                                                        {6659}let m2_6011: bitstring = (OpenSecureChannelResponse,Ns_6008,ST_6009,TTL_6010) in
                                                        {6660}out(c, m2_6011);
                                                        {6661}let Ksrv_6012: bitstring = h((Ns_6008,Nc_6007)) in
                                                        {6662}out(c, senc(mSrv(pkCli_5973,pkSess_5971),Ksrv_6012))
                                                )
                                                else
                                                    {6663}let pkDisco_6013: bitstring = fail-any in
                                                    {6664}in(c, (=pkCli_5973,em1_6014: bitstring));
                                                    {6665}let m1_6015: bitstring = em1_6014 in
                                                    {6666}let (=OpenSecureChannelRequest,=pkCli_5973,Nc_6016: bitstring) = m1_6015 in
                                                    {6667}new Ns_6017: bitstring;
                                                    {6668}new ST_6018: bitstring;
                                                    {6669}new TTL_6019: bitstring;
                                                    {6670}let m2_6020: bitstring = (OpenSecureChannelResponse,Ns_6017,ST_6018,TTL_6019) in
                                                    {6671}out(c, m2_6020);
                                                    {6672}let Ksrv_6021: bitstring = h((Ns_6017,Nc_6016)) in
                                                    {6673}out(c, senc(mSrv(pkCli_5973,pkSess_5971),Ksrv_6021))
                                        )
                                        else
                                            {6674}let pkDisco_6022: bitstring = fail-any in
                                            {6675}in(c, (=pkCli_5973,em1_6023: bitstring));
                                            {6676}let m1_6024: bitstring = em1_6023 in
                                            {6677}let (=OpenSecureChannelRequest,=pkCli_5973,Nc_6025: bitstring) = m1_6024 in
                                            {6678}new Ns_6026: bitstring;
                                            {6679}new ST_6027: bitstring;
                                            {6680}new TTL_6028: bitstring;
                                            {6681}let m2_6029: bitstring = (OpenSecureChannelResponse,Ns_6026,ST_6027,TTL_6028) in
                                            {6682}out(c, m2_6029);
                                            {6683}let Ksrv_6030: bitstring = h((Ns_6026,Nc_6025)) in
                                            {6684}out(c, senc(mSrv(pkCli_5973,pkSess_5971),Ksrv_6030))
                                )
                                else
                                    {6685}let pkDisco_6031: bitstring = fail-any in
                                    {6686}in(c, (=pkCli_5973,em1_6032: bitstring));
                                    {6687}let m1_6033: bitstring = em1_6032 in
                                    {6688}let (=OpenSecureChannelRequest,=pkCli_5973,Nc_6034: bitstring) = m1_6033 in
                                    {6689}new Ns_6035: bitstring;
                                    {6690}new ST_6036: bitstring;
                                    {6691}new TTL_6037: bitstring;
                                    {6692}let m2_6038: bitstring = (OpenSecureChannelResponse,Ns_6035,ST_6036,TTL_6037) in
                                    {6693}out(c, m2_6038);
                                    {6694}let Ksrv_6039: bitstring = h((Ns_6035,Nc_6034)) in
                                    {6695}out(c, senc(mSrv(pkCli_5973,pkSess_5971),Ksrv_6039))
                            )
                            else
                                {6696}let v_6040: bool = (Cli_5020 = B) in
                                (
                                    {6697}if v_6040 then
                                    (
                                        {6698}let pkCli_6041: bitstring = pub(skB) in
                                        {6699}let v_6042: bool = (Disco_5021 = A) in
                                        (
                                            {6700}if v_6042 then
                                            (
                                                {6701}let pkDisco_6043: bitstring = pub(skA) in
                                                {6702}in(c, (=pkCli_6041,em1_6044: bitstring));
                                                {6703}let m1_6045: bitstring = em1_6044 in
                                                {6704}let (=OpenSecureChannelRequest,=pkCli_6041,Nc_6046: bitstring) = m1_6045 in
                                                {6705}new Ns_6047: bitstring;
                                                {6706}new ST_6048: bitstring;
                                                {6707}new TTL_6049: bitstring;
                                                {6708}let m2_6050: bitstring = (OpenSecureChannelResponse,Ns_6047,ST_6048,TTL_6049) in
                                                {6709}out(c, m2_6050);
                                                {6710}let Ksrv_6051: bitstring = h((Ns_6047,Nc_6046)) in
                                                {6711}out(c, senc(mSrv(pkCli_6041,pkSess_5971),Ksrv_6051))
                                            )
                                            else
                                                {6712}let v_6052: bool = (Disco_5021 = B) in
                                                (
                                                    {6713}if v_6052 then
                                                    (
                                                        {6714}let pkDisco_6053: bitstring = pub(skB) in
                                                        {6715}in(c, (=pkCli_6041,em1_6054: bitstring));
                                                        {6716}let m1_6055: bitstring = em1_6054 in
                                                        {6717}let (=OpenSecureChannelRequest,=pkCli_6041,Nc_6056: bitstring) = m1_6055 in
                                                        {6718}new Ns_6057: bitstring;
                                                        {6719}new ST_6058: bitstring;
                                                        {6720}new TTL_6059: bitstring;
                                                        {6721}let m2_6060: bitstring = (OpenSecureChannelResponse,Ns_6057,ST_6058,TTL_6059) in
                                                        {6722}out(c, m2_6060);
                                                        {6723}let Ksrv_6061: bitstring = h((Ns_6057,Nc_6056)) in
                                                        {6724}out(c, senc(mSrv(pkCli_6041,pkSess_5971),Ksrv_6061))
                                                    )
                                                    else
                                                        {6725}let v_6062: bool = (Disco_5021 = C) in
                                                        (
                                                            {6726}if v_6062 then
                                                            (
                                                                {6727}let pkDisco_6063: bitstring = pub(skC) in
                                                                {6728}in(c, (=pkCli_6041,em1_6064: bitstring));
                                                                {6729}let m1_6065: bitstring = em1_6064 in
                                                                {6730}let (=OpenSecureChannelRequest,=pkCli_6041,Nc_6066: bitstring) = m1_6065 in
                                                                {6731}new Ns_6067: bitstring;
                                                                {6732}new ST_6068: bitstring;
                                                                {6733}new TTL_6069: bitstring;
                                                                {6734}let m2_6070: bitstring = (OpenSecureChannelResponse,Ns_6067,ST_6068,TTL_6069) in
                                                                {6735}out(c, m2_6070);
                                                                {6736}let Ksrv_6071: bitstring = h((Ns_6067,Nc_6066)) in
                                                                {6737}out(c, senc(mSrv(pkCli_6041,pkSess_5971),Ksrv_6071))
                                                            )
                                                            else
                                                                {6738}let pkDisco_6072: bitstring = pub(sk(Disco_5021)) in
                                                                {6739}in(c, (=pkCli_6041,em1_6073: bitstring));
                                                                {6740}let m1_6074: bitstring = em1_6073 in
                                                                {6741}let (=OpenSecureChannelRequest,=pkCli_6041,Nc_6075: bitstring) = m1_6074 in
                                                                {6742}new Ns_6076: bitstring;
                                                                {6743}new ST_6077: bitstring;
                                                                {6744}new TTL_6078: bitstring;
                                                                {6745}let m2_6079: bitstring = (OpenSecureChannelResponse,Ns_6076,ST_6077,TTL_6078) in
                                                                {6746}out(c, m2_6079);
                                                                {6747}let Ksrv_6080: bitstring = h((Ns_6076,Nc_6075)) in
                                                                {6748}out(c, senc(mSrv(pkCli_6041,pkSess_5971),Ksrv_6080))
                                                        )
                                                        else
                                                            {6749}let pkDisco_6081: bitstring = fail-any in
                                                            {6750}in(c, (=pkCli_6041,em1_6082: bitstring));
                                                            {6751}let m1_6083: bitstring = em1_6082 in
                                                            {6752}let (=OpenSecureChannelRequest,=pkCli_6041,Nc_6084: bitstring) = m1_6083 in
                                                            {6753}new Ns_6085: bitstring;
                                                            {6754}new ST_6086: bitstring;
                                                            {6755}new TTL_6087: bitstring;
                                                            {6756}let m2_6088: bitstring = (OpenSecureChannelResponse,Ns_6085,ST_6086,TTL_6087) in
                                                            {6757}out(c, m2_6088);
                                                            {6758}let Ksrv_6089: bitstring = h((Ns_6085,Nc_6084)) in
                                                            {6759}out(c, senc(mSrv(pkCli_6041,pkSess_5971),Ksrv_6089))
                                                )
                                                else
                                                    {6760}let pkDisco_6090: bitstring = fail-any in
                                                    {6761}in(c, (=pkCli_6041,em1_6091: bitstring));
                                                    {6762}let m1_6092: bitstring = em1_6091 in
                                                    {6763}let (=OpenSecureChannelRequest,=pkCli_6041,Nc_6093: bitstring) = m1_6092 in
                                                    {6764}new Ns_6094: bitstring;
                                                    {6765}new ST_6095: bitstring;
                                                    {6766}new TTL_6096: bitstring;
                                                    {6767}let m2_6097: bitstring = (OpenSecureChannelResponse,Ns_6094,ST_6095,TTL_6096) in
                                                    {6768}out(c, m2_6097);
                                                    {6769}let Ksrv_6098: bitstring = h((Ns_6094,Nc_6093)) in
                                                    {6770}out(c, senc(mSrv(pkCli_6041,pkSess_5971),Ksrv_6098))
                                        )
                                        else
                                            {6771}let pkDisco_6099: bitstring = fail-any in
                                            {6772}in(c, (=pkCli_6041,em1_6100: bitstring));
                                            {6773}let m1_6101: bitstring = em1_6100 in
                                            {6774}let (=OpenSecureChannelRequest,=pkCli_6041,Nc_6102: bitstring) = m1_6101 in
                                            {6775}new Ns_6103: bitstring;
                                            {6776}new ST_6104: bitstring;
                                            {6777}new TTL_6105: bitstring;
                                            {6778}let m2_6106: bitstring = (OpenSecureChannelResponse,Ns_6103,ST_6104,TTL_6105) in
                                            {6779}out(c, m2_6106);
                                            {6780}let Ksrv_6107: bitstring = h((Ns_6103,Nc_6102)) in
                                            {6781}out(c, senc(mSrv(pkCli_6041,pkSess_5971),Ksrv_6107))
                                    )
                                    else
                                        {6782}let v_6108: bool = (Cli_5020 = C) in
                                        (
                                            {6783}if v_6108 then
                                            (
                                                {6784}let pkCli_6109: bitstring = pub(skC) in
                                                {6785}let v_6110: bool = (Disco_5021 = A) in
                                                (
                                                    {6786}if v_6110 then
                                                    (
                                                        {6787}let pkDisco_6111: bitstring = pub(skA) in
                                                        {6788}in(c, (=pkCli_6109,em1_6112: bitstring));
                                                        {6789}let m1_6113: bitstring = em1_6112 in
                                                        {6790}let (=OpenSecureChannelRequest,=pkCli_6109,Nc_6114: bitstring) = m1_6113 in
                                                        {6791}new Ns_6115: bitstring;
                                                        {6792}new ST_6116: bitstring;
                                                        {6793}new TTL_6117: bitstring;
                                                        {6794}let m2_6118: bitstring = (OpenSecureChannelResponse,Ns_6115,ST_6116,TTL_6117) in
                                                        {6795}out(c, m2_6118);
                                                        {6796}let Ksrv_6119: bitstring = h((Ns_6115,Nc_6114)) in
                                                        {6797}out(c, senc(mSrv(pkCli_6109,pkSess_5971),Ksrv_6119))
                                                    )
                                                    else
                                                        {6798}let v_6120: bool = (Disco_5021 = B) in
                                                        (
                                                            {6799}if v_6120 then
                                                            (
                                                                {6800}let pkDisco_6121: bitstring = pub(skB) in
                                                                {6801}in(c, (=pkCli_6109,em1_6122: bitstring));
                                                                {6802}let m1_6123: bitstring = em1_6122 in
                                                                {6803}let (=OpenSecureChannelRequest,=pkCli_6109,Nc_6124: bitstring) = m1_6123 in
                                                                {6804}new Ns_6125: bitstring;
                                                                {6805}new ST_6126: bitstring;
                                                                {6806}new TTL_6127: bitstring;
                                                                {6807}let m2_6128: bitstring = (OpenSecureChannelResponse,Ns_6125,ST_6126,TTL_6127) in
                                                                {6808}out(c, m2_6128);
                                                                {6809}let Ksrv_6129: bitstring = h((Ns_6125,Nc_6124)) in
                                                                {6810}out(c, senc(mSrv(pkCli_6109,pkSess_5971),Ksrv_6129))
                                                            )
                                                            else
                                                                {6811}let v_6130: bool = (Disco_5021 = C) in
                                                                (
                                                                    {6812}if v_6130 then
                                                                    (
                                                                        {6813}let pkDisco_6131: bitstring = pub(skC) in
                                                                        {6814}in(c, (=pkCli_6109,em1_6132: bitstring));
                                                                        {6815}let m1_6133: bitstring = em1_6132 in
                                                                        {6816}let (=OpenSecureChannelRequest,=pkCli_6109,Nc_6134: bitstring) = m1_6133 in
                                                                        {6817}new Ns_6135: bitstring;
                                                                        {6818}new ST_6136: bitstring;
                                                                        {6819}new TTL_6137: bitstring;
                                                                        {6820}let m2_6138: bitstring = (OpenSecureChannelResponse,Ns_6135,ST_6136,TTL_6137) in
                                                                        {6821}out(c, m2_6138);
                                                                        {6822}let Ksrv_6139: bitstring = h((Ns_6135,Nc_6134)) in
                                                                        {6823}out(c, senc(mSrv(pkCli_6109,pkSess_5971),Ksrv_6139))
                                                                    )
                                                                    else
                                                                        {6824}let pkDisco_6140: bitstring = pub(sk(Disco_5021)) in
                                                                        {6825}in(c, (=pkCli_6109,em1_6141: bitstring));
                                                                        {6826}let m1_6142: bitstring = em1_6141 in
                                                                        {6827}let (=OpenSecureChannelRequest,=pkCli_6109,Nc_6143: bitstring) = m1_6142 in
                                                                        {6828}new Ns_6144: bitstring;
                                                                        {6829}new ST_6145: bitstring;
                                                                        {6830}new TTL_6146: bitstring;
                                                                        {6831}let m2_6147: bitstring = (OpenSecureChannelResponse,Ns_6144,ST_6145,TTL_6146) in
                                                                        {6832}out(c, m2_6147);
                                                                        {6833}let Ksrv_6148: bitstring = h((Ns_6144,Nc_6143)) in
                                                                        {6834}out(c, senc(mSrv(pkCli_6109,pkSess_5971),Ksrv_6148))
                                                                )
                                                                else
                                                                    {6835}let pkDisco_6149: bitstring = fail-any in
                                                                    {6836}in(c, (=pkCli_6109,em1_6150: bitstring));
                                                                    {6837}let m1_6151: bitstring = em1_6150 in
                                                                    {6838}let (=OpenSecureChannelRequest,=pkCli_6109,Nc_6152: bitstring) = m1_6151 in
                                                                    {6839}new Ns_6153: bitstring;
                                                                    {6840}new ST_6154: bitstring;
                                                                    {6841}new TTL_6155: bitstring;
                                                                    {6842}let m2_6156: bitstring = (OpenSecureChannelResponse,Ns_6153,ST_6154,TTL_6155) in
                                                                    {6843}out(c, m2_6156);
                                                                    {6844}let Ksrv_6157: bitstring = h((Ns_6153,Nc_6152)) in
                                                                    {6845}out(c, senc(mSrv(pkCli_6109,pkSess_5971),Ksrv_6157))
                                                        )
                                                        else
                                                            {6846}let pkDisco_6158: bitstring = fail-any in
                                                            {6847}in(c, (=pkCli_6109,em1_6159: bitstring));
                                                            {6848}let m1_6160: bitstring = em1_6159 in
                                                            {6849}let (=OpenSecureChannelRequest,=pkCli_6109,Nc_6161: bitstring) = m1_6160 in
                                                            {6850}new Ns_6162: bitstring;
                                                            {6851}new ST_6163: bitstring;
                                                            {6852}new TTL_6164: bitstring;
                                                            {6853}let m2_6165: bitstring = (OpenSecureChannelResponse,Ns_6162,ST_6163,TTL_6164) in
                                                            {6854}out(c, m2_6165);
                                                            {6855}let Ksrv_6166: bitstring = h((Ns_6162,Nc_6161)) in
                                                            {6856}out(c, senc(mSrv(pkCli_6109,pkSess_5971),Ksrv_6166))
                                                )
                                                else
                                                    {6857}let pkDisco_6167: bitstring = fail-any in
                                                    {6858}in(c, (=pkCli_6109,em1_6168: bitstring));
                                                    {6859}let m1_6169: bitstring = em1_6168 in
                                                    {6860}let (=OpenSecureChannelRequest,=pkCli_6109,Nc_6170: bitstring) = m1_6169 in
                                                    {6861}new Ns_6171: bitstring;
                                                    {6862}new ST_6172: bitstring;
                                                    {6863}new TTL_6173: bitstring;
                                                    {6864}let m2_6174: bitstring = (OpenSecureChannelResponse,Ns_6171,ST_6172,TTL_6173) in
                                                    {6865}out(c, m2_6174);
                                                    {6866}let Ksrv_6175: bitstring = h((Ns_6171,Nc_6170)) in
                                                    {6867}out(c, senc(mSrv(pkCli_6109,pkSess_5971),Ksrv_6175))
                                            )
                                            else
                                                {6868}let pkCli_6176: bitstring = pub(sk(Cli_5020)) in
                                                {6869}let v_6177: bool = (Disco_5021 = A) in
                                                (
                                                    {6870}if v_6177 then
                                                    (
                                                        {6871}let pkDisco_6178: bitstring = pub(skA) in
                                                        {6872}in(c, (=pkCli_6176,em1_6179: bitstring));
                                                        {6873}let m1_6180: bitstring = em1_6179 in
                                                        {6874}let (=OpenSecureChannelRequest,=pkCli_6176,Nc_6181: bitstring) = m1_6180 in
                                                        {6875}new Ns_6182: bitstring;
                                                        {6876}new ST_6183: bitstring;
                                                        {6877}new TTL_6184: bitstring;
                                                        {6878}let m2_6185: bitstring = (OpenSecureChannelResponse,Ns_6182,ST_6183,TTL_6184) in
                                                        {6879}out(c, m2_6185);
                                                        {6880}let Ksrv_6186: bitstring = h((Ns_6182,Nc_6181)) in
                                                        {6881}out(c, senc(mSrv(pkCli_6176,pkSess_5971),Ksrv_6186))
                                                    )
                                                    else
                                                        {6882}let v_6187: bool = (Disco_5021 = B) in
                                                        (
                                                            {6883}if v_6187 then
                                                            (
                                                                {6884}let pkDisco_6188: bitstring = pub(skB) in
                                                                {6885}in(c, (=pkCli_6176,em1_6189: bitstring));
                                                                {6886}let m1_6190: bitstring = em1_6189 in
                                                                {6887}let (=OpenSecureChannelRequest,=pkCli_6176,Nc_6191: bitstring) = m1_6190 in
                                                                {6888}new Ns_6192: bitstring;
                                                                {6889}new ST_6193: bitstring;
                                                                {6890}new TTL_6194: bitstring;
                                                                {6891}let m2_6195: bitstring = (OpenSecureChannelResponse,Ns_6192,ST_6193,TTL_6194) in
                                                                {6892}out(c, m2_6195);
                                                                {6893}let Ksrv_6196: bitstring = h((Ns_6192,Nc_6191)) in
                                                                {6894}out(c, senc(mSrv(pkCli_6176,pkSess_5971),Ksrv_6196))
                                                            )
                                                            else
                                                                {6895}let v_6197: bool = (Disco_5021 = C) in
                                                                (
                                                                    {6896}if v_6197 then
                                                                    (
                                                                        {6897}let pkDisco_6198: bitstring = pub(skC) in
                                                                        {6898}in(c, (=pkCli_6176,em1_6199: bitstring));
                                                                        {6899}let m1_6200: bitstring = em1_6199 in
                                                                        {6900}let (=OpenSecureChannelRequest,=pkCli_6176,Nc_6201: bitstring) = m1_6200 in
                                                                        {6901}new Ns_6202: bitstring;
                                                                        {6902}new ST_6203: bitstring;
                                                                        {6903}new TTL_6204: bitstring;
                                                                        {6904}let m2_6205: bitstring = (OpenSecureChannelResponse,Ns_6202,ST_6203,TTL_6204) in
                                                                        {6905}out(c, m2_6205);
                                                                        {6906}let Ksrv_6206: bitstring = h((Ns_6202,Nc_6201)) in
                                                                        {6907}out(c, senc(mSrv(pkCli_6176,pkSess_5971),Ksrv_6206))
                                                                    )
                                                                    else
                                                                        {6908}let pkDisco_6207: bitstring = pub(sk(Disco_5021)) in
                                                                        {6909}in(c, (=pkCli_6176,em1_6208: bitstring));
                                                                        {6910}let m1_6209: bitstring = em1_6208 in
                                                                        {6911}let (=OpenSecureChannelRequest,=pkCli_6176,Nc_6210: bitstring) = m1_6209 in
                                                                        {6912}new Ns_6211: bitstring;
                                                                        {6913}new ST_6212: bitstring;
                                                                        {6914}new TTL_6213: bitstring;
                                                                        {6915}let m2_6214: bitstring = (OpenSecureChannelResponse,Ns_6211,ST_6212,TTL_6213) in
                                                                        {6916}out(c, m2_6214);
                                                                        {6917}let Ksrv_6215: bitstring = h((Ns_6211,Nc_6210)) in
                                                                        {6918}out(c, senc(mSrv(pkCli_6176,pkSess_5971),Ksrv_6215))
                                                                )
                                                                else
                                                                    {6919}let pkDisco_6216: bitstring = fail-any in
                                                                    {6920}in(c, (=pkCli_6176,em1_6217: bitstring));
                                                                    {6921}let m1_6218: bitstring = em1_6217 in
                                                                    {6922}let (=OpenSecureChannelRequest,=pkCli_6176,Nc_6219: bitstring) = m1_6218 in
                                                                    {6923}new Ns_6220: bitstring;
                                                                    {6924}new ST_6221: bitstring;
                                                                    {6925}new TTL_6222: bitstring;
                                                                    {6926}let m2_6223: bitstring = (OpenSecureChannelResponse,Ns_6220,ST_6221,TTL_6222) in
                                                                    {6927}out(c, m2_6223);
                                                                    {6928}let Ksrv_6224: bitstring = h((Ns_6220,Nc_6219)) in
                                                                    {6929}out(c, senc(mSrv(pkCli_6176,pkSess_5971),Ksrv_6224))
                                                        )
                                                        else
                                                            {6930}let pkDisco_6225: bitstring = fail-any in
                                                            {6931}in(c, (=pkCli_6176,em1_6226: bitstring));
                                                            {6932}let m1_6227: bitstring = em1_6226 in
                                                            {6933}let (=OpenSecureChannelRequest,=pkCli_6176,Nc_6228: bitstring) = m1_6227 in
                                                            {6934}new Ns_6229: bitstring;
                                                            {6935}new ST_6230: bitstring;
                                                            {6936}new TTL_6231: bitstring;
                                                            {6937}let m2_6232: bitstring = (OpenSecureChannelResponse,Ns_6229,ST_6230,TTL_6231) in
                                                            {6938}out(c, m2_6232);
                                                            {6939}let Ksrv_6233: bitstring = h((Ns_6229,Nc_6228)) in
                                                            {6940}out(c, senc(mSrv(pkCli_6176,pkSess_5971),Ksrv_6233))
                                                )
                                                else
                                                    {6941}let pkDisco_6234: bitstring = fail-any in
                                                    {6942}in(c, (=pkCli_6176,em1_6235: bitstring));
                                                    {6943}let m1_6236: bitstring = em1_6235 in
                                                    {6944}let (=OpenSecureChannelRequest,=pkCli_6176,Nc_6237: bitstring) = m1_6236 in
                                                    {6945}new Ns_6238: bitstring;
                                                    {6946}new ST_6239: bitstring;
                                                    {6947}new TTL_6240: bitstring;
                                                    {6948}let m2_6241: bitstring = (OpenSecureChannelResponse,Ns_6238,ST_6239,TTL_6240) in
                                                    {6949}out(c, m2_6241);
                                                    {6950}let Ksrv_6242: bitstring = h((Ns_6238,Nc_6237)) in
                                                    {6951}out(c, senc(mSrv(pkCli_6176,pkSess_5971),Ksrv_6242))
                                        )
                                        else
                                            {6952}let pkCli_6243: bitstring = fail-any in
                                            {6953}let v_6244: bool = (Disco_5021 = A) in
                                            (
                                                {6954}if v_6244 then
                                                (
                                                    {6955}let pkDisco_6245: bitstring = pub(skA) in
                                                    {6956}in(c, (=pkCli_6243,em1_6246: bitstring));
                                                    {6957}let m1_6247: bitstring = em1_6246 in
                                                    {6958}let (=OpenSecureChannelRequest,=pkCli_6243,Nc_6248: bitstring) = m1_6247 in
                                                    {6959}new Ns_6249: bitstring;
                                                    {6960}new ST_6250: bitstring;
                                                    {6961}new TTL_6251: bitstring;
                                                    {6962}let m2_6252: bitstring = (OpenSecureChannelResponse,Ns_6249,ST_6250,TTL_6251) in
                                                    {6963}out(c, m2_6252);
                                                    {6964}let Ksrv_6253: bitstring = h((Ns_6249,Nc_6248)) in
                                                    {6965}out(c, senc(mSrv(pkCli_6243,pkSess_5971),Ksrv_6253))
                                                )
                                                else
                                                    {6966}let v_6254: bool = (Disco_5021 = B) in
                                                    (
                                                        {6967}if v_6254 then
                                                        (
                                                            {6968}let pkDisco_6255: bitstring = pub(skB) in
                                                            {6969}in(c, (=pkCli_6243,em1_6256: bitstring));
                                                            {6970}let m1_6257: bitstring = em1_6256 in
                                                            {6971}let (=OpenSecureChannelRequest,=pkCli_6243,Nc_6258: bitstring) = m1_6257 in
                                                            {6972}new Ns_6259: bitstring;
                                                            {6973}new ST_6260: bitstring;
                                                            {6974}new TTL_6261: bitstring;
                                                            {6975}let m2_6262: bitstring = (OpenSecureChannelResponse,Ns_6259,ST_6260,TTL_6261) in
                                                            {6976}out(c, m2_6262);
                                                            {6977}let Ksrv_6263: bitstring = h((Ns_6259,Nc_6258)) in
                                                            {6978}out(c, senc(mSrv(pkCli_6243,pkSess_5971),Ksrv_6263))
                                                        )
                                                        else
                                                            {6979}let v_6264: bool = (Disco_5021 = C) in
                                                            (
                                                                {6980}if v_6264 then
                                                                (
                                                                    {6981}let pkDisco_6265: bitstring = pub(skC) in
                                                                    {6982}in(c, (=pkCli_6243,em1_6266: bitstring));
                                                                    {6983}let m1_6267: bitstring = em1_6266 in
                                                                    {6984}let (=OpenSecureChannelRequest,=pkCli_6243,Nc_6268: bitstring) = m1_6267 in
                                                                    {6985}new Ns_6269: bitstring;
                                                                    {6986}new ST_6270: bitstring;
                                                                    {6987}new TTL_6271: bitstring;
                                                                    {6988}let m2_6272: bitstring = (OpenSecureChannelResponse,Ns_6269,ST_6270,TTL_6271) in
                                                                    {6989}out(c, m2_6272);
                                                                    {6990}let Ksrv_6273: bitstring = h((Ns_6269,Nc_6268)) in
                                                                    {6991}out(c, senc(mSrv(pkCli_6243,pkSess_5971),Ksrv_6273))
                                                                )
                                                                else
                                                                    {6992}let pkDisco_6274: bitstring = pub(sk(Disco_5021)) in
                                                                    {6993}in(c, (=pkCli_6243,em1_6275: bitstring));
                                                                    {6994}let m1_6276: bitstring = em1_6275 in
                                                                    {6995}let (=OpenSecureChannelRequest,=pkCli_6243,Nc_6277: bitstring) = m1_6276 in
                                                                    {6996}new Ns_6278: bitstring;
                                                                    {6997}new ST_6279: bitstring;
                                                                    {6998}new TTL_6280: bitstring;
                                                                    {6999}let m2_6281: bitstring = (OpenSecureChannelResponse,Ns_6278,ST_6279,TTL_6280) in
                                                                    {7000}out(c, m2_6281);
                                                                    {7001}let Ksrv_6282: bitstring = h((Ns_6278,Nc_6277)) in
                                                                    {7002}out(c, senc(mSrv(pkCli_6243,pkSess_5971),Ksrv_6282))
                                                            )
                                                            else
                                                                {7003}let pkDisco_6283: bitstring = fail-any in
                                                                {7004}in(c, (=pkCli_6243,em1_6284: bitstring));
                                                                {7005}let m1_6285: bitstring = em1_6284 in
                                                                {7006}let (=OpenSecureChannelRequest,=pkCli_6243,Nc_6286: bitstring) = m1_6285 in
                                                                {7007}new Ns_6287: bitstring;
                                                                {7008}new ST_6288: bitstring;
                                                                {7009}new TTL_6289: bitstring;
                                                                {7010}let m2_6290: bitstring = (OpenSecureChannelResponse,Ns_6287,ST_6288,TTL_6289) in
                                                                {7011}out(c, m2_6290);
                                                                {7012}let Ksrv_6291: bitstring = h((Ns_6287,Nc_6286)) in
                                                                {7013}out(c, senc(mSrv(pkCli_6243,pkSess_5971),Ksrv_6291))
                                                    )
                                                    else
                                                        {7014}let pkDisco_6292: bitstring = fail-any in
                                                        {7015}in(c, (=pkCli_6243,em1_6293: bitstring));
                                                        {7016}let m1_6294: bitstring = em1_6293 in
                                                        {7017}let (=OpenSecureChannelRequest,=pkCli_6243,Nc_6295: bitstring) = m1_6294 in
                                                        {7018}new Ns_6296: bitstring;
                                                        {7019}new ST_6297: bitstring;
                                                        {7020}new TTL_6298: bitstring;
                                                        {7021}let m2_6299: bitstring = (OpenSecureChannelResponse,Ns_6296,ST_6297,TTL_6298) in
                                                        {7022}out(c, m2_6299);
                                                        {7023}let Ksrv_6300: bitstring = h((Ns_6296,Nc_6295)) in
                                                        {7024}out(c, senc(mSrv(pkCli_6243,pkSess_5971),Ksrv_6300))
                                            )
                                            else
                                                {7025}let pkDisco_6301: bitstring = fail-any in
                                                {7026}in(c, (=pkCli_6243,em1_6302: bitstring));
                                                {7027}let m1_6303: bitstring = em1_6302 in
                                                {7028}let (=OpenSecureChannelRequest,=pkCli_6243,Nc_6304: bitstring) = m1_6303 in
                                                {7029}new Ns_6305: bitstring;
                                                {7030}new ST_6306: bitstring;
                                                {7031}new TTL_6307: bitstring;
                                                {7032}let m2_6308: bitstring = (OpenSecureChannelResponse,Ns_6305,ST_6306,TTL_6307) in
                                                {7033}out(c, m2_6308);
                                                {7034}let Ksrv_6309: bitstring = h((Ns_6305,Nc_6304)) in
                                                {7035}out(c, senc(mSrv(pkCli_6243,pkSess_5971),Ksrv_6309))
                                )
                                else
                                    {7036}let pkCli_6310: bitstring = fail-any in
                                    {7037}let v_6311: bool = (Disco_5021 = A) in
                                    (
                                        {7038}if v_6311 then
                                        (
                                            {7039}let pkDisco_6312: bitstring = pub(skA) in
                                            {7040}in(c, (=pkCli_6310,em1_6313: bitstring));
                                            {7041}let m1_6314: bitstring = em1_6313 in
                                            {7042}let (=OpenSecureChannelRequest,=pkCli_6310,Nc_6315: bitstring) = m1_6314 in
                                            {7043}new Ns_6316: bitstring;
                                            {7044}new ST_6317: bitstring;
                                            {7045}new TTL_6318: bitstring;
                                            {7046}let m2_6319: bitstring = (OpenSecureChannelResponse,Ns_6316,ST_6317,TTL_6318) in
                                            {7047}out(c, m2_6319);
                                            {7048}let Ksrv_6320: bitstring = h((Ns_6316,Nc_6315)) in
                                            {7049}out(c, senc(mSrv(pkCli_6310,pkSess_5971),Ksrv_6320))
                                        )
                                        else
                                            {7050}let v_6321: bool = (Disco_5021 = B) in
                                            (
                                                {7051}if v_6321 then
                                                (
                                                    {7052}let pkDisco_6322: bitstring = pub(skB) in
                                                    {7053}in(c, (=pkCli_6310,em1_6323: bitstring));
                                                    {7054}let m1_6324: bitstring = em1_6323 in
                                                    {7055}let (=OpenSecureChannelRequest,=pkCli_6310,Nc_6325: bitstring) = m1_6324 in
                                                    {7056}new Ns_6326: bitstring;
                                                    {7057}new ST_6327: bitstring;
                                                    {7058}new TTL_6328: bitstring;
                                                    {7059}let m2_6329: bitstring = (OpenSecureChannelResponse,Ns_6326,ST_6327,TTL_6328) in
                                                    {7060}out(c, m2_6329);
                                                    {7061}let Ksrv_6330: bitstring = h((Ns_6326,Nc_6325)) in
                                                    {7062}out(c, senc(mSrv(pkCli_6310,pkSess_5971),Ksrv_6330))
                                                )
                                                else
                                                    {7063}let v_6331: bool = (Disco_5021 = C) in
                                                    (
                                                        {7064}if v_6331 then
                                                        (
                                                            {7065}let pkDisco_6332: bitstring = pub(skC) in
                                                            {7066}in(c, (=pkCli_6310,em1_6333: bitstring));
                                                            {7067}let m1_6334: bitstring = em1_6333 in
                                                            {7068}let (=OpenSecureChannelRequest,=pkCli_6310,Nc_6335: bitstring) = m1_6334 in
                                                            {7069}new Ns_6336: bitstring;
                                                            {7070}new ST_6337: bitstring;
                                                            {7071}new TTL_6338: bitstring;
                                                            {7072}let m2_6339: bitstring = (OpenSecureChannelResponse,Ns_6336,ST_6337,TTL_6338) in
                                                            {7073}out(c, m2_6339);
                                                            {7074}let Ksrv_6340: bitstring = h((Ns_6336,Nc_6335)) in
                                                            {7075}out(c, senc(mSrv(pkCli_6310,pkSess_5971),Ksrv_6340))
                                                        )
                                                        else
                                                            {7076}let pkDisco_6341: bitstring = pub(sk(Disco_5021)) in
                                                            {7077}in(c, (=pkCli_6310,em1_6342: bitstring));
                                                            {7078}let m1_6343: bitstring = em1_6342 in
                                                            {7079}let (=OpenSecureChannelRequest,=pkCli_6310,Nc_6344: bitstring) = m1_6343 in
                                                            {7080}new Ns_6345: bitstring;
                                                            {7081}new ST_6346: bitstring;
                                                            {7082}new TTL_6347: bitstring;
                                                            {7083}let m2_6348: bitstring = (OpenSecureChannelResponse,Ns_6345,ST_6346,TTL_6347) in
                                                            {7084}out(c, m2_6348);
                                                            {7085}let Ksrv_6349: bitstring = h((Ns_6345,Nc_6344)) in
                                                            {7086}out(c, senc(mSrv(pkCli_6310,pkSess_5971),Ksrv_6349))
                                                    )
                                                    else
                                                        {7087}let pkDisco_6350: bitstring = fail-any in
                                                        {7088}in(c, (=pkCli_6310,em1_6351: bitstring));
                                                        {7089}let m1_6352: bitstring = em1_6351 in
                                                        {7090}let (=OpenSecureChannelRequest,=pkCli_6310,Nc_6353: bitstring) = m1_6352 in
                                                        {7091}new Ns_6354: bitstring;
                                                        {7092}new ST_6355: bitstring;
                                                        {7093}new TTL_6356: bitstring;
                                                        {7094}let m2_6357: bitstring = (OpenSecureChannelResponse,Ns_6354,ST_6355,TTL_6356) in
                                                        {7095}out(c, m2_6357);
                                                        {7096}let Ksrv_6358: bitstring = h((Ns_6354,Nc_6353)) in
                                                        {7097}out(c, senc(mSrv(pkCli_6310,pkSess_5971),Ksrv_6358))
                                            )
                                            else
                                                {7098}let pkDisco_6359: bitstring = fail-any in
                                                {7099}in(c, (=pkCli_6310,em1_6360: bitstring));
                                                {7100}let m1_6361: bitstring = em1_6360 in
                                                {7101}let (=OpenSecureChannelRequest,=pkCli_6310,Nc_6362: bitstring) = m1_6361 in
                                                {7102}new Ns_6363: bitstring;
                                                {7103}new ST_6364: bitstring;
                                                {7104}new TTL_6365: bitstring;
                                                {7105}let m2_6366: bitstring = (OpenSecureChannelResponse,Ns_6363,ST_6364,TTL_6365) in
                                                {7106}out(c, m2_6366);
                                                {7107}let Ksrv_6367: bitstring = h((Ns_6363,Nc_6362)) in
                                                {7108}out(c, senc(mSrv(pkCli_6310,pkSess_5971),Ksrv_6367))
                                    )
                                    else
                                        {7109}let pkDisco_6368: bitstring = fail-any in
                                        {7110}in(c, (=pkCli_6310,em1_6369: bitstring));
                                        {7111}let m1_6370: bitstring = em1_6369 in
                                        {7112}let (=OpenSecureChannelRequest,=pkCli_6310,Nc_6371: bitstring) = m1_6370 in
                                        {7113}new Ns_6372: bitstring;
                                        {7114}new ST_6373: bitstring;
                                        {7115}new TTL_6374: bitstring;
                                        {7116}let m2_6375: bitstring = (OpenSecureChannelResponse,Ns_6372,ST_6373,TTL_6374) in
                                        {7117}out(c, m2_6375);
                                        {7118}let Ksrv_6376: bitstring = h((Ns_6372,Nc_6371)) in
                                        {7119}out(c, senc(mSrv(pkCli_6310,pkSess_5971),Ksrv_6376))
                        )
                        else
                            {7120}let pkCli_6377: bitstring = fail-any in
                            {7121}let v_6378: bool = (Disco_5021 = A) in
                            (
                                {7122}if v_6378 then
                                (
                                    {7123}let pkDisco_6379: bitstring = pub(skA) in
                                    {7124}in(c, (=pkCli_6377,em1_6380: bitstring));
                                    {7125}let m1_6381: bitstring = em1_6380 in
                                    {7126}let (=OpenSecureChannelRequest,=pkCli_6377,Nc_6382: bitstring) = m1_6381 in
                                    {7127}new Ns_6383: bitstring;
                                    {7128}new ST_6384: bitstring;
                                    {7129}new TTL_6385: bitstring;
                                    {7130}let m2_6386: bitstring = (OpenSecureChannelResponse,Ns_6383,ST_6384,TTL_6385) in
                                    {7131}out(c, m2_6386);
                                    {7132}let Ksrv_6387: bitstring = h((Ns_6383,Nc_6382)) in
                                    {7133}out(c, senc(mSrv(pkCli_6377,pkSess_5971),Ksrv_6387))
                                )
                                else
                                    {7134}let v_6388: bool = (Disco_5021 = B) in
                                    (
                                        {7135}if v_6388 then
                                        (
                                            {7136}let pkDisco_6389: bitstring = pub(skB) in
                                            {7137}in(c, (=pkCli_6377,em1_6390: bitstring));
                                            {7138}let m1_6391: bitstring = em1_6390 in
                                            {7139}let (=OpenSecureChannelRequest,=pkCli_6377,Nc_6392: bitstring) = m1_6391 in
                                            {7140}new Ns_6393: bitstring;
                                            {7141}new ST_6394: bitstring;
                                            {7142}new TTL_6395: bitstring;
                                            {7143}let m2_6396: bitstring = (OpenSecureChannelResponse,Ns_6393,ST_6394,TTL_6395) in
                                            {7144}out(c, m2_6396);
                                            {7145}let Ksrv_6397: bitstring = h((Ns_6393,Nc_6392)) in
                                            {7146}out(c, senc(mSrv(pkCli_6377,pkSess_5971),Ksrv_6397))
                                        )
                                        else
                                            {7147}let v_6398: bool = (Disco_5021 = C) in
                                            (
                                                {7148}if v_6398 then
                                                (
                                                    {7149}let pkDisco_6399: bitstring = pub(skC) in
                                                    {7150}in(c, (=pkCli_6377,em1_6400: bitstring));
                                                    {7151}let m1_6401: bitstring = em1_6400 in
                                                    {7152}let (=OpenSecureChannelRequest,=pkCli_6377,Nc_6402: bitstring) = m1_6401 in
                                                    {7153}new Ns_6403: bitstring;
                                                    {7154}new ST_6404: bitstring;
                                                    {7155}new TTL_6405: bitstring;
                                                    {7156}let m2_6406: bitstring = (OpenSecureChannelResponse,Ns_6403,ST_6404,TTL_6405) in
                                                    {7157}out(c, m2_6406);
                                                    {7158}let Ksrv_6407: bitstring = h((Ns_6403,Nc_6402)) in
                                                    {7159}out(c, senc(mSrv(pkCli_6377,pkSess_5971),Ksrv_6407))
                                                )
                                                else
                                                    {7160}let pkDisco_6408: bitstring = pub(sk(Disco_5021)) in
                                                    {7161}in(c, (=pkCli_6377,em1_6409: bitstring));
                                                    {7162}let m1_6410: bitstring = em1_6409 in
                                                    {7163}let (=OpenSecureChannelRequest,=pkCli_6377,Nc_6411: bitstring) = m1_6410 in
                                                    {7164}new Ns_6412: bitstring;
                                                    {7165}new ST_6413: bitstring;
                                                    {7166}new TTL_6414: bitstring;
                                                    {7167}let m2_6415: bitstring = (OpenSecureChannelResponse,Ns_6412,ST_6413,TTL_6414) in
                                                    {7168}out(c, m2_6415);
                                                    {7169}let Ksrv_6416: bitstring = h((Ns_6412,Nc_6411)) in
                                                    {7170}out(c, senc(mSrv(pkCli_6377,pkSess_5971),Ksrv_6416))
                                            )
                                            else
                                                {7171}let pkDisco_6417: bitstring = fail-any in
                                                {7172}in(c, (=pkCli_6377,em1_6418: bitstring));
                                                {7173}let m1_6419: bitstring = em1_6418 in
                                                {7174}let (=OpenSecureChannelRequest,=pkCli_6377,Nc_6420: bitstring) = m1_6419 in
                                                {7175}new Ns_6421: bitstring;
                                                {7176}new ST_6422: bitstring;
                                                {7177}new TTL_6423: bitstring;
                                                {7178}let m2_6424: bitstring = (OpenSecureChannelResponse,Ns_6421,ST_6422,TTL_6423) in
                                                {7179}out(c, m2_6424);
                                                {7180}let Ksrv_6425: bitstring = h((Ns_6421,Nc_6420)) in
                                                {7181}out(c, senc(mSrv(pkCli_6377,pkSess_5971),Ksrv_6425))
                                    )
                                    else
                                        {7182}let pkDisco_6426: bitstring = fail-any in
                                        {7183}in(c, (=pkCli_6377,em1_6427: bitstring));
                                        {7184}let m1_6428: bitstring = em1_6427 in
                                        {7185}let (=OpenSecureChannelRequest,=pkCli_6377,Nc_6429: bitstring) = m1_6428 in
                                        {7186}new Ns_6430: bitstring;
                                        {7187}new ST_6431: bitstring;
                                        {7188}new TTL_6432: bitstring;
                                        {7189}let m2_6433: bitstring = (OpenSecureChannelResponse,Ns_6430,ST_6431,TTL_6432) in
                                        {7190}out(c, m2_6433);
                                        {7191}let Ksrv_6434: bitstring = h((Ns_6430,Nc_6429)) in
                                        {7192}out(c, senc(mSrv(pkCli_6377,pkSess_5971),Ksrv_6434))
                            )
                            else
                                {7193}let pkDisco_6435: bitstring = fail-any in
                                {7194}in(c, (=pkCli_6377,em1_6436: bitstring));
                                {7195}let m1_6437: bitstring = em1_6436 in
                                {7196}let (=OpenSecureChannelRequest,=pkCli_6377,Nc_6438: bitstring) = m1_6437 in
                                {7197}new Ns_6439: bitstring;
                                {7198}new ST_6440: bitstring;
                                {7199}new TTL_6441: bitstring;
                                {7200}let m2_6442: bitstring = (OpenSecureChannelResponse,Ns_6439,ST_6440,TTL_6441) in
                                {7201}out(c, m2_6442);
                                {7202}let Ksrv_6443: bitstring = h((Ns_6439,Nc_6438)) in
                                {7203}out(c, senc(mSrv(pkCli_6377,pkSess_5971),Ksrv_6443))
                    )
                    else
                        {7204}let skSess_6444: bitstring = fail-any in
                        {7205}let pkSess_6445: bitstring = pub(skSess_6444) in
                        {7206}let v_6446: bool = (Cli_5020 = A) in
                        (
                            {7207}if v_6446 then
                            (
                                {7208}let pkCli_6447: bitstring = pub(skA) in
                                {7209}let v_6448: bool = (Disco_5021 = A) in
                                (
                                    {7210}if v_6448 then
                                    (
                                        {7211}let pkDisco_6449: bitstring = pub(skA) in
                                        {7212}in(c, (=pkCli_6447,em1_6450: bitstring));
                                        {7213}let m1_6451: bitstring = em1_6450 in
                                        {7214}let (=OpenSecureChannelRequest,=pkCli_6447,Nc_6452: bitstring) = m1_6451 in
                                        {7215}new Ns_6453: bitstring;
                                        {7216}new ST_6454: bitstring;
                                        {7217}new TTL_6455: bitstring;
                                        {7218}let m2_6456: bitstring = (OpenSecureChannelResponse,Ns_6453,ST_6454,TTL_6455) in
                                        {7219}out(c, m2_6456);
                                        {7220}let Ksrv_6457: bitstring = h((Ns_6453,Nc_6452)) in
                                        {7221}out(c, senc(mSrv(pkCli_6447,pkSess_6445),Ksrv_6457))
                                    )
                                    else
                                        {7222}let v_6458: bool = (Disco_5021 = B) in
                                        (
                                            {7223}if v_6458 then
                                            (
                                                {7224}let pkDisco_6459: bitstring = pub(skB) in
                                                {7225}in(c, (=pkCli_6447,em1_6460: bitstring));
                                                {7226}let m1_6461: bitstring = em1_6460 in
                                                {7227}let (=OpenSecureChannelRequest,=pkCli_6447,Nc_6462: bitstring) = m1_6461 in
                                                {7228}new Ns_6463: bitstring;
                                                {7229}new ST_6464: bitstring;
                                                {7230}new TTL_6465: bitstring;
                                                {7231}let m2_6466: bitstring = (OpenSecureChannelResponse,Ns_6463,ST_6464,TTL_6465) in
                                                {7232}out(c, m2_6466);
                                                {7233}let Ksrv_6467: bitstring = h((Ns_6463,Nc_6462)) in
                                                {7234}out(c, senc(mSrv(pkCli_6447,pkSess_6445),Ksrv_6467))
                                            )
                                            else
                                                {7235}let v_6468: bool = (Disco_5021 = C) in
                                                (
                                                    {7236}if v_6468 then
                                                    (
                                                        {7237}let pkDisco_6469: bitstring = pub(skC) in
                                                        {7238}in(c, (=pkCli_6447,em1_6470: bitstring));
                                                        {7239}let m1_6471: bitstring = em1_6470 in
                                                        {7240}let (=OpenSecureChannelRequest,=pkCli_6447,Nc_6472: bitstring) = m1_6471 in
                                                        {7241}new Ns_6473: bitstring;
                                                        {7242}new ST_6474: bitstring;
                                                        {7243}new TTL_6475: bitstring;
                                                        {7244}let m2_6476: bitstring = (OpenSecureChannelResponse,Ns_6473,ST_6474,TTL_6475) in
                                                        {7245}out(c, m2_6476);
                                                        {7246}let Ksrv_6477: bitstring = h((Ns_6473,Nc_6472)) in
                                                        {7247}out(c, senc(mSrv(pkCli_6447,pkSess_6445),Ksrv_6477))
                                                    )
                                                    else
                                                        {7248}let pkDisco_6478: bitstring = pub(sk(Disco_5021)) in
                                                        {7249}in(c, (=pkCli_6447,em1_6479: bitstring));
                                                        {7250}let m1_6480: bitstring = em1_6479 in
                                                        {7251}let (=OpenSecureChannelRequest,=pkCli_6447,Nc_6481: bitstring) = m1_6480 in
                                                        {7252}new Ns_6482: bitstring;
                                                        {7253}new ST_6483: bitstring;
                                                        {7254}new TTL_6484: bitstring;
                                                        {7255}let m2_6485: bitstring = (OpenSecureChannelResponse,Ns_6482,ST_6483,TTL_6484) in
                                                        {7256}out(c, m2_6485);
                                                        {7257}let Ksrv_6486: bitstring = h((Ns_6482,Nc_6481)) in
                                                        {7258}out(c, senc(mSrv(pkCli_6447,pkSess_6445),Ksrv_6486))
                                                )
                                                else
                                                    {7259}let pkDisco_6487: bitstring = fail-any in
                                                    {7260}in(c, (=pkCli_6447,em1_6488: bitstring));
                                                    {7261}let m1_6489: bitstring = em1_6488 in
                                                    {7262}let (=OpenSecureChannelRequest,=pkCli_6447,Nc_6490: bitstring) = m1_6489 in
                                                    {7263}new Ns_6491: bitstring;
                                                    {7264}new ST_6492: bitstring;
                                                    {7265}new TTL_6493: bitstring;
                                                    {7266}let m2_6494: bitstring = (OpenSecureChannelResponse,Ns_6491,ST_6492,TTL_6493) in
                                                    {7267}out(c, m2_6494);
                                                    {7268}let Ksrv_6495: bitstring = h((Ns_6491,Nc_6490)) in
                                                    {7269}out(c, senc(mSrv(pkCli_6447,pkSess_6445),Ksrv_6495))
                                        )
                                        else
                                            {7270}let pkDisco_6496: bitstring = fail-any in
                                            {7271}in(c, (=pkCli_6447,em1_6497: bitstring));
                                            {7272}let m1_6498: bitstring = em1_6497 in
                                            {7273}let (=OpenSecureChannelRequest,=pkCli_6447,Nc_6499: bitstring) = m1_6498 in
                                            {7274}new Ns_6500: bitstring;
                                            {7275}new ST_6501: bitstring;
                                            {7276}new TTL_6502: bitstring;
                                            {7277}let m2_6503: bitstring = (OpenSecureChannelResponse,Ns_6500,ST_6501,TTL_6502) in
                                            {7278}out(c, m2_6503);
                                            {7279}let Ksrv_6504: bitstring = h((Ns_6500,Nc_6499)) in
                                            {7280}out(c, senc(mSrv(pkCli_6447,pkSess_6445),Ksrv_6504))
                                )
                                else
                                    {7281}let pkDisco_6505: bitstring = fail-any in
                                    {7282}in(c, (=pkCli_6447,em1_6506: bitstring));
                                    {7283}let m1_6507: bitstring = em1_6506 in
                                    {7284}let (=OpenSecureChannelRequest,=pkCli_6447,Nc_6508: bitstring) = m1_6507 in
                                    {7285}new Ns_6509: bitstring;
                                    {7286}new ST_6510: bitstring;
                                    {7287}new TTL_6511: bitstring;
                                    {7288}let m2_6512: bitstring = (OpenSecureChannelResponse,Ns_6509,ST_6510,TTL_6511) in
                                    {7289}out(c, m2_6512);
                                    {7290}let Ksrv_6513: bitstring = h((Ns_6509,Nc_6508)) in
                                    {7291}out(c, senc(mSrv(pkCli_6447,pkSess_6445),Ksrv_6513))
                            )
                            else
                                {7292}let v_6514: bool = (Cli_5020 = B) in
                                (
                                    {7293}if v_6514 then
                                    (
                                        {7294}let pkCli_6515: bitstring = pub(skB) in
                                        {7295}let v_6516: bool = (Disco_5021 = A) in
                                        (
                                            {7296}if v_6516 then
                                            (
                                                {7297}let pkDisco_6517: bitstring = pub(skA) in
                                                {7298}in(c, (=pkCli_6515,em1_6518: bitstring));
                                                {7299}let m1_6519: bitstring = em1_6518 in
                                                {7300}let (=OpenSecureChannelRequest,=pkCli_6515,Nc_6520: bitstring) = m1_6519 in
                                                {7301}new Ns_6521: bitstring;
                                                {7302}new ST_6522: bitstring;
                                                {7303}new TTL_6523: bitstring;
                                                {7304}let m2_6524: bitstring = (OpenSecureChannelResponse,Ns_6521,ST_6522,TTL_6523) in
                                                {7305}out(c, m2_6524);
                                                {7306}let Ksrv_6525: bitstring = h((Ns_6521,Nc_6520)) in
                                                {7307}out(c, senc(mSrv(pkCli_6515,pkSess_6445),Ksrv_6525))
                                            )
                                            else
                                                {7308}let v_6526: bool = (Disco_5021 = B) in
                                                (
                                                    {7309}if v_6526 then
                                                    (
                                                        {7310}let pkDisco_6527: bitstring = pub(skB) in
                                                        {7311}in(c, (=pkCli_6515,em1_6528: bitstring));
                                                        {7312}let m1_6529: bitstring = em1_6528 in
                                                        {7313}let (=OpenSecureChannelRequest,=pkCli_6515,Nc_6530: bitstring) = m1_6529 in
                                                        {7314}new Ns_6531: bitstring;
                                                        {7315}new ST_6532: bitstring;
                                                        {7316}new TTL_6533: bitstring;
                                                        {7317}let m2_6534: bitstring = (OpenSecureChannelResponse,Ns_6531,ST_6532,TTL_6533) in
                                                        {7318}out(c, m2_6534);
                                                        {7319}let Ksrv_6535: bitstring = h((Ns_6531,Nc_6530)) in
                                                        {7320}out(c, senc(mSrv(pkCli_6515,pkSess_6445),Ksrv_6535))
                                                    )
                                                    else
                                                        {7321}let v_6536: bool = (Disco_5021 = C) in
                                                        (
                                                            {7322}if v_6536 then
                                                            (
                                                                {7323}let pkDisco_6537: bitstring = pub(skC) in
                                                                {7324}in(c, (=pkCli_6515,em1_6538: bitstring));
                                                                {7325}let m1_6539: bitstring = em1_6538 in
                                                                {7326}let (=OpenSecureChannelRequest,=pkCli_6515,Nc_6540: bitstring) = m1_6539 in
                                                                {7327}new Ns_6541: bitstring;
                                                                {7328}new ST_6542: bitstring;
                                                                {7329}new TTL_6543: bitstring;
                                                                {7330}let m2_6544: bitstring = (OpenSecureChannelResponse,Ns_6541,ST_6542,TTL_6543) in
                                                                {7331}out(c, m2_6544);
                                                                {7332}let Ksrv_6545: bitstring = h((Ns_6541,Nc_6540)) in
                                                                {7333}out(c, senc(mSrv(pkCli_6515,pkSess_6445),Ksrv_6545))
                                                            )
                                                            else
                                                                {7334}let pkDisco_6546: bitstring = pub(sk(Disco_5021)) in
                                                                {7335}in(c, (=pkCli_6515,em1_6547: bitstring));
                                                                {7336}let m1_6548: bitstring = em1_6547 in
                                                                {7337}let (=OpenSecureChannelRequest,=pkCli_6515,Nc_6549: bitstring) = m1_6548 in
                                                                {7338}new Ns_6550: bitstring;
                                                                {7339}new ST_6551: bitstring;
                                                                {7340}new TTL_6552: bitstring;
                                                                {7341}let m2_6553: bitstring = (OpenSecureChannelResponse,Ns_6550,ST_6551,TTL_6552) in
                                                                {7342}out(c, m2_6553);
                                                                {7343}let Ksrv_6554: bitstring = h((Ns_6550,Nc_6549)) in
                                                                {7344}out(c, senc(mSrv(pkCli_6515,pkSess_6445),Ksrv_6554))
                                                        )
                                                        else
                                                            {7345}let pkDisco_6555: bitstring = fail-any in
                                                            {7346}in(c, (=pkCli_6515,em1_6556: bitstring));
                                                            {7347}let m1_6557: bitstring = em1_6556 in
                                                            {7348}let (=OpenSecureChannelRequest,=pkCli_6515,Nc_6558: bitstring) = m1_6557 in
                                                            {7349}new Ns_6559: bitstring;
                                                            {7350}new ST_6560: bitstring;
                                                            {7351}new TTL_6561: bitstring;
                                                            {7352}let m2_6562: bitstring = (OpenSecureChannelResponse,Ns_6559,ST_6560,TTL_6561) in
                                                            {7353}out(c, m2_6562);
                                                            {7354}let Ksrv_6563: bitstring = h((Ns_6559,Nc_6558)) in
                                                            {7355}out(c, senc(mSrv(pkCli_6515,pkSess_6445),Ksrv_6563))
                                                )
                                                else
                                                    {7356}let pkDisco_6564: bitstring = fail-any in
                                                    {7357}in(c, (=pkCli_6515,em1_6565: bitstring));
                                                    {7358}let m1_6566: bitstring = em1_6565 in
                                                    {7359}let (=OpenSecureChannelRequest,=pkCli_6515,Nc_6567: bitstring) = m1_6566 in
                                                    {7360}new Ns_6568: bitstring;
                                                    {7361}new ST_6569: bitstring;
                                                    {7362}new TTL_6570: bitstring;
                                                    {7363}let m2_6571: bitstring = (OpenSecureChannelResponse,Ns_6568,ST_6569,TTL_6570) in
                                                    {7364}out(c, m2_6571);
                                                    {7365}let Ksrv_6572: bitstring = h((Ns_6568,Nc_6567)) in
                                                    {7366}out(c, senc(mSrv(pkCli_6515,pkSess_6445),Ksrv_6572))
                                        )
                                        else
                                            {7367}let pkDisco_6573: bitstring = fail-any in
                                            {7368}in(c, (=pkCli_6515,em1_6574: bitstring));
                                            {7369}let m1_6575: bitstring = em1_6574 in
                                            {7370}let (=OpenSecureChannelRequest,=pkCli_6515,Nc_6576: bitstring) = m1_6575 in
                                            {7371}new Ns_6577: bitstring;
                                            {7372}new ST_6578: bitstring;
                                            {7373}new TTL_6579: bitstring;
                                            {7374}let m2_6580: bitstring = (OpenSecureChannelResponse,Ns_6577,ST_6578,TTL_6579) in
                                            {7375}out(c, m2_6580);
                                            {7376}let Ksrv_6581: bitstring = h((Ns_6577,Nc_6576)) in
                                            {7377}out(c, senc(mSrv(pkCli_6515,pkSess_6445),Ksrv_6581))
                                    )
                                    else
                                        {7378}let v_6582: bool = (Cli_5020 = C) in
                                        (
                                            {7379}if v_6582 then
                                            (
                                                {7380}let pkCli_6583: bitstring = pub(skC) in
                                                {7381}let v_6584: bool = (Disco_5021 = A) in
                                                (
                                                    {7382}if v_6584 then
                                                    (
                                                        {7383}let pkDisco_6585: bitstring = pub(skA) in
                                                        {7384}in(c, (=pkCli_6583,em1_6586: bitstring));
                                                        {7385}let m1_6587: bitstring = em1_6586 in
                                                        {7386}let (=OpenSecureChannelRequest,=pkCli_6583,Nc_6588: bitstring) = m1_6587 in
                                                        {7387}new Ns_6589: bitstring;
                                                        {7388}new ST_6590: bitstring;
                                                        {7389}new TTL_6591: bitstring;
                                                        {7390}let m2_6592: bitstring = (OpenSecureChannelResponse,Ns_6589,ST_6590,TTL_6591) in
                                                        {7391}out(c, m2_6592);
                                                        {7392}let Ksrv_6593: bitstring = h((Ns_6589,Nc_6588)) in
                                                        {7393}out(c, senc(mSrv(pkCli_6583,pkSess_6445),Ksrv_6593))
                                                    )
                                                    else
                                                        {7394}let v_6594: bool = (Disco_5021 = B) in
                                                        (
                                                            {7395}if v_6594 then
                                                            (
                                                                {7396}let pkDisco_6595: bitstring = pub(skB) in
                                                                {7397}in(c, (=pkCli_6583,em1_6596: bitstring));
                                                                {7398}let m1_6597: bitstring = em1_6596 in
                                                                {7399}let (=OpenSecureChannelRequest,=pkCli_6583,Nc_6598: bitstring) = m1_6597 in
                                                                {7400}new Ns_6599: bitstring;
                                                                {7401}new ST_6600: bitstring;
                                                                {7402}new TTL_6601: bitstring;
                                                                {7403}let m2_6602: bitstring = (OpenSecureChannelResponse,Ns_6599,ST_6600,TTL_6601) in
                                                                {7404}out(c, m2_6602);
                                                                {7405}let Ksrv_6603: bitstring = h((Ns_6599,Nc_6598)) in
                                                                {7406}out(c, senc(mSrv(pkCli_6583,pkSess_6445),Ksrv_6603))
                                                            )
                                                            else
                                                                {7407}let v_6604: bool = (Disco_5021 = C) in
                                                                (
                                                                    {7408}if v_6604 then
                                                                    (
                                                                        {7409}let pkDisco_6605: bitstring = pub(skC) in
                                                                        {7410}in(c, (=pkCli_6583,em1_6606: bitstring));
                                                                        {7411}let m1_6607: bitstring = em1_6606 in
                                                                        {7412}let (=OpenSecureChannelRequest,=pkCli_6583,Nc_6608: bitstring) = m1_6607 in
                                                                        {7413}new Ns_6609: bitstring;
                                                                        {7414}new ST_6610: bitstring;
                                                                        {7415}new TTL_6611: bitstring;
                                                                        {7416}let m2_6612: bitstring = (OpenSecureChannelResponse,Ns_6609,ST_6610,TTL_6611) in
                                                                        {7417}out(c, m2_6612);
                                                                        {7418}let Ksrv_6613: bitstring = h((Ns_6609,Nc_6608)) in
                                                                        {7419}out(c, senc(mSrv(pkCli_6583,pkSess_6445),Ksrv_6613))
                                                                    )
                                                                    else
                                                                        {7420}let pkDisco_6614: bitstring = pub(sk(Disco_5021)) in
                                                                        {7421}in(c, (=pkCli_6583,em1_6615: bitstring));
                                                                        {7422}let m1_6616: bitstring = em1_6615 in
                                                                        {7423}let (=OpenSecureChannelRequest,=pkCli_6583,Nc_6617: bitstring) = m1_6616 in
                                                                        {7424}new Ns_6618: bitstring;
                                                                        {7425}new ST_6619: bitstring;
                                                                        {7426}new TTL_6620: bitstring;
                                                                        {7427}let m2_6621: bitstring = (OpenSecureChannelResponse,Ns_6618,ST_6619,TTL_6620) in
                                                                        {7428}out(c, m2_6621);
                                                                        {7429}let Ksrv_6622: bitstring = h((Ns_6618,Nc_6617)) in
                                                                        {7430}out(c, senc(mSrv(pkCli_6583,pkSess_6445),Ksrv_6622))
                                                                )
                                                                else
                                                                    {7431}let pkDisco_6623: bitstring = fail-any in
                                                                    {7432}in(c, (=pkCli_6583,em1_6624: bitstring));
                                                                    {7433}let m1_6625: bitstring = em1_6624 in
                                                                    {7434}let (=OpenSecureChannelRequest,=pkCli_6583,Nc_6626: bitstring) = m1_6625 in
                                                                    {7435}new Ns_6627: bitstring;
                                                                    {7436}new ST_6628: bitstring;
                                                                    {7437}new TTL_6629: bitstring;
                                                                    {7438}let m2_6630: bitstring = (OpenSecureChannelResponse,Ns_6627,ST_6628,TTL_6629) in
                                                                    {7439}out(c, m2_6630);
                                                                    {7440}let Ksrv_6631: bitstring = h((Ns_6627,Nc_6626)) in
                                                                    {7441}out(c, senc(mSrv(pkCli_6583,pkSess_6445),Ksrv_6631))
                                                        )
                                                        else
                                                            {7442}let pkDisco_6632: bitstring = fail-any in
                                                            {7443}in(c, (=pkCli_6583,em1_6633: bitstring));
                                                            {7444}let m1_6634: bitstring = em1_6633 in
                                                            {7445}let (=OpenSecureChannelRequest,=pkCli_6583,Nc_6635: bitstring) = m1_6634 in
                                                            {7446}new Ns_6636: bitstring;
                                                            {7447}new ST_6637: bitstring;
                                                            {7448}new TTL_6638: bitstring;
                                                            {7449}let m2_6639: bitstring = (OpenSecureChannelResponse,Ns_6636,ST_6637,TTL_6638) in
                                                            {7450}out(c, m2_6639);
                                                            {7451}let Ksrv_6640: bitstring = h((Ns_6636,Nc_6635)) in
                                                            {7452}out(c, senc(mSrv(pkCli_6583,pkSess_6445),Ksrv_6640))
                                                )
                                                else
                                                    {7453}let pkDisco_6641: bitstring = fail-any in
                                                    {7454}in(c, (=pkCli_6583,em1_6642: bitstring));
                                                    {7455}let m1_6643: bitstring = em1_6642 in
                                                    {7456}let (=OpenSecureChannelRequest,=pkCli_6583,Nc_6644: bitstring) = m1_6643 in
                                                    {7457}new Ns_6645: bitstring;
                                                    {7458}new ST_6646: bitstring;
                                                    {7459}new TTL_6647: bitstring;
                                                    {7460}let m2_6648: bitstring = (OpenSecureChannelResponse,Ns_6645,ST_6646,TTL_6647) in
                                                    {7461}out(c, m2_6648);
                                                    {7462}let Ksrv_6649: bitstring = h((Ns_6645,Nc_6644)) in
                                                    {7463}out(c, senc(mSrv(pkCli_6583,pkSess_6445),Ksrv_6649))
                                            )
                                            else
                                                {7464}let pkCli_6650: bitstring = pub(sk(Cli_5020)) in
                                                {7465}let v_6651: bool = (Disco_5021 = A) in
                                                (
                                                    {7466}if v_6651 then
                                                    (
                                                        {7467}let pkDisco_6652: bitstring = pub(skA) in
                                                        {7468}in(c, (=pkCli_6650,em1_6653: bitstring));
                                                        {7469}let m1_6654: bitstring = em1_6653 in
                                                        {7470}let (=OpenSecureChannelRequest,=pkCli_6650,Nc_6655: bitstring) = m1_6654 in
                                                        {7471}new Ns_6656: bitstring;
                                                        {7472}new ST_6657: bitstring;
                                                        {7473}new TTL_6658: bitstring;
                                                        {7474}let m2_6659: bitstring = (OpenSecureChannelResponse,Ns_6656,ST_6657,TTL_6658) in
                                                        {7475}out(c, m2_6659);
                                                        {7476}let Ksrv_6660: bitstring = h((Ns_6656,Nc_6655)) in
                                                        {7477}out(c, senc(mSrv(pkCli_6650,pkSess_6445),Ksrv_6660))
                                                    )
                                                    else
                                                        {7478}let v_6661: bool = (Disco_5021 = B) in
                                                        (
                                                            {7479}if v_6661 then
                                                            (
                                                                {7480}let pkDisco_6662: bitstring = pub(skB) in
                                                                {7481}in(c, (=pkCli_6650,em1_6663: bitstring));
                                                                {7482}let m1_6664: bitstring = em1_6663 in
                                                                {7483}let (=OpenSecureChannelRequest,=pkCli_6650,Nc_6665: bitstring) = m1_6664 in
                                                                {7484}new Ns_6666: bitstring;
                                                                {7485}new ST_6667: bitstring;
                                                                {7486}new TTL_6668: bitstring;
                                                                {7487}let m2_6669: bitstring = (OpenSecureChannelResponse,Ns_6666,ST_6667,TTL_6668) in
                                                                {7488}out(c, m2_6669);
                                                                {7489}let Ksrv_6670: bitstring = h((Ns_6666,Nc_6665)) in
                                                                {7490}out(c, senc(mSrv(pkCli_6650,pkSess_6445),Ksrv_6670))
                                                            )
                                                            else
                                                                {7491}let v_6671: bool = (Disco_5021 = C) in
                                                                (
                                                                    {7492}if v_6671 then
                                                                    (
                                                                        {7493}let pkDisco_6672: bitstring = pub(skC) in
                                                                        {7494}in(c, (=pkCli_6650,em1_6673: bitstring));
                                                                        {7495}let m1_6674: bitstring = em1_6673 in
                                                                        {7496}let (=OpenSecureChannelRequest,=pkCli_6650,Nc_6675: bitstring) = m1_6674 in
                                                                        {7497}new Ns_6676: bitstring;
                                                                        {7498}new ST_6677: bitstring;
                                                                        {7499}new TTL_6678: bitstring;
                                                                        {7500}let m2_6679: bitstring = (OpenSecureChannelResponse,Ns_6676,ST_6677,TTL_6678) in
                                                                        {7501}out(c, m2_6679);
                                                                        {7502}let Ksrv_6680: bitstring = h((Ns_6676,Nc_6675)) in
                                                                        {7503}out(c, senc(mSrv(pkCli_6650,pkSess_6445),Ksrv_6680))
                                                                    )
                                                                    else
                                                                        {7504}let pkDisco_6681: bitstring = pub(sk(Disco_5021)) in
                                                                        {7505}in(c, (=pkCli_6650,em1_6682: bitstring));
                                                                        {7506}let m1_6683: bitstring = em1_6682 in
                                                                        {7507}let (=OpenSecureChannelRequest,=pkCli_6650,Nc_6684: bitstring) = m1_6683 in
                                                                        {7508}new Ns_6685: bitstring;
                                                                        {7509}new ST_6686: bitstring;
                                                                        {7510}new TTL_6687: bitstring;
                                                                        {7511}let m2_6688: bitstring = (OpenSecureChannelResponse,Ns_6685,ST_6686,TTL_6687) in
                                                                        {7512}out(c, m2_6688);
                                                                        {7513}let Ksrv_6689: bitstring = h((Ns_6685,Nc_6684)) in
                                                                        {7514}out(c, senc(mSrv(pkCli_6650,pkSess_6445),Ksrv_6689))
                                                                )
                                                                else
                                                                    {7515}let pkDisco_6690: bitstring = fail-any in
                                                                    {7516}in(c, (=pkCli_6650,em1_6691: bitstring));
                                                                    {7517}let m1_6692: bitstring = em1_6691 in
                                                                    {7518}let (=OpenSecureChannelRequest,=pkCli_6650,Nc_6693: bitstring) = m1_6692 in
                                                                    {7519}new Ns_6694: bitstring;
                                                                    {7520}new ST_6695: bitstring;
                                                                    {7521}new TTL_6696: bitstring;
                                                                    {7522}let m2_6697: bitstring = (OpenSecureChannelResponse,Ns_6694,ST_6695,TTL_6696) in
                                                                    {7523}out(c, m2_6697);
                                                                    {7524}let Ksrv_6698: bitstring = h((Ns_6694,Nc_6693)) in
                                                                    {7525}out(c, senc(mSrv(pkCli_6650,pkSess_6445),Ksrv_6698))
                                                        )
                                                        else
                                                            {7526}let pkDisco_6699: bitstring = fail-any in
                                                            {7527}in(c, (=pkCli_6650,em1_6700: bitstring));
                                                            {7528}let m1_6701: bitstring = em1_6700 in
                                                            {7529}let (=OpenSecureChannelRequest,=pkCli_6650,Nc_6702: bitstring) = m1_6701 in
                                                            {7530}new Ns_6703: bitstring;
                                                            {7531}new ST_6704: bitstring;
                                                            {7532}new TTL_6705: bitstring;
                                                            {7533}let m2_6706: bitstring = (OpenSecureChannelResponse,Ns_6703,ST_6704,TTL_6705) in
                                                            {7534}out(c, m2_6706);
                                                            {7535}let Ksrv_6707: bitstring = h((Ns_6703,Nc_6702)) in
                                                            {7536}out(c, senc(mSrv(pkCli_6650,pkSess_6445),Ksrv_6707))
                                                )
                                                else
                                                    {7537}let pkDisco_6708: bitstring = fail-any in
                                                    {7538}in(c, (=pkCli_6650,em1_6709: bitstring));
                                                    {7539}let m1_6710: bitstring = em1_6709 in
                                                    {7540}let (=OpenSecureChannelRequest,=pkCli_6650,Nc_6711: bitstring) = m1_6710 in
                                                    {7541}new Ns_6712: bitstring;
                                                    {7542}new ST_6713: bitstring;
                                                    {7543}new TTL_6714: bitstring;
                                                    {7544}let m2_6715: bitstring = (OpenSecureChannelResponse,Ns_6712,ST_6713,TTL_6714) in
                                                    {7545}out(c, m2_6715);
                                                    {7546}let Ksrv_6716: bitstring = h((Ns_6712,Nc_6711)) in
                                                    {7547}out(c, senc(mSrv(pkCli_6650,pkSess_6445),Ksrv_6716))
                                        )
                                        else
                                            {7548}let pkCli_6717: bitstring = fail-any in
                                            {7549}let v_6718: bool = (Disco_5021 = A) in
                                            (
                                                {7550}if v_6718 then
                                                (
                                                    {7551}let pkDisco_6719: bitstring = pub(skA) in
                                                    {7552}in(c, (=pkCli_6717,em1_6720: bitstring));
                                                    {7553}let m1_6721: bitstring = em1_6720 in
                                                    {7554}let (=OpenSecureChannelRequest,=pkCli_6717,Nc_6722: bitstring) = m1_6721 in
                                                    {7555}new Ns_6723: bitstring;
                                                    {7556}new ST_6724: bitstring;
                                                    {7557}new TTL_6725: bitstring;
                                                    {7558}let m2_6726: bitstring = (OpenSecureChannelResponse,Ns_6723,ST_6724,TTL_6725) in
                                                    {7559}out(c, m2_6726);
                                                    {7560}let Ksrv_6727: bitstring = h((Ns_6723,Nc_6722)) in
                                                    {7561}out(c, senc(mSrv(pkCli_6717,pkSess_6445),Ksrv_6727))
                                                )
                                                else
                                                    {7562}let v_6728: bool = (Disco_5021 = B) in
                                                    (
                                                        {7563}if v_6728 then
                                                        (
                                                            {7564}let pkDisco_6729: bitstring = pub(skB) in
                                                            {7565}in(c, (=pkCli_6717,em1_6730: bitstring));
                                                            {7566}let m1_6731: bitstring = em1_6730 in
                                                            {7567}let (=OpenSecureChannelRequest,=pkCli_6717,Nc_6732: bitstring) = m1_6731 in
                                                            {7568}new Ns_6733: bitstring;
                                                            {7569}new ST_6734: bitstring;
                                                            {7570}new TTL_6735: bitstring;
                                                            {7571}let m2_6736: bitstring = (OpenSecureChannelResponse,Ns_6733,ST_6734,TTL_6735) in
                                                            {7572}out(c, m2_6736);
                                                            {7573}let Ksrv_6737: bitstring = h((Ns_6733,Nc_6732)) in
                                                            {7574}out(c, senc(mSrv(pkCli_6717,pkSess_6445),Ksrv_6737))
                                                        )
                                                        else
                                                            {7575}let v_6738: bool = (Disco_5021 = C) in
                                                            (
                                                                {7576}if v_6738 then
                                                                (
                                                                    {7577}let pkDisco_6739: bitstring = pub(skC) in
                                                                    {7578}in(c, (=pkCli_6717,em1_6740: bitstring));
                                                                    {7579}let m1_6741: bitstring = em1_6740 in
                                                                    {7580}let (=OpenSecureChannelRequest,=pkCli_6717,Nc_6742: bitstring) = m1_6741 in
                                                                    {7581}new Ns_6743: bitstring;
                                                                    {7582}new ST_6744: bitstring;
                                                                    {7583}new TTL_6745: bitstring;
                                                                    {7584}let m2_6746: bitstring = (OpenSecureChannelResponse,Ns_6743,ST_6744,TTL_6745) in
                                                                    {7585}out(c, m2_6746);
                                                                    {7586}let Ksrv_6747: bitstring = h((Ns_6743,Nc_6742)) in
                                                                    {7587}out(c, senc(mSrv(pkCli_6717,pkSess_6445),Ksrv_6747))
                                                                )
                                                                else
                                                                    {7588}let pkDisco_6748: bitstring = pub(sk(Disco_5021)) in
                                                                    {7589}in(c, (=pkCli_6717,em1_6749: bitstring));
                                                                    {7590}let m1_6750: bitstring = em1_6749 in
                                                                    {7591}let (=OpenSecureChannelRequest,=pkCli_6717,Nc_6751: bitstring) = m1_6750 in
                                                                    {7592}new Ns_6752: bitstring;
                                                                    {7593}new ST_6753: bitstring;
                                                                    {7594}new TTL_6754: bitstring;
                                                                    {7595}let m2_6755: bitstring = (OpenSecureChannelResponse,Ns_6752,ST_6753,TTL_6754) in
                                                                    {7596}out(c, m2_6755);
                                                                    {7597}let Ksrv_6756: bitstring = h((Ns_6752,Nc_6751)) in
                                                                    {7598}out(c, senc(mSrv(pkCli_6717,pkSess_6445),Ksrv_6756))
                                                            )
                                                            else
                                                                {7599}let pkDisco_6757: bitstring = fail-any in
                                                                {7600}in(c, (=pkCli_6717,em1_6758: bitstring));
                                                                {7601}let m1_6759: bitstring = em1_6758 in
                                                                {7602}let (=OpenSecureChannelRequest,=pkCli_6717,Nc_6760: bitstring) = m1_6759 in
                                                                {7603}new Ns_6761: bitstring;
                                                                {7604}new ST_6762: bitstring;
                                                                {7605}new TTL_6763: bitstring;
                                                                {7606}let m2_6764: bitstring = (OpenSecureChannelResponse,Ns_6761,ST_6762,TTL_6763) in
                                                                {7607}out(c, m2_6764);
                                                                {7608}let Ksrv_6765: bitstring = h((Ns_6761,Nc_6760)) in
                                                                {7609}out(c, senc(mSrv(pkCli_6717,pkSess_6445),Ksrv_6765))
                                                    )
                                                    else
                                                        {7610}let pkDisco_6766: bitstring = fail-any in
                                                        {7611}in(c, (=pkCli_6717,em1_6767: bitstring));
                                                        {7612}let m1_6768: bitstring = em1_6767 in
                                                        {7613}let (=OpenSecureChannelRequest,=pkCli_6717,Nc_6769: bitstring) = m1_6768 in
                                                        {7614}new Ns_6770: bitstring;
                                                        {7615}new ST_6771: bitstring;
                                                        {7616}new TTL_6772: bitstring;
                                                        {7617}let m2_6773: bitstring = (OpenSecureChannelResponse,Ns_6770,ST_6771,TTL_6772) in
                                                        {7618}out(c, m2_6773);
                                                        {7619}let Ksrv_6774: bitstring = h((Ns_6770,Nc_6769)) in
                                                        {7620}out(c, senc(mSrv(pkCli_6717,pkSess_6445),Ksrv_6774))
                                            )
                                            else
                                                {7621}let pkDisco_6775: bitstring = fail-any in
                                                {7622}in(c, (=pkCli_6717,em1_6776: bitstring));
                                                {7623}let m1_6777: bitstring = em1_6776 in
                                                {7624}let (=OpenSecureChannelRequest,=pkCli_6717,Nc_6778: bitstring) = m1_6777 in
                                                {7625}new Ns_6779: bitstring;
                                                {7626}new ST_6780: bitstring;
                                                {7627}new TTL_6781: bitstring;
                                                {7628}let m2_6782: bitstring = (OpenSecureChannelResponse,Ns_6779,ST_6780,TTL_6781) in
                                                {7629}out(c, m2_6782);
                                                {7630}let Ksrv_6783: bitstring = h((Ns_6779,Nc_6778)) in
                                                {7631}out(c, senc(mSrv(pkCli_6717,pkSess_6445),Ksrv_6783))
                                )
                                else
                                    {7632}let pkCli_6784: bitstring = fail-any in
                                    {7633}let v_6785: bool = (Disco_5021 = A) in
                                    (
                                        {7634}if v_6785 then
                                        (
                                            {7635}let pkDisco_6786: bitstring = pub(skA) in
                                            {7636}in(c, (=pkCli_6784,em1_6787: bitstring));
                                            {7637}let m1_6788: bitstring = em1_6787 in
                                            {7638}let (=OpenSecureChannelRequest,=pkCli_6784,Nc_6789: bitstring) = m1_6788 in
                                            {7639}new Ns_6790: bitstring;
                                            {7640}new ST_6791: bitstring;
                                            {7641}new TTL_6792: bitstring;
                                            {7642}let m2_6793: bitstring = (OpenSecureChannelResponse,Ns_6790,ST_6791,TTL_6792) in
                                            {7643}out(c, m2_6793);
                                            {7644}let Ksrv_6794: bitstring = h((Ns_6790,Nc_6789)) in
                                            {7645}out(c, senc(mSrv(pkCli_6784,pkSess_6445),Ksrv_6794))
                                        )
                                        else
                                            {7646}let v_6795: bool = (Disco_5021 = B) in
                                            (
                                                {7647}if v_6795 then
                                                (
                                                    {7648}let pkDisco_6796: bitstring = pub(skB) in
                                                    {7649}in(c, (=pkCli_6784,em1_6797: bitstring));
                                                    {7650}let m1_6798: bitstring = em1_6797 in
                                                    {7651}let (=OpenSecureChannelRequest,=pkCli_6784,Nc_6799: bitstring) = m1_6798 in
                                                    {7652}new Ns_6800: bitstring;
                                                    {7653}new ST_6801: bitstring;
                                                    {7654}new TTL_6802: bitstring;
                                                    {7655}let m2_6803: bitstring = (OpenSecureChannelResponse,Ns_6800,ST_6801,TTL_6802) in
                                                    {7656}out(c, m2_6803);
                                                    {7657}let Ksrv_6804: bitstring = h((Ns_6800,Nc_6799)) in
                                                    {7658}out(c, senc(mSrv(pkCli_6784,pkSess_6445),Ksrv_6804))
                                                )
                                                else
                                                    {7659}let v_6805: bool = (Disco_5021 = C) in
                                                    (
                                                        {7660}if v_6805 then
                                                        (
                                                            {7661}let pkDisco_6806: bitstring = pub(skC) in
                                                            {7662}in(c, (=pkCli_6784,em1_6807: bitstring));
                                                            {7663}let m1_6808: bitstring = em1_6807 in
                                                            {7664}let (=OpenSecureChannelRequest,=pkCli_6784,Nc_6809: bitstring) = m1_6808 in
                                                            {7665}new Ns_6810: bitstring;
                                                            {7666}new ST_6811: bitstring;
                                                            {7667}new TTL_6812: bitstring;
                                                            {7668}let m2_6813: bitstring = (OpenSecureChannelResponse,Ns_6810,ST_6811,TTL_6812) in
                                                            {7669}out(c, m2_6813);
                                                            {7670}let Ksrv_6814: bitstring = h((Ns_6810,Nc_6809)) in
                                                            {7671}out(c, senc(mSrv(pkCli_6784,pkSess_6445),Ksrv_6814))
                                                        )
                                                        else
                                                            {7672}let pkDisco_6815: bitstring = pub(sk(Disco_5021)) in
                                                            {7673}in(c, (=pkCli_6784,em1_6816: bitstring));
                                                            {7674}let m1_6817: bitstring = em1_6816 in
                                                            {7675}let (=OpenSecureChannelRequest,=pkCli_6784,Nc_6818: bitstring) = m1_6817 in
                                                            {7676}new Ns_6819: bitstring;
                                                            {7677}new ST_6820: bitstring;
                                                            {7678}new TTL_6821: bitstring;
                                                            {7679}let m2_6822: bitstring = (OpenSecureChannelResponse,Ns_6819,ST_6820,TTL_6821) in
                                                            {7680}out(c, m2_6822);
                                                            {7681}let Ksrv_6823: bitstring = h((Ns_6819,Nc_6818)) in
                                                            {7682}out(c, senc(mSrv(pkCli_6784,pkSess_6445),Ksrv_6823))
                                                    )
                                                    else
                                                        {7683}let pkDisco_6824: bitstring = fail-any in
                                                        {7684}in(c, (=pkCli_6784,em1_6825: bitstring));
                                                        {7685}let m1_6826: bitstring = em1_6825 in
                                                        {7686}let (=OpenSecureChannelRequest,=pkCli_6784,Nc_6827: bitstring) = m1_6826 in
                                                        {7687}new Ns_6828: bitstring;
                                                        {7688}new ST_6829: bitstring;
                                                        {7689}new TTL_6830: bitstring;
                                                        {7690}let m2_6831: bitstring = (OpenSecureChannelResponse,Ns_6828,ST_6829,TTL_6830) in
                                                        {7691}out(c, m2_6831);
                                                        {7692}let Ksrv_6832: bitstring = h((Ns_6828,Nc_6827)) in
                                                        {7693}out(c, senc(mSrv(pkCli_6784,pkSess_6445),Ksrv_6832))
                                            )
                                            else
                                                {7694}let pkDisco_6833: bitstring = fail-any in
                                                {7695}in(c, (=pkCli_6784,em1_6834: bitstring));
                                                {7696}let m1_6835: bitstring = em1_6834 in
                                                {7697}let (=OpenSecureChannelRequest,=pkCli_6784,Nc_6836: bitstring) = m1_6835 in
                                                {7698}new Ns_6837: bitstring;
                                                {7699}new ST_6838: bitstring;
                                                {7700}new TTL_6839: bitstring;
                                                {7701}let m2_6840: bitstring = (OpenSecureChannelResponse,Ns_6837,ST_6838,TTL_6839) in
                                                {7702}out(c, m2_6840);
                                                {7703}let Ksrv_6841: bitstring = h((Ns_6837,Nc_6836)) in
                                                {7704}out(c, senc(mSrv(pkCli_6784,pkSess_6445),Ksrv_6841))
                                    )
                                    else
                                        {7705}let pkDisco_6842: bitstring = fail-any in
                                        {7706}in(c, (=pkCli_6784,em1_6843: bitstring));
                                        {7707}let m1_6844: bitstring = em1_6843 in
                                        {7708}let (=OpenSecureChannelRequest,=pkCli_6784,Nc_6845: bitstring) = m1_6844 in
                                        {7709}new Ns_6846: bitstring;
                                        {7710}new ST_6847: bitstring;
                                        {7711}new TTL_6848: bitstring;
                                        {7712}let m2_6849: bitstring = (OpenSecureChannelResponse,Ns_6846,ST_6847,TTL_6848) in
                                        {7713}out(c, m2_6849);
                                        {7714}let Ksrv_6850: bitstring = h((Ns_6846,Nc_6845)) in
                                        {7715}out(c, senc(mSrv(pkCli_6784,pkSess_6445),Ksrv_6850))
                        )
                        else
                            {7716}let pkCli_6851: bitstring = fail-any in
                            {7717}let v_6852: bool = (Disco_5021 = A) in
                            (
                                {7718}if v_6852 then
                                (
                                    {7719}let pkDisco_6853: bitstring = pub(skA) in
                                    {7720}in(c, (=pkCli_6851,em1_6854: bitstring));
                                    {7721}let m1_6855: bitstring = em1_6854 in
                                    {7722}let (=OpenSecureChannelRequest,=pkCli_6851,Nc_6856: bitstring) = m1_6855 in
                                    {7723}new Ns_6857: bitstring;
                                    {7724}new ST_6858: bitstring;
                                    {7725}new TTL_6859: bitstring;
                                    {7726}let m2_6860: bitstring = (OpenSecureChannelResponse,Ns_6857,ST_6858,TTL_6859) in
                                    {7727}out(c, m2_6860);
                                    {7728}let Ksrv_6861: bitstring = h((Ns_6857,Nc_6856)) in
                                    {7729}out(c, senc(mSrv(pkCli_6851,pkSess_6445),Ksrv_6861))
                                )
                                else
                                    {7730}let v_6862: bool = (Disco_5021 = B) in
                                    (
                                        {7731}if v_6862 then
                                        (
                                            {7732}let pkDisco_6863: bitstring = pub(skB) in
                                            {7733}in(c, (=pkCli_6851,em1_6864: bitstring));
                                            {7734}let m1_6865: bitstring = em1_6864 in
                                            {7735}let (=OpenSecureChannelRequest,=pkCli_6851,Nc_6866: bitstring) = m1_6865 in
                                            {7736}new Ns_6867: bitstring;
                                            {7737}new ST_6868: bitstring;
                                            {7738}new TTL_6869: bitstring;
                                            {7739}let m2_6870: bitstring = (OpenSecureChannelResponse,Ns_6867,ST_6868,TTL_6869) in
                                            {7740}out(c, m2_6870);
                                            {7741}let Ksrv_6871: bitstring = h((Ns_6867,Nc_6866)) in
                                            {7742}out(c, senc(mSrv(pkCli_6851,pkSess_6445),Ksrv_6871))
                                        )
                                        else
                                            {7743}let v_6872: bool = (Disco_5021 = C) in
                                            (
                                                {7744}if v_6872 then
                                                (
                                                    {7745}let pkDisco_6873: bitstring = pub(skC) in
                                                    {7746}in(c, (=pkCli_6851,em1_6874: bitstring));
                                                    {7747}let m1_6875: bitstring = em1_6874 in
                                                    {7748}let (=OpenSecureChannelRequest,=pkCli_6851,Nc_6876: bitstring) = m1_6875 in
                                                    {7749}new Ns_6877: bitstring;
                                                    {7750}new ST_6878: bitstring;
                                                    {7751}new TTL_6879: bitstring;
                                                    {7752}let m2_6880: bitstring = (OpenSecureChannelResponse,Ns_6877,ST_6878,TTL_6879) in
                                                    {7753}out(c, m2_6880);
                                                    {7754}let Ksrv_6881: bitstring = h((Ns_6877,Nc_6876)) in
                                                    {7755}out(c, senc(mSrv(pkCli_6851,pkSess_6445),Ksrv_6881))
                                                )
                                                else
                                                    {7756}let pkDisco_6882: bitstring = pub(sk(Disco_5021)) in
                                                    {7757}in(c, (=pkCli_6851,em1_6883: bitstring));
                                                    {7758}let m1_6884: bitstring = em1_6883 in
                                                    {7759}let (=OpenSecureChannelRequest,=pkCli_6851,Nc_6885: bitstring) = m1_6884 in
                                                    {7760}new Ns_6886: bitstring;
                                                    {7761}new ST_6887: bitstring;
                                                    {7762}new TTL_6888: bitstring;
                                                    {7763}let m2_6889: bitstring = (OpenSecureChannelResponse,Ns_6886,ST_6887,TTL_6888) in
                                                    {7764}out(c, m2_6889);
                                                    {7765}let Ksrv_6890: bitstring = h((Ns_6886,Nc_6885)) in
                                                    {7766}out(c, senc(mSrv(pkCli_6851,pkSess_6445),Ksrv_6890))
                                            )
                                            else
                                                {7767}let pkDisco_6891: bitstring = fail-any in
                                                {7768}in(c, (=pkCli_6851,em1_6892: bitstring));
                                                {7769}let m1_6893: bitstring = em1_6892 in
                                                {7770}let (=OpenSecureChannelRequest,=pkCli_6851,Nc_6894: bitstring) = m1_6893 in
                                                {7771}new Ns_6895: bitstring;
                                                {7772}new ST_6896: bitstring;
                                                {7773}new TTL_6897: bitstring;
                                                {7774}let m2_6898: bitstring = (OpenSecureChannelResponse,Ns_6895,ST_6896,TTL_6897) in
                                                {7775}out(c, m2_6898);
                                                {7776}let Ksrv_6899: bitstring = h((Ns_6895,Nc_6894)) in
                                                {7777}out(c, senc(mSrv(pkCli_6851,pkSess_6445),Ksrv_6899))
                                    )
                                    else
                                        {7778}let pkDisco_6900: bitstring = fail-any in
                                        {7779}in(c, (=pkCli_6851,em1_6901: bitstring));
                                        {7780}let m1_6902: bitstring = em1_6901 in
                                        {7781}let (=OpenSecureChannelRequest,=pkCli_6851,Nc_6903: bitstring) = m1_6902 in
                                        {7782}new Ns_6904: bitstring;
                                        {7783}new ST_6905: bitstring;
                                        {7784}new TTL_6906: bitstring;
                                        {7785}let m2_6907: bitstring = (OpenSecureChannelResponse,Ns_6904,ST_6905,TTL_6906) in
                                        {7786}out(c, m2_6907);
                                        {7787}let Ksrv_6908: bitstring = h((Ns_6904,Nc_6903)) in
                                        {7788}out(c, senc(mSrv(pkCli_6851,pkSess_6445),Ksrv_6908))
                            )
                            else
                                {7789}let pkDisco_6909: bitstring = fail-any in
                                {7790}in(c, (=pkCli_6851,em1_6910: bitstring));
                                {7791}let m1_6911: bitstring = em1_6910 in
                                {7792}let (=OpenSecureChannelRequest,=pkCli_6851,Nc_6912: bitstring) = m1_6911 in
                                {7793}new Ns_6913: bitstring;
                                {7794}new ST_6914: bitstring;
                                {7795}new TTL_6915: bitstring;
                                {7796}let m2_6916: bitstring = (OpenSecureChannelResponse,Ns_6913,ST_6914,TTL_6915) in
                                {7797}out(c, m2_6916);
                                {7798}let Ksrv_6917: bitstring = h((Ns_6913,Nc_6912)) in
                                {7799}out(c, senc(mSrv(pkCli_6851,pkSess_6445),Ksrv_6917))
            )
            else
                {7800}let skSess_6918: bitstring = fail-any in
                {7801}let pkSess_6919: bitstring = pub(skSess_6918) in
                {7802}let v_6920: bool = (Cli_5020 = A) in
                (
                    {7803}if v_6920 then
                    (
                        {7804}let pkCli_6921: bitstring = pub(skA) in
                        {7805}let v_6922: bool = (Disco_5021 = A) in
                        (
                            {7806}if v_6922 then
                            (
                                {7807}let pkDisco_6923: bitstring = pub(skA) in
                                {7808}in(c, (=pkCli_6921,em1_6924: bitstring));
                                {7809}let m1_6925: bitstring = em1_6924 in
                                {7810}let (=OpenSecureChannelRequest,=pkCli_6921,Nc_6926: bitstring) = m1_6925 in
                                {7811}new Ns_6927: bitstring;
                                {7812}new ST_6928: bitstring;
                                {7813}new TTL_6929: bitstring;
                                {7814}let m2_6930: bitstring = (OpenSecureChannelResponse,Ns_6927,ST_6928,TTL_6929) in
                                {7815}out(c, m2_6930);
                                {7816}let Ksrv_6931: bitstring = h((Ns_6927,Nc_6926)) in
                                {7817}out(c, senc(mSrv(pkCli_6921,pkSess_6919),Ksrv_6931))
                            )
                            else
                                {7818}let v_6932: bool = (Disco_5021 = B) in
                                (
                                    {7819}if v_6932 then
                                    (
                                        {7820}let pkDisco_6933: bitstring = pub(skB) in
                                        {7821}in(c, (=pkCli_6921,em1_6934: bitstring));
                                        {7822}let m1_6935: bitstring = em1_6934 in
                                        {7823}let (=OpenSecureChannelRequest,=pkCli_6921,Nc_6936: bitstring) = m1_6935 in
                                        {7824}new Ns_6937: bitstring;
                                        {7825}new ST_6938: bitstring;
                                        {7826}new TTL_6939: bitstring;
                                        {7827}let m2_6940: bitstring = (OpenSecureChannelResponse,Ns_6937,ST_6938,TTL_6939) in
                                        {7828}out(c, m2_6940);
                                        {7829}let Ksrv_6941: bitstring = h((Ns_6937,Nc_6936)) in
                                        {7830}out(c, senc(mSrv(pkCli_6921,pkSess_6919),Ksrv_6941))
                                    )
                                    else
                                        {7831}let v_6942: bool = (Disco_5021 = C) in
                                        (
                                            {7832}if v_6942 then
                                            (
                                                {7833}let pkDisco_6943: bitstring = pub(skC) in
                                                {7834}in(c, (=pkCli_6921,em1_6944: bitstring));
                                                {7835}let m1_6945: bitstring = em1_6944 in
                                                {7836}let (=OpenSecureChannelRequest,=pkCli_6921,Nc_6946: bitstring) = m1_6945 in
                                                {7837}new Ns_6947: bitstring;
                                                {7838}new ST_6948: bitstring;
                                                {7839}new TTL_6949: bitstring;
                                                {7840}let m2_6950: bitstring = (OpenSecureChannelResponse,Ns_6947,ST_6948,TTL_6949) in
                                                {7841}out(c, m2_6950);
                                                {7842}let Ksrv_6951: bitstring = h((Ns_6947,Nc_6946)) in
                                                {7843}out(c, senc(mSrv(pkCli_6921,pkSess_6919),Ksrv_6951))
                                            )
                                            else
                                                {7844}let pkDisco_6952: bitstring = pub(sk(Disco_5021)) in
                                                {7845}in(c, (=pkCli_6921,em1_6953: bitstring));
                                                {7846}let m1_6954: bitstring = em1_6953 in
                                                {7847}let (=OpenSecureChannelRequest,=pkCli_6921,Nc_6955: bitstring) = m1_6954 in
                                                {7848}new Ns_6956: bitstring;
                                                {7849}new ST_6957: bitstring;
                                                {7850}new TTL_6958: bitstring;
                                                {7851}let m2_6959: bitstring = (OpenSecureChannelResponse,Ns_6956,ST_6957,TTL_6958) in
                                                {7852}out(c, m2_6959);
                                                {7853}let Ksrv_6960: bitstring = h((Ns_6956,Nc_6955)) in
                                                {7854}out(c, senc(mSrv(pkCli_6921,pkSess_6919),Ksrv_6960))
                                        )
                                        else
                                            {7855}let pkDisco_6961: bitstring = fail-any in
                                            {7856}in(c, (=pkCli_6921,em1_6962: bitstring));
                                            {7857}let m1_6963: bitstring = em1_6962 in
                                            {7858}let (=OpenSecureChannelRequest,=pkCli_6921,Nc_6964: bitstring) = m1_6963 in
                                            {7859}new Ns_6965: bitstring;
                                            {7860}new ST_6966: bitstring;
                                            {7861}new TTL_6967: bitstring;
                                            {7862}let m2_6968: bitstring = (OpenSecureChannelResponse,Ns_6965,ST_6966,TTL_6967) in
                                            {7863}out(c, m2_6968);
                                            {7864}let Ksrv_6969: bitstring = h((Ns_6965,Nc_6964)) in
                                            {7865}out(c, senc(mSrv(pkCli_6921,pkSess_6919),Ksrv_6969))
                                )
                                else
                                    {7866}let pkDisco_6970: bitstring = fail-any in
                                    {7867}in(c, (=pkCli_6921,em1_6971: bitstring));
                                    {7868}let m1_6972: bitstring = em1_6971 in
                                    {7869}let (=OpenSecureChannelRequest,=pkCli_6921,Nc_6973: bitstring) = m1_6972 in
                                    {7870}new Ns_6974: bitstring;
                                    {7871}new ST_6975: bitstring;
                                    {7872}new TTL_6976: bitstring;
                                    {7873}let m2_6977: bitstring = (OpenSecureChannelResponse,Ns_6974,ST_6975,TTL_6976) in
                                    {7874}out(c, m2_6977);
                                    {7875}let Ksrv_6978: bitstring = h((Ns_6974,Nc_6973)) in
                                    {7876}out(c, senc(mSrv(pkCli_6921,pkSess_6919),Ksrv_6978))
                        )
                        else
                            {7877}let pkDisco_6979: bitstring = fail-any in
                            {7878}in(c, (=pkCli_6921,em1_6980: bitstring));
                            {7879}let m1_6981: bitstring = em1_6980 in
                            {7880}let (=OpenSecureChannelRequest,=pkCli_6921,Nc_6982: bitstring) = m1_6981 in
                            {7881}new Ns_6983: bitstring;
                            {7882}new ST_6984: bitstring;
                            {7883}new TTL_6985: bitstring;
                            {7884}let m2_6986: bitstring = (OpenSecureChannelResponse,Ns_6983,ST_6984,TTL_6985) in
                            {7885}out(c, m2_6986);
                            {7886}let Ksrv_6987: bitstring = h((Ns_6983,Nc_6982)) in
                            {7887}out(c, senc(mSrv(pkCli_6921,pkSess_6919),Ksrv_6987))
                    )
                    else
                        {7888}let v_6988: bool = (Cli_5020 = B) in
                        (
                            {7889}if v_6988 then
                            (
                                {7890}let pkCli_6989: bitstring = pub(skB) in
                                {7891}let v_6990: bool = (Disco_5021 = A) in
                                (
                                    {7892}if v_6990 then
                                    (
                                        {7893}let pkDisco_6991: bitstring = pub(skA) in
                                        {7894}in(c, (=pkCli_6989,em1_6992: bitstring));
                                        {7895}let m1_6993: bitstring = em1_6992 in
                                        {7896}let (=OpenSecureChannelRequest,=pkCli_6989,Nc_6994: bitstring) = m1_6993 in
                                        {7897}new Ns_6995: bitstring;
                                        {7898}new ST_6996: bitstring;
                                        {7899}new TTL_6997: bitstring;
                                        {7900}let m2_6998: bitstring = (OpenSecureChannelResponse,Ns_6995,ST_6996,TTL_6997) in
                                        {7901}out(c, m2_6998);
                                        {7902}let Ksrv_6999: bitstring = h((Ns_6995,Nc_6994)) in
                                        {7903}out(c, senc(mSrv(pkCli_6989,pkSess_6919),Ksrv_6999))
                                    )
                                    else
                                        {7904}let v_7000: bool = (Disco_5021 = B) in
                                        (
                                            {7905}if v_7000 then
                                            (
                                                {7906}let pkDisco_7001: bitstring = pub(skB) in
                                                {7907}in(c, (=pkCli_6989,em1_7002: bitstring));
                                                {7908}let m1_7003: bitstring = em1_7002 in
                                                {7909}let (=OpenSecureChannelRequest,=pkCli_6989,Nc_7004: bitstring) = m1_7003 in
                                                {7910}new Ns_7005: bitstring;
                                                {7911}new ST_7006: bitstring;
                                                {7912}new TTL_7007: bitstring;
                                                {7913}let m2_7008: bitstring = (OpenSecureChannelResponse,Ns_7005,ST_7006,TTL_7007) in
                                                {7914}out(c, m2_7008);
                                                {7915}let Ksrv_7009: bitstring = h((Ns_7005,Nc_7004)) in
                                                {7916}out(c, senc(mSrv(pkCli_6989,pkSess_6919),Ksrv_7009))
                                            )
                                            else
                                                {7917}let v_7010: bool = (Disco_5021 = C) in
                                                (
                                                    {7918}if v_7010 then
                                                    (
                                                        {7919}let pkDisco_7011: bitstring = pub(skC) in
                                                        {7920}in(c, (=pkCli_6989,em1_7012: bitstring));
                                                        {7921}let m1_7013: bitstring = em1_7012 in
                                                        {7922}let (=OpenSecureChannelRequest,=pkCli_6989,Nc_7014: bitstring) = m1_7013 in
                                                        {7923}new Ns_7015: bitstring;
                                                        {7924}new ST_7016: bitstring;
                                                        {7925}new TTL_7017: bitstring;
                                                        {7926}let m2_7018: bitstring = (OpenSecureChannelResponse,Ns_7015,ST_7016,TTL_7017) in
                                                        {7927}out(c, m2_7018);
                                                        {7928}let Ksrv_7019: bitstring = h((Ns_7015,Nc_7014)) in
                                                        {7929}out(c, senc(mSrv(pkCli_6989,pkSess_6919),Ksrv_7019))
                                                    )
                                                    else
                                                        {7930}let pkDisco_7020: bitstring = pub(sk(Disco_5021)) in
                                                        {7931}in(c, (=pkCli_6989,em1_7021: bitstring));
                                                        {7932}let m1_7022: bitstring = em1_7021 in
                                                        {7933}let (=OpenSecureChannelRequest,=pkCli_6989,Nc_7023: bitstring) = m1_7022 in
                                                        {7934}new Ns_7024: bitstring;
                                                        {7935}new ST_7025: bitstring;
                                                        {7936}new TTL_7026: bitstring;
                                                        {7937}let m2_7027: bitstring = (OpenSecureChannelResponse,Ns_7024,ST_7025,TTL_7026) in
                                                        {7938}out(c, m2_7027);
                                                        {7939}let Ksrv_7028: bitstring = h((Ns_7024,Nc_7023)) in
                                                        {7940}out(c, senc(mSrv(pkCli_6989,pkSess_6919),Ksrv_7028))
                                                )
                                                else
                                                    {7941}let pkDisco_7029: bitstring = fail-any in
                                                    {7942}in(c, (=pkCli_6989,em1_7030: bitstring));
                                                    {7943}let m1_7031: bitstring = em1_7030 in
                                                    {7944}let (=OpenSecureChannelRequest,=pkCli_6989,Nc_7032: bitstring) = m1_7031 in
                                                    {7945}new Ns_7033: bitstring;
                                                    {7946}new ST_7034: bitstring;
                                                    {7947}new TTL_7035: bitstring;
                                                    {7948}let m2_7036: bitstring = (OpenSecureChannelResponse,Ns_7033,ST_7034,TTL_7035) in
                                                    {7949}out(c, m2_7036);
                                                    {7950}let Ksrv_7037: bitstring = h((Ns_7033,Nc_7032)) in
                                                    {7951}out(c, senc(mSrv(pkCli_6989,pkSess_6919),Ksrv_7037))
                                        )
                                        else
                                            {7952}let pkDisco_7038: bitstring = fail-any in
                                            {7953}in(c, (=pkCli_6989,em1_7039: bitstring));
                                            {7954}let m1_7040: bitstring = em1_7039 in
                                            {7955}let (=OpenSecureChannelRequest,=pkCli_6989,Nc_7041: bitstring) = m1_7040 in
                                            {7956}new Ns_7042: bitstring;
                                            {7957}new ST_7043: bitstring;
                                            {7958}new TTL_7044: bitstring;
                                            {7959}let m2_7045: bitstring = (OpenSecureChannelResponse,Ns_7042,ST_7043,TTL_7044) in
                                            {7960}out(c, m2_7045);
                                            {7961}let Ksrv_7046: bitstring = h((Ns_7042,Nc_7041)) in
                                            {7962}out(c, senc(mSrv(pkCli_6989,pkSess_6919),Ksrv_7046))
                                )
                                else
                                    {7963}let pkDisco_7047: bitstring = fail-any in
                                    {7964}in(c, (=pkCli_6989,em1_7048: bitstring));
                                    {7965}let m1_7049: bitstring = em1_7048 in
                                    {7966}let (=OpenSecureChannelRequest,=pkCli_6989,Nc_7050: bitstring) = m1_7049 in
                                    {7967}new Ns_7051: bitstring;
                                    {7968}new ST_7052: bitstring;
                                    {7969}new TTL_7053: bitstring;
                                    {7970}let m2_7054: bitstring = (OpenSecureChannelResponse,Ns_7051,ST_7052,TTL_7053) in
                                    {7971}out(c, m2_7054);
                                    {7972}let Ksrv_7055: bitstring = h((Ns_7051,Nc_7050)) in
                                    {7973}out(c, senc(mSrv(pkCli_6989,pkSess_6919),Ksrv_7055))
                            )
                            else
                                {7974}let v_7056: bool = (Cli_5020 = C) in
                                (
                                    {7975}if v_7056 then
                                    (
                                        {7976}let pkCli_7057: bitstring = pub(skC) in
                                        {7977}let v_7058: bool = (Disco_5021 = A) in
                                        (
                                            {7978}if v_7058 then
                                            (
                                                {7979}let pkDisco_7059: bitstring = pub(skA) in
                                                {7980}in(c, (=pkCli_7057,em1_7060: bitstring));
                                                {7981}let m1_7061: bitstring = em1_7060 in
                                                {7982}let (=OpenSecureChannelRequest,=pkCli_7057,Nc_7062: bitstring) = m1_7061 in
                                                {7983}new Ns_7063: bitstring;
                                                {7984}new ST_7064: bitstring;
                                                {7985}new TTL_7065: bitstring;
                                                {7986}let m2_7066: bitstring = (OpenSecureChannelResponse,Ns_7063,ST_7064,TTL_7065) in
                                                {7987}out(c, m2_7066);
                                                {7988}let Ksrv_7067: bitstring = h((Ns_7063,Nc_7062)) in
                                                {7989}out(c, senc(mSrv(pkCli_7057,pkSess_6919),Ksrv_7067))
                                            )
                                            else
                                                {7990}let v_7068: bool = (Disco_5021 = B) in
                                                (
                                                    {7991}if v_7068 then
                                                    (
                                                        {7992}let pkDisco_7069: bitstring = pub(skB) in
                                                        {7993}in(c, (=pkCli_7057,em1_7070: bitstring));
                                                        {7994}let m1_7071: bitstring = em1_7070 in
                                                        {7995}let (=OpenSecureChannelRequest,=pkCli_7057,Nc_7072: bitstring) = m1_7071 in
                                                        {7996}new Ns_7073: bitstring;
                                                        {7997}new ST_7074: bitstring;
                                                        {7998}new TTL_7075: bitstring;
                                                        {7999}let m2_7076: bitstring = (OpenSecureChannelResponse,Ns_7073,ST_7074,TTL_7075) in
                                                        {8000}out(c, m2_7076);
                                                        {8001}let Ksrv_7077: bitstring = h((Ns_7073,Nc_7072)) in
                                                        {8002}out(c, senc(mSrv(pkCli_7057,pkSess_6919),Ksrv_7077))
                                                    )
                                                    else
                                                        {8003}let v_7078: bool = (Disco_5021 = C) in
                                                        (
                                                            {8004}if v_7078 then
                                                            (
                                                                {8005}let pkDisco_7079: bitstring = pub(skC) in
                                                                {8006}in(c, (=pkCli_7057,em1_7080: bitstring));
                                                                {8007}let m1_7081: bitstring = em1_7080 in
                                                                {8008}let (=OpenSecureChannelRequest,=pkCli_7057,Nc_7082: bitstring) = m1_7081 in
                                                                {8009}new Ns_7083: bitstring;
                                                                {8010}new ST_7084: bitstring;
                                                                {8011}new TTL_7085: bitstring;
                                                                {8012}let m2_7086: bitstring = (OpenSecureChannelResponse,Ns_7083,ST_7084,TTL_7085) in
                                                                {8013}out(c, m2_7086);
                                                                {8014}let Ksrv_7087: bitstring = h((Ns_7083,Nc_7082)) in
                                                                {8015}out(c, senc(mSrv(pkCli_7057,pkSess_6919),Ksrv_7087))
                                                            )
                                                            else
                                                                {8016}let pkDisco_7088: bitstring = pub(sk(Disco_5021)) in
                                                                {8017}in(c, (=pkCli_7057,em1_7089: bitstring));
                                                                {8018}let m1_7090: bitstring = em1_7089 in
                                                                {8019}let (=OpenSecureChannelRequest,=pkCli_7057,Nc_7091: bitstring) = m1_7090 in
                                                                {8020}new Ns_7092: bitstring;
                                                                {8021}new ST_7093: bitstring;
                                                                {8022}new TTL_7094: bitstring;
                                                                {8023}let m2_7095: bitstring = (OpenSecureChannelResponse,Ns_7092,ST_7093,TTL_7094) in
                                                                {8024}out(c, m2_7095);
                                                                {8025}let Ksrv_7096: bitstring = h((Ns_7092,Nc_7091)) in
                                                                {8026}out(c, senc(mSrv(pkCli_7057,pkSess_6919),Ksrv_7096))
                                                        )
                                                        else
                                                            {8027}let pkDisco_7097: bitstring = fail-any in
                                                            {8028}in(c, (=pkCli_7057,em1_7098: bitstring));
                                                            {8029}let m1_7099: bitstring = em1_7098 in
                                                            {8030}let (=OpenSecureChannelRequest,=pkCli_7057,Nc_7100: bitstring) = m1_7099 in
                                                            {8031}new Ns_7101: bitstring;
                                                            {8032}new ST_7102: bitstring;
                                                            {8033}new TTL_7103: bitstring;
                                                            {8034}let m2_7104: bitstring = (OpenSecureChannelResponse,Ns_7101,ST_7102,TTL_7103) in
                                                            {8035}out(c, m2_7104);
                                                            {8036}let Ksrv_7105: bitstring = h((Ns_7101,Nc_7100)) in
                                                            {8037}out(c, senc(mSrv(pkCli_7057,pkSess_6919),Ksrv_7105))
                                                )
                                                else
                                                    {8038}let pkDisco_7106: bitstring = fail-any in
                                                    {8039}in(c, (=pkCli_7057,em1_7107: bitstring));
                                                    {8040}let m1_7108: bitstring = em1_7107 in
                                                    {8041}let (=OpenSecureChannelRequest,=pkCli_7057,Nc_7109: bitstring) = m1_7108 in
                                                    {8042}new Ns_7110: bitstring;
                                                    {8043}new ST_7111: bitstring;
                                                    {8044}new TTL_7112: bitstring;
                                                    {8045}let m2_7113: bitstring = (OpenSecureChannelResponse,Ns_7110,ST_7111,TTL_7112) in
                                                    {8046}out(c, m2_7113);
                                                    {8047}let Ksrv_7114: bitstring = h((Ns_7110,Nc_7109)) in
                                                    {8048}out(c, senc(mSrv(pkCli_7057,pkSess_6919),Ksrv_7114))
                                        )
                                        else
                                            {8049}let pkDisco_7115: bitstring = fail-any in
                                            {8050}in(c, (=pkCli_7057,em1_7116: bitstring));
                                            {8051}let m1_7117: bitstring = em1_7116 in
                                            {8052}let (=OpenSecureChannelRequest,=pkCli_7057,Nc_7118: bitstring) = m1_7117 in
                                            {8053}new Ns_7119: bitstring;
                                            {8054}new ST_7120: bitstring;
                                            {8055}new TTL_7121: bitstring;
                                            {8056}let m2_7122: bitstring = (OpenSecureChannelResponse,Ns_7119,ST_7120,TTL_7121) in
                                            {8057}out(c, m2_7122);
                                            {8058}let Ksrv_7123: bitstring = h((Ns_7119,Nc_7118)) in
                                            {8059}out(c, senc(mSrv(pkCli_7057,pkSess_6919),Ksrv_7123))
                                    )
                                    else
                                        {8060}let pkCli_7124: bitstring = pub(sk(Cli_5020)) in
                                        {8061}let v_7125: bool = (Disco_5021 = A) in
                                        (
                                            {8062}if v_7125 then
                                            (
                                                {8063}let pkDisco_7126: bitstring = pub(skA) in
                                                {8064}in(c, (=pkCli_7124,em1_7127: bitstring));
                                                {8065}let m1_7128: bitstring = em1_7127 in
                                                {8066}let (=OpenSecureChannelRequest,=pkCli_7124,Nc_7129: bitstring) = m1_7128 in
                                                {8067}new Ns_7130: bitstring;
                                                {8068}new ST_7131: bitstring;
                                                {8069}new TTL_7132: bitstring;
                                                {8070}let m2_7133: bitstring = (OpenSecureChannelResponse,Ns_7130,ST_7131,TTL_7132) in
                                                {8071}out(c, m2_7133);
                                                {8072}let Ksrv_7134: bitstring = h((Ns_7130,Nc_7129)) in
                                                {8073}out(c, senc(mSrv(pkCli_7124,pkSess_6919),Ksrv_7134))
                                            )
                                            else
                                                {8074}let v_7135: bool = (Disco_5021 = B) in
                                                (
                                                    {8075}if v_7135 then
                                                    (
                                                        {8076}let pkDisco_7136: bitstring = pub(skB) in
                                                        {8077}in(c, (=pkCli_7124,em1_7137: bitstring));
                                                        {8078}let m1_7138: bitstring = em1_7137 in
                                                        {8079}let (=OpenSecureChannelRequest,=pkCli_7124,Nc_7139: bitstring) = m1_7138 in
                                                        {8080}new Ns_7140: bitstring;
                                                        {8081}new ST_7141: bitstring;
                                                        {8082}new TTL_7142: bitstring;
                                                        {8083}let m2_7143: bitstring = (OpenSecureChannelResponse,Ns_7140,ST_7141,TTL_7142) in
                                                        {8084}out(c, m2_7143);
                                                        {8085}let Ksrv_7144: bitstring = h((Ns_7140,Nc_7139)) in
                                                        {8086}out(c, senc(mSrv(pkCli_7124,pkSess_6919),Ksrv_7144))
                                                    )
                                                    else
                                                        {8087}let v_7145: bool = (Disco_5021 = C) in
                                                        (
                                                            {8088}if v_7145 then
                                                            (
                                                                {8089}let pkDisco_7146: bitstring = pub(skC) in
                                                                {8090}in(c, (=pkCli_7124,em1_7147: bitstring));
                                                                {8091}let m1_7148: bitstring = em1_7147 in
                                                                {8092}let (=OpenSecureChannelRequest,=pkCli_7124,Nc_7149: bitstring) = m1_7148 in
                                                                {8093}new Ns_7150: bitstring;
                                                                {8094}new ST_7151: bitstring;
                                                                {8095}new TTL_7152: bitstring;
                                                                {8096}let m2_7153: bitstring = (OpenSecureChannelResponse,Ns_7150,ST_7151,TTL_7152) in
                                                                {8097}out(c, m2_7153);
                                                                {8098}let Ksrv_7154: bitstring = h((Ns_7150,Nc_7149)) in
                                                                {8099}out(c, senc(mSrv(pkCli_7124,pkSess_6919),Ksrv_7154))
                                                            )
                                                            else
                                                                {8100}let pkDisco_7155: bitstring = pub(sk(Disco_5021)) in
                                                                {8101}in(c, (=pkCli_7124,em1_7156: bitstring));
                                                                {8102}let m1_7157: bitstring = em1_7156 in
                                                                {8103}let (=OpenSecureChannelRequest,=pkCli_7124,Nc_7158: bitstring) = m1_7157 in
                                                                {8104}new Ns_7159: bitstring;
                                                                {8105}new ST_7160: bitstring;
                                                                {8106}new TTL_7161: bitstring;
                                                                {8107}let m2_7162: bitstring = (OpenSecureChannelResponse,Ns_7159,ST_7160,TTL_7161) in
                                                                {8108}out(c, m2_7162);
                                                                {8109}let Ksrv_7163: bitstring = h((Ns_7159,Nc_7158)) in
                                                                {8110}out(c, senc(mSrv(pkCli_7124,pkSess_6919),Ksrv_7163))
                                                        )
                                                        else
                                                            {8111}let pkDisco_7164: bitstring = fail-any in
                                                            {8112}in(c, (=pkCli_7124,em1_7165: bitstring));
                                                            {8113}let m1_7166: bitstring = em1_7165 in
                                                            {8114}let (=OpenSecureChannelRequest,=pkCli_7124,Nc_7167: bitstring) = m1_7166 in
                                                            {8115}new Ns_7168: bitstring;
                                                            {8116}new ST_7169: bitstring;
                                                            {8117}new TTL_7170: bitstring;
                                                            {8118}let m2_7171: bitstring = (OpenSecureChannelResponse,Ns_7168,ST_7169,TTL_7170) in
                                                            {8119}out(c, m2_7171);
                                                            {8120}let Ksrv_7172: bitstring = h((Ns_7168,Nc_7167)) in
                                                            {8121}out(c, senc(mSrv(pkCli_7124,pkSess_6919),Ksrv_7172))
                                                )
                                                else
                                                    {8122}let pkDisco_7173: bitstring = fail-any in
                                                    {8123}in(c, (=pkCli_7124,em1_7174: bitstring));
                                                    {8124}let m1_7175: bitstring = em1_7174 in
                                                    {8125}let (=OpenSecureChannelRequest,=pkCli_7124,Nc_7176: bitstring) = m1_7175 in
                                                    {8126}new Ns_7177: bitstring;
                                                    {8127}new ST_7178: bitstring;
                                                    {8128}new TTL_7179: bitstring;
                                                    {8129}let m2_7180: bitstring = (OpenSecureChannelResponse,Ns_7177,ST_7178,TTL_7179) in
                                                    {8130}out(c, m2_7180);
                                                    {8131}let Ksrv_7181: bitstring = h((Ns_7177,Nc_7176)) in
                                                    {8132}out(c, senc(mSrv(pkCli_7124,pkSess_6919),Ksrv_7181))
                                        )
                                        else
                                            {8133}let pkDisco_7182: bitstring = fail-any in
                                            {8134}in(c, (=pkCli_7124,em1_7183: bitstring));
                                            {8135}let m1_7184: bitstring = em1_7183 in
                                            {8136}let (=OpenSecureChannelRequest,=pkCli_7124,Nc_7185: bitstring) = m1_7184 in
                                            {8137}new Ns_7186: bitstring;
                                            {8138}new ST_7187: bitstring;
                                            {8139}new TTL_7188: bitstring;
                                            {8140}let m2_7189: bitstring = (OpenSecureChannelResponse,Ns_7186,ST_7187,TTL_7188) in
                                            {8141}out(c, m2_7189);
                                            {8142}let Ksrv_7190: bitstring = h((Ns_7186,Nc_7185)) in
                                            {8143}out(c, senc(mSrv(pkCli_7124,pkSess_6919),Ksrv_7190))
                                )
                                else
                                    {8144}let pkCli_7191: bitstring = fail-any in
                                    {8145}let v_7192: bool = (Disco_5021 = A) in
                                    (
                                        {8146}if v_7192 then
                                        (
                                            {8147}let pkDisco_7193: bitstring = pub(skA) in
                                            {8148}in(c, (=pkCli_7191,em1_7194: bitstring));
                                            {8149}let m1_7195: bitstring = em1_7194 in
                                            {8150}let (=OpenSecureChannelRequest,=pkCli_7191,Nc_7196: bitstring) = m1_7195 in
                                            {8151}new Ns_7197: bitstring;
                                            {8152}new ST_7198: bitstring;
                                            {8153}new TTL_7199: bitstring;
                                            {8154}let m2_7200: bitstring = (OpenSecureChannelResponse,Ns_7197,ST_7198,TTL_7199) in
                                            {8155}out(c, m2_7200);
                                            {8156}let Ksrv_7201: bitstring = h((Ns_7197,Nc_7196)) in
                                            {8157}out(c, senc(mSrv(pkCli_7191,pkSess_6919),Ksrv_7201))
                                        )
                                        else
                                            {8158}let v_7202: bool = (Disco_5021 = B) in
                                            (
                                                {8159}if v_7202 then
                                                (
                                                    {8160}let pkDisco_7203: bitstring = pub(skB) in
                                                    {8161}in(c, (=pkCli_7191,em1_7204: bitstring));
                                                    {8162}let m1_7205: bitstring = em1_7204 in
                                                    {8163}let (=OpenSecureChannelRequest,=pkCli_7191,Nc_7206: bitstring) = m1_7205 in
                                                    {8164}new Ns_7207: bitstring;
                                                    {8165}new ST_7208: bitstring;
                                                    {8166}new TTL_7209: bitstring;
                                                    {8167}let m2_7210: bitstring = (OpenSecureChannelResponse,Ns_7207,ST_7208,TTL_7209) in
                                                    {8168}out(c, m2_7210);
                                                    {8169}let Ksrv_7211: bitstring = h((Ns_7207,Nc_7206)) in
                                                    {8170}out(c, senc(mSrv(pkCli_7191,pkSess_6919),Ksrv_7211))
                                                )
                                                else
                                                    {8171}let v_7212: bool = (Disco_5021 = C) in
                                                    (
                                                        {8172}if v_7212 then
                                                        (
                                                            {8173}let pkDisco_7213: bitstring = pub(skC) in
                                                            {8174}in(c, (=pkCli_7191,em1_7214: bitstring));
                                                            {8175}let m1_7215: bitstring = em1_7214 in
                                                            {8176}let (=OpenSecureChannelRequest,=pkCli_7191,Nc_7216: bitstring) = m1_7215 in
                                                            {8177}new Ns_7217: bitstring;
                                                            {8178}new ST_7218: bitstring;
                                                            {8179}new TTL_7219: bitstring;
                                                            {8180}let m2_7220: bitstring = (OpenSecureChannelResponse,Ns_7217,ST_7218,TTL_7219) in
                                                            {8181}out(c, m2_7220);
                                                            {8182}let Ksrv_7221: bitstring = h((Ns_7217,Nc_7216)) in
                                                            {8183}out(c, senc(mSrv(pkCli_7191,pkSess_6919),Ksrv_7221))
                                                        )
                                                        else
                                                            {8184}let pkDisco_7222: bitstring = pub(sk(Disco_5021)) in
                                                            {8185}in(c, (=pkCli_7191,em1_7223: bitstring));
                                                            {8186}let m1_7224: bitstring = em1_7223 in
                                                            {8187}let (=OpenSecureChannelRequest,=pkCli_7191,Nc_7225: bitstring) = m1_7224 in
                                                            {8188}new Ns_7226: bitstring;
                                                            {8189}new ST_7227: bitstring;
                                                            {8190}new TTL_7228: bitstring;
                                                            {8191}let m2_7229: bitstring = (OpenSecureChannelResponse,Ns_7226,ST_7227,TTL_7228) in
                                                            {8192}out(c, m2_7229);
                                                            {8193}let Ksrv_7230: bitstring = h((Ns_7226,Nc_7225)) in
                                                            {8194}out(c, senc(mSrv(pkCli_7191,pkSess_6919),Ksrv_7230))
                                                    )
                                                    else
                                                        {8195}let pkDisco_7231: bitstring = fail-any in
                                                        {8196}in(c, (=pkCli_7191,em1_7232: bitstring));
                                                        {8197}let m1_7233: bitstring = em1_7232 in
                                                        {8198}let (=OpenSecureChannelRequest,=pkCli_7191,Nc_7234: bitstring) = m1_7233 in
                                                        {8199}new Ns_7235: bitstring;
                                                        {8200}new ST_7236: bitstring;
                                                        {8201}new TTL_7237: bitstring;
                                                        {8202}let m2_7238: bitstring = (OpenSecureChannelResponse,Ns_7235,ST_7236,TTL_7237) in
                                                        {8203}out(c, m2_7238);
                                                        {8204}let Ksrv_7239: bitstring = h((Ns_7235,Nc_7234)) in
                                                        {8205}out(c, senc(mSrv(pkCli_7191,pkSess_6919),Ksrv_7239))
                                            )
                                            else
                                                {8206}let pkDisco_7240: bitstring = fail-any in
                                                {8207}in(c, (=pkCli_7191,em1_7241: bitstring));
                                                {8208}let m1_7242: bitstring = em1_7241 in
                                                {8209}let (=OpenSecureChannelRequest,=pkCli_7191,Nc_7243: bitstring) = m1_7242 in
                                                {8210}new Ns_7244: bitstring;
                                                {8211}new ST_7245: bitstring;
                                                {8212}new TTL_7246: bitstring;
                                                {8213}let m2_7247: bitstring = (OpenSecureChannelResponse,Ns_7244,ST_7245,TTL_7246) in
                                                {8214}out(c, m2_7247);
                                                {8215}let Ksrv_7248: bitstring = h((Ns_7244,Nc_7243)) in
                                                {8216}out(c, senc(mSrv(pkCli_7191,pkSess_6919),Ksrv_7248))
                                    )
                                    else
                                        {8217}let pkDisco_7249: bitstring = fail-any in
                                        {8218}in(c, (=pkCli_7191,em1_7250: bitstring));
                                        {8219}let m1_7251: bitstring = em1_7250 in
                                        {8220}let (=OpenSecureChannelRequest,=pkCli_7191,Nc_7252: bitstring) = m1_7251 in
                                        {8221}new Ns_7253: bitstring;
                                        {8222}new ST_7254: bitstring;
                                        {8223}new TTL_7255: bitstring;
                                        {8224}let m2_7256: bitstring = (OpenSecureChannelResponse,Ns_7253,ST_7254,TTL_7255) in
                                        {8225}out(c, m2_7256);
                                        {8226}let Ksrv_7257: bitstring = h((Ns_7253,Nc_7252)) in
                                        {8227}out(c, senc(mSrv(pkCli_7191,pkSess_6919),Ksrv_7257))
                        )
                        else
                            {8228}let pkCli_7258: bitstring = fail-any in
                            {8229}let v_7259: bool = (Disco_5021 = A) in
                            (
                                {8230}if v_7259 then
                                (
                                    {8231}let pkDisco_7260: bitstring = pub(skA) in
                                    {8232}in(c, (=pkCli_7258,em1_7261: bitstring));
                                    {8233}let m1_7262: bitstring = em1_7261 in
                                    {8234}let (=OpenSecureChannelRequest,=pkCli_7258,Nc_7263: bitstring) = m1_7262 in
                                    {8235}new Ns_7264: bitstring;
                                    {8236}new ST_7265: bitstring;
                                    {8237}new TTL_7266: bitstring;
                                    {8238}let m2_7267: bitstring = (OpenSecureChannelResponse,Ns_7264,ST_7265,TTL_7266) in
                                    {8239}out(c, m2_7267);
                                    {8240}let Ksrv_7268: bitstring = h((Ns_7264,Nc_7263)) in
                                    {8241}out(c, senc(mSrv(pkCli_7258,pkSess_6919),Ksrv_7268))
                                )
                                else
                                    {8242}let v_7269: bool = (Disco_5021 = B) in
                                    (
                                        {8243}if v_7269 then
                                        (
                                            {8244}let pkDisco_7270: bitstring = pub(skB) in
                                            {8245}in(c, (=pkCli_7258,em1_7271: bitstring));
                                            {8246}let m1_7272: bitstring = em1_7271 in
                                            {8247}let (=OpenSecureChannelRequest,=pkCli_7258,Nc_7273: bitstring) = m1_7272 in
                                            {8248}new Ns_7274: bitstring;
                                            {8249}new ST_7275: bitstring;
                                            {8250}new TTL_7276: bitstring;
                                            {8251}let m2_7277: bitstring = (OpenSecureChannelResponse,Ns_7274,ST_7275,TTL_7276) in
                                            {8252}out(c, m2_7277);
                                            {8253}let Ksrv_7278: bitstring = h((Ns_7274,Nc_7273)) in
                                            {8254}out(c, senc(mSrv(pkCli_7258,pkSess_6919),Ksrv_7278))
                                        )
                                        else
                                            {8255}let v_7279: bool = (Disco_5021 = C) in
                                            (
                                                {8256}if v_7279 then
                                                (
                                                    {8257}let pkDisco_7280: bitstring = pub(skC) in
                                                    {8258}in(c, (=pkCli_7258,em1_7281: bitstring));
                                                    {8259}let m1_7282: bitstring = em1_7281 in
                                                    {8260}let (=OpenSecureChannelRequest,=pkCli_7258,Nc_7283: bitstring) = m1_7282 in
                                                    {8261}new Ns_7284: bitstring;
                                                    {8262}new ST_7285: bitstring;
                                                    {8263}new TTL_7286: bitstring;
                                                    {8264}let m2_7287: bitstring = (OpenSecureChannelResponse,Ns_7284,ST_7285,TTL_7286) in
                                                    {8265}out(c, m2_7287);
                                                    {8266}let Ksrv_7288: bitstring = h((Ns_7284,Nc_7283)) in
                                                    {8267}out(c, senc(mSrv(pkCli_7258,pkSess_6919),Ksrv_7288))
                                                )
                                                else
                                                    {8268}let pkDisco_7289: bitstring = pub(sk(Disco_5021)) in
                                                    {8269}in(c, (=pkCli_7258,em1_7290: bitstring));
                                                    {8270}let m1_7291: bitstring = em1_7290 in
                                                    {8271}let (=OpenSecureChannelRequest,=pkCli_7258,Nc_7292: bitstring) = m1_7291 in
                                                    {8272}new Ns_7293: bitstring;
                                                    {8273}new ST_7294: bitstring;
                                                    {8274}new TTL_7295: bitstring;
                                                    {8275}let m2_7296: bitstring = (OpenSecureChannelResponse,Ns_7293,ST_7294,TTL_7295) in
                                                    {8276}out(c, m2_7296);
                                                    {8277}let Ksrv_7297: bitstring = h((Ns_7293,Nc_7292)) in
                                                    {8278}out(c, senc(mSrv(pkCli_7258,pkSess_6919),Ksrv_7297))
                                            )
                                            else
                                                {8279}let pkDisco_7298: bitstring = fail-any in
                                                {8280}in(c, (=pkCli_7258,em1_7299: bitstring));
                                                {8281}let m1_7300: bitstring = em1_7299 in
                                                {8282}let (=OpenSecureChannelRequest,=pkCli_7258,Nc_7301: bitstring) = m1_7300 in
                                                {8283}new Ns_7302: bitstring;
                                                {8284}new ST_7303: bitstring;
                                                {8285}new TTL_7304: bitstring;
                                                {8286}let m2_7305: bitstring = (OpenSecureChannelResponse,Ns_7302,ST_7303,TTL_7304) in
                                                {8287}out(c, m2_7305);
                                                {8288}let Ksrv_7306: bitstring = h((Ns_7302,Nc_7301)) in
                                                {8289}out(c, senc(mSrv(pkCli_7258,pkSess_6919),Ksrv_7306))
                                    )
                                    else
                                        {8290}let pkDisco_7307: bitstring = fail-any in
                                        {8291}in(c, (=pkCli_7258,em1_7308: bitstring));
                                        {8292}let m1_7309: bitstring = em1_7308 in
                                        {8293}let (=OpenSecureChannelRequest,=pkCli_7258,Nc_7310: bitstring) = m1_7309 in
                                        {8294}new Ns_7311: bitstring;
                                        {8295}new ST_7312: bitstring;
                                        {8296}new TTL_7313: bitstring;
                                        {8297}let m2_7314: bitstring = (OpenSecureChannelResponse,Ns_7311,ST_7312,TTL_7313) in
                                        {8298}out(c, m2_7314);
                                        {8299}let Ksrv_7315: bitstring = h((Ns_7311,Nc_7310)) in
                                        {8300}out(c, senc(mSrv(pkCli_7258,pkSess_6919),Ksrv_7315))
                            )
                            else
                                {8301}let pkDisco_7316: bitstring = fail-any in
                                {8302}in(c, (=pkCli_7258,em1_7317: bitstring));
                                {8303}let m1_7318: bitstring = em1_7317 in
                                {8304}let (=OpenSecureChannelRequest,=pkCli_7258,Nc_7319: bitstring) = m1_7318 in
                                {8305}new Ns_7320: bitstring;
                                {8306}new ST_7321: bitstring;
                                {8307}new TTL_7322: bitstring;
                                {8308}let m2_7323: bitstring = (OpenSecureChannelResponse,Ns_7320,ST_7321,TTL_7322) in
                                {8309}out(c, m2_7323);
                                {8310}let Ksrv_7324: bitstring = h((Ns_7320,Nc_7319)) in
                                {8311}out(c, senc(mSrv(pkCli_7258,pkSess_6919),Ksrv_7324))
                )
                else
                    {8312}let pkCli_7325: bitstring = fail-any in
                    {8313}let v_7326: bool = (Disco_5021 = A) in
                    (
                        {8314}if v_7326 then
                        (
                            {8315}let pkDisco_7327: bitstring = pub(skA) in
                            {8316}in(c, (=pkCli_7325,em1_7328: bitstring));
                            {8317}let m1_7329: bitstring = em1_7328 in
                            {8318}let (=OpenSecureChannelRequest,=pkCli_7325,Nc_7330: bitstring) = m1_7329 in
                            {8319}new Ns_7331: bitstring;
                            {8320}new ST_7332: bitstring;
                            {8321}new TTL_7333: bitstring;
                            {8322}let m2_7334: bitstring = (OpenSecureChannelResponse,Ns_7331,ST_7332,TTL_7333) in
                            {8323}out(c, m2_7334);
                            {8324}let Ksrv_7335: bitstring = h((Ns_7331,Nc_7330)) in
                            {8325}out(c, senc(mSrv(pkCli_7325,pkSess_6919),Ksrv_7335))
                        )
                        else
                            {8326}let v_7336: bool = (Disco_5021 = B) in
                            (
                                {8327}if v_7336 then
                                (
                                    {8328}let pkDisco_7337: bitstring = pub(skB) in
                                    {8329}in(c, (=pkCli_7325,em1_7338: bitstring));
                                    {8330}let m1_7339: bitstring = em1_7338 in
                                    {8331}let (=OpenSecureChannelRequest,=pkCli_7325,Nc_7340: bitstring) = m1_7339 in
                                    {8332}new Ns_7341: bitstring;
                                    {8333}new ST_7342: bitstring;
                                    {8334}new TTL_7343: bitstring;
                                    {8335}let m2_7344: bitstring = (OpenSecureChannelResponse,Ns_7341,ST_7342,TTL_7343) in
                                    {8336}out(c, m2_7344);
                                    {8337}let Ksrv_7345: bitstring = h((Ns_7341,Nc_7340)) in
                                    {8338}out(c, senc(mSrv(pkCli_7325,pkSess_6919),Ksrv_7345))
                                )
                                else
                                    {8339}let v_7346: bool = (Disco_5021 = C) in
                                    (
                                        {8340}if v_7346 then
                                        (
                                            {8341}let pkDisco_7347: bitstring = pub(skC) in
                                            {8342}in(c, (=pkCli_7325,em1_7348: bitstring));
                                            {8343}let m1_7349: bitstring = em1_7348 in
                                            {8344}let (=OpenSecureChannelRequest,=pkCli_7325,Nc_7350: bitstring) = m1_7349 in
                                            {8345}new Ns_7351: bitstring;
                                            {8346}new ST_7352: bitstring;
                                            {8347}new TTL_7353: bitstring;
                                            {8348}let m2_7354: bitstring = (OpenSecureChannelResponse,Ns_7351,ST_7352,TTL_7353) in
                                            {8349}out(c, m2_7354);
                                            {8350}let Ksrv_7355: bitstring = h((Ns_7351,Nc_7350)) in
                                            {8351}out(c, senc(mSrv(pkCli_7325,pkSess_6919),Ksrv_7355))
                                        )
                                        else
                                            {8352}let pkDisco_7356: bitstring = pub(sk(Disco_5021)) in
                                            {8353}in(c, (=pkCli_7325,em1_7357: bitstring));
                                            {8354}let m1_7358: bitstring = em1_7357 in
                                            {8355}let (=OpenSecureChannelRequest,=pkCli_7325,Nc_7359: bitstring) = m1_7358 in
                                            {8356}new Ns_7360: bitstring;
                                            {8357}new ST_7361: bitstring;
                                            {8358}new TTL_7362: bitstring;
                                            {8359}let m2_7363: bitstring = (OpenSecureChannelResponse,Ns_7360,ST_7361,TTL_7362) in
                                            {8360}out(c, m2_7363);
                                            {8361}let Ksrv_7364: bitstring = h((Ns_7360,Nc_7359)) in
                                            {8362}out(c, senc(mSrv(pkCli_7325,pkSess_6919),Ksrv_7364))
                                    )
                                    else
                                        {8363}let pkDisco_7365: bitstring = fail-any in
                                        {8364}in(c, (=pkCli_7325,em1_7366: bitstring));
                                        {8365}let m1_7367: bitstring = em1_7366 in
                                        {8366}let (=OpenSecureChannelRequest,=pkCli_7325,Nc_7368: bitstring) = m1_7367 in
                                        {8367}new Ns_7369: bitstring;
                                        {8368}new ST_7370: bitstring;
                                        {8369}new TTL_7371: bitstring;
                                        {8370}let m2_7372: bitstring = (OpenSecureChannelResponse,Ns_7369,ST_7370,TTL_7371) in
                                        {8371}out(c, m2_7372);
                                        {8372}let Ksrv_7373: bitstring = h((Ns_7369,Nc_7368)) in
                                        {8373}out(c, senc(mSrv(pkCli_7325,pkSess_6919),Ksrv_7373))
                            )
                            else
                                {8374}let pkDisco_7374: bitstring = fail-any in
                                {8375}in(c, (=pkCli_7325,em1_7375: bitstring));
                                {8376}let m1_7376: bitstring = em1_7375 in
                                {8377}let (=OpenSecureChannelRequest,=pkCli_7325,Nc_7377: bitstring) = m1_7376 in
                                {8378}new Ns_7378: bitstring;
                                {8379}new ST_7379: bitstring;
                                {8380}new TTL_7380: bitstring;
                                {8381}let m2_7381: bitstring = (OpenSecureChannelResponse,Ns_7378,ST_7379,TTL_7380) in
                                {8382}out(c, m2_7381);
                                {8383}let Ksrv_7382: bitstring = h((Ns_7378,Nc_7377)) in
                                {8384}out(c, senc(mSrv(pkCli_7325,pkSess_6919),Ksrv_7382))
                    )
                    else
                        {8385}let pkDisco_7383: bitstring = fail-any in
                        {8386}in(c, (=pkCli_7325,em1_7384: bitstring));
                        {8387}let m1_7385: bitstring = em1_7384 in
                        {8388}let (=OpenSecureChannelRequest,=pkCli_7325,Nc_7386: bitstring) = m1_7385 in
                        {8389}new Ns_7387: bitstring;
                        {8390}new ST_7388: bitstring;
                        {8391}new TTL_7389: bitstring;
                        {8392}let m2_7390: bitstring = (OpenSecureChannelResponse,Ns_7387,ST_7388,TTL_7389) in
                        {8393}out(c, m2_7390);
                        {8394}let Ksrv_7391: bitstring = h((Ns_7387,Nc_7386)) in
                        {8395}out(c, senc(mSrv(pkCli_7325,pkSess_6919),Ksrv_7391))
    )
    else
        {8396}let skSess_7392: bitstring = fail-any in
        {8397}let pkSess_7393: bitstring = pub(skSess_7392) in
        {8398}let v_7394: bool = (Cli_5020 = A) in
        (
            {8399}if v_7394 then
            (
                {8400}let pkCli_7395: bitstring = pub(skA) in
                {8401}let v_7396: bool = (Disco_5021 = A) in
                (
                    {8402}if v_7396 then
                    (
                        {8403}let pkDisco_7397: bitstring = pub(skA) in
                        {8404}in(c, (=pkCli_7395,em1_7398: bitstring));
                        {8405}let m1_7399: bitstring = em1_7398 in
                        {8406}let (=OpenSecureChannelRequest,=pkCli_7395,Nc_7400: bitstring) = m1_7399 in
                        {8407}new Ns_7401: bitstring;
                        {8408}new ST_7402: bitstring;
                        {8409}new TTL_7403: bitstring;
                        {8410}let m2_7404: bitstring = (OpenSecureChannelResponse,Ns_7401,ST_7402,TTL_7403) in
                        {8411}out(c, m2_7404);
                        {8412}let Ksrv_7405: bitstring = h((Ns_7401,Nc_7400)) in
                        {8413}out(c, senc(mSrv(pkCli_7395,pkSess_7393),Ksrv_7405))
                    )
                    else
                        {8414}let v_7406: bool = (Disco_5021 = B) in
                        (
                            {8415}if v_7406 then
                            (
                                {8416}let pkDisco_7407: bitstring = pub(skB) in
                                {8417}in(c, (=pkCli_7395,em1_7408: bitstring));
                                {8418}let m1_7409: bitstring = em1_7408 in
                                {8419}let (=OpenSecureChannelRequest,=pkCli_7395,Nc_7410: bitstring) = m1_7409 in
                                {8420}new Ns_7411: bitstring;
                                {8421}new ST_7412: bitstring;
                                {8422}new TTL_7413: bitstring;
                                {8423}let m2_7414: bitstring = (OpenSecureChannelResponse,Ns_7411,ST_7412,TTL_7413) in
                                {8424}out(c, m2_7414);
                                {8425}let Ksrv_7415: bitstring = h((Ns_7411,Nc_7410)) in
                                {8426}out(c, senc(mSrv(pkCli_7395,pkSess_7393),Ksrv_7415))
                            )
                            else
                                {8427}let v_7416: bool = (Disco_5021 = C) in
                                (
                                    {8428}if v_7416 then
                                    (
                                        {8429}let pkDisco_7417: bitstring = pub(skC) in
                                        {8430}in(c, (=pkCli_7395,em1_7418: bitstring));
                                        {8431}let m1_7419: bitstring = em1_7418 in
                                        {8432}let (=OpenSecureChannelRequest,=pkCli_7395,Nc_7420: bitstring) = m1_7419 in
                                        {8433}new Ns_7421: bitstring;
                                        {8434}new ST_7422: bitstring;
                                        {8435}new TTL_7423: bitstring;
                                        {8436}let m2_7424: bitstring = (OpenSecureChannelResponse,Ns_7421,ST_7422,TTL_7423) in
                                        {8437}out(c, m2_7424);
                                        {8438}let Ksrv_7425: bitstring = h((Ns_7421,Nc_7420)) in
                                        {8439}out(c, senc(mSrv(pkCli_7395,pkSess_7393),Ksrv_7425))
                                    )
                                    else
                                        {8440}let pkDisco_7426: bitstring = pub(sk(Disco_5021)) in
                                        {8441}in(c, (=pkCli_7395,em1_7427: bitstring));
                                        {8442}let m1_7428: bitstring = em1_7427 in
                                        {8443}let (=OpenSecureChannelRequest,=pkCli_7395,Nc_7429: bitstring) = m1_7428 in
                                        {8444}new Ns_7430: bitstring;
                                        {8445}new ST_7431: bitstring;
                                        {8446}new TTL_7432: bitstring;
                                        {8447}let m2_7433: bitstring = (OpenSecureChannelResponse,Ns_7430,ST_7431,TTL_7432) in
                                        {8448}out(c, m2_7433);
                                        {8449}let Ksrv_7434: bitstring = h((Ns_7430,Nc_7429)) in
                                        {8450}out(c, senc(mSrv(pkCli_7395,pkSess_7393),Ksrv_7434))
                                )
                                else
                                    {8451}let pkDisco_7435: bitstring = fail-any in
                                    {8452}in(c, (=pkCli_7395,em1_7436: bitstring));
                                    {8453}let m1_7437: bitstring = em1_7436 in
                                    {8454}let (=OpenSecureChannelRequest,=pkCli_7395,Nc_7438: bitstring) = m1_7437 in
                                    {8455}new Ns_7439: bitstring;
                                    {8456}new ST_7440: bitstring;
                                    {8457}new TTL_7441: bitstring;
                                    {8458}let m2_7442: bitstring = (OpenSecureChannelResponse,Ns_7439,ST_7440,TTL_7441) in
                                    {8459}out(c, m2_7442);
                                    {8460}let Ksrv_7443: bitstring = h((Ns_7439,Nc_7438)) in
                                    {8461}out(c, senc(mSrv(pkCli_7395,pkSess_7393),Ksrv_7443))
                        )
                        else
                            {8462}let pkDisco_7444: bitstring = fail-any in
                            {8463}in(c, (=pkCli_7395,em1_7445: bitstring));
                            {8464}let m1_7446: bitstring = em1_7445 in
                            {8465}let (=OpenSecureChannelRequest,=pkCli_7395,Nc_7447: bitstring) = m1_7446 in
                            {8466}new Ns_7448: bitstring;
                            {8467}new ST_7449: bitstring;
                            {8468}new TTL_7450: bitstring;
                            {8469}let m2_7451: bitstring = (OpenSecureChannelResponse,Ns_7448,ST_7449,TTL_7450) in
                            {8470}out(c, m2_7451);
                            {8471}let Ksrv_7452: bitstring = h((Ns_7448,Nc_7447)) in
                            {8472}out(c, senc(mSrv(pkCli_7395,pkSess_7393),Ksrv_7452))
                )
                else
                    {8473}let pkDisco_7453: bitstring = fail-any in
                    {8474}in(c, (=pkCli_7395,em1_7454: bitstring));
                    {8475}let m1_7455: bitstring = em1_7454 in
                    {8476}let (=OpenSecureChannelRequest,=pkCli_7395,Nc_7456: bitstring) = m1_7455 in
                    {8477}new Ns_7457: bitstring;
                    {8478}new ST_7458: bitstring;
                    {8479}new TTL_7459: bitstring;
                    {8480}let m2_7460: bitstring = (OpenSecureChannelResponse,Ns_7457,ST_7458,TTL_7459) in
                    {8481}out(c, m2_7460);
                    {8482}let Ksrv_7461: bitstring = h((Ns_7457,Nc_7456)) in
                    {8483}out(c, senc(mSrv(pkCli_7395,pkSess_7393),Ksrv_7461))
            )
            else
                {8484}let v_7462: bool = (Cli_5020 = B) in
                (
                    {8485}if v_7462 then
                    (
                        {8486}let pkCli_7463: bitstring = pub(skB) in
                        {8487}let v_7464: bool = (Disco_5021 = A) in
                        (
                            {8488}if v_7464 then
                            (
                                {8489}let pkDisco_7465: bitstring = pub(skA) in
                                {8490}in(c, (=pkCli_7463,em1_7466: bitstring));
                                {8491}let m1_7467: bitstring = em1_7466 in
                                {8492}let (=OpenSecureChannelRequest,=pkCli_7463,Nc_7468: bitstring) = m1_7467 in
                                {8493}new Ns_7469: bitstring;
                                {8494}new ST_7470: bitstring;
                                {8495}new TTL_7471: bitstring;
                                {8496}let m2_7472: bitstring = (OpenSecureChannelResponse,Ns_7469,ST_7470,TTL_7471) in
                                {8497}out(c, m2_7472);
                                {8498}let Ksrv_7473: bitstring = h((Ns_7469,Nc_7468)) in
                                {8499}out(c, senc(mSrv(pkCli_7463,pkSess_7393),Ksrv_7473))
                            )
                            else
                                {8500}let v_7474: bool = (Disco_5021 = B) in
                                (
                                    {8501}if v_7474 then
                                    (
                                        {8502}let pkDisco_7475: bitstring = pub(skB) in
                                        {8503}in(c, (=pkCli_7463,em1_7476: bitstring));
                                        {8504}let m1_7477: bitstring = em1_7476 in
                                        {8505}let (=OpenSecureChannelRequest,=pkCli_7463,Nc_7478: bitstring) = m1_7477 in
                                        {8506}new Ns_7479: bitstring;
                                        {8507}new ST_7480: bitstring;
                                        {8508}new TTL_7481: bitstring;
                                        {8509}let m2_7482: bitstring = (OpenSecureChannelResponse,Ns_7479,ST_7480,TTL_7481) in
                                        {8510}out(c, m2_7482);
                                        {8511}let Ksrv_7483: bitstring = h((Ns_7479,Nc_7478)) in
                                        {8512}out(c, senc(mSrv(pkCli_7463,pkSess_7393),Ksrv_7483))
                                    )
                                    else
                                        {8513}let v_7484: bool = (Disco_5021 = C) in
                                        (
                                            {8514}if v_7484 then
                                            (
                                                {8515}let pkDisco_7485: bitstring = pub(skC) in
                                                {8516}in(c, (=pkCli_7463,em1_7486: bitstring));
                                                {8517}let m1_7487: bitstring = em1_7486 in
                                                {8518}let (=OpenSecureChannelRequest,=pkCli_7463,Nc_7488: bitstring) = m1_7487 in
                                                {8519}new Ns_7489: bitstring;
                                                {8520}new ST_7490: bitstring;
                                                {8521}new TTL_7491: bitstring;
                                                {8522}let m2_7492: bitstring = (OpenSecureChannelResponse,Ns_7489,ST_7490,TTL_7491) in
                                                {8523}out(c, m2_7492);
                                                {8524}let Ksrv_7493: bitstring = h((Ns_7489,Nc_7488)) in
                                                {8525}out(c, senc(mSrv(pkCli_7463,pkSess_7393),Ksrv_7493))
                                            )
                                            else
                                                {8526}let pkDisco_7494: bitstring = pub(sk(Disco_5021)) in
                                                {8527}in(c, (=pkCli_7463,em1_7495: bitstring));
                                                {8528}let m1_7496: bitstring = em1_7495 in
                                                {8529}let (=OpenSecureChannelRequest,=pkCli_7463,Nc_7497: bitstring) = m1_7496 in
                                                {8530}new Ns_7498: bitstring;
                                                {8531}new ST_7499: bitstring;
                                                {8532}new TTL_7500: bitstring;
                                                {8533}let m2_7501: bitstring = (OpenSecureChannelResponse,Ns_7498,ST_7499,TTL_7500) in
                                                {8534}out(c, m2_7501);
                                                {8535}let Ksrv_7502: bitstring = h((Ns_7498,Nc_7497)) in
                                                {8536}out(c, senc(mSrv(pkCli_7463,pkSess_7393),Ksrv_7502))
                                        )
                                        else
                                            {8537}let pkDisco_7503: bitstring = fail-any in
                                            {8538}in(c, (=pkCli_7463,em1_7504: bitstring));
                                            {8539}let m1_7505: bitstring = em1_7504 in
                                            {8540}let (=OpenSecureChannelRequest,=pkCli_7463,Nc_7506: bitstring) = m1_7505 in
                                            {8541}new Ns_7507: bitstring;
                                            {8542}new ST_7508: bitstring;
                                            {8543}new TTL_7509: bitstring;
                                            {8544}let m2_7510: bitstring = (OpenSecureChannelResponse,Ns_7507,ST_7508,TTL_7509) in
                                            {8545}out(c, m2_7510);
                                            {8546}let Ksrv_7511: bitstring = h((Ns_7507,Nc_7506)) in
                                            {8547}out(c, senc(mSrv(pkCli_7463,pkSess_7393),Ksrv_7511))
                                )
                                else
                                    {8548}let pkDisco_7512: bitstring = fail-any in
                                    {8549}in(c, (=pkCli_7463,em1_7513: bitstring));
                                    {8550}let m1_7514: bitstring = em1_7513 in
                                    {8551}let (=OpenSecureChannelRequest,=pkCli_7463,Nc_7515: bitstring) = m1_7514 in
                                    {8552}new Ns_7516: bitstring;
                                    {8553}new ST_7517: bitstring;
                                    {8554}new TTL_7518: bitstring;
                                    {8555}let m2_7519: bitstring = (OpenSecureChannelResponse,Ns_7516,ST_7517,TTL_7518) in
                                    {8556}out(c, m2_7519);
                                    {8557}let Ksrv_7520: bitstring = h((Ns_7516,Nc_7515)) in
                                    {8558}out(c, senc(mSrv(pkCli_7463,pkSess_7393),Ksrv_7520))
                        )
                        else
                            {8559}let pkDisco_7521: bitstring = fail-any in
                            {8560}in(c, (=pkCli_7463,em1_7522: bitstring));
                            {8561}let m1_7523: bitstring = em1_7522 in
                            {8562}let (=OpenSecureChannelRequest,=pkCli_7463,Nc_7524: bitstring) = m1_7523 in
                            {8563}new Ns_7525: bitstring;
                            {8564}new ST_7526: bitstring;
                            {8565}new TTL_7527: bitstring;
                            {8566}let m2_7528: bitstring = (OpenSecureChannelResponse,Ns_7525,ST_7526,TTL_7527) in
                            {8567}out(c, m2_7528);
                            {8568}let Ksrv_7529: bitstring = h((Ns_7525,Nc_7524)) in
                            {8569}out(c, senc(mSrv(pkCli_7463,pkSess_7393),Ksrv_7529))
                    )
                    else
                        {8570}let v_7530: bool = (Cli_5020 = C) in
                        (
                            {8571}if v_7530 then
                            (
                                {8572}let pkCli_7531: bitstring = pub(skC) in
                                {8573}let v_7532: bool = (Disco_5021 = A) in
                                (
                                    {8574}if v_7532 then
                                    (
                                        {8575}let pkDisco_7533: bitstring = pub(skA) in
                                        {8576}in(c, (=pkCli_7531,em1_7534: bitstring));
                                        {8577}let m1_7535: bitstring = em1_7534 in
                                        {8578}let (=OpenSecureChannelRequest,=pkCli_7531,Nc_7536: bitstring) = m1_7535 in
                                        {8579}new Ns_7537: bitstring;
                                        {8580}new ST_7538: bitstring;
                                        {8581}new TTL_7539: bitstring;
                                        {8582}let m2_7540: bitstring = (OpenSecureChannelResponse,Ns_7537,ST_7538,TTL_7539) in
                                        {8583}out(c, m2_7540);
                                        {8584}let Ksrv_7541: bitstring = h((Ns_7537,Nc_7536)) in
                                        {8585}out(c, senc(mSrv(pkCli_7531,pkSess_7393),Ksrv_7541))
                                    )
                                    else
                                        {8586}let v_7542: bool = (Disco_5021 = B) in
                                        (
                                            {8587}if v_7542 then
                                            (
                                                {8588}let pkDisco_7543: bitstring = pub(skB) in
                                                {8589}in(c, (=pkCli_7531,em1_7544: bitstring));
                                                {8590}let m1_7545: bitstring = em1_7544 in
                                                {8591}let (=OpenSecureChannelRequest,=pkCli_7531,Nc_7546: bitstring) = m1_7545 in
                                                {8592}new Ns_7547: bitstring;
                                                {8593}new ST_7548: bitstring;
                                                {8594}new TTL_7549: bitstring;
                                                {8595}let m2_7550: bitstring = (OpenSecureChannelResponse,Ns_7547,ST_7548,TTL_7549) in
                                                {8596}out(c, m2_7550);
                                                {8597}let Ksrv_7551: bitstring = h((Ns_7547,Nc_7546)) in
                                                {8598}out(c, senc(mSrv(pkCli_7531,pkSess_7393),Ksrv_7551))
                                            )
                                            else
                                                {8599}let v_7552: bool = (Disco_5021 = C) in
                                                (
                                                    {8600}if v_7552 then
                                                    (
                                                        {8601}let pkDisco_7553: bitstring = pub(skC) in
                                                        {8602}in(c, (=pkCli_7531,em1_7554: bitstring));
                                                        {8603}let m1_7555: bitstring = em1_7554 in
                                                        {8604}let (=OpenSecureChannelRequest,=pkCli_7531,Nc_7556: bitstring) = m1_7555 in
                                                        {8605}new Ns_7557: bitstring;
                                                        {8606}new ST_7558: bitstring;
                                                        {8607}new TTL_7559: bitstring;
                                                        {8608}let m2_7560: bitstring = (OpenSecureChannelResponse,Ns_7557,ST_7558,TTL_7559) in
                                                        {8609}out(c, m2_7560);
                                                        {8610}let Ksrv_7561: bitstring = h((Ns_7557,Nc_7556)) in
                                                        {8611}out(c, senc(mSrv(pkCli_7531,pkSess_7393),Ksrv_7561))
                                                    )
                                                    else
                                                        {8612}let pkDisco_7562: bitstring = pub(sk(Disco_5021)) in
                                                        {8613}in(c, (=pkCli_7531,em1_7563: bitstring));
                                                        {8614}let m1_7564: bitstring = em1_7563 in
                                                        {8615}let (=OpenSecureChannelRequest,=pkCli_7531,Nc_7565: bitstring) = m1_7564 in
                                                        {8616}new Ns_7566: bitstring;
                                                        {8617}new ST_7567: bitstring;
                                                        {8618}new TTL_7568: bitstring;
                                                        {8619}let m2_7569: bitstring = (OpenSecureChannelResponse,Ns_7566,ST_7567,TTL_7568) in
                                                        {8620}out(c, m2_7569);
                                                        {8621}let Ksrv_7570: bitstring = h((Ns_7566,Nc_7565)) in
                                                        {8622}out(c, senc(mSrv(pkCli_7531,pkSess_7393),Ksrv_7570))
                                                )
                                                else
                                                    {8623}let pkDisco_7571: bitstring = fail-any in
                                                    {8624}in(c, (=pkCli_7531,em1_7572: bitstring));
                                                    {8625}let m1_7573: bitstring = em1_7572 in
                                                    {8626}let (=OpenSecureChannelRequest,=pkCli_7531,Nc_7574: bitstring) = m1_7573 in
                                                    {8627}new Ns_7575: bitstring;
                                                    {8628}new ST_7576: bitstring;
                                                    {8629}new TTL_7577: bitstring;
                                                    {8630}let m2_7578: bitstring = (OpenSecureChannelResponse,Ns_7575,ST_7576,TTL_7577) in
                                                    {8631}out(c, m2_7578);
                                                    {8632}let Ksrv_7579: bitstring = h((Ns_7575,Nc_7574)) in
                                                    {8633}out(c, senc(mSrv(pkCli_7531,pkSess_7393),Ksrv_7579))
                                        )
                                        else
                                            {8634}let pkDisco_7580: bitstring = fail-any in
                                            {8635}in(c, (=pkCli_7531,em1_7581: bitstring));
                                            {8636}let m1_7582: bitstring = em1_7581 in
                                            {8637}let (=OpenSecureChannelRequest,=pkCli_7531,Nc_7583: bitstring) = m1_7582 in
                                            {8638}new Ns_7584: bitstring;
                                            {8639}new ST_7585: bitstring;
                                            {8640}new TTL_7586: bitstring;
                                            {8641}let m2_7587: bitstring = (OpenSecureChannelResponse,Ns_7584,ST_7585,TTL_7586) in
                                            {8642}out(c, m2_7587);
                                            {8643}let Ksrv_7588: bitstring = h((Ns_7584,Nc_7583)) in
                                            {8644}out(c, senc(mSrv(pkCli_7531,pkSess_7393),Ksrv_7588))
                                )
                                else
                                    {8645}let pkDisco_7589: bitstring = fail-any in
                                    {8646}in(c, (=pkCli_7531,em1_7590: bitstring));
                                    {8647}let m1_7591: bitstring = em1_7590 in
                                    {8648}let (=OpenSecureChannelRequest,=pkCli_7531,Nc_7592: bitstring) = m1_7591 in
                                    {8649}new Ns_7593: bitstring;
                                    {8650}new ST_7594: bitstring;
                                    {8651}new TTL_7595: bitstring;
                                    {8652}let m2_7596: bitstring = (OpenSecureChannelResponse,Ns_7593,ST_7594,TTL_7595) in
                                    {8653}out(c, m2_7596);
                                    {8654}let Ksrv_7597: bitstring = h((Ns_7593,Nc_7592)) in
                                    {8655}out(c, senc(mSrv(pkCli_7531,pkSess_7393),Ksrv_7597))
                            )
                            else
                                {8656}let pkCli_7598: bitstring = pub(sk(Cli_5020)) in
                                {8657}let v_7599: bool = (Disco_5021 = A) in
                                (
                                    {8658}if v_7599 then
                                    (
                                        {8659}let pkDisco_7600: bitstring = pub(skA) in
                                        {8660}in(c, (=pkCli_7598,em1_7601: bitstring));
                                        {8661}let m1_7602: bitstring = em1_7601 in
                                        {8662}let (=OpenSecureChannelRequest,=pkCli_7598,Nc_7603: bitstring) = m1_7602 in
                                        {8663}new Ns_7604: bitstring;
                                        {8664}new ST_7605: bitstring;
                                        {8665}new TTL_7606: bitstring;
                                        {8666}let m2_7607: bitstring = (OpenSecureChannelResponse,Ns_7604,ST_7605,TTL_7606) in
                                        {8667}out(c, m2_7607);
                                        {8668}let Ksrv_7608: bitstring = h((Ns_7604,Nc_7603)) in
                                        {8669}out(c, senc(mSrv(pkCli_7598,pkSess_7393),Ksrv_7608))
                                    )
                                    else
                                        {8670}let v_7609: bool = (Disco_5021 = B) in
                                        (
                                            {8671}if v_7609 then
                                            (
                                                {8672}let pkDisco_7610: bitstring = pub(skB) in
                                                {8673}in(c, (=pkCli_7598,em1_7611: bitstring));
                                                {8674}let m1_7612: bitstring = em1_7611 in
                                                {8675}let (=OpenSecureChannelRequest,=pkCli_7598,Nc_7613: bitstring) = m1_7612 in
                                                {8676}new Ns_7614: bitstring;
                                                {8677}new ST_7615: bitstring;
                                                {8678}new TTL_7616: bitstring;
                                                {8679}let m2_7617: bitstring = (OpenSecureChannelResponse,Ns_7614,ST_7615,TTL_7616) in
                                                {8680}out(c, m2_7617);
                                                {8681}let Ksrv_7618: bitstring = h((Ns_7614,Nc_7613)) in
                                                {8682}out(c, senc(mSrv(pkCli_7598,pkSess_7393),Ksrv_7618))
                                            )
                                            else
                                                {8683}let v_7619: bool = (Disco_5021 = C) in
                                                (
                                                    {8684}if v_7619 then
                                                    (
                                                        {8685}let pkDisco_7620: bitstring = pub(skC) in
                                                        {8686}in(c, (=pkCli_7598,em1_7621: bitstring));
                                                        {8687}let m1_7622: bitstring = em1_7621 in
                                                        {8688}let (=OpenSecureChannelRequest,=pkCli_7598,Nc_7623: bitstring) = m1_7622 in
                                                        {8689}new Ns_7624: bitstring;
                                                        {8690}new ST_7625: bitstring;
                                                        {8691}new TTL_7626: bitstring;
                                                        {8692}let m2_7627: bitstring = (OpenSecureChannelResponse,Ns_7624,ST_7625,TTL_7626) in
                                                        {8693}out(c, m2_7627);
                                                        {8694}let Ksrv_7628: bitstring = h((Ns_7624,Nc_7623)) in
                                                        {8695}out(c, senc(mSrv(pkCli_7598,pkSess_7393),Ksrv_7628))
                                                    )
                                                    else
                                                        {8696}let pkDisco_7629: bitstring = pub(sk(Disco_5021)) in
                                                        {8697}in(c, (=pkCli_7598,em1_7630: bitstring));
                                                        {8698}let m1_7631: bitstring = em1_7630 in
                                                        {8699}let (=OpenSecureChannelRequest,=pkCli_7598,Nc_7632: bitstring) = m1_7631 in
                                                        {8700}new Ns_7633: bitstring;
                                                        {8701}new ST_7634: bitstring;
                                                        {8702}new TTL_7635: bitstring;
                                                        {8703}let m2_7636: bitstring = (OpenSecureChannelResponse,Ns_7633,ST_7634,TTL_7635) in
                                                        {8704}out(c, m2_7636);
                                                        {8705}let Ksrv_7637: bitstring = h((Ns_7633,Nc_7632)) in
                                                        {8706}out(c, senc(mSrv(pkCli_7598,pkSess_7393),Ksrv_7637))
                                                )
                                                else
                                                    {8707}let pkDisco_7638: bitstring = fail-any in
                                                    {8708}in(c, (=pkCli_7598,em1_7639: bitstring));
                                                    {8709}let m1_7640: bitstring = em1_7639 in
                                                    {8710}let (=OpenSecureChannelRequest,=pkCli_7598,Nc_7641: bitstring) = m1_7640 in
                                                    {8711}new Ns_7642: bitstring;
                                                    {8712}new ST_7643: bitstring;
                                                    {8713}new TTL_7644: bitstring;
                                                    {8714}let m2_7645: bitstring = (OpenSecureChannelResponse,Ns_7642,ST_7643,TTL_7644) in
                                                    {8715}out(c, m2_7645);
                                                    {8716}let Ksrv_7646: bitstring = h((Ns_7642,Nc_7641)) in
                                                    {8717}out(c, senc(mSrv(pkCli_7598,pkSess_7393),Ksrv_7646))
                                        )
                                        else
                                            {8718}let pkDisco_7647: bitstring = fail-any in
                                            {8719}in(c, (=pkCli_7598,em1_7648: bitstring));
                                            {8720}let m1_7649: bitstring = em1_7648 in
                                            {8721}let (=OpenSecureChannelRequest,=pkCli_7598,Nc_7650: bitstring) = m1_7649 in
                                            {8722}new Ns_7651: bitstring;
                                            {8723}new ST_7652: bitstring;
                                            {8724}new TTL_7653: bitstring;
                                            {8725}let m2_7654: bitstring = (OpenSecureChannelResponse,Ns_7651,ST_7652,TTL_7653) in
                                            {8726}out(c, m2_7654);
                                            {8727}let Ksrv_7655: bitstring = h((Ns_7651,Nc_7650)) in
                                            {8728}out(c, senc(mSrv(pkCli_7598,pkSess_7393),Ksrv_7655))
                                )
                                else
                                    {8729}let pkDisco_7656: bitstring = fail-any in
                                    {8730}in(c, (=pkCli_7598,em1_7657: bitstring));
                                    {8731}let m1_7658: bitstring = em1_7657 in
                                    {8732}let (=OpenSecureChannelRequest,=pkCli_7598,Nc_7659: bitstring) = m1_7658 in
                                    {8733}new Ns_7660: bitstring;
                                    {8734}new ST_7661: bitstring;
                                    {8735}new TTL_7662: bitstring;
                                    {8736}let m2_7663: bitstring = (OpenSecureChannelResponse,Ns_7660,ST_7661,TTL_7662) in
                                    {8737}out(c, m2_7663);
                                    {8738}let Ksrv_7664: bitstring = h((Ns_7660,Nc_7659)) in
                                    {8739}out(c, senc(mSrv(pkCli_7598,pkSess_7393),Ksrv_7664))
                        )
                        else
                            {8740}let pkCli_7665: bitstring = fail-any in
                            {8741}let v_7666: bool = (Disco_5021 = A) in
                            (
                                {8742}if v_7666 then
                                (
                                    {8743}let pkDisco_7667: bitstring = pub(skA) in
                                    {8744}in(c, (=pkCli_7665,em1_7668: bitstring));
                                    {8745}let m1_7669: bitstring = em1_7668 in
                                    {8746}let (=OpenSecureChannelRequest,=pkCli_7665,Nc_7670: bitstring) = m1_7669 in
                                    {8747}new Ns_7671: bitstring;
                                    {8748}new ST_7672: bitstring;
                                    {8749}new TTL_7673: bitstring;
                                    {8750}let m2_7674: bitstring = (OpenSecureChannelResponse,Ns_7671,ST_7672,TTL_7673) in
                                    {8751}out(c, m2_7674);
                                    {8752}let Ksrv_7675: bitstring = h((Ns_7671,Nc_7670)) in
                                    {8753}out(c, senc(mSrv(pkCli_7665,pkSess_7393),Ksrv_7675))
                                )
                                else
                                    {8754}let v_7676: bool = (Disco_5021 = B) in
                                    (
                                        {8755}if v_7676 then
                                        (
                                            {8756}let pkDisco_7677: bitstring = pub(skB) in
                                            {8757}in(c, (=pkCli_7665,em1_7678: bitstring));
                                            {8758}let m1_7679: bitstring = em1_7678 in
                                            {8759}let (=OpenSecureChannelRequest,=pkCli_7665,Nc_7680: bitstring) = m1_7679 in
                                            {8760}new Ns_7681: bitstring;
                                            {8761}new ST_7682: bitstring;
                                            {8762}new TTL_7683: bitstring;
                                            {8763}let m2_7684: bitstring = (OpenSecureChannelResponse,Ns_7681,ST_7682,TTL_7683) in
                                            {8764}out(c, m2_7684);
                                            {8765}let Ksrv_7685: bitstring = h((Ns_7681,Nc_7680)) in
                                            {8766}out(c, senc(mSrv(pkCli_7665,pkSess_7393),Ksrv_7685))
                                        )
                                        else
                                            {8767}let v_7686: bool = (Disco_5021 = C) in
                                            (
                                                {8768}if v_7686 then
                                                (
                                                    {8769}let pkDisco_7687: bitstring = pub(skC) in
                                                    {8770}in(c, (=pkCli_7665,em1_7688: bitstring));
                                                    {8771}let m1_7689: bitstring = em1_7688 in
                                                    {8772}let (=OpenSecureChannelRequest,=pkCli_7665,Nc_7690: bitstring) = m1_7689 in
                                                    {8773}new Ns_7691: bitstring;
                                                    {8774}new ST_7692: bitstring;
                                                    {8775}new TTL_7693: bitstring;
                                                    {8776}let m2_7694: bitstring = (OpenSecureChannelResponse,Ns_7691,ST_7692,TTL_7693) in
                                                    {8777}out(c, m2_7694);
                                                    {8778}let Ksrv_7695: bitstring = h((Ns_7691,Nc_7690)) in
                                                    {8779}out(c, senc(mSrv(pkCli_7665,pkSess_7393),Ksrv_7695))
                                                )
                                                else
                                                    {8780}let pkDisco_7696: bitstring = pub(sk(Disco_5021)) in
                                                    {8781}in(c, (=pkCli_7665,em1_7697: bitstring));
                                                    {8782}let m1_7698: bitstring = em1_7697 in
                                                    {8783}let (=OpenSecureChannelRequest,=pkCli_7665,Nc_7699: bitstring) = m1_7698 in
                                                    {8784}new Ns_7700: bitstring;
                                                    {8785}new ST_7701: bitstring;
                                                    {8786}new TTL_7702: bitstring;
                                                    {8787}let m2_7703: bitstring = (OpenSecureChannelResponse,Ns_7700,ST_7701,TTL_7702) in
                                                    {8788}out(c, m2_7703);
                                                    {8789}let Ksrv_7704: bitstring = h((Ns_7700,Nc_7699)) in
                                                    {8790}out(c, senc(mSrv(pkCli_7665,pkSess_7393),Ksrv_7704))
                                            )
                                            else
                                                {8791}let pkDisco_7705: bitstring = fail-any in
                                                {8792}in(c, (=pkCli_7665,em1_7706: bitstring));
                                                {8793}let m1_7707: bitstring = em1_7706 in
                                                {8794}let (=OpenSecureChannelRequest,=pkCli_7665,Nc_7708: bitstring) = m1_7707 in
                                                {8795}new Ns_7709: bitstring;
                                                {8796}new ST_7710: bitstring;
                                                {8797}new TTL_7711: bitstring;
                                                {8798}let m2_7712: bitstring = (OpenSecureChannelResponse,Ns_7709,ST_7710,TTL_7711) in
                                                {8799}out(c, m2_7712);
                                                {8800}let Ksrv_7713: bitstring = h((Ns_7709,Nc_7708)) in
                                                {8801}out(c, senc(mSrv(pkCli_7665,pkSess_7393),Ksrv_7713))
                                    )
                                    else
                                        {8802}let pkDisco_7714: bitstring = fail-any in
                                        {8803}in(c, (=pkCli_7665,em1_7715: bitstring));
                                        {8804}let m1_7716: bitstring = em1_7715 in
                                        {8805}let (=OpenSecureChannelRequest,=pkCli_7665,Nc_7717: bitstring) = m1_7716 in
                                        {8806}new Ns_7718: bitstring;
                                        {8807}new ST_7719: bitstring;
                                        {8808}new TTL_7720: bitstring;
                                        {8809}let m2_7721: bitstring = (OpenSecureChannelResponse,Ns_7718,ST_7719,TTL_7720) in
                                        {8810}out(c, m2_7721);
                                        {8811}let Ksrv_7722: bitstring = h((Ns_7718,Nc_7717)) in
                                        {8812}out(c, senc(mSrv(pkCli_7665,pkSess_7393),Ksrv_7722))
                            )
                            else
                                {8813}let pkDisco_7723: bitstring = fail-any in
                                {8814}in(c, (=pkCli_7665,em1_7724: bitstring));
                                {8815}let m1_7725: bitstring = em1_7724 in
                                {8816}let (=OpenSecureChannelRequest,=pkCli_7665,Nc_7726: bitstring) = m1_7725 in
                                {8817}new Ns_7727: bitstring;
                                {8818}new ST_7728: bitstring;
                                {8819}new TTL_7729: bitstring;
                                {8820}let m2_7730: bitstring = (OpenSecureChannelResponse,Ns_7727,ST_7728,TTL_7729) in
                                {8821}out(c, m2_7730);
                                {8822}let Ksrv_7731: bitstring = h((Ns_7727,Nc_7726)) in
                                {8823}out(c, senc(mSrv(pkCli_7665,pkSess_7393),Ksrv_7731))
                )
                else
                    {8824}let pkCli_7732: bitstring = fail-any in
                    {8825}let v_7733: bool = (Disco_5021 = A) in
                    (
                        {8826}if v_7733 then
                        (
                            {8827}let pkDisco_7734: bitstring = pub(skA) in
                            {8828}in(c, (=pkCli_7732,em1_7735: bitstring));
                            {8829}let m1_7736: bitstring = em1_7735 in
                            {8830}let (=OpenSecureChannelRequest,=pkCli_7732,Nc_7737: bitstring) = m1_7736 in
                            {8831}new Ns_7738: bitstring;
                            {8832}new ST_7739: bitstring;
                            {8833}new TTL_7740: bitstring;
                            {8834}let m2_7741: bitstring = (OpenSecureChannelResponse,Ns_7738,ST_7739,TTL_7740) in
                            {8835}out(c, m2_7741);
                            {8836}let Ksrv_7742: bitstring = h((Ns_7738,Nc_7737)) in
                            {8837}out(c, senc(mSrv(pkCli_7732,pkSess_7393),Ksrv_7742))
                        )
                        else
                            {8838}let v_7743: bool = (Disco_5021 = B) in
                            (
                                {8839}if v_7743 then
                                (
                                    {8840}let pkDisco_7744: bitstring = pub(skB) in
                                    {8841}in(c, (=pkCli_7732,em1_7745: bitstring));
                                    {8842}let m1_7746: bitstring = em1_7745 in
                                    {8843}let (=OpenSecureChannelRequest,=pkCli_7732,Nc_7747: bitstring) = m1_7746 in
                                    {8844}new Ns_7748: bitstring;
                                    {8845}new ST_7749: bitstring;
                                    {8846}new TTL_7750: bitstring;
                                    {8847}let m2_7751: bitstring = (OpenSecureChannelResponse,Ns_7748,ST_7749,TTL_7750) in
                                    {8848}out(c, m2_7751);
                                    {8849}let Ksrv_7752: bitstring = h((Ns_7748,Nc_7747)) in
                                    {8850}out(c, senc(mSrv(pkCli_7732,pkSess_7393),Ksrv_7752))
                                )
                                else
                                    {8851}let v_7753: bool = (Disco_5021 = C) in
                                    (
                                        {8852}if v_7753 then
                                        (
                                            {8853}let pkDisco_7754: bitstring = pub(skC) in
                                            {8854}in(c, (=pkCli_7732,em1_7755: bitstring));
                                            {8855}let m1_7756: bitstring = em1_7755 in
                                            {8856}let (=OpenSecureChannelRequest,=pkCli_7732,Nc_7757: bitstring) = m1_7756 in
                                            {8857}new Ns_7758: bitstring;
                                            {8858}new ST_7759: bitstring;
                                            {8859}new TTL_7760: bitstring;
                                            {8860}let m2_7761: bitstring = (OpenSecureChannelResponse,Ns_7758,ST_7759,TTL_7760) in
                                            {8861}out(c, m2_7761);
                                            {8862}let Ksrv_7762: bitstring = h((Ns_7758,Nc_7757)) in
                                            {8863}out(c, senc(mSrv(pkCli_7732,pkSess_7393),Ksrv_7762))
                                        )
                                        else
                                            {8864}let pkDisco_7763: bitstring = pub(sk(Disco_5021)) in
                                            {8865}in(c, (=pkCli_7732,em1_7764: bitstring));
                                            {8866}let m1_7765: bitstring = em1_7764 in
                                            {8867}let (=OpenSecureChannelRequest,=pkCli_7732,Nc_7766: bitstring) = m1_7765 in
                                            {8868}new Ns_7767: bitstring;
                                            {8869}new ST_7768: bitstring;
                                            {8870}new TTL_7769: bitstring;
                                            {8871}let m2_7770: bitstring = (OpenSecureChannelResponse,Ns_7767,ST_7768,TTL_7769) in
                                            {8872}out(c, m2_7770);
                                            {8873}let Ksrv_7771: bitstring = h((Ns_7767,Nc_7766)) in
                                            {8874}out(c, senc(mSrv(pkCli_7732,pkSess_7393),Ksrv_7771))
                                    )
                                    else
                                        {8875}let pkDisco_7772: bitstring = fail-any in
                                        {8876}in(c, (=pkCli_7732,em1_7773: bitstring));
                                        {8877}let m1_7774: bitstring = em1_7773 in
                                        {8878}let (=OpenSecureChannelRequest,=pkCli_7732,Nc_7775: bitstring) = m1_7774 in
                                        {8879}new Ns_7776: bitstring;
                                        {8880}new ST_7777: bitstring;
                                        {8881}new TTL_7778: bitstring;
                                        {8882}let m2_7779: bitstring = (OpenSecureChannelResponse,Ns_7776,ST_7777,TTL_7778) in
                                        {8883}out(c, m2_7779);
                                        {8884}let Ksrv_7780: bitstring = h((Ns_7776,Nc_7775)) in
                                        {8885}out(c, senc(mSrv(pkCli_7732,pkSess_7393),Ksrv_7780))
                            )
                            else
                                {8886}let pkDisco_7781: bitstring = fail-any in
                                {8887}in(c, (=pkCli_7732,em1_7782: bitstring));
                                {8888}let m1_7783: bitstring = em1_7782 in
                                {8889}let (=OpenSecureChannelRequest,=pkCli_7732,Nc_7784: bitstring) = m1_7783 in
                                {8890}new Ns_7785: bitstring;
                                {8891}new ST_7786: bitstring;
                                {8892}new TTL_7787: bitstring;
                                {8893}let m2_7788: bitstring = (OpenSecureChannelResponse,Ns_7785,ST_7786,TTL_7787) in
                                {8894}out(c, m2_7788);
                                {8895}let Ksrv_7789: bitstring = h((Ns_7785,Nc_7784)) in
                                {8896}out(c, senc(mSrv(pkCli_7732,pkSess_7393),Ksrv_7789))
                    )
                    else
                        {8897}let pkDisco_7790: bitstring = fail-any in
                        {8898}in(c, (=pkCli_7732,em1_7791: bitstring));
                        {8899}let m1_7792: bitstring = em1_7791 in
                        {8900}let (=OpenSecureChannelRequest,=pkCli_7732,Nc_7793: bitstring) = m1_7792 in
                        {8901}new Ns_7794: bitstring;
                        {8902}new ST_7795: bitstring;
                        {8903}new TTL_7796: bitstring;
                        {8904}let m2_7797: bitstring = (OpenSecureChannelResponse,Ns_7794,ST_7795,TTL_7796) in
                        {8905}out(c, m2_7797);
                        {8906}let Ksrv_7798: bitstring = h((Ns_7794,Nc_7793)) in
                        {8907}out(c, senc(mSrv(pkCli_7732,pkSess_7393),Ksrv_7798))
        )
        else
            {8908}let pkCli_7799: bitstring = fail-any in
            {8909}let v_7800: bool = (Disco_5021 = A) in
            (
                {8910}if v_7800 then
                (
                    {8911}let pkDisco_7801: bitstring = pub(skA) in
                    {8912}in(c, (=pkCli_7799,em1_7802: bitstring));
                    {8913}let m1_7803: bitstring = em1_7802 in
                    {8914}let (=OpenSecureChannelRequest,=pkCli_7799,Nc_7804: bitstring) = m1_7803 in
                    {8915}new Ns_7805: bitstring;
                    {8916}new ST_7806: bitstring;
                    {8917}new TTL_7807: bitstring;
                    {8918}let m2_7808: bitstring = (OpenSecureChannelResponse,Ns_7805,ST_7806,TTL_7807) in
                    {8919}out(c, m2_7808);
                    {8920}let Ksrv_7809: bitstring = h((Ns_7805,Nc_7804)) in
                    {8921}out(c, senc(mSrv(pkCli_7799,pkSess_7393),Ksrv_7809))
                )
                else
                    {8922}let v_7810: bool = (Disco_5021 = B) in
                    (
                        {8923}if v_7810 then
                        (
                            {8924}let pkDisco_7811: bitstring = pub(skB) in
                            {8925}in(c, (=pkCli_7799,em1_7812: bitstring));
                            {8926}let m1_7813: bitstring = em1_7812 in
                            {8927}let (=OpenSecureChannelRequest,=pkCli_7799,Nc_7814: bitstring) = m1_7813 in
                            {8928}new Ns_7815: bitstring;
                            {8929}new ST_7816: bitstring;
                            {8930}new TTL_7817: bitstring;
                            {8931}let m2_7818: bitstring = (OpenSecureChannelResponse,Ns_7815,ST_7816,TTL_7817) in
                            {8932}out(c, m2_7818);
                            {8933}let Ksrv_7819: bitstring = h((Ns_7815,Nc_7814)) in
                            {8934}out(c, senc(mSrv(pkCli_7799,pkSess_7393),Ksrv_7819))
                        )
                        else
                            {8935}let v_7820: bool = (Disco_5021 = C) in
                            (
                                {8936}if v_7820 then
                                (
                                    {8937}let pkDisco_7821: bitstring = pub(skC) in
                                    {8938}in(c, (=pkCli_7799,em1_7822: bitstring));
                                    {8939}let m1_7823: bitstring = em1_7822 in
                                    {8940}let (=OpenSecureChannelRequest,=pkCli_7799,Nc_7824: bitstring) = m1_7823 in
                                    {8941}new Ns_7825: bitstring;
                                    {8942}new ST_7826: bitstring;
                                    {8943}new TTL_7827: bitstring;
                                    {8944}let m2_7828: bitstring = (OpenSecureChannelResponse,Ns_7825,ST_7826,TTL_7827) in
                                    {8945}out(c, m2_7828);
                                    {8946}let Ksrv_7829: bitstring = h((Ns_7825,Nc_7824)) in
                                    {8947}out(c, senc(mSrv(pkCli_7799,pkSess_7393),Ksrv_7829))
                                )
                                else
                                    {8948}let pkDisco_7830: bitstring = pub(sk(Disco_5021)) in
                                    {8949}in(c, (=pkCli_7799,em1_7831: bitstring));
                                    {8950}let m1_7832: bitstring = em1_7831 in
                                    {8951}let (=OpenSecureChannelRequest,=pkCli_7799,Nc_7833: bitstring) = m1_7832 in
                                    {8952}new Ns_7834: bitstring;
                                    {8953}new ST_7835: bitstring;
                                    {8954}new TTL_7836: bitstring;
                                    {8955}let m2_7837: bitstring = (OpenSecureChannelResponse,Ns_7834,ST_7835,TTL_7836) in
                                    {8956}out(c, m2_7837);
                                    {8957}let Ksrv_7838: bitstring = h((Ns_7834,Nc_7833)) in
                                    {8958}out(c, senc(mSrv(pkCli_7799,pkSess_7393),Ksrv_7838))
                            )
                            else
                                {8959}let pkDisco_7839: bitstring = fail-any in
                                {8960}in(c, (=pkCli_7799,em1_7840: bitstring));
                                {8961}let m1_7841: bitstring = em1_7840 in
                                {8962}let (=OpenSecureChannelRequest,=pkCli_7799,Nc_7842: bitstring) = m1_7841 in
                                {8963}new Ns_7843: bitstring;
                                {8964}new ST_7844: bitstring;
                                {8965}new TTL_7845: bitstring;
                                {8966}let m2_7846: bitstring = (OpenSecureChannelResponse,Ns_7843,ST_7844,TTL_7845) in
                                {8967}out(c, m2_7846);
                                {8968}let Ksrv_7847: bitstring = h((Ns_7843,Nc_7842)) in
                                {8969}out(c, senc(mSrv(pkCli_7799,pkSess_7393),Ksrv_7847))
                    )
                    else
                        {8970}let pkDisco_7848: bitstring = fail-any in
                        {8971}in(c, (=pkCli_7799,em1_7849: bitstring));
                        {8972}let m1_7850: bitstring = em1_7849 in
                        {8973}let (=OpenSecureChannelRequest,=pkCli_7799,Nc_7851: bitstring) = m1_7850 in
                        {8974}new Ns_7852: bitstring;
                        {8975}new ST_7853: bitstring;
                        {8976}new TTL_7854: bitstring;
                        {8977}let m2_7855: bitstring = (OpenSecureChannelResponse,Ns_7852,ST_7853,TTL_7854) in
                        {8978}out(c, m2_7855);
                        {8979}let Ksrv_7856: bitstring = h((Ns_7852,Nc_7851)) in
                        {8980}out(c, senc(mSrv(pkCli_7799,pkSess_7393),Ksrv_7856))
            )
            else
                {8981}let pkDisco_7857: bitstring = fail-any in
                {8982}in(c, (=pkCli_7799,em1_7858: bitstring));
                {8983}let m1_7859: bitstring = em1_7858 in
                {8984}let (=OpenSecureChannelRequest,=pkCli_7799,Nc_7860: bitstring) = m1_7859 in
                {8985}new Ns_7861: bitstring;
                {8986}new ST_7862: bitstring;
                {8987}new TTL_7863: bitstring;
                {8988}let m2_7864: bitstring = (OpenSecureChannelResponse,Ns_7861,ST_7862,TTL_7863) in
                {8989}out(c, m2_7864);
                {8990}let Ksrv_7865: bitstring = h((Ns_7861,Nc_7860)) in
                {8991}out(c, senc(mSrv(pkCli_7799,pkSess_7393),Ksrv_7865))
)

-- Query not attacker(mSrv(pub(skA[]),pub(skC[])))
Completing...
200 rules inserted. The rule base contains 75 rules. 388 rules in the queue.
400 rules inserted. The rule base contains 107 rules. 388 rules in the queue.
600 rules inserted. The rule base contains 123 rules. 386 rules in the queue.
800 rules inserted. The rule base contains 123 rules. 386 rules in the queue.
1000 rules inserted. The rule base contains 127 rules. 368 rules in the queue.
1200 rules inserted. The rule base contains 97 rules. 360 rules in the queue.
1400 rules inserted. The rule base contains 143 rules. 294 rules in the queue.
1600 rules inserted. The rule base contains 161 rules. 280 rules in the queue.
1800 rules inserted. The rule base contains 265 rules. 201 rules in the queue.
2000 rules inserted. The rule base contains 390 rules. 111 rules in the queue.
Starting query not attacker(mSrv(pub(skA[]),pub(skC[])))
goal reachable: attacker(mSrv(pub(skA[]),pub(skC[])))
Abbreviations:
Ns_33345 = Ns_5979[em1_5976 = (OpenSecureChannelRequest,pub(skA[]),Nc_33341),Sess_5022 = C[],Disco_5021 = A[],Cli_5020 = A[],!1 = @sid_33342]
ST_33346 = ST_5980[em1_5976 = (OpenSecureChannelRequest,pub(skA[]),Nc_33341),Sess_5022 = C[],Disco_5021 = A[],Cli_5020 = A[],!1 = @sid_33342]
TTL_33347 = TTL_5981[em1_5976 = (OpenSecureChannelRequest,pub(skA[]),Nc_33341),Sess_5022 = C[],Disco_5021 = A[],Cli_5020 = A[],!1 = @sid_33342]

1. The attacker has some term Nc_33341.
attacker(Nc_33341).

2. The attacker initially knows C[].
attacker(C[]).

3. The attacker initially knows A[].
attacker(A[]).

4. By 3, the attacker may know A[].
By 3, the attacker may know A[].
By 2, the attacker may know C[].
Using the function 3-tuple the attacker may obtain (A[],A[],C[]).
attacker((A[],A[],C[])).

5. The message pub(skA[]) may be sent to the attacker at output {2}.
attacker(pub(skA[])).

6. Using the function OpenSecureChannelRequest the attacker may obtain OpenSecureChannelRequest.
attacker(OpenSecureChannelRequest).

7. By 6, the attacker may know OpenSecureChannelRequest.
By 5, the attacker may know pub(skA[]).
By 1, the attacker may know Nc_33341.
Using the function 3-tuple the attacker may obtain (OpenSecureChannelRequest,pub(skA[]),Nc_33341).
attacker((OpenSecureChannelRequest,pub(skA[]),Nc_33341)).

8. By 5, the attacker may know pub(skA[]).
By 7, the attacker may know (OpenSecureChannelRequest,pub(skA[]),Nc_33341).
Using the function 2-tuple the attacker may obtain (pub(skA[]),(OpenSecureChannelRequest,pub(skA[]),Nc_33341)).
attacker((pub(skA[]),(OpenSecureChannelRequest,pub(skA[]),Nc_33341))).

9. The message (A[],A[],C[]) that the attacker may have by 4 may be received at input {5410}.
The message (pub(skA[]),(OpenSecureChannelRequest,pub(skA[]),Nc_33341)) that the attacker may have by 8 may be received at input {6616}.
So the message (OpenSecureChannelResponse,Ns_33345,ST_33346,TTL_33347) may be sent to the attacker at output {6623}.
attacker((OpenSecureChannelResponse,Ns_33345,ST_33346,TTL_33347)).

10. By 9, the attacker may know (OpenSecureChannelResponse,Ns_33345,ST_33346,TTL_33347).
Using the function 2-proj-4-tuple the attacker may obtain Ns_33345.
attacker(Ns_33345).

11. By 10, the attacker may know Ns_33345.
By 1, the attacker may know Nc_33341.
Using the function 2-tuple the attacker may obtain (Ns_33345,Nc_33341).
attacker((Ns_33345,Nc_33341)).

12. By 11, the attacker may know (Ns_33345,Nc_33341).
Using the function h the attacker may obtain h((Ns_33345,Nc_33341)).
attacker(h((Ns_33345,Nc_33341))).

13. The message (A[],A[],C[]) that the attacker may have by 4 may be received at input {5410}.
The message (pub(skA[]),(OpenSecureChannelRequest,pub(skA[]),Nc_33341)) that the attacker may have by 8 may be received at input {6616}.
So the message senc(mSrv(pub(skA[]),pub(skC[])),h((Ns_33345,Nc_33341))) may be sent to the attacker at output {6625}.
attacker(senc(mSrv(pub(skA[]),pub(skC[])),h((Ns_33345,Nc_33341)))).

14. By 13, the attacker may know senc(mSrv(pub(skA[]),pub(skC[])),h((Ns_33345,Nc_33341))).
By 12, the attacker may know h((Ns_33345,Nc_33341)).
Using the function sdec the attacker may obtain mSrv(pub(skA[]),pub(skC[])).
attacker(mSrv(pub(skA[]),pub(skC[]))).


A more detailed output of the traces is available with
  set traceDisplay = long.

out(c, pub(skA)) at {2}

out(c, pub(skB)) at {4}

out(c, pub(skC)) at {6}

in(c, (A,A,C)) at {5410} in copy a_33348

in(c, (pub(skA),(OpenSecureChannelRequest,pub(skA),a))) at {6616} in copy a_33348

new Ns_5979 creating Ns_33349 at {6619} in copy a_33348

new ST_5980 creating ST_33350 at {6620} in copy a_33348

new TTL_5981 creating TTL_33351 at {6621} in copy a_33348

out(c, (OpenSecureChannelResponse,Ns_33349,ST_33350,TTL_33351)) at {6623} in copy a_33348

out(c, senc(mSrv(pub(skA),pub(skC)),h((Ns_33349,a)))) at {6625} in copy a_33348

The attacker has the message mSrv(pub(skA),pub(skC)).
A trace has been found.
RESULT not attacker(mSrv(pub(skA[]),pub(skC[]))) is false.
-- Query not attacker(mCli(pub(skA[]),pub(skC[])))
Completing...
200 rules inserted. The rule base contains 75 rules. 388 rules in the queue.
400 rules inserted. The rule base contains 107 rules. 388 rules in the queue.
600 rules inserted. The rule base contains 123 rules. 386 rules in the queue.
800 rules inserted. The rule base contains 123 rules. 386 rules in the queue.
1000 rules inserted. The rule base contains 127 rules. 368 rules in the queue.
1200 rules inserted. The rule base contains 97 rules. 360 rules in the queue.
1400 rules inserted. The rule base contains 143 rules. 294 rules in the queue.
1600 rules inserted. The rule base contains 161 rules. 280 rules in the queue.
1800 rules inserted. The rule base contains 265 rules. 201 rules in the queue.
2000 rules inserted. The rule base contains 390 rules. 111 rules in the queue.
Starting query not attacker(mCli(pub(skA[]),pub(skC[])))
goal reachable: attacker(mCli(pub(skA[]),pub(skC[])))
Abbreviations:
Nc_83453 = Nc_535[UP_534 = UP_83449,SP_533 = SP_83448,Sess = C[],Disco = A[],Cli = A[],!1 = @sid_83450]

1. The attacker has some term Ns_83445.
attacker(Ns_83445).

2. The attacker initially knows C[].
attacker(C[]).

3. The attacker initially knows A[].
attacker(A[]).

4. By 3, the attacker may know A[].
By 3, the attacker may know A[].
By 2, the attacker may know C[].
Using the function 3-tuple the attacker may obtain (A[],A[],C[]).
attacker((A[],A[],C[])).

5. The attacker has some term UP_83449.
attacker(UP_83449).

6. The attacker has some term SP_83448.
attacker(SP_83448).

7. Using the function None the attacker may obtain None.
attacker(None).

8. The message pub(skC[]) may be sent to the attacker at output {6}.
attacker(pub(skC[])).

9. Using the function GetEndpointResponse the attacker may obtain GetEndpointResponse.
attacker(GetEndpointResponse).

10. By 9, the attacker may know GetEndpointResponse.
By 8, the attacker may know pub(skC[]).
By 7, the attacker may know None.
By 6, the attacker may know SP_83448.
By 5, the attacker may know UP_83449.
Using the function 5-tuple the attacker may obtain (GetEndpointResponse,pub(skC[]),None,SP_83448,UP_83449).
attacker((GetEndpointResponse,pub(skC[]),None,SP_83448,UP_83449)).

11. The message (A[],A[],C[]) that the attacker may have by 4 may be received at input {8}.
The message (GetEndpointResponse,pub(skC[]),None,SP_83448,UP_83449) that the attacker may have by 10 may be received at input {46}.
So the message (pub(skA[]),(OpenSecureChannelRequest,pub(skA[]),Nc_83453)) may be sent to the attacker at output {49}.
attacker((pub(skA[]),(OpenSecureChannelRequest,pub(skA[]),Nc_83453))).

12. By 11, the attacker may know (pub(skA[]),(OpenSecureChannelRequest,pub(skA[]),Nc_83453)).
Using the function 2-proj-2-tuple the attacker may obtain (OpenSecureChannelRequest,pub(skA[]),Nc_83453).
attacker((OpenSecureChannelRequest,pub(skA[]),Nc_83453)).

13. By 12, the attacker may know (OpenSecureChannelRequest,pub(skA[]),Nc_83453).
Using the function 3-proj-3-tuple the attacker may obtain Nc_83453.
attacker(Nc_83453).

14. By 13, the attacker may know Nc_83453.
By 1, the attacker may know Ns_83445.
Using the function 2-tuple the attacker may obtain (Nc_83453,Ns_83445).
attacker((Nc_83453,Ns_83445)).

15. By 14, the attacker may know (Nc_83453,Ns_83445).
Using the function h the attacker may obtain h((Nc_83453,Ns_83445)).
attacker(h((Nc_83453,Ns_83445))).

16. The attacker has some term TTL_83447.
attacker(TTL_83447).

17. The attacker has some term ST_83446.
attacker(ST_83446).

18. Using the function OpenSecureChannelResponse the attacker may obtain OpenSecureChannelResponse.
attacker(OpenSecureChannelResponse).

19. By 18, the attacker may know OpenSecureChannelResponse.
By 1, the attacker may know Ns_83445.
By 17, the attacker may know ST_83446.
By 16, the attacker may know TTL_83447.
Using the function 4-tuple the attacker may obtain (OpenSecureChannelResponse,Ns_83445,ST_83446,TTL_83447).
attacker((OpenSecureChannelResponse,Ns_83445,ST_83446,TTL_83447)).

20. The message (A[],A[],C[]) that the attacker may have by 4 may be received at input {8}.
The message (GetEndpointResponse,pub(skC[]),None,SP_83448,UP_83449) that the attacker may have by 10 may be received at input {46}.
The message (OpenSecureChannelResponse,Ns_83445,ST_83446,TTL_83447) that the attacker may have by 19 may be received at input {50}.
So the message senc(mCli(pub(skA[]),pub(skC[])),h((Nc_83453,Ns_83445))) may be sent to the attacker at output {54}.
attacker(senc(mCli(pub(skA[]),pub(skC[])),h((Nc_83453,Ns_83445)))).

21. By 20, the attacker may know senc(mCli(pub(skA[]),pub(skC[])),h((Nc_83453,Ns_83445))).
By 15, the attacker may know h((Nc_83453,Ns_83445)).
Using the function sdec the attacker may obtain mCli(pub(skA[]),pub(skC[])).
attacker(mCli(pub(skA[]),pub(skC[]))).


A more detailed output of the traces is available with
  set traceDisplay = long.

out(c, pub(skA)) at {2}

out(c, pub(skB)) at {4}

out(c, pub(skC)) at {6}

in(c, (A,A,C)) at {8} in copy a_83456

out(c, GetEndpointRequest) at {45} in copy a_83456

in(c, (GetEndpointResponse,pub(skC),None,a_83455,a_83454)) at {46} in copy a_83456

new Nc_535 creating Nc_83460 at {47} in copy a_83456

out(c, (pub(skA),(OpenSecureChannelRequest,pub(skA),Nc_83460))) at {49} in copy a_83456

in(c, (OpenSecureChannelResponse,a_83457,a_83458,a_83459)) at {50} in copy a_83456

out(c, senc(mCli(pub(skA),pub(skC)),h((Nc_83460,a_83457)))) at {54} in copy a_83456

The attacker has the message mCli(pub(skA),pub(skC)).
A trace has been found.
RESULT not attacker(mCli(pub(skA[]),pub(skC[]))) is false.
