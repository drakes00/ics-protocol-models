Linear part:
exp(exp(g,x_32),y) = exp(exp(g,y),x_32)
Completing equations...
Completed equations:
exp(exp(g,x_32),y) = exp(exp(g,y),x_32)
Convergent part:
Completing equations...
Completed equations:
Process:
{1}let pkA: bitstring = pub(skA) in
{2}out(c, pkA);
{3}let pkB: bitstring = pub(skB) in
{4}out(c, pkB);
{5}let pkC: bitstring = pub(skC) in
{6}out(c, pkC);
(
    {7}!
    {8}in(c, (Cli: host,Disco: host,Sess: host));
    {9}let v_519: bool = (Cli = A) in
    (
        {10}if v_519 then
        (
            {11}let skCli: bitstring = skA in
            {12}let pkCli: bitstring = pub(skCli) in
            {13}let v_520: bool = (Disco = A) in
            (
                {14}if v_520 then
                (
                    {15}let pkDisco: bitstring = pub(skA) in
                    {16}let v_521: bool = (Sess = A) in
                    (
                        {17}if v_521 then
                        (
                            {18}let pkSess: bitstring = pub(skA) in
                            {19}out(c, GetEndpointRequest);
                            {20}in(c, (=GetEndpointResponse,=pkSess,=SignAndEncrypt,SP: bitstring,UP: bitstring));
                            {21}new Nc: bitstring;
                            {22}let m1: bitstring = (OpenSecureChannelRequest,pkCli,Nc) in
                            {23}event beginCli(Cli,Sess,Nc);
                            {24}out(c, (pkCli,enc(m1,pkSess),sign(h(m1),skCli)));
                            {25}in(c, (em2: bitstring,sigM2: bitstring));
                            {26}let m2: bitstring = dec(em2,skCli) in
                            {27}if (verify(h(m2),sigM2,pkSess) <> true) then
                                0
                            else
                                {28}let (=OpenSecureChannelResponse,Ns: bitstring,ST: bitstring,TTL: bitstring) = m2 in
                                {29}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                {30}event endCli(Sess,Cli,Ns)
                        )
                        else
                            {31}let v_522: bool = (Sess = B) in
                            (
                                {32}if v_522 then
                                (
                                    {33}let pkSess_523: bitstring = pub(skB) in
                                    {34}out(c, GetEndpointRequest);
                                    {35}in(c, (=GetEndpointResponse,=pkSess_523,=SignAndEncrypt,SP_524: bitstring,UP_525: bitstring));
                                    {36}new Nc_526: bitstring;
                                    {37}let m1_527: bitstring = (OpenSecureChannelRequest,pkCli,Nc_526) in
                                    {38}event beginCli(Cli,Sess,Nc_526);
                                    {39}out(c, (pkCli,enc(m1_527,pkSess_523),sign(h(m1_527),skCli)));
                                    {40}in(c, (em2_528: bitstring,sigM2_529: bitstring));
                                    {41}let m2_530: bitstring = dec(em2_528,skCli) in
                                    {42}if (verify(h(m2_530),sigM2_529,pkSess_523) <> true) then
                                        0
                                    else
                                        {43}let (=OpenSecureChannelResponse,Ns_531: bitstring,ST_532: bitstring,TTL_533: bitstring) = m2_530 in
                                        {44}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                        {45}event endCli(Sess,Cli,Ns_531)
                                )
                                else
                                    {46}let v_534: bool = (Sess = C) in
                                    (
                                        {47}if v_534 then
                                        (
                                            {48}let pkSess_535: bitstring = pub(skC) in
                                            {49}out(c, GetEndpointRequest);
                                            {50}in(c, (=GetEndpointResponse,=pkSess_535,=SignAndEncrypt,SP_536: bitstring,UP_537: bitstring));
                                            {51}new Nc_538: bitstring;
                                            {52}let m1_539: bitstring = (OpenSecureChannelRequest,pkCli,Nc_538) in
                                            {53}event beginCli(Cli,Sess,Nc_538);
                                            {54}out(c, (pkCli,enc(m1_539,pkSess_535),sign(h(m1_539),skCli)));
                                            {55}in(c, (em2_540: bitstring,sigM2_541: bitstring));
                                            {56}let m2_542: bitstring = dec(em2_540,skCli) in
                                            {57}if (verify(h(m2_542),sigM2_541,pkSess_535) <> true) then
                                                0
                                            else
                                                {58}let (=OpenSecureChannelResponse,Ns_543: bitstring,ST_544: bitstring,TTL_545: bitstring) = m2_542 in
                                                {59}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {60}event endCli(Sess,Cli,Ns_543)
                                        )
                                        else
                                            {61}let pkSess_546: bitstring = pub(sk(Sess)) in
                                            {62}out(c, GetEndpointRequest);
                                            {63}in(c, (=GetEndpointResponse,=pkSess_546,=SignAndEncrypt,SP_547: bitstring,UP_548: bitstring));
                                            {64}new Nc_549: bitstring;
                                            {65}let m1_550: bitstring = (OpenSecureChannelRequest,pkCli,Nc_549) in
                                            {66}event beginCli(Cli,Sess,Nc_549);
                                            {67}out(c, (pkCli,enc(m1_550,pkSess_546),sign(h(m1_550),skCli)));
                                            {68}in(c, (em2_551: bitstring,sigM2_552: bitstring));
                                            {69}let m2_553: bitstring = dec(em2_551,skCli) in
                                            {70}if (verify(h(m2_553),sigM2_552,pkSess_546) <> true) then
                                                0
                                            else
                                                {71}let (=OpenSecureChannelResponse,Ns_554: bitstring,ST_555: bitstring,TTL_556: bitstring) = m2_553 in
                                                {72}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {73}event endCli(Sess,Cli,Ns_554)
                                    )
                                    else
                                        {74}let pkSess_557: bitstring = fail-any in
                                        {75}out(c, GetEndpointRequest);
                                        {76}in(c, (=GetEndpointResponse,=pkSess_557,=SignAndEncrypt,SP_558: bitstring,UP_559: bitstring));
                                        {77}new Nc_560: bitstring;
                                        {78}let m1_561: bitstring = (OpenSecureChannelRequest,pkCli,Nc_560) in
                                        {79}event beginCli(Cli,Sess,Nc_560);
                                        {80}out(c, (pkCli,enc(m1_561,pkSess_557),sign(h(m1_561),skCli)));
                                        {81}in(c, (em2_562: bitstring,sigM2_563: bitstring));
                                        {82}let m2_564: bitstring = dec(em2_562,skCli) in
                                        {83}if (verify(h(m2_564),sigM2_563,pkSess_557) <> true) then
                                            0
                                        else
                                            {84}let (=OpenSecureChannelResponse,Ns_565: bitstring,ST_566: bitstring,TTL_567: bitstring) = m2_564 in
                                            {85}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {86}event endCli(Sess,Cli,Ns_565)
                            )
                            else
                                {87}let pkSess_568: bitstring = fail-any in
                                {88}out(c, GetEndpointRequest);
                                {89}in(c, (=GetEndpointResponse,=pkSess_568,=SignAndEncrypt,SP_569: bitstring,UP_570: bitstring));
                                {90}new Nc_571: bitstring;
                                {91}let m1_572: bitstring = (OpenSecureChannelRequest,pkCli,Nc_571) in
                                {92}event beginCli(Cli,Sess,Nc_571);
                                {93}out(c, (pkCli,enc(m1_572,pkSess_568),sign(h(m1_572),skCli)));
                                {94}in(c, (em2_573: bitstring,sigM2_574: bitstring));
                                {95}let m2_575: bitstring = dec(em2_573,skCli) in
                                {96}if (verify(h(m2_575),sigM2_574,pkSess_568) <> true) then
                                    0
                                else
                                    {97}let (=OpenSecureChannelResponse,Ns_576: bitstring,ST_577: bitstring,TTL_578: bitstring) = m2_575 in
                                    {98}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                    {99}event endCli(Sess,Cli,Ns_576)
                    )
                    else
                        {100}let pkSess_579: bitstring = fail-any in
                        {101}out(c, GetEndpointRequest);
                        {102}in(c, (=GetEndpointResponse,=pkSess_579,=SignAndEncrypt,SP_580: bitstring,UP_581: bitstring));
                        {103}new Nc_582: bitstring;
                        {104}let m1_583: bitstring = (OpenSecureChannelRequest,pkCli,Nc_582) in
                        {105}event beginCli(Cli,Sess,Nc_582);
                        {106}out(c, (pkCli,enc(m1_583,pkSess_579),sign(h(m1_583),skCli)));
                        {107}in(c, (em2_584: bitstring,sigM2_585: bitstring));
                        {108}let m2_586: bitstring = dec(em2_584,skCli) in
                        {109}if (verify(h(m2_586),sigM2_585,pkSess_579) <> true) then
                            0
                        else
                            {110}let (=OpenSecureChannelResponse,Ns_587: bitstring,ST_588: bitstring,TTL_589: bitstring) = m2_586 in
                            {111}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                            {112}event endCli(Sess,Cli,Ns_587)
                )
                else
                    {113}let v_590: bool = (Disco = B) in
                    (
                        {114}if v_590 then
                        (
                            {115}let pkDisco_591: bitstring = pub(skB) in
                            {116}let v_592: bool = (Sess = A) in
                            (
                                {117}if v_592 then
                                (
                                    {118}let pkSess_593: bitstring = pub(skA) in
                                    {119}out(c, GetEndpointRequest);
                                    {120}in(c, (=GetEndpointResponse,=pkSess_593,=SignAndEncrypt,SP_594: bitstring,UP_595: bitstring));
                                    {121}new Nc_596: bitstring;
                                    {122}let m1_597: bitstring = (OpenSecureChannelRequest,pkCli,Nc_596) in
                                    {123}event beginCli(Cli,Sess,Nc_596);
                                    {124}out(c, (pkCli,enc(m1_597,pkSess_593),sign(h(m1_597),skCli)));
                                    {125}in(c, (em2_598: bitstring,sigM2_599: bitstring));
                                    {126}let m2_600: bitstring = dec(em2_598,skCli) in
                                    {127}if (verify(h(m2_600),sigM2_599,pkSess_593) <> true) then
                                        0
                                    else
                                        {128}let (=OpenSecureChannelResponse,Ns_601: bitstring,ST_602: bitstring,TTL_603: bitstring) = m2_600 in
                                        {129}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                        {130}event endCli(Sess,Cli,Ns_601)
                                )
                                else
                                    {131}let v_604: bool = (Sess = B) in
                                    (
                                        {132}if v_604 then
                                        (
                                            {133}let pkSess_605: bitstring = pub(skB) in
                                            {134}out(c, GetEndpointRequest);
                                            {135}in(c, (=GetEndpointResponse,=pkSess_605,=SignAndEncrypt,SP_606: bitstring,UP_607: bitstring));
                                            {136}new Nc_608: bitstring;
                                            {137}let m1_609: bitstring = (OpenSecureChannelRequest,pkCli,Nc_608) in
                                            {138}event beginCli(Cli,Sess,Nc_608);
                                            {139}out(c, (pkCli,enc(m1_609,pkSess_605),sign(h(m1_609),skCli)));
                                            {140}in(c, (em2_610: bitstring,sigM2_611: bitstring));
                                            {141}let m2_612: bitstring = dec(em2_610,skCli) in
                                            {142}if (verify(h(m2_612),sigM2_611,pkSess_605) <> true) then
                                                0
                                            else
                                                {143}let (=OpenSecureChannelResponse,Ns_613: bitstring,ST_614: bitstring,TTL_615: bitstring) = m2_612 in
                                                {144}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {145}event endCli(Sess,Cli,Ns_613)
                                        )
                                        else
                                            {146}let v_616: bool = (Sess = C) in
                                            (
                                                {147}if v_616 then
                                                (
                                                    {148}let pkSess_617: bitstring = pub(skC) in
                                                    {149}out(c, GetEndpointRequest);
                                                    {150}in(c, (=GetEndpointResponse,=pkSess_617,=SignAndEncrypt,SP_618: bitstring,UP_619: bitstring));
                                                    {151}new Nc_620: bitstring;
                                                    {152}let m1_621: bitstring = (OpenSecureChannelRequest,pkCli,Nc_620) in
                                                    {153}event beginCli(Cli,Sess,Nc_620);
                                                    {154}out(c, (pkCli,enc(m1_621,pkSess_617),sign(h(m1_621),skCli)));
                                                    {155}in(c, (em2_622: bitstring,sigM2_623: bitstring));
                                                    {156}let m2_624: bitstring = dec(em2_622,skCli) in
                                                    {157}if (verify(h(m2_624),sigM2_623,pkSess_617) <> true) then
                                                        0
                                                    else
                                                        {158}let (=OpenSecureChannelResponse,Ns_625: bitstring,ST_626: bitstring,TTL_627: bitstring) = m2_624 in
                                                        {159}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {160}event endCli(Sess,Cli,Ns_625)
                                                )
                                                else
                                                    {161}let pkSess_628: bitstring = pub(sk(Sess)) in
                                                    {162}out(c, GetEndpointRequest);
                                                    {163}in(c, (=GetEndpointResponse,=pkSess_628,=SignAndEncrypt,SP_629: bitstring,UP_630: bitstring));
                                                    {164}new Nc_631: bitstring;
                                                    {165}let m1_632: bitstring = (OpenSecureChannelRequest,pkCli,Nc_631) in
                                                    {166}event beginCli(Cli,Sess,Nc_631);
                                                    {167}out(c, (pkCli,enc(m1_632,pkSess_628),sign(h(m1_632),skCli)));
                                                    {168}in(c, (em2_633: bitstring,sigM2_634: bitstring));
                                                    {169}let m2_635: bitstring = dec(em2_633,skCli) in
                                                    {170}if (verify(h(m2_635),sigM2_634,pkSess_628) <> true) then
                                                        0
                                                    else
                                                        {171}let (=OpenSecureChannelResponse,Ns_636: bitstring,ST_637: bitstring,TTL_638: bitstring) = m2_635 in
                                                        {172}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {173}event endCli(Sess,Cli,Ns_636)
                                            )
                                            else
                                                {174}let pkSess_639: bitstring = fail-any in
                                                {175}out(c, GetEndpointRequest);
                                                {176}in(c, (=GetEndpointResponse,=pkSess_639,=SignAndEncrypt,SP_640: bitstring,UP_641: bitstring));
                                                {177}new Nc_642: bitstring;
                                                {178}let m1_643: bitstring = (OpenSecureChannelRequest,pkCli,Nc_642) in
                                                {179}event beginCli(Cli,Sess,Nc_642);
                                                {180}out(c, (pkCli,enc(m1_643,pkSess_639),sign(h(m1_643),skCli)));
                                                {181}in(c, (em2_644: bitstring,sigM2_645: bitstring));
                                                {182}let m2_646: bitstring = dec(em2_644,skCli) in
                                                {183}if (verify(h(m2_646),sigM2_645,pkSess_639) <> true) then
                                                    0
                                                else
                                                    {184}let (=OpenSecureChannelResponse,Ns_647: bitstring,ST_648: bitstring,TTL_649: bitstring) = m2_646 in
                                                    {185}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {186}event endCli(Sess,Cli,Ns_647)
                                    )
                                    else
                                        {187}let pkSess_650: bitstring = fail-any in
                                        {188}out(c, GetEndpointRequest);
                                        {189}in(c, (=GetEndpointResponse,=pkSess_650,=SignAndEncrypt,SP_651: bitstring,UP_652: bitstring));
                                        {190}new Nc_653: bitstring;
                                        {191}let m1_654: bitstring = (OpenSecureChannelRequest,pkCli,Nc_653) in
                                        {192}event beginCli(Cli,Sess,Nc_653);
                                        {193}out(c, (pkCli,enc(m1_654,pkSess_650),sign(h(m1_654),skCli)));
                                        {194}in(c, (em2_655: bitstring,sigM2_656: bitstring));
                                        {195}let m2_657: bitstring = dec(em2_655,skCli) in
                                        {196}if (verify(h(m2_657),sigM2_656,pkSess_650) <> true) then
                                            0
                                        else
                                            {197}let (=OpenSecureChannelResponse,Ns_658: bitstring,ST_659: bitstring,TTL_660: bitstring) = m2_657 in
                                            {198}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {199}event endCli(Sess,Cli,Ns_658)
                            )
                            else
                                {200}let pkSess_661: bitstring = fail-any in
                                {201}out(c, GetEndpointRequest);
                                {202}in(c, (=GetEndpointResponse,=pkSess_661,=SignAndEncrypt,SP_662: bitstring,UP_663: bitstring));
                                {203}new Nc_664: bitstring;
                                {204}let m1_665: bitstring = (OpenSecureChannelRequest,pkCli,Nc_664) in
                                {205}event beginCli(Cli,Sess,Nc_664);
                                {206}out(c, (pkCli,enc(m1_665,pkSess_661),sign(h(m1_665),skCli)));
                                {207}in(c, (em2_666: bitstring,sigM2_667: bitstring));
                                {208}let m2_668: bitstring = dec(em2_666,skCli) in
                                {209}if (verify(h(m2_668),sigM2_667,pkSess_661) <> true) then
                                    0
                                else
                                    {210}let (=OpenSecureChannelResponse,Ns_669: bitstring,ST_670: bitstring,TTL_671: bitstring) = m2_668 in
                                    {211}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                    {212}event endCli(Sess,Cli,Ns_669)
                        )
                        else
                            {213}let v_672: bool = (Disco = C) in
                            (
                                {214}if v_672 then
                                (
                                    {215}let pkDisco_673: bitstring = pub(skC) in
                                    {216}let v_674: bool = (Sess = A) in
                                    (
                                        {217}if v_674 then
                                        (
                                            {218}let pkSess_675: bitstring = pub(skA) in
                                            {219}out(c, GetEndpointRequest);
                                            {220}in(c, (=GetEndpointResponse,=pkSess_675,=SignAndEncrypt,SP_676: bitstring,UP_677: bitstring));
                                            {221}new Nc_678: bitstring;
                                            {222}let m1_679: bitstring = (OpenSecureChannelRequest,pkCli,Nc_678) in
                                            {223}event beginCli(Cli,Sess,Nc_678);
                                            {224}out(c, (pkCli,enc(m1_679,pkSess_675),sign(h(m1_679),skCli)));
                                            {225}in(c, (em2_680: bitstring,sigM2_681: bitstring));
                                            {226}let m2_682: bitstring = dec(em2_680,skCli) in
                                            {227}if (verify(h(m2_682),sigM2_681,pkSess_675) <> true) then
                                                0
                                            else
                                                {228}let (=OpenSecureChannelResponse,Ns_683: bitstring,ST_684: bitstring,TTL_685: bitstring) = m2_682 in
                                                {229}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {230}event endCli(Sess,Cli,Ns_683)
                                        )
                                        else
                                            {231}let v_686: bool = (Sess = B) in
                                            (
                                                {232}if v_686 then
                                                (
                                                    {233}let pkSess_687: bitstring = pub(skB) in
                                                    {234}out(c, GetEndpointRequest);
                                                    {235}in(c, (=GetEndpointResponse,=pkSess_687,=SignAndEncrypt,SP_688: bitstring,UP_689: bitstring));
                                                    {236}new Nc_690: bitstring;
                                                    {237}let m1_691: bitstring = (OpenSecureChannelRequest,pkCli,Nc_690) in
                                                    {238}event beginCli(Cli,Sess,Nc_690);
                                                    {239}out(c, (pkCli,enc(m1_691,pkSess_687),sign(h(m1_691),skCli)));
                                                    {240}in(c, (em2_692: bitstring,sigM2_693: bitstring));
                                                    {241}let m2_694: bitstring = dec(em2_692,skCli) in
                                                    {242}if (verify(h(m2_694),sigM2_693,pkSess_687) <> true) then
                                                        0
                                                    else
                                                        {243}let (=OpenSecureChannelResponse,Ns_695: bitstring,ST_696: bitstring,TTL_697: bitstring) = m2_694 in
                                                        {244}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {245}event endCli(Sess,Cli,Ns_695)
                                                )
                                                else
                                                    {246}let v_698: bool = (Sess = C) in
                                                    (
                                                        {247}if v_698 then
                                                        (
                                                            {248}let pkSess_699: bitstring = pub(skC) in
                                                            {249}out(c, GetEndpointRequest);
                                                            {250}in(c, (=GetEndpointResponse,=pkSess_699,=SignAndEncrypt,SP_700: bitstring,UP_701: bitstring));
                                                            {251}new Nc_702: bitstring;
                                                            {252}let m1_703: bitstring = (OpenSecureChannelRequest,pkCli,Nc_702) in
                                                            {253}event beginCli(Cli,Sess,Nc_702);
                                                            {254}out(c, (pkCli,enc(m1_703,pkSess_699),sign(h(m1_703),skCli)));
                                                            {255}in(c, (em2_704: bitstring,sigM2_705: bitstring));
                                                            {256}let m2_706: bitstring = dec(em2_704,skCli) in
                                                            {257}if (verify(h(m2_706),sigM2_705,pkSess_699) <> true) then
                                                                0
                                                            else
                                                                {258}let (=OpenSecureChannelResponse,Ns_707: bitstring,ST_708: bitstring,TTL_709: bitstring) = m2_706 in
                                                                {259}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                {260}event endCli(Sess,Cli,Ns_707)
                                                        )
                                                        else
                                                            {261}let pkSess_710: bitstring = pub(sk(Sess)) in
                                                            {262}out(c, GetEndpointRequest);
                                                            {263}in(c, (=GetEndpointResponse,=pkSess_710,=SignAndEncrypt,SP_711: bitstring,UP_712: bitstring));
                                                            {264}new Nc_713: bitstring;
                                                            {265}let m1_714: bitstring = (OpenSecureChannelRequest,pkCli,Nc_713) in
                                                            {266}event beginCli(Cli,Sess,Nc_713);
                                                            {267}out(c, (pkCli,enc(m1_714,pkSess_710),sign(h(m1_714),skCli)));
                                                            {268}in(c, (em2_715: bitstring,sigM2_716: bitstring));
                                                            {269}let m2_717: bitstring = dec(em2_715,skCli) in
                                                            {270}if (verify(h(m2_717),sigM2_716,pkSess_710) <> true) then
                                                                0
                                                            else
                                                                {271}let (=OpenSecureChannelResponse,Ns_718: bitstring,ST_719: bitstring,TTL_720: bitstring) = m2_717 in
                                                                {272}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                {273}event endCli(Sess,Cli,Ns_718)
                                                    )
                                                    else
                                                        {274}let pkSess_721: bitstring = fail-any in
                                                        {275}out(c, GetEndpointRequest);
                                                        {276}in(c, (=GetEndpointResponse,=pkSess_721,=SignAndEncrypt,SP_722: bitstring,UP_723: bitstring));
                                                        {277}new Nc_724: bitstring;
                                                        {278}let m1_725: bitstring = (OpenSecureChannelRequest,pkCli,Nc_724) in
                                                        {279}event beginCli(Cli,Sess,Nc_724);
                                                        {280}out(c, (pkCli,enc(m1_725,pkSess_721),sign(h(m1_725),skCli)));
                                                        {281}in(c, (em2_726: bitstring,sigM2_727: bitstring));
                                                        {282}let m2_728: bitstring = dec(em2_726,skCli) in
                                                        {283}if (verify(h(m2_728),sigM2_727,pkSess_721) <> true) then
                                                            0
                                                        else
                                                            {284}let (=OpenSecureChannelResponse,Ns_729: bitstring,ST_730: bitstring,TTL_731: bitstring) = m2_728 in
                                                            {285}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                            {286}event endCli(Sess,Cli,Ns_729)
                                            )
                                            else
                                                {287}let pkSess_732: bitstring = fail-any in
                                                {288}out(c, GetEndpointRequest);
                                                {289}in(c, (=GetEndpointResponse,=pkSess_732,=SignAndEncrypt,SP_733: bitstring,UP_734: bitstring));
                                                {290}new Nc_735: bitstring;
                                                {291}let m1_736: bitstring = (OpenSecureChannelRequest,pkCli,Nc_735) in
                                                {292}event beginCli(Cli,Sess,Nc_735);
                                                {293}out(c, (pkCli,enc(m1_736,pkSess_732),sign(h(m1_736),skCli)));
                                                {294}in(c, (em2_737: bitstring,sigM2_738: bitstring));
                                                {295}let m2_739: bitstring = dec(em2_737,skCli) in
                                                {296}if (verify(h(m2_739),sigM2_738,pkSess_732) <> true) then
                                                    0
                                                else
                                                    {297}let (=OpenSecureChannelResponse,Ns_740: bitstring,ST_741: bitstring,TTL_742: bitstring) = m2_739 in
                                                    {298}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {299}event endCli(Sess,Cli,Ns_740)
                                    )
                                    else
                                        {300}let pkSess_743: bitstring = fail-any in
                                        {301}out(c, GetEndpointRequest);
                                        {302}in(c, (=GetEndpointResponse,=pkSess_743,=SignAndEncrypt,SP_744: bitstring,UP_745: bitstring));
                                        {303}new Nc_746: bitstring;
                                        {304}let m1_747: bitstring = (OpenSecureChannelRequest,pkCli,Nc_746) in
                                        {305}event beginCli(Cli,Sess,Nc_746);
                                        {306}out(c, (pkCli,enc(m1_747,pkSess_743),sign(h(m1_747),skCli)));
                                        {307}in(c, (em2_748: bitstring,sigM2_749: bitstring));
                                        {308}let m2_750: bitstring = dec(em2_748,skCli) in
                                        {309}if (verify(h(m2_750),sigM2_749,pkSess_743) <> true) then
                                            0
                                        else
                                            {310}let (=OpenSecureChannelResponse,Ns_751: bitstring,ST_752: bitstring,TTL_753: bitstring) = m2_750 in
                                            {311}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {312}event endCli(Sess,Cli,Ns_751)
                                )
                                else
                                    {313}let pkDisco_754: bitstring = pub(sk(Disco)) in
                                    {314}let v_755: bool = (Sess = A) in
                                    (
                                        {315}if v_755 then
                                        (
                                            {316}let pkSess_756: bitstring = pub(skA) in
                                            {317}out(c, GetEndpointRequest);
                                            {318}in(c, (=GetEndpointResponse,=pkSess_756,=SignAndEncrypt,SP_757: bitstring,UP_758: bitstring));
                                            {319}new Nc_759: bitstring;
                                            {320}let m1_760: bitstring = (OpenSecureChannelRequest,pkCli,Nc_759) in
                                            {321}event beginCli(Cli,Sess,Nc_759);
                                            {322}out(c, (pkCli,enc(m1_760,pkSess_756),sign(h(m1_760),skCli)));
                                            {323}in(c, (em2_761: bitstring,sigM2_762: bitstring));
                                            {324}let m2_763: bitstring = dec(em2_761,skCli) in
                                            {325}if (verify(h(m2_763),sigM2_762,pkSess_756) <> true) then
                                                0
                                            else
                                                {326}let (=OpenSecureChannelResponse,Ns_764: bitstring,ST_765: bitstring,TTL_766: bitstring) = m2_763 in
                                                {327}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {328}event endCli(Sess,Cli,Ns_764)
                                        )
                                        else
                                            {329}let v_767: bool = (Sess = B) in
                                            (
                                                {330}if v_767 then
                                                (
                                                    {331}let pkSess_768: bitstring = pub(skB) in
                                                    {332}out(c, GetEndpointRequest);
                                                    {333}in(c, (=GetEndpointResponse,=pkSess_768,=SignAndEncrypt,SP_769: bitstring,UP_770: bitstring));
                                                    {334}new Nc_771: bitstring;
                                                    {335}let m1_772: bitstring = (OpenSecureChannelRequest,pkCli,Nc_771) in
                                                    {336}event beginCli(Cli,Sess,Nc_771);
                                                    {337}out(c, (pkCli,enc(m1_772,pkSess_768),sign(h(m1_772),skCli)));
                                                    {338}in(c, (em2_773: bitstring,sigM2_774: bitstring));
                                                    {339}let m2_775: bitstring = dec(em2_773,skCli) in
                                                    {340}if (verify(h(m2_775),sigM2_774,pkSess_768) <> true) then
                                                        0
                                                    else
                                                        {341}let (=OpenSecureChannelResponse,Ns_776: bitstring,ST_777: bitstring,TTL_778: bitstring) = m2_775 in
                                                        {342}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {343}event endCli(Sess,Cli,Ns_776)
                                                )
                                                else
                                                    {344}let v_779: bool = (Sess = C) in
                                                    (
                                                        {345}if v_779 then
                                                        (
                                                            {346}let pkSess_780: bitstring = pub(skC) in
                                                            {347}out(c, GetEndpointRequest);
                                                            {348}in(c, (=GetEndpointResponse,=pkSess_780,=SignAndEncrypt,SP_781: bitstring,UP_782: bitstring));
                                                            {349}new Nc_783: bitstring;
                                                            {350}let m1_784: bitstring = (OpenSecureChannelRequest,pkCli,Nc_783) in
                                                            {351}event beginCli(Cli,Sess,Nc_783);
                                                            {352}out(c, (pkCli,enc(m1_784,pkSess_780),sign(h(m1_784),skCli)));
                                                            {353}in(c, (em2_785: bitstring,sigM2_786: bitstring));
                                                            {354}let m2_787: bitstring = dec(em2_785,skCli) in
                                                            {355}if (verify(h(m2_787),sigM2_786,pkSess_780) <> true) then
                                                                0
                                                            else
                                                                {356}let (=OpenSecureChannelResponse,Ns_788: bitstring,ST_789: bitstring,TTL_790: bitstring) = m2_787 in
                                                                {357}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                {358}event endCli(Sess,Cli,Ns_788)
                                                        )
                                                        else
                                                            {359}let pkSess_791: bitstring = pub(sk(Sess)) in
                                                            {360}out(c, GetEndpointRequest);
                                                            {361}in(c, (=GetEndpointResponse,=pkSess_791,=SignAndEncrypt,SP_792: bitstring,UP_793: bitstring));
                                                            {362}new Nc_794: bitstring;
                                                            {363}let m1_795: bitstring = (OpenSecureChannelRequest,pkCli,Nc_794) in
                                                            {364}event beginCli(Cli,Sess,Nc_794);
                                                            {365}out(c, (pkCli,enc(m1_795,pkSess_791),sign(h(m1_795),skCli)));
                                                            {366}in(c, (em2_796: bitstring,sigM2_797: bitstring));
                                                            {367}let m2_798: bitstring = dec(em2_796,skCli) in
                                                            {368}if (verify(h(m2_798),sigM2_797,pkSess_791) <> true) then
                                                                0
                                                            else
                                                                {369}let (=OpenSecureChannelResponse,Ns_799: bitstring,ST_800: bitstring,TTL_801: bitstring) = m2_798 in
                                                                {370}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                {371}event endCli(Sess,Cli,Ns_799)
                                                    )
                                                    else
                                                        {372}let pkSess_802: bitstring = fail-any in
                                                        {373}out(c, GetEndpointRequest);
                                                        {374}in(c, (=GetEndpointResponse,=pkSess_802,=SignAndEncrypt,SP_803: bitstring,UP_804: bitstring));
                                                        {375}new Nc_805: bitstring;
                                                        {376}let m1_806: bitstring = (OpenSecureChannelRequest,pkCli,Nc_805) in
                                                        {377}event beginCli(Cli,Sess,Nc_805);
                                                        {378}out(c, (pkCli,enc(m1_806,pkSess_802),sign(h(m1_806),skCli)));
                                                        {379}in(c, (em2_807: bitstring,sigM2_808: bitstring));
                                                        {380}let m2_809: bitstring = dec(em2_807,skCli) in
                                                        {381}if (verify(h(m2_809),sigM2_808,pkSess_802) <> true) then
                                                            0
                                                        else
                                                            {382}let (=OpenSecureChannelResponse,Ns_810: bitstring,ST_811: bitstring,TTL_812: bitstring) = m2_809 in
                                                            {383}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                            {384}event endCli(Sess,Cli,Ns_810)
                                            )
                                            else
                                                {385}let pkSess_813: bitstring = fail-any in
                                                {386}out(c, GetEndpointRequest);
                                                {387}in(c, (=GetEndpointResponse,=pkSess_813,=SignAndEncrypt,SP_814: bitstring,UP_815: bitstring));
                                                {388}new Nc_816: bitstring;
                                                {389}let m1_817: bitstring = (OpenSecureChannelRequest,pkCli,Nc_816) in
                                                {390}event beginCli(Cli,Sess,Nc_816);
                                                {391}out(c, (pkCli,enc(m1_817,pkSess_813),sign(h(m1_817),skCli)));
                                                {392}in(c, (em2_818: bitstring,sigM2_819: bitstring));
                                                {393}let m2_820: bitstring = dec(em2_818,skCli) in
                                                {394}if (verify(h(m2_820),sigM2_819,pkSess_813) <> true) then
                                                    0
                                                else
                                                    {395}let (=OpenSecureChannelResponse,Ns_821: bitstring,ST_822: bitstring,TTL_823: bitstring) = m2_820 in
                                                    {396}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {397}event endCli(Sess,Cli,Ns_821)
                                    )
                                    else
                                        {398}let pkSess_824: bitstring = fail-any in
                                        {399}out(c, GetEndpointRequest);
                                        {400}in(c, (=GetEndpointResponse,=pkSess_824,=SignAndEncrypt,SP_825: bitstring,UP_826: bitstring));
                                        {401}new Nc_827: bitstring;
                                        {402}let m1_828: bitstring = (OpenSecureChannelRequest,pkCli,Nc_827) in
                                        {403}event beginCli(Cli,Sess,Nc_827);
                                        {404}out(c, (pkCli,enc(m1_828,pkSess_824),sign(h(m1_828),skCli)));
                                        {405}in(c, (em2_829: bitstring,sigM2_830: bitstring));
                                        {406}let m2_831: bitstring = dec(em2_829,skCli) in
                                        {407}if (verify(h(m2_831),sigM2_830,pkSess_824) <> true) then
                                            0
                                        else
                                            {408}let (=OpenSecureChannelResponse,Ns_832: bitstring,ST_833: bitstring,TTL_834: bitstring) = m2_831 in
                                            {409}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {410}event endCli(Sess,Cli,Ns_832)
                            )
                            else
                                {411}let pkDisco_835: bitstring = fail-any in
                                {412}let v_836: bool = (Sess = A) in
                                (
                                    {413}if v_836 then
                                    (
                                        {414}let pkSess_837: bitstring = pub(skA) in
                                        {415}out(c, GetEndpointRequest);
                                        {416}in(c, (=GetEndpointResponse,=pkSess_837,=SignAndEncrypt,SP_838: bitstring,UP_839: bitstring));
                                        {417}new Nc_840: bitstring;
                                        {418}let m1_841: bitstring = (OpenSecureChannelRequest,pkCli,Nc_840) in
                                        {419}event beginCli(Cli,Sess,Nc_840);
                                        {420}out(c, (pkCli,enc(m1_841,pkSess_837),sign(h(m1_841),skCli)));
                                        {421}in(c, (em2_842: bitstring,sigM2_843: bitstring));
                                        {422}let m2_844: bitstring = dec(em2_842,skCli) in
                                        {423}if (verify(h(m2_844),sigM2_843,pkSess_837) <> true) then
                                            0
                                        else
                                            {424}let (=OpenSecureChannelResponse,Ns_845: bitstring,ST_846: bitstring,TTL_847: bitstring) = m2_844 in
                                            {425}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {426}event endCli(Sess,Cli,Ns_845)
                                    )
                                    else
                                        {427}let v_848: bool = (Sess = B) in
                                        (
                                            {428}if v_848 then
                                            (
                                                {429}let pkSess_849: bitstring = pub(skB) in
                                                {430}out(c, GetEndpointRequest);
                                                {431}in(c, (=GetEndpointResponse,=pkSess_849,=SignAndEncrypt,SP_850: bitstring,UP_851: bitstring));
                                                {432}new Nc_852: bitstring;
                                                {433}let m1_853: bitstring = (OpenSecureChannelRequest,pkCli,Nc_852) in
                                                {434}event beginCli(Cli,Sess,Nc_852);
                                                {435}out(c, (pkCli,enc(m1_853,pkSess_849),sign(h(m1_853),skCli)));
                                                {436}in(c, (em2_854: bitstring,sigM2_855: bitstring));
                                                {437}let m2_856: bitstring = dec(em2_854,skCli) in
                                                {438}if (verify(h(m2_856),sigM2_855,pkSess_849) <> true) then
                                                    0
                                                else
                                                    {439}let (=OpenSecureChannelResponse,Ns_857: bitstring,ST_858: bitstring,TTL_859: bitstring) = m2_856 in
                                                    {440}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {441}event endCli(Sess,Cli,Ns_857)
                                            )
                                            else
                                                {442}let v_860: bool = (Sess = C) in
                                                (
                                                    {443}if v_860 then
                                                    (
                                                        {444}let pkSess_861: bitstring = pub(skC) in
                                                        {445}out(c, GetEndpointRequest);
                                                        {446}in(c, (=GetEndpointResponse,=pkSess_861,=SignAndEncrypt,SP_862: bitstring,UP_863: bitstring));
                                                        {447}new Nc_864: bitstring;
                                                        {448}let m1_865: bitstring = (OpenSecureChannelRequest,pkCli,Nc_864) in
                                                        {449}event beginCli(Cli,Sess,Nc_864);
                                                        {450}out(c, (pkCli,enc(m1_865,pkSess_861),sign(h(m1_865),skCli)));
                                                        {451}in(c, (em2_866: bitstring,sigM2_867: bitstring));
                                                        {452}let m2_868: bitstring = dec(em2_866,skCli) in
                                                        {453}if (verify(h(m2_868),sigM2_867,pkSess_861) <> true) then
                                                            0
                                                        else
                                                            {454}let (=OpenSecureChannelResponse,Ns_869: bitstring,ST_870: bitstring,TTL_871: bitstring) = m2_868 in
                                                            {455}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                            {456}event endCli(Sess,Cli,Ns_869)
                                                    )
                                                    else
                                                        {457}let pkSess_872: bitstring = pub(sk(Sess)) in
                                                        {458}out(c, GetEndpointRequest);
                                                        {459}in(c, (=GetEndpointResponse,=pkSess_872,=SignAndEncrypt,SP_873: bitstring,UP_874: bitstring));
                                                        {460}new Nc_875: bitstring;
                                                        {461}let m1_876: bitstring = (OpenSecureChannelRequest,pkCli,Nc_875) in
                                                        {462}event beginCli(Cli,Sess,Nc_875);
                                                        {463}out(c, (pkCli,enc(m1_876,pkSess_872),sign(h(m1_876),skCli)));
                                                        {464}in(c, (em2_877: bitstring,sigM2_878: bitstring));
                                                        {465}let m2_879: bitstring = dec(em2_877,skCli) in
                                                        {466}if (verify(h(m2_879),sigM2_878,pkSess_872) <> true) then
                                                            0
                                                        else
                                                            {467}let (=OpenSecureChannelResponse,Ns_880: bitstring,ST_881: bitstring,TTL_882: bitstring) = m2_879 in
                                                            {468}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                            {469}event endCli(Sess,Cli,Ns_880)
                                                )
                                                else
                                                    {470}let pkSess_883: bitstring = fail-any in
                                                    {471}out(c, GetEndpointRequest);
                                                    {472}in(c, (=GetEndpointResponse,=pkSess_883,=SignAndEncrypt,SP_884: bitstring,UP_885: bitstring));
                                                    {473}new Nc_886: bitstring;
                                                    {474}let m1_887: bitstring = (OpenSecureChannelRequest,pkCli,Nc_886) in
                                                    {475}event beginCli(Cli,Sess,Nc_886);
                                                    {476}out(c, (pkCli,enc(m1_887,pkSess_883),sign(h(m1_887),skCli)));
                                                    {477}in(c, (em2_888: bitstring,sigM2_889: bitstring));
                                                    {478}let m2_890: bitstring = dec(em2_888,skCli) in
                                                    {479}if (verify(h(m2_890),sigM2_889,pkSess_883) <> true) then
                                                        0
                                                    else
                                                        {480}let (=OpenSecureChannelResponse,Ns_891: bitstring,ST_892: bitstring,TTL_893: bitstring) = m2_890 in
                                                        {481}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {482}event endCli(Sess,Cli,Ns_891)
                                        )
                                        else
                                            {483}let pkSess_894: bitstring = fail-any in
                                            {484}out(c, GetEndpointRequest);
                                            {485}in(c, (=GetEndpointResponse,=pkSess_894,=SignAndEncrypt,SP_895: bitstring,UP_896: bitstring));
                                            {486}new Nc_897: bitstring;
                                            {487}let m1_898: bitstring = (OpenSecureChannelRequest,pkCli,Nc_897) in
                                            {488}event beginCli(Cli,Sess,Nc_897);
                                            {489}out(c, (pkCli,enc(m1_898,pkSess_894),sign(h(m1_898),skCli)));
                                            {490}in(c, (em2_899: bitstring,sigM2_900: bitstring));
                                            {491}let m2_901: bitstring = dec(em2_899,skCli) in
                                            {492}if (verify(h(m2_901),sigM2_900,pkSess_894) <> true) then
                                                0
                                            else
                                                {493}let (=OpenSecureChannelResponse,Ns_902: bitstring,ST_903: bitstring,TTL_904: bitstring) = m2_901 in
                                                {494}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {495}event endCli(Sess,Cli,Ns_902)
                                )
                                else
                                    {496}let pkSess_905: bitstring = fail-any in
                                    {497}out(c, GetEndpointRequest);
                                    {498}in(c, (=GetEndpointResponse,=pkSess_905,=SignAndEncrypt,SP_906: bitstring,UP_907: bitstring));
                                    {499}new Nc_908: bitstring;
                                    {500}let m1_909: bitstring = (OpenSecureChannelRequest,pkCli,Nc_908) in
                                    {501}event beginCli(Cli,Sess,Nc_908);
                                    {502}out(c, (pkCli,enc(m1_909,pkSess_905),sign(h(m1_909),skCli)));
                                    {503}in(c, (em2_910: bitstring,sigM2_911: bitstring));
                                    {504}let m2_912: bitstring = dec(em2_910,skCli) in
                                    {505}if (verify(h(m2_912),sigM2_911,pkSess_905) <> true) then
                                        0
                                    else
                                        {506}let (=OpenSecureChannelResponse,Ns_913: bitstring,ST_914: bitstring,TTL_915: bitstring) = m2_912 in
                                        {507}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                        {508}event endCli(Sess,Cli,Ns_913)
                    )
                    else
                        {509}let pkDisco_916: bitstring = fail-any in
                        {510}let v_917: bool = (Sess = A) in
                        (
                            {511}if v_917 then
                            (
                                {512}let pkSess_918: bitstring = pub(skA) in
                                {513}out(c, GetEndpointRequest);
                                {514}in(c, (=GetEndpointResponse,=pkSess_918,=SignAndEncrypt,SP_919: bitstring,UP_920: bitstring));
                                {515}new Nc_921: bitstring;
                                {516}let m1_922: bitstring = (OpenSecureChannelRequest,pkCli,Nc_921) in
                                {517}event beginCli(Cli,Sess,Nc_921);
                                {518}out(c, (pkCli,enc(m1_922,pkSess_918),sign(h(m1_922),skCli)));
                                {519}in(c, (em2_923: bitstring,sigM2_924: bitstring));
                                {520}let m2_925: bitstring = dec(em2_923,skCli) in
                                {521}if (verify(h(m2_925),sigM2_924,pkSess_918) <> true) then
                                    0
                                else
                                    {522}let (=OpenSecureChannelResponse,Ns_926: bitstring,ST_927: bitstring,TTL_928: bitstring) = m2_925 in
                                    {523}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                    {524}event endCli(Sess,Cli,Ns_926)
                            )
                            else
                                {525}let v_929: bool = (Sess = B) in
                                (
                                    {526}if v_929 then
                                    (
                                        {527}let pkSess_930: bitstring = pub(skB) in
                                        {528}out(c, GetEndpointRequest);
                                        {529}in(c, (=GetEndpointResponse,=pkSess_930,=SignAndEncrypt,SP_931: bitstring,UP_932: bitstring));
                                        {530}new Nc_933: bitstring;
                                        {531}let m1_934: bitstring = (OpenSecureChannelRequest,pkCli,Nc_933) in
                                        {532}event beginCli(Cli,Sess,Nc_933);
                                        {533}out(c, (pkCli,enc(m1_934,pkSess_930),sign(h(m1_934),skCli)));
                                        {534}in(c, (em2_935: bitstring,sigM2_936: bitstring));
                                        {535}let m2_937: bitstring = dec(em2_935,skCli) in
                                        {536}if (verify(h(m2_937),sigM2_936,pkSess_930) <> true) then
                                            0
                                        else
                                            {537}let (=OpenSecureChannelResponse,Ns_938: bitstring,ST_939: bitstring,TTL_940: bitstring) = m2_937 in
                                            {538}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {539}event endCli(Sess,Cli,Ns_938)
                                    )
                                    else
                                        {540}let v_941: bool = (Sess = C) in
                                        (
                                            {541}if v_941 then
                                            (
                                                {542}let pkSess_942: bitstring = pub(skC) in
                                                {543}out(c, GetEndpointRequest);
                                                {544}in(c, (=GetEndpointResponse,=pkSess_942,=SignAndEncrypt,SP_943: bitstring,UP_944: bitstring));
                                                {545}new Nc_945: bitstring;
                                                {546}let m1_946: bitstring = (OpenSecureChannelRequest,pkCli,Nc_945) in
                                                {547}event beginCli(Cli,Sess,Nc_945);
                                                {548}out(c, (pkCli,enc(m1_946,pkSess_942),sign(h(m1_946),skCli)));
                                                {549}in(c, (em2_947: bitstring,sigM2_948: bitstring));
                                                {550}let m2_949: bitstring = dec(em2_947,skCli) in
                                                {551}if (verify(h(m2_949),sigM2_948,pkSess_942) <> true) then
                                                    0
                                                else
                                                    {552}let (=OpenSecureChannelResponse,Ns_950: bitstring,ST_951: bitstring,TTL_952: bitstring) = m2_949 in
                                                    {553}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {554}event endCli(Sess,Cli,Ns_950)
                                            )
                                            else
                                                {555}let pkSess_953: bitstring = pub(sk(Sess)) in
                                                {556}out(c, GetEndpointRequest);
                                                {557}in(c, (=GetEndpointResponse,=pkSess_953,=SignAndEncrypt,SP_954: bitstring,UP_955: bitstring));
                                                {558}new Nc_956: bitstring;
                                                {559}let m1_957: bitstring = (OpenSecureChannelRequest,pkCli,Nc_956) in
                                                {560}event beginCli(Cli,Sess,Nc_956);
                                                {561}out(c, (pkCli,enc(m1_957,pkSess_953),sign(h(m1_957),skCli)));
                                                {562}in(c, (em2_958: bitstring,sigM2_959: bitstring));
                                                {563}let m2_960: bitstring = dec(em2_958,skCli) in
                                                {564}if (verify(h(m2_960),sigM2_959,pkSess_953) <> true) then
                                                    0
                                                else
                                                    {565}let (=OpenSecureChannelResponse,Ns_961: bitstring,ST_962: bitstring,TTL_963: bitstring) = m2_960 in
                                                    {566}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {567}event endCli(Sess,Cli,Ns_961)
                                        )
                                        else
                                            {568}let pkSess_964: bitstring = fail-any in
                                            {569}out(c, GetEndpointRequest);
                                            {570}in(c, (=GetEndpointResponse,=pkSess_964,=SignAndEncrypt,SP_965: bitstring,UP_966: bitstring));
                                            {571}new Nc_967: bitstring;
                                            {572}let m1_968: bitstring = (OpenSecureChannelRequest,pkCli,Nc_967) in
                                            {573}event beginCli(Cli,Sess,Nc_967);
                                            {574}out(c, (pkCli,enc(m1_968,pkSess_964),sign(h(m1_968),skCli)));
                                            {575}in(c, (em2_969: bitstring,sigM2_970: bitstring));
                                            {576}let m2_971: bitstring = dec(em2_969,skCli) in
                                            {577}if (verify(h(m2_971),sigM2_970,pkSess_964) <> true) then
                                                0
                                            else
                                                {578}let (=OpenSecureChannelResponse,Ns_972: bitstring,ST_973: bitstring,TTL_974: bitstring) = m2_971 in
                                                {579}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {580}event endCli(Sess,Cli,Ns_972)
                                )
                                else
                                    {581}let pkSess_975: bitstring = fail-any in
                                    {582}out(c, GetEndpointRequest);
                                    {583}in(c, (=GetEndpointResponse,=pkSess_975,=SignAndEncrypt,SP_976: bitstring,UP_977: bitstring));
                                    {584}new Nc_978: bitstring;
                                    {585}let m1_979: bitstring = (OpenSecureChannelRequest,pkCli,Nc_978) in
                                    {586}event beginCli(Cli,Sess,Nc_978);
                                    {587}out(c, (pkCli,enc(m1_979,pkSess_975),sign(h(m1_979),skCli)));
                                    {588}in(c, (em2_980: bitstring,sigM2_981: bitstring));
                                    {589}let m2_982: bitstring = dec(em2_980,skCli) in
                                    {590}if (verify(h(m2_982),sigM2_981,pkSess_975) <> true) then
                                        0
                                    else
                                        {591}let (=OpenSecureChannelResponse,Ns_983: bitstring,ST_984: bitstring,TTL_985: bitstring) = m2_982 in
                                        {592}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                        {593}event endCli(Sess,Cli,Ns_983)
                        )
                        else
                            {594}let pkSess_986: bitstring = fail-any in
                            {595}out(c, GetEndpointRequest);
                            {596}in(c, (=GetEndpointResponse,=pkSess_986,=SignAndEncrypt,SP_987: bitstring,UP_988: bitstring));
                            {597}new Nc_989: bitstring;
                            {598}let m1_990: bitstring = (OpenSecureChannelRequest,pkCli,Nc_989) in
                            {599}event beginCli(Cli,Sess,Nc_989);
                            {600}out(c, (pkCli,enc(m1_990,pkSess_986),sign(h(m1_990),skCli)));
                            {601}in(c, (em2_991: bitstring,sigM2_992: bitstring));
                            {602}let m2_993: bitstring = dec(em2_991,skCli) in
                            {603}if (verify(h(m2_993),sigM2_992,pkSess_986) <> true) then
                                0
                            else
                                {604}let (=OpenSecureChannelResponse,Ns_994: bitstring,ST_995: bitstring,TTL_996: bitstring) = m2_993 in
                                {605}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                {606}event endCli(Sess,Cli,Ns_994)
            )
            else
                {607}let pkDisco_997: bitstring = fail-any in
                {608}let v_998: bool = (Sess = A) in
                (
                    {609}if v_998 then
                    (
                        {610}let pkSess_999: bitstring = pub(skA) in
                        {611}out(c, GetEndpointRequest);
                        {612}in(c, (=GetEndpointResponse,=pkSess_999,=SignAndEncrypt,SP_1000: bitstring,UP_1001: bitstring));
                        {613}new Nc_1002: bitstring;
                        {614}let m1_1003: bitstring = (OpenSecureChannelRequest,pkCli,Nc_1002) in
                        {615}event beginCli(Cli,Sess,Nc_1002);
                        {616}out(c, (pkCli,enc(m1_1003,pkSess_999),sign(h(m1_1003),skCli)));
                        {617}in(c, (em2_1004: bitstring,sigM2_1005: bitstring));
                        {618}let m2_1006: bitstring = dec(em2_1004,skCli) in
                        {619}if (verify(h(m2_1006),sigM2_1005,pkSess_999) <> true) then
                            0
                        else
                            {620}let (=OpenSecureChannelResponse,Ns_1007: bitstring,ST_1008: bitstring,TTL_1009: bitstring) = m2_1006 in
                            {621}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                            {622}event endCli(Sess,Cli,Ns_1007)
                    )
                    else
                        {623}let v_1010: bool = (Sess = B) in
                        (
                            {624}if v_1010 then
                            (
                                {625}let pkSess_1011: bitstring = pub(skB) in
                                {626}out(c, GetEndpointRequest);
                                {627}in(c, (=GetEndpointResponse,=pkSess_1011,=SignAndEncrypt,SP_1012: bitstring,UP_1013: bitstring));
                                {628}new Nc_1014: bitstring;
                                {629}let m1_1015: bitstring = (OpenSecureChannelRequest,pkCli,Nc_1014) in
                                {630}event beginCli(Cli,Sess,Nc_1014);
                                {631}out(c, (pkCli,enc(m1_1015,pkSess_1011),sign(h(m1_1015),skCli)));
                                {632}in(c, (em2_1016: bitstring,sigM2_1017: bitstring));
                                {633}let m2_1018: bitstring = dec(em2_1016,skCli) in
                                {634}if (verify(h(m2_1018),sigM2_1017,pkSess_1011) <> true) then
                                    0
                                else
                                    {635}let (=OpenSecureChannelResponse,Ns_1019: bitstring,ST_1020: bitstring,TTL_1021: bitstring) = m2_1018 in
                                    {636}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                    {637}event endCli(Sess,Cli,Ns_1019)
                            )
                            else
                                {638}let v_1022: bool = (Sess = C) in
                                (
                                    {639}if v_1022 then
                                    (
                                        {640}let pkSess_1023: bitstring = pub(skC) in
                                        {641}out(c, GetEndpointRequest);
                                        {642}in(c, (=GetEndpointResponse,=pkSess_1023,=SignAndEncrypt,SP_1024: bitstring,UP_1025: bitstring));
                                        {643}new Nc_1026: bitstring;
                                        {644}let m1_1027: bitstring = (OpenSecureChannelRequest,pkCli,Nc_1026) in
                                        {645}event beginCli(Cli,Sess,Nc_1026);
                                        {646}out(c, (pkCli,enc(m1_1027,pkSess_1023),sign(h(m1_1027),skCli)));
                                        {647}in(c, (em2_1028: bitstring,sigM2_1029: bitstring));
                                        {648}let m2_1030: bitstring = dec(em2_1028,skCli) in
                                        {649}if (verify(h(m2_1030),sigM2_1029,pkSess_1023) <> true) then
                                            0
                                        else
                                            {650}let (=OpenSecureChannelResponse,Ns_1031: bitstring,ST_1032: bitstring,TTL_1033: bitstring) = m2_1030 in
                                            {651}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {652}event endCli(Sess,Cli,Ns_1031)
                                    )
                                    else
                                        {653}let pkSess_1034: bitstring = pub(sk(Sess)) in
                                        {654}out(c, GetEndpointRequest);
                                        {655}in(c, (=GetEndpointResponse,=pkSess_1034,=SignAndEncrypt,SP_1035: bitstring,UP_1036: bitstring));
                                        {656}new Nc_1037: bitstring;
                                        {657}let m1_1038: bitstring = (OpenSecureChannelRequest,pkCli,Nc_1037) in
                                        {658}event beginCli(Cli,Sess,Nc_1037);
                                        {659}out(c, (pkCli,enc(m1_1038,pkSess_1034),sign(h(m1_1038),skCli)));
                                        {660}in(c, (em2_1039: bitstring,sigM2_1040: bitstring));
                                        {661}let m2_1041: bitstring = dec(em2_1039,skCli) in
                                        {662}if (verify(h(m2_1041),sigM2_1040,pkSess_1034) <> true) then
                                            0
                                        else
                                            {663}let (=OpenSecureChannelResponse,Ns_1042: bitstring,ST_1043: bitstring,TTL_1044: bitstring) = m2_1041 in
                                            {664}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {665}event endCli(Sess,Cli,Ns_1042)
                                )
                                else
                                    {666}let pkSess_1045: bitstring = fail-any in
                                    {667}out(c, GetEndpointRequest);
                                    {668}in(c, (=GetEndpointResponse,=pkSess_1045,=SignAndEncrypt,SP_1046: bitstring,UP_1047: bitstring));
                                    {669}new Nc_1048: bitstring;
                                    {670}let m1_1049: bitstring = (OpenSecureChannelRequest,pkCli,Nc_1048) in
                                    {671}event beginCli(Cli,Sess,Nc_1048);
                                    {672}out(c, (pkCli,enc(m1_1049,pkSess_1045),sign(h(m1_1049),skCli)));
                                    {673}in(c, (em2_1050: bitstring,sigM2_1051: bitstring));
                                    {674}let m2_1052: bitstring = dec(em2_1050,skCli) in
                                    {675}if (verify(h(m2_1052),sigM2_1051,pkSess_1045) <> true) then
                                        0
                                    else
                                        {676}let (=OpenSecureChannelResponse,Ns_1053: bitstring,ST_1054: bitstring,TTL_1055: bitstring) = m2_1052 in
                                        {677}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                        {678}event endCli(Sess,Cli,Ns_1053)
                        )
                        else
                            {679}let pkSess_1056: bitstring = fail-any in
                            {680}out(c, GetEndpointRequest);
                            {681}in(c, (=GetEndpointResponse,=pkSess_1056,=SignAndEncrypt,SP_1057: bitstring,UP_1058: bitstring));
                            {682}new Nc_1059: bitstring;
                            {683}let m1_1060: bitstring = (OpenSecureChannelRequest,pkCli,Nc_1059) in
                            {684}event beginCli(Cli,Sess,Nc_1059);
                            {685}out(c, (pkCli,enc(m1_1060,pkSess_1056),sign(h(m1_1060),skCli)));
                            {686}in(c, (em2_1061: bitstring,sigM2_1062: bitstring));
                            {687}let m2_1063: bitstring = dec(em2_1061,skCli) in
                            {688}if (verify(h(m2_1063),sigM2_1062,pkSess_1056) <> true) then
                                0
                            else
                                {689}let (=OpenSecureChannelResponse,Ns_1064: bitstring,ST_1065: bitstring,TTL_1066: bitstring) = m2_1063 in
                                {690}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                {691}event endCli(Sess,Cli,Ns_1064)
                )
                else
                    {692}let pkSess_1067: bitstring = fail-any in
                    {693}out(c, GetEndpointRequest);
                    {694}in(c, (=GetEndpointResponse,=pkSess_1067,=SignAndEncrypt,SP_1068: bitstring,UP_1069: bitstring));
                    {695}new Nc_1070: bitstring;
                    {696}let m1_1071: bitstring = (OpenSecureChannelRequest,pkCli,Nc_1070) in
                    {697}event beginCli(Cli,Sess,Nc_1070);
                    {698}out(c, (pkCli,enc(m1_1071,pkSess_1067),sign(h(m1_1071),skCli)));
                    {699}in(c, (em2_1072: bitstring,sigM2_1073: bitstring));
                    {700}let m2_1074: bitstring = dec(em2_1072,skCli) in
                    {701}if (verify(h(m2_1074),sigM2_1073,pkSess_1067) <> true) then
                        0
                    else
                        {702}let (=OpenSecureChannelResponse,Ns_1075: bitstring,ST_1076: bitstring,TTL_1077: bitstring) = m2_1074 in
                        {703}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                        {704}event endCli(Sess,Cli,Ns_1075)
        )
        else
            {705}let v_1078: bool = (Cli = B) in
            (
                {706}if v_1078 then
                (
                    {707}let skCli_1079: bitstring = skB in
                    {708}let pkCli_1080: bitstring = pub(skCli_1079) in
                    {709}let v_1081: bool = (Disco = A) in
                    (
                        {710}if v_1081 then
                        (
                            {711}let pkDisco_1082: bitstring = pub(skA) in
                            {712}let v_1083: bool = (Sess = A) in
                            (
                                {713}if v_1083 then
                                (
                                    {714}let pkSess_1084: bitstring = pub(skA) in
                                    {715}out(c, GetEndpointRequest);
                                    {716}in(c, (=GetEndpointResponse,=pkSess_1084,=SignAndEncrypt,SP_1085: bitstring,UP_1086: bitstring));
                                    {717}new Nc_1087: bitstring;
                                    {718}let m1_1088: bitstring = (OpenSecureChannelRequest,pkCli_1080,Nc_1087) in
                                    {719}event beginCli(Cli,Sess,Nc_1087);
                                    {720}out(c, (pkCli_1080,enc(m1_1088,pkSess_1084),sign(h(m1_1088),skCli_1079)));
                                    {721}in(c, (em2_1089: bitstring,sigM2_1090: bitstring));
                                    {722}let m2_1091: bitstring = dec(em2_1089,skCli_1079) in
                                    {723}if (verify(h(m2_1091),sigM2_1090,pkSess_1084) <> true) then
                                        0
                                    else
                                        {724}let (=OpenSecureChannelResponse,Ns_1092: bitstring,ST_1093: bitstring,TTL_1094: bitstring) = m2_1091 in
                                        {725}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                        {726}event endCli(Sess,Cli,Ns_1092)
                                )
                                else
                                    {727}let v_1095: bool = (Sess = B) in
                                    (
                                        {728}if v_1095 then
                                        (
                                            {729}let pkSess_1096: bitstring = pub(skB) in
                                            {730}out(c, GetEndpointRequest);
                                            {731}in(c, (=GetEndpointResponse,=pkSess_1096,=SignAndEncrypt,SP_1097: bitstring,UP_1098: bitstring));
                                            {732}new Nc_1099: bitstring;
                                            {733}let m1_1100: bitstring = (OpenSecureChannelRequest,pkCli_1080,Nc_1099) in
                                            {734}event beginCli(Cli,Sess,Nc_1099);
                                            {735}out(c, (pkCli_1080,enc(m1_1100,pkSess_1096),sign(h(m1_1100),skCli_1079)));
                                            {736}in(c, (em2_1101: bitstring,sigM2_1102: bitstring));
                                            {737}let m2_1103: bitstring = dec(em2_1101,skCli_1079) in
                                            {738}if (verify(h(m2_1103),sigM2_1102,pkSess_1096) <> true) then
                                                0
                                            else
                                                {739}let (=OpenSecureChannelResponse,Ns_1104: bitstring,ST_1105: bitstring,TTL_1106: bitstring) = m2_1103 in
                                                {740}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {741}event endCli(Sess,Cli,Ns_1104)
                                        )
                                        else
                                            {742}let v_1107: bool = (Sess = C) in
                                            (
                                                {743}if v_1107 then
                                                (
                                                    {744}let pkSess_1108: bitstring = pub(skC) in
                                                    {745}out(c, GetEndpointRequest);
                                                    {746}in(c, (=GetEndpointResponse,=pkSess_1108,=SignAndEncrypt,SP_1109: bitstring,UP_1110: bitstring));
                                                    {747}new Nc_1111: bitstring;
                                                    {748}let m1_1112: bitstring = (OpenSecureChannelRequest,pkCli_1080,Nc_1111) in
                                                    {749}event beginCli(Cli,Sess,Nc_1111);
                                                    {750}out(c, (pkCli_1080,enc(m1_1112,pkSess_1108),sign(h(m1_1112),skCli_1079)));
                                                    {751}in(c, (em2_1113: bitstring,sigM2_1114: bitstring));
                                                    {752}let m2_1115: bitstring = dec(em2_1113,skCli_1079) in
                                                    {753}if (verify(h(m2_1115),sigM2_1114,pkSess_1108) <> true) then
                                                        0
                                                    else
                                                        {754}let (=OpenSecureChannelResponse,Ns_1116: bitstring,ST_1117: bitstring,TTL_1118: bitstring) = m2_1115 in
                                                        {755}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {756}event endCli(Sess,Cli,Ns_1116)
                                                )
                                                else
                                                    {757}let pkSess_1119: bitstring = pub(sk(Sess)) in
                                                    {758}out(c, GetEndpointRequest);
                                                    {759}in(c, (=GetEndpointResponse,=pkSess_1119,=SignAndEncrypt,SP_1120: bitstring,UP_1121: bitstring));
                                                    {760}new Nc_1122: bitstring;
                                                    {761}let m1_1123: bitstring = (OpenSecureChannelRequest,pkCli_1080,Nc_1122) in
                                                    {762}event beginCli(Cli,Sess,Nc_1122);
                                                    {763}out(c, (pkCli_1080,enc(m1_1123,pkSess_1119),sign(h(m1_1123),skCli_1079)));
                                                    {764}in(c, (em2_1124: bitstring,sigM2_1125: bitstring));
                                                    {765}let m2_1126: bitstring = dec(em2_1124,skCli_1079) in
                                                    {766}if (verify(h(m2_1126),sigM2_1125,pkSess_1119) <> true) then
                                                        0
                                                    else
                                                        {767}let (=OpenSecureChannelResponse,Ns_1127: bitstring,ST_1128: bitstring,TTL_1129: bitstring) = m2_1126 in
                                                        {768}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {769}event endCli(Sess,Cli,Ns_1127)
                                            )
                                            else
                                                {770}let pkSess_1130: bitstring = fail-any in
                                                {771}out(c, GetEndpointRequest);
                                                {772}in(c, (=GetEndpointResponse,=pkSess_1130,=SignAndEncrypt,SP_1131: bitstring,UP_1132: bitstring));
                                                {773}new Nc_1133: bitstring;
                                                {774}let m1_1134: bitstring = (OpenSecureChannelRequest,pkCli_1080,Nc_1133) in
                                                {775}event beginCli(Cli,Sess,Nc_1133);
                                                {776}out(c, (pkCli_1080,enc(m1_1134,pkSess_1130),sign(h(m1_1134),skCli_1079)));
                                                {777}in(c, (em2_1135: bitstring,sigM2_1136: bitstring));
                                                {778}let m2_1137: bitstring = dec(em2_1135,skCli_1079) in
                                                {779}if (verify(h(m2_1137),sigM2_1136,pkSess_1130) <> true) then
                                                    0
                                                else
                                                    {780}let (=OpenSecureChannelResponse,Ns_1138: bitstring,ST_1139: bitstring,TTL_1140: bitstring) = m2_1137 in
                                                    {781}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {782}event endCli(Sess,Cli,Ns_1138)
                                    )
                                    else
                                        {783}let pkSess_1141: bitstring = fail-any in
                                        {784}out(c, GetEndpointRequest);
                                        {785}in(c, (=GetEndpointResponse,=pkSess_1141,=SignAndEncrypt,SP_1142: bitstring,UP_1143: bitstring));
                                        {786}new Nc_1144: bitstring;
                                        {787}let m1_1145: bitstring = (OpenSecureChannelRequest,pkCli_1080,Nc_1144) in
                                        {788}event beginCli(Cli,Sess,Nc_1144);
                                        {789}out(c, (pkCli_1080,enc(m1_1145,pkSess_1141),sign(h(m1_1145),skCli_1079)));
                                        {790}in(c, (em2_1146: bitstring,sigM2_1147: bitstring));
                                        {791}let m2_1148: bitstring = dec(em2_1146,skCli_1079) in
                                        {792}if (verify(h(m2_1148),sigM2_1147,pkSess_1141) <> true) then
                                            0
                                        else
                                            {793}let (=OpenSecureChannelResponse,Ns_1149: bitstring,ST_1150: bitstring,TTL_1151: bitstring) = m2_1148 in
                                            {794}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {795}event endCli(Sess,Cli,Ns_1149)
                            )
                            else
                                {796}let pkSess_1152: bitstring = fail-any in
                                {797}out(c, GetEndpointRequest);
                                {798}in(c, (=GetEndpointResponse,=pkSess_1152,=SignAndEncrypt,SP_1153: bitstring,UP_1154: bitstring));
                                {799}new Nc_1155: bitstring;
                                {800}let m1_1156: bitstring = (OpenSecureChannelRequest,pkCli_1080,Nc_1155) in
                                {801}event beginCli(Cli,Sess,Nc_1155);
                                {802}out(c, (pkCli_1080,enc(m1_1156,pkSess_1152),sign(h(m1_1156),skCli_1079)));
                                {803}in(c, (em2_1157: bitstring,sigM2_1158: bitstring));
                                {804}let m2_1159: bitstring = dec(em2_1157,skCli_1079) in
                                {805}if (verify(h(m2_1159),sigM2_1158,pkSess_1152) <> true) then
                                    0
                                else
                                    {806}let (=OpenSecureChannelResponse,Ns_1160: bitstring,ST_1161: bitstring,TTL_1162: bitstring) = m2_1159 in
                                    {807}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                    {808}event endCli(Sess,Cli,Ns_1160)
                        )
                        else
                            {809}let v_1163: bool = (Disco = B) in
                            (
                                {810}if v_1163 then
                                (
                                    {811}let pkDisco_1164: bitstring = pub(skB) in
                                    {812}let v_1165: bool = (Sess = A) in
                                    (
                                        {813}if v_1165 then
                                        (
                                            {814}let pkSess_1166: bitstring = pub(skA) in
                                            {815}out(c, GetEndpointRequest);
                                            {816}in(c, (=GetEndpointResponse,=pkSess_1166,=SignAndEncrypt,SP_1167: bitstring,UP_1168: bitstring));
                                            {817}new Nc_1169: bitstring;
                                            {818}let m1_1170: bitstring = (OpenSecureChannelRequest,pkCli_1080,Nc_1169) in
                                            {819}event beginCli(Cli,Sess,Nc_1169);
                                            {820}out(c, (pkCli_1080,enc(m1_1170,pkSess_1166),sign(h(m1_1170),skCli_1079)));
                                            {821}in(c, (em2_1171: bitstring,sigM2_1172: bitstring));
                                            {822}let m2_1173: bitstring = dec(em2_1171,skCli_1079) in
                                            {823}if (verify(h(m2_1173),sigM2_1172,pkSess_1166) <> true) then
                                                0
                                            else
                                                {824}let (=OpenSecureChannelResponse,Ns_1174: bitstring,ST_1175: bitstring,TTL_1176: bitstring) = m2_1173 in
                                                {825}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {826}event endCli(Sess,Cli,Ns_1174)
                                        )
                                        else
                                            {827}let v_1177: bool = (Sess = B) in
                                            (
                                                {828}if v_1177 then
                                                (
                                                    {829}let pkSess_1178: bitstring = pub(skB) in
                                                    {830}out(c, GetEndpointRequest);
                                                    {831}in(c, (=GetEndpointResponse,=pkSess_1178,=SignAndEncrypt,SP_1179: bitstring,UP_1180: bitstring));
                                                    {832}new Nc_1181: bitstring;
                                                    {833}let m1_1182: bitstring = (OpenSecureChannelRequest,pkCli_1080,Nc_1181) in
                                                    {834}event beginCli(Cli,Sess,Nc_1181);
                                                    {835}out(c, (pkCli_1080,enc(m1_1182,pkSess_1178),sign(h(m1_1182),skCli_1079)));
                                                    {836}in(c, (em2_1183: bitstring,sigM2_1184: bitstring));
                                                    {837}let m2_1185: bitstring = dec(em2_1183,skCli_1079) in
                                                    {838}if (verify(h(m2_1185),sigM2_1184,pkSess_1178) <> true) then
                                                        0
                                                    else
                                                        {839}let (=OpenSecureChannelResponse,Ns_1186: bitstring,ST_1187: bitstring,TTL_1188: bitstring) = m2_1185 in
                                                        {840}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {841}event endCli(Sess,Cli,Ns_1186)
                                                )
                                                else
                                                    {842}let v_1189: bool = (Sess = C) in
                                                    (
                                                        {843}if v_1189 then
                                                        (
                                                            {844}let pkSess_1190: bitstring = pub(skC) in
                                                            {845}out(c, GetEndpointRequest);
                                                            {846}in(c, (=GetEndpointResponse,=pkSess_1190,=SignAndEncrypt,SP_1191: bitstring,UP_1192: bitstring));
                                                            {847}new Nc_1193: bitstring;
                                                            {848}let m1_1194: bitstring = (OpenSecureChannelRequest,pkCli_1080,Nc_1193) in
                                                            {849}event beginCli(Cli,Sess,Nc_1193);
                                                            {850}out(c, (pkCli_1080,enc(m1_1194,pkSess_1190),sign(h(m1_1194),skCli_1079)));
                                                            {851}in(c, (em2_1195: bitstring,sigM2_1196: bitstring));
                                                            {852}let m2_1197: bitstring = dec(em2_1195,skCli_1079) in
                                                            {853}if (verify(h(m2_1197),sigM2_1196,pkSess_1190) <> true) then
                                                                0
                                                            else
                                                                {854}let (=OpenSecureChannelResponse,Ns_1198: bitstring,ST_1199: bitstring,TTL_1200: bitstring) = m2_1197 in
                                                                {855}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                {856}event endCli(Sess,Cli,Ns_1198)
                                                        )
                                                        else
                                                            {857}let pkSess_1201: bitstring = pub(sk(Sess)) in
                                                            {858}out(c, GetEndpointRequest);
                                                            {859}in(c, (=GetEndpointResponse,=pkSess_1201,=SignAndEncrypt,SP_1202: bitstring,UP_1203: bitstring));
                                                            {860}new Nc_1204: bitstring;
                                                            {861}let m1_1205: bitstring = (OpenSecureChannelRequest,pkCli_1080,Nc_1204) in
                                                            {862}event beginCli(Cli,Sess,Nc_1204);
                                                            {863}out(c, (pkCli_1080,enc(m1_1205,pkSess_1201),sign(h(m1_1205),skCli_1079)));
                                                            {864}in(c, (em2_1206: bitstring,sigM2_1207: bitstring));
                                                            {865}let m2_1208: bitstring = dec(em2_1206,skCli_1079) in
                                                            {866}if (verify(h(m2_1208),sigM2_1207,pkSess_1201) <> true) then
                                                                0
                                                            else
                                                                {867}let (=OpenSecureChannelResponse,Ns_1209: bitstring,ST_1210: bitstring,TTL_1211: bitstring) = m2_1208 in
                                                                {868}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                {869}event endCli(Sess,Cli,Ns_1209)
                                                    )
                                                    else
                                                        {870}let pkSess_1212: bitstring = fail-any in
                                                        {871}out(c, GetEndpointRequest);
                                                        {872}in(c, (=GetEndpointResponse,=pkSess_1212,=SignAndEncrypt,SP_1213: bitstring,UP_1214: bitstring));
                                                        {873}new Nc_1215: bitstring;
                                                        {874}let m1_1216: bitstring = (OpenSecureChannelRequest,pkCli_1080,Nc_1215) in
                                                        {875}event beginCli(Cli,Sess,Nc_1215);
                                                        {876}out(c, (pkCli_1080,enc(m1_1216,pkSess_1212),sign(h(m1_1216),skCli_1079)));
                                                        {877}in(c, (em2_1217: bitstring,sigM2_1218: bitstring));
                                                        {878}let m2_1219: bitstring = dec(em2_1217,skCli_1079) in
                                                        {879}if (verify(h(m2_1219),sigM2_1218,pkSess_1212) <> true) then
                                                            0
                                                        else
                                                            {880}let (=OpenSecureChannelResponse,Ns_1220: bitstring,ST_1221: bitstring,TTL_1222: bitstring) = m2_1219 in
                                                            {881}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                            {882}event endCli(Sess,Cli,Ns_1220)
                                            )
                                            else
                                                {883}let pkSess_1223: bitstring = fail-any in
                                                {884}out(c, GetEndpointRequest);
                                                {885}in(c, (=GetEndpointResponse,=pkSess_1223,=SignAndEncrypt,SP_1224: bitstring,UP_1225: bitstring));
                                                {886}new Nc_1226: bitstring;
                                                {887}let m1_1227: bitstring = (OpenSecureChannelRequest,pkCli_1080,Nc_1226) in
                                                {888}event beginCli(Cli,Sess,Nc_1226);
                                                {889}out(c, (pkCli_1080,enc(m1_1227,pkSess_1223),sign(h(m1_1227),skCli_1079)));
                                                {890}in(c, (em2_1228: bitstring,sigM2_1229: bitstring));
                                                {891}let m2_1230: bitstring = dec(em2_1228,skCli_1079) in
                                                {892}if (verify(h(m2_1230),sigM2_1229,pkSess_1223) <> true) then
                                                    0
                                                else
                                                    {893}let (=OpenSecureChannelResponse,Ns_1231: bitstring,ST_1232: bitstring,TTL_1233: bitstring) = m2_1230 in
                                                    {894}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {895}event endCli(Sess,Cli,Ns_1231)
                                    )
                                    else
                                        {896}let pkSess_1234: bitstring = fail-any in
                                        {897}out(c, GetEndpointRequest);
                                        {898}in(c, (=GetEndpointResponse,=pkSess_1234,=SignAndEncrypt,SP_1235: bitstring,UP_1236: bitstring));
                                        {899}new Nc_1237: bitstring;
                                        {900}let m1_1238: bitstring = (OpenSecureChannelRequest,pkCli_1080,Nc_1237) in
                                        {901}event beginCli(Cli,Sess,Nc_1237);
                                        {902}out(c, (pkCli_1080,enc(m1_1238,pkSess_1234),sign(h(m1_1238),skCli_1079)));
                                        {903}in(c, (em2_1239: bitstring,sigM2_1240: bitstring));
                                        {904}let m2_1241: bitstring = dec(em2_1239,skCli_1079) in
                                        {905}if (verify(h(m2_1241),sigM2_1240,pkSess_1234) <> true) then
                                            0
                                        else
                                            {906}let (=OpenSecureChannelResponse,Ns_1242: bitstring,ST_1243: bitstring,TTL_1244: bitstring) = m2_1241 in
                                            {907}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {908}event endCli(Sess,Cli,Ns_1242)
                                )
                                else
                                    {909}let v_1245: bool = (Disco = C) in
                                    (
                                        {910}if v_1245 then
                                        (
                                            {911}let pkDisco_1246: bitstring = pub(skC) in
                                            {912}let v_1247: bool = (Sess = A) in
                                            (
                                                {913}if v_1247 then
                                                (
                                                    {914}let pkSess_1248: bitstring = pub(skA) in
                                                    {915}out(c, GetEndpointRequest);
                                                    {916}in(c, (=GetEndpointResponse,=pkSess_1248,=SignAndEncrypt,SP_1249: bitstring,UP_1250: bitstring));
                                                    {917}new Nc_1251: bitstring;
                                                    {918}let m1_1252: bitstring = (OpenSecureChannelRequest,pkCli_1080,Nc_1251) in
                                                    {919}event beginCli(Cli,Sess,Nc_1251);
                                                    {920}out(c, (pkCli_1080,enc(m1_1252,pkSess_1248),sign(h(m1_1252),skCli_1079)));
                                                    {921}in(c, (em2_1253: bitstring,sigM2_1254: bitstring));
                                                    {922}let m2_1255: bitstring = dec(em2_1253,skCli_1079) in
                                                    {923}if (verify(h(m2_1255),sigM2_1254,pkSess_1248) <> true) then
                                                        0
                                                    else
                                                        {924}let (=OpenSecureChannelResponse,Ns_1256: bitstring,ST_1257: bitstring,TTL_1258: bitstring) = m2_1255 in
                                                        {925}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {926}event endCli(Sess,Cli,Ns_1256)
                                                )
                                                else
                                                    {927}let v_1259: bool = (Sess = B) in
                                                    (
                                                        {928}if v_1259 then
                                                        (
                                                            {929}let pkSess_1260: bitstring = pub(skB) in
                                                            {930}out(c, GetEndpointRequest);
                                                            {931}in(c, (=GetEndpointResponse,=pkSess_1260,=SignAndEncrypt,SP_1261: bitstring,UP_1262: bitstring));
                                                            {932}new Nc_1263: bitstring;
                                                            {933}let m1_1264: bitstring = (OpenSecureChannelRequest,pkCli_1080,Nc_1263) in
                                                            {934}event beginCli(Cli,Sess,Nc_1263);
                                                            {935}out(c, (pkCli_1080,enc(m1_1264,pkSess_1260),sign(h(m1_1264),skCli_1079)));
                                                            {936}in(c, (em2_1265: bitstring,sigM2_1266: bitstring));
                                                            {937}let m2_1267: bitstring = dec(em2_1265,skCli_1079) in
                                                            {938}if (verify(h(m2_1267),sigM2_1266,pkSess_1260) <> true) then
                                                                0
                                                            else
                                                                {939}let (=OpenSecureChannelResponse,Ns_1268: bitstring,ST_1269: bitstring,TTL_1270: bitstring) = m2_1267 in
                                                                {940}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                {941}event endCli(Sess,Cli,Ns_1268)
                                                        )
                                                        else
                                                            {942}let v_1271: bool = (Sess = C) in
                                                            (
                                                                {943}if v_1271 then
                                                                (
                                                                    {944}let pkSess_1272: bitstring = pub(skC) in
                                                                    {945}out(c, GetEndpointRequest);
                                                                    {946}in(c, (=GetEndpointResponse,=pkSess_1272,=SignAndEncrypt,SP_1273: bitstring,UP_1274: bitstring));
                                                                    {947}new Nc_1275: bitstring;
                                                                    {948}let m1_1276: bitstring = (OpenSecureChannelRequest,pkCli_1080,Nc_1275) in
                                                                    {949}event beginCli(Cli,Sess,Nc_1275);
                                                                    {950}out(c, (pkCli_1080,enc(m1_1276,pkSess_1272),sign(h(m1_1276),skCli_1079)));
                                                                    {951}in(c, (em2_1277: bitstring,sigM2_1278: bitstring));
                                                                    {952}let m2_1279: bitstring = dec(em2_1277,skCli_1079) in
                                                                    {953}if (verify(h(m2_1279),sigM2_1278,pkSess_1272) <> true) then
                                                                        0
                                                                    else
                                                                        {954}let (=OpenSecureChannelResponse,Ns_1280: bitstring,ST_1281: bitstring,TTL_1282: bitstring) = m2_1279 in
                                                                        {955}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                        {956}event endCli(Sess,Cli,Ns_1280)
                                                                )
                                                                else
                                                                    {957}let pkSess_1283: bitstring = pub(sk(Sess)) in
                                                                    {958}out(c, GetEndpointRequest);
                                                                    {959}in(c, (=GetEndpointResponse,=pkSess_1283,=SignAndEncrypt,SP_1284: bitstring,UP_1285: bitstring));
                                                                    {960}new Nc_1286: bitstring;
                                                                    {961}let m1_1287: bitstring = (OpenSecureChannelRequest,pkCli_1080,Nc_1286) in
                                                                    {962}event beginCli(Cli,Sess,Nc_1286);
                                                                    {963}out(c, (pkCli_1080,enc(m1_1287,pkSess_1283),sign(h(m1_1287),skCli_1079)));
                                                                    {964}in(c, (em2_1288: bitstring,sigM2_1289: bitstring));
                                                                    {965}let m2_1290: bitstring = dec(em2_1288,skCli_1079) in
                                                                    {966}if (verify(h(m2_1290),sigM2_1289,pkSess_1283) <> true) then
                                                                        0
                                                                    else
                                                                        {967}let (=OpenSecureChannelResponse,Ns_1291: bitstring,ST_1292: bitstring,TTL_1293: bitstring) = m2_1290 in
                                                                        {968}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                        {969}event endCli(Sess,Cli,Ns_1291)
                                                            )
                                                            else
                                                                {970}let pkSess_1294: bitstring = fail-any in
                                                                {971}out(c, GetEndpointRequest);
                                                                {972}in(c, (=GetEndpointResponse,=pkSess_1294,=SignAndEncrypt,SP_1295: bitstring,UP_1296: bitstring));
                                                                {973}new Nc_1297: bitstring;
                                                                {974}let m1_1298: bitstring = (OpenSecureChannelRequest,pkCli_1080,Nc_1297) in
                                                                {975}event beginCli(Cli,Sess,Nc_1297);
                                                                {976}out(c, (pkCli_1080,enc(m1_1298,pkSess_1294),sign(h(m1_1298),skCli_1079)));
                                                                {977}in(c, (em2_1299: bitstring,sigM2_1300: bitstring));
                                                                {978}let m2_1301: bitstring = dec(em2_1299,skCli_1079) in
                                                                {979}if (verify(h(m2_1301),sigM2_1300,pkSess_1294) <> true) then
                                                                    0
                                                                else
                                                                    {980}let (=OpenSecureChannelResponse,Ns_1302: bitstring,ST_1303: bitstring,TTL_1304: bitstring) = m2_1301 in
                                                                    {981}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                    {982}event endCli(Sess,Cli,Ns_1302)
                                                    )
                                                    else
                                                        {983}let pkSess_1305: bitstring = fail-any in
                                                        {984}out(c, GetEndpointRequest);
                                                        {985}in(c, (=GetEndpointResponse,=pkSess_1305,=SignAndEncrypt,SP_1306: bitstring,UP_1307: bitstring));
                                                        {986}new Nc_1308: bitstring;
                                                        {987}let m1_1309: bitstring = (OpenSecureChannelRequest,pkCli_1080,Nc_1308) in
                                                        {988}event beginCli(Cli,Sess,Nc_1308);
                                                        {989}out(c, (pkCli_1080,enc(m1_1309,pkSess_1305),sign(h(m1_1309),skCli_1079)));
                                                        {990}in(c, (em2_1310: bitstring,sigM2_1311: bitstring));
                                                        {991}let m2_1312: bitstring = dec(em2_1310,skCli_1079) in
                                                        {992}if (verify(h(m2_1312),sigM2_1311,pkSess_1305) <> true) then
                                                            0
                                                        else
                                                            {993}let (=OpenSecureChannelResponse,Ns_1313: bitstring,ST_1314: bitstring,TTL_1315: bitstring) = m2_1312 in
                                                            {994}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                            {995}event endCli(Sess,Cli,Ns_1313)
                                            )
                                            else
                                                {996}let pkSess_1316: bitstring = fail-any in
                                                {997}out(c, GetEndpointRequest);
                                                {998}in(c, (=GetEndpointResponse,=pkSess_1316,=SignAndEncrypt,SP_1317: bitstring,UP_1318: bitstring));
                                                {999}new Nc_1319: bitstring;
                                                {1000}let m1_1320: bitstring = (OpenSecureChannelRequest,pkCli_1080,Nc_1319) in
                                                {1001}event beginCli(Cli,Sess,Nc_1319);
                                                {1002}out(c, (pkCli_1080,enc(m1_1320,pkSess_1316),sign(h(m1_1320),skCli_1079)));
                                                {1003}in(c, (em2_1321: bitstring,sigM2_1322: bitstring));
                                                {1004}let m2_1323: bitstring = dec(em2_1321,skCli_1079) in
                                                {1005}if (verify(h(m2_1323),sigM2_1322,pkSess_1316) <> true) then
                                                    0
                                                else
                                                    {1006}let (=OpenSecureChannelResponse,Ns_1324: bitstring,ST_1325: bitstring,TTL_1326: bitstring) = m2_1323 in
                                                    {1007}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {1008}event endCli(Sess,Cli,Ns_1324)
                                        )
                                        else
                                            {1009}let pkDisco_1327: bitstring = pub(sk(Disco)) in
                                            {1010}let v_1328: bool = (Sess = A) in
                                            (
                                                {1011}if v_1328 then
                                                (
                                                    {1012}let pkSess_1329: bitstring = pub(skA) in
                                                    {1013}out(c, GetEndpointRequest);
                                                    {1014}in(c, (=GetEndpointResponse,=pkSess_1329,=SignAndEncrypt,SP_1330: bitstring,UP_1331: bitstring));
                                                    {1015}new Nc_1332: bitstring;
                                                    {1016}let m1_1333: bitstring = (OpenSecureChannelRequest,pkCli_1080,Nc_1332) in
                                                    {1017}event beginCli(Cli,Sess,Nc_1332);
                                                    {1018}out(c, (pkCli_1080,enc(m1_1333,pkSess_1329),sign(h(m1_1333),skCli_1079)));
                                                    {1019}in(c, (em2_1334: bitstring,sigM2_1335: bitstring));
                                                    {1020}let m2_1336: bitstring = dec(em2_1334,skCli_1079) in
                                                    {1021}if (verify(h(m2_1336),sigM2_1335,pkSess_1329) <> true) then
                                                        0
                                                    else
                                                        {1022}let (=OpenSecureChannelResponse,Ns_1337: bitstring,ST_1338: bitstring,TTL_1339: bitstring) = m2_1336 in
                                                        {1023}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {1024}event endCli(Sess,Cli,Ns_1337)
                                                )
                                                else
                                                    {1025}let v_1340: bool = (Sess = B) in
                                                    (
                                                        {1026}if v_1340 then
                                                        (
                                                            {1027}let pkSess_1341: bitstring = pub(skB) in
                                                            {1028}out(c, GetEndpointRequest);
                                                            {1029}in(c, (=GetEndpointResponse,=pkSess_1341,=SignAndEncrypt,SP_1342: bitstring,UP_1343: bitstring));
                                                            {1030}new Nc_1344: bitstring;
                                                            {1031}let m1_1345: bitstring = (OpenSecureChannelRequest,pkCli_1080,Nc_1344) in
                                                            {1032}event beginCli(Cli,Sess,Nc_1344);
                                                            {1033}out(c, (pkCli_1080,enc(m1_1345,pkSess_1341),sign(h(m1_1345),skCli_1079)));
                                                            {1034}in(c, (em2_1346: bitstring,sigM2_1347: bitstring));
                                                            {1035}let m2_1348: bitstring = dec(em2_1346,skCli_1079) in
                                                            {1036}if (verify(h(m2_1348),sigM2_1347,pkSess_1341) <> true) then
                                                                0
                                                            else
                                                                {1037}let (=OpenSecureChannelResponse,Ns_1349: bitstring,ST_1350: bitstring,TTL_1351: bitstring) = m2_1348 in
                                                                {1038}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                {1039}event endCli(Sess,Cli,Ns_1349)
                                                        )
                                                        else
                                                            {1040}let v_1352: bool = (Sess = C) in
                                                            (
                                                                {1041}if v_1352 then
                                                                (
                                                                    {1042}let pkSess_1353: bitstring = pub(skC) in
                                                                    {1043}out(c, GetEndpointRequest);
                                                                    {1044}in(c, (=GetEndpointResponse,=pkSess_1353,=SignAndEncrypt,SP_1354: bitstring,UP_1355: bitstring));
                                                                    {1045}new Nc_1356: bitstring;
                                                                    {1046}let m1_1357: bitstring = (OpenSecureChannelRequest,pkCli_1080,Nc_1356) in
                                                                    {1047}event beginCli(Cli,Sess,Nc_1356);
                                                                    {1048}out(c, (pkCli_1080,enc(m1_1357,pkSess_1353),sign(h(m1_1357),skCli_1079)));
                                                                    {1049}in(c, (em2_1358: bitstring,sigM2_1359: bitstring));
                                                                    {1050}let m2_1360: bitstring = dec(em2_1358,skCli_1079) in
                                                                    {1051}if (verify(h(m2_1360),sigM2_1359,pkSess_1353) <> true) then
                                                                        0
                                                                    else
                                                                        {1052}let (=OpenSecureChannelResponse,Ns_1361: bitstring,ST_1362: bitstring,TTL_1363: bitstring) = m2_1360 in
                                                                        {1053}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                        {1054}event endCli(Sess,Cli,Ns_1361)
                                                                )
                                                                else
                                                                    {1055}let pkSess_1364: bitstring = pub(sk(Sess)) in
                                                                    {1056}out(c, GetEndpointRequest);
                                                                    {1057}in(c, (=GetEndpointResponse,=pkSess_1364,=SignAndEncrypt,SP_1365: bitstring,UP_1366: bitstring));
                                                                    {1058}new Nc_1367: bitstring;
                                                                    {1059}let m1_1368: bitstring = (OpenSecureChannelRequest,pkCli_1080,Nc_1367) in
                                                                    {1060}event beginCli(Cli,Sess,Nc_1367);
                                                                    {1061}out(c, (pkCli_1080,enc(m1_1368,pkSess_1364),sign(h(m1_1368),skCli_1079)));
                                                                    {1062}in(c, (em2_1369: bitstring,sigM2_1370: bitstring));
                                                                    {1063}let m2_1371: bitstring = dec(em2_1369,skCli_1079) in
                                                                    {1064}if (verify(h(m2_1371),sigM2_1370,pkSess_1364) <> true) then
                                                                        0
                                                                    else
                                                                        {1065}let (=OpenSecureChannelResponse,Ns_1372: bitstring,ST_1373: bitstring,TTL_1374: bitstring) = m2_1371 in
                                                                        {1066}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                        {1067}event endCli(Sess,Cli,Ns_1372)
                                                            )
                                                            else
                                                                {1068}let pkSess_1375: bitstring = fail-any in
                                                                {1069}out(c, GetEndpointRequest);
                                                                {1070}in(c, (=GetEndpointResponse,=pkSess_1375,=SignAndEncrypt,SP_1376: bitstring,UP_1377: bitstring));
                                                                {1071}new Nc_1378: bitstring;
                                                                {1072}let m1_1379: bitstring = (OpenSecureChannelRequest,pkCli_1080,Nc_1378) in
                                                                {1073}event beginCli(Cli,Sess,Nc_1378);
                                                                {1074}out(c, (pkCli_1080,enc(m1_1379,pkSess_1375),sign(h(m1_1379),skCli_1079)));
                                                                {1075}in(c, (em2_1380: bitstring,sigM2_1381: bitstring));
                                                                {1076}let m2_1382: bitstring = dec(em2_1380,skCli_1079) in
                                                                {1077}if (verify(h(m2_1382),sigM2_1381,pkSess_1375) <> true) then
                                                                    0
                                                                else
                                                                    {1078}let (=OpenSecureChannelResponse,Ns_1383: bitstring,ST_1384: bitstring,TTL_1385: bitstring) = m2_1382 in
                                                                    {1079}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                    {1080}event endCli(Sess,Cli,Ns_1383)
                                                    )
                                                    else
                                                        {1081}let pkSess_1386: bitstring = fail-any in
                                                        {1082}out(c, GetEndpointRequest);
                                                        {1083}in(c, (=GetEndpointResponse,=pkSess_1386,=SignAndEncrypt,SP_1387: bitstring,UP_1388: bitstring));
                                                        {1084}new Nc_1389: bitstring;
                                                        {1085}let m1_1390: bitstring = (OpenSecureChannelRequest,pkCli_1080,Nc_1389) in
                                                        {1086}event beginCli(Cli,Sess,Nc_1389);
                                                        {1087}out(c, (pkCli_1080,enc(m1_1390,pkSess_1386),sign(h(m1_1390),skCli_1079)));
                                                        {1088}in(c, (em2_1391: bitstring,sigM2_1392: bitstring));
                                                        {1089}let m2_1393: bitstring = dec(em2_1391,skCli_1079) in
                                                        {1090}if (verify(h(m2_1393),sigM2_1392,pkSess_1386) <> true) then
                                                            0
                                                        else
                                                            {1091}let (=OpenSecureChannelResponse,Ns_1394: bitstring,ST_1395: bitstring,TTL_1396: bitstring) = m2_1393 in
                                                            {1092}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                            {1093}event endCli(Sess,Cli,Ns_1394)
                                            )
                                            else
                                                {1094}let pkSess_1397: bitstring = fail-any in
                                                {1095}out(c, GetEndpointRequest);
                                                {1096}in(c, (=GetEndpointResponse,=pkSess_1397,=SignAndEncrypt,SP_1398: bitstring,UP_1399: bitstring));
                                                {1097}new Nc_1400: bitstring;
                                                {1098}let m1_1401: bitstring = (OpenSecureChannelRequest,pkCli_1080,Nc_1400) in
                                                {1099}event beginCli(Cli,Sess,Nc_1400);
                                                {1100}out(c, (pkCli_1080,enc(m1_1401,pkSess_1397),sign(h(m1_1401),skCli_1079)));
                                                {1101}in(c, (em2_1402: bitstring,sigM2_1403: bitstring));
                                                {1102}let m2_1404: bitstring = dec(em2_1402,skCli_1079) in
                                                {1103}if (verify(h(m2_1404),sigM2_1403,pkSess_1397) <> true) then
                                                    0
                                                else
                                                    {1104}let (=OpenSecureChannelResponse,Ns_1405: bitstring,ST_1406: bitstring,TTL_1407: bitstring) = m2_1404 in
                                                    {1105}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {1106}event endCli(Sess,Cli,Ns_1405)
                                    )
                                    else
                                        {1107}let pkDisco_1408: bitstring = fail-any in
                                        {1108}let v_1409: bool = (Sess = A) in
                                        (
                                            {1109}if v_1409 then
                                            (
                                                {1110}let pkSess_1410: bitstring = pub(skA) in
                                                {1111}out(c, GetEndpointRequest);
                                                {1112}in(c, (=GetEndpointResponse,=pkSess_1410,=SignAndEncrypt,SP_1411: bitstring,UP_1412: bitstring));
                                                {1113}new Nc_1413: bitstring;
                                                {1114}let m1_1414: bitstring = (OpenSecureChannelRequest,pkCli_1080,Nc_1413) in
                                                {1115}event beginCli(Cli,Sess,Nc_1413);
                                                {1116}out(c, (pkCli_1080,enc(m1_1414,pkSess_1410),sign(h(m1_1414),skCli_1079)));
                                                {1117}in(c, (em2_1415: bitstring,sigM2_1416: bitstring));
                                                {1118}let m2_1417: bitstring = dec(em2_1415,skCli_1079) in
                                                {1119}if (verify(h(m2_1417),sigM2_1416,pkSess_1410) <> true) then
                                                    0
                                                else
                                                    {1120}let (=OpenSecureChannelResponse,Ns_1418: bitstring,ST_1419: bitstring,TTL_1420: bitstring) = m2_1417 in
                                                    {1121}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {1122}event endCli(Sess,Cli,Ns_1418)
                                            )
                                            else
                                                {1123}let v_1421: bool = (Sess = B) in
                                                (
                                                    {1124}if v_1421 then
                                                    (
                                                        {1125}let pkSess_1422: bitstring = pub(skB) in
                                                        {1126}out(c, GetEndpointRequest);
                                                        {1127}in(c, (=GetEndpointResponse,=pkSess_1422,=SignAndEncrypt,SP_1423: bitstring,UP_1424: bitstring));
                                                        {1128}new Nc_1425: bitstring;
                                                        {1129}let m1_1426: bitstring = (OpenSecureChannelRequest,pkCli_1080,Nc_1425) in
                                                        {1130}event beginCli(Cli,Sess,Nc_1425);
                                                        {1131}out(c, (pkCli_1080,enc(m1_1426,pkSess_1422),sign(h(m1_1426),skCli_1079)));
                                                        {1132}in(c, (em2_1427: bitstring,sigM2_1428: bitstring));
                                                        {1133}let m2_1429: bitstring = dec(em2_1427,skCli_1079) in
                                                        {1134}if (verify(h(m2_1429),sigM2_1428,pkSess_1422) <> true) then
                                                            0
                                                        else
                                                            {1135}let (=OpenSecureChannelResponse,Ns_1430: bitstring,ST_1431: bitstring,TTL_1432: bitstring) = m2_1429 in
                                                            {1136}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                            {1137}event endCli(Sess,Cli,Ns_1430)
                                                    )
                                                    else
                                                        {1138}let v_1433: bool = (Sess = C) in
                                                        (
                                                            {1139}if v_1433 then
                                                            (
                                                                {1140}let pkSess_1434: bitstring = pub(skC) in
                                                                {1141}out(c, GetEndpointRequest);
                                                                {1142}in(c, (=GetEndpointResponse,=pkSess_1434,=SignAndEncrypt,SP_1435: bitstring,UP_1436: bitstring));
                                                                {1143}new Nc_1437: bitstring;
                                                                {1144}let m1_1438: bitstring = (OpenSecureChannelRequest,pkCli_1080,Nc_1437) in
                                                                {1145}event beginCli(Cli,Sess,Nc_1437);
                                                                {1146}out(c, (pkCli_1080,enc(m1_1438,pkSess_1434),sign(h(m1_1438),skCli_1079)));
                                                                {1147}in(c, (em2_1439: bitstring,sigM2_1440: bitstring));
                                                                {1148}let m2_1441: bitstring = dec(em2_1439,skCli_1079) in
                                                                {1149}if (verify(h(m2_1441),sigM2_1440,pkSess_1434) <> true) then
                                                                    0
                                                                else
                                                                    {1150}let (=OpenSecureChannelResponse,Ns_1442: bitstring,ST_1443: bitstring,TTL_1444: bitstring) = m2_1441 in
                                                                    {1151}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                    {1152}event endCli(Sess,Cli,Ns_1442)
                                                            )
                                                            else
                                                                {1153}let pkSess_1445: bitstring = pub(sk(Sess)) in
                                                                {1154}out(c, GetEndpointRequest);
                                                                {1155}in(c, (=GetEndpointResponse,=pkSess_1445,=SignAndEncrypt,SP_1446: bitstring,UP_1447: bitstring));
                                                                {1156}new Nc_1448: bitstring;
                                                                {1157}let m1_1449: bitstring = (OpenSecureChannelRequest,pkCli_1080,Nc_1448) in
                                                                {1158}event beginCli(Cli,Sess,Nc_1448);
                                                                {1159}out(c, (pkCli_1080,enc(m1_1449,pkSess_1445),sign(h(m1_1449),skCli_1079)));
                                                                {1160}in(c, (em2_1450: bitstring,sigM2_1451: bitstring));
                                                                {1161}let m2_1452: bitstring = dec(em2_1450,skCli_1079) in
                                                                {1162}if (verify(h(m2_1452),sigM2_1451,pkSess_1445) <> true) then
                                                                    0
                                                                else
                                                                    {1163}let (=OpenSecureChannelResponse,Ns_1453: bitstring,ST_1454: bitstring,TTL_1455: bitstring) = m2_1452 in
                                                                    {1164}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                    {1165}event endCli(Sess,Cli,Ns_1453)
                                                        )
                                                        else
                                                            {1166}let pkSess_1456: bitstring = fail-any in
                                                            {1167}out(c, GetEndpointRequest);
                                                            {1168}in(c, (=GetEndpointResponse,=pkSess_1456,=SignAndEncrypt,SP_1457: bitstring,UP_1458: bitstring));
                                                            {1169}new Nc_1459: bitstring;
                                                            {1170}let m1_1460: bitstring = (OpenSecureChannelRequest,pkCli_1080,Nc_1459) in
                                                            {1171}event beginCli(Cli,Sess,Nc_1459);
                                                            {1172}out(c, (pkCli_1080,enc(m1_1460,pkSess_1456),sign(h(m1_1460),skCli_1079)));
                                                            {1173}in(c, (em2_1461: bitstring,sigM2_1462: bitstring));
                                                            {1174}let m2_1463: bitstring = dec(em2_1461,skCli_1079) in
                                                            {1175}if (verify(h(m2_1463),sigM2_1462,pkSess_1456) <> true) then
                                                                0
                                                            else
                                                                {1176}let (=OpenSecureChannelResponse,Ns_1464: bitstring,ST_1465: bitstring,TTL_1466: bitstring) = m2_1463 in
                                                                {1177}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                {1178}event endCli(Sess,Cli,Ns_1464)
                                                )
                                                else
                                                    {1179}let pkSess_1467: bitstring = fail-any in
                                                    {1180}out(c, GetEndpointRequest);
                                                    {1181}in(c, (=GetEndpointResponse,=pkSess_1467,=SignAndEncrypt,SP_1468: bitstring,UP_1469: bitstring));
                                                    {1182}new Nc_1470: bitstring;
                                                    {1183}let m1_1471: bitstring = (OpenSecureChannelRequest,pkCli_1080,Nc_1470) in
                                                    {1184}event beginCli(Cli,Sess,Nc_1470);
                                                    {1185}out(c, (pkCli_1080,enc(m1_1471,pkSess_1467),sign(h(m1_1471),skCli_1079)));
                                                    {1186}in(c, (em2_1472: bitstring,sigM2_1473: bitstring));
                                                    {1187}let m2_1474: bitstring = dec(em2_1472,skCli_1079) in
                                                    {1188}if (verify(h(m2_1474),sigM2_1473,pkSess_1467) <> true) then
                                                        0
                                                    else
                                                        {1189}let (=OpenSecureChannelResponse,Ns_1475: bitstring,ST_1476: bitstring,TTL_1477: bitstring) = m2_1474 in
                                                        {1190}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {1191}event endCli(Sess,Cli,Ns_1475)
                                        )
                                        else
                                            {1192}let pkSess_1478: bitstring = fail-any in
                                            {1193}out(c, GetEndpointRequest);
                                            {1194}in(c, (=GetEndpointResponse,=pkSess_1478,=SignAndEncrypt,SP_1479: bitstring,UP_1480: bitstring));
                                            {1195}new Nc_1481: bitstring;
                                            {1196}let m1_1482: bitstring = (OpenSecureChannelRequest,pkCli_1080,Nc_1481) in
                                            {1197}event beginCli(Cli,Sess,Nc_1481);
                                            {1198}out(c, (pkCli_1080,enc(m1_1482,pkSess_1478),sign(h(m1_1482),skCli_1079)));
                                            {1199}in(c, (em2_1483: bitstring,sigM2_1484: bitstring));
                                            {1200}let m2_1485: bitstring = dec(em2_1483,skCli_1079) in
                                            {1201}if (verify(h(m2_1485),sigM2_1484,pkSess_1478) <> true) then
                                                0
                                            else
                                                {1202}let (=OpenSecureChannelResponse,Ns_1486: bitstring,ST_1487: bitstring,TTL_1488: bitstring) = m2_1485 in
                                                {1203}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {1204}event endCli(Sess,Cli,Ns_1486)
                            )
                            else
                                {1205}let pkDisco_1489: bitstring = fail-any in
                                {1206}let v_1490: bool = (Sess = A) in
                                (
                                    {1207}if v_1490 then
                                    (
                                        {1208}let pkSess_1491: bitstring = pub(skA) in
                                        {1209}out(c, GetEndpointRequest);
                                        {1210}in(c, (=GetEndpointResponse,=pkSess_1491,=SignAndEncrypt,SP_1492: bitstring,UP_1493: bitstring));
                                        {1211}new Nc_1494: bitstring;
                                        {1212}let m1_1495: bitstring = (OpenSecureChannelRequest,pkCli_1080,Nc_1494) in
                                        {1213}event beginCli(Cli,Sess,Nc_1494);
                                        {1214}out(c, (pkCli_1080,enc(m1_1495,pkSess_1491),sign(h(m1_1495),skCli_1079)));
                                        {1215}in(c, (em2_1496: bitstring,sigM2_1497: bitstring));
                                        {1216}let m2_1498: bitstring = dec(em2_1496,skCli_1079) in
                                        {1217}if (verify(h(m2_1498),sigM2_1497,pkSess_1491) <> true) then
                                            0
                                        else
                                            {1218}let (=OpenSecureChannelResponse,Ns_1499: bitstring,ST_1500: bitstring,TTL_1501: bitstring) = m2_1498 in
                                            {1219}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {1220}event endCli(Sess,Cli,Ns_1499)
                                    )
                                    else
                                        {1221}let v_1502: bool = (Sess = B) in
                                        (
                                            {1222}if v_1502 then
                                            (
                                                {1223}let pkSess_1503: bitstring = pub(skB) in
                                                {1224}out(c, GetEndpointRequest);
                                                {1225}in(c, (=GetEndpointResponse,=pkSess_1503,=SignAndEncrypt,SP_1504: bitstring,UP_1505: bitstring));
                                                {1226}new Nc_1506: bitstring;
                                                {1227}let m1_1507: bitstring = (OpenSecureChannelRequest,pkCli_1080,Nc_1506) in
                                                {1228}event beginCli(Cli,Sess,Nc_1506);
                                                {1229}out(c, (pkCli_1080,enc(m1_1507,pkSess_1503),sign(h(m1_1507),skCli_1079)));
                                                {1230}in(c, (em2_1508: bitstring,sigM2_1509: bitstring));
                                                {1231}let m2_1510: bitstring = dec(em2_1508,skCli_1079) in
                                                {1232}if (verify(h(m2_1510),sigM2_1509,pkSess_1503) <> true) then
                                                    0
                                                else
                                                    {1233}let (=OpenSecureChannelResponse,Ns_1511: bitstring,ST_1512: bitstring,TTL_1513: bitstring) = m2_1510 in
                                                    {1234}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {1235}event endCli(Sess,Cli,Ns_1511)
                                            )
                                            else
                                                {1236}let v_1514: bool = (Sess = C) in
                                                (
                                                    {1237}if v_1514 then
                                                    (
                                                        {1238}let pkSess_1515: bitstring = pub(skC) in
                                                        {1239}out(c, GetEndpointRequest);
                                                        {1240}in(c, (=GetEndpointResponse,=pkSess_1515,=SignAndEncrypt,SP_1516: bitstring,UP_1517: bitstring));
                                                        {1241}new Nc_1518: bitstring;
                                                        {1242}let m1_1519: bitstring = (OpenSecureChannelRequest,pkCli_1080,Nc_1518) in
                                                        {1243}event beginCli(Cli,Sess,Nc_1518);
                                                        {1244}out(c, (pkCli_1080,enc(m1_1519,pkSess_1515),sign(h(m1_1519),skCli_1079)));
                                                        {1245}in(c, (em2_1520: bitstring,sigM2_1521: bitstring));
                                                        {1246}let m2_1522: bitstring = dec(em2_1520,skCli_1079) in
                                                        {1247}if (verify(h(m2_1522),sigM2_1521,pkSess_1515) <> true) then
                                                            0
                                                        else
                                                            {1248}let (=OpenSecureChannelResponse,Ns_1523: bitstring,ST_1524: bitstring,TTL_1525: bitstring) = m2_1522 in
                                                            {1249}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                            {1250}event endCli(Sess,Cli,Ns_1523)
                                                    )
                                                    else
                                                        {1251}let pkSess_1526: bitstring = pub(sk(Sess)) in
                                                        {1252}out(c, GetEndpointRequest);
                                                        {1253}in(c, (=GetEndpointResponse,=pkSess_1526,=SignAndEncrypt,SP_1527: bitstring,UP_1528: bitstring));
                                                        {1254}new Nc_1529: bitstring;
                                                        {1255}let m1_1530: bitstring = (OpenSecureChannelRequest,pkCli_1080,Nc_1529) in
                                                        {1256}event beginCli(Cli,Sess,Nc_1529);
                                                        {1257}out(c, (pkCli_1080,enc(m1_1530,pkSess_1526),sign(h(m1_1530),skCli_1079)));
                                                        {1258}in(c, (em2_1531: bitstring,sigM2_1532: bitstring));
                                                        {1259}let m2_1533: bitstring = dec(em2_1531,skCli_1079) in
                                                        {1260}if (verify(h(m2_1533),sigM2_1532,pkSess_1526) <> true) then
                                                            0
                                                        else
                                                            {1261}let (=OpenSecureChannelResponse,Ns_1534: bitstring,ST_1535: bitstring,TTL_1536: bitstring) = m2_1533 in
                                                            {1262}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                            {1263}event endCli(Sess,Cli,Ns_1534)
                                                )
                                                else
                                                    {1264}let pkSess_1537: bitstring = fail-any in
                                                    {1265}out(c, GetEndpointRequest);
                                                    {1266}in(c, (=GetEndpointResponse,=pkSess_1537,=SignAndEncrypt,SP_1538: bitstring,UP_1539: bitstring));
                                                    {1267}new Nc_1540: bitstring;
                                                    {1268}let m1_1541: bitstring = (OpenSecureChannelRequest,pkCli_1080,Nc_1540) in
                                                    {1269}event beginCli(Cli,Sess,Nc_1540);
                                                    {1270}out(c, (pkCli_1080,enc(m1_1541,pkSess_1537),sign(h(m1_1541),skCli_1079)));
                                                    {1271}in(c, (em2_1542: bitstring,sigM2_1543: bitstring));
                                                    {1272}let m2_1544: bitstring = dec(em2_1542,skCli_1079) in
                                                    {1273}if (verify(h(m2_1544),sigM2_1543,pkSess_1537) <> true) then
                                                        0
                                                    else
                                                        {1274}let (=OpenSecureChannelResponse,Ns_1545: bitstring,ST_1546: bitstring,TTL_1547: bitstring) = m2_1544 in
                                                        {1275}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {1276}event endCli(Sess,Cli,Ns_1545)
                                        )
                                        else
                                            {1277}let pkSess_1548: bitstring = fail-any in
                                            {1278}out(c, GetEndpointRequest);
                                            {1279}in(c, (=GetEndpointResponse,=pkSess_1548,=SignAndEncrypt,SP_1549: bitstring,UP_1550: bitstring));
                                            {1280}new Nc_1551: bitstring;
                                            {1281}let m1_1552: bitstring = (OpenSecureChannelRequest,pkCli_1080,Nc_1551) in
                                            {1282}event beginCli(Cli,Sess,Nc_1551);
                                            {1283}out(c, (pkCli_1080,enc(m1_1552,pkSess_1548),sign(h(m1_1552),skCli_1079)));
                                            {1284}in(c, (em2_1553: bitstring,sigM2_1554: bitstring));
                                            {1285}let m2_1555: bitstring = dec(em2_1553,skCli_1079) in
                                            {1286}if (verify(h(m2_1555),sigM2_1554,pkSess_1548) <> true) then
                                                0
                                            else
                                                {1287}let (=OpenSecureChannelResponse,Ns_1556: bitstring,ST_1557: bitstring,TTL_1558: bitstring) = m2_1555 in
                                                {1288}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {1289}event endCli(Sess,Cli,Ns_1556)
                                )
                                else
                                    {1290}let pkSess_1559: bitstring = fail-any in
                                    {1291}out(c, GetEndpointRequest);
                                    {1292}in(c, (=GetEndpointResponse,=pkSess_1559,=SignAndEncrypt,SP_1560: bitstring,UP_1561: bitstring));
                                    {1293}new Nc_1562: bitstring;
                                    {1294}let m1_1563: bitstring = (OpenSecureChannelRequest,pkCli_1080,Nc_1562) in
                                    {1295}event beginCli(Cli,Sess,Nc_1562);
                                    {1296}out(c, (pkCli_1080,enc(m1_1563,pkSess_1559),sign(h(m1_1563),skCli_1079)));
                                    {1297}in(c, (em2_1564: bitstring,sigM2_1565: bitstring));
                                    {1298}let m2_1566: bitstring = dec(em2_1564,skCli_1079) in
                                    {1299}if (verify(h(m2_1566),sigM2_1565,pkSess_1559) <> true) then
                                        0
                                    else
                                        {1300}let (=OpenSecureChannelResponse,Ns_1567: bitstring,ST_1568: bitstring,TTL_1569: bitstring) = m2_1566 in
                                        {1301}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                        {1302}event endCli(Sess,Cli,Ns_1567)
                    )
                    else
                        {1303}let pkDisco_1570: bitstring = fail-any in
                        {1304}let v_1571: bool = (Sess = A) in
                        (
                            {1305}if v_1571 then
                            (
                                {1306}let pkSess_1572: bitstring = pub(skA) in
                                {1307}out(c, GetEndpointRequest);
                                {1308}in(c, (=GetEndpointResponse,=pkSess_1572,=SignAndEncrypt,SP_1573: bitstring,UP_1574: bitstring));
                                {1309}new Nc_1575: bitstring;
                                {1310}let m1_1576: bitstring = (OpenSecureChannelRequest,pkCli_1080,Nc_1575) in
                                {1311}event beginCli(Cli,Sess,Nc_1575);
                                {1312}out(c, (pkCli_1080,enc(m1_1576,pkSess_1572),sign(h(m1_1576),skCli_1079)));
                                {1313}in(c, (em2_1577: bitstring,sigM2_1578: bitstring));
                                {1314}let m2_1579: bitstring = dec(em2_1577,skCli_1079) in
                                {1315}if (verify(h(m2_1579),sigM2_1578,pkSess_1572) <> true) then
                                    0
                                else
                                    {1316}let (=OpenSecureChannelResponse,Ns_1580: bitstring,ST_1581: bitstring,TTL_1582: bitstring) = m2_1579 in
                                    {1317}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                    {1318}event endCli(Sess,Cli,Ns_1580)
                            )
                            else
                                {1319}let v_1583: bool = (Sess = B) in
                                (
                                    {1320}if v_1583 then
                                    (
                                        {1321}let pkSess_1584: bitstring = pub(skB) in
                                        {1322}out(c, GetEndpointRequest);
                                        {1323}in(c, (=GetEndpointResponse,=pkSess_1584,=SignAndEncrypt,SP_1585: bitstring,UP_1586: bitstring));
                                        {1324}new Nc_1587: bitstring;
                                        {1325}let m1_1588: bitstring = (OpenSecureChannelRequest,pkCli_1080,Nc_1587) in
                                        {1326}event beginCli(Cli,Sess,Nc_1587);
                                        {1327}out(c, (pkCli_1080,enc(m1_1588,pkSess_1584),sign(h(m1_1588),skCli_1079)));
                                        {1328}in(c, (em2_1589: bitstring,sigM2_1590: bitstring));
                                        {1329}let m2_1591: bitstring = dec(em2_1589,skCli_1079) in
                                        {1330}if (verify(h(m2_1591),sigM2_1590,pkSess_1584) <> true) then
                                            0
                                        else
                                            {1331}let (=OpenSecureChannelResponse,Ns_1592: bitstring,ST_1593: bitstring,TTL_1594: bitstring) = m2_1591 in
                                            {1332}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {1333}event endCli(Sess,Cli,Ns_1592)
                                    )
                                    else
                                        {1334}let v_1595: bool = (Sess = C) in
                                        (
                                            {1335}if v_1595 then
                                            (
                                                {1336}let pkSess_1596: bitstring = pub(skC) in
                                                {1337}out(c, GetEndpointRequest);
                                                {1338}in(c, (=GetEndpointResponse,=pkSess_1596,=SignAndEncrypt,SP_1597: bitstring,UP_1598: bitstring));
                                                {1339}new Nc_1599: bitstring;
                                                {1340}let m1_1600: bitstring = (OpenSecureChannelRequest,pkCli_1080,Nc_1599) in
                                                {1341}event beginCli(Cli,Sess,Nc_1599);
                                                {1342}out(c, (pkCli_1080,enc(m1_1600,pkSess_1596),sign(h(m1_1600),skCli_1079)));
                                                {1343}in(c, (em2_1601: bitstring,sigM2_1602: bitstring));
                                                {1344}let m2_1603: bitstring = dec(em2_1601,skCli_1079) in
                                                {1345}if (verify(h(m2_1603),sigM2_1602,pkSess_1596) <> true) then
                                                    0
                                                else
                                                    {1346}let (=OpenSecureChannelResponse,Ns_1604: bitstring,ST_1605: bitstring,TTL_1606: bitstring) = m2_1603 in
                                                    {1347}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {1348}event endCli(Sess,Cli,Ns_1604)
                                            )
                                            else
                                                {1349}let pkSess_1607: bitstring = pub(sk(Sess)) in
                                                {1350}out(c, GetEndpointRequest);
                                                {1351}in(c, (=GetEndpointResponse,=pkSess_1607,=SignAndEncrypt,SP_1608: bitstring,UP_1609: bitstring));
                                                {1352}new Nc_1610: bitstring;
                                                {1353}let m1_1611: bitstring = (OpenSecureChannelRequest,pkCli_1080,Nc_1610) in
                                                {1354}event beginCli(Cli,Sess,Nc_1610);
                                                {1355}out(c, (pkCli_1080,enc(m1_1611,pkSess_1607),sign(h(m1_1611),skCli_1079)));
                                                {1356}in(c, (em2_1612: bitstring,sigM2_1613: bitstring));
                                                {1357}let m2_1614: bitstring = dec(em2_1612,skCli_1079) in
                                                {1358}if (verify(h(m2_1614),sigM2_1613,pkSess_1607) <> true) then
                                                    0
                                                else
                                                    {1359}let (=OpenSecureChannelResponse,Ns_1615: bitstring,ST_1616: bitstring,TTL_1617: bitstring) = m2_1614 in
                                                    {1360}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {1361}event endCli(Sess,Cli,Ns_1615)
                                        )
                                        else
                                            {1362}let pkSess_1618: bitstring = fail-any in
                                            {1363}out(c, GetEndpointRequest);
                                            {1364}in(c, (=GetEndpointResponse,=pkSess_1618,=SignAndEncrypt,SP_1619: bitstring,UP_1620: bitstring));
                                            {1365}new Nc_1621: bitstring;
                                            {1366}let m1_1622: bitstring = (OpenSecureChannelRequest,pkCli_1080,Nc_1621) in
                                            {1367}event beginCli(Cli,Sess,Nc_1621);
                                            {1368}out(c, (pkCli_1080,enc(m1_1622,pkSess_1618),sign(h(m1_1622),skCli_1079)));
                                            {1369}in(c, (em2_1623: bitstring,sigM2_1624: bitstring));
                                            {1370}let m2_1625: bitstring = dec(em2_1623,skCli_1079) in
                                            {1371}if (verify(h(m2_1625),sigM2_1624,pkSess_1618) <> true) then
                                                0
                                            else
                                                {1372}let (=OpenSecureChannelResponse,Ns_1626: bitstring,ST_1627: bitstring,TTL_1628: bitstring) = m2_1625 in
                                                {1373}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {1374}event endCli(Sess,Cli,Ns_1626)
                                )
                                else
                                    {1375}let pkSess_1629: bitstring = fail-any in
                                    {1376}out(c, GetEndpointRequest);
                                    {1377}in(c, (=GetEndpointResponse,=pkSess_1629,=SignAndEncrypt,SP_1630: bitstring,UP_1631: bitstring));
                                    {1378}new Nc_1632: bitstring;
                                    {1379}let m1_1633: bitstring = (OpenSecureChannelRequest,pkCli_1080,Nc_1632) in
                                    {1380}event beginCli(Cli,Sess,Nc_1632);
                                    {1381}out(c, (pkCli_1080,enc(m1_1633,pkSess_1629),sign(h(m1_1633),skCli_1079)));
                                    {1382}in(c, (em2_1634: bitstring,sigM2_1635: bitstring));
                                    {1383}let m2_1636: bitstring = dec(em2_1634,skCli_1079) in
                                    {1384}if (verify(h(m2_1636),sigM2_1635,pkSess_1629) <> true) then
                                        0
                                    else
                                        {1385}let (=OpenSecureChannelResponse,Ns_1637: bitstring,ST_1638: bitstring,TTL_1639: bitstring) = m2_1636 in
                                        {1386}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                        {1387}event endCli(Sess,Cli,Ns_1637)
                        )
                        else
                            {1388}let pkSess_1640: bitstring = fail-any in
                            {1389}out(c, GetEndpointRequest);
                            {1390}in(c, (=GetEndpointResponse,=pkSess_1640,=SignAndEncrypt,SP_1641: bitstring,UP_1642: bitstring));
                            {1391}new Nc_1643: bitstring;
                            {1392}let m1_1644: bitstring = (OpenSecureChannelRequest,pkCli_1080,Nc_1643) in
                            {1393}event beginCli(Cli,Sess,Nc_1643);
                            {1394}out(c, (pkCli_1080,enc(m1_1644,pkSess_1640),sign(h(m1_1644),skCli_1079)));
                            {1395}in(c, (em2_1645: bitstring,sigM2_1646: bitstring));
                            {1396}let m2_1647: bitstring = dec(em2_1645,skCli_1079) in
                            {1397}if (verify(h(m2_1647),sigM2_1646,pkSess_1640) <> true) then
                                0
                            else
                                {1398}let (=OpenSecureChannelResponse,Ns_1648: bitstring,ST_1649: bitstring,TTL_1650: bitstring) = m2_1647 in
                                {1399}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                {1400}event endCli(Sess,Cli,Ns_1648)
                )
                else
                    {1401}let =true = (Cli = C) in
                    (
                        {1402}let skCli_1651: bitstring = skC in
                        {1403}let pkCli_1652: bitstring = pub(skCli_1651) in
                        {1404}let v_1653: bool = (Disco = A) in
                        (
                            {1405}if v_1653 then
                            (
                                {1406}let pkDisco_1654: bitstring = pub(skA) in
                                {1407}let v_1655: bool = (Sess = A) in
                                (
                                    {1408}if v_1655 then
                                    (
                                        {1409}let pkSess_1656: bitstring = pub(skA) in
                                        {1410}out(c, GetEndpointRequest);
                                        {1411}in(c, (=GetEndpointResponse,=pkSess_1656,=SignAndEncrypt,SP_1657: bitstring,UP_1658: bitstring));
                                        {1412}new Nc_1659: bitstring;
                                        {1413}let m1_1660: bitstring = (OpenSecureChannelRequest,pkCli_1652,Nc_1659) in
                                        {1414}event beginCli(Cli,Sess,Nc_1659);
                                        {1415}out(c, (pkCli_1652,enc(m1_1660,pkSess_1656),sign(h(m1_1660),skCli_1651)));
                                        {1416}in(c, (em2_1661: bitstring,sigM2_1662: bitstring));
                                        {1417}let m2_1663: bitstring = dec(em2_1661,skCli_1651) in
                                        {1418}if (verify(h(m2_1663),sigM2_1662,pkSess_1656) <> true) then
                                            0
                                        else
                                            {1419}let (=OpenSecureChannelResponse,Ns_1664: bitstring,ST_1665: bitstring,TTL_1666: bitstring) = m2_1663 in
                                            {1420}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {1421}event endCli(Sess,Cli,Ns_1664)
                                    )
                                    else
                                        {1422}let v_1667: bool = (Sess = B) in
                                        (
                                            {1423}if v_1667 then
                                            (
                                                {1424}let pkSess_1668: bitstring = pub(skB) in
                                                {1425}out(c, GetEndpointRequest);
                                                {1426}in(c, (=GetEndpointResponse,=pkSess_1668,=SignAndEncrypt,SP_1669: bitstring,UP_1670: bitstring));
                                                {1427}new Nc_1671: bitstring;
                                                {1428}let m1_1672: bitstring = (OpenSecureChannelRequest,pkCli_1652,Nc_1671) in
                                                {1429}event beginCli(Cli,Sess,Nc_1671);
                                                {1430}out(c, (pkCli_1652,enc(m1_1672,pkSess_1668),sign(h(m1_1672),skCli_1651)));
                                                {1431}in(c, (em2_1673: bitstring,sigM2_1674: bitstring));
                                                {1432}let m2_1675: bitstring = dec(em2_1673,skCli_1651) in
                                                {1433}if (verify(h(m2_1675),sigM2_1674,pkSess_1668) <> true) then
                                                    0
                                                else
                                                    {1434}let (=OpenSecureChannelResponse,Ns_1676: bitstring,ST_1677: bitstring,TTL_1678: bitstring) = m2_1675 in
                                                    {1435}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {1436}event endCli(Sess,Cli,Ns_1676)
                                            )
                                            else
                                                {1437}let v_1679: bool = (Sess = C) in
                                                (
                                                    {1438}if v_1679 then
                                                    (
                                                        {1439}let pkSess_1680: bitstring = pub(skC) in
                                                        {1440}out(c, GetEndpointRequest);
                                                        {1441}in(c, (=GetEndpointResponse,=pkSess_1680,=SignAndEncrypt,SP_1681: bitstring,UP_1682: bitstring));
                                                        {1442}new Nc_1683: bitstring;
                                                        {1443}let m1_1684: bitstring = (OpenSecureChannelRequest,pkCli_1652,Nc_1683) in
                                                        {1444}event beginCli(Cli,Sess,Nc_1683);
                                                        {1445}out(c, (pkCli_1652,enc(m1_1684,pkSess_1680),sign(h(m1_1684),skCli_1651)));
                                                        {1446}in(c, (em2_1685: bitstring,sigM2_1686: bitstring));
                                                        {1447}let m2_1687: bitstring = dec(em2_1685,skCli_1651) in
                                                        {1448}if (verify(h(m2_1687),sigM2_1686,pkSess_1680) <> true) then
                                                            0
                                                        else
                                                            {1449}let (=OpenSecureChannelResponse,Ns_1688: bitstring,ST_1689: bitstring,TTL_1690: bitstring) = m2_1687 in
                                                            {1450}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                            {1451}event endCli(Sess,Cli,Ns_1688)
                                                    )
                                                    else
                                                        {1452}let pkSess_1691: bitstring = pub(sk(Sess)) in
                                                        {1453}out(c, GetEndpointRequest);
                                                        {1454}in(c, (=GetEndpointResponse,=pkSess_1691,=SignAndEncrypt,SP_1692: bitstring,UP_1693: bitstring));
                                                        {1455}new Nc_1694: bitstring;
                                                        {1456}let m1_1695: bitstring = (OpenSecureChannelRequest,pkCli_1652,Nc_1694) in
                                                        {1457}event beginCli(Cli,Sess,Nc_1694);
                                                        {1458}out(c, (pkCli_1652,enc(m1_1695,pkSess_1691),sign(h(m1_1695),skCli_1651)));
                                                        {1459}in(c, (em2_1696: bitstring,sigM2_1697: bitstring));
                                                        {1460}let m2_1698: bitstring = dec(em2_1696,skCli_1651) in
                                                        {1461}if (verify(h(m2_1698),sigM2_1697,pkSess_1691) <> true) then
                                                            0
                                                        else
                                                            {1462}let (=OpenSecureChannelResponse,Ns_1699: bitstring,ST_1700: bitstring,TTL_1701: bitstring) = m2_1698 in
                                                            {1463}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                            {1464}event endCli(Sess,Cli,Ns_1699)
                                                )
                                                else
                                                    {1465}let pkSess_1702: bitstring = fail-any in
                                                    {1466}out(c, GetEndpointRequest);
                                                    {1467}in(c, (=GetEndpointResponse,=pkSess_1702,=SignAndEncrypt,SP_1703: bitstring,UP_1704: bitstring));
                                                    {1468}new Nc_1705: bitstring;
                                                    {1469}let m1_1706: bitstring = (OpenSecureChannelRequest,pkCli_1652,Nc_1705) in
                                                    {1470}event beginCli(Cli,Sess,Nc_1705);
                                                    {1471}out(c, (pkCli_1652,enc(m1_1706,pkSess_1702),sign(h(m1_1706),skCli_1651)));
                                                    {1472}in(c, (em2_1707: bitstring,sigM2_1708: bitstring));
                                                    {1473}let m2_1709: bitstring = dec(em2_1707,skCli_1651) in
                                                    {1474}if (verify(h(m2_1709),sigM2_1708,pkSess_1702) <> true) then
                                                        0
                                                    else
                                                        {1475}let (=OpenSecureChannelResponse,Ns_1710: bitstring,ST_1711: bitstring,TTL_1712: bitstring) = m2_1709 in
                                                        {1476}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {1477}event endCli(Sess,Cli,Ns_1710)
                                        )
                                        else
                                            {1478}let pkSess_1713: bitstring = fail-any in
                                            {1479}out(c, GetEndpointRequest);
                                            {1480}in(c, (=GetEndpointResponse,=pkSess_1713,=SignAndEncrypt,SP_1714: bitstring,UP_1715: bitstring));
                                            {1481}new Nc_1716: bitstring;
                                            {1482}let m1_1717: bitstring = (OpenSecureChannelRequest,pkCli_1652,Nc_1716) in
                                            {1483}event beginCli(Cli,Sess,Nc_1716);
                                            {1484}out(c, (pkCli_1652,enc(m1_1717,pkSess_1713),sign(h(m1_1717),skCli_1651)));
                                            {1485}in(c, (em2_1718: bitstring,sigM2_1719: bitstring));
                                            {1486}let m2_1720: bitstring = dec(em2_1718,skCli_1651) in
                                            {1487}if (verify(h(m2_1720),sigM2_1719,pkSess_1713) <> true) then
                                                0
                                            else
                                                {1488}let (=OpenSecureChannelResponse,Ns_1721: bitstring,ST_1722: bitstring,TTL_1723: bitstring) = m2_1720 in
                                                {1489}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {1490}event endCli(Sess,Cli,Ns_1721)
                                )
                                else
                                    {1491}let pkSess_1724: bitstring = fail-any in
                                    {1492}out(c, GetEndpointRequest);
                                    {1493}in(c, (=GetEndpointResponse,=pkSess_1724,=SignAndEncrypt,SP_1725: bitstring,UP_1726: bitstring));
                                    {1494}new Nc_1727: bitstring;
                                    {1495}let m1_1728: bitstring = (OpenSecureChannelRequest,pkCli_1652,Nc_1727) in
                                    {1496}event beginCli(Cli,Sess,Nc_1727);
                                    {1497}out(c, (pkCli_1652,enc(m1_1728,pkSess_1724),sign(h(m1_1728),skCli_1651)));
                                    {1498}in(c, (em2_1729: bitstring,sigM2_1730: bitstring));
                                    {1499}let m2_1731: bitstring = dec(em2_1729,skCli_1651) in
                                    {1500}if (verify(h(m2_1731),sigM2_1730,pkSess_1724) <> true) then
                                        0
                                    else
                                        {1501}let (=OpenSecureChannelResponse,Ns_1732: bitstring,ST_1733: bitstring,TTL_1734: bitstring) = m2_1731 in
                                        {1502}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                        {1503}event endCli(Sess,Cli,Ns_1732)
                            )
                            else
                                {1504}let v_1735: bool = (Disco = B) in
                                (
                                    {1505}if v_1735 then
                                    (
                                        {1506}let pkDisco_1736: bitstring = pub(skB) in
                                        {1507}let v_1737: bool = (Sess = A) in
                                        (
                                            {1508}if v_1737 then
                                            (
                                                {1509}let pkSess_1738: bitstring = pub(skA) in
                                                {1510}out(c, GetEndpointRequest);
                                                {1511}in(c, (=GetEndpointResponse,=pkSess_1738,=SignAndEncrypt,SP_1739: bitstring,UP_1740: bitstring));
                                                {1512}new Nc_1741: bitstring;
                                                {1513}let m1_1742: bitstring = (OpenSecureChannelRequest,pkCli_1652,Nc_1741) in
                                                {1514}event beginCli(Cli,Sess,Nc_1741);
                                                {1515}out(c, (pkCli_1652,enc(m1_1742,pkSess_1738),sign(h(m1_1742),skCli_1651)));
                                                {1516}in(c, (em2_1743: bitstring,sigM2_1744: bitstring));
                                                {1517}let m2_1745: bitstring = dec(em2_1743,skCli_1651) in
                                                {1518}if (verify(h(m2_1745),sigM2_1744,pkSess_1738) <> true) then
                                                    0
                                                else
                                                    {1519}let (=OpenSecureChannelResponse,Ns_1746: bitstring,ST_1747: bitstring,TTL_1748: bitstring) = m2_1745 in
                                                    {1520}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {1521}event endCli(Sess,Cli,Ns_1746)
                                            )
                                            else
                                                {1522}let v_1749: bool = (Sess = B) in
                                                (
                                                    {1523}if v_1749 then
                                                    (
                                                        {1524}let pkSess_1750: bitstring = pub(skB) in
                                                        {1525}out(c, GetEndpointRequest);
                                                        {1526}in(c, (=GetEndpointResponse,=pkSess_1750,=SignAndEncrypt,SP_1751: bitstring,UP_1752: bitstring));
                                                        {1527}new Nc_1753: bitstring;
                                                        {1528}let m1_1754: bitstring = (OpenSecureChannelRequest,pkCli_1652,Nc_1753) in
                                                        {1529}event beginCli(Cli,Sess,Nc_1753);
                                                        {1530}out(c, (pkCli_1652,enc(m1_1754,pkSess_1750),sign(h(m1_1754),skCli_1651)));
                                                        {1531}in(c, (em2_1755: bitstring,sigM2_1756: bitstring));
                                                        {1532}let m2_1757: bitstring = dec(em2_1755,skCli_1651) in
                                                        {1533}if (verify(h(m2_1757),sigM2_1756,pkSess_1750) <> true) then
                                                            0
                                                        else
                                                            {1534}let (=OpenSecureChannelResponse,Ns_1758: bitstring,ST_1759: bitstring,TTL_1760: bitstring) = m2_1757 in
                                                            {1535}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                            {1536}event endCli(Sess,Cli,Ns_1758)
                                                    )
                                                    else
                                                        {1537}let v_1761: bool = (Sess = C) in
                                                        (
                                                            {1538}if v_1761 then
                                                            (
                                                                {1539}let pkSess_1762: bitstring = pub(skC) in
                                                                {1540}out(c, GetEndpointRequest);
                                                                {1541}in(c, (=GetEndpointResponse,=pkSess_1762,=SignAndEncrypt,SP_1763: bitstring,UP_1764: bitstring));
                                                                {1542}new Nc_1765: bitstring;
                                                                {1543}let m1_1766: bitstring = (OpenSecureChannelRequest,pkCli_1652,Nc_1765) in
                                                                {1544}event beginCli(Cli,Sess,Nc_1765);
                                                                {1545}out(c, (pkCli_1652,enc(m1_1766,pkSess_1762),sign(h(m1_1766),skCli_1651)));
                                                                {1546}in(c, (em2_1767: bitstring,sigM2_1768: bitstring));
                                                                {1547}let m2_1769: bitstring = dec(em2_1767,skCli_1651) in
                                                                {1548}if (verify(h(m2_1769),sigM2_1768,pkSess_1762) <> true) then
                                                                    0
                                                                else
                                                                    {1549}let (=OpenSecureChannelResponse,Ns_1770: bitstring,ST_1771: bitstring,TTL_1772: bitstring) = m2_1769 in
                                                                    {1550}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                    {1551}event endCli(Sess,Cli,Ns_1770)
                                                            )
                                                            else
                                                                {1552}let pkSess_1773: bitstring = pub(sk(Sess)) in
                                                                {1553}out(c, GetEndpointRequest);
                                                                {1554}in(c, (=GetEndpointResponse,=pkSess_1773,=SignAndEncrypt,SP_1774: bitstring,UP_1775: bitstring));
                                                                {1555}new Nc_1776: bitstring;
                                                                {1556}let m1_1777: bitstring = (OpenSecureChannelRequest,pkCli_1652,Nc_1776) in
                                                                {1557}event beginCli(Cli,Sess,Nc_1776);
                                                                {1558}out(c, (pkCli_1652,enc(m1_1777,pkSess_1773),sign(h(m1_1777),skCli_1651)));
                                                                {1559}in(c, (em2_1778: bitstring,sigM2_1779: bitstring));
                                                                {1560}let m2_1780: bitstring = dec(em2_1778,skCli_1651) in
                                                                {1561}if (verify(h(m2_1780),sigM2_1779,pkSess_1773) <> true) then
                                                                    0
                                                                else
                                                                    {1562}let (=OpenSecureChannelResponse,Ns_1781: bitstring,ST_1782: bitstring,TTL_1783: bitstring) = m2_1780 in
                                                                    {1563}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                    {1564}event endCli(Sess,Cli,Ns_1781)
                                                        )
                                                        else
                                                            {1565}let pkSess_1784: bitstring = fail-any in
                                                            {1566}out(c, GetEndpointRequest);
                                                            {1567}in(c, (=GetEndpointResponse,=pkSess_1784,=SignAndEncrypt,SP_1785: bitstring,UP_1786: bitstring));
                                                            {1568}new Nc_1787: bitstring;
                                                            {1569}let m1_1788: bitstring = (OpenSecureChannelRequest,pkCli_1652,Nc_1787) in
                                                            {1570}event beginCli(Cli,Sess,Nc_1787);
                                                            {1571}out(c, (pkCli_1652,enc(m1_1788,pkSess_1784),sign(h(m1_1788),skCli_1651)));
                                                            {1572}in(c, (em2_1789: bitstring,sigM2_1790: bitstring));
                                                            {1573}let m2_1791: bitstring = dec(em2_1789,skCli_1651) in
                                                            {1574}if (verify(h(m2_1791),sigM2_1790,pkSess_1784) <> true) then
                                                                0
                                                            else
                                                                {1575}let (=OpenSecureChannelResponse,Ns_1792: bitstring,ST_1793: bitstring,TTL_1794: bitstring) = m2_1791 in
                                                                {1576}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                {1577}event endCli(Sess,Cli,Ns_1792)
                                                )
                                                else
                                                    {1578}let pkSess_1795: bitstring = fail-any in
                                                    {1579}out(c, GetEndpointRequest);
                                                    {1580}in(c, (=GetEndpointResponse,=pkSess_1795,=SignAndEncrypt,SP_1796: bitstring,UP_1797: bitstring));
                                                    {1581}new Nc_1798: bitstring;
                                                    {1582}let m1_1799: bitstring = (OpenSecureChannelRequest,pkCli_1652,Nc_1798) in
                                                    {1583}event beginCli(Cli,Sess,Nc_1798);
                                                    {1584}out(c, (pkCli_1652,enc(m1_1799,pkSess_1795),sign(h(m1_1799),skCli_1651)));
                                                    {1585}in(c, (em2_1800: bitstring,sigM2_1801: bitstring));
                                                    {1586}let m2_1802: bitstring = dec(em2_1800,skCli_1651) in
                                                    {1587}if (verify(h(m2_1802),sigM2_1801,pkSess_1795) <> true) then
                                                        0
                                                    else
                                                        {1588}let (=OpenSecureChannelResponse,Ns_1803: bitstring,ST_1804: bitstring,TTL_1805: bitstring) = m2_1802 in
                                                        {1589}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {1590}event endCli(Sess,Cli,Ns_1803)
                                        )
                                        else
                                            {1591}let pkSess_1806: bitstring = fail-any in
                                            {1592}out(c, GetEndpointRequest);
                                            {1593}in(c, (=GetEndpointResponse,=pkSess_1806,=SignAndEncrypt,SP_1807: bitstring,UP_1808: bitstring));
                                            {1594}new Nc_1809: bitstring;
                                            {1595}let m1_1810: bitstring = (OpenSecureChannelRequest,pkCli_1652,Nc_1809) in
                                            {1596}event beginCli(Cli,Sess,Nc_1809);
                                            {1597}out(c, (pkCli_1652,enc(m1_1810,pkSess_1806),sign(h(m1_1810),skCli_1651)));
                                            {1598}in(c, (em2_1811: bitstring,sigM2_1812: bitstring));
                                            {1599}let m2_1813: bitstring = dec(em2_1811,skCli_1651) in
                                            {1600}if (verify(h(m2_1813),sigM2_1812,pkSess_1806) <> true) then
                                                0
                                            else
                                                {1601}let (=OpenSecureChannelResponse,Ns_1814: bitstring,ST_1815: bitstring,TTL_1816: bitstring) = m2_1813 in
                                                {1602}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {1603}event endCli(Sess,Cli,Ns_1814)
                                    )
                                    else
                                        {1604}let v_1817: bool = (Disco = C) in
                                        (
                                            {1605}if v_1817 then
                                            (
                                                {1606}let pkDisco_1818: bitstring = pub(skC) in
                                                {1607}let v_1819: bool = (Sess = A) in
                                                (
                                                    {1608}if v_1819 then
                                                    (
                                                        {1609}let pkSess_1820: bitstring = pub(skA) in
                                                        {1610}out(c, GetEndpointRequest);
                                                        {1611}in(c, (=GetEndpointResponse,=pkSess_1820,=SignAndEncrypt,SP_1821: bitstring,UP_1822: bitstring));
                                                        {1612}new Nc_1823: bitstring;
                                                        {1613}let m1_1824: bitstring = (OpenSecureChannelRequest,pkCli_1652,Nc_1823) in
                                                        {1614}event beginCli(Cli,Sess,Nc_1823);
                                                        {1615}out(c, (pkCli_1652,enc(m1_1824,pkSess_1820),sign(h(m1_1824),skCli_1651)));
                                                        {1616}in(c, (em2_1825: bitstring,sigM2_1826: bitstring));
                                                        {1617}let m2_1827: bitstring = dec(em2_1825,skCli_1651) in
                                                        {1618}if (verify(h(m2_1827),sigM2_1826,pkSess_1820) <> true) then
                                                            0
                                                        else
                                                            {1619}let (=OpenSecureChannelResponse,Ns_1828: bitstring,ST_1829: bitstring,TTL_1830: bitstring) = m2_1827 in
                                                            {1620}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                            {1621}event endCli(Sess,Cli,Ns_1828)
                                                    )
                                                    else
                                                        {1622}let v_1831: bool = (Sess = B) in
                                                        (
                                                            {1623}if v_1831 then
                                                            (
                                                                {1624}let pkSess_1832: bitstring = pub(skB) in
                                                                {1625}out(c, GetEndpointRequest);
                                                                {1626}in(c, (=GetEndpointResponse,=pkSess_1832,=SignAndEncrypt,SP_1833: bitstring,UP_1834: bitstring));
                                                                {1627}new Nc_1835: bitstring;
                                                                {1628}let m1_1836: bitstring = (OpenSecureChannelRequest,pkCli_1652,Nc_1835) in
                                                                {1629}event beginCli(Cli,Sess,Nc_1835);
                                                                {1630}out(c, (pkCli_1652,enc(m1_1836,pkSess_1832),sign(h(m1_1836),skCli_1651)));
                                                                {1631}in(c, (em2_1837: bitstring,sigM2_1838: bitstring));
                                                                {1632}let m2_1839: bitstring = dec(em2_1837,skCli_1651) in
                                                                {1633}if (verify(h(m2_1839),sigM2_1838,pkSess_1832) <> true) then
                                                                    0
                                                                else
                                                                    {1634}let (=OpenSecureChannelResponse,Ns_1840: bitstring,ST_1841: bitstring,TTL_1842: bitstring) = m2_1839 in
                                                                    {1635}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                    {1636}event endCli(Sess,Cli,Ns_1840)
                                                            )
                                                            else
                                                                {1637}let v_1843: bool = (Sess = C) in
                                                                (
                                                                    {1638}if v_1843 then
                                                                    (
                                                                        {1639}let pkSess_1844: bitstring = pub(skC) in
                                                                        {1640}out(c, GetEndpointRequest);
                                                                        {1641}in(c, (=GetEndpointResponse,=pkSess_1844,=SignAndEncrypt,SP_1845: bitstring,UP_1846: bitstring));
                                                                        {1642}new Nc_1847: bitstring;
                                                                        {1643}let m1_1848: bitstring = (OpenSecureChannelRequest,pkCli_1652,Nc_1847) in
                                                                        {1644}event beginCli(Cli,Sess,Nc_1847);
                                                                        {1645}out(c, (pkCli_1652,enc(m1_1848,pkSess_1844),sign(h(m1_1848),skCli_1651)));
                                                                        {1646}in(c, (em2_1849: bitstring,sigM2_1850: bitstring));
                                                                        {1647}let m2_1851: bitstring = dec(em2_1849,skCli_1651) in
                                                                        {1648}if (verify(h(m2_1851),sigM2_1850,pkSess_1844) <> true) then
                                                                            0
                                                                        else
                                                                            {1649}let (=OpenSecureChannelResponse,Ns_1852: bitstring,ST_1853: bitstring,TTL_1854: bitstring) = m2_1851 in
                                                                            {1650}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                            {1651}event endCli(Sess,Cli,Ns_1852)
                                                                    )
                                                                    else
                                                                        {1652}let pkSess_1855: bitstring = pub(sk(Sess)) in
                                                                        {1653}out(c, GetEndpointRequest);
                                                                        {1654}in(c, (=GetEndpointResponse,=pkSess_1855,=SignAndEncrypt,SP_1856: bitstring,UP_1857: bitstring));
                                                                        {1655}new Nc_1858: bitstring;
                                                                        {1656}let m1_1859: bitstring = (OpenSecureChannelRequest,pkCli_1652,Nc_1858) in
                                                                        {1657}event beginCli(Cli,Sess,Nc_1858);
                                                                        {1658}out(c, (pkCli_1652,enc(m1_1859,pkSess_1855),sign(h(m1_1859),skCli_1651)));
                                                                        {1659}in(c, (em2_1860: bitstring,sigM2_1861: bitstring));
                                                                        {1660}let m2_1862: bitstring = dec(em2_1860,skCli_1651) in
                                                                        {1661}if (verify(h(m2_1862),sigM2_1861,pkSess_1855) <> true) then
                                                                            0
                                                                        else
                                                                            {1662}let (=OpenSecureChannelResponse,Ns_1863: bitstring,ST_1864: bitstring,TTL_1865: bitstring) = m2_1862 in
                                                                            {1663}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                            {1664}event endCli(Sess,Cli,Ns_1863)
                                                                )
                                                                else
                                                                    {1665}let pkSess_1866: bitstring = fail-any in
                                                                    {1666}out(c, GetEndpointRequest);
                                                                    {1667}in(c, (=GetEndpointResponse,=pkSess_1866,=SignAndEncrypt,SP_1867: bitstring,UP_1868: bitstring));
                                                                    {1668}new Nc_1869: bitstring;
                                                                    {1669}let m1_1870: bitstring = (OpenSecureChannelRequest,pkCli_1652,Nc_1869) in
                                                                    {1670}event beginCli(Cli,Sess,Nc_1869);
                                                                    {1671}out(c, (pkCli_1652,enc(m1_1870,pkSess_1866),sign(h(m1_1870),skCli_1651)));
                                                                    {1672}in(c, (em2_1871: bitstring,sigM2_1872: bitstring));
                                                                    {1673}let m2_1873: bitstring = dec(em2_1871,skCli_1651) in
                                                                    {1674}if (verify(h(m2_1873),sigM2_1872,pkSess_1866) <> true) then
                                                                        0
                                                                    else
                                                                        {1675}let (=OpenSecureChannelResponse,Ns_1874: bitstring,ST_1875: bitstring,TTL_1876: bitstring) = m2_1873 in
                                                                        {1676}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                        {1677}event endCli(Sess,Cli,Ns_1874)
                                                        )
                                                        else
                                                            {1678}let pkSess_1877: bitstring = fail-any in
                                                            {1679}out(c, GetEndpointRequest);
                                                            {1680}in(c, (=GetEndpointResponse,=pkSess_1877,=SignAndEncrypt,SP_1878: bitstring,UP_1879: bitstring));
                                                            {1681}new Nc_1880: bitstring;
                                                            {1682}let m1_1881: bitstring = (OpenSecureChannelRequest,pkCli_1652,Nc_1880) in
                                                            {1683}event beginCli(Cli,Sess,Nc_1880);
                                                            {1684}out(c, (pkCli_1652,enc(m1_1881,pkSess_1877),sign(h(m1_1881),skCli_1651)));
                                                            {1685}in(c, (em2_1882: bitstring,sigM2_1883: bitstring));
                                                            {1686}let m2_1884: bitstring = dec(em2_1882,skCli_1651) in
                                                            {1687}if (verify(h(m2_1884),sigM2_1883,pkSess_1877) <> true) then
                                                                0
                                                            else
                                                                {1688}let (=OpenSecureChannelResponse,Ns_1885: bitstring,ST_1886: bitstring,TTL_1887: bitstring) = m2_1884 in
                                                                {1689}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                {1690}event endCli(Sess,Cli,Ns_1885)
                                                )
                                                else
                                                    {1691}let pkSess_1888: bitstring = fail-any in
                                                    {1692}out(c, GetEndpointRequest);
                                                    {1693}in(c, (=GetEndpointResponse,=pkSess_1888,=SignAndEncrypt,SP_1889: bitstring,UP_1890: bitstring));
                                                    {1694}new Nc_1891: bitstring;
                                                    {1695}let m1_1892: bitstring = (OpenSecureChannelRequest,pkCli_1652,Nc_1891) in
                                                    {1696}event beginCli(Cli,Sess,Nc_1891);
                                                    {1697}out(c, (pkCli_1652,enc(m1_1892,pkSess_1888),sign(h(m1_1892),skCli_1651)));
                                                    {1698}in(c, (em2_1893: bitstring,sigM2_1894: bitstring));
                                                    {1699}let m2_1895: bitstring = dec(em2_1893,skCli_1651) in
                                                    {1700}if (verify(h(m2_1895),sigM2_1894,pkSess_1888) <> true) then
                                                        0
                                                    else
                                                        {1701}let (=OpenSecureChannelResponse,Ns_1896: bitstring,ST_1897: bitstring,TTL_1898: bitstring) = m2_1895 in
                                                        {1702}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {1703}event endCli(Sess,Cli,Ns_1896)
                                            )
                                            else
                                                {1704}let pkDisco_1899: bitstring = pub(sk(Disco)) in
                                                {1705}let v_1900: bool = (Sess = A) in
                                                (
                                                    {1706}if v_1900 then
                                                    (
                                                        {1707}let pkSess_1901: bitstring = pub(skA) in
                                                        {1708}out(c, GetEndpointRequest);
                                                        {1709}in(c, (=GetEndpointResponse,=pkSess_1901,=SignAndEncrypt,SP_1902: bitstring,UP_1903: bitstring));
                                                        {1710}new Nc_1904: bitstring;
                                                        {1711}let m1_1905: bitstring = (OpenSecureChannelRequest,pkCli_1652,Nc_1904) in
                                                        {1712}event beginCli(Cli,Sess,Nc_1904);
                                                        {1713}out(c, (pkCli_1652,enc(m1_1905,pkSess_1901),sign(h(m1_1905),skCli_1651)));
                                                        {1714}in(c, (em2_1906: bitstring,sigM2_1907: bitstring));
                                                        {1715}let m2_1908: bitstring = dec(em2_1906,skCli_1651) in
                                                        {1716}if (verify(h(m2_1908),sigM2_1907,pkSess_1901) <> true) then
                                                            0
                                                        else
                                                            {1717}let (=OpenSecureChannelResponse,Ns_1909: bitstring,ST_1910: bitstring,TTL_1911: bitstring) = m2_1908 in
                                                            {1718}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                            {1719}event endCli(Sess,Cli,Ns_1909)
                                                    )
                                                    else
                                                        {1720}let v_1912: bool = (Sess = B) in
                                                        (
                                                            {1721}if v_1912 then
                                                            (
                                                                {1722}let pkSess_1913: bitstring = pub(skB) in
                                                                {1723}out(c, GetEndpointRequest);
                                                                {1724}in(c, (=GetEndpointResponse,=pkSess_1913,=SignAndEncrypt,SP_1914: bitstring,UP_1915: bitstring));
                                                                {1725}new Nc_1916: bitstring;
                                                                {1726}let m1_1917: bitstring = (OpenSecureChannelRequest,pkCli_1652,Nc_1916) in
                                                                {1727}event beginCli(Cli,Sess,Nc_1916);
                                                                {1728}out(c, (pkCli_1652,enc(m1_1917,pkSess_1913),sign(h(m1_1917),skCli_1651)));
                                                                {1729}in(c, (em2_1918: bitstring,sigM2_1919: bitstring));
                                                                {1730}let m2_1920: bitstring = dec(em2_1918,skCli_1651) in
                                                                {1731}if (verify(h(m2_1920),sigM2_1919,pkSess_1913) <> true) then
                                                                    0
                                                                else
                                                                    {1732}let (=OpenSecureChannelResponse,Ns_1921: bitstring,ST_1922: bitstring,TTL_1923: bitstring) = m2_1920 in
                                                                    {1733}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                    {1734}event endCli(Sess,Cli,Ns_1921)
                                                            )
                                                            else
                                                                {1735}let v_1924: bool = (Sess = C) in
                                                                (
                                                                    {1736}if v_1924 then
                                                                    (
                                                                        {1737}let pkSess_1925: bitstring = pub(skC) in
                                                                        {1738}out(c, GetEndpointRequest);
                                                                        {1739}in(c, (=GetEndpointResponse,=pkSess_1925,=SignAndEncrypt,SP_1926: bitstring,UP_1927: bitstring));
                                                                        {1740}new Nc_1928: bitstring;
                                                                        {1741}let m1_1929: bitstring = (OpenSecureChannelRequest,pkCli_1652,Nc_1928) in
                                                                        {1742}event beginCli(Cli,Sess,Nc_1928);
                                                                        {1743}out(c, (pkCli_1652,enc(m1_1929,pkSess_1925),sign(h(m1_1929),skCli_1651)));
                                                                        {1744}in(c, (em2_1930: bitstring,sigM2_1931: bitstring));
                                                                        {1745}let m2_1932: bitstring = dec(em2_1930,skCli_1651) in
                                                                        {1746}if (verify(h(m2_1932),sigM2_1931,pkSess_1925) <> true) then
                                                                            0
                                                                        else
                                                                            {1747}let (=OpenSecureChannelResponse,Ns_1933: bitstring,ST_1934: bitstring,TTL_1935: bitstring) = m2_1932 in
                                                                            {1748}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                            {1749}event endCli(Sess,Cli,Ns_1933)
                                                                    )
                                                                    else
                                                                        {1750}let pkSess_1936: bitstring = pub(sk(Sess)) in
                                                                        {1751}out(c, GetEndpointRequest);
                                                                        {1752}in(c, (=GetEndpointResponse,=pkSess_1936,=SignAndEncrypt,SP_1937: bitstring,UP_1938: bitstring));
                                                                        {1753}new Nc_1939: bitstring;
                                                                        {1754}let m1_1940: bitstring = (OpenSecureChannelRequest,pkCli_1652,Nc_1939) in
                                                                        {1755}event beginCli(Cli,Sess,Nc_1939);
                                                                        {1756}out(c, (pkCli_1652,enc(m1_1940,pkSess_1936),sign(h(m1_1940),skCli_1651)));
                                                                        {1757}in(c, (em2_1941: bitstring,sigM2_1942: bitstring));
                                                                        {1758}let m2_1943: bitstring = dec(em2_1941,skCli_1651) in
                                                                        {1759}if (verify(h(m2_1943),sigM2_1942,pkSess_1936) <> true) then
                                                                            0
                                                                        else
                                                                            {1760}let (=OpenSecureChannelResponse,Ns_1944: bitstring,ST_1945: bitstring,TTL_1946: bitstring) = m2_1943 in
                                                                            {1761}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                            {1762}event endCli(Sess,Cli,Ns_1944)
                                                                )
                                                                else
                                                                    {1763}let pkSess_1947: bitstring = fail-any in
                                                                    {1764}out(c, GetEndpointRequest);
                                                                    {1765}in(c, (=GetEndpointResponse,=pkSess_1947,=SignAndEncrypt,SP_1948: bitstring,UP_1949: bitstring));
                                                                    {1766}new Nc_1950: bitstring;
                                                                    {1767}let m1_1951: bitstring = (OpenSecureChannelRequest,pkCli_1652,Nc_1950) in
                                                                    {1768}event beginCli(Cli,Sess,Nc_1950);
                                                                    {1769}out(c, (pkCli_1652,enc(m1_1951,pkSess_1947),sign(h(m1_1951),skCli_1651)));
                                                                    {1770}in(c, (em2_1952: bitstring,sigM2_1953: bitstring));
                                                                    {1771}let m2_1954: bitstring = dec(em2_1952,skCli_1651) in
                                                                    {1772}if (verify(h(m2_1954),sigM2_1953,pkSess_1947) <> true) then
                                                                        0
                                                                    else
                                                                        {1773}let (=OpenSecureChannelResponse,Ns_1955: bitstring,ST_1956: bitstring,TTL_1957: bitstring) = m2_1954 in
                                                                        {1774}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                        {1775}event endCli(Sess,Cli,Ns_1955)
                                                        )
                                                        else
                                                            {1776}let pkSess_1958: bitstring = fail-any in
                                                            {1777}out(c, GetEndpointRequest);
                                                            {1778}in(c, (=GetEndpointResponse,=pkSess_1958,=SignAndEncrypt,SP_1959: bitstring,UP_1960: bitstring));
                                                            {1779}new Nc_1961: bitstring;
                                                            {1780}let m1_1962: bitstring = (OpenSecureChannelRequest,pkCli_1652,Nc_1961) in
                                                            {1781}event beginCli(Cli,Sess,Nc_1961);
                                                            {1782}out(c, (pkCli_1652,enc(m1_1962,pkSess_1958),sign(h(m1_1962),skCli_1651)));
                                                            {1783}in(c, (em2_1963: bitstring,sigM2_1964: bitstring));
                                                            {1784}let m2_1965: bitstring = dec(em2_1963,skCli_1651) in
                                                            {1785}if (verify(h(m2_1965),sigM2_1964,pkSess_1958) <> true) then
                                                                0
                                                            else
                                                                {1786}let (=OpenSecureChannelResponse,Ns_1966: bitstring,ST_1967: bitstring,TTL_1968: bitstring) = m2_1965 in
                                                                {1787}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                {1788}event endCli(Sess,Cli,Ns_1966)
                                                )
                                                else
                                                    {1789}let pkSess_1969: bitstring = fail-any in
                                                    {1790}out(c, GetEndpointRequest);
                                                    {1791}in(c, (=GetEndpointResponse,=pkSess_1969,=SignAndEncrypt,SP_1970: bitstring,UP_1971: bitstring));
                                                    {1792}new Nc_1972: bitstring;
                                                    {1793}let m1_1973: bitstring = (OpenSecureChannelRequest,pkCli_1652,Nc_1972) in
                                                    {1794}event beginCli(Cli,Sess,Nc_1972);
                                                    {1795}out(c, (pkCli_1652,enc(m1_1973,pkSess_1969),sign(h(m1_1973),skCli_1651)));
                                                    {1796}in(c, (em2_1974: bitstring,sigM2_1975: bitstring));
                                                    {1797}let m2_1976: bitstring = dec(em2_1974,skCli_1651) in
                                                    {1798}if (verify(h(m2_1976),sigM2_1975,pkSess_1969) <> true) then
                                                        0
                                                    else
                                                        {1799}let (=OpenSecureChannelResponse,Ns_1977: bitstring,ST_1978: bitstring,TTL_1979: bitstring) = m2_1976 in
                                                        {1800}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {1801}event endCli(Sess,Cli,Ns_1977)
                                        )
                                        else
                                            {1802}let pkDisco_1980: bitstring = fail-any in
                                            {1803}let v_1981: bool = (Sess = A) in
                                            (
                                                {1804}if v_1981 then
                                                (
                                                    {1805}let pkSess_1982: bitstring = pub(skA) in
                                                    {1806}out(c, GetEndpointRequest);
                                                    {1807}in(c, (=GetEndpointResponse,=pkSess_1982,=SignAndEncrypt,SP_1983: bitstring,UP_1984: bitstring));
                                                    {1808}new Nc_1985: bitstring;
                                                    {1809}let m1_1986: bitstring = (OpenSecureChannelRequest,pkCli_1652,Nc_1985) in
                                                    {1810}event beginCli(Cli,Sess,Nc_1985);
                                                    {1811}out(c, (pkCli_1652,enc(m1_1986,pkSess_1982),sign(h(m1_1986),skCli_1651)));
                                                    {1812}in(c, (em2_1987: bitstring,sigM2_1988: bitstring));
                                                    {1813}let m2_1989: bitstring = dec(em2_1987,skCli_1651) in
                                                    {1814}if (verify(h(m2_1989),sigM2_1988,pkSess_1982) <> true) then
                                                        0
                                                    else
                                                        {1815}let (=OpenSecureChannelResponse,Ns_1990: bitstring,ST_1991: bitstring,TTL_1992: bitstring) = m2_1989 in
                                                        {1816}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {1817}event endCli(Sess,Cli,Ns_1990)
                                                )
                                                else
                                                    {1818}let v_1993: bool = (Sess = B) in
                                                    (
                                                        {1819}if v_1993 then
                                                        (
                                                            {1820}let pkSess_1994: bitstring = pub(skB) in
                                                            {1821}out(c, GetEndpointRequest);
                                                            {1822}in(c, (=GetEndpointResponse,=pkSess_1994,=SignAndEncrypt,SP_1995: bitstring,UP_1996: bitstring));
                                                            {1823}new Nc_1997: bitstring;
                                                            {1824}let m1_1998: bitstring = (OpenSecureChannelRequest,pkCli_1652,Nc_1997) in
                                                            {1825}event beginCli(Cli,Sess,Nc_1997);
                                                            {1826}out(c, (pkCli_1652,enc(m1_1998,pkSess_1994),sign(h(m1_1998),skCli_1651)));
                                                            {1827}in(c, (em2_1999: bitstring,sigM2_2000: bitstring));
                                                            {1828}let m2_2001: bitstring = dec(em2_1999,skCli_1651) in
                                                            {1829}if (verify(h(m2_2001),sigM2_2000,pkSess_1994) <> true) then
                                                                0
                                                            else
                                                                {1830}let (=OpenSecureChannelResponse,Ns_2002: bitstring,ST_2003: bitstring,TTL_2004: bitstring) = m2_2001 in
                                                                {1831}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                {1832}event endCli(Sess,Cli,Ns_2002)
                                                        )
                                                        else
                                                            {1833}let v_2005: bool = (Sess = C) in
                                                            (
                                                                {1834}if v_2005 then
                                                                (
                                                                    {1835}let pkSess_2006: bitstring = pub(skC) in
                                                                    {1836}out(c, GetEndpointRequest);
                                                                    {1837}in(c, (=GetEndpointResponse,=pkSess_2006,=SignAndEncrypt,SP_2007: bitstring,UP_2008: bitstring));
                                                                    {1838}new Nc_2009: bitstring;
                                                                    {1839}let m1_2010: bitstring = (OpenSecureChannelRequest,pkCli_1652,Nc_2009) in
                                                                    {1840}event beginCli(Cli,Sess,Nc_2009);
                                                                    {1841}out(c, (pkCli_1652,enc(m1_2010,pkSess_2006),sign(h(m1_2010),skCli_1651)));
                                                                    {1842}in(c, (em2_2011: bitstring,sigM2_2012: bitstring));
                                                                    {1843}let m2_2013: bitstring = dec(em2_2011,skCli_1651) in
                                                                    {1844}if (verify(h(m2_2013),sigM2_2012,pkSess_2006) <> true) then
                                                                        0
                                                                    else
                                                                        {1845}let (=OpenSecureChannelResponse,Ns_2014: bitstring,ST_2015: bitstring,TTL_2016: bitstring) = m2_2013 in
                                                                        {1846}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                        {1847}event endCli(Sess,Cli,Ns_2014)
                                                                )
                                                                else
                                                                    {1848}let pkSess_2017: bitstring = pub(sk(Sess)) in
                                                                    {1849}out(c, GetEndpointRequest);
                                                                    {1850}in(c, (=GetEndpointResponse,=pkSess_2017,=SignAndEncrypt,SP_2018: bitstring,UP_2019: bitstring));
                                                                    {1851}new Nc_2020: bitstring;
                                                                    {1852}let m1_2021: bitstring = (OpenSecureChannelRequest,pkCli_1652,Nc_2020) in
                                                                    {1853}event beginCli(Cli,Sess,Nc_2020);
                                                                    {1854}out(c, (pkCli_1652,enc(m1_2021,pkSess_2017),sign(h(m1_2021),skCli_1651)));
                                                                    {1855}in(c, (em2_2022: bitstring,sigM2_2023: bitstring));
                                                                    {1856}let m2_2024: bitstring = dec(em2_2022,skCli_1651) in
                                                                    {1857}if (verify(h(m2_2024),sigM2_2023,pkSess_2017) <> true) then
                                                                        0
                                                                    else
                                                                        {1858}let (=OpenSecureChannelResponse,Ns_2025: bitstring,ST_2026: bitstring,TTL_2027: bitstring) = m2_2024 in
                                                                        {1859}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                        {1860}event endCli(Sess,Cli,Ns_2025)
                                                            )
                                                            else
                                                                {1861}let pkSess_2028: bitstring = fail-any in
                                                                {1862}out(c, GetEndpointRequest);
                                                                {1863}in(c, (=GetEndpointResponse,=pkSess_2028,=SignAndEncrypt,SP_2029: bitstring,UP_2030: bitstring));
                                                                {1864}new Nc_2031: bitstring;
                                                                {1865}let m1_2032: bitstring = (OpenSecureChannelRequest,pkCli_1652,Nc_2031) in
                                                                {1866}event beginCli(Cli,Sess,Nc_2031);
                                                                {1867}out(c, (pkCli_1652,enc(m1_2032,pkSess_2028),sign(h(m1_2032),skCli_1651)));
                                                                {1868}in(c, (em2_2033: bitstring,sigM2_2034: bitstring));
                                                                {1869}let m2_2035: bitstring = dec(em2_2033,skCli_1651) in
                                                                {1870}if (verify(h(m2_2035),sigM2_2034,pkSess_2028) <> true) then
                                                                    0
                                                                else
                                                                    {1871}let (=OpenSecureChannelResponse,Ns_2036: bitstring,ST_2037: bitstring,TTL_2038: bitstring) = m2_2035 in
                                                                    {1872}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                    {1873}event endCli(Sess,Cli,Ns_2036)
                                                    )
                                                    else
                                                        {1874}let pkSess_2039: bitstring = fail-any in
                                                        {1875}out(c, GetEndpointRequest);
                                                        {1876}in(c, (=GetEndpointResponse,=pkSess_2039,=SignAndEncrypt,SP_2040: bitstring,UP_2041: bitstring));
                                                        {1877}new Nc_2042: bitstring;
                                                        {1878}let m1_2043: bitstring = (OpenSecureChannelRequest,pkCli_1652,Nc_2042) in
                                                        {1879}event beginCli(Cli,Sess,Nc_2042);
                                                        {1880}out(c, (pkCli_1652,enc(m1_2043,pkSess_2039),sign(h(m1_2043),skCli_1651)));
                                                        {1881}in(c, (em2_2044: bitstring,sigM2_2045: bitstring));
                                                        {1882}let m2_2046: bitstring = dec(em2_2044,skCli_1651) in
                                                        {1883}if (verify(h(m2_2046),sigM2_2045,pkSess_2039) <> true) then
                                                            0
                                                        else
                                                            {1884}let (=OpenSecureChannelResponse,Ns_2047: bitstring,ST_2048: bitstring,TTL_2049: bitstring) = m2_2046 in
                                                            {1885}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                            {1886}event endCli(Sess,Cli,Ns_2047)
                                            )
                                            else
                                                {1887}let pkSess_2050: bitstring = fail-any in
                                                {1888}out(c, GetEndpointRequest);
                                                {1889}in(c, (=GetEndpointResponse,=pkSess_2050,=SignAndEncrypt,SP_2051: bitstring,UP_2052: bitstring));
                                                {1890}new Nc_2053: bitstring;
                                                {1891}let m1_2054: bitstring = (OpenSecureChannelRequest,pkCli_1652,Nc_2053) in
                                                {1892}event beginCli(Cli,Sess,Nc_2053);
                                                {1893}out(c, (pkCli_1652,enc(m1_2054,pkSess_2050),sign(h(m1_2054),skCli_1651)));
                                                {1894}in(c, (em2_2055: bitstring,sigM2_2056: bitstring));
                                                {1895}let m2_2057: bitstring = dec(em2_2055,skCli_1651) in
                                                {1896}if (verify(h(m2_2057),sigM2_2056,pkSess_2050) <> true) then
                                                    0
                                                else
                                                    {1897}let (=OpenSecureChannelResponse,Ns_2058: bitstring,ST_2059: bitstring,TTL_2060: bitstring) = m2_2057 in
                                                    {1898}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {1899}event endCli(Sess,Cli,Ns_2058)
                                )
                                else
                                    {1900}let pkDisco_2061: bitstring = fail-any in
                                    {1901}let v_2062: bool = (Sess = A) in
                                    (
                                        {1902}if v_2062 then
                                        (
                                            {1903}let pkSess_2063: bitstring = pub(skA) in
                                            {1904}out(c, GetEndpointRequest);
                                            {1905}in(c, (=GetEndpointResponse,=pkSess_2063,=SignAndEncrypt,SP_2064: bitstring,UP_2065: bitstring));
                                            {1906}new Nc_2066: bitstring;
                                            {1907}let m1_2067: bitstring = (OpenSecureChannelRequest,pkCli_1652,Nc_2066) in
                                            {1908}event beginCli(Cli,Sess,Nc_2066);
                                            {1909}out(c, (pkCli_1652,enc(m1_2067,pkSess_2063),sign(h(m1_2067),skCli_1651)));
                                            {1910}in(c, (em2_2068: bitstring,sigM2_2069: bitstring));
                                            {1911}let m2_2070: bitstring = dec(em2_2068,skCli_1651) in
                                            {1912}if (verify(h(m2_2070),sigM2_2069,pkSess_2063) <> true) then
                                                0
                                            else
                                                {1913}let (=OpenSecureChannelResponse,Ns_2071: bitstring,ST_2072: bitstring,TTL_2073: bitstring) = m2_2070 in
                                                {1914}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {1915}event endCli(Sess,Cli,Ns_2071)
                                        )
                                        else
                                            {1916}let v_2074: bool = (Sess = B) in
                                            (
                                                {1917}if v_2074 then
                                                (
                                                    {1918}let pkSess_2075: bitstring = pub(skB) in
                                                    {1919}out(c, GetEndpointRequest);
                                                    {1920}in(c, (=GetEndpointResponse,=pkSess_2075,=SignAndEncrypt,SP_2076: bitstring,UP_2077: bitstring));
                                                    {1921}new Nc_2078: bitstring;
                                                    {1922}let m1_2079: bitstring = (OpenSecureChannelRequest,pkCli_1652,Nc_2078) in
                                                    {1923}event beginCli(Cli,Sess,Nc_2078);
                                                    {1924}out(c, (pkCli_1652,enc(m1_2079,pkSess_2075),sign(h(m1_2079),skCli_1651)));
                                                    {1925}in(c, (em2_2080: bitstring,sigM2_2081: bitstring));
                                                    {1926}let m2_2082: bitstring = dec(em2_2080,skCli_1651) in
                                                    {1927}if (verify(h(m2_2082),sigM2_2081,pkSess_2075) <> true) then
                                                        0
                                                    else
                                                        {1928}let (=OpenSecureChannelResponse,Ns_2083: bitstring,ST_2084: bitstring,TTL_2085: bitstring) = m2_2082 in
                                                        {1929}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {1930}event endCli(Sess,Cli,Ns_2083)
                                                )
                                                else
                                                    {1931}let v_2086: bool = (Sess = C) in
                                                    (
                                                        {1932}if v_2086 then
                                                        (
                                                            {1933}let pkSess_2087: bitstring = pub(skC) in
                                                            {1934}out(c, GetEndpointRequest);
                                                            {1935}in(c, (=GetEndpointResponse,=pkSess_2087,=SignAndEncrypt,SP_2088: bitstring,UP_2089: bitstring));
                                                            {1936}new Nc_2090: bitstring;
                                                            {1937}let m1_2091: bitstring = (OpenSecureChannelRequest,pkCli_1652,Nc_2090) in
                                                            {1938}event beginCli(Cli,Sess,Nc_2090);
                                                            {1939}out(c, (pkCli_1652,enc(m1_2091,pkSess_2087),sign(h(m1_2091),skCli_1651)));
                                                            {1940}in(c, (em2_2092: bitstring,sigM2_2093: bitstring));
                                                            {1941}let m2_2094: bitstring = dec(em2_2092,skCli_1651) in
                                                            {1942}if (verify(h(m2_2094),sigM2_2093,pkSess_2087) <> true) then
                                                                0
                                                            else
                                                                {1943}let (=OpenSecureChannelResponse,Ns_2095: bitstring,ST_2096: bitstring,TTL_2097: bitstring) = m2_2094 in
                                                                {1944}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                {1945}event endCli(Sess,Cli,Ns_2095)
                                                        )
                                                        else
                                                            {1946}let pkSess_2098: bitstring = pub(sk(Sess)) in
                                                            {1947}out(c, GetEndpointRequest);
                                                            {1948}in(c, (=GetEndpointResponse,=pkSess_2098,=SignAndEncrypt,SP_2099: bitstring,UP_2100: bitstring));
                                                            {1949}new Nc_2101: bitstring;
                                                            {1950}let m1_2102: bitstring = (OpenSecureChannelRequest,pkCli_1652,Nc_2101) in
                                                            {1951}event beginCli(Cli,Sess,Nc_2101);
                                                            {1952}out(c, (pkCli_1652,enc(m1_2102,pkSess_2098),sign(h(m1_2102),skCli_1651)));
                                                            {1953}in(c, (em2_2103: bitstring,sigM2_2104: bitstring));
                                                            {1954}let m2_2105: bitstring = dec(em2_2103,skCli_1651) in
                                                            {1955}if (verify(h(m2_2105),sigM2_2104,pkSess_2098) <> true) then
                                                                0
                                                            else
                                                                {1956}let (=OpenSecureChannelResponse,Ns_2106: bitstring,ST_2107: bitstring,TTL_2108: bitstring) = m2_2105 in
                                                                {1957}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                {1958}event endCli(Sess,Cli,Ns_2106)
                                                    )
                                                    else
                                                        {1959}let pkSess_2109: bitstring = fail-any in
                                                        {1960}out(c, GetEndpointRequest);
                                                        {1961}in(c, (=GetEndpointResponse,=pkSess_2109,=SignAndEncrypt,SP_2110: bitstring,UP_2111: bitstring));
                                                        {1962}new Nc_2112: bitstring;
                                                        {1963}let m1_2113: bitstring = (OpenSecureChannelRequest,pkCli_1652,Nc_2112) in
                                                        {1964}event beginCli(Cli,Sess,Nc_2112);
                                                        {1965}out(c, (pkCli_1652,enc(m1_2113,pkSess_2109),sign(h(m1_2113),skCli_1651)));
                                                        {1966}in(c, (em2_2114: bitstring,sigM2_2115: bitstring));
                                                        {1967}let m2_2116: bitstring = dec(em2_2114,skCli_1651) in
                                                        {1968}if (verify(h(m2_2116),sigM2_2115,pkSess_2109) <> true) then
                                                            0
                                                        else
                                                            {1969}let (=OpenSecureChannelResponse,Ns_2117: bitstring,ST_2118: bitstring,TTL_2119: bitstring) = m2_2116 in
                                                            {1970}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                            {1971}event endCli(Sess,Cli,Ns_2117)
                                            )
                                            else
                                                {1972}let pkSess_2120: bitstring = fail-any in
                                                {1973}out(c, GetEndpointRequest);
                                                {1974}in(c, (=GetEndpointResponse,=pkSess_2120,=SignAndEncrypt,SP_2121: bitstring,UP_2122: bitstring));
                                                {1975}new Nc_2123: bitstring;
                                                {1976}let m1_2124: bitstring = (OpenSecureChannelRequest,pkCli_1652,Nc_2123) in
                                                {1977}event beginCli(Cli,Sess,Nc_2123);
                                                {1978}out(c, (pkCli_1652,enc(m1_2124,pkSess_2120),sign(h(m1_2124),skCli_1651)));
                                                {1979}in(c, (em2_2125: bitstring,sigM2_2126: bitstring));
                                                {1980}let m2_2127: bitstring = dec(em2_2125,skCli_1651) in
                                                {1981}if (verify(h(m2_2127),sigM2_2126,pkSess_2120) <> true) then
                                                    0
                                                else
                                                    {1982}let (=OpenSecureChannelResponse,Ns_2128: bitstring,ST_2129: bitstring,TTL_2130: bitstring) = m2_2127 in
                                                    {1983}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {1984}event endCli(Sess,Cli,Ns_2128)
                                    )
                                    else
                                        {1985}let pkSess_2131: bitstring = fail-any in
                                        {1986}out(c, GetEndpointRequest);
                                        {1987}in(c, (=GetEndpointResponse,=pkSess_2131,=SignAndEncrypt,SP_2132: bitstring,UP_2133: bitstring));
                                        {1988}new Nc_2134: bitstring;
                                        {1989}let m1_2135: bitstring = (OpenSecureChannelRequest,pkCli_1652,Nc_2134) in
                                        {1990}event beginCli(Cli,Sess,Nc_2134);
                                        {1991}out(c, (pkCli_1652,enc(m1_2135,pkSess_2131),sign(h(m1_2135),skCli_1651)));
                                        {1992}in(c, (em2_2136: bitstring,sigM2_2137: bitstring));
                                        {1993}let m2_2138: bitstring = dec(em2_2136,skCli_1651) in
                                        {1994}if (verify(h(m2_2138),sigM2_2137,pkSess_2131) <> true) then
                                            0
                                        else
                                            {1995}let (=OpenSecureChannelResponse,Ns_2139: bitstring,ST_2140: bitstring,TTL_2141: bitstring) = m2_2138 in
                                            {1996}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {1997}event endCli(Sess,Cli,Ns_2139)
                        )
                        else
                            {1998}let pkDisco_2142: bitstring = fail-any in
                            {1999}let v_2143: bool = (Sess = A) in
                            (
                                {2000}if v_2143 then
                                (
                                    {2001}let pkSess_2144: bitstring = pub(skA) in
                                    {2002}out(c, GetEndpointRequest);
                                    {2003}in(c, (=GetEndpointResponse,=pkSess_2144,=SignAndEncrypt,SP_2145: bitstring,UP_2146: bitstring));
                                    {2004}new Nc_2147: bitstring;
                                    {2005}let m1_2148: bitstring = (OpenSecureChannelRequest,pkCli_1652,Nc_2147) in
                                    {2006}event beginCli(Cli,Sess,Nc_2147);
                                    {2007}out(c, (pkCli_1652,enc(m1_2148,pkSess_2144),sign(h(m1_2148),skCli_1651)));
                                    {2008}in(c, (em2_2149: bitstring,sigM2_2150: bitstring));
                                    {2009}let m2_2151: bitstring = dec(em2_2149,skCli_1651) in
                                    {2010}if (verify(h(m2_2151),sigM2_2150,pkSess_2144) <> true) then
                                        0
                                    else
                                        {2011}let (=OpenSecureChannelResponse,Ns_2152: bitstring,ST_2153: bitstring,TTL_2154: bitstring) = m2_2151 in
                                        {2012}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                        {2013}event endCli(Sess,Cli,Ns_2152)
                                )
                                else
                                    {2014}let v_2155: bool = (Sess = B) in
                                    (
                                        {2015}if v_2155 then
                                        (
                                            {2016}let pkSess_2156: bitstring = pub(skB) in
                                            {2017}out(c, GetEndpointRequest);
                                            {2018}in(c, (=GetEndpointResponse,=pkSess_2156,=SignAndEncrypt,SP_2157: bitstring,UP_2158: bitstring));
                                            {2019}new Nc_2159: bitstring;
                                            {2020}let m1_2160: bitstring = (OpenSecureChannelRequest,pkCli_1652,Nc_2159) in
                                            {2021}event beginCli(Cli,Sess,Nc_2159);
                                            {2022}out(c, (pkCli_1652,enc(m1_2160,pkSess_2156),sign(h(m1_2160),skCli_1651)));
                                            {2023}in(c, (em2_2161: bitstring,sigM2_2162: bitstring));
                                            {2024}let m2_2163: bitstring = dec(em2_2161,skCli_1651) in
                                            {2025}if (verify(h(m2_2163),sigM2_2162,pkSess_2156) <> true) then
                                                0
                                            else
                                                {2026}let (=OpenSecureChannelResponse,Ns_2164: bitstring,ST_2165: bitstring,TTL_2166: bitstring) = m2_2163 in
                                                {2027}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {2028}event endCli(Sess,Cli,Ns_2164)
                                        )
                                        else
                                            {2029}let v_2167: bool = (Sess = C) in
                                            (
                                                {2030}if v_2167 then
                                                (
                                                    {2031}let pkSess_2168: bitstring = pub(skC) in
                                                    {2032}out(c, GetEndpointRequest);
                                                    {2033}in(c, (=GetEndpointResponse,=pkSess_2168,=SignAndEncrypt,SP_2169: bitstring,UP_2170: bitstring));
                                                    {2034}new Nc_2171: bitstring;
                                                    {2035}let m1_2172: bitstring = (OpenSecureChannelRequest,pkCli_1652,Nc_2171) in
                                                    {2036}event beginCli(Cli,Sess,Nc_2171);
                                                    {2037}out(c, (pkCli_1652,enc(m1_2172,pkSess_2168),sign(h(m1_2172),skCli_1651)));
                                                    {2038}in(c, (em2_2173: bitstring,sigM2_2174: bitstring));
                                                    {2039}let m2_2175: bitstring = dec(em2_2173,skCli_1651) in
                                                    {2040}if (verify(h(m2_2175),sigM2_2174,pkSess_2168) <> true) then
                                                        0
                                                    else
                                                        {2041}let (=OpenSecureChannelResponse,Ns_2176: bitstring,ST_2177: bitstring,TTL_2178: bitstring) = m2_2175 in
                                                        {2042}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {2043}event endCli(Sess,Cli,Ns_2176)
                                                )
                                                else
                                                    {2044}let pkSess_2179: bitstring = pub(sk(Sess)) in
                                                    {2045}out(c, GetEndpointRequest);
                                                    {2046}in(c, (=GetEndpointResponse,=pkSess_2179,=SignAndEncrypt,SP_2180: bitstring,UP_2181: bitstring));
                                                    {2047}new Nc_2182: bitstring;
                                                    {2048}let m1_2183: bitstring = (OpenSecureChannelRequest,pkCli_1652,Nc_2182) in
                                                    {2049}event beginCli(Cli,Sess,Nc_2182);
                                                    {2050}out(c, (pkCli_1652,enc(m1_2183,pkSess_2179),sign(h(m1_2183),skCli_1651)));
                                                    {2051}in(c, (em2_2184: bitstring,sigM2_2185: bitstring));
                                                    {2052}let m2_2186: bitstring = dec(em2_2184,skCli_1651) in
                                                    {2053}if (verify(h(m2_2186),sigM2_2185,pkSess_2179) <> true) then
                                                        0
                                                    else
                                                        {2054}let (=OpenSecureChannelResponse,Ns_2187: bitstring,ST_2188: bitstring,TTL_2189: bitstring) = m2_2186 in
                                                        {2055}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {2056}event endCli(Sess,Cli,Ns_2187)
                                            )
                                            else
                                                {2057}let pkSess_2190: bitstring = fail-any in
                                                {2058}out(c, GetEndpointRequest);
                                                {2059}in(c, (=GetEndpointResponse,=pkSess_2190,=SignAndEncrypt,SP_2191: bitstring,UP_2192: bitstring));
                                                {2060}new Nc_2193: bitstring;
                                                {2061}let m1_2194: bitstring = (OpenSecureChannelRequest,pkCli_1652,Nc_2193) in
                                                {2062}event beginCli(Cli,Sess,Nc_2193);
                                                {2063}out(c, (pkCli_1652,enc(m1_2194,pkSess_2190),sign(h(m1_2194),skCli_1651)));
                                                {2064}in(c, (em2_2195: bitstring,sigM2_2196: bitstring));
                                                {2065}let m2_2197: bitstring = dec(em2_2195,skCli_1651) in
                                                {2066}if (verify(h(m2_2197),sigM2_2196,pkSess_2190) <> true) then
                                                    0
                                                else
                                                    {2067}let (=OpenSecureChannelResponse,Ns_2198: bitstring,ST_2199: bitstring,TTL_2200: bitstring) = m2_2197 in
                                                    {2068}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {2069}event endCli(Sess,Cli,Ns_2198)
                                    )
                                    else
                                        {2070}let pkSess_2201: bitstring = fail-any in
                                        {2071}out(c, GetEndpointRequest);
                                        {2072}in(c, (=GetEndpointResponse,=pkSess_2201,=SignAndEncrypt,SP_2202: bitstring,UP_2203: bitstring));
                                        {2073}new Nc_2204: bitstring;
                                        {2074}let m1_2205: bitstring = (OpenSecureChannelRequest,pkCli_1652,Nc_2204) in
                                        {2075}event beginCli(Cli,Sess,Nc_2204);
                                        {2076}out(c, (pkCli_1652,enc(m1_2205,pkSess_2201),sign(h(m1_2205),skCli_1651)));
                                        {2077}in(c, (em2_2206: bitstring,sigM2_2207: bitstring));
                                        {2078}let m2_2208: bitstring = dec(em2_2206,skCli_1651) in
                                        {2079}if (verify(h(m2_2208),sigM2_2207,pkSess_2201) <> true) then
                                            0
                                        else
                                            {2080}let (=OpenSecureChannelResponse,Ns_2209: bitstring,ST_2210: bitstring,TTL_2211: bitstring) = m2_2208 in
                                            {2081}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {2082}event endCli(Sess,Cli,Ns_2209)
                            )
                            else
                                {2083}let pkSess_2212: bitstring = fail-any in
                                {2084}out(c, GetEndpointRequest);
                                {2085}in(c, (=GetEndpointResponse,=pkSess_2212,=SignAndEncrypt,SP_2213: bitstring,UP_2214: bitstring));
                                {2086}new Nc_2215: bitstring;
                                {2087}let m1_2216: bitstring = (OpenSecureChannelRequest,pkCli_1652,Nc_2215) in
                                {2088}event beginCli(Cli,Sess,Nc_2215);
                                {2089}out(c, (pkCli_1652,enc(m1_2216,pkSess_2212),sign(h(m1_2216),skCli_1651)));
                                {2090}in(c, (em2_2217: bitstring,sigM2_2218: bitstring));
                                {2091}let m2_2219: bitstring = dec(em2_2217,skCli_1651) in
                                {2092}if (verify(h(m2_2219),sigM2_2218,pkSess_2212) <> true) then
                                    0
                                else
                                    {2093}let (=OpenSecureChannelResponse,Ns_2220: bitstring,ST_2221: bitstring,TTL_2222: bitstring) = m2_2219 in
                                    {2094}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                    {2095}event endCli(Sess,Cli,Ns_2220)
                    )
                    else
                        {2096}let skCli_2223: bitstring = fail-any in
                        {2097}let pkCli_2224: bitstring = pub(skCli_2223) in
                        {2098}let v_2225: bool = (Disco = A) in
                        (
                            {2099}if v_2225 then
                            (
                                {2100}let pkDisco_2226: bitstring = pub(skA) in
                                {2101}let v_2227: bool = (Sess = A) in
                                (
                                    {2102}if v_2227 then
                                    (
                                        {2103}let pkSess_2228: bitstring = pub(skA) in
                                        {2104}out(c, GetEndpointRequest);
                                        {2105}in(c, (=GetEndpointResponse,=pkSess_2228,=SignAndEncrypt,SP_2229: bitstring,UP_2230: bitstring));
                                        {2106}new Nc_2231: bitstring;
                                        {2107}let m1_2232: bitstring = (OpenSecureChannelRequest,pkCli_2224,Nc_2231) in
                                        {2108}event beginCli(Cli,Sess,Nc_2231);
                                        {2109}out(c, (pkCli_2224,enc(m1_2232,pkSess_2228),sign(h(m1_2232),skCli_2223)));
                                        {2110}in(c, (em2_2233: bitstring,sigM2_2234: bitstring));
                                        {2111}let m2_2235: bitstring = dec(em2_2233,skCli_2223) in
                                        {2112}if (verify(h(m2_2235),sigM2_2234,pkSess_2228) <> true) then
                                            0
                                        else
                                            {2113}let (=OpenSecureChannelResponse,Ns_2236: bitstring,ST_2237: bitstring,TTL_2238: bitstring) = m2_2235 in
                                            {2114}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {2115}event endCli(Sess,Cli,Ns_2236)
                                    )
                                    else
                                        {2116}let v_2239: bool = (Sess = B) in
                                        (
                                            {2117}if v_2239 then
                                            (
                                                {2118}let pkSess_2240: bitstring = pub(skB) in
                                                {2119}out(c, GetEndpointRequest);
                                                {2120}in(c, (=GetEndpointResponse,=pkSess_2240,=SignAndEncrypt,SP_2241: bitstring,UP_2242: bitstring));
                                                {2121}new Nc_2243: bitstring;
                                                {2122}let m1_2244: bitstring = (OpenSecureChannelRequest,pkCli_2224,Nc_2243) in
                                                {2123}event beginCli(Cli,Sess,Nc_2243);
                                                {2124}out(c, (pkCli_2224,enc(m1_2244,pkSess_2240),sign(h(m1_2244),skCli_2223)));
                                                {2125}in(c, (em2_2245: bitstring,sigM2_2246: bitstring));
                                                {2126}let m2_2247: bitstring = dec(em2_2245,skCli_2223) in
                                                {2127}if (verify(h(m2_2247),sigM2_2246,pkSess_2240) <> true) then
                                                    0
                                                else
                                                    {2128}let (=OpenSecureChannelResponse,Ns_2248: bitstring,ST_2249: bitstring,TTL_2250: bitstring) = m2_2247 in
                                                    {2129}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {2130}event endCli(Sess,Cli,Ns_2248)
                                            )
                                            else
                                                {2131}let v_2251: bool = (Sess = C) in
                                                (
                                                    {2132}if v_2251 then
                                                    (
                                                        {2133}let pkSess_2252: bitstring = pub(skC) in
                                                        {2134}out(c, GetEndpointRequest);
                                                        {2135}in(c, (=GetEndpointResponse,=pkSess_2252,=SignAndEncrypt,SP_2253: bitstring,UP_2254: bitstring));
                                                        {2136}new Nc_2255: bitstring;
                                                        {2137}let m1_2256: bitstring = (OpenSecureChannelRequest,pkCli_2224,Nc_2255) in
                                                        {2138}event beginCli(Cli,Sess,Nc_2255);
                                                        {2139}out(c, (pkCli_2224,enc(m1_2256,pkSess_2252),sign(h(m1_2256),skCli_2223)));
                                                        {2140}in(c, (em2_2257: bitstring,sigM2_2258: bitstring));
                                                        {2141}let m2_2259: bitstring = dec(em2_2257,skCli_2223) in
                                                        {2142}if (verify(h(m2_2259),sigM2_2258,pkSess_2252) <> true) then
                                                            0
                                                        else
                                                            {2143}let (=OpenSecureChannelResponse,Ns_2260: bitstring,ST_2261: bitstring,TTL_2262: bitstring) = m2_2259 in
                                                            {2144}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                            {2145}event endCli(Sess,Cli,Ns_2260)
                                                    )
                                                    else
                                                        {2146}let pkSess_2263: bitstring = pub(sk(Sess)) in
                                                        {2147}out(c, GetEndpointRequest);
                                                        {2148}in(c, (=GetEndpointResponse,=pkSess_2263,=SignAndEncrypt,SP_2264: bitstring,UP_2265: bitstring));
                                                        {2149}new Nc_2266: bitstring;
                                                        {2150}let m1_2267: bitstring = (OpenSecureChannelRequest,pkCli_2224,Nc_2266) in
                                                        {2151}event beginCli(Cli,Sess,Nc_2266);
                                                        {2152}out(c, (pkCli_2224,enc(m1_2267,pkSess_2263),sign(h(m1_2267),skCli_2223)));
                                                        {2153}in(c, (em2_2268: bitstring,sigM2_2269: bitstring));
                                                        {2154}let m2_2270: bitstring = dec(em2_2268,skCli_2223) in
                                                        {2155}if (verify(h(m2_2270),sigM2_2269,pkSess_2263) <> true) then
                                                            0
                                                        else
                                                            {2156}let (=OpenSecureChannelResponse,Ns_2271: bitstring,ST_2272: bitstring,TTL_2273: bitstring) = m2_2270 in
                                                            {2157}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                            {2158}event endCli(Sess,Cli,Ns_2271)
                                                )
                                                else
                                                    {2159}let pkSess_2274: bitstring = fail-any in
                                                    {2160}out(c, GetEndpointRequest);
                                                    {2161}in(c, (=GetEndpointResponse,=pkSess_2274,=SignAndEncrypt,SP_2275: bitstring,UP_2276: bitstring));
                                                    {2162}new Nc_2277: bitstring;
                                                    {2163}let m1_2278: bitstring = (OpenSecureChannelRequest,pkCli_2224,Nc_2277) in
                                                    {2164}event beginCli(Cli,Sess,Nc_2277);
                                                    {2165}out(c, (pkCli_2224,enc(m1_2278,pkSess_2274),sign(h(m1_2278),skCli_2223)));
                                                    {2166}in(c, (em2_2279: bitstring,sigM2_2280: bitstring));
                                                    {2167}let m2_2281: bitstring = dec(em2_2279,skCli_2223) in
                                                    {2168}if (verify(h(m2_2281),sigM2_2280,pkSess_2274) <> true) then
                                                        0
                                                    else
                                                        {2169}let (=OpenSecureChannelResponse,Ns_2282: bitstring,ST_2283: bitstring,TTL_2284: bitstring) = m2_2281 in
                                                        {2170}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {2171}event endCli(Sess,Cli,Ns_2282)
                                        )
                                        else
                                            {2172}let pkSess_2285: bitstring = fail-any in
                                            {2173}out(c, GetEndpointRequest);
                                            {2174}in(c, (=GetEndpointResponse,=pkSess_2285,=SignAndEncrypt,SP_2286: bitstring,UP_2287: bitstring));
                                            {2175}new Nc_2288: bitstring;
                                            {2176}let m1_2289: bitstring = (OpenSecureChannelRequest,pkCli_2224,Nc_2288) in
                                            {2177}event beginCli(Cli,Sess,Nc_2288);
                                            {2178}out(c, (pkCli_2224,enc(m1_2289,pkSess_2285),sign(h(m1_2289),skCli_2223)));
                                            {2179}in(c, (em2_2290: bitstring,sigM2_2291: bitstring));
                                            {2180}let m2_2292: bitstring = dec(em2_2290,skCli_2223) in
                                            {2181}if (verify(h(m2_2292),sigM2_2291,pkSess_2285) <> true) then
                                                0
                                            else
                                                {2182}let (=OpenSecureChannelResponse,Ns_2293: bitstring,ST_2294: bitstring,TTL_2295: bitstring) = m2_2292 in
                                                {2183}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {2184}event endCli(Sess,Cli,Ns_2293)
                                )
                                else
                                    {2185}let pkSess_2296: bitstring = fail-any in
                                    {2186}out(c, GetEndpointRequest);
                                    {2187}in(c, (=GetEndpointResponse,=pkSess_2296,=SignAndEncrypt,SP_2297: bitstring,UP_2298: bitstring));
                                    {2188}new Nc_2299: bitstring;
                                    {2189}let m1_2300: bitstring = (OpenSecureChannelRequest,pkCli_2224,Nc_2299) in
                                    {2190}event beginCli(Cli,Sess,Nc_2299);
                                    {2191}out(c, (pkCli_2224,enc(m1_2300,pkSess_2296),sign(h(m1_2300),skCli_2223)));
                                    {2192}in(c, (em2_2301: bitstring,sigM2_2302: bitstring));
                                    {2193}let m2_2303: bitstring = dec(em2_2301,skCli_2223) in
                                    {2194}if (verify(h(m2_2303),sigM2_2302,pkSess_2296) <> true) then
                                        0
                                    else
                                        {2195}let (=OpenSecureChannelResponse,Ns_2304: bitstring,ST_2305: bitstring,TTL_2306: bitstring) = m2_2303 in
                                        {2196}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                        {2197}event endCli(Sess,Cli,Ns_2304)
                            )
                            else
                                {2198}let v_2307: bool = (Disco = B) in
                                (
                                    {2199}if v_2307 then
                                    (
                                        {2200}let pkDisco_2308: bitstring = pub(skB) in
                                        {2201}let v_2309: bool = (Sess = A) in
                                        (
                                            {2202}if v_2309 then
                                            (
                                                {2203}let pkSess_2310: bitstring = pub(skA) in
                                                {2204}out(c, GetEndpointRequest);
                                                {2205}in(c, (=GetEndpointResponse,=pkSess_2310,=SignAndEncrypt,SP_2311: bitstring,UP_2312: bitstring));
                                                {2206}new Nc_2313: bitstring;
                                                {2207}let m1_2314: bitstring = (OpenSecureChannelRequest,pkCli_2224,Nc_2313) in
                                                {2208}event beginCli(Cli,Sess,Nc_2313);
                                                {2209}out(c, (pkCli_2224,enc(m1_2314,pkSess_2310),sign(h(m1_2314),skCli_2223)));
                                                {2210}in(c, (em2_2315: bitstring,sigM2_2316: bitstring));
                                                {2211}let m2_2317: bitstring = dec(em2_2315,skCli_2223) in
                                                {2212}if (verify(h(m2_2317),sigM2_2316,pkSess_2310) <> true) then
                                                    0
                                                else
                                                    {2213}let (=OpenSecureChannelResponse,Ns_2318: bitstring,ST_2319: bitstring,TTL_2320: bitstring) = m2_2317 in
                                                    {2214}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {2215}event endCli(Sess,Cli,Ns_2318)
                                            )
                                            else
                                                {2216}let v_2321: bool = (Sess = B) in
                                                (
                                                    {2217}if v_2321 then
                                                    (
                                                        {2218}let pkSess_2322: bitstring = pub(skB) in
                                                        {2219}out(c, GetEndpointRequest);
                                                        {2220}in(c, (=GetEndpointResponse,=pkSess_2322,=SignAndEncrypt,SP_2323: bitstring,UP_2324: bitstring));
                                                        {2221}new Nc_2325: bitstring;
                                                        {2222}let m1_2326: bitstring = (OpenSecureChannelRequest,pkCli_2224,Nc_2325) in
                                                        {2223}event beginCli(Cli,Sess,Nc_2325);
                                                        {2224}out(c, (pkCli_2224,enc(m1_2326,pkSess_2322),sign(h(m1_2326),skCli_2223)));
                                                        {2225}in(c, (em2_2327: bitstring,sigM2_2328: bitstring));
                                                        {2226}let m2_2329: bitstring = dec(em2_2327,skCli_2223) in
                                                        {2227}if (verify(h(m2_2329),sigM2_2328,pkSess_2322) <> true) then
                                                            0
                                                        else
                                                            {2228}let (=OpenSecureChannelResponse,Ns_2330: bitstring,ST_2331: bitstring,TTL_2332: bitstring) = m2_2329 in
                                                            {2229}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                            {2230}event endCli(Sess,Cli,Ns_2330)
                                                    )
                                                    else
                                                        {2231}let v_2333: bool = (Sess = C) in
                                                        (
                                                            {2232}if v_2333 then
                                                            (
                                                                {2233}let pkSess_2334: bitstring = pub(skC) in
                                                                {2234}out(c, GetEndpointRequest);
                                                                {2235}in(c, (=GetEndpointResponse,=pkSess_2334,=SignAndEncrypt,SP_2335: bitstring,UP_2336: bitstring));
                                                                {2236}new Nc_2337: bitstring;
                                                                {2237}let m1_2338: bitstring = (OpenSecureChannelRequest,pkCli_2224,Nc_2337) in
                                                                {2238}event beginCli(Cli,Sess,Nc_2337);
                                                                {2239}out(c, (pkCli_2224,enc(m1_2338,pkSess_2334),sign(h(m1_2338),skCli_2223)));
                                                                {2240}in(c, (em2_2339: bitstring,sigM2_2340: bitstring));
                                                                {2241}let m2_2341: bitstring = dec(em2_2339,skCli_2223) in
                                                                {2242}if (verify(h(m2_2341),sigM2_2340,pkSess_2334) <> true) then
                                                                    0
                                                                else
                                                                    {2243}let (=OpenSecureChannelResponse,Ns_2342: bitstring,ST_2343: bitstring,TTL_2344: bitstring) = m2_2341 in
                                                                    {2244}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                    {2245}event endCli(Sess,Cli,Ns_2342)
                                                            )
                                                            else
                                                                {2246}let pkSess_2345: bitstring = pub(sk(Sess)) in
                                                                {2247}out(c, GetEndpointRequest);
                                                                {2248}in(c, (=GetEndpointResponse,=pkSess_2345,=SignAndEncrypt,SP_2346: bitstring,UP_2347: bitstring));
                                                                {2249}new Nc_2348: bitstring;
                                                                {2250}let m1_2349: bitstring = (OpenSecureChannelRequest,pkCli_2224,Nc_2348) in
                                                                {2251}event beginCli(Cli,Sess,Nc_2348);
                                                                {2252}out(c, (pkCli_2224,enc(m1_2349,pkSess_2345),sign(h(m1_2349),skCli_2223)));
                                                                {2253}in(c, (em2_2350: bitstring,sigM2_2351: bitstring));
                                                                {2254}let m2_2352: bitstring = dec(em2_2350,skCli_2223) in
                                                                {2255}if (verify(h(m2_2352),sigM2_2351,pkSess_2345) <> true) then
                                                                    0
                                                                else
                                                                    {2256}let (=OpenSecureChannelResponse,Ns_2353: bitstring,ST_2354: bitstring,TTL_2355: bitstring) = m2_2352 in
                                                                    {2257}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                    {2258}event endCli(Sess,Cli,Ns_2353)
                                                        )
                                                        else
                                                            {2259}let pkSess_2356: bitstring = fail-any in
                                                            {2260}out(c, GetEndpointRequest);
                                                            {2261}in(c, (=GetEndpointResponse,=pkSess_2356,=SignAndEncrypt,SP_2357: bitstring,UP_2358: bitstring));
                                                            {2262}new Nc_2359: bitstring;
                                                            {2263}let m1_2360: bitstring = (OpenSecureChannelRequest,pkCli_2224,Nc_2359) in
                                                            {2264}event beginCli(Cli,Sess,Nc_2359);
                                                            {2265}out(c, (pkCli_2224,enc(m1_2360,pkSess_2356),sign(h(m1_2360),skCli_2223)));
                                                            {2266}in(c, (em2_2361: bitstring,sigM2_2362: bitstring));
                                                            {2267}let m2_2363: bitstring = dec(em2_2361,skCli_2223) in
                                                            {2268}if (verify(h(m2_2363),sigM2_2362,pkSess_2356) <> true) then
                                                                0
                                                            else
                                                                {2269}let (=OpenSecureChannelResponse,Ns_2364: bitstring,ST_2365: bitstring,TTL_2366: bitstring) = m2_2363 in
                                                                {2270}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                {2271}event endCli(Sess,Cli,Ns_2364)
                                                )
                                                else
                                                    {2272}let pkSess_2367: bitstring = fail-any in
                                                    {2273}out(c, GetEndpointRequest);
                                                    {2274}in(c, (=GetEndpointResponse,=pkSess_2367,=SignAndEncrypt,SP_2368: bitstring,UP_2369: bitstring));
                                                    {2275}new Nc_2370: bitstring;
                                                    {2276}let m1_2371: bitstring = (OpenSecureChannelRequest,pkCli_2224,Nc_2370) in
                                                    {2277}event beginCli(Cli,Sess,Nc_2370);
                                                    {2278}out(c, (pkCli_2224,enc(m1_2371,pkSess_2367),sign(h(m1_2371),skCli_2223)));
                                                    {2279}in(c, (em2_2372: bitstring,sigM2_2373: bitstring));
                                                    {2280}let m2_2374: bitstring = dec(em2_2372,skCli_2223) in
                                                    {2281}if (verify(h(m2_2374),sigM2_2373,pkSess_2367) <> true) then
                                                        0
                                                    else
                                                        {2282}let (=OpenSecureChannelResponse,Ns_2375: bitstring,ST_2376: bitstring,TTL_2377: bitstring) = m2_2374 in
                                                        {2283}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {2284}event endCli(Sess,Cli,Ns_2375)
                                        )
                                        else
                                            {2285}let pkSess_2378: bitstring = fail-any in
                                            {2286}out(c, GetEndpointRequest);
                                            {2287}in(c, (=GetEndpointResponse,=pkSess_2378,=SignAndEncrypt,SP_2379: bitstring,UP_2380: bitstring));
                                            {2288}new Nc_2381: bitstring;
                                            {2289}let m1_2382: bitstring = (OpenSecureChannelRequest,pkCli_2224,Nc_2381) in
                                            {2290}event beginCli(Cli,Sess,Nc_2381);
                                            {2291}out(c, (pkCli_2224,enc(m1_2382,pkSess_2378),sign(h(m1_2382),skCli_2223)));
                                            {2292}in(c, (em2_2383: bitstring,sigM2_2384: bitstring));
                                            {2293}let m2_2385: bitstring = dec(em2_2383,skCli_2223) in
                                            {2294}if (verify(h(m2_2385),sigM2_2384,pkSess_2378) <> true) then
                                                0
                                            else
                                                {2295}let (=OpenSecureChannelResponse,Ns_2386: bitstring,ST_2387: bitstring,TTL_2388: bitstring) = m2_2385 in
                                                {2296}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {2297}event endCli(Sess,Cli,Ns_2386)
                                    )
                                    else
                                        {2298}let v_2389: bool = (Disco = C) in
                                        (
                                            {2299}if v_2389 then
                                            (
                                                {2300}let pkDisco_2390: bitstring = pub(skC) in
                                                {2301}let v_2391: bool = (Sess = A) in
                                                (
                                                    {2302}if v_2391 then
                                                    (
                                                        {2303}let pkSess_2392: bitstring = pub(skA) in
                                                        {2304}out(c, GetEndpointRequest);
                                                        {2305}in(c, (=GetEndpointResponse,=pkSess_2392,=SignAndEncrypt,SP_2393: bitstring,UP_2394: bitstring));
                                                        {2306}new Nc_2395: bitstring;
                                                        {2307}let m1_2396: bitstring = (OpenSecureChannelRequest,pkCli_2224,Nc_2395) in
                                                        {2308}event beginCli(Cli,Sess,Nc_2395);
                                                        {2309}out(c, (pkCli_2224,enc(m1_2396,pkSess_2392),sign(h(m1_2396),skCli_2223)));
                                                        {2310}in(c, (em2_2397: bitstring,sigM2_2398: bitstring));
                                                        {2311}let m2_2399: bitstring = dec(em2_2397,skCli_2223) in
                                                        {2312}if (verify(h(m2_2399),sigM2_2398,pkSess_2392) <> true) then
                                                            0
                                                        else
                                                            {2313}let (=OpenSecureChannelResponse,Ns_2400: bitstring,ST_2401: bitstring,TTL_2402: bitstring) = m2_2399 in
                                                            {2314}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                            {2315}event endCli(Sess,Cli,Ns_2400)
                                                    )
                                                    else
                                                        {2316}let v_2403: bool = (Sess = B) in
                                                        (
                                                            {2317}if v_2403 then
                                                            (
                                                                {2318}let pkSess_2404: bitstring = pub(skB) in
                                                                {2319}out(c, GetEndpointRequest);
                                                                {2320}in(c, (=GetEndpointResponse,=pkSess_2404,=SignAndEncrypt,SP_2405: bitstring,UP_2406: bitstring));
                                                                {2321}new Nc_2407: bitstring;
                                                                {2322}let m1_2408: bitstring = (OpenSecureChannelRequest,pkCli_2224,Nc_2407) in
                                                                {2323}event beginCli(Cli,Sess,Nc_2407);
                                                                {2324}out(c, (pkCli_2224,enc(m1_2408,pkSess_2404),sign(h(m1_2408),skCli_2223)));
                                                                {2325}in(c, (em2_2409: bitstring,sigM2_2410: bitstring));
                                                                {2326}let m2_2411: bitstring = dec(em2_2409,skCli_2223) in
                                                                {2327}if (verify(h(m2_2411),sigM2_2410,pkSess_2404) <> true) then
                                                                    0
                                                                else
                                                                    {2328}let (=OpenSecureChannelResponse,Ns_2412: bitstring,ST_2413: bitstring,TTL_2414: bitstring) = m2_2411 in
                                                                    {2329}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                    {2330}event endCli(Sess,Cli,Ns_2412)
                                                            )
                                                            else
                                                                {2331}let v_2415: bool = (Sess = C) in
                                                                (
                                                                    {2332}if v_2415 then
                                                                    (
                                                                        {2333}let pkSess_2416: bitstring = pub(skC) in
                                                                        {2334}out(c, GetEndpointRequest);
                                                                        {2335}in(c, (=GetEndpointResponse,=pkSess_2416,=SignAndEncrypt,SP_2417: bitstring,UP_2418: bitstring));
                                                                        {2336}new Nc_2419: bitstring;
                                                                        {2337}let m1_2420: bitstring = (OpenSecureChannelRequest,pkCli_2224,Nc_2419) in
                                                                        {2338}event beginCli(Cli,Sess,Nc_2419);
                                                                        {2339}out(c, (pkCli_2224,enc(m1_2420,pkSess_2416),sign(h(m1_2420),skCli_2223)));
                                                                        {2340}in(c, (em2_2421: bitstring,sigM2_2422: bitstring));
                                                                        {2341}let m2_2423: bitstring = dec(em2_2421,skCli_2223) in
                                                                        {2342}if (verify(h(m2_2423),sigM2_2422,pkSess_2416) <> true) then
                                                                            0
                                                                        else
                                                                            {2343}let (=OpenSecureChannelResponse,Ns_2424: bitstring,ST_2425: bitstring,TTL_2426: bitstring) = m2_2423 in
                                                                            {2344}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                            {2345}event endCli(Sess,Cli,Ns_2424)
                                                                    )
                                                                    else
                                                                        {2346}let pkSess_2427: bitstring = pub(sk(Sess)) in
                                                                        {2347}out(c, GetEndpointRequest);
                                                                        {2348}in(c, (=GetEndpointResponse,=pkSess_2427,=SignAndEncrypt,SP_2428: bitstring,UP_2429: bitstring));
                                                                        {2349}new Nc_2430: bitstring;
                                                                        {2350}let m1_2431: bitstring = (OpenSecureChannelRequest,pkCli_2224,Nc_2430) in
                                                                        {2351}event beginCli(Cli,Sess,Nc_2430);
                                                                        {2352}out(c, (pkCli_2224,enc(m1_2431,pkSess_2427),sign(h(m1_2431),skCli_2223)));
                                                                        {2353}in(c, (em2_2432: bitstring,sigM2_2433: bitstring));
                                                                        {2354}let m2_2434: bitstring = dec(em2_2432,skCli_2223) in
                                                                        {2355}if (verify(h(m2_2434),sigM2_2433,pkSess_2427) <> true) then
                                                                            0
                                                                        else
                                                                            {2356}let (=OpenSecureChannelResponse,Ns_2435: bitstring,ST_2436: bitstring,TTL_2437: bitstring) = m2_2434 in
                                                                            {2357}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                            {2358}event endCli(Sess,Cli,Ns_2435)
                                                                )
                                                                else
                                                                    {2359}let pkSess_2438: bitstring = fail-any in
                                                                    {2360}out(c, GetEndpointRequest);
                                                                    {2361}in(c, (=GetEndpointResponse,=pkSess_2438,=SignAndEncrypt,SP_2439: bitstring,UP_2440: bitstring));
                                                                    {2362}new Nc_2441: bitstring;
                                                                    {2363}let m1_2442: bitstring = (OpenSecureChannelRequest,pkCli_2224,Nc_2441) in
                                                                    {2364}event beginCli(Cli,Sess,Nc_2441);
                                                                    {2365}out(c, (pkCli_2224,enc(m1_2442,pkSess_2438),sign(h(m1_2442),skCli_2223)));
                                                                    {2366}in(c, (em2_2443: bitstring,sigM2_2444: bitstring));
                                                                    {2367}let m2_2445: bitstring = dec(em2_2443,skCli_2223) in
                                                                    {2368}if (verify(h(m2_2445),sigM2_2444,pkSess_2438) <> true) then
                                                                        0
                                                                    else
                                                                        {2369}let (=OpenSecureChannelResponse,Ns_2446: bitstring,ST_2447: bitstring,TTL_2448: bitstring) = m2_2445 in
                                                                        {2370}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                        {2371}event endCli(Sess,Cli,Ns_2446)
                                                        )
                                                        else
                                                            {2372}let pkSess_2449: bitstring = fail-any in
                                                            {2373}out(c, GetEndpointRequest);
                                                            {2374}in(c, (=GetEndpointResponse,=pkSess_2449,=SignAndEncrypt,SP_2450: bitstring,UP_2451: bitstring));
                                                            {2375}new Nc_2452: bitstring;
                                                            {2376}let m1_2453: bitstring = (OpenSecureChannelRequest,pkCli_2224,Nc_2452) in
                                                            {2377}event beginCli(Cli,Sess,Nc_2452);
                                                            {2378}out(c, (pkCli_2224,enc(m1_2453,pkSess_2449),sign(h(m1_2453),skCli_2223)));
                                                            {2379}in(c, (em2_2454: bitstring,sigM2_2455: bitstring));
                                                            {2380}let m2_2456: bitstring = dec(em2_2454,skCli_2223) in
                                                            {2381}if (verify(h(m2_2456),sigM2_2455,pkSess_2449) <> true) then
                                                                0
                                                            else
                                                                {2382}let (=OpenSecureChannelResponse,Ns_2457: bitstring,ST_2458: bitstring,TTL_2459: bitstring) = m2_2456 in
                                                                {2383}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                {2384}event endCli(Sess,Cli,Ns_2457)
                                                )
                                                else
                                                    {2385}let pkSess_2460: bitstring = fail-any in
                                                    {2386}out(c, GetEndpointRequest);
                                                    {2387}in(c, (=GetEndpointResponse,=pkSess_2460,=SignAndEncrypt,SP_2461: bitstring,UP_2462: bitstring));
                                                    {2388}new Nc_2463: bitstring;
                                                    {2389}let m1_2464: bitstring = (OpenSecureChannelRequest,pkCli_2224,Nc_2463) in
                                                    {2390}event beginCli(Cli,Sess,Nc_2463);
                                                    {2391}out(c, (pkCli_2224,enc(m1_2464,pkSess_2460),sign(h(m1_2464),skCli_2223)));
                                                    {2392}in(c, (em2_2465: bitstring,sigM2_2466: bitstring));
                                                    {2393}let m2_2467: bitstring = dec(em2_2465,skCli_2223) in
                                                    {2394}if (verify(h(m2_2467),sigM2_2466,pkSess_2460) <> true) then
                                                        0
                                                    else
                                                        {2395}let (=OpenSecureChannelResponse,Ns_2468: bitstring,ST_2469: bitstring,TTL_2470: bitstring) = m2_2467 in
                                                        {2396}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {2397}event endCli(Sess,Cli,Ns_2468)
                                            )
                                            else
                                                {2398}let pkDisco_2471: bitstring = pub(sk(Disco)) in
                                                {2399}let v_2472: bool = (Sess = A) in
                                                (
                                                    {2400}if v_2472 then
                                                    (
                                                        {2401}let pkSess_2473: bitstring = pub(skA) in
                                                        {2402}out(c, GetEndpointRequest);
                                                        {2403}in(c, (=GetEndpointResponse,=pkSess_2473,=SignAndEncrypt,SP_2474: bitstring,UP_2475: bitstring));
                                                        {2404}new Nc_2476: bitstring;
                                                        {2405}let m1_2477: bitstring = (OpenSecureChannelRequest,pkCli_2224,Nc_2476) in
                                                        {2406}event beginCli(Cli,Sess,Nc_2476);
                                                        {2407}out(c, (pkCli_2224,enc(m1_2477,pkSess_2473),sign(h(m1_2477),skCli_2223)));
                                                        {2408}in(c, (em2_2478: bitstring,sigM2_2479: bitstring));
                                                        {2409}let m2_2480: bitstring = dec(em2_2478,skCli_2223) in
                                                        {2410}if (verify(h(m2_2480),sigM2_2479,pkSess_2473) <> true) then
                                                            0
                                                        else
                                                            {2411}let (=OpenSecureChannelResponse,Ns_2481: bitstring,ST_2482: bitstring,TTL_2483: bitstring) = m2_2480 in
                                                            {2412}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                            {2413}event endCli(Sess,Cli,Ns_2481)
                                                    )
                                                    else
                                                        {2414}let v_2484: bool = (Sess = B) in
                                                        (
                                                            {2415}if v_2484 then
                                                            (
                                                                {2416}let pkSess_2485: bitstring = pub(skB) in
                                                                {2417}out(c, GetEndpointRequest);
                                                                {2418}in(c, (=GetEndpointResponse,=pkSess_2485,=SignAndEncrypt,SP_2486: bitstring,UP_2487: bitstring));
                                                                {2419}new Nc_2488: bitstring;
                                                                {2420}let m1_2489: bitstring = (OpenSecureChannelRequest,pkCli_2224,Nc_2488) in
                                                                {2421}event beginCli(Cli,Sess,Nc_2488);
                                                                {2422}out(c, (pkCli_2224,enc(m1_2489,pkSess_2485),sign(h(m1_2489),skCli_2223)));
                                                                {2423}in(c, (em2_2490: bitstring,sigM2_2491: bitstring));
                                                                {2424}let m2_2492: bitstring = dec(em2_2490,skCli_2223) in
                                                                {2425}if (verify(h(m2_2492),sigM2_2491,pkSess_2485) <> true) then
                                                                    0
                                                                else
                                                                    {2426}let (=OpenSecureChannelResponse,Ns_2493: bitstring,ST_2494: bitstring,TTL_2495: bitstring) = m2_2492 in
                                                                    {2427}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                    {2428}event endCli(Sess,Cli,Ns_2493)
                                                            )
                                                            else
                                                                {2429}let v_2496: bool = (Sess = C) in
                                                                (
                                                                    {2430}if v_2496 then
                                                                    (
                                                                        {2431}let pkSess_2497: bitstring = pub(skC) in
                                                                        {2432}out(c, GetEndpointRequest);
                                                                        {2433}in(c, (=GetEndpointResponse,=pkSess_2497,=SignAndEncrypt,SP_2498: bitstring,UP_2499: bitstring));
                                                                        {2434}new Nc_2500: bitstring;
                                                                        {2435}let m1_2501: bitstring = (OpenSecureChannelRequest,pkCli_2224,Nc_2500) in
                                                                        {2436}event beginCli(Cli,Sess,Nc_2500);
                                                                        {2437}out(c, (pkCli_2224,enc(m1_2501,pkSess_2497),sign(h(m1_2501),skCli_2223)));
                                                                        {2438}in(c, (em2_2502: bitstring,sigM2_2503: bitstring));
                                                                        {2439}let m2_2504: bitstring = dec(em2_2502,skCli_2223) in
                                                                        {2440}if (verify(h(m2_2504),sigM2_2503,pkSess_2497) <> true) then
                                                                            0
                                                                        else
                                                                            {2441}let (=OpenSecureChannelResponse,Ns_2505: bitstring,ST_2506: bitstring,TTL_2507: bitstring) = m2_2504 in
                                                                            {2442}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                            {2443}event endCli(Sess,Cli,Ns_2505)
                                                                    )
                                                                    else
                                                                        {2444}let pkSess_2508: bitstring = pub(sk(Sess)) in
                                                                        {2445}out(c, GetEndpointRequest);
                                                                        {2446}in(c, (=GetEndpointResponse,=pkSess_2508,=SignAndEncrypt,SP_2509: bitstring,UP_2510: bitstring));
                                                                        {2447}new Nc_2511: bitstring;
                                                                        {2448}let m1_2512: bitstring = (OpenSecureChannelRequest,pkCli_2224,Nc_2511) in
                                                                        {2449}event beginCli(Cli,Sess,Nc_2511);
                                                                        {2450}out(c, (pkCli_2224,enc(m1_2512,pkSess_2508),sign(h(m1_2512),skCli_2223)));
                                                                        {2451}in(c, (em2_2513: bitstring,sigM2_2514: bitstring));
                                                                        {2452}let m2_2515: bitstring = dec(em2_2513,skCli_2223) in
                                                                        {2453}if (verify(h(m2_2515),sigM2_2514,pkSess_2508) <> true) then
                                                                            0
                                                                        else
                                                                            {2454}let (=OpenSecureChannelResponse,Ns_2516: bitstring,ST_2517: bitstring,TTL_2518: bitstring) = m2_2515 in
                                                                            {2455}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                            {2456}event endCli(Sess,Cli,Ns_2516)
                                                                )
                                                                else
                                                                    {2457}let pkSess_2519: bitstring = fail-any in
                                                                    {2458}out(c, GetEndpointRequest);
                                                                    {2459}in(c, (=GetEndpointResponse,=pkSess_2519,=SignAndEncrypt,SP_2520: bitstring,UP_2521: bitstring));
                                                                    {2460}new Nc_2522: bitstring;
                                                                    {2461}let m1_2523: bitstring = (OpenSecureChannelRequest,pkCli_2224,Nc_2522) in
                                                                    {2462}event beginCli(Cli,Sess,Nc_2522);
                                                                    {2463}out(c, (pkCli_2224,enc(m1_2523,pkSess_2519),sign(h(m1_2523),skCli_2223)));
                                                                    {2464}in(c, (em2_2524: bitstring,sigM2_2525: bitstring));
                                                                    {2465}let m2_2526: bitstring = dec(em2_2524,skCli_2223) in
                                                                    {2466}if (verify(h(m2_2526),sigM2_2525,pkSess_2519) <> true) then
                                                                        0
                                                                    else
                                                                        {2467}let (=OpenSecureChannelResponse,Ns_2527: bitstring,ST_2528: bitstring,TTL_2529: bitstring) = m2_2526 in
                                                                        {2468}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                        {2469}event endCli(Sess,Cli,Ns_2527)
                                                        )
                                                        else
                                                            {2470}let pkSess_2530: bitstring = fail-any in
                                                            {2471}out(c, GetEndpointRequest);
                                                            {2472}in(c, (=GetEndpointResponse,=pkSess_2530,=SignAndEncrypt,SP_2531: bitstring,UP_2532: bitstring));
                                                            {2473}new Nc_2533: bitstring;
                                                            {2474}let m1_2534: bitstring = (OpenSecureChannelRequest,pkCli_2224,Nc_2533) in
                                                            {2475}event beginCli(Cli,Sess,Nc_2533);
                                                            {2476}out(c, (pkCli_2224,enc(m1_2534,pkSess_2530),sign(h(m1_2534),skCli_2223)));
                                                            {2477}in(c, (em2_2535: bitstring,sigM2_2536: bitstring));
                                                            {2478}let m2_2537: bitstring = dec(em2_2535,skCli_2223) in
                                                            {2479}if (verify(h(m2_2537),sigM2_2536,pkSess_2530) <> true) then
                                                                0
                                                            else
                                                                {2480}let (=OpenSecureChannelResponse,Ns_2538: bitstring,ST_2539: bitstring,TTL_2540: bitstring) = m2_2537 in
                                                                {2481}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                {2482}event endCli(Sess,Cli,Ns_2538)
                                                )
                                                else
                                                    {2483}let pkSess_2541: bitstring = fail-any in
                                                    {2484}out(c, GetEndpointRequest);
                                                    {2485}in(c, (=GetEndpointResponse,=pkSess_2541,=SignAndEncrypt,SP_2542: bitstring,UP_2543: bitstring));
                                                    {2486}new Nc_2544: bitstring;
                                                    {2487}let m1_2545: bitstring = (OpenSecureChannelRequest,pkCli_2224,Nc_2544) in
                                                    {2488}event beginCli(Cli,Sess,Nc_2544);
                                                    {2489}out(c, (pkCli_2224,enc(m1_2545,pkSess_2541),sign(h(m1_2545),skCli_2223)));
                                                    {2490}in(c, (em2_2546: bitstring,sigM2_2547: bitstring));
                                                    {2491}let m2_2548: bitstring = dec(em2_2546,skCli_2223) in
                                                    {2492}if (verify(h(m2_2548),sigM2_2547,pkSess_2541) <> true) then
                                                        0
                                                    else
                                                        {2493}let (=OpenSecureChannelResponse,Ns_2549: bitstring,ST_2550: bitstring,TTL_2551: bitstring) = m2_2548 in
                                                        {2494}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {2495}event endCli(Sess,Cli,Ns_2549)
                                        )
                                        else
                                            {2496}let pkDisco_2552: bitstring = fail-any in
                                            {2497}let v_2553: bool = (Sess = A) in
                                            (
                                                {2498}if v_2553 then
                                                (
                                                    {2499}let pkSess_2554: bitstring = pub(skA) in
                                                    {2500}out(c, GetEndpointRequest);
                                                    {2501}in(c, (=GetEndpointResponse,=pkSess_2554,=SignAndEncrypt,SP_2555: bitstring,UP_2556: bitstring));
                                                    {2502}new Nc_2557: bitstring;
                                                    {2503}let m1_2558: bitstring = (OpenSecureChannelRequest,pkCli_2224,Nc_2557) in
                                                    {2504}event beginCli(Cli,Sess,Nc_2557);
                                                    {2505}out(c, (pkCli_2224,enc(m1_2558,pkSess_2554),sign(h(m1_2558),skCli_2223)));
                                                    {2506}in(c, (em2_2559: bitstring,sigM2_2560: bitstring));
                                                    {2507}let m2_2561: bitstring = dec(em2_2559,skCli_2223) in
                                                    {2508}if (verify(h(m2_2561),sigM2_2560,pkSess_2554) <> true) then
                                                        0
                                                    else
                                                        {2509}let (=OpenSecureChannelResponse,Ns_2562: bitstring,ST_2563: bitstring,TTL_2564: bitstring) = m2_2561 in
                                                        {2510}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {2511}event endCli(Sess,Cli,Ns_2562)
                                                )
                                                else
                                                    {2512}let v_2565: bool = (Sess = B) in
                                                    (
                                                        {2513}if v_2565 then
                                                        (
                                                            {2514}let pkSess_2566: bitstring = pub(skB) in
                                                            {2515}out(c, GetEndpointRequest);
                                                            {2516}in(c, (=GetEndpointResponse,=pkSess_2566,=SignAndEncrypt,SP_2567: bitstring,UP_2568: bitstring));
                                                            {2517}new Nc_2569: bitstring;
                                                            {2518}let m1_2570: bitstring = (OpenSecureChannelRequest,pkCli_2224,Nc_2569) in
                                                            {2519}event beginCli(Cli,Sess,Nc_2569);
                                                            {2520}out(c, (pkCli_2224,enc(m1_2570,pkSess_2566),sign(h(m1_2570),skCli_2223)));
                                                            {2521}in(c, (em2_2571: bitstring,sigM2_2572: bitstring));
                                                            {2522}let m2_2573: bitstring = dec(em2_2571,skCli_2223) in
                                                            {2523}if (verify(h(m2_2573),sigM2_2572,pkSess_2566) <> true) then
                                                                0
                                                            else
                                                                {2524}let (=OpenSecureChannelResponse,Ns_2574: bitstring,ST_2575: bitstring,TTL_2576: bitstring) = m2_2573 in
                                                                {2525}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                {2526}event endCli(Sess,Cli,Ns_2574)
                                                        )
                                                        else
                                                            {2527}let v_2577: bool = (Sess = C) in
                                                            (
                                                                {2528}if v_2577 then
                                                                (
                                                                    {2529}let pkSess_2578: bitstring = pub(skC) in
                                                                    {2530}out(c, GetEndpointRequest);
                                                                    {2531}in(c, (=GetEndpointResponse,=pkSess_2578,=SignAndEncrypt,SP_2579: bitstring,UP_2580: bitstring));
                                                                    {2532}new Nc_2581: bitstring;
                                                                    {2533}let m1_2582: bitstring = (OpenSecureChannelRequest,pkCli_2224,Nc_2581) in
                                                                    {2534}event beginCli(Cli,Sess,Nc_2581);
                                                                    {2535}out(c, (pkCli_2224,enc(m1_2582,pkSess_2578),sign(h(m1_2582),skCli_2223)));
                                                                    {2536}in(c, (em2_2583: bitstring,sigM2_2584: bitstring));
                                                                    {2537}let m2_2585: bitstring = dec(em2_2583,skCli_2223) in
                                                                    {2538}if (verify(h(m2_2585),sigM2_2584,pkSess_2578) <> true) then
                                                                        0
                                                                    else
                                                                        {2539}let (=OpenSecureChannelResponse,Ns_2586: bitstring,ST_2587: bitstring,TTL_2588: bitstring) = m2_2585 in
                                                                        {2540}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                        {2541}event endCli(Sess,Cli,Ns_2586)
                                                                )
                                                                else
                                                                    {2542}let pkSess_2589: bitstring = pub(sk(Sess)) in
                                                                    {2543}out(c, GetEndpointRequest);
                                                                    {2544}in(c, (=GetEndpointResponse,=pkSess_2589,=SignAndEncrypt,SP_2590: bitstring,UP_2591: bitstring));
                                                                    {2545}new Nc_2592: bitstring;
                                                                    {2546}let m1_2593: bitstring = (OpenSecureChannelRequest,pkCli_2224,Nc_2592) in
                                                                    {2547}event beginCli(Cli,Sess,Nc_2592);
                                                                    {2548}out(c, (pkCli_2224,enc(m1_2593,pkSess_2589),sign(h(m1_2593),skCli_2223)));
                                                                    {2549}in(c, (em2_2594: bitstring,sigM2_2595: bitstring));
                                                                    {2550}let m2_2596: bitstring = dec(em2_2594,skCli_2223) in
                                                                    {2551}if (verify(h(m2_2596),sigM2_2595,pkSess_2589) <> true) then
                                                                        0
                                                                    else
                                                                        {2552}let (=OpenSecureChannelResponse,Ns_2597: bitstring,ST_2598: bitstring,TTL_2599: bitstring) = m2_2596 in
                                                                        {2553}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                        {2554}event endCli(Sess,Cli,Ns_2597)
                                                            )
                                                            else
                                                                {2555}let pkSess_2600: bitstring = fail-any in
                                                                {2556}out(c, GetEndpointRequest);
                                                                {2557}in(c, (=GetEndpointResponse,=pkSess_2600,=SignAndEncrypt,SP_2601: bitstring,UP_2602: bitstring));
                                                                {2558}new Nc_2603: bitstring;
                                                                {2559}let m1_2604: bitstring = (OpenSecureChannelRequest,pkCli_2224,Nc_2603) in
                                                                {2560}event beginCli(Cli,Sess,Nc_2603);
                                                                {2561}out(c, (pkCli_2224,enc(m1_2604,pkSess_2600),sign(h(m1_2604),skCli_2223)));
                                                                {2562}in(c, (em2_2605: bitstring,sigM2_2606: bitstring));
                                                                {2563}let m2_2607: bitstring = dec(em2_2605,skCli_2223) in
                                                                {2564}if (verify(h(m2_2607),sigM2_2606,pkSess_2600) <> true) then
                                                                    0
                                                                else
                                                                    {2565}let (=OpenSecureChannelResponse,Ns_2608: bitstring,ST_2609: bitstring,TTL_2610: bitstring) = m2_2607 in
                                                                    {2566}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                    {2567}event endCli(Sess,Cli,Ns_2608)
                                                    )
                                                    else
                                                        {2568}let pkSess_2611: bitstring = fail-any in
                                                        {2569}out(c, GetEndpointRequest);
                                                        {2570}in(c, (=GetEndpointResponse,=pkSess_2611,=SignAndEncrypt,SP_2612: bitstring,UP_2613: bitstring));
                                                        {2571}new Nc_2614: bitstring;
                                                        {2572}let m1_2615: bitstring = (OpenSecureChannelRequest,pkCli_2224,Nc_2614) in
                                                        {2573}event beginCli(Cli,Sess,Nc_2614);
                                                        {2574}out(c, (pkCli_2224,enc(m1_2615,pkSess_2611),sign(h(m1_2615),skCli_2223)));
                                                        {2575}in(c, (em2_2616: bitstring,sigM2_2617: bitstring));
                                                        {2576}let m2_2618: bitstring = dec(em2_2616,skCli_2223) in
                                                        {2577}if (verify(h(m2_2618),sigM2_2617,pkSess_2611) <> true) then
                                                            0
                                                        else
                                                            {2578}let (=OpenSecureChannelResponse,Ns_2619: bitstring,ST_2620: bitstring,TTL_2621: bitstring) = m2_2618 in
                                                            {2579}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                            {2580}event endCli(Sess,Cli,Ns_2619)
                                            )
                                            else
                                                {2581}let pkSess_2622: bitstring = fail-any in
                                                {2582}out(c, GetEndpointRequest);
                                                {2583}in(c, (=GetEndpointResponse,=pkSess_2622,=SignAndEncrypt,SP_2623: bitstring,UP_2624: bitstring));
                                                {2584}new Nc_2625: bitstring;
                                                {2585}let m1_2626: bitstring = (OpenSecureChannelRequest,pkCli_2224,Nc_2625) in
                                                {2586}event beginCli(Cli,Sess,Nc_2625);
                                                {2587}out(c, (pkCli_2224,enc(m1_2626,pkSess_2622),sign(h(m1_2626),skCli_2223)));
                                                {2588}in(c, (em2_2627: bitstring,sigM2_2628: bitstring));
                                                {2589}let m2_2629: bitstring = dec(em2_2627,skCli_2223) in
                                                {2590}if (verify(h(m2_2629),sigM2_2628,pkSess_2622) <> true) then
                                                    0
                                                else
                                                    {2591}let (=OpenSecureChannelResponse,Ns_2630: bitstring,ST_2631: bitstring,TTL_2632: bitstring) = m2_2629 in
                                                    {2592}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {2593}event endCli(Sess,Cli,Ns_2630)
                                )
                                else
                                    {2594}let pkDisco_2633: bitstring = fail-any in
                                    {2595}let v_2634: bool = (Sess = A) in
                                    (
                                        {2596}if v_2634 then
                                        (
                                            {2597}let pkSess_2635: bitstring = pub(skA) in
                                            {2598}out(c, GetEndpointRequest);
                                            {2599}in(c, (=GetEndpointResponse,=pkSess_2635,=SignAndEncrypt,SP_2636: bitstring,UP_2637: bitstring));
                                            {2600}new Nc_2638: bitstring;
                                            {2601}let m1_2639: bitstring = (OpenSecureChannelRequest,pkCli_2224,Nc_2638) in
                                            {2602}event beginCli(Cli,Sess,Nc_2638);
                                            {2603}out(c, (pkCli_2224,enc(m1_2639,pkSess_2635),sign(h(m1_2639),skCli_2223)));
                                            {2604}in(c, (em2_2640: bitstring,sigM2_2641: bitstring));
                                            {2605}let m2_2642: bitstring = dec(em2_2640,skCli_2223) in
                                            {2606}if (verify(h(m2_2642),sigM2_2641,pkSess_2635) <> true) then
                                                0
                                            else
                                                {2607}let (=OpenSecureChannelResponse,Ns_2643: bitstring,ST_2644: bitstring,TTL_2645: bitstring) = m2_2642 in
                                                {2608}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {2609}event endCli(Sess,Cli,Ns_2643)
                                        )
                                        else
                                            {2610}let v_2646: bool = (Sess = B) in
                                            (
                                                {2611}if v_2646 then
                                                (
                                                    {2612}let pkSess_2647: bitstring = pub(skB) in
                                                    {2613}out(c, GetEndpointRequest);
                                                    {2614}in(c, (=GetEndpointResponse,=pkSess_2647,=SignAndEncrypt,SP_2648: bitstring,UP_2649: bitstring));
                                                    {2615}new Nc_2650: bitstring;
                                                    {2616}let m1_2651: bitstring = (OpenSecureChannelRequest,pkCli_2224,Nc_2650) in
                                                    {2617}event beginCli(Cli,Sess,Nc_2650);
                                                    {2618}out(c, (pkCli_2224,enc(m1_2651,pkSess_2647),sign(h(m1_2651),skCli_2223)));
                                                    {2619}in(c, (em2_2652: bitstring,sigM2_2653: bitstring));
                                                    {2620}let m2_2654: bitstring = dec(em2_2652,skCli_2223) in
                                                    {2621}if (verify(h(m2_2654),sigM2_2653,pkSess_2647) <> true) then
                                                        0
                                                    else
                                                        {2622}let (=OpenSecureChannelResponse,Ns_2655: bitstring,ST_2656: bitstring,TTL_2657: bitstring) = m2_2654 in
                                                        {2623}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {2624}event endCli(Sess,Cli,Ns_2655)
                                                )
                                                else
                                                    {2625}let v_2658: bool = (Sess = C) in
                                                    (
                                                        {2626}if v_2658 then
                                                        (
                                                            {2627}let pkSess_2659: bitstring = pub(skC) in
                                                            {2628}out(c, GetEndpointRequest);
                                                            {2629}in(c, (=GetEndpointResponse,=pkSess_2659,=SignAndEncrypt,SP_2660: bitstring,UP_2661: bitstring));
                                                            {2630}new Nc_2662: bitstring;
                                                            {2631}let m1_2663: bitstring = (OpenSecureChannelRequest,pkCli_2224,Nc_2662) in
                                                            {2632}event beginCli(Cli,Sess,Nc_2662);
                                                            {2633}out(c, (pkCli_2224,enc(m1_2663,pkSess_2659),sign(h(m1_2663),skCli_2223)));
                                                            {2634}in(c, (em2_2664: bitstring,sigM2_2665: bitstring));
                                                            {2635}let m2_2666: bitstring = dec(em2_2664,skCli_2223) in
                                                            {2636}if (verify(h(m2_2666),sigM2_2665,pkSess_2659) <> true) then
                                                                0
                                                            else
                                                                {2637}let (=OpenSecureChannelResponse,Ns_2667: bitstring,ST_2668: bitstring,TTL_2669: bitstring) = m2_2666 in
                                                                {2638}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                {2639}event endCli(Sess,Cli,Ns_2667)
                                                        )
                                                        else
                                                            {2640}let pkSess_2670: bitstring = pub(sk(Sess)) in
                                                            {2641}out(c, GetEndpointRequest);
                                                            {2642}in(c, (=GetEndpointResponse,=pkSess_2670,=SignAndEncrypt,SP_2671: bitstring,UP_2672: bitstring));
                                                            {2643}new Nc_2673: bitstring;
                                                            {2644}let m1_2674: bitstring = (OpenSecureChannelRequest,pkCli_2224,Nc_2673) in
                                                            {2645}event beginCli(Cli,Sess,Nc_2673);
                                                            {2646}out(c, (pkCli_2224,enc(m1_2674,pkSess_2670),sign(h(m1_2674),skCli_2223)));
                                                            {2647}in(c, (em2_2675: bitstring,sigM2_2676: bitstring));
                                                            {2648}let m2_2677: bitstring = dec(em2_2675,skCli_2223) in
                                                            {2649}if (verify(h(m2_2677),sigM2_2676,pkSess_2670) <> true) then
                                                                0
                                                            else
                                                                {2650}let (=OpenSecureChannelResponse,Ns_2678: bitstring,ST_2679: bitstring,TTL_2680: bitstring) = m2_2677 in
                                                                {2651}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                {2652}event endCli(Sess,Cli,Ns_2678)
                                                    )
                                                    else
                                                        {2653}let pkSess_2681: bitstring = fail-any in
                                                        {2654}out(c, GetEndpointRequest);
                                                        {2655}in(c, (=GetEndpointResponse,=pkSess_2681,=SignAndEncrypt,SP_2682: bitstring,UP_2683: bitstring));
                                                        {2656}new Nc_2684: bitstring;
                                                        {2657}let m1_2685: bitstring = (OpenSecureChannelRequest,pkCli_2224,Nc_2684) in
                                                        {2658}event beginCli(Cli,Sess,Nc_2684);
                                                        {2659}out(c, (pkCli_2224,enc(m1_2685,pkSess_2681),sign(h(m1_2685),skCli_2223)));
                                                        {2660}in(c, (em2_2686: bitstring,sigM2_2687: bitstring));
                                                        {2661}let m2_2688: bitstring = dec(em2_2686,skCli_2223) in
                                                        {2662}if (verify(h(m2_2688),sigM2_2687,pkSess_2681) <> true) then
                                                            0
                                                        else
                                                            {2663}let (=OpenSecureChannelResponse,Ns_2689: bitstring,ST_2690: bitstring,TTL_2691: bitstring) = m2_2688 in
                                                            {2664}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                            {2665}event endCli(Sess,Cli,Ns_2689)
                                            )
                                            else
                                                {2666}let pkSess_2692: bitstring = fail-any in
                                                {2667}out(c, GetEndpointRequest);
                                                {2668}in(c, (=GetEndpointResponse,=pkSess_2692,=SignAndEncrypt,SP_2693: bitstring,UP_2694: bitstring));
                                                {2669}new Nc_2695: bitstring;
                                                {2670}let m1_2696: bitstring = (OpenSecureChannelRequest,pkCli_2224,Nc_2695) in
                                                {2671}event beginCli(Cli,Sess,Nc_2695);
                                                {2672}out(c, (pkCli_2224,enc(m1_2696,pkSess_2692),sign(h(m1_2696),skCli_2223)));
                                                {2673}in(c, (em2_2697: bitstring,sigM2_2698: bitstring));
                                                {2674}let m2_2699: bitstring = dec(em2_2697,skCli_2223) in
                                                {2675}if (verify(h(m2_2699),sigM2_2698,pkSess_2692) <> true) then
                                                    0
                                                else
                                                    {2676}let (=OpenSecureChannelResponse,Ns_2700: bitstring,ST_2701: bitstring,TTL_2702: bitstring) = m2_2699 in
                                                    {2677}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {2678}event endCli(Sess,Cli,Ns_2700)
                                    )
                                    else
                                        {2679}let pkSess_2703: bitstring = fail-any in
                                        {2680}out(c, GetEndpointRequest);
                                        {2681}in(c, (=GetEndpointResponse,=pkSess_2703,=SignAndEncrypt,SP_2704: bitstring,UP_2705: bitstring));
                                        {2682}new Nc_2706: bitstring;
                                        {2683}let m1_2707: bitstring = (OpenSecureChannelRequest,pkCli_2224,Nc_2706) in
                                        {2684}event beginCli(Cli,Sess,Nc_2706);
                                        {2685}out(c, (pkCli_2224,enc(m1_2707,pkSess_2703),sign(h(m1_2707),skCli_2223)));
                                        {2686}in(c, (em2_2708: bitstring,sigM2_2709: bitstring));
                                        {2687}let m2_2710: bitstring = dec(em2_2708,skCli_2223) in
                                        {2688}if (verify(h(m2_2710),sigM2_2709,pkSess_2703) <> true) then
                                            0
                                        else
                                            {2689}let (=OpenSecureChannelResponse,Ns_2711: bitstring,ST_2712: bitstring,TTL_2713: bitstring) = m2_2710 in
                                            {2690}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {2691}event endCli(Sess,Cli,Ns_2711)
                        )
                        else
                            {2692}let pkDisco_2714: bitstring = fail-any in
                            {2693}let v_2715: bool = (Sess = A) in
                            (
                                {2694}if v_2715 then
                                (
                                    {2695}let pkSess_2716: bitstring = pub(skA) in
                                    {2696}out(c, GetEndpointRequest);
                                    {2697}in(c, (=GetEndpointResponse,=pkSess_2716,=SignAndEncrypt,SP_2717: bitstring,UP_2718: bitstring));
                                    {2698}new Nc_2719: bitstring;
                                    {2699}let m1_2720: bitstring = (OpenSecureChannelRequest,pkCli_2224,Nc_2719) in
                                    {2700}event beginCli(Cli,Sess,Nc_2719);
                                    {2701}out(c, (pkCli_2224,enc(m1_2720,pkSess_2716),sign(h(m1_2720),skCli_2223)));
                                    {2702}in(c, (em2_2721: bitstring,sigM2_2722: bitstring));
                                    {2703}let m2_2723: bitstring = dec(em2_2721,skCli_2223) in
                                    {2704}if (verify(h(m2_2723),sigM2_2722,pkSess_2716) <> true) then
                                        0
                                    else
                                        {2705}let (=OpenSecureChannelResponse,Ns_2724: bitstring,ST_2725: bitstring,TTL_2726: bitstring) = m2_2723 in
                                        {2706}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                        {2707}event endCli(Sess,Cli,Ns_2724)
                                )
                                else
                                    {2708}let v_2727: bool = (Sess = B) in
                                    (
                                        {2709}if v_2727 then
                                        (
                                            {2710}let pkSess_2728: bitstring = pub(skB) in
                                            {2711}out(c, GetEndpointRequest);
                                            {2712}in(c, (=GetEndpointResponse,=pkSess_2728,=SignAndEncrypt,SP_2729: bitstring,UP_2730: bitstring));
                                            {2713}new Nc_2731: bitstring;
                                            {2714}let m1_2732: bitstring = (OpenSecureChannelRequest,pkCli_2224,Nc_2731) in
                                            {2715}event beginCli(Cli,Sess,Nc_2731);
                                            {2716}out(c, (pkCli_2224,enc(m1_2732,pkSess_2728),sign(h(m1_2732),skCli_2223)));
                                            {2717}in(c, (em2_2733: bitstring,sigM2_2734: bitstring));
                                            {2718}let m2_2735: bitstring = dec(em2_2733,skCli_2223) in
                                            {2719}if (verify(h(m2_2735),sigM2_2734,pkSess_2728) <> true) then
                                                0
                                            else
                                                {2720}let (=OpenSecureChannelResponse,Ns_2736: bitstring,ST_2737: bitstring,TTL_2738: bitstring) = m2_2735 in
                                                {2721}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {2722}event endCli(Sess,Cli,Ns_2736)
                                        )
                                        else
                                            {2723}let v_2739: bool = (Sess = C) in
                                            (
                                                {2724}if v_2739 then
                                                (
                                                    {2725}let pkSess_2740: bitstring = pub(skC) in
                                                    {2726}out(c, GetEndpointRequest);
                                                    {2727}in(c, (=GetEndpointResponse,=pkSess_2740,=SignAndEncrypt,SP_2741: bitstring,UP_2742: bitstring));
                                                    {2728}new Nc_2743: bitstring;
                                                    {2729}let m1_2744: bitstring = (OpenSecureChannelRequest,pkCli_2224,Nc_2743) in
                                                    {2730}event beginCli(Cli,Sess,Nc_2743);
                                                    {2731}out(c, (pkCli_2224,enc(m1_2744,pkSess_2740),sign(h(m1_2744),skCli_2223)));
                                                    {2732}in(c, (em2_2745: bitstring,sigM2_2746: bitstring));
                                                    {2733}let m2_2747: bitstring = dec(em2_2745,skCli_2223) in
                                                    {2734}if (verify(h(m2_2747),sigM2_2746,pkSess_2740) <> true) then
                                                        0
                                                    else
                                                        {2735}let (=OpenSecureChannelResponse,Ns_2748: bitstring,ST_2749: bitstring,TTL_2750: bitstring) = m2_2747 in
                                                        {2736}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {2737}event endCli(Sess,Cli,Ns_2748)
                                                )
                                                else
                                                    {2738}let pkSess_2751: bitstring = pub(sk(Sess)) in
                                                    {2739}out(c, GetEndpointRequest);
                                                    {2740}in(c, (=GetEndpointResponse,=pkSess_2751,=SignAndEncrypt,SP_2752: bitstring,UP_2753: bitstring));
                                                    {2741}new Nc_2754: bitstring;
                                                    {2742}let m1_2755: bitstring = (OpenSecureChannelRequest,pkCli_2224,Nc_2754) in
                                                    {2743}event beginCli(Cli,Sess,Nc_2754);
                                                    {2744}out(c, (pkCli_2224,enc(m1_2755,pkSess_2751),sign(h(m1_2755),skCli_2223)));
                                                    {2745}in(c, (em2_2756: bitstring,sigM2_2757: bitstring));
                                                    {2746}let m2_2758: bitstring = dec(em2_2756,skCli_2223) in
                                                    {2747}if (verify(h(m2_2758),sigM2_2757,pkSess_2751) <> true) then
                                                        0
                                                    else
                                                        {2748}let (=OpenSecureChannelResponse,Ns_2759: bitstring,ST_2760: bitstring,TTL_2761: bitstring) = m2_2758 in
                                                        {2749}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {2750}event endCli(Sess,Cli,Ns_2759)
                                            )
                                            else
                                                {2751}let pkSess_2762: bitstring = fail-any in
                                                {2752}out(c, GetEndpointRequest);
                                                {2753}in(c, (=GetEndpointResponse,=pkSess_2762,=SignAndEncrypt,SP_2763: bitstring,UP_2764: bitstring));
                                                {2754}new Nc_2765: bitstring;
                                                {2755}let m1_2766: bitstring = (OpenSecureChannelRequest,pkCli_2224,Nc_2765) in
                                                {2756}event beginCli(Cli,Sess,Nc_2765);
                                                {2757}out(c, (pkCli_2224,enc(m1_2766,pkSess_2762),sign(h(m1_2766),skCli_2223)));
                                                {2758}in(c, (em2_2767: bitstring,sigM2_2768: bitstring));
                                                {2759}let m2_2769: bitstring = dec(em2_2767,skCli_2223) in
                                                {2760}if (verify(h(m2_2769),sigM2_2768,pkSess_2762) <> true) then
                                                    0
                                                else
                                                    {2761}let (=OpenSecureChannelResponse,Ns_2770: bitstring,ST_2771: bitstring,TTL_2772: bitstring) = m2_2769 in
                                                    {2762}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {2763}event endCli(Sess,Cli,Ns_2770)
                                    )
                                    else
                                        {2764}let pkSess_2773: bitstring = fail-any in
                                        {2765}out(c, GetEndpointRequest);
                                        {2766}in(c, (=GetEndpointResponse,=pkSess_2773,=SignAndEncrypt,SP_2774: bitstring,UP_2775: bitstring));
                                        {2767}new Nc_2776: bitstring;
                                        {2768}let m1_2777: bitstring = (OpenSecureChannelRequest,pkCli_2224,Nc_2776) in
                                        {2769}event beginCli(Cli,Sess,Nc_2776);
                                        {2770}out(c, (pkCli_2224,enc(m1_2777,pkSess_2773),sign(h(m1_2777),skCli_2223)));
                                        {2771}in(c, (em2_2778: bitstring,sigM2_2779: bitstring));
                                        {2772}let m2_2780: bitstring = dec(em2_2778,skCli_2223) in
                                        {2773}if (verify(h(m2_2780),sigM2_2779,pkSess_2773) <> true) then
                                            0
                                        else
                                            {2774}let (=OpenSecureChannelResponse,Ns_2781: bitstring,ST_2782: bitstring,TTL_2783: bitstring) = m2_2780 in
                                            {2775}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {2776}event endCli(Sess,Cli,Ns_2781)
                            )
                            else
                                {2777}let pkSess_2784: bitstring = fail-any in
                                {2778}out(c, GetEndpointRequest);
                                {2779}in(c, (=GetEndpointResponse,=pkSess_2784,=SignAndEncrypt,SP_2785: bitstring,UP_2786: bitstring));
                                {2780}new Nc_2787: bitstring;
                                {2781}let m1_2788: bitstring = (OpenSecureChannelRequest,pkCli_2224,Nc_2787) in
                                {2782}event beginCli(Cli,Sess,Nc_2787);
                                {2783}out(c, (pkCli_2224,enc(m1_2788,pkSess_2784),sign(h(m1_2788),skCli_2223)));
                                {2784}in(c, (em2_2789: bitstring,sigM2_2790: bitstring));
                                {2785}let m2_2791: bitstring = dec(em2_2789,skCli_2223) in
                                {2786}if (verify(h(m2_2791),sigM2_2790,pkSess_2784) <> true) then
                                    0
                                else
                                    {2787}let (=OpenSecureChannelResponse,Ns_2792: bitstring,ST_2793: bitstring,TTL_2794: bitstring) = m2_2791 in
                                    {2788}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                    {2789}event endCli(Sess,Cli,Ns_2792)
            )
            else
                {2790}let skCli_2795: bitstring = fail-any in
                {2791}let pkCli_2796: bitstring = pub(skCli_2795) in
                {2792}let v_2797: bool = (Disco = A) in
                (
                    {2793}if v_2797 then
                    (
                        {2794}let pkDisco_2798: bitstring = pub(skA) in
                        {2795}let v_2799: bool = (Sess = A) in
                        (
                            {2796}if v_2799 then
                            (
                                {2797}let pkSess_2800: bitstring = pub(skA) in
                                {2798}out(c, GetEndpointRequest);
                                {2799}in(c, (=GetEndpointResponse,=pkSess_2800,=SignAndEncrypt,SP_2801: bitstring,UP_2802: bitstring));
                                {2800}new Nc_2803: bitstring;
                                {2801}let m1_2804: bitstring = (OpenSecureChannelRequest,pkCli_2796,Nc_2803) in
                                {2802}event beginCli(Cli,Sess,Nc_2803);
                                {2803}out(c, (pkCli_2796,enc(m1_2804,pkSess_2800),sign(h(m1_2804),skCli_2795)));
                                {2804}in(c, (em2_2805: bitstring,sigM2_2806: bitstring));
                                {2805}let m2_2807: bitstring = dec(em2_2805,skCli_2795) in
                                {2806}if (verify(h(m2_2807),sigM2_2806,pkSess_2800) <> true) then
                                    0
                                else
                                    {2807}let (=OpenSecureChannelResponse,Ns_2808: bitstring,ST_2809: bitstring,TTL_2810: bitstring) = m2_2807 in
                                    {2808}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                    {2809}event endCli(Sess,Cli,Ns_2808)
                            )
                            else
                                {2810}let v_2811: bool = (Sess = B) in
                                (
                                    {2811}if v_2811 then
                                    (
                                        {2812}let pkSess_2812: bitstring = pub(skB) in
                                        {2813}out(c, GetEndpointRequest);
                                        {2814}in(c, (=GetEndpointResponse,=pkSess_2812,=SignAndEncrypt,SP_2813: bitstring,UP_2814: bitstring));
                                        {2815}new Nc_2815: bitstring;
                                        {2816}let m1_2816: bitstring = (OpenSecureChannelRequest,pkCli_2796,Nc_2815) in
                                        {2817}event beginCli(Cli,Sess,Nc_2815);
                                        {2818}out(c, (pkCli_2796,enc(m1_2816,pkSess_2812),sign(h(m1_2816),skCli_2795)));
                                        {2819}in(c, (em2_2817: bitstring,sigM2_2818: bitstring));
                                        {2820}let m2_2819: bitstring = dec(em2_2817,skCli_2795) in
                                        {2821}if (verify(h(m2_2819),sigM2_2818,pkSess_2812) <> true) then
                                            0
                                        else
                                            {2822}let (=OpenSecureChannelResponse,Ns_2820: bitstring,ST_2821: bitstring,TTL_2822: bitstring) = m2_2819 in
                                            {2823}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {2824}event endCli(Sess,Cli,Ns_2820)
                                    )
                                    else
                                        {2825}let v_2823: bool = (Sess = C) in
                                        (
                                            {2826}if v_2823 then
                                            (
                                                {2827}let pkSess_2824: bitstring = pub(skC) in
                                                {2828}out(c, GetEndpointRequest);
                                                {2829}in(c, (=GetEndpointResponse,=pkSess_2824,=SignAndEncrypt,SP_2825: bitstring,UP_2826: bitstring));
                                                {2830}new Nc_2827: bitstring;
                                                {2831}let m1_2828: bitstring = (OpenSecureChannelRequest,pkCli_2796,Nc_2827) in
                                                {2832}event beginCli(Cli,Sess,Nc_2827);
                                                {2833}out(c, (pkCli_2796,enc(m1_2828,pkSess_2824),sign(h(m1_2828),skCli_2795)));
                                                {2834}in(c, (em2_2829: bitstring,sigM2_2830: bitstring));
                                                {2835}let m2_2831: bitstring = dec(em2_2829,skCli_2795) in
                                                {2836}if (verify(h(m2_2831),sigM2_2830,pkSess_2824) <> true) then
                                                    0
                                                else
                                                    {2837}let (=OpenSecureChannelResponse,Ns_2832: bitstring,ST_2833: bitstring,TTL_2834: bitstring) = m2_2831 in
                                                    {2838}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {2839}event endCli(Sess,Cli,Ns_2832)
                                            )
                                            else
                                                {2840}let pkSess_2835: bitstring = pub(sk(Sess)) in
                                                {2841}out(c, GetEndpointRequest);
                                                {2842}in(c, (=GetEndpointResponse,=pkSess_2835,=SignAndEncrypt,SP_2836: bitstring,UP_2837: bitstring));
                                                {2843}new Nc_2838: bitstring;
                                                {2844}let m1_2839: bitstring = (OpenSecureChannelRequest,pkCli_2796,Nc_2838) in
                                                {2845}event beginCli(Cli,Sess,Nc_2838);
                                                {2846}out(c, (pkCli_2796,enc(m1_2839,pkSess_2835),sign(h(m1_2839),skCli_2795)));
                                                {2847}in(c, (em2_2840: bitstring,sigM2_2841: bitstring));
                                                {2848}let m2_2842: bitstring = dec(em2_2840,skCli_2795) in
                                                {2849}if (verify(h(m2_2842),sigM2_2841,pkSess_2835) <> true) then
                                                    0
                                                else
                                                    {2850}let (=OpenSecureChannelResponse,Ns_2843: bitstring,ST_2844: bitstring,TTL_2845: bitstring) = m2_2842 in
                                                    {2851}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {2852}event endCli(Sess,Cli,Ns_2843)
                                        )
                                        else
                                            {2853}let pkSess_2846: bitstring = fail-any in
                                            {2854}out(c, GetEndpointRequest);
                                            {2855}in(c, (=GetEndpointResponse,=pkSess_2846,=SignAndEncrypt,SP_2847: bitstring,UP_2848: bitstring));
                                            {2856}new Nc_2849: bitstring;
                                            {2857}let m1_2850: bitstring = (OpenSecureChannelRequest,pkCli_2796,Nc_2849) in
                                            {2858}event beginCli(Cli,Sess,Nc_2849);
                                            {2859}out(c, (pkCli_2796,enc(m1_2850,pkSess_2846),sign(h(m1_2850),skCli_2795)));
                                            {2860}in(c, (em2_2851: bitstring,sigM2_2852: bitstring));
                                            {2861}let m2_2853: bitstring = dec(em2_2851,skCli_2795) in
                                            {2862}if (verify(h(m2_2853),sigM2_2852,pkSess_2846) <> true) then
                                                0
                                            else
                                                {2863}let (=OpenSecureChannelResponse,Ns_2854: bitstring,ST_2855: bitstring,TTL_2856: bitstring) = m2_2853 in
                                                {2864}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {2865}event endCli(Sess,Cli,Ns_2854)
                                )
                                else
                                    {2866}let pkSess_2857: bitstring = fail-any in
                                    {2867}out(c, GetEndpointRequest);
                                    {2868}in(c, (=GetEndpointResponse,=pkSess_2857,=SignAndEncrypt,SP_2858: bitstring,UP_2859: bitstring));
                                    {2869}new Nc_2860: bitstring;
                                    {2870}let m1_2861: bitstring = (OpenSecureChannelRequest,pkCli_2796,Nc_2860) in
                                    {2871}event beginCli(Cli,Sess,Nc_2860);
                                    {2872}out(c, (pkCli_2796,enc(m1_2861,pkSess_2857),sign(h(m1_2861),skCli_2795)));
                                    {2873}in(c, (em2_2862: bitstring,sigM2_2863: bitstring));
                                    {2874}let m2_2864: bitstring = dec(em2_2862,skCli_2795) in
                                    {2875}if (verify(h(m2_2864),sigM2_2863,pkSess_2857) <> true) then
                                        0
                                    else
                                        {2876}let (=OpenSecureChannelResponse,Ns_2865: bitstring,ST_2866: bitstring,TTL_2867: bitstring) = m2_2864 in
                                        {2877}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                        {2878}event endCli(Sess,Cli,Ns_2865)
                        )
                        else
                            {2879}let pkSess_2868: bitstring = fail-any in
                            {2880}out(c, GetEndpointRequest);
                            {2881}in(c, (=GetEndpointResponse,=pkSess_2868,=SignAndEncrypt,SP_2869: bitstring,UP_2870: bitstring));
                            {2882}new Nc_2871: bitstring;
                            {2883}let m1_2872: bitstring = (OpenSecureChannelRequest,pkCli_2796,Nc_2871) in
                            {2884}event beginCli(Cli,Sess,Nc_2871);
                            {2885}out(c, (pkCli_2796,enc(m1_2872,pkSess_2868),sign(h(m1_2872),skCli_2795)));
                            {2886}in(c, (em2_2873: bitstring,sigM2_2874: bitstring));
                            {2887}let m2_2875: bitstring = dec(em2_2873,skCli_2795) in
                            {2888}if (verify(h(m2_2875),sigM2_2874,pkSess_2868) <> true) then
                                0
                            else
                                {2889}let (=OpenSecureChannelResponse,Ns_2876: bitstring,ST_2877: bitstring,TTL_2878: bitstring) = m2_2875 in
                                {2890}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                {2891}event endCli(Sess,Cli,Ns_2876)
                    )
                    else
                        {2892}let v_2879: bool = (Disco = B) in
                        (
                            {2893}if v_2879 then
                            (
                                {2894}let pkDisco_2880: bitstring = pub(skB) in
                                {2895}let v_2881: bool = (Sess = A) in
                                (
                                    {2896}if v_2881 then
                                    (
                                        {2897}let pkSess_2882: bitstring = pub(skA) in
                                        {2898}out(c, GetEndpointRequest);
                                        {2899}in(c, (=GetEndpointResponse,=pkSess_2882,=SignAndEncrypt,SP_2883: bitstring,UP_2884: bitstring));
                                        {2900}new Nc_2885: bitstring;
                                        {2901}let m1_2886: bitstring = (OpenSecureChannelRequest,pkCli_2796,Nc_2885) in
                                        {2902}event beginCli(Cli,Sess,Nc_2885);
                                        {2903}out(c, (pkCli_2796,enc(m1_2886,pkSess_2882),sign(h(m1_2886),skCli_2795)));
                                        {2904}in(c, (em2_2887: bitstring,sigM2_2888: bitstring));
                                        {2905}let m2_2889: bitstring = dec(em2_2887,skCli_2795) in
                                        {2906}if (verify(h(m2_2889),sigM2_2888,pkSess_2882) <> true) then
                                            0
                                        else
                                            {2907}let (=OpenSecureChannelResponse,Ns_2890: bitstring,ST_2891: bitstring,TTL_2892: bitstring) = m2_2889 in
                                            {2908}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {2909}event endCli(Sess,Cli,Ns_2890)
                                    )
                                    else
                                        {2910}let v_2893: bool = (Sess = B) in
                                        (
                                            {2911}if v_2893 then
                                            (
                                                {2912}let pkSess_2894: bitstring = pub(skB) in
                                                {2913}out(c, GetEndpointRequest);
                                                {2914}in(c, (=GetEndpointResponse,=pkSess_2894,=SignAndEncrypt,SP_2895: bitstring,UP_2896: bitstring));
                                                {2915}new Nc_2897: bitstring;
                                                {2916}let m1_2898: bitstring = (OpenSecureChannelRequest,pkCli_2796,Nc_2897) in
                                                {2917}event beginCli(Cli,Sess,Nc_2897);
                                                {2918}out(c, (pkCli_2796,enc(m1_2898,pkSess_2894),sign(h(m1_2898),skCli_2795)));
                                                {2919}in(c, (em2_2899: bitstring,sigM2_2900: bitstring));
                                                {2920}let m2_2901: bitstring = dec(em2_2899,skCli_2795) in
                                                {2921}if (verify(h(m2_2901),sigM2_2900,pkSess_2894) <> true) then
                                                    0
                                                else
                                                    {2922}let (=OpenSecureChannelResponse,Ns_2902: bitstring,ST_2903: bitstring,TTL_2904: bitstring) = m2_2901 in
                                                    {2923}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {2924}event endCli(Sess,Cli,Ns_2902)
                                            )
                                            else
                                                {2925}let v_2905: bool = (Sess = C) in
                                                (
                                                    {2926}if v_2905 then
                                                    (
                                                        {2927}let pkSess_2906: bitstring = pub(skC) in
                                                        {2928}out(c, GetEndpointRequest);
                                                        {2929}in(c, (=GetEndpointResponse,=pkSess_2906,=SignAndEncrypt,SP_2907: bitstring,UP_2908: bitstring));
                                                        {2930}new Nc_2909: bitstring;
                                                        {2931}let m1_2910: bitstring = (OpenSecureChannelRequest,pkCli_2796,Nc_2909) in
                                                        {2932}event beginCli(Cli,Sess,Nc_2909);
                                                        {2933}out(c, (pkCli_2796,enc(m1_2910,pkSess_2906),sign(h(m1_2910),skCli_2795)));
                                                        {2934}in(c, (em2_2911: bitstring,sigM2_2912: bitstring));
                                                        {2935}let m2_2913: bitstring = dec(em2_2911,skCli_2795) in
                                                        {2936}if (verify(h(m2_2913),sigM2_2912,pkSess_2906) <> true) then
                                                            0
                                                        else
                                                            {2937}let (=OpenSecureChannelResponse,Ns_2914: bitstring,ST_2915: bitstring,TTL_2916: bitstring) = m2_2913 in
                                                            {2938}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                            {2939}event endCli(Sess,Cli,Ns_2914)
                                                    )
                                                    else
                                                        {2940}let pkSess_2917: bitstring = pub(sk(Sess)) in
                                                        {2941}out(c, GetEndpointRequest);
                                                        {2942}in(c, (=GetEndpointResponse,=pkSess_2917,=SignAndEncrypt,SP_2918: bitstring,UP_2919: bitstring));
                                                        {2943}new Nc_2920: bitstring;
                                                        {2944}let m1_2921: bitstring = (OpenSecureChannelRequest,pkCli_2796,Nc_2920) in
                                                        {2945}event beginCli(Cli,Sess,Nc_2920);
                                                        {2946}out(c, (pkCli_2796,enc(m1_2921,pkSess_2917),sign(h(m1_2921),skCli_2795)));
                                                        {2947}in(c, (em2_2922: bitstring,sigM2_2923: bitstring));
                                                        {2948}let m2_2924: bitstring = dec(em2_2922,skCli_2795) in
                                                        {2949}if (verify(h(m2_2924),sigM2_2923,pkSess_2917) <> true) then
                                                            0
                                                        else
                                                            {2950}let (=OpenSecureChannelResponse,Ns_2925: bitstring,ST_2926: bitstring,TTL_2927: bitstring) = m2_2924 in
                                                            {2951}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                            {2952}event endCli(Sess,Cli,Ns_2925)
                                                )
                                                else
                                                    {2953}let pkSess_2928: bitstring = fail-any in
                                                    {2954}out(c, GetEndpointRequest);
                                                    {2955}in(c, (=GetEndpointResponse,=pkSess_2928,=SignAndEncrypt,SP_2929: bitstring,UP_2930: bitstring));
                                                    {2956}new Nc_2931: bitstring;
                                                    {2957}let m1_2932: bitstring = (OpenSecureChannelRequest,pkCli_2796,Nc_2931) in
                                                    {2958}event beginCli(Cli,Sess,Nc_2931);
                                                    {2959}out(c, (pkCli_2796,enc(m1_2932,pkSess_2928),sign(h(m1_2932),skCli_2795)));
                                                    {2960}in(c, (em2_2933: bitstring,sigM2_2934: bitstring));
                                                    {2961}let m2_2935: bitstring = dec(em2_2933,skCli_2795) in
                                                    {2962}if (verify(h(m2_2935),sigM2_2934,pkSess_2928) <> true) then
                                                        0
                                                    else
                                                        {2963}let (=OpenSecureChannelResponse,Ns_2936: bitstring,ST_2937: bitstring,TTL_2938: bitstring) = m2_2935 in
                                                        {2964}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {2965}event endCli(Sess,Cli,Ns_2936)
                                        )
                                        else
                                            {2966}let pkSess_2939: bitstring = fail-any in
                                            {2967}out(c, GetEndpointRequest);
                                            {2968}in(c, (=GetEndpointResponse,=pkSess_2939,=SignAndEncrypt,SP_2940: bitstring,UP_2941: bitstring));
                                            {2969}new Nc_2942: bitstring;
                                            {2970}let m1_2943: bitstring = (OpenSecureChannelRequest,pkCli_2796,Nc_2942) in
                                            {2971}event beginCli(Cli,Sess,Nc_2942);
                                            {2972}out(c, (pkCli_2796,enc(m1_2943,pkSess_2939),sign(h(m1_2943),skCli_2795)));
                                            {2973}in(c, (em2_2944: bitstring,sigM2_2945: bitstring));
                                            {2974}let m2_2946: bitstring = dec(em2_2944,skCli_2795) in
                                            {2975}if (verify(h(m2_2946),sigM2_2945,pkSess_2939) <> true) then
                                                0
                                            else
                                                {2976}let (=OpenSecureChannelResponse,Ns_2947: bitstring,ST_2948: bitstring,TTL_2949: bitstring) = m2_2946 in
                                                {2977}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {2978}event endCli(Sess,Cli,Ns_2947)
                                )
                                else
                                    {2979}let pkSess_2950: bitstring = fail-any in
                                    {2980}out(c, GetEndpointRequest);
                                    {2981}in(c, (=GetEndpointResponse,=pkSess_2950,=SignAndEncrypt,SP_2951: bitstring,UP_2952: bitstring));
                                    {2982}new Nc_2953: bitstring;
                                    {2983}let m1_2954: bitstring = (OpenSecureChannelRequest,pkCli_2796,Nc_2953) in
                                    {2984}event beginCli(Cli,Sess,Nc_2953);
                                    {2985}out(c, (pkCli_2796,enc(m1_2954,pkSess_2950),sign(h(m1_2954),skCli_2795)));
                                    {2986}in(c, (em2_2955: bitstring,sigM2_2956: bitstring));
                                    {2987}let m2_2957: bitstring = dec(em2_2955,skCli_2795) in
                                    {2988}if (verify(h(m2_2957),sigM2_2956,pkSess_2950) <> true) then
                                        0
                                    else
                                        {2989}let (=OpenSecureChannelResponse,Ns_2958: bitstring,ST_2959: bitstring,TTL_2960: bitstring) = m2_2957 in
                                        {2990}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                        {2991}event endCli(Sess,Cli,Ns_2958)
                            )
                            else
                                {2992}let v_2961: bool = (Disco = C) in
                                (
                                    {2993}if v_2961 then
                                    (
                                        {2994}let pkDisco_2962: bitstring = pub(skC) in
                                        {2995}let v_2963: bool = (Sess = A) in
                                        (
                                            {2996}if v_2963 then
                                            (
                                                {2997}let pkSess_2964: bitstring = pub(skA) in
                                                {2998}out(c, GetEndpointRequest);
                                                {2999}in(c, (=GetEndpointResponse,=pkSess_2964,=SignAndEncrypt,SP_2965: bitstring,UP_2966: bitstring));
                                                {3000}new Nc_2967: bitstring;
                                                {3001}let m1_2968: bitstring = (OpenSecureChannelRequest,pkCli_2796,Nc_2967) in
                                                {3002}event beginCli(Cli,Sess,Nc_2967);
                                                {3003}out(c, (pkCli_2796,enc(m1_2968,pkSess_2964),sign(h(m1_2968),skCli_2795)));
                                                {3004}in(c, (em2_2969: bitstring,sigM2_2970: bitstring));
                                                {3005}let m2_2971: bitstring = dec(em2_2969,skCli_2795) in
                                                {3006}if (verify(h(m2_2971),sigM2_2970,pkSess_2964) <> true) then
                                                    0
                                                else
                                                    {3007}let (=OpenSecureChannelResponse,Ns_2972: bitstring,ST_2973: bitstring,TTL_2974: bitstring) = m2_2971 in
                                                    {3008}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {3009}event endCli(Sess,Cli,Ns_2972)
                                            )
                                            else
                                                {3010}let v_2975: bool = (Sess = B) in
                                                (
                                                    {3011}if v_2975 then
                                                    (
                                                        {3012}let pkSess_2976: bitstring = pub(skB) in
                                                        {3013}out(c, GetEndpointRequest);
                                                        {3014}in(c, (=GetEndpointResponse,=pkSess_2976,=SignAndEncrypt,SP_2977: bitstring,UP_2978: bitstring));
                                                        {3015}new Nc_2979: bitstring;
                                                        {3016}let m1_2980: bitstring = (OpenSecureChannelRequest,pkCli_2796,Nc_2979) in
                                                        {3017}event beginCli(Cli,Sess,Nc_2979);
                                                        {3018}out(c, (pkCli_2796,enc(m1_2980,pkSess_2976),sign(h(m1_2980),skCli_2795)));
                                                        {3019}in(c, (em2_2981: bitstring,sigM2_2982: bitstring));
                                                        {3020}let m2_2983: bitstring = dec(em2_2981,skCli_2795) in
                                                        {3021}if (verify(h(m2_2983),sigM2_2982,pkSess_2976) <> true) then
                                                            0
                                                        else
                                                            {3022}let (=OpenSecureChannelResponse,Ns_2984: bitstring,ST_2985: bitstring,TTL_2986: bitstring) = m2_2983 in
                                                            {3023}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                            {3024}event endCli(Sess,Cli,Ns_2984)
                                                    )
                                                    else
                                                        {3025}let v_2987: bool = (Sess = C) in
                                                        (
                                                            {3026}if v_2987 then
                                                            (
                                                                {3027}let pkSess_2988: bitstring = pub(skC) in
                                                                {3028}out(c, GetEndpointRequest);
                                                                {3029}in(c, (=GetEndpointResponse,=pkSess_2988,=SignAndEncrypt,SP_2989: bitstring,UP_2990: bitstring));
                                                                {3030}new Nc_2991: bitstring;
                                                                {3031}let m1_2992: bitstring = (OpenSecureChannelRequest,pkCli_2796,Nc_2991) in
                                                                {3032}event beginCli(Cli,Sess,Nc_2991);
                                                                {3033}out(c, (pkCli_2796,enc(m1_2992,pkSess_2988),sign(h(m1_2992),skCli_2795)));
                                                                {3034}in(c, (em2_2993: bitstring,sigM2_2994: bitstring));
                                                                {3035}let m2_2995: bitstring = dec(em2_2993,skCli_2795) in
                                                                {3036}if (verify(h(m2_2995),sigM2_2994,pkSess_2988) <> true) then
                                                                    0
                                                                else
                                                                    {3037}let (=OpenSecureChannelResponse,Ns_2996: bitstring,ST_2997: bitstring,TTL_2998: bitstring) = m2_2995 in
                                                                    {3038}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                    {3039}event endCli(Sess,Cli,Ns_2996)
                                                            )
                                                            else
                                                                {3040}let pkSess_2999: bitstring = pub(sk(Sess)) in
                                                                {3041}out(c, GetEndpointRequest);
                                                                {3042}in(c, (=GetEndpointResponse,=pkSess_2999,=SignAndEncrypt,SP_3000: bitstring,UP_3001: bitstring));
                                                                {3043}new Nc_3002: bitstring;
                                                                {3044}let m1_3003: bitstring = (OpenSecureChannelRequest,pkCli_2796,Nc_3002) in
                                                                {3045}event beginCli(Cli,Sess,Nc_3002);
                                                                {3046}out(c, (pkCli_2796,enc(m1_3003,pkSess_2999),sign(h(m1_3003),skCli_2795)));
                                                                {3047}in(c, (em2_3004: bitstring,sigM2_3005: bitstring));
                                                                {3048}let m2_3006: bitstring = dec(em2_3004,skCli_2795) in
                                                                {3049}if (verify(h(m2_3006),sigM2_3005,pkSess_2999) <> true) then
                                                                    0
                                                                else
                                                                    {3050}let (=OpenSecureChannelResponse,Ns_3007: bitstring,ST_3008: bitstring,TTL_3009: bitstring) = m2_3006 in
                                                                    {3051}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                    {3052}event endCli(Sess,Cli,Ns_3007)
                                                        )
                                                        else
                                                            {3053}let pkSess_3010: bitstring = fail-any in
                                                            {3054}out(c, GetEndpointRequest);
                                                            {3055}in(c, (=GetEndpointResponse,=pkSess_3010,=SignAndEncrypt,SP_3011: bitstring,UP_3012: bitstring));
                                                            {3056}new Nc_3013: bitstring;
                                                            {3057}let m1_3014: bitstring = (OpenSecureChannelRequest,pkCli_2796,Nc_3013) in
                                                            {3058}event beginCli(Cli,Sess,Nc_3013);
                                                            {3059}out(c, (pkCli_2796,enc(m1_3014,pkSess_3010),sign(h(m1_3014),skCli_2795)));
                                                            {3060}in(c, (em2_3015: bitstring,sigM2_3016: bitstring));
                                                            {3061}let m2_3017: bitstring = dec(em2_3015,skCli_2795) in
                                                            {3062}if (verify(h(m2_3017),sigM2_3016,pkSess_3010) <> true) then
                                                                0
                                                            else
                                                                {3063}let (=OpenSecureChannelResponse,Ns_3018: bitstring,ST_3019: bitstring,TTL_3020: bitstring) = m2_3017 in
                                                                {3064}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                {3065}event endCli(Sess,Cli,Ns_3018)
                                                )
                                                else
                                                    {3066}let pkSess_3021: bitstring = fail-any in
                                                    {3067}out(c, GetEndpointRequest);
                                                    {3068}in(c, (=GetEndpointResponse,=pkSess_3021,=SignAndEncrypt,SP_3022: bitstring,UP_3023: bitstring));
                                                    {3069}new Nc_3024: bitstring;
                                                    {3070}let m1_3025: bitstring = (OpenSecureChannelRequest,pkCli_2796,Nc_3024) in
                                                    {3071}event beginCli(Cli,Sess,Nc_3024);
                                                    {3072}out(c, (pkCli_2796,enc(m1_3025,pkSess_3021),sign(h(m1_3025),skCli_2795)));
                                                    {3073}in(c, (em2_3026: bitstring,sigM2_3027: bitstring));
                                                    {3074}let m2_3028: bitstring = dec(em2_3026,skCli_2795) in
                                                    {3075}if (verify(h(m2_3028),sigM2_3027,pkSess_3021) <> true) then
                                                        0
                                                    else
                                                        {3076}let (=OpenSecureChannelResponse,Ns_3029: bitstring,ST_3030: bitstring,TTL_3031: bitstring) = m2_3028 in
                                                        {3077}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {3078}event endCli(Sess,Cli,Ns_3029)
                                        )
                                        else
                                            {3079}let pkSess_3032: bitstring = fail-any in
                                            {3080}out(c, GetEndpointRequest);
                                            {3081}in(c, (=GetEndpointResponse,=pkSess_3032,=SignAndEncrypt,SP_3033: bitstring,UP_3034: bitstring));
                                            {3082}new Nc_3035: bitstring;
                                            {3083}let m1_3036: bitstring = (OpenSecureChannelRequest,pkCli_2796,Nc_3035) in
                                            {3084}event beginCli(Cli,Sess,Nc_3035);
                                            {3085}out(c, (pkCli_2796,enc(m1_3036,pkSess_3032),sign(h(m1_3036),skCli_2795)));
                                            {3086}in(c, (em2_3037: bitstring,sigM2_3038: bitstring));
                                            {3087}let m2_3039: bitstring = dec(em2_3037,skCli_2795) in
                                            {3088}if (verify(h(m2_3039),sigM2_3038,pkSess_3032) <> true) then
                                                0
                                            else
                                                {3089}let (=OpenSecureChannelResponse,Ns_3040: bitstring,ST_3041: bitstring,TTL_3042: bitstring) = m2_3039 in
                                                {3090}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {3091}event endCli(Sess,Cli,Ns_3040)
                                    )
                                    else
                                        {3092}let pkDisco_3043: bitstring = pub(sk(Disco)) in
                                        {3093}let v_3044: bool = (Sess = A) in
                                        (
                                            {3094}if v_3044 then
                                            (
                                                {3095}let pkSess_3045: bitstring = pub(skA) in
                                                {3096}out(c, GetEndpointRequest);
                                                {3097}in(c, (=GetEndpointResponse,=pkSess_3045,=SignAndEncrypt,SP_3046: bitstring,UP_3047: bitstring));
                                                {3098}new Nc_3048: bitstring;
                                                {3099}let m1_3049: bitstring = (OpenSecureChannelRequest,pkCli_2796,Nc_3048) in
                                                {3100}event beginCli(Cli,Sess,Nc_3048);
                                                {3101}out(c, (pkCli_2796,enc(m1_3049,pkSess_3045),sign(h(m1_3049),skCli_2795)));
                                                {3102}in(c, (em2_3050: bitstring,sigM2_3051: bitstring));
                                                {3103}let m2_3052: bitstring = dec(em2_3050,skCli_2795) in
                                                {3104}if (verify(h(m2_3052),sigM2_3051,pkSess_3045) <> true) then
                                                    0
                                                else
                                                    {3105}let (=OpenSecureChannelResponse,Ns_3053: bitstring,ST_3054: bitstring,TTL_3055: bitstring) = m2_3052 in
                                                    {3106}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {3107}event endCli(Sess,Cli,Ns_3053)
                                            )
                                            else
                                                {3108}let v_3056: bool = (Sess = B) in
                                                (
                                                    {3109}if v_3056 then
                                                    (
                                                        {3110}let pkSess_3057: bitstring = pub(skB) in
                                                        {3111}out(c, GetEndpointRequest);
                                                        {3112}in(c, (=GetEndpointResponse,=pkSess_3057,=SignAndEncrypt,SP_3058: bitstring,UP_3059: bitstring));
                                                        {3113}new Nc_3060: bitstring;
                                                        {3114}let m1_3061: bitstring = (OpenSecureChannelRequest,pkCli_2796,Nc_3060) in
                                                        {3115}event beginCli(Cli,Sess,Nc_3060);
                                                        {3116}out(c, (pkCli_2796,enc(m1_3061,pkSess_3057),sign(h(m1_3061),skCli_2795)));
                                                        {3117}in(c, (em2_3062: bitstring,sigM2_3063: bitstring));
                                                        {3118}let m2_3064: bitstring = dec(em2_3062,skCli_2795) in
                                                        {3119}if (verify(h(m2_3064),sigM2_3063,pkSess_3057) <> true) then
                                                            0
                                                        else
                                                            {3120}let (=OpenSecureChannelResponse,Ns_3065: bitstring,ST_3066: bitstring,TTL_3067: bitstring) = m2_3064 in
                                                            {3121}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                            {3122}event endCli(Sess,Cli,Ns_3065)
                                                    )
                                                    else
                                                        {3123}let v_3068: bool = (Sess = C) in
                                                        (
                                                            {3124}if v_3068 then
                                                            (
                                                                {3125}let pkSess_3069: bitstring = pub(skC) in
                                                                {3126}out(c, GetEndpointRequest);
                                                                {3127}in(c, (=GetEndpointResponse,=pkSess_3069,=SignAndEncrypt,SP_3070: bitstring,UP_3071: bitstring));
                                                                {3128}new Nc_3072: bitstring;
                                                                {3129}let m1_3073: bitstring = (OpenSecureChannelRequest,pkCli_2796,Nc_3072) in
                                                                {3130}event beginCli(Cli,Sess,Nc_3072);
                                                                {3131}out(c, (pkCli_2796,enc(m1_3073,pkSess_3069),sign(h(m1_3073),skCli_2795)));
                                                                {3132}in(c, (em2_3074: bitstring,sigM2_3075: bitstring));
                                                                {3133}let m2_3076: bitstring = dec(em2_3074,skCli_2795) in
                                                                {3134}if (verify(h(m2_3076),sigM2_3075,pkSess_3069) <> true) then
                                                                    0
                                                                else
                                                                    {3135}let (=OpenSecureChannelResponse,Ns_3077: bitstring,ST_3078: bitstring,TTL_3079: bitstring) = m2_3076 in
                                                                    {3136}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                    {3137}event endCli(Sess,Cli,Ns_3077)
                                                            )
                                                            else
                                                                {3138}let pkSess_3080: bitstring = pub(sk(Sess)) in
                                                                {3139}out(c, GetEndpointRequest);
                                                                {3140}in(c, (=GetEndpointResponse,=pkSess_3080,=SignAndEncrypt,SP_3081: bitstring,UP_3082: bitstring));
                                                                {3141}new Nc_3083: bitstring;
                                                                {3142}let m1_3084: bitstring = (OpenSecureChannelRequest,pkCli_2796,Nc_3083) in
                                                                {3143}event beginCli(Cli,Sess,Nc_3083);
                                                                {3144}out(c, (pkCli_2796,enc(m1_3084,pkSess_3080),sign(h(m1_3084),skCli_2795)));
                                                                {3145}in(c, (em2_3085: bitstring,sigM2_3086: bitstring));
                                                                {3146}let m2_3087: bitstring = dec(em2_3085,skCli_2795) in
                                                                {3147}if (verify(h(m2_3087),sigM2_3086,pkSess_3080) <> true) then
                                                                    0
                                                                else
                                                                    {3148}let (=OpenSecureChannelResponse,Ns_3088: bitstring,ST_3089: bitstring,TTL_3090: bitstring) = m2_3087 in
                                                                    {3149}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                    {3150}event endCli(Sess,Cli,Ns_3088)
                                                        )
                                                        else
                                                            {3151}let pkSess_3091: bitstring = fail-any in
                                                            {3152}out(c, GetEndpointRequest);
                                                            {3153}in(c, (=GetEndpointResponse,=pkSess_3091,=SignAndEncrypt,SP_3092: bitstring,UP_3093: bitstring));
                                                            {3154}new Nc_3094: bitstring;
                                                            {3155}let m1_3095: bitstring = (OpenSecureChannelRequest,pkCli_2796,Nc_3094) in
                                                            {3156}event beginCli(Cli,Sess,Nc_3094);
                                                            {3157}out(c, (pkCli_2796,enc(m1_3095,pkSess_3091),sign(h(m1_3095),skCli_2795)));
                                                            {3158}in(c, (em2_3096: bitstring,sigM2_3097: bitstring));
                                                            {3159}let m2_3098: bitstring = dec(em2_3096,skCli_2795) in
                                                            {3160}if (verify(h(m2_3098),sigM2_3097,pkSess_3091) <> true) then
                                                                0
                                                            else
                                                                {3161}let (=OpenSecureChannelResponse,Ns_3099: bitstring,ST_3100: bitstring,TTL_3101: bitstring) = m2_3098 in
                                                                {3162}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                {3163}event endCli(Sess,Cli,Ns_3099)
                                                )
                                                else
                                                    {3164}let pkSess_3102: bitstring = fail-any in
                                                    {3165}out(c, GetEndpointRequest);
                                                    {3166}in(c, (=GetEndpointResponse,=pkSess_3102,=SignAndEncrypt,SP_3103: bitstring,UP_3104: bitstring));
                                                    {3167}new Nc_3105: bitstring;
                                                    {3168}let m1_3106: bitstring = (OpenSecureChannelRequest,pkCli_2796,Nc_3105) in
                                                    {3169}event beginCli(Cli,Sess,Nc_3105);
                                                    {3170}out(c, (pkCli_2796,enc(m1_3106,pkSess_3102),sign(h(m1_3106),skCli_2795)));
                                                    {3171}in(c, (em2_3107: bitstring,sigM2_3108: bitstring));
                                                    {3172}let m2_3109: bitstring = dec(em2_3107,skCli_2795) in
                                                    {3173}if (verify(h(m2_3109),sigM2_3108,pkSess_3102) <> true) then
                                                        0
                                                    else
                                                        {3174}let (=OpenSecureChannelResponse,Ns_3110: bitstring,ST_3111: bitstring,TTL_3112: bitstring) = m2_3109 in
                                                        {3175}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {3176}event endCli(Sess,Cli,Ns_3110)
                                        )
                                        else
                                            {3177}let pkSess_3113: bitstring = fail-any in
                                            {3178}out(c, GetEndpointRequest);
                                            {3179}in(c, (=GetEndpointResponse,=pkSess_3113,=SignAndEncrypt,SP_3114: bitstring,UP_3115: bitstring));
                                            {3180}new Nc_3116: bitstring;
                                            {3181}let m1_3117: bitstring = (OpenSecureChannelRequest,pkCli_2796,Nc_3116) in
                                            {3182}event beginCli(Cli,Sess,Nc_3116);
                                            {3183}out(c, (pkCli_2796,enc(m1_3117,pkSess_3113),sign(h(m1_3117),skCli_2795)));
                                            {3184}in(c, (em2_3118: bitstring,sigM2_3119: bitstring));
                                            {3185}let m2_3120: bitstring = dec(em2_3118,skCli_2795) in
                                            {3186}if (verify(h(m2_3120),sigM2_3119,pkSess_3113) <> true) then
                                                0
                                            else
                                                {3187}let (=OpenSecureChannelResponse,Ns_3121: bitstring,ST_3122: bitstring,TTL_3123: bitstring) = m2_3120 in
                                                {3188}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {3189}event endCli(Sess,Cli,Ns_3121)
                                )
                                else
                                    {3190}let pkDisco_3124: bitstring = fail-any in
                                    {3191}let v_3125: bool = (Sess = A) in
                                    (
                                        {3192}if v_3125 then
                                        (
                                            {3193}let pkSess_3126: bitstring = pub(skA) in
                                            {3194}out(c, GetEndpointRequest);
                                            {3195}in(c, (=GetEndpointResponse,=pkSess_3126,=SignAndEncrypt,SP_3127: bitstring,UP_3128: bitstring));
                                            {3196}new Nc_3129: bitstring;
                                            {3197}let m1_3130: bitstring = (OpenSecureChannelRequest,pkCli_2796,Nc_3129) in
                                            {3198}event beginCli(Cli,Sess,Nc_3129);
                                            {3199}out(c, (pkCli_2796,enc(m1_3130,pkSess_3126),sign(h(m1_3130),skCli_2795)));
                                            {3200}in(c, (em2_3131: bitstring,sigM2_3132: bitstring));
                                            {3201}let m2_3133: bitstring = dec(em2_3131,skCli_2795) in
                                            {3202}if (verify(h(m2_3133),sigM2_3132,pkSess_3126) <> true) then
                                                0
                                            else
                                                {3203}let (=OpenSecureChannelResponse,Ns_3134: bitstring,ST_3135: bitstring,TTL_3136: bitstring) = m2_3133 in
                                                {3204}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {3205}event endCli(Sess,Cli,Ns_3134)
                                        )
                                        else
                                            {3206}let v_3137: bool = (Sess = B) in
                                            (
                                                {3207}if v_3137 then
                                                (
                                                    {3208}let pkSess_3138: bitstring = pub(skB) in
                                                    {3209}out(c, GetEndpointRequest);
                                                    {3210}in(c, (=GetEndpointResponse,=pkSess_3138,=SignAndEncrypt,SP_3139: bitstring,UP_3140: bitstring));
                                                    {3211}new Nc_3141: bitstring;
                                                    {3212}let m1_3142: bitstring = (OpenSecureChannelRequest,pkCli_2796,Nc_3141) in
                                                    {3213}event beginCli(Cli,Sess,Nc_3141);
                                                    {3214}out(c, (pkCli_2796,enc(m1_3142,pkSess_3138),sign(h(m1_3142),skCli_2795)));
                                                    {3215}in(c, (em2_3143: bitstring,sigM2_3144: bitstring));
                                                    {3216}let m2_3145: bitstring = dec(em2_3143,skCli_2795) in
                                                    {3217}if (verify(h(m2_3145),sigM2_3144,pkSess_3138) <> true) then
                                                        0
                                                    else
                                                        {3218}let (=OpenSecureChannelResponse,Ns_3146: bitstring,ST_3147: bitstring,TTL_3148: bitstring) = m2_3145 in
                                                        {3219}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {3220}event endCli(Sess,Cli,Ns_3146)
                                                )
                                                else
                                                    {3221}let v_3149: bool = (Sess = C) in
                                                    (
                                                        {3222}if v_3149 then
                                                        (
                                                            {3223}let pkSess_3150: bitstring = pub(skC) in
                                                            {3224}out(c, GetEndpointRequest);
                                                            {3225}in(c, (=GetEndpointResponse,=pkSess_3150,=SignAndEncrypt,SP_3151: bitstring,UP_3152: bitstring));
                                                            {3226}new Nc_3153: bitstring;
                                                            {3227}let m1_3154: bitstring = (OpenSecureChannelRequest,pkCli_2796,Nc_3153) in
                                                            {3228}event beginCli(Cli,Sess,Nc_3153);
                                                            {3229}out(c, (pkCli_2796,enc(m1_3154,pkSess_3150),sign(h(m1_3154),skCli_2795)));
                                                            {3230}in(c, (em2_3155: bitstring,sigM2_3156: bitstring));
                                                            {3231}let m2_3157: bitstring = dec(em2_3155,skCli_2795) in
                                                            {3232}if (verify(h(m2_3157),sigM2_3156,pkSess_3150) <> true) then
                                                                0
                                                            else
                                                                {3233}let (=OpenSecureChannelResponse,Ns_3158: bitstring,ST_3159: bitstring,TTL_3160: bitstring) = m2_3157 in
                                                                {3234}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                {3235}event endCli(Sess,Cli,Ns_3158)
                                                        )
                                                        else
                                                            {3236}let pkSess_3161: bitstring = pub(sk(Sess)) in
                                                            {3237}out(c, GetEndpointRequest);
                                                            {3238}in(c, (=GetEndpointResponse,=pkSess_3161,=SignAndEncrypt,SP_3162: bitstring,UP_3163: bitstring));
                                                            {3239}new Nc_3164: bitstring;
                                                            {3240}let m1_3165: bitstring = (OpenSecureChannelRequest,pkCli_2796,Nc_3164) in
                                                            {3241}event beginCli(Cli,Sess,Nc_3164);
                                                            {3242}out(c, (pkCli_2796,enc(m1_3165,pkSess_3161),sign(h(m1_3165),skCli_2795)));
                                                            {3243}in(c, (em2_3166: bitstring,sigM2_3167: bitstring));
                                                            {3244}let m2_3168: bitstring = dec(em2_3166,skCli_2795) in
                                                            {3245}if (verify(h(m2_3168),sigM2_3167,pkSess_3161) <> true) then
                                                                0
                                                            else
                                                                {3246}let (=OpenSecureChannelResponse,Ns_3169: bitstring,ST_3170: bitstring,TTL_3171: bitstring) = m2_3168 in
                                                                {3247}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                {3248}event endCli(Sess,Cli,Ns_3169)
                                                    )
                                                    else
                                                        {3249}let pkSess_3172: bitstring = fail-any in
                                                        {3250}out(c, GetEndpointRequest);
                                                        {3251}in(c, (=GetEndpointResponse,=pkSess_3172,=SignAndEncrypt,SP_3173: bitstring,UP_3174: bitstring));
                                                        {3252}new Nc_3175: bitstring;
                                                        {3253}let m1_3176: bitstring = (OpenSecureChannelRequest,pkCli_2796,Nc_3175) in
                                                        {3254}event beginCli(Cli,Sess,Nc_3175);
                                                        {3255}out(c, (pkCli_2796,enc(m1_3176,pkSess_3172),sign(h(m1_3176),skCli_2795)));
                                                        {3256}in(c, (em2_3177: bitstring,sigM2_3178: bitstring));
                                                        {3257}let m2_3179: bitstring = dec(em2_3177,skCli_2795) in
                                                        {3258}if (verify(h(m2_3179),sigM2_3178,pkSess_3172) <> true) then
                                                            0
                                                        else
                                                            {3259}let (=OpenSecureChannelResponse,Ns_3180: bitstring,ST_3181: bitstring,TTL_3182: bitstring) = m2_3179 in
                                                            {3260}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                            {3261}event endCli(Sess,Cli,Ns_3180)
                                            )
                                            else
                                                {3262}let pkSess_3183: bitstring = fail-any in
                                                {3263}out(c, GetEndpointRequest);
                                                {3264}in(c, (=GetEndpointResponse,=pkSess_3183,=SignAndEncrypt,SP_3184: bitstring,UP_3185: bitstring));
                                                {3265}new Nc_3186: bitstring;
                                                {3266}let m1_3187: bitstring = (OpenSecureChannelRequest,pkCli_2796,Nc_3186) in
                                                {3267}event beginCli(Cli,Sess,Nc_3186);
                                                {3268}out(c, (pkCli_2796,enc(m1_3187,pkSess_3183),sign(h(m1_3187),skCli_2795)));
                                                {3269}in(c, (em2_3188: bitstring,sigM2_3189: bitstring));
                                                {3270}let m2_3190: bitstring = dec(em2_3188,skCli_2795) in
                                                {3271}if (verify(h(m2_3190),sigM2_3189,pkSess_3183) <> true) then
                                                    0
                                                else
                                                    {3272}let (=OpenSecureChannelResponse,Ns_3191: bitstring,ST_3192: bitstring,TTL_3193: bitstring) = m2_3190 in
                                                    {3273}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {3274}event endCli(Sess,Cli,Ns_3191)
                                    )
                                    else
                                        {3275}let pkSess_3194: bitstring = fail-any in
                                        {3276}out(c, GetEndpointRequest);
                                        {3277}in(c, (=GetEndpointResponse,=pkSess_3194,=SignAndEncrypt,SP_3195: bitstring,UP_3196: bitstring));
                                        {3278}new Nc_3197: bitstring;
                                        {3279}let m1_3198: bitstring = (OpenSecureChannelRequest,pkCli_2796,Nc_3197) in
                                        {3280}event beginCli(Cli,Sess,Nc_3197);
                                        {3281}out(c, (pkCli_2796,enc(m1_3198,pkSess_3194),sign(h(m1_3198),skCli_2795)));
                                        {3282}in(c, (em2_3199: bitstring,sigM2_3200: bitstring));
                                        {3283}let m2_3201: bitstring = dec(em2_3199,skCli_2795) in
                                        {3284}if (verify(h(m2_3201),sigM2_3200,pkSess_3194) <> true) then
                                            0
                                        else
                                            {3285}let (=OpenSecureChannelResponse,Ns_3202: bitstring,ST_3203: bitstring,TTL_3204: bitstring) = m2_3201 in
                                            {3286}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {3287}event endCli(Sess,Cli,Ns_3202)
                        )
                        else
                            {3288}let pkDisco_3205: bitstring = fail-any in
                            {3289}let v_3206: bool = (Sess = A) in
                            (
                                {3290}if v_3206 then
                                (
                                    {3291}let pkSess_3207: bitstring = pub(skA) in
                                    {3292}out(c, GetEndpointRequest);
                                    {3293}in(c, (=GetEndpointResponse,=pkSess_3207,=SignAndEncrypt,SP_3208: bitstring,UP_3209: bitstring));
                                    {3294}new Nc_3210: bitstring;
                                    {3295}let m1_3211: bitstring = (OpenSecureChannelRequest,pkCli_2796,Nc_3210) in
                                    {3296}event beginCli(Cli,Sess,Nc_3210);
                                    {3297}out(c, (pkCli_2796,enc(m1_3211,pkSess_3207),sign(h(m1_3211),skCli_2795)));
                                    {3298}in(c, (em2_3212: bitstring,sigM2_3213: bitstring));
                                    {3299}let m2_3214: bitstring = dec(em2_3212,skCli_2795) in
                                    {3300}if (verify(h(m2_3214),sigM2_3213,pkSess_3207) <> true) then
                                        0
                                    else
                                        {3301}let (=OpenSecureChannelResponse,Ns_3215: bitstring,ST_3216: bitstring,TTL_3217: bitstring) = m2_3214 in
                                        {3302}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                        {3303}event endCli(Sess,Cli,Ns_3215)
                                )
                                else
                                    {3304}let v_3218: bool = (Sess = B) in
                                    (
                                        {3305}if v_3218 then
                                        (
                                            {3306}let pkSess_3219: bitstring = pub(skB) in
                                            {3307}out(c, GetEndpointRequest);
                                            {3308}in(c, (=GetEndpointResponse,=pkSess_3219,=SignAndEncrypt,SP_3220: bitstring,UP_3221: bitstring));
                                            {3309}new Nc_3222: bitstring;
                                            {3310}let m1_3223: bitstring = (OpenSecureChannelRequest,pkCli_2796,Nc_3222) in
                                            {3311}event beginCli(Cli,Sess,Nc_3222);
                                            {3312}out(c, (pkCli_2796,enc(m1_3223,pkSess_3219),sign(h(m1_3223),skCli_2795)));
                                            {3313}in(c, (em2_3224: bitstring,sigM2_3225: bitstring));
                                            {3314}let m2_3226: bitstring = dec(em2_3224,skCli_2795) in
                                            {3315}if (verify(h(m2_3226),sigM2_3225,pkSess_3219) <> true) then
                                                0
                                            else
                                                {3316}let (=OpenSecureChannelResponse,Ns_3227: bitstring,ST_3228: bitstring,TTL_3229: bitstring) = m2_3226 in
                                                {3317}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {3318}event endCli(Sess,Cli,Ns_3227)
                                        )
                                        else
                                            {3319}let v_3230: bool = (Sess = C) in
                                            (
                                                {3320}if v_3230 then
                                                (
                                                    {3321}let pkSess_3231: bitstring = pub(skC) in
                                                    {3322}out(c, GetEndpointRequest);
                                                    {3323}in(c, (=GetEndpointResponse,=pkSess_3231,=SignAndEncrypt,SP_3232: bitstring,UP_3233: bitstring));
                                                    {3324}new Nc_3234: bitstring;
                                                    {3325}let m1_3235: bitstring = (OpenSecureChannelRequest,pkCli_2796,Nc_3234) in
                                                    {3326}event beginCli(Cli,Sess,Nc_3234);
                                                    {3327}out(c, (pkCli_2796,enc(m1_3235,pkSess_3231),sign(h(m1_3235),skCli_2795)));
                                                    {3328}in(c, (em2_3236: bitstring,sigM2_3237: bitstring));
                                                    {3329}let m2_3238: bitstring = dec(em2_3236,skCli_2795) in
                                                    {3330}if (verify(h(m2_3238),sigM2_3237,pkSess_3231) <> true) then
                                                        0
                                                    else
                                                        {3331}let (=OpenSecureChannelResponse,Ns_3239: bitstring,ST_3240: bitstring,TTL_3241: bitstring) = m2_3238 in
                                                        {3332}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {3333}event endCli(Sess,Cli,Ns_3239)
                                                )
                                                else
                                                    {3334}let pkSess_3242: bitstring = pub(sk(Sess)) in
                                                    {3335}out(c, GetEndpointRequest);
                                                    {3336}in(c, (=GetEndpointResponse,=pkSess_3242,=SignAndEncrypt,SP_3243: bitstring,UP_3244: bitstring));
                                                    {3337}new Nc_3245: bitstring;
                                                    {3338}let m1_3246: bitstring = (OpenSecureChannelRequest,pkCli_2796,Nc_3245) in
                                                    {3339}event beginCli(Cli,Sess,Nc_3245);
                                                    {3340}out(c, (pkCli_2796,enc(m1_3246,pkSess_3242),sign(h(m1_3246),skCli_2795)));
                                                    {3341}in(c, (em2_3247: bitstring,sigM2_3248: bitstring));
                                                    {3342}let m2_3249: bitstring = dec(em2_3247,skCli_2795) in
                                                    {3343}if (verify(h(m2_3249),sigM2_3248,pkSess_3242) <> true) then
                                                        0
                                                    else
                                                        {3344}let (=OpenSecureChannelResponse,Ns_3250: bitstring,ST_3251: bitstring,TTL_3252: bitstring) = m2_3249 in
                                                        {3345}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {3346}event endCli(Sess,Cli,Ns_3250)
                                            )
                                            else
                                                {3347}let pkSess_3253: bitstring = fail-any in
                                                {3348}out(c, GetEndpointRequest);
                                                {3349}in(c, (=GetEndpointResponse,=pkSess_3253,=SignAndEncrypt,SP_3254: bitstring,UP_3255: bitstring));
                                                {3350}new Nc_3256: bitstring;
                                                {3351}let m1_3257: bitstring = (OpenSecureChannelRequest,pkCli_2796,Nc_3256) in
                                                {3352}event beginCli(Cli,Sess,Nc_3256);
                                                {3353}out(c, (pkCli_2796,enc(m1_3257,pkSess_3253),sign(h(m1_3257),skCli_2795)));
                                                {3354}in(c, (em2_3258: bitstring,sigM2_3259: bitstring));
                                                {3355}let m2_3260: bitstring = dec(em2_3258,skCli_2795) in
                                                {3356}if (verify(h(m2_3260),sigM2_3259,pkSess_3253) <> true) then
                                                    0
                                                else
                                                    {3357}let (=OpenSecureChannelResponse,Ns_3261: bitstring,ST_3262: bitstring,TTL_3263: bitstring) = m2_3260 in
                                                    {3358}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {3359}event endCli(Sess,Cli,Ns_3261)
                                    )
                                    else
                                        {3360}let pkSess_3264: bitstring = fail-any in
                                        {3361}out(c, GetEndpointRequest);
                                        {3362}in(c, (=GetEndpointResponse,=pkSess_3264,=SignAndEncrypt,SP_3265: bitstring,UP_3266: bitstring));
                                        {3363}new Nc_3267: bitstring;
                                        {3364}let m1_3268: bitstring = (OpenSecureChannelRequest,pkCli_2796,Nc_3267) in
                                        {3365}event beginCli(Cli,Sess,Nc_3267);
                                        {3366}out(c, (pkCli_2796,enc(m1_3268,pkSess_3264),sign(h(m1_3268),skCli_2795)));
                                        {3367}in(c, (em2_3269: bitstring,sigM2_3270: bitstring));
                                        {3368}let m2_3271: bitstring = dec(em2_3269,skCli_2795) in
                                        {3369}if (verify(h(m2_3271),sigM2_3270,pkSess_3264) <> true) then
                                            0
                                        else
                                            {3370}let (=OpenSecureChannelResponse,Ns_3272: bitstring,ST_3273: bitstring,TTL_3274: bitstring) = m2_3271 in
                                            {3371}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {3372}event endCli(Sess,Cli,Ns_3272)
                            )
                            else
                                {3373}let pkSess_3275: bitstring = fail-any in
                                {3374}out(c, GetEndpointRequest);
                                {3375}in(c, (=GetEndpointResponse,=pkSess_3275,=SignAndEncrypt,SP_3276: bitstring,UP_3277: bitstring));
                                {3376}new Nc_3278: bitstring;
                                {3377}let m1_3279: bitstring = (OpenSecureChannelRequest,pkCli_2796,Nc_3278) in
                                {3378}event beginCli(Cli,Sess,Nc_3278);
                                {3379}out(c, (pkCli_2796,enc(m1_3279,pkSess_3275),sign(h(m1_3279),skCli_2795)));
                                {3380}in(c, (em2_3280: bitstring,sigM2_3281: bitstring));
                                {3381}let m2_3282: bitstring = dec(em2_3280,skCli_2795) in
                                {3382}if (verify(h(m2_3282),sigM2_3281,pkSess_3275) <> true) then
                                    0
                                else
                                    {3383}let (=OpenSecureChannelResponse,Ns_3283: bitstring,ST_3284: bitstring,TTL_3285: bitstring) = m2_3282 in
                                    {3384}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                    {3385}event endCli(Sess,Cli,Ns_3283)
                )
                else
                    {3386}let pkDisco_3286: bitstring = fail-any in
                    {3387}let v_3287: bool = (Sess = A) in
                    (
                        {3388}if v_3287 then
                        (
                            {3389}let pkSess_3288: bitstring = pub(skA) in
                            {3390}out(c, GetEndpointRequest);
                            {3391}in(c, (=GetEndpointResponse,=pkSess_3288,=SignAndEncrypt,SP_3289: bitstring,UP_3290: bitstring));
                            {3392}new Nc_3291: bitstring;
                            {3393}let m1_3292: bitstring = (OpenSecureChannelRequest,pkCli_2796,Nc_3291) in
                            {3394}event beginCli(Cli,Sess,Nc_3291);
                            {3395}out(c, (pkCli_2796,enc(m1_3292,pkSess_3288),sign(h(m1_3292),skCli_2795)));
                            {3396}in(c, (em2_3293: bitstring,sigM2_3294: bitstring));
                            {3397}let m2_3295: bitstring = dec(em2_3293,skCli_2795) in
                            {3398}if (verify(h(m2_3295),sigM2_3294,pkSess_3288) <> true) then
                                0
                            else
                                {3399}let (=OpenSecureChannelResponse,Ns_3296: bitstring,ST_3297: bitstring,TTL_3298: bitstring) = m2_3295 in
                                {3400}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                {3401}event endCli(Sess,Cli,Ns_3296)
                        )
                        else
                            {3402}let v_3299: bool = (Sess = B) in
                            (
                                {3403}if v_3299 then
                                (
                                    {3404}let pkSess_3300: bitstring = pub(skB) in
                                    {3405}out(c, GetEndpointRequest);
                                    {3406}in(c, (=GetEndpointResponse,=pkSess_3300,=SignAndEncrypt,SP_3301: bitstring,UP_3302: bitstring));
                                    {3407}new Nc_3303: bitstring;
                                    {3408}let m1_3304: bitstring = (OpenSecureChannelRequest,pkCli_2796,Nc_3303) in
                                    {3409}event beginCli(Cli,Sess,Nc_3303);
                                    {3410}out(c, (pkCli_2796,enc(m1_3304,pkSess_3300),sign(h(m1_3304),skCli_2795)));
                                    {3411}in(c, (em2_3305: bitstring,sigM2_3306: bitstring));
                                    {3412}let m2_3307: bitstring = dec(em2_3305,skCli_2795) in
                                    {3413}if (verify(h(m2_3307),sigM2_3306,pkSess_3300) <> true) then
                                        0
                                    else
                                        {3414}let (=OpenSecureChannelResponse,Ns_3308: bitstring,ST_3309: bitstring,TTL_3310: bitstring) = m2_3307 in
                                        {3415}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                        {3416}event endCli(Sess,Cli,Ns_3308)
                                )
                                else
                                    {3417}let v_3311: bool = (Sess = C) in
                                    (
                                        {3418}if v_3311 then
                                        (
                                            {3419}let pkSess_3312: bitstring = pub(skC) in
                                            {3420}out(c, GetEndpointRequest);
                                            {3421}in(c, (=GetEndpointResponse,=pkSess_3312,=SignAndEncrypt,SP_3313: bitstring,UP_3314: bitstring));
                                            {3422}new Nc_3315: bitstring;
                                            {3423}let m1_3316: bitstring = (OpenSecureChannelRequest,pkCli_2796,Nc_3315) in
                                            {3424}event beginCli(Cli,Sess,Nc_3315);
                                            {3425}out(c, (pkCli_2796,enc(m1_3316,pkSess_3312),sign(h(m1_3316),skCli_2795)));
                                            {3426}in(c, (em2_3317: bitstring,sigM2_3318: bitstring));
                                            {3427}let m2_3319: bitstring = dec(em2_3317,skCli_2795) in
                                            {3428}if (verify(h(m2_3319),sigM2_3318,pkSess_3312) <> true) then
                                                0
                                            else
                                                {3429}let (=OpenSecureChannelResponse,Ns_3320: bitstring,ST_3321: bitstring,TTL_3322: bitstring) = m2_3319 in
                                                {3430}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {3431}event endCli(Sess,Cli,Ns_3320)
                                        )
                                        else
                                            {3432}let pkSess_3323: bitstring = pub(sk(Sess)) in
                                            {3433}out(c, GetEndpointRequest);
                                            {3434}in(c, (=GetEndpointResponse,=pkSess_3323,=SignAndEncrypt,SP_3324: bitstring,UP_3325: bitstring));
                                            {3435}new Nc_3326: bitstring;
                                            {3436}let m1_3327: bitstring = (OpenSecureChannelRequest,pkCli_2796,Nc_3326) in
                                            {3437}event beginCli(Cli,Sess,Nc_3326);
                                            {3438}out(c, (pkCli_2796,enc(m1_3327,pkSess_3323),sign(h(m1_3327),skCli_2795)));
                                            {3439}in(c, (em2_3328: bitstring,sigM2_3329: bitstring));
                                            {3440}let m2_3330: bitstring = dec(em2_3328,skCli_2795) in
                                            {3441}if (verify(h(m2_3330),sigM2_3329,pkSess_3323) <> true) then
                                                0
                                            else
                                                {3442}let (=OpenSecureChannelResponse,Ns_3331: bitstring,ST_3332: bitstring,TTL_3333: bitstring) = m2_3330 in
                                                {3443}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {3444}event endCli(Sess,Cli,Ns_3331)
                                    )
                                    else
                                        {3445}let pkSess_3334: bitstring = fail-any in
                                        {3446}out(c, GetEndpointRequest);
                                        {3447}in(c, (=GetEndpointResponse,=pkSess_3334,=SignAndEncrypt,SP_3335: bitstring,UP_3336: bitstring));
                                        {3448}new Nc_3337: bitstring;
                                        {3449}let m1_3338: bitstring = (OpenSecureChannelRequest,pkCli_2796,Nc_3337) in
                                        {3450}event beginCli(Cli,Sess,Nc_3337);
                                        {3451}out(c, (pkCli_2796,enc(m1_3338,pkSess_3334),sign(h(m1_3338),skCli_2795)));
                                        {3452}in(c, (em2_3339: bitstring,sigM2_3340: bitstring));
                                        {3453}let m2_3341: bitstring = dec(em2_3339,skCli_2795) in
                                        {3454}if (verify(h(m2_3341),sigM2_3340,pkSess_3334) <> true) then
                                            0
                                        else
                                            {3455}let (=OpenSecureChannelResponse,Ns_3342: bitstring,ST_3343: bitstring,TTL_3344: bitstring) = m2_3341 in
                                            {3456}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {3457}event endCli(Sess,Cli,Ns_3342)
                            )
                            else
                                {3458}let pkSess_3345: bitstring = fail-any in
                                {3459}out(c, GetEndpointRequest);
                                {3460}in(c, (=GetEndpointResponse,=pkSess_3345,=SignAndEncrypt,SP_3346: bitstring,UP_3347: bitstring));
                                {3461}new Nc_3348: bitstring;
                                {3462}let m1_3349: bitstring = (OpenSecureChannelRequest,pkCli_2796,Nc_3348) in
                                {3463}event beginCli(Cli,Sess,Nc_3348);
                                {3464}out(c, (pkCli_2796,enc(m1_3349,pkSess_3345),sign(h(m1_3349),skCli_2795)));
                                {3465}in(c, (em2_3350: bitstring,sigM2_3351: bitstring));
                                {3466}let m2_3352: bitstring = dec(em2_3350,skCli_2795) in
                                {3467}if (verify(h(m2_3352),sigM2_3351,pkSess_3345) <> true) then
                                    0
                                else
                                    {3468}let (=OpenSecureChannelResponse,Ns_3353: bitstring,ST_3354: bitstring,TTL_3355: bitstring) = m2_3352 in
                                    {3469}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                    {3470}event endCli(Sess,Cli,Ns_3353)
                    )
                    else
                        {3471}let pkSess_3356: bitstring = fail-any in
                        {3472}out(c, GetEndpointRequest);
                        {3473}in(c, (=GetEndpointResponse,=pkSess_3356,=SignAndEncrypt,SP_3357: bitstring,UP_3358: bitstring));
                        {3474}new Nc_3359: bitstring;
                        {3475}let m1_3360: bitstring = (OpenSecureChannelRequest,pkCli_2796,Nc_3359) in
                        {3476}event beginCli(Cli,Sess,Nc_3359);
                        {3477}out(c, (pkCli_2796,enc(m1_3360,pkSess_3356),sign(h(m1_3360),skCli_2795)));
                        {3478}in(c, (em2_3361: bitstring,sigM2_3362: bitstring));
                        {3479}let m2_3363: bitstring = dec(em2_3361,skCli_2795) in
                        {3480}if (verify(h(m2_3363),sigM2_3362,pkSess_3356) <> true) then
                            0
                        else
                            {3481}let (=OpenSecureChannelResponse,Ns_3364: bitstring,ST_3365: bitstring,TTL_3366: bitstring) = m2_3363 in
                            {3482}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                            {3483}event endCli(Sess,Cli,Ns_3364)
    )
    else
        {3484}let skCli_3367: bitstring = fail-any in
        {3485}let pkCli_3368: bitstring = pub(skCli_3367) in
        {3486}let v_3369: bool = (Disco = A) in
        (
            {3487}if v_3369 then
            (
                {3488}let pkDisco_3370: bitstring = pub(skA) in
                {3489}let v_3371: bool = (Sess = A) in
                (
                    {3490}if v_3371 then
                    (
                        {3491}let pkSess_3372: bitstring = pub(skA) in
                        {3492}out(c, GetEndpointRequest);
                        {3493}in(c, (=GetEndpointResponse,=pkSess_3372,=SignAndEncrypt,SP_3373: bitstring,UP_3374: bitstring));
                        {3494}new Nc_3375: bitstring;
                        {3495}let m1_3376: bitstring = (OpenSecureChannelRequest,pkCli_3368,Nc_3375) in
                        {3496}event beginCli(Cli,Sess,Nc_3375);
                        {3497}out(c, (pkCli_3368,enc(m1_3376,pkSess_3372),sign(h(m1_3376),skCli_3367)));
                        {3498}in(c, (em2_3377: bitstring,sigM2_3378: bitstring));
                        {3499}let m2_3379: bitstring = dec(em2_3377,skCli_3367) in
                        {3500}if (verify(h(m2_3379),sigM2_3378,pkSess_3372) <> true) then
                            0
                        else
                            {3501}let (=OpenSecureChannelResponse,Ns_3380: bitstring,ST_3381: bitstring,TTL_3382: bitstring) = m2_3379 in
                            {3502}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                            {3503}event endCli(Sess,Cli,Ns_3380)
                    )
                    else
                        {3504}let v_3383: bool = (Sess = B) in
                        (
                            {3505}if v_3383 then
                            (
                                {3506}let pkSess_3384: bitstring = pub(skB) in
                                {3507}out(c, GetEndpointRequest);
                                {3508}in(c, (=GetEndpointResponse,=pkSess_3384,=SignAndEncrypt,SP_3385: bitstring,UP_3386: bitstring));
                                {3509}new Nc_3387: bitstring;
                                {3510}let m1_3388: bitstring = (OpenSecureChannelRequest,pkCli_3368,Nc_3387) in
                                {3511}event beginCli(Cli,Sess,Nc_3387);
                                {3512}out(c, (pkCli_3368,enc(m1_3388,pkSess_3384),sign(h(m1_3388),skCli_3367)));
                                {3513}in(c, (em2_3389: bitstring,sigM2_3390: bitstring));
                                {3514}let m2_3391: bitstring = dec(em2_3389,skCli_3367) in
                                {3515}if (verify(h(m2_3391),sigM2_3390,pkSess_3384) <> true) then
                                    0
                                else
                                    {3516}let (=OpenSecureChannelResponse,Ns_3392: bitstring,ST_3393: bitstring,TTL_3394: bitstring) = m2_3391 in
                                    {3517}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                    {3518}event endCli(Sess,Cli,Ns_3392)
                            )
                            else
                                {3519}let v_3395: bool = (Sess = C) in
                                (
                                    {3520}if v_3395 then
                                    (
                                        {3521}let pkSess_3396: bitstring = pub(skC) in
                                        {3522}out(c, GetEndpointRequest);
                                        {3523}in(c, (=GetEndpointResponse,=pkSess_3396,=SignAndEncrypt,SP_3397: bitstring,UP_3398: bitstring));
                                        {3524}new Nc_3399: bitstring;
                                        {3525}let m1_3400: bitstring = (OpenSecureChannelRequest,pkCli_3368,Nc_3399) in
                                        {3526}event beginCli(Cli,Sess,Nc_3399);
                                        {3527}out(c, (pkCli_3368,enc(m1_3400,pkSess_3396),sign(h(m1_3400),skCli_3367)));
                                        {3528}in(c, (em2_3401: bitstring,sigM2_3402: bitstring));
                                        {3529}let m2_3403: bitstring = dec(em2_3401,skCli_3367) in
                                        {3530}if (verify(h(m2_3403),sigM2_3402,pkSess_3396) <> true) then
                                            0
                                        else
                                            {3531}let (=OpenSecureChannelResponse,Ns_3404: bitstring,ST_3405: bitstring,TTL_3406: bitstring) = m2_3403 in
                                            {3532}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {3533}event endCli(Sess,Cli,Ns_3404)
                                    )
                                    else
                                        {3534}let pkSess_3407: bitstring = pub(sk(Sess)) in
                                        {3535}out(c, GetEndpointRequest);
                                        {3536}in(c, (=GetEndpointResponse,=pkSess_3407,=SignAndEncrypt,SP_3408: bitstring,UP_3409: bitstring));
                                        {3537}new Nc_3410: bitstring;
                                        {3538}let m1_3411: bitstring = (OpenSecureChannelRequest,pkCli_3368,Nc_3410) in
                                        {3539}event beginCli(Cli,Sess,Nc_3410);
                                        {3540}out(c, (pkCli_3368,enc(m1_3411,pkSess_3407),sign(h(m1_3411),skCli_3367)));
                                        {3541}in(c, (em2_3412: bitstring,sigM2_3413: bitstring));
                                        {3542}let m2_3414: bitstring = dec(em2_3412,skCli_3367) in
                                        {3543}if (verify(h(m2_3414),sigM2_3413,pkSess_3407) <> true) then
                                            0
                                        else
                                            {3544}let (=OpenSecureChannelResponse,Ns_3415: bitstring,ST_3416: bitstring,TTL_3417: bitstring) = m2_3414 in
                                            {3545}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {3546}event endCli(Sess,Cli,Ns_3415)
                                )
                                else
                                    {3547}let pkSess_3418: bitstring = fail-any in
                                    {3548}out(c, GetEndpointRequest);
                                    {3549}in(c, (=GetEndpointResponse,=pkSess_3418,=SignAndEncrypt,SP_3419: bitstring,UP_3420: bitstring));
                                    {3550}new Nc_3421: bitstring;
                                    {3551}let m1_3422: bitstring = (OpenSecureChannelRequest,pkCli_3368,Nc_3421) in
                                    {3552}event beginCli(Cli,Sess,Nc_3421);
                                    {3553}out(c, (pkCli_3368,enc(m1_3422,pkSess_3418),sign(h(m1_3422),skCli_3367)));
                                    {3554}in(c, (em2_3423: bitstring,sigM2_3424: bitstring));
                                    {3555}let m2_3425: bitstring = dec(em2_3423,skCli_3367) in
                                    {3556}if (verify(h(m2_3425),sigM2_3424,pkSess_3418) <> true) then
                                        0
                                    else
                                        {3557}let (=OpenSecureChannelResponse,Ns_3426: bitstring,ST_3427: bitstring,TTL_3428: bitstring) = m2_3425 in
                                        {3558}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                        {3559}event endCli(Sess,Cli,Ns_3426)
                        )
                        else
                            {3560}let pkSess_3429: bitstring = fail-any in
                            {3561}out(c, GetEndpointRequest);
                            {3562}in(c, (=GetEndpointResponse,=pkSess_3429,=SignAndEncrypt,SP_3430: bitstring,UP_3431: bitstring));
                            {3563}new Nc_3432: bitstring;
                            {3564}let m1_3433: bitstring = (OpenSecureChannelRequest,pkCli_3368,Nc_3432) in
                            {3565}event beginCli(Cli,Sess,Nc_3432);
                            {3566}out(c, (pkCli_3368,enc(m1_3433,pkSess_3429),sign(h(m1_3433),skCli_3367)));
                            {3567}in(c, (em2_3434: bitstring,sigM2_3435: bitstring));
                            {3568}let m2_3436: bitstring = dec(em2_3434,skCli_3367) in
                            {3569}if (verify(h(m2_3436),sigM2_3435,pkSess_3429) <> true) then
                                0
                            else
                                {3570}let (=OpenSecureChannelResponse,Ns_3437: bitstring,ST_3438: bitstring,TTL_3439: bitstring) = m2_3436 in
                                {3571}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                {3572}event endCli(Sess,Cli,Ns_3437)
                )
                else
                    {3573}let pkSess_3440: bitstring = fail-any in
                    {3574}out(c, GetEndpointRequest);
                    {3575}in(c, (=GetEndpointResponse,=pkSess_3440,=SignAndEncrypt,SP_3441: bitstring,UP_3442: bitstring));
                    {3576}new Nc_3443: bitstring;
                    {3577}let m1_3444: bitstring = (OpenSecureChannelRequest,pkCli_3368,Nc_3443) in
                    {3578}event beginCli(Cli,Sess,Nc_3443);
                    {3579}out(c, (pkCli_3368,enc(m1_3444,pkSess_3440),sign(h(m1_3444),skCli_3367)));
                    {3580}in(c, (em2_3445: bitstring,sigM2_3446: bitstring));
                    {3581}let m2_3447: bitstring = dec(em2_3445,skCli_3367) in
                    {3582}if (verify(h(m2_3447),sigM2_3446,pkSess_3440) <> true) then
                        0
                    else
                        {3583}let (=OpenSecureChannelResponse,Ns_3448: bitstring,ST_3449: bitstring,TTL_3450: bitstring) = m2_3447 in
                        {3584}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                        {3585}event endCli(Sess,Cli,Ns_3448)
            )
            else
                {3586}let v_3451: bool = (Disco = B) in
                (
                    {3587}if v_3451 then
                    (
                        {3588}let pkDisco_3452: bitstring = pub(skB) in
                        {3589}let v_3453: bool = (Sess = A) in
                        (
                            {3590}if v_3453 then
                            (
                                {3591}let pkSess_3454: bitstring = pub(skA) in
                                {3592}out(c, GetEndpointRequest);
                                {3593}in(c, (=GetEndpointResponse,=pkSess_3454,=SignAndEncrypt,SP_3455: bitstring,UP_3456: bitstring));
                                {3594}new Nc_3457: bitstring;
                                {3595}let m1_3458: bitstring = (OpenSecureChannelRequest,pkCli_3368,Nc_3457) in
                                {3596}event beginCli(Cli,Sess,Nc_3457);
                                {3597}out(c, (pkCli_3368,enc(m1_3458,pkSess_3454),sign(h(m1_3458),skCli_3367)));
                                {3598}in(c, (em2_3459: bitstring,sigM2_3460: bitstring));
                                {3599}let m2_3461: bitstring = dec(em2_3459,skCli_3367) in
                                {3600}if (verify(h(m2_3461),sigM2_3460,pkSess_3454) <> true) then
                                    0
                                else
                                    {3601}let (=OpenSecureChannelResponse,Ns_3462: bitstring,ST_3463: bitstring,TTL_3464: bitstring) = m2_3461 in
                                    {3602}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                    {3603}event endCli(Sess,Cli,Ns_3462)
                            )
                            else
                                {3604}let v_3465: bool = (Sess = B) in
                                (
                                    {3605}if v_3465 then
                                    (
                                        {3606}let pkSess_3466: bitstring = pub(skB) in
                                        {3607}out(c, GetEndpointRequest);
                                        {3608}in(c, (=GetEndpointResponse,=pkSess_3466,=SignAndEncrypt,SP_3467: bitstring,UP_3468: bitstring));
                                        {3609}new Nc_3469: bitstring;
                                        {3610}let m1_3470: bitstring = (OpenSecureChannelRequest,pkCli_3368,Nc_3469) in
                                        {3611}event beginCli(Cli,Sess,Nc_3469);
                                        {3612}out(c, (pkCli_3368,enc(m1_3470,pkSess_3466),sign(h(m1_3470),skCli_3367)));
                                        {3613}in(c, (em2_3471: bitstring,sigM2_3472: bitstring));
                                        {3614}let m2_3473: bitstring = dec(em2_3471,skCli_3367) in
                                        {3615}if (verify(h(m2_3473),sigM2_3472,pkSess_3466) <> true) then
                                            0
                                        else
                                            {3616}let (=OpenSecureChannelResponse,Ns_3474: bitstring,ST_3475: bitstring,TTL_3476: bitstring) = m2_3473 in
                                            {3617}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {3618}event endCli(Sess,Cli,Ns_3474)
                                    )
                                    else
                                        {3619}let v_3477: bool = (Sess = C) in
                                        (
                                            {3620}if v_3477 then
                                            (
                                                {3621}let pkSess_3478: bitstring = pub(skC) in
                                                {3622}out(c, GetEndpointRequest);
                                                {3623}in(c, (=GetEndpointResponse,=pkSess_3478,=SignAndEncrypt,SP_3479: bitstring,UP_3480: bitstring));
                                                {3624}new Nc_3481: bitstring;
                                                {3625}let m1_3482: bitstring = (OpenSecureChannelRequest,pkCli_3368,Nc_3481) in
                                                {3626}event beginCli(Cli,Sess,Nc_3481);
                                                {3627}out(c, (pkCli_3368,enc(m1_3482,pkSess_3478),sign(h(m1_3482),skCli_3367)));
                                                {3628}in(c, (em2_3483: bitstring,sigM2_3484: bitstring));
                                                {3629}let m2_3485: bitstring = dec(em2_3483,skCli_3367) in
                                                {3630}if (verify(h(m2_3485),sigM2_3484,pkSess_3478) <> true) then
                                                    0
                                                else
                                                    {3631}let (=OpenSecureChannelResponse,Ns_3486: bitstring,ST_3487: bitstring,TTL_3488: bitstring) = m2_3485 in
                                                    {3632}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {3633}event endCli(Sess,Cli,Ns_3486)
                                            )
                                            else
                                                {3634}let pkSess_3489: bitstring = pub(sk(Sess)) in
                                                {3635}out(c, GetEndpointRequest);
                                                {3636}in(c, (=GetEndpointResponse,=pkSess_3489,=SignAndEncrypt,SP_3490: bitstring,UP_3491: bitstring));
                                                {3637}new Nc_3492: bitstring;
                                                {3638}let m1_3493: bitstring = (OpenSecureChannelRequest,pkCli_3368,Nc_3492) in
                                                {3639}event beginCli(Cli,Sess,Nc_3492);
                                                {3640}out(c, (pkCli_3368,enc(m1_3493,pkSess_3489),sign(h(m1_3493),skCli_3367)));
                                                {3641}in(c, (em2_3494: bitstring,sigM2_3495: bitstring));
                                                {3642}let m2_3496: bitstring = dec(em2_3494,skCli_3367) in
                                                {3643}if (verify(h(m2_3496),sigM2_3495,pkSess_3489) <> true) then
                                                    0
                                                else
                                                    {3644}let (=OpenSecureChannelResponse,Ns_3497: bitstring,ST_3498: bitstring,TTL_3499: bitstring) = m2_3496 in
                                                    {3645}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {3646}event endCli(Sess,Cli,Ns_3497)
                                        )
                                        else
                                            {3647}let pkSess_3500: bitstring = fail-any in
                                            {3648}out(c, GetEndpointRequest);
                                            {3649}in(c, (=GetEndpointResponse,=pkSess_3500,=SignAndEncrypt,SP_3501: bitstring,UP_3502: bitstring));
                                            {3650}new Nc_3503: bitstring;
                                            {3651}let m1_3504: bitstring = (OpenSecureChannelRequest,pkCli_3368,Nc_3503) in
                                            {3652}event beginCli(Cli,Sess,Nc_3503);
                                            {3653}out(c, (pkCli_3368,enc(m1_3504,pkSess_3500),sign(h(m1_3504),skCli_3367)));
                                            {3654}in(c, (em2_3505: bitstring,sigM2_3506: bitstring));
                                            {3655}let m2_3507: bitstring = dec(em2_3505,skCli_3367) in
                                            {3656}if (verify(h(m2_3507),sigM2_3506,pkSess_3500) <> true) then
                                                0
                                            else
                                                {3657}let (=OpenSecureChannelResponse,Ns_3508: bitstring,ST_3509: bitstring,TTL_3510: bitstring) = m2_3507 in
                                                {3658}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {3659}event endCli(Sess,Cli,Ns_3508)
                                )
                                else
                                    {3660}let pkSess_3511: bitstring = fail-any in
                                    {3661}out(c, GetEndpointRequest);
                                    {3662}in(c, (=GetEndpointResponse,=pkSess_3511,=SignAndEncrypt,SP_3512: bitstring,UP_3513: bitstring));
                                    {3663}new Nc_3514: bitstring;
                                    {3664}let m1_3515: bitstring = (OpenSecureChannelRequest,pkCli_3368,Nc_3514) in
                                    {3665}event beginCli(Cli,Sess,Nc_3514);
                                    {3666}out(c, (pkCli_3368,enc(m1_3515,pkSess_3511),sign(h(m1_3515),skCli_3367)));
                                    {3667}in(c, (em2_3516: bitstring,sigM2_3517: bitstring));
                                    {3668}let m2_3518: bitstring = dec(em2_3516,skCli_3367) in
                                    {3669}if (verify(h(m2_3518),sigM2_3517,pkSess_3511) <> true) then
                                        0
                                    else
                                        {3670}let (=OpenSecureChannelResponse,Ns_3519: bitstring,ST_3520: bitstring,TTL_3521: bitstring) = m2_3518 in
                                        {3671}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                        {3672}event endCli(Sess,Cli,Ns_3519)
                        )
                        else
                            {3673}let pkSess_3522: bitstring = fail-any in
                            {3674}out(c, GetEndpointRequest);
                            {3675}in(c, (=GetEndpointResponse,=pkSess_3522,=SignAndEncrypt,SP_3523: bitstring,UP_3524: bitstring));
                            {3676}new Nc_3525: bitstring;
                            {3677}let m1_3526: bitstring = (OpenSecureChannelRequest,pkCli_3368,Nc_3525) in
                            {3678}event beginCli(Cli,Sess,Nc_3525);
                            {3679}out(c, (pkCli_3368,enc(m1_3526,pkSess_3522),sign(h(m1_3526),skCli_3367)));
                            {3680}in(c, (em2_3527: bitstring,sigM2_3528: bitstring));
                            {3681}let m2_3529: bitstring = dec(em2_3527,skCli_3367) in
                            {3682}if (verify(h(m2_3529),sigM2_3528,pkSess_3522) <> true) then
                                0
                            else
                                {3683}let (=OpenSecureChannelResponse,Ns_3530: bitstring,ST_3531: bitstring,TTL_3532: bitstring) = m2_3529 in
                                {3684}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                {3685}event endCli(Sess,Cli,Ns_3530)
                    )
                    else
                        {3686}let v_3533: bool = (Disco = C) in
                        (
                            {3687}if v_3533 then
                            (
                                {3688}let pkDisco_3534: bitstring = pub(skC) in
                                {3689}let v_3535: bool = (Sess = A) in
                                (
                                    {3690}if v_3535 then
                                    (
                                        {3691}let pkSess_3536: bitstring = pub(skA) in
                                        {3692}out(c, GetEndpointRequest);
                                        {3693}in(c, (=GetEndpointResponse,=pkSess_3536,=SignAndEncrypt,SP_3537: bitstring,UP_3538: bitstring));
                                        {3694}new Nc_3539: bitstring;
                                        {3695}let m1_3540: bitstring = (OpenSecureChannelRequest,pkCli_3368,Nc_3539) in
                                        {3696}event beginCli(Cli,Sess,Nc_3539);
                                        {3697}out(c, (pkCli_3368,enc(m1_3540,pkSess_3536),sign(h(m1_3540),skCli_3367)));
                                        {3698}in(c, (em2_3541: bitstring,sigM2_3542: bitstring));
                                        {3699}let m2_3543: bitstring = dec(em2_3541,skCli_3367) in
                                        {3700}if (verify(h(m2_3543),sigM2_3542,pkSess_3536) <> true) then
                                            0
                                        else
                                            {3701}let (=OpenSecureChannelResponse,Ns_3544: bitstring,ST_3545: bitstring,TTL_3546: bitstring) = m2_3543 in
                                            {3702}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {3703}event endCli(Sess,Cli,Ns_3544)
                                    )
                                    else
                                        {3704}let v_3547: bool = (Sess = B) in
                                        (
                                            {3705}if v_3547 then
                                            (
                                                {3706}let pkSess_3548: bitstring = pub(skB) in
                                                {3707}out(c, GetEndpointRequest);
                                                {3708}in(c, (=GetEndpointResponse,=pkSess_3548,=SignAndEncrypt,SP_3549: bitstring,UP_3550: bitstring));
                                                {3709}new Nc_3551: bitstring;
                                                {3710}let m1_3552: bitstring = (OpenSecureChannelRequest,pkCli_3368,Nc_3551) in
                                                {3711}event beginCli(Cli,Sess,Nc_3551);
                                                {3712}out(c, (pkCli_3368,enc(m1_3552,pkSess_3548),sign(h(m1_3552),skCli_3367)));
                                                {3713}in(c, (em2_3553: bitstring,sigM2_3554: bitstring));
                                                {3714}let m2_3555: bitstring = dec(em2_3553,skCli_3367) in
                                                {3715}if (verify(h(m2_3555),sigM2_3554,pkSess_3548) <> true) then
                                                    0
                                                else
                                                    {3716}let (=OpenSecureChannelResponse,Ns_3556: bitstring,ST_3557: bitstring,TTL_3558: bitstring) = m2_3555 in
                                                    {3717}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {3718}event endCli(Sess,Cli,Ns_3556)
                                            )
                                            else
                                                {3719}let v_3559: bool = (Sess = C) in
                                                (
                                                    {3720}if v_3559 then
                                                    (
                                                        {3721}let pkSess_3560: bitstring = pub(skC) in
                                                        {3722}out(c, GetEndpointRequest);
                                                        {3723}in(c, (=GetEndpointResponse,=pkSess_3560,=SignAndEncrypt,SP_3561: bitstring,UP_3562: bitstring));
                                                        {3724}new Nc_3563: bitstring;
                                                        {3725}let m1_3564: bitstring = (OpenSecureChannelRequest,pkCli_3368,Nc_3563) in
                                                        {3726}event beginCli(Cli,Sess,Nc_3563);
                                                        {3727}out(c, (pkCli_3368,enc(m1_3564,pkSess_3560),sign(h(m1_3564),skCli_3367)));
                                                        {3728}in(c, (em2_3565: bitstring,sigM2_3566: bitstring));
                                                        {3729}let m2_3567: bitstring = dec(em2_3565,skCli_3367) in
                                                        {3730}if (verify(h(m2_3567),sigM2_3566,pkSess_3560) <> true) then
                                                            0
                                                        else
                                                            {3731}let (=OpenSecureChannelResponse,Ns_3568: bitstring,ST_3569: bitstring,TTL_3570: bitstring) = m2_3567 in
                                                            {3732}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                            {3733}event endCli(Sess,Cli,Ns_3568)
                                                    )
                                                    else
                                                        {3734}let pkSess_3571: bitstring = pub(sk(Sess)) in
                                                        {3735}out(c, GetEndpointRequest);
                                                        {3736}in(c, (=GetEndpointResponse,=pkSess_3571,=SignAndEncrypt,SP_3572: bitstring,UP_3573: bitstring));
                                                        {3737}new Nc_3574: bitstring;
                                                        {3738}let m1_3575: bitstring = (OpenSecureChannelRequest,pkCli_3368,Nc_3574) in
                                                        {3739}event beginCli(Cli,Sess,Nc_3574);
                                                        {3740}out(c, (pkCli_3368,enc(m1_3575,pkSess_3571),sign(h(m1_3575),skCli_3367)));
                                                        {3741}in(c, (em2_3576: bitstring,sigM2_3577: bitstring));
                                                        {3742}let m2_3578: bitstring = dec(em2_3576,skCli_3367) in
                                                        {3743}if (verify(h(m2_3578),sigM2_3577,pkSess_3571) <> true) then
                                                            0
                                                        else
                                                            {3744}let (=OpenSecureChannelResponse,Ns_3579: bitstring,ST_3580: bitstring,TTL_3581: bitstring) = m2_3578 in
                                                            {3745}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                            {3746}event endCli(Sess,Cli,Ns_3579)
                                                )
                                                else
                                                    {3747}let pkSess_3582: bitstring = fail-any in
                                                    {3748}out(c, GetEndpointRequest);
                                                    {3749}in(c, (=GetEndpointResponse,=pkSess_3582,=SignAndEncrypt,SP_3583: bitstring,UP_3584: bitstring));
                                                    {3750}new Nc_3585: bitstring;
                                                    {3751}let m1_3586: bitstring = (OpenSecureChannelRequest,pkCli_3368,Nc_3585) in
                                                    {3752}event beginCli(Cli,Sess,Nc_3585);
                                                    {3753}out(c, (pkCli_3368,enc(m1_3586,pkSess_3582),sign(h(m1_3586),skCli_3367)));
                                                    {3754}in(c, (em2_3587: bitstring,sigM2_3588: bitstring));
                                                    {3755}let m2_3589: bitstring = dec(em2_3587,skCli_3367) in
                                                    {3756}if (verify(h(m2_3589),sigM2_3588,pkSess_3582) <> true) then
                                                        0
                                                    else
                                                        {3757}let (=OpenSecureChannelResponse,Ns_3590: bitstring,ST_3591: bitstring,TTL_3592: bitstring) = m2_3589 in
                                                        {3758}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {3759}event endCli(Sess,Cli,Ns_3590)
                                        )
                                        else
                                            {3760}let pkSess_3593: bitstring = fail-any in
                                            {3761}out(c, GetEndpointRequest);
                                            {3762}in(c, (=GetEndpointResponse,=pkSess_3593,=SignAndEncrypt,SP_3594: bitstring,UP_3595: bitstring));
                                            {3763}new Nc_3596: bitstring;
                                            {3764}let m1_3597: bitstring = (OpenSecureChannelRequest,pkCli_3368,Nc_3596) in
                                            {3765}event beginCli(Cli,Sess,Nc_3596);
                                            {3766}out(c, (pkCli_3368,enc(m1_3597,pkSess_3593),sign(h(m1_3597),skCli_3367)));
                                            {3767}in(c, (em2_3598: bitstring,sigM2_3599: bitstring));
                                            {3768}let m2_3600: bitstring = dec(em2_3598,skCli_3367) in
                                            {3769}if (verify(h(m2_3600),sigM2_3599,pkSess_3593) <> true) then
                                                0
                                            else
                                                {3770}let (=OpenSecureChannelResponse,Ns_3601: bitstring,ST_3602: bitstring,TTL_3603: bitstring) = m2_3600 in
                                                {3771}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {3772}event endCli(Sess,Cli,Ns_3601)
                                )
                                else
                                    {3773}let pkSess_3604: bitstring = fail-any in
                                    {3774}out(c, GetEndpointRequest);
                                    {3775}in(c, (=GetEndpointResponse,=pkSess_3604,=SignAndEncrypt,SP_3605: bitstring,UP_3606: bitstring));
                                    {3776}new Nc_3607: bitstring;
                                    {3777}let m1_3608: bitstring = (OpenSecureChannelRequest,pkCli_3368,Nc_3607) in
                                    {3778}event beginCli(Cli,Sess,Nc_3607);
                                    {3779}out(c, (pkCli_3368,enc(m1_3608,pkSess_3604),sign(h(m1_3608),skCli_3367)));
                                    {3780}in(c, (em2_3609: bitstring,sigM2_3610: bitstring));
                                    {3781}let m2_3611: bitstring = dec(em2_3609,skCli_3367) in
                                    {3782}if (verify(h(m2_3611),sigM2_3610,pkSess_3604) <> true) then
                                        0
                                    else
                                        {3783}let (=OpenSecureChannelResponse,Ns_3612: bitstring,ST_3613: bitstring,TTL_3614: bitstring) = m2_3611 in
                                        {3784}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                        {3785}event endCli(Sess,Cli,Ns_3612)
                            )
                            else
                                {3786}let pkDisco_3615: bitstring = pub(sk(Disco)) in
                                {3787}let v_3616: bool = (Sess = A) in
                                (
                                    {3788}if v_3616 then
                                    (
                                        {3789}let pkSess_3617: bitstring = pub(skA) in
                                        {3790}out(c, GetEndpointRequest);
                                        {3791}in(c, (=GetEndpointResponse,=pkSess_3617,=SignAndEncrypt,SP_3618: bitstring,UP_3619: bitstring));
                                        {3792}new Nc_3620: bitstring;
                                        {3793}let m1_3621: bitstring = (OpenSecureChannelRequest,pkCli_3368,Nc_3620) in
                                        {3794}event beginCli(Cli,Sess,Nc_3620);
                                        {3795}out(c, (pkCli_3368,enc(m1_3621,pkSess_3617),sign(h(m1_3621),skCli_3367)));
                                        {3796}in(c, (em2_3622: bitstring,sigM2_3623: bitstring));
                                        {3797}let m2_3624: bitstring = dec(em2_3622,skCli_3367) in
                                        {3798}if (verify(h(m2_3624),sigM2_3623,pkSess_3617) <> true) then
                                            0
                                        else
                                            {3799}let (=OpenSecureChannelResponse,Ns_3625: bitstring,ST_3626: bitstring,TTL_3627: bitstring) = m2_3624 in
                                            {3800}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {3801}event endCli(Sess,Cli,Ns_3625)
                                    )
                                    else
                                        {3802}let v_3628: bool = (Sess = B) in
                                        (
                                            {3803}if v_3628 then
                                            (
                                                {3804}let pkSess_3629: bitstring = pub(skB) in
                                                {3805}out(c, GetEndpointRequest);
                                                {3806}in(c, (=GetEndpointResponse,=pkSess_3629,=SignAndEncrypt,SP_3630: bitstring,UP_3631: bitstring));
                                                {3807}new Nc_3632: bitstring;
                                                {3808}let m1_3633: bitstring = (OpenSecureChannelRequest,pkCli_3368,Nc_3632) in
                                                {3809}event beginCli(Cli,Sess,Nc_3632);
                                                {3810}out(c, (pkCli_3368,enc(m1_3633,pkSess_3629),sign(h(m1_3633),skCli_3367)));
                                                {3811}in(c, (em2_3634: bitstring,sigM2_3635: bitstring));
                                                {3812}let m2_3636: bitstring = dec(em2_3634,skCli_3367) in
                                                {3813}if (verify(h(m2_3636),sigM2_3635,pkSess_3629) <> true) then
                                                    0
                                                else
                                                    {3814}let (=OpenSecureChannelResponse,Ns_3637: bitstring,ST_3638: bitstring,TTL_3639: bitstring) = m2_3636 in
                                                    {3815}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {3816}event endCli(Sess,Cli,Ns_3637)
                                            )
                                            else
                                                {3817}let v_3640: bool = (Sess = C) in
                                                (
                                                    {3818}if v_3640 then
                                                    (
                                                        {3819}let pkSess_3641: bitstring = pub(skC) in
                                                        {3820}out(c, GetEndpointRequest);
                                                        {3821}in(c, (=GetEndpointResponse,=pkSess_3641,=SignAndEncrypt,SP_3642: bitstring,UP_3643: bitstring));
                                                        {3822}new Nc_3644: bitstring;
                                                        {3823}let m1_3645: bitstring = (OpenSecureChannelRequest,pkCli_3368,Nc_3644) in
                                                        {3824}event beginCli(Cli,Sess,Nc_3644);
                                                        {3825}out(c, (pkCli_3368,enc(m1_3645,pkSess_3641),sign(h(m1_3645),skCli_3367)));
                                                        {3826}in(c, (em2_3646: bitstring,sigM2_3647: bitstring));
                                                        {3827}let m2_3648: bitstring = dec(em2_3646,skCli_3367) in
                                                        {3828}if (verify(h(m2_3648),sigM2_3647,pkSess_3641) <> true) then
                                                            0
                                                        else
                                                            {3829}let (=OpenSecureChannelResponse,Ns_3649: bitstring,ST_3650: bitstring,TTL_3651: bitstring) = m2_3648 in
                                                            {3830}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                            {3831}event endCli(Sess,Cli,Ns_3649)
                                                    )
                                                    else
                                                        {3832}let pkSess_3652: bitstring = pub(sk(Sess)) in
                                                        {3833}out(c, GetEndpointRequest);
                                                        {3834}in(c, (=GetEndpointResponse,=pkSess_3652,=SignAndEncrypt,SP_3653: bitstring,UP_3654: bitstring));
                                                        {3835}new Nc_3655: bitstring;
                                                        {3836}let m1_3656: bitstring = (OpenSecureChannelRequest,pkCli_3368,Nc_3655) in
                                                        {3837}event beginCli(Cli,Sess,Nc_3655);
                                                        {3838}out(c, (pkCli_3368,enc(m1_3656,pkSess_3652),sign(h(m1_3656),skCli_3367)));
                                                        {3839}in(c, (em2_3657: bitstring,sigM2_3658: bitstring));
                                                        {3840}let m2_3659: bitstring = dec(em2_3657,skCli_3367) in
                                                        {3841}if (verify(h(m2_3659),sigM2_3658,pkSess_3652) <> true) then
                                                            0
                                                        else
                                                            {3842}let (=OpenSecureChannelResponse,Ns_3660: bitstring,ST_3661: bitstring,TTL_3662: bitstring) = m2_3659 in
                                                            {3843}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                            {3844}event endCli(Sess,Cli,Ns_3660)
                                                )
                                                else
                                                    {3845}let pkSess_3663: bitstring = fail-any in
                                                    {3846}out(c, GetEndpointRequest);
                                                    {3847}in(c, (=GetEndpointResponse,=pkSess_3663,=SignAndEncrypt,SP_3664: bitstring,UP_3665: bitstring));
                                                    {3848}new Nc_3666: bitstring;
                                                    {3849}let m1_3667: bitstring = (OpenSecureChannelRequest,pkCli_3368,Nc_3666) in
                                                    {3850}event beginCli(Cli,Sess,Nc_3666);
                                                    {3851}out(c, (pkCli_3368,enc(m1_3667,pkSess_3663),sign(h(m1_3667),skCli_3367)));
                                                    {3852}in(c, (em2_3668: bitstring,sigM2_3669: bitstring));
                                                    {3853}let m2_3670: bitstring = dec(em2_3668,skCli_3367) in
                                                    {3854}if (verify(h(m2_3670),sigM2_3669,pkSess_3663) <> true) then
                                                        0
                                                    else
                                                        {3855}let (=OpenSecureChannelResponse,Ns_3671: bitstring,ST_3672: bitstring,TTL_3673: bitstring) = m2_3670 in
                                                        {3856}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {3857}event endCli(Sess,Cli,Ns_3671)
                                        )
                                        else
                                            {3858}let pkSess_3674: bitstring = fail-any in
                                            {3859}out(c, GetEndpointRequest);
                                            {3860}in(c, (=GetEndpointResponse,=pkSess_3674,=SignAndEncrypt,SP_3675: bitstring,UP_3676: bitstring));
                                            {3861}new Nc_3677: bitstring;
                                            {3862}let m1_3678: bitstring = (OpenSecureChannelRequest,pkCli_3368,Nc_3677) in
                                            {3863}event beginCli(Cli,Sess,Nc_3677);
                                            {3864}out(c, (pkCli_3368,enc(m1_3678,pkSess_3674),sign(h(m1_3678),skCli_3367)));
                                            {3865}in(c, (em2_3679: bitstring,sigM2_3680: bitstring));
                                            {3866}let m2_3681: bitstring = dec(em2_3679,skCli_3367) in
                                            {3867}if (verify(h(m2_3681),sigM2_3680,pkSess_3674) <> true) then
                                                0
                                            else
                                                {3868}let (=OpenSecureChannelResponse,Ns_3682: bitstring,ST_3683: bitstring,TTL_3684: bitstring) = m2_3681 in
                                                {3869}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {3870}event endCli(Sess,Cli,Ns_3682)
                                )
                                else
                                    {3871}let pkSess_3685: bitstring = fail-any in
                                    {3872}out(c, GetEndpointRequest);
                                    {3873}in(c, (=GetEndpointResponse,=pkSess_3685,=SignAndEncrypt,SP_3686: bitstring,UP_3687: bitstring));
                                    {3874}new Nc_3688: bitstring;
                                    {3875}let m1_3689: bitstring = (OpenSecureChannelRequest,pkCli_3368,Nc_3688) in
                                    {3876}event beginCli(Cli,Sess,Nc_3688);
                                    {3877}out(c, (pkCli_3368,enc(m1_3689,pkSess_3685),sign(h(m1_3689),skCli_3367)));
                                    {3878}in(c, (em2_3690: bitstring,sigM2_3691: bitstring));
                                    {3879}let m2_3692: bitstring = dec(em2_3690,skCli_3367) in
                                    {3880}if (verify(h(m2_3692),sigM2_3691,pkSess_3685) <> true) then
                                        0
                                    else
                                        {3881}let (=OpenSecureChannelResponse,Ns_3693: bitstring,ST_3694: bitstring,TTL_3695: bitstring) = m2_3692 in
                                        {3882}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                        {3883}event endCli(Sess,Cli,Ns_3693)
                        )
                        else
                            {3884}let pkDisco_3696: bitstring = fail-any in
                            {3885}let v_3697: bool = (Sess = A) in
                            (
                                {3886}if v_3697 then
                                (
                                    {3887}let pkSess_3698: bitstring = pub(skA) in
                                    {3888}out(c, GetEndpointRequest);
                                    {3889}in(c, (=GetEndpointResponse,=pkSess_3698,=SignAndEncrypt,SP_3699: bitstring,UP_3700: bitstring));
                                    {3890}new Nc_3701: bitstring;
                                    {3891}let m1_3702: bitstring = (OpenSecureChannelRequest,pkCli_3368,Nc_3701) in
                                    {3892}event beginCli(Cli,Sess,Nc_3701);
                                    {3893}out(c, (pkCli_3368,enc(m1_3702,pkSess_3698),sign(h(m1_3702),skCli_3367)));
                                    {3894}in(c, (em2_3703: bitstring,sigM2_3704: bitstring));
                                    {3895}let m2_3705: bitstring = dec(em2_3703,skCli_3367) in
                                    {3896}if (verify(h(m2_3705),sigM2_3704,pkSess_3698) <> true) then
                                        0
                                    else
                                        {3897}let (=OpenSecureChannelResponse,Ns_3706: bitstring,ST_3707: bitstring,TTL_3708: bitstring) = m2_3705 in
                                        {3898}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                        {3899}event endCli(Sess,Cli,Ns_3706)
                                )
                                else
                                    {3900}let v_3709: bool = (Sess = B) in
                                    (
                                        {3901}if v_3709 then
                                        (
                                            {3902}let pkSess_3710: bitstring = pub(skB) in
                                            {3903}out(c, GetEndpointRequest);
                                            {3904}in(c, (=GetEndpointResponse,=pkSess_3710,=SignAndEncrypt,SP_3711: bitstring,UP_3712: bitstring));
                                            {3905}new Nc_3713: bitstring;
                                            {3906}let m1_3714: bitstring = (OpenSecureChannelRequest,pkCli_3368,Nc_3713) in
                                            {3907}event beginCli(Cli,Sess,Nc_3713);
                                            {3908}out(c, (pkCli_3368,enc(m1_3714,pkSess_3710),sign(h(m1_3714),skCli_3367)));
                                            {3909}in(c, (em2_3715: bitstring,sigM2_3716: bitstring));
                                            {3910}let m2_3717: bitstring = dec(em2_3715,skCli_3367) in
                                            {3911}if (verify(h(m2_3717),sigM2_3716,pkSess_3710) <> true) then
                                                0
                                            else
                                                {3912}let (=OpenSecureChannelResponse,Ns_3718: bitstring,ST_3719: bitstring,TTL_3720: bitstring) = m2_3717 in
                                                {3913}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {3914}event endCli(Sess,Cli,Ns_3718)
                                        )
                                        else
                                            {3915}let v_3721: bool = (Sess = C) in
                                            (
                                                {3916}if v_3721 then
                                                (
                                                    {3917}let pkSess_3722: bitstring = pub(skC) in
                                                    {3918}out(c, GetEndpointRequest);
                                                    {3919}in(c, (=GetEndpointResponse,=pkSess_3722,=SignAndEncrypt,SP_3723: bitstring,UP_3724: bitstring));
                                                    {3920}new Nc_3725: bitstring;
                                                    {3921}let m1_3726: bitstring = (OpenSecureChannelRequest,pkCli_3368,Nc_3725) in
                                                    {3922}event beginCli(Cli,Sess,Nc_3725);
                                                    {3923}out(c, (pkCli_3368,enc(m1_3726,pkSess_3722),sign(h(m1_3726),skCli_3367)));
                                                    {3924}in(c, (em2_3727: bitstring,sigM2_3728: bitstring));
                                                    {3925}let m2_3729: bitstring = dec(em2_3727,skCli_3367) in
                                                    {3926}if (verify(h(m2_3729),sigM2_3728,pkSess_3722) <> true) then
                                                        0
                                                    else
                                                        {3927}let (=OpenSecureChannelResponse,Ns_3730: bitstring,ST_3731: bitstring,TTL_3732: bitstring) = m2_3729 in
                                                        {3928}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {3929}event endCli(Sess,Cli,Ns_3730)
                                                )
                                                else
                                                    {3930}let pkSess_3733: bitstring = pub(sk(Sess)) in
                                                    {3931}out(c, GetEndpointRequest);
                                                    {3932}in(c, (=GetEndpointResponse,=pkSess_3733,=SignAndEncrypt,SP_3734: bitstring,UP_3735: bitstring));
                                                    {3933}new Nc_3736: bitstring;
                                                    {3934}let m1_3737: bitstring = (OpenSecureChannelRequest,pkCli_3368,Nc_3736) in
                                                    {3935}event beginCli(Cli,Sess,Nc_3736);
                                                    {3936}out(c, (pkCli_3368,enc(m1_3737,pkSess_3733),sign(h(m1_3737),skCli_3367)));
                                                    {3937}in(c, (em2_3738: bitstring,sigM2_3739: bitstring));
                                                    {3938}let m2_3740: bitstring = dec(em2_3738,skCli_3367) in
                                                    {3939}if (verify(h(m2_3740),sigM2_3739,pkSess_3733) <> true) then
                                                        0
                                                    else
                                                        {3940}let (=OpenSecureChannelResponse,Ns_3741: bitstring,ST_3742: bitstring,TTL_3743: bitstring) = m2_3740 in
                                                        {3941}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {3942}event endCli(Sess,Cli,Ns_3741)
                                            )
                                            else
                                                {3943}let pkSess_3744: bitstring = fail-any in
                                                {3944}out(c, GetEndpointRequest);
                                                {3945}in(c, (=GetEndpointResponse,=pkSess_3744,=SignAndEncrypt,SP_3745: bitstring,UP_3746: bitstring));
                                                {3946}new Nc_3747: bitstring;
                                                {3947}let m1_3748: bitstring = (OpenSecureChannelRequest,pkCli_3368,Nc_3747) in
                                                {3948}event beginCli(Cli,Sess,Nc_3747);
                                                {3949}out(c, (pkCli_3368,enc(m1_3748,pkSess_3744),sign(h(m1_3748),skCli_3367)));
                                                {3950}in(c, (em2_3749: bitstring,sigM2_3750: bitstring));
                                                {3951}let m2_3751: bitstring = dec(em2_3749,skCli_3367) in
                                                {3952}if (verify(h(m2_3751),sigM2_3750,pkSess_3744) <> true) then
                                                    0
                                                else
                                                    {3953}let (=OpenSecureChannelResponse,Ns_3752: bitstring,ST_3753: bitstring,TTL_3754: bitstring) = m2_3751 in
                                                    {3954}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {3955}event endCli(Sess,Cli,Ns_3752)
                                    )
                                    else
                                        {3956}let pkSess_3755: bitstring = fail-any in
                                        {3957}out(c, GetEndpointRequest);
                                        {3958}in(c, (=GetEndpointResponse,=pkSess_3755,=SignAndEncrypt,SP_3756: bitstring,UP_3757: bitstring));
                                        {3959}new Nc_3758: bitstring;
                                        {3960}let m1_3759: bitstring = (OpenSecureChannelRequest,pkCli_3368,Nc_3758) in
                                        {3961}event beginCli(Cli,Sess,Nc_3758);
                                        {3962}out(c, (pkCli_3368,enc(m1_3759,pkSess_3755),sign(h(m1_3759),skCli_3367)));
                                        {3963}in(c, (em2_3760: bitstring,sigM2_3761: bitstring));
                                        {3964}let m2_3762: bitstring = dec(em2_3760,skCli_3367) in
                                        {3965}if (verify(h(m2_3762),sigM2_3761,pkSess_3755) <> true) then
                                            0
                                        else
                                            {3966}let (=OpenSecureChannelResponse,Ns_3763: bitstring,ST_3764: bitstring,TTL_3765: bitstring) = m2_3762 in
                                            {3967}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {3968}event endCli(Sess,Cli,Ns_3763)
                            )
                            else
                                {3969}let pkSess_3766: bitstring = fail-any in
                                {3970}out(c, GetEndpointRequest);
                                {3971}in(c, (=GetEndpointResponse,=pkSess_3766,=SignAndEncrypt,SP_3767: bitstring,UP_3768: bitstring));
                                {3972}new Nc_3769: bitstring;
                                {3973}let m1_3770: bitstring = (OpenSecureChannelRequest,pkCli_3368,Nc_3769) in
                                {3974}event beginCli(Cli,Sess,Nc_3769);
                                {3975}out(c, (pkCli_3368,enc(m1_3770,pkSess_3766),sign(h(m1_3770),skCli_3367)));
                                {3976}in(c, (em2_3771: bitstring,sigM2_3772: bitstring));
                                {3977}let m2_3773: bitstring = dec(em2_3771,skCli_3367) in
                                {3978}if (verify(h(m2_3773),sigM2_3772,pkSess_3766) <> true) then
                                    0
                                else
                                    {3979}let (=OpenSecureChannelResponse,Ns_3774: bitstring,ST_3775: bitstring,TTL_3776: bitstring) = m2_3773 in
                                    {3980}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                    {3981}event endCli(Sess,Cli,Ns_3774)
                )
                else
                    {3982}let pkDisco_3777: bitstring = fail-any in
                    {3983}let v_3778: bool = (Sess = A) in
                    (
                        {3984}if v_3778 then
                        (
                            {3985}let pkSess_3779: bitstring = pub(skA) in
                            {3986}out(c, GetEndpointRequest);
                            {3987}in(c, (=GetEndpointResponse,=pkSess_3779,=SignAndEncrypt,SP_3780: bitstring,UP_3781: bitstring));
                            {3988}new Nc_3782: bitstring;
                            {3989}let m1_3783: bitstring = (OpenSecureChannelRequest,pkCli_3368,Nc_3782) in
                            {3990}event beginCli(Cli,Sess,Nc_3782);
                            {3991}out(c, (pkCli_3368,enc(m1_3783,pkSess_3779),sign(h(m1_3783),skCli_3367)));
                            {3992}in(c, (em2_3784: bitstring,sigM2_3785: bitstring));
                            {3993}let m2_3786: bitstring = dec(em2_3784,skCli_3367) in
                            {3994}if (verify(h(m2_3786),sigM2_3785,pkSess_3779) <> true) then
                                0
                            else
                                {3995}let (=OpenSecureChannelResponse,Ns_3787: bitstring,ST_3788: bitstring,TTL_3789: bitstring) = m2_3786 in
                                {3996}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                {3997}event endCli(Sess,Cli,Ns_3787)
                        )
                        else
                            {3998}let v_3790: bool = (Sess = B) in
                            (
                                {3999}if v_3790 then
                                (
                                    {4000}let pkSess_3791: bitstring = pub(skB) in
                                    {4001}out(c, GetEndpointRequest);
                                    {4002}in(c, (=GetEndpointResponse,=pkSess_3791,=SignAndEncrypt,SP_3792: bitstring,UP_3793: bitstring));
                                    {4003}new Nc_3794: bitstring;
                                    {4004}let m1_3795: bitstring = (OpenSecureChannelRequest,pkCli_3368,Nc_3794) in
                                    {4005}event beginCli(Cli,Sess,Nc_3794);
                                    {4006}out(c, (pkCli_3368,enc(m1_3795,pkSess_3791),sign(h(m1_3795),skCli_3367)));
                                    {4007}in(c, (em2_3796: bitstring,sigM2_3797: bitstring));
                                    {4008}let m2_3798: bitstring = dec(em2_3796,skCli_3367) in
                                    {4009}if (verify(h(m2_3798),sigM2_3797,pkSess_3791) <> true) then
                                        0
                                    else
                                        {4010}let (=OpenSecureChannelResponse,Ns_3799: bitstring,ST_3800: bitstring,TTL_3801: bitstring) = m2_3798 in
                                        {4011}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                        {4012}event endCli(Sess,Cli,Ns_3799)
                                )
                                else
                                    {4013}let v_3802: bool = (Sess = C) in
                                    (
                                        {4014}if v_3802 then
                                        (
                                            {4015}let pkSess_3803: bitstring = pub(skC) in
                                            {4016}out(c, GetEndpointRequest);
                                            {4017}in(c, (=GetEndpointResponse,=pkSess_3803,=SignAndEncrypt,SP_3804: bitstring,UP_3805: bitstring));
                                            {4018}new Nc_3806: bitstring;
                                            {4019}let m1_3807: bitstring = (OpenSecureChannelRequest,pkCli_3368,Nc_3806) in
                                            {4020}event beginCli(Cli,Sess,Nc_3806);
                                            {4021}out(c, (pkCli_3368,enc(m1_3807,pkSess_3803),sign(h(m1_3807),skCli_3367)));
                                            {4022}in(c, (em2_3808: bitstring,sigM2_3809: bitstring));
                                            {4023}let m2_3810: bitstring = dec(em2_3808,skCli_3367) in
                                            {4024}if (verify(h(m2_3810),sigM2_3809,pkSess_3803) <> true) then
                                                0
                                            else
                                                {4025}let (=OpenSecureChannelResponse,Ns_3811: bitstring,ST_3812: bitstring,TTL_3813: bitstring) = m2_3810 in
                                                {4026}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {4027}event endCli(Sess,Cli,Ns_3811)
                                        )
                                        else
                                            {4028}let pkSess_3814: bitstring = pub(sk(Sess)) in
                                            {4029}out(c, GetEndpointRequest);
                                            {4030}in(c, (=GetEndpointResponse,=pkSess_3814,=SignAndEncrypt,SP_3815: bitstring,UP_3816: bitstring));
                                            {4031}new Nc_3817: bitstring;
                                            {4032}let m1_3818: bitstring = (OpenSecureChannelRequest,pkCli_3368,Nc_3817) in
                                            {4033}event beginCli(Cli,Sess,Nc_3817);
                                            {4034}out(c, (pkCli_3368,enc(m1_3818,pkSess_3814),sign(h(m1_3818),skCli_3367)));
                                            {4035}in(c, (em2_3819: bitstring,sigM2_3820: bitstring));
                                            {4036}let m2_3821: bitstring = dec(em2_3819,skCli_3367) in
                                            {4037}if (verify(h(m2_3821),sigM2_3820,pkSess_3814) <> true) then
                                                0
                                            else
                                                {4038}let (=OpenSecureChannelResponse,Ns_3822: bitstring,ST_3823: bitstring,TTL_3824: bitstring) = m2_3821 in
                                                {4039}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {4040}event endCli(Sess,Cli,Ns_3822)
                                    )
                                    else
                                        {4041}let pkSess_3825: bitstring = fail-any in
                                        {4042}out(c, GetEndpointRequest);
                                        {4043}in(c, (=GetEndpointResponse,=pkSess_3825,=SignAndEncrypt,SP_3826: bitstring,UP_3827: bitstring));
                                        {4044}new Nc_3828: bitstring;
                                        {4045}let m1_3829: bitstring = (OpenSecureChannelRequest,pkCli_3368,Nc_3828) in
                                        {4046}event beginCli(Cli,Sess,Nc_3828);
                                        {4047}out(c, (pkCli_3368,enc(m1_3829,pkSess_3825),sign(h(m1_3829),skCli_3367)));
                                        {4048}in(c, (em2_3830: bitstring,sigM2_3831: bitstring));
                                        {4049}let m2_3832: bitstring = dec(em2_3830,skCli_3367) in
                                        {4050}if (verify(h(m2_3832),sigM2_3831,pkSess_3825) <> true) then
                                            0
                                        else
                                            {4051}let (=OpenSecureChannelResponse,Ns_3833: bitstring,ST_3834: bitstring,TTL_3835: bitstring) = m2_3832 in
                                            {4052}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {4053}event endCli(Sess,Cli,Ns_3833)
                            )
                            else
                                {4054}let pkSess_3836: bitstring = fail-any in
                                {4055}out(c, GetEndpointRequest);
                                {4056}in(c, (=GetEndpointResponse,=pkSess_3836,=SignAndEncrypt,SP_3837: bitstring,UP_3838: bitstring));
                                {4057}new Nc_3839: bitstring;
                                {4058}let m1_3840: bitstring = (OpenSecureChannelRequest,pkCli_3368,Nc_3839) in
                                {4059}event beginCli(Cli,Sess,Nc_3839);
                                {4060}out(c, (pkCli_3368,enc(m1_3840,pkSess_3836),sign(h(m1_3840),skCli_3367)));
                                {4061}in(c, (em2_3841: bitstring,sigM2_3842: bitstring));
                                {4062}let m2_3843: bitstring = dec(em2_3841,skCli_3367) in
                                {4063}if (verify(h(m2_3843),sigM2_3842,pkSess_3836) <> true) then
                                    0
                                else
                                    {4064}let (=OpenSecureChannelResponse,Ns_3844: bitstring,ST_3845: bitstring,TTL_3846: bitstring) = m2_3843 in
                                    {4065}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                    {4066}event endCli(Sess,Cli,Ns_3844)
                    )
                    else
                        {4067}let pkSess_3847: bitstring = fail-any in
                        {4068}out(c, GetEndpointRequest);
                        {4069}in(c, (=GetEndpointResponse,=pkSess_3847,=SignAndEncrypt,SP_3848: bitstring,UP_3849: bitstring));
                        {4070}new Nc_3850: bitstring;
                        {4071}let m1_3851: bitstring = (OpenSecureChannelRequest,pkCli_3368,Nc_3850) in
                        {4072}event beginCli(Cli,Sess,Nc_3850);
                        {4073}out(c, (pkCli_3368,enc(m1_3851,pkSess_3847),sign(h(m1_3851),skCli_3367)));
                        {4074}in(c, (em2_3852: bitstring,sigM2_3853: bitstring));
                        {4075}let m2_3854: bitstring = dec(em2_3852,skCli_3367) in
                        {4076}if (verify(h(m2_3854),sigM2_3853,pkSess_3847) <> true) then
                            0
                        else
                            {4077}let (=OpenSecureChannelResponse,Ns_3855: bitstring,ST_3856: bitstring,TTL_3857: bitstring) = m2_3854 in
                            {4078}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                            {4079}event endCli(Sess,Cli,Ns_3855)
        )
        else
            {4080}let pkDisco_3858: bitstring = fail-any in
            {4081}let v_3859: bool = (Sess = A) in
            (
                {4082}if v_3859 then
                (
                    {4083}let pkSess_3860: bitstring = pub(skA) in
                    {4084}out(c, GetEndpointRequest);
                    {4085}in(c, (=GetEndpointResponse,=pkSess_3860,=SignAndEncrypt,SP_3861: bitstring,UP_3862: bitstring));
                    {4086}new Nc_3863: bitstring;
                    {4087}let m1_3864: bitstring = (OpenSecureChannelRequest,pkCli_3368,Nc_3863) in
                    {4088}event beginCli(Cli,Sess,Nc_3863);
                    {4089}out(c, (pkCli_3368,enc(m1_3864,pkSess_3860),sign(h(m1_3864),skCli_3367)));
                    {4090}in(c, (em2_3865: bitstring,sigM2_3866: bitstring));
                    {4091}let m2_3867: bitstring = dec(em2_3865,skCli_3367) in
                    {4092}if (verify(h(m2_3867),sigM2_3866,pkSess_3860) <> true) then
                        0
                    else
                        {4093}let (=OpenSecureChannelResponse,Ns_3868: bitstring,ST_3869: bitstring,TTL_3870: bitstring) = m2_3867 in
                        {4094}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                        {4095}event endCli(Sess,Cli,Ns_3868)
                )
                else
                    {4096}let v_3871: bool = (Sess = B) in
                    (
                        {4097}if v_3871 then
                        (
                            {4098}let pkSess_3872: bitstring = pub(skB) in
                            {4099}out(c, GetEndpointRequest);
                            {4100}in(c, (=GetEndpointResponse,=pkSess_3872,=SignAndEncrypt,SP_3873: bitstring,UP_3874: bitstring));
                            {4101}new Nc_3875: bitstring;
                            {4102}let m1_3876: bitstring = (OpenSecureChannelRequest,pkCli_3368,Nc_3875) in
                            {4103}event beginCli(Cli,Sess,Nc_3875);
                            {4104}out(c, (pkCli_3368,enc(m1_3876,pkSess_3872),sign(h(m1_3876),skCli_3367)));
                            {4105}in(c, (em2_3877: bitstring,sigM2_3878: bitstring));
                            {4106}let m2_3879: bitstring = dec(em2_3877,skCli_3367) in
                            {4107}if (verify(h(m2_3879),sigM2_3878,pkSess_3872) <> true) then
                                0
                            else
                                {4108}let (=OpenSecureChannelResponse,Ns_3880: bitstring,ST_3881: bitstring,TTL_3882: bitstring) = m2_3879 in
                                {4109}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                {4110}event endCli(Sess,Cli,Ns_3880)
                        )
                        else
                            {4111}let v_3883: bool = (Sess = C) in
                            (
                                {4112}if v_3883 then
                                (
                                    {4113}let pkSess_3884: bitstring = pub(skC) in
                                    {4114}out(c, GetEndpointRequest);
                                    {4115}in(c, (=GetEndpointResponse,=pkSess_3884,=SignAndEncrypt,SP_3885: bitstring,UP_3886: bitstring));
                                    {4116}new Nc_3887: bitstring;
                                    {4117}let m1_3888: bitstring = (OpenSecureChannelRequest,pkCli_3368,Nc_3887) in
                                    {4118}event beginCli(Cli,Sess,Nc_3887);
                                    {4119}out(c, (pkCli_3368,enc(m1_3888,pkSess_3884),sign(h(m1_3888),skCli_3367)));
                                    {4120}in(c, (em2_3889: bitstring,sigM2_3890: bitstring));
                                    {4121}let m2_3891: bitstring = dec(em2_3889,skCli_3367) in
                                    {4122}if (verify(h(m2_3891),sigM2_3890,pkSess_3884) <> true) then
                                        0
                                    else
                                        {4123}let (=OpenSecureChannelResponse,Ns_3892: bitstring,ST_3893: bitstring,TTL_3894: bitstring) = m2_3891 in
                                        {4124}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                        {4125}event endCli(Sess,Cli,Ns_3892)
                                )
                                else
                                    {4126}let pkSess_3895: bitstring = pub(sk(Sess)) in
                                    {4127}out(c, GetEndpointRequest);
                                    {4128}in(c, (=GetEndpointResponse,=pkSess_3895,=SignAndEncrypt,SP_3896: bitstring,UP_3897: bitstring));
                                    {4129}new Nc_3898: bitstring;
                                    {4130}let m1_3899: bitstring = (OpenSecureChannelRequest,pkCli_3368,Nc_3898) in
                                    {4131}event beginCli(Cli,Sess,Nc_3898);
                                    {4132}out(c, (pkCli_3368,enc(m1_3899,pkSess_3895),sign(h(m1_3899),skCli_3367)));
                                    {4133}in(c, (em2_3900: bitstring,sigM2_3901: bitstring));
                                    {4134}let m2_3902: bitstring = dec(em2_3900,skCli_3367) in
                                    {4135}if (verify(h(m2_3902),sigM2_3901,pkSess_3895) <> true) then
                                        0
                                    else
                                        {4136}let (=OpenSecureChannelResponse,Ns_3903: bitstring,ST_3904: bitstring,TTL_3905: bitstring) = m2_3902 in
                                        {4137}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                        {4138}event endCli(Sess,Cli,Ns_3903)
                            )
                            else
                                {4139}let pkSess_3906: bitstring = fail-any in
                                {4140}out(c, GetEndpointRequest);
                                {4141}in(c, (=GetEndpointResponse,=pkSess_3906,=SignAndEncrypt,SP_3907: bitstring,UP_3908: bitstring));
                                {4142}new Nc_3909: bitstring;
                                {4143}let m1_3910: bitstring = (OpenSecureChannelRequest,pkCli_3368,Nc_3909) in
                                {4144}event beginCli(Cli,Sess,Nc_3909);
                                {4145}out(c, (pkCli_3368,enc(m1_3910,pkSess_3906),sign(h(m1_3910),skCli_3367)));
                                {4146}in(c, (em2_3911: bitstring,sigM2_3912: bitstring));
                                {4147}let m2_3913: bitstring = dec(em2_3911,skCli_3367) in
                                {4148}if (verify(h(m2_3913),sigM2_3912,pkSess_3906) <> true) then
                                    0
                                else
                                    {4149}let (=OpenSecureChannelResponse,Ns_3914: bitstring,ST_3915: bitstring,TTL_3916: bitstring) = m2_3913 in
                                    {4150}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                    {4151}event endCli(Sess,Cli,Ns_3914)
                    )
                    else
                        {4152}let pkSess_3917: bitstring = fail-any in
                        {4153}out(c, GetEndpointRequest);
                        {4154}in(c, (=GetEndpointResponse,=pkSess_3917,=SignAndEncrypt,SP_3918: bitstring,UP_3919: bitstring));
                        {4155}new Nc_3920: bitstring;
                        {4156}let m1_3921: bitstring = (OpenSecureChannelRequest,pkCli_3368,Nc_3920) in
                        {4157}event beginCli(Cli,Sess,Nc_3920);
                        {4158}out(c, (pkCli_3368,enc(m1_3921,pkSess_3917),sign(h(m1_3921),skCli_3367)));
                        {4159}in(c, (em2_3922: bitstring,sigM2_3923: bitstring));
                        {4160}let m2_3924: bitstring = dec(em2_3922,skCli_3367) in
                        {4161}if (verify(h(m2_3924),sigM2_3923,pkSess_3917) <> true) then
                            0
                        else
                            {4162}let (=OpenSecureChannelResponse,Ns_3925: bitstring,ST_3926: bitstring,TTL_3927: bitstring) = m2_3924 in
                            {4163}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                            {4164}event endCli(Sess,Cli,Ns_3925)
            )
            else
                {4165}let pkSess_3928: bitstring = fail-any in
                {4166}out(c, GetEndpointRequest);
                {4167}in(c, (=GetEndpointResponse,=pkSess_3928,=SignAndEncrypt,SP_3929: bitstring,UP_3930: bitstring));
                {4168}new Nc_3931: bitstring;
                {4169}let m1_3932: bitstring = (OpenSecureChannelRequest,pkCli_3368,Nc_3931) in
                {4170}event beginCli(Cli,Sess,Nc_3931);
                {4171}out(c, (pkCli_3368,enc(m1_3932,pkSess_3928),sign(h(m1_3932),skCli_3367)));
                {4172}in(c, (em2_3933: bitstring,sigM2_3934: bitstring));
                {4173}let m2_3935: bitstring = dec(em2_3933,skCli_3367) in
                {4174}if (verify(h(m2_3935),sigM2_3934,pkSess_3928) <> true) then
                    0
                else
                    {4175}let (=OpenSecureChannelResponse,Ns_3936: bitstring,ST_3937: bitstring,TTL_3938: bitstring) = m2_3935 in
                    {4176}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                    {4177}event endCli(Sess,Cli,Ns_3936)
) | (
    {4178}!
    {4179}in(c, (Cli_3939: host,Disco_3940: host,Sess_3941: host));
    {4180}let v_3942: bool = (Disco_3940 = A) in
    (
        {4181}if v_3942 then
        (
            {4182}let skDisco: bitstring = skA in
            {4183}let pkDisco_3943: bitstring = pub(skDisco) in
            {4184}let v_3944: bool = (Cli_3939 = A) in
            (
                {4185}if v_3944 then
                (
                    {4186}let pkCli_3945: bitstring = pub(skA) in
                    {4187}let v_3946: bool = (Sess_3941 = A) in
                    (
                        {4188}if v_3946 then
                        (
                            {4189}let pkSess_3947: bitstring = pub(skA) in
                            {4190}in(c, =GetEndpointRequest);
                            {4191}new SP_3948: bitstring;
                            {4192}new UP_3949: bitstring;
                            {4193}out(c, (GetEndpointResponse,pkSess_3947,SignAndEncrypt,SP_3948,UP_3949))
                        )
                        else
                            {4194}let v_3950: bool = (Sess_3941 = B) in
                            (
                                {4195}if v_3950 then
                                (
                                    {4196}let pkSess_3951: bitstring = pub(skB) in
                                    {4197}in(c, =GetEndpointRequest);
                                    {4198}new SP_3952: bitstring;
                                    {4199}new UP_3953: bitstring;
                                    {4200}out(c, (GetEndpointResponse,pkSess_3951,SignAndEncrypt,SP_3952,UP_3953))
                                )
                                else
                                    {4201}let v_3954: bool = (Sess_3941 = C) in
                                    (
                                        {4202}if v_3954 then
                                        (
                                            {4203}let pkSess_3955: bitstring = pub(skC) in
                                            {4204}in(c, =GetEndpointRequest);
                                            {4205}new SP_3956: bitstring;
                                            {4206}new UP_3957: bitstring;
                                            {4207}out(c, (GetEndpointResponse,pkSess_3955,SignAndEncrypt,SP_3956,UP_3957))
                                        )
                                        else
                                            {4208}let pkSess_3958: bitstring = pub(sk(Sess_3941)) in
                                            {4209}in(c, =GetEndpointRequest);
                                            {4210}new SP_3959: bitstring;
                                            {4211}new UP_3960: bitstring;
                                            {4212}out(c, (GetEndpointResponse,pkSess_3958,SignAndEncrypt,SP_3959,UP_3960))
                                    )
                                    else
                                        {4213}let pkSess_3961: bitstring = fail-any in
                                        {4214}in(c, =GetEndpointRequest);
                                        {4215}new SP_3962: bitstring;
                                        {4216}new UP_3963: bitstring;
                                        {4217}out(c, (GetEndpointResponse,pkSess_3961,SignAndEncrypt,SP_3962,UP_3963))
                            )
                            else
                                {4218}let pkSess_3964: bitstring = fail-any in
                                {4219}in(c, =GetEndpointRequest);
                                {4220}new SP_3965: bitstring;
                                {4221}new UP_3966: bitstring;
                                {4222}out(c, (GetEndpointResponse,pkSess_3964,SignAndEncrypt,SP_3965,UP_3966))
                    )
                    else
                        {4223}let pkSess_3967: bitstring = fail-any in
                        {4224}in(c, =GetEndpointRequest);
                        {4225}new SP_3968: bitstring;
                        {4226}new UP_3969: bitstring;
                        {4227}out(c, (GetEndpointResponse,pkSess_3967,SignAndEncrypt,SP_3968,UP_3969))
                )
                else
                    {4228}let v_3970: bool = (Cli_3939 = B) in
                    (
                        {4229}if v_3970 then
                        (
                            {4230}let pkCli_3971: bitstring = pub(skB) in
                            {4231}let v_3972: bool = (Sess_3941 = A) in
                            (
                                {4232}if v_3972 then
                                (
                                    {4233}let pkSess_3973: bitstring = pub(skA) in
                                    {4234}in(c, =GetEndpointRequest);
                                    {4235}new SP_3974: bitstring;
                                    {4236}new UP_3975: bitstring;
                                    {4237}out(c, (GetEndpointResponse,pkSess_3973,SignAndEncrypt,SP_3974,UP_3975))
                                )
                                else
                                    {4238}let v_3976: bool = (Sess_3941 = B) in
                                    (
                                        {4239}if v_3976 then
                                        (
                                            {4240}let pkSess_3977: bitstring = pub(skB) in
                                            {4241}in(c, =GetEndpointRequest);
                                            {4242}new SP_3978: bitstring;
                                            {4243}new UP_3979: bitstring;
                                            {4244}out(c, (GetEndpointResponse,pkSess_3977,SignAndEncrypt,SP_3978,UP_3979))
                                        )
                                        else
                                            {4245}let v_3980: bool = (Sess_3941 = C) in
                                            (
                                                {4246}if v_3980 then
                                                (
                                                    {4247}let pkSess_3981: bitstring = pub(skC) in
                                                    {4248}in(c, =GetEndpointRequest);
                                                    {4249}new SP_3982: bitstring;
                                                    {4250}new UP_3983: bitstring;
                                                    {4251}out(c, (GetEndpointResponse,pkSess_3981,SignAndEncrypt,SP_3982,UP_3983))
                                                )
                                                else
                                                    {4252}let pkSess_3984: bitstring = pub(sk(Sess_3941)) in
                                                    {4253}in(c, =GetEndpointRequest);
                                                    {4254}new SP_3985: bitstring;
                                                    {4255}new UP_3986: bitstring;
                                                    {4256}out(c, (GetEndpointResponse,pkSess_3984,SignAndEncrypt,SP_3985,UP_3986))
                                            )
                                            else
                                                {4257}let pkSess_3987: bitstring = fail-any in
                                                {4258}in(c, =GetEndpointRequest);
                                                {4259}new SP_3988: bitstring;
                                                {4260}new UP_3989: bitstring;
                                                {4261}out(c, (GetEndpointResponse,pkSess_3987,SignAndEncrypt,SP_3988,UP_3989))
                                    )
                                    else
                                        {4262}let pkSess_3990: bitstring = fail-any in
                                        {4263}in(c, =GetEndpointRequest);
                                        {4264}new SP_3991: bitstring;
                                        {4265}new UP_3992: bitstring;
                                        {4266}out(c, (GetEndpointResponse,pkSess_3990,SignAndEncrypt,SP_3991,UP_3992))
                            )
                            else
                                {4267}let pkSess_3993: bitstring = fail-any in
                                {4268}in(c, =GetEndpointRequest);
                                {4269}new SP_3994: bitstring;
                                {4270}new UP_3995: bitstring;
                                {4271}out(c, (GetEndpointResponse,pkSess_3993,SignAndEncrypt,SP_3994,UP_3995))
                        )
                        else
                            {4272}let v_3996: bool = (Cli_3939 = C) in
                            (
                                {4273}if v_3996 then
                                (
                                    {4274}let pkCli_3997: bitstring = pub(skC) in
                                    {4275}let v_3998: bool = (Sess_3941 = A) in
                                    (
                                        {4276}if v_3998 then
                                        (
                                            {4277}let pkSess_3999: bitstring = pub(skA) in
                                            {4278}in(c, =GetEndpointRequest);
                                            {4279}new SP_4000: bitstring;
                                            {4280}new UP_4001: bitstring;
                                            {4281}out(c, (GetEndpointResponse,pkSess_3999,SignAndEncrypt,SP_4000,UP_4001))
                                        )
                                        else
                                            {4282}let v_4002: bool = (Sess_3941 = B) in
                                            (
                                                {4283}if v_4002 then
                                                (
                                                    {4284}let pkSess_4003: bitstring = pub(skB) in
                                                    {4285}in(c, =GetEndpointRequest);
                                                    {4286}new SP_4004: bitstring;
                                                    {4287}new UP_4005: bitstring;
                                                    {4288}out(c, (GetEndpointResponse,pkSess_4003,SignAndEncrypt,SP_4004,UP_4005))
                                                )
                                                else
                                                    {4289}let v_4006: bool = (Sess_3941 = C) in
                                                    (
                                                        {4290}if v_4006 then
                                                        (
                                                            {4291}let pkSess_4007: bitstring = pub(skC) in
                                                            {4292}in(c, =GetEndpointRequest);
                                                            {4293}new SP_4008: bitstring;
                                                            {4294}new UP_4009: bitstring;
                                                            {4295}out(c, (GetEndpointResponse,pkSess_4007,SignAndEncrypt,SP_4008,UP_4009))
                                                        )
                                                        else
                                                            {4296}let pkSess_4010: bitstring = pub(sk(Sess_3941)) in
                                                            {4297}in(c, =GetEndpointRequest);
                                                            {4298}new SP_4011: bitstring;
                                                            {4299}new UP_4012: bitstring;
                                                            {4300}out(c, (GetEndpointResponse,pkSess_4010,SignAndEncrypt,SP_4011,UP_4012))
                                                    )
                                                    else
                                                        {4301}let pkSess_4013: bitstring = fail-any in
                                                        {4302}in(c, =GetEndpointRequest);
                                                        {4303}new SP_4014: bitstring;
                                                        {4304}new UP_4015: bitstring;
                                                        {4305}out(c, (GetEndpointResponse,pkSess_4013,SignAndEncrypt,SP_4014,UP_4015))
                                            )
                                            else
                                                {4306}let pkSess_4016: bitstring = fail-any in
                                                {4307}in(c, =GetEndpointRequest);
                                                {4308}new SP_4017: bitstring;
                                                {4309}new UP_4018: bitstring;
                                                {4310}out(c, (GetEndpointResponse,pkSess_4016,SignAndEncrypt,SP_4017,UP_4018))
                                    )
                                    else
                                        {4311}let pkSess_4019: bitstring = fail-any in
                                        {4312}in(c, =GetEndpointRequest);
                                        {4313}new SP_4020: bitstring;
                                        {4314}new UP_4021: bitstring;
                                        {4315}out(c, (GetEndpointResponse,pkSess_4019,SignAndEncrypt,SP_4020,UP_4021))
                                )
                                else
                                    {4316}let pkCli_4022: bitstring = pub(sk(Cli_3939)) in
                                    {4317}let v_4023: bool = (Sess_3941 = A) in
                                    (
                                        {4318}if v_4023 then
                                        (
                                            {4319}let pkSess_4024: bitstring = pub(skA) in
                                            {4320}in(c, =GetEndpointRequest);
                                            {4321}new SP_4025: bitstring;
                                            {4322}new UP_4026: bitstring;
                                            {4323}out(c, (GetEndpointResponse,pkSess_4024,SignAndEncrypt,SP_4025,UP_4026))
                                        )
                                        else
                                            {4324}let v_4027: bool = (Sess_3941 = B) in
                                            (
                                                {4325}if v_4027 then
                                                (
                                                    {4326}let pkSess_4028: bitstring = pub(skB) in
                                                    {4327}in(c, =GetEndpointRequest);
                                                    {4328}new SP_4029: bitstring;
                                                    {4329}new UP_4030: bitstring;
                                                    {4330}out(c, (GetEndpointResponse,pkSess_4028,SignAndEncrypt,SP_4029,UP_4030))
                                                )
                                                else
                                                    {4331}let v_4031: bool = (Sess_3941 = C) in
                                                    (
                                                        {4332}if v_4031 then
                                                        (
                                                            {4333}let pkSess_4032: bitstring = pub(skC) in
                                                            {4334}in(c, =GetEndpointRequest);
                                                            {4335}new SP_4033: bitstring;
                                                            {4336}new UP_4034: bitstring;
                                                            {4337}out(c, (GetEndpointResponse,pkSess_4032,SignAndEncrypt,SP_4033,UP_4034))
                                                        )
                                                        else
                                                            {4338}let pkSess_4035: bitstring = pub(sk(Sess_3941)) in
                                                            {4339}in(c, =GetEndpointRequest);
                                                            {4340}new SP_4036: bitstring;
                                                            {4341}new UP_4037: bitstring;
                                                            {4342}out(c, (GetEndpointResponse,pkSess_4035,SignAndEncrypt,SP_4036,UP_4037))
                                                    )
                                                    else
                                                        {4343}let pkSess_4038: bitstring = fail-any in
                                                        {4344}in(c, =GetEndpointRequest);
                                                        {4345}new SP_4039: bitstring;
                                                        {4346}new UP_4040: bitstring;
                                                        {4347}out(c, (GetEndpointResponse,pkSess_4038,SignAndEncrypt,SP_4039,UP_4040))
                                            )
                                            else
                                                {4348}let pkSess_4041: bitstring = fail-any in
                                                {4349}in(c, =GetEndpointRequest);
                                                {4350}new SP_4042: bitstring;
                                                {4351}new UP_4043: bitstring;
                                                {4352}out(c, (GetEndpointResponse,pkSess_4041,SignAndEncrypt,SP_4042,UP_4043))
                                    )
                                    else
                                        {4353}let pkSess_4044: bitstring = fail-any in
                                        {4354}in(c, =GetEndpointRequest);
                                        {4355}new SP_4045: bitstring;
                                        {4356}new UP_4046: bitstring;
                                        {4357}out(c, (GetEndpointResponse,pkSess_4044,SignAndEncrypt,SP_4045,UP_4046))
                            )
                            else
                                {4358}let pkCli_4047: bitstring = fail-any in
                                {4359}let v_4048: bool = (Sess_3941 = A) in
                                (
                                    {4360}if v_4048 then
                                    (
                                        {4361}let pkSess_4049: bitstring = pub(skA) in
                                        {4362}in(c, =GetEndpointRequest);
                                        {4363}new SP_4050: bitstring;
                                        {4364}new UP_4051: bitstring;
                                        {4365}out(c, (GetEndpointResponse,pkSess_4049,SignAndEncrypt,SP_4050,UP_4051))
                                    )
                                    else
                                        {4366}let v_4052: bool = (Sess_3941 = B) in
                                        (
                                            {4367}if v_4052 then
                                            (
                                                {4368}let pkSess_4053: bitstring = pub(skB) in
                                                {4369}in(c, =GetEndpointRequest);
                                                {4370}new SP_4054: bitstring;
                                                {4371}new UP_4055: bitstring;
                                                {4372}out(c, (GetEndpointResponse,pkSess_4053,SignAndEncrypt,SP_4054,UP_4055))
                                            )
                                            else
                                                {4373}let v_4056: bool = (Sess_3941 = C) in
                                                (
                                                    {4374}if v_4056 then
                                                    (
                                                        {4375}let pkSess_4057: bitstring = pub(skC) in
                                                        {4376}in(c, =GetEndpointRequest);
                                                        {4377}new SP_4058: bitstring;
                                                        {4378}new UP_4059: bitstring;
                                                        {4379}out(c, (GetEndpointResponse,pkSess_4057,SignAndEncrypt,SP_4058,UP_4059))
                                                    )
                                                    else
                                                        {4380}let pkSess_4060: bitstring = pub(sk(Sess_3941)) in
                                                        {4381}in(c, =GetEndpointRequest);
                                                        {4382}new SP_4061: bitstring;
                                                        {4383}new UP_4062: bitstring;
                                                        {4384}out(c, (GetEndpointResponse,pkSess_4060,SignAndEncrypt,SP_4061,UP_4062))
                                                )
                                                else
                                                    {4385}let pkSess_4063: bitstring = fail-any in
                                                    {4386}in(c, =GetEndpointRequest);
                                                    {4387}new SP_4064: bitstring;
                                                    {4388}new UP_4065: bitstring;
                                                    {4389}out(c, (GetEndpointResponse,pkSess_4063,SignAndEncrypt,SP_4064,UP_4065))
                                        )
                                        else
                                            {4390}let pkSess_4066: bitstring = fail-any in
                                            {4391}in(c, =GetEndpointRequest);
                                            {4392}new SP_4067: bitstring;
                                            {4393}new UP_4068: bitstring;
                                            {4394}out(c, (GetEndpointResponse,pkSess_4066,SignAndEncrypt,SP_4067,UP_4068))
                                )
                                else
                                    {4395}let pkSess_4069: bitstring = fail-any in
                                    {4396}in(c, =GetEndpointRequest);
                                    {4397}new SP_4070: bitstring;
                                    {4398}new UP_4071: bitstring;
                                    {4399}out(c, (GetEndpointResponse,pkSess_4069,SignAndEncrypt,SP_4070,UP_4071))
                    )
                    else
                        {4400}let pkCli_4072: bitstring = fail-any in
                        {4401}let v_4073: bool = (Sess_3941 = A) in
                        (
                            {4402}if v_4073 then
                            (
                                {4403}let pkSess_4074: bitstring = pub(skA) in
                                {4404}in(c, =GetEndpointRequest);
                                {4405}new SP_4075: bitstring;
                                {4406}new UP_4076: bitstring;
                                {4407}out(c, (GetEndpointResponse,pkSess_4074,SignAndEncrypt,SP_4075,UP_4076))
                            )
                            else
                                {4408}let v_4077: bool = (Sess_3941 = B) in
                                (
                                    {4409}if v_4077 then
                                    (
                                        {4410}let pkSess_4078: bitstring = pub(skB) in
                                        {4411}in(c, =GetEndpointRequest);
                                        {4412}new SP_4079: bitstring;
                                        {4413}new UP_4080: bitstring;
                                        {4414}out(c, (GetEndpointResponse,pkSess_4078,SignAndEncrypt,SP_4079,UP_4080))
                                    )
                                    else
                                        {4415}let v_4081: bool = (Sess_3941 = C) in
                                        (
                                            {4416}if v_4081 then
                                            (
                                                {4417}let pkSess_4082: bitstring = pub(skC) in
                                                {4418}in(c, =GetEndpointRequest);
                                                {4419}new SP_4083: bitstring;
                                                {4420}new UP_4084: bitstring;
                                                {4421}out(c, (GetEndpointResponse,pkSess_4082,SignAndEncrypt,SP_4083,UP_4084))
                                            )
                                            else
                                                {4422}let pkSess_4085: bitstring = pub(sk(Sess_3941)) in
                                                {4423}in(c, =GetEndpointRequest);
                                                {4424}new SP_4086: bitstring;
                                                {4425}new UP_4087: bitstring;
                                                {4426}out(c, (GetEndpointResponse,pkSess_4085,SignAndEncrypt,SP_4086,UP_4087))
                                        )
                                        else
                                            {4427}let pkSess_4088: bitstring = fail-any in
                                            {4428}in(c, =GetEndpointRequest);
                                            {4429}new SP_4089: bitstring;
                                            {4430}new UP_4090: bitstring;
                                            {4431}out(c, (GetEndpointResponse,pkSess_4088,SignAndEncrypt,SP_4089,UP_4090))
                                )
                                else
                                    {4432}let pkSess_4091: bitstring = fail-any in
                                    {4433}in(c, =GetEndpointRequest);
                                    {4434}new SP_4092: bitstring;
                                    {4435}new UP_4093: bitstring;
                                    {4436}out(c, (GetEndpointResponse,pkSess_4091,SignAndEncrypt,SP_4092,UP_4093))
                        )
                        else
                            {4437}let pkSess_4094: bitstring = fail-any in
                            {4438}in(c, =GetEndpointRequest);
                            {4439}new SP_4095: bitstring;
                            {4440}new UP_4096: bitstring;
                            {4441}out(c, (GetEndpointResponse,pkSess_4094,SignAndEncrypt,SP_4095,UP_4096))
            )
            else
                {4442}let pkCli_4097: bitstring = fail-any in
                {4443}let v_4098: bool = (Sess_3941 = A) in
                (
                    {4444}if v_4098 then
                    (
                        {4445}let pkSess_4099: bitstring = pub(skA) in
                        {4446}in(c, =GetEndpointRequest);
                        {4447}new SP_4100: bitstring;
                        {4448}new UP_4101: bitstring;
                        {4449}out(c, (GetEndpointResponse,pkSess_4099,SignAndEncrypt,SP_4100,UP_4101))
                    )
                    else
                        {4450}let v_4102: bool = (Sess_3941 = B) in
                        (
                            {4451}if v_4102 then
                            (
                                {4452}let pkSess_4103: bitstring = pub(skB) in
                                {4453}in(c, =GetEndpointRequest);
                                {4454}new SP_4104: bitstring;
                                {4455}new UP_4105: bitstring;
                                {4456}out(c, (GetEndpointResponse,pkSess_4103,SignAndEncrypt,SP_4104,UP_4105))
                            )
                            else
                                {4457}let v_4106: bool = (Sess_3941 = C) in
                                (
                                    {4458}if v_4106 then
                                    (
                                        {4459}let pkSess_4107: bitstring = pub(skC) in
                                        {4460}in(c, =GetEndpointRequest);
                                        {4461}new SP_4108: bitstring;
                                        {4462}new UP_4109: bitstring;
                                        {4463}out(c, (GetEndpointResponse,pkSess_4107,SignAndEncrypt,SP_4108,UP_4109))
                                    )
                                    else
                                        {4464}let pkSess_4110: bitstring = pub(sk(Sess_3941)) in
                                        {4465}in(c, =GetEndpointRequest);
                                        {4466}new SP_4111: bitstring;
                                        {4467}new UP_4112: bitstring;
                                        {4468}out(c, (GetEndpointResponse,pkSess_4110,SignAndEncrypt,SP_4111,UP_4112))
                                )
                                else
                                    {4469}let pkSess_4113: bitstring = fail-any in
                                    {4470}in(c, =GetEndpointRequest);
                                    {4471}new SP_4114: bitstring;
                                    {4472}new UP_4115: bitstring;
                                    {4473}out(c, (GetEndpointResponse,pkSess_4113,SignAndEncrypt,SP_4114,UP_4115))
                        )
                        else
                            {4474}let pkSess_4116: bitstring = fail-any in
                            {4475}in(c, =GetEndpointRequest);
                            {4476}new SP_4117: bitstring;
                            {4477}new UP_4118: bitstring;
                            {4478}out(c, (GetEndpointResponse,pkSess_4116,SignAndEncrypt,SP_4117,UP_4118))
                )
                else
                    {4479}let pkSess_4119: bitstring = fail-any in
                    {4480}in(c, =GetEndpointRequest);
                    {4481}new SP_4120: bitstring;
                    {4482}new UP_4121: bitstring;
                    {4483}out(c, (GetEndpointResponse,pkSess_4119,SignAndEncrypt,SP_4120,UP_4121))
        )
        else
            {4484}let v_4122: bool = (Disco_3940 = B) in
            (
                {4485}if v_4122 then
                (
                    {4486}let skDisco_4123: bitstring = skB in
                    {4487}let pkDisco_4124: bitstring = pub(skDisco_4123) in
                    {4488}let v_4125: bool = (Cli_3939 = A) in
                    (
                        {4489}if v_4125 then
                        (
                            {4490}let pkCli_4126: bitstring = pub(skA) in
                            {4491}let v_4127: bool = (Sess_3941 = A) in
                            (
                                {4492}if v_4127 then
                                (
                                    {4493}let pkSess_4128: bitstring = pub(skA) in
                                    {4494}in(c, =GetEndpointRequest);
                                    {4495}new SP_4129: bitstring;
                                    {4496}new UP_4130: bitstring;
                                    {4497}out(c, (GetEndpointResponse,pkSess_4128,SignAndEncrypt,SP_4129,UP_4130))
                                )
                                else
                                    {4498}let v_4131: bool = (Sess_3941 = B) in
                                    (
                                        {4499}if v_4131 then
                                        (
                                            {4500}let pkSess_4132: bitstring = pub(skB) in
                                            {4501}in(c, =GetEndpointRequest);
                                            {4502}new SP_4133: bitstring;
                                            {4503}new UP_4134: bitstring;
                                            {4504}out(c, (GetEndpointResponse,pkSess_4132,SignAndEncrypt,SP_4133,UP_4134))
                                        )
                                        else
                                            {4505}let v_4135: bool = (Sess_3941 = C) in
                                            (
                                                {4506}if v_4135 then
                                                (
                                                    {4507}let pkSess_4136: bitstring = pub(skC) in
                                                    {4508}in(c, =GetEndpointRequest);
                                                    {4509}new SP_4137: bitstring;
                                                    {4510}new UP_4138: bitstring;
                                                    {4511}out(c, (GetEndpointResponse,pkSess_4136,SignAndEncrypt,SP_4137,UP_4138))
                                                )
                                                else
                                                    {4512}let pkSess_4139: bitstring = pub(sk(Sess_3941)) in
                                                    {4513}in(c, =GetEndpointRequest);
                                                    {4514}new SP_4140: bitstring;
                                                    {4515}new UP_4141: bitstring;
                                                    {4516}out(c, (GetEndpointResponse,pkSess_4139,SignAndEncrypt,SP_4140,UP_4141))
                                            )
                                            else
                                                {4517}let pkSess_4142: bitstring = fail-any in
                                                {4518}in(c, =GetEndpointRequest);
                                                {4519}new SP_4143: bitstring;
                                                {4520}new UP_4144: bitstring;
                                                {4521}out(c, (GetEndpointResponse,pkSess_4142,SignAndEncrypt,SP_4143,UP_4144))
                                    )
                                    else
                                        {4522}let pkSess_4145: bitstring = fail-any in
                                        {4523}in(c, =GetEndpointRequest);
                                        {4524}new SP_4146: bitstring;
                                        {4525}new UP_4147: bitstring;
                                        {4526}out(c, (GetEndpointResponse,pkSess_4145,SignAndEncrypt,SP_4146,UP_4147))
                            )
                            else
                                {4527}let pkSess_4148: bitstring = fail-any in
                                {4528}in(c, =GetEndpointRequest);
                                {4529}new SP_4149: bitstring;
                                {4530}new UP_4150: bitstring;
                                {4531}out(c, (GetEndpointResponse,pkSess_4148,SignAndEncrypt,SP_4149,UP_4150))
                        )
                        else
                            {4532}let v_4151: bool = (Cli_3939 = B) in
                            (
                                {4533}if v_4151 then
                                (
                                    {4534}let pkCli_4152: bitstring = pub(skB) in
                                    {4535}let v_4153: bool = (Sess_3941 = A) in
                                    (
                                        {4536}if v_4153 then
                                        (
                                            {4537}let pkSess_4154: bitstring = pub(skA) in
                                            {4538}in(c, =GetEndpointRequest);
                                            {4539}new SP_4155: bitstring;
                                            {4540}new UP_4156: bitstring;
                                            {4541}out(c, (GetEndpointResponse,pkSess_4154,SignAndEncrypt,SP_4155,UP_4156))
                                        )
                                        else
                                            {4542}let v_4157: bool = (Sess_3941 = B) in
                                            (
                                                {4543}if v_4157 then
                                                (
                                                    {4544}let pkSess_4158: bitstring = pub(skB) in
                                                    {4545}in(c, =GetEndpointRequest);
                                                    {4546}new SP_4159: bitstring;
                                                    {4547}new UP_4160: bitstring;
                                                    {4548}out(c, (GetEndpointResponse,pkSess_4158,SignAndEncrypt,SP_4159,UP_4160))
                                                )
                                                else
                                                    {4549}let v_4161: bool = (Sess_3941 = C) in
                                                    (
                                                        {4550}if v_4161 then
                                                        (
                                                            {4551}let pkSess_4162: bitstring = pub(skC) in
                                                            {4552}in(c, =GetEndpointRequest);
                                                            {4553}new SP_4163: bitstring;
                                                            {4554}new UP_4164: bitstring;
                                                            {4555}out(c, (GetEndpointResponse,pkSess_4162,SignAndEncrypt,SP_4163,UP_4164))
                                                        )
                                                        else
                                                            {4556}let pkSess_4165: bitstring = pub(sk(Sess_3941)) in
                                                            {4557}in(c, =GetEndpointRequest);
                                                            {4558}new SP_4166: bitstring;
                                                            {4559}new UP_4167: bitstring;
                                                            {4560}out(c, (GetEndpointResponse,pkSess_4165,SignAndEncrypt,SP_4166,UP_4167))
                                                    )
                                                    else
                                                        {4561}let pkSess_4168: bitstring = fail-any in
                                                        {4562}in(c, =GetEndpointRequest);
                                                        {4563}new SP_4169: bitstring;
                                                        {4564}new UP_4170: bitstring;
                                                        {4565}out(c, (GetEndpointResponse,pkSess_4168,SignAndEncrypt,SP_4169,UP_4170))
                                            )
                                            else
                                                {4566}let pkSess_4171: bitstring = fail-any in
                                                {4567}in(c, =GetEndpointRequest);
                                                {4568}new SP_4172: bitstring;
                                                {4569}new UP_4173: bitstring;
                                                {4570}out(c, (GetEndpointResponse,pkSess_4171,SignAndEncrypt,SP_4172,UP_4173))
                                    )
                                    else
                                        {4571}let pkSess_4174: bitstring = fail-any in
                                        {4572}in(c, =GetEndpointRequest);
                                        {4573}new SP_4175: bitstring;
                                        {4574}new UP_4176: bitstring;
                                        {4575}out(c, (GetEndpointResponse,pkSess_4174,SignAndEncrypt,SP_4175,UP_4176))
                                )
                                else
                                    {4576}let v_4177: bool = (Cli_3939 = C) in
                                    (
                                        {4577}if v_4177 then
                                        (
                                            {4578}let pkCli_4178: bitstring = pub(skC) in
                                            {4579}let v_4179: bool = (Sess_3941 = A) in
                                            (
                                                {4580}if v_4179 then
                                                (
                                                    {4581}let pkSess_4180: bitstring = pub(skA) in
                                                    {4582}in(c, =GetEndpointRequest);
                                                    {4583}new SP_4181: bitstring;
                                                    {4584}new UP_4182: bitstring;
                                                    {4585}out(c, (GetEndpointResponse,pkSess_4180,SignAndEncrypt,SP_4181,UP_4182))
                                                )
                                                else
                                                    {4586}let v_4183: bool = (Sess_3941 = B) in
                                                    (
                                                        {4587}if v_4183 then
                                                        (
                                                            {4588}let pkSess_4184: bitstring = pub(skB) in
                                                            {4589}in(c, =GetEndpointRequest);
                                                            {4590}new SP_4185: bitstring;
                                                            {4591}new UP_4186: bitstring;
                                                            {4592}out(c, (GetEndpointResponse,pkSess_4184,SignAndEncrypt,SP_4185,UP_4186))
                                                        )
                                                        else
                                                            {4593}let v_4187: bool = (Sess_3941 = C) in
                                                            (
                                                                {4594}if v_4187 then
                                                                (
                                                                    {4595}let pkSess_4188: bitstring = pub(skC) in
                                                                    {4596}in(c, =GetEndpointRequest);
                                                                    {4597}new SP_4189: bitstring;
                                                                    {4598}new UP_4190: bitstring;
                                                                    {4599}out(c, (GetEndpointResponse,pkSess_4188,SignAndEncrypt,SP_4189,UP_4190))
                                                                )
                                                                else
                                                                    {4600}let pkSess_4191: bitstring = pub(sk(Sess_3941)) in
                                                                    {4601}in(c, =GetEndpointRequest);
                                                                    {4602}new SP_4192: bitstring;
                                                                    {4603}new UP_4193: bitstring;
                                                                    {4604}out(c, (GetEndpointResponse,pkSess_4191,SignAndEncrypt,SP_4192,UP_4193))
                                                            )
                                                            else
                                                                {4605}let pkSess_4194: bitstring = fail-any in
                                                                {4606}in(c, =GetEndpointRequest);
                                                                {4607}new SP_4195: bitstring;
                                                                {4608}new UP_4196: bitstring;
                                                                {4609}out(c, (GetEndpointResponse,pkSess_4194,SignAndEncrypt,SP_4195,UP_4196))
                                                    )
                                                    else
                                                        {4610}let pkSess_4197: bitstring = fail-any in
                                                        {4611}in(c, =GetEndpointRequest);
                                                        {4612}new SP_4198: bitstring;
                                                        {4613}new UP_4199: bitstring;
                                                        {4614}out(c, (GetEndpointResponse,pkSess_4197,SignAndEncrypt,SP_4198,UP_4199))
                                            )
                                            else
                                                {4615}let pkSess_4200: bitstring = fail-any in
                                                {4616}in(c, =GetEndpointRequest);
                                                {4617}new SP_4201: bitstring;
                                                {4618}new UP_4202: bitstring;
                                                {4619}out(c, (GetEndpointResponse,pkSess_4200,SignAndEncrypt,SP_4201,UP_4202))
                                        )
                                        else
                                            {4620}let pkCli_4203: bitstring = pub(sk(Cli_3939)) in
                                            {4621}let v_4204: bool = (Sess_3941 = A) in
                                            (
                                                {4622}if v_4204 then
                                                (
                                                    {4623}let pkSess_4205: bitstring = pub(skA) in
                                                    {4624}in(c, =GetEndpointRequest);
                                                    {4625}new SP_4206: bitstring;
                                                    {4626}new UP_4207: bitstring;
                                                    {4627}out(c, (GetEndpointResponse,pkSess_4205,SignAndEncrypt,SP_4206,UP_4207))
                                                )
                                                else
                                                    {4628}let v_4208: bool = (Sess_3941 = B) in
                                                    (
                                                        {4629}if v_4208 then
                                                        (
                                                            {4630}let pkSess_4209: bitstring = pub(skB) in
                                                            {4631}in(c, =GetEndpointRequest);
                                                            {4632}new SP_4210: bitstring;
                                                            {4633}new UP_4211: bitstring;
                                                            {4634}out(c, (GetEndpointResponse,pkSess_4209,SignAndEncrypt,SP_4210,UP_4211))
                                                        )
                                                        else
                                                            {4635}let v_4212: bool = (Sess_3941 = C) in
                                                            (
                                                                {4636}if v_4212 then
                                                                (
                                                                    {4637}let pkSess_4213: bitstring = pub(skC) in
                                                                    {4638}in(c, =GetEndpointRequest);
                                                                    {4639}new SP_4214: bitstring;
                                                                    {4640}new UP_4215: bitstring;
                                                                    {4641}out(c, (GetEndpointResponse,pkSess_4213,SignAndEncrypt,SP_4214,UP_4215))
                                                                )
                                                                else
                                                                    {4642}let pkSess_4216: bitstring = pub(sk(Sess_3941)) in
                                                                    {4643}in(c, =GetEndpointRequest);
                                                                    {4644}new SP_4217: bitstring;
                                                                    {4645}new UP_4218: bitstring;
                                                                    {4646}out(c, (GetEndpointResponse,pkSess_4216,SignAndEncrypt,SP_4217,UP_4218))
                                                            )
                                                            else
                                                                {4647}let pkSess_4219: bitstring = fail-any in
                                                                {4648}in(c, =GetEndpointRequest);
                                                                {4649}new SP_4220: bitstring;
                                                                {4650}new UP_4221: bitstring;
                                                                {4651}out(c, (GetEndpointResponse,pkSess_4219,SignAndEncrypt,SP_4220,UP_4221))
                                                    )
                                                    else
                                                        {4652}let pkSess_4222: bitstring = fail-any in
                                                        {4653}in(c, =GetEndpointRequest);
                                                        {4654}new SP_4223: bitstring;
                                                        {4655}new UP_4224: bitstring;
                                                        {4656}out(c, (GetEndpointResponse,pkSess_4222,SignAndEncrypt,SP_4223,UP_4224))
                                            )
                                            else
                                                {4657}let pkSess_4225: bitstring = fail-any in
                                                {4658}in(c, =GetEndpointRequest);
                                                {4659}new SP_4226: bitstring;
                                                {4660}new UP_4227: bitstring;
                                                {4661}out(c, (GetEndpointResponse,pkSess_4225,SignAndEncrypt,SP_4226,UP_4227))
                                    )
                                    else
                                        {4662}let pkCli_4228: bitstring = fail-any in
                                        {4663}let v_4229: bool = (Sess_3941 = A) in
                                        (
                                            {4664}if v_4229 then
                                            (
                                                {4665}let pkSess_4230: bitstring = pub(skA) in
                                                {4666}in(c, =GetEndpointRequest);
                                                {4667}new SP_4231: bitstring;
                                                {4668}new UP_4232: bitstring;
                                                {4669}out(c, (GetEndpointResponse,pkSess_4230,SignAndEncrypt,SP_4231,UP_4232))
                                            )
                                            else
                                                {4670}let v_4233: bool = (Sess_3941 = B) in
                                                (
                                                    {4671}if v_4233 then
                                                    (
                                                        {4672}let pkSess_4234: bitstring = pub(skB) in
                                                        {4673}in(c, =GetEndpointRequest);
                                                        {4674}new SP_4235: bitstring;
                                                        {4675}new UP_4236: bitstring;
                                                        {4676}out(c, (GetEndpointResponse,pkSess_4234,SignAndEncrypt,SP_4235,UP_4236))
                                                    )
                                                    else
                                                        {4677}let v_4237: bool = (Sess_3941 = C) in
                                                        (
                                                            {4678}if v_4237 then
                                                            (
                                                                {4679}let pkSess_4238: bitstring = pub(skC) in
                                                                {4680}in(c, =GetEndpointRequest);
                                                                {4681}new SP_4239: bitstring;
                                                                {4682}new UP_4240: bitstring;
                                                                {4683}out(c, (GetEndpointResponse,pkSess_4238,SignAndEncrypt,SP_4239,UP_4240))
                                                            )
                                                            else
                                                                {4684}let pkSess_4241: bitstring = pub(sk(Sess_3941)) in
                                                                {4685}in(c, =GetEndpointRequest);
                                                                {4686}new SP_4242: bitstring;
                                                                {4687}new UP_4243: bitstring;
                                                                {4688}out(c, (GetEndpointResponse,pkSess_4241,SignAndEncrypt,SP_4242,UP_4243))
                                                        )
                                                        else
                                                            {4689}let pkSess_4244: bitstring = fail-any in
                                                            {4690}in(c, =GetEndpointRequest);
                                                            {4691}new SP_4245: bitstring;
                                                            {4692}new UP_4246: bitstring;
                                                            {4693}out(c, (GetEndpointResponse,pkSess_4244,SignAndEncrypt,SP_4245,UP_4246))
                                                )
                                                else
                                                    {4694}let pkSess_4247: bitstring = fail-any in
                                                    {4695}in(c, =GetEndpointRequest);
                                                    {4696}new SP_4248: bitstring;
                                                    {4697}new UP_4249: bitstring;
                                                    {4698}out(c, (GetEndpointResponse,pkSess_4247,SignAndEncrypt,SP_4248,UP_4249))
                                        )
                                        else
                                            {4699}let pkSess_4250: bitstring = fail-any in
                                            {4700}in(c, =GetEndpointRequest);
                                            {4701}new SP_4251: bitstring;
                                            {4702}new UP_4252: bitstring;
                                            {4703}out(c, (GetEndpointResponse,pkSess_4250,SignAndEncrypt,SP_4251,UP_4252))
                            )
                            else
                                {4704}let pkCli_4253: bitstring = fail-any in
                                {4705}let v_4254: bool = (Sess_3941 = A) in
                                (
                                    {4706}if v_4254 then
                                    (
                                        {4707}let pkSess_4255: bitstring = pub(skA) in
                                        {4708}in(c, =GetEndpointRequest);
                                        {4709}new SP_4256: bitstring;
                                        {4710}new UP_4257: bitstring;
                                        {4711}out(c, (GetEndpointResponse,pkSess_4255,SignAndEncrypt,SP_4256,UP_4257))
                                    )
                                    else
                                        {4712}let v_4258: bool = (Sess_3941 = B) in
                                        (
                                            {4713}if v_4258 then
                                            (
                                                {4714}let pkSess_4259: bitstring = pub(skB) in
                                                {4715}in(c, =GetEndpointRequest);
                                                {4716}new SP_4260: bitstring;
                                                {4717}new UP_4261: bitstring;
                                                {4718}out(c, (GetEndpointResponse,pkSess_4259,SignAndEncrypt,SP_4260,UP_4261))
                                            )
                                            else
                                                {4719}let v_4262: bool = (Sess_3941 = C) in
                                                (
                                                    {4720}if v_4262 then
                                                    (
                                                        {4721}let pkSess_4263: bitstring = pub(skC) in
                                                        {4722}in(c, =GetEndpointRequest);
                                                        {4723}new SP_4264: bitstring;
                                                        {4724}new UP_4265: bitstring;
                                                        {4725}out(c, (GetEndpointResponse,pkSess_4263,SignAndEncrypt,SP_4264,UP_4265))
                                                    )
                                                    else
                                                        {4726}let pkSess_4266: bitstring = pub(sk(Sess_3941)) in
                                                        {4727}in(c, =GetEndpointRequest);
                                                        {4728}new SP_4267: bitstring;
                                                        {4729}new UP_4268: bitstring;
                                                        {4730}out(c, (GetEndpointResponse,pkSess_4266,SignAndEncrypt,SP_4267,UP_4268))
                                                )
                                                else
                                                    {4731}let pkSess_4269: bitstring = fail-any in
                                                    {4732}in(c, =GetEndpointRequest);
                                                    {4733}new SP_4270: bitstring;
                                                    {4734}new UP_4271: bitstring;
                                                    {4735}out(c, (GetEndpointResponse,pkSess_4269,SignAndEncrypt,SP_4270,UP_4271))
                                        )
                                        else
                                            {4736}let pkSess_4272: bitstring = fail-any in
                                            {4737}in(c, =GetEndpointRequest);
                                            {4738}new SP_4273: bitstring;
                                            {4739}new UP_4274: bitstring;
                                            {4740}out(c, (GetEndpointResponse,pkSess_4272,SignAndEncrypt,SP_4273,UP_4274))
                                )
                                else
                                    {4741}let pkSess_4275: bitstring = fail-any in
                                    {4742}in(c, =GetEndpointRequest);
                                    {4743}new SP_4276: bitstring;
                                    {4744}new UP_4277: bitstring;
                                    {4745}out(c, (GetEndpointResponse,pkSess_4275,SignAndEncrypt,SP_4276,UP_4277))
                    )
                    else
                        {4746}let pkCli_4278: bitstring = fail-any in
                        {4747}let v_4279: bool = (Sess_3941 = A) in
                        (
                            {4748}if v_4279 then
                            (
                                {4749}let pkSess_4280: bitstring = pub(skA) in
                                {4750}in(c, =GetEndpointRequest);
                                {4751}new SP_4281: bitstring;
                                {4752}new UP_4282: bitstring;
                                {4753}out(c, (GetEndpointResponse,pkSess_4280,SignAndEncrypt,SP_4281,UP_4282))
                            )
                            else
                                {4754}let v_4283: bool = (Sess_3941 = B) in
                                (
                                    {4755}if v_4283 then
                                    (
                                        {4756}let pkSess_4284: bitstring = pub(skB) in
                                        {4757}in(c, =GetEndpointRequest);
                                        {4758}new SP_4285: bitstring;
                                        {4759}new UP_4286: bitstring;
                                        {4760}out(c, (GetEndpointResponse,pkSess_4284,SignAndEncrypt,SP_4285,UP_4286))
                                    )
                                    else
                                        {4761}let v_4287: bool = (Sess_3941 = C) in
                                        (
                                            {4762}if v_4287 then
                                            (
                                                {4763}let pkSess_4288: bitstring = pub(skC) in
                                                {4764}in(c, =GetEndpointRequest);
                                                {4765}new SP_4289: bitstring;
                                                {4766}new UP_4290: bitstring;
                                                {4767}out(c, (GetEndpointResponse,pkSess_4288,SignAndEncrypt,SP_4289,UP_4290))
                                            )
                                            else
                                                {4768}let pkSess_4291: bitstring = pub(sk(Sess_3941)) in
                                                {4769}in(c, =GetEndpointRequest);
                                                {4770}new SP_4292: bitstring;
                                                {4771}new UP_4293: bitstring;
                                                {4772}out(c, (GetEndpointResponse,pkSess_4291,SignAndEncrypt,SP_4292,UP_4293))
                                        )
                                        else
                                            {4773}let pkSess_4294: bitstring = fail-any in
                                            {4774}in(c, =GetEndpointRequest);
                                            {4775}new SP_4295: bitstring;
                                            {4776}new UP_4296: bitstring;
                                            {4777}out(c, (GetEndpointResponse,pkSess_4294,SignAndEncrypt,SP_4295,UP_4296))
                                )
                                else
                                    {4778}let pkSess_4297: bitstring = fail-any in
                                    {4779}in(c, =GetEndpointRequest);
                                    {4780}new SP_4298: bitstring;
                                    {4781}new UP_4299: bitstring;
                                    {4782}out(c, (GetEndpointResponse,pkSess_4297,SignAndEncrypt,SP_4298,UP_4299))
                        )
                        else
                            {4783}let pkSess_4300: bitstring = fail-any in
                            {4784}in(c, =GetEndpointRequest);
                            {4785}new SP_4301: bitstring;
                            {4786}new UP_4302: bitstring;
                            {4787}out(c, (GetEndpointResponse,pkSess_4300,SignAndEncrypt,SP_4301,UP_4302))
                )
                else
                    {4788}let =true = (Disco_3940 = C) in
                    (
                        {4789}let skDisco_4303: bitstring = skC in
                        {4790}let pkDisco_4304: bitstring = pub(skDisco_4303) in
                        {4791}let v_4305: bool = (Cli_3939 = A) in
                        (
                            {4792}if v_4305 then
                            (
                                {4793}let pkCli_4306: bitstring = pub(skA) in
                                {4794}let v_4307: bool = (Sess_3941 = A) in
                                (
                                    {4795}if v_4307 then
                                    (
                                        {4796}let pkSess_4308: bitstring = pub(skA) in
                                        {4797}in(c, =GetEndpointRequest);
                                        {4798}new SP_4309: bitstring;
                                        {4799}new UP_4310: bitstring;
                                        {4800}out(c, (GetEndpointResponse,pkSess_4308,SignAndEncrypt,SP_4309,UP_4310))
                                    )
                                    else
                                        {4801}let v_4311: bool = (Sess_3941 = B) in
                                        (
                                            {4802}if v_4311 then
                                            (
                                                {4803}let pkSess_4312: bitstring = pub(skB) in
                                                {4804}in(c, =GetEndpointRequest);
                                                {4805}new SP_4313: bitstring;
                                                {4806}new UP_4314: bitstring;
                                                {4807}out(c, (GetEndpointResponse,pkSess_4312,SignAndEncrypt,SP_4313,UP_4314))
                                            )
                                            else
                                                {4808}let v_4315: bool = (Sess_3941 = C) in
                                                (
                                                    {4809}if v_4315 then
                                                    (
                                                        {4810}let pkSess_4316: bitstring = pub(skC) in
                                                        {4811}in(c, =GetEndpointRequest);
                                                        {4812}new SP_4317: bitstring;
                                                        {4813}new UP_4318: bitstring;
                                                        {4814}out(c, (GetEndpointResponse,pkSess_4316,SignAndEncrypt,SP_4317,UP_4318))
                                                    )
                                                    else
                                                        {4815}let pkSess_4319: bitstring = pub(sk(Sess_3941)) in
                                                        {4816}in(c, =GetEndpointRequest);
                                                        {4817}new SP_4320: bitstring;
                                                        {4818}new UP_4321: bitstring;
                                                        {4819}out(c, (GetEndpointResponse,pkSess_4319,SignAndEncrypt,SP_4320,UP_4321))
                                                )
                                                else
                                                    {4820}let pkSess_4322: bitstring = fail-any in
                                                    {4821}in(c, =GetEndpointRequest);
                                                    {4822}new SP_4323: bitstring;
                                                    {4823}new UP_4324: bitstring;
                                                    {4824}out(c, (GetEndpointResponse,pkSess_4322,SignAndEncrypt,SP_4323,UP_4324))
                                        )
                                        else
                                            {4825}let pkSess_4325: bitstring = fail-any in
                                            {4826}in(c, =GetEndpointRequest);
                                            {4827}new SP_4326: bitstring;
                                            {4828}new UP_4327: bitstring;
                                            {4829}out(c, (GetEndpointResponse,pkSess_4325,SignAndEncrypt,SP_4326,UP_4327))
                                )
                                else
                                    {4830}let pkSess_4328: bitstring = fail-any in
                                    {4831}in(c, =GetEndpointRequest);
                                    {4832}new SP_4329: bitstring;
                                    {4833}new UP_4330: bitstring;
                                    {4834}out(c, (GetEndpointResponse,pkSess_4328,SignAndEncrypt,SP_4329,UP_4330))
                            )
                            else
                                {4835}let v_4331: bool = (Cli_3939 = B) in
                                (
                                    {4836}if v_4331 then
                                    (
                                        {4837}let pkCli_4332: bitstring = pub(skB) in
                                        {4838}let v_4333: bool = (Sess_3941 = A) in
                                        (
                                            {4839}if v_4333 then
                                            (
                                                {4840}let pkSess_4334: bitstring = pub(skA) in
                                                {4841}in(c, =GetEndpointRequest);
                                                {4842}new SP_4335: bitstring;
                                                {4843}new UP_4336: bitstring;
                                                {4844}out(c, (GetEndpointResponse,pkSess_4334,SignAndEncrypt,SP_4335,UP_4336))
                                            )
                                            else
                                                {4845}let v_4337: bool = (Sess_3941 = B) in
                                                (
                                                    {4846}if v_4337 then
                                                    (
                                                        {4847}let pkSess_4338: bitstring = pub(skB) in
                                                        {4848}in(c, =GetEndpointRequest);
                                                        {4849}new SP_4339: bitstring;
                                                        {4850}new UP_4340: bitstring;
                                                        {4851}out(c, (GetEndpointResponse,pkSess_4338,SignAndEncrypt,SP_4339,UP_4340))
                                                    )
                                                    else
                                                        {4852}let v_4341: bool = (Sess_3941 = C) in
                                                        (
                                                            {4853}if v_4341 then
                                                            (
                                                                {4854}let pkSess_4342: bitstring = pub(skC) in
                                                                {4855}in(c, =GetEndpointRequest);
                                                                {4856}new SP_4343: bitstring;
                                                                {4857}new UP_4344: bitstring;
                                                                {4858}out(c, (GetEndpointResponse,pkSess_4342,SignAndEncrypt,SP_4343,UP_4344))
                                                            )
                                                            else
                                                                {4859}let pkSess_4345: bitstring = pub(sk(Sess_3941)) in
                                                                {4860}in(c, =GetEndpointRequest);
                                                                {4861}new SP_4346: bitstring;
                                                                {4862}new UP_4347: bitstring;
                                                                {4863}out(c, (GetEndpointResponse,pkSess_4345,SignAndEncrypt,SP_4346,UP_4347))
                                                        )
                                                        else
                                                            {4864}let pkSess_4348: bitstring = fail-any in
                                                            {4865}in(c, =GetEndpointRequest);
                                                            {4866}new SP_4349: bitstring;
                                                            {4867}new UP_4350: bitstring;
                                                            {4868}out(c, (GetEndpointResponse,pkSess_4348,SignAndEncrypt,SP_4349,UP_4350))
                                                )
                                                else
                                                    {4869}let pkSess_4351: bitstring = fail-any in
                                                    {4870}in(c, =GetEndpointRequest);
                                                    {4871}new SP_4352: bitstring;
                                                    {4872}new UP_4353: bitstring;
                                                    {4873}out(c, (GetEndpointResponse,pkSess_4351,SignAndEncrypt,SP_4352,UP_4353))
                                        )
                                        else
                                            {4874}let pkSess_4354: bitstring = fail-any in
                                            {4875}in(c, =GetEndpointRequest);
                                            {4876}new SP_4355: bitstring;
                                            {4877}new UP_4356: bitstring;
                                            {4878}out(c, (GetEndpointResponse,pkSess_4354,SignAndEncrypt,SP_4355,UP_4356))
                                    )
                                    else
                                        {4879}let v_4357: bool = (Cli_3939 = C) in
                                        (
                                            {4880}if v_4357 then
                                            (
                                                {4881}let pkCli_4358: bitstring = pub(skC) in
                                                {4882}let v_4359: bool = (Sess_3941 = A) in
                                                (
                                                    {4883}if v_4359 then
                                                    (
                                                        {4884}let pkSess_4360: bitstring = pub(skA) in
                                                        {4885}in(c, =GetEndpointRequest);
                                                        {4886}new SP_4361: bitstring;
                                                        {4887}new UP_4362: bitstring;
                                                        {4888}out(c, (GetEndpointResponse,pkSess_4360,SignAndEncrypt,SP_4361,UP_4362))
                                                    )
                                                    else
                                                        {4889}let v_4363: bool = (Sess_3941 = B) in
                                                        (
                                                            {4890}if v_4363 then
                                                            (
                                                                {4891}let pkSess_4364: bitstring = pub(skB) in
                                                                {4892}in(c, =GetEndpointRequest);
                                                                {4893}new SP_4365: bitstring;
                                                                {4894}new UP_4366: bitstring;
                                                                {4895}out(c, (GetEndpointResponse,pkSess_4364,SignAndEncrypt,SP_4365,UP_4366))
                                                            )
                                                            else
                                                                {4896}let v_4367: bool = (Sess_3941 = C) in
                                                                (
                                                                    {4897}if v_4367 then
                                                                    (
                                                                        {4898}let pkSess_4368: bitstring = pub(skC) in
                                                                        {4899}in(c, =GetEndpointRequest);
                                                                        {4900}new SP_4369: bitstring;
                                                                        {4901}new UP_4370: bitstring;
                                                                        {4902}out(c, (GetEndpointResponse,pkSess_4368,SignAndEncrypt,SP_4369,UP_4370))
                                                                    )
                                                                    else
                                                                        {4903}let pkSess_4371: bitstring = pub(sk(Sess_3941)) in
                                                                        {4904}in(c, =GetEndpointRequest);
                                                                        {4905}new SP_4372: bitstring;
                                                                        {4906}new UP_4373: bitstring;
                                                                        {4907}out(c, (GetEndpointResponse,pkSess_4371,SignAndEncrypt,SP_4372,UP_4373))
                                                                )
                                                                else
                                                                    {4908}let pkSess_4374: bitstring = fail-any in
                                                                    {4909}in(c, =GetEndpointRequest);
                                                                    {4910}new SP_4375: bitstring;
                                                                    {4911}new UP_4376: bitstring;
                                                                    {4912}out(c, (GetEndpointResponse,pkSess_4374,SignAndEncrypt,SP_4375,UP_4376))
                                                        )
                                                        else
                                                            {4913}let pkSess_4377: bitstring = fail-any in
                                                            {4914}in(c, =GetEndpointRequest);
                                                            {4915}new SP_4378: bitstring;
                                                            {4916}new UP_4379: bitstring;
                                                            {4917}out(c, (GetEndpointResponse,pkSess_4377,SignAndEncrypt,SP_4378,UP_4379))
                                                )
                                                else
                                                    {4918}let pkSess_4380: bitstring = fail-any in
                                                    {4919}in(c, =GetEndpointRequest);
                                                    {4920}new SP_4381: bitstring;
                                                    {4921}new UP_4382: bitstring;
                                                    {4922}out(c, (GetEndpointResponse,pkSess_4380,SignAndEncrypt,SP_4381,UP_4382))
                                            )
                                            else
                                                {4923}let pkCli_4383: bitstring = pub(sk(Cli_3939)) in
                                                {4924}let v_4384: bool = (Sess_3941 = A) in
                                                (
                                                    {4925}if v_4384 then
                                                    (
                                                        {4926}let pkSess_4385: bitstring = pub(skA) in
                                                        {4927}in(c, =GetEndpointRequest);
                                                        {4928}new SP_4386: bitstring;
                                                        {4929}new UP_4387: bitstring;
                                                        {4930}out(c, (GetEndpointResponse,pkSess_4385,SignAndEncrypt,SP_4386,UP_4387))
                                                    )
                                                    else
                                                        {4931}let v_4388: bool = (Sess_3941 = B) in
                                                        (
                                                            {4932}if v_4388 then
                                                            (
                                                                {4933}let pkSess_4389: bitstring = pub(skB) in
                                                                {4934}in(c, =GetEndpointRequest);
                                                                {4935}new SP_4390: bitstring;
                                                                {4936}new UP_4391: bitstring;
                                                                {4937}out(c, (GetEndpointResponse,pkSess_4389,SignAndEncrypt,SP_4390,UP_4391))
                                                            )
                                                            else
                                                                {4938}let v_4392: bool = (Sess_3941 = C) in
                                                                (
                                                                    {4939}if v_4392 then
                                                                    (
                                                                        {4940}let pkSess_4393: bitstring = pub(skC) in
                                                                        {4941}in(c, =GetEndpointRequest);
                                                                        {4942}new SP_4394: bitstring;
                                                                        {4943}new UP_4395: bitstring;
                                                                        {4944}out(c, (GetEndpointResponse,pkSess_4393,SignAndEncrypt,SP_4394,UP_4395))
                                                                    )
                                                                    else
                                                                        {4945}let pkSess_4396: bitstring = pub(sk(Sess_3941)) in
                                                                        {4946}in(c, =GetEndpointRequest);
                                                                        {4947}new SP_4397: bitstring;
                                                                        {4948}new UP_4398: bitstring;
                                                                        {4949}out(c, (GetEndpointResponse,pkSess_4396,SignAndEncrypt,SP_4397,UP_4398))
                                                                )
                                                                else
                                                                    {4950}let pkSess_4399: bitstring = fail-any in
                                                                    {4951}in(c, =GetEndpointRequest);
                                                                    {4952}new SP_4400: bitstring;
                                                                    {4953}new UP_4401: bitstring;
                                                                    {4954}out(c, (GetEndpointResponse,pkSess_4399,SignAndEncrypt,SP_4400,UP_4401))
                                                        )
                                                        else
                                                            {4955}let pkSess_4402: bitstring = fail-any in
                                                            {4956}in(c, =GetEndpointRequest);
                                                            {4957}new SP_4403: bitstring;
                                                            {4958}new UP_4404: bitstring;
                                                            {4959}out(c, (GetEndpointResponse,pkSess_4402,SignAndEncrypt,SP_4403,UP_4404))
                                                )
                                                else
                                                    {4960}let pkSess_4405: bitstring = fail-any in
                                                    {4961}in(c, =GetEndpointRequest);
                                                    {4962}new SP_4406: bitstring;
                                                    {4963}new UP_4407: bitstring;
                                                    {4964}out(c, (GetEndpointResponse,pkSess_4405,SignAndEncrypt,SP_4406,UP_4407))
                                        )
                                        else
                                            {4965}let pkCli_4408: bitstring = fail-any in
                                            {4966}let v_4409: bool = (Sess_3941 = A) in
                                            (
                                                {4967}if v_4409 then
                                                (
                                                    {4968}let pkSess_4410: bitstring = pub(skA) in
                                                    {4969}in(c, =GetEndpointRequest);
                                                    {4970}new SP_4411: bitstring;
                                                    {4971}new UP_4412: bitstring;
                                                    {4972}out(c, (GetEndpointResponse,pkSess_4410,SignAndEncrypt,SP_4411,UP_4412))
                                                )
                                                else
                                                    {4973}let v_4413: bool = (Sess_3941 = B) in
                                                    (
                                                        {4974}if v_4413 then
                                                        (
                                                            {4975}let pkSess_4414: bitstring = pub(skB) in
                                                            {4976}in(c, =GetEndpointRequest);
                                                            {4977}new SP_4415: bitstring;
                                                            {4978}new UP_4416: bitstring;
                                                            {4979}out(c, (GetEndpointResponse,pkSess_4414,SignAndEncrypt,SP_4415,UP_4416))
                                                        )
                                                        else
                                                            {4980}let v_4417: bool = (Sess_3941 = C) in
                                                            (
                                                                {4981}if v_4417 then
                                                                (
                                                                    {4982}let pkSess_4418: bitstring = pub(skC) in
                                                                    {4983}in(c, =GetEndpointRequest);
                                                                    {4984}new SP_4419: bitstring;
                                                                    {4985}new UP_4420: bitstring;
                                                                    {4986}out(c, (GetEndpointResponse,pkSess_4418,SignAndEncrypt,SP_4419,UP_4420))
                                                                )
                                                                else
                                                                    {4987}let pkSess_4421: bitstring = pub(sk(Sess_3941)) in
                                                                    {4988}in(c, =GetEndpointRequest);
                                                                    {4989}new SP_4422: bitstring;
                                                                    {4990}new UP_4423: bitstring;
                                                                    {4991}out(c, (GetEndpointResponse,pkSess_4421,SignAndEncrypt,SP_4422,UP_4423))
                                                            )
                                                            else
                                                                {4992}let pkSess_4424: bitstring = fail-any in
                                                                {4993}in(c, =GetEndpointRequest);
                                                                {4994}new SP_4425: bitstring;
                                                                {4995}new UP_4426: bitstring;
                                                                {4996}out(c, (GetEndpointResponse,pkSess_4424,SignAndEncrypt,SP_4425,UP_4426))
                                                    )
                                                    else
                                                        {4997}let pkSess_4427: bitstring = fail-any in
                                                        {4998}in(c, =GetEndpointRequest);
                                                        {4999}new SP_4428: bitstring;
                                                        {5000}new UP_4429: bitstring;
                                                        {5001}out(c, (GetEndpointResponse,pkSess_4427,SignAndEncrypt,SP_4428,UP_4429))
                                            )
                                            else
                                                {5002}let pkSess_4430: bitstring = fail-any in
                                                {5003}in(c, =GetEndpointRequest);
                                                {5004}new SP_4431: bitstring;
                                                {5005}new UP_4432: bitstring;
                                                {5006}out(c, (GetEndpointResponse,pkSess_4430,SignAndEncrypt,SP_4431,UP_4432))
                                )
                                else
                                    {5007}let pkCli_4433: bitstring = fail-any in
                                    {5008}let v_4434: bool = (Sess_3941 = A) in
                                    (
                                        {5009}if v_4434 then
                                        (
                                            {5010}let pkSess_4435: bitstring = pub(skA) in
                                            {5011}in(c, =GetEndpointRequest);
                                            {5012}new SP_4436: bitstring;
                                            {5013}new UP_4437: bitstring;
                                            {5014}out(c, (GetEndpointResponse,pkSess_4435,SignAndEncrypt,SP_4436,UP_4437))
                                        )
                                        else
                                            {5015}let v_4438: bool = (Sess_3941 = B) in
                                            (
                                                {5016}if v_4438 then
                                                (
                                                    {5017}let pkSess_4439: bitstring = pub(skB) in
                                                    {5018}in(c, =GetEndpointRequest);
                                                    {5019}new SP_4440: bitstring;
                                                    {5020}new UP_4441: bitstring;
                                                    {5021}out(c, (GetEndpointResponse,pkSess_4439,SignAndEncrypt,SP_4440,UP_4441))
                                                )
                                                else
                                                    {5022}let v_4442: bool = (Sess_3941 = C) in
                                                    (
                                                        {5023}if v_4442 then
                                                        (
                                                            {5024}let pkSess_4443: bitstring = pub(skC) in
                                                            {5025}in(c, =GetEndpointRequest);
                                                            {5026}new SP_4444: bitstring;
                                                            {5027}new UP_4445: bitstring;
                                                            {5028}out(c, (GetEndpointResponse,pkSess_4443,SignAndEncrypt,SP_4444,UP_4445))
                                                        )
                                                        else
                                                            {5029}let pkSess_4446: bitstring = pub(sk(Sess_3941)) in
                                                            {5030}in(c, =GetEndpointRequest);
                                                            {5031}new SP_4447: bitstring;
                                                            {5032}new UP_4448: bitstring;
                                                            {5033}out(c, (GetEndpointResponse,pkSess_4446,SignAndEncrypt,SP_4447,UP_4448))
                                                    )
                                                    else
                                                        {5034}let pkSess_4449: bitstring = fail-any in
                                                        {5035}in(c, =GetEndpointRequest);
                                                        {5036}new SP_4450: bitstring;
                                                        {5037}new UP_4451: bitstring;
                                                        {5038}out(c, (GetEndpointResponse,pkSess_4449,SignAndEncrypt,SP_4450,UP_4451))
                                            )
                                            else
                                                {5039}let pkSess_4452: bitstring = fail-any in
                                                {5040}in(c, =GetEndpointRequest);
                                                {5041}new SP_4453: bitstring;
                                                {5042}new UP_4454: bitstring;
                                                {5043}out(c, (GetEndpointResponse,pkSess_4452,SignAndEncrypt,SP_4453,UP_4454))
                                    )
                                    else
                                        {5044}let pkSess_4455: bitstring = fail-any in
                                        {5045}in(c, =GetEndpointRequest);
                                        {5046}new SP_4456: bitstring;
                                        {5047}new UP_4457: bitstring;
                                        {5048}out(c, (GetEndpointResponse,pkSess_4455,SignAndEncrypt,SP_4456,UP_4457))
                        )
                        else
                            {5049}let pkCli_4458: bitstring = fail-any in
                            {5050}let v_4459: bool = (Sess_3941 = A) in
                            (
                                {5051}if v_4459 then
                                (
                                    {5052}let pkSess_4460: bitstring = pub(skA) in
                                    {5053}in(c, =GetEndpointRequest);
                                    {5054}new SP_4461: bitstring;
                                    {5055}new UP_4462: bitstring;
                                    {5056}out(c, (GetEndpointResponse,pkSess_4460,SignAndEncrypt,SP_4461,UP_4462))
                                )
                                else
                                    {5057}let v_4463: bool = (Sess_3941 = B) in
                                    (
                                        {5058}if v_4463 then
                                        (
                                            {5059}let pkSess_4464: bitstring = pub(skB) in
                                            {5060}in(c, =GetEndpointRequest);
                                            {5061}new SP_4465: bitstring;
                                            {5062}new UP_4466: bitstring;
                                            {5063}out(c, (GetEndpointResponse,pkSess_4464,SignAndEncrypt,SP_4465,UP_4466))
                                        )
                                        else
                                            {5064}let v_4467: bool = (Sess_3941 = C) in
                                            (
                                                {5065}if v_4467 then
                                                (
                                                    {5066}let pkSess_4468: bitstring = pub(skC) in
                                                    {5067}in(c, =GetEndpointRequest);
                                                    {5068}new SP_4469: bitstring;
                                                    {5069}new UP_4470: bitstring;
                                                    {5070}out(c, (GetEndpointResponse,pkSess_4468,SignAndEncrypt,SP_4469,UP_4470))
                                                )
                                                else
                                                    {5071}let pkSess_4471: bitstring = pub(sk(Sess_3941)) in
                                                    {5072}in(c, =GetEndpointRequest);
                                                    {5073}new SP_4472: bitstring;
                                                    {5074}new UP_4473: bitstring;
                                                    {5075}out(c, (GetEndpointResponse,pkSess_4471,SignAndEncrypt,SP_4472,UP_4473))
                                            )
                                            else
                                                {5076}let pkSess_4474: bitstring = fail-any in
                                                {5077}in(c, =GetEndpointRequest);
                                                {5078}new SP_4475: bitstring;
                                                {5079}new UP_4476: bitstring;
                                                {5080}out(c, (GetEndpointResponse,pkSess_4474,SignAndEncrypt,SP_4475,UP_4476))
                                    )
                                    else
                                        {5081}let pkSess_4477: bitstring = fail-any in
                                        {5082}in(c, =GetEndpointRequest);
                                        {5083}new SP_4478: bitstring;
                                        {5084}new UP_4479: bitstring;
                                        {5085}out(c, (GetEndpointResponse,pkSess_4477,SignAndEncrypt,SP_4478,UP_4479))
                            )
                            else
                                {5086}let pkSess_4480: bitstring = fail-any in
                                {5087}in(c, =GetEndpointRequest);
                                {5088}new SP_4481: bitstring;
                                {5089}new UP_4482: bitstring;
                                {5090}out(c, (GetEndpointResponse,pkSess_4480,SignAndEncrypt,SP_4481,UP_4482))
                    )
                    else
                        {5091}let skDisco_4483: bitstring = fail-any in
                        {5092}let pkDisco_4484: bitstring = pub(skDisco_4483) in
                        {5093}let v_4485: bool = (Cli_3939 = A) in
                        (
                            {5094}if v_4485 then
                            (
                                {5095}let pkCli_4486: bitstring = pub(skA) in
                                {5096}let v_4487: bool = (Sess_3941 = A) in
                                (
                                    {5097}if v_4487 then
                                    (
                                        {5098}let pkSess_4488: bitstring = pub(skA) in
                                        {5099}in(c, =GetEndpointRequest);
                                        {5100}new SP_4489: bitstring;
                                        {5101}new UP_4490: bitstring;
                                        {5102}out(c, (GetEndpointResponse,pkSess_4488,SignAndEncrypt,SP_4489,UP_4490))
                                    )
                                    else
                                        {5103}let v_4491: bool = (Sess_3941 = B) in
                                        (
                                            {5104}if v_4491 then
                                            (
                                                {5105}let pkSess_4492: bitstring = pub(skB) in
                                                {5106}in(c, =GetEndpointRequest);
                                                {5107}new SP_4493: bitstring;
                                                {5108}new UP_4494: bitstring;
                                                {5109}out(c, (GetEndpointResponse,pkSess_4492,SignAndEncrypt,SP_4493,UP_4494))
                                            )
                                            else
                                                {5110}let v_4495: bool = (Sess_3941 = C) in
                                                (
                                                    {5111}if v_4495 then
                                                    (
                                                        {5112}let pkSess_4496: bitstring = pub(skC) in
                                                        {5113}in(c, =GetEndpointRequest);
                                                        {5114}new SP_4497: bitstring;
                                                        {5115}new UP_4498: bitstring;
                                                        {5116}out(c, (GetEndpointResponse,pkSess_4496,SignAndEncrypt,SP_4497,UP_4498))
                                                    )
                                                    else
                                                        {5117}let pkSess_4499: bitstring = pub(sk(Sess_3941)) in
                                                        {5118}in(c, =GetEndpointRequest);
                                                        {5119}new SP_4500: bitstring;
                                                        {5120}new UP_4501: bitstring;
                                                        {5121}out(c, (GetEndpointResponse,pkSess_4499,SignAndEncrypt,SP_4500,UP_4501))
                                                )
                                                else
                                                    {5122}let pkSess_4502: bitstring = fail-any in
                                                    {5123}in(c, =GetEndpointRequest);
                                                    {5124}new SP_4503: bitstring;
                                                    {5125}new UP_4504: bitstring;
                                                    {5126}out(c, (GetEndpointResponse,pkSess_4502,SignAndEncrypt,SP_4503,UP_4504))
                                        )
                                        else
                                            {5127}let pkSess_4505: bitstring = fail-any in
                                            {5128}in(c, =GetEndpointRequest);
                                            {5129}new SP_4506: bitstring;
                                            {5130}new UP_4507: bitstring;
                                            {5131}out(c, (GetEndpointResponse,pkSess_4505,SignAndEncrypt,SP_4506,UP_4507))
                                )
                                else
                                    {5132}let pkSess_4508: bitstring = fail-any in
                                    {5133}in(c, =GetEndpointRequest);
                                    {5134}new SP_4509: bitstring;
                                    {5135}new UP_4510: bitstring;
                                    {5136}out(c, (GetEndpointResponse,pkSess_4508,SignAndEncrypt,SP_4509,UP_4510))
                            )
                            else
                                {5137}let v_4511: bool = (Cli_3939 = B) in
                                (
                                    {5138}if v_4511 then
                                    (
                                        {5139}let pkCli_4512: bitstring = pub(skB) in
                                        {5140}let v_4513: bool = (Sess_3941 = A) in
                                        (
                                            {5141}if v_4513 then
                                            (
                                                {5142}let pkSess_4514: bitstring = pub(skA) in
                                                {5143}in(c, =GetEndpointRequest);
                                                {5144}new SP_4515: bitstring;
                                                {5145}new UP_4516: bitstring;
                                                {5146}out(c, (GetEndpointResponse,pkSess_4514,SignAndEncrypt,SP_4515,UP_4516))
                                            )
                                            else
                                                {5147}let v_4517: bool = (Sess_3941 = B) in
                                                (
                                                    {5148}if v_4517 then
                                                    (
                                                        {5149}let pkSess_4518: bitstring = pub(skB) in
                                                        {5150}in(c, =GetEndpointRequest);
                                                        {5151}new SP_4519: bitstring;
                                                        {5152}new UP_4520: bitstring;
                                                        {5153}out(c, (GetEndpointResponse,pkSess_4518,SignAndEncrypt,SP_4519,UP_4520))
                                                    )
                                                    else
                                                        {5154}let v_4521: bool = (Sess_3941 = C) in
                                                        (
                                                            {5155}if v_4521 then
                                                            (
                                                                {5156}let pkSess_4522: bitstring = pub(skC) in
                                                                {5157}in(c, =GetEndpointRequest);
                                                                {5158}new SP_4523: bitstring;
                                                                {5159}new UP_4524: bitstring;
                                                                {5160}out(c, (GetEndpointResponse,pkSess_4522,SignAndEncrypt,SP_4523,UP_4524))
                                                            )
                                                            else
                                                                {5161}let pkSess_4525: bitstring = pub(sk(Sess_3941)) in
                                                                {5162}in(c, =GetEndpointRequest);
                                                                {5163}new SP_4526: bitstring;
                                                                {5164}new UP_4527: bitstring;
                                                                {5165}out(c, (GetEndpointResponse,pkSess_4525,SignAndEncrypt,SP_4526,UP_4527))
                                                        )
                                                        else
                                                            {5166}let pkSess_4528: bitstring = fail-any in
                                                            {5167}in(c, =GetEndpointRequest);
                                                            {5168}new SP_4529: bitstring;
                                                            {5169}new UP_4530: bitstring;
                                                            {5170}out(c, (GetEndpointResponse,pkSess_4528,SignAndEncrypt,SP_4529,UP_4530))
                                                )
                                                else
                                                    {5171}let pkSess_4531: bitstring = fail-any in
                                                    {5172}in(c, =GetEndpointRequest);
                                                    {5173}new SP_4532: bitstring;
                                                    {5174}new UP_4533: bitstring;
                                                    {5175}out(c, (GetEndpointResponse,pkSess_4531,SignAndEncrypt,SP_4532,UP_4533))
                                        )
                                        else
                                            {5176}let pkSess_4534: bitstring = fail-any in
                                            {5177}in(c, =GetEndpointRequest);
                                            {5178}new SP_4535: bitstring;
                                            {5179}new UP_4536: bitstring;
                                            {5180}out(c, (GetEndpointResponse,pkSess_4534,SignAndEncrypt,SP_4535,UP_4536))
                                    )
                                    else
                                        {5181}let v_4537: bool = (Cli_3939 = C) in
                                        (
                                            {5182}if v_4537 then
                                            (
                                                {5183}let pkCli_4538: bitstring = pub(skC) in
                                                {5184}let v_4539: bool = (Sess_3941 = A) in
                                                (
                                                    {5185}if v_4539 then
                                                    (
                                                        {5186}let pkSess_4540: bitstring = pub(skA) in
                                                        {5187}in(c, =GetEndpointRequest);
                                                        {5188}new SP_4541: bitstring;
                                                        {5189}new UP_4542: bitstring;
                                                        {5190}out(c, (GetEndpointResponse,pkSess_4540,SignAndEncrypt,SP_4541,UP_4542))
                                                    )
                                                    else
                                                        {5191}let v_4543: bool = (Sess_3941 = B) in
                                                        (
                                                            {5192}if v_4543 then
                                                            (
                                                                {5193}let pkSess_4544: bitstring = pub(skB) in
                                                                {5194}in(c, =GetEndpointRequest);
                                                                {5195}new SP_4545: bitstring;
                                                                {5196}new UP_4546: bitstring;
                                                                {5197}out(c, (GetEndpointResponse,pkSess_4544,SignAndEncrypt,SP_4545,UP_4546))
                                                            )
                                                            else
                                                                {5198}let v_4547: bool = (Sess_3941 = C) in
                                                                (
                                                                    {5199}if v_4547 then
                                                                    (
                                                                        {5200}let pkSess_4548: bitstring = pub(skC) in
                                                                        {5201}in(c, =GetEndpointRequest);
                                                                        {5202}new SP_4549: bitstring;
                                                                        {5203}new UP_4550: bitstring;
                                                                        {5204}out(c, (GetEndpointResponse,pkSess_4548,SignAndEncrypt,SP_4549,UP_4550))
                                                                    )
                                                                    else
                                                                        {5205}let pkSess_4551: bitstring = pub(sk(Sess_3941)) in
                                                                        {5206}in(c, =GetEndpointRequest);
                                                                        {5207}new SP_4552: bitstring;
                                                                        {5208}new UP_4553: bitstring;
                                                                        {5209}out(c, (GetEndpointResponse,pkSess_4551,SignAndEncrypt,SP_4552,UP_4553))
                                                                )
                                                                else
                                                                    {5210}let pkSess_4554: bitstring = fail-any in
                                                                    {5211}in(c, =GetEndpointRequest);
                                                                    {5212}new SP_4555: bitstring;
                                                                    {5213}new UP_4556: bitstring;
                                                                    {5214}out(c, (GetEndpointResponse,pkSess_4554,SignAndEncrypt,SP_4555,UP_4556))
                                                        )
                                                        else
                                                            {5215}let pkSess_4557: bitstring = fail-any in
                                                            {5216}in(c, =GetEndpointRequest);
                                                            {5217}new SP_4558: bitstring;
                                                            {5218}new UP_4559: bitstring;
                                                            {5219}out(c, (GetEndpointResponse,pkSess_4557,SignAndEncrypt,SP_4558,UP_4559))
                                                )
                                                else
                                                    {5220}let pkSess_4560: bitstring = fail-any in
                                                    {5221}in(c, =GetEndpointRequest);
                                                    {5222}new SP_4561: bitstring;
                                                    {5223}new UP_4562: bitstring;
                                                    {5224}out(c, (GetEndpointResponse,pkSess_4560,SignAndEncrypt,SP_4561,UP_4562))
                                            )
                                            else
                                                {5225}let pkCli_4563: bitstring = pub(sk(Cli_3939)) in
                                                {5226}let v_4564: bool = (Sess_3941 = A) in
                                                (
                                                    {5227}if v_4564 then
                                                    (
                                                        {5228}let pkSess_4565: bitstring = pub(skA) in
                                                        {5229}in(c, =GetEndpointRequest);
                                                        {5230}new SP_4566: bitstring;
                                                        {5231}new UP_4567: bitstring;
                                                        {5232}out(c, (GetEndpointResponse,pkSess_4565,SignAndEncrypt,SP_4566,UP_4567))
                                                    )
                                                    else
                                                        {5233}let v_4568: bool = (Sess_3941 = B) in
                                                        (
                                                            {5234}if v_4568 then
                                                            (
                                                                {5235}let pkSess_4569: bitstring = pub(skB) in
                                                                {5236}in(c, =GetEndpointRequest);
                                                                {5237}new SP_4570: bitstring;
                                                                {5238}new UP_4571: bitstring;
                                                                {5239}out(c, (GetEndpointResponse,pkSess_4569,SignAndEncrypt,SP_4570,UP_4571))
                                                            )
                                                            else
                                                                {5240}let v_4572: bool = (Sess_3941 = C) in
                                                                (
                                                                    {5241}if v_4572 then
                                                                    (
                                                                        {5242}let pkSess_4573: bitstring = pub(skC) in
                                                                        {5243}in(c, =GetEndpointRequest);
                                                                        {5244}new SP_4574: bitstring;
                                                                        {5245}new UP_4575: bitstring;
                                                                        {5246}out(c, (GetEndpointResponse,pkSess_4573,SignAndEncrypt,SP_4574,UP_4575))
                                                                    )
                                                                    else
                                                                        {5247}let pkSess_4576: bitstring = pub(sk(Sess_3941)) in
                                                                        {5248}in(c, =GetEndpointRequest);
                                                                        {5249}new SP_4577: bitstring;
                                                                        {5250}new UP_4578: bitstring;
                                                                        {5251}out(c, (GetEndpointResponse,pkSess_4576,SignAndEncrypt,SP_4577,UP_4578))
                                                                )
                                                                else
                                                                    {5252}let pkSess_4579: bitstring = fail-any in
                                                                    {5253}in(c, =GetEndpointRequest);
                                                                    {5254}new SP_4580: bitstring;
                                                                    {5255}new UP_4581: bitstring;
                                                                    {5256}out(c, (GetEndpointResponse,pkSess_4579,SignAndEncrypt,SP_4580,UP_4581))
                                                        )
                                                        else
                                                            {5257}let pkSess_4582: bitstring = fail-any in
                                                            {5258}in(c, =GetEndpointRequest);
                                                            {5259}new SP_4583: bitstring;
                                                            {5260}new UP_4584: bitstring;
                                                            {5261}out(c, (GetEndpointResponse,pkSess_4582,SignAndEncrypt,SP_4583,UP_4584))
                                                )
                                                else
                                                    {5262}let pkSess_4585: bitstring = fail-any in
                                                    {5263}in(c, =GetEndpointRequest);
                                                    {5264}new SP_4586: bitstring;
                                                    {5265}new UP_4587: bitstring;
                                                    {5266}out(c, (GetEndpointResponse,pkSess_4585,SignAndEncrypt,SP_4586,UP_4587))
                                        )
                                        else
                                            {5267}let pkCli_4588: bitstring = fail-any in
                                            {5268}let v_4589: bool = (Sess_3941 = A) in
                                            (
                                                {5269}if v_4589 then
                                                (
                                                    {5270}let pkSess_4590: bitstring = pub(skA) in
                                                    {5271}in(c, =GetEndpointRequest);
                                                    {5272}new SP_4591: bitstring;
                                                    {5273}new UP_4592: bitstring;
                                                    {5274}out(c, (GetEndpointResponse,pkSess_4590,SignAndEncrypt,SP_4591,UP_4592))
                                                )
                                                else
                                                    {5275}let v_4593: bool = (Sess_3941 = B) in
                                                    (
                                                        {5276}if v_4593 then
                                                        (
                                                            {5277}let pkSess_4594: bitstring = pub(skB) in
                                                            {5278}in(c, =GetEndpointRequest);
                                                            {5279}new SP_4595: bitstring;
                                                            {5280}new UP_4596: bitstring;
                                                            {5281}out(c, (GetEndpointResponse,pkSess_4594,SignAndEncrypt,SP_4595,UP_4596))
                                                        )
                                                        else
                                                            {5282}let v_4597: bool = (Sess_3941 = C) in
                                                            (
                                                                {5283}if v_4597 then
                                                                (
                                                                    {5284}let pkSess_4598: bitstring = pub(skC) in
                                                                    {5285}in(c, =GetEndpointRequest);
                                                                    {5286}new SP_4599: bitstring;
                                                                    {5287}new UP_4600: bitstring;
                                                                    {5288}out(c, (GetEndpointResponse,pkSess_4598,SignAndEncrypt,SP_4599,UP_4600))
                                                                )
                                                                else
                                                                    {5289}let pkSess_4601: bitstring = pub(sk(Sess_3941)) in
                                                                    {5290}in(c, =GetEndpointRequest);
                                                                    {5291}new SP_4602: bitstring;
                                                                    {5292}new UP_4603: bitstring;
                                                                    {5293}out(c, (GetEndpointResponse,pkSess_4601,SignAndEncrypt,SP_4602,UP_4603))
                                                            )
                                                            else
                                                                {5294}let pkSess_4604: bitstring = fail-any in
                                                                {5295}in(c, =GetEndpointRequest);
                                                                {5296}new SP_4605: bitstring;
                                                                {5297}new UP_4606: bitstring;
                                                                {5298}out(c, (GetEndpointResponse,pkSess_4604,SignAndEncrypt,SP_4605,UP_4606))
                                                    )
                                                    else
                                                        {5299}let pkSess_4607: bitstring = fail-any in
                                                        {5300}in(c, =GetEndpointRequest);
                                                        {5301}new SP_4608: bitstring;
                                                        {5302}new UP_4609: bitstring;
                                                        {5303}out(c, (GetEndpointResponse,pkSess_4607,SignAndEncrypt,SP_4608,UP_4609))
                                            )
                                            else
                                                {5304}let pkSess_4610: bitstring = fail-any in
                                                {5305}in(c, =GetEndpointRequest);
                                                {5306}new SP_4611: bitstring;
                                                {5307}new UP_4612: bitstring;
                                                {5308}out(c, (GetEndpointResponse,pkSess_4610,SignAndEncrypt,SP_4611,UP_4612))
                                )
                                else
                                    {5309}let pkCli_4613: bitstring = fail-any in
                                    {5310}let v_4614: bool = (Sess_3941 = A) in
                                    (
                                        {5311}if v_4614 then
                                        (
                                            {5312}let pkSess_4615: bitstring = pub(skA) in
                                            {5313}in(c, =GetEndpointRequest);
                                            {5314}new SP_4616: bitstring;
                                            {5315}new UP_4617: bitstring;
                                            {5316}out(c, (GetEndpointResponse,pkSess_4615,SignAndEncrypt,SP_4616,UP_4617))
                                        )
                                        else
                                            {5317}let v_4618: bool = (Sess_3941 = B) in
                                            (
                                                {5318}if v_4618 then
                                                (
                                                    {5319}let pkSess_4619: bitstring = pub(skB) in
                                                    {5320}in(c, =GetEndpointRequest);
                                                    {5321}new SP_4620: bitstring;
                                                    {5322}new UP_4621: bitstring;
                                                    {5323}out(c, (GetEndpointResponse,pkSess_4619,SignAndEncrypt,SP_4620,UP_4621))
                                                )
                                                else
                                                    {5324}let v_4622: bool = (Sess_3941 = C) in
                                                    (
                                                        {5325}if v_4622 then
                                                        (
                                                            {5326}let pkSess_4623: bitstring = pub(skC) in
                                                            {5327}in(c, =GetEndpointRequest);
                                                            {5328}new SP_4624: bitstring;
                                                            {5329}new UP_4625: bitstring;
                                                            {5330}out(c, (GetEndpointResponse,pkSess_4623,SignAndEncrypt,SP_4624,UP_4625))
                                                        )
                                                        else
                                                            {5331}let pkSess_4626: bitstring = pub(sk(Sess_3941)) in
                                                            {5332}in(c, =GetEndpointRequest);
                                                            {5333}new SP_4627: bitstring;
                                                            {5334}new UP_4628: bitstring;
                                                            {5335}out(c, (GetEndpointResponse,pkSess_4626,SignAndEncrypt,SP_4627,UP_4628))
                                                    )
                                                    else
                                                        {5336}let pkSess_4629: bitstring = fail-any in
                                                        {5337}in(c, =GetEndpointRequest);
                                                        {5338}new SP_4630: bitstring;
                                                        {5339}new UP_4631: bitstring;
                                                        {5340}out(c, (GetEndpointResponse,pkSess_4629,SignAndEncrypt,SP_4630,UP_4631))
                                            )
                                            else
                                                {5341}let pkSess_4632: bitstring = fail-any in
                                                {5342}in(c, =GetEndpointRequest);
                                                {5343}new SP_4633: bitstring;
                                                {5344}new UP_4634: bitstring;
                                                {5345}out(c, (GetEndpointResponse,pkSess_4632,SignAndEncrypt,SP_4633,UP_4634))
                                    )
                                    else
                                        {5346}let pkSess_4635: bitstring = fail-any in
                                        {5347}in(c, =GetEndpointRequest);
                                        {5348}new SP_4636: bitstring;
                                        {5349}new UP_4637: bitstring;
                                        {5350}out(c, (GetEndpointResponse,pkSess_4635,SignAndEncrypt,SP_4636,UP_4637))
                        )
                        else
                            {5351}let pkCli_4638: bitstring = fail-any in
                            {5352}let v_4639: bool = (Sess_3941 = A) in
                            (
                                {5353}if v_4639 then
                                (
                                    {5354}let pkSess_4640: bitstring = pub(skA) in
                                    {5355}in(c, =GetEndpointRequest);
                                    {5356}new SP_4641: bitstring;
                                    {5357}new UP_4642: bitstring;
                                    {5358}out(c, (GetEndpointResponse,pkSess_4640,SignAndEncrypt,SP_4641,UP_4642))
                                )
                                else
                                    {5359}let v_4643: bool = (Sess_3941 = B) in
                                    (
                                        {5360}if v_4643 then
                                        (
                                            {5361}let pkSess_4644: bitstring = pub(skB) in
                                            {5362}in(c, =GetEndpointRequest);
                                            {5363}new SP_4645: bitstring;
                                            {5364}new UP_4646: bitstring;
                                            {5365}out(c, (GetEndpointResponse,pkSess_4644,SignAndEncrypt,SP_4645,UP_4646))
                                        )
                                        else
                                            {5366}let v_4647: bool = (Sess_3941 = C) in
                                            (
                                                {5367}if v_4647 then
                                                (
                                                    {5368}let pkSess_4648: bitstring = pub(skC) in
                                                    {5369}in(c, =GetEndpointRequest);
                                                    {5370}new SP_4649: bitstring;
                                                    {5371}new UP_4650: bitstring;
                                                    {5372}out(c, (GetEndpointResponse,pkSess_4648,SignAndEncrypt,SP_4649,UP_4650))
                                                )
                                                else
                                                    {5373}let pkSess_4651: bitstring = pub(sk(Sess_3941)) in
                                                    {5374}in(c, =GetEndpointRequest);
                                                    {5375}new SP_4652: bitstring;
                                                    {5376}new UP_4653: bitstring;
                                                    {5377}out(c, (GetEndpointResponse,pkSess_4651,SignAndEncrypt,SP_4652,UP_4653))
                                            )
                                            else
                                                {5378}let pkSess_4654: bitstring = fail-any in
                                                {5379}in(c, =GetEndpointRequest);
                                                {5380}new SP_4655: bitstring;
                                                {5381}new UP_4656: bitstring;
                                                {5382}out(c, (GetEndpointResponse,pkSess_4654,SignAndEncrypt,SP_4655,UP_4656))
                                    )
                                    else
                                        {5383}let pkSess_4657: bitstring = fail-any in
                                        {5384}in(c, =GetEndpointRequest);
                                        {5385}new SP_4658: bitstring;
                                        {5386}new UP_4659: bitstring;
                                        {5387}out(c, (GetEndpointResponse,pkSess_4657,SignAndEncrypt,SP_4658,UP_4659))
                            )
                            else
                                {5388}let pkSess_4660: bitstring = fail-any in
                                {5389}in(c, =GetEndpointRequest);
                                {5390}new SP_4661: bitstring;
                                {5391}new UP_4662: bitstring;
                                {5392}out(c, (GetEndpointResponse,pkSess_4660,SignAndEncrypt,SP_4661,UP_4662))
            )
            else
                {5393}let skDisco_4663: bitstring = fail-any in
                {5394}let pkDisco_4664: bitstring = pub(skDisco_4663) in
                {5395}let v_4665: bool = (Cli_3939 = A) in
                (
                    {5396}if v_4665 then
                    (
                        {5397}let pkCli_4666: bitstring = pub(skA) in
                        {5398}let v_4667: bool = (Sess_3941 = A) in
                        (
                            {5399}if v_4667 then
                            (
                                {5400}let pkSess_4668: bitstring = pub(skA) in
                                {5401}in(c, =GetEndpointRequest);
                                {5402}new SP_4669: bitstring;
                                {5403}new UP_4670: bitstring;
                                {5404}out(c, (GetEndpointResponse,pkSess_4668,SignAndEncrypt,SP_4669,UP_4670))
                            )
                            else
                                {5405}let v_4671: bool = (Sess_3941 = B) in
                                (
                                    {5406}if v_4671 then
                                    (
                                        {5407}let pkSess_4672: bitstring = pub(skB) in
                                        {5408}in(c, =GetEndpointRequest);
                                        {5409}new SP_4673: bitstring;
                                        {5410}new UP_4674: bitstring;
                                        {5411}out(c, (GetEndpointResponse,pkSess_4672,SignAndEncrypt,SP_4673,UP_4674))
                                    )
                                    else
                                        {5412}let v_4675: bool = (Sess_3941 = C) in
                                        (
                                            {5413}if v_4675 then
                                            (
                                                {5414}let pkSess_4676: bitstring = pub(skC) in
                                                {5415}in(c, =GetEndpointRequest);
                                                {5416}new SP_4677: bitstring;
                                                {5417}new UP_4678: bitstring;
                                                {5418}out(c, (GetEndpointResponse,pkSess_4676,SignAndEncrypt,SP_4677,UP_4678))
                                            )
                                            else
                                                {5419}let pkSess_4679: bitstring = pub(sk(Sess_3941)) in
                                                {5420}in(c, =GetEndpointRequest);
                                                {5421}new SP_4680: bitstring;
                                                {5422}new UP_4681: bitstring;
                                                {5423}out(c, (GetEndpointResponse,pkSess_4679,SignAndEncrypt,SP_4680,UP_4681))
                                        )
                                        else
                                            {5424}let pkSess_4682: bitstring = fail-any in
                                            {5425}in(c, =GetEndpointRequest);
                                            {5426}new SP_4683: bitstring;
                                            {5427}new UP_4684: bitstring;
                                            {5428}out(c, (GetEndpointResponse,pkSess_4682,SignAndEncrypt,SP_4683,UP_4684))
                                )
                                else
                                    {5429}let pkSess_4685: bitstring = fail-any in
                                    {5430}in(c, =GetEndpointRequest);
                                    {5431}new SP_4686: bitstring;
                                    {5432}new UP_4687: bitstring;
                                    {5433}out(c, (GetEndpointResponse,pkSess_4685,SignAndEncrypt,SP_4686,UP_4687))
                        )
                        else
                            {5434}let pkSess_4688: bitstring = fail-any in
                            {5435}in(c, =GetEndpointRequest);
                            {5436}new SP_4689: bitstring;
                            {5437}new UP_4690: bitstring;
                            {5438}out(c, (GetEndpointResponse,pkSess_4688,SignAndEncrypt,SP_4689,UP_4690))
                    )
                    else
                        {5439}let v_4691: bool = (Cli_3939 = B) in
                        (
                            {5440}if v_4691 then
                            (
                                {5441}let pkCli_4692: bitstring = pub(skB) in
                                {5442}let v_4693: bool = (Sess_3941 = A) in
                                (
                                    {5443}if v_4693 then
                                    (
                                        {5444}let pkSess_4694: bitstring = pub(skA) in
                                        {5445}in(c, =GetEndpointRequest);
                                        {5446}new SP_4695: bitstring;
                                        {5447}new UP_4696: bitstring;
                                        {5448}out(c, (GetEndpointResponse,pkSess_4694,SignAndEncrypt,SP_4695,UP_4696))
                                    )
                                    else
                                        {5449}let v_4697: bool = (Sess_3941 = B) in
                                        (
                                            {5450}if v_4697 then
                                            (
                                                {5451}let pkSess_4698: bitstring = pub(skB) in
                                                {5452}in(c, =GetEndpointRequest);
                                                {5453}new SP_4699: bitstring;
                                                {5454}new UP_4700: bitstring;
                                                {5455}out(c, (GetEndpointResponse,pkSess_4698,SignAndEncrypt,SP_4699,UP_4700))
                                            )
                                            else
                                                {5456}let v_4701: bool = (Sess_3941 = C) in
                                                (
                                                    {5457}if v_4701 then
                                                    (
                                                        {5458}let pkSess_4702: bitstring = pub(skC) in
                                                        {5459}in(c, =GetEndpointRequest);
                                                        {5460}new SP_4703: bitstring;
                                                        {5461}new UP_4704: bitstring;
                                                        {5462}out(c, (GetEndpointResponse,pkSess_4702,SignAndEncrypt,SP_4703,UP_4704))
                                                    )
                                                    else
                                                        {5463}let pkSess_4705: bitstring = pub(sk(Sess_3941)) in
                                                        {5464}in(c, =GetEndpointRequest);
                                                        {5465}new SP_4706: bitstring;
                                                        {5466}new UP_4707: bitstring;
                                                        {5467}out(c, (GetEndpointResponse,pkSess_4705,SignAndEncrypt,SP_4706,UP_4707))
                                                )
                                                else
                                                    {5468}let pkSess_4708: bitstring = fail-any in
                                                    {5469}in(c, =GetEndpointRequest);
                                                    {5470}new SP_4709: bitstring;
                                                    {5471}new UP_4710: bitstring;
                                                    {5472}out(c, (GetEndpointResponse,pkSess_4708,SignAndEncrypt,SP_4709,UP_4710))
                                        )
                                        else
                                            {5473}let pkSess_4711: bitstring = fail-any in
                                            {5474}in(c, =GetEndpointRequest);
                                            {5475}new SP_4712: bitstring;
                                            {5476}new UP_4713: bitstring;
                                            {5477}out(c, (GetEndpointResponse,pkSess_4711,SignAndEncrypt,SP_4712,UP_4713))
                                )
                                else
                                    {5478}let pkSess_4714: bitstring = fail-any in
                                    {5479}in(c, =GetEndpointRequest);
                                    {5480}new SP_4715: bitstring;
                                    {5481}new UP_4716: bitstring;
                                    {5482}out(c, (GetEndpointResponse,pkSess_4714,SignAndEncrypt,SP_4715,UP_4716))
                            )
                            else
                                {5483}let v_4717: bool = (Cli_3939 = C) in
                                (
                                    {5484}if v_4717 then
                                    (
                                        {5485}let pkCli_4718: bitstring = pub(skC) in
                                        {5486}let v_4719: bool = (Sess_3941 = A) in
                                        (
                                            {5487}if v_4719 then
                                            (
                                                {5488}let pkSess_4720: bitstring = pub(skA) in
                                                {5489}in(c, =GetEndpointRequest);
                                                {5490}new SP_4721: bitstring;
                                                {5491}new UP_4722: bitstring;
                                                {5492}out(c, (GetEndpointResponse,pkSess_4720,SignAndEncrypt,SP_4721,UP_4722))
                                            )
                                            else
                                                {5493}let v_4723: bool = (Sess_3941 = B) in
                                                (
                                                    {5494}if v_4723 then
                                                    (
                                                        {5495}let pkSess_4724: bitstring = pub(skB) in
                                                        {5496}in(c, =GetEndpointRequest);
                                                        {5497}new SP_4725: bitstring;
                                                        {5498}new UP_4726: bitstring;
                                                        {5499}out(c, (GetEndpointResponse,pkSess_4724,SignAndEncrypt,SP_4725,UP_4726))
                                                    )
                                                    else
                                                        {5500}let v_4727: bool = (Sess_3941 = C) in
                                                        (
                                                            {5501}if v_4727 then
                                                            (
                                                                {5502}let pkSess_4728: bitstring = pub(skC) in
                                                                {5503}in(c, =GetEndpointRequest);
                                                                {5504}new SP_4729: bitstring;
                                                                {5505}new UP_4730: bitstring;
                                                                {5506}out(c, (GetEndpointResponse,pkSess_4728,SignAndEncrypt,SP_4729,UP_4730))
                                                            )
                                                            else
                                                                {5507}let pkSess_4731: bitstring = pub(sk(Sess_3941)) in
                                                                {5508}in(c, =GetEndpointRequest);
                                                                {5509}new SP_4732: bitstring;
                                                                {5510}new UP_4733: bitstring;
                                                                {5511}out(c, (GetEndpointResponse,pkSess_4731,SignAndEncrypt,SP_4732,UP_4733))
                                                        )
                                                        else
                                                            {5512}let pkSess_4734: bitstring = fail-any in
                                                            {5513}in(c, =GetEndpointRequest);
                                                            {5514}new SP_4735: bitstring;
                                                            {5515}new UP_4736: bitstring;
                                                            {5516}out(c, (GetEndpointResponse,pkSess_4734,SignAndEncrypt,SP_4735,UP_4736))
                                                )
                                                else
                                                    {5517}let pkSess_4737: bitstring = fail-any in
                                                    {5518}in(c, =GetEndpointRequest);
                                                    {5519}new SP_4738: bitstring;
                                                    {5520}new UP_4739: bitstring;
                                                    {5521}out(c, (GetEndpointResponse,pkSess_4737,SignAndEncrypt,SP_4738,UP_4739))
                                        )
                                        else
                                            {5522}let pkSess_4740: bitstring = fail-any in
                                            {5523}in(c, =GetEndpointRequest);
                                            {5524}new SP_4741: bitstring;
                                            {5525}new UP_4742: bitstring;
                                            {5526}out(c, (GetEndpointResponse,pkSess_4740,SignAndEncrypt,SP_4741,UP_4742))
                                    )
                                    else
                                        {5527}let pkCli_4743: bitstring = pub(sk(Cli_3939)) in
                                        {5528}let v_4744: bool = (Sess_3941 = A) in
                                        (
                                            {5529}if v_4744 then
                                            (
                                                {5530}let pkSess_4745: bitstring = pub(skA) in
                                                {5531}in(c, =GetEndpointRequest);
                                                {5532}new SP_4746: bitstring;
                                                {5533}new UP_4747: bitstring;
                                                {5534}out(c, (GetEndpointResponse,pkSess_4745,SignAndEncrypt,SP_4746,UP_4747))
                                            )
                                            else
                                                {5535}let v_4748: bool = (Sess_3941 = B) in
                                                (
                                                    {5536}if v_4748 then
                                                    (
                                                        {5537}let pkSess_4749: bitstring = pub(skB) in
                                                        {5538}in(c, =GetEndpointRequest);
                                                        {5539}new SP_4750: bitstring;
                                                        {5540}new UP_4751: bitstring;
                                                        {5541}out(c, (GetEndpointResponse,pkSess_4749,SignAndEncrypt,SP_4750,UP_4751))
                                                    )
                                                    else
                                                        {5542}let v_4752: bool = (Sess_3941 = C) in
                                                        (
                                                            {5543}if v_4752 then
                                                            (
                                                                {5544}let pkSess_4753: bitstring = pub(skC) in
                                                                {5545}in(c, =GetEndpointRequest);
                                                                {5546}new SP_4754: bitstring;
                                                                {5547}new UP_4755: bitstring;
                                                                {5548}out(c, (GetEndpointResponse,pkSess_4753,SignAndEncrypt,SP_4754,UP_4755))
                                                            )
                                                            else
                                                                {5549}let pkSess_4756: bitstring = pub(sk(Sess_3941)) in
                                                                {5550}in(c, =GetEndpointRequest);
                                                                {5551}new SP_4757: bitstring;
                                                                {5552}new UP_4758: bitstring;
                                                                {5553}out(c, (GetEndpointResponse,pkSess_4756,SignAndEncrypt,SP_4757,UP_4758))
                                                        )
                                                        else
                                                            {5554}let pkSess_4759: bitstring = fail-any in
                                                            {5555}in(c, =GetEndpointRequest);
                                                            {5556}new SP_4760: bitstring;
                                                            {5557}new UP_4761: bitstring;
                                                            {5558}out(c, (GetEndpointResponse,pkSess_4759,SignAndEncrypt,SP_4760,UP_4761))
                                                )
                                                else
                                                    {5559}let pkSess_4762: bitstring = fail-any in
                                                    {5560}in(c, =GetEndpointRequest);
                                                    {5561}new SP_4763: bitstring;
                                                    {5562}new UP_4764: bitstring;
                                                    {5563}out(c, (GetEndpointResponse,pkSess_4762,SignAndEncrypt,SP_4763,UP_4764))
                                        )
                                        else
                                            {5564}let pkSess_4765: bitstring = fail-any in
                                            {5565}in(c, =GetEndpointRequest);
                                            {5566}new SP_4766: bitstring;
                                            {5567}new UP_4767: bitstring;
                                            {5568}out(c, (GetEndpointResponse,pkSess_4765,SignAndEncrypt,SP_4766,UP_4767))
                                )
                                else
                                    {5569}let pkCli_4768: bitstring = fail-any in
                                    {5570}let v_4769: bool = (Sess_3941 = A) in
                                    (
                                        {5571}if v_4769 then
                                        (
                                            {5572}let pkSess_4770: bitstring = pub(skA) in
                                            {5573}in(c, =GetEndpointRequest);
                                            {5574}new SP_4771: bitstring;
                                            {5575}new UP_4772: bitstring;
                                            {5576}out(c, (GetEndpointResponse,pkSess_4770,SignAndEncrypt,SP_4771,UP_4772))
                                        )
                                        else
                                            {5577}let v_4773: bool = (Sess_3941 = B) in
                                            (
                                                {5578}if v_4773 then
                                                (
                                                    {5579}let pkSess_4774: bitstring = pub(skB) in
                                                    {5580}in(c, =GetEndpointRequest);
                                                    {5581}new SP_4775: bitstring;
                                                    {5582}new UP_4776: bitstring;
                                                    {5583}out(c, (GetEndpointResponse,pkSess_4774,SignAndEncrypt,SP_4775,UP_4776))
                                                )
                                                else
                                                    {5584}let v_4777: bool = (Sess_3941 = C) in
                                                    (
                                                        {5585}if v_4777 then
                                                        (
                                                            {5586}let pkSess_4778: bitstring = pub(skC) in
                                                            {5587}in(c, =GetEndpointRequest);
                                                            {5588}new SP_4779: bitstring;
                                                            {5589}new UP_4780: bitstring;
                                                            {5590}out(c, (GetEndpointResponse,pkSess_4778,SignAndEncrypt,SP_4779,UP_4780))
                                                        )
                                                        else
                                                            {5591}let pkSess_4781: bitstring = pub(sk(Sess_3941)) in
                                                            {5592}in(c, =GetEndpointRequest);
                                                            {5593}new SP_4782: bitstring;
                                                            {5594}new UP_4783: bitstring;
                                                            {5595}out(c, (GetEndpointResponse,pkSess_4781,SignAndEncrypt,SP_4782,UP_4783))
                                                    )
                                                    else
                                                        {5596}let pkSess_4784: bitstring = fail-any in
                                                        {5597}in(c, =GetEndpointRequest);
                                                        {5598}new SP_4785: bitstring;
                                                        {5599}new UP_4786: bitstring;
                                                        {5600}out(c, (GetEndpointResponse,pkSess_4784,SignAndEncrypt,SP_4785,UP_4786))
                                            )
                                            else
                                                {5601}let pkSess_4787: bitstring = fail-any in
                                                {5602}in(c, =GetEndpointRequest);
                                                {5603}new SP_4788: bitstring;
                                                {5604}new UP_4789: bitstring;
                                                {5605}out(c, (GetEndpointResponse,pkSess_4787,SignAndEncrypt,SP_4788,UP_4789))
                                    )
                                    else
                                        {5606}let pkSess_4790: bitstring = fail-any in
                                        {5607}in(c, =GetEndpointRequest);
                                        {5608}new SP_4791: bitstring;
                                        {5609}new UP_4792: bitstring;
                                        {5610}out(c, (GetEndpointResponse,pkSess_4790,SignAndEncrypt,SP_4791,UP_4792))
                        )
                        else
                            {5611}let pkCli_4793: bitstring = fail-any in
                            {5612}let v_4794: bool = (Sess_3941 = A) in
                            (
                                {5613}if v_4794 then
                                (
                                    {5614}let pkSess_4795: bitstring = pub(skA) in
                                    {5615}in(c, =GetEndpointRequest);
                                    {5616}new SP_4796: bitstring;
                                    {5617}new UP_4797: bitstring;
                                    {5618}out(c, (GetEndpointResponse,pkSess_4795,SignAndEncrypt,SP_4796,UP_4797))
                                )
                                else
                                    {5619}let v_4798: bool = (Sess_3941 = B) in
                                    (
                                        {5620}if v_4798 then
                                        (
                                            {5621}let pkSess_4799: bitstring = pub(skB) in
                                            {5622}in(c, =GetEndpointRequest);
                                            {5623}new SP_4800: bitstring;
                                            {5624}new UP_4801: bitstring;
                                            {5625}out(c, (GetEndpointResponse,pkSess_4799,SignAndEncrypt,SP_4800,UP_4801))
                                        )
                                        else
                                            {5626}let v_4802: bool = (Sess_3941 = C) in
                                            (
                                                {5627}if v_4802 then
                                                (
                                                    {5628}let pkSess_4803: bitstring = pub(skC) in
                                                    {5629}in(c, =GetEndpointRequest);
                                                    {5630}new SP_4804: bitstring;
                                                    {5631}new UP_4805: bitstring;
                                                    {5632}out(c, (GetEndpointResponse,pkSess_4803,SignAndEncrypt,SP_4804,UP_4805))
                                                )
                                                else
                                                    {5633}let pkSess_4806: bitstring = pub(sk(Sess_3941)) in
                                                    {5634}in(c, =GetEndpointRequest);
                                                    {5635}new SP_4807: bitstring;
                                                    {5636}new UP_4808: bitstring;
                                                    {5637}out(c, (GetEndpointResponse,pkSess_4806,SignAndEncrypt,SP_4807,UP_4808))
                                            )
                                            else
                                                {5638}let pkSess_4809: bitstring = fail-any in
                                                {5639}in(c, =GetEndpointRequest);
                                                {5640}new SP_4810: bitstring;
                                                {5641}new UP_4811: bitstring;
                                                {5642}out(c, (GetEndpointResponse,pkSess_4809,SignAndEncrypt,SP_4810,UP_4811))
                                    )
                                    else
                                        {5643}let pkSess_4812: bitstring = fail-any in
                                        {5644}in(c, =GetEndpointRequest);
                                        {5645}new SP_4813: bitstring;
                                        {5646}new UP_4814: bitstring;
                                        {5647}out(c, (GetEndpointResponse,pkSess_4812,SignAndEncrypt,SP_4813,UP_4814))
                            )
                            else
                                {5648}let pkSess_4815: bitstring = fail-any in
                                {5649}in(c, =GetEndpointRequest);
                                {5650}new SP_4816: bitstring;
                                {5651}new UP_4817: bitstring;
                                {5652}out(c, (GetEndpointResponse,pkSess_4815,SignAndEncrypt,SP_4816,UP_4817))
                )
                else
                    {5653}let pkCli_4818: bitstring = fail-any in
                    {5654}let v_4819: bool = (Sess_3941 = A) in
                    (
                        {5655}if v_4819 then
                        (
                            {5656}let pkSess_4820: bitstring = pub(skA) in
                            {5657}in(c, =GetEndpointRequest);
                            {5658}new SP_4821: bitstring;
                            {5659}new UP_4822: bitstring;
                            {5660}out(c, (GetEndpointResponse,pkSess_4820,SignAndEncrypt,SP_4821,UP_4822))
                        )
                        else
                            {5661}let v_4823: bool = (Sess_3941 = B) in
                            (
                                {5662}if v_4823 then
                                (
                                    {5663}let pkSess_4824: bitstring = pub(skB) in
                                    {5664}in(c, =GetEndpointRequest);
                                    {5665}new SP_4825: bitstring;
                                    {5666}new UP_4826: bitstring;
                                    {5667}out(c, (GetEndpointResponse,pkSess_4824,SignAndEncrypt,SP_4825,UP_4826))
                                )
                                else
                                    {5668}let v_4827: bool = (Sess_3941 = C) in
                                    (
                                        {5669}if v_4827 then
                                        (
                                            {5670}let pkSess_4828: bitstring = pub(skC) in
                                            {5671}in(c, =GetEndpointRequest);
                                            {5672}new SP_4829: bitstring;
                                            {5673}new UP_4830: bitstring;
                                            {5674}out(c, (GetEndpointResponse,pkSess_4828,SignAndEncrypt,SP_4829,UP_4830))
                                        )
                                        else
                                            {5675}let pkSess_4831: bitstring = pub(sk(Sess_3941)) in
                                            {5676}in(c, =GetEndpointRequest);
                                            {5677}new SP_4832: bitstring;
                                            {5678}new UP_4833: bitstring;
                                            {5679}out(c, (GetEndpointResponse,pkSess_4831,SignAndEncrypt,SP_4832,UP_4833))
                                    )
                                    else
                                        {5680}let pkSess_4834: bitstring = fail-any in
                                        {5681}in(c, =GetEndpointRequest);
                                        {5682}new SP_4835: bitstring;
                                        {5683}new UP_4836: bitstring;
                                        {5684}out(c, (GetEndpointResponse,pkSess_4834,SignAndEncrypt,SP_4835,UP_4836))
                            )
                            else
                                {5685}let pkSess_4837: bitstring = fail-any in
                                {5686}in(c, =GetEndpointRequest);
                                {5687}new SP_4838: bitstring;
                                {5688}new UP_4839: bitstring;
                                {5689}out(c, (GetEndpointResponse,pkSess_4837,SignAndEncrypt,SP_4838,UP_4839))
                    )
                    else
                        {5690}let pkSess_4840: bitstring = fail-any in
                        {5691}in(c, =GetEndpointRequest);
                        {5692}new SP_4841: bitstring;
                        {5693}new UP_4842: bitstring;
                        {5694}out(c, (GetEndpointResponse,pkSess_4840,SignAndEncrypt,SP_4841,UP_4842))
    )
    else
        {5695}let skDisco_4843: bitstring = fail-any in
        {5696}let pkDisco_4844: bitstring = pub(skDisco_4843) in
        {5697}let v_4845: bool = (Cli_3939 = A) in
        (
            {5698}if v_4845 then
            (
                {5699}let pkCli_4846: bitstring = pub(skA) in
                {5700}let v_4847: bool = (Sess_3941 = A) in
                (
                    {5701}if v_4847 then
                    (
                        {5702}let pkSess_4848: bitstring = pub(skA) in
                        {5703}in(c, =GetEndpointRequest);
                        {5704}new SP_4849: bitstring;
                        {5705}new UP_4850: bitstring;
                        {5706}out(c, (GetEndpointResponse,pkSess_4848,SignAndEncrypt,SP_4849,UP_4850))
                    )
                    else
                        {5707}let v_4851: bool = (Sess_3941 = B) in
                        (
                            {5708}if v_4851 then
                            (
                                {5709}let pkSess_4852: bitstring = pub(skB) in
                                {5710}in(c, =GetEndpointRequest);
                                {5711}new SP_4853: bitstring;
                                {5712}new UP_4854: bitstring;
                                {5713}out(c, (GetEndpointResponse,pkSess_4852,SignAndEncrypt,SP_4853,UP_4854))
                            )
                            else
                                {5714}let v_4855: bool = (Sess_3941 = C) in
                                (
                                    {5715}if v_4855 then
                                    (
                                        {5716}let pkSess_4856: bitstring = pub(skC) in
                                        {5717}in(c, =GetEndpointRequest);
                                        {5718}new SP_4857: bitstring;
                                        {5719}new UP_4858: bitstring;
                                        {5720}out(c, (GetEndpointResponse,pkSess_4856,SignAndEncrypt,SP_4857,UP_4858))
                                    )
                                    else
                                        {5721}let pkSess_4859: bitstring = pub(sk(Sess_3941)) in
                                        {5722}in(c, =GetEndpointRequest);
                                        {5723}new SP_4860: bitstring;
                                        {5724}new UP_4861: bitstring;
                                        {5725}out(c, (GetEndpointResponse,pkSess_4859,SignAndEncrypt,SP_4860,UP_4861))
                                )
                                else
                                    {5726}let pkSess_4862: bitstring = fail-any in
                                    {5727}in(c, =GetEndpointRequest);
                                    {5728}new SP_4863: bitstring;
                                    {5729}new UP_4864: bitstring;
                                    {5730}out(c, (GetEndpointResponse,pkSess_4862,SignAndEncrypt,SP_4863,UP_4864))
                        )
                        else
                            {5731}let pkSess_4865: bitstring = fail-any in
                            {5732}in(c, =GetEndpointRequest);
                            {5733}new SP_4866: bitstring;
                            {5734}new UP_4867: bitstring;
                            {5735}out(c, (GetEndpointResponse,pkSess_4865,SignAndEncrypt,SP_4866,UP_4867))
                )
                else
                    {5736}let pkSess_4868: bitstring = fail-any in
                    {5737}in(c, =GetEndpointRequest);
                    {5738}new SP_4869: bitstring;
                    {5739}new UP_4870: bitstring;
                    {5740}out(c, (GetEndpointResponse,pkSess_4868,SignAndEncrypt,SP_4869,UP_4870))
            )
            else
                {5741}let v_4871: bool = (Cli_3939 = B) in
                (
                    {5742}if v_4871 then
                    (
                        {5743}let pkCli_4872: bitstring = pub(skB) in
                        {5744}let v_4873: bool = (Sess_3941 = A) in
                        (
                            {5745}if v_4873 then
                            (
                                {5746}let pkSess_4874: bitstring = pub(skA) in
                                {5747}in(c, =GetEndpointRequest);
                                {5748}new SP_4875: bitstring;
                                {5749}new UP_4876: bitstring;
                                {5750}out(c, (GetEndpointResponse,pkSess_4874,SignAndEncrypt,SP_4875,UP_4876))
                            )
                            else
                                {5751}let v_4877: bool = (Sess_3941 = B) in
                                (
                                    {5752}if v_4877 then
                                    (
                                        {5753}let pkSess_4878: bitstring = pub(skB) in
                                        {5754}in(c, =GetEndpointRequest);
                                        {5755}new SP_4879: bitstring;
                                        {5756}new UP_4880: bitstring;
                                        {5757}out(c, (GetEndpointResponse,pkSess_4878,SignAndEncrypt,SP_4879,UP_4880))
                                    )
                                    else
                                        {5758}let v_4881: bool = (Sess_3941 = C) in
                                        (
                                            {5759}if v_4881 then
                                            (
                                                {5760}let pkSess_4882: bitstring = pub(skC) in
                                                {5761}in(c, =GetEndpointRequest);
                                                {5762}new SP_4883: bitstring;
                                                {5763}new UP_4884: bitstring;
                                                {5764}out(c, (GetEndpointResponse,pkSess_4882,SignAndEncrypt,SP_4883,UP_4884))
                                            )
                                            else
                                                {5765}let pkSess_4885: bitstring = pub(sk(Sess_3941)) in
                                                {5766}in(c, =GetEndpointRequest);
                                                {5767}new SP_4886: bitstring;
                                                {5768}new UP_4887: bitstring;
                                                {5769}out(c, (GetEndpointResponse,pkSess_4885,SignAndEncrypt,SP_4886,UP_4887))
                                        )
                                        else
                                            {5770}let pkSess_4888: bitstring = fail-any in
                                            {5771}in(c, =GetEndpointRequest);
                                            {5772}new SP_4889: bitstring;
                                            {5773}new UP_4890: bitstring;
                                            {5774}out(c, (GetEndpointResponse,pkSess_4888,SignAndEncrypt,SP_4889,UP_4890))
                                )
                                else
                                    {5775}let pkSess_4891: bitstring = fail-any in
                                    {5776}in(c, =GetEndpointRequest);
                                    {5777}new SP_4892: bitstring;
                                    {5778}new UP_4893: bitstring;
                                    {5779}out(c, (GetEndpointResponse,pkSess_4891,SignAndEncrypt,SP_4892,UP_4893))
                        )
                        else
                            {5780}let pkSess_4894: bitstring = fail-any in
                            {5781}in(c, =GetEndpointRequest);
                            {5782}new SP_4895: bitstring;
                            {5783}new UP_4896: bitstring;
                            {5784}out(c, (GetEndpointResponse,pkSess_4894,SignAndEncrypt,SP_4895,UP_4896))
                    )
                    else
                        {5785}let v_4897: bool = (Cli_3939 = C) in
                        (
                            {5786}if v_4897 then
                            (
                                {5787}let pkCli_4898: bitstring = pub(skC) in
                                {5788}let v_4899: bool = (Sess_3941 = A) in
                                (
                                    {5789}if v_4899 then
                                    (
                                        {5790}let pkSess_4900: bitstring = pub(skA) in
                                        {5791}in(c, =GetEndpointRequest);
                                        {5792}new SP_4901: bitstring;
                                        {5793}new UP_4902: bitstring;
                                        {5794}out(c, (GetEndpointResponse,pkSess_4900,SignAndEncrypt,SP_4901,UP_4902))
                                    )
                                    else
                                        {5795}let v_4903: bool = (Sess_3941 = B) in
                                        (
                                            {5796}if v_4903 then
                                            (
                                                {5797}let pkSess_4904: bitstring = pub(skB) in
                                                {5798}in(c, =GetEndpointRequest);
                                                {5799}new SP_4905: bitstring;
                                                {5800}new UP_4906: bitstring;
                                                {5801}out(c, (GetEndpointResponse,pkSess_4904,SignAndEncrypt,SP_4905,UP_4906))
                                            )
                                            else
                                                {5802}let v_4907: bool = (Sess_3941 = C) in
                                                (
                                                    {5803}if v_4907 then
                                                    (
                                                        {5804}let pkSess_4908: bitstring = pub(skC) in
                                                        {5805}in(c, =GetEndpointRequest);
                                                        {5806}new SP_4909: bitstring;
                                                        {5807}new UP_4910: bitstring;
                                                        {5808}out(c, (GetEndpointResponse,pkSess_4908,SignAndEncrypt,SP_4909,UP_4910))
                                                    )
                                                    else
                                                        {5809}let pkSess_4911: bitstring = pub(sk(Sess_3941)) in
                                                        {5810}in(c, =GetEndpointRequest);
                                                        {5811}new SP_4912: bitstring;
                                                        {5812}new UP_4913: bitstring;
                                                        {5813}out(c, (GetEndpointResponse,pkSess_4911,SignAndEncrypt,SP_4912,UP_4913))
                                                )
                                                else
                                                    {5814}let pkSess_4914: bitstring = fail-any in
                                                    {5815}in(c, =GetEndpointRequest);
                                                    {5816}new SP_4915: bitstring;
                                                    {5817}new UP_4916: bitstring;
                                                    {5818}out(c, (GetEndpointResponse,pkSess_4914,SignAndEncrypt,SP_4915,UP_4916))
                                        )
                                        else
                                            {5819}let pkSess_4917: bitstring = fail-any in
                                            {5820}in(c, =GetEndpointRequest);
                                            {5821}new SP_4918: bitstring;
                                            {5822}new UP_4919: bitstring;
                                            {5823}out(c, (GetEndpointResponse,pkSess_4917,SignAndEncrypt,SP_4918,UP_4919))
                                )
                                else
                                    {5824}let pkSess_4920: bitstring = fail-any in
                                    {5825}in(c, =GetEndpointRequest);
                                    {5826}new SP_4921: bitstring;
                                    {5827}new UP_4922: bitstring;
                                    {5828}out(c, (GetEndpointResponse,pkSess_4920,SignAndEncrypt,SP_4921,UP_4922))
                            )
                            else
                                {5829}let pkCli_4923: bitstring = pub(sk(Cli_3939)) in
                                {5830}let v_4924: bool = (Sess_3941 = A) in
                                (
                                    {5831}if v_4924 then
                                    (
                                        {5832}let pkSess_4925: bitstring = pub(skA) in
                                        {5833}in(c, =GetEndpointRequest);
                                        {5834}new SP_4926: bitstring;
                                        {5835}new UP_4927: bitstring;
                                        {5836}out(c, (GetEndpointResponse,pkSess_4925,SignAndEncrypt,SP_4926,UP_4927))
                                    )
                                    else
                                        {5837}let v_4928: bool = (Sess_3941 = B) in
                                        (
                                            {5838}if v_4928 then
                                            (
                                                {5839}let pkSess_4929: bitstring = pub(skB) in
                                                {5840}in(c, =GetEndpointRequest);
                                                {5841}new SP_4930: bitstring;
                                                {5842}new UP_4931: bitstring;
                                                {5843}out(c, (GetEndpointResponse,pkSess_4929,SignAndEncrypt,SP_4930,UP_4931))
                                            )
                                            else
                                                {5844}let v_4932: bool = (Sess_3941 = C) in
                                                (
                                                    {5845}if v_4932 then
                                                    (
                                                        {5846}let pkSess_4933: bitstring = pub(skC) in
                                                        {5847}in(c, =GetEndpointRequest);
                                                        {5848}new SP_4934: bitstring;
                                                        {5849}new UP_4935: bitstring;
                                                        {5850}out(c, (GetEndpointResponse,pkSess_4933,SignAndEncrypt,SP_4934,UP_4935))
                                                    )
                                                    else
                                                        {5851}let pkSess_4936: bitstring = pub(sk(Sess_3941)) in
                                                        {5852}in(c, =GetEndpointRequest);
                                                        {5853}new SP_4937: bitstring;
                                                        {5854}new UP_4938: bitstring;
                                                        {5855}out(c, (GetEndpointResponse,pkSess_4936,SignAndEncrypt,SP_4937,UP_4938))
                                                )
                                                else
                                                    {5856}let pkSess_4939: bitstring = fail-any in
                                                    {5857}in(c, =GetEndpointRequest);
                                                    {5858}new SP_4940: bitstring;
                                                    {5859}new UP_4941: bitstring;
                                                    {5860}out(c, (GetEndpointResponse,pkSess_4939,SignAndEncrypt,SP_4940,UP_4941))
                                        )
                                        else
                                            {5861}let pkSess_4942: bitstring = fail-any in
                                            {5862}in(c, =GetEndpointRequest);
                                            {5863}new SP_4943: bitstring;
                                            {5864}new UP_4944: bitstring;
                                            {5865}out(c, (GetEndpointResponse,pkSess_4942,SignAndEncrypt,SP_4943,UP_4944))
                                )
                                else
                                    {5866}let pkSess_4945: bitstring = fail-any in
                                    {5867}in(c, =GetEndpointRequest);
                                    {5868}new SP_4946: bitstring;
                                    {5869}new UP_4947: bitstring;
                                    {5870}out(c, (GetEndpointResponse,pkSess_4945,SignAndEncrypt,SP_4946,UP_4947))
                        )
                        else
                            {5871}let pkCli_4948: bitstring = fail-any in
                            {5872}let v_4949: bool = (Sess_3941 = A) in
                            (
                                {5873}if v_4949 then
                                (
                                    {5874}let pkSess_4950: bitstring = pub(skA) in
                                    {5875}in(c, =GetEndpointRequest);
                                    {5876}new SP_4951: bitstring;
                                    {5877}new UP_4952: bitstring;
                                    {5878}out(c, (GetEndpointResponse,pkSess_4950,SignAndEncrypt,SP_4951,UP_4952))
                                )
                                else
                                    {5879}let v_4953: bool = (Sess_3941 = B) in
                                    (
                                        {5880}if v_4953 then
                                        (
                                            {5881}let pkSess_4954: bitstring = pub(skB) in
                                            {5882}in(c, =GetEndpointRequest);
                                            {5883}new SP_4955: bitstring;
                                            {5884}new UP_4956: bitstring;
                                            {5885}out(c, (GetEndpointResponse,pkSess_4954,SignAndEncrypt,SP_4955,UP_4956))
                                        )
                                        else
                                            {5886}let v_4957: bool = (Sess_3941 = C) in
                                            (
                                                {5887}if v_4957 then
                                                (
                                                    {5888}let pkSess_4958: bitstring = pub(skC) in
                                                    {5889}in(c, =GetEndpointRequest);
                                                    {5890}new SP_4959: bitstring;
                                                    {5891}new UP_4960: bitstring;
                                                    {5892}out(c, (GetEndpointResponse,pkSess_4958,SignAndEncrypt,SP_4959,UP_4960))
                                                )
                                                else
                                                    {5893}let pkSess_4961: bitstring = pub(sk(Sess_3941)) in
                                                    {5894}in(c, =GetEndpointRequest);
                                                    {5895}new SP_4962: bitstring;
                                                    {5896}new UP_4963: bitstring;
                                                    {5897}out(c, (GetEndpointResponse,pkSess_4961,SignAndEncrypt,SP_4962,UP_4963))
                                            )
                                            else
                                                {5898}let pkSess_4964: bitstring = fail-any in
                                                {5899}in(c, =GetEndpointRequest);
                                                {5900}new SP_4965: bitstring;
                                                {5901}new UP_4966: bitstring;
                                                {5902}out(c, (GetEndpointResponse,pkSess_4964,SignAndEncrypt,SP_4965,UP_4966))
                                    )
                                    else
                                        {5903}let pkSess_4967: bitstring = fail-any in
                                        {5904}in(c, =GetEndpointRequest);
                                        {5905}new SP_4968: bitstring;
                                        {5906}new UP_4969: bitstring;
                                        {5907}out(c, (GetEndpointResponse,pkSess_4967,SignAndEncrypt,SP_4968,UP_4969))
                            )
                            else
                                {5908}let pkSess_4970: bitstring = fail-any in
                                {5909}in(c, =GetEndpointRequest);
                                {5910}new SP_4971: bitstring;
                                {5911}new UP_4972: bitstring;
                                {5912}out(c, (GetEndpointResponse,pkSess_4970,SignAndEncrypt,SP_4971,UP_4972))
                )
                else
                    {5913}let pkCli_4973: bitstring = fail-any in
                    {5914}let v_4974: bool = (Sess_3941 = A) in
                    (
                        {5915}if v_4974 then
                        (
                            {5916}let pkSess_4975: bitstring = pub(skA) in
                            {5917}in(c, =GetEndpointRequest);
                            {5918}new SP_4976: bitstring;
                            {5919}new UP_4977: bitstring;
                            {5920}out(c, (GetEndpointResponse,pkSess_4975,SignAndEncrypt,SP_4976,UP_4977))
                        )
                        else
                            {5921}let v_4978: bool = (Sess_3941 = B) in
                            (
                                {5922}if v_4978 then
                                (
                                    {5923}let pkSess_4979: bitstring = pub(skB) in
                                    {5924}in(c, =GetEndpointRequest);
                                    {5925}new SP_4980: bitstring;
                                    {5926}new UP_4981: bitstring;
                                    {5927}out(c, (GetEndpointResponse,pkSess_4979,SignAndEncrypt,SP_4980,UP_4981))
                                )
                                else
                                    {5928}let v_4982: bool = (Sess_3941 = C) in
                                    (
                                        {5929}if v_4982 then
                                        (
                                            {5930}let pkSess_4983: bitstring = pub(skC) in
                                            {5931}in(c, =GetEndpointRequest);
                                            {5932}new SP_4984: bitstring;
                                            {5933}new UP_4985: bitstring;
                                            {5934}out(c, (GetEndpointResponse,pkSess_4983,SignAndEncrypt,SP_4984,UP_4985))
                                        )
                                        else
                                            {5935}let pkSess_4986: bitstring = pub(sk(Sess_3941)) in
                                            {5936}in(c, =GetEndpointRequest);
                                            {5937}new SP_4987: bitstring;
                                            {5938}new UP_4988: bitstring;
                                            {5939}out(c, (GetEndpointResponse,pkSess_4986,SignAndEncrypt,SP_4987,UP_4988))
                                    )
                                    else
                                        {5940}let pkSess_4989: bitstring = fail-any in
                                        {5941}in(c, =GetEndpointRequest);
                                        {5942}new SP_4990: bitstring;
                                        {5943}new UP_4991: bitstring;
                                        {5944}out(c, (GetEndpointResponse,pkSess_4989,SignAndEncrypt,SP_4990,UP_4991))
                            )
                            else
                                {5945}let pkSess_4992: bitstring = fail-any in
                                {5946}in(c, =GetEndpointRequest);
                                {5947}new SP_4993: bitstring;
                                {5948}new UP_4994: bitstring;
                                {5949}out(c, (GetEndpointResponse,pkSess_4992,SignAndEncrypt,SP_4993,UP_4994))
                    )
                    else
                        {5950}let pkSess_4995: bitstring = fail-any in
                        {5951}in(c, =GetEndpointRequest);
                        {5952}new SP_4996: bitstring;
                        {5953}new UP_4997: bitstring;
                        {5954}out(c, (GetEndpointResponse,pkSess_4995,SignAndEncrypt,SP_4996,UP_4997))
        )
        else
            {5955}let pkCli_4998: bitstring = fail-any in
            {5956}let v_4999: bool = (Sess_3941 = A) in
            (
                {5957}if v_4999 then
                (
                    {5958}let pkSess_5000: bitstring = pub(skA) in
                    {5959}in(c, =GetEndpointRequest);
                    {5960}new SP_5001: bitstring;
                    {5961}new UP_5002: bitstring;
                    {5962}out(c, (GetEndpointResponse,pkSess_5000,SignAndEncrypt,SP_5001,UP_5002))
                )
                else
                    {5963}let v_5003: bool = (Sess_3941 = B) in
                    (
                        {5964}if v_5003 then
                        (
                            {5965}let pkSess_5004: bitstring = pub(skB) in
                            {5966}in(c, =GetEndpointRequest);
                            {5967}new SP_5005: bitstring;
                            {5968}new UP_5006: bitstring;
                            {5969}out(c, (GetEndpointResponse,pkSess_5004,SignAndEncrypt,SP_5005,UP_5006))
                        )
                        else
                            {5970}let v_5007: bool = (Sess_3941 = C) in
                            (
                                {5971}if v_5007 then
                                (
                                    {5972}let pkSess_5008: bitstring = pub(skC) in
                                    {5973}in(c, =GetEndpointRequest);
                                    {5974}new SP_5009: bitstring;
                                    {5975}new UP_5010: bitstring;
                                    {5976}out(c, (GetEndpointResponse,pkSess_5008,SignAndEncrypt,SP_5009,UP_5010))
                                )
                                else
                                    {5977}let pkSess_5011: bitstring = pub(sk(Sess_3941)) in
                                    {5978}in(c, =GetEndpointRequest);
                                    {5979}new SP_5012: bitstring;
                                    {5980}new UP_5013: bitstring;
                                    {5981}out(c, (GetEndpointResponse,pkSess_5011,SignAndEncrypt,SP_5012,UP_5013))
                            )
                            else
                                {5982}let pkSess_5014: bitstring = fail-any in
                                {5983}in(c, =GetEndpointRequest);
                                {5984}new SP_5015: bitstring;
                                {5985}new UP_5016: bitstring;
                                {5986}out(c, (GetEndpointResponse,pkSess_5014,SignAndEncrypt,SP_5015,UP_5016))
                    )
                    else
                        {5987}let pkSess_5017: bitstring = fail-any in
                        {5988}in(c, =GetEndpointRequest);
                        {5989}new SP_5018: bitstring;
                        {5990}new UP_5019: bitstring;
                        {5991}out(c, (GetEndpointResponse,pkSess_5017,SignAndEncrypt,SP_5018,UP_5019))
            )
            else
                {5992}let pkSess_5020: bitstring = fail-any in
                {5993}in(c, =GetEndpointRequest);
                {5994}new SP_5021: bitstring;
                {5995}new UP_5022: bitstring;
                {5996}out(c, (GetEndpointResponse,pkSess_5020,SignAndEncrypt,SP_5021,UP_5022))
) | (
    {5997}!
    {5998}in(c, (Cli_5023: host,Disco_5024: host,Sess_5025: host));
    {5999}let v_5026: bool = (Sess_5025 = A) in
    (
        {6000}if v_5026 then
        (
            {6001}let skSess: bitstring = skA in
            {6002}let pkSess_5027: bitstring = pub(skSess) in
            {6003}let v_5028: bool = (Cli_5023 = A) in
            (
                {6004}if v_5028 then
                (
                    {6005}let pkCli_5029: bitstring = pub(skA) in
                    {6006}let v_5030: bool = (Disco_5024 = A) in
                    (
                        {6007}if v_5030 then
                        (
                            {6008}let pkDisco_5031: bitstring = pub(skA) in
                            {6009}in(c, (=pkCli_5029,em1: bitstring,sigM1: bitstring));
                            {6010}let m1_5032: bitstring = dec(em1,skSess) in
                            {6011}if (verify(h(m1_5032),sigM1,pkCli_5029) <> true) then
                                0
                            else
                                {6012}let (=OpenSecureChannelRequest,=pkCli_5029,Nc_5033: bitstring) = m1_5032 in
                                {6013}new Ns_5034: bitstring;
                                {6014}new ST_5035: bitstring;
                                {6015}new TTL_5036: bitstring;
                                {6016}let m2_5037: bitstring = (OpenSecureChannelResponse,Ns_5034,ST_5035,TTL_5036) in
                                {6017}event beginSrv(Sess_5025,Cli_5023,Ns_5034);
                                {6018}out(c, (enc(m2_5037,pkCli_5029),sign(h(m2_5037),skSess)));
                                {6019}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                {6020}event endSrv(Cli_5023,Sess_5025,Nc_5033)
                        )
                        else
                            {6021}let v_5038: bool = (Disco_5024 = B) in
                            (
                                {6022}if v_5038 then
                                (
                                    {6023}let pkDisco_5039: bitstring = pub(skB) in
                                    {6024}in(c, (=pkCli_5029,em1_5040: bitstring,sigM1_5041: bitstring));
                                    {6025}let m1_5042: bitstring = dec(em1_5040,skSess) in
                                    {6026}if (verify(h(m1_5042),sigM1_5041,pkCli_5029) <> true) then
                                        0
                                    else
                                        {6027}let (=OpenSecureChannelRequest,=pkCli_5029,Nc_5043: bitstring) = m1_5042 in
                                        {6028}new Ns_5044: bitstring;
                                        {6029}new ST_5045: bitstring;
                                        {6030}new TTL_5046: bitstring;
                                        {6031}let m2_5047: bitstring = (OpenSecureChannelResponse,Ns_5044,ST_5045,TTL_5046) in
                                        {6032}event beginSrv(Sess_5025,Cli_5023,Ns_5044);
                                        {6033}out(c, (enc(m2_5047,pkCli_5029),sign(h(m2_5047),skSess)));
                                        {6034}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                        {6035}event endSrv(Cli_5023,Sess_5025,Nc_5043)
                                )
                                else
                                    {6036}let v_5048: bool = (Disco_5024 = C) in
                                    (
                                        {6037}if v_5048 then
                                        (
                                            {6038}let pkDisco_5049: bitstring = pub(skC) in
                                            {6039}in(c, (=pkCli_5029,em1_5050: bitstring,sigM1_5051: bitstring));
                                            {6040}let m1_5052: bitstring = dec(em1_5050,skSess) in
                                            {6041}if (verify(h(m1_5052),sigM1_5051,pkCli_5029) <> true) then
                                                0
                                            else
                                                {6042}let (=OpenSecureChannelRequest,=pkCli_5029,Nc_5053: bitstring) = m1_5052 in
                                                {6043}new Ns_5054: bitstring;
                                                {6044}new ST_5055: bitstring;
                                                {6045}new TTL_5056: bitstring;
                                                {6046}let m2_5057: bitstring = (OpenSecureChannelResponse,Ns_5054,ST_5055,TTL_5056) in
                                                {6047}event beginSrv(Sess_5025,Cli_5023,Ns_5054);
                                                {6048}out(c, (enc(m2_5057,pkCli_5029),sign(h(m2_5057),skSess)));
                                                {6049}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                {6050}event endSrv(Cli_5023,Sess_5025,Nc_5053)
                                        )
                                        else
                                            {6051}let pkDisco_5058: bitstring = pub(sk(Disco_5024)) in
                                            {6052}in(c, (=pkCli_5029,em1_5059: bitstring,sigM1_5060: bitstring));
                                            {6053}let m1_5061: bitstring = dec(em1_5059,skSess) in
                                            {6054}if (verify(h(m1_5061),sigM1_5060,pkCli_5029) <> true) then
                                                0
                                            else
                                                {6055}let (=OpenSecureChannelRequest,=pkCli_5029,Nc_5062: bitstring) = m1_5061 in
                                                {6056}new Ns_5063: bitstring;
                                                {6057}new ST_5064: bitstring;
                                                {6058}new TTL_5065: bitstring;
                                                {6059}let m2_5066: bitstring = (OpenSecureChannelResponse,Ns_5063,ST_5064,TTL_5065) in
                                                {6060}event beginSrv(Sess_5025,Cli_5023,Ns_5063);
                                                {6061}out(c, (enc(m2_5066,pkCli_5029),sign(h(m2_5066),skSess)));
                                                {6062}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                {6063}event endSrv(Cli_5023,Sess_5025,Nc_5062)
                                    )
                                    else
                                        {6064}let pkDisco_5067: bitstring = fail-any in
                                        {6065}in(c, (=pkCli_5029,em1_5068: bitstring,sigM1_5069: bitstring));
                                        {6066}let m1_5070: bitstring = dec(em1_5068,skSess) in
                                        {6067}if (verify(h(m1_5070),sigM1_5069,pkCli_5029) <> true) then
                                            0
                                        else
                                            {6068}let (=OpenSecureChannelRequest,=pkCli_5029,Nc_5071: bitstring) = m1_5070 in
                                            {6069}new Ns_5072: bitstring;
                                            {6070}new ST_5073: bitstring;
                                            {6071}new TTL_5074: bitstring;
                                            {6072}let m2_5075: bitstring = (OpenSecureChannelResponse,Ns_5072,ST_5073,TTL_5074) in
                                            {6073}event beginSrv(Sess_5025,Cli_5023,Ns_5072);
                                            {6074}out(c, (enc(m2_5075,pkCli_5029),sign(h(m2_5075),skSess)));
                                            {6075}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                            {6076}event endSrv(Cli_5023,Sess_5025,Nc_5071)
                            )
                            else
                                {6077}let pkDisco_5076: bitstring = fail-any in
                                {6078}in(c, (=pkCli_5029,em1_5077: bitstring,sigM1_5078: bitstring));
                                {6079}let m1_5079: bitstring = dec(em1_5077,skSess) in
                                {6080}if (verify(h(m1_5079),sigM1_5078,pkCli_5029) <> true) then
                                    0
                                else
                                    {6081}let (=OpenSecureChannelRequest,=pkCli_5029,Nc_5080: bitstring) = m1_5079 in
                                    {6082}new Ns_5081: bitstring;
                                    {6083}new ST_5082: bitstring;
                                    {6084}new TTL_5083: bitstring;
                                    {6085}let m2_5084: bitstring = (OpenSecureChannelResponse,Ns_5081,ST_5082,TTL_5083) in
                                    {6086}event beginSrv(Sess_5025,Cli_5023,Ns_5081);
                                    {6087}out(c, (enc(m2_5084,pkCli_5029),sign(h(m2_5084),skSess)));
                                    {6088}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                    {6089}event endSrv(Cli_5023,Sess_5025,Nc_5080)
                    )
                    else
                        {6090}let pkDisco_5085: bitstring = fail-any in
                        {6091}in(c, (=pkCli_5029,em1_5086: bitstring,sigM1_5087: bitstring));
                        {6092}let m1_5088: bitstring = dec(em1_5086,skSess) in
                        {6093}if (verify(h(m1_5088),sigM1_5087,pkCli_5029) <> true) then
                            0
                        else
                            {6094}let (=OpenSecureChannelRequest,=pkCli_5029,Nc_5089: bitstring) = m1_5088 in
                            {6095}new Ns_5090: bitstring;
                            {6096}new ST_5091: bitstring;
                            {6097}new TTL_5092: bitstring;
                            {6098}let m2_5093: bitstring = (OpenSecureChannelResponse,Ns_5090,ST_5091,TTL_5092) in
                            {6099}event beginSrv(Sess_5025,Cli_5023,Ns_5090);
                            {6100}out(c, (enc(m2_5093,pkCli_5029),sign(h(m2_5093),skSess)));
                            {6101}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                            {6102}event endSrv(Cli_5023,Sess_5025,Nc_5089)
                )
                else
                    {6103}let v_5094: bool = (Cli_5023 = B) in
                    (
                        {6104}if v_5094 then
                        (
                            {6105}let pkCli_5095: bitstring = pub(skB) in
                            {6106}let v_5096: bool = (Disco_5024 = A) in
                            (
                                {6107}if v_5096 then
                                (
                                    {6108}let pkDisco_5097: bitstring = pub(skA) in
                                    {6109}in(c, (=pkCli_5095,em1_5098: bitstring,sigM1_5099: bitstring));
                                    {6110}let m1_5100: bitstring = dec(em1_5098,skSess) in
                                    {6111}if (verify(h(m1_5100),sigM1_5099,pkCli_5095) <> true) then
                                        0
                                    else
                                        {6112}let (=OpenSecureChannelRequest,=pkCli_5095,Nc_5101: bitstring) = m1_5100 in
                                        {6113}new Ns_5102: bitstring;
                                        {6114}new ST_5103: bitstring;
                                        {6115}new TTL_5104: bitstring;
                                        {6116}let m2_5105: bitstring = (OpenSecureChannelResponse,Ns_5102,ST_5103,TTL_5104) in
                                        {6117}event beginSrv(Sess_5025,Cli_5023,Ns_5102);
                                        {6118}out(c, (enc(m2_5105,pkCli_5095),sign(h(m2_5105),skSess)));
                                        {6119}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                        {6120}event endSrv(Cli_5023,Sess_5025,Nc_5101)
                                )
                                else
                                    {6121}let v_5106: bool = (Disco_5024 = B) in
                                    (
                                        {6122}if v_5106 then
                                        (
                                            {6123}let pkDisco_5107: bitstring = pub(skB) in
                                            {6124}in(c, (=pkCli_5095,em1_5108: bitstring,sigM1_5109: bitstring));
                                            {6125}let m1_5110: bitstring = dec(em1_5108,skSess) in
                                            {6126}if (verify(h(m1_5110),sigM1_5109,pkCli_5095) <> true) then
                                                0
                                            else
                                                {6127}let (=OpenSecureChannelRequest,=pkCli_5095,Nc_5111: bitstring) = m1_5110 in
                                                {6128}new Ns_5112: bitstring;
                                                {6129}new ST_5113: bitstring;
                                                {6130}new TTL_5114: bitstring;
                                                {6131}let m2_5115: bitstring = (OpenSecureChannelResponse,Ns_5112,ST_5113,TTL_5114) in
                                                {6132}event beginSrv(Sess_5025,Cli_5023,Ns_5112);
                                                {6133}out(c, (enc(m2_5115,pkCli_5095),sign(h(m2_5115),skSess)));
                                                {6134}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                {6135}event endSrv(Cli_5023,Sess_5025,Nc_5111)
                                        )
                                        else
                                            {6136}let v_5116: bool = (Disco_5024 = C) in
                                            (
                                                {6137}if v_5116 then
                                                (
                                                    {6138}let pkDisco_5117: bitstring = pub(skC) in
                                                    {6139}in(c, (=pkCli_5095,em1_5118: bitstring,sigM1_5119: bitstring));
                                                    {6140}let m1_5120: bitstring = dec(em1_5118,skSess) in
                                                    {6141}if (verify(h(m1_5120),sigM1_5119,pkCli_5095) <> true) then
                                                        0
                                                    else
                                                        {6142}let (=OpenSecureChannelRequest,=pkCli_5095,Nc_5121: bitstring) = m1_5120 in
                                                        {6143}new Ns_5122: bitstring;
                                                        {6144}new ST_5123: bitstring;
                                                        {6145}new TTL_5124: bitstring;
                                                        {6146}let m2_5125: bitstring = (OpenSecureChannelResponse,Ns_5122,ST_5123,TTL_5124) in
                                                        {6147}event beginSrv(Sess_5025,Cli_5023,Ns_5122);
                                                        {6148}out(c, (enc(m2_5125,pkCli_5095),sign(h(m2_5125),skSess)));
                                                        {6149}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                        {6150}event endSrv(Cli_5023,Sess_5025,Nc_5121)
                                                )
                                                else
                                                    {6151}let pkDisco_5126: bitstring = pub(sk(Disco_5024)) in
                                                    {6152}in(c, (=pkCli_5095,em1_5127: bitstring,sigM1_5128: bitstring));
                                                    {6153}let m1_5129: bitstring = dec(em1_5127,skSess) in
                                                    {6154}if (verify(h(m1_5129),sigM1_5128,pkCli_5095) <> true) then
                                                        0
                                                    else
                                                        {6155}let (=OpenSecureChannelRequest,=pkCli_5095,Nc_5130: bitstring) = m1_5129 in
                                                        {6156}new Ns_5131: bitstring;
                                                        {6157}new ST_5132: bitstring;
                                                        {6158}new TTL_5133: bitstring;
                                                        {6159}let m2_5134: bitstring = (OpenSecureChannelResponse,Ns_5131,ST_5132,TTL_5133) in
                                                        {6160}event beginSrv(Sess_5025,Cli_5023,Ns_5131);
                                                        {6161}out(c, (enc(m2_5134,pkCli_5095),sign(h(m2_5134),skSess)));
                                                        {6162}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                        {6163}event endSrv(Cli_5023,Sess_5025,Nc_5130)
                                            )
                                            else
                                                {6164}let pkDisco_5135: bitstring = fail-any in
                                                {6165}in(c, (=pkCli_5095,em1_5136: bitstring,sigM1_5137: bitstring));
                                                {6166}let m1_5138: bitstring = dec(em1_5136,skSess) in
                                                {6167}if (verify(h(m1_5138),sigM1_5137,pkCli_5095) <> true) then
                                                    0
                                                else
                                                    {6168}let (=OpenSecureChannelRequest,=pkCli_5095,Nc_5139: bitstring) = m1_5138 in
                                                    {6169}new Ns_5140: bitstring;
                                                    {6170}new ST_5141: bitstring;
                                                    {6171}new TTL_5142: bitstring;
                                                    {6172}let m2_5143: bitstring = (OpenSecureChannelResponse,Ns_5140,ST_5141,TTL_5142) in
                                                    {6173}event beginSrv(Sess_5025,Cli_5023,Ns_5140);
                                                    {6174}out(c, (enc(m2_5143,pkCli_5095),sign(h(m2_5143),skSess)));
                                                    {6175}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                    {6176}event endSrv(Cli_5023,Sess_5025,Nc_5139)
                                    )
                                    else
                                        {6177}let pkDisco_5144: bitstring = fail-any in
                                        {6178}in(c, (=pkCli_5095,em1_5145: bitstring,sigM1_5146: bitstring));
                                        {6179}let m1_5147: bitstring = dec(em1_5145,skSess) in
                                        {6180}if (verify(h(m1_5147),sigM1_5146,pkCli_5095) <> true) then
                                            0
                                        else
                                            {6181}let (=OpenSecureChannelRequest,=pkCli_5095,Nc_5148: bitstring) = m1_5147 in
                                            {6182}new Ns_5149: bitstring;
                                            {6183}new ST_5150: bitstring;
                                            {6184}new TTL_5151: bitstring;
                                            {6185}let m2_5152: bitstring = (OpenSecureChannelResponse,Ns_5149,ST_5150,TTL_5151) in
                                            {6186}event beginSrv(Sess_5025,Cli_5023,Ns_5149);
                                            {6187}out(c, (enc(m2_5152,pkCli_5095),sign(h(m2_5152),skSess)));
                                            {6188}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                            {6189}event endSrv(Cli_5023,Sess_5025,Nc_5148)
                            )
                            else
                                {6190}let pkDisco_5153: bitstring = fail-any in
                                {6191}in(c, (=pkCli_5095,em1_5154: bitstring,sigM1_5155: bitstring));
                                {6192}let m1_5156: bitstring = dec(em1_5154,skSess) in
                                {6193}if (verify(h(m1_5156),sigM1_5155,pkCli_5095) <> true) then
                                    0
                                else
                                    {6194}let (=OpenSecureChannelRequest,=pkCli_5095,Nc_5157: bitstring) = m1_5156 in
                                    {6195}new Ns_5158: bitstring;
                                    {6196}new ST_5159: bitstring;
                                    {6197}new TTL_5160: bitstring;
                                    {6198}let m2_5161: bitstring = (OpenSecureChannelResponse,Ns_5158,ST_5159,TTL_5160) in
                                    {6199}event beginSrv(Sess_5025,Cli_5023,Ns_5158);
                                    {6200}out(c, (enc(m2_5161,pkCli_5095),sign(h(m2_5161),skSess)));
                                    {6201}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                    {6202}event endSrv(Cli_5023,Sess_5025,Nc_5157)
                        )
                        else
                            {6203}let v_5162: bool = (Cli_5023 = C) in
                            (
                                {6204}if v_5162 then
                                (
                                    {6205}let pkCli_5163: bitstring = pub(skC) in
                                    {6206}let v_5164: bool = (Disco_5024 = A) in
                                    (
                                        {6207}if v_5164 then
                                        (
                                            {6208}let pkDisco_5165: bitstring = pub(skA) in
                                            {6209}in(c, (=pkCli_5163,em1_5166: bitstring,sigM1_5167: bitstring));
                                            {6210}let m1_5168: bitstring = dec(em1_5166,skSess) in
                                            {6211}if (verify(h(m1_5168),sigM1_5167,pkCli_5163) <> true) then
                                                0
                                            else
                                                {6212}let (=OpenSecureChannelRequest,=pkCli_5163,Nc_5169: bitstring) = m1_5168 in
                                                {6213}new Ns_5170: bitstring;
                                                {6214}new ST_5171: bitstring;
                                                {6215}new TTL_5172: bitstring;
                                                {6216}let m2_5173: bitstring = (OpenSecureChannelResponse,Ns_5170,ST_5171,TTL_5172) in
                                                {6217}event beginSrv(Sess_5025,Cli_5023,Ns_5170);
                                                {6218}out(c, (enc(m2_5173,pkCli_5163),sign(h(m2_5173),skSess)));
                                                {6219}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                {6220}event endSrv(Cli_5023,Sess_5025,Nc_5169)
                                        )
                                        else
                                            {6221}let v_5174: bool = (Disco_5024 = B) in
                                            (
                                                {6222}if v_5174 then
                                                (
                                                    {6223}let pkDisco_5175: bitstring = pub(skB) in
                                                    {6224}in(c, (=pkCli_5163,em1_5176: bitstring,sigM1_5177: bitstring));
                                                    {6225}let m1_5178: bitstring = dec(em1_5176,skSess) in
                                                    {6226}if (verify(h(m1_5178),sigM1_5177,pkCli_5163) <> true) then
                                                        0
                                                    else
                                                        {6227}let (=OpenSecureChannelRequest,=pkCli_5163,Nc_5179: bitstring) = m1_5178 in
                                                        {6228}new Ns_5180: bitstring;
                                                        {6229}new ST_5181: bitstring;
                                                        {6230}new TTL_5182: bitstring;
                                                        {6231}let m2_5183: bitstring = (OpenSecureChannelResponse,Ns_5180,ST_5181,TTL_5182) in
                                                        {6232}event beginSrv(Sess_5025,Cli_5023,Ns_5180);
                                                        {6233}out(c, (enc(m2_5183,pkCli_5163),sign(h(m2_5183),skSess)));
                                                        {6234}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                        {6235}event endSrv(Cli_5023,Sess_5025,Nc_5179)
                                                )
                                                else
                                                    {6236}let v_5184: bool = (Disco_5024 = C) in
                                                    (
                                                        {6237}if v_5184 then
                                                        (
                                                            {6238}let pkDisco_5185: bitstring = pub(skC) in
                                                            {6239}in(c, (=pkCli_5163,em1_5186: bitstring,sigM1_5187: bitstring));
                                                            {6240}let m1_5188: bitstring = dec(em1_5186,skSess) in
                                                            {6241}if (verify(h(m1_5188),sigM1_5187,pkCli_5163) <> true) then
                                                                0
                                                            else
                                                                {6242}let (=OpenSecureChannelRequest,=pkCli_5163,Nc_5189: bitstring) = m1_5188 in
                                                                {6243}new Ns_5190: bitstring;
                                                                {6244}new ST_5191: bitstring;
                                                                {6245}new TTL_5192: bitstring;
                                                                {6246}let m2_5193: bitstring = (OpenSecureChannelResponse,Ns_5190,ST_5191,TTL_5192) in
                                                                {6247}event beginSrv(Sess_5025,Cli_5023,Ns_5190);
                                                                {6248}out(c, (enc(m2_5193,pkCli_5163),sign(h(m2_5193),skSess)));
                                                                {6249}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                                {6250}event endSrv(Cli_5023,Sess_5025,Nc_5189)
                                                        )
                                                        else
                                                            {6251}let pkDisco_5194: bitstring = pub(sk(Disco_5024)) in
                                                            {6252}in(c, (=pkCli_5163,em1_5195: bitstring,sigM1_5196: bitstring));
                                                            {6253}let m1_5197: bitstring = dec(em1_5195,skSess) in
                                                            {6254}if (verify(h(m1_5197),sigM1_5196,pkCli_5163) <> true) then
                                                                0
                                                            else
                                                                {6255}let (=OpenSecureChannelRequest,=pkCli_5163,Nc_5198: bitstring) = m1_5197 in
                                                                {6256}new Ns_5199: bitstring;
                                                                {6257}new ST_5200: bitstring;
                                                                {6258}new TTL_5201: bitstring;
                                                                {6259}let m2_5202: bitstring = (OpenSecureChannelResponse,Ns_5199,ST_5200,TTL_5201) in
                                                                {6260}event beginSrv(Sess_5025,Cli_5023,Ns_5199);
                                                                {6261}out(c, (enc(m2_5202,pkCli_5163),sign(h(m2_5202),skSess)));
                                                                {6262}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                                {6263}event endSrv(Cli_5023,Sess_5025,Nc_5198)
                                                    )
                                                    else
                                                        {6264}let pkDisco_5203: bitstring = fail-any in
                                                        {6265}in(c, (=pkCli_5163,em1_5204: bitstring,sigM1_5205: bitstring));
                                                        {6266}let m1_5206: bitstring = dec(em1_5204,skSess) in
                                                        {6267}if (verify(h(m1_5206),sigM1_5205,pkCli_5163) <> true) then
                                                            0
                                                        else
                                                            {6268}let (=OpenSecureChannelRequest,=pkCli_5163,Nc_5207: bitstring) = m1_5206 in
                                                            {6269}new Ns_5208: bitstring;
                                                            {6270}new ST_5209: bitstring;
                                                            {6271}new TTL_5210: bitstring;
                                                            {6272}let m2_5211: bitstring = (OpenSecureChannelResponse,Ns_5208,ST_5209,TTL_5210) in
                                                            {6273}event beginSrv(Sess_5025,Cli_5023,Ns_5208);
                                                            {6274}out(c, (enc(m2_5211,pkCli_5163),sign(h(m2_5211),skSess)));
                                                            {6275}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                            {6276}event endSrv(Cli_5023,Sess_5025,Nc_5207)
                                            )
                                            else
                                                {6277}let pkDisco_5212: bitstring = fail-any in
                                                {6278}in(c, (=pkCli_5163,em1_5213: bitstring,sigM1_5214: bitstring));
                                                {6279}let m1_5215: bitstring = dec(em1_5213,skSess) in
                                                {6280}if (verify(h(m1_5215),sigM1_5214,pkCli_5163) <> true) then
                                                    0
                                                else
                                                    {6281}let (=OpenSecureChannelRequest,=pkCli_5163,Nc_5216: bitstring) = m1_5215 in
                                                    {6282}new Ns_5217: bitstring;
                                                    {6283}new ST_5218: bitstring;
                                                    {6284}new TTL_5219: bitstring;
                                                    {6285}let m2_5220: bitstring = (OpenSecureChannelResponse,Ns_5217,ST_5218,TTL_5219) in
                                                    {6286}event beginSrv(Sess_5025,Cli_5023,Ns_5217);
                                                    {6287}out(c, (enc(m2_5220,pkCli_5163),sign(h(m2_5220),skSess)));
                                                    {6288}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                    {6289}event endSrv(Cli_5023,Sess_5025,Nc_5216)
                                    )
                                    else
                                        {6290}let pkDisco_5221: bitstring = fail-any in
                                        {6291}in(c, (=pkCli_5163,em1_5222: bitstring,sigM1_5223: bitstring));
                                        {6292}let m1_5224: bitstring = dec(em1_5222,skSess) in
                                        {6293}if (verify(h(m1_5224),sigM1_5223,pkCli_5163) <> true) then
                                            0
                                        else
                                            {6294}let (=OpenSecureChannelRequest,=pkCli_5163,Nc_5225: bitstring) = m1_5224 in
                                            {6295}new Ns_5226: bitstring;
                                            {6296}new ST_5227: bitstring;
                                            {6297}new TTL_5228: bitstring;
                                            {6298}let m2_5229: bitstring = (OpenSecureChannelResponse,Ns_5226,ST_5227,TTL_5228) in
                                            {6299}event beginSrv(Sess_5025,Cli_5023,Ns_5226);
                                            {6300}out(c, (enc(m2_5229,pkCli_5163),sign(h(m2_5229),skSess)));
                                            {6301}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                            {6302}event endSrv(Cli_5023,Sess_5025,Nc_5225)
                                )
                                else
                                    {6303}let pkCli_5230: bitstring = pub(sk(Cli_5023)) in
                                    {6304}let v_5231: bool = (Disco_5024 = A) in
                                    (
                                        {6305}if v_5231 then
                                        (
                                            {6306}let pkDisco_5232: bitstring = pub(skA) in
                                            {6307}in(c, (=pkCli_5230,em1_5233: bitstring,sigM1_5234: bitstring));
                                            {6308}let m1_5235: bitstring = dec(em1_5233,skSess) in
                                            {6309}if (verify(h(m1_5235),sigM1_5234,pkCli_5230) <> true) then
                                                0
                                            else
                                                {6310}let (=OpenSecureChannelRequest,=pkCli_5230,Nc_5236: bitstring) = m1_5235 in
                                                {6311}new Ns_5237: bitstring;
                                                {6312}new ST_5238: bitstring;
                                                {6313}new TTL_5239: bitstring;
                                                {6314}let m2_5240: bitstring = (OpenSecureChannelResponse,Ns_5237,ST_5238,TTL_5239) in
                                                {6315}event beginSrv(Sess_5025,Cli_5023,Ns_5237);
                                                {6316}out(c, (enc(m2_5240,pkCli_5230),sign(h(m2_5240),skSess)));
                                                {6317}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                {6318}event endSrv(Cli_5023,Sess_5025,Nc_5236)
                                        )
                                        else
                                            {6319}let v_5241: bool = (Disco_5024 = B) in
                                            (
                                                {6320}if v_5241 then
                                                (
                                                    {6321}let pkDisco_5242: bitstring = pub(skB) in
                                                    {6322}in(c, (=pkCli_5230,em1_5243: bitstring,sigM1_5244: bitstring));
                                                    {6323}let m1_5245: bitstring = dec(em1_5243,skSess) in
                                                    {6324}if (verify(h(m1_5245),sigM1_5244,pkCli_5230) <> true) then
                                                        0
                                                    else
                                                        {6325}let (=OpenSecureChannelRequest,=pkCli_5230,Nc_5246: bitstring) = m1_5245 in
                                                        {6326}new Ns_5247: bitstring;
                                                        {6327}new ST_5248: bitstring;
                                                        {6328}new TTL_5249: bitstring;
                                                        {6329}let m2_5250: bitstring = (OpenSecureChannelResponse,Ns_5247,ST_5248,TTL_5249) in
                                                        {6330}event beginSrv(Sess_5025,Cli_5023,Ns_5247);
                                                        {6331}out(c, (enc(m2_5250,pkCli_5230),sign(h(m2_5250),skSess)));
                                                        {6332}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                        {6333}event endSrv(Cli_5023,Sess_5025,Nc_5246)
                                                )
                                                else
                                                    {6334}let v_5251: bool = (Disco_5024 = C) in
                                                    (
                                                        {6335}if v_5251 then
                                                        (
                                                            {6336}let pkDisco_5252: bitstring = pub(skC) in
                                                            {6337}in(c, (=pkCli_5230,em1_5253: bitstring,sigM1_5254: bitstring));
                                                            {6338}let m1_5255: bitstring = dec(em1_5253,skSess) in
                                                            {6339}if (verify(h(m1_5255),sigM1_5254,pkCli_5230) <> true) then
                                                                0
                                                            else
                                                                {6340}let (=OpenSecureChannelRequest,=pkCli_5230,Nc_5256: bitstring) = m1_5255 in
                                                                {6341}new Ns_5257: bitstring;
                                                                {6342}new ST_5258: bitstring;
                                                                {6343}new TTL_5259: bitstring;
                                                                {6344}let m2_5260: bitstring = (OpenSecureChannelResponse,Ns_5257,ST_5258,TTL_5259) in
                                                                {6345}event beginSrv(Sess_5025,Cli_5023,Ns_5257);
                                                                {6346}out(c, (enc(m2_5260,pkCli_5230),sign(h(m2_5260),skSess)));
                                                                {6347}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                                {6348}event endSrv(Cli_5023,Sess_5025,Nc_5256)
                                                        )
                                                        else
                                                            {6349}let pkDisco_5261: bitstring = pub(sk(Disco_5024)) in
                                                            {6350}in(c, (=pkCli_5230,em1_5262: bitstring,sigM1_5263: bitstring));
                                                            {6351}let m1_5264: bitstring = dec(em1_5262,skSess) in
                                                            {6352}if (verify(h(m1_5264),sigM1_5263,pkCli_5230) <> true) then
                                                                0
                                                            else
                                                                {6353}let (=OpenSecureChannelRequest,=pkCli_5230,Nc_5265: bitstring) = m1_5264 in
                                                                {6354}new Ns_5266: bitstring;
                                                                {6355}new ST_5267: bitstring;
                                                                {6356}new TTL_5268: bitstring;
                                                                {6357}let m2_5269: bitstring = (OpenSecureChannelResponse,Ns_5266,ST_5267,TTL_5268) in
                                                                {6358}event beginSrv(Sess_5025,Cli_5023,Ns_5266);
                                                                {6359}out(c, (enc(m2_5269,pkCli_5230),sign(h(m2_5269),skSess)));
                                                                {6360}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                                {6361}event endSrv(Cli_5023,Sess_5025,Nc_5265)
                                                    )
                                                    else
                                                        {6362}let pkDisco_5270: bitstring = fail-any in
                                                        {6363}in(c, (=pkCli_5230,em1_5271: bitstring,sigM1_5272: bitstring));
                                                        {6364}let m1_5273: bitstring = dec(em1_5271,skSess) in
                                                        {6365}if (verify(h(m1_5273),sigM1_5272,pkCli_5230) <> true) then
                                                            0
                                                        else
                                                            {6366}let (=OpenSecureChannelRequest,=pkCli_5230,Nc_5274: bitstring) = m1_5273 in
                                                            {6367}new Ns_5275: bitstring;
                                                            {6368}new ST_5276: bitstring;
                                                            {6369}new TTL_5277: bitstring;
                                                            {6370}let m2_5278: bitstring = (OpenSecureChannelResponse,Ns_5275,ST_5276,TTL_5277) in
                                                            {6371}event beginSrv(Sess_5025,Cli_5023,Ns_5275);
                                                            {6372}out(c, (enc(m2_5278,pkCli_5230),sign(h(m2_5278),skSess)));
                                                            {6373}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                            {6374}event endSrv(Cli_5023,Sess_5025,Nc_5274)
                                            )
                                            else
                                                {6375}let pkDisco_5279: bitstring = fail-any in
                                                {6376}in(c, (=pkCli_5230,em1_5280: bitstring,sigM1_5281: bitstring));
                                                {6377}let m1_5282: bitstring = dec(em1_5280,skSess) in
                                                {6378}if (verify(h(m1_5282),sigM1_5281,pkCli_5230) <> true) then
                                                    0
                                                else
                                                    {6379}let (=OpenSecureChannelRequest,=pkCli_5230,Nc_5283: bitstring) = m1_5282 in
                                                    {6380}new Ns_5284: bitstring;
                                                    {6381}new ST_5285: bitstring;
                                                    {6382}new TTL_5286: bitstring;
                                                    {6383}let m2_5287: bitstring = (OpenSecureChannelResponse,Ns_5284,ST_5285,TTL_5286) in
                                                    {6384}event beginSrv(Sess_5025,Cli_5023,Ns_5284);
                                                    {6385}out(c, (enc(m2_5287,pkCli_5230),sign(h(m2_5287),skSess)));
                                                    {6386}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                    {6387}event endSrv(Cli_5023,Sess_5025,Nc_5283)
                                    )
                                    else
                                        {6388}let pkDisco_5288: bitstring = fail-any in
                                        {6389}in(c, (=pkCli_5230,em1_5289: bitstring,sigM1_5290: bitstring));
                                        {6390}let m1_5291: bitstring = dec(em1_5289,skSess) in
                                        {6391}if (verify(h(m1_5291),sigM1_5290,pkCli_5230) <> true) then
                                            0
                                        else
                                            {6392}let (=OpenSecureChannelRequest,=pkCli_5230,Nc_5292: bitstring) = m1_5291 in
                                            {6393}new Ns_5293: bitstring;
                                            {6394}new ST_5294: bitstring;
                                            {6395}new TTL_5295: bitstring;
                                            {6396}let m2_5296: bitstring = (OpenSecureChannelResponse,Ns_5293,ST_5294,TTL_5295) in
                                            {6397}event beginSrv(Sess_5025,Cli_5023,Ns_5293);
                                            {6398}out(c, (enc(m2_5296,pkCli_5230),sign(h(m2_5296),skSess)));
                                            {6399}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                            {6400}event endSrv(Cli_5023,Sess_5025,Nc_5292)
                            )
                            else
                                {6401}let pkCli_5297: bitstring = fail-any in
                                {6402}let v_5298: bool = (Disco_5024 = A) in
                                (
                                    {6403}if v_5298 then
                                    (
                                        {6404}let pkDisco_5299: bitstring = pub(skA) in
                                        {6405}in(c, (=pkCli_5297,em1_5300: bitstring,sigM1_5301: bitstring));
                                        {6406}let m1_5302: bitstring = dec(em1_5300,skSess) in
                                        {6407}if (verify(h(m1_5302),sigM1_5301,pkCli_5297) <> true) then
                                            0
                                        else
                                            {6408}let (=OpenSecureChannelRequest,=pkCli_5297,Nc_5303: bitstring) = m1_5302 in
                                            {6409}new Ns_5304: bitstring;
                                            {6410}new ST_5305: bitstring;
                                            {6411}new TTL_5306: bitstring;
                                            {6412}let m2_5307: bitstring = (OpenSecureChannelResponse,Ns_5304,ST_5305,TTL_5306) in
                                            {6413}event beginSrv(Sess_5025,Cli_5023,Ns_5304);
                                            {6414}out(c, (enc(m2_5307,pkCli_5297),sign(h(m2_5307),skSess)));
                                            {6415}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                            {6416}event endSrv(Cli_5023,Sess_5025,Nc_5303)
                                    )
                                    else
                                        {6417}let v_5308: bool = (Disco_5024 = B) in
                                        (
                                            {6418}if v_5308 then
                                            (
                                                {6419}let pkDisco_5309: bitstring = pub(skB) in
                                                {6420}in(c, (=pkCli_5297,em1_5310: bitstring,sigM1_5311: bitstring));
                                                {6421}let m1_5312: bitstring = dec(em1_5310,skSess) in
                                                {6422}if (verify(h(m1_5312),sigM1_5311,pkCli_5297) <> true) then
                                                    0
                                                else
                                                    {6423}let (=OpenSecureChannelRequest,=pkCli_5297,Nc_5313: bitstring) = m1_5312 in
                                                    {6424}new Ns_5314: bitstring;
                                                    {6425}new ST_5315: bitstring;
                                                    {6426}new TTL_5316: bitstring;
                                                    {6427}let m2_5317: bitstring = (OpenSecureChannelResponse,Ns_5314,ST_5315,TTL_5316) in
                                                    {6428}event beginSrv(Sess_5025,Cli_5023,Ns_5314);
                                                    {6429}out(c, (enc(m2_5317,pkCli_5297),sign(h(m2_5317),skSess)));
                                                    {6430}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                    {6431}event endSrv(Cli_5023,Sess_5025,Nc_5313)
                                            )
                                            else
                                                {6432}let v_5318: bool = (Disco_5024 = C) in
                                                (
                                                    {6433}if v_5318 then
                                                    (
                                                        {6434}let pkDisco_5319: bitstring = pub(skC) in
                                                        {6435}in(c, (=pkCli_5297,em1_5320: bitstring,sigM1_5321: bitstring));
                                                        {6436}let m1_5322: bitstring = dec(em1_5320,skSess) in
                                                        {6437}if (verify(h(m1_5322),sigM1_5321,pkCli_5297) <> true) then
                                                            0
                                                        else
                                                            {6438}let (=OpenSecureChannelRequest,=pkCli_5297,Nc_5323: bitstring) = m1_5322 in
                                                            {6439}new Ns_5324: bitstring;
                                                            {6440}new ST_5325: bitstring;
                                                            {6441}new TTL_5326: bitstring;
                                                            {6442}let m2_5327: bitstring = (OpenSecureChannelResponse,Ns_5324,ST_5325,TTL_5326) in
                                                            {6443}event beginSrv(Sess_5025,Cli_5023,Ns_5324);
                                                            {6444}out(c, (enc(m2_5327,pkCli_5297),sign(h(m2_5327),skSess)));
                                                            {6445}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                            {6446}event endSrv(Cli_5023,Sess_5025,Nc_5323)
                                                    )
                                                    else
                                                        {6447}let pkDisco_5328: bitstring = pub(sk(Disco_5024)) in
                                                        {6448}in(c, (=pkCli_5297,em1_5329: bitstring,sigM1_5330: bitstring));
                                                        {6449}let m1_5331: bitstring = dec(em1_5329,skSess) in
                                                        {6450}if (verify(h(m1_5331),sigM1_5330,pkCli_5297) <> true) then
                                                            0
                                                        else
                                                            {6451}let (=OpenSecureChannelRequest,=pkCli_5297,Nc_5332: bitstring) = m1_5331 in
                                                            {6452}new Ns_5333: bitstring;
                                                            {6453}new ST_5334: bitstring;
                                                            {6454}new TTL_5335: bitstring;
                                                            {6455}let m2_5336: bitstring = (OpenSecureChannelResponse,Ns_5333,ST_5334,TTL_5335) in
                                                            {6456}event beginSrv(Sess_5025,Cli_5023,Ns_5333);
                                                            {6457}out(c, (enc(m2_5336,pkCli_5297),sign(h(m2_5336),skSess)));
                                                            {6458}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                            {6459}event endSrv(Cli_5023,Sess_5025,Nc_5332)
                                                )
                                                else
                                                    {6460}let pkDisco_5337: bitstring = fail-any in
                                                    {6461}in(c, (=pkCli_5297,em1_5338: bitstring,sigM1_5339: bitstring));
                                                    {6462}let m1_5340: bitstring = dec(em1_5338,skSess) in
                                                    {6463}if (verify(h(m1_5340),sigM1_5339,pkCli_5297) <> true) then
                                                        0
                                                    else
                                                        {6464}let (=OpenSecureChannelRequest,=pkCli_5297,Nc_5341: bitstring) = m1_5340 in
                                                        {6465}new Ns_5342: bitstring;
                                                        {6466}new ST_5343: bitstring;
                                                        {6467}new TTL_5344: bitstring;
                                                        {6468}let m2_5345: bitstring = (OpenSecureChannelResponse,Ns_5342,ST_5343,TTL_5344) in
                                                        {6469}event beginSrv(Sess_5025,Cli_5023,Ns_5342);
                                                        {6470}out(c, (enc(m2_5345,pkCli_5297),sign(h(m2_5345),skSess)));
                                                        {6471}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                        {6472}event endSrv(Cli_5023,Sess_5025,Nc_5341)
                                        )
                                        else
                                            {6473}let pkDisco_5346: bitstring = fail-any in
                                            {6474}in(c, (=pkCli_5297,em1_5347: bitstring,sigM1_5348: bitstring));
                                            {6475}let m1_5349: bitstring = dec(em1_5347,skSess) in
                                            {6476}if (verify(h(m1_5349),sigM1_5348,pkCli_5297) <> true) then
                                                0
                                            else
                                                {6477}let (=OpenSecureChannelRequest,=pkCli_5297,Nc_5350: bitstring) = m1_5349 in
                                                {6478}new Ns_5351: bitstring;
                                                {6479}new ST_5352: bitstring;
                                                {6480}new TTL_5353: bitstring;
                                                {6481}let m2_5354: bitstring = (OpenSecureChannelResponse,Ns_5351,ST_5352,TTL_5353) in
                                                {6482}event beginSrv(Sess_5025,Cli_5023,Ns_5351);
                                                {6483}out(c, (enc(m2_5354,pkCli_5297),sign(h(m2_5354),skSess)));
                                                {6484}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                {6485}event endSrv(Cli_5023,Sess_5025,Nc_5350)
                                )
                                else
                                    {6486}let pkDisco_5355: bitstring = fail-any in
                                    {6487}in(c, (=pkCli_5297,em1_5356: bitstring,sigM1_5357: bitstring));
                                    {6488}let m1_5358: bitstring = dec(em1_5356,skSess) in
                                    {6489}if (verify(h(m1_5358),sigM1_5357,pkCli_5297) <> true) then
                                        0
                                    else
                                        {6490}let (=OpenSecureChannelRequest,=pkCli_5297,Nc_5359: bitstring) = m1_5358 in
                                        {6491}new Ns_5360: bitstring;
                                        {6492}new ST_5361: bitstring;
                                        {6493}new TTL_5362: bitstring;
                                        {6494}let m2_5363: bitstring = (OpenSecureChannelResponse,Ns_5360,ST_5361,TTL_5362) in
                                        {6495}event beginSrv(Sess_5025,Cli_5023,Ns_5360);
                                        {6496}out(c, (enc(m2_5363,pkCli_5297),sign(h(m2_5363),skSess)));
                                        {6497}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                        {6498}event endSrv(Cli_5023,Sess_5025,Nc_5359)
                    )
                    else
                        {6499}let pkCli_5364: bitstring = fail-any in
                        {6500}let v_5365: bool = (Disco_5024 = A) in
                        (
                            {6501}if v_5365 then
                            (
                                {6502}let pkDisco_5366: bitstring = pub(skA) in
                                {6503}in(c, (=pkCli_5364,em1_5367: bitstring,sigM1_5368: bitstring));
                                {6504}let m1_5369: bitstring = dec(em1_5367,skSess) in
                                {6505}if (verify(h(m1_5369),sigM1_5368,pkCli_5364) <> true) then
                                    0
                                else
                                    {6506}let (=OpenSecureChannelRequest,=pkCli_5364,Nc_5370: bitstring) = m1_5369 in
                                    {6507}new Ns_5371: bitstring;
                                    {6508}new ST_5372: bitstring;
                                    {6509}new TTL_5373: bitstring;
                                    {6510}let m2_5374: bitstring = (OpenSecureChannelResponse,Ns_5371,ST_5372,TTL_5373) in
                                    {6511}event beginSrv(Sess_5025,Cli_5023,Ns_5371);
                                    {6512}out(c, (enc(m2_5374,pkCli_5364),sign(h(m2_5374),skSess)));
                                    {6513}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                    {6514}event endSrv(Cli_5023,Sess_5025,Nc_5370)
                            )
                            else
                                {6515}let v_5375: bool = (Disco_5024 = B) in
                                (
                                    {6516}if v_5375 then
                                    (
                                        {6517}let pkDisco_5376: bitstring = pub(skB) in
                                        {6518}in(c, (=pkCli_5364,em1_5377: bitstring,sigM1_5378: bitstring));
                                        {6519}let m1_5379: bitstring = dec(em1_5377,skSess) in
                                        {6520}if (verify(h(m1_5379),sigM1_5378,pkCli_5364) <> true) then
                                            0
                                        else
                                            {6521}let (=OpenSecureChannelRequest,=pkCli_5364,Nc_5380: bitstring) = m1_5379 in
                                            {6522}new Ns_5381: bitstring;
                                            {6523}new ST_5382: bitstring;
                                            {6524}new TTL_5383: bitstring;
                                            {6525}let m2_5384: bitstring = (OpenSecureChannelResponse,Ns_5381,ST_5382,TTL_5383) in
                                            {6526}event beginSrv(Sess_5025,Cli_5023,Ns_5381);
                                            {6527}out(c, (enc(m2_5384,pkCli_5364),sign(h(m2_5384),skSess)));
                                            {6528}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                            {6529}event endSrv(Cli_5023,Sess_5025,Nc_5380)
                                    )
                                    else
                                        {6530}let v_5385: bool = (Disco_5024 = C) in
                                        (
                                            {6531}if v_5385 then
                                            (
                                                {6532}let pkDisco_5386: bitstring = pub(skC) in
                                                {6533}in(c, (=pkCli_5364,em1_5387: bitstring,sigM1_5388: bitstring));
                                                {6534}let m1_5389: bitstring = dec(em1_5387,skSess) in
                                                {6535}if (verify(h(m1_5389),sigM1_5388,pkCli_5364) <> true) then
                                                    0
                                                else
                                                    {6536}let (=OpenSecureChannelRequest,=pkCli_5364,Nc_5390: bitstring) = m1_5389 in
                                                    {6537}new Ns_5391: bitstring;
                                                    {6538}new ST_5392: bitstring;
                                                    {6539}new TTL_5393: bitstring;
                                                    {6540}let m2_5394: bitstring = (OpenSecureChannelResponse,Ns_5391,ST_5392,TTL_5393) in
                                                    {6541}event beginSrv(Sess_5025,Cli_5023,Ns_5391);
                                                    {6542}out(c, (enc(m2_5394,pkCli_5364),sign(h(m2_5394),skSess)));
                                                    {6543}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                    {6544}event endSrv(Cli_5023,Sess_5025,Nc_5390)
                                            )
                                            else
                                                {6545}let pkDisco_5395: bitstring = pub(sk(Disco_5024)) in
                                                {6546}in(c, (=pkCli_5364,em1_5396: bitstring,sigM1_5397: bitstring));
                                                {6547}let m1_5398: bitstring = dec(em1_5396,skSess) in
                                                {6548}if (verify(h(m1_5398),sigM1_5397,pkCli_5364) <> true) then
                                                    0
                                                else
                                                    {6549}let (=OpenSecureChannelRequest,=pkCli_5364,Nc_5399: bitstring) = m1_5398 in
                                                    {6550}new Ns_5400: bitstring;
                                                    {6551}new ST_5401: bitstring;
                                                    {6552}new TTL_5402: bitstring;
                                                    {6553}let m2_5403: bitstring = (OpenSecureChannelResponse,Ns_5400,ST_5401,TTL_5402) in
                                                    {6554}event beginSrv(Sess_5025,Cli_5023,Ns_5400);
                                                    {6555}out(c, (enc(m2_5403,pkCli_5364),sign(h(m2_5403),skSess)));
                                                    {6556}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                    {6557}event endSrv(Cli_5023,Sess_5025,Nc_5399)
                                        )
                                        else
                                            {6558}let pkDisco_5404: bitstring = fail-any in
                                            {6559}in(c, (=pkCli_5364,em1_5405: bitstring,sigM1_5406: bitstring));
                                            {6560}let m1_5407: bitstring = dec(em1_5405,skSess) in
                                            {6561}if (verify(h(m1_5407),sigM1_5406,pkCli_5364) <> true) then
                                                0
                                            else
                                                {6562}let (=OpenSecureChannelRequest,=pkCli_5364,Nc_5408: bitstring) = m1_5407 in
                                                {6563}new Ns_5409: bitstring;
                                                {6564}new ST_5410: bitstring;
                                                {6565}new TTL_5411: bitstring;
                                                {6566}let m2_5412: bitstring = (OpenSecureChannelResponse,Ns_5409,ST_5410,TTL_5411) in
                                                {6567}event beginSrv(Sess_5025,Cli_5023,Ns_5409);
                                                {6568}out(c, (enc(m2_5412,pkCli_5364),sign(h(m2_5412),skSess)));
                                                {6569}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                {6570}event endSrv(Cli_5023,Sess_5025,Nc_5408)
                                )
                                else
                                    {6571}let pkDisco_5413: bitstring = fail-any in
                                    {6572}in(c, (=pkCli_5364,em1_5414: bitstring,sigM1_5415: bitstring));
                                    {6573}let m1_5416: bitstring = dec(em1_5414,skSess) in
                                    {6574}if (verify(h(m1_5416),sigM1_5415,pkCli_5364) <> true) then
                                        0
                                    else
                                        {6575}let (=OpenSecureChannelRequest,=pkCli_5364,Nc_5417: bitstring) = m1_5416 in
                                        {6576}new Ns_5418: bitstring;
                                        {6577}new ST_5419: bitstring;
                                        {6578}new TTL_5420: bitstring;
                                        {6579}let m2_5421: bitstring = (OpenSecureChannelResponse,Ns_5418,ST_5419,TTL_5420) in
                                        {6580}event beginSrv(Sess_5025,Cli_5023,Ns_5418);
                                        {6581}out(c, (enc(m2_5421,pkCli_5364),sign(h(m2_5421),skSess)));
                                        {6582}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                        {6583}event endSrv(Cli_5023,Sess_5025,Nc_5417)
                        )
                        else
                            {6584}let pkDisco_5422: bitstring = fail-any in
                            {6585}in(c, (=pkCli_5364,em1_5423: bitstring,sigM1_5424: bitstring));
                            {6586}let m1_5425: bitstring = dec(em1_5423,skSess) in
                            {6587}if (verify(h(m1_5425),sigM1_5424,pkCli_5364) <> true) then
                                0
                            else
                                {6588}let (=OpenSecureChannelRequest,=pkCli_5364,Nc_5426: bitstring) = m1_5425 in
                                {6589}new Ns_5427: bitstring;
                                {6590}new ST_5428: bitstring;
                                {6591}new TTL_5429: bitstring;
                                {6592}let m2_5430: bitstring = (OpenSecureChannelResponse,Ns_5427,ST_5428,TTL_5429) in
                                {6593}event beginSrv(Sess_5025,Cli_5023,Ns_5427);
                                {6594}out(c, (enc(m2_5430,pkCli_5364),sign(h(m2_5430),skSess)));
                                {6595}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                {6596}event endSrv(Cli_5023,Sess_5025,Nc_5426)
            )
            else
                {6597}let pkCli_5431: bitstring = fail-any in
                {6598}let v_5432: bool = (Disco_5024 = A) in
                (
                    {6599}if v_5432 then
                    (
                        {6600}let pkDisco_5433: bitstring = pub(skA) in
                        {6601}in(c, (=pkCli_5431,em1_5434: bitstring,sigM1_5435: bitstring));
                        {6602}let m1_5436: bitstring = dec(em1_5434,skSess) in
                        {6603}if (verify(h(m1_5436),sigM1_5435,pkCli_5431) <> true) then
                            0
                        else
                            {6604}let (=OpenSecureChannelRequest,=pkCli_5431,Nc_5437: bitstring) = m1_5436 in
                            {6605}new Ns_5438: bitstring;
                            {6606}new ST_5439: bitstring;
                            {6607}new TTL_5440: bitstring;
                            {6608}let m2_5441: bitstring = (OpenSecureChannelResponse,Ns_5438,ST_5439,TTL_5440) in
                            {6609}event beginSrv(Sess_5025,Cli_5023,Ns_5438);
                            {6610}out(c, (enc(m2_5441,pkCli_5431),sign(h(m2_5441),skSess)));
                            {6611}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                            {6612}event endSrv(Cli_5023,Sess_5025,Nc_5437)
                    )
                    else
                        {6613}let v_5442: bool = (Disco_5024 = B) in
                        (
                            {6614}if v_5442 then
                            (
                                {6615}let pkDisco_5443: bitstring = pub(skB) in
                                {6616}in(c, (=pkCli_5431,em1_5444: bitstring,sigM1_5445: bitstring));
                                {6617}let m1_5446: bitstring = dec(em1_5444,skSess) in
                                {6618}if (verify(h(m1_5446),sigM1_5445,pkCli_5431) <> true) then
                                    0
                                else
                                    {6619}let (=OpenSecureChannelRequest,=pkCli_5431,Nc_5447: bitstring) = m1_5446 in
                                    {6620}new Ns_5448: bitstring;
                                    {6621}new ST_5449: bitstring;
                                    {6622}new TTL_5450: bitstring;
                                    {6623}let m2_5451: bitstring = (OpenSecureChannelResponse,Ns_5448,ST_5449,TTL_5450) in
                                    {6624}event beginSrv(Sess_5025,Cli_5023,Ns_5448);
                                    {6625}out(c, (enc(m2_5451,pkCli_5431),sign(h(m2_5451),skSess)));
                                    {6626}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                    {6627}event endSrv(Cli_5023,Sess_5025,Nc_5447)
                            )
                            else
                                {6628}let v_5452: bool = (Disco_5024 = C) in
                                (
                                    {6629}if v_5452 then
                                    (
                                        {6630}let pkDisco_5453: bitstring = pub(skC) in
                                        {6631}in(c, (=pkCli_5431,em1_5454: bitstring,sigM1_5455: bitstring));
                                        {6632}let m1_5456: bitstring = dec(em1_5454,skSess) in
                                        {6633}if (verify(h(m1_5456),sigM1_5455,pkCli_5431) <> true) then
                                            0
                                        else
                                            {6634}let (=OpenSecureChannelRequest,=pkCli_5431,Nc_5457: bitstring) = m1_5456 in
                                            {6635}new Ns_5458: bitstring;
                                            {6636}new ST_5459: bitstring;
                                            {6637}new TTL_5460: bitstring;
                                            {6638}let m2_5461: bitstring = (OpenSecureChannelResponse,Ns_5458,ST_5459,TTL_5460) in
                                            {6639}event beginSrv(Sess_5025,Cli_5023,Ns_5458);
                                            {6640}out(c, (enc(m2_5461,pkCli_5431),sign(h(m2_5461),skSess)));
                                            {6641}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                            {6642}event endSrv(Cli_5023,Sess_5025,Nc_5457)
                                    )
                                    else
                                        {6643}let pkDisco_5462: bitstring = pub(sk(Disco_5024)) in
                                        {6644}in(c, (=pkCli_5431,em1_5463: bitstring,sigM1_5464: bitstring));
                                        {6645}let m1_5465: bitstring = dec(em1_5463,skSess) in
                                        {6646}if (verify(h(m1_5465),sigM1_5464,pkCli_5431) <> true) then
                                            0
                                        else
                                            {6647}let (=OpenSecureChannelRequest,=pkCli_5431,Nc_5466: bitstring) = m1_5465 in
                                            {6648}new Ns_5467: bitstring;
                                            {6649}new ST_5468: bitstring;
                                            {6650}new TTL_5469: bitstring;
                                            {6651}let m2_5470: bitstring = (OpenSecureChannelResponse,Ns_5467,ST_5468,TTL_5469) in
                                            {6652}event beginSrv(Sess_5025,Cli_5023,Ns_5467);
                                            {6653}out(c, (enc(m2_5470,pkCli_5431),sign(h(m2_5470),skSess)));
                                            {6654}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                            {6655}event endSrv(Cli_5023,Sess_5025,Nc_5466)
                                )
                                else
                                    {6656}let pkDisco_5471: bitstring = fail-any in
                                    {6657}in(c, (=pkCli_5431,em1_5472: bitstring,sigM1_5473: bitstring));
                                    {6658}let m1_5474: bitstring = dec(em1_5472,skSess) in
                                    {6659}if (verify(h(m1_5474),sigM1_5473,pkCli_5431) <> true) then
                                        0
                                    else
                                        {6660}let (=OpenSecureChannelRequest,=pkCli_5431,Nc_5475: bitstring) = m1_5474 in
                                        {6661}new Ns_5476: bitstring;
                                        {6662}new ST_5477: bitstring;
                                        {6663}new TTL_5478: bitstring;
                                        {6664}let m2_5479: bitstring = (OpenSecureChannelResponse,Ns_5476,ST_5477,TTL_5478) in
                                        {6665}event beginSrv(Sess_5025,Cli_5023,Ns_5476);
                                        {6666}out(c, (enc(m2_5479,pkCli_5431),sign(h(m2_5479),skSess)));
                                        {6667}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                        {6668}event endSrv(Cli_5023,Sess_5025,Nc_5475)
                        )
                        else
                            {6669}let pkDisco_5480: bitstring = fail-any in
                            {6670}in(c, (=pkCli_5431,em1_5481: bitstring,sigM1_5482: bitstring));
                            {6671}let m1_5483: bitstring = dec(em1_5481,skSess) in
                            {6672}if (verify(h(m1_5483),sigM1_5482,pkCli_5431) <> true) then
                                0
                            else
                                {6673}let (=OpenSecureChannelRequest,=pkCli_5431,Nc_5484: bitstring) = m1_5483 in
                                {6674}new Ns_5485: bitstring;
                                {6675}new ST_5486: bitstring;
                                {6676}new TTL_5487: bitstring;
                                {6677}let m2_5488: bitstring = (OpenSecureChannelResponse,Ns_5485,ST_5486,TTL_5487) in
                                {6678}event beginSrv(Sess_5025,Cli_5023,Ns_5485);
                                {6679}out(c, (enc(m2_5488,pkCli_5431),sign(h(m2_5488),skSess)));
                                {6680}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                {6681}event endSrv(Cli_5023,Sess_5025,Nc_5484)
                )
                else
                    {6682}let pkDisco_5489: bitstring = fail-any in
                    {6683}in(c, (=pkCli_5431,em1_5490: bitstring,sigM1_5491: bitstring));
                    {6684}let m1_5492: bitstring = dec(em1_5490,skSess) in
                    {6685}if (verify(h(m1_5492),sigM1_5491,pkCli_5431) <> true) then
                        0
                    else
                        {6686}let (=OpenSecureChannelRequest,=pkCli_5431,Nc_5493: bitstring) = m1_5492 in
                        {6687}new Ns_5494: bitstring;
                        {6688}new ST_5495: bitstring;
                        {6689}new TTL_5496: bitstring;
                        {6690}let m2_5497: bitstring = (OpenSecureChannelResponse,Ns_5494,ST_5495,TTL_5496) in
                        {6691}event beginSrv(Sess_5025,Cli_5023,Ns_5494);
                        {6692}out(c, (enc(m2_5497,pkCli_5431),sign(h(m2_5497),skSess)));
                        {6693}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                        {6694}event endSrv(Cli_5023,Sess_5025,Nc_5493)
        )
        else
            {6695}let v_5498: bool = (Sess_5025 = B) in
            (
                {6696}if v_5498 then
                (
                    {6697}let skSess_5499: bitstring = skB in
                    {6698}let pkSess_5500: bitstring = pub(skSess_5499) in
                    {6699}let v_5501: bool = (Cli_5023 = A) in
                    (
                        {6700}if v_5501 then
                        (
                            {6701}let pkCli_5502: bitstring = pub(skA) in
                            {6702}let v_5503: bool = (Disco_5024 = A) in
                            (
                                {6703}if v_5503 then
                                (
                                    {6704}let pkDisco_5504: bitstring = pub(skA) in
                                    {6705}in(c, (=pkCli_5502,em1_5505: bitstring,sigM1_5506: bitstring));
                                    {6706}let m1_5507: bitstring = dec(em1_5505,skSess_5499) in
                                    {6707}if (verify(h(m1_5507),sigM1_5506,pkCli_5502) <> true) then
                                        0
                                    else
                                        {6708}let (=OpenSecureChannelRequest,=pkCli_5502,Nc_5508: bitstring) = m1_5507 in
                                        {6709}new Ns_5509: bitstring;
                                        {6710}new ST_5510: bitstring;
                                        {6711}new TTL_5511: bitstring;
                                        {6712}let m2_5512: bitstring = (OpenSecureChannelResponse,Ns_5509,ST_5510,TTL_5511) in
                                        {6713}event beginSrv(Sess_5025,Cli_5023,Ns_5509);
                                        {6714}out(c, (enc(m2_5512,pkCli_5502),sign(h(m2_5512),skSess_5499)));
                                        {6715}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                        {6716}event endSrv(Cli_5023,Sess_5025,Nc_5508)
                                )
                                else
                                    {6717}let v_5513: bool = (Disco_5024 = B) in
                                    (
                                        {6718}if v_5513 then
                                        (
                                            {6719}let pkDisco_5514: bitstring = pub(skB) in
                                            {6720}in(c, (=pkCli_5502,em1_5515: bitstring,sigM1_5516: bitstring));
                                            {6721}let m1_5517: bitstring = dec(em1_5515,skSess_5499) in
                                            {6722}if (verify(h(m1_5517),sigM1_5516,pkCli_5502) <> true) then
                                                0
                                            else
                                                {6723}let (=OpenSecureChannelRequest,=pkCli_5502,Nc_5518: bitstring) = m1_5517 in
                                                {6724}new Ns_5519: bitstring;
                                                {6725}new ST_5520: bitstring;
                                                {6726}new TTL_5521: bitstring;
                                                {6727}let m2_5522: bitstring = (OpenSecureChannelResponse,Ns_5519,ST_5520,TTL_5521) in
                                                {6728}event beginSrv(Sess_5025,Cli_5023,Ns_5519);
                                                {6729}out(c, (enc(m2_5522,pkCli_5502),sign(h(m2_5522),skSess_5499)));
                                                {6730}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                {6731}event endSrv(Cli_5023,Sess_5025,Nc_5518)
                                        )
                                        else
                                            {6732}let v_5523: bool = (Disco_5024 = C) in
                                            (
                                                {6733}if v_5523 then
                                                (
                                                    {6734}let pkDisco_5524: bitstring = pub(skC) in
                                                    {6735}in(c, (=pkCli_5502,em1_5525: bitstring,sigM1_5526: bitstring));
                                                    {6736}let m1_5527: bitstring = dec(em1_5525,skSess_5499) in
                                                    {6737}if (verify(h(m1_5527),sigM1_5526,pkCli_5502) <> true) then
                                                        0
                                                    else
                                                        {6738}let (=OpenSecureChannelRequest,=pkCli_5502,Nc_5528: bitstring) = m1_5527 in
                                                        {6739}new Ns_5529: bitstring;
                                                        {6740}new ST_5530: bitstring;
                                                        {6741}new TTL_5531: bitstring;
                                                        {6742}let m2_5532: bitstring = (OpenSecureChannelResponse,Ns_5529,ST_5530,TTL_5531) in
                                                        {6743}event beginSrv(Sess_5025,Cli_5023,Ns_5529);
                                                        {6744}out(c, (enc(m2_5532,pkCli_5502),sign(h(m2_5532),skSess_5499)));
                                                        {6745}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                        {6746}event endSrv(Cli_5023,Sess_5025,Nc_5528)
                                                )
                                                else
                                                    {6747}let pkDisco_5533: bitstring = pub(sk(Disco_5024)) in
                                                    {6748}in(c, (=pkCli_5502,em1_5534: bitstring,sigM1_5535: bitstring));
                                                    {6749}let m1_5536: bitstring = dec(em1_5534,skSess_5499) in
                                                    {6750}if (verify(h(m1_5536),sigM1_5535,pkCli_5502) <> true) then
                                                        0
                                                    else
                                                        {6751}let (=OpenSecureChannelRequest,=pkCli_5502,Nc_5537: bitstring) = m1_5536 in
                                                        {6752}new Ns_5538: bitstring;
                                                        {6753}new ST_5539: bitstring;
                                                        {6754}new TTL_5540: bitstring;
                                                        {6755}let m2_5541: bitstring = (OpenSecureChannelResponse,Ns_5538,ST_5539,TTL_5540) in
                                                        {6756}event beginSrv(Sess_5025,Cli_5023,Ns_5538);
                                                        {6757}out(c, (enc(m2_5541,pkCli_5502),sign(h(m2_5541),skSess_5499)));
                                                        {6758}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                        {6759}event endSrv(Cli_5023,Sess_5025,Nc_5537)
                                            )
                                            else
                                                {6760}let pkDisco_5542: bitstring = fail-any in
                                                {6761}in(c, (=pkCli_5502,em1_5543: bitstring,sigM1_5544: bitstring));
                                                {6762}let m1_5545: bitstring = dec(em1_5543,skSess_5499) in
                                                {6763}if (verify(h(m1_5545),sigM1_5544,pkCli_5502) <> true) then
                                                    0
                                                else
                                                    {6764}let (=OpenSecureChannelRequest,=pkCli_5502,Nc_5546: bitstring) = m1_5545 in
                                                    {6765}new Ns_5547: bitstring;
                                                    {6766}new ST_5548: bitstring;
                                                    {6767}new TTL_5549: bitstring;
                                                    {6768}let m2_5550: bitstring = (OpenSecureChannelResponse,Ns_5547,ST_5548,TTL_5549) in
                                                    {6769}event beginSrv(Sess_5025,Cli_5023,Ns_5547);
                                                    {6770}out(c, (enc(m2_5550,pkCli_5502),sign(h(m2_5550),skSess_5499)));
                                                    {6771}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                    {6772}event endSrv(Cli_5023,Sess_5025,Nc_5546)
                                    )
                                    else
                                        {6773}let pkDisco_5551: bitstring = fail-any in
                                        {6774}in(c, (=pkCli_5502,em1_5552: bitstring,sigM1_5553: bitstring));
                                        {6775}let m1_5554: bitstring = dec(em1_5552,skSess_5499) in
                                        {6776}if (verify(h(m1_5554),sigM1_5553,pkCli_5502) <> true) then
                                            0
                                        else
                                            {6777}let (=OpenSecureChannelRequest,=pkCli_5502,Nc_5555: bitstring) = m1_5554 in
                                            {6778}new Ns_5556: bitstring;
                                            {6779}new ST_5557: bitstring;
                                            {6780}new TTL_5558: bitstring;
                                            {6781}let m2_5559: bitstring = (OpenSecureChannelResponse,Ns_5556,ST_5557,TTL_5558) in
                                            {6782}event beginSrv(Sess_5025,Cli_5023,Ns_5556);
                                            {6783}out(c, (enc(m2_5559,pkCli_5502),sign(h(m2_5559),skSess_5499)));
                                            {6784}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                            {6785}event endSrv(Cli_5023,Sess_5025,Nc_5555)
                            )
                            else
                                {6786}let pkDisco_5560: bitstring = fail-any in
                                {6787}in(c, (=pkCli_5502,em1_5561: bitstring,sigM1_5562: bitstring));
                                {6788}let m1_5563: bitstring = dec(em1_5561,skSess_5499) in
                                {6789}if (verify(h(m1_5563),sigM1_5562,pkCli_5502) <> true) then
                                    0
                                else
                                    {6790}let (=OpenSecureChannelRequest,=pkCli_5502,Nc_5564: bitstring) = m1_5563 in
                                    {6791}new Ns_5565: bitstring;
                                    {6792}new ST_5566: bitstring;
                                    {6793}new TTL_5567: bitstring;
                                    {6794}let m2_5568: bitstring = (OpenSecureChannelResponse,Ns_5565,ST_5566,TTL_5567) in
                                    {6795}event beginSrv(Sess_5025,Cli_5023,Ns_5565);
                                    {6796}out(c, (enc(m2_5568,pkCli_5502),sign(h(m2_5568),skSess_5499)));
                                    {6797}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                    {6798}event endSrv(Cli_5023,Sess_5025,Nc_5564)
                        )
                        else
                            {6799}let v_5569: bool = (Cli_5023 = B) in
                            (
                                {6800}if v_5569 then
                                (
                                    {6801}let pkCli_5570: bitstring = pub(skB) in
                                    {6802}let v_5571: bool = (Disco_5024 = A) in
                                    (
                                        {6803}if v_5571 then
                                        (
                                            {6804}let pkDisco_5572: bitstring = pub(skA) in
                                            {6805}in(c, (=pkCli_5570,em1_5573: bitstring,sigM1_5574: bitstring));
                                            {6806}let m1_5575: bitstring = dec(em1_5573,skSess_5499) in
                                            {6807}if (verify(h(m1_5575),sigM1_5574,pkCli_5570) <> true) then
                                                0
                                            else
                                                {6808}let (=OpenSecureChannelRequest,=pkCli_5570,Nc_5576: bitstring) = m1_5575 in
                                                {6809}new Ns_5577: bitstring;
                                                {6810}new ST_5578: bitstring;
                                                {6811}new TTL_5579: bitstring;
                                                {6812}let m2_5580: bitstring = (OpenSecureChannelResponse,Ns_5577,ST_5578,TTL_5579) in
                                                {6813}event beginSrv(Sess_5025,Cli_5023,Ns_5577);
                                                {6814}out(c, (enc(m2_5580,pkCli_5570),sign(h(m2_5580),skSess_5499)));
                                                {6815}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                {6816}event endSrv(Cli_5023,Sess_5025,Nc_5576)
                                        )
                                        else
                                            {6817}let v_5581: bool = (Disco_5024 = B) in
                                            (
                                                {6818}if v_5581 then
                                                (
                                                    {6819}let pkDisco_5582: bitstring = pub(skB) in
                                                    {6820}in(c, (=pkCli_5570,em1_5583: bitstring,sigM1_5584: bitstring));
                                                    {6821}let m1_5585: bitstring = dec(em1_5583,skSess_5499) in
                                                    {6822}if (verify(h(m1_5585),sigM1_5584,pkCli_5570) <> true) then
                                                        0
                                                    else
                                                        {6823}let (=OpenSecureChannelRequest,=pkCli_5570,Nc_5586: bitstring) = m1_5585 in
                                                        {6824}new Ns_5587: bitstring;
                                                        {6825}new ST_5588: bitstring;
                                                        {6826}new TTL_5589: bitstring;
                                                        {6827}let m2_5590: bitstring = (OpenSecureChannelResponse,Ns_5587,ST_5588,TTL_5589) in
                                                        {6828}event beginSrv(Sess_5025,Cli_5023,Ns_5587);
                                                        {6829}out(c, (enc(m2_5590,pkCli_5570),sign(h(m2_5590),skSess_5499)));
                                                        {6830}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                        {6831}event endSrv(Cli_5023,Sess_5025,Nc_5586)
                                                )
                                                else
                                                    {6832}let v_5591: bool = (Disco_5024 = C) in
                                                    (
                                                        {6833}if v_5591 then
                                                        (
                                                            {6834}let pkDisco_5592: bitstring = pub(skC) in
                                                            {6835}in(c, (=pkCli_5570,em1_5593: bitstring,sigM1_5594: bitstring));
                                                            {6836}let m1_5595: bitstring = dec(em1_5593,skSess_5499) in
                                                            {6837}if (verify(h(m1_5595),sigM1_5594,pkCli_5570) <> true) then
                                                                0
                                                            else
                                                                {6838}let (=OpenSecureChannelRequest,=pkCli_5570,Nc_5596: bitstring) = m1_5595 in
                                                                {6839}new Ns_5597: bitstring;
                                                                {6840}new ST_5598: bitstring;
                                                                {6841}new TTL_5599: bitstring;
                                                                {6842}let m2_5600: bitstring = (OpenSecureChannelResponse,Ns_5597,ST_5598,TTL_5599) in
                                                                {6843}event beginSrv(Sess_5025,Cli_5023,Ns_5597);
                                                                {6844}out(c, (enc(m2_5600,pkCli_5570),sign(h(m2_5600),skSess_5499)));
                                                                {6845}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                                {6846}event endSrv(Cli_5023,Sess_5025,Nc_5596)
                                                        )
                                                        else
                                                            {6847}let pkDisco_5601: bitstring = pub(sk(Disco_5024)) in
                                                            {6848}in(c, (=pkCli_5570,em1_5602: bitstring,sigM1_5603: bitstring));
                                                            {6849}let m1_5604: bitstring = dec(em1_5602,skSess_5499) in
                                                            {6850}if (verify(h(m1_5604),sigM1_5603,pkCli_5570) <> true) then
                                                                0
                                                            else
                                                                {6851}let (=OpenSecureChannelRequest,=pkCli_5570,Nc_5605: bitstring) = m1_5604 in
                                                                {6852}new Ns_5606: bitstring;
                                                                {6853}new ST_5607: bitstring;
                                                                {6854}new TTL_5608: bitstring;
                                                                {6855}let m2_5609: bitstring = (OpenSecureChannelResponse,Ns_5606,ST_5607,TTL_5608) in
                                                                {6856}event beginSrv(Sess_5025,Cli_5023,Ns_5606);
                                                                {6857}out(c, (enc(m2_5609,pkCli_5570),sign(h(m2_5609),skSess_5499)));
                                                                {6858}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                                {6859}event endSrv(Cli_5023,Sess_5025,Nc_5605)
                                                    )
                                                    else
                                                        {6860}let pkDisco_5610: bitstring = fail-any in
                                                        {6861}in(c, (=pkCli_5570,em1_5611: bitstring,sigM1_5612: bitstring));
                                                        {6862}let m1_5613: bitstring = dec(em1_5611,skSess_5499) in
                                                        {6863}if (verify(h(m1_5613),sigM1_5612,pkCli_5570) <> true) then
                                                            0
                                                        else
                                                            {6864}let (=OpenSecureChannelRequest,=pkCli_5570,Nc_5614: bitstring) = m1_5613 in
                                                            {6865}new Ns_5615: bitstring;
                                                            {6866}new ST_5616: bitstring;
                                                            {6867}new TTL_5617: bitstring;
                                                            {6868}let m2_5618: bitstring = (OpenSecureChannelResponse,Ns_5615,ST_5616,TTL_5617) in
                                                            {6869}event beginSrv(Sess_5025,Cli_5023,Ns_5615);
                                                            {6870}out(c, (enc(m2_5618,pkCli_5570),sign(h(m2_5618),skSess_5499)));
                                                            {6871}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                            {6872}event endSrv(Cli_5023,Sess_5025,Nc_5614)
                                            )
                                            else
                                                {6873}let pkDisco_5619: bitstring = fail-any in
                                                {6874}in(c, (=pkCli_5570,em1_5620: bitstring,sigM1_5621: bitstring));
                                                {6875}let m1_5622: bitstring = dec(em1_5620,skSess_5499) in
                                                {6876}if (verify(h(m1_5622),sigM1_5621,pkCli_5570) <> true) then
                                                    0
                                                else
                                                    {6877}let (=OpenSecureChannelRequest,=pkCli_5570,Nc_5623: bitstring) = m1_5622 in
                                                    {6878}new Ns_5624: bitstring;
                                                    {6879}new ST_5625: bitstring;
                                                    {6880}new TTL_5626: bitstring;
                                                    {6881}let m2_5627: bitstring = (OpenSecureChannelResponse,Ns_5624,ST_5625,TTL_5626) in
                                                    {6882}event beginSrv(Sess_5025,Cli_5023,Ns_5624);
                                                    {6883}out(c, (enc(m2_5627,pkCli_5570),sign(h(m2_5627),skSess_5499)));
                                                    {6884}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                    {6885}event endSrv(Cli_5023,Sess_5025,Nc_5623)
                                    )
                                    else
                                        {6886}let pkDisco_5628: bitstring = fail-any in
                                        {6887}in(c, (=pkCli_5570,em1_5629: bitstring,sigM1_5630: bitstring));
                                        {6888}let m1_5631: bitstring = dec(em1_5629,skSess_5499) in
                                        {6889}if (verify(h(m1_5631),sigM1_5630,pkCli_5570) <> true) then
                                            0
                                        else
                                            {6890}let (=OpenSecureChannelRequest,=pkCli_5570,Nc_5632: bitstring) = m1_5631 in
                                            {6891}new Ns_5633: bitstring;
                                            {6892}new ST_5634: bitstring;
                                            {6893}new TTL_5635: bitstring;
                                            {6894}let m2_5636: bitstring = (OpenSecureChannelResponse,Ns_5633,ST_5634,TTL_5635) in
                                            {6895}event beginSrv(Sess_5025,Cli_5023,Ns_5633);
                                            {6896}out(c, (enc(m2_5636,pkCli_5570),sign(h(m2_5636),skSess_5499)));
                                            {6897}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                            {6898}event endSrv(Cli_5023,Sess_5025,Nc_5632)
                                )
                                else
                                    {6899}let v_5637: bool = (Cli_5023 = C) in
                                    (
                                        {6900}if v_5637 then
                                        (
                                            {6901}let pkCli_5638: bitstring = pub(skC) in
                                            {6902}let v_5639: bool = (Disco_5024 = A) in
                                            (
                                                {6903}if v_5639 then
                                                (
                                                    {6904}let pkDisco_5640: bitstring = pub(skA) in
                                                    {6905}in(c, (=pkCli_5638,em1_5641: bitstring,sigM1_5642: bitstring));
                                                    {6906}let m1_5643: bitstring = dec(em1_5641,skSess_5499) in
                                                    {6907}if (verify(h(m1_5643),sigM1_5642,pkCli_5638) <> true) then
                                                        0
                                                    else
                                                        {6908}let (=OpenSecureChannelRequest,=pkCli_5638,Nc_5644: bitstring) = m1_5643 in
                                                        {6909}new Ns_5645: bitstring;
                                                        {6910}new ST_5646: bitstring;
                                                        {6911}new TTL_5647: bitstring;
                                                        {6912}let m2_5648: bitstring = (OpenSecureChannelResponse,Ns_5645,ST_5646,TTL_5647) in
                                                        {6913}event beginSrv(Sess_5025,Cli_5023,Ns_5645);
                                                        {6914}out(c, (enc(m2_5648,pkCli_5638),sign(h(m2_5648),skSess_5499)));
                                                        {6915}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                        {6916}event endSrv(Cli_5023,Sess_5025,Nc_5644)
                                                )
                                                else
                                                    {6917}let v_5649: bool = (Disco_5024 = B) in
                                                    (
                                                        {6918}if v_5649 then
                                                        (
                                                            {6919}let pkDisco_5650: bitstring = pub(skB) in
                                                            {6920}in(c, (=pkCli_5638,em1_5651: bitstring,sigM1_5652: bitstring));
                                                            {6921}let m1_5653: bitstring = dec(em1_5651,skSess_5499) in
                                                            {6922}if (verify(h(m1_5653),sigM1_5652,pkCli_5638) <> true) then
                                                                0
                                                            else
                                                                {6923}let (=OpenSecureChannelRequest,=pkCli_5638,Nc_5654: bitstring) = m1_5653 in
                                                                {6924}new Ns_5655: bitstring;
                                                                {6925}new ST_5656: bitstring;
                                                                {6926}new TTL_5657: bitstring;
                                                                {6927}let m2_5658: bitstring = (OpenSecureChannelResponse,Ns_5655,ST_5656,TTL_5657) in
                                                                {6928}event beginSrv(Sess_5025,Cli_5023,Ns_5655);
                                                                {6929}out(c, (enc(m2_5658,pkCli_5638),sign(h(m2_5658),skSess_5499)));
                                                                {6930}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                                {6931}event endSrv(Cli_5023,Sess_5025,Nc_5654)
                                                        )
                                                        else
                                                            {6932}let v_5659: bool = (Disco_5024 = C) in
                                                            (
                                                                {6933}if v_5659 then
                                                                (
                                                                    {6934}let pkDisco_5660: bitstring = pub(skC) in
                                                                    {6935}in(c, (=pkCli_5638,em1_5661: bitstring,sigM1_5662: bitstring));
                                                                    {6936}let m1_5663: bitstring = dec(em1_5661,skSess_5499) in
                                                                    {6937}if (verify(h(m1_5663),sigM1_5662,pkCli_5638) <> true) then
                                                                        0
                                                                    else
                                                                        {6938}let (=OpenSecureChannelRequest,=pkCli_5638,Nc_5664: bitstring) = m1_5663 in
                                                                        {6939}new Ns_5665: bitstring;
                                                                        {6940}new ST_5666: bitstring;
                                                                        {6941}new TTL_5667: bitstring;
                                                                        {6942}let m2_5668: bitstring = (OpenSecureChannelResponse,Ns_5665,ST_5666,TTL_5667) in
                                                                        {6943}event beginSrv(Sess_5025,Cli_5023,Ns_5665);
                                                                        {6944}out(c, (enc(m2_5668,pkCli_5638),sign(h(m2_5668),skSess_5499)));
                                                                        {6945}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                                        {6946}event endSrv(Cli_5023,Sess_5025,Nc_5664)
                                                                )
                                                                else
                                                                    {6947}let pkDisco_5669: bitstring = pub(sk(Disco_5024)) in
                                                                    {6948}in(c, (=pkCli_5638,em1_5670: bitstring,sigM1_5671: bitstring));
                                                                    {6949}let m1_5672: bitstring = dec(em1_5670,skSess_5499) in
                                                                    {6950}if (verify(h(m1_5672),sigM1_5671,pkCli_5638) <> true) then
                                                                        0
                                                                    else
                                                                        {6951}let (=OpenSecureChannelRequest,=pkCli_5638,Nc_5673: bitstring) = m1_5672 in
                                                                        {6952}new Ns_5674: bitstring;
                                                                        {6953}new ST_5675: bitstring;
                                                                        {6954}new TTL_5676: bitstring;
                                                                        {6955}let m2_5677: bitstring = (OpenSecureChannelResponse,Ns_5674,ST_5675,TTL_5676) in
                                                                        {6956}event beginSrv(Sess_5025,Cli_5023,Ns_5674);
                                                                        {6957}out(c, (enc(m2_5677,pkCli_5638),sign(h(m2_5677),skSess_5499)));
                                                                        {6958}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                                        {6959}event endSrv(Cli_5023,Sess_5025,Nc_5673)
                                                            )
                                                            else
                                                                {6960}let pkDisco_5678: bitstring = fail-any in
                                                                {6961}in(c, (=pkCli_5638,em1_5679: bitstring,sigM1_5680: bitstring));
                                                                {6962}let m1_5681: bitstring = dec(em1_5679,skSess_5499) in
                                                                {6963}if (verify(h(m1_5681),sigM1_5680,pkCli_5638) <> true) then
                                                                    0
                                                                else
                                                                    {6964}let (=OpenSecureChannelRequest,=pkCli_5638,Nc_5682: bitstring) = m1_5681 in
                                                                    {6965}new Ns_5683: bitstring;
                                                                    {6966}new ST_5684: bitstring;
                                                                    {6967}new TTL_5685: bitstring;
                                                                    {6968}let m2_5686: bitstring = (OpenSecureChannelResponse,Ns_5683,ST_5684,TTL_5685) in
                                                                    {6969}event beginSrv(Sess_5025,Cli_5023,Ns_5683);
                                                                    {6970}out(c, (enc(m2_5686,pkCli_5638),sign(h(m2_5686),skSess_5499)));
                                                                    {6971}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                                    {6972}event endSrv(Cli_5023,Sess_5025,Nc_5682)
                                                    )
                                                    else
                                                        {6973}let pkDisco_5687: bitstring = fail-any in
                                                        {6974}in(c, (=pkCli_5638,em1_5688: bitstring,sigM1_5689: bitstring));
                                                        {6975}let m1_5690: bitstring = dec(em1_5688,skSess_5499) in
                                                        {6976}if (verify(h(m1_5690),sigM1_5689,pkCli_5638) <> true) then
                                                            0
                                                        else
                                                            {6977}let (=OpenSecureChannelRequest,=pkCli_5638,Nc_5691: bitstring) = m1_5690 in
                                                            {6978}new Ns_5692: bitstring;
                                                            {6979}new ST_5693: bitstring;
                                                            {6980}new TTL_5694: bitstring;
                                                            {6981}let m2_5695: bitstring = (OpenSecureChannelResponse,Ns_5692,ST_5693,TTL_5694) in
                                                            {6982}event beginSrv(Sess_5025,Cli_5023,Ns_5692);
                                                            {6983}out(c, (enc(m2_5695,pkCli_5638),sign(h(m2_5695),skSess_5499)));
                                                            {6984}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                            {6985}event endSrv(Cli_5023,Sess_5025,Nc_5691)
                                            )
                                            else
                                                {6986}let pkDisco_5696: bitstring = fail-any in
                                                {6987}in(c, (=pkCli_5638,em1_5697: bitstring,sigM1_5698: bitstring));
                                                {6988}let m1_5699: bitstring = dec(em1_5697,skSess_5499) in
                                                {6989}if (verify(h(m1_5699),sigM1_5698,pkCli_5638) <> true) then
                                                    0
                                                else
                                                    {6990}let (=OpenSecureChannelRequest,=pkCli_5638,Nc_5700: bitstring) = m1_5699 in
                                                    {6991}new Ns_5701: bitstring;
                                                    {6992}new ST_5702: bitstring;
                                                    {6993}new TTL_5703: bitstring;
                                                    {6994}let m2_5704: bitstring = (OpenSecureChannelResponse,Ns_5701,ST_5702,TTL_5703) in
                                                    {6995}event beginSrv(Sess_5025,Cli_5023,Ns_5701);
                                                    {6996}out(c, (enc(m2_5704,pkCli_5638),sign(h(m2_5704),skSess_5499)));
                                                    {6997}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                    {6998}event endSrv(Cli_5023,Sess_5025,Nc_5700)
                                        )
                                        else
                                            {6999}let pkCli_5705: bitstring = pub(sk(Cli_5023)) in
                                            {7000}let v_5706: bool = (Disco_5024 = A) in
                                            (
                                                {7001}if v_5706 then
                                                (
                                                    {7002}let pkDisco_5707: bitstring = pub(skA) in
                                                    {7003}in(c, (=pkCli_5705,em1_5708: bitstring,sigM1_5709: bitstring));
                                                    {7004}let m1_5710: bitstring = dec(em1_5708,skSess_5499) in
                                                    {7005}if (verify(h(m1_5710),sigM1_5709,pkCli_5705) <> true) then
                                                        0
                                                    else
                                                        {7006}let (=OpenSecureChannelRequest,=pkCli_5705,Nc_5711: bitstring) = m1_5710 in
                                                        {7007}new Ns_5712: bitstring;
                                                        {7008}new ST_5713: bitstring;
                                                        {7009}new TTL_5714: bitstring;
                                                        {7010}let m2_5715: bitstring = (OpenSecureChannelResponse,Ns_5712,ST_5713,TTL_5714) in
                                                        {7011}event beginSrv(Sess_5025,Cli_5023,Ns_5712);
                                                        {7012}out(c, (enc(m2_5715,pkCli_5705),sign(h(m2_5715),skSess_5499)));
                                                        {7013}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                        {7014}event endSrv(Cli_5023,Sess_5025,Nc_5711)
                                                )
                                                else
                                                    {7015}let v_5716: bool = (Disco_5024 = B) in
                                                    (
                                                        {7016}if v_5716 then
                                                        (
                                                            {7017}let pkDisco_5717: bitstring = pub(skB) in
                                                            {7018}in(c, (=pkCli_5705,em1_5718: bitstring,sigM1_5719: bitstring));
                                                            {7019}let m1_5720: bitstring = dec(em1_5718,skSess_5499) in
                                                            {7020}if (verify(h(m1_5720),sigM1_5719,pkCli_5705) <> true) then
                                                                0
                                                            else
                                                                {7021}let (=OpenSecureChannelRequest,=pkCli_5705,Nc_5721: bitstring) = m1_5720 in
                                                                {7022}new Ns_5722: bitstring;
                                                                {7023}new ST_5723: bitstring;
                                                                {7024}new TTL_5724: bitstring;
                                                                {7025}let m2_5725: bitstring = (OpenSecureChannelResponse,Ns_5722,ST_5723,TTL_5724) in
                                                                {7026}event beginSrv(Sess_5025,Cli_5023,Ns_5722);
                                                                {7027}out(c, (enc(m2_5725,pkCli_5705),sign(h(m2_5725),skSess_5499)));
                                                                {7028}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                                {7029}event endSrv(Cli_5023,Sess_5025,Nc_5721)
                                                        )
                                                        else
                                                            {7030}let v_5726: bool = (Disco_5024 = C) in
                                                            (
                                                                {7031}if v_5726 then
                                                                (
                                                                    {7032}let pkDisco_5727: bitstring = pub(skC) in
                                                                    {7033}in(c, (=pkCli_5705,em1_5728: bitstring,sigM1_5729: bitstring));
                                                                    {7034}let m1_5730: bitstring = dec(em1_5728,skSess_5499) in
                                                                    {7035}if (verify(h(m1_5730),sigM1_5729,pkCli_5705) <> true) then
                                                                        0
                                                                    else
                                                                        {7036}let (=OpenSecureChannelRequest,=pkCli_5705,Nc_5731: bitstring) = m1_5730 in
                                                                        {7037}new Ns_5732: bitstring;
                                                                        {7038}new ST_5733: bitstring;
                                                                        {7039}new TTL_5734: bitstring;
                                                                        {7040}let m2_5735: bitstring = (OpenSecureChannelResponse,Ns_5732,ST_5733,TTL_5734) in
                                                                        {7041}event beginSrv(Sess_5025,Cli_5023,Ns_5732);
                                                                        {7042}out(c, (enc(m2_5735,pkCli_5705),sign(h(m2_5735),skSess_5499)));
                                                                        {7043}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                                        {7044}event endSrv(Cli_5023,Sess_5025,Nc_5731)
                                                                )
                                                                else
                                                                    {7045}let pkDisco_5736: bitstring = pub(sk(Disco_5024)) in
                                                                    {7046}in(c, (=pkCli_5705,em1_5737: bitstring,sigM1_5738: bitstring));
                                                                    {7047}let m1_5739: bitstring = dec(em1_5737,skSess_5499) in
                                                                    {7048}if (verify(h(m1_5739),sigM1_5738,pkCli_5705) <> true) then
                                                                        0
                                                                    else
                                                                        {7049}let (=OpenSecureChannelRequest,=pkCli_5705,Nc_5740: bitstring) = m1_5739 in
                                                                        {7050}new Ns_5741: bitstring;
                                                                        {7051}new ST_5742: bitstring;
                                                                        {7052}new TTL_5743: bitstring;
                                                                        {7053}let m2_5744: bitstring = (OpenSecureChannelResponse,Ns_5741,ST_5742,TTL_5743) in
                                                                        {7054}event beginSrv(Sess_5025,Cli_5023,Ns_5741);
                                                                        {7055}out(c, (enc(m2_5744,pkCli_5705),sign(h(m2_5744),skSess_5499)));
                                                                        {7056}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                                        {7057}event endSrv(Cli_5023,Sess_5025,Nc_5740)
                                                            )
                                                            else
                                                                {7058}let pkDisco_5745: bitstring = fail-any in
                                                                {7059}in(c, (=pkCli_5705,em1_5746: bitstring,sigM1_5747: bitstring));
                                                                {7060}let m1_5748: bitstring = dec(em1_5746,skSess_5499) in
                                                                {7061}if (verify(h(m1_5748),sigM1_5747,pkCli_5705) <> true) then
                                                                    0
                                                                else
                                                                    {7062}let (=OpenSecureChannelRequest,=pkCli_5705,Nc_5749: bitstring) = m1_5748 in
                                                                    {7063}new Ns_5750: bitstring;
                                                                    {7064}new ST_5751: bitstring;
                                                                    {7065}new TTL_5752: bitstring;
                                                                    {7066}let m2_5753: bitstring = (OpenSecureChannelResponse,Ns_5750,ST_5751,TTL_5752) in
                                                                    {7067}event beginSrv(Sess_5025,Cli_5023,Ns_5750);
                                                                    {7068}out(c, (enc(m2_5753,pkCli_5705),sign(h(m2_5753),skSess_5499)));
                                                                    {7069}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                                    {7070}event endSrv(Cli_5023,Sess_5025,Nc_5749)
                                                    )
                                                    else
                                                        {7071}let pkDisco_5754: bitstring = fail-any in
                                                        {7072}in(c, (=pkCli_5705,em1_5755: bitstring,sigM1_5756: bitstring));
                                                        {7073}let m1_5757: bitstring = dec(em1_5755,skSess_5499) in
                                                        {7074}if (verify(h(m1_5757),sigM1_5756,pkCli_5705) <> true) then
                                                            0
                                                        else
                                                            {7075}let (=OpenSecureChannelRequest,=pkCli_5705,Nc_5758: bitstring) = m1_5757 in
                                                            {7076}new Ns_5759: bitstring;
                                                            {7077}new ST_5760: bitstring;
                                                            {7078}new TTL_5761: bitstring;
                                                            {7079}let m2_5762: bitstring = (OpenSecureChannelResponse,Ns_5759,ST_5760,TTL_5761) in
                                                            {7080}event beginSrv(Sess_5025,Cli_5023,Ns_5759);
                                                            {7081}out(c, (enc(m2_5762,pkCli_5705),sign(h(m2_5762),skSess_5499)));
                                                            {7082}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                            {7083}event endSrv(Cli_5023,Sess_5025,Nc_5758)
                                            )
                                            else
                                                {7084}let pkDisco_5763: bitstring = fail-any in
                                                {7085}in(c, (=pkCli_5705,em1_5764: bitstring,sigM1_5765: bitstring));
                                                {7086}let m1_5766: bitstring = dec(em1_5764,skSess_5499) in
                                                {7087}if (verify(h(m1_5766),sigM1_5765,pkCli_5705) <> true) then
                                                    0
                                                else
                                                    {7088}let (=OpenSecureChannelRequest,=pkCli_5705,Nc_5767: bitstring) = m1_5766 in
                                                    {7089}new Ns_5768: bitstring;
                                                    {7090}new ST_5769: bitstring;
                                                    {7091}new TTL_5770: bitstring;
                                                    {7092}let m2_5771: bitstring = (OpenSecureChannelResponse,Ns_5768,ST_5769,TTL_5770) in
                                                    {7093}event beginSrv(Sess_5025,Cli_5023,Ns_5768);
                                                    {7094}out(c, (enc(m2_5771,pkCli_5705),sign(h(m2_5771),skSess_5499)));
                                                    {7095}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                    {7096}event endSrv(Cli_5023,Sess_5025,Nc_5767)
                                    )
                                    else
                                        {7097}let pkCli_5772: bitstring = fail-any in
                                        {7098}let v_5773: bool = (Disco_5024 = A) in
                                        (
                                            {7099}if v_5773 then
                                            (
                                                {7100}let pkDisco_5774: bitstring = pub(skA) in
                                                {7101}in(c, (=pkCli_5772,em1_5775: bitstring,sigM1_5776: bitstring));
                                                {7102}let m1_5777: bitstring = dec(em1_5775,skSess_5499) in
                                                {7103}if (verify(h(m1_5777),sigM1_5776,pkCli_5772) <> true) then
                                                    0
                                                else
                                                    {7104}let (=OpenSecureChannelRequest,=pkCli_5772,Nc_5778: bitstring) = m1_5777 in
                                                    {7105}new Ns_5779: bitstring;
                                                    {7106}new ST_5780: bitstring;
                                                    {7107}new TTL_5781: bitstring;
                                                    {7108}let m2_5782: bitstring = (OpenSecureChannelResponse,Ns_5779,ST_5780,TTL_5781) in
                                                    {7109}event beginSrv(Sess_5025,Cli_5023,Ns_5779);
                                                    {7110}out(c, (enc(m2_5782,pkCli_5772),sign(h(m2_5782),skSess_5499)));
                                                    {7111}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                    {7112}event endSrv(Cli_5023,Sess_5025,Nc_5778)
                                            )
                                            else
                                                {7113}let v_5783: bool = (Disco_5024 = B) in
                                                (
                                                    {7114}if v_5783 then
                                                    (
                                                        {7115}let pkDisco_5784: bitstring = pub(skB) in
                                                        {7116}in(c, (=pkCli_5772,em1_5785: bitstring,sigM1_5786: bitstring));
                                                        {7117}let m1_5787: bitstring = dec(em1_5785,skSess_5499) in
                                                        {7118}if (verify(h(m1_5787),sigM1_5786,pkCli_5772) <> true) then
                                                            0
                                                        else
                                                            {7119}let (=OpenSecureChannelRequest,=pkCli_5772,Nc_5788: bitstring) = m1_5787 in
                                                            {7120}new Ns_5789: bitstring;
                                                            {7121}new ST_5790: bitstring;
                                                            {7122}new TTL_5791: bitstring;
                                                            {7123}let m2_5792: bitstring = (OpenSecureChannelResponse,Ns_5789,ST_5790,TTL_5791) in
                                                            {7124}event beginSrv(Sess_5025,Cli_5023,Ns_5789);
                                                            {7125}out(c, (enc(m2_5792,pkCli_5772),sign(h(m2_5792),skSess_5499)));
                                                            {7126}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                            {7127}event endSrv(Cli_5023,Sess_5025,Nc_5788)
                                                    )
                                                    else
                                                        {7128}let v_5793: bool = (Disco_5024 = C) in
                                                        (
                                                            {7129}if v_5793 then
                                                            (
                                                                {7130}let pkDisco_5794: bitstring = pub(skC) in
                                                                {7131}in(c, (=pkCli_5772,em1_5795: bitstring,sigM1_5796: bitstring));
                                                                {7132}let m1_5797: bitstring = dec(em1_5795,skSess_5499) in
                                                                {7133}if (verify(h(m1_5797),sigM1_5796,pkCli_5772) <> true) then
                                                                    0
                                                                else
                                                                    {7134}let (=OpenSecureChannelRequest,=pkCli_5772,Nc_5798: bitstring) = m1_5797 in
                                                                    {7135}new Ns_5799: bitstring;
                                                                    {7136}new ST_5800: bitstring;
                                                                    {7137}new TTL_5801: bitstring;
                                                                    {7138}let m2_5802: bitstring = (OpenSecureChannelResponse,Ns_5799,ST_5800,TTL_5801) in
                                                                    {7139}event beginSrv(Sess_5025,Cli_5023,Ns_5799);
                                                                    {7140}out(c, (enc(m2_5802,pkCli_5772),sign(h(m2_5802),skSess_5499)));
                                                                    {7141}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                                    {7142}event endSrv(Cli_5023,Sess_5025,Nc_5798)
                                                            )
                                                            else
                                                                {7143}let pkDisco_5803: bitstring = pub(sk(Disco_5024)) in
                                                                {7144}in(c, (=pkCli_5772,em1_5804: bitstring,sigM1_5805: bitstring));
                                                                {7145}let m1_5806: bitstring = dec(em1_5804,skSess_5499) in
                                                                {7146}if (verify(h(m1_5806),sigM1_5805,pkCli_5772) <> true) then
                                                                    0
                                                                else
                                                                    {7147}let (=OpenSecureChannelRequest,=pkCli_5772,Nc_5807: bitstring) = m1_5806 in
                                                                    {7148}new Ns_5808: bitstring;
                                                                    {7149}new ST_5809: bitstring;
                                                                    {7150}new TTL_5810: bitstring;
                                                                    {7151}let m2_5811: bitstring = (OpenSecureChannelResponse,Ns_5808,ST_5809,TTL_5810) in
                                                                    {7152}event beginSrv(Sess_5025,Cli_5023,Ns_5808);
                                                                    {7153}out(c, (enc(m2_5811,pkCli_5772),sign(h(m2_5811),skSess_5499)));
                                                                    {7154}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                                    {7155}event endSrv(Cli_5023,Sess_5025,Nc_5807)
                                                        )
                                                        else
                                                            {7156}let pkDisco_5812: bitstring = fail-any in
                                                            {7157}in(c, (=pkCli_5772,em1_5813: bitstring,sigM1_5814: bitstring));
                                                            {7158}let m1_5815: bitstring = dec(em1_5813,skSess_5499) in
                                                            {7159}if (verify(h(m1_5815),sigM1_5814,pkCli_5772) <> true) then
                                                                0
                                                            else
                                                                {7160}let (=OpenSecureChannelRequest,=pkCli_5772,Nc_5816: bitstring) = m1_5815 in
                                                                {7161}new Ns_5817: bitstring;
                                                                {7162}new ST_5818: bitstring;
                                                                {7163}new TTL_5819: bitstring;
                                                                {7164}let m2_5820: bitstring = (OpenSecureChannelResponse,Ns_5817,ST_5818,TTL_5819) in
                                                                {7165}event beginSrv(Sess_5025,Cli_5023,Ns_5817);
                                                                {7166}out(c, (enc(m2_5820,pkCli_5772),sign(h(m2_5820),skSess_5499)));
                                                                {7167}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                                {7168}event endSrv(Cli_5023,Sess_5025,Nc_5816)
                                                )
                                                else
                                                    {7169}let pkDisco_5821: bitstring = fail-any in
                                                    {7170}in(c, (=pkCli_5772,em1_5822: bitstring,sigM1_5823: bitstring));
                                                    {7171}let m1_5824: bitstring = dec(em1_5822,skSess_5499) in
                                                    {7172}if (verify(h(m1_5824),sigM1_5823,pkCli_5772) <> true) then
                                                        0
                                                    else
                                                        {7173}let (=OpenSecureChannelRequest,=pkCli_5772,Nc_5825: bitstring) = m1_5824 in
                                                        {7174}new Ns_5826: bitstring;
                                                        {7175}new ST_5827: bitstring;
                                                        {7176}new TTL_5828: bitstring;
                                                        {7177}let m2_5829: bitstring = (OpenSecureChannelResponse,Ns_5826,ST_5827,TTL_5828) in
                                                        {7178}event beginSrv(Sess_5025,Cli_5023,Ns_5826);
                                                        {7179}out(c, (enc(m2_5829,pkCli_5772),sign(h(m2_5829),skSess_5499)));
                                                        {7180}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                        {7181}event endSrv(Cli_5023,Sess_5025,Nc_5825)
                                        )
                                        else
                                            {7182}let pkDisco_5830: bitstring = fail-any in
                                            {7183}in(c, (=pkCli_5772,em1_5831: bitstring,sigM1_5832: bitstring));
                                            {7184}let m1_5833: bitstring = dec(em1_5831,skSess_5499) in
                                            {7185}if (verify(h(m1_5833),sigM1_5832,pkCli_5772) <> true) then
                                                0
                                            else
                                                {7186}let (=OpenSecureChannelRequest,=pkCli_5772,Nc_5834: bitstring) = m1_5833 in
                                                {7187}new Ns_5835: bitstring;
                                                {7188}new ST_5836: bitstring;
                                                {7189}new TTL_5837: bitstring;
                                                {7190}let m2_5838: bitstring = (OpenSecureChannelResponse,Ns_5835,ST_5836,TTL_5837) in
                                                {7191}event beginSrv(Sess_5025,Cli_5023,Ns_5835);
                                                {7192}out(c, (enc(m2_5838,pkCli_5772),sign(h(m2_5838),skSess_5499)));
                                                {7193}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                {7194}event endSrv(Cli_5023,Sess_5025,Nc_5834)
                            )
                            else
                                {7195}let pkCli_5839: bitstring = fail-any in
                                {7196}let v_5840: bool = (Disco_5024 = A) in
                                (
                                    {7197}if v_5840 then
                                    (
                                        {7198}let pkDisco_5841: bitstring = pub(skA) in
                                        {7199}in(c, (=pkCli_5839,em1_5842: bitstring,sigM1_5843: bitstring));
                                        {7200}let m1_5844: bitstring = dec(em1_5842,skSess_5499) in
                                        {7201}if (verify(h(m1_5844),sigM1_5843,pkCli_5839) <> true) then
                                            0
                                        else
                                            {7202}let (=OpenSecureChannelRequest,=pkCli_5839,Nc_5845: bitstring) = m1_5844 in
                                            {7203}new Ns_5846: bitstring;
                                            {7204}new ST_5847: bitstring;
                                            {7205}new TTL_5848: bitstring;
                                            {7206}let m2_5849: bitstring = (OpenSecureChannelResponse,Ns_5846,ST_5847,TTL_5848) in
                                            {7207}event beginSrv(Sess_5025,Cli_5023,Ns_5846);
                                            {7208}out(c, (enc(m2_5849,pkCli_5839),sign(h(m2_5849),skSess_5499)));
                                            {7209}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                            {7210}event endSrv(Cli_5023,Sess_5025,Nc_5845)
                                    )
                                    else
                                        {7211}let v_5850: bool = (Disco_5024 = B) in
                                        (
                                            {7212}if v_5850 then
                                            (
                                                {7213}let pkDisco_5851: bitstring = pub(skB) in
                                                {7214}in(c, (=pkCli_5839,em1_5852: bitstring,sigM1_5853: bitstring));
                                                {7215}let m1_5854: bitstring = dec(em1_5852,skSess_5499) in
                                                {7216}if (verify(h(m1_5854),sigM1_5853,pkCli_5839) <> true) then
                                                    0
                                                else
                                                    {7217}let (=OpenSecureChannelRequest,=pkCli_5839,Nc_5855: bitstring) = m1_5854 in
                                                    {7218}new Ns_5856: bitstring;
                                                    {7219}new ST_5857: bitstring;
                                                    {7220}new TTL_5858: bitstring;
                                                    {7221}let m2_5859: bitstring = (OpenSecureChannelResponse,Ns_5856,ST_5857,TTL_5858) in
                                                    {7222}event beginSrv(Sess_5025,Cli_5023,Ns_5856);
                                                    {7223}out(c, (enc(m2_5859,pkCli_5839),sign(h(m2_5859),skSess_5499)));
                                                    {7224}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                    {7225}event endSrv(Cli_5023,Sess_5025,Nc_5855)
                                            )
                                            else
                                                {7226}let v_5860: bool = (Disco_5024 = C) in
                                                (
                                                    {7227}if v_5860 then
                                                    (
                                                        {7228}let pkDisco_5861: bitstring = pub(skC) in
                                                        {7229}in(c, (=pkCli_5839,em1_5862: bitstring,sigM1_5863: bitstring));
                                                        {7230}let m1_5864: bitstring = dec(em1_5862,skSess_5499) in
                                                        {7231}if (verify(h(m1_5864),sigM1_5863,pkCli_5839) <> true) then
                                                            0
                                                        else
                                                            {7232}let (=OpenSecureChannelRequest,=pkCli_5839,Nc_5865: bitstring) = m1_5864 in
                                                            {7233}new Ns_5866: bitstring;
                                                            {7234}new ST_5867: bitstring;
                                                            {7235}new TTL_5868: bitstring;
                                                            {7236}let m2_5869: bitstring = (OpenSecureChannelResponse,Ns_5866,ST_5867,TTL_5868) in
                                                            {7237}event beginSrv(Sess_5025,Cli_5023,Ns_5866);
                                                            {7238}out(c, (enc(m2_5869,pkCli_5839),sign(h(m2_5869),skSess_5499)));
                                                            {7239}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                            {7240}event endSrv(Cli_5023,Sess_5025,Nc_5865)
                                                    )
                                                    else
                                                        {7241}let pkDisco_5870: bitstring = pub(sk(Disco_5024)) in
                                                        {7242}in(c, (=pkCli_5839,em1_5871: bitstring,sigM1_5872: bitstring));
                                                        {7243}let m1_5873: bitstring = dec(em1_5871,skSess_5499) in
                                                        {7244}if (verify(h(m1_5873),sigM1_5872,pkCli_5839) <> true) then
                                                            0
                                                        else
                                                            {7245}let (=OpenSecureChannelRequest,=pkCli_5839,Nc_5874: bitstring) = m1_5873 in
                                                            {7246}new Ns_5875: bitstring;
                                                            {7247}new ST_5876: bitstring;
                                                            {7248}new TTL_5877: bitstring;
                                                            {7249}let m2_5878: bitstring = (OpenSecureChannelResponse,Ns_5875,ST_5876,TTL_5877) in
                                                            {7250}event beginSrv(Sess_5025,Cli_5023,Ns_5875);
                                                            {7251}out(c, (enc(m2_5878,pkCli_5839),sign(h(m2_5878),skSess_5499)));
                                                            {7252}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                            {7253}event endSrv(Cli_5023,Sess_5025,Nc_5874)
                                                )
                                                else
                                                    {7254}let pkDisco_5879: bitstring = fail-any in
                                                    {7255}in(c, (=pkCli_5839,em1_5880: bitstring,sigM1_5881: bitstring));
                                                    {7256}let m1_5882: bitstring = dec(em1_5880,skSess_5499) in
                                                    {7257}if (verify(h(m1_5882),sigM1_5881,pkCli_5839) <> true) then
                                                        0
                                                    else
                                                        {7258}let (=OpenSecureChannelRequest,=pkCli_5839,Nc_5883: bitstring) = m1_5882 in
                                                        {7259}new Ns_5884: bitstring;
                                                        {7260}new ST_5885: bitstring;
                                                        {7261}new TTL_5886: bitstring;
                                                        {7262}let m2_5887: bitstring = (OpenSecureChannelResponse,Ns_5884,ST_5885,TTL_5886) in
                                                        {7263}event beginSrv(Sess_5025,Cli_5023,Ns_5884);
                                                        {7264}out(c, (enc(m2_5887,pkCli_5839),sign(h(m2_5887),skSess_5499)));
                                                        {7265}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                        {7266}event endSrv(Cli_5023,Sess_5025,Nc_5883)
                                        )
                                        else
                                            {7267}let pkDisco_5888: bitstring = fail-any in
                                            {7268}in(c, (=pkCli_5839,em1_5889: bitstring,sigM1_5890: bitstring));
                                            {7269}let m1_5891: bitstring = dec(em1_5889,skSess_5499) in
                                            {7270}if (verify(h(m1_5891),sigM1_5890,pkCli_5839) <> true) then
                                                0
                                            else
                                                {7271}let (=OpenSecureChannelRequest,=pkCli_5839,Nc_5892: bitstring) = m1_5891 in
                                                {7272}new Ns_5893: bitstring;
                                                {7273}new ST_5894: bitstring;
                                                {7274}new TTL_5895: bitstring;
                                                {7275}let m2_5896: bitstring = (OpenSecureChannelResponse,Ns_5893,ST_5894,TTL_5895) in
                                                {7276}event beginSrv(Sess_5025,Cli_5023,Ns_5893);
                                                {7277}out(c, (enc(m2_5896,pkCli_5839),sign(h(m2_5896),skSess_5499)));
                                                {7278}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                {7279}event endSrv(Cli_5023,Sess_5025,Nc_5892)
                                )
                                else
                                    {7280}let pkDisco_5897: bitstring = fail-any in
                                    {7281}in(c, (=pkCli_5839,em1_5898: bitstring,sigM1_5899: bitstring));
                                    {7282}let m1_5900: bitstring = dec(em1_5898,skSess_5499) in
                                    {7283}if (verify(h(m1_5900),sigM1_5899,pkCli_5839) <> true) then
                                        0
                                    else
                                        {7284}let (=OpenSecureChannelRequest,=pkCli_5839,Nc_5901: bitstring) = m1_5900 in
                                        {7285}new Ns_5902: bitstring;
                                        {7286}new ST_5903: bitstring;
                                        {7287}new TTL_5904: bitstring;
                                        {7288}let m2_5905: bitstring = (OpenSecureChannelResponse,Ns_5902,ST_5903,TTL_5904) in
                                        {7289}event beginSrv(Sess_5025,Cli_5023,Ns_5902);
                                        {7290}out(c, (enc(m2_5905,pkCli_5839),sign(h(m2_5905),skSess_5499)));
                                        {7291}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                        {7292}event endSrv(Cli_5023,Sess_5025,Nc_5901)
                    )
                    else
                        {7293}let pkCli_5906: bitstring = fail-any in
                        {7294}let v_5907: bool = (Disco_5024 = A) in
                        (
                            {7295}if v_5907 then
                            (
                                {7296}let pkDisco_5908: bitstring = pub(skA) in
                                {7297}in(c, (=pkCli_5906,em1_5909: bitstring,sigM1_5910: bitstring));
                                {7298}let m1_5911: bitstring = dec(em1_5909,skSess_5499) in
                                {7299}if (verify(h(m1_5911),sigM1_5910,pkCli_5906) <> true) then
                                    0
                                else
                                    {7300}let (=OpenSecureChannelRequest,=pkCli_5906,Nc_5912: bitstring) = m1_5911 in
                                    {7301}new Ns_5913: bitstring;
                                    {7302}new ST_5914: bitstring;
                                    {7303}new TTL_5915: bitstring;
                                    {7304}let m2_5916: bitstring = (OpenSecureChannelResponse,Ns_5913,ST_5914,TTL_5915) in
                                    {7305}event beginSrv(Sess_5025,Cli_5023,Ns_5913);
                                    {7306}out(c, (enc(m2_5916,pkCli_5906),sign(h(m2_5916),skSess_5499)));
                                    {7307}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                    {7308}event endSrv(Cli_5023,Sess_5025,Nc_5912)
                            )
                            else
                                {7309}let v_5917: bool = (Disco_5024 = B) in
                                (
                                    {7310}if v_5917 then
                                    (
                                        {7311}let pkDisco_5918: bitstring = pub(skB) in
                                        {7312}in(c, (=pkCli_5906,em1_5919: bitstring,sigM1_5920: bitstring));
                                        {7313}let m1_5921: bitstring = dec(em1_5919,skSess_5499) in
                                        {7314}if (verify(h(m1_5921),sigM1_5920,pkCli_5906) <> true) then
                                            0
                                        else
                                            {7315}let (=OpenSecureChannelRequest,=pkCli_5906,Nc_5922: bitstring) = m1_5921 in
                                            {7316}new Ns_5923: bitstring;
                                            {7317}new ST_5924: bitstring;
                                            {7318}new TTL_5925: bitstring;
                                            {7319}let m2_5926: bitstring = (OpenSecureChannelResponse,Ns_5923,ST_5924,TTL_5925) in
                                            {7320}event beginSrv(Sess_5025,Cli_5023,Ns_5923);
                                            {7321}out(c, (enc(m2_5926,pkCli_5906),sign(h(m2_5926),skSess_5499)));
                                            {7322}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                            {7323}event endSrv(Cli_5023,Sess_5025,Nc_5922)
                                    )
                                    else
                                        {7324}let v_5927: bool = (Disco_5024 = C) in
                                        (
                                            {7325}if v_5927 then
                                            (
                                                {7326}let pkDisco_5928: bitstring = pub(skC) in
                                                {7327}in(c, (=pkCli_5906,em1_5929: bitstring,sigM1_5930: bitstring));
                                                {7328}let m1_5931: bitstring = dec(em1_5929,skSess_5499) in
                                                {7329}if (verify(h(m1_5931),sigM1_5930,pkCli_5906) <> true) then
                                                    0
                                                else
                                                    {7330}let (=OpenSecureChannelRequest,=pkCli_5906,Nc_5932: bitstring) = m1_5931 in
                                                    {7331}new Ns_5933: bitstring;
                                                    {7332}new ST_5934: bitstring;
                                                    {7333}new TTL_5935: bitstring;
                                                    {7334}let m2_5936: bitstring = (OpenSecureChannelResponse,Ns_5933,ST_5934,TTL_5935) in
                                                    {7335}event beginSrv(Sess_5025,Cli_5023,Ns_5933);
                                                    {7336}out(c, (enc(m2_5936,pkCli_5906),sign(h(m2_5936),skSess_5499)));
                                                    {7337}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                    {7338}event endSrv(Cli_5023,Sess_5025,Nc_5932)
                                            )
                                            else
                                                {7339}let pkDisco_5937: bitstring = pub(sk(Disco_5024)) in
                                                {7340}in(c, (=pkCli_5906,em1_5938: bitstring,sigM1_5939: bitstring));
                                                {7341}let m1_5940: bitstring = dec(em1_5938,skSess_5499) in
                                                {7342}if (verify(h(m1_5940),sigM1_5939,pkCli_5906) <> true) then
                                                    0
                                                else
                                                    {7343}let (=OpenSecureChannelRequest,=pkCli_5906,Nc_5941: bitstring) = m1_5940 in
                                                    {7344}new Ns_5942: bitstring;
                                                    {7345}new ST_5943: bitstring;
                                                    {7346}new TTL_5944: bitstring;
                                                    {7347}let m2_5945: bitstring = (OpenSecureChannelResponse,Ns_5942,ST_5943,TTL_5944) in
                                                    {7348}event beginSrv(Sess_5025,Cli_5023,Ns_5942);
                                                    {7349}out(c, (enc(m2_5945,pkCli_5906),sign(h(m2_5945),skSess_5499)));
                                                    {7350}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                    {7351}event endSrv(Cli_5023,Sess_5025,Nc_5941)
                                        )
                                        else
                                            {7352}let pkDisco_5946: bitstring = fail-any in
                                            {7353}in(c, (=pkCli_5906,em1_5947: bitstring,sigM1_5948: bitstring));
                                            {7354}let m1_5949: bitstring = dec(em1_5947,skSess_5499) in
                                            {7355}if (verify(h(m1_5949),sigM1_5948,pkCli_5906) <> true) then
                                                0
                                            else
                                                {7356}let (=OpenSecureChannelRequest,=pkCli_5906,Nc_5950: bitstring) = m1_5949 in
                                                {7357}new Ns_5951: bitstring;
                                                {7358}new ST_5952: bitstring;
                                                {7359}new TTL_5953: bitstring;
                                                {7360}let m2_5954: bitstring = (OpenSecureChannelResponse,Ns_5951,ST_5952,TTL_5953) in
                                                {7361}event beginSrv(Sess_5025,Cli_5023,Ns_5951);
                                                {7362}out(c, (enc(m2_5954,pkCli_5906),sign(h(m2_5954),skSess_5499)));
                                                {7363}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                {7364}event endSrv(Cli_5023,Sess_5025,Nc_5950)
                                )
                                else
                                    {7365}let pkDisco_5955: bitstring = fail-any in
                                    {7366}in(c, (=pkCli_5906,em1_5956: bitstring,sigM1_5957: bitstring));
                                    {7367}let m1_5958: bitstring = dec(em1_5956,skSess_5499) in
                                    {7368}if (verify(h(m1_5958),sigM1_5957,pkCli_5906) <> true) then
                                        0
                                    else
                                        {7369}let (=OpenSecureChannelRequest,=pkCli_5906,Nc_5959: bitstring) = m1_5958 in
                                        {7370}new Ns_5960: bitstring;
                                        {7371}new ST_5961: bitstring;
                                        {7372}new TTL_5962: bitstring;
                                        {7373}let m2_5963: bitstring = (OpenSecureChannelResponse,Ns_5960,ST_5961,TTL_5962) in
                                        {7374}event beginSrv(Sess_5025,Cli_5023,Ns_5960);
                                        {7375}out(c, (enc(m2_5963,pkCli_5906),sign(h(m2_5963),skSess_5499)));
                                        {7376}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                        {7377}event endSrv(Cli_5023,Sess_5025,Nc_5959)
                        )
                        else
                            {7378}let pkDisco_5964: bitstring = fail-any in
                            {7379}in(c, (=pkCli_5906,em1_5965: bitstring,sigM1_5966: bitstring));
                            {7380}let m1_5967: bitstring = dec(em1_5965,skSess_5499) in
                            {7381}if (verify(h(m1_5967),sigM1_5966,pkCli_5906) <> true) then
                                0
                            else
                                {7382}let (=OpenSecureChannelRequest,=pkCli_5906,Nc_5968: bitstring) = m1_5967 in
                                {7383}new Ns_5969: bitstring;
                                {7384}new ST_5970: bitstring;
                                {7385}new TTL_5971: bitstring;
                                {7386}let m2_5972: bitstring = (OpenSecureChannelResponse,Ns_5969,ST_5970,TTL_5971) in
                                {7387}event beginSrv(Sess_5025,Cli_5023,Ns_5969);
                                {7388}out(c, (enc(m2_5972,pkCli_5906),sign(h(m2_5972),skSess_5499)));
                                {7389}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                {7390}event endSrv(Cli_5023,Sess_5025,Nc_5968)
                )
                else
                    {7391}let =true = (Sess_5025 = C) in
                    (
                        {7392}let skSess_5973: bitstring = skC in
                        {7393}let pkSess_5974: bitstring = pub(skSess_5973) in
                        {7394}let v_5975: bool = (Cli_5023 = A) in
                        (
                            {7395}if v_5975 then
                            (
                                {7396}let pkCli_5976: bitstring = pub(skA) in
                                {7397}let v_5977: bool = (Disco_5024 = A) in
                                (
                                    {7398}if v_5977 then
                                    (
                                        {7399}let pkDisco_5978: bitstring = pub(skA) in
                                        {7400}in(c, (=pkCli_5976,em1_5979: bitstring,sigM1_5980: bitstring));
                                        {7401}let m1_5981: bitstring = dec(em1_5979,skSess_5973) in
                                        {7402}if (verify(h(m1_5981),sigM1_5980,pkCli_5976) <> true) then
                                            0
                                        else
                                            {7403}let (=OpenSecureChannelRequest,=pkCli_5976,Nc_5982: bitstring) = m1_5981 in
                                            {7404}new Ns_5983: bitstring;
                                            {7405}new ST_5984: bitstring;
                                            {7406}new TTL_5985: bitstring;
                                            {7407}let m2_5986: bitstring = (OpenSecureChannelResponse,Ns_5983,ST_5984,TTL_5985) in
                                            {7408}event beginSrv(Sess_5025,Cli_5023,Ns_5983);
                                            {7409}out(c, (enc(m2_5986,pkCli_5976),sign(h(m2_5986),skSess_5973)));
                                            {7410}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                            {7411}event endSrv(Cli_5023,Sess_5025,Nc_5982)
                                    )
                                    else
                                        {7412}let v_5987: bool = (Disco_5024 = B) in
                                        (
                                            {7413}if v_5987 then
                                            (
                                                {7414}let pkDisco_5988: bitstring = pub(skB) in
                                                {7415}in(c, (=pkCli_5976,em1_5989: bitstring,sigM1_5990: bitstring));
                                                {7416}let m1_5991: bitstring = dec(em1_5989,skSess_5973) in
                                                {7417}if (verify(h(m1_5991),sigM1_5990,pkCli_5976) <> true) then
                                                    0
                                                else
                                                    {7418}let (=OpenSecureChannelRequest,=pkCli_5976,Nc_5992: bitstring) = m1_5991 in
                                                    {7419}new Ns_5993: bitstring;
                                                    {7420}new ST_5994: bitstring;
                                                    {7421}new TTL_5995: bitstring;
                                                    {7422}let m2_5996: bitstring = (OpenSecureChannelResponse,Ns_5993,ST_5994,TTL_5995) in
                                                    {7423}event beginSrv(Sess_5025,Cli_5023,Ns_5993);
                                                    {7424}out(c, (enc(m2_5996,pkCli_5976),sign(h(m2_5996),skSess_5973)));
                                                    {7425}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                    {7426}event endSrv(Cli_5023,Sess_5025,Nc_5992)
                                            )
                                            else
                                                {7427}let v_5997: bool = (Disco_5024 = C) in
                                                (
                                                    {7428}if v_5997 then
                                                    (
                                                        {7429}let pkDisco_5998: bitstring = pub(skC) in
                                                        {7430}in(c, (=pkCli_5976,em1_5999: bitstring,sigM1_6000: bitstring));
                                                        {7431}let m1_6001: bitstring = dec(em1_5999,skSess_5973) in
                                                        {7432}if (verify(h(m1_6001),sigM1_6000,pkCli_5976) <> true) then
                                                            0
                                                        else
                                                            {7433}let (=OpenSecureChannelRequest,=pkCli_5976,Nc_6002: bitstring) = m1_6001 in
                                                            {7434}new Ns_6003: bitstring;
                                                            {7435}new ST_6004: bitstring;
                                                            {7436}new TTL_6005: bitstring;
                                                            {7437}let m2_6006: bitstring = (OpenSecureChannelResponse,Ns_6003,ST_6004,TTL_6005) in
                                                            {7438}event beginSrv(Sess_5025,Cli_5023,Ns_6003);
                                                            {7439}out(c, (enc(m2_6006,pkCli_5976),sign(h(m2_6006),skSess_5973)));
                                                            {7440}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                            {7441}event endSrv(Cli_5023,Sess_5025,Nc_6002)
                                                    )
                                                    else
                                                        {7442}let pkDisco_6007: bitstring = pub(sk(Disco_5024)) in
                                                        {7443}in(c, (=pkCli_5976,em1_6008: bitstring,sigM1_6009: bitstring));
                                                        {7444}let m1_6010: bitstring = dec(em1_6008,skSess_5973) in
                                                        {7445}if (verify(h(m1_6010),sigM1_6009,pkCli_5976) <> true) then
                                                            0
                                                        else
                                                            {7446}let (=OpenSecureChannelRequest,=pkCli_5976,Nc_6011: bitstring) = m1_6010 in
                                                            {7447}new Ns_6012: bitstring;
                                                            {7448}new ST_6013: bitstring;
                                                            {7449}new TTL_6014: bitstring;
                                                            {7450}let m2_6015: bitstring = (OpenSecureChannelResponse,Ns_6012,ST_6013,TTL_6014) in
                                                            {7451}event beginSrv(Sess_5025,Cli_5023,Ns_6012);
                                                            {7452}out(c, (enc(m2_6015,pkCli_5976),sign(h(m2_6015),skSess_5973)));
                                                            {7453}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                            {7454}event endSrv(Cli_5023,Sess_5025,Nc_6011)
                                                )
                                                else
                                                    {7455}let pkDisco_6016: bitstring = fail-any in
                                                    {7456}in(c, (=pkCli_5976,em1_6017: bitstring,sigM1_6018: bitstring));
                                                    {7457}let m1_6019: bitstring = dec(em1_6017,skSess_5973) in
                                                    {7458}if (verify(h(m1_6019),sigM1_6018,pkCli_5976) <> true) then
                                                        0
                                                    else
                                                        {7459}let (=OpenSecureChannelRequest,=pkCli_5976,Nc_6020: bitstring) = m1_6019 in
                                                        {7460}new Ns_6021: bitstring;
                                                        {7461}new ST_6022: bitstring;
                                                        {7462}new TTL_6023: bitstring;
                                                        {7463}let m2_6024: bitstring = (OpenSecureChannelResponse,Ns_6021,ST_6022,TTL_6023) in
                                                        {7464}event beginSrv(Sess_5025,Cli_5023,Ns_6021);
                                                        {7465}out(c, (enc(m2_6024,pkCli_5976),sign(h(m2_6024),skSess_5973)));
                                                        {7466}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                        {7467}event endSrv(Cli_5023,Sess_5025,Nc_6020)
                                        )
                                        else
                                            {7468}let pkDisco_6025: bitstring = fail-any in
                                            {7469}in(c, (=pkCli_5976,em1_6026: bitstring,sigM1_6027: bitstring));
                                            {7470}let m1_6028: bitstring = dec(em1_6026,skSess_5973) in
                                            {7471}if (verify(h(m1_6028),sigM1_6027,pkCli_5976) <> true) then
                                                0
                                            else
                                                {7472}let (=OpenSecureChannelRequest,=pkCli_5976,Nc_6029: bitstring) = m1_6028 in
                                                {7473}new Ns_6030: bitstring;
                                                {7474}new ST_6031: bitstring;
                                                {7475}new TTL_6032: bitstring;
                                                {7476}let m2_6033: bitstring = (OpenSecureChannelResponse,Ns_6030,ST_6031,TTL_6032) in
                                                {7477}event beginSrv(Sess_5025,Cli_5023,Ns_6030);
                                                {7478}out(c, (enc(m2_6033,pkCli_5976),sign(h(m2_6033),skSess_5973)));
                                                {7479}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                {7480}event endSrv(Cli_5023,Sess_5025,Nc_6029)
                                )
                                else
                                    {7481}let pkDisco_6034: bitstring = fail-any in
                                    {7482}in(c, (=pkCli_5976,em1_6035: bitstring,sigM1_6036: bitstring));
                                    {7483}let m1_6037: bitstring = dec(em1_6035,skSess_5973) in
                                    {7484}if (verify(h(m1_6037),sigM1_6036,pkCli_5976) <> true) then
                                        0
                                    else
                                        {7485}let (=OpenSecureChannelRequest,=pkCli_5976,Nc_6038: bitstring) = m1_6037 in
                                        {7486}new Ns_6039: bitstring;
                                        {7487}new ST_6040: bitstring;
                                        {7488}new TTL_6041: bitstring;
                                        {7489}let m2_6042: bitstring = (OpenSecureChannelResponse,Ns_6039,ST_6040,TTL_6041) in
                                        {7490}event beginSrv(Sess_5025,Cli_5023,Ns_6039);
                                        {7491}out(c, (enc(m2_6042,pkCli_5976),sign(h(m2_6042),skSess_5973)));
                                        {7492}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                        {7493}event endSrv(Cli_5023,Sess_5025,Nc_6038)
                            )
                            else
                                {7494}let v_6043: bool = (Cli_5023 = B) in
                                (
                                    {7495}if v_6043 then
                                    (
                                        {7496}let pkCli_6044: bitstring = pub(skB) in
                                        {7497}let v_6045: bool = (Disco_5024 = A) in
                                        (
                                            {7498}if v_6045 then
                                            (
                                                {7499}let pkDisco_6046: bitstring = pub(skA) in
                                                {7500}in(c, (=pkCli_6044,em1_6047: bitstring,sigM1_6048: bitstring));
                                                {7501}let m1_6049: bitstring = dec(em1_6047,skSess_5973) in
                                                {7502}if (verify(h(m1_6049),sigM1_6048,pkCli_6044) <> true) then
                                                    0
                                                else
                                                    {7503}let (=OpenSecureChannelRequest,=pkCli_6044,Nc_6050: bitstring) = m1_6049 in
                                                    {7504}new Ns_6051: bitstring;
                                                    {7505}new ST_6052: bitstring;
                                                    {7506}new TTL_6053: bitstring;
                                                    {7507}let m2_6054: bitstring = (OpenSecureChannelResponse,Ns_6051,ST_6052,TTL_6053) in
                                                    {7508}event beginSrv(Sess_5025,Cli_5023,Ns_6051);
                                                    {7509}out(c, (enc(m2_6054,pkCli_6044),sign(h(m2_6054),skSess_5973)));
                                                    {7510}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                    {7511}event endSrv(Cli_5023,Sess_5025,Nc_6050)
                                            )
                                            else
                                                {7512}let v_6055: bool = (Disco_5024 = B) in
                                                (
                                                    {7513}if v_6055 then
                                                    (
                                                        {7514}let pkDisco_6056: bitstring = pub(skB) in
                                                        {7515}in(c, (=pkCli_6044,em1_6057: bitstring,sigM1_6058: bitstring));
                                                        {7516}let m1_6059: bitstring = dec(em1_6057,skSess_5973) in
                                                        {7517}if (verify(h(m1_6059),sigM1_6058,pkCli_6044) <> true) then
                                                            0
                                                        else
                                                            {7518}let (=OpenSecureChannelRequest,=pkCli_6044,Nc_6060: bitstring) = m1_6059 in
                                                            {7519}new Ns_6061: bitstring;
                                                            {7520}new ST_6062: bitstring;
                                                            {7521}new TTL_6063: bitstring;
                                                            {7522}let m2_6064: bitstring = (OpenSecureChannelResponse,Ns_6061,ST_6062,TTL_6063) in
                                                            {7523}event beginSrv(Sess_5025,Cli_5023,Ns_6061);
                                                            {7524}out(c, (enc(m2_6064,pkCli_6044),sign(h(m2_6064),skSess_5973)));
                                                            {7525}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                            {7526}event endSrv(Cli_5023,Sess_5025,Nc_6060)
                                                    )
                                                    else
                                                        {7527}let v_6065: bool = (Disco_5024 = C) in
                                                        (
                                                            {7528}if v_6065 then
                                                            (
                                                                {7529}let pkDisco_6066: bitstring = pub(skC) in
                                                                {7530}in(c, (=pkCli_6044,em1_6067: bitstring,sigM1_6068: bitstring));
                                                                {7531}let m1_6069: bitstring = dec(em1_6067,skSess_5973) in
                                                                {7532}if (verify(h(m1_6069),sigM1_6068,pkCli_6044) <> true) then
                                                                    0
                                                                else
                                                                    {7533}let (=OpenSecureChannelRequest,=pkCli_6044,Nc_6070: bitstring) = m1_6069 in
                                                                    {7534}new Ns_6071: bitstring;
                                                                    {7535}new ST_6072: bitstring;
                                                                    {7536}new TTL_6073: bitstring;
                                                                    {7537}let m2_6074: bitstring = (OpenSecureChannelResponse,Ns_6071,ST_6072,TTL_6073) in
                                                                    {7538}event beginSrv(Sess_5025,Cli_5023,Ns_6071);
                                                                    {7539}out(c, (enc(m2_6074,pkCli_6044),sign(h(m2_6074),skSess_5973)));
                                                                    {7540}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                                    {7541}event endSrv(Cli_5023,Sess_5025,Nc_6070)
                                                            )
                                                            else
                                                                {7542}let pkDisco_6075: bitstring = pub(sk(Disco_5024)) in
                                                                {7543}in(c, (=pkCli_6044,em1_6076: bitstring,sigM1_6077: bitstring));
                                                                {7544}let m1_6078: bitstring = dec(em1_6076,skSess_5973) in
                                                                {7545}if (verify(h(m1_6078),sigM1_6077,pkCli_6044) <> true) then
                                                                    0
                                                                else
                                                                    {7546}let (=OpenSecureChannelRequest,=pkCli_6044,Nc_6079: bitstring) = m1_6078 in
                                                                    {7547}new Ns_6080: bitstring;
                                                                    {7548}new ST_6081: bitstring;
                                                                    {7549}new TTL_6082: bitstring;
                                                                    {7550}let m2_6083: bitstring = (OpenSecureChannelResponse,Ns_6080,ST_6081,TTL_6082) in
                                                                    {7551}event beginSrv(Sess_5025,Cli_5023,Ns_6080);
                                                                    {7552}out(c, (enc(m2_6083,pkCli_6044),sign(h(m2_6083),skSess_5973)));
                                                                    {7553}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                                    {7554}event endSrv(Cli_5023,Sess_5025,Nc_6079)
                                                        )
                                                        else
                                                            {7555}let pkDisco_6084: bitstring = fail-any in
                                                            {7556}in(c, (=pkCli_6044,em1_6085: bitstring,sigM1_6086: bitstring));
                                                            {7557}let m1_6087: bitstring = dec(em1_6085,skSess_5973) in
                                                            {7558}if (verify(h(m1_6087),sigM1_6086,pkCli_6044) <> true) then
                                                                0
                                                            else
                                                                {7559}let (=OpenSecureChannelRequest,=pkCli_6044,Nc_6088: bitstring) = m1_6087 in
                                                                {7560}new Ns_6089: bitstring;
                                                                {7561}new ST_6090: bitstring;
                                                                {7562}new TTL_6091: bitstring;
                                                                {7563}let m2_6092: bitstring = (OpenSecureChannelResponse,Ns_6089,ST_6090,TTL_6091) in
                                                                {7564}event beginSrv(Sess_5025,Cli_5023,Ns_6089);
                                                                {7565}out(c, (enc(m2_6092,pkCli_6044),sign(h(m2_6092),skSess_5973)));
                                                                {7566}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                                {7567}event endSrv(Cli_5023,Sess_5025,Nc_6088)
                                                )
                                                else
                                                    {7568}let pkDisco_6093: bitstring = fail-any in
                                                    {7569}in(c, (=pkCli_6044,em1_6094: bitstring,sigM1_6095: bitstring));
                                                    {7570}let m1_6096: bitstring = dec(em1_6094,skSess_5973) in
                                                    {7571}if (verify(h(m1_6096),sigM1_6095,pkCli_6044) <> true) then
                                                        0
                                                    else
                                                        {7572}let (=OpenSecureChannelRequest,=pkCli_6044,Nc_6097: bitstring) = m1_6096 in
                                                        {7573}new Ns_6098: bitstring;
                                                        {7574}new ST_6099: bitstring;
                                                        {7575}new TTL_6100: bitstring;
                                                        {7576}let m2_6101: bitstring = (OpenSecureChannelResponse,Ns_6098,ST_6099,TTL_6100) in
                                                        {7577}event beginSrv(Sess_5025,Cli_5023,Ns_6098);
                                                        {7578}out(c, (enc(m2_6101,pkCli_6044),sign(h(m2_6101),skSess_5973)));
                                                        {7579}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                        {7580}event endSrv(Cli_5023,Sess_5025,Nc_6097)
                                        )
                                        else
                                            {7581}let pkDisco_6102: bitstring = fail-any in
                                            {7582}in(c, (=pkCli_6044,em1_6103: bitstring,sigM1_6104: bitstring));
                                            {7583}let m1_6105: bitstring = dec(em1_6103,skSess_5973) in
                                            {7584}if (verify(h(m1_6105),sigM1_6104,pkCli_6044) <> true) then
                                                0
                                            else
                                                {7585}let (=OpenSecureChannelRequest,=pkCli_6044,Nc_6106: bitstring) = m1_6105 in
                                                {7586}new Ns_6107: bitstring;
                                                {7587}new ST_6108: bitstring;
                                                {7588}new TTL_6109: bitstring;
                                                {7589}let m2_6110: bitstring = (OpenSecureChannelResponse,Ns_6107,ST_6108,TTL_6109) in
                                                {7590}event beginSrv(Sess_5025,Cli_5023,Ns_6107);
                                                {7591}out(c, (enc(m2_6110,pkCli_6044),sign(h(m2_6110),skSess_5973)));
                                                {7592}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                {7593}event endSrv(Cli_5023,Sess_5025,Nc_6106)
                                    )
                                    else
                                        {7594}let v_6111: bool = (Cli_5023 = C) in
                                        (
                                            {7595}if v_6111 then
                                            (
                                                {7596}let pkCli_6112: bitstring = pub(skC) in
                                                {7597}let v_6113: bool = (Disco_5024 = A) in
                                                (
                                                    {7598}if v_6113 then
                                                    (
                                                        {7599}let pkDisco_6114: bitstring = pub(skA) in
                                                        {7600}in(c, (=pkCli_6112,em1_6115: bitstring,sigM1_6116: bitstring));
                                                        {7601}let m1_6117: bitstring = dec(em1_6115,skSess_5973) in
                                                        {7602}if (verify(h(m1_6117),sigM1_6116,pkCli_6112) <> true) then
                                                            0
                                                        else
                                                            {7603}let (=OpenSecureChannelRequest,=pkCli_6112,Nc_6118: bitstring) = m1_6117 in
                                                            {7604}new Ns_6119: bitstring;
                                                            {7605}new ST_6120: bitstring;
                                                            {7606}new TTL_6121: bitstring;
                                                            {7607}let m2_6122: bitstring = (OpenSecureChannelResponse,Ns_6119,ST_6120,TTL_6121) in
                                                            {7608}event beginSrv(Sess_5025,Cli_5023,Ns_6119);
                                                            {7609}out(c, (enc(m2_6122,pkCli_6112),sign(h(m2_6122),skSess_5973)));
                                                            {7610}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                            {7611}event endSrv(Cli_5023,Sess_5025,Nc_6118)
                                                    )
                                                    else
                                                        {7612}let v_6123: bool = (Disco_5024 = B) in
                                                        (
                                                            {7613}if v_6123 then
                                                            (
                                                                {7614}let pkDisco_6124: bitstring = pub(skB) in
                                                                {7615}in(c, (=pkCli_6112,em1_6125: bitstring,sigM1_6126: bitstring));
                                                                {7616}let m1_6127: bitstring = dec(em1_6125,skSess_5973) in
                                                                {7617}if (verify(h(m1_6127),sigM1_6126,pkCli_6112) <> true) then
                                                                    0
                                                                else
                                                                    {7618}let (=OpenSecureChannelRequest,=pkCli_6112,Nc_6128: bitstring) = m1_6127 in
                                                                    {7619}new Ns_6129: bitstring;
                                                                    {7620}new ST_6130: bitstring;
                                                                    {7621}new TTL_6131: bitstring;
                                                                    {7622}let m2_6132: bitstring = (OpenSecureChannelResponse,Ns_6129,ST_6130,TTL_6131) in
                                                                    {7623}event beginSrv(Sess_5025,Cli_5023,Ns_6129);
                                                                    {7624}out(c, (enc(m2_6132,pkCli_6112),sign(h(m2_6132),skSess_5973)));
                                                                    {7625}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                                    {7626}event endSrv(Cli_5023,Sess_5025,Nc_6128)
                                                            )
                                                            else
                                                                {7627}let v_6133: bool = (Disco_5024 = C) in
                                                                (
                                                                    {7628}if v_6133 then
                                                                    (
                                                                        {7629}let pkDisco_6134: bitstring = pub(skC) in
                                                                        {7630}in(c, (=pkCli_6112,em1_6135: bitstring,sigM1_6136: bitstring));
                                                                        {7631}let m1_6137: bitstring = dec(em1_6135,skSess_5973) in
                                                                        {7632}if (verify(h(m1_6137),sigM1_6136,pkCli_6112) <> true) then
                                                                            0
                                                                        else
                                                                            {7633}let (=OpenSecureChannelRequest,=pkCli_6112,Nc_6138: bitstring) = m1_6137 in
                                                                            {7634}new Ns_6139: bitstring;
                                                                            {7635}new ST_6140: bitstring;
                                                                            {7636}new TTL_6141: bitstring;
                                                                            {7637}let m2_6142: bitstring = (OpenSecureChannelResponse,Ns_6139,ST_6140,TTL_6141) in
                                                                            {7638}event beginSrv(Sess_5025,Cli_5023,Ns_6139);
                                                                            {7639}out(c, (enc(m2_6142,pkCli_6112),sign(h(m2_6142),skSess_5973)));
                                                                            {7640}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                                            {7641}event endSrv(Cli_5023,Sess_5025,Nc_6138)
                                                                    )
                                                                    else
                                                                        {7642}let pkDisco_6143: bitstring = pub(sk(Disco_5024)) in
                                                                        {7643}in(c, (=pkCli_6112,em1_6144: bitstring,sigM1_6145: bitstring));
                                                                        {7644}let m1_6146: bitstring = dec(em1_6144,skSess_5973) in
                                                                        {7645}if (verify(h(m1_6146),sigM1_6145,pkCli_6112) <> true) then
                                                                            0
                                                                        else
                                                                            {7646}let (=OpenSecureChannelRequest,=pkCli_6112,Nc_6147: bitstring) = m1_6146 in
                                                                            {7647}new Ns_6148: bitstring;
                                                                            {7648}new ST_6149: bitstring;
                                                                            {7649}new TTL_6150: bitstring;
                                                                            {7650}let m2_6151: bitstring = (OpenSecureChannelResponse,Ns_6148,ST_6149,TTL_6150) in
                                                                            {7651}event beginSrv(Sess_5025,Cli_5023,Ns_6148);
                                                                            {7652}out(c, (enc(m2_6151,pkCli_6112),sign(h(m2_6151),skSess_5973)));
                                                                            {7653}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                                            {7654}event endSrv(Cli_5023,Sess_5025,Nc_6147)
                                                                )
                                                                else
                                                                    {7655}let pkDisco_6152: bitstring = fail-any in
                                                                    {7656}in(c, (=pkCli_6112,em1_6153: bitstring,sigM1_6154: bitstring));
                                                                    {7657}let m1_6155: bitstring = dec(em1_6153,skSess_5973) in
                                                                    {7658}if (verify(h(m1_6155),sigM1_6154,pkCli_6112) <> true) then
                                                                        0
                                                                    else
                                                                        {7659}let (=OpenSecureChannelRequest,=pkCli_6112,Nc_6156: bitstring) = m1_6155 in
                                                                        {7660}new Ns_6157: bitstring;
                                                                        {7661}new ST_6158: bitstring;
                                                                        {7662}new TTL_6159: bitstring;
                                                                        {7663}let m2_6160: bitstring = (OpenSecureChannelResponse,Ns_6157,ST_6158,TTL_6159) in
                                                                        {7664}event beginSrv(Sess_5025,Cli_5023,Ns_6157);
                                                                        {7665}out(c, (enc(m2_6160,pkCli_6112),sign(h(m2_6160),skSess_5973)));
                                                                        {7666}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                                        {7667}event endSrv(Cli_5023,Sess_5025,Nc_6156)
                                                        )
                                                        else
                                                            {7668}let pkDisco_6161: bitstring = fail-any in
                                                            {7669}in(c, (=pkCli_6112,em1_6162: bitstring,sigM1_6163: bitstring));
                                                            {7670}let m1_6164: bitstring = dec(em1_6162,skSess_5973) in
                                                            {7671}if (verify(h(m1_6164),sigM1_6163,pkCli_6112) <> true) then
                                                                0
                                                            else
                                                                {7672}let (=OpenSecureChannelRequest,=pkCli_6112,Nc_6165: bitstring) = m1_6164 in
                                                                {7673}new Ns_6166: bitstring;
                                                                {7674}new ST_6167: bitstring;
                                                                {7675}new TTL_6168: bitstring;
                                                                {7676}let m2_6169: bitstring = (OpenSecureChannelResponse,Ns_6166,ST_6167,TTL_6168) in
                                                                {7677}event beginSrv(Sess_5025,Cli_5023,Ns_6166);
                                                                {7678}out(c, (enc(m2_6169,pkCli_6112),sign(h(m2_6169),skSess_5973)));
                                                                {7679}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                                {7680}event endSrv(Cli_5023,Sess_5025,Nc_6165)
                                                )
                                                else
                                                    {7681}let pkDisco_6170: bitstring = fail-any in
                                                    {7682}in(c, (=pkCli_6112,em1_6171: bitstring,sigM1_6172: bitstring));
                                                    {7683}let m1_6173: bitstring = dec(em1_6171,skSess_5973) in
                                                    {7684}if (verify(h(m1_6173),sigM1_6172,pkCli_6112) <> true) then
                                                        0
                                                    else
                                                        {7685}let (=OpenSecureChannelRequest,=pkCli_6112,Nc_6174: bitstring) = m1_6173 in
                                                        {7686}new Ns_6175: bitstring;
                                                        {7687}new ST_6176: bitstring;
                                                        {7688}new TTL_6177: bitstring;
                                                        {7689}let m2_6178: bitstring = (OpenSecureChannelResponse,Ns_6175,ST_6176,TTL_6177) in
                                                        {7690}event beginSrv(Sess_5025,Cli_5023,Ns_6175);
                                                        {7691}out(c, (enc(m2_6178,pkCli_6112),sign(h(m2_6178),skSess_5973)));
                                                        {7692}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                        {7693}event endSrv(Cli_5023,Sess_5025,Nc_6174)
                                            )
                                            else
                                                {7694}let pkCli_6179: bitstring = pub(sk(Cli_5023)) in
                                                {7695}let v_6180: bool = (Disco_5024 = A) in
                                                (
                                                    {7696}if v_6180 then
                                                    (
                                                        {7697}let pkDisco_6181: bitstring = pub(skA) in
                                                        {7698}in(c, (=pkCli_6179,em1_6182: bitstring,sigM1_6183: bitstring));
                                                        {7699}let m1_6184: bitstring = dec(em1_6182,skSess_5973) in
                                                        {7700}if (verify(h(m1_6184),sigM1_6183,pkCli_6179) <> true) then
                                                            0
                                                        else
                                                            {7701}let (=OpenSecureChannelRequest,=pkCli_6179,Nc_6185: bitstring) = m1_6184 in
                                                            {7702}new Ns_6186: bitstring;
                                                            {7703}new ST_6187: bitstring;
                                                            {7704}new TTL_6188: bitstring;
                                                            {7705}let m2_6189: bitstring = (OpenSecureChannelResponse,Ns_6186,ST_6187,TTL_6188) in
                                                            {7706}event beginSrv(Sess_5025,Cli_5023,Ns_6186);
                                                            {7707}out(c, (enc(m2_6189,pkCli_6179),sign(h(m2_6189),skSess_5973)));
                                                            {7708}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                            {7709}event endSrv(Cli_5023,Sess_5025,Nc_6185)
                                                    )
                                                    else
                                                        {7710}let v_6190: bool = (Disco_5024 = B) in
                                                        (
                                                            {7711}if v_6190 then
                                                            (
                                                                {7712}let pkDisco_6191: bitstring = pub(skB) in
                                                                {7713}in(c, (=pkCli_6179,em1_6192: bitstring,sigM1_6193: bitstring));
                                                                {7714}let m1_6194: bitstring = dec(em1_6192,skSess_5973) in
                                                                {7715}if (verify(h(m1_6194),sigM1_6193,pkCli_6179) <> true) then
                                                                    0
                                                                else
                                                                    {7716}let (=OpenSecureChannelRequest,=pkCli_6179,Nc_6195: bitstring) = m1_6194 in
                                                                    {7717}new Ns_6196: bitstring;
                                                                    {7718}new ST_6197: bitstring;
                                                                    {7719}new TTL_6198: bitstring;
                                                                    {7720}let m2_6199: bitstring = (OpenSecureChannelResponse,Ns_6196,ST_6197,TTL_6198) in
                                                                    {7721}event beginSrv(Sess_5025,Cli_5023,Ns_6196);
                                                                    {7722}out(c, (enc(m2_6199,pkCli_6179),sign(h(m2_6199),skSess_5973)));
                                                                    {7723}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                                    {7724}event endSrv(Cli_5023,Sess_5025,Nc_6195)
                                                            )
                                                            else
                                                                {7725}let v_6200: bool = (Disco_5024 = C) in
                                                                (
                                                                    {7726}if v_6200 then
                                                                    (
                                                                        {7727}let pkDisco_6201: bitstring = pub(skC) in
                                                                        {7728}in(c, (=pkCli_6179,em1_6202: bitstring,sigM1_6203: bitstring));
                                                                        {7729}let m1_6204: bitstring = dec(em1_6202,skSess_5973) in
                                                                        {7730}if (verify(h(m1_6204),sigM1_6203,pkCli_6179) <> true) then
                                                                            0
                                                                        else
                                                                            {7731}let (=OpenSecureChannelRequest,=pkCli_6179,Nc_6205: bitstring) = m1_6204 in
                                                                            {7732}new Ns_6206: bitstring;
                                                                            {7733}new ST_6207: bitstring;
                                                                            {7734}new TTL_6208: bitstring;
                                                                            {7735}let m2_6209: bitstring = (OpenSecureChannelResponse,Ns_6206,ST_6207,TTL_6208) in
                                                                            {7736}event beginSrv(Sess_5025,Cli_5023,Ns_6206);
                                                                            {7737}out(c, (enc(m2_6209,pkCli_6179),sign(h(m2_6209),skSess_5973)));
                                                                            {7738}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                                            {7739}event endSrv(Cli_5023,Sess_5025,Nc_6205)
                                                                    )
                                                                    else
                                                                        {7740}let pkDisco_6210: bitstring = pub(sk(Disco_5024)) in
                                                                        {7741}in(c, (=pkCli_6179,em1_6211: bitstring,sigM1_6212: bitstring));
                                                                        {7742}let m1_6213: bitstring = dec(em1_6211,skSess_5973) in
                                                                        {7743}if (verify(h(m1_6213),sigM1_6212,pkCli_6179) <> true) then
                                                                            0
                                                                        else
                                                                            {7744}let (=OpenSecureChannelRequest,=pkCli_6179,Nc_6214: bitstring) = m1_6213 in
                                                                            {7745}new Ns_6215: bitstring;
                                                                            {7746}new ST_6216: bitstring;
                                                                            {7747}new TTL_6217: bitstring;
                                                                            {7748}let m2_6218: bitstring = (OpenSecureChannelResponse,Ns_6215,ST_6216,TTL_6217) in
                                                                            {7749}event beginSrv(Sess_5025,Cli_5023,Ns_6215);
                                                                            {7750}out(c, (enc(m2_6218,pkCli_6179),sign(h(m2_6218),skSess_5973)));
                                                                            {7751}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                                            {7752}event endSrv(Cli_5023,Sess_5025,Nc_6214)
                                                                )
                                                                else
                                                                    {7753}let pkDisco_6219: bitstring = fail-any in
                                                                    {7754}in(c, (=pkCli_6179,em1_6220: bitstring,sigM1_6221: bitstring));
                                                                    {7755}let m1_6222: bitstring = dec(em1_6220,skSess_5973) in
                                                                    {7756}if (verify(h(m1_6222),sigM1_6221,pkCli_6179) <> true) then
                                                                        0
                                                                    else
                                                                        {7757}let (=OpenSecureChannelRequest,=pkCli_6179,Nc_6223: bitstring) = m1_6222 in
                                                                        {7758}new Ns_6224: bitstring;
                                                                        {7759}new ST_6225: bitstring;
                                                                        {7760}new TTL_6226: bitstring;
                                                                        {7761}let m2_6227: bitstring = (OpenSecureChannelResponse,Ns_6224,ST_6225,TTL_6226) in
                                                                        {7762}event beginSrv(Sess_5025,Cli_5023,Ns_6224);
                                                                        {7763}out(c, (enc(m2_6227,pkCli_6179),sign(h(m2_6227),skSess_5973)));
                                                                        {7764}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                                        {7765}event endSrv(Cli_5023,Sess_5025,Nc_6223)
                                                        )
                                                        else
                                                            {7766}let pkDisco_6228: bitstring = fail-any in
                                                            {7767}in(c, (=pkCli_6179,em1_6229: bitstring,sigM1_6230: bitstring));
                                                            {7768}let m1_6231: bitstring = dec(em1_6229,skSess_5973) in
                                                            {7769}if (verify(h(m1_6231),sigM1_6230,pkCli_6179) <> true) then
                                                                0
                                                            else
                                                                {7770}let (=OpenSecureChannelRequest,=pkCli_6179,Nc_6232: bitstring) = m1_6231 in
                                                                {7771}new Ns_6233: bitstring;
                                                                {7772}new ST_6234: bitstring;
                                                                {7773}new TTL_6235: bitstring;
                                                                {7774}let m2_6236: bitstring = (OpenSecureChannelResponse,Ns_6233,ST_6234,TTL_6235) in
                                                                {7775}event beginSrv(Sess_5025,Cli_5023,Ns_6233);
                                                                {7776}out(c, (enc(m2_6236,pkCli_6179),sign(h(m2_6236),skSess_5973)));
                                                                {7777}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                                {7778}event endSrv(Cli_5023,Sess_5025,Nc_6232)
                                                )
                                                else
                                                    {7779}let pkDisco_6237: bitstring = fail-any in
                                                    {7780}in(c, (=pkCli_6179,em1_6238: bitstring,sigM1_6239: bitstring));
                                                    {7781}let m1_6240: bitstring = dec(em1_6238,skSess_5973) in
                                                    {7782}if (verify(h(m1_6240),sigM1_6239,pkCli_6179) <> true) then
                                                        0
                                                    else
                                                        {7783}let (=OpenSecureChannelRequest,=pkCli_6179,Nc_6241: bitstring) = m1_6240 in
                                                        {7784}new Ns_6242: bitstring;
                                                        {7785}new ST_6243: bitstring;
                                                        {7786}new TTL_6244: bitstring;
                                                        {7787}let m2_6245: bitstring = (OpenSecureChannelResponse,Ns_6242,ST_6243,TTL_6244) in
                                                        {7788}event beginSrv(Sess_5025,Cli_5023,Ns_6242);
                                                        {7789}out(c, (enc(m2_6245,pkCli_6179),sign(h(m2_6245),skSess_5973)));
                                                        {7790}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                        {7791}event endSrv(Cli_5023,Sess_5025,Nc_6241)
                                        )
                                        else
                                            {7792}let pkCli_6246: bitstring = fail-any in
                                            {7793}let v_6247: bool = (Disco_5024 = A) in
                                            (
                                                {7794}if v_6247 then
                                                (
                                                    {7795}let pkDisco_6248: bitstring = pub(skA) in
                                                    {7796}in(c, (=pkCli_6246,em1_6249: bitstring,sigM1_6250: bitstring));
                                                    {7797}let m1_6251: bitstring = dec(em1_6249,skSess_5973) in
                                                    {7798}if (verify(h(m1_6251),sigM1_6250,pkCli_6246) <> true) then
                                                        0
                                                    else
                                                        {7799}let (=OpenSecureChannelRequest,=pkCli_6246,Nc_6252: bitstring) = m1_6251 in
                                                        {7800}new Ns_6253: bitstring;
                                                        {7801}new ST_6254: bitstring;
                                                        {7802}new TTL_6255: bitstring;
                                                        {7803}let m2_6256: bitstring = (OpenSecureChannelResponse,Ns_6253,ST_6254,TTL_6255) in
                                                        {7804}event beginSrv(Sess_5025,Cli_5023,Ns_6253);
                                                        {7805}out(c, (enc(m2_6256,pkCli_6246),sign(h(m2_6256),skSess_5973)));
                                                        {7806}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                        {7807}event endSrv(Cli_5023,Sess_5025,Nc_6252)
                                                )
                                                else
                                                    {7808}let v_6257: bool = (Disco_5024 = B) in
                                                    (
                                                        {7809}if v_6257 then
                                                        (
                                                            {7810}let pkDisco_6258: bitstring = pub(skB) in
                                                            {7811}in(c, (=pkCli_6246,em1_6259: bitstring,sigM1_6260: bitstring));
                                                            {7812}let m1_6261: bitstring = dec(em1_6259,skSess_5973) in
                                                            {7813}if (verify(h(m1_6261),sigM1_6260,pkCli_6246) <> true) then
                                                                0
                                                            else
                                                                {7814}let (=OpenSecureChannelRequest,=pkCli_6246,Nc_6262: bitstring) = m1_6261 in
                                                                {7815}new Ns_6263: bitstring;
                                                                {7816}new ST_6264: bitstring;
                                                                {7817}new TTL_6265: bitstring;
                                                                {7818}let m2_6266: bitstring = (OpenSecureChannelResponse,Ns_6263,ST_6264,TTL_6265) in
                                                                {7819}event beginSrv(Sess_5025,Cli_5023,Ns_6263);
                                                                {7820}out(c, (enc(m2_6266,pkCli_6246),sign(h(m2_6266),skSess_5973)));
                                                                {7821}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                                {7822}event endSrv(Cli_5023,Sess_5025,Nc_6262)
                                                        )
                                                        else
                                                            {7823}let v_6267: bool = (Disco_5024 = C) in
                                                            (
                                                                {7824}if v_6267 then
                                                                (
                                                                    {7825}let pkDisco_6268: bitstring = pub(skC) in
                                                                    {7826}in(c, (=pkCli_6246,em1_6269: bitstring,sigM1_6270: bitstring));
                                                                    {7827}let m1_6271: bitstring = dec(em1_6269,skSess_5973) in
                                                                    {7828}if (verify(h(m1_6271),sigM1_6270,pkCli_6246) <> true) then
                                                                        0
                                                                    else
                                                                        {7829}let (=OpenSecureChannelRequest,=pkCli_6246,Nc_6272: bitstring) = m1_6271 in
                                                                        {7830}new Ns_6273: bitstring;
                                                                        {7831}new ST_6274: bitstring;
                                                                        {7832}new TTL_6275: bitstring;
                                                                        {7833}let m2_6276: bitstring = (OpenSecureChannelResponse,Ns_6273,ST_6274,TTL_6275) in
                                                                        {7834}event beginSrv(Sess_5025,Cli_5023,Ns_6273);
                                                                        {7835}out(c, (enc(m2_6276,pkCli_6246),sign(h(m2_6276),skSess_5973)));
                                                                        {7836}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                                        {7837}event endSrv(Cli_5023,Sess_5025,Nc_6272)
                                                                )
                                                                else
                                                                    {7838}let pkDisco_6277: bitstring = pub(sk(Disco_5024)) in
                                                                    {7839}in(c, (=pkCli_6246,em1_6278: bitstring,sigM1_6279: bitstring));
                                                                    {7840}let m1_6280: bitstring = dec(em1_6278,skSess_5973) in
                                                                    {7841}if (verify(h(m1_6280),sigM1_6279,pkCli_6246) <> true) then
                                                                        0
                                                                    else
                                                                        {7842}let (=OpenSecureChannelRequest,=pkCli_6246,Nc_6281: bitstring) = m1_6280 in
                                                                        {7843}new Ns_6282: bitstring;
                                                                        {7844}new ST_6283: bitstring;
                                                                        {7845}new TTL_6284: bitstring;
                                                                        {7846}let m2_6285: bitstring = (OpenSecureChannelResponse,Ns_6282,ST_6283,TTL_6284) in
                                                                        {7847}event beginSrv(Sess_5025,Cli_5023,Ns_6282);
                                                                        {7848}out(c, (enc(m2_6285,pkCli_6246),sign(h(m2_6285),skSess_5973)));
                                                                        {7849}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                                        {7850}event endSrv(Cli_5023,Sess_5025,Nc_6281)
                                                            )
                                                            else
                                                                {7851}let pkDisco_6286: bitstring = fail-any in
                                                                {7852}in(c, (=pkCli_6246,em1_6287: bitstring,sigM1_6288: bitstring));
                                                                {7853}let m1_6289: bitstring = dec(em1_6287,skSess_5973) in
                                                                {7854}if (verify(h(m1_6289),sigM1_6288,pkCli_6246) <> true) then
                                                                    0
                                                                else
                                                                    {7855}let (=OpenSecureChannelRequest,=pkCli_6246,Nc_6290: bitstring) = m1_6289 in
                                                                    {7856}new Ns_6291: bitstring;
                                                                    {7857}new ST_6292: bitstring;
                                                                    {7858}new TTL_6293: bitstring;
                                                                    {7859}let m2_6294: bitstring = (OpenSecureChannelResponse,Ns_6291,ST_6292,TTL_6293) in
                                                                    {7860}event beginSrv(Sess_5025,Cli_5023,Ns_6291);
                                                                    {7861}out(c, (enc(m2_6294,pkCli_6246),sign(h(m2_6294),skSess_5973)));
                                                                    {7862}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                                    {7863}event endSrv(Cli_5023,Sess_5025,Nc_6290)
                                                    )
                                                    else
                                                        {7864}let pkDisco_6295: bitstring = fail-any in
                                                        {7865}in(c, (=pkCli_6246,em1_6296: bitstring,sigM1_6297: bitstring));
                                                        {7866}let m1_6298: bitstring = dec(em1_6296,skSess_5973) in
                                                        {7867}if (verify(h(m1_6298),sigM1_6297,pkCli_6246) <> true) then
                                                            0
                                                        else
                                                            {7868}let (=OpenSecureChannelRequest,=pkCli_6246,Nc_6299: bitstring) = m1_6298 in
                                                            {7869}new Ns_6300: bitstring;
                                                            {7870}new ST_6301: bitstring;
                                                            {7871}new TTL_6302: bitstring;
                                                            {7872}let m2_6303: bitstring = (OpenSecureChannelResponse,Ns_6300,ST_6301,TTL_6302) in
                                                            {7873}event beginSrv(Sess_5025,Cli_5023,Ns_6300);
                                                            {7874}out(c, (enc(m2_6303,pkCli_6246),sign(h(m2_6303),skSess_5973)));
                                                            {7875}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                            {7876}event endSrv(Cli_5023,Sess_5025,Nc_6299)
                                            )
                                            else
                                                {7877}let pkDisco_6304: bitstring = fail-any in
                                                {7878}in(c, (=pkCli_6246,em1_6305: bitstring,sigM1_6306: bitstring));
                                                {7879}let m1_6307: bitstring = dec(em1_6305,skSess_5973) in
                                                {7880}if (verify(h(m1_6307),sigM1_6306,pkCli_6246) <> true) then
                                                    0
                                                else
                                                    {7881}let (=OpenSecureChannelRequest,=pkCli_6246,Nc_6308: bitstring) = m1_6307 in
                                                    {7882}new Ns_6309: bitstring;
                                                    {7883}new ST_6310: bitstring;
                                                    {7884}new TTL_6311: bitstring;
                                                    {7885}let m2_6312: bitstring = (OpenSecureChannelResponse,Ns_6309,ST_6310,TTL_6311) in
                                                    {7886}event beginSrv(Sess_5025,Cli_5023,Ns_6309);
                                                    {7887}out(c, (enc(m2_6312,pkCli_6246),sign(h(m2_6312),skSess_5973)));
                                                    {7888}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                    {7889}event endSrv(Cli_5023,Sess_5025,Nc_6308)
                                )
                                else
                                    {7890}let pkCli_6313: bitstring = fail-any in
                                    {7891}let v_6314: bool = (Disco_5024 = A) in
                                    (
                                        {7892}if v_6314 then
                                        (
                                            {7893}let pkDisco_6315: bitstring = pub(skA) in
                                            {7894}in(c, (=pkCli_6313,em1_6316: bitstring,sigM1_6317: bitstring));
                                            {7895}let m1_6318: bitstring = dec(em1_6316,skSess_5973) in
                                            {7896}if (verify(h(m1_6318),sigM1_6317,pkCli_6313) <> true) then
                                                0
                                            else
                                                {7897}let (=OpenSecureChannelRequest,=pkCli_6313,Nc_6319: bitstring) = m1_6318 in
                                                {7898}new Ns_6320: bitstring;
                                                {7899}new ST_6321: bitstring;
                                                {7900}new TTL_6322: bitstring;
                                                {7901}let m2_6323: bitstring = (OpenSecureChannelResponse,Ns_6320,ST_6321,TTL_6322) in
                                                {7902}event beginSrv(Sess_5025,Cli_5023,Ns_6320);
                                                {7903}out(c, (enc(m2_6323,pkCli_6313),sign(h(m2_6323),skSess_5973)));
                                                {7904}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                {7905}event endSrv(Cli_5023,Sess_5025,Nc_6319)
                                        )
                                        else
                                            {7906}let v_6324: bool = (Disco_5024 = B) in
                                            (
                                                {7907}if v_6324 then
                                                (
                                                    {7908}let pkDisco_6325: bitstring = pub(skB) in
                                                    {7909}in(c, (=pkCli_6313,em1_6326: bitstring,sigM1_6327: bitstring));
                                                    {7910}let m1_6328: bitstring = dec(em1_6326,skSess_5973) in
                                                    {7911}if (verify(h(m1_6328),sigM1_6327,pkCli_6313) <> true) then
                                                        0
                                                    else
                                                        {7912}let (=OpenSecureChannelRequest,=pkCli_6313,Nc_6329: bitstring) = m1_6328 in
                                                        {7913}new Ns_6330: bitstring;
                                                        {7914}new ST_6331: bitstring;
                                                        {7915}new TTL_6332: bitstring;
                                                        {7916}let m2_6333: bitstring = (OpenSecureChannelResponse,Ns_6330,ST_6331,TTL_6332) in
                                                        {7917}event beginSrv(Sess_5025,Cli_5023,Ns_6330);
                                                        {7918}out(c, (enc(m2_6333,pkCli_6313),sign(h(m2_6333),skSess_5973)));
                                                        {7919}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                        {7920}event endSrv(Cli_5023,Sess_5025,Nc_6329)
                                                )
                                                else
                                                    {7921}let v_6334: bool = (Disco_5024 = C) in
                                                    (
                                                        {7922}if v_6334 then
                                                        (
                                                            {7923}let pkDisco_6335: bitstring = pub(skC) in
                                                            {7924}in(c, (=pkCli_6313,em1_6336: bitstring,sigM1_6337: bitstring));
                                                            {7925}let m1_6338: bitstring = dec(em1_6336,skSess_5973) in
                                                            {7926}if (verify(h(m1_6338),sigM1_6337,pkCli_6313) <> true) then
                                                                0
                                                            else
                                                                {7927}let (=OpenSecureChannelRequest,=pkCli_6313,Nc_6339: bitstring) = m1_6338 in
                                                                {7928}new Ns_6340: bitstring;
                                                                {7929}new ST_6341: bitstring;
                                                                {7930}new TTL_6342: bitstring;
                                                                {7931}let m2_6343: bitstring = (OpenSecureChannelResponse,Ns_6340,ST_6341,TTL_6342) in
                                                                {7932}event beginSrv(Sess_5025,Cli_5023,Ns_6340);
                                                                {7933}out(c, (enc(m2_6343,pkCli_6313),sign(h(m2_6343),skSess_5973)));
                                                                {7934}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                                {7935}event endSrv(Cli_5023,Sess_5025,Nc_6339)
                                                        )
                                                        else
                                                            {7936}let pkDisco_6344: bitstring = pub(sk(Disco_5024)) in
                                                            {7937}in(c, (=pkCli_6313,em1_6345: bitstring,sigM1_6346: bitstring));
                                                            {7938}let m1_6347: bitstring = dec(em1_6345,skSess_5973) in
                                                            {7939}if (verify(h(m1_6347),sigM1_6346,pkCli_6313) <> true) then
                                                                0
                                                            else
                                                                {7940}let (=OpenSecureChannelRequest,=pkCli_6313,Nc_6348: bitstring) = m1_6347 in
                                                                {7941}new Ns_6349: bitstring;
                                                                {7942}new ST_6350: bitstring;
                                                                {7943}new TTL_6351: bitstring;
                                                                {7944}let m2_6352: bitstring = (OpenSecureChannelResponse,Ns_6349,ST_6350,TTL_6351) in
                                                                {7945}event beginSrv(Sess_5025,Cli_5023,Ns_6349);
                                                                {7946}out(c, (enc(m2_6352,pkCli_6313),sign(h(m2_6352),skSess_5973)));
                                                                {7947}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                                {7948}event endSrv(Cli_5023,Sess_5025,Nc_6348)
                                                    )
                                                    else
                                                        {7949}let pkDisco_6353: bitstring = fail-any in
                                                        {7950}in(c, (=pkCli_6313,em1_6354: bitstring,sigM1_6355: bitstring));
                                                        {7951}let m1_6356: bitstring = dec(em1_6354,skSess_5973) in
                                                        {7952}if (verify(h(m1_6356),sigM1_6355,pkCli_6313) <> true) then
                                                            0
                                                        else
                                                            {7953}let (=OpenSecureChannelRequest,=pkCli_6313,Nc_6357: bitstring) = m1_6356 in
                                                            {7954}new Ns_6358: bitstring;
                                                            {7955}new ST_6359: bitstring;
                                                            {7956}new TTL_6360: bitstring;
                                                            {7957}let m2_6361: bitstring = (OpenSecureChannelResponse,Ns_6358,ST_6359,TTL_6360) in
                                                            {7958}event beginSrv(Sess_5025,Cli_5023,Ns_6358);
                                                            {7959}out(c, (enc(m2_6361,pkCli_6313),sign(h(m2_6361),skSess_5973)));
                                                            {7960}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                            {7961}event endSrv(Cli_5023,Sess_5025,Nc_6357)
                                            )
                                            else
                                                {7962}let pkDisco_6362: bitstring = fail-any in
                                                {7963}in(c, (=pkCli_6313,em1_6363: bitstring,sigM1_6364: bitstring));
                                                {7964}let m1_6365: bitstring = dec(em1_6363,skSess_5973) in
                                                {7965}if (verify(h(m1_6365),sigM1_6364,pkCli_6313) <> true) then
                                                    0
                                                else
                                                    {7966}let (=OpenSecureChannelRequest,=pkCli_6313,Nc_6366: bitstring) = m1_6365 in
                                                    {7967}new Ns_6367: bitstring;
                                                    {7968}new ST_6368: bitstring;
                                                    {7969}new TTL_6369: bitstring;
                                                    {7970}let m2_6370: bitstring = (OpenSecureChannelResponse,Ns_6367,ST_6368,TTL_6369) in
                                                    {7971}event beginSrv(Sess_5025,Cli_5023,Ns_6367);
                                                    {7972}out(c, (enc(m2_6370,pkCli_6313),sign(h(m2_6370),skSess_5973)));
                                                    {7973}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                    {7974}event endSrv(Cli_5023,Sess_5025,Nc_6366)
                                    )
                                    else
                                        {7975}let pkDisco_6371: bitstring = fail-any in
                                        {7976}in(c, (=pkCli_6313,em1_6372: bitstring,sigM1_6373: bitstring));
                                        {7977}let m1_6374: bitstring = dec(em1_6372,skSess_5973) in
                                        {7978}if (verify(h(m1_6374),sigM1_6373,pkCli_6313) <> true) then
                                            0
                                        else
                                            {7979}let (=OpenSecureChannelRequest,=pkCli_6313,Nc_6375: bitstring) = m1_6374 in
                                            {7980}new Ns_6376: bitstring;
                                            {7981}new ST_6377: bitstring;
                                            {7982}new TTL_6378: bitstring;
                                            {7983}let m2_6379: bitstring = (OpenSecureChannelResponse,Ns_6376,ST_6377,TTL_6378) in
                                            {7984}event beginSrv(Sess_5025,Cli_5023,Ns_6376);
                                            {7985}out(c, (enc(m2_6379,pkCli_6313),sign(h(m2_6379),skSess_5973)));
                                            {7986}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                            {7987}event endSrv(Cli_5023,Sess_5025,Nc_6375)
                        )
                        else
                            {7988}let pkCli_6380: bitstring = fail-any in
                            {7989}let v_6381: bool = (Disco_5024 = A) in
                            (
                                {7990}if v_6381 then
                                (
                                    {7991}let pkDisco_6382: bitstring = pub(skA) in
                                    {7992}in(c, (=pkCli_6380,em1_6383: bitstring,sigM1_6384: bitstring));
                                    {7993}let m1_6385: bitstring = dec(em1_6383,skSess_5973) in
                                    {7994}if (verify(h(m1_6385),sigM1_6384,pkCli_6380) <> true) then
                                        0
                                    else
                                        {7995}let (=OpenSecureChannelRequest,=pkCli_6380,Nc_6386: bitstring) = m1_6385 in
                                        {7996}new Ns_6387: bitstring;
                                        {7997}new ST_6388: bitstring;
                                        {7998}new TTL_6389: bitstring;
                                        {7999}let m2_6390: bitstring = (OpenSecureChannelResponse,Ns_6387,ST_6388,TTL_6389) in
                                        {8000}event beginSrv(Sess_5025,Cli_5023,Ns_6387);
                                        {8001}out(c, (enc(m2_6390,pkCli_6380),sign(h(m2_6390),skSess_5973)));
                                        {8002}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                        {8003}event endSrv(Cli_5023,Sess_5025,Nc_6386)
                                )
                                else
                                    {8004}let v_6391: bool = (Disco_5024 = B) in
                                    (
                                        {8005}if v_6391 then
                                        (
                                            {8006}let pkDisco_6392: bitstring = pub(skB) in
                                            {8007}in(c, (=pkCli_6380,em1_6393: bitstring,sigM1_6394: bitstring));
                                            {8008}let m1_6395: bitstring = dec(em1_6393,skSess_5973) in
                                            {8009}if (verify(h(m1_6395),sigM1_6394,pkCli_6380) <> true) then
                                                0
                                            else
                                                {8010}let (=OpenSecureChannelRequest,=pkCli_6380,Nc_6396: bitstring) = m1_6395 in
                                                {8011}new Ns_6397: bitstring;
                                                {8012}new ST_6398: bitstring;
                                                {8013}new TTL_6399: bitstring;
                                                {8014}let m2_6400: bitstring = (OpenSecureChannelResponse,Ns_6397,ST_6398,TTL_6399) in
                                                {8015}event beginSrv(Sess_5025,Cli_5023,Ns_6397);
                                                {8016}out(c, (enc(m2_6400,pkCli_6380),sign(h(m2_6400),skSess_5973)));
                                                {8017}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                {8018}event endSrv(Cli_5023,Sess_5025,Nc_6396)
                                        )
                                        else
                                            {8019}let v_6401: bool = (Disco_5024 = C) in
                                            (
                                                {8020}if v_6401 then
                                                (
                                                    {8021}let pkDisco_6402: bitstring = pub(skC) in
                                                    {8022}in(c, (=pkCli_6380,em1_6403: bitstring,sigM1_6404: bitstring));
                                                    {8023}let m1_6405: bitstring = dec(em1_6403,skSess_5973) in
                                                    {8024}if (verify(h(m1_6405),sigM1_6404,pkCli_6380) <> true) then
                                                        0
                                                    else
                                                        {8025}let (=OpenSecureChannelRequest,=pkCli_6380,Nc_6406: bitstring) = m1_6405 in
                                                        {8026}new Ns_6407: bitstring;
                                                        {8027}new ST_6408: bitstring;
                                                        {8028}new TTL_6409: bitstring;
                                                        {8029}let m2_6410: bitstring = (OpenSecureChannelResponse,Ns_6407,ST_6408,TTL_6409) in
                                                        {8030}event beginSrv(Sess_5025,Cli_5023,Ns_6407);
                                                        {8031}out(c, (enc(m2_6410,pkCli_6380),sign(h(m2_6410),skSess_5973)));
                                                        {8032}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                        {8033}event endSrv(Cli_5023,Sess_5025,Nc_6406)
                                                )
                                                else
                                                    {8034}let pkDisco_6411: bitstring = pub(sk(Disco_5024)) in
                                                    {8035}in(c, (=pkCli_6380,em1_6412: bitstring,sigM1_6413: bitstring));
                                                    {8036}let m1_6414: bitstring = dec(em1_6412,skSess_5973) in
                                                    {8037}if (verify(h(m1_6414),sigM1_6413,pkCli_6380) <> true) then
                                                        0
                                                    else
                                                        {8038}let (=OpenSecureChannelRequest,=pkCli_6380,Nc_6415: bitstring) = m1_6414 in
                                                        {8039}new Ns_6416: bitstring;
                                                        {8040}new ST_6417: bitstring;
                                                        {8041}new TTL_6418: bitstring;
                                                        {8042}let m2_6419: bitstring = (OpenSecureChannelResponse,Ns_6416,ST_6417,TTL_6418) in
                                                        {8043}event beginSrv(Sess_5025,Cli_5023,Ns_6416);
                                                        {8044}out(c, (enc(m2_6419,pkCli_6380),sign(h(m2_6419),skSess_5973)));
                                                        {8045}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                        {8046}event endSrv(Cli_5023,Sess_5025,Nc_6415)
                                            )
                                            else
                                                {8047}let pkDisco_6420: bitstring = fail-any in
                                                {8048}in(c, (=pkCli_6380,em1_6421: bitstring,sigM1_6422: bitstring));
                                                {8049}let m1_6423: bitstring = dec(em1_6421,skSess_5973) in
                                                {8050}if (verify(h(m1_6423),sigM1_6422,pkCli_6380) <> true) then
                                                    0
                                                else
                                                    {8051}let (=OpenSecureChannelRequest,=pkCli_6380,Nc_6424: bitstring) = m1_6423 in
                                                    {8052}new Ns_6425: bitstring;
                                                    {8053}new ST_6426: bitstring;
                                                    {8054}new TTL_6427: bitstring;
                                                    {8055}let m2_6428: bitstring = (OpenSecureChannelResponse,Ns_6425,ST_6426,TTL_6427) in
                                                    {8056}event beginSrv(Sess_5025,Cli_5023,Ns_6425);
                                                    {8057}out(c, (enc(m2_6428,pkCli_6380),sign(h(m2_6428),skSess_5973)));
                                                    {8058}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                    {8059}event endSrv(Cli_5023,Sess_5025,Nc_6424)
                                    )
                                    else
                                        {8060}let pkDisco_6429: bitstring = fail-any in
                                        {8061}in(c, (=pkCli_6380,em1_6430: bitstring,sigM1_6431: bitstring));
                                        {8062}let m1_6432: bitstring = dec(em1_6430,skSess_5973) in
                                        {8063}if (verify(h(m1_6432),sigM1_6431,pkCli_6380) <> true) then
                                            0
                                        else
                                            {8064}let (=OpenSecureChannelRequest,=pkCli_6380,Nc_6433: bitstring) = m1_6432 in
                                            {8065}new Ns_6434: bitstring;
                                            {8066}new ST_6435: bitstring;
                                            {8067}new TTL_6436: bitstring;
                                            {8068}let m2_6437: bitstring = (OpenSecureChannelResponse,Ns_6434,ST_6435,TTL_6436) in
                                            {8069}event beginSrv(Sess_5025,Cli_5023,Ns_6434);
                                            {8070}out(c, (enc(m2_6437,pkCli_6380),sign(h(m2_6437),skSess_5973)));
                                            {8071}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                            {8072}event endSrv(Cli_5023,Sess_5025,Nc_6433)
                            )
                            else
                                {8073}let pkDisco_6438: bitstring = fail-any in
                                {8074}in(c, (=pkCli_6380,em1_6439: bitstring,sigM1_6440: bitstring));
                                {8075}let m1_6441: bitstring = dec(em1_6439,skSess_5973) in
                                {8076}if (verify(h(m1_6441),sigM1_6440,pkCli_6380) <> true) then
                                    0
                                else
                                    {8077}let (=OpenSecureChannelRequest,=pkCli_6380,Nc_6442: bitstring) = m1_6441 in
                                    {8078}new Ns_6443: bitstring;
                                    {8079}new ST_6444: bitstring;
                                    {8080}new TTL_6445: bitstring;
                                    {8081}let m2_6446: bitstring = (OpenSecureChannelResponse,Ns_6443,ST_6444,TTL_6445) in
                                    {8082}event beginSrv(Sess_5025,Cli_5023,Ns_6443);
                                    {8083}out(c, (enc(m2_6446,pkCli_6380),sign(h(m2_6446),skSess_5973)));
                                    {8084}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                    {8085}event endSrv(Cli_5023,Sess_5025,Nc_6442)
                    )
                    else
                        {8086}let skSess_6447: bitstring = fail-any in
                        {8087}let pkSess_6448: bitstring = pub(skSess_6447) in
                        {8088}let v_6449: bool = (Cli_5023 = A) in
                        (
                            {8089}if v_6449 then
                            (
                                {8090}let pkCli_6450: bitstring = pub(skA) in
                                {8091}let v_6451: bool = (Disco_5024 = A) in
                                (
                                    {8092}if v_6451 then
                                    (
                                        {8093}let pkDisco_6452: bitstring = pub(skA) in
                                        {8094}in(c, (=pkCli_6450,em1_6453: bitstring,sigM1_6454: bitstring));
                                        {8095}let m1_6455: bitstring = dec(em1_6453,skSess_6447) in
                                        {8096}if (verify(h(m1_6455),sigM1_6454,pkCli_6450) <> true) then
                                            0
                                        else
                                            {8097}let (=OpenSecureChannelRequest,=pkCli_6450,Nc_6456: bitstring) = m1_6455 in
                                            {8098}new Ns_6457: bitstring;
                                            {8099}new ST_6458: bitstring;
                                            {8100}new TTL_6459: bitstring;
                                            {8101}let m2_6460: bitstring = (OpenSecureChannelResponse,Ns_6457,ST_6458,TTL_6459) in
                                            {8102}event beginSrv(Sess_5025,Cli_5023,Ns_6457);
                                            {8103}out(c, (enc(m2_6460,pkCli_6450),sign(h(m2_6460),skSess_6447)));
                                            {8104}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                            {8105}event endSrv(Cli_5023,Sess_5025,Nc_6456)
                                    )
                                    else
                                        {8106}let v_6461: bool = (Disco_5024 = B) in
                                        (
                                            {8107}if v_6461 then
                                            (
                                                {8108}let pkDisco_6462: bitstring = pub(skB) in
                                                {8109}in(c, (=pkCli_6450,em1_6463: bitstring,sigM1_6464: bitstring));
                                                {8110}let m1_6465: bitstring = dec(em1_6463,skSess_6447) in
                                                {8111}if (verify(h(m1_6465),sigM1_6464,pkCli_6450) <> true) then
                                                    0
                                                else
                                                    {8112}let (=OpenSecureChannelRequest,=pkCli_6450,Nc_6466: bitstring) = m1_6465 in
                                                    {8113}new Ns_6467: bitstring;
                                                    {8114}new ST_6468: bitstring;
                                                    {8115}new TTL_6469: bitstring;
                                                    {8116}let m2_6470: bitstring = (OpenSecureChannelResponse,Ns_6467,ST_6468,TTL_6469) in
                                                    {8117}event beginSrv(Sess_5025,Cli_5023,Ns_6467);
                                                    {8118}out(c, (enc(m2_6470,pkCli_6450),sign(h(m2_6470),skSess_6447)));
                                                    {8119}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                    {8120}event endSrv(Cli_5023,Sess_5025,Nc_6466)
                                            )
                                            else
                                                {8121}let v_6471: bool = (Disco_5024 = C) in
                                                (
                                                    {8122}if v_6471 then
                                                    (
                                                        {8123}let pkDisco_6472: bitstring = pub(skC) in
                                                        {8124}in(c, (=pkCli_6450,em1_6473: bitstring,sigM1_6474: bitstring));
                                                        {8125}let m1_6475: bitstring = dec(em1_6473,skSess_6447) in
                                                        {8126}if (verify(h(m1_6475),sigM1_6474,pkCli_6450) <> true) then
                                                            0
                                                        else
                                                            {8127}let (=OpenSecureChannelRequest,=pkCli_6450,Nc_6476: bitstring) = m1_6475 in
                                                            {8128}new Ns_6477: bitstring;
                                                            {8129}new ST_6478: bitstring;
                                                            {8130}new TTL_6479: bitstring;
                                                            {8131}let m2_6480: bitstring = (OpenSecureChannelResponse,Ns_6477,ST_6478,TTL_6479) in
                                                            {8132}event beginSrv(Sess_5025,Cli_5023,Ns_6477);
                                                            {8133}out(c, (enc(m2_6480,pkCli_6450),sign(h(m2_6480),skSess_6447)));
                                                            {8134}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                            {8135}event endSrv(Cli_5023,Sess_5025,Nc_6476)
                                                    )
                                                    else
                                                        {8136}let pkDisco_6481: bitstring = pub(sk(Disco_5024)) in
                                                        {8137}in(c, (=pkCli_6450,em1_6482: bitstring,sigM1_6483: bitstring));
                                                        {8138}let m1_6484: bitstring = dec(em1_6482,skSess_6447) in
                                                        {8139}if (verify(h(m1_6484),sigM1_6483,pkCli_6450) <> true) then
                                                            0
                                                        else
                                                            {8140}let (=OpenSecureChannelRequest,=pkCli_6450,Nc_6485: bitstring) = m1_6484 in
                                                            {8141}new Ns_6486: bitstring;
                                                            {8142}new ST_6487: bitstring;
                                                            {8143}new TTL_6488: bitstring;
                                                            {8144}let m2_6489: bitstring = (OpenSecureChannelResponse,Ns_6486,ST_6487,TTL_6488) in
                                                            {8145}event beginSrv(Sess_5025,Cli_5023,Ns_6486);
                                                            {8146}out(c, (enc(m2_6489,pkCli_6450),sign(h(m2_6489),skSess_6447)));
                                                            {8147}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                            {8148}event endSrv(Cli_5023,Sess_5025,Nc_6485)
                                                )
                                                else
                                                    {8149}let pkDisco_6490: bitstring = fail-any in
                                                    {8150}in(c, (=pkCli_6450,em1_6491: bitstring,sigM1_6492: bitstring));
                                                    {8151}let m1_6493: bitstring = dec(em1_6491,skSess_6447) in
                                                    {8152}if (verify(h(m1_6493),sigM1_6492,pkCli_6450) <> true) then
                                                        0
                                                    else
                                                        {8153}let (=OpenSecureChannelRequest,=pkCli_6450,Nc_6494: bitstring) = m1_6493 in
                                                        {8154}new Ns_6495: bitstring;
                                                        {8155}new ST_6496: bitstring;
                                                        {8156}new TTL_6497: bitstring;
                                                        {8157}let m2_6498: bitstring = (OpenSecureChannelResponse,Ns_6495,ST_6496,TTL_6497) in
                                                        {8158}event beginSrv(Sess_5025,Cli_5023,Ns_6495);
                                                        {8159}out(c, (enc(m2_6498,pkCli_6450),sign(h(m2_6498),skSess_6447)));
                                                        {8160}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                        {8161}event endSrv(Cli_5023,Sess_5025,Nc_6494)
                                        )
                                        else
                                            {8162}let pkDisco_6499: bitstring = fail-any in
                                            {8163}in(c, (=pkCli_6450,em1_6500: bitstring,sigM1_6501: bitstring));
                                            {8164}let m1_6502: bitstring = dec(em1_6500,skSess_6447) in
                                            {8165}if (verify(h(m1_6502),sigM1_6501,pkCli_6450) <> true) then
                                                0
                                            else
                                                {8166}let (=OpenSecureChannelRequest,=pkCli_6450,Nc_6503: bitstring) = m1_6502 in
                                                {8167}new Ns_6504: bitstring;
                                                {8168}new ST_6505: bitstring;
                                                {8169}new TTL_6506: bitstring;
                                                {8170}let m2_6507: bitstring = (OpenSecureChannelResponse,Ns_6504,ST_6505,TTL_6506) in
                                                {8171}event beginSrv(Sess_5025,Cli_5023,Ns_6504);
                                                {8172}out(c, (enc(m2_6507,pkCli_6450),sign(h(m2_6507),skSess_6447)));
                                                {8173}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                {8174}event endSrv(Cli_5023,Sess_5025,Nc_6503)
                                )
                                else
                                    {8175}let pkDisco_6508: bitstring = fail-any in
                                    {8176}in(c, (=pkCli_6450,em1_6509: bitstring,sigM1_6510: bitstring));
                                    {8177}let m1_6511: bitstring = dec(em1_6509,skSess_6447) in
                                    {8178}if (verify(h(m1_6511),sigM1_6510,pkCli_6450) <> true) then
                                        0
                                    else
                                        {8179}let (=OpenSecureChannelRequest,=pkCli_6450,Nc_6512: bitstring) = m1_6511 in
                                        {8180}new Ns_6513: bitstring;
                                        {8181}new ST_6514: bitstring;
                                        {8182}new TTL_6515: bitstring;
                                        {8183}let m2_6516: bitstring = (OpenSecureChannelResponse,Ns_6513,ST_6514,TTL_6515) in
                                        {8184}event beginSrv(Sess_5025,Cli_5023,Ns_6513);
                                        {8185}out(c, (enc(m2_6516,pkCli_6450),sign(h(m2_6516),skSess_6447)));
                                        {8186}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                        {8187}event endSrv(Cli_5023,Sess_5025,Nc_6512)
                            )
                            else
                                {8188}let v_6517: bool = (Cli_5023 = B) in
                                (
                                    {8189}if v_6517 then
                                    (
                                        {8190}let pkCli_6518: bitstring = pub(skB) in
                                        {8191}let v_6519: bool = (Disco_5024 = A) in
                                        (
                                            {8192}if v_6519 then
                                            (
                                                {8193}let pkDisco_6520: bitstring = pub(skA) in
                                                {8194}in(c, (=pkCli_6518,em1_6521: bitstring,sigM1_6522: bitstring));
                                                {8195}let m1_6523: bitstring = dec(em1_6521,skSess_6447) in
                                                {8196}if (verify(h(m1_6523),sigM1_6522,pkCli_6518) <> true) then
                                                    0
                                                else
                                                    {8197}let (=OpenSecureChannelRequest,=pkCli_6518,Nc_6524: bitstring) = m1_6523 in
                                                    {8198}new Ns_6525: bitstring;
                                                    {8199}new ST_6526: bitstring;
                                                    {8200}new TTL_6527: bitstring;
                                                    {8201}let m2_6528: bitstring = (OpenSecureChannelResponse,Ns_6525,ST_6526,TTL_6527) in
                                                    {8202}event beginSrv(Sess_5025,Cli_5023,Ns_6525);
                                                    {8203}out(c, (enc(m2_6528,pkCli_6518),sign(h(m2_6528),skSess_6447)));
                                                    {8204}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                    {8205}event endSrv(Cli_5023,Sess_5025,Nc_6524)
                                            )
                                            else
                                                {8206}let v_6529: bool = (Disco_5024 = B) in
                                                (
                                                    {8207}if v_6529 then
                                                    (
                                                        {8208}let pkDisco_6530: bitstring = pub(skB) in
                                                        {8209}in(c, (=pkCli_6518,em1_6531: bitstring,sigM1_6532: bitstring));
                                                        {8210}let m1_6533: bitstring = dec(em1_6531,skSess_6447) in
                                                        {8211}if (verify(h(m1_6533),sigM1_6532,pkCli_6518) <> true) then
                                                            0
                                                        else
                                                            {8212}let (=OpenSecureChannelRequest,=pkCli_6518,Nc_6534: bitstring) = m1_6533 in
                                                            {8213}new Ns_6535: bitstring;
                                                            {8214}new ST_6536: bitstring;
                                                            {8215}new TTL_6537: bitstring;
                                                            {8216}let m2_6538: bitstring = (OpenSecureChannelResponse,Ns_6535,ST_6536,TTL_6537) in
                                                            {8217}event beginSrv(Sess_5025,Cli_5023,Ns_6535);
                                                            {8218}out(c, (enc(m2_6538,pkCli_6518),sign(h(m2_6538),skSess_6447)));
                                                            {8219}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                            {8220}event endSrv(Cli_5023,Sess_5025,Nc_6534)
                                                    )
                                                    else
                                                        {8221}let v_6539: bool = (Disco_5024 = C) in
                                                        (
                                                            {8222}if v_6539 then
                                                            (
                                                                {8223}let pkDisco_6540: bitstring = pub(skC) in
                                                                {8224}in(c, (=pkCli_6518,em1_6541: bitstring,sigM1_6542: bitstring));
                                                                {8225}let m1_6543: bitstring = dec(em1_6541,skSess_6447) in
                                                                {8226}if (verify(h(m1_6543),sigM1_6542,pkCli_6518) <> true) then
                                                                    0
                                                                else
                                                                    {8227}let (=OpenSecureChannelRequest,=pkCli_6518,Nc_6544: bitstring) = m1_6543 in
                                                                    {8228}new Ns_6545: bitstring;
                                                                    {8229}new ST_6546: bitstring;
                                                                    {8230}new TTL_6547: bitstring;
                                                                    {8231}let m2_6548: bitstring = (OpenSecureChannelResponse,Ns_6545,ST_6546,TTL_6547) in
                                                                    {8232}event beginSrv(Sess_5025,Cli_5023,Ns_6545);
                                                                    {8233}out(c, (enc(m2_6548,pkCli_6518),sign(h(m2_6548),skSess_6447)));
                                                                    {8234}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                                    {8235}event endSrv(Cli_5023,Sess_5025,Nc_6544)
                                                            )
                                                            else
                                                                {8236}let pkDisco_6549: bitstring = pub(sk(Disco_5024)) in
                                                                {8237}in(c, (=pkCli_6518,em1_6550: bitstring,sigM1_6551: bitstring));
                                                                {8238}let m1_6552: bitstring = dec(em1_6550,skSess_6447) in
                                                                {8239}if (verify(h(m1_6552),sigM1_6551,pkCli_6518) <> true) then
                                                                    0
                                                                else
                                                                    {8240}let (=OpenSecureChannelRequest,=pkCli_6518,Nc_6553: bitstring) = m1_6552 in
                                                                    {8241}new Ns_6554: bitstring;
                                                                    {8242}new ST_6555: bitstring;
                                                                    {8243}new TTL_6556: bitstring;
                                                                    {8244}let m2_6557: bitstring = (OpenSecureChannelResponse,Ns_6554,ST_6555,TTL_6556) in
                                                                    {8245}event beginSrv(Sess_5025,Cli_5023,Ns_6554);
                                                                    {8246}out(c, (enc(m2_6557,pkCli_6518),sign(h(m2_6557),skSess_6447)));
                                                                    {8247}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                                    {8248}event endSrv(Cli_5023,Sess_5025,Nc_6553)
                                                        )
                                                        else
                                                            {8249}let pkDisco_6558: bitstring = fail-any in
                                                            {8250}in(c, (=pkCli_6518,em1_6559: bitstring,sigM1_6560: bitstring));
                                                            {8251}let m1_6561: bitstring = dec(em1_6559,skSess_6447) in
                                                            {8252}if (verify(h(m1_6561),sigM1_6560,pkCli_6518) <> true) then
                                                                0
                                                            else
                                                                {8253}let (=OpenSecureChannelRequest,=pkCli_6518,Nc_6562: bitstring) = m1_6561 in
                                                                {8254}new Ns_6563: bitstring;
                                                                {8255}new ST_6564: bitstring;
                                                                {8256}new TTL_6565: bitstring;
                                                                {8257}let m2_6566: bitstring = (OpenSecureChannelResponse,Ns_6563,ST_6564,TTL_6565) in
                                                                {8258}event beginSrv(Sess_5025,Cli_5023,Ns_6563);
                                                                {8259}out(c, (enc(m2_6566,pkCli_6518),sign(h(m2_6566),skSess_6447)));
                                                                {8260}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                                {8261}event endSrv(Cli_5023,Sess_5025,Nc_6562)
                                                )
                                                else
                                                    {8262}let pkDisco_6567: bitstring = fail-any in
                                                    {8263}in(c, (=pkCli_6518,em1_6568: bitstring,sigM1_6569: bitstring));
                                                    {8264}let m1_6570: bitstring = dec(em1_6568,skSess_6447) in
                                                    {8265}if (verify(h(m1_6570),sigM1_6569,pkCli_6518) <> true) then
                                                        0
                                                    else
                                                        {8266}let (=OpenSecureChannelRequest,=pkCli_6518,Nc_6571: bitstring) = m1_6570 in
                                                        {8267}new Ns_6572: bitstring;
                                                        {8268}new ST_6573: bitstring;
                                                        {8269}new TTL_6574: bitstring;
                                                        {8270}let m2_6575: bitstring = (OpenSecureChannelResponse,Ns_6572,ST_6573,TTL_6574) in
                                                        {8271}event beginSrv(Sess_5025,Cli_5023,Ns_6572);
                                                        {8272}out(c, (enc(m2_6575,pkCli_6518),sign(h(m2_6575),skSess_6447)));
                                                        {8273}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                        {8274}event endSrv(Cli_5023,Sess_5025,Nc_6571)
                                        )
                                        else
                                            {8275}let pkDisco_6576: bitstring = fail-any in
                                            {8276}in(c, (=pkCli_6518,em1_6577: bitstring,sigM1_6578: bitstring));
                                            {8277}let m1_6579: bitstring = dec(em1_6577,skSess_6447) in
                                            {8278}if (verify(h(m1_6579),sigM1_6578,pkCli_6518) <> true) then
                                                0
                                            else
                                                {8279}let (=OpenSecureChannelRequest,=pkCli_6518,Nc_6580: bitstring) = m1_6579 in
                                                {8280}new Ns_6581: bitstring;
                                                {8281}new ST_6582: bitstring;
                                                {8282}new TTL_6583: bitstring;
                                                {8283}let m2_6584: bitstring = (OpenSecureChannelResponse,Ns_6581,ST_6582,TTL_6583) in
                                                {8284}event beginSrv(Sess_5025,Cli_5023,Ns_6581);
                                                {8285}out(c, (enc(m2_6584,pkCli_6518),sign(h(m2_6584),skSess_6447)));
                                                {8286}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                {8287}event endSrv(Cli_5023,Sess_5025,Nc_6580)
                                    )
                                    else
                                        {8288}let v_6585: bool = (Cli_5023 = C) in
                                        (
                                            {8289}if v_6585 then
                                            (
                                                {8290}let pkCli_6586: bitstring = pub(skC) in
                                                {8291}let v_6587: bool = (Disco_5024 = A) in
                                                (
                                                    {8292}if v_6587 then
                                                    (
                                                        {8293}let pkDisco_6588: bitstring = pub(skA) in
                                                        {8294}in(c, (=pkCli_6586,em1_6589: bitstring,sigM1_6590: bitstring));
                                                        {8295}let m1_6591: bitstring = dec(em1_6589,skSess_6447) in
                                                        {8296}if (verify(h(m1_6591),sigM1_6590,pkCli_6586) <> true) then
                                                            0
                                                        else
                                                            {8297}let (=OpenSecureChannelRequest,=pkCli_6586,Nc_6592: bitstring) = m1_6591 in
                                                            {8298}new Ns_6593: bitstring;
                                                            {8299}new ST_6594: bitstring;
                                                            {8300}new TTL_6595: bitstring;
                                                            {8301}let m2_6596: bitstring = (OpenSecureChannelResponse,Ns_6593,ST_6594,TTL_6595) in
                                                            {8302}event beginSrv(Sess_5025,Cli_5023,Ns_6593);
                                                            {8303}out(c, (enc(m2_6596,pkCli_6586),sign(h(m2_6596),skSess_6447)));
                                                            {8304}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                            {8305}event endSrv(Cli_5023,Sess_5025,Nc_6592)
                                                    )
                                                    else
                                                        {8306}let v_6597: bool = (Disco_5024 = B) in
                                                        (
                                                            {8307}if v_6597 then
                                                            (
                                                                {8308}let pkDisco_6598: bitstring = pub(skB) in
                                                                {8309}in(c, (=pkCli_6586,em1_6599: bitstring,sigM1_6600: bitstring));
                                                                {8310}let m1_6601: bitstring = dec(em1_6599,skSess_6447) in
                                                                {8311}if (verify(h(m1_6601),sigM1_6600,pkCli_6586) <> true) then
                                                                    0
                                                                else
                                                                    {8312}let (=OpenSecureChannelRequest,=pkCli_6586,Nc_6602: bitstring) = m1_6601 in
                                                                    {8313}new Ns_6603: bitstring;
                                                                    {8314}new ST_6604: bitstring;
                                                                    {8315}new TTL_6605: bitstring;
                                                                    {8316}let m2_6606: bitstring = (OpenSecureChannelResponse,Ns_6603,ST_6604,TTL_6605) in
                                                                    {8317}event beginSrv(Sess_5025,Cli_5023,Ns_6603);
                                                                    {8318}out(c, (enc(m2_6606,pkCli_6586),sign(h(m2_6606),skSess_6447)));
                                                                    {8319}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                                    {8320}event endSrv(Cli_5023,Sess_5025,Nc_6602)
                                                            )
                                                            else
                                                                {8321}let v_6607: bool = (Disco_5024 = C) in
                                                                (
                                                                    {8322}if v_6607 then
                                                                    (
                                                                        {8323}let pkDisco_6608: bitstring = pub(skC) in
                                                                        {8324}in(c, (=pkCli_6586,em1_6609: bitstring,sigM1_6610: bitstring));
                                                                        {8325}let m1_6611: bitstring = dec(em1_6609,skSess_6447) in
                                                                        {8326}if (verify(h(m1_6611),sigM1_6610,pkCli_6586) <> true) then
                                                                            0
                                                                        else
                                                                            {8327}let (=OpenSecureChannelRequest,=pkCli_6586,Nc_6612: bitstring) = m1_6611 in
                                                                            {8328}new Ns_6613: bitstring;
                                                                            {8329}new ST_6614: bitstring;
                                                                            {8330}new TTL_6615: bitstring;
                                                                            {8331}let m2_6616: bitstring = (OpenSecureChannelResponse,Ns_6613,ST_6614,TTL_6615) in
                                                                            {8332}event beginSrv(Sess_5025,Cli_5023,Ns_6613);
                                                                            {8333}out(c, (enc(m2_6616,pkCli_6586),sign(h(m2_6616),skSess_6447)));
                                                                            {8334}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                                            {8335}event endSrv(Cli_5023,Sess_5025,Nc_6612)
                                                                    )
                                                                    else
                                                                        {8336}let pkDisco_6617: bitstring = pub(sk(Disco_5024)) in
                                                                        {8337}in(c, (=pkCli_6586,em1_6618: bitstring,sigM1_6619: bitstring));
                                                                        {8338}let m1_6620: bitstring = dec(em1_6618,skSess_6447) in
                                                                        {8339}if (verify(h(m1_6620),sigM1_6619,pkCli_6586) <> true) then
                                                                            0
                                                                        else
                                                                            {8340}let (=OpenSecureChannelRequest,=pkCli_6586,Nc_6621: bitstring) = m1_6620 in
                                                                            {8341}new Ns_6622: bitstring;
                                                                            {8342}new ST_6623: bitstring;
                                                                            {8343}new TTL_6624: bitstring;
                                                                            {8344}let m2_6625: bitstring = (OpenSecureChannelResponse,Ns_6622,ST_6623,TTL_6624) in
                                                                            {8345}event beginSrv(Sess_5025,Cli_5023,Ns_6622);
                                                                            {8346}out(c, (enc(m2_6625,pkCli_6586),sign(h(m2_6625),skSess_6447)));
                                                                            {8347}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                                            {8348}event endSrv(Cli_5023,Sess_5025,Nc_6621)
                                                                )
                                                                else
                                                                    {8349}let pkDisco_6626: bitstring = fail-any in
                                                                    {8350}in(c, (=pkCli_6586,em1_6627: bitstring,sigM1_6628: bitstring));
                                                                    {8351}let m1_6629: bitstring = dec(em1_6627,skSess_6447) in
                                                                    {8352}if (verify(h(m1_6629),sigM1_6628,pkCli_6586) <> true) then
                                                                        0
                                                                    else
                                                                        {8353}let (=OpenSecureChannelRequest,=pkCli_6586,Nc_6630: bitstring) = m1_6629 in
                                                                        {8354}new Ns_6631: bitstring;
                                                                        {8355}new ST_6632: bitstring;
                                                                        {8356}new TTL_6633: bitstring;
                                                                        {8357}let m2_6634: bitstring = (OpenSecureChannelResponse,Ns_6631,ST_6632,TTL_6633) in
                                                                        {8358}event beginSrv(Sess_5025,Cli_5023,Ns_6631);
                                                                        {8359}out(c, (enc(m2_6634,pkCli_6586),sign(h(m2_6634),skSess_6447)));
                                                                        {8360}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                                        {8361}event endSrv(Cli_5023,Sess_5025,Nc_6630)
                                                        )
                                                        else
                                                            {8362}let pkDisco_6635: bitstring = fail-any in
                                                            {8363}in(c, (=pkCli_6586,em1_6636: bitstring,sigM1_6637: bitstring));
                                                            {8364}let m1_6638: bitstring = dec(em1_6636,skSess_6447) in
                                                            {8365}if (verify(h(m1_6638),sigM1_6637,pkCli_6586) <> true) then
                                                                0
                                                            else
                                                                {8366}let (=OpenSecureChannelRequest,=pkCli_6586,Nc_6639: bitstring) = m1_6638 in
                                                                {8367}new Ns_6640: bitstring;
                                                                {8368}new ST_6641: bitstring;
                                                                {8369}new TTL_6642: bitstring;
                                                                {8370}let m2_6643: bitstring = (OpenSecureChannelResponse,Ns_6640,ST_6641,TTL_6642) in
                                                                {8371}event beginSrv(Sess_5025,Cli_5023,Ns_6640);
                                                                {8372}out(c, (enc(m2_6643,pkCli_6586),sign(h(m2_6643),skSess_6447)));
                                                                {8373}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                                {8374}event endSrv(Cli_5023,Sess_5025,Nc_6639)
                                                )
                                                else
                                                    {8375}let pkDisco_6644: bitstring = fail-any in
                                                    {8376}in(c, (=pkCli_6586,em1_6645: bitstring,sigM1_6646: bitstring));
                                                    {8377}let m1_6647: bitstring = dec(em1_6645,skSess_6447) in
                                                    {8378}if (verify(h(m1_6647),sigM1_6646,pkCli_6586) <> true) then
                                                        0
                                                    else
                                                        {8379}let (=OpenSecureChannelRequest,=pkCli_6586,Nc_6648: bitstring) = m1_6647 in
                                                        {8380}new Ns_6649: bitstring;
                                                        {8381}new ST_6650: bitstring;
                                                        {8382}new TTL_6651: bitstring;
                                                        {8383}let m2_6652: bitstring = (OpenSecureChannelResponse,Ns_6649,ST_6650,TTL_6651) in
                                                        {8384}event beginSrv(Sess_5025,Cli_5023,Ns_6649);
                                                        {8385}out(c, (enc(m2_6652,pkCli_6586),sign(h(m2_6652),skSess_6447)));
                                                        {8386}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                        {8387}event endSrv(Cli_5023,Sess_5025,Nc_6648)
                                            )
                                            else
                                                {8388}let pkCli_6653: bitstring = pub(sk(Cli_5023)) in
                                                {8389}let v_6654: bool = (Disco_5024 = A) in
                                                (
                                                    {8390}if v_6654 then
                                                    (
                                                        {8391}let pkDisco_6655: bitstring = pub(skA) in
                                                        {8392}in(c, (=pkCli_6653,em1_6656: bitstring,sigM1_6657: bitstring));
                                                        {8393}let m1_6658: bitstring = dec(em1_6656,skSess_6447) in
                                                        {8394}if (verify(h(m1_6658),sigM1_6657,pkCli_6653) <> true) then
                                                            0
                                                        else
                                                            {8395}let (=OpenSecureChannelRequest,=pkCli_6653,Nc_6659: bitstring) = m1_6658 in
                                                            {8396}new Ns_6660: bitstring;
                                                            {8397}new ST_6661: bitstring;
                                                            {8398}new TTL_6662: bitstring;
                                                            {8399}let m2_6663: bitstring = (OpenSecureChannelResponse,Ns_6660,ST_6661,TTL_6662) in
                                                            {8400}event beginSrv(Sess_5025,Cli_5023,Ns_6660);
                                                            {8401}out(c, (enc(m2_6663,pkCli_6653),sign(h(m2_6663),skSess_6447)));
                                                            {8402}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                            {8403}event endSrv(Cli_5023,Sess_5025,Nc_6659)
                                                    )
                                                    else
                                                        {8404}let v_6664: bool = (Disco_5024 = B) in
                                                        (
                                                            {8405}if v_6664 then
                                                            (
                                                                {8406}let pkDisco_6665: bitstring = pub(skB) in
                                                                {8407}in(c, (=pkCli_6653,em1_6666: bitstring,sigM1_6667: bitstring));
                                                                {8408}let m1_6668: bitstring = dec(em1_6666,skSess_6447) in
                                                                {8409}if (verify(h(m1_6668),sigM1_6667,pkCli_6653) <> true) then
                                                                    0
                                                                else
                                                                    {8410}let (=OpenSecureChannelRequest,=pkCli_6653,Nc_6669: bitstring) = m1_6668 in
                                                                    {8411}new Ns_6670: bitstring;
                                                                    {8412}new ST_6671: bitstring;
                                                                    {8413}new TTL_6672: bitstring;
                                                                    {8414}let m2_6673: bitstring = (OpenSecureChannelResponse,Ns_6670,ST_6671,TTL_6672) in
                                                                    {8415}event beginSrv(Sess_5025,Cli_5023,Ns_6670);
                                                                    {8416}out(c, (enc(m2_6673,pkCli_6653),sign(h(m2_6673),skSess_6447)));
                                                                    {8417}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                                    {8418}event endSrv(Cli_5023,Sess_5025,Nc_6669)
                                                            )
                                                            else
                                                                {8419}let v_6674: bool = (Disco_5024 = C) in
                                                                (
                                                                    {8420}if v_6674 then
                                                                    (
                                                                        {8421}let pkDisco_6675: bitstring = pub(skC) in
                                                                        {8422}in(c, (=pkCli_6653,em1_6676: bitstring,sigM1_6677: bitstring));
                                                                        {8423}let m1_6678: bitstring = dec(em1_6676,skSess_6447) in
                                                                        {8424}if (verify(h(m1_6678),sigM1_6677,pkCli_6653) <> true) then
                                                                            0
                                                                        else
                                                                            {8425}let (=OpenSecureChannelRequest,=pkCli_6653,Nc_6679: bitstring) = m1_6678 in
                                                                            {8426}new Ns_6680: bitstring;
                                                                            {8427}new ST_6681: bitstring;
                                                                            {8428}new TTL_6682: bitstring;
                                                                            {8429}let m2_6683: bitstring = (OpenSecureChannelResponse,Ns_6680,ST_6681,TTL_6682) in
                                                                            {8430}event beginSrv(Sess_5025,Cli_5023,Ns_6680);
                                                                            {8431}out(c, (enc(m2_6683,pkCli_6653),sign(h(m2_6683),skSess_6447)));
                                                                            {8432}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                                            {8433}event endSrv(Cli_5023,Sess_5025,Nc_6679)
                                                                    )
                                                                    else
                                                                        {8434}let pkDisco_6684: bitstring = pub(sk(Disco_5024)) in
                                                                        {8435}in(c, (=pkCli_6653,em1_6685: bitstring,sigM1_6686: bitstring));
                                                                        {8436}let m1_6687: bitstring = dec(em1_6685,skSess_6447) in
                                                                        {8437}if (verify(h(m1_6687),sigM1_6686,pkCli_6653) <> true) then
                                                                            0
                                                                        else
                                                                            {8438}let (=OpenSecureChannelRequest,=pkCli_6653,Nc_6688: bitstring) = m1_6687 in
                                                                            {8439}new Ns_6689: bitstring;
                                                                            {8440}new ST_6690: bitstring;
                                                                            {8441}new TTL_6691: bitstring;
                                                                            {8442}let m2_6692: bitstring = (OpenSecureChannelResponse,Ns_6689,ST_6690,TTL_6691) in
                                                                            {8443}event beginSrv(Sess_5025,Cli_5023,Ns_6689);
                                                                            {8444}out(c, (enc(m2_6692,pkCli_6653),sign(h(m2_6692),skSess_6447)));
                                                                            {8445}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                                            {8446}event endSrv(Cli_5023,Sess_5025,Nc_6688)
                                                                )
                                                                else
                                                                    {8447}let pkDisco_6693: bitstring = fail-any in
                                                                    {8448}in(c, (=pkCli_6653,em1_6694: bitstring,sigM1_6695: bitstring));
                                                                    {8449}let m1_6696: bitstring = dec(em1_6694,skSess_6447) in
                                                                    {8450}if (verify(h(m1_6696),sigM1_6695,pkCli_6653) <> true) then
                                                                        0
                                                                    else
                                                                        {8451}let (=OpenSecureChannelRequest,=pkCli_6653,Nc_6697: bitstring) = m1_6696 in
                                                                        {8452}new Ns_6698: bitstring;
                                                                        {8453}new ST_6699: bitstring;
                                                                        {8454}new TTL_6700: bitstring;
                                                                        {8455}let m2_6701: bitstring = (OpenSecureChannelResponse,Ns_6698,ST_6699,TTL_6700) in
                                                                        {8456}event beginSrv(Sess_5025,Cli_5023,Ns_6698);
                                                                        {8457}out(c, (enc(m2_6701,pkCli_6653),sign(h(m2_6701),skSess_6447)));
                                                                        {8458}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                                        {8459}event endSrv(Cli_5023,Sess_5025,Nc_6697)
                                                        )
                                                        else
                                                            {8460}let pkDisco_6702: bitstring = fail-any in
                                                            {8461}in(c, (=pkCli_6653,em1_6703: bitstring,sigM1_6704: bitstring));
                                                            {8462}let m1_6705: bitstring = dec(em1_6703,skSess_6447) in
                                                            {8463}if (verify(h(m1_6705),sigM1_6704,pkCli_6653) <> true) then
                                                                0
                                                            else
                                                                {8464}let (=OpenSecureChannelRequest,=pkCli_6653,Nc_6706: bitstring) = m1_6705 in
                                                                {8465}new Ns_6707: bitstring;
                                                                {8466}new ST_6708: bitstring;
                                                                {8467}new TTL_6709: bitstring;
                                                                {8468}let m2_6710: bitstring = (OpenSecureChannelResponse,Ns_6707,ST_6708,TTL_6709) in
                                                                {8469}event beginSrv(Sess_5025,Cli_5023,Ns_6707);
                                                                {8470}out(c, (enc(m2_6710,pkCli_6653),sign(h(m2_6710),skSess_6447)));
                                                                {8471}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                                {8472}event endSrv(Cli_5023,Sess_5025,Nc_6706)
                                                )
                                                else
                                                    {8473}let pkDisco_6711: bitstring = fail-any in
                                                    {8474}in(c, (=pkCli_6653,em1_6712: bitstring,sigM1_6713: bitstring));
                                                    {8475}let m1_6714: bitstring = dec(em1_6712,skSess_6447) in
                                                    {8476}if (verify(h(m1_6714),sigM1_6713,pkCli_6653) <> true) then
                                                        0
                                                    else
                                                        {8477}let (=OpenSecureChannelRequest,=pkCli_6653,Nc_6715: bitstring) = m1_6714 in
                                                        {8478}new Ns_6716: bitstring;
                                                        {8479}new ST_6717: bitstring;
                                                        {8480}new TTL_6718: bitstring;
                                                        {8481}let m2_6719: bitstring = (OpenSecureChannelResponse,Ns_6716,ST_6717,TTL_6718) in
                                                        {8482}event beginSrv(Sess_5025,Cli_5023,Ns_6716);
                                                        {8483}out(c, (enc(m2_6719,pkCli_6653),sign(h(m2_6719),skSess_6447)));
                                                        {8484}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                        {8485}event endSrv(Cli_5023,Sess_5025,Nc_6715)
                                        )
                                        else
                                            {8486}let pkCli_6720: bitstring = fail-any in
                                            {8487}let v_6721: bool = (Disco_5024 = A) in
                                            (
                                                {8488}if v_6721 then
                                                (
                                                    {8489}let pkDisco_6722: bitstring = pub(skA) in
                                                    {8490}in(c, (=pkCli_6720,em1_6723: bitstring,sigM1_6724: bitstring));
                                                    {8491}let m1_6725: bitstring = dec(em1_6723,skSess_6447) in
                                                    {8492}if (verify(h(m1_6725),sigM1_6724,pkCli_6720) <> true) then
                                                        0
                                                    else
                                                        {8493}let (=OpenSecureChannelRequest,=pkCli_6720,Nc_6726: bitstring) = m1_6725 in
                                                        {8494}new Ns_6727: bitstring;
                                                        {8495}new ST_6728: bitstring;
                                                        {8496}new TTL_6729: bitstring;
                                                        {8497}let m2_6730: bitstring = (OpenSecureChannelResponse,Ns_6727,ST_6728,TTL_6729) in
                                                        {8498}event beginSrv(Sess_5025,Cli_5023,Ns_6727);
                                                        {8499}out(c, (enc(m2_6730,pkCli_6720),sign(h(m2_6730),skSess_6447)));
                                                        {8500}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                        {8501}event endSrv(Cli_5023,Sess_5025,Nc_6726)
                                                )
                                                else
                                                    {8502}let v_6731: bool = (Disco_5024 = B) in
                                                    (
                                                        {8503}if v_6731 then
                                                        (
                                                            {8504}let pkDisco_6732: bitstring = pub(skB) in
                                                            {8505}in(c, (=pkCli_6720,em1_6733: bitstring,sigM1_6734: bitstring));
                                                            {8506}let m1_6735: bitstring = dec(em1_6733,skSess_6447) in
                                                            {8507}if (verify(h(m1_6735),sigM1_6734,pkCli_6720) <> true) then
                                                                0
                                                            else
                                                                {8508}let (=OpenSecureChannelRequest,=pkCli_6720,Nc_6736: bitstring) = m1_6735 in
                                                                {8509}new Ns_6737: bitstring;
                                                                {8510}new ST_6738: bitstring;
                                                                {8511}new TTL_6739: bitstring;
                                                                {8512}let m2_6740: bitstring = (OpenSecureChannelResponse,Ns_6737,ST_6738,TTL_6739) in
                                                                {8513}event beginSrv(Sess_5025,Cli_5023,Ns_6737);
                                                                {8514}out(c, (enc(m2_6740,pkCli_6720),sign(h(m2_6740),skSess_6447)));
                                                                {8515}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                                {8516}event endSrv(Cli_5023,Sess_5025,Nc_6736)
                                                        )
                                                        else
                                                            {8517}let v_6741: bool = (Disco_5024 = C) in
                                                            (
                                                                {8518}if v_6741 then
                                                                (
                                                                    {8519}let pkDisco_6742: bitstring = pub(skC) in
                                                                    {8520}in(c, (=pkCli_6720,em1_6743: bitstring,sigM1_6744: bitstring));
                                                                    {8521}let m1_6745: bitstring = dec(em1_6743,skSess_6447) in
                                                                    {8522}if (verify(h(m1_6745),sigM1_6744,pkCli_6720) <> true) then
                                                                        0
                                                                    else
                                                                        {8523}let (=OpenSecureChannelRequest,=pkCli_6720,Nc_6746: bitstring) = m1_6745 in
                                                                        {8524}new Ns_6747: bitstring;
                                                                        {8525}new ST_6748: bitstring;
                                                                        {8526}new TTL_6749: bitstring;
                                                                        {8527}let m2_6750: bitstring = (OpenSecureChannelResponse,Ns_6747,ST_6748,TTL_6749) in
                                                                        {8528}event beginSrv(Sess_5025,Cli_5023,Ns_6747);
                                                                        {8529}out(c, (enc(m2_6750,pkCli_6720),sign(h(m2_6750),skSess_6447)));
                                                                        {8530}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                                        {8531}event endSrv(Cli_5023,Sess_5025,Nc_6746)
                                                                )
                                                                else
                                                                    {8532}let pkDisco_6751: bitstring = pub(sk(Disco_5024)) in
                                                                    {8533}in(c, (=pkCli_6720,em1_6752: bitstring,sigM1_6753: bitstring));
                                                                    {8534}let m1_6754: bitstring = dec(em1_6752,skSess_6447) in
                                                                    {8535}if (verify(h(m1_6754),sigM1_6753,pkCli_6720) <> true) then
                                                                        0
                                                                    else
                                                                        {8536}let (=OpenSecureChannelRequest,=pkCli_6720,Nc_6755: bitstring) = m1_6754 in
                                                                        {8537}new Ns_6756: bitstring;
                                                                        {8538}new ST_6757: bitstring;
                                                                        {8539}new TTL_6758: bitstring;
                                                                        {8540}let m2_6759: bitstring = (OpenSecureChannelResponse,Ns_6756,ST_6757,TTL_6758) in
                                                                        {8541}event beginSrv(Sess_5025,Cli_5023,Ns_6756);
                                                                        {8542}out(c, (enc(m2_6759,pkCli_6720),sign(h(m2_6759),skSess_6447)));
                                                                        {8543}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                                        {8544}event endSrv(Cli_5023,Sess_5025,Nc_6755)
                                                            )
                                                            else
                                                                {8545}let pkDisco_6760: bitstring = fail-any in
                                                                {8546}in(c, (=pkCli_6720,em1_6761: bitstring,sigM1_6762: bitstring));
                                                                {8547}let m1_6763: bitstring = dec(em1_6761,skSess_6447) in
                                                                {8548}if (verify(h(m1_6763),sigM1_6762,pkCli_6720) <> true) then
                                                                    0
                                                                else
                                                                    {8549}let (=OpenSecureChannelRequest,=pkCli_6720,Nc_6764: bitstring) = m1_6763 in
                                                                    {8550}new Ns_6765: bitstring;
                                                                    {8551}new ST_6766: bitstring;
                                                                    {8552}new TTL_6767: bitstring;
                                                                    {8553}let m2_6768: bitstring = (OpenSecureChannelResponse,Ns_6765,ST_6766,TTL_6767) in
                                                                    {8554}event beginSrv(Sess_5025,Cli_5023,Ns_6765);
                                                                    {8555}out(c, (enc(m2_6768,pkCli_6720),sign(h(m2_6768),skSess_6447)));
                                                                    {8556}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                                    {8557}event endSrv(Cli_5023,Sess_5025,Nc_6764)
                                                    )
                                                    else
                                                        {8558}let pkDisco_6769: bitstring = fail-any in
                                                        {8559}in(c, (=pkCli_6720,em1_6770: bitstring,sigM1_6771: bitstring));
                                                        {8560}let m1_6772: bitstring = dec(em1_6770,skSess_6447) in
                                                        {8561}if (verify(h(m1_6772),sigM1_6771,pkCli_6720) <> true) then
                                                            0
                                                        else
                                                            {8562}let (=OpenSecureChannelRequest,=pkCli_6720,Nc_6773: bitstring) = m1_6772 in
                                                            {8563}new Ns_6774: bitstring;
                                                            {8564}new ST_6775: bitstring;
                                                            {8565}new TTL_6776: bitstring;
                                                            {8566}let m2_6777: bitstring = (OpenSecureChannelResponse,Ns_6774,ST_6775,TTL_6776) in
                                                            {8567}event beginSrv(Sess_5025,Cli_5023,Ns_6774);
                                                            {8568}out(c, (enc(m2_6777,pkCli_6720),sign(h(m2_6777),skSess_6447)));
                                                            {8569}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                            {8570}event endSrv(Cli_5023,Sess_5025,Nc_6773)
                                            )
                                            else
                                                {8571}let pkDisco_6778: bitstring = fail-any in
                                                {8572}in(c, (=pkCli_6720,em1_6779: bitstring,sigM1_6780: bitstring));
                                                {8573}let m1_6781: bitstring = dec(em1_6779,skSess_6447) in
                                                {8574}if (verify(h(m1_6781),sigM1_6780,pkCli_6720) <> true) then
                                                    0
                                                else
                                                    {8575}let (=OpenSecureChannelRequest,=pkCli_6720,Nc_6782: bitstring) = m1_6781 in
                                                    {8576}new Ns_6783: bitstring;
                                                    {8577}new ST_6784: bitstring;
                                                    {8578}new TTL_6785: bitstring;
                                                    {8579}let m2_6786: bitstring = (OpenSecureChannelResponse,Ns_6783,ST_6784,TTL_6785) in
                                                    {8580}event beginSrv(Sess_5025,Cli_5023,Ns_6783);
                                                    {8581}out(c, (enc(m2_6786,pkCli_6720),sign(h(m2_6786),skSess_6447)));
                                                    {8582}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                    {8583}event endSrv(Cli_5023,Sess_5025,Nc_6782)
                                )
                                else
                                    {8584}let pkCli_6787: bitstring = fail-any in
                                    {8585}let v_6788: bool = (Disco_5024 = A) in
                                    (
                                        {8586}if v_6788 then
                                        (
                                            {8587}let pkDisco_6789: bitstring = pub(skA) in
                                            {8588}in(c, (=pkCli_6787,em1_6790: bitstring,sigM1_6791: bitstring));
                                            {8589}let m1_6792: bitstring = dec(em1_6790,skSess_6447) in
                                            {8590}if (verify(h(m1_6792),sigM1_6791,pkCli_6787) <> true) then
                                                0
                                            else
                                                {8591}let (=OpenSecureChannelRequest,=pkCli_6787,Nc_6793: bitstring) = m1_6792 in
                                                {8592}new Ns_6794: bitstring;
                                                {8593}new ST_6795: bitstring;
                                                {8594}new TTL_6796: bitstring;
                                                {8595}let m2_6797: bitstring = (OpenSecureChannelResponse,Ns_6794,ST_6795,TTL_6796) in
                                                {8596}event beginSrv(Sess_5025,Cli_5023,Ns_6794);
                                                {8597}out(c, (enc(m2_6797,pkCli_6787),sign(h(m2_6797),skSess_6447)));
                                                {8598}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                {8599}event endSrv(Cli_5023,Sess_5025,Nc_6793)
                                        )
                                        else
                                            {8600}let v_6798: bool = (Disco_5024 = B) in
                                            (
                                                {8601}if v_6798 then
                                                (
                                                    {8602}let pkDisco_6799: bitstring = pub(skB) in
                                                    {8603}in(c, (=pkCli_6787,em1_6800: bitstring,sigM1_6801: bitstring));
                                                    {8604}let m1_6802: bitstring = dec(em1_6800,skSess_6447) in
                                                    {8605}if (verify(h(m1_6802),sigM1_6801,pkCli_6787) <> true) then
                                                        0
                                                    else
                                                        {8606}let (=OpenSecureChannelRequest,=pkCli_6787,Nc_6803: bitstring) = m1_6802 in
                                                        {8607}new Ns_6804: bitstring;
                                                        {8608}new ST_6805: bitstring;
                                                        {8609}new TTL_6806: bitstring;
                                                        {8610}let m2_6807: bitstring = (OpenSecureChannelResponse,Ns_6804,ST_6805,TTL_6806) in
                                                        {8611}event beginSrv(Sess_5025,Cli_5023,Ns_6804);
                                                        {8612}out(c, (enc(m2_6807,pkCli_6787),sign(h(m2_6807),skSess_6447)));
                                                        {8613}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                        {8614}event endSrv(Cli_5023,Sess_5025,Nc_6803)
                                                )
                                                else
                                                    {8615}let v_6808: bool = (Disco_5024 = C) in
                                                    (
                                                        {8616}if v_6808 then
                                                        (
                                                            {8617}let pkDisco_6809: bitstring = pub(skC) in
                                                            {8618}in(c, (=pkCli_6787,em1_6810: bitstring,sigM1_6811: bitstring));
                                                            {8619}let m1_6812: bitstring = dec(em1_6810,skSess_6447) in
                                                            {8620}if (verify(h(m1_6812),sigM1_6811,pkCli_6787) <> true) then
                                                                0
                                                            else
                                                                {8621}let (=OpenSecureChannelRequest,=pkCli_6787,Nc_6813: bitstring) = m1_6812 in
                                                                {8622}new Ns_6814: bitstring;
                                                                {8623}new ST_6815: bitstring;
                                                                {8624}new TTL_6816: bitstring;
                                                                {8625}let m2_6817: bitstring = (OpenSecureChannelResponse,Ns_6814,ST_6815,TTL_6816) in
                                                                {8626}event beginSrv(Sess_5025,Cli_5023,Ns_6814);
                                                                {8627}out(c, (enc(m2_6817,pkCli_6787),sign(h(m2_6817),skSess_6447)));
                                                                {8628}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                                {8629}event endSrv(Cli_5023,Sess_5025,Nc_6813)
                                                        )
                                                        else
                                                            {8630}let pkDisco_6818: bitstring = pub(sk(Disco_5024)) in
                                                            {8631}in(c, (=pkCli_6787,em1_6819: bitstring,sigM1_6820: bitstring));
                                                            {8632}let m1_6821: bitstring = dec(em1_6819,skSess_6447) in
                                                            {8633}if (verify(h(m1_6821),sigM1_6820,pkCli_6787) <> true) then
                                                                0
                                                            else
                                                                {8634}let (=OpenSecureChannelRequest,=pkCli_6787,Nc_6822: bitstring) = m1_6821 in
                                                                {8635}new Ns_6823: bitstring;
                                                                {8636}new ST_6824: bitstring;
                                                                {8637}new TTL_6825: bitstring;
                                                                {8638}let m2_6826: bitstring = (OpenSecureChannelResponse,Ns_6823,ST_6824,TTL_6825) in
                                                                {8639}event beginSrv(Sess_5025,Cli_5023,Ns_6823);
                                                                {8640}out(c, (enc(m2_6826,pkCli_6787),sign(h(m2_6826),skSess_6447)));
                                                                {8641}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                                {8642}event endSrv(Cli_5023,Sess_5025,Nc_6822)
                                                    )
                                                    else
                                                        {8643}let pkDisco_6827: bitstring = fail-any in
                                                        {8644}in(c, (=pkCli_6787,em1_6828: bitstring,sigM1_6829: bitstring));
                                                        {8645}let m1_6830: bitstring = dec(em1_6828,skSess_6447) in
                                                        {8646}if (verify(h(m1_6830),sigM1_6829,pkCli_6787) <> true) then
                                                            0
                                                        else
                                                            {8647}let (=OpenSecureChannelRequest,=pkCli_6787,Nc_6831: bitstring) = m1_6830 in
                                                            {8648}new Ns_6832: bitstring;
                                                            {8649}new ST_6833: bitstring;
                                                            {8650}new TTL_6834: bitstring;
                                                            {8651}let m2_6835: bitstring = (OpenSecureChannelResponse,Ns_6832,ST_6833,TTL_6834) in
                                                            {8652}event beginSrv(Sess_5025,Cli_5023,Ns_6832);
                                                            {8653}out(c, (enc(m2_6835,pkCli_6787),sign(h(m2_6835),skSess_6447)));
                                                            {8654}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                            {8655}event endSrv(Cli_5023,Sess_5025,Nc_6831)
                                            )
                                            else
                                                {8656}let pkDisco_6836: bitstring = fail-any in
                                                {8657}in(c, (=pkCli_6787,em1_6837: bitstring,sigM1_6838: bitstring));
                                                {8658}let m1_6839: bitstring = dec(em1_6837,skSess_6447) in
                                                {8659}if (verify(h(m1_6839),sigM1_6838,pkCli_6787) <> true) then
                                                    0
                                                else
                                                    {8660}let (=OpenSecureChannelRequest,=pkCli_6787,Nc_6840: bitstring) = m1_6839 in
                                                    {8661}new Ns_6841: bitstring;
                                                    {8662}new ST_6842: bitstring;
                                                    {8663}new TTL_6843: bitstring;
                                                    {8664}let m2_6844: bitstring = (OpenSecureChannelResponse,Ns_6841,ST_6842,TTL_6843) in
                                                    {8665}event beginSrv(Sess_5025,Cli_5023,Ns_6841);
                                                    {8666}out(c, (enc(m2_6844,pkCli_6787),sign(h(m2_6844),skSess_6447)));
                                                    {8667}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                    {8668}event endSrv(Cli_5023,Sess_5025,Nc_6840)
                                    )
                                    else
                                        {8669}let pkDisco_6845: bitstring = fail-any in
                                        {8670}in(c, (=pkCli_6787,em1_6846: bitstring,sigM1_6847: bitstring));
                                        {8671}let m1_6848: bitstring = dec(em1_6846,skSess_6447) in
                                        {8672}if (verify(h(m1_6848),sigM1_6847,pkCli_6787) <> true) then
                                            0
                                        else
                                            {8673}let (=OpenSecureChannelRequest,=pkCli_6787,Nc_6849: bitstring) = m1_6848 in
                                            {8674}new Ns_6850: bitstring;
                                            {8675}new ST_6851: bitstring;
                                            {8676}new TTL_6852: bitstring;
                                            {8677}let m2_6853: bitstring = (OpenSecureChannelResponse,Ns_6850,ST_6851,TTL_6852) in
                                            {8678}event beginSrv(Sess_5025,Cli_5023,Ns_6850);
                                            {8679}out(c, (enc(m2_6853,pkCli_6787),sign(h(m2_6853),skSess_6447)));
                                            {8680}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                            {8681}event endSrv(Cli_5023,Sess_5025,Nc_6849)
                        )
                        else
                            {8682}let pkCli_6854: bitstring = fail-any in
                            {8683}let v_6855: bool = (Disco_5024 = A) in
                            (
                                {8684}if v_6855 then
                                (
                                    {8685}let pkDisco_6856: bitstring = pub(skA) in
                                    {8686}in(c, (=pkCli_6854,em1_6857: bitstring,sigM1_6858: bitstring));
                                    {8687}let m1_6859: bitstring = dec(em1_6857,skSess_6447) in
                                    {8688}if (verify(h(m1_6859),sigM1_6858,pkCli_6854) <> true) then
                                        0
                                    else
                                        {8689}let (=OpenSecureChannelRequest,=pkCli_6854,Nc_6860: bitstring) = m1_6859 in
                                        {8690}new Ns_6861: bitstring;
                                        {8691}new ST_6862: bitstring;
                                        {8692}new TTL_6863: bitstring;
                                        {8693}let m2_6864: bitstring = (OpenSecureChannelResponse,Ns_6861,ST_6862,TTL_6863) in
                                        {8694}event beginSrv(Sess_5025,Cli_5023,Ns_6861);
                                        {8695}out(c, (enc(m2_6864,pkCli_6854),sign(h(m2_6864),skSess_6447)));
                                        {8696}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                        {8697}event endSrv(Cli_5023,Sess_5025,Nc_6860)
                                )
                                else
                                    {8698}let v_6865: bool = (Disco_5024 = B) in
                                    (
                                        {8699}if v_6865 then
                                        (
                                            {8700}let pkDisco_6866: bitstring = pub(skB) in
                                            {8701}in(c, (=pkCli_6854,em1_6867: bitstring,sigM1_6868: bitstring));
                                            {8702}let m1_6869: bitstring = dec(em1_6867,skSess_6447) in
                                            {8703}if (verify(h(m1_6869),sigM1_6868,pkCli_6854) <> true) then
                                                0
                                            else
                                                {8704}let (=OpenSecureChannelRequest,=pkCli_6854,Nc_6870: bitstring) = m1_6869 in
                                                {8705}new Ns_6871: bitstring;
                                                {8706}new ST_6872: bitstring;
                                                {8707}new TTL_6873: bitstring;
                                                {8708}let m2_6874: bitstring = (OpenSecureChannelResponse,Ns_6871,ST_6872,TTL_6873) in
                                                {8709}event beginSrv(Sess_5025,Cli_5023,Ns_6871);
                                                {8710}out(c, (enc(m2_6874,pkCli_6854),sign(h(m2_6874),skSess_6447)));
                                                {8711}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                {8712}event endSrv(Cli_5023,Sess_5025,Nc_6870)
                                        )
                                        else
                                            {8713}let v_6875: bool = (Disco_5024 = C) in
                                            (
                                                {8714}if v_6875 then
                                                (
                                                    {8715}let pkDisco_6876: bitstring = pub(skC) in
                                                    {8716}in(c, (=pkCli_6854,em1_6877: bitstring,sigM1_6878: bitstring));
                                                    {8717}let m1_6879: bitstring = dec(em1_6877,skSess_6447) in
                                                    {8718}if (verify(h(m1_6879),sigM1_6878,pkCli_6854) <> true) then
                                                        0
                                                    else
                                                        {8719}let (=OpenSecureChannelRequest,=pkCli_6854,Nc_6880: bitstring) = m1_6879 in
                                                        {8720}new Ns_6881: bitstring;
                                                        {8721}new ST_6882: bitstring;
                                                        {8722}new TTL_6883: bitstring;
                                                        {8723}let m2_6884: bitstring = (OpenSecureChannelResponse,Ns_6881,ST_6882,TTL_6883) in
                                                        {8724}event beginSrv(Sess_5025,Cli_5023,Ns_6881);
                                                        {8725}out(c, (enc(m2_6884,pkCli_6854),sign(h(m2_6884),skSess_6447)));
                                                        {8726}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                        {8727}event endSrv(Cli_5023,Sess_5025,Nc_6880)
                                                )
                                                else
                                                    {8728}let pkDisco_6885: bitstring = pub(sk(Disco_5024)) in
                                                    {8729}in(c, (=pkCli_6854,em1_6886: bitstring,sigM1_6887: bitstring));
                                                    {8730}let m1_6888: bitstring = dec(em1_6886,skSess_6447) in
                                                    {8731}if (verify(h(m1_6888),sigM1_6887,pkCli_6854) <> true) then
                                                        0
                                                    else
                                                        {8732}let (=OpenSecureChannelRequest,=pkCli_6854,Nc_6889: bitstring) = m1_6888 in
                                                        {8733}new Ns_6890: bitstring;
                                                        {8734}new ST_6891: bitstring;
                                                        {8735}new TTL_6892: bitstring;
                                                        {8736}let m2_6893: bitstring = (OpenSecureChannelResponse,Ns_6890,ST_6891,TTL_6892) in
                                                        {8737}event beginSrv(Sess_5025,Cli_5023,Ns_6890);
                                                        {8738}out(c, (enc(m2_6893,pkCli_6854),sign(h(m2_6893),skSess_6447)));
                                                        {8739}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                        {8740}event endSrv(Cli_5023,Sess_5025,Nc_6889)
                                            )
                                            else
                                                {8741}let pkDisco_6894: bitstring = fail-any in
                                                {8742}in(c, (=pkCli_6854,em1_6895: bitstring,sigM1_6896: bitstring));
                                                {8743}let m1_6897: bitstring = dec(em1_6895,skSess_6447) in
                                                {8744}if (verify(h(m1_6897),sigM1_6896,pkCli_6854) <> true) then
                                                    0
                                                else
                                                    {8745}let (=OpenSecureChannelRequest,=pkCli_6854,Nc_6898: bitstring) = m1_6897 in
                                                    {8746}new Ns_6899: bitstring;
                                                    {8747}new ST_6900: bitstring;
                                                    {8748}new TTL_6901: bitstring;
                                                    {8749}let m2_6902: bitstring = (OpenSecureChannelResponse,Ns_6899,ST_6900,TTL_6901) in
                                                    {8750}event beginSrv(Sess_5025,Cli_5023,Ns_6899);
                                                    {8751}out(c, (enc(m2_6902,pkCli_6854),sign(h(m2_6902),skSess_6447)));
                                                    {8752}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                    {8753}event endSrv(Cli_5023,Sess_5025,Nc_6898)
                                    )
                                    else
                                        {8754}let pkDisco_6903: bitstring = fail-any in
                                        {8755}in(c, (=pkCli_6854,em1_6904: bitstring,sigM1_6905: bitstring));
                                        {8756}let m1_6906: bitstring = dec(em1_6904,skSess_6447) in
                                        {8757}if (verify(h(m1_6906),sigM1_6905,pkCli_6854) <> true) then
                                            0
                                        else
                                            {8758}let (=OpenSecureChannelRequest,=pkCli_6854,Nc_6907: bitstring) = m1_6906 in
                                            {8759}new Ns_6908: bitstring;
                                            {8760}new ST_6909: bitstring;
                                            {8761}new TTL_6910: bitstring;
                                            {8762}let m2_6911: bitstring = (OpenSecureChannelResponse,Ns_6908,ST_6909,TTL_6910) in
                                            {8763}event beginSrv(Sess_5025,Cli_5023,Ns_6908);
                                            {8764}out(c, (enc(m2_6911,pkCli_6854),sign(h(m2_6911),skSess_6447)));
                                            {8765}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                            {8766}event endSrv(Cli_5023,Sess_5025,Nc_6907)
                            )
                            else
                                {8767}let pkDisco_6912: bitstring = fail-any in
                                {8768}in(c, (=pkCli_6854,em1_6913: bitstring,sigM1_6914: bitstring));
                                {8769}let m1_6915: bitstring = dec(em1_6913,skSess_6447) in
                                {8770}if (verify(h(m1_6915),sigM1_6914,pkCli_6854) <> true) then
                                    0
                                else
                                    {8771}let (=OpenSecureChannelRequest,=pkCli_6854,Nc_6916: bitstring) = m1_6915 in
                                    {8772}new Ns_6917: bitstring;
                                    {8773}new ST_6918: bitstring;
                                    {8774}new TTL_6919: bitstring;
                                    {8775}let m2_6920: bitstring = (OpenSecureChannelResponse,Ns_6917,ST_6918,TTL_6919) in
                                    {8776}event beginSrv(Sess_5025,Cli_5023,Ns_6917);
                                    {8777}out(c, (enc(m2_6920,pkCli_6854),sign(h(m2_6920),skSess_6447)));
                                    {8778}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                    {8779}event endSrv(Cli_5023,Sess_5025,Nc_6916)
            )
            else
                {8780}let skSess_6921: bitstring = fail-any in
                {8781}let pkSess_6922: bitstring = pub(skSess_6921) in
                {8782}let v_6923: bool = (Cli_5023 = A) in
                (
                    {8783}if v_6923 then
                    (
                        {8784}let pkCli_6924: bitstring = pub(skA) in
                        {8785}let v_6925: bool = (Disco_5024 = A) in
                        (
                            {8786}if v_6925 then
                            (
                                {8787}let pkDisco_6926: bitstring = pub(skA) in
                                {8788}in(c, (=pkCli_6924,em1_6927: bitstring,sigM1_6928: bitstring));
                                {8789}let m1_6929: bitstring = dec(em1_6927,skSess_6921) in
                                {8790}if (verify(h(m1_6929),sigM1_6928,pkCli_6924) <> true) then
                                    0
                                else
                                    {8791}let (=OpenSecureChannelRequest,=pkCli_6924,Nc_6930: bitstring) = m1_6929 in
                                    {8792}new Ns_6931: bitstring;
                                    {8793}new ST_6932: bitstring;
                                    {8794}new TTL_6933: bitstring;
                                    {8795}let m2_6934: bitstring = (OpenSecureChannelResponse,Ns_6931,ST_6932,TTL_6933) in
                                    {8796}event beginSrv(Sess_5025,Cli_5023,Ns_6931);
                                    {8797}out(c, (enc(m2_6934,pkCli_6924),sign(h(m2_6934),skSess_6921)));
                                    {8798}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                    {8799}event endSrv(Cli_5023,Sess_5025,Nc_6930)
                            )
                            else
                                {8800}let v_6935: bool = (Disco_5024 = B) in
                                (
                                    {8801}if v_6935 then
                                    (
                                        {8802}let pkDisco_6936: bitstring = pub(skB) in
                                        {8803}in(c, (=pkCli_6924,em1_6937: bitstring,sigM1_6938: bitstring));
                                        {8804}let m1_6939: bitstring = dec(em1_6937,skSess_6921) in
                                        {8805}if (verify(h(m1_6939),sigM1_6938,pkCli_6924) <> true) then
                                            0
                                        else
                                            {8806}let (=OpenSecureChannelRequest,=pkCli_6924,Nc_6940: bitstring) = m1_6939 in
                                            {8807}new Ns_6941: bitstring;
                                            {8808}new ST_6942: bitstring;
                                            {8809}new TTL_6943: bitstring;
                                            {8810}let m2_6944: bitstring = (OpenSecureChannelResponse,Ns_6941,ST_6942,TTL_6943) in
                                            {8811}event beginSrv(Sess_5025,Cli_5023,Ns_6941);
                                            {8812}out(c, (enc(m2_6944,pkCli_6924),sign(h(m2_6944),skSess_6921)));
                                            {8813}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                            {8814}event endSrv(Cli_5023,Sess_5025,Nc_6940)
                                    )
                                    else
                                        {8815}let v_6945: bool = (Disco_5024 = C) in
                                        (
                                            {8816}if v_6945 then
                                            (
                                                {8817}let pkDisco_6946: bitstring = pub(skC) in
                                                {8818}in(c, (=pkCli_6924,em1_6947: bitstring,sigM1_6948: bitstring));
                                                {8819}let m1_6949: bitstring = dec(em1_6947,skSess_6921) in
                                                {8820}if (verify(h(m1_6949),sigM1_6948,pkCli_6924) <> true) then
                                                    0
                                                else
                                                    {8821}let (=OpenSecureChannelRequest,=pkCli_6924,Nc_6950: bitstring) = m1_6949 in
                                                    {8822}new Ns_6951: bitstring;
                                                    {8823}new ST_6952: bitstring;
                                                    {8824}new TTL_6953: bitstring;
                                                    {8825}let m2_6954: bitstring = (OpenSecureChannelResponse,Ns_6951,ST_6952,TTL_6953) in
                                                    {8826}event beginSrv(Sess_5025,Cli_5023,Ns_6951);
                                                    {8827}out(c, (enc(m2_6954,pkCli_6924),sign(h(m2_6954),skSess_6921)));
                                                    {8828}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                    {8829}event endSrv(Cli_5023,Sess_5025,Nc_6950)
                                            )
                                            else
                                                {8830}let pkDisco_6955: bitstring = pub(sk(Disco_5024)) in
                                                {8831}in(c, (=pkCli_6924,em1_6956: bitstring,sigM1_6957: bitstring));
                                                {8832}let m1_6958: bitstring = dec(em1_6956,skSess_6921) in
                                                {8833}if (verify(h(m1_6958),sigM1_6957,pkCli_6924) <> true) then
                                                    0
                                                else
                                                    {8834}let (=OpenSecureChannelRequest,=pkCli_6924,Nc_6959: bitstring) = m1_6958 in
                                                    {8835}new Ns_6960: bitstring;
                                                    {8836}new ST_6961: bitstring;
                                                    {8837}new TTL_6962: bitstring;
                                                    {8838}let m2_6963: bitstring = (OpenSecureChannelResponse,Ns_6960,ST_6961,TTL_6962) in
                                                    {8839}event beginSrv(Sess_5025,Cli_5023,Ns_6960);
                                                    {8840}out(c, (enc(m2_6963,pkCli_6924),sign(h(m2_6963),skSess_6921)));
                                                    {8841}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                    {8842}event endSrv(Cli_5023,Sess_5025,Nc_6959)
                                        )
                                        else
                                            {8843}let pkDisco_6964: bitstring = fail-any in
                                            {8844}in(c, (=pkCli_6924,em1_6965: bitstring,sigM1_6966: bitstring));
                                            {8845}let m1_6967: bitstring = dec(em1_6965,skSess_6921) in
                                            {8846}if (verify(h(m1_6967),sigM1_6966,pkCli_6924) <> true) then
                                                0
                                            else
                                                {8847}let (=OpenSecureChannelRequest,=pkCli_6924,Nc_6968: bitstring) = m1_6967 in
                                                {8848}new Ns_6969: bitstring;
                                                {8849}new ST_6970: bitstring;
                                                {8850}new TTL_6971: bitstring;
                                                {8851}let m2_6972: bitstring = (OpenSecureChannelResponse,Ns_6969,ST_6970,TTL_6971) in
                                                {8852}event beginSrv(Sess_5025,Cli_5023,Ns_6969);
                                                {8853}out(c, (enc(m2_6972,pkCli_6924),sign(h(m2_6972),skSess_6921)));
                                                {8854}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                {8855}event endSrv(Cli_5023,Sess_5025,Nc_6968)
                                )
                                else
                                    {8856}let pkDisco_6973: bitstring = fail-any in
                                    {8857}in(c, (=pkCli_6924,em1_6974: bitstring,sigM1_6975: bitstring));
                                    {8858}let m1_6976: bitstring = dec(em1_6974,skSess_6921) in
                                    {8859}if (verify(h(m1_6976),sigM1_6975,pkCli_6924) <> true) then
                                        0
                                    else
                                        {8860}let (=OpenSecureChannelRequest,=pkCli_6924,Nc_6977: bitstring) = m1_6976 in
                                        {8861}new Ns_6978: bitstring;
                                        {8862}new ST_6979: bitstring;
                                        {8863}new TTL_6980: bitstring;
                                        {8864}let m2_6981: bitstring = (OpenSecureChannelResponse,Ns_6978,ST_6979,TTL_6980) in
                                        {8865}event beginSrv(Sess_5025,Cli_5023,Ns_6978);
                                        {8866}out(c, (enc(m2_6981,pkCli_6924),sign(h(m2_6981),skSess_6921)));
                                        {8867}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                        {8868}event endSrv(Cli_5023,Sess_5025,Nc_6977)
                        )
                        else
                            {8869}let pkDisco_6982: bitstring = fail-any in
                            {8870}in(c, (=pkCli_6924,em1_6983: bitstring,sigM1_6984: bitstring));
                            {8871}let m1_6985: bitstring = dec(em1_6983,skSess_6921) in
                            {8872}if (verify(h(m1_6985),sigM1_6984,pkCli_6924) <> true) then
                                0
                            else
                                {8873}let (=OpenSecureChannelRequest,=pkCli_6924,Nc_6986: bitstring) = m1_6985 in
                                {8874}new Ns_6987: bitstring;
                                {8875}new ST_6988: bitstring;
                                {8876}new TTL_6989: bitstring;
                                {8877}let m2_6990: bitstring = (OpenSecureChannelResponse,Ns_6987,ST_6988,TTL_6989) in
                                {8878}event beginSrv(Sess_5025,Cli_5023,Ns_6987);
                                {8879}out(c, (enc(m2_6990,pkCli_6924),sign(h(m2_6990),skSess_6921)));
                                {8880}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                {8881}event endSrv(Cli_5023,Sess_5025,Nc_6986)
                    )
                    else
                        {8882}let v_6991: bool = (Cli_5023 = B) in
                        (
                            {8883}if v_6991 then
                            (
                                {8884}let pkCli_6992: bitstring = pub(skB) in
                                {8885}let v_6993: bool = (Disco_5024 = A) in
                                (
                                    {8886}if v_6993 then
                                    (
                                        {8887}let pkDisco_6994: bitstring = pub(skA) in
                                        {8888}in(c, (=pkCli_6992,em1_6995: bitstring,sigM1_6996: bitstring));
                                        {8889}let m1_6997: bitstring = dec(em1_6995,skSess_6921) in
                                        {8890}if (verify(h(m1_6997),sigM1_6996,pkCli_6992) <> true) then
                                            0
                                        else
                                            {8891}let (=OpenSecureChannelRequest,=pkCli_6992,Nc_6998: bitstring) = m1_6997 in
                                            {8892}new Ns_6999: bitstring;
                                            {8893}new ST_7000: bitstring;
                                            {8894}new TTL_7001: bitstring;
                                            {8895}let m2_7002: bitstring = (OpenSecureChannelResponse,Ns_6999,ST_7000,TTL_7001) in
                                            {8896}event beginSrv(Sess_5025,Cli_5023,Ns_6999);
                                            {8897}out(c, (enc(m2_7002,pkCli_6992),sign(h(m2_7002),skSess_6921)));
                                            {8898}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                            {8899}event endSrv(Cli_5023,Sess_5025,Nc_6998)
                                    )
                                    else
                                        {8900}let v_7003: bool = (Disco_5024 = B) in
                                        (
                                            {8901}if v_7003 then
                                            (
                                                {8902}let pkDisco_7004: bitstring = pub(skB) in
                                                {8903}in(c, (=pkCli_6992,em1_7005: bitstring,sigM1_7006: bitstring));
                                                {8904}let m1_7007: bitstring = dec(em1_7005,skSess_6921) in
                                                {8905}if (verify(h(m1_7007),sigM1_7006,pkCli_6992) <> true) then
                                                    0
                                                else
                                                    {8906}let (=OpenSecureChannelRequest,=pkCli_6992,Nc_7008: bitstring) = m1_7007 in
                                                    {8907}new Ns_7009: bitstring;
                                                    {8908}new ST_7010: bitstring;
                                                    {8909}new TTL_7011: bitstring;
                                                    {8910}let m2_7012: bitstring = (OpenSecureChannelResponse,Ns_7009,ST_7010,TTL_7011) in
                                                    {8911}event beginSrv(Sess_5025,Cli_5023,Ns_7009);
                                                    {8912}out(c, (enc(m2_7012,pkCli_6992),sign(h(m2_7012),skSess_6921)));
                                                    {8913}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                    {8914}event endSrv(Cli_5023,Sess_5025,Nc_7008)
                                            )
                                            else
                                                {8915}let v_7013: bool = (Disco_5024 = C) in
                                                (
                                                    {8916}if v_7013 then
                                                    (
                                                        {8917}let pkDisco_7014: bitstring = pub(skC) in
                                                        {8918}in(c, (=pkCli_6992,em1_7015: bitstring,sigM1_7016: bitstring));
                                                        {8919}let m1_7017: bitstring = dec(em1_7015,skSess_6921) in
                                                        {8920}if (verify(h(m1_7017),sigM1_7016,pkCli_6992) <> true) then
                                                            0
                                                        else
                                                            {8921}let (=OpenSecureChannelRequest,=pkCli_6992,Nc_7018: bitstring) = m1_7017 in
                                                            {8922}new Ns_7019: bitstring;
                                                            {8923}new ST_7020: bitstring;
                                                            {8924}new TTL_7021: bitstring;
                                                            {8925}let m2_7022: bitstring = (OpenSecureChannelResponse,Ns_7019,ST_7020,TTL_7021) in
                                                            {8926}event beginSrv(Sess_5025,Cli_5023,Ns_7019);
                                                            {8927}out(c, (enc(m2_7022,pkCli_6992),sign(h(m2_7022),skSess_6921)));
                                                            {8928}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                            {8929}event endSrv(Cli_5023,Sess_5025,Nc_7018)
                                                    )
                                                    else
                                                        {8930}let pkDisco_7023: bitstring = pub(sk(Disco_5024)) in
                                                        {8931}in(c, (=pkCli_6992,em1_7024: bitstring,sigM1_7025: bitstring));
                                                        {8932}let m1_7026: bitstring = dec(em1_7024,skSess_6921) in
                                                        {8933}if (verify(h(m1_7026),sigM1_7025,pkCli_6992) <> true) then
                                                            0
                                                        else
                                                            {8934}let (=OpenSecureChannelRequest,=pkCli_6992,Nc_7027: bitstring) = m1_7026 in
                                                            {8935}new Ns_7028: bitstring;
                                                            {8936}new ST_7029: bitstring;
                                                            {8937}new TTL_7030: bitstring;
                                                            {8938}let m2_7031: bitstring = (OpenSecureChannelResponse,Ns_7028,ST_7029,TTL_7030) in
                                                            {8939}event beginSrv(Sess_5025,Cli_5023,Ns_7028);
                                                            {8940}out(c, (enc(m2_7031,pkCli_6992),sign(h(m2_7031),skSess_6921)));
                                                            {8941}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                            {8942}event endSrv(Cli_5023,Sess_5025,Nc_7027)
                                                )
                                                else
                                                    {8943}let pkDisco_7032: bitstring = fail-any in
                                                    {8944}in(c, (=pkCli_6992,em1_7033: bitstring,sigM1_7034: bitstring));
                                                    {8945}let m1_7035: bitstring = dec(em1_7033,skSess_6921) in
                                                    {8946}if (verify(h(m1_7035),sigM1_7034,pkCli_6992) <> true) then
                                                        0
                                                    else
                                                        {8947}let (=OpenSecureChannelRequest,=pkCli_6992,Nc_7036: bitstring) = m1_7035 in
                                                        {8948}new Ns_7037: bitstring;
                                                        {8949}new ST_7038: bitstring;
                                                        {8950}new TTL_7039: bitstring;
                                                        {8951}let m2_7040: bitstring = (OpenSecureChannelResponse,Ns_7037,ST_7038,TTL_7039) in
                                                        {8952}event beginSrv(Sess_5025,Cli_5023,Ns_7037);
                                                        {8953}out(c, (enc(m2_7040,pkCli_6992),sign(h(m2_7040),skSess_6921)));
                                                        {8954}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                        {8955}event endSrv(Cli_5023,Sess_5025,Nc_7036)
                                        )
                                        else
                                            {8956}let pkDisco_7041: bitstring = fail-any in
                                            {8957}in(c, (=pkCli_6992,em1_7042: bitstring,sigM1_7043: bitstring));
                                            {8958}let m1_7044: bitstring = dec(em1_7042,skSess_6921) in
                                            {8959}if (verify(h(m1_7044),sigM1_7043,pkCli_6992) <> true) then
                                                0
                                            else
                                                {8960}let (=OpenSecureChannelRequest,=pkCli_6992,Nc_7045: bitstring) = m1_7044 in
                                                {8961}new Ns_7046: bitstring;
                                                {8962}new ST_7047: bitstring;
                                                {8963}new TTL_7048: bitstring;
                                                {8964}let m2_7049: bitstring = (OpenSecureChannelResponse,Ns_7046,ST_7047,TTL_7048) in
                                                {8965}event beginSrv(Sess_5025,Cli_5023,Ns_7046);
                                                {8966}out(c, (enc(m2_7049,pkCli_6992),sign(h(m2_7049),skSess_6921)));
                                                {8967}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                {8968}event endSrv(Cli_5023,Sess_5025,Nc_7045)
                                )
                                else
                                    {8969}let pkDisco_7050: bitstring = fail-any in
                                    {8970}in(c, (=pkCli_6992,em1_7051: bitstring,sigM1_7052: bitstring));
                                    {8971}let m1_7053: bitstring = dec(em1_7051,skSess_6921) in
                                    {8972}if (verify(h(m1_7053),sigM1_7052,pkCli_6992) <> true) then
                                        0
                                    else
                                        {8973}let (=OpenSecureChannelRequest,=pkCli_6992,Nc_7054: bitstring) = m1_7053 in
                                        {8974}new Ns_7055: bitstring;
                                        {8975}new ST_7056: bitstring;
                                        {8976}new TTL_7057: bitstring;
                                        {8977}let m2_7058: bitstring = (OpenSecureChannelResponse,Ns_7055,ST_7056,TTL_7057) in
                                        {8978}event beginSrv(Sess_5025,Cli_5023,Ns_7055);
                                        {8979}out(c, (enc(m2_7058,pkCli_6992),sign(h(m2_7058),skSess_6921)));
                                        {8980}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                        {8981}event endSrv(Cli_5023,Sess_5025,Nc_7054)
                            )
                            else
                                {8982}let v_7059: bool = (Cli_5023 = C) in
                                (
                                    {8983}if v_7059 then
                                    (
                                        {8984}let pkCli_7060: bitstring = pub(skC) in
                                        {8985}let v_7061: bool = (Disco_5024 = A) in
                                        (
                                            {8986}if v_7061 then
                                            (
                                                {8987}let pkDisco_7062: bitstring = pub(skA) in
                                                {8988}in(c, (=pkCli_7060,em1_7063: bitstring,sigM1_7064: bitstring));
                                                {8989}let m1_7065: bitstring = dec(em1_7063,skSess_6921) in
                                                {8990}if (verify(h(m1_7065),sigM1_7064,pkCli_7060) <> true) then
                                                    0
                                                else
                                                    {8991}let (=OpenSecureChannelRequest,=pkCli_7060,Nc_7066: bitstring) = m1_7065 in
                                                    {8992}new Ns_7067: bitstring;
                                                    {8993}new ST_7068: bitstring;
                                                    {8994}new TTL_7069: bitstring;
                                                    {8995}let m2_7070: bitstring = (OpenSecureChannelResponse,Ns_7067,ST_7068,TTL_7069) in
                                                    {8996}event beginSrv(Sess_5025,Cli_5023,Ns_7067);
                                                    {8997}out(c, (enc(m2_7070,pkCli_7060),sign(h(m2_7070),skSess_6921)));
                                                    {8998}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                    {8999}event endSrv(Cli_5023,Sess_5025,Nc_7066)
                                            )
                                            else
                                                {9000}let v_7071: bool = (Disco_5024 = B) in
                                                (
                                                    {9001}if v_7071 then
                                                    (
                                                        {9002}let pkDisco_7072: bitstring = pub(skB) in
                                                        {9003}in(c, (=pkCli_7060,em1_7073: bitstring,sigM1_7074: bitstring));
                                                        {9004}let m1_7075: bitstring = dec(em1_7073,skSess_6921) in
                                                        {9005}if (verify(h(m1_7075),sigM1_7074,pkCli_7060) <> true) then
                                                            0
                                                        else
                                                            {9006}let (=OpenSecureChannelRequest,=pkCli_7060,Nc_7076: bitstring) = m1_7075 in
                                                            {9007}new Ns_7077: bitstring;
                                                            {9008}new ST_7078: bitstring;
                                                            {9009}new TTL_7079: bitstring;
                                                            {9010}let m2_7080: bitstring = (OpenSecureChannelResponse,Ns_7077,ST_7078,TTL_7079) in
                                                            {9011}event beginSrv(Sess_5025,Cli_5023,Ns_7077);
                                                            {9012}out(c, (enc(m2_7080,pkCli_7060),sign(h(m2_7080),skSess_6921)));
                                                            {9013}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                            {9014}event endSrv(Cli_5023,Sess_5025,Nc_7076)
                                                    )
                                                    else
                                                        {9015}let v_7081: bool = (Disco_5024 = C) in
                                                        (
                                                            {9016}if v_7081 then
                                                            (
                                                                {9017}let pkDisco_7082: bitstring = pub(skC) in
                                                                {9018}in(c, (=pkCli_7060,em1_7083: bitstring,sigM1_7084: bitstring));
                                                                {9019}let m1_7085: bitstring = dec(em1_7083,skSess_6921) in
                                                                {9020}if (verify(h(m1_7085),sigM1_7084,pkCli_7060) <> true) then
                                                                    0
                                                                else
                                                                    {9021}let (=OpenSecureChannelRequest,=pkCli_7060,Nc_7086: bitstring) = m1_7085 in
                                                                    {9022}new Ns_7087: bitstring;
                                                                    {9023}new ST_7088: bitstring;
                                                                    {9024}new TTL_7089: bitstring;
                                                                    {9025}let m2_7090: bitstring = (OpenSecureChannelResponse,Ns_7087,ST_7088,TTL_7089) in
                                                                    {9026}event beginSrv(Sess_5025,Cli_5023,Ns_7087);
                                                                    {9027}out(c, (enc(m2_7090,pkCli_7060),sign(h(m2_7090),skSess_6921)));
                                                                    {9028}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                                    {9029}event endSrv(Cli_5023,Sess_5025,Nc_7086)
                                                            )
                                                            else
                                                                {9030}let pkDisco_7091: bitstring = pub(sk(Disco_5024)) in
                                                                {9031}in(c, (=pkCli_7060,em1_7092: bitstring,sigM1_7093: bitstring));
                                                                {9032}let m1_7094: bitstring = dec(em1_7092,skSess_6921) in
                                                                {9033}if (verify(h(m1_7094),sigM1_7093,pkCli_7060) <> true) then
                                                                    0
                                                                else
                                                                    {9034}let (=OpenSecureChannelRequest,=pkCli_7060,Nc_7095: bitstring) = m1_7094 in
                                                                    {9035}new Ns_7096: bitstring;
                                                                    {9036}new ST_7097: bitstring;
                                                                    {9037}new TTL_7098: bitstring;
                                                                    {9038}let m2_7099: bitstring = (OpenSecureChannelResponse,Ns_7096,ST_7097,TTL_7098) in
                                                                    {9039}event beginSrv(Sess_5025,Cli_5023,Ns_7096);
                                                                    {9040}out(c, (enc(m2_7099,pkCli_7060),sign(h(m2_7099),skSess_6921)));
                                                                    {9041}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                                    {9042}event endSrv(Cli_5023,Sess_5025,Nc_7095)
                                                        )
                                                        else
                                                            {9043}let pkDisco_7100: bitstring = fail-any in
                                                            {9044}in(c, (=pkCli_7060,em1_7101: bitstring,sigM1_7102: bitstring));
                                                            {9045}let m1_7103: bitstring = dec(em1_7101,skSess_6921) in
                                                            {9046}if (verify(h(m1_7103),sigM1_7102,pkCli_7060) <> true) then
                                                                0
                                                            else
                                                                {9047}let (=OpenSecureChannelRequest,=pkCli_7060,Nc_7104: bitstring) = m1_7103 in
                                                                {9048}new Ns_7105: bitstring;
                                                                {9049}new ST_7106: bitstring;
                                                                {9050}new TTL_7107: bitstring;
                                                                {9051}let m2_7108: bitstring = (OpenSecureChannelResponse,Ns_7105,ST_7106,TTL_7107) in
                                                                {9052}event beginSrv(Sess_5025,Cli_5023,Ns_7105);
                                                                {9053}out(c, (enc(m2_7108,pkCli_7060),sign(h(m2_7108),skSess_6921)));
                                                                {9054}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                                {9055}event endSrv(Cli_5023,Sess_5025,Nc_7104)
                                                )
                                                else
                                                    {9056}let pkDisco_7109: bitstring = fail-any in
                                                    {9057}in(c, (=pkCli_7060,em1_7110: bitstring,sigM1_7111: bitstring));
                                                    {9058}let m1_7112: bitstring = dec(em1_7110,skSess_6921) in
                                                    {9059}if (verify(h(m1_7112),sigM1_7111,pkCli_7060) <> true) then
                                                        0
                                                    else
                                                        {9060}let (=OpenSecureChannelRequest,=pkCli_7060,Nc_7113: bitstring) = m1_7112 in
                                                        {9061}new Ns_7114: bitstring;
                                                        {9062}new ST_7115: bitstring;
                                                        {9063}new TTL_7116: bitstring;
                                                        {9064}let m2_7117: bitstring = (OpenSecureChannelResponse,Ns_7114,ST_7115,TTL_7116) in
                                                        {9065}event beginSrv(Sess_5025,Cli_5023,Ns_7114);
                                                        {9066}out(c, (enc(m2_7117,pkCli_7060),sign(h(m2_7117),skSess_6921)));
                                                        {9067}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                        {9068}event endSrv(Cli_5023,Sess_5025,Nc_7113)
                                        )
                                        else
                                            {9069}let pkDisco_7118: bitstring = fail-any in
                                            {9070}in(c, (=pkCli_7060,em1_7119: bitstring,sigM1_7120: bitstring));
                                            {9071}let m1_7121: bitstring = dec(em1_7119,skSess_6921) in
                                            {9072}if (verify(h(m1_7121),sigM1_7120,pkCli_7060) <> true) then
                                                0
                                            else
                                                {9073}let (=OpenSecureChannelRequest,=pkCli_7060,Nc_7122: bitstring) = m1_7121 in
                                                {9074}new Ns_7123: bitstring;
                                                {9075}new ST_7124: bitstring;
                                                {9076}new TTL_7125: bitstring;
                                                {9077}let m2_7126: bitstring = (OpenSecureChannelResponse,Ns_7123,ST_7124,TTL_7125) in
                                                {9078}event beginSrv(Sess_5025,Cli_5023,Ns_7123);
                                                {9079}out(c, (enc(m2_7126,pkCli_7060),sign(h(m2_7126),skSess_6921)));
                                                {9080}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                {9081}event endSrv(Cli_5023,Sess_5025,Nc_7122)
                                    )
                                    else
                                        {9082}let pkCli_7127: bitstring = pub(sk(Cli_5023)) in
                                        {9083}let v_7128: bool = (Disco_5024 = A) in
                                        (
                                            {9084}if v_7128 then
                                            (
                                                {9085}let pkDisco_7129: bitstring = pub(skA) in
                                                {9086}in(c, (=pkCli_7127,em1_7130: bitstring,sigM1_7131: bitstring));
                                                {9087}let m1_7132: bitstring = dec(em1_7130,skSess_6921) in
                                                {9088}if (verify(h(m1_7132),sigM1_7131,pkCli_7127) <> true) then
                                                    0
                                                else
                                                    {9089}let (=OpenSecureChannelRequest,=pkCli_7127,Nc_7133: bitstring) = m1_7132 in
                                                    {9090}new Ns_7134: bitstring;
                                                    {9091}new ST_7135: bitstring;
                                                    {9092}new TTL_7136: bitstring;
                                                    {9093}let m2_7137: bitstring = (OpenSecureChannelResponse,Ns_7134,ST_7135,TTL_7136) in
                                                    {9094}event beginSrv(Sess_5025,Cli_5023,Ns_7134);
                                                    {9095}out(c, (enc(m2_7137,pkCli_7127),sign(h(m2_7137),skSess_6921)));
                                                    {9096}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                    {9097}event endSrv(Cli_5023,Sess_5025,Nc_7133)
                                            )
                                            else
                                                {9098}let v_7138: bool = (Disco_5024 = B) in
                                                (
                                                    {9099}if v_7138 then
                                                    (
                                                        {9100}let pkDisco_7139: bitstring = pub(skB) in
                                                        {9101}in(c, (=pkCli_7127,em1_7140: bitstring,sigM1_7141: bitstring));
                                                        {9102}let m1_7142: bitstring = dec(em1_7140,skSess_6921) in
                                                        {9103}if (verify(h(m1_7142),sigM1_7141,pkCli_7127) <> true) then
                                                            0
                                                        else
                                                            {9104}let (=OpenSecureChannelRequest,=pkCli_7127,Nc_7143: bitstring) = m1_7142 in
                                                            {9105}new Ns_7144: bitstring;
                                                            {9106}new ST_7145: bitstring;
                                                            {9107}new TTL_7146: bitstring;
                                                            {9108}let m2_7147: bitstring = (OpenSecureChannelResponse,Ns_7144,ST_7145,TTL_7146) in
                                                            {9109}event beginSrv(Sess_5025,Cli_5023,Ns_7144);
                                                            {9110}out(c, (enc(m2_7147,pkCli_7127),sign(h(m2_7147),skSess_6921)));
                                                            {9111}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                            {9112}event endSrv(Cli_5023,Sess_5025,Nc_7143)
                                                    )
                                                    else
                                                        {9113}let v_7148: bool = (Disco_5024 = C) in
                                                        (
                                                            {9114}if v_7148 then
                                                            (
                                                                {9115}let pkDisco_7149: bitstring = pub(skC) in
                                                                {9116}in(c, (=pkCli_7127,em1_7150: bitstring,sigM1_7151: bitstring));
                                                                {9117}let m1_7152: bitstring = dec(em1_7150,skSess_6921) in
                                                                {9118}if (verify(h(m1_7152),sigM1_7151,pkCli_7127) <> true) then
                                                                    0
                                                                else
                                                                    {9119}let (=OpenSecureChannelRequest,=pkCli_7127,Nc_7153: bitstring) = m1_7152 in
                                                                    {9120}new Ns_7154: bitstring;
                                                                    {9121}new ST_7155: bitstring;
                                                                    {9122}new TTL_7156: bitstring;
                                                                    {9123}let m2_7157: bitstring = (OpenSecureChannelResponse,Ns_7154,ST_7155,TTL_7156) in
                                                                    {9124}event beginSrv(Sess_5025,Cli_5023,Ns_7154);
                                                                    {9125}out(c, (enc(m2_7157,pkCli_7127),sign(h(m2_7157),skSess_6921)));
                                                                    {9126}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                                    {9127}event endSrv(Cli_5023,Sess_5025,Nc_7153)
                                                            )
                                                            else
                                                                {9128}let pkDisco_7158: bitstring = pub(sk(Disco_5024)) in
                                                                {9129}in(c, (=pkCli_7127,em1_7159: bitstring,sigM1_7160: bitstring));
                                                                {9130}let m1_7161: bitstring = dec(em1_7159,skSess_6921) in
                                                                {9131}if (verify(h(m1_7161),sigM1_7160,pkCli_7127) <> true) then
                                                                    0
                                                                else
                                                                    {9132}let (=OpenSecureChannelRequest,=pkCli_7127,Nc_7162: bitstring) = m1_7161 in
                                                                    {9133}new Ns_7163: bitstring;
                                                                    {9134}new ST_7164: bitstring;
                                                                    {9135}new TTL_7165: bitstring;
                                                                    {9136}let m2_7166: bitstring = (OpenSecureChannelResponse,Ns_7163,ST_7164,TTL_7165) in
                                                                    {9137}event beginSrv(Sess_5025,Cli_5023,Ns_7163);
                                                                    {9138}out(c, (enc(m2_7166,pkCli_7127),sign(h(m2_7166),skSess_6921)));
                                                                    {9139}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                                    {9140}event endSrv(Cli_5023,Sess_5025,Nc_7162)
                                                        )
                                                        else
                                                            {9141}let pkDisco_7167: bitstring = fail-any in
                                                            {9142}in(c, (=pkCli_7127,em1_7168: bitstring,sigM1_7169: bitstring));
                                                            {9143}let m1_7170: bitstring = dec(em1_7168,skSess_6921) in
                                                            {9144}if (verify(h(m1_7170),sigM1_7169,pkCli_7127) <> true) then
                                                                0
                                                            else
                                                                {9145}let (=OpenSecureChannelRequest,=pkCli_7127,Nc_7171: bitstring) = m1_7170 in
                                                                {9146}new Ns_7172: bitstring;
                                                                {9147}new ST_7173: bitstring;
                                                                {9148}new TTL_7174: bitstring;
                                                                {9149}let m2_7175: bitstring = (OpenSecureChannelResponse,Ns_7172,ST_7173,TTL_7174) in
                                                                {9150}event beginSrv(Sess_5025,Cli_5023,Ns_7172);
                                                                {9151}out(c, (enc(m2_7175,pkCli_7127),sign(h(m2_7175),skSess_6921)));
                                                                {9152}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                                {9153}event endSrv(Cli_5023,Sess_5025,Nc_7171)
                                                )
                                                else
                                                    {9154}let pkDisco_7176: bitstring = fail-any in
                                                    {9155}in(c, (=pkCli_7127,em1_7177: bitstring,sigM1_7178: bitstring));
                                                    {9156}let m1_7179: bitstring = dec(em1_7177,skSess_6921) in
                                                    {9157}if (verify(h(m1_7179),sigM1_7178,pkCli_7127) <> true) then
                                                        0
                                                    else
                                                        {9158}let (=OpenSecureChannelRequest,=pkCli_7127,Nc_7180: bitstring) = m1_7179 in
                                                        {9159}new Ns_7181: bitstring;
                                                        {9160}new ST_7182: bitstring;
                                                        {9161}new TTL_7183: bitstring;
                                                        {9162}let m2_7184: bitstring = (OpenSecureChannelResponse,Ns_7181,ST_7182,TTL_7183) in
                                                        {9163}event beginSrv(Sess_5025,Cli_5023,Ns_7181);
                                                        {9164}out(c, (enc(m2_7184,pkCli_7127),sign(h(m2_7184),skSess_6921)));
                                                        {9165}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                        {9166}event endSrv(Cli_5023,Sess_5025,Nc_7180)
                                        )
                                        else
                                            {9167}let pkDisco_7185: bitstring = fail-any in
                                            {9168}in(c, (=pkCli_7127,em1_7186: bitstring,sigM1_7187: bitstring));
                                            {9169}let m1_7188: bitstring = dec(em1_7186,skSess_6921) in
                                            {9170}if (verify(h(m1_7188),sigM1_7187,pkCli_7127) <> true) then
                                                0
                                            else
                                                {9171}let (=OpenSecureChannelRequest,=pkCli_7127,Nc_7189: bitstring) = m1_7188 in
                                                {9172}new Ns_7190: bitstring;
                                                {9173}new ST_7191: bitstring;
                                                {9174}new TTL_7192: bitstring;
                                                {9175}let m2_7193: bitstring = (OpenSecureChannelResponse,Ns_7190,ST_7191,TTL_7192) in
                                                {9176}event beginSrv(Sess_5025,Cli_5023,Ns_7190);
                                                {9177}out(c, (enc(m2_7193,pkCli_7127),sign(h(m2_7193),skSess_6921)));
                                                {9178}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                {9179}event endSrv(Cli_5023,Sess_5025,Nc_7189)
                                )
                                else
                                    {9180}let pkCli_7194: bitstring = fail-any in
                                    {9181}let v_7195: bool = (Disco_5024 = A) in
                                    (
                                        {9182}if v_7195 then
                                        (
                                            {9183}let pkDisco_7196: bitstring = pub(skA) in
                                            {9184}in(c, (=pkCli_7194,em1_7197: bitstring,sigM1_7198: bitstring));
                                            {9185}let m1_7199: bitstring = dec(em1_7197,skSess_6921) in
                                            {9186}if (verify(h(m1_7199),sigM1_7198,pkCli_7194) <> true) then
                                                0
                                            else
                                                {9187}let (=OpenSecureChannelRequest,=pkCli_7194,Nc_7200: bitstring) = m1_7199 in
                                                {9188}new Ns_7201: bitstring;
                                                {9189}new ST_7202: bitstring;
                                                {9190}new TTL_7203: bitstring;
                                                {9191}let m2_7204: bitstring = (OpenSecureChannelResponse,Ns_7201,ST_7202,TTL_7203) in
                                                {9192}event beginSrv(Sess_5025,Cli_5023,Ns_7201);
                                                {9193}out(c, (enc(m2_7204,pkCli_7194),sign(h(m2_7204),skSess_6921)));
                                                {9194}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                {9195}event endSrv(Cli_5023,Sess_5025,Nc_7200)
                                        )
                                        else
                                            {9196}let v_7205: bool = (Disco_5024 = B) in
                                            (
                                                {9197}if v_7205 then
                                                (
                                                    {9198}let pkDisco_7206: bitstring = pub(skB) in
                                                    {9199}in(c, (=pkCli_7194,em1_7207: bitstring,sigM1_7208: bitstring));
                                                    {9200}let m1_7209: bitstring = dec(em1_7207,skSess_6921) in
                                                    {9201}if (verify(h(m1_7209),sigM1_7208,pkCli_7194) <> true) then
                                                        0
                                                    else
                                                        {9202}let (=OpenSecureChannelRequest,=pkCli_7194,Nc_7210: bitstring) = m1_7209 in
                                                        {9203}new Ns_7211: bitstring;
                                                        {9204}new ST_7212: bitstring;
                                                        {9205}new TTL_7213: bitstring;
                                                        {9206}let m2_7214: bitstring = (OpenSecureChannelResponse,Ns_7211,ST_7212,TTL_7213) in
                                                        {9207}event beginSrv(Sess_5025,Cli_5023,Ns_7211);
                                                        {9208}out(c, (enc(m2_7214,pkCli_7194),sign(h(m2_7214),skSess_6921)));
                                                        {9209}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                        {9210}event endSrv(Cli_5023,Sess_5025,Nc_7210)
                                                )
                                                else
                                                    {9211}let v_7215: bool = (Disco_5024 = C) in
                                                    (
                                                        {9212}if v_7215 then
                                                        (
                                                            {9213}let pkDisco_7216: bitstring = pub(skC) in
                                                            {9214}in(c, (=pkCli_7194,em1_7217: bitstring,sigM1_7218: bitstring));
                                                            {9215}let m1_7219: bitstring = dec(em1_7217,skSess_6921) in
                                                            {9216}if (verify(h(m1_7219),sigM1_7218,pkCli_7194) <> true) then
                                                                0
                                                            else
                                                                {9217}let (=OpenSecureChannelRequest,=pkCli_7194,Nc_7220: bitstring) = m1_7219 in
                                                                {9218}new Ns_7221: bitstring;
                                                                {9219}new ST_7222: bitstring;
                                                                {9220}new TTL_7223: bitstring;
                                                                {9221}let m2_7224: bitstring = (OpenSecureChannelResponse,Ns_7221,ST_7222,TTL_7223) in
                                                                {9222}event beginSrv(Sess_5025,Cli_5023,Ns_7221);
                                                                {9223}out(c, (enc(m2_7224,pkCli_7194),sign(h(m2_7224),skSess_6921)));
                                                                {9224}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                                {9225}event endSrv(Cli_5023,Sess_5025,Nc_7220)
                                                        )
                                                        else
                                                            {9226}let pkDisco_7225: bitstring = pub(sk(Disco_5024)) in
                                                            {9227}in(c, (=pkCli_7194,em1_7226: bitstring,sigM1_7227: bitstring));
                                                            {9228}let m1_7228: bitstring = dec(em1_7226,skSess_6921) in
                                                            {9229}if (verify(h(m1_7228),sigM1_7227,pkCli_7194) <> true) then
                                                                0
                                                            else
                                                                {9230}let (=OpenSecureChannelRequest,=pkCli_7194,Nc_7229: bitstring) = m1_7228 in
                                                                {9231}new Ns_7230: bitstring;
                                                                {9232}new ST_7231: bitstring;
                                                                {9233}new TTL_7232: bitstring;
                                                                {9234}let m2_7233: bitstring = (OpenSecureChannelResponse,Ns_7230,ST_7231,TTL_7232) in
                                                                {9235}event beginSrv(Sess_5025,Cli_5023,Ns_7230);
                                                                {9236}out(c, (enc(m2_7233,pkCli_7194),sign(h(m2_7233),skSess_6921)));
                                                                {9237}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                                {9238}event endSrv(Cli_5023,Sess_5025,Nc_7229)
                                                    )
                                                    else
                                                        {9239}let pkDisco_7234: bitstring = fail-any in
                                                        {9240}in(c, (=pkCli_7194,em1_7235: bitstring,sigM1_7236: bitstring));
                                                        {9241}let m1_7237: bitstring = dec(em1_7235,skSess_6921) in
                                                        {9242}if (verify(h(m1_7237),sigM1_7236,pkCli_7194) <> true) then
                                                            0
                                                        else
                                                            {9243}let (=OpenSecureChannelRequest,=pkCli_7194,Nc_7238: bitstring) = m1_7237 in
                                                            {9244}new Ns_7239: bitstring;
                                                            {9245}new ST_7240: bitstring;
                                                            {9246}new TTL_7241: bitstring;
                                                            {9247}let m2_7242: bitstring = (OpenSecureChannelResponse,Ns_7239,ST_7240,TTL_7241) in
                                                            {9248}event beginSrv(Sess_5025,Cli_5023,Ns_7239);
                                                            {9249}out(c, (enc(m2_7242,pkCli_7194),sign(h(m2_7242),skSess_6921)));
                                                            {9250}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                            {9251}event endSrv(Cli_5023,Sess_5025,Nc_7238)
                                            )
                                            else
                                                {9252}let pkDisco_7243: bitstring = fail-any in
                                                {9253}in(c, (=pkCli_7194,em1_7244: bitstring,sigM1_7245: bitstring));
                                                {9254}let m1_7246: bitstring = dec(em1_7244,skSess_6921) in
                                                {9255}if (verify(h(m1_7246),sigM1_7245,pkCli_7194) <> true) then
                                                    0
                                                else
                                                    {9256}let (=OpenSecureChannelRequest,=pkCli_7194,Nc_7247: bitstring) = m1_7246 in
                                                    {9257}new Ns_7248: bitstring;
                                                    {9258}new ST_7249: bitstring;
                                                    {9259}new TTL_7250: bitstring;
                                                    {9260}let m2_7251: bitstring = (OpenSecureChannelResponse,Ns_7248,ST_7249,TTL_7250) in
                                                    {9261}event beginSrv(Sess_5025,Cli_5023,Ns_7248);
                                                    {9262}out(c, (enc(m2_7251,pkCli_7194),sign(h(m2_7251),skSess_6921)));
                                                    {9263}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                    {9264}event endSrv(Cli_5023,Sess_5025,Nc_7247)
                                    )
                                    else
                                        {9265}let pkDisco_7252: bitstring = fail-any in
                                        {9266}in(c, (=pkCli_7194,em1_7253: bitstring,sigM1_7254: bitstring));
                                        {9267}let m1_7255: bitstring = dec(em1_7253,skSess_6921) in
                                        {9268}if (verify(h(m1_7255),sigM1_7254,pkCli_7194) <> true) then
                                            0
                                        else
                                            {9269}let (=OpenSecureChannelRequest,=pkCli_7194,Nc_7256: bitstring) = m1_7255 in
                                            {9270}new Ns_7257: bitstring;
                                            {9271}new ST_7258: bitstring;
                                            {9272}new TTL_7259: bitstring;
                                            {9273}let m2_7260: bitstring = (OpenSecureChannelResponse,Ns_7257,ST_7258,TTL_7259) in
                                            {9274}event beginSrv(Sess_5025,Cli_5023,Ns_7257);
                                            {9275}out(c, (enc(m2_7260,pkCli_7194),sign(h(m2_7260),skSess_6921)));
                                            {9276}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                            {9277}event endSrv(Cli_5023,Sess_5025,Nc_7256)
                        )
                        else
                            {9278}let pkCli_7261: bitstring = fail-any in
                            {9279}let v_7262: bool = (Disco_5024 = A) in
                            (
                                {9280}if v_7262 then
                                (
                                    {9281}let pkDisco_7263: bitstring = pub(skA) in
                                    {9282}in(c, (=pkCli_7261,em1_7264: bitstring,sigM1_7265: bitstring));
                                    {9283}let m1_7266: bitstring = dec(em1_7264,skSess_6921) in
                                    {9284}if (verify(h(m1_7266),sigM1_7265,pkCli_7261) <> true) then
                                        0
                                    else
                                        {9285}let (=OpenSecureChannelRequest,=pkCli_7261,Nc_7267: bitstring) = m1_7266 in
                                        {9286}new Ns_7268: bitstring;
                                        {9287}new ST_7269: bitstring;
                                        {9288}new TTL_7270: bitstring;
                                        {9289}let m2_7271: bitstring = (OpenSecureChannelResponse,Ns_7268,ST_7269,TTL_7270) in
                                        {9290}event beginSrv(Sess_5025,Cli_5023,Ns_7268);
                                        {9291}out(c, (enc(m2_7271,pkCli_7261),sign(h(m2_7271),skSess_6921)));
                                        {9292}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                        {9293}event endSrv(Cli_5023,Sess_5025,Nc_7267)
                                )
                                else
                                    {9294}let v_7272: bool = (Disco_5024 = B) in
                                    (
                                        {9295}if v_7272 then
                                        (
                                            {9296}let pkDisco_7273: bitstring = pub(skB) in
                                            {9297}in(c, (=pkCli_7261,em1_7274: bitstring,sigM1_7275: bitstring));
                                            {9298}let m1_7276: bitstring = dec(em1_7274,skSess_6921) in
                                            {9299}if (verify(h(m1_7276),sigM1_7275,pkCli_7261) <> true) then
                                                0
                                            else
                                                {9300}let (=OpenSecureChannelRequest,=pkCli_7261,Nc_7277: bitstring) = m1_7276 in
                                                {9301}new Ns_7278: bitstring;
                                                {9302}new ST_7279: bitstring;
                                                {9303}new TTL_7280: bitstring;
                                                {9304}let m2_7281: bitstring = (OpenSecureChannelResponse,Ns_7278,ST_7279,TTL_7280) in
                                                {9305}event beginSrv(Sess_5025,Cli_5023,Ns_7278);
                                                {9306}out(c, (enc(m2_7281,pkCli_7261),sign(h(m2_7281),skSess_6921)));
                                                {9307}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                {9308}event endSrv(Cli_5023,Sess_5025,Nc_7277)
                                        )
                                        else
                                            {9309}let v_7282: bool = (Disco_5024 = C) in
                                            (
                                                {9310}if v_7282 then
                                                (
                                                    {9311}let pkDisco_7283: bitstring = pub(skC) in
                                                    {9312}in(c, (=pkCli_7261,em1_7284: bitstring,sigM1_7285: bitstring));
                                                    {9313}let m1_7286: bitstring = dec(em1_7284,skSess_6921) in
                                                    {9314}if (verify(h(m1_7286),sigM1_7285,pkCli_7261) <> true) then
                                                        0
                                                    else
                                                        {9315}let (=OpenSecureChannelRequest,=pkCli_7261,Nc_7287: bitstring) = m1_7286 in
                                                        {9316}new Ns_7288: bitstring;
                                                        {9317}new ST_7289: bitstring;
                                                        {9318}new TTL_7290: bitstring;
                                                        {9319}let m2_7291: bitstring = (OpenSecureChannelResponse,Ns_7288,ST_7289,TTL_7290) in
                                                        {9320}event beginSrv(Sess_5025,Cli_5023,Ns_7288);
                                                        {9321}out(c, (enc(m2_7291,pkCli_7261),sign(h(m2_7291),skSess_6921)));
                                                        {9322}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                        {9323}event endSrv(Cli_5023,Sess_5025,Nc_7287)
                                                )
                                                else
                                                    {9324}let pkDisco_7292: bitstring = pub(sk(Disco_5024)) in
                                                    {9325}in(c, (=pkCli_7261,em1_7293: bitstring,sigM1_7294: bitstring));
                                                    {9326}let m1_7295: bitstring = dec(em1_7293,skSess_6921) in
                                                    {9327}if (verify(h(m1_7295),sigM1_7294,pkCli_7261) <> true) then
                                                        0
                                                    else
                                                        {9328}let (=OpenSecureChannelRequest,=pkCli_7261,Nc_7296: bitstring) = m1_7295 in
                                                        {9329}new Ns_7297: bitstring;
                                                        {9330}new ST_7298: bitstring;
                                                        {9331}new TTL_7299: bitstring;
                                                        {9332}let m2_7300: bitstring = (OpenSecureChannelResponse,Ns_7297,ST_7298,TTL_7299) in
                                                        {9333}event beginSrv(Sess_5025,Cli_5023,Ns_7297);
                                                        {9334}out(c, (enc(m2_7300,pkCli_7261),sign(h(m2_7300),skSess_6921)));
                                                        {9335}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                        {9336}event endSrv(Cli_5023,Sess_5025,Nc_7296)
                                            )
                                            else
                                                {9337}let pkDisco_7301: bitstring = fail-any in
                                                {9338}in(c, (=pkCli_7261,em1_7302: bitstring,sigM1_7303: bitstring));
                                                {9339}let m1_7304: bitstring = dec(em1_7302,skSess_6921) in
                                                {9340}if (verify(h(m1_7304),sigM1_7303,pkCli_7261) <> true) then
                                                    0
                                                else
                                                    {9341}let (=OpenSecureChannelRequest,=pkCli_7261,Nc_7305: bitstring) = m1_7304 in
                                                    {9342}new Ns_7306: bitstring;
                                                    {9343}new ST_7307: bitstring;
                                                    {9344}new TTL_7308: bitstring;
                                                    {9345}let m2_7309: bitstring = (OpenSecureChannelResponse,Ns_7306,ST_7307,TTL_7308) in
                                                    {9346}event beginSrv(Sess_5025,Cli_5023,Ns_7306);
                                                    {9347}out(c, (enc(m2_7309,pkCli_7261),sign(h(m2_7309),skSess_6921)));
                                                    {9348}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                    {9349}event endSrv(Cli_5023,Sess_5025,Nc_7305)
                                    )
                                    else
                                        {9350}let pkDisco_7310: bitstring = fail-any in
                                        {9351}in(c, (=pkCli_7261,em1_7311: bitstring,sigM1_7312: bitstring));
                                        {9352}let m1_7313: bitstring = dec(em1_7311,skSess_6921) in
                                        {9353}if (verify(h(m1_7313),sigM1_7312,pkCli_7261) <> true) then
                                            0
                                        else
                                            {9354}let (=OpenSecureChannelRequest,=pkCli_7261,Nc_7314: bitstring) = m1_7313 in
                                            {9355}new Ns_7315: bitstring;
                                            {9356}new ST_7316: bitstring;
                                            {9357}new TTL_7317: bitstring;
                                            {9358}let m2_7318: bitstring = (OpenSecureChannelResponse,Ns_7315,ST_7316,TTL_7317) in
                                            {9359}event beginSrv(Sess_5025,Cli_5023,Ns_7315);
                                            {9360}out(c, (enc(m2_7318,pkCli_7261),sign(h(m2_7318),skSess_6921)));
                                            {9361}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                            {9362}event endSrv(Cli_5023,Sess_5025,Nc_7314)
                            )
                            else
                                {9363}let pkDisco_7319: bitstring = fail-any in
                                {9364}in(c, (=pkCli_7261,em1_7320: bitstring,sigM1_7321: bitstring));
                                {9365}let m1_7322: bitstring = dec(em1_7320,skSess_6921) in
                                {9366}if (verify(h(m1_7322),sigM1_7321,pkCli_7261) <> true) then
                                    0
                                else
                                    {9367}let (=OpenSecureChannelRequest,=pkCli_7261,Nc_7323: bitstring) = m1_7322 in
                                    {9368}new Ns_7324: bitstring;
                                    {9369}new ST_7325: bitstring;
                                    {9370}new TTL_7326: bitstring;
                                    {9371}let m2_7327: bitstring = (OpenSecureChannelResponse,Ns_7324,ST_7325,TTL_7326) in
                                    {9372}event beginSrv(Sess_5025,Cli_5023,Ns_7324);
                                    {9373}out(c, (enc(m2_7327,pkCli_7261),sign(h(m2_7327),skSess_6921)));
                                    {9374}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                    {9375}event endSrv(Cli_5023,Sess_5025,Nc_7323)
                )
                else
                    {9376}let pkCli_7328: bitstring = fail-any in
                    {9377}let v_7329: bool = (Disco_5024 = A) in
                    (
                        {9378}if v_7329 then
                        (
                            {9379}let pkDisco_7330: bitstring = pub(skA) in
                            {9380}in(c, (=pkCli_7328,em1_7331: bitstring,sigM1_7332: bitstring));
                            {9381}let m1_7333: bitstring = dec(em1_7331,skSess_6921) in
                            {9382}if (verify(h(m1_7333),sigM1_7332,pkCli_7328) <> true) then
                                0
                            else
                                {9383}let (=OpenSecureChannelRequest,=pkCli_7328,Nc_7334: bitstring) = m1_7333 in
                                {9384}new Ns_7335: bitstring;
                                {9385}new ST_7336: bitstring;
                                {9386}new TTL_7337: bitstring;
                                {9387}let m2_7338: bitstring = (OpenSecureChannelResponse,Ns_7335,ST_7336,TTL_7337) in
                                {9388}event beginSrv(Sess_5025,Cli_5023,Ns_7335);
                                {9389}out(c, (enc(m2_7338,pkCli_7328),sign(h(m2_7338),skSess_6921)));
                                {9390}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                {9391}event endSrv(Cli_5023,Sess_5025,Nc_7334)
                        )
                        else
                            {9392}let v_7339: bool = (Disco_5024 = B) in
                            (
                                {9393}if v_7339 then
                                (
                                    {9394}let pkDisco_7340: bitstring = pub(skB) in
                                    {9395}in(c, (=pkCli_7328,em1_7341: bitstring,sigM1_7342: bitstring));
                                    {9396}let m1_7343: bitstring = dec(em1_7341,skSess_6921) in
                                    {9397}if (verify(h(m1_7343),sigM1_7342,pkCli_7328) <> true) then
                                        0
                                    else
                                        {9398}let (=OpenSecureChannelRequest,=pkCli_7328,Nc_7344: bitstring) = m1_7343 in
                                        {9399}new Ns_7345: bitstring;
                                        {9400}new ST_7346: bitstring;
                                        {9401}new TTL_7347: bitstring;
                                        {9402}let m2_7348: bitstring = (OpenSecureChannelResponse,Ns_7345,ST_7346,TTL_7347) in
                                        {9403}event beginSrv(Sess_5025,Cli_5023,Ns_7345);
                                        {9404}out(c, (enc(m2_7348,pkCli_7328),sign(h(m2_7348),skSess_6921)));
                                        {9405}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                        {9406}event endSrv(Cli_5023,Sess_5025,Nc_7344)
                                )
                                else
                                    {9407}let v_7349: bool = (Disco_5024 = C) in
                                    (
                                        {9408}if v_7349 then
                                        (
                                            {9409}let pkDisco_7350: bitstring = pub(skC) in
                                            {9410}in(c, (=pkCli_7328,em1_7351: bitstring,sigM1_7352: bitstring));
                                            {9411}let m1_7353: bitstring = dec(em1_7351,skSess_6921) in
                                            {9412}if (verify(h(m1_7353),sigM1_7352,pkCli_7328) <> true) then
                                                0
                                            else
                                                {9413}let (=OpenSecureChannelRequest,=pkCli_7328,Nc_7354: bitstring) = m1_7353 in
                                                {9414}new Ns_7355: bitstring;
                                                {9415}new ST_7356: bitstring;
                                                {9416}new TTL_7357: bitstring;
                                                {9417}let m2_7358: bitstring = (OpenSecureChannelResponse,Ns_7355,ST_7356,TTL_7357) in
                                                {9418}event beginSrv(Sess_5025,Cli_5023,Ns_7355);
                                                {9419}out(c, (enc(m2_7358,pkCli_7328),sign(h(m2_7358),skSess_6921)));
                                                {9420}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                {9421}event endSrv(Cli_5023,Sess_5025,Nc_7354)
                                        )
                                        else
                                            {9422}let pkDisco_7359: bitstring = pub(sk(Disco_5024)) in
                                            {9423}in(c, (=pkCli_7328,em1_7360: bitstring,sigM1_7361: bitstring));
                                            {9424}let m1_7362: bitstring = dec(em1_7360,skSess_6921) in
                                            {9425}if (verify(h(m1_7362),sigM1_7361,pkCli_7328) <> true) then
                                                0
                                            else
                                                {9426}let (=OpenSecureChannelRequest,=pkCli_7328,Nc_7363: bitstring) = m1_7362 in
                                                {9427}new Ns_7364: bitstring;
                                                {9428}new ST_7365: bitstring;
                                                {9429}new TTL_7366: bitstring;
                                                {9430}let m2_7367: bitstring = (OpenSecureChannelResponse,Ns_7364,ST_7365,TTL_7366) in
                                                {9431}event beginSrv(Sess_5025,Cli_5023,Ns_7364);
                                                {9432}out(c, (enc(m2_7367,pkCli_7328),sign(h(m2_7367),skSess_6921)));
                                                {9433}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                {9434}event endSrv(Cli_5023,Sess_5025,Nc_7363)
                                    )
                                    else
                                        {9435}let pkDisco_7368: bitstring = fail-any in
                                        {9436}in(c, (=pkCli_7328,em1_7369: bitstring,sigM1_7370: bitstring));
                                        {9437}let m1_7371: bitstring = dec(em1_7369,skSess_6921) in
                                        {9438}if (verify(h(m1_7371),sigM1_7370,pkCli_7328) <> true) then
                                            0
                                        else
                                            {9439}let (=OpenSecureChannelRequest,=pkCli_7328,Nc_7372: bitstring) = m1_7371 in
                                            {9440}new Ns_7373: bitstring;
                                            {9441}new ST_7374: bitstring;
                                            {9442}new TTL_7375: bitstring;
                                            {9443}let m2_7376: bitstring = (OpenSecureChannelResponse,Ns_7373,ST_7374,TTL_7375) in
                                            {9444}event beginSrv(Sess_5025,Cli_5023,Ns_7373);
                                            {9445}out(c, (enc(m2_7376,pkCli_7328),sign(h(m2_7376),skSess_6921)));
                                            {9446}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                            {9447}event endSrv(Cli_5023,Sess_5025,Nc_7372)
                            )
                            else
                                {9448}let pkDisco_7377: bitstring = fail-any in
                                {9449}in(c, (=pkCli_7328,em1_7378: bitstring,sigM1_7379: bitstring));
                                {9450}let m1_7380: bitstring = dec(em1_7378,skSess_6921) in
                                {9451}if (verify(h(m1_7380),sigM1_7379,pkCli_7328) <> true) then
                                    0
                                else
                                    {9452}let (=OpenSecureChannelRequest,=pkCli_7328,Nc_7381: bitstring) = m1_7380 in
                                    {9453}new Ns_7382: bitstring;
                                    {9454}new ST_7383: bitstring;
                                    {9455}new TTL_7384: bitstring;
                                    {9456}let m2_7385: bitstring = (OpenSecureChannelResponse,Ns_7382,ST_7383,TTL_7384) in
                                    {9457}event beginSrv(Sess_5025,Cli_5023,Ns_7382);
                                    {9458}out(c, (enc(m2_7385,pkCli_7328),sign(h(m2_7385),skSess_6921)));
                                    {9459}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                    {9460}event endSrv(Cli_5023,Sess_5025,Nc_7381)
                    )
                    else
                        {9461}let pkDisco_7386: bitstring = fail-any in
                        {9462}in(c, (=pkCli_7328,em1_7387: bitstring,sigM1_7388: bitstring));
                        {9463}let m1_7389: bitstring = dec(em1_7387,skSess_6921) in
                        {9464}if (verify(h(m1_7389),sigM1_7388,pkCli_7328) <> true) then
                            0
                        else
                            {9465}let (=OpenSecureChannelRequest,=pkCli_7328,Nc_7390: bitstring) = m1_7389 in
                            {9466}new Ns_7391: bitstring;
                            {9467}new ST_7392: bitstring;
                            {9468}new TTL_7393: bitstring;
                            {9469}let m2_7394: bitstring = (OpenSecureChannelResponse,Ns_7391,ST_7392,TTL_7393) in
                            {9470}event beginSrv(Sess_5025,Cli_5023,Ns_7391);
                            {9471}out(c, (enc(m2_7394,pkCli_7328),sign(h(m2_7394),skSess_6921)));
                            {9472}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                            {9473}event endSrv(Cli_5023,Sess_5025,Nc_7390)
    )
    else
        {9474}let skSess_7395: bitstring = fail-any in
        {9475}let pkSess_7396: bitstring = pub(skSess_7395) in
        {9476}let v_7397: bool = (Cli_5023 = A) in
        (
            {9477}if v_7397 then
            (
                {9478}let pkCli_7398: bitstring = pub(skA) in
                {9479}let v_7399: bool = (Disco_5024 = A) in
                (
                    {9480}if v_7399 then
                    (
                        {9481}let pkDisco_7400: bitstring = pub(skA) in
                        {9482}in(c, (=pkCli_7398,em1_7401: bitstring,sigM1_7402: bitstring));
                        {9483}let m1_7403: bitstring = dec(em1_7401,skSess_7395) in
                        {9484}if (verify(h(m1_7403),sigM1_7402,pkCli_7398) <> true) then
                            0
                        else
                            {9485}let (=OpenSecureChannelRequest,=pkCli_7398,Nc_7404: bitstring) = m1_7403 in
                            {9486}new Ns_7405: bitstring;
                            {9487}new ST_7406: bitstring;
                            {9488}new TTL_7407: bitstring;
                            {9489}let m2_7408: bitstring = (OpenSecureChannelResponse,Ns_7405,ST_7406,TTL_7407) in
                            {9490}event beginSrv(Sess_5025,Cli_5023,Ns_7405);
                            {9491}out(c, (enc(m2_7408,pkCli_7398),sign(h(m2_7408),skSess_7395)));
                            {9492}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                            {9493}event endSrv(Cli_5023,Sess_5025,Nc_7404)
                    )
                    else
                        {9494}let v_7409: bool = (Disco_5024 = B) in
                        (
                            {9495}if v_7409 then
                            (
                                {9496}let pkDisco_7410: bitstring = pub(skB) in
                                {9497}in(c, (=pkCli_7398,em1_7411: bitstring,sigM1_7412: bitstring));
                                {9498}let m1_7413: bitstring = dec(em1_7411,skSess_7395) in
                                {9499}if (verify(h(m1_7413),sigM1_7412,pkCli_7398) <> true) then
                                    0
                                else
                                    {9500}let (=OpenSecureChannelRequest,=pkCli_7398,Nc_7414: bitstring) = m1_7413 in
                                    {9501}new Ns_7415: bitstring;
                                    {9502}new ST_7416: bitstring;
                                    {9503}new TTL_7417: bitstring;
                                    {9504}let m2_7418: bitstring = (OpenSecureChannelResponse,Ns_7415,ST_7416,TTL_7417) in
                                    {9505}event beginSrv(Sess_5025,Cli_5023,Ns_7415);
                                    {9506}out(c, (enc(m2_7418,pkCli_7398),sign(h(m2_7418),skSess_7395)));
                                    {9507}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                    {9508}event endSrv(Cli_5023,Sess_5025,Nc_7414)
                            )
                            else
                                {9509}let v_7419: bool = (Disco_5024 = C) in
                                (
                                    {9510}if v_7419 then
                                    (
                                        {9511}let pkDisco_7420: bitstring = pub(skC) in
                                        {9512}in(c, (=pkCli_7398,em1_7421: bitstring,sigM1_7422: bitstring));
                                        {9513}let m1_7423: bitstring = dec(em1_7421,skSess_7395) in
                                        {9514}if (verify(h(m1_7423),sigM1_7422,pkCli_7398) <> true) then
                                            0
                                        else
                                            {9515}let (=OpenSecureChannelRequest,=pkCli_7398,Nc_7424: bitstring) = m1_7423 in
                                            {9516}new Ns_7425: bitstring;
                                            {9517}new ST_7426: bitstring;
                                            {9518}new TTL_7427: bitstring;
                                            {9519}let m2_7428: bitstring = (OpenSecureChannelResponse,Ns_7425,ST_7426,TTL_7427) in
                                            {9520}event beginSrv(Sess_5025,Cli_5023,Ns_7425);
                                            {9521}out(c, (enc(m2_7428,pkCli_7398),sign(h(m2_7428),skSess_7395)));
                                            {9522}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                            {9523}event endSrv(Cli_5023,Sess_5025,Nc_7424)
                                    )
                                    else
                                        {9524}let pkDisco_7429: bitstring = pub(sk(Disco_5024)) in
                                        {9525}in(c, (=pkCli_7398,em1_7430: bitstring,sigM1_7431: bitstring));
                                        {9526}let m1_7432: bitstring = dec(em1_7430,skSess_7395) in
                                        {9527}if (verify(h(m1_7432),sigM1_7431,pkCli_7398) <> true) then
                                            0
                                        else
                                            {9528}let (=OpenSecureChannelRequest,=pkCli_7398,Nc_7433: bitstring) = m1_7432 in
                                            {9529}new Ns_7434: bitstring;
                                            {9530}new ST_7435: bitstring;
                                            {9531}new TTL_7436: bitstring;
                                            {9532}let m2_7437: bitstring = (OpenSecureChannelResponse,Ns_7434,ST_7435,TTL_7436) in
                                            {9533}event beginSrv(Sess_5025,Cli_5023,Ns_7434);
                                            {9534}out(c, (enc(m2_7437,pkCli_7398),sign(h(m2_7437),skSess_7395)));
                                            {9535}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                            {9536}event endSrv(Cli_5023,Sess_5025,Nc_7433)
                                )
                                else
                                    {9537}let pkDisco_7438: bitstring = fail-any in
                                    {9538}in(c, (=pkCli_7398,em1_7439: bitstring,sigM1_7440: bitstring));
                                    {9539}let m1_7441: bitstring = dec(em1_7439,skSess_7395) in
                                    {9540}if (verify(h(m1_7441),sigM1_7440,pkCli_7398) <> true) then
                                        0
                                    else
                                        {9541}let (=OpenSecureChannelRequest,=pkCli_7398,Nc_7442: bitstring) = m1_7441 in
                                        {9542}new Ns_7443: bitstring;
                                        {9543}new ST_7444: bitstring;
                                        {9544}new TTL_7445: bitstring;
                                        {9545}let m2_7446: bitstring = (OpenSecureChannelResponse,Ns_7443,ST_7444,TTL_7445) in
                                        {9546}event beginSrv(Sess_5025,Cli_5023,Ns_7443);
                                        {9547}out(c, (enc(m2_7446,pkCli_7398),sign(h(m2_7446),skSess_7395)));
                                        {9548}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                        {9549}event endSrv(Cli_5023,Sess_5025,Nc_7442)
                        )
                        else
                            {9550}let pkDisco_7447: bitstring = fail-any in
                            {9551}in(c, (=pkCli_7398,em1_7448: bitstring,sigM1_7449: bitstring));
                            {9552}let m1_7450: bitstring = dec(em1_7448,skSess_7395) in
                            {9553}if (verify(h(m1_7450),sigM1_7449,pkCli_7398) <> true) then
                                0
                            else
                                {9554}let (=OpenSecureChannelRequest,=pkCli_7398,Nc_7451: bitstring) = m1_7450 in
                                {9555}new Ns_7452: bitstring;
                                {9556}new ST_7453: bitstring;
                                {9557}new TTL_7454: bitstring;
                                {9558}let m2_7455: bitstring = (OpenSecureChannelResponse,Ns_7452,ST_7453,TTL_7454) in
                                {9559}event beginSrv(Sess_5025,Cli_5023,Ns_7452);
                                {9560}out(c, (enc(m2_7455,pkCli_7398),sign(h(m2_7455),skSess_7395)));
                                {9561}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                {9562}event endSrv(Cli_5023,Sess_5025,Nc_7451)
                )
                else
                    {9563}let pkDisco_7456: bitstring = fail-any in
                    {9564}in(c, (=pkCli_7398,em1_7457: bitstring,sigM1_7458: bitstring));
                    {9565}let m1_7459: bitstring = dec(em1_7457,skSess_7395) in
                    {9566}if (verify(h(m1_7459),sigM1_7458,pkCli_7398) <> true) then
                        0
                    else
                        {9567}let (=OpenSecureChannelRequest,=pkCli_7398,Nc_7460: bitstring) = m1_7459 in
                        {9568}new Ns_7461: bitstring;
                        {9569}new ST_7462: bitstring;
                        {9570}new TTL_7463: bitstring;
                        {9571}let m2_7464: bitstring = (OpenSecureChannelResponse,Ns_7461,ST_7462,TTL_7463) in
                        {9572}event beginSrv(Sess_5025,Cli_5023,Ns_7461);
                        {9573}out(c, (enc(m2_7464,pkCli_7398),sign(h(m2_7464),skSess_7395)));
                        {9574}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                        {9575}event endSrv(Cli_5023,Sess_5025,Nc_7460)
            )
            else
                {9576}let v_7465: bool = (Cli_5023 = B) in
                (
                    {9577}if v_7465 then
                    (
                        {9578}let pkCli_7466: bitstring = pub(skB) in
                        {9579}let v_7467: bool = (Disco_5024 = A) in
                        (
                            {9580}if v_7467 then
                            (
                                {9581}let pkDisco_7468: bitstring = pub(skA) in
                                {9582}in(c, (=pkCli_7466,em1_7469: bitstring,sigM1_7470: bitstring));
                                {9583}let m1_7471: bitstring = dec(em1_7469,skSess_7395) in
                                {9584}if (verify(h(m1_7471),sigM1_7470,pkCli_7466) <> true) then
                                    0
                                else
                                    {9585}let (=OpenSecureChannelRequest,=pkCli_7466,Nc_7472: bitstring) = m1_7471 in
                                    {9586}new Ns_7473: bitstring;
                                    {9587}new ST_7474: bitstring;
                                    {9588}new TTL_7475: bitstring;
                                    {9589}let m2_7476: bitstring = (OpenSecureChannelResponse,Ns_7473,ST_7474,TTL_7475) in
                                    {9590}event beginSrv(Sess_5025,Cli_5023,Ns_7473);
                                    {9591}out(c, (enc(m2_7476,pkCli_7466),sign(h(m2_7476),skSess_7395)));
                                    {9592}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                    {9593}event endSrv(Cli_5023,Sess_5025,Nc_7472)
                            )
                            else
                                {9594}let v_7477: bool = (Disco_5024 = B) in
                                (
                                    {9595}if v_7477 then
                                    (
                                        {9596}let pkDisco_7478: bitstring = pub(skB) in
                                        {9597}in(c, (=pkCli_7466,em1_7479: bitstring,sigM1_7480: bitstring));
                                        {9598}let m1_7481: bitstring = dec(em1_7479,skSess_7395) in
                                        {9599}if (verify(h(m1_7481),sigM1_7480,pkCli_7466) <> true) then
                                            0
                                        else
                                            {9600}let (=OpenSecureChannelRequest,=pkCli_7466,Nc_7482: bitstring) = m1_7481 in
                                            {9601}new Ns_7483: bitstring;
                                            {9602}new ST_7484: bitstring;
                                            {9603}new TTL_7485: bitstring;
                                            {9604}let m2_7486: bitstring = (OpenSecureChannelResponse,Ns_7483,ST_7484,TTL_7485) in
                                            {9605}event beginSrv(Sess_5025,Cli_5023,Ns_7483);
                                            {9606}out(c, (enc(m2_7486,pkCli_7466),sign(h(m2_7486),skSess_7395)));
                                            {9607}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                            {9608}event endSrv(Cli_5023,Sess_5025,Nc_7482)
                                    )
                                    else
                                        {9609}let v_7487: bool = (Disco_5024 = C) in
                                        (
                                            {9610}if v_7487 then
                                            (
                                                {9611}let pkDisco_7488: bitstring = pub(skC) in
                                                {9612}in(c, (=pkCli_7466,em1_7489: bitstring,sigM1_7490: bitstring));
                                                {9613}let m1_7491: bitstring = dec(em1_7489,skSess_7395) in
                                                {9614}if (verify(h(m1_7491),sigM1_7490,pkCli_7466) <> true) then
                                                    0
                                                else
                                                    {9615}let (=OpenSecureChannelRequest,=pkCli_7466,Nc_7492: bitstring) = m1_7491 in
                                                    {9616}new Ns_7493: bitstring;
                                                    {9617}new ST_7494: bitstring;
                                                    {9618}new TTL_7495: bitstring;
                                                    {9619}let m2_7496: bitstring = (OpenSecureChannelResponse,Ns_7493,ST_7494,TTL_7495) in
                                                    {9620}event beginSrv(Sess_5025,Cli_5023,Ns_7493);
                                                    {9621}out(c, (enc(m2_7496,pkCli_7466),sign(h(m2_7496),skSess_7395)));
                                                    {9622}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                    {9623}event endSrv(Cli_5023,Sess_5025,Nc_7492)
                                            )
                                            else
                                                {9624}let pkDisco_7497: bitstring = pub(sk(Disco_5024)) in
                                                {9625}in(c, (=pkCli_7466,em1_7498: bitstring,sigM1_7499: bitstring));
                                                {9626}let m1_7500: bitstring = dec(em1_7498,skSess_7395) in
                                                {9627}if (verify(h(m1_7500),sigM1_7499,pkCli_7466) <> true) then
                                                    0
                                                else
                                                    {9628}let (=OpenSecureChannelRequest,=pkCli_7466,Nc_7501: bitstring) = m1_7500 in
                                                    {9629}new Ns_7502: bitstring;
                                                    {9630}new ST_7503: bitstring;
                                                    {9631}new TTL_7504: bitstring;
                                                    {9632}let m2_7505: bitstring = (OpenSecureChannelResponse,Ns_7502,ST_7503,TTL_7504) in
                                                    {9633}event beginSrv(Sess_5025,Cli_5023,Ns_7502);
                                                    {9634}out(c, (enc(m2_7505,pkCli_7466),sign(h(m2_7505),skSess_7395)));
                                                    {9635}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                    {9636}event endSrv(Cli_5023,Sess_5025,Nc_7501)
                                        )
                                        else
                                            {9637}let pkDisco_7506: bitstring = fail-any in
                                            {9638}in(c, (=pkCli_7466,em1_7507: bitstring,sigM1_7508: bitstring));
                                            {9639}let m1_7509: bitstring = dec(em1_7507,skSess_7395) in
                                            {9640}if (verify(h(m1_7509),sigM1_7508,pkCli_7466) <> true) then
                                                0
                                            else
                                                {9641}let (=OpenSecureChannelRequest,=pkCli_7466,Nc_7510: bitstring) = m1_7509 in
                                                {9642}new Ns_7511: bitstring;
                                                {9643}new ST_7512: bitstring;
                                                {9644}new TTL_7513: bitstring;
                                                {9645}let m2_7514: bitstring = (OpenSecureChannelResponse,Ns_7511,ST_7512,TTL_7513) in
                                                {9646}event beginSrv(Sess_5025,Cli_5023,Ns_7511);
                                                {9647}out(c, (enc(m2_7514,pkCli_7466),sign(h(m2_7514),skSess_7395)));
                                                {9648}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                {9649}event endSrv(Cli_5023,Sess_5025,Nc_7510)
                                )
                                else
                                    {9650}let pkDisco_7515: bitstring = fail-any in
                                    {9651}in(c, (=pkCli_7466,em1_7516: bitstring,sigM1_7517: bitstring));
                                    {9652}let m1_7518: bitstring = dec(em1_7516,skSess_7395) in
                                    {9653}if (verify(h(m1_7518),sigM1_7517,pkCli_7466) <> true) then
                                        0
                                    else
                                        {9654}let (=OpenSecureChannelRequest,=pkCli_7466,Nc_7519: bitstring) = m1_7518 in
                                        {9655}new Ns_7520: bitstring;
                                        {9656}new ST_7521: bitstring;
                                        {9657}new TTL_7522: bitstring;
                                        {9658}let m2_7523: bitstring = (OpenSecureChannelResponse,Ns_7520,ST_7521,TTL_7522) in
                                        {9659}event beginSrv(Sess_5025,Cli_5023,Ns_7520);
                                        {9660}out(c, (enc(m2_7523,pkCli_7466),sign(h(m2_7523),skSess_7395)));
                                        {9661}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                        {9662}event endSrv(Cli_5023,Sess_5025,Nc_7519)
                        )
                        else
                            {9663}let pkDisco_7524: bitstring = fail-any in
                            {9664}in(c, (=pkCli_7466,em1_7525: bitstring,sigM1_7526: bitstring));
                            {9665}let m1_7527: bitstring = dec(em1_7525,skSess_7395) in
                            {9666}if (verify(h(m1_7527),sigM1_7526,pkCli_7466) <> true) then
                                0
                            else
                                {9667}let (=OpenSecureChannelRequest,=pkCli_7466,Nc_7528: bitstring) = m1_7527 in
                                {9668}new Ns_7529: bitstring;
                                {9669}new ST_7530: bitstring;
                                {9670}new TTL_7531: bitstring;
                                {9671}let m2_7532: bitstring = (OpenSecureChannelResponse,Ns_7529,ST_7530,TTL_7531) in
                                {9672}event beginSrv(Sess_5025,Cli_5023,Ns_7529);
                                {9673}out(c, (enc(m2_7532,pkCli_7466),sign(h(m2_7532),skSess_7395)));
                                {9674}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                {9675}event endSrv(Cli_5023,Sess_5025,Nc_7528)
                    )
                    else
                        {9676}let v_7533: bool = (Cli_5023 = C) in
                        (
                            {9677}if v_7533 then
                            (
                                {9678}let pkCli_7534: bitstring = pub(skC) in
                                {9679}let v_7535: bool = (Disco_5024 = A) in
                                (
                                    {9680}if v_7535 then
                                    (
                                        {9681}let pkDisco_7536: bitstring = pub(skA) in
                                        {9682}in(c, (=pkCli_7534,em1_7537: bitstring,sigM1_7538: bitstring));
                                        {9683}let m1_7539: bitstring = dec(em1_7537,skSess_7395) in
                                        {9684}if (verify(h(m1_7539),sigM1_7538,pkCli_7534) <> true) then
                                            0
                                        else
                                            {9685}let (=OpenSecureChannelRequest,=pkCli_7534,Nc_7540: bitstring) = m1_7539 in
                                            {9686}new Ns_7541: bitstring;
                                            {9687}new ST_7542: bitstring;
                                            {9688}new TTL_7543: bitstring;
                                            {9689}let m2_7544: bitstring = (OpenSecureChannelResponse,Ns_7541,ST_7542,TTL_7543) in
                                            {9690}event beginSrv(Sess_5025,Cli_5023,Ns_7541);
                                            {9691}out(c, (enc(m2_7544,pkCli_7534),sign(h(m2_7544),skSess_7395)));
                                            {9692}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                            {9693}event endSrv(Cli_5023,Sess_5025,Nc_7540)
                                    )
                                    else
                                        {9694}let v_7545: bool = (Disco_5024 = B) in
                                        (
                                            {9695}if v_7545 then
                                            (
                                                {9696}let pkDisco_7546: bitstring = pub(skB) in
                                                {9697}in(c, (=pkCli_7534,em1_7547: bitstring,sigM1_7548: bitstring));
                                                {9698}let m1_7549: bitstring = dec(em1_7547,skSess_7395) in
                                                {9699}if (verify(h(m1_7549),sigM1_7548,pkCli_7534) <> true) then
                                                    0
                                                else
                                                    {9700}let (=OpenSecureChannelRequest,=pkCli_7534,Nc_7550: bitstring) = m1_7549 in
                                                    {9701}new Ns_7551: bitstring;
                                                    {9702}new ST_7552: bitstring;
                                                    {9703}new TTL_7553: bitstring;
                                                    {9704}let m2_7554: bitstring = (OpenSecureChannelResponse,Ns_7551,ST_7552,TTL_7553) in
                                                    {9705}event beginSrv(Sess_5025,Cli_5023,Ns_7551);
                                                    {9706}out(c, (enc(m2_7554,pkCli_7534),sign(h(m2_7554),skSess_7395)));
                                                    {9707}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                    {9708}event endSrv(Cli_5023,Sess_5025,Nc_7550)
                                            )
                                            else
                                                {9709}let v_7555: bool = (Disco_5024 = C) in
                                                (
                                                    {9710}if v_7555 then
                                                    (
                                                        {9711}let pkDisco_7556: bitstring = pub(skC) in
                                                        {9712}in(c, (=pkCli_7534,em1_7557: bitstring,sigM1_7558: bitstring));
                                                        {9713}let m1_7559: bitstring = dec(em1_7557,skSess_7395) in
                                                        {9714}if (verify(h(m1_7559),sigM1_7558,pkCli_7534) <> true) then
                                                            0
                                                        else
                                                            {9715}let (=OpenSecureChannelRequest,=pkCli_7534,Nc_7560: bitstring) = m1_7559 in
                                                            {9716}new Ns_7561: bitstring;
                                                            {9717}new ST_7562: bitstring;
                                                            {9718}new TTL_7563: bitstring;
                                                            {9719}let m2_7564: bitstring = (OpenSecureChannelResponse,Ns_7561,ST_7562,TTL_7563) in
                                                            {9720}event beginSrv(Sess_5025,Cli_5023,Ns_7561);
                                                            {9721}out(c, (enc(m2_7564,pkCli_7534),sign(h(m2_7564),skSess_7395)));
                                                            {9722}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                            {9723}event endSrv(Cli_5023,Sess_5025,Nc_7560)
                                                    )
                                                    else
                                                        {9724}let pkDisco_7565: bitstring = pub(sk(Disco_5024)) in
                                                        {9725}in(c, (=pkCli_7534,em1_7566: bitstring,sigM1_7567: bitstring));
                                                        {9726}let m1_7568: bitstring = dec(em1_7566,skSess_7395) in
                                                        {9727}if (verify(h(m1_7568),sigM1_7567,pkCli_7534) <> true) then
                                                            0
                                                        else
                                                            {9728}let (=OpenSecureChannelRequest,=pkCli_7534,Nc_7569: bitstring) = m1_7568 in
                                                            {9729}new Ns_7570: bitstring;
                                                            {9730}new ST_7571: bitstring;
                                                            {9731}new TTL_7572: bitstring;
                                                            {9732}let m2_7573: bitstring = (OpenSecureChannelResponse,Ns_7570,ST_7571,TTL_7572) in
                                                            {9733}event beginSrv(Sess_5025,Cli_5023,Ns_7570);
                                                            {9734}out(c, (enc(m2_7573,pkCli_7534),sign(h(m2_7573),skSess_7395)));
                                                            {9735}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                            {9736}event endSrv(Cli_5023,Sess_5025,Nc_7569)
                                                )
                                                else
                                                    {9737}let pkDisco_7574: bitstring = fail-any in
                                                    {9738}in(c, (=pkCli_7534,em1_7575: bitstring,sigM1_7576: bitstring));
                                                    {9739}let m1_7577: bitstring = dec(em1_7575,skSess_7395) in
                                                    {9740}if (verify(h(m1_7577),sigM1_7576,pkCli_7534) <> true) then
                                                        0
                                                    else
                                                        {9741}let (=OpenSecureChannelRequest,=pkCli_7534,Nc_7578: bitstring) = m1_7577 in
                                                        {9742}new Ns_7579: bitstring;
                                                        {9743}new ST_7580: bitstring;
                                                        {9744}new TTL_7581: bitstring;
                                                        {9745}let m2_7582: bitstring = (OpenSecureChannelResponse,Ns_7579,ST_7580,TTL_7581) in
                                                        {9746}event beginSrv(Sess_5025,Cli_5023,Ns_7579);
                                                        {9747}out(c, (enc(m2_7582,pkCli_7534),sign(h(m2_7582),skSess_7395)));
                                                        {9748}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                        {9749}event endSrv(Cli_5023,Sess_5025,Nc_7578)
                                        )
                                        else
                                            {9750}let pkDisco_7583: bitstring = fail-any in
                                            {9751}in(c, (=pkCli_7534,em1_7584: bitstring,sigM1_7585: bitstring));
                                            {9752}let m1_7586: bitstring = dec(em1_7584,skSess_7395) in
                                            {9753}if (verify(h(m1_7586),sigM1_7585,pkCli_7534) <> true) then
                                                0
                                            else
                                                {9754}let (=OpenSecureChannelRequest,=pkCli_7534,Nc_7587: bitstring) = m1_7586 in
                                                {9755}new Ns_7588: bitstring;
                                                {9756}new ST_7589: bitstring;
                                                {9757}new TTL_7590: bitstring;
                                                {9758}let m2_7591: bitstring = (OpenSecureChannelResponse,Ns_7588,ST_7589,TTL_7590) in
                                                {9759}event beginSrv(Sess_5025,Cli_5023,Ns_7588);
                                                {9760}out(c, (enc(m2_7591,pkCli_7534),sign(h(m2_7591),skSess_7395)));
                                                {9761}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                {9762}event endSrv(Cli_5023,Sess_5025,Nc_7587)
                                )
                                else
                                    {9763}let pkDisco_7592: bitstring = fail-any in
                                    {9764}in(c, (=pkCli_7534,em1_7593: bitstring,sigM1_7594: bitstring));
                                    {9765}let m1_7595: bitstring = dec(em1_7593,skSess_7395) in
                                    {9766}if (verify(h(m1_7595),sigM1_7594,pkCli_7534) <> true) then
                                        0
                                    else
                                        {9767}let (=OpenSecureChannelRequest,=pkCli_7534,Nc_7596: bitstring) = m1_7595 in
                                        {9768}new Ns_7597: bitstring;
                                        {9769}new ST_7598: bitstring;
                                        {9770}new TTL_7599: bitstring;
                                        {9771}let m2_7600: bitstring = (OpenSecureChannelResponse,Ns_7597,ST_7598,TTL_7599) in
                                        {9772}event beginSrv(Sess_5025,Cli_5023,Ns_7597);
                                        {9773}out(c, (enc(m2_7600,pkCli_7534),sign(h(m2_7600),skSess_7395)));
                                        {9774}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                        {9775}event endSrv(Cli_5023,Sess_5025,Nc_7596)
                            )
                            else
                                {9776}let pkCli_7601: bitstring = pub(sk(Cli_5023)) in
                                {9777}let v_7602: bool = (Disco_5024 = A) in
                                (
                                    {9778}if v_7602 then
                                    (
                                        {9779}let pkDisco_7603: bitstring = pub(skA) in
                                        {9780}in(c, (=pkCli_7601,em1_7604: bitstring,sigM1_7605: bitstring));
                                        {9781}let m1_7606: bitstring = dec(em1_7604,skSess_7395) in
                                        {9782}if (verify(h(m1_7606),sigM1_7605,pkCli_7601) <> true) then
                                            0
                                        else
                                            {9783}let (=OpenSecureChannelRequest,=pkCli_7601,Nc_7607: bitstring) = m1_7606 in
                                            {9784}new Ns_7608: bitstring;
                                            {9785}new ST_7609: bitstring;
                                            {9786}new TTL_7610: bitstring;
                                            {9787}let m2_7611: bitstring = (OpenSecureChannelResponse,Ns_7608,ST_7609,TTL_7610) in
                                            {9788}event beginSrv(Sess_5025,Cli_5023,Ns_7608);
                                            {9789}out(c, (enc(m2_7611,pkCli_7601),sign(h(m2_7611),skSess_7395)));
                                            {9790}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                            {9791}event endSrv(Cli_5023,Sess_5025,Nc_7607)
                                    )
                                    else
                                        {9792}let v_7612: bool = (Disco_5024 = B) in
                                        (
                                            {9793}if v_7612 then
                                            (
                                                {9794}let pkDisco_7613: bitstring = pub(skB) in
                                                {9795}in(c, (=pkCli_7601,em1_7614: bitstring,sigM1_7615: bitstring));
                                                {9796}let m1_7616: bitstring = dec(em1_7614,skSess_7395) in
                                                {9797}if (verify(h(m1_7616),sigM1_7615,pkCli_7601) <> true) then
                                                    0
                                                else
                                                    {9798}let (=OpenSecureChannelRequest,=pkCli_7601,Nc_7617: bitstring) = m1_7616 in
                                                    {9799}new Ns_7618: bitstring;
                                                    {9800}new ST_7619: bitstring;
                                                    {9801}new TTL_7620: bitstring;
                                                    {9802}let m2_7621: bitstring = (OpenSecureChannelResponse,Ns_7618,ST_7619,TTL_7620) in
                                                    {9803}event beginSrv(Sess_5025,Cli_5023,Ns_7618);
                                                    {9804}out(c, (enc(m2_7621,pkCli_7601),sign(h(m2_7621),skSess_7395)));
                                                    {9805}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                    {9806}event endSrv(Cli_5023,Sess_5025,Nc_7617)
                                            )
                                            else
                                                {9807}let v_7622: bool = (Disco_5024 = C) in
                                                (
                                                    {9808}if v_7622 then
                                                    (
                                                        {9809}let pkDisco_7623: bitstring = pub(skC) in
                                                        {9810}in(c, (=pkCli_7601,em1_7624: bitstring,sigM1_7625: bitstring));
                                                        {9811}let m1_7626: bitstring = dec(em1_7624,skSess_7395) in
                                                        {9812}if (verify(h(m1_7626),sigM1_7625,pkCli_7601) <> true) then
                                                            0
                                                        else
                                                            {9813}let (=OpenSecureChannelRequest,=pkCli_7601,Nc_7627: bitstring) = m1_7626 in
                                                            {9814}new Ns_7628: bitstring;
                                                            {9815}new ST_7629: bitstring;
                                                            {9816}new TTL_7630: bitstring;
                                                            {9817}let m2_7631: bitstring = (OpenSecureChannelResponse,Ns_7628,ST_7629,TTL_7630) in
                                                            {9818}event beginSrv(Sess_5025,Cli_5023,Ns_7628);
                                                            {9819}out(c, (enc(m2_7631,pkCli_7601),sign(h(m2_7631),skSess_7395)));
                                                            {9820}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                            {9821}event endSrv(Cli_5023,Sess_5025,Nc_7627)
                                                    )
                                                    else
                                                        {9822}let pkDisco_7632: bitstring = pub(sk(Disco_5024)) in
                                                        {9823}in(c, (=pkCli_7601,em1_7633: bitstring,sigM1_7634: bitstring));
                                                        {9824}let m1_7635: bitstring = dec(em1_7633,skSess_7395) in
                                                        {9825}if (verify(h(m1_7635),sigM1_7634,pkCli_7601) <> true) then
                                                            0
                                                        else
                                                            {9826}let (=OpenSecureChannelRequest,=pkCli_7601,Nc_7636: bitstring) = m1_7635 in
                                                            {9827}new Ns_7637: bitstring;
                                                            {9828}new ST_7638: bitstring;
                                                            {9829}new TTL_7639: bitstring;
                                                            {9830}let m2_7640: bitstring = (OpenSecureChannelResponse,Ns_7637,ST_7638,TTL_7639) in
                                                            {9831}event beginSrv(Sess_5025,Cli_5023,Ns_7637);
                                                            {9832}out(c, (enc(m2_7640,pkCli_7601),sign(h(m2_7640),skSess_7395)));
                                                            {9833}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                            {9834}event endSrv(Cli_5023,Sess_5025,Nc_7636)
                                                )
                                                else
                                                    {9835}let pkDisco_7641: bitstring = fail-any in
                                                    {9836}in(c, (=pkCli_7601,em1_7642: bitstring,sigM1_7643: bitstring));
                                                    {9837}let m1_7644: bitstring = dec(em1_7642,skSess_7395) in
                                                    {9838}if (verify(h(m1_7644),sigM1_7643,pkCli_7601) <> true) then
                                                        0
                                                    else
                                                        {9839}let (=OpenSecureChannelRequest,=pkCli_7601,Nc_7645: bitstring) = m1_7644 in
                                                        {9840}new Ns_7646: bitstring;
                                                        {9841}new ST_7647: bitstring;
                                                        {9842}new TTL_7648: bitstring;
                                                        {9843}let m2_7649: bitstring = (OpenSecureChannelResponse,Ns_7646,ST_7647,TTL_7648) in
                                                        {9844}event beginSrv(Sess_5025,Cli_5023,Ns_7646);
                                                        {9845}out(c, (enc(m2_7649,pkCli_7601),sign(h(m2_7649),skSess_7395)));
                                                        {9846}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                        {9847}event endSrv(Cli_5023,Sess_5025,Nc_7645)
                                        )
                                        else
                                            {9848}let pkDisco_7650: bitstring = fail-any in
                                            {9849}in(c, (=pkCli_7601,em1_7651: bitstring,sigM1_7652: bitstring));
                                            {9850}let m1_7653: bitstring = dec(em1_7651,skSess_7395) in
                                            {9851}if (verify(h(m1_7653),sigM1_7652,pkCli_7601) <> true) then
                                                0
                                            else
                                                {9852}let (=OpenSecureChannelRequest,=pkCli_7601,Nc_7654: bitstring) = m1_7653 in
                                                {9853}new Ns_7655: bitstring;
                                                {9854}new ST_7656: bitstring;
                                                {9855}new TTL_7657: bitstring;
                                                {9856}let m2_7658: bitstring = (OpenSecureChannelResponse,Ns_7655,ST_7656,TTL_7657) in
                                                {9857}event beginSrv(Sess_5025,Cli_5023,Ns_7655);
                                                {9858}out(c, (enc(m2_7658,pkCli_7601),sign(h(m2_7658),skSess_7395)));
                                                {9859}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                {9860}event endSrv(Cli_5023,Sess_5025,Nc_7654)
                                )
                                else
                                    {9861}let pkDisco_7659: bitstring = fail-any in
                                    {9862}in(c, (=pkCli_7601,em1_7660: bitstring,sigM1_7661: bitstring));
                                    {9863}let m1_7662: bitstring = dec(em1_7660,skSess_7395) in
                                    {9864}if (verify(h(m1_7662),sigM1_7661,pkCli_7601) <> true) then
                                        0
                                    else
                                        {9865}let (=OpenSecureChannelRequest,=pkCli_7601,Nc_7663: bitstring) = m1_7662 in
                                        {9866}new Ns_7664: bitstring;
                                        {9867}new ST_7665: bitstring;
                                        {9868}new TTL_7666: bitstring;
                                        {9869}let m2_7667: bitstring = (OpenSecureChannelResponse,Ns_7664,ST_7665,TTL_7666) in
                                        {9870}event beginSrv(Sess_5025,Cli_5023,Ns_7664);
                                        {9871}out(c, (enc(m2_7667,pkCli_7601),sign(h(m2_7667),skSess_7395)));
                                        {9872}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                        {9873}event endSrv(Cli_5023,Sess_5025,Nc_7663)
                        )
                        else
                            {9874}let pkCli_7668: bitstring = fail-any in
                            {9875}let v_7669: bool = (Disco_5024 = A) in
                            (
                                {9876}if v_7669 then
                                (
                                    {9877}let pkDisco_7670: bitstring = pub(skA) in
                                    {9878}in(c, (=pkCli_7668,em1_7671: bitstring,sigM1_7672: bitstring));
                                    {9879}let m1_7673: bitstring = dec(em1_7671,skSess_7395) in
                                    {9880}if (verify(h(m1_7673),sigM1_7672,pkCli_7668) <> true) then
                                        0
                                    else
                                        {9881}let (=OpenSecureChannelRequest,=pkCli_7668,Nc_7674: bitstring) = m1_7673 in
                                        {9882}new Ns_7675: bitstring;
                                        {9883}new ST_7676: bitstring;
                                        {9884}new TTL_7677: bitstring;
                                        {9885}let m2_7678: bitstring = (OpenSecureChannelResponse,Ns_7675,ST_7676,TTL_7677) in
                                        {9886}event beginSrv(Sess_5025,Cli_5023,Ns_7675);
                                        {9887}out(c, (enc(m2_7678,pkCli_7668),sign(h(m2_7678),skSess_7395)));
                                        {9888}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                        {9889}event endSrv(Cli_5023,Sess_5025,Nc_7674)
                                )
                                else
                                    {9890}let v_7679: bool = (Disco_5024 = B) in
                                    (
                                        {9891}if v_7679 then
                                        (
                                            {9892}let pkDisco_7680: bitstring = pub(skB) in
                                            {9893}in(c, (=pkCli_7668,em1_7681: bitstring,sigM1_7682: bitstring));
                                            {9894}let m1_7683: bitstring = dec(em1_7681,skSess_7395) in
                                            {9895}if (verify(h(m1_7683),sigM1_7682,pkCli_7668) <> true) then
                                                0
                                            else
                                                {9896}let (=OpenSecureChannelRequest,=pkCli_7668,Nc_7684: bitstring) = m1_7683 in
                                                {9897}new Ns_7685: bitstring;
                                                {9898}new ST_7686: bitstring;
                                                {9899}new TTL_7687: bitstring;
                                                {9900}let m2_7688: bitstring = (OpenSecureChannelResponse,Ns_7685,ST_7686,TTL_7687) in
                                                {9901}event beginSrv(Sess_5025,Cli_5023,Ns_7685);
                                                {9902}out(c, (enc(m2_7688,pkCli_7668),sign(h(m2_7688),skSess_7395)));
                                                {9903}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                {9904}event endSrv(Cli_5023,Sess_5025,Nc_7684)
                                        )
                                        else
                                            {9905}let v_7689: bool = (Disco_5024 = C) in
                                            (
                                                {9906}if v_7689 then
                                                (
                                                    {9907}let pkDisco_7690: bitstring = pub(skC) in
                                                    {9908}in(c, (=pkCli_7668,em1_7691: bitstring,sigM1_7692: bitstring));
                                                    {9909}let m1_7693: bitstring = dec(em1_7691,skSess_7395) in
                                                    {9910}if (verify(h(m1_7693),sigM1_7692,pkCli_7668) <> true) then
                                                        0
                                                    else
                                                        {9911}let (=OpenSecureChannelRequest,=pkCli_7668,Nc_7694: bitstring) = m1_7693 in
                                                        {9912}new Ns_7695: bitstring;
                                                        {9913}new ST_7696: bitstring;
                                                        {9914}new TTL_7697: bitstring;
                                                        {9915}let m2_7698: bitstring = (OpenSecureChannelResponse,Ns_7695,ST_7696,TTL_7697) in
                                                        {9916}event beginSrv(Sess_5025,Cli_5023,Ns_7695);
                                                        {9917}out(c, (enc(m2_7698,pkCli_7668),sign(h(m2_7698),skSess_7395)));
                                                        {9918}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                        {9919}event endSrv(Cli_5023,Sess_5025,Nc_7694)
                                                )
                                                else
                                                    {9920}let pkDisco_7699: bitstring = pub(sk(Disco_5024)) in
                                                    {9921}in(c, (=pkCli_7668,em1_7700: bitstring,sigM1_7701: bitstring));
                                                    {9922}let m1_7702: bitstring = dec(em1_7700,skSess_7395) in
                                                    {9923}if (verify(h(m1_7702),sigM1_7701,pkCli_7668) <> true) then
                                                        0
                                                    else
                                                        {9924}let (=OpenSecureChannelRequest,=pkCli_7668,Nc_7703: bitstring) = m1_7702 in
                                                        {9925}new Ns_7704: bitstring;
                                                        {9926}new ST_7705: bitstring;
                                                        {9927}new TTL_7706: bitstring;
                                                        {9928}let m2_7707: bitstring = (OpenSecureChannelResponse,Ns_7704,ST_7705,TTL_7706) in
                                                        {9929}event beginSrv(Sess_5025,Cli_5023,Ns_7704);
                                                        {9930}out(c, (enc(m2_7707,pkCli_7668),sign(h(m2_7707),skSess_7395)));
                                                        {9931}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                        {9932}event endSrv(Cli_5023,Sess_5025,Nc_7703)
                                            )
                                            else
                                                {9933}let pkDisco_7708: bitstring = fail-any in
                                                {9934}in(c, (=pkCli_7668,em1_7709: bitstring,sigM1_7710: bitstring));
                                                {9935}let m1_7711: bitstring = dec(em1_7709,skSess_7395) in
                                                {9936}if (verify(h(m1_7711),sigM1_7710,pkCli_7668) <> true) then
                                                    0
                                                else
                                                    {9937}let (=OpenSecureChannelRequest,=pkCli_7668,Nc_7712: bitstring) = m1_7711 in
                                                    {9938}new Ns_7713: bitstring;
                                                    {9939}new ST_7714: bitstring;
                                                    {9940}new TTL_7715: bitstring;
                                                    {9941}let m2_7716: bitstring = (OpenSecureChannelResponse,Ns_7713,ST_7714,TTL_7715) in
                                                    {9942}event beginSrv(Sess_5025,Cli_5023,Ns_7713);
                                                    {9943}out(c, (enc(m2_7716,pkCli_7668),sign(h(m2_7716),skSess_7395)));
                                                    {9944}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                    {9945}event endSrv(Cli_5023,Sess_5025,Nc_7712)
                                    )
                                    else
                                        {9946}let pkDisco_7717: bitstring = fail-any in
                                        {9947}in(c, (=pkCli_7668,em1_7718: bitstring,sigM1_7719: bitstring));
                                        {9948}let m1_7720: bitstring = dec(em1_7718,skSess_7395) in
                                        {9949}if (verify(h(m1_7720),sigM1_7719,pkCli_7668) <> true) then
                                            0
                                        else
                                            {9950}let (=OpenSecureChannelRequest,=pkCli_7668,Nc_7721: bitstring) = m1_7720 in
                                            {9951}new Ns_7722: bitstring;
                                            {9952}new ST_7723: bitstring;
                                            {9953}new TTL_7724: bitstring;
                                            {9954}let m2_7725: bitstring = (OpenSecureChannelResponse,Ns_7722,ST_7723,TTL_7724) in
                                            {9955}event beginSrv(Sess_5025,Cli_5023,Ns_7722);
                                            {9956}out(c, (enc(m2_7725,pkCli_7668),sign(h(m2_7725),skSess_7395)));
                                            {9957}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                            {9958}event endSrv(Cli_5023,Sess_5025,Nc_7721)
                            )
                            else
                                {9959}let pkDisco_7726: bitstring = fail-any in
                                {9960}in(c, (=pkCli_7668,em1_7727: bitstring,sigM1_7728: bitstring));
                                {9961}let m1_7729: bitstring = dec(em1_7727,skSess_7395) in
                                {9962}if (verify(h(m1_7729),sigM1_7728,pkCli_7668) <> true) then
                                    0
                                else
                                    {9963}let (=OpenSecureChannelRequest,=pkCli_7668,Nc_7730: bitstring) = m1_7729 in
                                    {9964}new Ns_7731: bitstring;
                                    {9965}new ST_7732: bitstring;
                                    {9966}new TTL_7733: bitstring;
                                    {9967}let m2_7734: bitstring = (OpenSecureChannelResponse,Ns_7731,ST_7732,TTL_7733) in
                                    {9968}event beginSrv(Sess_5025,Cli_5023,Ns_7731);
                                    {9969}out(c, (enc(m2_7734,pkCli_7668),sign(h(m2_7734),skSess_7395)));
                                    {9970}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                    {9971}event endSrv(Cli_5023,Sess_5025,Nc_7730)
                )
                else
                    {9972}let pkCli_7735: bitstring = fail-any in
                    {9973}let v_7736: bool = (Disco_5024 = A) in
                    (
                        {9974}if v_7736 then
                        (
                            {9975}let pkDisco_7737: bitstring = pub(skA) in
                            {9976}in(c, (=pkCli_7735,em1_7738: bitstring,sigM1_7739: bitstring));
                            {9977}let m1_7740: bitstring = dec(em1_7738,skSess_7395) in
                            {9978}if (verify(h(m1_7740),sigM1_7739,pkCli_7735) <> true) then
                                0
                            else
                                {9979}let (=OpenSecureChannelRequest,=pkCli_7735,Nc_7741: bitstring) = m1_7740 in
                                {9980}new Ns_7742: bitstring;
                                {9981}new ST_7743: bitstring;
                                {9982}new TTL_7744: bitstring;
                                {9983}let m2_7745: bitstring = (OpenSecureChannelResponse,Ns_7742,ST_7743,TTL_7744) in
                                {9984}event beginSrv(Sess_5025,Cli_5023,Ns_7742);
                                {9985}out(c, (enc(m2_7745,pkCli_7735),sign(h(m2_7745),skSess_7395)));
                                {9986}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                {9987}event endSrv(Cli_5023,Sess_5025,Nc_7741)
                        )
                        else
                            {9988}let v_7746: bool = (Disco_5024 = B) in
                            (
                                {9989}if v_7746 then
                                (
                                    {9990}let pkDisco_7747: bitstring = pub(skB) in
                                    {9991}in(c, (=pkCli_7735,em1_7748: bitstring,sigM1_7749: bitstring));
                                    {9992}let m1_7750: bitstring = dec(em1_7748,skSess_7395) in
                                    {9993}if (verify(h(m1_7750),sigM1_7749,pkCli_7735) <> true) then
                                        0
                                    else
                                        {9994}let (=OpenSecureChannelRequest,=pkCli_7735,Nc_7751: bitstring) = m1_7750 in
                                        {9995}new Ns_7752: bitstring;
                                        {9996}new ST_7753: bitstring;
                                        {9997}new TTL_7754: bitstring;
                                        {9998}let m2_7755: bitstring = (OpenSecureChannelResponse,Ns_7752,ST_7753,TTL_7754) in
                                        {9999}event beginSrv(Sess_5025,Cli_5023,Ns_7752);
                                        {10000}out(c, (enc(m2_7755,pkCli_7735),sign(h(m2_7755),skSess_7395)));
                                        {10001}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                        {10002}event endSrv(Cli_5023,Sess_5025,Nc_7751)
                                )
                                else
                                    {10003}let v_7756: bool = (Disco_5024 = C) in
                                    (
                                        {10004}if v_7756 then
                                        (
                                            {10005}let pkDisco_7757: bitstring = pub(skC) in
                                            {10006}in(c, (=pkCli_7735,em1_7758: bitstring,sigM1_7759: bitstring));
                                            {10007}let m1_7760: bitstring = dec(em1_7758,skSess_7395) in
                                            {10008}if (verify(h(m1_7760),sigM1_7759,pkCli_7735) <> true) then
                                                0
                                            else
                                                {10009}let (=OpenSecureChannelRequest,=pkCli_7735,Nc_7761: bitstring) = m1_7760 in
                                                {10010}new Ns_7762: bitstring;
                                                {10011}new ST_7763: bitstring;
                                                {10012}new TTL_7764: bitstring;
                                                {10013}let m2_7765: bitstring = (OpenSecureChannelResponse,Ns_7762,ST_7763,TTL_7764) in
                                                {10014}event beginSrv(Sess_5025,Cli_5023,Ns_7762);
                                                {10015}out(c, (enc(m2_7765,pkCli_7735),sign(h(m2_7765),skSess_7395)));
                                                {10016}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                {10017}event endSrv(Cli_5023,Sess_5025,Nc_7761)
                                        )
                                        else
                                            {10018}let pkDisco_7766: bitstring = pub(sk(Disco_5024)) in
                                            {10019}in(c, (=pkCli_7735,em1_7767: bitstring,sigM1_7768: bitstring));
                                            {10020}let m1_7769: bitstring = dec(em1_7767,skSess_7395) in
                                            {10021}if (verify(h(m1_7769),sigM1_7768,pkCli_7735) <> true) then
                                                0
                                            else
                                                {10022}let (=OpenSecureChannelRequest,=pkCli_7735,Nc_7770: bitstring) = m1_7769 in
                                                {10023}new Ns_7771: bitstring;
                                                {10024}new ST_7772: bitstring;
                                                {10025}new TTL_7773: bitstring;
                                                {10026}let m2_7774: bitstring = (OpenSecureChannelResponse,Ns_7771,ST_7772,TTL_7773) in
                                                {10027}event beginSrv(Sess_5025,Cli_5023,Ns_7771);
                                                {10028}out(c, (enc(m2_7774,pkCli_7735),sign(h(m2_7774),skSess_7395)));
                                                {10029}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                {10030}event endSrv(Cli_5023,Sess_5025,Nc_7770)
                                    )
                                    else
                                        {10031}let pkDisco_7775: bitstring = fail-any in
                                        {10032}in(c, (=pkCli_7735,em1_7776: bitstring,sigM1_7777: bitstring));
                                        {10033}let m1_7778: bitstring = dec(em1_7776,skSess_7395) in
                                        {10034}if (verify(h(m1_7778),sigM1_7777,pkCli_7735) <> true) then
                                            0
                                        else
                                            {10035}let (=OpenSecureChannelRequest,=pkCli_7735,Nc_7779: bitstring) = m1_7778 in
                                            {10036}new Ns_7780: bitstring;
                                            {10037}new ST_7781: bitstring;
                                            {10038}new TTL_7782: bitstring;
                                            {10039}let m2_7783: bitstring = (OpenSecureChannelResponse,Ns_7780,ST_7781,TTL_7782) in
                                            {10040}event beginSrv(Sess_5025,Cli_5023,Ns_7780);
                                            {10041}out(c, (enc(m2_7783,pkCli_7735),sign(h(m2_7783),skSess_7395)));
                                            {10042}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                            {10043}event endSrv(Cli_5023,Sess_5025,Nc_7779)
                            )
                            else
                                {10044}let pkDisco_7784: bitstring = fail-any in
                                {10045}in(c, (=pkCli_7735,em1_7785: bitstring,sigM1_7786: bitstring));
                                {10046}let m1_7787: bitstring = dec(em1_7785,skSess_7395) in
                                {10047}if (verify(h(m1_7787),sigM1_7786,pkCli_7735) <> true) then
                                    0
                                else
                                    {10048}let (=OpenSecureChannelRequest,=pkCli_7735,Nc_7788: bitstring) = m1_7787 in
                                    {10049}new Ns_7789: bitstring;
                                    {10050}new ST_7790: bitstring;
                                    {10051}new TTL_7791: bitstring;
                                    {10052}let m2_7792: bitstring = (OpenSecureChannelResponse,Ns_7789,ST_7790,TTL_7791) in
                                    {10053}event beginSrv(Sess_5025,Cli_5023,Ns_7789);
                                    {10054}out(c, (enc(m2_7792,pkCli_7735),sign(h(m2_7792),skSess_7395)));
                                    {10055}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                    {10056}event endSrv(Cli_5023,Sess_5025,Nc_7788)
                    )
                    else
                        {10057}let pkDisco_7793: bitstring = fail-any in
                        {10058}in(c, (=pkCli_7735,em1_7794: bitstring,sigM1_7795: bitstring));
                        {10059}let m1_7796: bitstring = dec(em1_7794,skSess_7395) in
                        {10060}if (verify(h(m1_7796),sigM1_7795,pkCli_7735) <> true) then
                            0
                        else
                            {10061}let (=OpenSecureChannelRequest,=pkCli_7735,Nc_7797: bitstring) = m1_7796 in
                            {10062}new Ns_7798: bitstring;
                            {10063}new ST_7799: bitstring;
                            {10064}new TTL_7800: bitstring;
                            {10065}let m2_7801: bitstring = (OpenSecureChannelResponse,Ns_7798,ST_7799,TTL_7800) in
                            {10066}event beginSrv(Sess_5025,Cli_5023,Ns_7798);
                            {10067}out(c, (enc(m2_7801,pkCli_7735),sign(h(m2_7801),skSess_7395)));
                            {10068}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                            {10069}event endSrv(Cli_5023,Sess_5025,Nc_7797)
        )
        else
            {10070}let pkCli_7802: bitstring = fail-any in
            {10071}let v_7803: bool = (Disco_5024 = A) in
            (
                {10072}if v_7803 then
                (
                    {10073}let pkDisco_7804: bitstring = pub(skA) in
                    {10074}in(c, (=pkCli_7802,em1_7805: bitstring,sigM1_7806: bitstring));
                    {10075}let m1_7807: bitstring = dec(em1_7805,skSess_7395) in
                    {10076}if (verify(h(m1_7807),sigM1_7806,pkCli_7802) <> true) then
                        0
                    else
                        {10077}let (=OpenSecureChannelRequest,=pkCli_7802,Nc_7808: bitstring) = m1_7807 in
                        {10078}new Ns_7809: bitstring;
                        {10079}new ST_7810: bitstring;
                        {10080}new TTL_7811: bitstring;
                        {10081}let m2_7812: bitstring = (OpenSecureChannelResponse,Ns_7809,ST_7810,TTL_7811) in
                        {10082}event beginSrv(Sess_5025,Cli_5023,Ns_7809);
                        {10083}out(c, (enc(m2_7812,pkCli_7802),sign(h(m2_7812),skSess_7395)));
                        {10084}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                        {10085}event endSrv(Cli_5023,Sess_5025,Nc_7808)
                )
                else
                    {10086}let v_7813: bool = (Disco_5024 = B) in
                    (
                        {10087}if v_7813 then
                        (
                            {10088}let pkDisco_7814: bitstring = pub(skB) in
                            {10089}in(c, (=pkCli_7802,em1_7815: bitstring,sigM1_7816: bitstring));
                            {10090}let m1_7817: bitstring = dec(em1_7815,skSess_7395) in
                            {10091}if (verify(h(m1_7817),sigM1_7816,pkCli_7802) <> true) then
                                0
                            else
                                {10092}let (=OpenSecureChannelRequest,=pkCli_7802,Nc_7818: bitstring) = m1_7817 in
                                {10093}new Ns_7819: bitstring;
                                {10094}new ST_7820: bitstring;
                                {10095}new TTL_7821: bitstring;
                                {10096}let m2_7822: bitstring = (OpenSecureChannelResponse,Ns_7819,ST_7820,TTL_7821) in
                                {10097}event beginSrv(Sess_5025,Cli_5023,Ns_7819);
                                {10098}out(c, (enc(m2_7822,pkCli_7802),sign(h(m2_7822),skSess_7395)));
                                {10099}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                {10100}event endSrv(Cli_5023,Sess_5025,Nc_7818)
                        )
                        else
                            {10101}let v_7823: bool = (Disco_5024 = C) in
                            (
                                {10102}if v_7823 then
                                (
                                    {10103}let pkDisco_7824: bitstring = pub(skC) in
                                    {10104}in(c, (=pkCli_7802,em1_7825: bitstring,sigM1_7826: bitstring));
                                    {10105}let m1_7827: bitstring = dec(em1_7825,skSess_7395) in
                                    {10106}if (verify(h(m1_7827),sigM1_7826,pkCli_7802) <> true) then
                                        0
                                    else
                                        {10107}let (=OpenSecureChannelRequest,=pkCli_7802,Nc_7828: bitstring) = m1_7827 in
                                        {10108}new Ns_7829: bitstring;
                                        {10109}new ST_7830: bitstring;
                                        {10110}new TTL_7831: bitstring;
                                        {10111}let m2_7832: bitstring = (OpenSecureChannelResponse,Ns_7829,ST_7830,TTL_7831) in
                                        {10112}event beginSrv(Sess_5025,Cli_5023,Ns_7829);
                                        {10113}out(c, (enc(m2_7832,pkCli_7802),sign(h(m2_7832),skSess_7395)));
                                        {10114}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                        {10115}event endSrv(Cli_5023,Sess_5025,Nc_7828)
                                )
                                else
                                    {10116}let pkDisco_7833: bitstring = pub(sk(Disco_5024)) in
                                    {10117}in(c, (=pkCli_7802,em1_7834: bitstring,sigM1_7835: bitstring));
                                    {10118}let m1_7836: bitstring = dec(em1_7834,skSess_7395) in
                                    {10119}if (verify(h(m1_7836),sigM1_7835,pkCli_7802) <> true) then
                                        0
                                    else
                                        {10120}let (=OpenSecureChannelRequest,=pkCli_7802,Nc_7837: bitstring) = m1_7836 in
                                        {10121}new Ns_7838: bitstring;
                                        {10122}new ST_7839: bitstring;
                                        {10123}new TTL_7840: bitstring;
                                        {10124}let m2_7841: bitstring = (OpenSecureChannelResponse,Ns_7838,ST_7839,TTL_7840) in
                                        {10125}event beginSrv(Sess_5025,Cli_5023,Ns_7838);
                                        {10126}out(c, (enc(m2_7841,pkCli_7802),sign(h(m2_7841),skSess_7395)));
                                        {10127}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                        {10128}event endSrv(Cli_5023,Sess_5025,Nc_7837)
                            )
                            else
                                {10129}let pkDisco_7842: bitstring = fail-any in
                                {10130}in(c, (=pkCli_7802,em1_7843: bitstring,sigM1_7844: bitstring));
                                {10131}let m1_7845: bitstring = dec(em1_7843,skSess_7395) in
                                {10132}if (verify(h(m1_7845),sigM1_7844,pkCli_7802) <> true) then
                                    0
                                else
                                    {10133}let (=OpenSecureChannelRequest,=pkCli_7802,Nc_7846: bitstring) = m1_7845 in
                                    {10134}new Ns_7847: bitstring;
                                    {10135}new ST_7848: bitstring;
                                    {10136}new TTL_7849: bitstring;
                                    {10137}let m2_7850: bitstring = (OpenSecureChannelResponse,Ns_7847,ST_7848,TTL_7849) in
                                    {10138}event beginSrv(Sess_5025,Cli_5023,Ns_7847);
                                    {10139}out(c, (enc(m2_7850,pkCli_7802),sign(h(m2_7850),skSess_7395)));
                                    {10140}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                    {10141}event endSrv(Cli_5023,Sess_5025,Nc_7846)
                    )
                    else
                        {10142}let pkDisco_7851: bitstring = fail-any in
                        {10143}in(c, (=pkCli_7802,em1_7852: bitstring,sigM1_7853: bitstring));
                        {10144}let m1_7854: bitstring = dec(em1_7852,skSess_7395) in
                        {10145}if (verify(h(m1_7854),sigM1_7853,pkCli_7802) <> true) then
                            0
                        else
                            {10146}let (=OpenSecureChannelRequest,=pkCli_7802,Nc_7855: bitstring) = m1_7854 in
                            {10147}new Ns_7856: bitstring;
                            {10148}new ST_7857: bitstring;
                            {10149}new TTL_7858: bitstring;
                            {10150}let m2_7859: bitstring = (OpenSecureChannelResponse,Ns_7856,ST_7857,TTL_7858) in
                            {10151}event beginSrv(Sess_5025,Cli_5023,Ns_7856);
                            {10152}out(c, (enc(m2_7859,pkCli_7802),sign(h(m2_7859),skSess_7395)));
                            {10153}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                            {10154}event endSrv(Cli_5023,Sess_5025,Nc_7855)
            )
            else
                {10155}let pkDisco_7860: bitstring = fail-any in
                {10156}in(c, (=pkCli_7802,em1_7861: bitstring,sigM1_7862: bitstring));
                {10157}let m1_7863: bitstring = dec(em1_7861,skSess_7395) in
                {10158}if (verify(h(m1_7863),sigM1_7862,pkCli_7802) <> true) then
                    0
                else
                    {10159}let (=OpenSecureChannelRequest,=pkCli_7802,Nc_7864: bitstring) = m1_7863 in
                    {10160}new Ns_7865: bitstring;
                    {10161}new ST_7866: bitstring;
                    {10162}new TTL_7867: bitstring;
                    {10163}let m2_7868: bitstring = (OpenSecureChannelResponse,Ns_7865,ST_7866,TTL_7867) in
                    {10164}event beginSrv(Sess_5025,Cli_5023,Ns_7865);
                    {10165}out(c, (enc(m2_7868,pkCli_7802),sign(h(m2_7868),skSess_7395)));
                    {10166}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                    {10167}event endSrv(Cli_5023,Sess_5025,Nc_7864)
)

-- Query event(endCli(X,Y,N)) ==> event(beginSrv(X,Y,N))
Completing...
200 rules inserted. The rule base contains 84 rules. 301 rules in the queue.
400 rules inserted. The rule base contains 184 rules. 301 rules in the queue.
600 rules inserted. The rule base contains 235 rules. 299 rules in the queue.
800 rules inserted. The rule base contains 270 rules. 288 rules in the queue.
1000 rules inserted. The rule base contains 285 rules. 273 rules in the queue.
1200 rules inserted. The rule base contains 345 rules. 213 rules in the queue.
1400 rules inserted. The rule base contains 369 rules. 387 rules in the queue.
1600 rules inserted. The rule base contains 466 rules. 836 rules in the queue.
1800 rules inserted. The rule base contains 550 rules. 1100 rules in the queue.
2000 rules inserted. The rule base contains 663 rules. 1013 rules in the queue.
2200 rules inserted. The rule base contains 758 rules. 936 rules in the queue.
2400 rules inserted. The rule base contains 869 rules. 876 rules in the queue.
2600 rules inserted. The rule base contains 978 rules. 850 rules in the queue.
2800 rules inserted. The rule base contains 1091 rules. 723 rules in the queue.
3000 rules inserted. The rule base contains 1122 rules. 652 rules in the queue.
3200 rules inserted. The rule base contains 1208 rules. 550 rules in the queue.
3400 rules inserted. The rule base contains 1246 rules. 496 rules in the queue.
3600 rules inserted. The rule base contains 1276 rules. 476 rules in the queue.
3800 rules inserted. The rule base contains 1215 rules. 573 rules in the queue.
4000 rules inserted. The rule base contains 1158 rules. 684 rules in the queue.
4200 rules inserted. The rule base contains 1198 rules. 738 rules in the queue.
4400 rules inserted. The rule base contains 1240 rules. 770 rules in the queue.
4600 rules inserted. The rule base contains 1278 rules. 790 rules in the queue.
4800 rules inserted. The rule base contains 1362 rules. 836 rules in the queue.
5000 rules inserted. The rule base contains 1455 rules. 930 rules in the queue.
5200 rules inserted. The rule base contains 1548 rules. 1006 rules in the queue.
5400 rules inserted. The rule base contains 1626 rules. 1078 rules in the queue.
5600 rules inserted. The rule base contains 1728 rules. 1074 rules in the queue.
5800 rules inserted. The rule base contains 1847 rules. 1049 rules in the queue.
6000 rules inserted. The rule base contains 1973 rules. 1018 rules in the queue.
6200 rules inserted. The rule base contains 2096 rules. 1009 rules in the queue.
6400 rules inserted. The rule base contains 2222 rules. 976 rules in the queue.
6600 rules inserted. The rule base contains 2322 rules. 959 rules in the queue.
6800 rules inserted. The rule base contains 2431 rules. 913 rules in the queue.
7000 rules inserted. The rule base contains 2558 rules. 914 rules in the queue.
7200 rules inserted. The rule base contains 2696 rules. 895 rules in the queue.
7400 rules inserted. The rule base contains 2807 rules. 856 rules in the queue.
7600 rules inserted. The rule base contains 2911 rules. 904 rules in the queue.
7800 rules inserted. The rule base contains 3027 rules. 836 rules in the queue.
8000 rules inserted. The rule base contains 3138 rules. 834 rules in the queue.
8200 rules inserted. The rule base contains 3250 rules. 778 rules in the queue.
8400 rules inserted. The rule base contains 3358 rules. 753 rules in the queue.
8600 rules inserted. The rule base contains 3486 rules. 762 rules in the queue.
8800 rules inserted. The rule base contains 3610 rules. 765 rules in the queue.
9000 rules inserted. The rule base contains 3728 rules. 781 rules in the queue.
9200 rules inserted. The rule base contains 3823 rules. 703 rules in the queue.
9400 rules inserted. The rule base contains 3948 rules. 637 rules in the queue.
9600 rules inserted. The rule base contains 4068 rules. 556 rules in the queue.
9800 rules inserted. The rule base contains 4199 rules. 475 rules in the queue.
10000 rules inserted. The rule base contains 4266 rules. 412 rules in the queue.
10200 rules inserted. The rule base contains 4353 rules. 331 rules in the queue.
10400 rules inserted. The rule base contains 4406 rules. 280 rules in the queue.
10600 rules inserted. The rule base contains 4476 rules. 210 rules in the queue.
10800 rules inserted. The rule base contains 4534 rules. 152 rules in the queue.
11000 rules inserted. The rule base contains 4590 rules. 96 rules in the queue.
Starting query event(endCli(X,Y,N)) ==> event(beginSrv(X,Y,N))
goal reachable: Cli_169246 <> C[] && Cli_169246 <> B[] && Cli_169246 <> A[] && begin(beginSrv(C[],Cli_169246,Ns_6196[sigM1_6193 = sign(h((OpenSecureChannelRequest,pub(sk(Cli_169246)),Nc_169247)),sk(Cli_169246)),em1_6192 = enc((OpenSecureChannelRequest,pub(sk(Cli_169246)),Nc_169247),pub(skC[])),Sess_5025 = C[],Disco_5024 = B[],Cli_5023 = Cli_169246,!1 = @sid_169248])) && attacker(Nc_169247) && attacker(Cli_169246) -> end(endCli(C[],B[],Ns_6196[sigM1_6193 = sign(h((OpenSecureChannelRequest,pub(sk(Cli_169246)),Nc_169247)),sk(Cli_169246)),em1_6192 = enc((OpenSecureChannelRequest,pub(sk(Cli_169246)),Nc_169247),pub(skC[])),Sess_5025 = C[],Disco_5024 = B[],Cli_5023 = Cli_169246,!1 = @sid_169248]))
Abbreviations:
Ns_170888 = Ns_6196[sigM1_6193 = sign(h((OpenSecureChannelRequest,pub(sk(Cli_170858)),Nc_170859)),sk(Cli_170858)),em1_6192 = enc((OpenSecureChannelRequest,pub(sk(Cli_170858)),Nc_170859),pub(skC[])),Sess_5025 = C[],Disco_5024 = B[],Cli_5023 = Cli_170858,!1 = @sid_170860]
ST_170889 = ST_6197[sigM1_6193 = sign(h((OpenSecureChannelRequest,pub(sk(Cli_170858)),Nc_170859)),sk(Cli_170858)),em1_6192 = enc((OpenSecureChannelRequest,pub(sk(Cli_170858)),Nc_170859),pub(skC[])),Sess_5025 = C[],Disco_5024 = B[],Cli_5023 = Cli_170858,!1 = @sid_170860]
TTL_170890 = TTL_6198[sigM1_6193 = sign(h((OpenSecureChannelRequest,pub(sk(Cli_170858)),Nc_170859)),sk(Cli_170858)),em1_6192 = enc((OpenSecureChannelRequest,pub(sk(Cli_170858)),Nc_170859),pub(skC[])),Sess_5025 = C[],Disco_5024 = B[],Cli_5023 = Cli_170858,!1 = @sid_170860]

1. The attacker initially knows C[].
attacker(C[]).

2. The attacker initially knows B[].
attacker(B[]).

3. By 2, the attacker may know B[].
By 2, the attacker may know B[].
By 1, the attacker may know C[].
Using the function 3-tuple the attacker may obtain (B[],B[],C[]).
attacker((B[],B[],C[])).

4. The attacker has some term UP_170883.
attacker(UP_170883).

5. The attacker has some term SP_170882.
attacker(SP_170882).

6. Using the function SignAndEncrypt the attacker may obtain SignAndEncrypt.
attacker(SignAndEncrypt).

7. The message pub(skC[]) may be sent to the attacker at output {6}.
attacker(pub(skC[])).

8. Using the function GetEndpointResponse the attacker may obtain GetEndpointResponse.
attacker(GetEndpointResponse).

9. By 8, the attacker may know GetEndpointResponse.
By 7, the attacker may know pub(skC[]).
By 6, the attacker may know SignAndEncrypt.
By 5, the attacker may know SP_170882.
By 4, the attacker may know UP_170883.
Using the function 5-tuple the attacker may obtain (GetEndpointResponse,pub(skC[]),SignAndEncrypt,SP_170882,UP_170883).
attacker((GetEndpointResponse,pub(skC[]),SignAndEncrypt,SP_170882,UP_170883)).

10. We assume as hypothesis that
attacker(Cli_170858).

11. By 10, the attacker may know Cli_170858.
By 2, the attacker may know B[].
By 1, the attacker may know C[].
Using the function 3-tuple the attacker may obtain (Cli_170858,B[],C[]).
attacker((Cli_170858,B[],C[])).

12. By 10, the attacker may know Cli_170858.
Using the function sk the attacker may obtain sk(Cli_170858).
attacker(sk(Cli_170858)).

13. We assume as hypothesis that
attacker(Nc_170859).

14. By 12, the attacker may know sk(Cli_170858).
Using the function pub the attacker may obtain pub(sk(Cli_170858)).
attacker(pub(sk(Cli_170858))).

15. Using the function OpenSecureChannelRequest the attacker may obtain OpenSecureChannelRequest.
attacker(OpenSecureChannelRequest).

16. By 15, the attacker may know OpenSecureChannelRequest.
By 14, the attacker may know pub(sk(Cli_170858)).
By 13, the attacker may know Nc_170859.
Using the function 3-tuple the attacker may obtain (OpenSecureChannelRequest,pub(sk(Cli_170858)),Nc_170859).
attacker((OpenSecureChannelRequest,pub(sk(Cli_170858)),Nc_170859)).

17. By 16, the attacker may know (OpenSecureChannelRequest,pub(sk(Cli_170858)),Nc_170859).
Using the function h the attacker may obtain h((OpenSecureChannelRequest,pub(sk(Cli_170858)),Nc_170859)).
attacker(h((OpenSecureChannelRequest,pub(sk(Cli_170858)),Nc_170859))).

18. By 17, the attacker may know h((OpenSecureChannelRequest,pub(sk(Cli_170858)),Nc_170859)).
By 12, the attacker may know sk(Cli_170858).
Using the function sign the attacker may obtain sign(h((OpenSecureChannelRequest,pub(sk(Cli_170858)),Nc_170859)),sk(Cli_170858)).
attacker(sign(h((OpenSecureChannelRequest,pub(sk(Cli_170858)),Nc_170859)),sk(Cli_170858))).

19. By 16, the attacker may know (OpenSecureChannelRequest,pub(sk(Cli_170858)),Nc_170859).
By 7, the attacker may know pub(skC[]).
Using the function enc the attacker may obtain enc((OpenSecureChannelRequest,pub(sk(Cli_170858)),Nc_170859),pub(skC[])).
attacker(enc((OpenSecureChannelRequest,pub(sk(Cli_170858)),Nc_170859),pub(skC[]))).

20. By 14, the attacker may know pub(sk(Cli_170858)).
By 19, the attacker may know enc((OpenSecureChannelRequest,pub(sk(Cli_170858)),Nc_170859),pub(skC[])).
By 18, the attacker may know sign(h((OpenSecureChannelRequest,pub(sk(Cli_170858)),Nc_170859)),sk(Cli_170858)).
Using the function 3-tuple the attacker may obtain (pub(sk(Cli_170858)),enc((OpenSecureChannelRequest,pub(sk(Cli_170858)),Nc_170859),pub(skC[])),sign(h((OpenSecureChannelRequest,pub(sk(Cli_170858)),Nc_170859)),sk(Cli_170858))).
attacker((pub(sk(Cli_170858)),enc((OpenSecureChannelRequest,pub(sk(Cli_170858)),Nc_170859),pub(skC[])),sign(h((OpenSecureChannelRequest,pub(sk(Cli_170858)),Nc_170859)),sk(Cli_170858)))).

21. The message (Cli_170858,B[],C[]) that the attacker may have by 11 may be received at input {5998}.
The message (pub(sk(Cli_170858)),enc((OpenSecureChannelRequest,pub(sk(Cli_170858)),Nc_170859),pub(skC[])),sign(h((OpenSecureChannelRequest,pub(sk(Cli_170858)),Nc_170859)),sk(Cli_170858))) that the attacker may have by 20 may be received at input {7713}.
The event beginSrv(C[],Cli_170858,Ns_170888) may be executed at {7721}.
We have Cli_170858 <> C[] & Cli_170858 <> B[] & Cli_170858 <> A[].
So the message (enc((OpenSecureChannelResponse,Ns_170888,ST_170889,TTL_170890),pub(sk(Cli_170858))),sign(h((OpenSecureChannelResponse,Ns_170888,ST_170889,TTL_170890)),skC[])) may be sent to the attacker at output {7722}.
attacker((enc((OpenSecureChannelResponse,Ns_170888,ST_170889,TTL_170890),pub(sk(Cli_170858))),sign(h((OpenSecureChannelResponse,Ns_170888,ST_170889,TTL_170890)),skC[]))).

22. By 21, the attacker may know (enc((OpenSecureChannelResponse,Ns_170888,ST_170889,TTL_170890),pub(sk(Cli_170858))),sign(h((OpenSecureChannelResponse,Ns_170888,ST_170889,TTL_170890)),skC[])).
Using the function 2-proj-2-tuple the attacker may obtain sign(h((OpenSecureChannelResponse,Ns_170888,ST_170889,TTL_170890)),skC[]).
attacker(sign(h((OpenSecureChannelResponse,Ns_170888,ST_170889,TTL_170890)),skC[])).

23. The message pub(skB[]) may be sent to the attacker at output {4}.
attacker(pub(skB[])).

24. By 21, the attacker may know (enc((OpenSecureChannelResponse,Ns_170888,ST_170889,TTL_170890),pub(sk(Cli_170858))),sign(h((OpenSecureChannelResponse,Ns_170888,ST_170889,TTL_170890)),skC[])).
Using the function 1-proj-2-tuple the attacker may obtain enc((OpenSecureChannelResponse,Ns_170888,ST_170889,TTL_170890),pub(sk(Cli_170858))).
attacker(enc((OpenSecureChannelResponse,Ns_170888,ST_170889,TTL_170890),pub(sk(Cli_170858)))).

25. By 24, the attacker may know enc((OpenSecureChannelResponse,Ns_170888,ST_170889,TTL_170890),pub(sk(Cli_170858))).
By 12, the attacker may know sk(Cli_170858).
Using the function dec the attacker may obtain (OpenSecureChannelResponse,Ns_170888,ST_170889,TTL_170890).
attacker((OpenSecureChannelResponse,Ns_170888,ST_170889,TTL_170890)).

26. By 25, the attacker may know (OpenSecureChannelResponse,Ns_170888,ST_170889,TTL_170890).
Using the function 4-proj-4-tuple the attacker may obtain TTL_170890.
attacker(TTL_170890).

27. By 25, the attacker may know (OpenSecureChannelResponse,Ns_170888,ST_170889,TTL_170890).
Using the function 3-proj-4-tuple the attacker may obtain ST_170889.
attacker(ST_170889).

28. By 25, the attacker may know (OpenSecureChannelResponse,Ns_170888,ST_170889,TTL_170890).
Using the function 2-proj-4-tuple the attacker may obtain Ns_170888.
attacker(Ns_170888).

29. Using the function OpenSecureChannelResponse the attacker may obtain OpenSecureChannelResponse.
attacker(OpenSecureChannelResponse).

30. By 29, the attacker may know OpenSecureChannelResponse.
By 28, the attacker may know Ns_170888.
By 27, the attacker may know ST_170889.
By 26, the attacker may know TTL_170890.
Using the function 4-tuple the attacker may obtain (OpenSecureChannelResponse,Ns_170888,ST_170889,TTL_170890).
attacker((OpenSecureChannelResponse,Ns_170888,ST_170889,TTL_170890)).

31. By 30, the attacker may know (OpenSecureChannelResponse,Ns_170888,ST_170889,TTL_170890).
By 23, the attacker may know pub(skB[]).
Using the function enc the attacker may obtain enc((OpenSecureChannelResponse,Ns_170888,ST_170889,TTL_170890),pub(skB[])).
attacker(enc((OpenSecureChannelResponse,Ns_170888,ST_170889,TTL_170890),pub(skB[]))).

32. By 31, the attacker may know enc((OpenSecureChannelResponse,Ns_170888,ST_170889,TTL_170890),pub(skB[])).
By 22, the attacker may know sign(h((OpenSecureChannelResponse,Ns_170888,ST_170889,TTL_170890)),skC[]).
Using the function 2-tuple the attacker may obtain (enc((OpenSecureChannelResponse,Ns_170888,ST_170889,TTL_170890),pub(skB[])),sign(h((OpenSecureChannelResponse,Ns_170888,ST_170889,TTL_170890)),skC[])).
attacker((enc((OpenSecureChannelResponse,Ns_170888,ST_170889,TTL_170890),pub(skB[])),sign(h((OpenSecureChannelResponse,Ns_170888,ST_170889,TTL_170890)),skC[]))).

33. The message (B[],B[],C[]) that the attacker may have by 3 may be received at input {8}.
The message (GetEndpointResponse,pub(skC[]),SignAndEncrypt,SP_170882,UP_170883) that the attacker may have by 9 may be received at input {846}.
The message (enc((OpenSecureChannelResponse,Ns_170888,ST_170889,TTL_170890),pub(skB[])),sign(h((OpenSecureChannelResponse,Ns_170888,ST_170889,TTL_170890)),skC[])) that the attacker may have by 32 may be received at input {851}.
So event endCli(C[],B[],Ns_170888) may be executed at {856}.
end(endCli(C[],B[],Ns_170888)).


A more detailed output of the traces is available with
  set traceDisplay = long.

out(c, pub(skA)) at {2}

out(c, pub(skB)) at {4}

out(c, pub(skC)) at {6}

in(c, (B,B,C)) at {8} in copy a_170895

out(c, GetEndpointRequest) at {845} in copy a_170895

in(c, (GetEndpointResponse,pub(skC),SignAndEncrypt,a_170893,a_170894)) at {846} in copy a_170895

new Nc_1193 creating Nc_202183 at {847} in copy a_170895

event(beginCli(B,C,Nc_202183)) at {849} in copy a_170895

out(c, (pub(skB),enc((OpenSecureChannelRequest,pub(skB),Nc_202183),pub(skC)),sign(h((OpenSecureChannelRequest,pub(skB),Nc_202183)),skB))) at {850} in copy a_170895

in(c, (a,B,C)) at {5998} in copy a_170892

in(c, (pub(sk(a)),enc((OpenSecureChannelRequest,pub(sk(a)),a_170891),pub(skC)),sign(h((OpenSecureChannelRequest,pub(sk(a)),a_170891)),sk(a)))) at {7713} in copy a_170892

new Ns_6196 creating Ns_170896 at {7717} in copy a_170892

new ST_6197 creating ST_170897 at {7718} in copy a_170892

new TTL_6198 creating TTL_170898 at {7719} in copy a_170892

event(beginSrv(C,a,Ns_170896)) at {7721} in copy a_170892

out(c, (enc((OpenSecureChannelResponse,Ns_170896,ST_170897,TTL_170898),pub(sk(a))),sign(h((OpenSecureChannelResponse,Ns_170896,ST_170897,TTL_170898)),skC))) at {7722} in copy a_170892

in(c, (enc((OpenSecureChannelResponse,Ns_170896,ST_170897,TTL_170898),pub(skB)),sign(h((OpenSecureChannelResponse,Ns_170896,ST_170897,TTL_170898)),skC))) at {851} in copy a_170895

event(endCli(C,B,Ns_170896)) at {856} in copy a_170895

The event endCli(C,B,Ns_170896) is executed.
A trace has been found.
RESULT event(endCli(X,Y,N)) ==> event(beginSrv(X,Y,N)) is false.
-- Query event(endSrv(X_208506,Y_208507,N_208508)) ==> event(beginCli(X_208506,Y_208507,N_208508))
Completing...
200 rules inserted. The rule base contains 75 rules. 301 rules in the queue.
400 rules inserted. The rule base contains 180 rules. 301 rules in the queue.
600 rules inserted. The rule base contains 235 rules. 299 rules in the queue.
800 rules inserted. The rule base contains 273 rules. 285 rules in the queue.
1000 rules inserted. The rule base contains 285 rules. 273 rules in the queue.
1200 rules inserted. The rule base contains 345 rules. 213 rules in the queue.
1400 rules inserted. The rule base contains 369 rules. 411 rules in the queue.
1600 rules inserted. The rule base contains 464 rules. 928 rules in the queue.
1800 rules inserted. The rule base contains 561 rules. 1221 rules in the queue.
2000 rules inserted. The rule base contains 660 rules. 1095 rules in the queue.
2200 rules inserted. The rule base contains 757 rules. 1083 rules in the queue.
2400 rules inserted. The rule base contains 861 rules. 1008 rules in the queue.
2600 rules inserted. The rule base contains 962 rules. 936 rules in the queue.
2800 rules inserted. The rule base contains 1070 rules. 913 rules in the queue.
3000 rules inserted. The rule base contains 1174 rules. 780 rules in the queue.
3200 rules inserted. The rule base contains 1230 rules. 693 rules in the queue.
3400 rules inserted. The rule base contains 1292 rules. 613 rules in the queue.
3600 rules inserted. The rule base contains 1330 rules. 557 rules in the queue.
3800 rules inserted. The rule base contains 1362 rules. 516 rules in the queue.
4000 rules inserted. The rule base contains 1294 rules. 596 rules in the queue.
4200 rules inserted. The rule base contains 1226 rules. 676 rules in the queue.
4400 rules inserted. The rule base contains 1263 rules. 681 rules in the queue.
4600 rules inserted. The rule base contains 1284 rules. 678 rules in the queue.
4800 rules inserted. The rule base contains 1313 rules. 673 rules in the queue.
5000 rules inserted. The rule base contains 1350 rules. 672 rules in the queue.
5200 rules inserted. The rule base contains 1424 rules. 664 rules in the queue.
5400 rules inserted. The rule base contains 1498 rules. 656 rules in the queue.
5600 rules inserted. The rule base contains 1563 rules. 654 rules in the queue.
5800 rules inserted. The rule base contains 1663 rules. 593 rules in the queue.
6000 rules inserted. The rule base contains 1761 rules. 540 rules in the queue.
6200 rules inserted. The rule base contains 1854 rules. 489 rules in the queue.
6400 rules inserted. The rule base contains 1966 rules. 419 rules in the queue.
6600 rules inserted. The rule base contains 2078 rules. 379 rules in the queue.
6800 rules inserted. The rule base contains 2199 rules. 333 rules in the queue.
7000 rules inserted. The rule base contains 2317 rules. 263 rules in the queue.
7200 rules inserted. The rule base contains 2480 rules. 196 rules in the queue.
7400 rules inserted. The rule base contains 2668 rules. 92 rules in the queue.
Starting query event(endSrv(X_208506,Y_208507,N_208508)) ==> event(beginCli(X_208506,Y_208507,N_208508))
goal reachable: Sess_320536 <> C[] && Sess_320536 <> B[] && Sess_320536 <> A[] && begin(beginCli(C[],Sess_320536,Nc_1776[UP_1775 = UP_320537,SP_1774 = SP_320538,Sess = Sess_320536,Disco = B[],Cli = C[],!1 = @sid_320539])) && attacker(SP_320538) && attacker(UP_320537) && attacker(Sess_320536) -> end(endSrv(C[],B[],Nc_1776[UP_1775 = UP_320537,SP_1774 = SP_320538,Sess = Sess_320536,Disco = B[],Cli = C[],!1 = @sid_320539]))
Abbreviations:
Nc_320865 = Nc_1776[UP_1775 = UP_320843,SP_1774 = SP_320844,Sess = Sess_320842,Disco = B[],Cli = C[],!1 = @sid_320845]

1. The attacker initially knows B[].
attacker(B[]).

2. The attacker initially knows C[].
attacker(C[]).

3. By 2, the attacker may know C[].
By 1, the attacker may know B[].
By 1, the attacker may know B[].
Using the function 3-tuple the attacker may obtain (C[],B[],B[]).
attacker((C[],B[],B[])).

4. We assume as hypothesis that
attacker(Sess_320842).

5. By 2, the attacker may know C[].
By 1, the attacker may know B[].
By 4, the attacker may know Sess_320842.
Using the function 3-tuple the attacker may obtain (C[],B[],Sess_320842).
attacker((C[],B[],Sess_320842)).

6. We assume as hypothesis that
attacker(UP_320843).

7. We assume as hypothesis that
attacker(SP_320844).

8. Using the function SignAndEncrypt the attacker may obtain SignAndEncrypt.
attacker(SignAndEncrypt).

9. By 4, the attacker may know Sess_320842.
Using the function sk the attacker may obtain sk(Sess_320842).
attacker(sk(Sess_320842)).

10. By 9, the attacker may know sk(Sess_320842).
Using the function pub the attacker may obtain pub(sk(Sess_320842)).
attacker(pub(sk(Sess_320842))).

11. Using the function GetEndpointResponse the attacker may obtain GetEndpointResponse.
attacker(GetEndpointResponse).

12. By 11, the attacker may know GetEndpointResponse.
By 10, the attacker may know pub(sk(Sess_320842)).
By 8, the attacker may know SignAndEncrypt.
By 7, the attacker may know SP_320844.
By 6, the attacker may know UP_320843.
Using the function 5-tuple the attacker may obtain (GetEndpointResponse,pub(sk(Sess_320842)),SignAndEncrypt,SP_320844,UP_320843).
attacker((GetEndpointResponse,pub(sk(Sess_320842)),SignAndEncrypt,SP_320844,UP_320843)).

13. The message (C[],B[],Sess_320842) that the attacker may have by 5 may be received at input {8}.
The message (GetEndpointResponse,pub(sk(Sess_320842)),SignAndEncrypt,SP_320844,UP_320843) that the attacker may have by 12 may be received at input {1554}.
The event beginCli(C[],Sess_320842,Nc_320865) may be executed at {1557}.
We have Sess_320842 <> C[] & Sess_320842 <> B[] & Sess_320842 <> A[].
So the message (pub(skC[]),enc((OpenSecureChannelRequest,pub(skC[]),Nc_320865),pub(sk(Sess_320842))),sign(h((OpenSecureChannelRequest,pub(skC[]),Nc_320865)),skC[])) may be sent to the attacker at output {1558}.
attacker((pub(skC[]),enc((OpenSecureChannelRequest,pub(skC[]),Nc_320865),pub(sk(Sess_320842))),sign(h((OpenSecureChannelRequest,pub(skC[]),Nc_320865)),skC[]))).

14. By 13, the attacker may know (pub(skC[]),enc((OpenSecureChannelRequest,pub(skC[]),Nc_320865),pub(sk(Sess_320842))),sign(h((OpenSecureChannelRequest,pub(skC[]),Nc_320865)),skC[])).
Using the function 3-proj-3-tuple the attacker may obtain sign(h((OpenSecureChannelRequest,pub(skC[]),Nc_320865)),skC[]).
attacker(sign(h((OpenSecureChannelRequest,pub(skC[]),Nc_320865)),skC[])).

15. The message pub(skB[]) may be sent to the attacker at output {4}.
attacker(pub(skB[])).

16. By 13, the attacker may know (pub(skC[]),enc((OpenSecureChannelRequest,pub(skC[]),Nc_320865),pub(sk(Sess_320842))),sign(h((OpenSecureChannelRequest,pub(skC[]),Nc_320865)),skC[])).
Using the function 2-proj-3-tuple the attacker may obtain enc((OpenSecureChannelRequest,pub(skC[]),Nc_320865),pub(sk(Sess_320842))).
attacker(enc((OpenSecureChannelRequest,pub(skC[]),Nc_320865),pub(sk(Sess_320842)))).

17. By 16, the attacker may know enc((OpenSecureChannelRequest,pub(skC[]),Nc_320865),pub(sk(Sess_320842))).
By 9, the attacker may know sk(Sess_320842).
Using the function dec the attacker may obtain (OpenSecureChannelRequest,pub(skC[]),Nc_320865).
attacker((OpenSecureChannelRequest,pub(skC[]),Nc_320865)).

18. By 17, the attacker may know (OpenSecureChannelRequest,pub(skC[]),Nc_320865).
Using the function 3-proj-3-tuple the attacker may obtain Nc_320865.
attacker(Nc_320865).

19. The message pub(skC[]) may be sent to the attacker at output {6}.
attacker(pub(skC[])).

20. Using the function OpenSecureChannelRequest the attacker may obtain OpenSecureChannelRequest.
attacker(OpenSecureChannelRequest).

21. By 20, the attacker may know OpenSecureChannelRequest.
By 19, the attacker may know pub(skC[]).
By 18, the attacker may know Nc_320865.
Using the function 3-tuple the attacker may obtain (OpenSecureChannelRequest,pub(skC[]),Nc_320865).
attacker((OpenSecureChannelRequest,pub(skC[]),Nc_320865)).

22. By 21, the attacker may know (OpenSecureChannelRequest,pub(skC[]),Nc_320865).
By 15, the attacker may know pub(skB[]).
Using the function enc the attacker may obtain enc((OpenSecureChannelRequest,pub(skC[]),Nc_320865),pub(skB[])).
attacker(enc((OpenSecureChannelRequest,pub(skC[]),Nc_320865),pub(skB[]))).

23. By 19, the attacker may know pub(skC[]).
By 22, the attacker may know enc((OpenSecureChannelRequest,pub(skC[]),Nc_320865),pub(skB[])).
By 14, the attacker may know sign(h((OpenSecureChannelRequest,pub(skC[]),Nc_320865)),skC[]).
Using the function 3-tuple the attacker may obtain (pub(skC[]),enc((OpenSecureChannelRequest,pub(skC[]),Nc_320865),pub(skB[])),sign(h((OpenSecureChannelRequest,pub(skC[]),Nc_320865)),skC[])).
attacker((pub(skC[]),enc((OpenSecureChannelRequest,pub(skC[]),Nc_320865),pub(skB[])),sign(h((OpenSecureChannelRequest,pub(skC[]),Nc_320865)),skC[]))).

24. The message (C[],B[],B[]) that the attacker may have by 3 may be received at input {5998}.
The message (pub(skC[]),enc((OpenSecureChannelRequest,pub(skC[]),Nc_320865),pub(skB[])),sign(h((OpenSecureChannelRequest,pub(skC[]),Nc_320865)),skC[])) that the attacker may have by 23 may be received at input {6920}.
So event endSrv(C[],B[],Nc_320865) may be executed at {6931}.
end(endSrv(C[],B[],Nc_320865)).


A more detailed output of the traces is available with
  set traceDisplay = long.

out(c, pub(skA)) at {2}

out(c, pub(skB)) at {4}

out(c, pub(skC)) at {6}

in(c, (C,B,a_320868)) at {8} in copy a_320869

out(c, GetEndpointRequest) at {1553} in copy a_320869

in(c, (GetEndpointResponse,pub(sk(a_320868)),SignAndEncrypt,a_320867,a_320866)) at {1554} in copy a_320869

new Nc_1776 creating Nc_320871 at {1555} in copy a_320869

event(beginCli(C,a_320868,Nc_320871)) at {1557} in copy a_320869

out(c, (pub(skC),enc((OpenSecureChannelRequest,pub(skC),Nc_320871),pub(sk(a_320868))),sign(h((OpenSecureChannelRequest,pub(skC),Nc_320871)),skC))) at {1558} in copy a_320869

in(c, (C,B,B)) at {5998} in copy a_320870

in(c, (pub(skC),enc((OpenSecureChannelRequest,pub(skC),Nc_320871),pub(skB)),sign(h((OpenSecureChannelRequest,pub(skC),Nc_320871)),skC))) at {6920} in copy a_320870

new Ns_5655 creating Ns_358629 at {6924} in copy a_320870

new ST_5656 creating ST_358630 at {6925} in copy a_320870

new TTL_5657 creating TTL_358631 at {6926} in copy a_320870

event(beginSrv(B,C,Ns_358629)) at {6928} in copy a_320870

out(c, (enc((OpenSecureChannelResponse,Ns_358629,ST_358630,TTL_358631),pub(skC)),sign(h((OpenSecureChannelResponse,Ns_358629,ST_358630,TTL_358631)),skB))) at {6929} in copy a_320870

event(endSrv(C,B,Nc_320871)) at {6931} in copy a_320870

The event endSrv(C,B,Nc_320871) is executed.
A trace has been found.
RESULT event(endSrv(X_208506,Y_208507,N_208508)) ==> event(beginCli(X_208506,Y_208507,N_208508)) is false.
