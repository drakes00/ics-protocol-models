Linear part:
exp(exp(g,x_26),y) = exp(exp(g,y),x_26)
Completing equations...
Completed equations:
exp(exp(g,x_26),y) = exp(exp(g,y),x_26)
Convergent part:
dec(enc(x_13,pub(k_14)),k_14) = x_13
Completing equations...
Completed equations:
dec(enc(x_13,pub(k_14)),k_14) = x_13
Process:
{1}let pkA: bitstring = pub(skA) in
{2}out(c, pkA);
{3}let pkB: bitstring = pub(skB) in
{4}out(c, pkB);
{5}let pkC: bitstring = pub(skC) in
{6}out(c, pkC);
(
    {7}!
    {8}in(c, (Cli: host,Disco: host,Sess: host));
    {9}let v_509: bool = (Cli = A) in
    (
        {10}if v_509 then
        (
            {11}let skCli: bitstring = skA in
            {12}let pkCli: bitstring = pub(skCli) in
            {13}let v_510: bool = (Disco = A) in
            (
                {14}if v_510 then
                (
                    {15}let pkDisco: bitstring = pub(skA) in
                    {16}let v_511: bool = (Sess = A) in
                    (
                        {17}if v_511 then
                        (
                            {18}let pkSess: bitstring = pub(skA) in
                            {19}out(c, GetEndpointRequest);
                            {20}in(c, (=GetEndpointResponse,=pkSess,=None,SP: bitstring,UP: bitstring));
                            {21}new Nc: bitstring;
                            {22}let wNc: bitstring = enc(Nc,pkSess) in
                            {23}let m1: bitstring = (OpenSecureChannelRequest,pkCli,wNc) in
                            {24}event beginCli(Cli,Sess,Nc);
                            {25}out(c, (pkCli,m1));
                            {26}in(c, em2: bitstring);
                            {27}let m2: bitstring = em2 in
                            {28}let (=OpenSecureChannelResponse,wNs: bitstring,ST: bitstring,TTL: bitstring) = m2 in
                            {29}let Ns: bitstring = dec(wNs,skCli) in
                            {30}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                            {31}event endCli(Sess,Cli,Ns)
                        )
                        else
                            {32}let v_512: bool = (Sess = B) in
                            (
                                {33}if v_512 then
                                (
                                    {34}let pkSess_513: bitstring = pub(skB) in
                                    {35}out(c, GetEndpointRequest);
                                    {36}in(c, (=GetEndpointResponse,=pkSess_513,=None,SP_514: bitstring,UP_515: bitstring));
                                    {37}new Nc_516: bitstring;
                                    {38}let wNc_517: bitstring = enc(Nc_516,pkSess_513) in
                                    {39}let m1_518: bitstring = (OpenSecureChannelRequest,pkCli,wNc_517) in
                                    {40}event beginCli(Cli,Sess,Nc_516);
                                    {41}out(c, (pkCli,m1_518));
                                    {42}in(c, em2_519: bitstring);
                                    {43}let m2_520: bitstring = em2_519 in
                                    {44}let (=OpenSecureChannelResponse,wNs_521: bitstring,ST_522: bitstring,TTL_523: bitstring) = m2_520 in
                                    {45}let Ns_524: bitstring = dec(wNs_521,skCli) in
                                    {46}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                    {47}event endCli(Sess,Cli,Ns_524)
                                )
                                else
                                    {48}let v_525: bool = (Sess = C) in
                                    (
                                        {49}if v_525 then
                                        (
                                            {50}let pkSess_526: bitstring = pub(skC) in
                                            {51}out(c, GetEndpointRequest);
                                            {52}in(c, (=GetEndpointResponse,=pkSess_526,=None,SP_527: bitstring,UP_528: bitstring));
                                            {53}new Nc_529: bitstring;
                                            {54}let wNc_530: bitstring = enc(Nc_529,pkSess_526) in
                                            {55}let m1_531: bitstring = (OpenSecureChannelRequest,pkCli,wNc_530) in
                                            {56}event beginCli(Cli,Sess,Nc_529);
                                            {57}out(c, (pkCli,m1_531));
                                            {58}in(c, em2_532: bitstring);
                                            {59}let m2_533: bitstring = em2_532 in
                                            {60}let (=OpenSecureChannelResponse,wNs_534: bitstring,ST_535: bitstring,TTL_536: bitstring) = m2_533 in
                                            {61}let Ns_537: bitstring = dec(wNs_534,skCli) in
                                            {62}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {63}event endCli(Sess,Cli,Ns_537)
                                        )
                                        else
                                            {64}let pkSess_538: bitstring = pub(sk(Sess)) in
                                            {65}out(c, GetEndpointRequest);
                                            {66}in(c, (=GetEndpointResponse,=pkSess_538,=None,SP_539: bitstring,UP_540: bitstring));
                                            {67}new Nc_541: bitstring;
                                            {68}let wNc_542: bitstring = enc(Nc_541,pkSess_538) in
                                            {69}let m1_543: bitstring = (OpenSecureChannelRequest,pkCli,wNc_542) in
                                            {70}event beginCli(Cli,Sess,Nc_541);
                                            {71}out(c, (pkCli,m1_543));
                                            {72}in(c, em2_544: bitstring);
                                            {73}let m2_545: bitstring = em2_544 in
                                            {74}let (=OpenSecureChannelResponse,wNs_546: bitstring,ST_547: bitstring,TTL_548: bitstring) = m2_545 in
                                            {75}let Ns_549: bitstring = dec(wNs_546,skCli) in
                                            {76}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {77}event endCli(Sess,Cli,Ns_549)
                                    )
                                    else
                                        {78}let pkSess_550: bitstring = fail-any in
                                        {79}out(c, GetEndpointRequest);
                                        {80}in(c, (=GetEndpointResponse,=pkSess_550,=None,SP_551: bitstring,UP_552: bitstring));
                                        {81}new Nc_553: bitstring;
                                        {82}let wNc_554: bitstring = enc(Nc_553,pkSess_550) in
                                        {83}let m1_555: bitstring = (OpenSecureChannelRequest,pkCli,wNc_554) in
                                        {84}event beginCli(Cli,Sess,Nc_553);
                                        {85}out(c, (pkCli,m1_555));
                                        {86}in(c, em2_556: bitstring);
                                        {87}let m2_557: bitstring = em2_556 in
                                        {88}let (=OpenSecureChannelResponse,wNs_558: bitstring,ST_559: bitstring,TTL_560: bitstring) = m2_557 in
                                        {89}let Ns_561: bitstring = dec(wNs_558,skCli) in
                                        {90}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                        {91}event endCli(Sess,Cli,Ns_561)
                            )
                            else
                                {92}let pkSess_562: bitstring = fail-any in
                                {93}out(c, GetEndpointRequest);
                                {94}in(c, (=GetEndpointResponse,=pkSess_562,=None,SP_563: bitstring,UP_564: bitstring));
                                {95}new Nc_565: bitstring;
                                {96}let wNc_566: bitstring = enc(Nc_565,pkSess_562) in
                                {97}let m1_567: bitstring = (OpenSecureChannelRequest,pkCli,wNc_566) in
                                {98}event beginCli(Cli,Sess,Nc_565);
                                {99}out(c, (pkCli,m1_567));
                                {100}in(c, em2_568: bitstring);
                                {101}let m2_569: bitstring = em2_568 in
                                {102}let (=OpenSecureChannelResponse,wNs_570: bitstring,ST_571: bitstring,TTL_572: bitstring) = m2_569 in
                                {103}let Ns_573: bitstring = dec(wNs_570,skCli) in
                                {104}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                {105}event endCli(Sess,Cli,Ns_573)
                    )
                    else
                        {106}let pkSess_574: bitstring = fail-any in
                        {107}out(c, GetEndpointRequest);
                        {108}in(c, (=GetEndpointResponse,=pkSess_574,=None,SP_575: bitstring,UP_576: bitstring));
                        {109}new Nc_577: bitstring;
                        {110}let wNc_578: bitstring = enc(Nc_577,pkSess_574) in
                        {111}let m1_579: bitstring = (OpenSecureChannelRequest,pkCli,wNc_578) in
                        {112}event beginCli(Cli,Sess,Nc_577);
                        {113}out(c, (pkCli,m1_579));
                        {114}in(c, em2_580: bitstring);
                        {115}let m2_581: bitstring = em2_580 in
                        {116}let (=OpenSecureChannelResponse,wNs_582: bitstring,ST_583: bitstring,TTL_584: bitstring) = m2_581 in
                        {117}let Ns_585: bitstring = dec(wNs_582,skCli) in
                        {118}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                        {119}event endCli(Sess,Cli,Ns_585)
                )
                else
                    {120}let v_586: bool = (Disco = B) in
                    (
                        {121}if v_586 then
                        (
                            {122}let pkDisco_587: bitstring = pub(skB) in
                            {123}let v_588: bool = (Sess = A) in
                            (
                                {124}if v_588 then
                                (
                                    {125}let pkSess_589: bitstring = pub(skA) in
                                    {126}out(c, GetEndpointRequest);
                                    {127}in(c, (=GetEndpointResponse,=pkSess_589,=None,SP_590: bitstring,UP_591: bitstring));
                                    {128}new Nc_592: bitstring;
                                    {129}let wNc_593: bitstring = enc(Nc_592,pkSess_589) in
                                    {130}let m1_594: bitstring = (OpenSecureChannelRequest,pkCli,wNc_593) in
                                    {131}event beginCli(Cli,Sess,Nc_592);
                                    {132}out(c, (pkCli,m1_594));
                                    {133}in(c, em2_595: bitstring);
                                    {134}let m2_596: bitstring = em2_595 in
                                    {135}let (=OpenSecureChannelResponse,wNs_597: bitstring,ST_598: bitstring,TTL_599: bitstring) = m2_596 in
                                    {136}let Ns_600: bitstring = dec(wNs_597,skCli) in
                                    {137}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                    {138}event endCli(Sess,Cli,Ns_600)
                                )
                                else
                                    {139}let v_601: bool = (Sess = B) in
                                    (
                                        {140}if v_601 then
                                        (
                                            {141}let pkSess_602: bitstring = pub(skB) in
                                            {142}out(c, GetEndpointRequest);
                                            {143}in(c, (=GetEndpointResponse,=pkSess_602,=None,SP_603: bitstring,UP_604: bitstring));
                                            {144}new Nc_605: bitstring;
                                            {145}let wNc_606: bitstring = enc(Nc_605,pkSess_602) in
                                            {146}let m1_607: bitstring = (OpenSecureChannelRequest,pkCli,wNc_606) in
                                            {147}event beginCli(Cli,Sess,Nc_605);
                                            {148}out(c, (pkCli,m1_607));
                                            {149}in(c, em2_608: bitstring);
                                            {150}let m2_609: bitstring = em2_608 in
                                            {151}let (=OpenSecureChannelResponse,wNs_610: bitstring,ST_611: bitstring,TTL_612: bitstring) = m2_609 in
                                            {152}let Ns_613: bitstring = dec(wNs_610,skCli) in
                                            {153}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {154}event endCli(Sess,Cli,Ns_613)
                                        )
                                        else
                                            {155}let v_614: bool = (Sess = C) in
                                            (
                                                {156}if v_614 then
                                                (
                                                    {157}let pkSess_615: bitstring = pub(skC) in
                                                    {158}out(c, GetEndpointRequest);
                                                    {159}in(c, (=GetEndpointResponse,=pkSess_615,=None,SP_616: bitstring,UP_617: bitstring));
                                                    {160}new Nc_618: bitstring;
                                                    {161}let wNc_619: bitstring = enc(Nc_618,pkSess_615) in
                                                    {162}let m1_620: bitstring = (OpenSecureChannelRequest,pkCli,wNc_619) in
                                                    {163}event beginCli(Cli,Sess,Nc_618);
                                                    {164}out(c, (pkCli,m1_620));
                                                    {165}in(c, em2_621: bitstring);
                                                    {166}let m2_622: bitstring = em2_621 in
                                                    {167}let (=OpenSecureChannelResponse,wNs_623: bitstring,ST_624: bitstring,TTL_625: bitstring) = m2_622 in
                                                    {168}let Ns_626: bitstring = dec(wNs_623,skCli) in
                                                    {169}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {170}event endCli(Sess,Cli,Ns_626)
                                                )
                                                else
                                                    {171}let pkSess_627: bitstring = pub(sk(Sess)) in
                                                    {172}out(c, GetEndpointRequest);
                                                    {173}in(c, (=GetEndpointResponse,=pkSess_627,=None,SP_628: bitstring,UP_629: bitstring));
                                                    {174}new Nc_630: bitstring;
                                                    {175}let wNc_631: bitstring = enc(Nc_630,pkSess_627) in
                                                    {176}let m1_632: bitstring = (OpenSecureChannelRequest,pkCli,wNc_631) in
                                                    {177}event beginCli(Cli,Sess,Nc_630);
                                                    {178}out(c, (pkCli,m1_632));
                                                    {179}in(c, em2_633: bitstring);
                                                    {180}let m2_634: bitstring = em2_633 in
                                                    {181}let (=OpenSecureChannelResponse,wNs_635: bitstring,ST_636: bitstring,TTL_637: bitstring) = m2_634 in
                                                    {182}let Ns_638: bitstring = dec(wNs_635,skCli) in
                                                    {183}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {184}event endCli(Sess,Cli,Ns_638)
                                            )
                                            else
                                                {185}let pkSess_639: bitstring = fail-any in
                                                {186}out(c, GetEndpointRequest);
                                                {187}in(c, (=GetEndpointResponse,=pkSess_639,=None,SP_640: bitstring,UP_641: bitstring));
                                                {188}new Nc_642: bitstring;
                                                {189}let wNc_643: bitstring = enc(Nc_642,pkSess_639) in
                                                {190}let m1_644: bitstring = (OpenSecureChannelRequest,pkCli,wNc_643) in
                                                {191}event beginCli(Cli,Sess,Nc_642);
                                                {192}out(c, (pkCli,m1_644));
                                                {193}in(c, em2_645: bitstring);
                                                {194}let m2_646: bitstring = em2_645 in
                                                {195}let (=OpenSecureChannelResponse,wNs_647: bitstring,ST_648: bitstring,TTL_649: bitstring) = m2_646 in
                                                {196}let Ns_650: bitstring = dec(wNs_647,skCli) in
                                                {197}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {198}event endCli(Sess,Cli,Ns_650)
                                    )
                                    else
                                        {199}let pkSess_651: bitstring = fail-any in
                                        {200}out(c, GetEndpointRequest);
                                        {201}in(c, (=GetEndpointResponse,=pkSess_651,=None,SP_652: bitstring,UP_653: bitstring));
                                        {202}new Nc_654: bitstring;
                                        {203}let wNc_655: bitstring = enc(Nc_654,pkSess_651) in
                                        {204}let m1_656: bitstring = (OpenSecureChannelRequest,pkCli,wNc_655) in
                                        {205}event beginCli(Cli,Sess,Nc_654);
                                        {206}out(c, (pkCli,m1_656));
                                        {207}in(c, em2_657: bitstring);
                                        {208}let m2_658: bitstring = em2_657 in
                                        {209}let (=OpenSecureChannelResponse,wNs_659: bitstring,ST_660: bitstring,TTL_661: bitstring) = m2_658 in
                                        {210}let Ns_662: bitstring = dec(wNs_659,skCli) in
                                        {211}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                        {212}event endCli(Sess,Cli,Ns_662)
                            )
                            else
                                {213}let pkSess_663: bitstring = fail-any in
                                {214}out(c, GetEndpointRequest);
                                {215}in(c, (=GetEndpointResponse,=pkSess_663,=None,SP_664: bitstring,UP_665: bitstring));
                                {216}new Nc_666: bitstring;
                                {217}let wNc_667: bitstring = enc(Nc_666,pkSess_663) in
                                {218}let m1_668: bitstring = (OpenSecureChannelRequest,pkCli,wNc_667) in
                                {219}event beginCli(Cli,Sess,Nc_666);
                                {220}out(c, (pkCli,m1_668));
                                {221}in(c, em2_669: bitstring);
                                {222}let m2_670: bitstring = em2_669 in
                                {223}let (=OpenSecureChannelResponse,wNs_671: bitstring,ST_672: bitstring,TTL_673: bitstring) = m2_670 in
                                {224}let Ns_674: bitstring = dec(wNs_671,skCli) in
                                {225}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                {226}event endCli(Sess,Cli,Ns_674)
                        )
                        else
                            {227}let v_675: bool = (Disco = C) in
                            (
                                {228}if v_675 then
                                (
                                    {229}let pkDisco_676: bitstring = pub(skC) in
                                    {230}let v_677: bool = (Sess = A) in
                                    (
                                        {231}if v_677 then
                                        (
                                            {232}let pkSess_678: bitstring = pub(skA) in
                                            {233}out(c, GetEndpointRequest);
                                            {234}in(c, (=GetEndpointResponse,=pkSess_678,=None,SP_679: bitstring,UP_680: bitstring));
                                            {235}new Nc_681: bitstring;
                                            {236}let wNc_682: bitstring = enc(Nc_681,pkSess_678) in
                                            {237}let m1_683: bitstring = (OpenSecureChannelRequest,pkCli,wNc_682) in
                                            {238}event beginCli(Cli,Sess,Nc_681);
                                            {239}out(c, (pkCli,m1_683));
                                            {240}in(c, em2_684: bitstring);
                                            {241}let m2_685: bitstring = em2_684 in
                                            {242}let (=OpenSecureChannelResponse,wNs_686: bitstring,ST_687: bitstring,TTL_688: bitstring) = m2_685 in
                                            {243}let Ns_689: bitstring = dec(wNs_686,skCli) in
                                            {244}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {245}event endCli(Sess,Cli,Ns_689)
                                        )
                                        else
                                            {246}let v_690: bool = (Sess = B) in
                                            (
                                                {247}if v_690 then
                                                (
                                                    {248}let pkSess_691: bitstring = pub(skB) in
                                                    {249}out(c, GetEndpointRequest);
                                                    {250}in(c, (=GetEndpointResponse,=pkSess_691,=None,SP_692: bitstring,UP_693: bitstring));
                                                    {251}new Nc_694: bitstring;
                                                    {252}let wNc_695: bitstring = enc(Nc_694,pkSess_691) in
                                                    {253}let m1_696: bitstring = (OpenSecureChannelRequest,pkCli,wNc_695) in
                                                    {254}event beginCli(Cli,Sess,Nc_694);
                                                    {255}out(c, (pkCli,m1_696));
                                                    {256}in(c, em2_697: bitstring);
                                                    {257}let m2_698: bitstring = em2_697 in
                                                    {258}let (=OpenSecureChannelResponse,wNs_699: bitstring,ST_700: bitstring,TTL_701: bitstring) = m2_698 in
                                                    {259}let Ns_702: bitstring = dec(wNs_699,skCli) in
                                                    {260}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {261}event endCli(Sess,Cli,Ns_702)
                                                )
                                                else
                                                    {262}let v_703: bool = (Sess = C) in
                                                    (
                                                        {263}if v_703 then
                                                        (
                                                            {264}let pkSess_704: bitstring = pub(skC) in
                                                            {265}out(c, GetEndpointRequest);
                                                            {266}in(c, (=GetEndpointResponse,=pkSess_704,=None,SP_705: bitstring,UP_706: bitstring));
                                                            {267}new Nc_707: bitstring;
                                                            {268}let wNc_708: bitstring = enc(Nc_707,pkSess_704) in
                                                            {269}let m1_709: bitstring = (OpenSecureChannelRequest,pkCli,wNc_708) in
                                                            {270}event beginCli(Cli,Sess,Nc_707);
                                                            {271}out(c, (pkCli,m1_709));
                                                            {272}in(c, em2_710: bitstring);
                                                            {273}let m2_711: bitstring = em2_710 in
                                                            {274}let (=OpenSecureChannelResponse,wNs_712: bitstring,ST_713: bitstring,TTL_714: bitstring) = m2_711 in
                                                            {275}let Ns_715: bitstring = dec(wNs_712,skCli) in
                                                            {276}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                            {277}event endCli(Sess,Cli,Ns_715)
                                                        )
                                                        else
                                                            {278}let pkSess_716: bitstring = pub(sk(Sess)) in
                                                            {279}out(c, GetEndpointRequest);
                                                            {280}in(c, (=GetEndpointResponse,=pkSess_716,=None,SP_717: bitstring,UP_718: bitstring));
                                                            {281}new Nc_719: bitstring;
                                                            {282}let wNc_720: bitstring = enc(Nc_719,pkSess_716) in
                                                            {283}let m1_721: bitstring = (OpenSecureChannelRequest,pkCli,wNc_720) in
                                                            {284}event beginCli(Cli,Sess,Nc_719);
                                                            {285}out(c, (pkCli,m1_721));
                                                            {286}in(c, em2_722: bitstring);
                                                            {287}let m2_723: bitstring = em2_722 in
                                                            {288}let (=OpenSecureChannelResponse,wNs_724: bitstring,ST_725: bitstring,TTL_726: bitstring) = m2_723 in
                                                            {289}let Ns_727: bitstring = dec(wNs_724,skCli) in
                                                            {290}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                            {291}event endCli(Sess,Cli,Ns_727)
                                                    )
                                                    else
                                                        {292}let pkSess_728: bitstring = fail-any in
                                                        {293}out(c, GetEndpointRequest);
                                                        {294}in(c, (=GetEndpointResponse,=pkSess_728,=None,SP_729: bitstring,UP_730: bitstring));
                                                        {295}new Nc_731: bitstring;
                                                        {296}let wNc_732: bitstring = enc(Nc_731,pkSess_728) in
                                                        {297}let m1_733: bitstring = (OpenSecureChannelRequest,pkCli,wNc_732) in
                                                        {298}event beginCli(Cli,Sess,Nc_731);
                                                        {299}out(c, (pkCli,m1_733));
                                                        {300}in(c, em2_734: bitstring);
                                                        {301}let m2_735: bitstring = em2_734 in
                                                        {302}let (=OpenSecureChannelResponse,wNs_736: bitstring,ST_737: bitstring,TTL_738: bitstring) = m2_735 in
                                                        {303}let Ns_739: bitstring = dec(wNs_736,skCli) in
                                                        {304}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {305}event endCli(Sess,Cli,Ns_739)
                                            )
                                            else
                                                {306}let pkSess_740: bitstring = fail-any in
                                                {307}out(c, GetEndpointRequest);
                                                {308}in(c, (=GetEndpointResponse,=pkSess_740,=None,SP_741: bitstring,UP_742: bitstring));
                                                {309}new Nc_743: bitstring;
                                                {310}let wNc_744: bitstring = enc(Nc_743,pkSess_740) in
                                                {311}let m1_745: bitstring = (OpenSecureChannelRequest,pkCli,wNc_744) in
                                                {312}event beginCli(Cli,Sess,Nc_743);
                                                {313}out(c, (pkCli,m1_745));
                                                {314}in(c, em2_746: bitstring);
                                                {315}let m2_747: bitstring = em2_746 in
                                                {316}let (=OpenSecureChannelResponse,wNs_748: bitstring,ST_749: bitstring,TTL_750: bitstring) = m2_747 in
                                                {317}let Ns_751: bitstring = dec(wNs_748,skCli) in
                                                {318}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {319}event endCli(Sess,Cli,Ns_751)
                                    )
                                    else
                                        {320}let pkSess_752: bitstring = fail-any in
                                        {321}out(c, GetEndpointRequest);
                                        {322}in(c, (=GetEndpointResponse,=pkSess_752,=None,SP_753: bitstring,UP_754: bitstring));
                                        {323}new Nc_755: bitstring;
                                        {324}let wNc_756: bitstring = enc(Nc_755,pkSess_752) in
                                        {325}let m1_757: bitstring = (OpenSecureChannelRequest,pkCli,wNc_756) in
                                        {326}event beginCli(Cli,Sess,Nc_755);
                                        {327}out(c, (pkCli,m1_757));
                                        {328}in(c, em2_758: bitstring);
                                        {329}let m2_759: bitstring = em2_758 in
                                        {330}let (=OpenSecureChannelResponse,wNs_760: bitstring,ST_761: bitstring,TTL_762: bitstring) = m2_759 in
                                        {331}let Ns_763: bitstring = dec(wNs_760,skCli) in
                                        {332}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                        {333}event endCli(Sess,Cli,Ns_763)
                                )
                                else
                                    {334}let pkDisco_764: bitstring = pub(sk(Disco)) in
                                    {335}let v_765: bool = (Sess = A) in
                                    (
                                        {336}if v_765 then
                                        (
                                            {337}let pkSess_766: bitstring = pub(skA) in
                                            {338}out(c, GetEndpointRequest);
                                            {339}in(c, (=GetEndpointResponse,=pkSess_766,=None,SP_767: bitstring,UP_768: bitstring));
                                            {340}new Nc_769: bitstring;
                                            {341}let wNc_770: bitstring = enc(Nc_769,pkSess_766) in
                                            {342}let m1_771: bitstring = (OpenSecureChannelRequest,pkCli,wNc_770) in
                                            {343}event beginCli(Cli,Sess,Nc_769);
                                            {344}out(c, (pkCli,m1_771));
                                            {345}in(c, em2_772: bitstring);
                                            {346}let m2_773: bitstring = em2_772 in
                                            {347}let (=OpenSecureChannelResponse,wNs_774: bitstring,ST_775: bitstring,TTL_776: bitstring) = m2_773 in
                                            {348}let Ns_777: bitstring = dec(wNs_774,skCli) in
                                            {349}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {350}event endCli(Sess,Cli,Ns_777)
                                        )
                                        else
                                            {351}let v_778: bool = (Sess = B) in
                                            (
                                                {352}if v_778 then
                                                (
                                                    {353}let pkSess_779: bitstring = pub(skB) in
                                                    {354}out(c, GetEndpointRequest);
                                                    {355}in(c, (=GetEndpointResponse,=pkSess_779,=None,SP_780: bitstring,UP_781: bitstring));
                                                    {356}new Nc_782: bitstring;
                                                    {357}let wNc_783: bitstring = enc(Nc_782,pkSess_779) in
                                                    {358}let m1_784: bitstring = (OpenSecureChannelRequest,pkCli,wNc_783) in
                                                    {359}event beginCli(Cli,Sess,Nc_782);
                                                    {360}out(c, (pkCli,m1_784));
                                                    {361}in(c, em2_785: bitstring);
                                                    {362}let m2_786: bitstring = em2_785 in
                                                    {363}let (=OpenSecureChannelResponse,wNs_787: bitstring,ST_788: bitstring,TTL_789: bitstring) = m2_786 in
                                                    {364}let Ns_790: bitstring = dec(wNs_787,skCli) in
                                                    {365}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {366}event endCli(Sess,Cli,Ns_790)
                                                )
                                                else
                                                    {367}let v_791: bool = (Sess = C) in
                                                    (
                                                        {368}if v_791 then
                                                        (
                                                            {369}let pkSess_792: bitstring = pub(skC) in
                                                            {370}out(c, GetEndpointRequest);
                                                            {371}in(c, (=GetEndpointResponse,=pkSess_792,=None,SP_793: bitstring,UP_794: bitstring));
                                                            {372}new Nc_795: bitstring;
                                                            {373}let wNc_796: bitstring = enc(Nc_795,pkSess_792) in
                                                            {374}let m1_797: bitstring = (OpenSecureChannelRequest,pkCli,wNc_796) in
                                                            {375}event beginCli(Cli,Sess,Nc_795);
                                                            {376}out(c, (pkCli,m1_797));
                                                            {377}in(c, em2_798: bitstring);
                                                            {378}let m2_799: bitstring = em2_798 in
                                                            {379}let (=OpenSecureChannelResponse,wNs_800: bitstring,ST_801: bitstring,TTL_802: bitstring) = m2_799 in
                                                            {380}let Ns_803: bitstring = dec(wNs_800,skCli) in
                                                            {381}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                            {382}event endCli(Sess,Cli,Ns_803)
                                                        )
                                                        else
                                                            {383}let pkSess_804: bitstring = pub(sk(Sess)) in
                                                            {384}out(c, GetEndpointRequest);
                                                            {385}in(c, (=GetEndpointResponse,=pkSess_804,=None,SP_805: bitstring,UP_806: bitstring));
                                                            {386}new Nc_807: bitstring;
                                                            {387}let wNc_808: bitstring = enc(Nc_807,pkSess_804) in
                                                            {388}let m1_809: bitstring = (OpenSecureChannelRequest,pkCli,wNc_808) in
                                                            {389}event beginCli(Cli,Sess,Nc_807);
                                                            {390}out(c, (pkCli,m1_809));
                                                            {391}in(c, em2_810: bitstring);
                                                            {392}let m2_811: bitstring = em2_810 in
                                                            {393}let (=OpenSecureChannelResponse,wNs_812: bitstring,ST_813: bitstring,TTL_814: bitstring) = m2_811 in
                                                            {394}let Ns_815: bitstring = dec(wNs_812,skCli) in
                                                            {395}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                            {396}event endCli(Sess,Cli,Ns_815)
                                                    )
                                                    else
                                                        {397}let pkSess_816: bitstring = fail-any in
                                                        {398}out(c, GetEndpointRequest);
                                                        {399}in(c, (=GetEndpointResponse,=pkSess_816,=None,SP_817: bitstring,UP_818: bitstring));
                                                        {400}new Nc_819: bitstring;
                                                        {401}let wNc_820: bitstring = enc(Nc_819,pkSess_816) in
                                                        {402}let m1_821: bitstring = (OpenSecureChannelRequest,pkCli,wNc_820) in
                                                        {403}event beginCli(Cli,Sess,Nc_819);
                                                        {404}out(c, (pkCli,m1_821));
                                                        {405}in(c, em2_822: bitstring);
                                                        {406}let m2_823: bitstring = em2_822 in
                                                        {407}let (=OpenSecureChannelResponse,wNs_824: bitstring,ST_825: bitstring,TTL_826: bitstring) = m2_823 in
                                                        {408}let Ns_827: bitstring = dec(wNs_824,skCli) in
                                                        {409}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {410}event endCli(Sess,Cli,Ns_827)
                                            )
                                            else
                                                {411}let pkSess_828: bitstring = fail-any in
                                                {412}out(c, GetEndpointRequest);
                                                {413}in(c, (=GetEndpointResponse,=pkSess_828,=None,SP_829: bitstring,UP_830: bitstring));
                                                {414}new Nc_831: bitstring;
                                                {415}let wNc_832: bitstring = enc(Nc_831,pkSess_828) in
                                                {416}let m1_833: bitstring = (OpenSecureChannelRequest,pkCli,wNc_832) in
                                                {417}event beginCli(Cli,Sess,Nc_831);
                                                {418}out(c, (pkCli,m1_833));
                                                {419}in(c, em2_834: bitstring);
                                                {420}let m2_835: bitstring = em2_834 in
                                                {421}let (=OpenSecureChannelResponse,wNs_836: bitstring,ST_837: bitstring,TTL_838: bitstring) = m2_835 in
                                                {422}let Ns_839: bitstring = dec(wNs_836,skCli) in
                                                {423}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {424}event endCli(Sess,Cli,Ns_839)
                                    )
                                    else
                                        {425}let pkSess_840: bitstring = fail-any in
                                        {426}out(c, GetEndpointRequest);
                                        {427}in(c, (=GetEndpointResponse,=pkSess_840,=None,SP_841: bitstring,UP_842: bitstring));
                                        {428}new Nc_843: bitstring;
                                        {429}let wNc_844: bitstring = enc(Nc_843,pkSess_840) in
                                        {430}let m1_845: bitstring = (OpenSecureChannelRequest,pkCli,wNc_844) in
                                        {431}event beginCli(Cli,Sess,Nc_843);
                                        {432}out(c, (pkCli,m1_845));
                                        {433}in(c, em2_846: bitstring);
                                        {434}let m2_847: bitstring = em2_846 in
                                        {435}let (=OpenSecureChannelResponse,wNs_848: bitstring,ST_849: bitstring,TTL_850: bitstring) = m2_847 in
                                        {436}let Ns_851: bitstring = dec(wNs_848,skCli) in
                                        {437}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                        {438}event endCli(Sess,Cli,Ns_851)
                            )
                            else
                                {439}let pkDisco_852: bitstring = fail-any in
                                {440}let v_853: bool = (Sess = A) in
                                (
                                    {441}if v_853 then
                                    (
                                        {442}let pkSess_854: bitstring = pub(skA) in
                                        {443}out(c, GetEndpointRequest);
                                        {444}in(c, (=GetEndpointResponse,=pkSess_854,=None,SP_855: bitstring,UP_856: bitstring));
                                        {445}new Nc_857: bitstring;
                                        {446}let wNc_858: bitstring = enc(Nc_857,pkSess_854) in
                                        {447}let m1_859: bitstring = (OpenSecureChannelRequest,pkCli,wNc_858) in
                                        {448}event beginCli(Cli,Sess,Nc_857);
                                        {449}out(c, (pkCli,m1_859));
                                        {450}in(c, em2_860: bitstring);
                                        {451}let m2_861: bitstring = em2_860 in
                                        {452}let (=OpenSecureChannelResponse,wNs_862: bitstring,ST_863: bitstring,TTL_864: bitstring) = m2_861 in
                                        {453}let Ns_865: bitstring = dec(wNs_862,skCli) in
                                        {454}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                        {455}event endCli(Sess,Cli,Ns_865)
                                    )
                                    else
                                        {456}let v_866: bool = (Sess = B) in
                                        (
                                            {457}if v_866 then
                                            (
                                                {458}let pkSess_867: bitstring = pub(skB) in
                                                {459}out(c, GetEndpointRequest);
                                                {460}in(c, (=GetEndpointResponse,=pkSess_867,=None,SP_868: bitstring,UP_869: bitstring));
                                                {461}new Nc_870: bitstring;
                                                {462}let wNc_871: bitstring = enc(Nc_870,pkSess_867) in
                                                {463}let m1_872: bitstring = (OpenSecureChannelRequest,pkCli,wNc_871) in
                                                {464}event beginCli(Cli,Sess,Nc_870);
                                                {465}out(c, (pkCli,m1_872));
                                                {466}in(c, em2_873: bitstring);
                                                {467}let m2_874: bitstring = em2_873 in
                                                {468}let (=OpenSecureChannelResponse,wNs_875: bitstring,ST_876: bitstring,TTL_877: bitstring) = m2_874 in
                                                {469}let Ns_878: bitstring = dec(wNs_875,skCli) in
                                                {470}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {471}event endCli(Sess,Cli,Ns_878)
                                            )
                                            else
                                                {472}let v_879: bool = (Sess = C) in
                                                (
                                                    {473}if v_879 then
                                                    (
                                                        {474}let pkSess_880: bitstring = pub(skC) in
                                                        {475}out(c, GetEndpointRequest);
                                                        {476}in(c, (=GetEndpointResponse,=pkSess_880,=None,SP_881: bitstring,UP_882: bitstring));
                                                        {477}new Nc_883: bitstring;
                                                        {478}let wNc_884: bitstring = enc(Nc_883,pkSess_880) in
                                                        {479}let m1_885: bitstring = (OpenSecureChannelRequest,pkCli,wNc_884) in
                                                        {480}event beginCli(Cli,Sess,Nc_883);
                                                        {481}out(c, (pkCli,m1_885));
                                                        {482}in(c, em2_886: bitstring);
                                                        {483}let m2_887: bitstring = em2_886 in
                                                        {484}let (=OpenSecureChannelResponse,wNs_888: bitstring,ST_889: bitstring,TTL_890: bitstring) = m2_887 in
                                                        {485}let Ns_891: bitstring = dec(wNs_888,skCli) in
                                                        {486}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {487}event endCli(Sess,Cli,Ns_891)
                                                    )
                                                    else
                                                        {488}let pkSess_892: bitstring = pub(sk(Sess)) in
                                                        {489}out(c, GetEndpointRequest);
                                                        {490}in(c, (=GetEndpointResponse,=pkSess_892,=None,SP_893: bitstring,UP_894: bitstring));
                                                        {491}new Nc_895: bitstring;
                                                        {492}let wNc_896: bitstring = enc(Nc_895,pkSess_892) in
                                                        {493}let m1_897: bitstring = (OpenSecureChannelRequest,pkCli,wNc_896) in
                                                        {494}event beginCli(Cli,Sess,Nc_895);
                                                        {495}out(c, (pkCli,m1_897));
                                                        {496}in(c, em2_898: bitstring);
                                                        {497}let m2_899: bitstring = em2_898 in
                                                        {498}let (=OpenSecureChannelResponse,wNs_900: bitstring,ST_901: bitstring,TTL_902: bitstring) = m2_899 in
                                                        {499}let Ns_903: bitstring = dec(wNs_900,skCli) in
                                                        {500}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {501}event endCli(Sess,Cli,Ns_903)
                                                )
                                                else
                                                    {502}let pkSess_904: bitstring = fail-any in
                                                    {503}out(c, GetEndpointRequest);
                                                    {504}in(c, (=GetEndpointResponse,=pkSess_904,=None,SP_905: bitstring,UP_906: bitstring));
                                                    {505}new Nc_907: bitstring;
                                                    {506}let wNc_908: bitstring = enc(Nc_907,pkSess_904) in
                                                    {507}let m1_909: bitstring = (OpenSecureChannelRequest,pkCli,wNc_908) in
                                                    {508}event beginCli(Cli,Sess,Nc_907);
                                                    {509}out(c, (pkCli,m1_909));
                                                    {510}in(c, em2_910: bitstring);
                                                    {511}let m2_911: bitstring = em2_910 in
                                                    {512}let (=OpenSecureChannelResponse,wNs_912: bitstring,ST_913: bitstring,TTL_914: bitstring) = m2_911 in
                                                    {513}let Ns_915: bitstring = dec(wNs_912,skCli) in
                                                    {514}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {515}event endCli(Sess,Cli,Ns_915)
                                        )
                                        else
                                            {516}let pkSess_916: bitstring = fail-any in
                                            {517}out(c, GetEndpointRequest);
                                            {518}in(c, (=GetEndpointResponse,=pkSess_916,=None,SP_917: bitstring,UP_918: bitstring));
                                            {519}new Nc_919: bitstring;
                                            {520}let wNc_920: bitstring = enc(Nc_919,pkSess_916) in
                                            {521}let m1_921: bitstring = (OpenSecureChannelRequest,pkCli,wNc_920) in
                                            {522}event beginCli(Cli,Sess,Nc_919);
                                            {523}out(c, (pkCli,m1_921));
                                            {524}in(c, em2_922: bitstring);
                                            {525}let m2_923: bitstring = em2_922 in
                                            {526}let (=OpenSecureChannelResponse,wNs_924: bitstring,ST_925: bitstring,TTL_926: bitstring) = m2_923 in
                                            {527}let Ns_927: bitstring = dec(wNs_924,skCli) in
                                            {528}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {529}event endCli(Sess,Cli,Ns_927)
                                )
                                else
                                    {530}let pkSess_928: bitstring = fail-any in
                                    {531}out(c, GetEndpointRequest);
                                    {532}in(c, (=GetEndpointResponse,=pkSess_928,=None,SP_929: bitstring,UP_930: bitstring));
                                    {533}new Nc_931: bitstring;
                                    {534}let wNc_932: bitstring = enc(Nc_931,pkSess_928) in
                                    {535}let m1_933: bitstring = (OpenSecureChannelRequest,pkCli,wNc_932) in
                                    {536}event beginCli(Cli,Sess,Nc_931);
                                    {537}out(c, (pkCli,m1_933));
                                    {538}in(c, em2_934: bitstring);
                                    {539}let m2_935: bitstring = em2_934 in
                                    {540}let (=OpenSecureChannelResponse,wNs_936: bitstring,ST_937: bitstring,TTL_938: bitstring) = m2_935 in
                                    {541}let Ns_939: bitstring = dec(wNs_936,skCli) in
                                    {542}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                    {543}event endCli(Sess,Cli,Ns_939)
                    )
                    else
                        {544}let pkDisco_940: bitstring = fail-any in
                        {545}let v_941: bool = (Sess = A) in
                        (
                            {546}if v_941 then
                            (
                                {547}let pkSess_942: bitstring = pub(skA) in
                                {548}out(c, GetEndpointRequest);
                                {549}in(c, (=GetEndpointResponse,=pkSess_942,=None,SP_943: bitstring,UP_944: bitstring));
                                {550}new Nc_945: bitstring;
                                {551}let wNc_946: bitstring = enc(Nc_945,pkSess_942) in
                                {552}let m1_947: bitstring = (OpenSecureChannelRequest,pkCli,wNc_946) in
                                {553}event beginCli(Cli,Sess,Nc_945);
                                {554}out(c, (pkCli,m1_947));
                                {555}in(c, em2_948: bitstring);
                                {556}let m2_949: bitstring = em2_948 in
                                {557}let (=OpenSecureChannelResponse,wNs_950: bitstring,ST_951: bitstring,TTL_952: bitstring) = m2_949 in
                                {558}let Ns_953: bitstring = dec(wNs_950,skCli) in
                                {559}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                {560}event endCli(Sess,Cli,Ns_953)
                            )
                            else
                                {561}let v_954: bool = (Sess = B) in
                                (
                                    {562}if v_954 then
                                    (
                                        {563}let pkSess_955: bitstring = pub(skB) in
                                        {564}out(c, GetEndpointRequest);
                                        {565}in(c, (=GetEndpointResponse,=pkSess_955,=None,SP_956: bitstring,UP_957: bitstring));
                                        {566}new Nc_958: bitstring;
                                        {567}let wNc_959: bitstring = enc(Nc_958,pkSess_955) in
                                        {568}let m1_960: bitstring = (OpenSecureChannelRequest,pkCli,wNc_959) in
                                        {569}event beginCli(Cli,Sess,Nc_958);
                                        {570}out(c, (pkCli,m1_960));
                                        {571}in(c, em2_961: bitstring);
                                        {572}let m2_962: bitstring = em2_961 in
                                        {573}let (=OpenSecureChannelResponse,wNs_963: bitstring,ST_964: bitstring,TTL_965: bitstring) = m2_962 in
                                        {574}let Ns_966: bitstring = dec(wNs_963,skCli) in
                                        {575}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                        {576}event endCli(Sess,Cli,Ns_966)
                                    )
                                    else
                                        {577}let v_967: bool = (Sess = C) in
                                        (
                                            {578}if v_967 then
                                            (
                                                {579}let pkSess_968: bitstring = pub(skC) in
                                                {580}out(c, GetEndpointRequest);
                                                {581}in(c, (=GetEndpointResponse,=pkSess_968,=None,SP_969: bitstring,UP_970: bitstring));
                                                {582}new Nc_971: bitstring;
                                                {583}let wNc_972: bitstring = enc(Nc_971,pkSess_968) in
                                                {584}let m1_973: bitstring = (OpenSecureChannelRequest,pkCli,wNc_972) in
                                                {585}event beginCli(Cli,Sess,Nc_971);
                                                {586}out(c, (pkCli,m1_973));
                                                {587}in(c, em2_974: bitstring);
                                                {588}let m2_975: bitstring = em2_974 in
                                                {589}let (=OpenSecureChannelResponse,wNs_976: bitstring,ST_977: bitstring,TTL_978: bitstring) = m2_975 in
                                                {590}let Ns_979: bitstring = dec(wNs_976,skCli) in
                                                {591}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {592}event endCli(Sess,Cli,Ns_979)
                                            )
                                            else
                                                {593}let pkSess_980: bitstring = pub(sk(Sess)) in
                                                {594}out(c, GetEndpointRequest);
                                                {595}in(c, (=GetEndpointResponse,=pkSess_980,=None,SP_981: bitstring,UP_982: bitstring));
                                                {596}new Nc_983: bitstring;
                                                {597}let wNc_984: bitstring = enc(Nc_983,pkSess_980) in
                                                {598}let m1_985: bitstring = (OpenSecureChannelRequest,pkCli,wNc_984) in
                                                {599}event beginCli(Cli,Sess,Nc_983);
                                                {600}out(c, (pkCli,m1_985));
                                                {601}in(c, em2_986: bitstring);
                                                {602}let m2_987: bitstring = em2_986 in
                                                {603}let (=OpenSecureChannelResponse,wNs_988: bitstring,ST_989: bitstring,TTL_990: bitstring) = m2_987 in
                                                {604}let Ns_991: bitstring = dec(wNs_988,skCli) in
                                                {605}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {606}event endCli(Sess,Cli,Ns_991)
                                        )
                                        else
                                            {607}let pkSess_992: bitstring = fail-any in
                                            {608}out(c, GetEndpointRequest);
                                            {609}in(c, (=GetEndpointResponse,=pkSess_992,=None,SP_993: bitstring,UP_994: bitstring));
                                            {610}new Nc_995: bitstring;
                                            {611}let wNc_996: bitstring = enc(Nc_995,pkSess_992) in
                                            {612}let m1_997: bitstring = (OpenSecureChannelRequest,pkCli,wNc_996) in
                                            {613}event beginCli(Cli,Sess,Nc_995);
                                            {614}out(c, (pkCli,m1_997));
                                            {615}in(c, em2_998: bitstring);
                                            {616}let m2_999: bitstring = em2_998 in
                                            {617}let (=OpenSecureChannelResponse,wNs_1000: bitstring,ST_1001: bitstring,TTL_1002: bitstring) = m2_999 in
                                            {618}let Ns_1003: bitstring = dec(wNs_1000,skCli) in
                                            {619}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {620}event endCli(Sess,Cli,Ns_1003)
                                )
                                else
                                    {621}let pkSess_1004: bitstring = fail-any in
                                    {622}out(c, GetEndpointRequest);
                                    {623}in(c, (=GetEndpointResponse,=pkSess_1004,=None,SP_1005: bitstring,UP_1006: bitstring));
                                    {624}new Nc_1007: bitstring;
                                    {625}let wNc_1008: bitstring = enc(Nc_1007,pkSess_1004) in
                                    {626}let m1_1009: bitstring = (OpenSecureChannelRequest,pkCli,wNc_1008) in
                                    {627}event beginCli(Cli,Sess,Nc_1007);
                                    {628}out(c, (pkCli,m1_1009));
                                    {629}in(c, em2_1010: bitstring);
                                    {630}let m2_1011: bitstring = em2_1010 in
                                    {631}let (=OpenSecureChannelResponse,wNs_1012: bitstring,ST_1013: bitstring,TTL_1014: bitstring) = m2_1011 in
                                    {632}let Ns_1015: bitstring = dec(wNs_1012,skCli) in
                                    {633}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                    {634}event endCli(Sess,Cli,Ns_1015)
                        )
                        else
                            {635}let pkSess_1016: bitstring = fail-any in
                            {636}out(c, GetEndpointRequest);
                            {637}in(c, (=GetEndpointResponse,=pkSess_1016,=None,SP_1017: bitstring,UP_1018: bitstring));
                            {638}new Nc_1019: bitstring;
                            {639}let wNc_1020: bitstring = enc(Nc_1019,pkSess_1016) in
                            {640}let m1_1021: bitstring = (OpenSecureChannelRequest,pkCli,wNc_1020) in
                            {641}event beginCli(Cli,Sess,Nc_1019);
                            {642}out(c, (pkCli,m1_1021));
                            {643}in(c, em2_1022: bitstring);
                            {644}let m2_1023: bitstring = em2_1022 in
                            {645}let (=OpenSecureChannelResponse,wNs_1024: bitstring,ST_1025: bitstring,TTL_1026: bitstring) = m2_1023 in
                            {646}let Ns_1027: bitstring = dec(wNs_1024,skCli) in
                            {647}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                            {648}event endCli(Sess,Cli,Ns_1027)
            )
            else
                {649}let pkDisco_1028: bitstring = fail-any in
                {650}let v_1029: bool = (Sess = A) in
                (
                    {651}if v_1029 then
                    (
                        {652}let pkSess_1030: bitstring = pub(skA) in
                        {653}out(c, GetEndpointRequest);
                        {654}in(c, (=GetEndpointResponse,=pkSess_1030,=None,SP_1031: bitstring,UP_1032: bitstring));
                        {655}new Nc_1033: bitstring;
                        {656}let wNc_1034: bitstring = enc(Nc_1033,pkSess_1030) in
                        {657}let m1_1035: bitstring = (OpenSecureChannelRequest,pkCli,wNc_1034) in
                        {658}event beginCli(Cli,Sess,Nc_1033);
                        {659}out(c, (pkCli,m1_1035));
                        {660}in(c, em2_1036: bitstring);
                        {661}let m2_1037: bitstring = em2_1036 in
                        {662}let (=OpenSecureChannelResponse,wNs_1038: bitstring,ST_1039: bitstring,TTL_1040: bitstring) = m2_1037 in
                        {663}let Ns_1041: bitstring = dec(wNs_1038,skCli) in
                        {664}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                        {665}event endCli(Sess,Cli,Ns_1041)
                    )
                    else
                        {666}let v_1042: bool = (Sess = B) in
                        (
                            {667}if v_1042 then
                            (
                                {668}let pkSess_1043: bitstring = pub(skB) in
                                {669}out(c, GetEndpointRequest);
                                {670}in(c, (=GetEndpointResponse,=pkSess_1043,=None,SP_1044: bitstring,UP_1045: bitstring));
                                {671}new Nc_1046: bitstring;
                                {672}let wNc_1047: bitstring = enc(Nc_1046,pkSess_1043) in
                                {673}let m1_1048: bitstring = (OpenSecureChannelRequest,pkCli,wNc_1047) in
                                {674}event beginCli(Cli,Sess,Nc_1046);
                                {675}out(c, (pkCli,m1_1048));
                                {676}in(c, em2_1049: bitstring);
                                {677}let m2_1050: bitstring = em2_1049 in
                                {678}let (=OpenSecureChannelResponse,wNs_1051: bitstring,ST_1052: bitstring,TTL_1053: bitstring) = m2_1050 in
                                {679}let Ns_1054: bitstring = dec(wNs_1051,skCli) in
                                {680}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                {681}event endCli(Sess,Cli,Ns_1054)
                            )
                            else
                                {682}let v_1055: bool = (Sess = C) in
                                (
                                    {683}if v_1055 then
                                    (
                                        {684}let pkSess_1056: bitstring = pub(skC) in
                                        {685}out(c, GetEndpointRequest);
                                        {686}in(c, (=GetEndpointResponse,=pkSess_1056,=None,SP_1057: bitstring,UP_1058: bitstring));
                                        {687}new Nc_1059: bitstring;
                                        {688}let wNc_1060: bitstring = enc(Nc_1059,pkSess_1056) in
                                        {689}let m1_1061: bitstring = (OpenSecureChannelRequest,pkCli,wNc_1060) in
                                        {690}event beginCli(Cli,Sess,Nc_1059);
                                        {691}out(c, (pkCli,m1_1061));
                                        {692}in(c, em2_1062: bitstring);
                                        {693}let m2_1063: bitstring = em2_1062 in
                                        {694}let (=OpenSecureChannelResponse,wNs_1064: bitstring,ST_1065: bitstring,TTL_1066: bitstring) = m2_1063 in
                                        {695}let Ns_1067: bitstring = dec(wNs_1064,skCli) in
                                        {696}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                        {697}event endCli(Sess,Cli,Ns_1067)
                                    )
                                    else
                                        {698}let pkSess_1068: bitstring = pub(sk(Sess)) in
                                        {699}out(c, GetEndpointRequest);
                                        {700}in(c, (=GetEndpointResponse,=pkSess_1068,=None,SP_1069: bitstring,UP_1070: bitstring));
                                        {701}new Nc_1071: bitstring;
                                        {702}let wNc_1072: bitstring = enc(Nc_1071,pkSess_1068) in
                                        {703}let m1_1073: bitstring = (OpenSecureChannelRequest,pkCli,wNc_1072) in
                                        {704}event beginCli(Cli,Sess,Nc_1071);
                                        {705}out(c, (pkCli,m1_1073));
                                        {706}in(c, em2_1074: bitstring);
                                        {707}let m2_1075: bitstring = em2_1074 in
                                        {708}let (=OpenSecureChannelResponse,wNs_1076: bitstring,ST_1077: bitstring,TTL_1078: bitstring) = m2_1075 in
                                        {709}let Ns_1079: bitstring = dec(wNs_1076,skCli) in
                                        {710}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                        {711}event endCli(Sess,Cli,Ns_1079)
                                )
                                else
                                    {712}let pkSess_1080: bitstring = fail-any in
                                    {713}out(c, GetEndpointRequest);
                                    {714}in(c, (=GetEndpointResponse,=pkSess_1080,=None,SP_1081: bitstring,UP_1082: bitstring));
                                    {715}new Nc_1083: bitstring;
                                    {716}let wNc_1084: bitstring = enc(Nc_1083,pkSess_1080) in
                                    {717}let m1_1085: bitstring = (OpenSecureChannelRequest,pkCli,wNc_1084) in
                                    {718}event beginCli(Cli,Sess,Nc_1083);
                                    {719}out(c, (pkCli,m1_1085));
                                    {720}in(c, em2_1086: bitstring);
                                    {721}let m2_1087: bitstring = em2_1086 in
                                    {722}let (=OpenSecureChannelResponse,wNs_1088: bitstring,ST_1089: bitstring,TTL_1090: bitstring) = m2_1087 in
                                    {723}let Ns_1091: bitstring = dec(wNs_1088,skCli) in
                                    {724}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                    {725}event endCli(Sess,Cli,Ns_1091)
                        )
                        else
                            {726}let pkSess_1092: bitstring = fail-any in
                            {727}out(c, GetEndpointRequest);
                            {728}in(c, (=GetEndpointResponse,=pkSess_1092,=None,SP_1093: bitstring,UP_1094: bitstring));
                            {729}new Nc_1095: bitstring;
                            {730}let wNc_1096: bitstring = enc(Nc_1095,pkSess_1092) in
                            {731}let m1_1097: bitstring = (OpenSecureChannelRequest,pkCli,wNc_1096) in
                            {732}event beginCli(Cli,Sess,Nc_1095);
                            {733}out(c, (pkCli,m1_1097));
                            {734}in(c, em2_1098: bitstring);
                            {735}let m2_1099: bitstring = em2_1098 in
                            {736}let (=OpenSecureChannelResponse,wNs_1100: bitstring,ST_1101: bitstring,TTL_1102: bitstring) = m2_1099 in
                            {737}let Ns_1103: bitstring = dec(wNs_1100,skCli) in
                            {738}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                            {739}event endCli(Sess,Cli,Ns_1103)
                )
                else
                    {740}let pkSess_1104: bitstring = fail-any in
                    {741}out(c, GetEndpointRequest);
                    {742}in(c, (=GetEndpointResponse,=pkSess_1104,=None,SP_1105: bitstring,UP_1106: bitstring));
                    {743}new Nc_1107: bitstring;
                    {744}let wNc_1108: bitstring = enc(Nc_1107,pkSess_1104) in
                    {745}let m1_1109: bitstring = (OpenSecureChannelRequest,pkCli,wNc_1108) in
                    {746}event beginCli(Cli,Sess,Nc_1107);
                    {747}out(c, (pkCli,m1_1109));
                    {748}in(c, em2_1110: bitstring);
                    {749}let m2_1111: bitstring = em2_1110 in
                    {750}let (=OpenSecureChannelResponse,wNs_1112: bitstring,ST_1113: bitstring,TTL_1114: bitstring) = m2_1111 in
                    {751}let Ns_1115: bitstring = dec(wNs_1112,skCli) in
                    {752}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                    {753}event endCli(Sess,Cli,Ns_1115)
        )
        else
            {754}let v_1116: bool = (Cli = B) in
            (
                {755}if v_1116 then
                (
                    {756}let skCli_1117: bitstring = skB in
                    {757}let pkCli_1118: bitstring = pub(skCli_1117) in
                    {758}let v_1119: bool = (Disco = A) in
                    (
                        {759}if v_1119 then
                        (
                            {760}let pkDisco_1120: bitstring = pub(skA) in
                            {761}let v_1121: bool = (Sess = A) in
                            (
                                {762}if v_1121 then
                                (
                                    {763}let pkSess_1122: bitstring = pub(skA) in
                                    {764}out(c, GetEndpointRequest);
                                    {765}in(c, (=GetEndpointResponse,=pkSess_1122,=None,SP_1123: bitstring,UP_1124: bitstring));
                                    {766}new Nc_1125: bitstring;
                                    {767}let wNc_1126: bitstring = enc(Nc_1125,pkSess_1122) in
                                    {768}let m1_1127: bitstring = (OpenSecureChannelRequest,pkCli_1118,wNc_1126) in
                                    {769}event beginCli(Cli,Sess,Nc_1125);
                                    {770}out(c, (pkCli_1118,m1_1127));
                                    {771}in(c, em2_1128: bitstring);
                                    {772}let m2_1129: bitstring = em2_1128 in
                                    {773}let (=OpenSecureChannelResponse,wNs_1130: bitstring,ST_1131: bitstring,TTL_1132: bitstring) = m2_1129 in
                                    {774}let Ns_1133: bitstring = dec(wNs_1130,skCli_1117) in
                                    {775}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                    {776}event endCli(Sess,Cli,Ns_1133)
                                )
                                else
                                    {777}let v_1134: bool = (Sess = B) in
                                    (
                                        {778}if v_1134 then
                                        (
                                            {779}let pkSess_1135: bitstring = pub(skB) in
                                            {780}out(c, GetEndpointRequest);
                                            {781}in(c, (=GetEndpointResponse,=pkSess_1135,=None,SP_1136: bitstring,UP_1137: bitstring));
                                            {782}new Nc_1138: bitstring;
                                            {783}let wNc_1139: bitstring = enc(Nc_1138,pkSess_1135) in
                                            {784}let m1_1140: bitstring = (OpenSecureChannelRequest,pkCli_1118,wNc_1139) in
                                            {785}event beginCli(Cli,Sess,Nc_1138);
                                            {786}out(c, (pkCli_1118,m1_1140));
                                            {787}in(c, em2_1141: bitstring);
                                            {788}let m2_1142: bitstring = em2_1141 in
                                            {789}let (=OpenSecureChannelResponse,wNs_1143: bitstring,ST_1144: bitstring,TTL_1145: bitstring) = m2_1142 in
                                            {790}let Ns_1146: bitstring = dec(wNs_1143,skCli_1117) in
                                            {791}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {792}event endCli(Sess,Cli,Ns_1146)
                                        )
                                        else
                                            {793}let v_1147: bool = (Sess = C) in
                                            (
                                                {794}if v_1147 then
                                                (
                                                    {795}let pkSess_1148: bitstring = pub(skC) in
                                                    {796}out(c, GetEndpointRequest);
                                                    {797}in(c, (=GetEndpointResponse,=pkSess_1148,=None,SP_1149: bitstring,UP_1150: bitstring));
                                                    {798}new Nc_1151: bitstring;
                                                    {799}let wNc_1152: bitstring = enc(Nc_1151,pkSess_1148) in
                                                    {800}let m1_1153: bitstring = (OpenSecureChannelRequest,pkCli_1118,wNc_1152) in
                                                    {801}event beginCli(Cli,Sess,Nc_1151);
                                                    {802}out(c, (pkCli_1118,m1_1153));
                                                    {803}in(c, em2_1154: bitstring);
                                                    {804}let m2_1155: bitstring = em2_1154 in
                                                    {805}let (=OpenSecureChannelResponse,wNs_1156: bitstring,ST_1157: bitstring,TTL_1158: bitstring) = m2_1155 in
                                                    {806}let Ns_1159: bitstring = dec(wNs_1156,skCli_1117) in
                                                    {807}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {808}event endCli(Sess,Cli,Ns_1159)
                                                )
                                                else
                                                    {809}let pkSess_1160: bitstring = pub(sk(Sess)) in
                                                    {810}out(c, GetEndpointRequest);
                                                    {811}in(c, (=GetEndpointResponse,=pkSess_1160,=None,SP_1161: bitstring,UP_1162: bitstring));
                                                    {812}new Nc_1163: bitstring;
                                                    {813}let wNc_1164: bitstring = enc(Nc_1163,pkSess_1160) in
                                                    {814}let m1_1165: bitstring = (OpenSecureChannelRequest,pkCli_1118,wNc_1164) in
                                                    {815}event beginCli(Cli,Sess,Nc_1163);
                                                    {816}out(c, (pkCli_1118,m1_1165));
                                                    {817}in(c, em2_1166: bitstring);
                                                    {818}let m2_1167: bitstring = em2_1166 in
                                                    {819}let (=OpenSecureChannelResponse,wNs_1168: bitstring,ST_1169: bitstring,TTL_1170: bitstring) = m2_1167 in
                                                    {820}let Ns_1171: bitstring = dec(wNs_1168,skCli_1117) in
                                                    {821}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {822}event endCli(Sess,Cli,Ns_1171)
                                            )
                                            else
                                                {823}let pkSess_1172: bitstring = fail-any in
                                                {824}out(c, GetEndpointRequest);
                                                {825}in(c, (=GetEndpointResponse,=pkSess_1172,=None,SP_1173: bitstring,UP_1174: bitstring));
                                                {826}new Nc_1175: bitstring;
                                                {827}let wNc_1176: bitstring = enc(Nc_1175,pkSess_1172) in
                                                {828}let m1_1177: bitstring = (OpenSecureChannelRequest,pkCli_1118,wNc_1176) in
                                                {829}event beginCli(Cli,Sess,Nc_1175);
                                                {830}out(c, (pkCli_1118,m1_1177));
                                                {831}in(c, em2_1178: bitstring);
                                                {832}let m2_1179: bitstring = em2_1178 in
                                                {833}let (=OpenSecureChannelResponse,wNs_1180: bitstring,ST_1181: bitstring,TTL_1182: bitstring) = m2_1179 in
                                                {834}let Ns_1183: bitstring = dec(wNs_1180,skCli_1117) in
                                                {835}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {836}event endCli(Sess,Cli,Ns_1183)
                                    )
                                    else
                                        {837}let pkSess_1184: bitstring = fail-any in
                                        {838}out(c, GetEndpointRequest);
                                        {839}in(c, (=GetEndpointResponse,=pkSess_1184,=None,SP_1185: bitstring,UP_1186: bitstring));
                                        {840}new Nc_1187: bitstring;
                                        {841}let wNc_1188: bitstring = enc(Nc_1187,pkSess_1184) in
                                        {842}let m1_1189: bitstring = (OpenSecureChannelRequest,pkCli_1118,wNc_1188) in
                                        {843}event beginCli(Cli,Sess,Nc_1187);
                                        {844}out(c, (pkCli_1118,m1_1189));
                                        {845}in(c, em2_1190: bitstring);
                                        {846}let m2_1191: bitstring = em2_1190 in
                                        {847}let (=OpenSecureChannelResponse,wNs_1192: bitstring,ST_1193: bitstring,TTL_1194: bitstring) = m2_1191 in
                                        {848}let Ns_1195: bitstring = dec(wNs_1192,skCli_1117) in
                                        {849}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                        {850}event endCli(Sess,Cli,Ns_1195)
                            )
                            else
                                {851}let pkSess_1196: bitstring = fail-any in
                                {852}out(c, GetEndpointRequest);
                                {853}in(c, (=GetEndpointResponse,=pkSess_1196,=None,SP_1197: bitstring,UP_1198: bitstring));
                                {854}new Nc_1199: bitstring;
                                {855}let wNc_1200: bitstring = enc(Nc_1199,pkSess_1196) in
                                {856}let m1_1201: bitstring = (OpenSecureChannelRequest,pkCli_1118,wNc_1200) in
                                {857}event beginCli(Cli,Sess,Nc_1199);
                                {858}out(c, (pkCli_1118,m1_1201));
                                {859}in(c, em2_1202: bitstring);
                                {860}let m2_1203: bitstring = em2_1202 in
                                {861}let (=OpenSecureChannelResponse,wNs_1204: bitstring,ST_1205: bitstring,TTL_1206: bitstring) = m2_1203 in
                                {862}let Ns_1207: bitstring = dec(wNs_1204,skCli_1117) in
                                {863}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                {864}event endCli(Sess,Cli,Ns_1207)
                        )
                        else
                            {865}let v_1208: bool = (Disco = B) in
                            (
                                {866}if v_1208 then
                                (
                                    {867}let pkDisco_1209: bitstring = pub(skB) in
                                    {868}let v_1210: bool = (Sess = A) in
                                    (
                                        {869}if v_1210 then
                                        (
                                            {870}let pkSess_1211: bitstring = pub(skA) in
                                            {871}out(c, GetEndpointRequest);
                                            {872}in(c, (=GetEndpointResponse,=pkSess_1211,=None,SP_1212: bitstring,UP_1213: bitstring));
                                            {873}new Nc_1214: bitstring;
                                            {874}let wNc_1215: bitstring = enc(Nc_1214,pkSess_1211) in
                                            {875}let m1_1216: bitstring = (OpenSecureChannelRequest,pkCli_1118,wNc_1215) in
                                            {876}event beginCli(Cli,Sess,Nc_1214);
                                            {877}out(c, (pkCli_1118,m1_1216));
                                            {878}in(c, em2_1217: bitstring);
                                            {879}let m2_1218: bitstring = em2_1217 in
                                            {880}let (=OpenSecureChannelResponse,wNs_1219: bitstring,ST_1220: bitstring,TTL_1221: bitstring) = m2_1218 in
                                            {881}let Ns_1222: bitstring = dec(wNs_1219,skCli_1117) in
                                            {882}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {883}event endCli(Sess,Cli,Ns_1222)
                                        )
                                        else
                                            {884}let v_1223: bool = (Sess = B) in
                                            (
                                                {885}if v_1223 then
                                                (
                                                    {886}let pkSess_1224: bitstring = pub(skB) in
                                                    {887}out(c, GetEndpointRequest);
                                                    {888}in(c, (=GetEndpointResponse,=pkSess_1224,=None,SP_1225: bitstring,UP_1226: bitstring));
                                                    {889}new Nc_1227: bitstring;
                                                    {890}let wNc_1228: bitstring = enc(Nc_1227,pkSess_1224) in
                                                    {891}let m1_1229: bitstring = (OpenSecureChannelRequest,pkCli_1118,wNc_1228) in
                                                    {892}event beginCli(Cli,Sess,Nc_1227);
                                                    {893}out(c, (pkCli_1118,m1_1229));
                                                    {894}in(c, em2_1230: bitstring);
                                                    {895}let m2_1231: bitstring = em2_1230 in
                                                    {896}let (=OpenSecureChannelResponse,wNs_1232: bitstring,ST_1233: bitstring,TTL_1234: bitstring) = m2_1231 in
                                                    {897}let Ns_1235: bitstring = dec(wNs_1232,skCli_1117) in
                                                    {898}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {899}event endCli(Sess,Cli,Ns_1235)
                                                )
                                                else
                                                    {900}let v_1236: bool = (Sess = C) in
                                                    (
                                                        {901}if v_1236 then
                                                        (
                                                            {902}let pkSess_1237: bitstring = pub(skC) in
                                                            {903}out(c, GetEndpointRequest);
                                                            {904}in(c, (=GetEndpointResponse,=pkSess_1237,=None,SP_1238: bitstring,UP_1239: bitstring));
                                                            {905}new Nc_1240: bitstring;
                                                            {906}let wNc_1241: bitstring = enc(Nc_1240,pkSess_1237) in
                                                            {907}let m1_1242: bitstring = (OpenSecureChannelRequest,pkCli_1118,wNc_1241) in
                                                            {908}event beginCli(Cli,Sess,Nc_1240);
                                                            {909}out(c, (pkCli_1118,m1_1242));
                                                            {910}in(c, em2_1243: bitstring);
                                                            {911}let m2_1244: bitstring = em2_1243 in
                                                            {912}let (=OpenSecureChannelResponse,wNs_1245: bitstring,ST_1246: bitstring,TTL_1247: bitstring) = m2_1244 in
                                                            {913}let Ns_1248: bitstring = dec(wNs_1245,skCli_1117) in
                                                            {914}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                            {915}event endCli(Sess,Cli,Ns_1248)
                                                        )
                                                        else
                                                            {916}let pkSess_1249: bitstring = pub(sk(Sess)) in
                                                            {917}out(c, GetEndpointRequest);
                                                            {918}in(c, (=GetEndpointResponse,=pkSess_1249,=None,SP_1250: bitstring,UP_1251: bitstring));
                                                            {919}new Nc_1252: bitstring;
                                                            {920}let wNc_1253: bitstring = enc(Nc_1252,pkSess_1249) in
                                                            {921}let m1_1254: bitstring = (OpenSecureChannelRequest,pkCli_1118,wNc_1253) in
                                                            {922}event beginCli(Cli,Sess,Nc_1252);
                                                            {923}out(c, (pkCli_1118,m1_1254));
                                                            {924}in(c, em2_1255: bitstring);
                                                            {925}let m2_1256: bitstring = em2_1255 in
                                                            {926}let (=OpenSecureChannelResponse,wNs_1257: bitstring,ST_1258: bitstring,TTL_1259: bitstring) = m2_1256 in
                                                            {927}let Ns_1260: bitstring = dec(wNs_1257,skCli_1117) in
                                                            {928}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                            {929}event endCli(Sess,Cli,Ns_1260)
                                                    )
                                                    else
                                                        {930}let pkSess_1261: bitstring = fail-any in
                                                        {931}out(c, GetEndpointRequest);
                                                        {932}in(c, (=GetEndpointResponse,=pkSess_1261,=None,SP_1262: bitstring,UP_1263: bitstring));
                                                        {933}new Nc_1264: bitstring;
                                                        {934}let wNc_1265: bitstring = enc(Nc_1264,pkSess_1261) in
                                                        {935}let m1_1266: bitstring = (OpenSecureChannelRequest,pkCli_1118,wNc_1265) in
                                                        {936}event beginCli(Cli,Sess,Nc_1264);
                                                        {937}out(c, (pkCli_1118,m1_1266));
                                                        {938}in(c, em2_1267: bitstring);
                                                        {939}let m2_1268: bitstring = em2_1267 in
                                                        {940}let (=OpenSecureChannelResponse,wNs_1269: bitstring,ST_1270: bitstring,TTL_1271: bitstring) = m2_1268 in
                                                        {941}let Ns_1272: bitstring = dec(wNs_1269,skCli_1117) in
                                                        {942}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {943}event endCli(Sess,Cli,Ns_1272)
                                            )
                                            else
                                                {944}let pkSess_1273: bitstring = fail-any in
                                                {945}out(c, GetEndpointRequest);
                                                {946}in(c, (=GetEndpointResponse,=pkSess_1273,=None,SP_1274: bitstring,UP_1275: bitstring));
                                                {947}new Nc_1276: bitstring;
                                                {948}let wNc_1277: bitstring = enc(Nc_1276,pkSess_1273) in
                                                {949}let m1_1278: bitstring = (OpenSecureChannelRequest,pkCli_1118,wNc_1277) in
                                                {950}event beginCli(Cli,Sess,Nc_1276);
                                                {951}out(c, (pkCli_1118,m1_1278));
                                                {952}in(c, em2_1279: bitstring);
                                                {953}let m2_1280: bitstring = em2_1279 in
                                                {954}let (=OpenSecureChannelResponse,wNs_1281: bitstring,ST_1282: bitstring,TTL_1283: bitstring) = m2_1280 in
                                                {955}let Ns_1284: bitstring = dec(wNs_1281,skCli_1117) in
                                                {956}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {957}event endCli(Sess,Cli,Ns_1284)
                                    )
                                    else
                                        {958}let pkSess_1285: bitstring = fail-any in
                                        {959}out(c, GetEndpointRequest);
                                        {960}in(c, (=GetEndpointResponse,=pkSess_1285,=None,SP_1286: bitstring,UP_1287: bitstring));
                                        {961}new Nc_1288: bitstring;
                                        {962}let wNc_1289: bitstring = enc(Nc_1288,pkSess_1285) in
                                        {963}let m1_1290: bitstring = (OpenSecureChannelRequest,pkCli_1118,wNc_1289) in
                                        {964}event beginCli(Cli,Sess,Nc_1288);
                                        {965}out(c, (pkCli_1118,m1_1290));
                                        {966}in(c, em2_1291: bitstring);
                                        {967}let m2_1292: bitstring = em2_1291 in
                                        {968}let (=OpenSecureChannelResponse,wNs_1293: bitstring,ST_1294: bitstring,TTL_1295: bitstring) = m2_1292 in
                                        {969}let Ns_1296: bitstring = dec(wNs_1293,skCli_1117) in
                                        {970}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                        {971}event endCli(Sess,Cli,Ns_1296)
                                )
                                else
                                    {972}let v_1297: bool = (Disco = C) in
                                    (
                                        {973}if v_1297 then
                                        (
                                            {974}let pkDisco_1298: bitstring = pub(skC) in
                                            {975}let v_1299: bool = (Sess = A) in
                                            (
                                                {976}if v_1299 then
                                                (
                                                    {977}let pkSess_1300: bitstring = pub(skA) in
                                                    {978}out(c, GetEndpointRequest);
                                                    {979}in(c, (=GetEndpointResponse,=pkSess_1300,=None,SP_1301: bitstring,UP_1302: bitstring));
                                                    {980}new Nc_1303: bitstring;
                                                    {981}let wNc_1304: bitstring = enc(Nc_1303,pkSess_1300) in
                                                    {982}let m1_1305: bitstring = (OpenSecureChannelRequest,pkCli_1118,wNc_1304) in
                                                    {983}event beginCli(Cli,Sess,Nc_1303);
                                                    {984}out(c, (pkCli_1118,m1_1305));
                                                    {985}in(c, em2_1306: bitstring);
                                                    {986}let m2_1307: bitstring = em2_1306 in
                                                    {987}let (=OpenSecureChannelResponse,wNs_1308: bitstring,ST_1309: bitstring,TTL_1310: bitstring) = m2_1307 in
                                                    {988}let Ns_1311: bitstring = dec(wNs_1308,skCli_1117) in
                                                    {989}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {990}event endCli(Sess,Cli,Ns_1311)
                                                )
                                                else
                                                    {991}let v_1312: bool = (Sess = B) in
                                                    (
                                                        {992}if v_1312 then
                                                        (
                                                            {993}let pkSess_1313: bitstring = pub(skB) in
                                                            {994}out(c, GetEndpointRequest);
                                                            {995}in(c, (=GetEndpointResponse,=pkSess_1313,=None,SP_1314: bitstring,UP_1315: bitstring));
                                                            {996}new Nc_1316: bitstring;
                                                            {997}let wNc_1317: bitstring = enc(Nc_1316,pkSess_1313) in
                                                            {998}let m1_1318: bitstring = (OpenSecureChannelRequest,pkCli_1118,wNc_1317) in
                                                            {999}event beginCli(Cli,Sess,Nc_1316);
                                                            {1000}out(c, (pkCli_1118,m1_1318));
                                                            {1001}in(c, em2_1319: bitstring);
                                                            {1002}let m2_1320: bitstring = em2_1319 in
                                                            {1003}let (=OpenSecureChannelResponse,wNs_1321: bitstring,ST_1322: bitstring,TTL_1323: bitstring) = m2_1320 in
                                                            {1004}let Ns_1324: bitstring = dec(wNs_1321,skCli_1117) in
                                                            {1005}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                            {1006}event endCli(Sess,Cli,Ns_1324)
                                                        )
                                                        else
                                                            {1007}let v_1325: bool = (Sess = C) in
                                                            (
                                                                {1008}if v_1325 then
                                                                (
                                                                    {1009}let pkSess_1326: bitstring = pub(skC) in
                                                                    {1010}out(c, GetEndpointRequest);
                                                                    {1011}in(c, (=GetEndpointResponse,=pkSess_1326,=None,SP_1327: bitstring,UP_1328: bitstring));
                                                                    {1012}new Nc_1329: bitstring;
                                                                    {1013}let wNc_1330: bitstring = enc(Nc_1329,pkSess_1326) in
                                                                    {1014}let m1_1331: bitstring = (OpenSecureChannelRequest,pkCli_1118,wNc_1330) in
                                                                    {1015}event beginCli(Cli,Sess,Nc_1329);
                                                                    {1016}out(c, (pkCli_1118,m1_1331));
                                                                    {1017}in(c, em2_1332: bitstring);
                                                                    {1018}let m2_1333: bitstring = em2_1332 in
                                                                    {1019}let (=OpenSecureChannelResponse,wNs_1334: bitstring,ST_1335: bitstring,TTL_1336: bitstring) = m2_1333 in
                                                                    {1020}let Ns_1337: bitstring = dec(wNs_1334,skCli_1117) in
                                                                    {1021}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                    {1022}event endCli(Sess,Cli,Ns_1337)
                                                                )
                                                                else
                                                                    {1023}let pkSess_1338: bitstring = pub(sk(Sess)) in
                                                                    {1024}out(c, GetEndpointRequest);
                                                                    {1025}in(c, (=GetEndpointResponse,=pkSess_1338,=None,SP_1339: bitstring,UP_1340: bitstring));
                                                                    {1026}new Nc_1341: bitstring;
                                                                    {1027}let wNc_1342: bitstring = enc(Nc_1341,pkSess_1338) in
                                                                    {1028}let m1_1343: bitstring = (OpenSecureChannelRequest,pkCli_1118,wNc_1342) in
                                                                    {1029}event beginCli(Cli,Sess,Nc_1341);
                                                                    {1030}out(c, (pkCli_1118,m1_1343));
                                                                    {1031}in(c, em2_1344: bitstring);
                                                                    {1032}let m2_1345: bitstring = em2_1344 in
                                                                    {1033}let (=OpenSecureChannelResponse,wNs_1346: bitstring,ST_1347: bitstring,TTL_1348: bitstring) = m2_1345 in
                                                                    {1034}let Ns_1349: bitstring = dec(wNs_1346,skCli_1117) in
                                                                    {1035}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                    {1036}event endCli(Sess,Cli,Ns_1349)
                                                            )
                                                            else
                                                                {1037}let pkSess_1350: bitstring = fail-any in
                                                                {1038}out(c, GetEndpointRequest);
                                                                {1039}in(c, (=GetEndpointResponse,=pkSess_1350,=None,SP_1351: bitstring,UP_1352: bitstring));
                                                                {1040}new Nc_1353: bitstring;
                                                                {1041}let wNc_1354: bitstring = enc(Nc_1353,pkSess_1350) in
                                                                {1042}let m1_1355: bitstring = (OpenSecureChannelRequest,pkCli_1118,wNc_1354) in
                                                                {1043}event beginCli(Cli,Sess,Nc_1353);
                                                                {1044}out(c, (pkCli_1118,m1_1355));
                                                                {1045}in(c, em2_1356: bitstring);
                                                                {1046}let m2_1357: bitstring = em2_1356 in
                                                                {1047}let (=OpenSecureChannelResponse,wNs_1358: bitstring,ST_1359: bitstring,TTL_1360: bitstring) = m2_1357 in
                                                                {1048}let Ns_1361: bitstring = dec(wNs_1358,skCli_1117) in
                                                                {1049}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                {1050}event endCli(Sess,Cli,Ns_1361)
                                                    )
                                                    else
                                                        {1051}let pkSess_1362: bitstring = fail-any in
                                                        {1052}out(c, GetEndpointRequest);
                                                        {1053}in(c, (=GetEndpointResponse,=pkSess_1362,=None,SP_1363: bitstring,UP_1364: bitstring));
                                                        {1054}new Nc_1365: bitstring;
                                                        {1055}let wNc_1366: bitstring = enc(Nc_1365,pkSess_1362) in
                                                        {1056}let m1_1367: bitstring = (OpenSecureChannelRequest,pkCli_1118,wNc_1366) in
                                                        {1057}event beginCli(Cli,Sess,Nc_1365);
                                                        {1058}out(c, (pkCli_1118,m1_1367));
                                                        {1059}in(c, em2_1368: bitstring);
                                                        {1060}let m2_1369: bitstring = em2_1368 in
                                                        {1061}let (=OpenSecureChannelResponse,wNs_1370: bitstring,ST_1371: bitstring,TTL_1372: bitstring) = m2_1369 in
                                                        {1062}let Ns_1373: bitstring = dec(wNs_1370,skCli_1117) in
                                                        {1063}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {1064}event endCli(Sess,Cli,Ns_1373)
                                            )
                                            else
                                                {1065}let pkSess_1374: bitstring = fail-any in
                                                {1066}out(c, GetEndpointRequest);
                                                {1067}in(c, (=GetEndpointResponse,=pkSess_1374,=None,SP_1375: bitstring,UP_1376: bitstring));
                                                {1068}new Nc_1377: bitstring;
                                                {1069}let wNc_1378: bitstring = enc(Nc_1377,pkSess_1374) in
                                                {1070}let m1_1379: bitstring = (OpenSecureChannelRequest,pkCli_1118,wNc_1378) in
                                                {1071}event beginCli(Cli,Sess,Nc_1377);
                                                {1072}out(c, (pkCli_1118,m1_1379));
                                                {1073}in(c, em2_1380: bitstring);
                                                {1074}let m2_1381: bitstring = em2_1380 in
                                                {1075}let (=OpenSecureChannelResponse,wNs_1382: bitstring,ST_1383: bitstring,TTL_1384: bitstring) = m2_1381 in
                                                {1076}let Ns_1385: bitstring = dec(wNs_1382,skCli_1117) in
                                                {1077}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {1078}event endCli(Sess,Cli,Ns_1385)
                                        )
                                        else
                                            {1079}let pkDisco_1386: bitstring = pub(sk(Disco)) in
                                            {1080}let v_1387: bool = (Sess = A) in
                                            (
                                                {1081}if v_1387 then
                                                (
                                                    {1082}let pkSess_1388: bitstring = pub(skA) in
                                                    {1083}out(c, GetEndpointRequest);
                                                    {1084}in(c, (=GetEndpointResponse,=pkSess_1388,=None,SP_1389: bitstring,UP_1390: bitstring));
                                                    {1085}new Nc_1391: bitstring;
                                                    {1086}let wNc_1392: bitstring = enc(Nc_1391,pkSess_1388) in
                                                    {1087}let m1_1393: bitstring = (OpenSecureChannelRequest,pkCli_1118,wNc_1392) in
                                                    {1088}event beginCli(Cli,Sess,Nc_1391);
                                                    {1089}out(c, (pkCli_1118,m1_1393));
                                                    {1090}in(c, em2_1394: bitstring);
                                                    {1091}let m2_1395: bitstring = em2_1394 in
                                                    {1092}let (=OpenSecureChannelResponse,wNs_1396: bitstring,ST_1397: bitstring,TTL_1398: bitstring) = m2_1395 in
                                                    {1093}let Ns_1399: bitstring = dec(wNs_1396,skCli_1117) in
                                                    {1094}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {1095}event endCli(Sess,Cli,Ns_1399)
                                                )
                                                else
                                                    {1096}let v_1400: bool = (Sess = B) in
                                                    (
                                                        {1097}if v_1400 then
                                                        (
                                                            {1098}let pkSess_1401: bitstring = pub(skB) in
                                                            {1099}out(c, GetEndpointRequest);
                                                            {1100}in(c, (=GetEndpointResponse,=pkSess_1401,=None,SP_1402: bitstring,UP_1403: bitstring));
                                                            {1101}new Nc_1404: bitstring;
                                                            {1102}let wNc_1405: bitstring = enc(Nc_1404,pkSess_1401) in
                                                            {1103}let m1_1406: bitstring = (OpenSecureChannelRequest,pkCli_1118,wNc_1405) in
                                                            {1104}event beginCli(Cli,Sess,Nc_1404);
                                                            {1105}out(c, (pkCli_1118,m1_1406));
                                                            {1106}in(c, em2_1407: bitstring);
                                                            {1107}let m2_1408: bitstring = em2_1407 in
                                                            {1108}let (=OpenSecureChannelResponse,wNs_1409: bitstring,ST_1410: bitstring,TTL_1411: bitstring) = m2_1408 in
                                                            {1109}let Ns_1412: bitstring = dec(wNs_1409,skCli_1117) in
                                                            {1110}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                            {1111}event endCli(Sess,Cli,Ns_1412)
                                                        )
                                                        else
                                                            {1112}let v_1413: bool = (Sess = C) in
                                                            (
                                                                {1113}if v_1413 then
                                                                (
                                                                    {1114}let pkSess_1414: bitstring = pub(skC) in
                                                                    {1115}out(c, GetEndpointRequest);
                                                                    {1116}in(c, (=GetEndpointResponse,=pkSess_1414,=None,SP_1415: bitstring,UP_1416: bitstring));
                                                                    {1117}new Nc_1417: bitstring;
                                                                    {1118}let wNc_1418: bitstring = enc(Nc_1417,pkSess_1414) in
                                                                    {1119}let m1_1419: bitstring = (OpenSecureChannelRequest,pkCli_1118,wNc_1418) in
                                                                    {1120}event beginCli(Cli,Sess,Nc_1417);
                                                                    {1121}out(c, (pkCli_1118,m1_1419));
                                                                    {1122}in(c, em2_1420: bitstring);
                                                                    {1123}let m2_1421: bitstring = em2_1420 in
                                                                    {1124}let (=OpenSecureChannelResponse,wNs_1422: bitstring,ST_1423: bitstring,TTL_1424: bitstring) = m2_1421 in
                                                                    {1125}let Ns_1425: bitstring = dec(wNs_1422,skCli_1117) in
                                                                    {1126}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                    {1127}event endCli(Sess,Cli,Ns_1425)
                                                                )
                                                                else
                                                                    {1128}let pkSess_1426: bitstring = pub(sk(Sess)) in
                                                                    {1129}out(c, GetEndpointRequest);
                                                                    {1130}in(c, (=GetEndpointResponse,=pkSess_1426,=None,SP_1427: bitstring,UP_1428: bitstring));
                                                                    {1131}new Nc_1429: bitstring;
                                                                    {1132}let wNc_1430: bitstring = enc(Nc_1429,pkSess_1426) in
                                                                    {1133}let m1_1431: bitstring = (OpenSecureChannelRequest,pkCli_1118,wNc_1430) in
                                                                    {1134}event beginCli(Cli,Sess,Nc_1429);
                                                                    {1135}out(c, (pkCli_1118,m1_1431));
                                                                    {1136}in(c, em2_1432: bitstring);
                                                                    {1137}let m2_1433: bitstring = em2_1432 in
                                                                    {1138}let (=OpenSecureChannelResponse,wNs_1434: bitstring,ST_1435: bitstring,TTL_1436: bitstring) = m2_1433 in
                                                                    {1139}let Ns_1437: bitstring = dec(wNs_1434,skCli_1117) in
                                                                    {1140}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                    {1141}event endCli(Sess,Cli,Ns_1437)
                                                            )
                                                            else
                                                                {1142}let pkSess_1438: bitstring = fail-any in
                                                                {1143}out(c, GetEndpointRequest);
                                                                {1144}in(c, (=GetEndpointResponse,=pkSess_1438,=None,SP_1439: bitstring,UP_1440: bitstring));
                                                                {1145}new Nc_1441: bitstring;
                                                                {1146}let wNc_1442: bitstring = enc(Nc_1441,pkSess_1438) in
                                                                {1147}let m1_1443: bitstring = (OpenSecureChannelRequest,pkCli_1118,wNc_1442) in
                                                                {1148}event beginCli(Cli,Sess,Nc_1441);
                                                                {1149}out(c, (pkCli_1118,m1_1443));
                                                                {1150}in(c, em2_1444: bitstring);
                                                                {1151}let m2_1445: bitstring = em2_1444 in
                                                                {1152}let (=OpenSecureChannelResponse,wNs_1446: bitstring,ST_1447: bitstring,TTL_1448: bitstring) = m2_1445 in
                                                                {1153}let Ns_1449: bitstring = dec(wNs_1446,skCli_1117) in
                                                                {1154}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                {1155}event endCli(Sess,Cli,Ns_1449)
                                                    )
                                                    else
                                                        {1156}let pkSess_1450: bitstring = fail-any in
                                                        {1157}out(c, GetEndpointRequest);
                                                        {1158}in(c, (=GetEndpointResponse,=pkSess_1450,=None,SP_1451: bitstring,UP_1452: bitstring));
                                                        {1159}new Nc_1453: bitstring;
                                                        {1160}let wNc_1454: bitstring = enc(Nc_1453,pkSess_1450) in
                                                        {1161}let m1_1455: bitstring = (OpenSecureChannelRequest,pkCli_1118,wNc_1454) in
                                                        {1162}event beginCli(Cli,Sess,Nc_1453);
                                                        {1163}out(c, (pkCli_1118,m1_1455));
                                                        {1164}in(c, em2_1456: bitstring);
                                                        {1165}let m2_1457: bitstring = em2_1456 in
                                                        {1166}let (=OpenSecureChannelResponse,wNs_1458: bitstring,ST_1459: bitstring,TTL_1460: bitstring) = m2_1457 in
                                                        {1167}let Ns_1461: bitstring = dec(wNs_1458,skCli_1117) in
                                                        {1168}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {1169}event endCli(Sess,Cli,Ns_1461)
                                            )
                                            else
                                                {1170}let pkSess_1462: bitstring = fail-any in
                                                {1171}out(c, GetEndpointRequest);
                                                {1172}in(c, (=GetEndpointResponse,=pkSess_1462,=None,SP_1463: bitstring,UP_1464: bitstring));
                                                {1173}new Nc_1465: bitstring;
                                                {1174}let wNc_1466: bitstring = enc(Nc_1465,pkSess_1462) in
                                                {1175}let m1_1467: bitstring = (OpenSecureChannelRequest,pkCli_1118,wNc_1466) in
                                                {1176}event beginCli(Cli,Sess,Nc_1465);
                                                {1177}out(c, (pkCli_1118,m1_1467));
                                                {1178}in(c, em2_1468: bitstring);
                                                {1179}let m2_1469: bitstring = em2_1468 in
                                                {1180}let (=OpenSecureChannelResponse,wNs_1470: bitstring,ST_1471: bitstring,TTL_1472: bitstring) = m2_1469 in
                                                {1181}let Ns_1473: bitstring = dec(wNs_1470,skCli_1117) in
                                                {1182}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {1183}event endCli(Sess,Cli,Ns_1473)
                                    )
                                    else
                                        {1184}let pkDisco_1474: bitstring = fail-any in
                                        {1185}let v_1475: bool = (Sess = A) in
                                        (
                                            {1186}if v_1475 then
                                            (
                                                {1187}let pkSess_1476: bitstring = pub(skA) in
                                                {1188}out(c, GetEndpointRequest);
                                                {1189}in(c, (=GetEndpointResponse,=pkSess_1476,=None,SP_1477: bitstring,UP_1478: bitstring));
                                                {1190}new Nc_1479: bitstring;
                                                {1191}let wNc_1480: bitstring = enc(Nc_1479,pkSess_1476) in
                                                {1192}let m1_1481: bitstring = (OpenSecureChannelRequest,pkCli_1118,wNc_1480) in
                                                {1193}event beginCli(Cli,Sess,Nc_1479);
                                                {1194}out(c, (pkCli_1118,m1_1481));
                                                {1195}in(c, em2_1482: bitstring);
                                                {1196}let m2_1483: bitstring = em2_1482 in
                                                {1197}let (=OpenSecureChannelResponse,wNs_1484: bitstring,ST_1485: bitstring,TTL_1486: bitstring) = m2_1483 in
                                                {1198}let Ns_1487: bitstring = dec(wNs_1484,skCli_1117) in
                                                {1199}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {1200}event endCli(Sess,Cli,Ns_1487)
                                            )
                                            else
                                                {1201}let v_1488: bool = (Sess = B) in
                                                (
                                                    {1202}if v_1488 then
                                                    (
                                                        {1203}let pkSess_1489: bitstring = pub(skB) in
                                                        {1204}out(c, GetEndpointRequest);
                                                        {1205}in(c, (=GetEndpointResponse,=pkSess_1489,=None,SP_1490: bitstring,UP_1491: bitstring));
                                                        {1206}new Nc_1492: bitstring;
                                                        {1207}let wNc_1493: bitstring = enc(Nc_1492,pkSess_1489) in
                                                        {1208}let m1_1494: bitstring = (OpenSecureChannelRequest,pkCli_1118,wNc_1493) in
                                                        {1209}event beginCli(Cli,Sess,Nc_1492);
                                                        {1210}out(c, (pkCli_1118,m1_1494));
                                                        {1211}in(c, em2_1495: bitstring);
                                                        {1212}let m2_1496: bitstring = em2_1495 in
                                                        {1213}let (=OpenSecureChannelResponse,wNs_1497: bitstring,ST_1498: bitstring,TTL_1499: bitstring) = m2_1496 in
                                                        {1214}let Ns_1500: bitstring = dec(wNs_1497,skCli_1117) in
                                                        {1215}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {1216}event endCli(Sess,Cli,Ns_1500)
                                                    )
                                                    else
                                                        {1217}let v_1501: bool = (Sess = C) in
                                                        (
                                                            {1218}if v_1501 then
                                                            (
                                                                {1219}let pkSess_1502: bitstring = pub(skC) in
                                                                {1220}out(c, GetEndpointRequest);
                                                                {1221}in(c, (=GetEndpointResponse,=pkSess_1502,=None,SP_1503: bitstring,UP_1504: bitstring));
                                                                {1222}new Nc_1505: bitstring;
                                                                {1223}let wNc_1506: bitstring = enc(Nc_1505,pkSess_1502) in
                                                                {1224}let m1_1507: bitstring = (OpenSecureChannelRequest,pkCli_1118,wNc_1506) in
                                                                {1225}event beginCli(Cli,Sess,Nc_1505);
                                                                {1226}out(c, (pkCli_1118,m1_1507));
                                                                {1227}in(c, em2_1508: bitstring);
                                                                {1228}let m2_1509: bitstring = em2_1508 in
                                                                {1229}let (=OpenSecureChannelResponse,wNs_1510: bitstring,ST_1511: bitstring,TTL_1512: bitstring) = m2_1509 in
                                                                {1230}let Ns_1513: bitstring = dec(wNs_1510,skCli_1117) in
                                                                {1231}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                {1232}event endCli(Sess,Cli,Ns_1513)
                                                            )
                                                            else
                                                                {1233}let pkSess_1514: bitstring = pub(sk(Sess)) in
                                                                {1234}out(c, GetEndpointRequest);
                                                                {1235}in(c, (=GetEndpointResponse,=pkSess_1514,=None,SP_1515: bitstring,UP_1516: bitstring));
                                                                {1236}new Nc_1517: bitstring;
                                                                {1237}let wNc_1518: bitstring = enc(Nc_1517,pkSess_1514) in
                                                                {1238}let m1_1519: bitstring = (OpenSecureChannelRequest,pkCli_1118,wNc_1518) in
                                                                {1239}event beginCli(Cli,Sess,Nc_1517);
                                                                {1240}out(c, (pkCli_1118,m1_1519));
                                                                {1241}in(c, em2_1520: bitstring);
                                                                {1242}let m2_1521: bitstring = em2_1520 in
                                                                {1243}let (=OpenSecureChannelResponse,wNs_1522: bitstring,ST_1523: bitstring,TTL_1524: bitstring) = m2_1521 in
                                                                {1244}let Ns_1525: bitstring = dec(wNs_1522,skCli_1117) in
                                                                {1245}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                {1246}event endCli(Sess,Cli,Ns_1525)
                                                        )
                                                        else
                                                            {1247}let pkSess_1526: bitstring = fail-any in
                                                            {1248}out(c, GetEndpointRequest);
                                                            {1249}in(c, (=GetEndpointResponse,=pkSess_1526,=None,SP_1527: bitstring,UP_1528: bitstring));
                                                            {1250}new Nc_1529: bitstring;
                                                            {1251}let wNc_1530: bitstring = enc(Nc_1529,pkSess_1526) in
                                                            {1252}let m1_1531: bitstring = (OpenSecureChannelRequest,pkCli_1118,wNc_1530) in
                                                            {1253}event beginCli(Cli,Sess,Nc_1529);
                                                            {1254}out(c, (pkCli_1118,m1_1531));
                                                            {1255}in(c, em2_1532: bitstring);
                                                            {1256}let m2_1533: bitstring = em2_1532 in
                                                            {1257}let (=OpenSecureChannelResponse,wNs_1534: bitstring,ST_1535: bitstring,TTL_1536: bitstring) = m2_1533 in
                                                            {1258}let Ns_1537: bitstring = dec(wNs_1534,skCli_1117) in
                                                            {1259}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                            {1260}event endCli(Sess,Cli,Ns_1537)
                                                )
                                                else
                                                    {1261}let pkSess_1538: bitstring = fail-any in
                                                    {1262}out(c, GetEndpointRequest);
                                                    {1263}in(c, (=GetEndpointResponse,=pkSess_1538,=None,SP_1539: bitstring,UP_1540: bitstring));
                                                    {1264}new Nc_1541: bitstring;
                                                    {1265}let wNc_1542: bitstring = enc(Nc_1541,pkSess_1538) in
                                                    {1266}let m1_1543: bitstring = (OpenSecureChannelRequest,pkCli_1118,wNc_1542) in
                                                    {1267}event beginCli(Cli,Sess,Nc_1541);
                                                    {1268}out(c, (pkCli_1118,m1_1543));
                                                    {1269}in(c, em2_1544: bitstring);
                                                    {1270}let m2_1545: bitstring = em2_1544 in
                                                    {1271}let (=OpenSecureChannelResponse,wNs_1546: bitstring,ST_1547: bitstring,TTL_1548: bitstring) = m2_1545 in
                                                    {1272}let Ns_1549: bitstring = dec(wNs_1546,skCli_1117) in
                                                    {1273}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {1274}event endCli(Sess,Cli,Ns_1549)
                                        )
                                        else
                                            {1275}let pkSess_1550: bitstring = fail-any in
                                            {1276}out(c, GetEndpointRequest);
                                            {1277}in(c, (=GetEndpointResponse,=pkSess_1550,=None,SP_1551: bitstring,UP_1552: bitstring));
                                            {1278}new Nc_1553: bitstring;
                                            {1279}let wNc_1554: bitstring = enc(Nc_1553,pkSess_1550) in
                                            {1280}let m1_1555: bitstring = (OpenSecureChannelRequest,pkCli_1118,wNc_1554) in
                                            {1281}event beginCli(Cli,Sess,Nc_1553);
                                            {1282}out(c, (pkCli_1118,m1_1555));
                                            {1283}in(c, em2_1556: bitstring);
                                            {1284}let m2_1557: bitstring = em2_1556 in
                                            {1285}let (=OpenSecureChannelResponse,wNs_1558: bitstring,ST_1559: bitstring,TTL_1560: bitstring) = m2_1557 in
                                            {1286}let Ns_1561: bitstring = dec(wNs_1558,skCli_1117) in
                                            {1287}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {1288}event endCli(Sess,Cli,Ns_1561)
                            )
                            else
                                {1289}let pkDisco_1562: bitstring = fail-any in
                                {1290}let v_1563: bool = (Sess = A) in
                                (
                                    {1291}if v_1563 then
                                    (
                                        {1292}let pkSess_1564: bitstring = pub(skA) in
                                        {1293}out(c, GetEndpointRequest);
                                        {1294}in(c, (=GetEndpointResponse,=pkSess_1564,=None,SP_1565: bitstring,UP_1566: bitstring));
                                        {1295}new Nc_1567: bitstring;
                                        {1296}let wNc_1568: bitstring = enc(Nc_1567,pkSess_1564) in
                                        {1297}let m1_1569: bitstring = (OpenSecureChannelRequest,pkCli_1118,wNc_1568) in
                                        {1298}event beginCli(Cli,Sess,Nc_1567);
                                        {1299}out(c, (pkCli_1118,m1_1569));
                                        {1300}in(c, em2_1570: bitstring);
                                        {1301}let m2_1571: bitstring = em2_1570 in
                                        {1302}let (=OpenSecureChannelResponse,wNs_1572: bitstring,ST_1573: bitstring,TTL_1574: bitstring) = m2_1571 in
                                        {1303}let Ns_1575: bitstring = dec(wNs_1572,skCli_1117) in
                                        {1304}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                        {1305}event endCli(Sess,Cli,Ns_1575)
                                    )
                                    else
                                        {1306}let v_1576: bool = (Sess = B) in
                                        (
                                            {1307}if v_1576 then
                                            (
                                                {1308}let pkSess_1577: bitstring = pub(skB) in
                                                {1309}out(c, GetEndpointRequest);
                                                {1310}in(c, (=GetEndpointResponse,=pkSess_1577,=None,SP_1578: bitstring,UP_1579: bitstring));
                                                {1311}new Nc_1580: bitstring;
                                                {1312}let wNc_1581: bitstring = enc(Nc_1580,pkSess_1577) in
                                                {1313}let m1_1582: bitstring = (OpenSecureChannelRequest,pkCli_1118,wNc_1581) in
                                                {1314}event beginCli(Cli,Sess,Nc_1580);
                                                {1315}out(c, (pkCli_1118,m1_1582));
                                                {1316}in(c, em2_1583: bitstring);
                                                {1317}let m2_1584: bitstring = em2_1583 in
                                                {1318}let (=OpenSecureChannelResponse,wNs_1585: bitstring,ST_1586: bitstring,TTL_1587: bitstring) = m2_1584 in
                                                {1319}let Ns_1588: bitstring = dec(wNs_1585,skCli_1117) in
                                                {1320}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {1321}event endCli(Sess,Cli,Ns_1588)
                                            )
                                            else
                                                {1322}let v_1589: bool = (Sess = C) in
                                                (
                                                    {1323}if v_1589 then
                                                    (
                                                        {1324}let pkSess_1590: bitstring = pub(skC) in
                                                        {1325}out(c, GetEndpointRequest);
                                                        {1326}in(c, (=GetEndpointResponse,=pkSess_1590,=None,SP_1591: bitstring,UP_1592: bitstring));
                                                        {1327}new Nc_1593: bitstring;
                                                        {1328}let wNc_1594: bitstring = enc(Nc_1593,pkSess_1590) in
                                                        {1329}let m1_1595: bitstring = (OpenSecureChannelRequest,pkCli_1118,wNc_1594) in
                                                        {1330}event beginCli(Cli,Sess,Nc_1593);
                                                        {1331}out(c, (pkCli_1118,m1_1595));
                                                        {1332}in(c, em2_1596: bitstring);
                                                        {1333}let m2_1597: bitstring = em2_1596 in
                                                        {1334}let (=OpenSecureChannelResponse,wNs_1598: bitstring,ST_1599: bitstring,TTL_1600: bitstring) = m2_1597 in
                                                        {1335}let Ns_1601: bitstring = dec(wNs_1598,skCli_1117) in
                                                        {1336}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {1337}event endCli(Sess,Cli,Ns_1601)
                                                    )
                                                    else
                                                        {1338}let pkSess_1602: bitstring = pub(sk(Sess)) in
                                                        {1339}out(c, GetEndpointRequest);
                                                        {1340}in(c, (=GetEndpointResponse,=pkSess_1602,=None,SP_1603: bitstring,UP_1604: bitstring));
                                                        {1341}new Nc_1605: bitstring;
                                                        {1342}let wNc_1606: bitstring = enc(Nc_1605,pkSess_1602) in
                                                        {1343}let m1_1607: bitstring = (OpenSecureChannelRequest,pkCli_1118,wNc_1606) in
                                                        {1344}event beginCli(Cli,Sess,Nc_1605);
                                                        {1345}out(c, (pkCli_1118,m1_1607));
                                                        {1346}in(c, em2_1608: bitstring);
                                                        {1347}let m2_1609: bitstring = em2_1608 in
                                                        {1348}let (=OpenSecureChannelResponse,wNs_1610: bitstring,ST_1611: bitstring,TTL_1612: bitstring) = m2_1609 in
                                                        {1349}let Ns_1613: bitstring = dec(wNs_1610,skCli_1117) in
                                                        {1350}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {1351}event endCli(Sess,Cli,Ns_1613)
                                                )
                                                else
                                                    {1352}let pkSess_1614: bitstring = fail-any in
                                                    {1353}out(c, GetEndpointRequest);
                                                    {1354}in(c, (=GetEndpointResponse,=pkSess_1614,=None,SP_1615: bitstring,UP_1616: bitstring));
                                                    {1355}new Nc_1617: bitstring;
                                                    {1356}let wNc_1618: bitstring = enc(Nc_1617,pkSess_1614) in
                                                    {1357}let m1_1619: bitstring = (OpenSecureChannelRequest,pkCli_1118,wNc_1618) in
                                                    {1358}event beginCli(Cli,Sess,Nc_1617);
                                                    {1359}out(c, (pkCli_1118,m1_1619));
                                                    {1360}in(c, em2_1620: bitstring);
                                                    {1361}let m2_1621: bitstring = em2_1620 in
                                                    {1362}let (=OpenSecureChannelResponse,wNs_1622: bitstring,ST_1623: bitstring,TTL_1624: bitstring) = m2_1621 in
                                                    {1363}let Ns_1625: bitstring = dec(wNs_1622,skCli_1117) in
                                                    {1364}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {1365}event endCli(Sess,Cli,Ns_1625)
                                        )
                                        else
                                            {1366}let pkSess_1626: bitstring = fail-any in
                                            {1367}out(c, GetEndpointRequest);
                                            {1368}in(c, (=GetEndpointResponse,=pkSess_1626,=None,SP_1627: bitstring,UP_1628: bitstring));
                                            {1369}new Nc_1629: bitstring;
                                            {1370}let wNc_1630: bitstring = enc(Nc_1629,pkSess_1626) in
                                            {1371}let m1_1631: bitstring = (OpenSecureChannelRequest,pkCli_1118,wNc_1630) in
                                            {1372}event beginCli(Cli,Sess,Nc_1629);
                                            {1373}out(c, (pkCli_1118,m1_1631));
                                            {1374}in(c, em2_1632: bitstring);
                                            {1375}let m2_1633: bitstring = em2_1632 in
                                            {1376}let (=OpenSecureChannelResponse,wNs_1634: bitstring,ST_1635: bitstring,TTL_1636: bitstring) = m2_1633 in
                                            {1377}let Ns_1637: bitstring = dec(wNs_1634,skCli_1117) in
                                            {1378}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {1379}event endCli(Sess,Cli,Ns_1637)
                                )
                                else
                                    {1380}let pkSess_1638: bitstring = fail-any in
                                    {1381}out(c, GetEndpointRequest);
                                    {1382}in(c, (=GetEndpointResponse,=pkSess_1638,=None,SP_1639: bitstring,UP_1640: bitstring));
                                    {1383}new Nc_1641: bitstring;
                                    {1384}let wNc_1642: bitstring = enc(Nc_1641,pkSess_1638) in
                                    {1385}let m1_1643: bitstring = (OpenSecureChannelRequest,pkCli_1118,wNc_1642) in
                                    {1386}event beginCli(Cli,Sess,Nc_1641);
                                    {1387}out(c, (pkCli_1118,m1_1643));
                                    {1388}in(c, em2_1644: bitstring);
                                    {1389}let m2_1645: bitstring = em2_1644 in
                                    {1390}let (=OpenSecureChannelResponse,wNs_1646: bitstring,ST_1647: bitstring,TTL_1648: bitstring) = m2_1645 in
                                    {1391}let Ns_1649: bitstring = dec(wNs_1646,skCli_1117) in
                                    {1392}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                    {1393}event endCli(Sess,Cli,Ns_1649)
                    )
                    else
                        {1394}let pkDisco_1650: bitstring = fail-any in
                        {1395}let v_1651: bool = (Sess = A) in
                        (
                            {1396}if v_1651 then
                            (
                                {1397}let pkSess_1652: bitstring = pub(skA) in
                                {1398}out(c, GetEndpointRequest);
                                {1399}in(c, (=GetEndpointResponse,=pkSess_1652,=None,SP_1653: bitstring,UP_1654: bitstring));
                                {1400}new Nc_1655: bitstring;
                                {1401}let wNc_1656: bitstring = enc(Nc_1655,pkSess_1652) in
                                {1402}let m1_1657: bitstring = (OpenSecureChannelRequest,pkCli_1118,wNc_1656) in
                                {1403}event beginCli(Cli,Sess,Nc_1655);
                                {1404}out(c, (pkCli_1118,m1_1657));
                                {1405}in(c, em2_1658: bitstring);
                                {1406}let m2_1659: bitstring = em2_1658 in
                                {1407}let (=OpenSecureChannelResponse,wNs_1660: bitstring,ST_1661: bitstring,TTL_1662: bitstring) = m2_1659 in
                                {1408}let Ns_1663: bitstring = dec(wNs_1660,skCli_1117) in
                                {1409}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                {1410}event endCli(Sess,Cli,Ns_1663)
                            )
                            else
                                {1411}let v_1664: bool = (Sess = B) in
                                (
                                    {1412}if v_1664 then
                                    (
                                        {1413}let pkSess_1665: bitstring = pub(skB) in
                                        {1414}out(c, GetEndpointRequest);
                                        {1415}in(c, (=GetEndpointResponse,=pkSess_1665,=None,SP_1666: bitstring,UP_1667: bitstring));
                                        {1416}new Nc_1668: bitstring;
                                        {1417}let wNc_1669: bitstring = enc(Nc_1668,pkSess_1665) in
                                        {1418}let m1_1670: bitstring = (OpenSecureChannelRequest,pkCli_1118,wNc_1669) in
                                        {1419}event beginCli(Cli,Sess,Nc_1668);
                                        {1420}out(c, (pkCli_1118,m1_1670));
                                        {1421}in(c, em2_1671: bitstring);
                                        {1422}let m2_1672: bitstring = em2_1671 in
                                        {1423}let (=OpenSecureChannelResponse,wNs_1673: bitstring,ST_1674: bitstring,TTL_1675: bitstring) = m2_1672 in
                                        {1424}let Ns_1676: bitstring = dec(wNs_1673,skCli_1117) in
                                        {1425}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                        {1426}event endCli(Sess,Cli,Ns_1676)
                                    )
                                    else
                                        {1427}let v_1677: bool = (Sess = C) in
                                        (
                                            {1428}if v_1677 then
                                            (
                                                {1429}let pkSess_1678: bitstring = pub(skC) in
                                                {1430}out(c, GetEndpointRequest);
                                                {1431}in(c, (=GetEndpointResponse,=pkSess_1678,=None,SP_1679: bitstring,UP_1680: bitstring));
                                                {1432}new Nc_1681: bitstring;
                                                {1433}let wNc_1682: bitstring = enc(Nc_1681,pkSess_1678) in
                                                {1434}let m1_1683: bitstring = (OpenSecureChannelRequest,pkCli_1118,wNc_1682) in
                                                {1435}event beginCli(Cli,Sess,Nc_1681);
                                                {1436}out(c, (pkCli_1118,m1_1683));
                                                {1437}in(c, em2_1684: bitstring);
                                                {1438}let m2_1685: bitstring = em2_1684 in
                                                {1439}let (=OpenSecureChannelResponse,wNs_1686: bitstring,ST_1687: bitstring,TTL_1688: bitstring) = m2_1685 in
                                                {1440}let Ns_1689: bitstring = dec(wNs_1686,skCli_1117) in
                                                {1441}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {1442}event endCli(Sess,Cli,Ns_1689)
                                            )
                                            else
                                                {1443}let pkSess_1690: bitstring = pub(sk(Sess)) in
                                                {1444}out(c, GetEndpointRequest);
                                                {1445}in(c, (=GetEndpointResponse,=pkSess_1690,=None,SP_1691: bitstring,UP_1692: bitstring));
                                                {1446}new Nc_1693: bitstring;
                                                {1447}let wNc_1694: bitstring = enc(Nc_1693,pkSess_1690) in
                                                {1448}let m1_1695: bitstring = (OpenSecureChannelRequest,pkCli_1118,wNc_1694) in
                                                {1449}event beginCli(Cli,Sess,Nc_1693);
                                                {1450}out(c, (pkCli_1118,m1_1695));
                                                {1451}in(c, em2_1696: bitstring);
                                                {1452}let m2_1697: bitstring = em2_1696 in
                                                {1453}let (=OpenSecureChannelResponse,wNs_1698: bitstring,ST_1699: bitstring,TTL_1700: bitstring) = m2_1697 in
                                                {1454}let Ns_1701: bitstring = dec(wNs_1698,skCli_1117) in
                                                {1455}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {1456}event endCli(Sess,Cli,Ns_1701)
                                        )
                                        else
                                            {1457}let pkSess_1702: bitstring = fail-any in
                                            {1458}out(c, GetEndpointRequest);
                                            {1459}in(c, (=GetEndpointResponse,=pkSess_1702,=None,SP_1703: bitstring,UP_1704: bitstring));
                                            {1460}new Nc_1705: bitstring;
                                            {1461}let wNc_1706: bitstring = enc(Nc_1705,pkSess_1702) in
                                            {1462}let m1_1707: bitstring = (OpenSecureChannelRequest,pkCli_1118,wNc_1706) in
                                            {1463}event beginCli(Cli,Sess,Nc_1705);
                                            {1464}out(c, (pkCli_1118,m1_1707));
                                            {1465}in(c, em2_1708: bitstring);
                                            {1466}let m2_1709: bitstring = em2_1708 in
                                            {1467}let (=OpenSecureChannelResponse,wNs_1710: bitstring,ST_1711: bitstring,TTL_1712: bitstring) = m2_1709 in
                                            {1468}let Ns_1713: bitstring = dec(wNs_1710,skCli_1117) in
                                            {1469}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {1470}event endCli(Sess,Cli,Ns_1713)
                                )
                                else
                                    {1471}let pkSess_1714: bitstring = fail-any in
                                    {1472}out(c, GetEndpointRequest);
                                    {1473}in(c, (=GetEndpointResponse,=pkSess_1714,=None,SP_1715: bitstring,UP_1716: bitstring));
                                    {1474}new Nc_1717: bitstring;
                                    {1475}let wNc_1718: bitstring = enc(Nc_1717,pkSess_1714) in
                                    {1476}let m1_1719: bitstring = (OpenSecureChannelRequest,pkCli_1118,wNc_1718) in
                                    {1477}event beginCli(Cli,Sess,Nc_1717);
                                    {1478}out(c, (pkCli_1118,m1_1719));
                                    {1479}in(c, em2_1720: bitstring);
                                    {1480}let m2_1721: bitstring = em2_1720 in
                                    {1481}let (=OpenSecureChannelResponse,wNs_1722: bitstring,ST_1723: bitstring,TTL_1724: bitstring) = m2_1721 in
                                    {1482}let Ns_1725: bitstring = dec(wNs_1722,skCli_1117) in
                                    {1483}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                    {1484}event endCli(Sess,Cli,Ns_1725)
                        )
                        else
                            {1485}let pkSess_1726: bitstring = fail-any in
                            {1486}out(c, GetEndpointRequest);
                            {1487}in(c, (=GetEndpointResponse,=pkSess_1726,=None,SP_1727: bitstring,UP_1728: bitstring));
                            {1488}new Nc_1729: bitstring;
                            {1489}let wNc_1730: bitstring = enc(Nc_1729,pkSess_1726) in
                            {1490}let m1_1731: bitstring = (OpenSecureChannelRequest,pkCli_1118,wNc_1730) in
                            {1491}event beginCli(Cli,Sess,Nc_1729);
                            {1492}out(c, (pkCli_1118,m1_1731));
                            {1493}in(c, em2_1732: bitstring);
                            {1494}let m2_1733: bitstring = em2_1732 in
                            {1495}let (=OpenSecureChannelResponse,wNs_1734: bitstring,ST_1735: bitstring,TTL_1736: bitstring) = m2_1733 in
                            {1496}let Ns_1737: bitstring = dec(wNs_1734,skCli_1117) in
                            {1497}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                            {1498}event endCli(Sess,Cli,Ns_1737)
                )
                else
                    {1499}let =true = (Cli = C) in
                    (
                        {1500}let skCli_1738: bitstring = skC in
                        {1501}let pkCli_1739: bitstring = pub(skCli_1738) in
                        {1502}let v_1740: bool = (Disco = A) in
                        (
                            {1503}if v_1740 then
                            (
                                {1504}let pkDisco_1741: bitstring = pub(skA) in
                                {1505}let v_1742: bool = (Sess = A) in
                                (
                                    {1506}if v_1742 then
                                    (
                                        {1507}let pkSess_1743: bitstring = pub(skA) in
                                        {1508}out(c, GetEndpointRequest);
                                        {1509}in(c, (=GetEndpointResponse,=pkSess_1743,=None,SP_1744: bitstring,UP_1745: bitstring));
                                        {1510}new Nc_1746: bitstring;
                                        {1511}let wNc_1747: bitstring = enc(Nc_1746,pkSess_1743) in
                                        {1512}let m1_1748: bitstring = (OpenSecureChannelRequest,pkCli_1739,wNc_1747) in
                                        {1513}event beginCli(Cli,Sess,Nc_1746);
                                        {1514}out(c, (pkCli_1739,m1_1748));
                                        {1515}in(c, em2_1749: bitstring);
                                        {1516}let m2_1750: bitstring = em2_1749 in
                                        {1517}let (=OpenSecureChannelResponse,wNs_1751: bitstring,ST_1752: bitstring,TTL_1753: bitstring) = m2_1750 in
                                        {1518}let Ns_1754: bitstring = dec(wNs_1751,skCli_1738) in
                                        {1519}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                        {1520}event endCli(Sess,Cli,Ns_1754)
                                    )
                                    else
                                        {1521}let v_1755: bool = (Sess = B) in
                                        (
                                            {1522}if v_1755 then
                                            (
                                                {1523}let pkSess_1756: bitstring = pub(skB) in
                                                {1524}out(c, GetEndpointRequest);
                                                {1525}in(c, (=GetEndpointResponse,=pkSess_1756,=None,SP_1757: bitstring,UP_1758: bitstring));
                                                {1526}new Nc_1759: bitstring;
                                                {1527}let wNc_1760: bitstring = enc(Nc_1759,pkSess_1756) in
                                                {1528}let m1_1761: bitstring = (OpenSecureChannelRequest,pkCli_1739,wNc_1760) in
                                                {1529}event beginCli(Cli,Sess,Nc_1759);
                                                {1530}out(c, (pkCli_1739,m1_1761));
                                                {1531}in(c, em2_1762: bitstring);
                                                {1532}let m2_1763: bitstring = em2_1762 in
                                                {1533}let (=OpenSecureChannelResponse,wNs_1764: bitstring,ST_1765: bitstring,TTL_1766: bitstring) = m2_1763 in
                                                {1534}let Ns_1767: bitstring = dec(wNs_1764,skCli_1738) in
                                                {1535}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {1536}event endCli(Sess,Cli,Ns_1767)
                                            )
                                            else
                                                {1537}let v_1768: bool = (Sess = C) in
                                                (
                                                    {1538}if v_1768 then
                                                    (
                                                        {1539}let pkSess_1769: bitstring = pub(skC) in
                                                        {1540}out(c, GetEndpointRequest);
                                                        {1541}in(c, (=GetEndpointResponse,=pkSess_1769,=None,SP_1770: bitstring,UP_1771: bitstring));
                                                        {1542}new Nc_1772: bitstring;
                                                        {1543}let wNc_1773: bitstring = enc(Nc_1772,pkSess_1769) in
                                                        {1544}let m1_1774: bitstring = (OpenSecureChannelRequest,pkCli_1739,wNc_1773) in
                                                        {1545}event beginCli(Cli,Sess,Nc_1772);
                                                        {1546}out(c, (pkCli_1739,m1_1774));
                                                        {1547}in(c, em2_1775: bitstring);
                                                        {1548}let m2_1776: bitstring = em2_1775 in
                                                        {1549}let (=OpenSecureChannelResponse,wNs_1777: bitstring,ST_1778: bitstring,TTL_1779: bitstring) = m2_1776 in
                                                        {1550}let Ns_1780: bitstring = dec(wNs_1777,skCli_1738) in
                                                        {1551}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {1552}event endCli(Sess,Cli,Ns_1780)
                                                    )
                                                    else
                                                        {1553}let pkSess_1781: bitstring = pub(sk(Sess)) in
                                                        {1554}out(c, GetEndpointRequest);
                                                        {1555}in(c, (=GetEndpointResponse,=pkSess_1781,=None,SP_1782: bitstring,UP_1783: bitstring));
                                                        {1556}new Nc_1784: bitstring;
                                                        {1557}let wNc_1785: bitstring = enc(Nc_1784,pkSess_1781) in
                                                        {1558}let m1_1786: bitstring = (OpenSecureChannelRequest,pkCli_1739,wNc_1785) in
                                                        {1559}event beginCli(Cli,Sess,Nc_1784);
                                                        {1560}out(c, (pkCli_1739,m1_1786));
                                                        {1561}in(c, em2_1787: bitstring);
                                                        {1562}let m2_1788: bitstring = em2_1787 in
                                                        {1563}let (=OpenSecureChannelResponse,wNs_1789: bitstring,ST_1790: bitstring,TTL_1791: bitstring) = m2_1788 in
                                                        {1564}let Ns_1792: bitstring = dec(wNs_1789,skCli_1738) in
                                                        {1565}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {1566}event endCli(Sess,Cli,Ns_1792)
                                                )
                                                else
                                                    {1567}let pkSess_1793: bitstring = fail-any in
                                                    {1568}out(c, GetEndpointRequest);
                                                    {1569}in(c, (=GetEndpointResponse,=pkSess_1793,=None,SP_1794: bitstring,UP_1795: bitstring));
                                                    {1570}new Nc_1796: bitstring;
                                                    {1571}let wNc_1797: bitstring = enc(Nc_1796,pkSess_1793) in
                                                    {1572}let m1_1798: bitstring = (OpenSecureChannelRequest,pkCli_1739,wNc_1797) in
                                                    {1573}event beginCli(Cli,Sess,Nc_1796);
                                                    {1574}out(c, (pkCli_1739,m1_1798));
                                                    {1575}in(c, em2_1799: bitstring);
                                                    {1576}let m2_1800: bitstring = em2_1799 in
                                                    {1577}let (=OpenSecureChannelResponse,wNs_1801: bitstring,ST_1802: bitstring,TTL_1803: bitstring) = m2_1800 in
                                                    {1578}let Ns_1804: bitstring = dec(wNs_1801,skCli_1738) in
                                                    {1579}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {1580}event endCli(Sess,Cli,Ns_1804)
                                        )
                                        else
                                            {1581}let pkSess_1805: bitstring = fail-any in
                                            {1582}out(c, GetEndpointRequest);
                                            {1583}in(c, (=GetEndpointResponse,=pkSess_1805,=None,SP_1806: bitstring,UP_1807: bitstring));
                                            {1584}new Nc_1808: bitstring;
                                            {1585}let wNc_1809: bitstring = enc(Nc_1808,pkSess_1805) in
                                            {1586}let m1_1810: bitstring = (OpenSecureChannelRequest,pkCli_1739,wNc_1809) in
                                            {1587}event beginCli(Cli,Sess,Nc_1808);
                                            {1588}out(c, (pkCli_1739,m1_1810));
                                            {1589}in(c, em2_1811: bitstring);
                                            {1590}let m2_1812: bitstring = em2_1811 in
                                            {1591}let (=OpenSecureChannelResponse,wNs_1813: bitstring,ST_1814: bitstring,TTL_1815: bitstring) = m2_1812 in
                                            {1592}let Ns_1816: bitstring = dec(wNs_1813,skCli_1738) in
                                            {1593}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {1594}event endCli(Sess,Cli,Ns_1816)
                                )
                                else
                                    {1595}let pkSess_1817: bitstring = fail-any in
                                    {1596}out(c, GetEndpointRequest);
                                    {1597}in(c, (=GetEndpointResponse,=pkSess_1817,=None,SP_1818: bitstring,UP_1819: bitstring));
                                    {1598}new Nc_1820: bitstring;
                                    {1599}let wNc_1821: bitstring = enc(Nc_1820,pkSess_1817) in
                                    {1600}let m1_1822: bitstring = (OpenSecureChannelRequest,pkCli_1739,wNc_1821) in
                                    {1601}event beginCli(Cli,Sess,Nc_1820);
                                    {1602}out(c, (pkCli_1739,m1_1822));
                                    {1603}in(c, em2_1823: bitstring);
                                    {1604}let m2_1824: bitstring = em2_1823 in
                                    {1605}let (=OpenSecureChannelResponse,wNs_1825: bitstring,ST_1826: bitstring,TTL_1827: bitstring) = m2_1824 in
                                    {1606}let Ns_1828: bitstring = dec(wNs_1825,skCli_1738) in
                                    {1607}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                    {1608}event endCli(Sess,Cli,Ns_1828)
                            )
                            else
                                {1609}let v_1829: bool = (Disco = B) in
                                (
                                    {1610}if v_1829 then
                                    (
                                        {1611}let pkDisco_1830: bitstring = pub(skB) in
                                        {1612}let v_1831: bool = (Sess = A) in
                                        (
                                            {1613}if v_1831 then
                                            (
                                                {1614}let pkSess_1832: bitstring = pub(skA) in
                                                {1615}out(c, GetEndpointRequest);
                                                {1616}in(c, (=GetEndpointResponse,=pkSess_1832,=None,SP_1833: bitstring,UP_1834: bitstring));
                                                {1617}new Nc_1835: bitstring;
                                                {1618}let wNc_1836: bitstring = enc(Nc_1835,pkSess_1832) in
                                                {1619}let m1_1837: bitstring = (OpenSecureChannelRequest,pkCli_1739,wNc_1836) in
                                                {1620}event beginCli(Cli,Sess,Nc_1835);
                                                {1621}out(c, (pkCli_1739,m1_1837));
                                                {1622}in(c, em2_1838: bitstring);
                                                {1623}let m2_1839: bitstring = em2_1838 in
                                                {1624}let (=OpenSecureChannelResponse,wNs_1840: bitstring,ST_1841: bitstring,TTL_1842: bitstring) = m2_1839 in
                                                {1625}let Ns_1843: bitstring = dec(wNs_1840,skCli_1738) in
                                                {1626}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {1627}event endCli(Sess,Cli,Ns_1843)
                                            )
                                            else
                                                {1628}let v_1844: bool = (Sess = B) in
                                                (
                                                    {1629}if v_1844 then
                                                    (
                                                        {1630}let pkSess_1845: bitstring = pub(skB) in
                                                        {1631}out(c, GetEndpointRequest);
                                                        {1632}in(c, (=GetEndpointResponse,=pkSess_1845,=None,SP_1846: bitstring,UP_1847: bitstring));
                                                        {1633}new Nc_1848: bitstring;
                                                        {1634}let wNc_1849: bitstring = enc(Nc_1848,pkSess_1845) in
                                                        {1635}let m1_1850: bitstring = (OpenSecureChannelRequest,pkCli_1739,wNc_1849) in
                                                        {1636}event beginCli(Cli,Sess,Nc_1848);
                                                        {1637}out(c, (pkCli_1739,m1_1850));
                                                        {1638}in(c, em2_1851: bitstring);
                                                        {1639}let m2_1852: bitstring = em2_1851 in
                                                        {1640}let (=OpenSecureChannelResponse,wNs_1853: bitstring,ST_1854: bitstring,TTL_1855: bitstring) = m2_1852 in
                                                        {1641}let Ns_1856: bitstring = dec(wNs_1853,skCli_1738) in
                                                        {1642}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {1643}event endCli(Sess,Cli,Ns_1856)
                                                    )
                                                    else
                                                        {1644}let v_1857: bool = (Sess = C) in
                                                        (
                                                            {1645}if v_1857 then
                                                            (
                                                                {1646}let pkSess_1858: bitstring = pub(skC) in
                                                                {1647}out(c, GetEndpointRequest);
                                                                {1648}in(c, (=GetEndpointResponse,=pkSess_1858,=None,SP_1859: bitstring,UP_1860: bitstring));
                                                                {1649}new Nc_1861: bitstring;
                                                                {1650}let wNc_1862: bitstring = enc(Nc_1861,pkSess_1858) in
                                                                {1651}let m1_1863: bitstring = (OpenSecureChannelRequest,pkCli_1739,wNc_1862) in
                                                                {1652}event beginCli(Cli,Sess,Nc_1861);
                                                                {1653}out(c, (pkCli_1739,m1_1863));
                                                                {1654}in(c, em2_1864: bitstring);
                                                                {1655}let m2_1865: bitstring = em2_1864 in
                                                                {1656}let (=OpenSecureChannelResponse,wNs_1866: bitstring,ST_1867: bitstring,TTL_1868: bitstring) = m2_1865 in
                                                                {1657}let Ns_1869: bitstring = dec(wNs_1866,skCli_1738) in
                                                                {1658}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                {1659}event endCli(Sess,Cli,Ns_1869)
                                                            )
                                                            else
                                                                {1660}let pkSess_1870: bitstring = pub(sk(Sess)) in
                                                                {1661}out(c, GetEndpointRequest);
                                                                {1662}in(c, (=GetEndpointResponse,=pkSess_1870,=None,SP_1871: bitstring,UP_1872: bitstring));
                                                                {1663}new Nc_1873: bitstring;
                                                                {1664}let wNc_1874: bitstring = enc(Nc_1873,pkSess_1870) in
                                                                {1665}let m1_1875: bitstring = (OpenSecureChannelRequest,pkCli_1739,wNc_1874) in
                                                                {1666}event beginCli(Cli,Sess,Nc_1873);
                                                                {1667}out(c, (pkCli_1739,m1_1875));
                                                                {1668}in(c, em2_1876: bitstring);
                                                                {1669}let m2_1877: bitstring = em2_1876 in
                                                                {1670}let (=OpenSecureChannelResponse,wNs_1878: bitstring,ST_1879: bitstring,TTL_1880: bitstring) = m2_1877 in
                                                                {1671}let Ns_1881: bitstring = dec(wNs_1878,skCli_1738) in
                                                                {1672}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                {1673}event endCli(Sess,Cli,Ns_1881)
                                                        )
                                                        else
                                                            {1674}let pkSess_1882: bitstring = fail-any in
                                                            {1675}out(c, GetEndpointRequest);
                                                            {1676}in(c, (=GetEndpointResponse,=pkSess_1882,=None,SP_1883: bitstring,UP_1884: bitstring));
                                                            {1677}new Nc_1885: bitstring;
                                                            {1678}let wNc_1886: bitstring = enc(Nc_1885,pkSess_1882) in
                                                            {1679}let m1_1887: bitstring = (OpenSecureChannelRequest,pkCli_1739,wNc_1886) in
                                                            {1680}event beginCli(Cli,Sess,Nc_1885);
                                                            {1681}out(c, (pkCli_1739,m1_1887));
                                                            {1682}in(c, em2_1888: bitstring);
                                                            {1683}let m2_1889: bitstring = em2_1888 in
                                                            {1684}let (=OpenSecureChannelResponse,wNs_1890: bitstring,ST_1891: bitstring,TTL_1892: bitstring) = m2_1889 in
                                                            {1685}let Ns_1893: bitstring = dec(wNs_1890,skCli_1738) in
                                                            {1686}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                            {1687}event endCli(Sess,Cli,Ns_1893)
                                                )
                                                else
                                                    {1688}let pkSess_1894: bitstring = fail-any in
                                                    {1689}out(c, GetEndpointRequest);
                                                    {1690}in(c, (=GetEndpointResponse,=pkSess_1894,=None,SP_1895: bitstring,UP_1896: bitstring));
                                                    {1691}new Nc_1897: bitstring;
                                                    {1692}let wNc_1898: bitstring = enc(Nc_1897,pkSess_1894) in
                                                    {1693}let m1_1899: bitstring = (OpenSecureChannelRequest,pkCli_1739,wNc_1898) in
                                                    {1694}event beginCli(Cli,Sess,Nc_1897);
                                                    {1695}out(c, (pkCli_1739,m1_1899));
                                                    {1696}in(c, em2_1900: bitstring);
                                                    {1697}let m2_1901: bitstring = em2_1900 in
                                                    {1698}let (=OpenSecureChannelResponse,wNs_1902: bitstring,ST_1903: bitstring,TTL_1904: bitstring) = m2_1901 in
                                                    {1699}let Ns_1905: bitstring = dec(wNs_1902,skCli_1738) in
                                                    {1700}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {1701}event endCli(Sess,Cli,Ns_1905)
                                        )
                                        else
                                            {1702}let pkSess_1906: bitstring = fail-any in
                                            {1703}out(c, GetEndpointRequest);
                                            {1704}in(c, (=GetEndpointResponse,=pkSess_1906,=None,SP_1907: bitstring,UP_1908: bitstring));
                                            {1705}new Nc_1909: bitstring;
                                            {1706}let wNc_1910: bitstring = enc(Nc_1909,pkSess_1906) in
                                            {1707}let m1_1911: bitstring = (OpenSecureChannelRequest,pkCli_1739,wNc_1910) in
                                            {1708}event beginCli(Cli,Sess,Nc_1909);
                                            {1709}out(c, (pkCli_1739,m1_1911));
                                            {1710}in(c, em2_1912: bitstring);
                                            {1711}let m2_1913: bitstring = em2_1912 in
                                            {1712}let (=OpenSecureChannelResponse,wNs_1914: bitstring,ST_1915: bitstring,TTL_1916: bitstring) = m2_1913 in
                                            {1713}let Ns_1917: bitstring = dec(wNs_1914,skCli_1738) in
                                            {1714}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {1715}event endCli(Sess,Cli,Ns_1917)
                                    )
                                    else
                                        {1716}let v_1918: bool = (Disco = C) in
                                        (
                                            {1717}if v_1918 then
                                            (
                                                {1718}let pkDisco_1919: bitstring = pub(skC) in
                                                {1719}let v_1920: bool = (Sess = A) in
                                                (
                                                    {1720}if v_1920 then
                                                    (
                                                        {1721}let pkSess_1921: bitstring = pub(skA) in
                                                        {1722}out(c, GetEndpointRequest);
                                                        {1723}in(c, (=GetEndpointResponse,=pkSess_1921,=None,SP_1922: bitstring,UP_1923: bitstring));
                                                        {1724}new Nc_1924: bitstring;
                                                        {1725}let wNc_1925: bitstring = enc(Nc_1924,pkSess_1921) in
                                                        {1726}let m1_1926: bitstring = (OpenSecureChannelRequest,pkCli_1739,wNc_1925) in
                                                        {1727}event beginCli(Cli,Sess,Nc_1924);
                                                        {1728}out(c, (pkCli_1739,m1_1926));
                                                        {1729}in(c, em2_1927: bitstring);
                                                        {1730}let m2_1928: bitstring = em2_1927 in
                                                        {1731}let (=OpenSecureChannelResponse,wNs_1929: bitstring,ST_1930: bitstring,TTL_1931: bitstring) = m2_1928 in
                                                        {1732}let Ns_1932: bitstring = dec(wNs_1929,skCli_1738) in
                                                        {1733}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {1734}event endCli(Sess,Cli,Ns_1932)
                                                    )
                                                    else
                                                        {1735}let v_1933: bool = (Sess = B) in
                                                        (
                                                            {1736}if v_1933 then
                                                            (
                                                                {1737}let pkSess_1934: bitstring = pub(skB) in
                                                                {1738}out(c, GetEndpointRequest);
                                                                {1739}in(c, (=GetEndpointResponse,=pkSess_1934,=None,SP_1935: bitstring,UP_1936: bitstring));
                                                                {1740}new Nc_1937: bitstring;
                                                                {1741}let wNc_1938: bitstring = enc(Nc_1937,pkSess_1934) in
                                                                {1742}let m1_1939: bitstring = (OpenSecureChannelRequest,pkCli_1739,wNc_1938) in
                                                                {1743}event beginCli(Cli,Sess,Nc_1937);
                                                                {1744}out(c, (pkCli_1739,m1_1939));
                                                                {1745}in(c, em2_1940: bitstring);
                                                                {1746}let m2_1941: bitstring = em2_1940 in
                                                                {1747}let (=OpenSecureChannelResponse,wNs_1942: bitstring,ST_1943: bitstring,TTL_1944: bitstring) = m2_1941 in
                                                                {1748}let Ns_1945: bitstring = dec(wNs_1942,skCli_1738) in
                                                                {1749}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                {1750}event endCli(Sess,Cli,Ns_1945)
                                                            )
                                                            else
                                                                {1751}let v_1946: bool = (Sess = C) in
                                                                (
                                                                    {1752}if v_1946 then
                                                                    (
                                                                        {1753}let pkSess_1947: bitstring = pub(skC) in
                                                                        {1754}out(c, GetEndpointRequest);
                                                                        {1755}in(c, (=GetEndpointResponse,=pkSess_1947,=None,SP_1948: bitstring,UP_1949: bitstring));
                                                                        {1756}new Nc_1950: bitstring;
                                                                        {1757}let wNc_1951: bitstring = enc(Nc_1950,pkSess_1947) in
                                                                        {1758}let m1_1952: bitstring = (OpenSecureChannelRequest,pkCli_1739,wNc_1951) in
                                                                        {1759}event beginCli(Cli,Sess,Nc_1950);
                                                                        {1760}out(c, (pkCli_1739,m1_1952));
                                                                        {1761}in(c, em2_1953: bitstring);
                                                                        {1762}let m2_1954: bitstring = em2_1953 in
                                                                        {1763}let (=OpenSecureChannelResponse,wNs_1955: bitstring,ST_1956: bitstring,TTL_1957: bitstring) = m2_1954 in
                                                                        {1764}let Ns_1958: bitstring = dec(wNs_1955,skCli_1738) in
                                                                        {1765}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                        {1766}event endCli(Sess,Cli,Ns_1958)
                                                                    )
                                                                    else
                                                                        {1767}let pkSess_1959: bitstring = pub(sk(Sess)) in
                                                                        {1768}out(c, GetEndpointRequest);
                                                                        {1769}in(c, (=GetEndpointResponse,=pkSess_1959,=None,SP_1960: bitstring,UP_1961: bitstring));
                                                                        {1770}new Nc_1962: bitstring;
                                                                        {1771}let wNc_1963: bitstring = enc(Nc_1962,pkSess_1959) in
                                                                        {1772}let m1_1964: bitstring = (OpenSecureChannelRequest,pkCli_1739,wNc_1963) in
                                                                        {1773}event beginCli(Cli,Sess,Nc_1962);
                                                                        {1774}out(c, (pkCli_1739,m1_1964));
                                                                        {1775}in(c, em2_1965: bitstring);
                                                                        {1776}let m2_1966: bitstring = em2_1965 in
                                                                        {1777}let (=OpenSecureChannelResponse,wNs_1967: bitstring,ST_1968: bitstring,TTL_1969: bitstring) = m2_1966 in
                                                                        {1778}let Ns_1970: bitstring = dec(wNs_1967,skCli_1738) in
                                                                        {1779}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                        {1780}event endCli(Sess,Cli,Ns_1970)
                                                                )
                                                                else
                                                                    {1781}let pkSess_1971: bitstring = fail-any in
                                                                    {1782}out(c, GetEndpointRequest);
                                                                    {1783}in(c, (=GetEndpointResponse,=pkSess_1971,=None,SP_1972: bitstring,UP_1973: bitstring));
                                                                    {1784}new Nc_1974: bitstring;
                                                                    {1785}let wNc_1975: bitstring = enc(Nc_1974,pkSess_1971) in
                                                                    {1786}let m1_1976: bitstring = (OpenSecureChannelRequest,pkCli_1739,wNc_1975) in
                                                                    {1787}event beginCli(Cli,Sess,Nc_1974);
                                                                    {1788}out(c, (pkCli_1739,m1_1976));
                                                                    {1789}in(c, em2_1977: bitstring);
                                                                    {1790}let m2_1978: bitstring = em2_1977 in
                                                                    {1791}let (=OpenSecureChannelResponse,wNs_1979: bitstring,ST_1980: bitstring,TTL_1981: bitstring) = m2_1978 in
                                                                    {1792}let Ns_1982: bitstring = dec(wNs_1979,skCli_1738) in
                                                                    {1793}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                    {1794}event endCli(Sess,Cli,Ns_1982)
                                                        )
                                                        else
                                                            {1795}let pkSess_1983: bitstring = fail-any in
                                                            {1796}out(c, GetEndpointRequest);
                                                            {1797}in(c, (=GetEndpointResponse,=pkSess_1983,=None,SP_1984: bitstring,UP_1985: bitstring));
                                                            {1798}new Nc_1986: bitstring;
                                                            {1799}let wNc_1987: bitstring = enc(Nc_1986,pkSess_1983) in
                                                            {1800}let m1_1988: bitstring = (OpenSecureChannelRequest,pkCli_1739,wNc_1987) in
                                                            {1801}event beginCli(Cli,Sess,Nc_1986);
                                                            {1802}out(c, (pkCli_1739,m1_1988));
                                                            {1803}in(c, em2_1989: bitstring);
                                                            {1804}let m2_1990: bitstring = em2_1989 in
                                                            {1805}let (=OpenSecureChannelResponse,wNs_1991: bitstring,ST_1992: bitstring,TTL_1993: bitstring) = m2_1990 in
                                                            {1806}let Ns_1994: bitstring = dec(wNs_1991,skCli_1738) in
                                                            {1807}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                            {1808}event endCli(Sess,Cli,Ns_1994)
                                                )
                                                else
                                                    {1809}let pkSess_1995: bitstring = fail-any in
                                                    {1810}out(c, GetEndpointRequest);
                                                    {1811}in(c, (=GetEndpointResponse,=pkSess_1995,=None,SP_1996: bitstring,UP_1997: bitstring));
                                                    {1812}new Nc_1998: bitstring;
                                                    {1813}let wNc_1999: bitstring = enc(Nc_1998,pkSess_1995) in
                                                    {1814}let m1_2000: bitstring = (OpenSecureChannelRequest,pkCli_1739,wNc_1999) in
                                                    {1815}event beginCli(Cli,Sess,Nc_1998);
                                                    {1816}out(c, (pkCli_1739,m1_2000));
                                                    {1817}in(c, em2_2001: bitstring);
                                                    {1818}let m2_2002: bitstring = em2_2001 in
                                                    {1819}let (=OpenSecureChannelResponse,wNs_2003: bitstring,ST_2004: bitstring,TTL_2005: bitstring) = m2_2002 in
                                                    {1820}let Ns_2006: bitstring = dec(wNs_2003,skCli_1738) in
                                                    {1821}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {1822}event endCli(Sess,Cli,Ns_2006)
                                            )
                                            else
                                                {1823}let pkDisco_2007: bitstring = pub(sk(Disco)) in
                                                {1824}let v_2008: bool = (Sess = A) in
                                                (
                                                    {1825}if v_2008 then
                                                    (
                                                        {1826}let pkSess_2009: bitstring = pub(skA) in
                                                        {1827}out(c, GetEndpointRequest);
                                                        {1828}in(c, (=GetEndpointResponse,=pkSess_2009,=None,SP_2010: bitstring,UP_2011: bitstring));
                                                        {1829}new Nc_2012: bitstring;
                                                        {1830}let wNc_2013: bitstring = enc(Nc_2012,pkSess_2009) in
                                                        {1831}let m1_2014: bitstring = (OpenSecureChannelRequest,pkCli_1739,wNc_2013) in
                                                        {1832}event beginCli(Cli,Sess,Nc_2012);
                                                        {1833}out(c, (pkCli_1739,m1_2014));
                                                        {1834}in(c, em2_2015: bitstring);
                                                        {1835}let m2_2016: bitstring = em2_2015 in
                                                        {1836}let (=OpenSecureChannelResponse,wNs_2017: bitstring,ST_2018: bitstring,TTL_2019: bitstring) = m2_2016 in
                                                        {1837}let Ns_2020: bitstring = dec(wNs_2017,skCli_1738) in
                                                        {1838}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {1839}event endCli(Sess,Cli,Ns_2020)
                                                    )
                                                    else
                                                        {1840}let v_2021: bool = (Sess = B) in
                                                        (
                                                            {1841}if v_2021 then
                                                            (
                                                                {1842}let pkSess_2022: bitstring = pub(skB) in
                                                                {1843}out(c, GetEndpointRequest);
                                                                {1844}in(c, (=GetEndpointResponse,=pkSess_2022,=None,SP_2023: bitstring,UP_2024: bitstring));
                                                                {1845}new Nc_2025: bitstring;
                                                                {1846}let wNc_2026: bitstring = enc(Nc_2025,pkSess_2022) in
                                                                {1847}let m1_2027: bitstring = (OpenSecureChannelRequest,pkCli_1739,wNc_2026) in
                                                                {1848}event beginCli(Cli,Sess,Nc_2025);
                                                                {1849}out(c, (pkCli_1739,m1_2027));
                                                                {1850}in(c, em2_2028: bitstring);
                                                                {1851}let m2_2029: bitstring = em2_2028 in
                                                                {1852}let (=OpenSecureChannelResponse,wNs_2030: bitstring,ST_2031: bitstring,TTL_2032: bitstring) = m2_2029 in
                                                                {1853}let Ns_2033: bitstring = dec(wNs_2030,skCli_1738) in
                                                                {1854}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                {1855}event endCli(Sess,Cli,Ns_2033)
                                                            )
                                                            else
                                                                {1856}let v_2034: bool = (Sess = C) in
                                                                (
                                                                    {1857}if v_2034 then
                                                                    (
                                                                        {1858}let pkSess_2035: bitstring = pub(skC) in
                                                                        {1859}out(c, GetEndpointRequest);
                                                                        {1860}in(c, (=GetEndpointResponse,=pkSess_2035,=None,SP_2036: bitstring,UP_2037: bitstring));
                                                                        {1861}new Nc_2038: bitstring;
                                                                        {1862}let wNc_2039: bitstring = enc(Nc_2038,pkSess_2035) in
                                                                        {1863}let m1_2040: bitstring = (OpenSecureChannelRequest,pkCli_1739,wNc_2039) in
                                                                        {1864}event beginCli(Cli,Sess,Nc_2038);
                                                                        {1865}out(c, (pkCli_1739,m1_2040));
                                                                        {1866}in(c, em2_2041: bitstring);
                                                                        {1867}let m2_2042: bitstring = em2_2041 in
                                                                        {1868}let (=OpenSecureChannelResponse,wNs_2043: bitstring,ST_2044: bitstring,TTL_2045: bitstring) = m2_2042 in
                                                                        {1869}let Ns_2046: bitstring = dec(wNs_2043,skCli_1738) in
                                                                        {1870}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                        {1871}event endCli(Sess,Cli,Ns_2046)
                                                                    )
                                                                    else
                                                                        {1872}let pkSess_2047: bitstring = pub(sk(Sess)) in
                                                                        {1873}out(c, GetEndpointRequest);
                                                                        {1874}in(c, (=GetEndpointResponse,=pkSess_2047,=None,SP_2048: bitstring,UP_2049: bitstring));
                                                                        {1875}new Nc_2050: bitstring;
                                                                        {1876}let wNc_2051: bitstring = enc(Nc_2050,pkSess_2047) in
                                                                        {1877}let m1_2052: bitstring = (OpenSecureChannelRequest,pkCli_1739,wNc_2051) in
                                                                        {1878}event beginCli(Cli,Sess,Nc_2050);
                                                                        {1879}out(c, (pkCli_1739,m1_2052));
                                                                        {1880}in(c, em2_2053: bitstring);
                                                                        {1881}let m2_2054: bitstring = em2_2053 in
                                                                        {1882}let (=OpenSecureChannelResponse,wNs_2055: bitstring,ST_2056: bitstring,TTL_2057: bitstring) = m2_2054 in
                                                                        {1883}let Ns_2058: bitstring = dec(wNs_2055,skCli_1738) in
                                                                        {1884}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                        {1885}event endCli(Sess,Cli,Ns_2058)
                                                                )
                                                                else
                                                                    {1886}let pkSess_2059: bitstring = fail-any in
                                                                    {1887}out(c, GetEndpointRequest);
                                                                    {1888}in(c, (=GetEndpointResponse,=pkSess_2059,=None,SP_2060: bitstring,UP_2061: bitstring));
                                                                    {1889}new Nc_2062: bitstring;
                                                                    {1890}let wNc_2063: bitstring = enc(Nc_2062,pkSess_2059) in
                                                                    {1891}let m1_2064: bitstring = (OpenSecureChannelRequest,pkCli_1739,wNc_2063) in
                                                                    {1892}event beginCli(Cli,Sess,Nc_2062);
                                                                    {1893}out(c, (pkCli_1739,m1_2064));
                                                                    {1894}in(c, em2_2065: bitstring);
                                                                    {1895}let m2_2066: bitstring = em2_2065 in
                                                                    {1896}let (=OpenSecureChannelResponse,wNs_2067: bitstring,ST_2068: bitstring,TTL_2069: bitstring) = m2_2066 in
                                                                    {1897}let Ns_2070: bitstring = dec(wNs_2067,skCli_1738) in
                                                                    {1898}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                    {1899}event endCli(Sess,Cli,Ns_2070)
                                                        )
                                                        else
                                                            {1900}let pkSess_2071: bitstring = fail-any in
                                                            {1901}out(c, GetEndpointRequest);
                                                            {1902}in(c, (=GetEndpointResponse,=pkSess_2071,=None,SP_2072: bitstring,UP_2073: bitstring));
                                                            {1903}new Nc_2074: bitstring;
                                                            {1904}let wNc_2075: bitstring = enc(Nc_2074,pkSess_2071) in
                                                            {1905}let m1_2076: bitstring = (OpenSecureChannelRequest,pkCli_1739,wNc_2075) in
                                                            {1906}event beginCli(Cli,Sess,Nc_2074);
                                                            {1907}out(c, (pkCli_1739,m1_2076));
                                                            {1908}in(c, em2_2077: bitstring);
                                                            {1909}let m2_2078: bitstring = em2_2077 in
                                                            {1910}let (=OpenSecureChannelResponse,wNs_2079: bitstring,ST_2080: bitstring,TTL_2081: bitstring) = m2_2078 in
                                                            {1911}let Ns_2082: bitstring = dec(wNs_2079,skCli_1738) in
                                                            {1912}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                            {1913}event endCli(Sess,Cli,Ns_2082)
                                                )
                                                else
                                                    {1914}let pkSess_2083: bitstring = fail-any in
                                                    {1915}out(c, GetEndpointRequest);
                                                    {1916}in(c, (=GetEndpointResponse,=pkSess_2083,=None,SP_2084: bitstring,UP_2085: bitstring));
                                                    {1917}new Nc_2086: bitstring;
                                                    {1918}let wNc_2087: bitstring = enc(Nc_2086,pkSess_2083) in
                                                    {1919}let m1_2088: bitstring = (OpenSecureChannelRequest,pkCli_1739,wNc_2087) in
                                                    {1920}event beginCli(Cli,Sess,Nc_2086);
                                                    {1921}out(c, (pkCli_1739,m1_2088));
                                                    {1922}in(c, em2_2089: bitstring);
                                                    {1923}let m2_2090: bitstring = em2_2089 in
                                                    {1924}let (=OpenSecureChannelResponse,wNs_2091: bitstring,ST_2092: bitstring,TTL_2093: bitstring) = m2_2090 in
                                                    {1925}let Ns_2094: bitstring = dec(wNs_2091,skCli_1738) in
                                                    {1926}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {1927}event endCli(Sess,Cli,Ns_2094)
                                        )
                                        else
                                            {1928}let pkDisco_2095: bitstring = fail-any in
                                            {1929}let v_2096: bool = (Sess = A) in
                                            (
                                                {1930}if v_2096 then
                                                (
                                                    {1931}let pkSess_2097: bitstring = pub(skA) in
                                                    {1932}out(c, GetEndpointRequest);
                                                    {1933}in(c, (=GetEndpointResponse,=pkSess_2097,=None,SP_2098: bitstring,UP_2099: bitstring));
                                                    {1934}new Nc_2100: bitstring;
                                                    {1935}let wNc_2101: bitstring = enc(Nc_2100,pkSess_2097) in
                                                    {1936}let m1_2102: bitstring = (OpenSecureChannelRequest,pkCli_1739,wNc_2101) in
                                                    {1937}event beginCli(Cli,Sess,Nc_2100);
                                                    {1938}out(c, (pkCli_1739,m1_2102));
                                                    {1939}in(c, em2_2103: bitstring);
                                                    {1940}let m2_2104: bitstring = em2_2103 in
                                                    {1941}let (=OpenSecureChannelResponse,wNs_2105: bitstring,ST_2106: bitstring,TTL_2107: bitstring) = m2_2104 in
                                                    {1942}let Ns_2108: bitstring = dec(wNs_2105,skCli_1738) in
                                                    {1943}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {1944}event endCli(Sess,Cli,Ns_2108)
                                                )
                                                else
                                                    {1945}let v_2109: bool = (Sess = B) in
                                                    (
                                                        {1946}if v_2109 then
                                                        (
                                                            {1947}let pkSess_2110: bitstring = pub(skB) in
                                                            {1948}out(c, GetEndpointRequest);
                                                            {1949}in(c, (=GetEndpointResponse,=pkSess_2110,=None,SP_2111: bitstring,UP_2112: bitstring));
                                                            {1950}new Nc_2113: bitstring;
                                                            {1951}let wNc_2114: bitstring = enc(Nc_2113,pkSess_2110) in
                                                            {1952}let m1_2115: bitstring = (OpenSecureChannelRequest,pkCli_1739,wNc_2114) in
                                                            {1953}event beginCli(Cli,Sess,Nc_2113);
                                                            {1954}out(c, (pkCli_1739,m1_2115));
                                                            {1955}in(c, em2_2116: bitstring);
                                                            {1956}let m2_2117: bitstring = em2_2116 in
                                                            {1957}let (=OpenSecureChannelResponse,wNs_2118: bitstring,ST_2119: bitstring,TTL_2120: bitstring) = m2_2117 in
                                                            {1958}let Ns_2121: bitstring = dec(wNs_2118,skCli_1738) in
                                                            {1959}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                            {1960}event endCli(Sess,Cli,Ns_2121)
                                                        )
                                                        else
                                                            {1961}let v_2122: bool = (Sess = C) in
                                                            (
                                                                {1962}if v_2122 then
                                                                (
                                                                    {1963}let pkSess_2123: bitstring = pub(skC) in
                                                                    {1964}out(c, GetEndpointRequest);
                                                                    {1965}in(c, (=GetEndpointResponse,=pkSess_2123,=None,SP_2124: bitstring,UP_2125: bitstring));
                                                                    {1966}new Nc_2126: bitstring;
                                                                    {1967}let wNc_2127: bitstring = enc(Nc_2126,pkSess_2123) in
                                                                    {1968}let m1_2128: bitstring = (OpenSecureChannelRequest,pkCli_1739,wNc_2127) in
                                                                    {1969}event beginCli(Cli,Sess,Nc_2126);
                                                                    {1970}out(c, (pkCli_1739,m1_2128));
                                                                    {1971}in(c, em2_2129: bitstring);
                                                                    {1972}let m2_2130: bitstring = em2_2129 in
                                                                    {1973}let (=OpenSecureChannelResponse,wNs_2131: bitstring,ST_2132: bitstring,TTL_2133: bitstring) = m2_2130 in
                                                                    {1974}let Ns_2134: bitstring = dec(wNs_2131,skCli_1738) in
                                                                    {1975}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                    {1976}event endCli(Sess,Cli,Ns_2134)
                                                                )
                                                                else
                                                                    {1977}let pkSess_2135: bitstring = pub(sk(Sess)) in
                                                                    {1978}out(c, GetEndpointRequest);
                                                                    {1979}in(c, (=GetEndpointResponse,=pkSess_2135,=None,SP_2136: bitstring,UP_2137: bitstring));
                                                                    {1980}new Nc_2138: bitstring;
                                                                    {1981}let wNc_2139: bitstring = enc(Nc_2138,pkSess_2135) in
                                                                    {1982}let m1_2140: bitstring = (OpenSecureChannelRequest,pkCli_1739,wNc_2139) in
                                                                    {1983}event beginCli(Cli,Sess,Nc_2138);
                                                                    {1984}out(c, (pkCli_1739,m1_2140));
                                                                    {1985}in(c, em2_2141: bitstring);
                                                                    {1986}let m2_2142: bitstring = em2_2141 in
                                                                    {1987}let (=OpenSecureChannelResponse,wNs_2143: bitstring,ST_2144: bitstring,TTL_2145: bitstring) = m2_2142 in
                                                                    {1988}let Ns_2146: bitstring = dec(wNs_2143,skCli_1738) in
                                                                    {1989}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                    {1990}event endCli(Sess,Cli,Ns_2146)
                                                            )
                                                            else
                                                                {1991}let pkSess_2147: bitstring = fail-any in
                                                                {1992}out(c, GetEndpointRequest);
                                                                {1993}in(c, (=GetEndpointResponse,=pkSess_2147,=None,SP_2148: bitstring,UP_2149: bitstring));
                                                                {1994}new Nc_2150: bitstring;
                                                                {1995}let wNc_2151: bitstring = enc(Nc_2150,pkSess_2147) in
                                                                {1996}let m1_2152: bitstring = (OpenSecureChannelRequest,pkCli_1739,wNc_2151) in
                                                                {1997}event beginCli(Cli,Sess,Nc_2150);
                                                                {1998}out(c, (pkCli_1739,m1_2152));
                                                                {1999}in(c, em2_2153: bitstring);
                                                                {2000}let m2_2154: bitstring = em2_2153 in
                                                                {2001}let (=OpenSecureChannelResponse,wNs_2155: bitstring,ST_2156: bitstring,TTL_2157: bitstring) = m2_2154 in
                                                                {2002}let Ns_2158: bitstring = dec(wNs_2155,skCli_1738) in
                                                                {2003}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                {2004}event endCli(Sess,Cli,Ns_2158)
                                                    )
                                                    else
                                                        {2005}let pkSess_2159: bitstring = fail-any in
                                                        {2006}out(c, GetEndpointRequest);
                                                        {2007}in(c, (=GetEndpointResponse,=pkSess_2159,=None,SP_2160: bitstring,UP_2161: bitstring));
                                                        {2008}new Nc_2162: bitstring;
                                                        {2009}let wNc_2163: bitstring = enc(Nc_2162,pkSess_2159) in
                                                        {2010}let m1_2164: bitstring = (OpenSecureChannelRequest,pkCli_1739,wNc_2163) in
                                                        {2011}event beginCli(Cli,Sess,Nc_2162);
                                                        {2012}out(c, (pkCli_1739,m1_2164));
                                                        {2013}in(c, em2_2165: bitstring);
                                                        {2014}let m2_2166: bitstring = em2_2165 in
                                                        {2015}let (=OpenSecureChannelResponse,wNs_2167: bitstring,ST_2168: bitstring,TTL_2169: bitstring) = m2_2166 in
                                                        {2016}let Ns_2170: bitstring = dec(wNs_2167,skCli_1738) in
                                                        {2017}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {2018}event endCli(Sess,Cli,Ns_2170)
                                            )
                                            else
                                                {2019}let pkSess_2171: bitstring = fail-any in
                                                {2020}out(c, GetEndpointRequest);
                                                {2021}in(c, (=GetEndpointResponse,=pkSess_2171,=None,SP_2172: bitstring,UP_2173: bitstring));
                                                {2022}new Nc_2174: bitstring;
                                                {2023}let wNc_2175: bitstring = enc(Nc_2174,pkSess_2171) in
                                                {2024}let m1_2176: bitstring = (OpenSecureChannelRequest,pkCli_1739,wNc_2175) in
                                                {2025}event beginCli(Cli,Sess,Nc_2174);
                                                {2026}out(c, (pkCli_1739,m1_2176));
                                                {2027}in(c, em2_2177: bitstring);
                                                {2028}let m2_2178: bitstring = em2_2177 in
                                                {2029}let (=OpenSecureChannelResponse,wNs_2179: bitstring,ST_2180: bitstring,TTL_2181: bitstring) = m2_2178 in
                                                {2030}let Ns_2182: bitstring = dec(wNs_2179,skCli_1738) in
                                                {2031}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {2032}event endCli(Sess,Cli,Ns_2182)
                                )
                                else
                                    {2033}let pkDisco_2183: bitstring = fail-any in
                                    {2034}let v_2184: bool = (Sess = A) in
                                    (
                                        {2035}if v_2184 then
                                        (
                                            {2036}let pkSess_2185: bitstring = pub(skA) in
                                            {2037}out(c, GetEndpointRequest);
                                            {2038}in(c, (=GetEndpointResponse,=pkSess_2185,=None,SP_2186: bitstring,UP_2187: bitstring));
                                            {2039}new Nc_2188: bitstring;
                                            {2040}let wNc_2189: bitstring = enc(Nc_2188,pkSess_2185) in
                                            {2041}let m1_2190: bitstring = (OpenSecureChannelRequest,pkCli_1739,wNc_2189) in
                                            {2042}event beginCli(Cli,Sess,Nc_2188);
                                            {2043}out(c, (pkCli_1739,m1_2190));
                                            {2044}in(c, em2_2191: bitstring);
                                            {2045}let m2_2192: bitstring = em2_2191 in
                                            {2046}let (=OpenSecureChannelResponse,wNs_2193: bitstring,ST_2194: bitstring,TTL_2195: bitstring) = m2_2192 in
                                            {2047}let Ns_2196: bitstring = dec(wNs_2193,skCli_1738) in
                                            {2048}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {2049}event endCli(Sess,Cli,Ns_2196)
                                        )
                                        else
                                            {2050}let v_2197: bool = (Sess = B) in
                                            (
                                                {2051}if v_2197 then
                                                (
                                                    {2052}let pkSess_2198: bitstring = pub(skB) in
                                                    {2053}out(c, GetEndpointRequest);
                                                    {2054}in(c, (=GetEndpointResponse,=pkSess_2198,=None,SP_2199: bitstring,UP_2200: bitstring));
                                                    {2055}new Nc_2201: bitstring;
                                                    {2056}let wNc_2202: bitstring = enc(Nc_2201,pkSess_2198) in
                                                    {2057}let m1_2203: bitstring = (OpenSecureChannelRequest,pkCli_1739,wNc_2202) in
                                                    {2058}event beginCli(Cli,Sess,Nc_2201);
                                                    {2059}out(c, (pkCli_1739,m1_2203));
                                                    {2060}in(c, em2_2204: bitstring);
                                                    {2061}let m2_2205: bitstring = em2_2204 in
                                                    {2062}let (=OpenSecureChannelResponse,wNs_2206: bitstring,ST_2207: bitstring,TTL_2208: bitstring) = m2_2205 in
                                                    {2063}let Ns_2209: bitstring = dec(wNs_2206,skCli_1738) in
                                                    {2064}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {2065}event endCli(Sess,Cli,Ns_2209)
                                                )
                                                else
                                                    {2066}let v_2210: bool = (Sess = C) in
                                                    (
                                                        {2067}if v_2210 then
                                                        (
                                                            {2068}let pkSess_2211: bitstring = pub(skC) in
                                                            {2069}out(c, GetEndpointRequest);
                                                            {2070}in(c, (=GetEndpointResponse,=pkSess_2211,=None,SP_2212: bitstring,UP_2213: bitstring));
                                                            {2071}new Nc_2214: bitstring;
                                                            {2072}let wNc_2215: bitstring = enc(Nc_2214,pkSess_2211) in
                                                            {2073}let m1_2216: bitstring = (OpenSecureChannelRequest,pkCli_1739,wNc_2215) in
                                                            {2074}event beginCli(Cli,Sess,Nc_2214);
                                                            {2075}out(c, (pkCli_1739,m1_2216));
                                                            {2076}in(c, em2_2217: bitstring);
                                                            {2077}let m2_2218: bitstring = em2_2217 in
                                                            {2078}let (=OpenSecureChannelResponse,wNs_2219: bitstring,ST_2220: bitstring,TTL_2221: bitstring) = m2_2218 in
                                                            {2079}let Ns_2222: bitstring = dec(wNs_2219,skCli_1738) in
                                                            {2080}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                            {2081}event endCli(Sess,Cli,Ns_2222)
                                                        )
                                                        else
                                                            {2082}let pkSess_2223: bitstring = pub(sk(Sess)) in
                                                            {2083}out(c, GetEndpointRequest);
                                                            {2084}in(c, (=GetEndpointResponse,=pkSess_2223,=None,SP_2224: bitstring,UP_2225: bitstring));
                                                            {2085}new Nc_2226: bitstring;
                                                            {2086}let wNc_2227: bitstring = enc(Nc_2226,pkSess_2223) in
                                                            {2087}let m1_2228: bitstring = (OpenSecureChannelRequest,pkCli_1739,wNc_2227) in
                                                            {2088}event beginCli(Cli,Sess,Nc_2226);
                                                            {2089}out(c, (pkCli_1739,m1_2228));
                                                            {2090}in(c, em2_2229: bitstring);
                                                            {2091}let m2_2230: bitstring = em2_2229 in
                                                            {2092}let (=OpenSecureChannelResponse,wNs_2231: bitstring,ST_2232: bitstring,TTL_2233: bitstring) = m2_2230 in
                                                            {2093}let Ns_2234: bitstring = dec(wNs_2231,skCli_1738) in
                                                            {2094}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                            {2095}event endCli(Sess,Cli,Ns_2234)
                                                    )
                                                    else
                                                        {2096}let pkSess_2235: bitstring = fail-any in
                                                        {2097}out(c, GetEndpointRequest);
                                                        {2098}in(c, (=GetEndpointResponse,=pkSess_2235,=None,SP_2236: bitstring,UP_2237: bitstring));
                                                        {2099}new Nc_2238: bitstring;
                                                        {2100}let wNc_2239: bitstring = enc(Nc_2238,pkSess_2235) in
                                                        {2101}let m1_2240: bitstring = (OpenSecureChannelRequest,pkCli_1739,wNc_2239) in
                                                        {2102}event beginCli(Cli,Sess,Nc_2238);
                                                        {2103}out(c, (pkCli_1739,m1_2240));
                                                        {2104}in(c, em2_2241: bitstring);
                                                        {2105}let m2_2242: bitstring = em2_2241 in
                                                        {2106}let (=OpenSecureChannelResponse,wNs_2243: bitstring,ST_2244: bitstring,TTL_2245: bitstring) = m2_2242 in
                                                        {2107}let Ns_2246: bitstring = dec(wNs_2243,skCli_1738) in
                                                        {2108}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {2109}event endCli(Sess,Cli,Ns_2246)
                                            )
                                            else
                                                {2110}let pkSess_2247: bitstring = fail-any in
                                                {2111}out(c, GetEndpointRequest);
                                                {2112}in(c, (=GetEndpointResponse,=pkSess_2247,=None,SP_2248: bitstring,UP_2249: bitstring));
                                                {2113}new Nc_2250: bitstring;
                                                {2114}let wNc_2251: bitstring = enc(Nc_2250,pkSess_2247) in
                                                {2115}let m1_2252: bitstring = (OpenSecureChannelRequest,pkCli_1739,wNc_2251) in
                                                {2116}event beginCli(Cli,Sess,Nc_2250);
                                                {2117}out(c, (pkCli_1739,m1_2252));
                                                {2118}in(c, em2_2253: bitstring);
                                                {2119}let m2_2254: bitstring = em2_2253 in
                                                {2120}let (=OpenSecureChannelResponse,wNs_2255: bitstring,ST_2256: bitstring,TTL_2257: bitstring) = m2_2254 in
                                                {2121}let Ns_2258: bitstring = dec(wNs_2255,skCli_1738) in
                                                {2122}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {2123}event endCli(Sess,Cli,Ns_2258)
                                    )
                                    else
                                        {2124}let pkSess_2259: bitstring = fail-any in
                                        {2125}out(c, GetEndpointRequest);
                                        {2126}in(c, (=GetEndpointResponse,=pkSess_2259,=None,SP_2260: bitstring,UP_2261: bitstring));
                                        {2127}new Nc_2262: bitstring;
                                        {2128}let wNc_2263: bitstring = enc(Nc_2262,pkSess_2259) in
                                        {2129}let m1_2264: bitstring = (OpenSecureChannelRequest,pkCli_1739,wNc_2263) in
                                        {2130}event beginCli(Cli,Sess,Nc_2262);
                                        {2131}out(c, (pkCli_1739,m1_2264));
                                        {2132}in(c, em2_2265: bitstring);
                                        {2133}let m2_2266: bitstring = em2_2265 in
                                        {2134}let (=OpenSecureChannelResponse,wNs_2267: bitstring,ST_2268: bitstring,TTL_2269: bitstring) = m2_2266 in
                                        {2135}let Ns_2270: bitstring = dec(wNs_2267,skCli_1738) in
                                        {2136}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                        {2137}event endCli(Sess,Cli,Ns_2270)
                        )
                        else
                            {2138}let pkDisco_2271: bitstring = fail-any in
                            {2139}let v_2272: bool = (Sess = A) in
                            (
                                {2140}if v_2272 then
                                (
                                    {2141}let pkSess_2273: bitstring = pub(skA) in
                                    {2142}out(c, GetEndpointRequest);
                                    {2143}in(c, (=GetEndpointResponse,=pkSess_2273,=None,SP_2274: bitstring,UP_2275: bitstring));
                                    {2144}new Nc_2276: bitstring;
                                    {2145}let wNc_2277: bitstring = enc(Nc_2276,pkSess_2273) in
                                    {2146}let m1_2278: bitstring = (OpenSecureChannelRequest,pkCli_1739,wNc_2277) in
                                    {2147}event beginCli(Cli,Sess,Nc_2276);
                                    {2148}out(c, (pkCli_1739,m1_2278));
                                    {2149}in(c, em2_2279: bitstring);
                                    {2150}let m2_2280: bitstring = em2_2279 in
                                    {2151}let (=OpenSecureChannelResponse,wNs_2281: bitstring,ST_2282: bitstring,TTL_2283: bitstring) = m2_2280 in
                                    {2152}let Ns_2284: bitstring = dec(wNs_2281,skCli_1738) in
                                    {2153}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                    {2154}event endCli(Sess,Cli,Ns_2284)
                                )
                                else
                                    {2155}let v_2285: bool = (Sess = B) in
                                    (
                                        {2156}if v_2285 then
                                        (
                                            {2157}let pkSess_2286: bitstring = pub(skB) in
                                            {2158}out(c, GetEndpointRequest);
                                            {2159}in(c, (=GetEndpointResponse,=pkSess_2286,=None,SP_2287: bitstring,UP_2288: bitstring));
                                            {2160}new Nc_2289: bitstring;
                                            {2161}let wNc_2290: bitstring = enc(Nc_2289,pkSess_2286) in
                                            {2162}let m1_2291: bitstring = (OpenSecureChannelRequest,pkCli_1739,wNc_2290) in
                                            {2163}event beginCli(Cli,Sess,Nc_2289);
                                            {2164}out(c, (pkCli_1739,m1_2291));
                                            {2165}in(c, em2_2292: bitstring);
                                            {2166}let m2_2293: bitstring = em2_2292 in
                                            {2167}let (=OpenSecureChannelResponse,wNs_2294: bitstring,ST_2295: bitstring,TTL_2296: bitstring) = m2_2293 in
                                            {2168}let Ns_2297: bitstring = dec(wNs_2294,skCli_1738) in
                                            {2169}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {2170}event endCli(Sess,Cli,Ns_2297)
                                        )
                                        else
                                            {2171}let v_2298: bool = (Sess = C) in
                                            (
                                                {2172}if v_2298 then
                                                (
                                                    {2173}let pkSess_2299: bitstring = pub(skC) in
                                                    {2174}out(c, GetEndpointRequest);
                                                    {2175}in(c, (=GetEndpointResponse,=pkSess_2299,=None,SP_2300: bitstring,UP_2301: bitstring));
                                                    {2176}new Nc_2302: bitstring;
                                                    {2177}let wNc_2303: bitstring = enc(Nc_2302,pkSess_2299) in
                                                    {2178}let m1_2304: bitstring = (OpenSecureChannelRequest,pkCli_1739,wNc_2303) in
                                                    {2179}event beginCli(Cli,Sess,Nc_2302);
                                                    {2180}out(c, (pkCli_1739,m1_2304));
                                                    {2181}in(c, em2_2305: bitstring);
                                                    {2182}let m2_2306: bitstring = em2_2305 in
                                                    {2183}let (=OpenSecureChannelResponse,wNs_2307: bitstring,ST_2308: bitstring,TTL_2309: bitstring) = m2_2306 in
                                                    {2184}let Ns_2310: bitstring = dec(wNs_2307,skCli_1738) in
                                                    {2185}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {2186}event endCli(Sess,Cli,Ns_2310)
                                                )
                                                else
                                                    {2187}let pkSess_2311: bitstring = pub(sk(Sess)) in
                                                    {2188}out(c, GetEndpointRequest);
                                                    {2189}in(c, (=GetEndpointResponse,=pkSess_2311,=None,SP_2312: bitstring,UP_2313: bitstring));
                                                    {2190}new Nc_2314: bitstring;
                                                    {2191}let wNc_2315: bitstring = enc(Nc_2314,pkSess_2311) in
                                                    {2192}let m1_2316: bitstring = (OpenSecureChannelRequest,pkCli_1739,wNc_2315) in
                                                    {2193}event beginCli(Cli,Sess,Nc_2314);
                                                    {2194}out(c, (pkCli_1739,m1_2316));
                                                    {2195}in(c, em2_2317: bitstring);
                                                    {2196}let m2_2318: bitstring = em2_2317 in
                                                    {2197}let (=OpenSecureChannelResponse,wNs_2319: bitstring,ST_2320: bitstring,TTL_2321: bitstring) = m2_2318 in
                                                    {2198}let Ns_2322: bitstring = dec(wNs_2319,skCli_1738) in
                                                    {2199}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {2200}event endCli(Sess,Cli,Ns_2322)
                                            )
                                            else
                                                {2201}let pkSess_2323: bitstring = fail-any in
                                                {2202}out(c, GetEndpointRequest);
                                                {2203}in(c, (=GetEndpointResponse,=pkSess_2323,=None,SP_2324: bitstring,UP_2325: bitstring));
                                                {2204}new Nc_2326: bitstring;
                                                {2205}let wNc_2327: bitstring = enc(Nc_2326,pkSess_2323) in
                                                {2206}let m1_2328: bitstring = (OpenSecureChannelRequest,pkCli_1739,wNc_2327) in
                                                {2207}event beginCli(Cli,Sess,Nc_2326);
                                                {2208}out(c, (pkCli_1739,m1_2328));
                                                {2209}in(c, em2_2329: bitstring);
                                                {2210}let m2_2330: bitstring = em2_2329 in
                                                {2211}let (=OpenSecureChannelResponse,wNs_2331: bitstring,ST_2332: bitstring,TTL_2333: bitstring) = m2_2330 in
                                                {2212}let Ns_2334: bitstring = dec(wNs_2331,skCli_1738) in
                                                {2213}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {2214}event endCli(Sess,Cli,Ns_2334)
                                    )
                                    else
                                        {2215}let pkSess_2335: bitstring = fail-any in
                                        {2216}out(c, GetEndpointRequest);
                                        {2217}in(c, (=GetEndpointResponse,=pkSess_2335,=None,SP_2336: bitstring,UP_2337: bitstring));
                                        {2218}new Nc_2338: bitstring;
                                        {2219}let wNc_2339: bitstring = enc(Nc_2338,pkSess_2335) in
                                        {2220}let m1_2340: bitstring = (OpenSecureChannelRequest,pkCli_1739,wNc_2339) in
                                        {2221}event beginCli(Cli,Sess,Nc_2338);
                                        {2222}out(c, (pkCli_1739,m1_2340));
                                        {2223}in(c, em2_2341: bitstring);
                                        {2224}let m2_2342: bitstring = em2_2341 in
                                        {2225}let (=OpenSecureChannelResponse,wNs_2343: bitstring,ST_2344: bitstring,TTL_2345: bitstring) = m2_2342 in
                                        {2226}let Ns_2346: bitstring = dec(wNs_2343,skCli_1738) in
                                        {2227}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                        {2228}event endCli(Sess,Cli,Ns_2346)
                            )
                            else
                                {2229}let pkSess_2347: bitstring = fail-any in
                                {2230}out(c, GetEndpointRequest);
                                {2231}in(c, (=GetEndpointResponse,=pkSess_2347,=None,SP_2348: bitstring,UP_2349: bitstring));
                                {2232}new Nc_2350: bitstring;
                                {2233}let wNc_2351: bitstring = enc(Nc_2350,pkSess_2347) in
                                {2234}let m1_2352: bitstring = (OpenSecureChannelRequest,pkCli_1739,wNc_2351) in
                                {2235}event beginCli(Cli,Sess,Nc_2350);
                                {2236}out(c, (pkCli_1739,m1_2352));
                                {2237}in(c, em2_2353: bitstring);
                                {2238}let m2_2354: bitstring = em2_2353 in
                                {2239}let (=OpenSecureChannelResponse,wNs_2355: bitstring,ST_2356: bitstring,TTL_2357: bitstring) = m2_2354 in
                                {2240}let Ns_2358: bitstring = dec(wNs_2355,skCli_1738) in
                                {2241}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                {2242}event endCli(Sess,Cli,Ns_2358)
                    )
                    else
                        {2243}let skCli_2359: bitstring = fail-any in
                        {2244}let pkCli_2360: bitstring = pub(skCli_2359) in
                        {2245}let v_2361: bool = (Disco = A) in
                        (
                            {2246}if v_2361 then
                            (
                                {2247}let pkDisco_2362: bitstring = pub(skA) in
                                {2248}let v_2363: bool = (Sess = A) in
                                (
                                    {2249}if v_2363 then
                                    (
                                        {2250}let pkSess_2364: bitstring = pub(skA) in
                                        {2251}out(c, GetEndpointRequest);
                                        {2252}in(c, (=GetEndpointResponse,=pkSess_2364,=None,SP_2365: bitstring,UP_2366: bitstring));
                                        {2253}new Nc_2367: bitstring;
                                        {2254}let wNc_2368: bitstring = enc(Nc_2367,pkSess_2364) in
                                        {2255}let m1_2369: bitstring = (OpenSecureChannelRequest,pkCli_2360,wNc_2368) in
                                        {2256}event beginCli(Cli,Sess,Nc_2367);
                                        {2257}out(c, (pkCli_2360,m1_2369));
                                        {2258}in(c, em2_2370: bitstring);
                                        {2259}let m2_2371: bitstring = em2_2370 in
                                        {2260}let (=OpenSecureChannelResponse,wNs_2372: bitstring,ST_2373: bitstring,TTL_2374: bitstring) = m2_2371 in
                                        {2261}let Ns_2375: bitstring = dec(wNs_2372,skCli_2359) in
                                        {2262}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                        {2263}event endCli(Sess,Cli,Ns_2375)
                                    )
                                    else
                                        {2264}let v_2376: bool = (Sess = B) in
                                        (
                                            {2265}if v_2376 then
                                            (
                                                {2266}let pkSess_2377: bitstring = pub(skB) in
                                                {2267}out(c, GetEndpointRequest);
                                                {2268}in(c, (=GetEndpointResponse,=pkSess_2377,=None,SP_2378: bitstring,UP_2379: bitstring));
                                                {2269}new Nc_2380: bitstring;
                                                {2270}let wNc_2381: bitstring = enc(Nc_2380,pkSess_2377) in
                                                {2271}let m1_2382: bitstring = (OpenSecureChannelRequest,pkCli_2360,wNc_2381) in
                                                {2272}event beginCli(Cli,Sess,Nc_2380);
                                                {2273}out(c, (pkCli_2360,m1_2382));
                                                {2274}in(c, em2_2383: bitstring);
                                                {2275}let m2_2384: bitstring = em2_2383 in
                                                {2276}let (=OpenSecureChannelResponse,wNs_2385: bitstring,ST_2386: bitstring,TTL_2387: bitstring) = m2_2384 in
                                                {2277}let Ns_2388: bitstring = dec(wNs_2385,skCli_2359) in
                                                {2278}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {2279}event endCli(Sess,Cli,Ns_2388)
                                            )
                                            else
                                                {2280}let v_2389: bool = (Sess = C) in
                                                (
                                                    {2281}if v_2389 then
                                                    (
                                                        {2282}let pkSess_2390: bitstring = pub(skC) in
                                                        {2283}out(c, GetEndpointRequest);
                                                        {2284}in(c, (=GetEndpointResponse,=pkSess_2390,=None,SP_2391: bitstring,UP_2392: bitstring));
                                                        {2285}new Nc_2393: bitstring;
                                                        {2286}let wNc_2394: bitstring = enc(Nc_2393,pkSess_2390) in
                                                        {2287}let m1_2395: bitstring = (OpenSecureChannelRequest,pkCli_2360,wNc_2394) in
                                                        {2288}event beginCli(Cli,Sess,Nc_2393);
                                                        {2289}out(c, (pkCli_2360,m1_2395));
                                                        {2290}in(c, em2_2396: bitstring);
                                                        {2291}let m2_2397: bitstring = em2_2396 in
                                                        {2292}let (=OpenSecureChannelResponse,wNs_2398: bitstring,ST_2399: bitstring,TTL_2400: bitstring) = m2_2397 in
                                                        {2293}let Ns_2401: bitstring = dec(wNs_2398,skCli_2359) in
                                                        {2294}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {2295}event endCli(Sess,Cli,Ns_2401)
                                                    )
                                                    else
                                                        {2296}let pkSess_2402: bitstring = pub(sk(Sess)) in
                                                        {2297}out(c, GetEndpointRequest);
                                                        {2298}in(c, (=GetEndpointResponse,=pkSess_2402,=None,SP_2403: bitstring,UP_2404: bitstring));
                                                        {2299}new Nc_2405: bitstring;
                                                        {2300}let wNc_2406: bitstring = enc(Nc_2405,pkSess_2402) in
                                                        {2301}let m1_2407: bitstring = (OpenSecureChannelRequest,pkCli_2360,wNc_2406) in
                                                        {2302}event beginCli(Cli,Sess,Nc_2405);
                                                        {2303}out(c, (pkCli_2360,m1_2407));
                                                        {2304}in(c, em2_2408: bitstring);
                                                        {2305}let m2_2409: bitstring = em2_2408 in
                                                        {2306}let (=OpenSecureChannelResponse,wNs_2410: bitstring,ST_2411: bitstring,TTL_2412: bitstring) = m2_2409 in
                                                        {2307}let Ns_2413: bitstring = dec(wNs_2410,skCli_2359) in
                                                        {2308}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {2309}event endCli(Sess,Cli,Ns_2413)
                                                )
                                                else
                                                    {2310}let pkSess_2414: bitstring = fail-any in
                                                    {2311}out(c, GetEndpointRequest);
                                                    {2312}in(c, (=GetEndpointResponse,=pkSess_2414,=None,SP_2415: bitstring,UP_2416: bitstring));
                                                    {2313}new Nc_2417: bitstring;
                                                    {2314}let wNc_2418: bitstring = enc(Nc_2417,pkSess_2414) in
                                                    {2315}let m1_2419: bitstring = (OpenSecureChannelRequest,pkCli_2360,wNc_2418) in
                                                    {2316}event beginCli(Cli,Sess,Nc_2417);
                                                    {2317}out(c, (pkCli_2360,m1_2419));
                                                    {2318}in(c, em2_2420: bitstring);
                                                    {2319}let m2_2421: bitstring = em2_2420 in
                                                    {2320}let (=OpenSecureChannelResponse,wNs_2422: bitstring,ST_2423: bitstring,TTL_2424: bitstring) = m2_2421 in
                                                    {2321}let Ns_2425: bitstring = dec(wNs_2422,skCli_2359) in
                                                    {2322}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {2323}event endCli(Sess,Cli,Ns_2425)
                                        )
                                        else
                                            {2324}let pkSess_2426: bitstring = fail-any in
                                            {2325}out(c, GetEndpointRequest);
                                            {2326}in(c, (=GetEndpointResponse,=pkSess_2426,=None,SP_2427: bitstring,UP_2428: bitstring));
                                            {2327}new Nc_2429: bitstring;
                                            {2328}let wNc_2430: bitstring = enc(Nc_2429,pkSess_2426) in
                                            {2329}let m1_2431: bitstring = (OpenSecureChannelRequest,pkCli_2360,wNc_2430) in
                                            {2330}event beginCli(Cli,Sess,Nc_2429);
                                            {2331}out(c, (pkCli_2360,m1_2431));
                                            {2332}in(c, em2_2432: bitstring);
                                            {2333}let m2_2433: bitstring = em2_2432 in
                                            {2334}let (=OpenSecureChannelResponse,wNs_2434: bitstring,ST_2435: bitstring,TTL_2436: bitstring) = m2_2433 in
                                            {2335}let Ns_2437: bitstring = dec(wNs_2434,skCli_2359) in
                                            {2336}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {2337}event endCli(Sess,Cli,Ns_2437)
                                )
                                else
                                    {2338}let pkSess_2438: bitstring = fail-any in
                                    {2339}out(c, GetEndpointRequest);
                                    {2340}in(c, (=GetEndpointResponse,=pkSess_2438,=None,SP_2439: bitstring,UP_2440: bitstring));
                                    {2341}new Nc_2441: bitstring;
                                    {2342}let wNc_2442: bitstring = enc(Nc_2441,pkSess_2438) in
                                    {2343}let m1_2443: bitstring = (OpenSecureChannelRequest,pkCli_2360,wNc_2442) in
                                    {2344}event beginCli(Cli,Sess,Nc_2441);
                                    {2345}out(c, (pkCli_2360,m1_2443));
                                    {2346}in(c, em2_2444: bitstring);
                                    {2347}let m2_2445: bitstring = em2_2444 in
                                    {2348}let (=OpenSecureChannelResponse,wNs_2446: bitstring,ST_2447: bitstring,TTL_2448: bitstring) = m2_2445 in
                                    {2349}let Ns_2449: bitstring = dec(wNs_2446,skCli_2359) in
                                    {2350}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                    {2351}event endCli(Sess,Cli,Ns_2449)
                            )
                            else
                                {2352}let v_2450: bool = (Disco = B) in
                                (
                                    {2353}if v_2450 then
                                    (
                                        {2354}let pkDisco_2451: bitstring = pub(skB) in
                                        {2355}let v_2452: bool = (Sess = A) in
                                        (
                                            {2356}if v_2452 then
                                            (
                                                {2357}let pkSess_2453: bitstring = pub(skA) in
                                                {2358}out(c, GetEndpointRequest);
                                                {2359}in(c, (=GetEndpointResponse,=pkSess_2453,=None,SP_2454: bitstring,UP_2455: bitstring));
                                                {2360}new Nc_2456: bitstring;
                                                {2361}let wNc_2457: bitstring = enc(Nc_2456,pkSess_2453) in
                                                {2362}let m1_2458: bitstring = (OpenSecureChannelRequest,pkCli_2360,wNc_2457) in
                                                {2363}event beginCli(Cli,Sess,Nc_2456);
                                                {2364}out(c, (pkCli_2360,m1_2458));
                                                {2365}in(c, em2_2459: bitstring);
                                                {2366}let m2_2460: bitstring = em2_2459 in
                                                {2367}let (=OpenSecureChannelResponse,wNs_2461: bitstring,ST_2462: bitstring,TTL_2463: bitstring) = m2_2460 in
                                                {2368}let Ns_2464: bitstring = dec(wNs_2461,skCli_2359) in
                                                {2369}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {2370}event endCli(Sess,Cli,Ns_2464)
                                            )
                                            else
                                                {2371}let v_2465: bool = (Sess = B) in
                                                (
                                                    {2372}if v_2465 then
                                                    (
                                                        {2373}let pkSess_2466: bitstring = pub(skB) in
                                                        {2374}out(c, GetEndpointRequest);
                                                        {2375}in(c, (=GetEndpointResponse,=pkSess_2466,=None,SP_2467: bitstring,UP_2468: bitstring));
                                                        {2376}new Nc_2469: bitstring;
                                                        {2377}let wNc_2470: bitstring = enc(Nc_2469,pkSess_2466) in
                                                        {2378}let m1_2471: bitstring = (OpenSecureChannelRequest,pkCli_2360,wNc_2470) in
                                                        {2379}event beginCli(Cli,Sess,Nc_2469);
                                                        {2380}out(c, (pkCli_2360,m1_2471));
                                                        {2381}in(c, em2_2472: bitstring);
                                                        {2382}let m2_2473: bitstring = em2_2472 in
                                                        {2383}let (=OpenSecureChannelResponse,wNs_2474: bitstring,ST_2475: bitstring,TTL_2476: bitstring) = m2_2473 in
                                                        {2384}let Ns_2477: bitstring = dec(wNs_2474,skCli_2359) in
                                                        {2385}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {2386}event endCli(Sess,Cli,Ns_2477)
                                                    )
                                                    else
                                                        {2387}let v_2478: bool = (Sess = C) in
                                                        (
                                                            {2388}if v_2478 then
                                                            (
                                                                {2389}let pkSess_2479: bitstring = pub(skC) in
                                                                {2390}out(c, GetEndpointRequest);
                                                                {2391}in(c, (=GetEndpointResponse,=pkSess_2479,=None,SP_2480: bitstring,UP_2481: bitstring));
                                                                {2392}new Nc_2482: bitstring;
                                                                {2393}let wNc_2483: bitstring = enc(Nc_2482,pkSess_2479) in
                                                                {2394}let m1_2484: bitstring = (OpenSecureChannelRequest,pkCli_2360,wNc_2483) in
                                                                {2395}event beginCli(Cli,Sess,Nc_2482);
                                                                {2396}out(c, (pkCli_2360,m1_2484));
                                                                {2397}in(c, em2_2485: bitstring);
                                                                {2398}let m2_2486: bitstring = em2_2485 in
                                                                {2399}let (=OpenSecureChannelResponse,wNs_2487: bitstring,ST_2488: bitstring,TTL_2489: bitstring) = m2_2486 in
                                                                {2400}let Ns_2490: bitstring = dec(wNs_2487,skCli_2359) in
                                                                {2401}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                {2402}event endCli(Sess,Cli,Ns_2490)
                                                            )
                                                            else
                                                                {2403}let pkSess_2491: bitstring = pub(sk(Sess)) in
                                                                {2404}out(c, GetEndpointRequest);
                                                                {2405}in(c, (=GetEndpointResponse,=pkSess_2491,=None,SP_2492: bitstring,UP_2493: bitstring));
                                                                {2406}new Nc_2494: bitstring;
                                                                {2407}let wNc_2495: bitstring = enc(Nc_2494,pkSess_2491) in
                                                                {2408}let m1_2496: bitstring = (OpenSecureChannelRequest,pkCli_2360,wNc_2495) in
                                                                {2409}event beginCli(Cli,Sess,Nc_2494);
                                                                {2410}out(c, (pkCli_2360,m1_2496));
                                                                {2411}in(c, em2_2497: bitstring);
                                                                {2412}let m2_2498: bitstring = em2_2497 in
                                                                {2413}let (=OpenSecureChannelResponse,wNs_2499: bitstring,ST_2500: bitstring,TTL_2501: bitstring) = m2_2498 in
                                                                {2414}let Ns_2502: bitstring = dec(wNs_2499,skCli_2359) in
                                                                {2415}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                {2416}event endCli(Sess,Cli,Ns_2502)
                                                        )
                                                        else
                                                            {2417}let pkSess_2503: bitstring = fail-any in
                                                            {2418}out(c, GetEndpointRequest);
                                                            {2419}in(c, (=GetEndpointResponse,=pkSess_2503,=None,SP_2504: bitstring,UP_2505: bitstring));
                                                            {2420}new Nc_2506: bitstring;
                                                            {2421}let wNc_2507: bitstring = enc(Nc_2506,pkSess_2503) in
                                                            {2422}let m1_2508: bitstring = (OpenSecureChannelRequest,pkCli_2360,wNc_2507) in
                                                            {2423}event beginCli(Cli,Sess,Nc_2506);
                                                            {2424}out(c, (pkCli_2360,m1_2508));
                                                            {2425}in(c, em2_2509: bitstring);
                                                            {2426}let m2_2510: bitstring = em2_2509 in
                                                            {2427}let (=OpenSecureChannelResponse,wNs_2511: bitstring,ST_2512: bitstring,TTL_2513: bitstring) = m2_2510 in
                                                            {2428}let Ns_2514: bitstring = dec(wNs_2511,skCli_2359) in
                                                            {2429}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                            {2430}event endCli(Sess,Cli,Ns_2514)
                                                )
                                                else
                                                    {2431}let pkSess_2515: bitstring = fail-any in
                                                    {2432}out(c, GetEndpointRequest);
                                                    {2433}in(c, (=GetEndpointResponse,=pkSess_2515,=None,SP_2516: bitstring,UP_2517: bitstring));
                                                    {2434}new Nc_2518: bitstring;
                                                    {2435}let wNc_2519: bitstring = enc(Nc_2518,pkSess_2515) in
                                                    {2436}let m1_2520: bitstring = (OpenSecureChannelRequest,pkCli_2360,wNc_2519) in
                                                    {2437}event beginCli(Cli,Sess,Nc_2518);
                                                    {2438}out(c, (pkCli_2360,m1_2520));
                                                    {2439}in(c, em2_2521: bitstring);
                                                    {2440}let m2_2522: bitstring = em2_2521 in
                                                    {2441}let (=OpenSecureChannelResponse,wNs_2523: bitstring,ST_2524: bitstring,TTL_2525: bitstring) = m2_2522 in
                                                    {2442}let Ns_2526: bitstring = dec(wNs_2523,skCli_2359) in
                                                    {2443}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {2444}event endCli(Sess,Cli,Ns_2526)
                                        )
                                        else
                                            {2445}let pkSess_2527: bitstring = fail-any in
                                            {2446}out(c, GetEndpointRequest);
                                            {2447}in(c, (=GetEndpointResponse,=pkSess_2527,=None,SP_2528: bitstring,UP_2529: bitstring));
                                            {2448}new Nc_2530: bitstring;
                                            {2449}let wNc_2531: bitstring = enc(Nc_2530,pkSess_2527) in
                                            {2450}let m1_2532: bitstring = (OpenSecureChannelRequest,pkCli_2360,wNc_2531) in
                                            {2451}event beginCli(Cli,Sess,Nc_2530);
                                            {2452}out(c, (pkCli_2360,m1_2532));
                                            {2453}in(c, em2_2533: bitstring);
                                            {2454}let m2_2534: bitstring = em2_2533 in
                                            {2455}let (=OpenSecureChannelResponse,wNs_2535: bitstring,ST_2536: bitstring,TTL_2537: bitstring) = m2_2534 in
                                            {2456}let Ns_2538: bitstring = dec(wNs_2535,skCli_2359) in
                                            {2457}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {2458}event endCli(Sess,Cli,Ns_2538)
                                    )
                                    else
                                        {2459}let v_2539: bool = (Disco = C) in
                                        (
                                            {2460}if v_2539 then
                                            (
                                                {2461}let pkDisco_2540: bitstring = pub(skC) in
                                                {2462}let v_2541: bool = (Sess = A) in
                                                (
                                                    {2463}if v_2541 then
                                                    (
                                                        {2464}let pkSess_2542: bitstring = pub(skA) in
                                                        {2465}out(c, GetEndpointRequest);
                                                        {2466}in(c, (=GetEndpointResponse,=pkSess_2542,=None,SP_2543: bitstring,UP_2544: bitstring));
                                                        {2467}new Nc_2545: bitstring;
                                                        {2468}let wNc_2546: bitstring = enc(Nc_2545,pkSess_2542) in
                                                        {2469}let m1_2547: bitstring = (OpenSecureChannelRequest,pkCli_2360,wNc_2546) in
                                                        {2470}event beginCli(Cli,Sess,Nc_2545);
                                                        {2471}out(c, (pkCli_2360,m1_2547));
                                                        {2472}in(c, em2_2548: bitstring);
                                                        {2473}let m2_2549: bitstring = em2_2548 in
                                                        {2474}let (=OpenSecureChannelResponse,wNs_2550: bitstring,ST_2551: bitstring,TTL_2552: bitstring) = m2_2549 in
                                                        {2475}let Ns_2553: bitstring = dec(wNs_2550,skCli_2359) in
                                                        {2476}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {2477}event endCli(Sess,Cli,Ns_2553)
                                                    )
                                                    else
                                                        {2478}let v_2554: bool = (Sess = B) in
                                                        (
                                                            {2479}if v_2554 then
                                                            (
                                                                {2480}let pkSess_2555: bitstring = pub(skB) in
                                                                {2481}out(c, GetEndpointRequest);
                                                                {2482}in(c, (=GetEndpointResponse,=pkSess_2555,=None,SP_2556: bitstring,UP_2557: bitstring));
                                                                {2483}new Nc_2558: bitstring;
                                                                {2484}let wNc_2559: bitstring = enc(Nc_2558,pkSess_2555) in
                                                                {2485}let m1_2560: bitstring = (OpenSecureChannelRequest,pkCli_2360,wNc_2559) in
                                                                {2486}event beginCli(Cli,Sess,Nc_2558);
                                                                {2487}out(c, (pkCli_2360,m1_2560));
                                                                {2488}in(c, em2_2561: bitstring);
                                                                {2489}let m2_2562: bitstring = em2_2561 in
                                                                {2490}let (=OpenSecureChannelResponse,wNs_2563: bitstring,ST_2564: bitstring,TTL_2565: bitstring) = m2_2562 in
                                                                {2491}let Ns_2566: bitstring = dec(wNs_2563,skCli_2359) in
                                                                {2492}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                {2493}event endCli(Sess,Cli,Ns_2566)
                                                            )
                                                            else
                                                                {2494}let v_2567: bool = (Sess = C) in
                                                                (
                                                                    {2495}if v_2567 then
                                                                    (
                                                                        {2496}let pkSess_2568: bitstring = pub(skC) in
                                                                        {2497}out(c, GetEndpointRequest);
                                                                        {2498}in(c, (=GetEndpointResponse,=pkSess_2568,=None,SP_2569: bitstring,UP_2570: bitstring));
                                                                        {2499}new Nc_2571: bitstring;
                                                                        {2500}let wNc_2572: bitstring = enc(Nc_2571,pkSess_2568) in
                                                                        {2501}let m1_2573: bitstring = (OpenSecureChannelRequest,pkCli_2360,wNc_2572) in
                                                                        {2502}event beginCli(Cli,Sess,Nc_2571);
                                                                        {2503}out(c, (pkCli_2360,m1_2573));
                                                                        {2504}in(c, em2_2574: bitstring);
                                                                        {2505}let m2_2575: bitstring = em2_2574 in
                                                                        {2506}let (=OpenSecureChannelResponse,wNs_2576: bitstring,ST_2577: bitstring,TTL_2578: bitstring) = m2_2575 in
                                                                        {2507}let Ns_2579: bitstring = dec(wNs_2576,skCli_2359) in
                                                                        {2508}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                        {2509}event endCli(Sess,Cli,Ns_2579)
                                                                    )
                                                                    else
                                                                        {2510}let pkSess_2580: bitstring = pub(sk(Sess)) in
                                                                        {2511}out(c, GetEndpointRequest);
                                                                        {2512}in(c, (=GetEndpointResponse,=pkSess_2580,=None,SP_2581: bitstring,UP_2582: bitstring));
                                                                        {2513}new Nc_2583: bitstring;
                                                                        {2514}let wNc_2584: bitstring = enc(Nc_2583,pkSess_2580) in
                                                                        {2515}let m1_2585: bitstring = (OpenSecureChannelRequest,pkCli_2360,wNc_2584) in
                                                                        {2516}event beginCli(Cli,Sess,Nc_2583);
                                                                        {2517}out(c, (pkCli_2360,m1_2585));
                                                                        {2518}in(c, em2_2586: bitstring);
                                                                        {2519}let m2_2587: bitstring = em2_2586 in
                                                                        {2520}let (=OpenSecureChannelResponse,wNs_2588: bitstring,ST_2589: bitstring,TTL_2590: bitstring) = m2_2587 in
                                                                        {2521}let Ns_2591: bitstring = dec(wNs_2588,skCli_2359) in
                                                                        {2522}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                        {2523}event endCli(Sess,Cli,Ns_2591)
                                                                )
                                                                else
                                                                    {2524}let pkSess_2592: bitstring = fail-any in
                                                                    {2525}out(c, GetEndpointRequest);
                                                                    {2526}in(c, (=GetEndpointResponse,=pkSess_2592,=None,SP_2593: bitstring,UP_2594: bitstring));
                                                                    {2527}new Nc_2595: bitstring;
                                                                    {2528}let wNc_2596: bitstring = enc(Nc_2595,pkSess_2592) in
                                                                    {2529}let m1_2597: bitstring = (OpenSecureChannelRequest,pkCli_2360,wNc_2596) in
                                                                    {2530}event beginCli(Cli,Sess,Nc_2595);
                                                                    {2531}out(c, (pkCli_2360,m1_2597));
                                                                    {2532}in(c, em2_2598: bitstring);
                                                                    {2533}let m2_2599: bitstring = em2_2598 in
                                                                    {2534}let (=OpenSecureChannelResponse,wNs_2600: bitstring,ST_2601: bitstring,TTL_2602: bitstring) = m2_2599 in
                                                                    {2535}let Ns_2603: bitstring = dec(wNs_2600,skCli_2359) in
                                                                    {2536}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                    {2537}event endCli(Sess,Cli,Ns_2603)
                                                        )
                                                        else
                                                            {2538}let pkSess_2604: bitstring = fail-any in
                                                            {2539}out(c, GetEndpointRequest);
                                                            {2540}in(c, (=GetEndpointResponse,=pkSess_2604,=None,SP_2605: bitstring,UP_2606: bitstring));
                                                            {2541}new Nc_2607: bitstring;
                                                            {2542}let wNc_2608: bitstring = enc(Nc_2607,pkSess_2604) in
                                                            {2543}let m1_2609: bitstring = (OpenSecureChannelRequest,pkCli_2360,wNc_2608) in
                                                            {2544}event beginCli(Cli,Sess,Nc_2607);
                                                            {2545}out(c, (pkCli_2360,m1_2609));
                                                            {2546}in(c, em2_2610: bitstring);
                                                            {2547}let m2_2611: bitstring = em2_2610 in
                                                            {2548}let (=OpenSecureChannelResponse,wNs_2612: bitstring,ST_2613: bitstring,TTL_2614: bitstring) = m2_2611 in
                                                            {2549}let Ns_2615: bitstring = dec(wNs_2612,skCli_2359) in
                                                            {2550}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                            {2551}event endCli(Sess,Cli,Ns_2615)
                                                )
                                                else
                                                    {2552}let pkSess_2616: bitstring = fail-any in
                                                    {2553}out(c, GetEndpointRequest);
                                                    {2554}in(c, (=GetEndpointResponse,=pkSess_2616,=None,SP_2617: bitstring,UP_2618: bitstring));
                                                    {2555}new Nc_2619: bitstring;
                                                    {2556}let wNc_2620: bitstring = enc(Nc_2619,pkSess_2616) in
                                                    {2557}let m1_2621: bitstring = (OpenSecureChannelRequest,pkCli_2360,wNc_2620) in
                                                    {2558}event beginCli(Cli,Sess,Nc_2619);
                                                    {2559}out(c, (pkCli_2360,m1_2621));
                                                    {2560}in(c, em2_2622: bitstring);
                                                    {2561}let m2_2623: bitstring = em2_2622 in
                                                    {2562}let (=OpenSecureChannelResponse,wNs_2624: bitstring,ST_2625: bitstring,TTL_2626: bitstring) = m2_2623 in
                                                    {2563}let Ns_2627: bitstring = dec(wNs_2624,skCli_2359) in
                                                    {2564}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {2565}event endCli(Sess,Cli,Ns_2627)
                                            )
                                            else
                                                {2566}let pkDisco_2628: bitstring = pub(sk(Disco)) in
                                                {2567}let v_2629: bool = (Sess = A) in
                                                (
                                                    {2568}if v_2629 then
                                                    (
                                                        {2569}let pkSess_2630: bitstring = pub(skA) in
                                                        {2570}out(c, GetEndpointRequest);
                                                        {2571}in(c, (=GetEndpointResponse,=pkSess_2630,=None,SP_2631: bitstring,UP_2632: bitstring));
                                                        {2572}new Nc_2633: bitstring;
                                                        {2573}let wNc_2634: bitstring = enc(Nc_2633,pkSess_2630) in
                                                        {2574}let m1_2635: bitstring = (OpenSecureChannelRequest,pkCli_2360,wNc_2634) in
                                                        {2575}event beginCli(Cli,Sess,Nc_2633);
                                                        {2576}out(c, (pkCli_2360,m1_2635));
                                                        {2577}in(c, em2_2636: bitstring);
                                                        {2578}let m2_2637: bitstring = em2_2636 in
                                                        {2579}let (=OpenSecureChannelResponse,wNs_2638: bitstring,ST_2639: bitstring,TTL_2640: bitstring) = m2_2637 in
                                                        {2580}let Ns_2641: bitstring = dec(wNs_2638,skCli_2359) in
                                                        {2581}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {2582}event endCli(Sess,Cli,Ns_2641)
                                                    )
                                                    else
                                                        {2583}let v_2642: bool = (Sess = B) in
                                                        (
                                                            {2584}if v_2642 then
                                                            (
                                                                {2585}let pkSess_2643: bitstring = pub(skB) in
                                                                {2586}out(c, GetEndpointRequest);
                                                                {2587}in(c, (=GetEndpointResponse,=pkSess_2643,=None,SP_2644: bitstring,UP_2645: bitstring));
                                                                {2588}new Nc_2646: bitstring;
                                                                {2589}let wNc_2647: bitstring = enc(Nc_2646,pkSess_2643) in
                                                                {2590}let m1_2648: bitstring = (OpenSecureChannelRequest,pkCli_2360,wNc_2647) in
                                                                {2591}event beginCli(Cli,Sess,Nc_2646);
                                                                {2592}out(c, (pkCli_2360,m1_2648));
                                                                {2593}in(c, em2_2649: bitstring);
                                                                {2594}let m2_2650: bitstring = em2_2649 in
                                                                {2595}let (=OpenSecureChannelResponse,wNs_2651: bitstring,ST_2652: bitstring,TTL_2653: bitstring) = m2_2650 in
                                                                {2596}let Ns_2654: bitstring = dec(wNs_2651,skCli_2359) in
                                                                {2597}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                {2598}event endCli(Sess,Cli,Ns_2654)
                                                            )
                                                            else
                                                                {2599}let v_2655: bool = (Sess = C) in
                                                                (
                                                                    {2600}if v_2655 then
                                                                    (
                                                                        {2601}let pkSess_2656: bitstring = pub(skC) in
                                                                        {2602}out(c, GetEndpointRequest);
                                                                        {2603}in(c, (=GetEndpointResponse,=pkSess_2656,=None,SP_2657: bitstring,UP_2658: bitstring));
                                                                        {2604}new Nc_2659: bitstring;
                                                                        {2605}let wNc_2660: bitstring = enc(Nc_2659,pkSess_2656) in
                                                                        {2606}let m1_2661: bitstring = (OpenSecureChannelRequest,pkCli_2360,wNc_2660) in
                                                                        {2607}event beginCli(Cli,Sess,Nc_2659);
                                                                        {2608}out(c, (pkCli_2360,m1_2661));
                                                                        {2609}in(c, em2_2662: bitstring);
                                                                        {2610}let m2_2663: bitstring = em2_2662 in
                                                                        {2611}let (=OpenSecureChannelResponse,wNs_2664: bitstring,ST_2665: bitstring,TTL_2666: bitstring) = m2_2663 in
                                                                        {2612}let Ns_2667: bitstring = dec(wNs_2664,skCli_2359) in
                                                                        {2613}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                        {2614}event endCli(Sess,Cli,Ns_2667)
                                                                    )
                                                                    else
                                                                        {2615}let pkSess_2668: bitstring = pub(sk(Sess)) in
                                                                        {2616}out(c, GetEndpointRequest);
                                                                        {2617}in(c, (=GetEndpointResponse,=pkSess_2668,=None,SP_2669: bitstring,UP_2670: bitstring));
                                                                        {2618}new Nc_2671: bitstring;
                                                                        {2619}let wNc_2672: bitstring = enc(Nc_2671,pkSess_2668) in
                                                                        {2620}let m1_2673: bitstring = (OpenSecureChannelRequest,pkCli_2360,wNc_2672) in
                                                                        {2621}event beginCli(Cli,Sess,Nc_2671);
                                                                        {2622}out(c, (pkCli_2360,m1_2673));
                                                                        {2623}in(c, em2_2674: bitstring);
                                                                        {2624}let m2_2675: bitstring = em2_2674 in
                                                                        {2625}let (=OpenSecureChannelResponse,wNs_2676: bitstring,ST_2677: bitstring,TTL_2678: bitstring) = m2_2675 in
                                                                        {2626}let Ns_2679: bitstring = dec(wNs_2676,skCli_2359) in
                                                                        {2627}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                        {2628}event endCli(Sess,Cli,Ns_2679)
                                                                )
                                                                else
                                                                    {2629}let pkSess_2680: bitstring = fail-any in
                                                                    {2630}out(c, GetEndpointRequest);
                                                                    {2631}in(c, (=GetEndpointResponse,=pkSess_2680,=None,SP_2681: bitstring,UP_2682: bitstring));
                                                                    {2632}new Nc_2683: bitstring;
                                                                    {2633}let wNc_2684: bitstring = enc(Nc_2683,pkSess_2680) in
                                                                    {2634}let m1_2685: bitstring = (OpenSecureChannelRequest,pkCli_2360,wNc_2684) in
                                                                    {2635}event beginCli(Cli,Sess,Nc_2683);
                                                                    {2636}out(c, (pkCli_2360,m1_2685));
                                                                    {2637}in(c, em2_2686: bitstring);
                                                                    {2638}let m2_2687: bitstring = em2_2686 in
                                                                    {2639}let (=OpenSecureChannelResponse,wNs_2688: bitstring,ST_2689: bitstring,TTL_2690: bitstring) = m2_2687 in
                                                                    {2640}let Ns_2691: bitstring = dec(wNs_2688,skCli_2359) in
                                                                    {2641}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                    {2642}event endCli(Sess,Cli,Ns_2691)
                                                        )
                                                        else
                                                            {2643}let pkSess_2692: bitstring = fail-any in
                                                            {2644}out(c, GetEndpointRequest);
                                                            {2645}in(c, (=GetEndpointResponse,=pkSess_2692,=None,SP_2693: bitstring,UP_2694: bitstring));
                                                            {2646}new Nc_2695: bitstring;
                                                            {2647}let wNc_2696: bitstring = enc(Nc_2695,pkSess_2692) in
                                                            {2648}let m1_2697: bitstring = (OpenSecureChannelRequest,pkCli_2360,wNc_2696) in
                                                            {2649}event beginCli(Cli,Sess,Nc_2695);
                                                            {2650}out(c, (pkCli_2360,m1_2697));
                                                            {2651}in(c, em2_2698: bitstring);
                                                            {2652}let m2_2699: bitstring = em2_2698 in
                                                            {2653}let (=OpenSecureChannelResponse,wNs_2700: bitstring,ST_2701: bitstring,TTL_2702: bitstring) = m2_2699 in
                                                            {2654}let Ns_2703: bitstring = dec(wNs_2700,skCli_2359) in
                                                            {2655}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                            {2656}event endCli(Sess,Cli,Ns_2703)
                                                )
                                                else
                                                    {2657}let pkSess_2704: bitstring = fail-any in
                                                    {2658}out(c, GetEndpointRequest);
                                                    {2659}in(c, (=GetEndpointResponse,=pkSess_2704,=None,SP_2705: bitstring,UP_2706: bitstring));
                                                    {2660}new Nc_2707: bitstring;
                                                    {2661}let wNc_2708: bitstring = enc(Nc_2707,pkSess_2704) in
                                                    {2662}let m1_2709: bitstring = (OpenSecureChannelRequest,pkCli_2360,wNc_2708) in
                                                    {2663}event beginCli(Cli,Sess,Nc_2707);
                                                    {2664}out(c, (pkCli_2360,m1_2709));
                                                    {2665}in(c, em2_2710: bitstring);
                                                    {2666}let m2_2711: bitstring = em2_2710 in
                                                    {2667}let (=OpenSecureChannelResponse,wNs_2712: bitstring,ST_2713: bitstring,TTL_2714: bitstring) = m2_2711 in
                                                    {2668}let Ns_2715: bitstring = dec(wNs_2712,skCli_2359) in
                                                    {2669}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {2670}event endCli(Sess,Cli,Ns_2715)
                                        )
                                        else
                                            {2671}let pkDisco_2716: bitstring = fail-any in
                                            {2672}let v_2717: bool = (Sess = A) in
                                            (
                                                {2673}if v_2717 then
                                                (
                                                    {2674}let pkSess_2718: bitstring = pub(skA) in
                                                    {2675}out(c, GetEndpointRequest);
                                                    {2676}in(c, (=GetEndpointResponse,=pkSess_2718,=None,SP_2719: bitstring,UP_2720: bitstring));
                                                    {2677}new Nc_2721: bitstring;
                                                    {2678}let wNc_2722: bitstring = enc(Nc_2721,pkSess_2718) in
                                                    {2679}let m1_2723: bitstring = (OpenSecureChannelRequest,pkCli_2360,wNc_2722) in
                                                    {2680}event beginCli(Cli,Sess,Nc_2721);
                                                    {2681}out(c, (pkCli_2360,m1_2723));
                                                    {2682}in(c, em2_2724: bitstring);
                                                    {2683}let m2_2725: bitstring = em2_2724 in
                                                    {2684}let (=OpenSecureChannelResponse,wNs_2726: bitstring,ST_2727: bitstring,TTL_2728: bitstring) = m2_2725 in
                                                    {2685}let Ns_2729: bitstring = dec(wNs_2726,skCli_2359) in
                                                    {2686}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {2687}event endCli(Sess,Cli,Ns_2729)
                                                )
                                                else
                                                    {2688}let v_2730: bool = (Sess = B) in
                                                    (
                                                        {2689}if v_2730 then
                                                        (
                                                            {2690}let pkSess_2731: bitstring = pub(skB) in
                                                            {2691}out(c, GetEndpointRequest);
                                                            {2692}in(c, (=GetEndpointResponse,=pkSess_2731,=None,SP_2732: bitstring,UP_2733: bitstring));
                                                            {2693}new Nc_2734: bitstring;
                                                            {2694}let wNc_2735: bitstring = enc(Nc_2734,pkSess_2731) in
                                                            {2695}let m1_2736: bitstring = (OpenSecureChannelRequest,pkCli_2360,wNc_2735) in
                                                            {2696}event beginCli(Cli,Sess,Nc_2734);
                                                            {2697}out(c, (pkCli_2360,m1_2736));
                                                            {2698}in(c, em2_2737: bitstring);
                                                            {2699}let m2_2738: bitstring = em2_2737 in
                                                            {2700}let (=OpenSecureChannelResponse,wNs_2739: bitstring,ST_2740: bitstring,TTL_2741: bitstring) = m2_2738 in
                                                            {2701}let Ns_2742: bitstring = dec(wNs_2739,skCli_2359) in
                                                            {2702}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                            {2703}event endCli(Sess,Cli,Ns_2742)
                                                        )
                                                        else
                                                            {2704}let v_2743: bool = (Sess = C) in
                                                            (
                                                                {2705}if v_2743 then
                                                                (
                                                                    {2706}let pkSess_2744: bitstring = pub(skC) in
                                                                    {2707}out(c, GetEndpointRequest);
                                                                    {2708}in(c, (=GetEndpointResponse,=pkSess_2744,=None,SP_2745: bitstring,UP_2746: bitstring));
                                                                    {2709}new Nc_2747: bitstring;
                                                                    {2710}let wNc_2748: bitstring = enc(Nc_2747,pkSess_2744) in
                                                                    {2711}let m1_2749: bitstring = (OpenSecureChannelRequest,pkCli_2360,wNc_2748) in
                                                                    {2712}event beginCli(Cli,Sess,Nc_2747);
                                                                    {2713}out(c, (pkCli_2360,m1_2749));
                                                                    {2714}in(c, em2_2750: bitstring);
                                                                    {2715}let m2_2751: bitstring = em2_2750 in
                                                                    {2716}let (=OpenSecureChannelResponse,wNs_2752: bitstring,ST_2753: bitstring,TTL_2754: bitstring) = m2_2751 in
                                                                    {2717}let Ns_2755: bitstring = dec(wNs_2752,skCli_2359) in
                                                                    {2718}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                    {2719}event endCli(Sess,Cli,Ns_2755)
                                                                )
                                                                else
                                                                    {2720}let pkSess_2756: bitstring = pub(sk(Sess)) in
                                                                    {2721}out(c, GetEndpointRequest);
                                                                    {2722}in(c, (=GetEndpointResponse,=pkSess_2756,=None,SP_2757: bitstring,UP_2758: bitstring));
                                                                    {2723}new Nc_2759: bitstring;
                                                                    {2724}let wNc_2760: bitstring = enc(Nc_2759,pkSess_2756) in
                                                                    {2725}let m1_2761: bitstring = (OpenSecureChannelRequest,pkCli_2360,wNc_2760) in
                                                                    {2726}event beginCli(Cli,Sess,Nc_2759);
                                                                    {2727}out(c, (pkCli_2360,m1_2761));
                                                                    {2728}in(c, em2_2762: bitstring);
                                                                    {2729}let m2_2763: bitstring = em2_2762 in
                                                                    {2730}let (=OpenSecureChannelResponse,wNs_2764: bitstring,ST_2765: bitstring,TTL_2766: bitstring) = m2_2763 in
                                                                    {2731}let Ns_2767: bitstring = dec(wNs_2764,skCli_2359) in
                                                                    {2732}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                    {2733}event endCli(Sess,Cli,Ns_2767)
                                                            )
                                                            else
                                                                {2734}let pkSess_2768: bitstring = fail-any in
                                                                {2735}out(c, GetEndpointRequest);
                                                                {2736}in(c, (=GetEndpointResponse,=pkSess_2768,=None,SP_2769: bitstring,UP_2770: bitstring));
                                                                {2737}new Nc_2771: bitstring;
                                                                {2738}let wNc_2772: bitstring = enc(Nc_2771,pkSess_2768) in
                                                                {2739}let m1_2773: bitstring = (OpenSecureChannelRequest,pkCli_2360,wNc_2772) in
                                                                {2740}event beginCli(Cli,Sess,Nc_2771);
                                                                {2741}out(c, (pkCli_2360,m1_2773));
                                                                {2742}in(c, em2_2774: bitstring);
                                                                {2743}let m2_2775: bitstring = em2_2774 in
                                                                {2744}let (=OpenSecureChannelResponse,wNs_2776: bitstring,ST_2777: bitstring,TTL_2778: bitstring) = m2_2775 in
                                                                {2745}let Ns_2779: bitstring = dec(wNs_2776,skCli_2359) in
                                                                {2746}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                {2747}event endCli(Sess,Cli,Ns_2779)
                                                    )
                                                    else
                                                        {2748}let pkSess_2780: bitstring = fail-any in
                                                        {2749}out(c, GetEndpointRequest);
                                                        {2750}in(c, (=GetEndpointResponse,=pkSess_2780,=None,SP_2781: bitstring,UP_2782: bitstring));
                                                        {2751}new Nc_2783: bitstring;
                                                        {2752}let wNc_2784: bitstring = enc(Nc_2783,pkSess_2780) in
                                                        {2753}let m1_2785: bitstring = (OpenSecureChannelRequest,pkCli_2360,wNc_2784) in
                                                        {2754}event beginCli(Cli,Sess,Nc_2783);
                                                        {2755}out(c, (pkCli_2360,m1_2785));
                                                        {2756}in(c, em2_2786: bitstring);
                                                        {2757}let m2_2787: bitstring = em2_2786 in
                                                        {2758}let (=OpenSecureChannelResponse,wNs_2788: bitstring,ST_2789: bitstring,TTL_2790: bitstring) = m2_2787 in
                                                        {2759}let Ns_2791: bitstring = dec(wNs_2788,skCli_2359) in
                                                        {2760}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {2761}event endCli(Sess,Cli,Ns_2791)
                                            )
                                            else
                                                {2762}let pkSess_2792: bitstring = fail-any in
                                                {2763}out(c, GetEndpointRequest);
                                                {2764}in(c, (=GetEndpointResponse,=pkSess_2792,=None,SP_2793: bitstring,UP_2794: bitstring));
                                                {2765}new Nc_2795: bitstring;
                                                {2766}let wNc_2796: bitstring = enc(Nc_2795,pkSess_2792) in
                                                {2767}let m1_2797: bitstring = (OpenSecureChannelRequest,pkCli_2360,wNc_2796) in
                                                {2768}event beginCli(Cli,Sess,Nc_2795);
                                                {2769}out(c, (pkCli_2360,m1_2797));
                                                {2770}in(c, em2_2798: bitstring);
                                                {2771}let m2_2799: bitstring = em2_2798 in
                                                {2772}let (=OpenSecureChannelResponse,wNs_2800: bitstring,ST_2801: bitstring,TTL_2802: bitstring) = m2_2799 in
                                                {2773}let Ns_2803: bitstring = dec(wNs_2800,skCli_2359) in
                                                {2774}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {2775}event endCli(Sess,Cli,Ns_2803)
                                )
                                else
                                    {2776}let pkDisco_2804: bitstring = fail-any in
                                    {2777}let v_2805: bool = (Sess = A) in
                                    (
                                        {2778}if v_2805 then
                                        (
                                            {2779}let pkSess_2806: bitstring = pub(skA) in
                                            {2780}out(c, GetEndpointRequest);
                                            {2781}in(c, (=GetEndpointResponse,=pkSess_2806,=None,SP_2807: bitstring,UP_2808: bitstring));
                                            {2782}new Nc_2809: bitstring;
                                            {2783}let wNc_2810: bitstring = enc(Nc_2809,pkSess_2806) in
                                            {2784}let m1_2811: bitstring = (OpenSecureChannelRequest,pkCli_2360,wNc_2810) in
                                            {2785}event beginCli(Cli,Sess,Nc_2809);
                                            {2786}out(c, (pkCli_2360,m1_2811));
                                            {2787}in(c, em2_2812: bitstring);
                                            {2788}let m2_2813: bitstring = em2_2812 in
                                            {2789}let (=OpenSecureChannelResponse,wNs_2814: bitstring,ST_2815: bitstring,TTL_2816: bitstring) = m2_2813 in
                                            {2790}let Ns_2817: bitstring = dec(wNs_2814,skCli_2359) in
                                            {2791}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {2792}event endCli(Sess,Cli,Ns_2817)
                                        )
                                        else
                                            {2793}let v_2818: bool = (Sess = B) in
                                            (
                                                {2794}if v_2818 then
                                                (
                                                    {2795}let pkSess_2819: bitstring = pub(skB) in
                                                    {2796}out(c, GetEndpointRequest);
                                                    {2797}in(c, (=GetEndpointResponse,=pkSess_2819,=None,SP_2820: bitstring,UP_2821: bitstring));
                                                    {2798}new Nc_2822: bitstring;
                                                    {2799}let wNc_2823: bitstring = enc(Nc_2822,pkSess_2819) in
                                                    {2800}let m1_2824: bitstring = (OpenSecureChannelRequest,pkCli_2360,wNc_2823) in
                                                    {2801}event beginCli(Cli,Sess,Nc_2822);
                                                    {2802}out(c, (pkCli_2360,m1_2824));
                                                    {2803}in(c, em2_2825: bitstring);
                                                    {2804}let m2_2826: bitstring = em2_2825 in
                                                    {2805}let (=OpenSecureChannelResponse,wNs_2827: bitstring,ST_2828: bitstring,TTL_2829: bitstring) = m2_2826 in
                                                    {2806}let Ns_2830: bitstring = dec(wNs_2827,skCli_2359) in
                                                    {2807}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {2808}event endCli(Sess,Cli,Ns_2830)
                                                )
                                                else
                                                    {2809}let v_2831: bool = (Sess = C) in
                                                    (
                                                        {2810}if v_2831 then
                                                        (
                                                            {2811}let pkSess_2832: bitstring = pub(skC) in
                                                            {2812}out(c, GetEndpointRequest);
                                                            {2813}in(c, (=GetEndpointResponse,=pkSess_2832,=None,SP_2833: bitstring,UP_2834: bitstring));
                                                            {2814}new Nc_2835: bitstring;
                                                            {2815}let wNc_2836: bitstring = enc(Nc_2835,pkSess_2832) in
                                                            {2816}let m1_2837: bitstring = (OpenSecureChannelRequest,pkCli_2360,wNc_2836) in
                                                            {2817}event beginCli(Cli,Sess,Nc_2835);
                                                            {2818}out(c, (pkCli_2360,m1_2837));
                                                            {2819}in(c, em2_2838: bitstring);
                                                            {2820}let m2_2839: bitstring = em2_2838 in
                                                            {2821}let (=OpenSecureChannelResponse,wNs_2840: bitstring,ST_2841: bitstring,TTL_2842: bitstring) = m2_2839 in
                                                            {2822}let Ns_2843: bitstring = dec(wNs_2840,skCli_2359) in
                                                            {2823}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                            {2824}event endCli(Sess,Cli,Ns_2843)
                                                        )
                                                        else
                                                            {2825}let pkSess_2844: bitstring = pub(sk(Sess)) in
                                                            {2826}out(c, GetEndpointRequest);
                                                            {2827}in(c, (=GetEndpointResponse,=pkSess_2844,=None,SP_2845: bitstring,UP_2846: bitstring));
                                                            {2828}new Nc_2847: bitstring;
                                                            {2829}let wNc_2848: bitstring = enc(Nc_2847,pkSess_2844) in
                                                            {2830}let m1_2849: bitstring = (OpenSecureChannelRequest,pkCli_2360,wNc_2848) in
                                                            {2831}event beginCli(Cli,Sess,Nc_2847);
                                                            {2832}out(c, (pkCli_2360,m1_2849));
                                                            {2833}in(c, em2_2850: bitstring);
                                                            {2834}let m2_2851: bitstring = em2_2850 in
                                                            {2835}let (=OpenSecureChannelResponse,wNs_2852: bitstring,ST_2853: bitstring,TTL_2854: bitstring) = m2_2851 in
                                                            {2836}let Ns_2855: bitstring = dec(wNs_2852,skCli_2359) in
                                                            {2837}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                            {2838}event endCli(Sess,Cli,Ns_2855)
                                                    )
                                                    else
                                                        {2839}let pkSess_2856: bitstring = fail-any in
                                                        {2840}out(c, GetEndpointRequest);
                                                        {2841}in(c, (=GetEndpointResponse,=pkSess_2856,=None,SP_2857: bitstring,UP_2858: bitstring));
                                                        {2842}new Nc_2859: bitstring;
                                                        {2843}let wNc_2860: bitstring = enc(Nc_2859,pkSess_2856) in
                                                        {2844}let m1_2861: bitstring = (OpenSecureChannelRequest,pkCli_2360,wNc_2860) in
                                                        {2845}event beginCli(Cli,Sess,Nc_2859);
                                                        {2846}out(c, (pkCli_2360,m1_2861));
                                                        {2847}in(c, em2_2862: bitstring);
                                                        {2848}let m2_2863: bitstring = em2_2862 in
                                                        {2849}let (=OpenSecureChannelResponse,wNs_2864: bitstring,ST_2865: bitstring,TTL_2866: bitstring) = m2_2863 in
                                                        {2850}let Ns_2867: bitstring = dec(wNs_2864,skCli_2359) in
                                                        {2851}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {2852}event endCli(Sess,Cli,Ns_2867)
                                            )
                                            else
                                                {2853}let pkSess_2868: bitstring = fail-any in
                                                {2854}out(c, GetEndpointRequest);
                                                {2855}in(c, (=GetEndpointResponse,=pkSess_2868,=None,SP_2869: bitstring,UP_2870: bitstring));
                                                {2856}new Nc_2871: bitstring;
                                                {2857}let wNc_2872: bitstring = enc(Nc_2871,pkSess_2868) in
                                                {2858}let m1_2873: bitstring = (OpenSecureChannelRequest,pkCli_2360,wNc_2872) in
                                                {2859}event beginCli(Cli,Sess,Nc_2871);
                                                {2860}out(c, (pkCli_2360,m1_2873));
                                                {2861}in(c, em2_2874: bitstring);
                                                {2862}let m2_2875: bitstring = em2_2874 in
                                                {2863}let (=OpenSecureChannelResponse,wNs_2876: bitstring,ST_2877: bitstring,TTL_2878: bitstring) = m2_2875 in
                                                {2864}let Ns_2879: bitstring = dec(wNs_2876,skCli_2359) in
                                                {2865}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {2866}event endCli(Sess,Cli,Ns_2879)
                                    )
                                    else
                                        {2867}let pkSess_2880: bitstring = fail-any in
                                        {2868}out(c, GetEndpointRequest);
                                        {2869}in(c, (=GetEndpointResponse,=pkSess_2880,=None,SP_2881: bitstring,UP_2882: bitstring));
                                        {2870}new Nc_2883: bitstring;
                                        {2871}let wNc_2884: bitstring = enc(Nc_2883,pkSess_2880) in
                                        {2872}let m1_2885: bitstring = (OpenSecureChannelRequest,pkCli_2360,wNc_2884) in
                                        {2873}event beginCli(Cli,Sess,Nc_2883);
                                        {2874}out(c, (pkCli_2360,m1_2885));
                                        {2875}in(c, em2_2886: bitstring);
                                        {2876}let m2_2887: bitstring = em2_2886 in
                                        {2877}let (=OpenSecureChannelResponse,wNs_2888: bitstring,ST_2889: bitstring,TTL_2890: bitstring) = m2_2887 in
                                        {2878}let Ns_2891: bitstring = dec(wNs_2888,skCli_2359) in
                                        {2879}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                        {2880}event endCli(Sess,Cli,Ns_2891)
                        )
                        else
                            {2881}let pkDisco_2892: bitstring = fail-any in
                            {2882}let v_2893: bool = (Sess = A) in
                            (
                                {2883}if v_2893 then
                                (
                                    {2884}let pkSess_2894: bitstring = pub(skA) in
                                    {2885}out(c, GetEndpointRequest);
                                    {2886}in(c, (=GetEndpointResponse,=pkSess_2894,=None,SP_2895: bitstring,UP_2896: bitstring));
                                    {2887}new Nc_2897: bitstring;
                                    {2888}let wNc_2898: bitstring = enc(Nc_2897,pkSess_2894) in
                                    {2889}let m1_2899: bitstring = (OpenSecureChannelRequest,pkCli_2360,wNc_2898) in
                                    {2890}event beginCli(Cli,Sess,Nc_2897);
                                    {2891}out(c, (pkCli_2360,m1_2899));
                                    {2892}in(c, em2_2900: bitstring);
                                    {2893}let m2_2901: bitstring = em2_2900 in
                                    {2894}let (=OpenSecureChannelResponse,wNs_2902: bitstring,ST_2903: bitstring,TTL_2904: bitstring) = m2_2901 in
                                    {2895}let Ns_2905: bitstring = dec(wNs_2902,skCli_2359) in
                                    {2896}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                    {2897}event endCli(Sess,Cli,Ns_2905)
                                )
                                else
                                    {2898}let v_2906: bool = (Sess = B) in
                                    (
                                        {2899}if v_2906 then
                                        (
                                            {2900}let pkSess_2907: bitstring = pub(skB) in
                                            {2901}out(c, GetEndpointRequest);
                                            {2902}in(c, (=GetEndpointResponse,=pkSess_2907,=None,SP_2908: bitstring,UP_2909: bitstring));
                                            {2903}new Nc_2910: bitstring;
                                            {2904}let wNc_2911: bitstring = enc(Nc_2910,pkSess_2907) in
                                            {2905}let m1_2912: bitstring = (OpenSecureChannelRequest,pkCli_2360,wNc_2911) in
                                            {2906}event beginCli(Cli,Sess,Nc_2910);
                                            {2907}out(c, (pkCli_2360,m1_2912));
                                            {2908}in(c, em2_2913: bitstring);
                                            {2909}let m2_2914: bitstring = em2_2913 in
                                            {2910}let (=OpenSecureChannelResponse,wNs_2915: bitstring,ST_2916: bitstring,TTL_2917: bitstring) = m2_2914 in
                                            {2911}let Ns_2918: bitstring = dec(wNs_2915,skCli_2359) in
                                            {2912}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {2913}event endCli(Sess,Cli,Ns_2918)
                                        )
                                        else
                                            {2914}let v_2919: bool = (Sess = C) in
                                            (
                                                {2915}if v_2919 then
                                                (
                                                    {2916}let pkSess_2920: bitstring = pub(skC) in
                                                    {2917}out(c, GetEndpointRequest);
                                                    {2918}in(c, (=GetEndpointResponse,=pkSess_2920,=None,SP_2921: bitstring,UP_2922: bitstring));
                                                    {2919}new Nc_2923: bitstring;
                                                    {2920}let wNc_2924: bitstring = enc(Nc_2923,pkSess_2920) in
                                                    {2921}let m1_2925: bitstring = (OpenSecureChannelRequest,pkCli_2360,wNc_2924) in
                                                    {2922}event beginCli(Cli,Sess,Nc_2923);
                                                    {2923}out(c, (pkCli_2360,m1_2925));
                                                    {2924}in(c, em2_2926: bitstring);
                                                    {2925}let m2_2927: bitstring = em2_2926 in
                                                    {2926}let (=OpenSecureChannelResponse,wNs_2928: bitstring,ST_2929: bitstring,TTL_2930: bitstring) = m2_2927 in
                                                    {2927}let Ns_2931: bitstring = dec(wNs_2928,skCli_2359) in
                                                    {2928}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {2929}event endCli(Sess,Cli,Ns_2931)
                                                )
                                                else
                                                    {2930}let pkSess_2932: bitstring = pub(sk(Sess)) in
                                                    {2931}out(c, GetEndpointRequest);
                                                    {2932}in(c, (=GetEndpointResponse,=pkSess_2932,=None,SP_2933: bitstring,UP_2934: bitstring));
                                                    {2933}new Nc_2935: bitstring;
                                                    {2934}let wNc_2936: bitstring = enc(Nc_2935,pkSess_2932) in
                                                    {2935}let m1_2937: bitstring = (OpenSecureChannelRequest,pkCli_2360,wNc_2936) in
                                                    {2936}event beginCli(Cli,Sess,Nc_2935);
                                                    {2937}out(c, (pkCli_2360,m1_2937));
                                                    {2938}in(c, em2_2938: bitstring);
                                                    {2939}let m2_2939: bitstring = em2_2938 in
                                                    {2940}let (=OpenSecureChannelResponse,wNs_2940: bitstring,ST_2941: bitstring,TTL_2942: bitstring) = m2_2939 in
                                                    {2941}let Ns_2943: bitstring = dec(wNs_2940,skCli_2359) in
                                                    {2942}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {2943}event endCli(Sess,Cli,Ns_2943)
                                            )
                                            else
                                                {2944}let pkSess_2944: bitstring = fail-any in
                                                {2945}out(c, GetEndpointRequest);
                                                {2946}in(c, (=GetEndpointResponse,=pkSess_2944,=None,SP_2945: bitstring,UP_2946: bitstring));
                                                {2947}new Nc_2947: bitstring;
                                                {2948}let wNc_2948: bitstring = enc(Nc_2947,pkSess_2944) in
                                                {2949}let m1_2949: bitstring = (OpenSecureChannelRequest,pkCli_2360,wNc_2948) in
                                                {2950}event beginCli(Cli,Sess,Nc_2947);
                                                {2951}out(c, (pkCli_2360,m1_2949));
                                                {2952}in(c, em2_2950: bitstring);
                                                {2953}let m2_2951: bitstring = em2_2950 in
                                                {2954}let (=OpenSecureChannelResponse,wNs_2952: bitstring,ST_2953: bitstring,TTL_2954: bitstring) = m2_2951 in
                                                {2955}let Ns_2955: bitstring = dec(wNs_2952,skCli_2359) in
                                                {2956}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {2957}event endCli(Sess,Cli,Ns_2955)
                                    )
                                    else
                                        {2958}let pkSess_2956: bitstring = fail-any in
                                        {2959}out(c, GetEndpointRequest);
                                        {2960}in(c, (=GetEndpointResponse,=pkSess_2956,=None,SP_2957: bitstring,UP_2958: bitstring));
                                        {2961}new Nc_2959: bitstring;
                                        {2962}let wNc_2960: bitstring = enc(Nc_2959,pkSess_2956) in
                                        {2963}let m1_2961: bitstring = (OpenSecureChannelRequest,pkCli_2360,wNc_2960) in
                                        {2964}event beginCli(Cli,Sess,Nc_2959);
                                        {2965}out(c, (pkCli_2360,m1_2961));
                                        {2966}in(c, em2_2962: bitstring);
                                        {2967}let m2_2963: bitstring = em2_2962 in
                                        {2968}let (=OpenSecureChannelResponse,wNs_2964: bitstring,ST_2965: bitstring,TTL_2966: bitstring) = m2_2963 in
                                        {2969}let Ns_2967: bitstring = dec(wNs_2964,skCli_2359) in
                                        {2970}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                        {2971}event endCli(Sess,Cli,Ns_2967)
                            )
                            else
                                {2972}let pkSess_2968: bitstring = fail-any in
                                {2973}out(c, GetEndpointRequest);
                                {2974}in(c, (=GetEndpointResponse,=pkSess_2968,=None,SP_2969: bitstring,UP_2970: bitstring));
                                {2975}new Nc_2971: bitstring;
                                {2976}let wNc_2972: bitstring = enc(Nc_2971,pkSess_2968) in
                                {2977}let m1_2973: bitstring = (OpenSecureChannelRequest,pkCli_2360,wNc_2972) in
                                {2978}event beginCli(Cli,Sess,Nc_2971);
                                {2979}out(c, (pkCli_2360,m1_2973));
                                {2980}in(c, em2_2974: bitstring);
                                {2981}let m2_2975: bitstring = em2_2974 in
                                {2982}let (=OpenSecureChannelResponse,wNs_2976: bitstring,ST_2977: bitstring,TTL_2978: bitstring) = m2_2975 in
                                {2983}let Ns_2979: bitstring = dec(wNs_2976,skCli_2359) in
                                {2984}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                {2985}event endCli(Sess,Cli,Ns_2979)
            )
            else
                {2986}let skCli_2980: bitstring = fail-any in
                {2987}let pkCli_2981: bitstring = pub(skCli_2980) in
                {2988}let v_2982: bool = (Disco = A) in
                (
                    {2989}if v_2982 then
                    (
                        {2990}let pkDisco_2983: bitstring = pub(skA) in
                        {2991}let v_2984: bool = (Sess = A) in
                        (
                            {2992}if v_2984 then
                            (
                                {2993}let pkSess_2985: bitstring = pub(skA) in
                                {2994}out(c, GetEndpointRequest);
                                {2995}in(c, (=GetEndpointResponse,=pkSess_2985,=None,SP_2986: bitstring,UP_2987: bitstring));
                                {2996}new Nc_2988: bitstring;
                                {2997}let wNc_2989: bitstring = enc(Nc_2988,pkSess_2985) in
                                {2998}let m1_2990: bitstring = (OpenSecureChannelRequest,pkCli_2981,wNc_2989) in
                                {2999}event beginCli(Cli,Sess,Nc_2988);
                                {3000}out(c, (pkCli_2981,m1_2990));
                                {3001}in(c, em2_2991: bitstring);
                                {3002}let m2_2992: bitstring = em2_2991 in
                                {3003}let (=OpenSecureChannelResponse,wNs_2993: bitstring,ST_2994: bitstring,TTL_2995: bitstring) = m2_2992 in
                                {3004}let Ns_2996: bitstring = dec(wNs_2993,skCli_2980) in
                                {3005}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                {3006}event endCli(Sess,Cli,Ns_2996)
                            )
                            else
                                {3007}let v_2997: bool = (Sess = B) in
                                (
                                    {3008}if v_2997 then
                                    (
                                        {3009}let pkSess_2998: bitstring = pub(skB) in
                                        {3010}out(c, GetEndpointRequest);
                                        {3011}in(c, (=GetEndpointResponse,=pkSess_2998,=None,SP_2999: bitstring,UP_3000: bitstring));
                                        {3012}new Nc_3001: bitstring;
                                        {3013}let wNc_3002: bitstring = enc(Nc_3001,pkSess_2998) in
                                        {3014}let m1_3003: bitstring = (OpenSecureChannelRequest,pkCli_2981,wNc_3002) in
                                        {3015}event beginCli(Cli,Sess,Nc_3001);
                                        {3016}out(c, (pkCli_2981,m1_3003));
                                        {3017}in(c, em2_3004: bitstring);
                                        {3018}let m2_3005: bitstring = em2_3004 in
                                        {3019}let (=OpenSecureChannelResponse,wNs_3006: bitstring,ST_3007: bitstring,TTL_3008: bitstring) = m2_3005 in
                                        {3020}let Ns_3009: bitstring = dec(wNs_3006,skCli_2980) in
                                        {3021}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                        {3022}event endCli(Sess,Cli,Ns_3009)
                                    )
                                    else
                                        {3023}let v_3010: bool = (Sess = C) in
                                        (
                                            {3024}if v_3010 then
                                            (
                                                {3025}let pkSess_3011: bitstring = pub(skC) in
                                                {3026}out(c, GetEndpointRequest);
                                                {3027}in(c, (=GetEndpointResponse,=pkSess_3011,=None,SP_3012: bitstring,UP_3013: bitstring));
                                                {3028}new Nc_3014: bitstring;
                                                {3029}let wNc_3015: bitstring = enc(Nc_3014,pkSess_3011) in
                                                {3030}let m1_3016: bitstring = (OpenSecureChannelRequest,pkCli_2981,wNc_3015) in
                                                {3031}event beginCli(Cli,Sess,Nc_3014);
                                                {3032}out(c, (pkCli_2981,m1_3016));
                                                {3033}in(c, em2_3017: bitstring);
                                                {3034}let m2_3018: bitstring = em2_3017 in
                                                {3035}let (=OpenSecureChannelResponse,wNs_3019: bitstring,ST_3020: bitstring,TTL_3021: bitstring) = m2_3018 in
                                                {3036}let Ns_3022: bitstring = dec(wNs_3019,skCli_2980) in
                                                {3037}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {3038}event endCli(Sess,Cli,Ns_3022)
                                            )
                                            else
                                                {3039}let pkSess_3023: bitstring = pub(sk(Sess)) in
                                                {3040}out(c, GetEndpointRequest);
                                                {3041}in(c, (=GetEndpointResponse,=pkSess_3023,=None,SP_3024: bitstring,UP_3025: bitstring));
                                                {3042}new Nc_3026: bitstring;
                                                {3043}let wNc_3027: bitstring = enc(Nc_3026,pkSess_3023) in
                                                {3044}let m1_3028: bitstring = (OpenSecureChannelRequest,pkCli_2981,wNc_3027) in
                                                {3045}event beginCli(Cli,Sess,Nc_3026);
                                                {3046}out(c, (pkCli_2981,m1_3028));
                                                {3047}in(c, em2_3029: bitstring);
                                                {3048}let m2_3030: bitstring = em2_3029 in
                                                {3049}let (=OpenSecureChannelResponse,wNs_3031: bitstring,ST_3032: bitstring,TTL_3033: bitstring) = m2_3030 in
                                                {3050}let Ns_3034: bitstring = dec(wNs_3031,skCli_2980) in
                                                {3051}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {3052}event endCli(Sess,Cli,Ns_3034)
                                        )
                                        else
                                            {3053}let pkSess_3035: bitstring = fail-any in
                                            {3054}out(c, GetEndpointRequest);
                                            {3055}in(c, (=GetEndpointResponse,=pkSess_3035,=None,SP_3036: bitstring,UP_3037: bitstring));
                                            {3056}new Nc_3038: bitstring;
                                            {3057}let wNc_3039: bitstring = enc(Nc_3038,pkSess_3035) in
                                            {3058}let m1_3040: bitstring = (OpenSecureChannelRequest,pkCli_2981,wNc_3039) in
                                            {3059}event beginCli(Cli,Sess,Nc_3038);
                                            {3060}out(c, (pkCli_2981,m1_3040));
                                            {3061}in(c, em2_3041: bitstring);
                                            {3062}let m2_3042: bitstring = em2_3041 in
                                            {3063}let (=OpenSecureChannelResponse,wNs_3043: bitstring,ST_3044: bitstring,TTL_3045: bitstring) = m2_3042 in
                                            {3064}let Ns_3046: bitstring = dec(wNs_3043,skCli_2980) in
                                            {3065}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {3066}event endCli(Sess,Cli,Ns_3046)
                                )
                                else
                                    {3067}let pkSess_3047: bitstring = fail-any in
                                    {3068}out(c, GetEndpointRequest);
                                    {3069}in(c, (=GetEndpointResponse,=pkSess_3047,=None,SP_3048: bitstring,UP_3049: bitstring));
                                    {3070}new Nc_3050: bitstring;
                                    {3071}let wNc_3051: bitstring = enc(Nc_3050,pkSess_3047) in
                                    {3072}let m1_3052: bitstring = (OpenSecureChannelRequest,pkCli_2981,wNc_3051) in
                                    {3073}event beginCli(Cli,Sess,Nc_3050);
                                    {3074}out(c, (pkCli_2981,m1_3052));
                                    {3075}in(c, em2_3053: bitstring);
                                    {3076}let m2_3054: bitstring = em2_3053 in
                                    {3077}let (=OpenSecureChannelResponse,wNs_3055: bitstring,ST_3056: bitstring,TTL_3057: bitstring) = m2_3054 in
                                    {3078}let Ns_3058: bitstring = dec(wNs_3055,skCli_2980) in
                                    {3079}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                    {3080}event endCli(Sess,Cli,Ns_3058)
                        )
                        else
                            {3081}let pkSess_3059: bitstring = fail-any in
                            {3082}out(c, GetEndpointRequest);
                            {3083}in(c, (=GetEndpointResponse,=pkSess_3059,=None,SP_3060: bitstring,UP_3061: bitstring));
                            {3084}new Nc_3062: bitstring;
                            {3085}let wNc_3063: bitstring = enc(Nc_3062,pkSess_3059) in
                            {3086}let m1_3064: bitstring = (OpenSecureChannelRequest,pkCli_2981,wNc_3063) in
                            {3087}event beginCli(Cli,Sess,Nc_3062);
                            {3088}out(c, (pkCli_2981,m1_3064));
                            {3089}in(c, em2_3065: bitstring);
                            {3090}let m2_3066: bitstring = em2_3065 in
                            {3091}let (=OpenSecureChannelResponse,wNs_3067: bitstring,ST_3068: bitstring,TTL_3069: bitstring) = m2_3066 in
                            {3092}let Ns_3070: bitstring = dec(wNs_3067,skCli_2980) in
                            {3093}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                            {3094}event endCli(Sess,Cli,Ns_3070)
                    )
                    else
                        {3095}let v_3071: bool = (Disco = B) in
                        (
                            {3096}if v_3071 then
                            (
                                {3097}let pkDisco_3072: bitstring = pub(skB) in
                                {3098}let v_3073: bool = (Sess = A) in
                                (
                                    {3099}if v_3073 then
                                    (
                                        {3100}let pkSess_3074: bitstring = pub(skA) in
                                        {3101}out(c, GetEndpointRequest);
                                        {3102}in(c, (=GetEndpointResponse,=pkSess_3074,=None,SP_3075: bitstring,UP_3076: bitstring));
                                        {3103}new Nc_3077: bitstring;
                                        {3104}let wNc_3078: bitstring = enc(Nc_3077,pkSess_3074) in
                                        {3105}let m1_3079: bitstring = (OpenSecureChannelRequest,pkCli_2981,wNc_3078) in
                                        {3106}event beginCli(Cli,Sess,Nc_3077);
                                        {3107}out(c, (pkCli_2981,m1_3079));
                                        {3108}in(c, em2_3080: bitstring);
                                        {3109}let m2_3081: bitstring = em2_3080 in
                                        {3110}let (=OpenSecureChannelResponse,wNs_3082: bitstring,ST_3083: bitstring,TTL_3084: bitstring) = m2_3081 in
                                        {3111}let Ns_3085: bitstring = dec(wNs_3082,skCli_2980) in
                                        {3112}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                        {3113}event endCli(Sess,Cli,Ns_3085)
                                    )
                                    else
                                        {3114}let v_3086: bool = (Sess = B) in
                                        (
                                            {3115}if v_3086 then
                                            (
                                                {3116}let pkSess_3087: bitstring = pub(skB) in
                                                {3117}out(c, GetEndpointRequest);
                                                {3118}in(c, (=GetEndpointResponse,=pkSess_3087,=None,SP_3088: bitstring,UP_3089: bitstring));
                                                {3119}new Nc_3090: bitstring;
                                                {3120}let wNc_3091: bitstring = enc(Nc_3090,pkSess_3087) in
                                                {3121}let m1_3092: bitstring = (OpenSecureChannelRequest,pkCli_2981,wNc_3091) in
                                                {3122}event beginCli(Cli,Sess,Nc_3090);
                                                {3123}out(c, (pkCli_2981,m1_3092));
                                                {3124}in(c, em2_3093: bitstring);
                                                {3125}let m2_3094: bitstring = em2_3093 in
                                                {3126}let (=OpenSecureChannelResponse,wNs_3095: bitstring,ST_3096: bitstring,TTL_3097: bitstring) = m2_3094 in
                                                {3127}let Ns_3098: bitstring = dec(wNs_3095,skCli_2980) in
                                                {3128}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {3129}event endCli(Sess,Cli,Ns_3098)
                                            )
                                            else
                                                {3130}let v_3099: bool = (Sess = C) in
                                                (
                                                    {3131}if v_3099 then
                                                    (
                                                        {3132}let pkSess_3100: bitstring = pub(skC) in
                                                        {3133}out(c, GetEndpointRequest);
                                                        {3134}in(c, (=GetEndpointResponse,=pkSess_3100,=None,SP_3101: bitstring,UP_3102: bitstring));
                                                        {3135}new Nc_3103: bitstring;
                                                        {3136}let wNc_3104: bitstring = enc(Nc_3103,pkSess_3100) in
                                                        {3137}let m1_3105: bitstring = (OpenSecureChannelRequest,pkCli_2981,wNc_3104) in
                                                        {3138}event beginCli(Cli,Sess,Nc_3103);
                                                        {3139}out(c, (pkCli_2981,m1_3105));
                                                        {3140}in(c, em2_3106: bitstring);
                                                        {3141}let m2_3107: bitstring = em2_3106 in
                                                        {3142}let (=OpenSecureChannelResponse,wNs_3108: bitstring,ST_3109: bitstring,TTL_3110: bitstring) = m2_3107 in
                                                        {3143}let Ns_3111: bitstring = dec(wNs_3108,skCli_2980) in
                                                        {3144}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {3145}event endCli(Sess,Cli,Ns_3111)
                                                    )
                                                    else
                                                        {3146}let pkSess_3112: bitstring = pub(sk(Sess)) in
                                                        {3147}out(c, GetEndpointRequest);
                                                        {3148}in(c, (=GetEndpointResponse,=pkSess_3112,=None,SP_3113: bitstring,UP_3114: bitstring));
                                                        {3149}new Nc_3115: bitstring;
                                                        {3150}let wNc_3116: bitstring = enc(Nc_3115,pkSess_3112) in
                                                        {3151}let m1_3117: bitstring = (OpenSecureChannelRequest,pkCli_2981,wNc_3116) in
                                                        {3152}event beginCli(Cli,Sess,Nc_3115);
                                                        {3153}out(c, (pkCli_2981,m1_3117));
                                                        {3154}in(c, em2_3118: bitstring);
                                                        {3155}let m2_3119: bitstring = em2_3118 in
                                                        {3156}let (=OpenSecureChannelResponse,wNs_3120: bitstring,ST_3121: bitstring,TTL_3122: bitstring) = m2_3119 in
                                                        {3157}let Ns_3123: bitstring = dec(wNs_3120,skCli_2980) in
                                                        {3158}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {3159}event endCli(Sess,Cli,Ns_3123)
                                                )
                                                else
                                                    {3160}let pkSess_3124: bitstring = fail-any in
                                                    {3161}out(c, GetEndpointRequest);
                                                    {3162}in(c, (=GetEndpointResponse,=pkSess_3124,=None,SP_3125: bitstring,UP_3126: bitstring));
                                                    {3163}new Nc_3127: bitstring;
                                                    {3164}let wNc_3128: bitstring = enc(Nc_3127,pkSess_3124) in
                                                    {3165}let m1_3129: bitstring = (OpenSecureChannelRequest,pkCli_2981,wNc_3128) in
                                                    {3166}event beginCli(Cli,Sess,Nc_3127);
                                                    {3167}out(c, (pkCli_2981,m1_3129));
                                                    {3168}in(c, em2_3130: bitstring);
                                                    {3169}let m2_3131: bitstring = em2_3130 in
                                                    {3170}let (=OpenSecureChannelResponse,wNs_3132: bitstring,ST_3133: bitstring,TTL_3134: bitstring) = m2_3131 in
                                                    {3171}let Ns_3135: bitstring = dec(wNs_3132,skCli_2980) in
                                                    {3172}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {3173}event endCli(Sess,Cli,Ns_3135)
                                        )
                                        else
                                            {3174}let pkSess_3136: bitstring = fail-any in
                                            {3175}out(c, GetEndpointRequest);
                                            {3176}in(c, (=GetEndpointResponse,=pkSess_3136,=None,SP_3137: bitstring,UP_3138: bitstring));
                                            {3177}new Nc_3139: bitstring;
                                            {3178}let wNc_3140: bitstring = enc(Nc_3139,pkSess_3136) in
                                            {3179}let m1_3141: bitstring = (OpenSecureChannelRequest,pkCli_2981,wNc_3140) in
                                            {3180}event beginCli(Cli,Sess,Nc_3139);
                                            {3181}out(c, (pkCli_2981,m1_3141));
                                            {3182}in(c, em2_3142: bitstring);
                                            {3183}let m2_3143: bitstring = em2_3142 in
                                            {3184}let (=OpenSecureChannelResponse,wNs_3144: bitstring,ST_3145: bitstring,TTL_3146: bitstring) = m2_3143 in
                                            {3185}let Ns_3147: bitstring = dec(wNs_3144,skCli_2980) in
                                            {3186}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {3187}event endCli(Sess,Cli,Ns_3147)
                                )
                                else
                                    {3188}let pkSess_3148: bitstring = fail-any in
                                    {3189}out(c, GetEndpointRequest);
                                    {3190}in(c, (=GetEndpointResponse,=pkSess_3148,=None,SP_3149: bitstring,UP_3150: bitstring));
                                    {3191}new Nc_3151: bitstring;
                                    {3192}let wNc_3152: bitstring = enc(Nc_3151,pkSess_3148) in
                                    {3193}let m1_3153: bitstring = (OpenSecureChannelRequest,pkCli_2981,wNc_3152) in
                                    {3194}event beginCli(Cli,Sess,Nc_3151);
                                    {3195}out(c, (pkCli_2981,m1_3153));
                                    {3196}in(c, em2_3154: bitstring);
                                    {3197}let m2_3155: bitstring = em2_3154 in
                                    {3198}let (=OpenSecureChannelResponse,wNs_3156: bitstring,ST_3157: bitstring,TTL_3158: bitstring) = m2_3155 in
                                    {3199}let Ns_3159: bitstring = dec(wNs_3156,skCli_2980) in
                                    {3200}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                    {3201}event endCli(Sess,Cli,Ns_3159)
                            )
                            else
                                {3202}let v_3160: bool = (Disco = C) in
                                (
                                    {3203}if v_3160 then
                                    (
                                        {3204}let pkDisco_3161: bitstring = pub(skC) in
                                        {3205}let v_3162: bool = (Sess = A) in
                                        (
                                            {3206}if v_3162 then
                                            (
                                                {3207}let pkSess_3163: bitstring = pub(skA) in
                                                {3208}out(c, GetEndpointRequest);
                                                {3209}in(c, (=GetEndpointResponse,=pkSess_3163,=None,SP_3164: bitstring,UP_3165: bitstring));
                                                {3210}new Nc_3166: bitstring;
                                                {3211}let wNc_3167: bitstring = enc(Nc_3166,pkSess_3163) in
                                                {3212}let m1_3168: bitstring = (OpenSecureChannelRequest,pkCli_2981,wNc_3167) in
                                                {3213}event beginCli(Cli,Sess,Nc_3166);
                                                {3214}out(c, (pkCli_2981,m1_3168));
                                                {3215}in(c, em2_3169: bitstring);
                                                {3216}let m2_3170: bitstring = em2_3169 in
                                                {3217}let (=OpenSecureChannelResponse,wNs_3171: bitstring,ST_3172: bitstring,TTL_3173: bitstring) = m2_3170 in
                                                {3218}let Ns_3174: bitstring = dec(wNs_3171,skCli_2980) in
                                                {3219}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {3220}event endCli(Sess,Cli,Ns_3174)
                                            )
                                            else
                                                {3221}let v_3175: bool = (Sess = B) in
                                                (
                                                    {3222}if v_3175 then
                                                    (
                                                        {3223}let pkSess_3176: bitstring = pub(skB) in
                                                        {3224}out(c, GetEndpointRequest);
                                                        {3225}in(c, (=GetEndpointResponse,=pkSess_3176,=None,SP_3177: bitstring,UP_3178: bitstring));
                                                        {3226}new Nc_3179: bitstring;
                                                        {3227}let wNc_3180: bitstring = enc(Nc_3179,pkSess_3176) in
                                                        {3228}let m1_3181: bitstring = (OpenSecureChannelRequest,pkCli_2981,wNc_3180) in
                                                        {3229}event beginCli(Cli,Sess,Nc_3179);
                                                        {3230}out(c, (pkCli_2981,m1_3181));
                                                        {3231}in(c, em2_3182: bitstring);
                                                        {3232}let m2_3183: bitstring = em2_3182 in
                                                        {3233}let (=OpenSecureChannelResponse,wNs_3184: bitstring,ST_3185: bitstring,TTL_3186: bitstring) = m2_3183 in
                                                        {3234}let Ns_3187: bitstring = dec(wNs_3184,skCli_2980) in
                                                        {3235}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {3236}event endCli(Sess,Cli,Ns_3187)
                                                    )
                                                    else
                                                        {3237}let v_3188: bool = (Sess = C) in
                                                        (
                                                            {3238}if v_3188 then
                                                            (
                                                                {3239}let pkSess_3189: bitstring = pub(skC) in
                                                                {3240}out(c, GetEndpointRequest);
                                                                {3241}in(c, (=GetEndpointResponse,=pkSess_3189,=None,SP_3190: bitstring,UP_3191: bitstring));
                                                                {3242}new Nc_3192: bitstring;
                                                                {3243}let wNc_3193: bitstring = enc(Nc_3192,pkSess_3189) in
                                                                {3244}let m1_3194: bitstring = (OpenSecureChannelRequest,pkCli_2981,wNc_3193) in
                                                                {3245}event beginCli(Cli,Sess,Nc_3192);
                                                                {3246}out(c, (pkCli_2981,m1_3194));
                                                                {3247}in(c, em2_3195: bitstring);
                                                                {3248}let m2_3196: bitstring = em2_3195 in
                                                                {3249}let (=OpenSecureChannelResponse,wNs_3197: bitstring,ST_3198: bitstring,TTL_3199: bitstring) = m2_3196 in
                                                                {3250}let Ns_3200: bitstring = dec(wNs_3197,skCli_2980) in
                                                                {3251}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                {3252}event endCli(Sess,Cli,Ns_3200)
                                                            )
                                                            else
                                                                {3253}let pkSess_3201: bitstring = pub(sk(Sess)) in
                                                                {3254}out(c, GetEndpointRequest);
                                                                {3255}in(c, (=GetEndpointResponse,=pkSess_3201,=None,SP_3202: bitstring,UP_3203: bitstring));
                                                                {3256}new Nc_3204: bitstring;
                                                                {3257}let wNc_3205: bitstring = enc(Nc_3204,pkSess_3201) in
                                                                {3258}let m1_3206: bitstring = (OpenSecureChannelRequest,pkCli_2981,wNc_3205) in
                                                                {3259}event beginCli(Cli,Sess,Nc_3204);
                                                                {3260}out(c, (pkCli_2981,m1_3206));
                                                                {3261}in(c, em2_3207: bitstring);
                                                                {3262}let m2_3208: bitstring = em2_3207 in
                                                                {3263}let (=OpenSecureChannelResponse,wNs_3209: bitstring,ST_3210: bitstring,TTL_3211: bitstring) = m2_3208 in
                                                                {3264}let Ns_3212: bitstring = dec(wNs_3209,skCli_2980) in
                                                                {3265}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                {3266}event endCli(Sess,Cli,Ns_3212)
                                                        )
                                                        else
                                                            {3267}let pkSess_3213: bitstring = fail-any in
                                                            {3268}out(c, GetEndpointRequest);
                                                            {3269}in(c, (=GetEndpointResponse,=pkSess_3213,=None,SP_3214: bitstring,UP_3215: bitstring));
                                                            {3270}new Nc_3216: bitstring;
                                                            {3271}let wNc_3217: bitstring = enc(Nc_3216,pkSess_3213) in
                                                            {3272}let m1_3218: bitstring = (OpenSecureChannelRequest,pkCli_2981,wNc_3217) in
                                                            {3273}event beginCli(Cli,Sess,Nc_3216);
                                                            {3274}out(c, (pkCli_2981,m1_3218));
                                                            {3275}in(c, em2_3219: bitstring);
                                                            {3276}let m2_3220: bitstring = em2_3219 in
                                                            {3277}let (=OpenSecureChannelResponse,wNs_3221: bitstring,ST_3222: bitstring,TTL_3223: bitstring) = m2_3220 in
                                                            {3278}let Ns_3224: bitstring = dec(wNs_3221,skCli_2980) in
                                                            {3279}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                            {3280}event endCli(Sess,Cli,Ns_3224)
                                                )
                                                else
                                                    {3281}let pkSess_3225: bitstring = fail-any in
                                                    {3282}out(c, GetEndpointRequest);
                                                    {3283}in(c, (=GetEndpointResponse,=pkSess_3225,=None,SP_3226: bitstring,UP_3227: bitstring));
                                                    {3284}new Nc_3228: bitstring;
                                                    {3285}let wNc_3229: bitstring = enc(Nc_3228,pkSess_3225) in
                                                    {3286}let m1_3230: bitstring = (OpenSecureChannelRequest,pkCli_2981,wNc_3229) in
                                                    {3287}event beginCli(Cli,Sess,Nc_3228);
                                                    {3288}out(c, (pkCli_2981,m1_3230));
                                                    {3289}in(c, em2_3231: bitstring);
                                                    {3290}let m2_3232: bitstring = em2_3231 in
                                                    {3291}let (=OpenSecureChannelResponse,wNs_3233: bitstring,ST_3234: bitstring,TTL_3235: bitstring) = m2_3232 in
                                                    {3292}let Ns_3236: bitstring = dec(wNs_3233,skCli_2980) in
                                                    {3293}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {3294}event endCli(Sess,Cli,Ns_3236)
                                        )
                                        else
                                            {3295}let pkSess_3237: bitstring = fail-any in
                                            {3296}out(c, GetEndpointRequest);
                                            {3297}in(c, (=GetEndpointResponse,=pkSess_3237,=None,SP_3238: bitstring,UP_3239: bitstring));
                                            {3298}new Nc_3240: bitstring;
                                            {3299}let wNc_3241: bitstring = enc(Nc_3240,pkSess_3237) in
                                            {3300}let m1_3242: bitstring = (OpenSecureChannelRequest,pkCli_2981,wNc_3241) in
                                            {3301}event beginCli(Cli,Sess,Nc_3240);
                                            {3302}out(c, (pkCli_2981,m1_3242));
                                            {3303}in(c, em2_3243: bitstring);
                                            {3304}let m2_3244: bitstring = em2_3243 in
                                            {3305}let (=OpenSecureChannelResponse,wNs_3245: bitstring,ST_3246: bitstring,TTL_3247: bitstring) = m2_3244 in
                                            {3306}let Ns_3248: bitstring = dec(wNs_3245,skCli_2980) in
                                            {3307}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {3308}event endCli(Sess,Cli,Ns_3248)
                                    )
                                    else
                                        {3309}let pkDisco_3249: bitstring = pub(sk(Disco)) in
                                        {3310}let v_3250: bool = (Sess = A) in
                                        (
                                            {3311}if v_3250 then
                                            (
                                                {3312}let pkSess_3251: bitstring = pub(skA) in
                                                {3313}out(c, GetEndpointRequest);
                                                {3314}in(c, (=GetEndpointResponse,=pkSess_3251,=None,SP_3252: bitstring,UP_3253: bitstring));
                                                {3315}new Nc_3254: bitstring;
                                                {3316}let wNc_3255: bitstring = enc(Nc_3254,pkSess_3251) in
                                                {3317}let m1_3256: bitstring = (OpenSecureChannelRequest,pkCli_2981,wNc_3255) in
                                                {3318}event beginCli(Cli,Sess,Nc_3254);
                                                {3319}out(c, (pkCli_2981,m1_3256));
                                                {3320}in(c, em2_3257: bitstring);
                                                {3321}let m2_3258: bitstring = em2_3257 in
                                                {3322}let (=OpenSecureChannelResponse,wNs_3259: bitstring,ST_3260: bitstring,TTL_3261: bitstring) = m2_3258 in
                                                {3323}let Ns_3262: bitstring = dec(wNs_3259,skCli_2980) in
                                                {3324}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {3325}event endCli(Sess,Cli,Ns_3262)
                                            )
                                            else
                                                {3326}let v_3263: bool = (Sess = B) in
                                                (
                                                    {3327}if v_3263 then
                                                    (
                                                        {3328}let pkSess_3264: bitstring = pub(skB) in
                                                        {3329}out(c, GetEndpointRequest);
                                                        {3330}in(c, (=GetEndpointResponse,=pkSess_3264,=None,SP_3265: bitstring,UP_3266: bitstring));
                                                        {3331}new Nc_3267: bitstring;
                                                        {3332}let wNc_3268: bitstring = enc(Nc_3267,pkSess_3264) in
                                                        {3333}let m1_3269: bitstring = (OpenSecureChannelRequest,pkCli_2981,wNc_3268) in
                                                        {3334}event beginCli(Cli,Sess,Nc_3267);
                                                        {3335}out(c, (pkCli_2981,m1_3269));
                                                        {3336}in(c, em2_3270: bitstring);
                                                        {3337}let m2_3271: bitstring = em2_3270 in
                                                        {3338}let (=OpenSecureChannelResponse,wNs_3272: bitstring,ST_3273: bitstring,TTL_3274: bitstring) = m2_3271 in
                                                        {3339}let Ns_3275: bitstring = dec(wNs_3272,skCli_2980) in
                                                        {3340}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {3341}event endCli(Sess,Cli,Ns_3275)
                                                    )
                                                    else
                                                        {3342}let v_3276: bool = (Sess = C) in
                                                        (
                                                            {3343}if v_3276 then
                                                            (
                                                                {3344}let pkSess_3277: bitstring = pub(skC) in
                                                                {3345}out(c, GetEndpointRequest);
                                                                {3346}in(c, (=GetEndpointResponse,=pkSess_3277,=None,SP_3278: bitstring,UP_3279: bitstring));
                                                                {3347}new Nc_3280: bitstring;
                                                                {3348}let wNc_3281: bitstring = enc(Nc_3280,pkSess_3277) in
                                                                {3349}let m1_3282: bitstring = (OpenSecureChannelRequest,pkCli_2981,wNc_3281) in
                                                                {3350}event beginCli(Cli,Sess,Nc_3280);
                                                                {3351}out(c, (pkCli_2981,m1_3282));
                                                                {3352}in(c, em2_3283: bitstring);
                                                                {3353}let m2_3284: bitstring = em2_3283 in
                                                                {3354}let (=OpenSecureChannelResponse,wNs_3285: bitstring,ST_3286: bitstring,TTL_3287: bitstring) = m2_3284 in
                                                                {3355}let Ns_3288: bitstring = dec(wNs_3285,skCli_2980) in
                                                                {3356}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                {3357}event endCli(Sess,Cli,Ns_3288)
                                                            )
                                                            else
                                                                {3358}let pkSess_3289: bitstring = pub(sk(Sess)) in
                                                                {3359}out(c, GetEndpointRequest);
                                                                {3360}in(c, (=GetEndpointResponse,=pkSess_3289,=None,SP_3290: bitstring,UP_3291: bitstring));
                                                                {3361}new Nc_3292: bitstring;
                                                                {3362}let wNc_3293: bitstring = enc(Nc_3292,pkSess_3289) in
                                                                {3363}let m1_3294: bitstring = (OpenSecureChannelRequest,pkCli_2981,wNc_3293) in
                                                                {3364}event beginCli(Cli,Sess,Nc_3292);
                                                                {3365}out(c, (pkCli_2981,m1_3294));
                                                                {3366}in(c, em2_3295: bitstring);
                                                                {3367}let m2_3296: bitstring = em2_3295 in
                                                                {3368}let (=OpenSecureChannelResponse,wNs_3297: bitstring,ST_3298: bitstring,TTL_3299: bitstring) = m2_3296 in
                                                                {3369}let Ns_3300: bitstring = dec(wNs_3297,skCli_2980) in
                                                                {3370}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                {3371}event endCli(Sess,Cli,Ns_3300)
                                                        )
                                                        else
                                                            {3372}let pkSess_3301: bitstring = fail-any in
                                                            {3373}out(c, GetEndpointRequest);
                                                            {3374}in(c, (=GetEndpointResponse,=pkSess_3301,=None,SP_3302: bitstring,UP_3303: bitstring));
                                                            {3375}new Nc_3304: bitstring;
                                                            {3376}let wNc_3305: bitstring = enc(Nc_3304,pkSess_3301) in
                                                            {3377}let m1_3306: bitstring = (OpenSecureChannelRequest,pkCli_2981,wNc_3305) in
                                                            {3378}event beginCli(Cli,Sess,Nc_3304);
                                                            {3379}out(c, (pkCli_2981,m1_3306));
                                                            {3380}in(c, em2_3307: bitstring);
                                                            {3381}let m2_3308: bitstring = em2_3307 in
                                                            {3382}let (=OpenSecureChannelResponse,wNs_3309: bitstring,ST_3310: bitstring,TTL_3311: bitstring) = m2_3308 in
                                                            {3383}let Ns_3312: bitstring = dec(wNs_3309,skCli_2980) in
                                                            {3384}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                            {3385}event endCli(Sess,Cli,Ns_3312)
                                                )
                                                else
                                                    {3386}let pkSess_3313: bitstring = fail-any in
                                                    {3387}out(c, GetEndpointRequest);
                                                    {3388}in(c, (=GetEndpointResponse,=pkSess_3313,=None,SP_3314: bitstring,UP_3315: bitstring));
                                                    {3389}new Nc_3316: bitstring;
                                                    {3390}let wNc_3317: bitstring = enc(Nc_3316,pkSess_3313) in
                                                    {3391}let m1_3318: bitstring = (OpenSecureChannelRequest,pkCli_2981,wNc_3317) in
                                                    {3392}event beginCli(Cli,Sess,Nc_3316);
                                                    {3393}out(c, (pkCli_2981,m1_3318));
                                                    {3394}in(c, em2_3319: bitstring);
                                                    {3395}let m2_3320: bitstring = em2_3319 in
                                                    {3396}let (=OpenSecureChannelResponse,wNs_3321: bitstring,ST_3322: bitstring,TTL_3323: bitstring) = m2_3320 in
                                                    {3397}let Ns_3324: bitstring = dec(wNs_3321,skCli_2980) in
                                                    {3398}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {3399}event endCli(Sess,Cli,Ns_3324)
                                        )
                                        else
                                            {3400}let pkSess_3325: bitstring = fail-any in
                                            {3401}out(c, GetEndpointRequest);
                                            {3402}in(c, (=GetEndpointResponse,=pkSess_3325,=None,SP_3326: bitstring,UP_3327: bitstring));
                                            {3403}new Nc_3328: bitstring;
                                            {3404}let wNc_3329: bitstring = enc(Nc_3328,pkSess_3325) in
                                            {3405}let m1_3330: bitstring = (OpenSecureChannelRequest,pkCli_2981,wNc_3329) in
                                            {3406}event beginCli(Cli,Sess,Nc_3328);
                                            {3407}out(c, (pkCli_2981,m1_3330));
                                            {3408}in(c, em2_3331: bitstring);
                                            {3409}let m2_3332: bitstring = em2_3331 in
                                            {3410}let (=OpenSecureChannelResponse,wNs_3333: bitstring,ST_3334: bitstring,TTL_3335: bitstring) = m2_3332 in
                                            {3411}let Ns_3336: bitstring = dec(wNs_3333,skCli_2980) in
                                            {3412}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {3413}event endCli(Sess,Cli,Ns_3336)
                                )
                                else
                                    {3414}let pkDisco_3337: bitstring = fail-any in
                                    {3415}let v_3338: bool = (Sess = A) in
                                    (
                                        {3416}if v_3338 then
                                        (
                                            {3417}let pkSess_3339: bitstring = pub(skA) in
                                            {3418}out(c, GetEndpointRequest);
                                            {3419}in(c, (=GetEndpointResponse,=pkSess_3339,=None,SP_3340: bitstring,UP_3341: bitstring));
                                            {3420}new Nc_3342: bitstring;
                                            {3421}let wNc_3343: bitstring = enc(Nc_3342,pkSess_3339) in
                                            {3422}let m1_3344: bitstring = (OpenSecureChannelRequest,pkCli_2981,wNc_3343) in
                                            {3423}event beginCli(Cli,Sess,Nc_3342);
                                            {3424}out(c, (pkCli_2981,m1_3344));
                                            {3425}in(c, em2_3345: bitstring);
                                            {3426}let m2_3346: bitstring = em2_3345 in
                                            {3427}let (=OpenSecureChannelResponse,wNs_3347: bitstring,ST_3348: bitstring,TTL_3349: bitstring) = m2_3346 in
                                            {3428}let Ns_3350: bitstring = dec(wNs_3347,skCli_2980) in
                                            {3429}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {3430}event endCli(Sess,Cli,Ns_3350)
                                        )
                                        else
                                            {3431}let v_3351: bool = (Sess = B) in
                                            (
                                                {3432}if v_3351 then
                                                (
                                                    {3433}let pkSess_3352: bitstring = pub(skB) in
                                                    {3434}out(c, GetEndpointRequest);
                                                    {3435}in(c, (=GetEndpointResponse,=pkSess_3352,=None,SP_3353: bitstring,UP_3354: bitstring));
                                                    {3436}new Nc_3355: bitstring;
                                                    {3437}let wNc_3356: bitstring = enc(Nc_3355,pkSess_3352) in
                                                    {3438}let m1_3357: bitstring = (OpenSecureChannelRequest,pkCli_2981,wNc_3356) in
                                                    {3439}event beginCli(Cli,Sess,Nc_3355);
                                                    {3440}out(c, (pkCli_2981,m1_3357));
                                                    {3441}in(c, em2_3358: bitstring);
                                                    {3442}let m2_3359: bitstring = em2_3358 in
                                                    {3443}let (=OpenSecureChannelResponse,wNs_3360: bitstring,ST_3361: bitstring,TTL_3362: bitstring) = m2_3359 in
                                                    {3444}let Ns_3363: bitstring = dec(wNs_3360,skCli_2980) in
                                                    {3445}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {3446}event endCli(Sess,Cli,Ns_3363)
                                                )
                                                else
                                                    {3447}let v_3364: bool = (Sess = C) in
                                                    (
                                                        {3448}if v_3364 then
                                                        (
                                                            {3449}let pkSess_3365: bitstring = pub(skC) in
                                                            {3450}out(c, GetEndpointRequest);
                                                            {3451}in(c, (=GetEndpointResponse,=pkSess_3365,=None,SP_3366: bitstring,UP_3367: bitstring));
                                                            {3452}new Nc_3368: bitstring;
                                                            {3453}let wNc_3369: bitstring = enc(Nc_3368,pkSess_3365) in
                                                            {3454}let m1_3370: bitstring = (OpenSecureChannelRequest,pkCli_2981,wNc_3369) in
                                                            {3455}event beginCli(Cli,Sess,Nc_3368);
                                                            {3456}out(c, (pkCli_2981,m1_3370));
                                                            {3457}in(c, em2_3371: bitstring);
                                                            {3458}let m2_3372: bitstring = em2_3371 in
                                                            {3459}let (=OpenSecureChannelResponse,wNs_3373: bitstring,ST_3374: bitstring,TTL_3375: bitstring) = m2_3372 in
                                                            {3460}let Ns_3376: bitstring = dec(wNs_3373,skCli_2980) in
                                                            {3461}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                            {3462}event endCli(Sess,Cli,Ns_3376)
                                                        )
                                                        else
                                                            {3463}let pkSess_3377: bitstring = pub(sk(Sess)) in
                                                            {3464}out(c, GetEndpointRequest);
                                                            {3465}in(c, (=GetEndpointResponse,=pkSess_3377,=None,SP_3378: bitstring,UP_3379: bitstring));
                                                            {3466}new Nc_3380: bitstring;
                                                            {3467}let wNc_3381: bitstring = enc(Nc_3380,pkSess_3377) in
                                                            {3468}let m1_3382: bitstring = (OpenSecureChannelRequest,pkCli_2981,wNc_3381) in
                                                            {3469}event beginCli(Cli,Sess,Nc_3380);
                                                            {3470}out(c, (pkCli_2981,m1_3382));
                                                            {3471}in(c, em2_3383: bitstring);
                                                            {3472}let m2_3384: bitstring = em2_3383 in
                                                            {3473}let (=OpenSecureChannelResponse,wNs_3385: bitstring,ST_3386: bitstring,TTL_3387: bitstring) = m2_3384 in
                                                            {3474}let Ns_3388: bitstring = dec(wNs_3385,skCli_2980) in
                                                            {3475}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                            {3476}event endCli(Sess,Cli,Ns_3388)
                                                    )
                                                    else
                                                        {3477}let pkSess_3389: bitstring = fail-any in
                                                        {3478}out(c, GetEndpointRequest);
                                                        {3479}in(c, (=GetEndpointResponse,=pkSess_3389,=None,SP_3390: bitstring,UP_3391: bitstring));
                                                        {3480}new Nc_3392: bitstring;
                                                        {3481}let wNc_3393: bitstring = enc(Nc_3392,pkSess_3389) in
                                                        {3482}let m1_3394: bitstring = (OpenSecureChannelRequest,pkCli_2981,wNc_3393) in
                                                        {3483}event beginCli(Cli,Sess,Nc_3392);
                                                        {3484}out(c, (pkCli_2981,m1_3394));
                                                        {3485}in(c, em2_3395: bitstring);
                                                        {3486}let m2_3396: bitstring = em2_3395 in
                                                        {3487}let (=OpenSecureChannelResponse,wNs_3397: bitstring,ST_3398: bitstring,TTL_3399: bitstring) = m2_3396 in
                                                        {3488}let Ns_3400: bitstring = dec(wNs_3397,skCli_2980) in
                                                        {3489}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {3490}event endCli(Sess,Cli,Ns_3400)
                                            )
                                            else
                                                {3491}let pkSess_3401: bitstring = fail-any in
                                                {3492}out(c, GetEndpointRequest);
                                                {3493}in(c, (=GetEndpointResponse,=pkSess_3401,=None,SP_3402: bitstring,UP_3403: bitstring));
                                                {3494}new Nc_3404: bitstring;
                                                {3495}let wNc_3405: bitstring = enc(Nc_3404,pkSess_3401) in
                                                {3496}let m1_3406: bitstring = (OpenSecureChannelRequest,pkCli_2981,wNc_3405) in
                                                {3497}event beginCli(Cli,Sess,Nc_3404);
                                                {3498}out(c, (pkCli_2981,m1_3406));
                                                {3499}in(c, em2_3407: bitstring);
                                                {3500}let m2_3408: bitstring = em2_3407 in
                                                {3501}let (=OpenSecureChannelResponse,wNs_3409: bitstring,ST_3410: bitstring,TTL_3411: bitstring) = m2_3408 in
                                                {3502}let Ns_3412: bitstring = dec(wNs_3409,skCli_2980) in
                                                {3503}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {3504}event endCli(Sess,Cli,Ns_3412)
                                    )
                                    else
                                        {3505}let pkSess_3413: bitstring = fail-any in
                                        {3506}out(c, GetEndpointRequest);
                                        {3507}in(c, (=GetEndpointResponse,=pkSess_3413,=None,SP_3414: bitstring,UP_3415: bitstring));
                                        {3508}new Nc_3416: bitstring;
                                        {3509}let wNc_3417: bitstring = enc(Nc_3416,pkSess_3413) in
                                        {3510}let m1_3418: bitstring = (OpenSecureChannelRequest,pkCli_2981,wNc_3417) in
                                        {3511}event beginCli(Cli,Sess,Nc_3416);
                                        {3512}out(c, (pkCli_2981,m1_3418));
                                        {3513}in(c, em2_3419: bitstring);
                                        {3514}let m2_3420: bitstring = em2_3419 in
                                        {3515}let (=OpenSecureChannelResponse,wNs_3421: bitstring,ST_3422: bitstring,TTL_3423: bitstring) = m2_3420 in
                                        {3516}let Ns_3424: bitstring = dec(wNs_3421,skCli_2980) in
                                        {3517}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                        {3518}event endCli(Sess,Cli,Ns_3424)
                        )
                        else
                            {3519}let pkDisco_3425: bitstring = fail-any in
                            {3520}let v_3426: bool = (Sess = A) in
                            (
                                {3521}if v_3426 then
                                (
                                    {3522}let pkSess_3427: bitstring = pub(skA) in
                                    {3523}out(c, GetEndpointRequest);
                                    {3524}in(c, (=GetEndpointResponse,=pkSess_3427,=None,SP_3428: bitstring,UP_3429: bitstring));
                                    {3525}new Nc_3430: bitstring;
                                    {3526}let wNc_3431: bitstring = enc(Nc_3430,pkSess_3427) in
                                    {3527}let m1_3432: bitstring = (OpenSecureChannelRequest,pkCli_2981,wNc_3431) in
                                    {3528}event beginCli(Cli,Sess,Nc_3430);
                                    {3529}out(c, (pkCli_2981,m1_3432));
                                    {3530}in(c, em2_3433: bitstring);
                                    {3531}let m2_3434: bitstring = em2_3433 in
                                    {3532}let (=OpenSecureChannelResponse,wNs_3435: bitstring,ST_3436: bitstring,TTL_3437: bitstring) = m2_3434 in
                                    {3533}let Ns_3438: bitstring = dec(wNs_3435,skCli_2980) in
                                    {3534}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                    {3535}event endCli(Sess,Cli,Ns_3438)
                                )
                                else
                                    {3536}let v_3439: bool = (Sess = B) in
                                    (
                                        {3537}if v_3439 then
                                        (
                                            {3538}let pkSess_3440: bitstring = pub(skB) in
                                            {3539}out(c, GetEndpointRequest);
                                            {3540}in(c, (=GetEndpointResponse,=pkSess_3440,=None,SP_3441: bitstring,UP_3442: bitstring));
                                            {3541}new Nc_3443: bitstring;
                                            {3542}let wNc_3444: bitstring = enc(Nc_3443,pkSess_3440) in
                                            {3543}let m1_3445: bitstring = (OpenSecureChannelRequest,pkCli_2981,wNc_3444) in
                                            {3544}event beginCli(Cli,Sess,Nc_3443);
                                            {3545}out(c, (pkCli_2981,m1_3445));
                                            {3546}in(c, em2_3446: bitstring);
                                            {3547}let m2_3447: bitstring = em2_3446 in
                                            {3548}let (=OpenSecureChannelResponse,wNs_3448: bitstring,ST_3449: bitstring,TTL_3450: bitstring) = m2_3447 in
                                            {3549}let Ns_3451: bitstring = dec(wNs_3448,skCli_2980) in
                                            {3550}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {3551}event endCli(Sess,Cli,Ns_3451)
                                        )
                                        else
                                            {3552}let v_3452: bool = (Sess = C) in
                                            (
                                                {3553}if v_3452 then
                                                (
                                                    {3554}let pkSess_3453: bitstring = pub(skC) in
                                                    {3555}out(c, GetEndpointRequest);
                                                    {3556}in(c, (=GetEndpointResponse,=pkSess_3453,=None,SP_3454: bitstring,UP_3455: bitstring));
                                                    {3557}new Nc_3456: bitstring;
                                                    {3558}let wNc_3457: bitstring = enc(Nc_3456,pkSess_3453) in
                                                    {3559}let m1_3458: bitstring = (OpenSecureChannelRequest,pkCli_2981,wNc_3457) in
                                                    {3560}event beginCli(Cli,Sess,Nc_3456);
                                                    {3561}out(c, (pkCli_2981,m1_3458));
                                                    {3562}in(c, em2_3459: bitstring);
                                                    {3563}let m2_3460: bitstring = em2_3459 in
                                                    {3564}let (=OpenSecureChannelResponse,wNs_3461: bitstring,ST_3462: bitstring,TTL_3463: bitstring) = m2_3460 in
                                                    {3565}let Ns_3464: bitstring = dec(wNs_3461,skCli_2980) in
                                                    {3566}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {3567}event endCli(Sess,Cli,Ns_3464)
                                                )
                                                else
                                                    {3568}let pkSess_3465: bitstring = pub(sk(Sess)) in
                                                    {3569}out(c, GetEndpointRequest);
                                                    {3570}in(c, (=GetEndpointResponse,=pkSess_3465,=None,SP_3466: bitstring,UP_3467: bitstring));
                                                    {3571}new Nc_3468: bitstring;
                                                    {3572}let wNc_3469: bitstring = enc(Nc_3468,pkSess_3465) in
                                                    {3573}let m1_3470: bitstring = (OpenSecureChannelRequest,pkCli_2981,wNc_3469) in
                                                    {3574}event beginCli(Cli,Sess,Nc_3468);
                                                    {3575}out(c, (pkCli_2981,m1_3470));
                                                    {3576}in(c, em2_3471: bitstring);
                                                    {3577}let m2_3472: bitstring = em2_3471 in
                                                    {3578}let (=OpenSecureChannelResponse,wNs_3473: bitstring,ST_3474: bitstring,TTL_3475: bitstring) = m2_3472 in
                                                    {3579}let Ns_3476: bitstring = dec(wNs_3473,skCli_2980) in
                                                    {3580}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {3581}event endCli(Sess,Cli,Ns_3476)
                                            )
                                            else
                                                {3582}let pkSess_3477: bitstring = fail-any in
                                                {3583}out(c, GetEndpointRequest);
                                                {3584}in(c, (=GetEndpointResponse,=pkSess_3477,=None,SP_3478: bitstring,UP_3479: bitstring));
                                                {3585}new Nc_3480: bitstring;
                                                {3586}let wNc_3481: bitstring = enc(Nc_3480,pkSess_3477) in
                                                {3587}let m1_3482: bitstring = (OpenSecureChannelRequest,pkCli_2981,wNc_3481) in
                                                {3588}event beginCli(Cli,Sess,Nc_3480);
                                                {3589}out(c, (pkCli_2981,m1_3482));
                                                {3590}in(c, em2_3483: bitstring);
                                                {3591}let m2_3484: bitstring = em2_3483 in
                                                {3592}let (=OpenSecureChannelResponse,wNs_3485: bitstring,ST_3486: bitstring,TTL_3487: bitstring) = m2_3484 in
                                                {3593}let Ns_3488: bitstring = dec(wNs_3485,skCli_2980) in
                                                {3594}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {3595}event endCli(Sess,Cli,Ns_3488)
                                    )
                                    else
                                        {3596}let pkSess_3489: bitstring = fail-any in
                                        {3597}out(c, GetEndpointRequest);
                                        {3598}in(c, (=GetEndpointResponse,=pkSess_3489,=None,SP_3490: bitstring,UP_3491: bitstring));
                                        {3599}new Nc_3492: bitstring;
                                        {3600}let wNc_3493: bitstring = enc(Nc_3492,pkSess_3489) in
                                        {3601}let m1_3494: bitstring = (OpenSecureChannelRequest,pkCli_2981,wNc_3493) in
                                        {3602}event beginCli(Cli,Sess,Nc_3492);
                                        {3603}out(c, (pkCli_2981,m1_3494));
                                        {3604}in(c, em2_3495: bitstring);
                                        {3605}let m2_3496: bitstring = em2_3495 in
                                        {3606}let (=OpenSecureChannelResponse,wNs_3497: bitstring,ST_3498: bitstring,TTL_3499: bitstring) = m2_3496 in
                                        {3607}let Ns_3500: bitstring = dec(wNs_3497,skCli_2980) in
                                        {3608}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                        {3609}event endCli(Sess,Cli,Ns_3500)
                            )
                            else
                                {3610}let pkSess_3501: bitstring = fail-any in
                                {3611}out(c, GetEndpointRequest);
                                {3612}in(c, (=GetEndpointResponse,=pkSess_3501,=None,SP_3502: bitstring,UP_3503: bitstring));
                                {3613}new Nc_3504: bitstring;
                                {3614}let wNc_3505: bitstring = enc(Nc_3504,pkSess_3501) in
                                {3615}let m1_3506: bitstring = (OpenSecureChannelRequest,pkCli_2981,wNc_3505) in
                                {3616}event beginCli(Cli,Sess,Nc_3504);
                                {3617}out(c, (pkCli_2981,m1_3506));
                                {3618}in(c, em2_3507: bitstring);
                                {3619}let m2_3508: bitstring = em2_3507 in
                                {3620}let (=OpenSecureChannelResponse,wNs_3509: bitstring,ST_3510: bitstring,TTL_3511: bitstring) = m2_3508 in
                                {3621}let Ns_3512: bitstring = dec(wNs_3509,skCli_2980) in
                                {3622}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                {3623}event endCli(Sess,Cli,Ns_3512)
                )
                else
                    {3624}let pkDisco_3513: bitstring = fail-any in
                    {3625}let v_3514: bool = (Sess = A) in
                    (
                        {3626}if v_3514 then
                        (
                            {3627}let pkSess_3515: bitstring = pub(skA) in
                            {3628}out(c, GetEndpointRequest);
                            {3629}in(c, (=GetEndpointResponse,=pkSess_3515,=None,SP_3516: bitstring,UP_3517: bitstring));
                            {3630}new Nc_3518: bitstring;
                            {3631}let wNc_3519: bitstring = enc(Nc_3518,pkSess_3515) in
                            {3632}let m1_3520: bitstring = (OpenSecureChannelRequest,pkCli_2981,wNc_3519) in
                            {3633}event beginCli(Cli,Sess,Nc_3518);
                            {3634}out(c, (pkCli_2981,m1_3520));
                            {3635}in(c, em2_3521: bitstring);
                            {3636}let m2_3522: bitstring = em2_3521 in
                            {3637}let (=OpenSecureChannelResponse,wNs_3523: bitstring,ST_3524: bitstring,TTL_3525: bitstring) = m2_3522 in
                            {3638}let Ns_3526: bitstring = dec(wNs_3523,skCli_2980) in
                            {3639}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                            {3640}event endCli(Sess,Cli,Ns_3526)
                        )
                        else
                            {3641}let v_3527: bool = (Sess = B) in
                            (
                                {3642}if v_3527 then
                                (
                                    {3643}let pkSess_3528: bitstring = pub(skB) in
                                    {3644}out(c, GetEndpointRequest);
                                    {3645}in(c, (=GetEndpointResponse,=pkSess_3528,=None,SP_3529: bitstring,UP_3530: bitstring));
                                    {3646}new Nc_3531: bitstring;
                                    {3647}let wNc_3532: bitstring = enc(Nc_3531,pkSess_3528) in
                                    {3648}let m1_3533: bitstring = (OpenSecureChannelRequest,pkCli_2981,wNc_3532) in
                                    {3649}event beginCli(Cli,Sess,Nc_3531);
                                    {3650}out(c, (pkCli_2981,m1_3533));
                                    {3651}in(c, em2_3534: bitstring);
                                    {3652}let m2_3535: bitstring = em2_3534 in
                                    {3653}let (=OpenSecureChannelResponse,wNs_3536: bitstring,ST_3537: bitstring,TTL_3538: bitstring) = m2_3535 in
                                    {3654}let Ns_3539: bitstring = dec(wNs_3536,skCli_2980) in
                                    {3655}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                    {3656}event endCli(Sess,Cli,Ns_3539)
                                )
                                else
                                    {3657}let v_3540: bool = (Sess = C) in
                                    (
                                        {3658}if v_3540 then
                                        (
                                            {3659}let pkSess_3541: bitstring = pub(skC) in
                                            {3660}out(c, GetEndpointRequest);
                                            {3661}in(c, (=GetEndpointResponse,=pkSess_3541,=None,SP_3542: bitstring,UP_3543: bitstring));
                                            {3662}new Nc_3544: bitstring;
                                            {3663}let wNc_3545: bitstring = enc(Nc_3544,pkSess_3541) in
                                            {3664}let m1_3546: bitstring = (OpenSecureChannelRequest,pkCli_2981,wNc_3545) in
                                            {3665}event beginCli(Cli,Sess,Nc_3544);
                                            {3666}out(c, (pkCli_2981,m1_3546));
                                            {3667}in(c, em2_3547: bitstring);
                                            {3668}let m2_3548: bitstring = em2_3547 in
                                            {3669}let (=OpenSecureChannelResponse,wNs_3549: bitstring,ST_3550: bitstring,TTL_3551: bitstring) = m2_3548 in
                                            {3670}let Ns_3552: bitstring = dec(wNs_3549,skCli_2980) in
                                            {3671}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {3672}event endCli(Sess,Cli,Ns_3552)
                                        )
                                        else
                                            {3673}let pkSess_3553: bitstring = pub(sk(Sess)) in
                                            {3674}out(c, GetEndpointRequest);
                                            {3675}in(c, (=GetEndpointResponse,=pkSess_3553,=None,SP_3554: bitstring,UP_3555: bitstring));
                                            {3676}new Nc_3556: bitstring;
                                            {3677}let wNc_3557: bitstring = enc(Nc_3556,pkSess_3553) in
                                            {3678}let m1_3558: bitstring = (OpenSecureChannelRequest,pkCli_2981,wNc_3557) in
                                            {3679}event beginCli(Cli,Sess,Nc_3556);
                                            {3680}out(c, (pkCli_2981,m1_3558));
                                            {3681}in(c, em2_3559: bitstring);
                                            {3682}let m2_3560: bitstring = em2_3559 in
                                            {3683}let (=OpenSecureChannelResponse,wNs_3561: bitstring,ST_3562: bitstring,TTL_3563: bitstring) = m2_3560 in
                                            {3684}let Ns_3564: bitstring = dec(wNs_3561,skCli_2980) in
                                            {3685}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {3686}event endCli(Sess,Cli,Ns_3564)
                                    )
                                    else
                                        {3687}let pkSess_3565: bitstring = fail-any in
                                        {3688}out(c, GetEndpointRequest);
                                        {3689}in(c, (=GetEndpointResponse,=pkSess_3565,=None,SP_3566: bitstring,UP_3567: bitstring));
                                        {3690}new Nc_3568: bitstring;
                                        {3691}let wNc_3569: bitstring = enc(Nc_3568,pkSess_3565) in
                                        {3692}let m1_3570: bitstring = (OpenSecureChannelRequest,pkCli_2981,wNc_3569) in
                                        {3693}event beginCli(Cli,Sess,Nc_3568);
                                        {3694}out(c, (pkCli_2981,m1_3570));
                                        {3695}in(c, em2_3571: bitstring);
                                        {3696}let m2_3572: bitstring = em2_3571 in
                                        {3697}let (=OpenSecureChannelResponse,wNs_3573: bitstring,ST_3574: bitstring,TTL_3575: bitstring) = m2_3572 in
                                        {3698}let Ns_3576: bitstring = dec(wNs_3573,skCli_2980) in
                                        {3699}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                        {3700}event endCli(Sess,Cli,Ns_3576)
                            )
                            else
                                {3701}let pkSess_3577: bitstring = fail-any in
                                {3702}out(c, GetEndpointRequest);
                                {3703}in(c, (=GetEndpointResponse,=pkSess_3577,=None,SP_3578: bitstring,UP_3579: bitstring));
                                {3704}new Nc_3580: bitstring;
                                {3705}let wNc_3581: bitstring = enc(Nc_3580,pkSess_3577) in
                                {3706}let m1_3582: bitstring = (OpenSecureChannelRequest,pkCli_2981,wNc_3581) in
                                {3707}event beginCli(Cli,Sess,Nc_3580);
                                {3708}out(c, (pkCli_2981,m1_3582));
                                {3709}in(c, em2_3583: bitstring);
                                {3710}let m2_3584: bitstring = em2_3583 in
                                {3711}let (=OpenSecureChannelResponse,wNs_3585: bitstring,ST_3586: bitstring,TTL_3587: bitstring) = m2_3584 in
                                {3712}let Ns_3588: bitstring = dec(wNs_3585,skCli_2980) in
                                {3713}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                {3714}event endCli(Sess,Cli,Ns_3588)
                    )
                    else
                        {3715}let pkSess_3589: bitstring = fail-any in
                        {3716}out(c, GetEndpointRequest);
                        {3717}in(c, (=GetEndpointResponse,=pkSess_3589,=None,SP_3590: bitstring,UP_3591: bitstring));
                        {3718}new Nc_3592: bitstring;
                        {3719}let wNc_3593: bitstring = enc(Nc_3592,pkSess_3589) in
                        {3720}let m1_3594: bitstring = (OpenSecureChannelRequest,pkCli_2981,wNc_3593) in
                        {3721}event beginCli(Cli,Sess,Nc_3592);
                        {3722}out(c, (pkCli_2981,m1_3594));
                        {3723}in(c, em2_3595: bitstring);
                        {3724}let m2_3596: bitstring = em2_3595 in
                        {3725}let (=OpenSecureChannelResponse,wNs_3597: bitstring,ST_3598: bitstring,TTL_3599: bitstring) = m2_3596 in
                        {3726}let Ns_3600: bitstring = dec(wNs_3597,skCli_2980) in
                        {3727}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                        {3728}event endCli(Sess,Cli,Ns_3600)
    )
    else
        {3729}let skCli_3601: bitstring = fail-any in
        {3730}let pkCli_3602: bitstring = pub(skCli_3601) in
        {3731}let v_3603: bool = (Disco = A) in
        (
            {3732}if v_3603 then
            (
                {3733}let pkDisco_3604: bitstring = pub(skA) in
                {3734}let v_3605: bool = (Sess = A) in
                (
                    {3735}if v_3605 then
                    (
                        {3736}let pkSess_3606: bitstring = pub(skA) in
                        {3737}out(c, GetEndpointRequest);
                        {3738}in(c, (=GetEndpointResponse,=pkSess_3606,=None,SP_3607: bitstring,UP_3608: bitstring));
                        {3739}new Nc_3609: bitstring;
                        {3740}let wNc_3610: bitstring = enc(Nc_3609,pkSess_3606) in
                        {3741}let m1_3611: bitstring = (OpenSecureChannelRequest,pkCli_3602,wNc_3610) in
                        {3742}event beginCli(Cli,Sess,Nc_3609);
                        {3743}out(c, (pkCli_3602,m1_3611));
                        {3744}in(c, em2_3612: bitstring);
                        {3745}let m2_3613: bitstring = em2_3612 in
                        {3746}let (=OpenSecureChannelResponse,wNs_3614: bitstring,ST_3615: bitstring,TTL_3616: bitstring) = m2_3613 in
                        {3747}let Ns_3617: bitstring = dec(wNs_3614,skCli_3601) in
                        {3748}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                        {3749}event endCli(Sess,Cli,Ns_3617)
                    )
                    else
                        {3750}let v_3618: bool = (Sess = B) in
                        (
                            {3751}if v_3618 then
                            (
                                {3752}let pkSess_3619: bitstring = pub(skB) in
                                {3753}out(c, GetEndpointRequest);
                                {3754}in(c, (=GetEndpointResponse,=pkSess_3619,=None,SP_3620: bitstring,UP_3621: bitstring));
                                {3755}new Nc_3622: bitstring;
                                {3756}let wNc_3623: bitstring = enc(Nc_3622,pkSess_3619) in
                                {3757}let m1_3624: bitstring = (OpenSecureChannelRequest,pkCli_3602,wNc_3623) in
                                {3758}event beginCli(Cli,Sess,Nc_3622);
                                {3759}out(c, (pkCli_3602,m1_3624));
                                {3760}in(c, em2_3625: bitstring);
                                {3761}let m2_3626: bitstring = em2_3625 in
                                {3762}let (=OpenSecureChannelResponse,wNs_3627: bitstring,ST_3628: bitstring,TTL_3629: bitstring) = m2_3626 in
                                {3763}let Ns_3630: bitstring = dec(wNs_3627,skCli_3601) in
                                {3764}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                {3765}event endCli(Sess,Cli,Ns_3630)
                            )
                            else
                                {3766}let v_3631: bool = (Sess = C) in
                                (
                                    {3767}if v_3631 then
                                    (
                                        {3768}let pkSess_3632: bitstring = pub(skC) in
                                        {3769}out(c, GetEndpointRequest);
                                        {3770}in(c, (=GetEndpointResponse,=pkSess_3632,=None,SP_3633: bitstring,UP_3634: bitstring));
                                        {3771}new Nc_3635: bitstring;
                                        {3772}let wNc_3636: bitstring = enc(Nc_3635,pkSess_3632) in
                                        {3773}let m1_3637: bitstring = (OpenSecureChannelRequest,pkCli_3602,wNc_3636) in
                                        {3774}event beginCli(Cli,Sess,Nc_3635);
                                        {3775}out(c, (pkCli_3602,m1_3637));
                                        {3776}in(c, em2_3638: bitstring);
                                        {3777}let m2_3639: bitstring = em2_3638 in
                                        {3778}let (=OpenSecureChannelResponse,wNs_3640: bitstring,ST_3641: bitstring,TTL_3642: bitstring) = m2_3639 in
                                        {3779}let Ns_3643: bitstring = dec(wNs_3640,skCli_3601) in
                                        {3780}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                        {3781}event endCli(Sess,Cli,Ns_3643)
                                    )
                                    else
                                        {3782}let pkSess_3644: bitstring = pub(sk(Sess)) in
                                        {3783}out(c, GetEndpointRequest);
                                        {3784}in(c, (=GetEndpointResponse,=pkSess_3644,=None,SP_3645: bitstring,UP_3646: bitstring));
                                        {3785}new Nc_3647: bitstring;
                                        {3786}let wNc_3648: bitstring = enc(Nc_3647,pkSess_3644) in
                                        {3787}let m1_3649: bitstring = (OpenSecureChannelRequest,pkCli_3602,wNc_3648) in
                                        {3788}event beginCli(Cli,Sess,Nc_3647);
                                        {3789}out(c, (pkCli_3602,m1_3649));
                                        {3790}in(c, em2_3650: bitstring);
                                        {3791}let m2_3651: bitstring = em2_3650 in
                                        {3792}let (=OpenSecureChannelResponse,wNs_3652: bitstring,ST_3653: bitstring,TTL_3654: bitstring) = m2_3651 in
                                        {3793}let Ns_3655: bitstring = dec(wNs_3652,skCli_3601) in
                                        {3794}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                        {3795}event endCli(Sess,Cli,Ns_3655)
                                )
                                else
                                    {3796}let pkSess_3656: bitstring = fail-any in
                                    {3797}out(c, GetEndpointRequest);
                                    {3798}in(c, (=GetEndpointResponse,=pkSess_3656,=None,SP_3657: bitstring,UP_3658: bitstring));
                                    {3799}new Nc_3659: bitstring;
                                    {3800}let wNc_3660: bitstring = enc(Nc_3659,pkSess_3656) in
                                    {3801}let m1_3661: bitstring = (OpenSecureChannelRequest,pkCli_3602,wNc_3660) in
                                    {3802}event beginCli(Cli,Sess,Nc_3659);
                                    {3803}out(c, (pkCli_3602,m1_3661));
                                    {3804}in(c, em2_3662: bitstring);
                                    {3805}let m2_3663: bitstring = em2_3662 in
                                    {3806}let (=OpenSecureChannelResponse,wNs_3664: bitstring,ST_3665: bitstring,TTL_3666: bitstring) = m2_3663 in
                                    {3807}let Ns_3667: bitstring = dec(wNs_3664,skCli_3601) in
                                    {3808}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                    {3809}event endCli(Sess,Cli,Ns_3667)
                        )
                        else
                            {3810}let pkSess_3668: bitstring = fail-any in
                            {3811}out(c, GetEndpointRequest);
                            {3812}in(c, (=GetEndpointResponse,=pkSess_3668,=None,SP_3669: bitstring,UP_3670: bitstring));
                            {3813}new Nc_3671: bitstring;
                            {3814}let wNc_3672: bitstring = enc(Nc_3671,pkSess_3668) in
                            {3815}let m1_3673: bitstring = (OpenSecureChannelRequest,pkCli_3602,wNc_3672) in
                            {3816}event beginCli(Cli,Sess,Nc_3671);
                            {3817}out(c, (pkCli_3602,m1_3673));
                            {3818}in(c, em2_3674: bitstring);
                            {3819}let m2_3675: bitstring = em2_3674 in
                            {3820}let (=OpenSecureChannelResponse,wNs_3676: bitstring,ST_3677: bitstring,TTL_3678: bitstring) = m2_3675 in
                            {3821}let Ns_3679: bitstring = dec(wNs_3676,skCli_3601) in
                            {3822}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                            {3823}event endCli(Sess,Cli,Ns_3679)
                )
                else
                    {3824}let pkSess_3680: bitstring = fail-any in
                    {3825}out(c, GetEndpointRequest);
                    {3826}in(c, (=GetEndpointResponse,=pkSess_3680,=None,SP_3681: bitstring,UP_3682: bitstring));
                    {3827}new Nc_3683: bitstring;
                    {3828}let wNc_3684: bitstring = enc(Nc_3683,pkSess_3680) in
                    {3829}let m1_3685: bitstring = (OpenSecureChannelRequest,pkCli_3602,wNc_3684) in
                    {3830}event beginCli(Cli,Sess,Nc_3683);
                    {3831}out(c, (pkCli_3602,m1_3685));
                    {3832}in(c, em2_3686: bitstring);
                    {3833}let m2_3687: bitstring = em2_3686 in
                    {3834}let (=OpenSecureChannelResponse,wNs_3688: bitstring,ST_3689: bitstring,TTL_3690: bitstring) = m2_3687 in
                    {3835}let Ns_3691: bitstring = dec(wNs_3688,skCli_3601) in
                    {3836}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                    {3837}event endCli(Sess,Cli,Ns_3691)
            )
            else
                {3838}let v_3692: bool = (Disco = B) in
                (
                    {3839}if v_3692 then
                    (
                        {3840}let pkDisco_3693: bitstring = pub(skB) in
                        {3841}let v_3694: bool = (Sess = A) in
                        (
                            {3842}if v_3694 then
                            (
                                {3843}let pkSess_3695: bitstring = pub(skA) in
                                {3844}out(c, GetEndpointRequest);
                                {3845}in(c, (=GetEndpointResponse,=pkSess_3695,=None,SP_3696: bitstring,UP_3697: bitstring));
                                {3846}new Nc_3698: bitstring;
                                {3847}let wNc_3699: bitstring = enc(Nc_3698,pkSess_3695) in
                                {3848}let m1_3700: bitstring = (OpenSecureChannelRequest,pkCli_3602,wNc_3699) in
                                {3849}event beginCli(Cli,Sess,Nc_3698);
                                {3850}out(c, (pkCli_3602,m1_3700));
                                {3851}in(c, em2_3701: bitstring);
                                {3852}let m2_3702: bitstring = em2_3701 in
                                {3853}let (=OpenSecureChannelResponse,wNs_3703: bitstring,ST_3704: bitstring,TTL_3705: bitstring) = m2_3702 in
                                {3854}let Ns_3706: bitstring = dec(wNs_3703,skCli_3601) in
                                {3855}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                {3856}event endCli(Sess,Cli,Ns_3706)
                            )
                            else
                                {3857}let v_3707: bool = (Sess = B) in
                                (
                                    {3858}if v_3707 then
                                    (
                                        {3859}let pkSess_3708: bitstring = pub(skB) in
                                        {3860}out(c, GetEndpointRequest);
                                        {3861}in(c, (=GetEndpointResponse,=pkSess_3708,=None,SP_3709: bitstring,UP_3710: bitstring));
                                        {3862}new Nc_3711: bitstring;
                                        {3863}let wNc_3712: bitstring = enc(Nc_3711,pkSess_3708) in
                                        {3864}let m1_3713: bitstring = (OpenSecureChannelRequest,pkCli_3602,wNc_3712) in
                                        {3865}event beginCli(Cli,Sess,Nc_3711);
                                        {3866}out(c, (pkCli_3602,m1_3713));
                                        {3867}in(c, em2_3714: bitstring);
                                        {3868}let m2_3715: bitstring = em2_3714 in
                                        {3869}let (=OpenSecureChannelResponse,wNs_3716: bitstring,ST_3717: bitstring,TTL_3718: bitstring) = m2_3715 in
                                        {3870}let Ns_3719: bitstring = dec(wNs_3716,skCli_3601) in
                                        {3871}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                        {3872}event endCli(Sess,Cli,Ns_3719)
                                    )
                                    else
                                        {3873}let v_3720: bool = (Sess = C) in
                                        (
                                            {3874}if v_3720 then
                                            (
                                                {3875}let pkSess_3721: bitstring = pub(skC) in
                                                {3876}out(c, GetEndpointRequest);
                                                {3877}in(c, (=GetEndpointResponse,=pkSess_3721,=None,SP_3722: bitstring,UP_3723: bitstring));
                                                {3878}new Nc_3724: bitstring;
                                                {3879}let wNc_3725: bitstring = enc(Nc_3724,pkSess_3721) in
                                                {3880}let m1_3726: bitstring = (OpenSecureChannelRequest,pkCli_3602,wNc_3725) in
                                                {3881}event beginCli(Cli,Sess,Nc_3724);
                                                {3882}out(c, (pkCli_3602,m1_3726));
                                                {3883}in(c, em2_3727: bitstring);
                                                {3884}let m2_3728: bitstring = em2_3727 in
                                                {3885}let (=OpenSecureChannelResponse,wNs_3729: bitstring,ST_3730: bitstring,TTL_3731: bitstring) = m2_3728 in
                                                {3886}let Ns_3732: bitstring = dec(wNs_3729,skCli_3601) in
                                                {3887}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {3888}event endCli(Sess,Cli,Ns_3732)
                                            )
                                            else
                                                {3889}let pkSess_3733: bitstring = pub(sk(Sess)) in
                                                {3890}out(c, GetEndpointRequest);
                                                {3891}in(c, (=GetEndpointResponse,=pkSess_3733,=None,SP_3734: bitstring,UP_3735: bitstring));
                                                {3892}new Nc_3736: bitstring;
                                                {3893}let wNc_3737: bitstring = enc(Nc_3736,pkSess_3733) in
                                                {3894}let m1_3738: bitstring = (OpenSecureChannelRequest,pkCli_3602,wNc_3737) in
                                                {3895}event beginCli(Cli,Sess,Nc_3736);
                                                {3896}out(c, (pkCli_3602,m1_3738));
                                                {3897}in(c, em2_3739: bitstring);
                                                {3898}let m2_3740: bitstring = em2_3739 in
                                                {3899}let (=OpenSecureChannelResponse,wNs_3741: bitstring,ST_3742: bitstring,TTL_3743: bitstring) = m2_3740 in
                                                {3900}let Ns_3744: bitstring = dec(wNs_3741,skCli_3601) in
                                                {3901}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {3902}event endCli(Sess,Cli,Ns_3744)
                                        )
                                        else
                                            {3903}let pkSess_3745: bitstring = fail-any in
                                            {3904}out(c, GetEndpointRequest);
                                            {3905}in(c, (=GetEndpointResponse,=pkSess_3745,=None,SP_3746: bitstring,UP_3747: bitstring));
                                            {3906}new Nc_3748: bitstring;
                                            {3907}let wNc_3749: bitstring = enc(Nc_3748,pkSess_3745) in
                                            {3908}let m1_3750: bitstring = (OpenSecureChannelRequest,pkCli_3602,wNc_3749) in
                                            {3909}event beginCli(Cli,Sess,Nc_3748);
                                            {3910}out(c, (pkCli_3602,m1_3750));
                                            {3911}in(c, em2_3751: bitstring);
                                            {3912}let m2_3752: bitstring = em2_3751 in
                                            {3913}let (=OpenSecureChannelResponse,wNs_3753: bitstring,ST_3754: bitstring,TTL_3755: bitstring) = m2_3752 in
                                            {3914}let Ns_3756: bitstring = dec(wNs_3753,skCli_3601) in
                                            {3915}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {3916}event endCli(Sess,Cli,Ns_3756)
                                )
                                else
                                    {3917}let pkSess_3757: bitstring = fail-any in
                                    {3918}out(c, GetEndpointRequest);
                                    {3919}in(c, (=GetEndpointResponse,=pkSess_3757,=None,SP_3758: bitstring,UP_3759: bitstring));
                                    {3920}new Nc_3760: bitstring;
                                    {3921}let wNc_3761: bitstring = enc(Nc_3760,pkSess_3757) in
                                    {3922}let m1_3762: bitstring = (OpenSecureChannelRequest,pkCli_3602,wNc_3761) in
                                    {3923}event beginCli(Cli,Sess,Nc_3760);
                                    {3924}out(c, (pkCli_3602,m1_3762));
                                    {3925}in(c, em2_3763: bitstring);
                                    {3926}let m2_3764: bitstring = em2_3763 in
                                    {3927}let (=OpenSecureChannelResponse,wNs_3765: bitstring,ST_3766: bitstring,TTL_3767: bitstring) = m2_3764 in
                                    {3928}let Ns_3768: bitstring = dec(wNs_3765,skCli_3601) in
                                    {3929}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                    {3930}event endCli(Sess,Cli,Ns_3768)
                        )
                        else
                            {3931}let pkSess_3769: bitstring = fail-any in
                            {3932}out(c, GetEndpointRequest);
                            {3933}in(c, (=GetEndpointResponse,=pkSess_3769,=None,SP_3770: bitstring,UP_3771: bitstring));
                            {3934}new Nc_3772: bitstring;
                            {3935}let wNc_3773: bitstring = enc(Nc_3772,pkSess_3769) in
                            {3936}let m1_3774: bitstring = (OpenSecureChannelRequest,pkCli_3602,wNc_3773) in
                            {3937}event beginCli(Cli,Sess,Nc_3772);
                            {3938}out(c, (pkCli_3602,m1_3774));
                            {3939}in(c, em2_3775: bitstring);
                            {3940}let m2_3776: bitstring = em2_3775 in
                            {3941}let (=OpenSecureChannelResponse,wNs_3777: bitstring,ST_3778: bitstring,TTL_3779: bitstring) = m2_3776 in
                            {3942}let Ns_3780: bitstring = dec(wNs_3777,skCli_3601) in
                            {3943}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                            {3944}event endCli(Sess,Cli,Ns_3780)
                    )
                    else
                        {3945}let v_3781: bool = (Disco = C) in
                        (
                            {3946}if v_3781 then
                            (
                                {3947}let pkDisco_3782: bitstring = pub(skC) in
                                {3948}let v_3783: bool = (Sess = A) in
                                (
                                    {3949}if v_3783 then
                                    (
                                        {3950}let pkSess_3784: bitstring = pub(skA) in
                                        {3951}out(c, GetEndpointRequest);
                                        {3952}in(c, (=GetEndpointResponse,=pkSess_3784,=None,SP_3785: bitstring,UP_3786: bitstring));
                                        {3953}new Nc_3787: bitstring;
                                        {3954}let wNc_3788: bitstring = enc(Nc_3787,pkSess_3784) in
                                        {3955}let m1_3789: bitstring = (OpenSecureChannelRequest,pkCli_3602,wNc_3788) in
                                        {3956}event beginCli(Cli,Sess,Nc_3787);
                                        {3957}out(c, (pkCli_3602,m1_3789));
                                        {3958}in(c, em2_3790: bitstring);
                                        {3959}let m2_3791: bitstring = em2_3790 in
                                        {3960}let (=OpenSecureChannelResponse,wNs_3792: bitstring,ST_3793: bitstring,TTL_3794: bitstring) = m2_3791 in
                                        {3961}let Ns_3795: bitstring = dec(wNs_3792,skCli_3601) in
                                        {3962}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                        {3963}event endCli(Sess,Cli,Ns_3795)
                                    )
                                    else
                                        {3964}let v_3796: bool = (Sess = B) in
                                        (
                                            {3965}if v_3796 then
                                            (
                                                {3966}let pkSess_3797: bitstring = pub(skB) in
                                                {3967}out(c, GetEndpointRequest);
                                                {3968}in(c, (=GetEndpointResponse,=pkSess_3797,=None,SP_3798: bitstring,UP_3799: bitstring));
                                                {3969}new Nc_3800: bitstring;
                                                {3970}let wNc_3801: bitstring = enc(Nc_3800,pkSess_3797) in
                                                {3971}let m1_3802: bitstring = (OpenSecureChannelRequest,pkCli_3602,wNc_3801) in
                                                {3972}event beginCli(Cli,Sess,Nc_3800);
                                                {3973}out(c, (pkCli_3602,m1_3802));
                                                {3974}in(c, em2_3803: bitstring);
                                                {3975}let m2_3804: bitstring = em2_3803 in
                                                {3976}let (=OpenSecureChannelResponse,wNs_3805: bitstring,ST_3806: bitstring,TTL_3807: bitstring) = m2_3804 in
                                                {3977}let Ns_3808: bitstring = dec(wNs_3805,skCli_3601) in
                                                {3978}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {3979}event endCli(Sess,Cli,Ns_3808)
                                            )
                                            else
                                                {3980}let v_3809: bool = (Sess = C) in
                                                (
                                                    {3981}if v_3809 then
                                                    (
                                                        {3982}let pkSess_3810: bitstring = pub(skC) in
                                                        {3983}out(c, GetEndpointRequest);
                                                        {3984}in(c, (=GetEndpointResponse,=pkSess_3810,=None,SP_3811: bitstring,UP_3812: bitstring));
                                                        {3985}new Nc_3813: bitstring;
                                                        {3986}let wNc_3814: bitstring = enc(Nc_3813,pkSess_3810) in
                                                        {3987}let m1_3815: bitstring = (OpenSecureChannelRequest,pkCli_3602,wNc_3814) in
                                                        {3988}event beginCli(Cli,Sess,Nc_3813);
                                                        {3989}out(c, (pkCli_3602,m1_3815));
                                                        {3990}in(c, em2_3816: bitstring);
                                                        {3991}let m2_3817: bitstring = em2_3816 in
                                                        {3992}let (=OpenSecureChannelResponse,wNs_3818: bitstring,ST_3819: bitstring,TTL_3820: bitstring) = m2_3817 in
                                                        {3993}let Ns_3821: bitstring = dec(wNs_3818,skCli_3601) in
                                                        {3994}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {3995}event endCli(Sess,Cli,Ns_3821)
                                                    )
                                                    else
                                                        {3996}let pkSess_3822: bitstring = pub(sk(Sess)) in
                                                        {3997}out(c, GetEndpointRequest);
                                                        {3998}in(c, (=GetEndpointResponse,=pkSess_3822,=None,SP_3823: bitstring,UP_3824: bitstring));
                                                        {3999}new Nc_3825: bitstring;
                                                        {4000}let wNc_3826: bitstring = enc(Nc_3825,pkSess_3822) in
                                                        {4001}let m1_3827: bitstring = (OpenSecureChannelRequest,pkCli_3602,wNc_3826) in
                                                        {4002}event beginCli(Cli,Sess,Nc_3825);
                                                        {4003}out(c, (pkCli_3602,m1_3827));
                                                        {4004}in(c, em2_3828: bitstring);
                                                        {4005}let m2_3829: bitstring = em2_3828 in
                                                        {4006}let (=OpenSecureChannelResponse,wNs_3830: bitstring,ST_3831: bitstring,TTL_3832: bitstring) = m2_3829 in
                                                        {4007}let Ns_3833: bitstring = dec(wNs_3830,skCli_3601) in
                                                        {4008}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {4009}event endCli(Sess,Cli,Ns_3833)
                                                )
                                                else
                                                    {4010}let pkSess_3834: bitstring = fail-any in
                                                    {4011}out(c, GetEndpointRequest);
                                                    {4012}in(c, (=GetEndpointResponse,=pkSess_3834,=None,SP_3835: bitstring,UP_3836: bitstring));
                                                    {4013}new Nc_3837: bitstring;
                                                    {4014}let wNc_3838: bitstring = enc(Nc_3837,pkSess_3834) in
                                                    {4015}let m1_3839: bitstring = (OpenSecureChannelRequest,pkCli_3602,wNc_3838) in
                                                    {4016}event beginCli(Cli,Sess,Nc_3837);
                                                    {4017}out(c, (pkCli_3602,m1_3839));
                                                    {4018}in(c, em2_3840: bitstring);
                                                    {4019}let m2_3841: bitstring = em2_3840 in
                                                    {4020}let (=OpenSecureChannelResponse,wNs_3842: bitstring,ST_3843: bitstring,TTL_3844: bitstring) = m2_3841 in
                                                    {4021}let Ns_3845: bitstring = dec(wNs_3842,skCli_3601) in
                                                    {4022}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {4023}event endCli(Sess,Cli,Ns_3845)
                                        )
                                        else
                                            {4024}let pkSess_3846: bitstring = fail-any in
                                            {4025}out(c, GetEndpointRequest);
                                            {4026}in(c, (=GetEndpointResponse,=pkSess_3846,=None,SP_3847: bitstring,UP_3848: bitstring));
                                            {4027}new Nc_3849: bitstring;
                                            {4028}let wNc_3850: bitstring = enc(Nc_3849,pkSess_3846) in
                                            {4029}let m1_3851: bitstring = (OpenSecureChannelRequest,pkCli_3602,wNc_3850) in
                                            {4030}event beginCli(Cli,Sess,Nc_3849);
                                            {4031}out(c, (pkCli_3602,m1_3851));
                                            {4032}in(c, em2_3852: bitstring);
                                            {4033}let m2_3853: bitstring = em2_3852 in
                                            {4034}let (=OpenSecureChannelResponse,wNs_3854: bitstring,ST_3855: bitstring,TTL_3856: bitstring) = m2_3853 in
                                            {4035}let Ns_3857: bitstring = dec(wNs_3854,skCli_3601) in
                                            {4036}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {4037}event endCli(Sess,Cli,Ns_3857)
                                )
                                else
                                    {4038}let pkSess_3858: bitstring = fail-any in
                                    {4039}out(c, GetEndpointRequest);
                                    {4040}in(c, (=GetEndpointResponse,=pkSess_3858,=None,SP_3859: bitstring,UP_3860: bitstring));
                                    {4041}new Nc_3861: bitstring;
                                    {4042}let wNc_3862: bitstring = enc(Nc_3861,pkSess_3858) in
                                    {4043}let m1_3863: bitstring = (OpenSecureChannelRequest,pkCli_3602,wNc_3862) in
                                    {4044}event beginCli(Cli,Sess,Nc_3861);
                                    {4045}out(c, (pkCli_3602,m1_3863));
                                    {4046}in(c, em2_3864: bitstring);
                                    {4047}let m2_3865: bitstring = em2_3864 in
                                    {4048}let (=OpenSecureChannelResponse,wNs_3866: bitstring,ST_3867: bitstring,TTL_3868: bitstring) = m2_3865 in
                                    {4049}let Ns_3869: bitstring = dec(wNs_3866,skCli_3601) in
                                    {4050}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                    {4051}event endCli(Sess,Cli,Ns_3869)
                            )
                            else
                                {4052}let pkDisco_3870: bitstring = pub(sk(Disco)) in
                                {4053}let v_3871: bool = (Sess = A) in
                                (
                                    {4054}if v_3871 then
                                    (
                                        {4055}let pkSess_3872: bitstring = pub(skA) in
                                        {4056}out(c, GetEndpointRequest);
                                        {4057}in(c, (=GetEndpointResponse,=pkSess_3872,=None,SP_3873: bitstring,UP_3874: bitstring));
                                        {4058}new Nc_3875: bitstring;
                                        {4059}let wNc_3876: bitstring = enc(Nc_3875,pkSess_3872) in
                                        {4060}let m1_3877: bitstring = (OpenSecureChannelRequest,pkCli_3602,wNc_3876) in
                                        {4061}event beginCli(Cli,Sess,Nc_3875);
                                        {4062}out(c, (pkCli_3602,m1_3877));
                                        {4063}in(c, em2_3878: bitstring);
                                        {4064}let m2_3879: bitstring = em2_3878 in
                                        {4065}let (=OpenSecureChannelResponse,wNs_3880: bitstring,ST_3881: bitstring,TTL_3882: bitstring) = m2_3879 in
                                        {4066}let Ns_3883: bitstring = dec(wNs_3880,skCli_3601) in
                                        {4067}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                        {4068}event endCli(Sess,Cli,Ns_3883)
                                    )
                                    else
                                        {4069}let v_3884: bool = (Sess = B) in
                                        (
                                            {4070}if v_3884 then
                                            (
                                                {4071}let pkSess_3885: bitstring = pub(skB) in
                                                {4072}out(c, GetEndpointRequest);
                                                {4073}in(c, (=GetEndpointResponse,=pkSess_3885,=None,SP_3886: bitstring,UP_3887: bitstring));
                                                {4074}new Nc_3888: bitstring;
                                                {4075}let wNc_3889: bitstring = enc(Nc_3888,pkSess_3885) in
                                                {4076}let m1_3890: bitstring = (OpenSecureChannelRequest,pkCli_3602,wNc_3889) in
                                                {4077}event beginCli(Cli,Sess,Nc_3888);
                                                {4078}out(c, (pkCli_3602,m1_3890));
                                                {4079}in(c, em2_3891: bitstring);
                                                {4080}let m2_3892: bitstring = em2_3891 in
                                                {4081}let (=OpenSecureChannelResponse,wNs_3893: bitstring,ST_3894: bitstring,TTL_3895: bitstring) = m2_3892 in
                                                {4082}let Ns_3896: bitstring = dec(wNs_3893,skCli_3601) in
                                                {4083}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {4084}event endCli(Sess,Cli,Ns_3896)
                                            )
                                            else
                                                {4085}let v_3897: bool = (Sess = C) in
                                                (
                                                    {4086}if v_3897 then
                                                    (
                                                        {4087}let pkSess_3898: bitstring = pub(skC) in
                                                        {4088}out(c, GetEndpointRequest);
                                                        {4089}in(c, (=GetEndpointResponse,=pkSess_3898,=None,SP_3899: bitstring,UP_3900: bitstring));
                                                        {4090}new Nc_3901: bitstring;
                                                        {4091}let wNc_3902: bitstring = enc(Nc_3901,pkSess_3898) in
                                                        {4092}let m1_3903: bitstring = (OpenSecureChannelRequest,pkCli_3602,wNc_3902) in
                                                        {4093}event beginCli(Cli,Sess,Nc_3901);
                                                        {4094}out(c, (pkCli_3602,m1_3903));
                                                        {4095}in(c, em2_3904: bitstring);
                                                        {4096}let m2_3905: bitstring = em2_3904 in
                                                        {4097}let (=OpenSecureChannelResponse,wNs_3906: bitstring,ST_3907: bitstring,TTL_3908: bitstring) = m2_3905 in
                                                        {4098}let Ns_3909: bitstring = dec(wNs_3906,skCli_3601) in
                                                        {4099}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {4100}event endCli(Sess,Cli,Ns_3909)
                                                    )
                                                    else
                                                        {4101}let pkSess_3910: bitstring = pub(sk(Sess)) in
                                                        {4102}out(c, GetEndpointRequest);
                                                        {4103}in(c, (=GetEndpointResponse,=pkSess_3910,=None,SP_3911: bitstring,UP_3912: bitstring));
                                                        {4104}new Nc_3913: bitstring;
                                                        {4105}let wNc_3914: bitstring = enc(Nc_3913,pkSess_3910) in
                                                        {4106}let m1_3915: bitstring = (OpenSecureChannelRequest,pkCli_3602,wNc_3914) in
                                                        {4107}event beginCli(Cli,Sess,Nc_3913);
                                                        {4108}out(c, (pkCli_3602,m1_3915));
                                                        {4109}in(c, em2_3916: bitstring);
                                                        {4110}let m2_3917: bitstring = em2_3916 in
                                                        {4111}let (=OpenSecureChannelResponse,wNs_3918: bitstring,ST_3919: bitstring,TTL_3920: bitstring) = m2_3917 in
                                                        {4112}let Ns_3921: bitstring = dec(wNs_3918,skCli_3601) in
                                                        {4113}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {4114}event endCli(Sess,Cli,Ns_3921)
                                                )
                                                else
                                                    {4115}let pkSess_3922: bitstring = fail-any in
                                                    {4116}out(c, GetEndpointRequest);
                                                    {4117}in(c, (=GetEndpointResponse,=pkSess_3922,=None,SP_3923: bitstring,UP_3924: bitstring));
                                                    {4118}new Nc_3925: bitstring;
                                                    {4119}let wNc_3926: bitstring = enc(Nc_3925,pkSess_3922) in
                                                    {4120}let m1_3927: bitstring = (OpenSecureChannelRequest,pkCli_3602,wNc_3926) in
                                                    {4121}event beginCli(Cli,Sess,Nc_3925);
                                                    {4122}out(c, (pkCli_3602,m1_3927));
                                                    {4123}in(c, em2_3928: bitstring);
                                                    {4124}let m2_3929: bitstring = em2_3928 in
                                                    {4125}let (=OpenSecureChannelResponse,wNs_3930: bitstring,ST_3931: bitstring,TTL_3932: bitstring) = m2_3929 in
                                                    {4126}let Ns_3933: bitstring = dec(wNs_3930,skCli_3601) in
                                                    {4127}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {4128}event endCli(Sess,Cli,Ns_3933)
                                        )
                                        else
                                            {4129}let pkSess_3934: bitstring = fail-any in
                                            {4130}out(c, GetEndpointRequest);
                                            {4131}in(c, (=GetEndpointResponse,=pkSess_3934,=None,SP_3935: bitstring,UP_3936: bitstring));
                                            {4132}new Nc_3937: bitstring;
                                            {4133}let wNc_3938: bitstring = enc(Nc_3937,pkSess_3934) in
                                            {4134}let m1_3939: bitstring = (OpenSecureChannelRequest,pkCli_3602,wNc_3938) in
                                            {4135}event beginCli(Cli,Sess,Nc_3937);
                                            {4136}out(c, (pkCli_3602,m1_3939));
                                            {4137}in(c, em2_3940: bitstring);
                                            {4138}let m2_3941: bitstring = em2_3940 in
                                            {4139}let (=OpenSecureChannelResponse,wNs_3942: bitstring,ST_3943: bitstring,TTL_3944: bitstring) = m2_3941 in
                                            {4140}let Ns_3945: bitstring = dec(wNs_3942,skCli_3601) in
                                            {4141}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {4142}event endCli(Sess,Cli,Ns_3945)
                                )
                                else
                                    {4143}let pkSess_3946: bitstring = fail-any in
                                    {4144}out(c, GetEndpointRequest);
                                    {4145}in(c, (=GetEndpointResponse,=pkSess_3946,=None,SP_3947: bitstring,UP_3948: bitstring));
                                    {4146}new Nc_3949: bitstring;
                                    {4147}let wNc_3950: bitstring = enc(Nc_3949,pkSess_3946) in
                                    {4148}let m1_3951: bitstring = (OpenSecureChannelRequest,pkCli_3602,wNc_3950) in
                                    {4149}event beginCli(Cli,Sess,Nc_3949);
                                    {4150}out(c, (pkCli_3602,m1_3951));
                                    {4151}in(c, em2_3952: bitstring);
                                    {4152}let m2_3953: bitstring = em2_3952 in
                                    {4153}let (=OpenSecureChannelResponse,wNs_3954: bitstring,ST_3955: bitstring,TTL_3956: bitstring) = m2_3953 in
                                    {4154}let Ns_3957: bitstring = dec(wNs_3954,skCli_3601) in
                                    {4155}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                    {4156}event endCli(Sess,Cli,Ns_3957)
                        )
                        else
                            {4157}let pkDisco_3958: bitstring = fail-any in
                            {4158}let v_3959: bool = (Sess = A) in
                            (
                                {4159}if v_3959 then
                                (
                                    {4160}let pkSess_3960: bitstring = pub(skA) in
                                    {4161}out(c, GetEndpointRequest);
                                    {4162}in(c, (=GetEndpointResponse,=pkSess_3960,=None,SP_3961: bitstring,UP_3962: bitstring));
                                    {4163}new Nc_3963: bitstring;
                                    {4164}let wNc_3964: bitstring = enc(Nc_3963,pkSess_3960) in
                                    {4165}let m1_3965: bitstring = (OpenSecureChannelRequest,pkCli_3602,wNc_3964) in
                                    {4166}event beginCli(Cli,Sess,Nc_3963);
                                    {4167}out(c, (pkCli_3602,m1_3965));
                                    {4168}in(c, em2_3966: bitstring);
                                    {4169}let m2_3967: bitstring = em2_3966 in
                                    {4170}let (=OpenSecureChannelResponse,wNs_3968: bitstring,ST_3969: bitstring,TTL_3970: bitstring) = m2_3967 in
                                    {4171}let Ns_3971: bitstring = dec(wNs_3968,skCli_3601) in
                                    {4172}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                    {4173}event endCli(Sess,Cli,Ns_3971)
                                )
                                else
                                    {4174}let v_3972: bool = (Sess = B) in
                                    (
                                        {4175}if v_3972 then
                                        (
                                            {4176}let pkSess_3973: bitstring = pub(skB) in
                                            {4177}out(c, GetEndpointRequest);
                                            {4178}in(c, (=GetEndpointResponse,=pkSess_3973,=None,SP_3974: bitstring,UP_3975: bitstring));
                                            {4179}new Nc_3976: bitstring;
                                            {4180}let wNc_3977: bitstring = enc(Nc_3976,pkSess_3973) in
                                            {4181}let m1_3978: bitstring = (OpenSecureChannelRequest,pkCli_3602,wNc_3977) in
                                            {4182}event beginCli(Cli,Sess,Nc_3976);
                                            {4183}out(c, (pkCli_3602,m1_3978));
                                            {4184}in(c, em2_3979: bitstring);
                                            {4185}let m2_3980: bitstring = em2_3979 in
                                            {4186}let (=OpenSecureChannelResponse,wNs_3981: bitstring,ST_3982: bitstring,TTL_3983: bitstring) = m2_3980 in
                                            {4187}let Ns_3984: bitstring = dec(wNs_3981,skCli_3601) in
                                            {4188}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {4189}event endCli(Sess,Cli,Ns_3984)
                                        )
                                        else
                                            {4190}let v_3985: bool = (Sess = C) in
                                            (
                                                {4191}if v_3985 then
                                                (
                                                    {4192}let pkSess_3986: bitstring = pub(skC) in
                                                    {4193}out(c, GetEndpointRequest);
                                                    {4194}in(c, (=GetEndpointResponse,=pkSess_3986,=None,SP_3987: bitstring,UP_3988: bitstring));
                                                    {4195}new Nc_3989: bitstring;
                                                    {4196}let wNc_3990: bitstring = enc(Nc_3989,pkSess_3986) in
                                                    {4197}let m1_3991: bitstring = (OpenSecureChannelRequest,pkCli_3602,wNc_3990) in
                                                    {4198}event beginCli(Cli,Sess,Nc_3989);
                                                    {4199}out(c, (pkCli_3602,m1_3991));
                                                    {4200}in(c, em2_3992: bitstring);
                                                    {4201}let m2_3993: bitstring = em2_3992 in
                                                    {4202}let (=OpenSecureChannelResponse,wNs_3994: bitstring,ST_3995: bitstring,TTL_3996: bitstring) = m2_3993 in
                                                    {4203}let Ns_3997: bitstring = dec(wNs_3994,skCli_3601) in
                                                    {4204}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {4205}event endCli(Sess,Cli,Ns_3997)
                                                )
                                                else
                                                    {4206}let pkSess_3998: bitstring = pub(sk(Sess)) in
                                                    {4207}out(c, GetEndpointRequest);
                                                    {4208}in(c, (=GetEndpointResponse,=pkSess_3998,=None,SP_3999: bitstring,UP_4000: bitstring));
                                                    {4209}new Nc_4001: bitstring;
                                                    {4210}let wNc_4002: bitstring = enc(Nc_4001,pkSess_3998) in
                                                    {4211}let m1_4003: bitstring = (OpenSecureChannelRequest,pkCli_3602,wNc_4002) in
                                                    {4212}event beginCli(Cli,Sess,Nc_4001);
                                                    {4213}out(c, (pkCli_3602,m1_4003));
                                                    {4214}in(c, em2_4004: bitstring);
                                                    {4215}let m2_4005: bitstring = em2_4004 in
                                                    {4216}let (=OpenSecureChannelResponse,wNs_4006: bitstring,ST_4007: bitstring,TTL_4008: bitstring) = m2_4005 in
                                                    {4217}let Ns_4009: bitstring = dec(wNs_4006,skCli_3601) in
                                                    {4218}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {4219}event endCli(Sess,Cli,Ns_4009)
                                            )
                                            else
                                                {4220}let pkSess_4010: bitstring = fail-any in
                                                {4221}out(c, GetEndpointRequest);
                                                {4222}in(c, (=GetEndpointResponse,=pkSess_4010,=None,SP_4011: bitstring,UP_4012: bitstring));
                                                {4223}new Nc_4013: bitstring;
                                                {4224}let wNc_4014: bitstring = enc(Nc_4013,pkSess_4010) in
                                                {4225}let m1_4015: bitstring = (OpenSecureChannelRequest,pkCli_3602,wNc_4014) in
                                                {4226}event beginCli(Cli,Sess,Nc_4013);
                                                {4227}out(c, (pkCli_3602,m1_4015));
                                                {4228}in(c, em2_4016: bitstring);
                                                {4229}let m2_4017: bitstring = em2_4016 in
                                                {4230}let (=OpenSecureChannelResponse,wNs_4018: bitstring,ST_4019: bitstring,TTL_4020: bitstring) = m2_4017 in
                                                {4231}let Ns_4021: bitstring = dec(wNs_4018,skCli_3601) in
                                                {4232}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {4233}event endCli(Sess,Cli,Ns_4021)
                                    )
                                    else
                                        {4234}let pkSess_4022: bitstring = fail-any in
                                        {4235}out(c, GetEndpointRequest);
                                        {4236}in(c, (=GetEndpointResponse,=pkSess_4022,=None,SP_4023: bitstring,UP_4024: bitstring));
                                        {4237}new Nc_4025: bitstring;
                                        {4238}let wNc_4026: bitstring = enc(Nc_4025,pkSess_4022) in
                                        {4239}let m1_4027: bitstring = (OpenSecureChannelRequest,pkCli_3602,wNc_4026) in
                                        {4240}event beginCli(Cli,Sess,Nc_4025);
                                        {4241}out(c, (pkCli_3602,m1_4027));
                                        {4242}in(c, em2_4028: bitstring);
                                        {4243}let m2_4029: bitstring = em2_4028 in
                                        {4244}let (=OpenSecureChannelResponse,wNs_4030: bitstring,ST_4031: bitstring,TTL_4032: bitstring) = m2_4029 in
                                        {4245}let Ns_4033: bitstring = dec(wNs_4030,skCli_3601) in
                                        {4246}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                        {4247}event endCli(Sess,Cli,Ns_4033)
                            )
                            else
                                {4248}let pkSess_4034: bitstring = fail-any in
                                {4249}out(c, GetEndpointRequest);
                                {4250}in(c, (=GetEndpointResponse,=pkSess_4034,=None,SP_4035: bitstring,UP_4036: bitstring));
                                {4251}new Nc_4037: bitstring;
                                {4252}let wNc_4038: bitstring = enc(Nc_4037,pkSess_4034) in
                                {4253}let m1_4039: bitstring = (OpenSecureChannelRequest,pkCli_3602,wNc_4038) in
                                {4254}event beginCli(Cli,Sess,Nc_4037);
                                {4255}out(c, (pkCli_3602,m1_4039));
                                {4256}in(c, em2_4040: bitstring);
                                {4257}let m2_4041: bitstring = em2_4040 in
                                {4258}let (=OpenSecureChannelResponse,wNs_4042: bitstring,ST_4043: bitstring,TTL_4044: bitstring) = m2_4041 in
                                {4259}let Ns_4045: bitstring = dec(wNs_4042,skCli_3601) in
                                {4260}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                {4261}event endCli(Sess,Cli,Ns_4045)
                )
                else
                    {4262}let pkDisco_4046: bitstring = fail-any in
                    {4263}let v_4047: bool = (Sess = A) in
                    (
                        {4264}if v_4047 then
                        (
                            {4265}let pkSess_4048: bitstring = pub(skA) in
                            {4266}out(c, GetEndpointRequest);
                            {4267}in(c, (=GetEndpointResponse,=pkSess_4048,=None,SP_4049: bitstring,UP_4050: bitstring));
                            {4268}new Nc_4051: bitstring;
                            {4269}let wNc_4052: bitstring = enc(Nc_4051,pkSess_4048) in
                            {4270}let m1_4053: bitstring = (OpenSecureChannelRequest,pkCli_3602,wNc_4052) in
                            {4271}event beginCli(Cli,Sess,Nc_4051);
                            {4272}out(c, (pkCli_3602,m1_4053));
                            {4273}in(c, em2_4054: bitstring);
                            {4274}let m2_4055: bitstring = em2_4054 in
                            {4275}let (=OpenSecureChannelResponse,wNs_4056: bitstring,ST_4057: bitstring,TTL_4058: bitstring) = m2_4055 in
                            {4276}let Ns_4059: bitstring = dec(wNs_4056,skCli_3601) in
                            {4277}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                            {4278}event endCli(Sess,Cli,Ns_4059)
                        )
                        else
                            {4279}let v_4060: bool = (Sess = B) in
                            (
                                {4280}if v_4060 then
                                (
                                    {4281}let pkSess_4061: bitstring = pub(skB) in
                                    {4282}out(c, GetEndpointRequest);
                                    {4283}in(c, (=GetEndpointResponse,=pkSess_4061,=None,SP_4062: bitstring,UP_4063: bitstring));
                                    {4284}new Nc_4064: bitstring;
                                    {4285}let wNc_4065: bitstring = enc(Nc_4064,pkSess_4061) in
                                    {4286}let m1_4066: bitstring = (OpenSecureChannelRequest,pkCli_3602,wNc_4065) in
                                    {4287}event beginCli(Cli,Sess,Nc_4064);
                                    {4288}out(c, (pkCli_3602,m1_4066));
                                    {4289}in(c, em2_4067: bitstring);
                                    {4290}let m2_4068: bitstring = em2_4067 in
                                    {4291}let (=OpenSecureChannelResponse,wNs_4069: bitstring,ST_4070: bitstring,TTL_4071: bitstring) = m2_4068 in
                                    {4292}let Ns_4072: bitstring = dec(wNs_4069,skCli_3601) in
                                    {4293}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                    {4294}event endCli(Sess,Cli,Ns_4072)
                                )
                                else
                                    {4295}let v_4073: bool = (Sess = C) in
                                    (
                                        {4296}if v_4073 then
                                        (
                                            {4297}let pkSess_4074: bitstring = pub(skC) in
                                            {4298}out(c, GetEndpointRequest);
                                            {4299}in(c, (=GetEndpointResponse,=pkSess_4074,=None,SP_4075: bitstring,UP_4076: bitstring));
                                            {4300}new Nc_4077: bitstring;
                                            {4301}let wNc_4078: bitstring = enc(Nc_4077,pkSess_4074) in
                                            {4302}let m1_4079: bitstring = (OpenSecureChannelRequest,pkCli_3602,wNc_4078) in
                                            {4303}event beginCli(Cli,Sess,Nc_4077);
                                            {4304}out(c, (pkCli_3602,m1_4079));
                                            {4305}in(c, em2_4080: bitstring);
                                            {4306}let m2_4081: bitstring = em2_4080 in
                                            {4307}let (=OpenSecureChannelResponse,wNs_4082: bitstring,ST_4083: bitstring,TTL_4084: bitstring) = m2_4081 in
                                            {4308}let Ns_4085: bitstring = dec(wNs_4082,skCli_3601) in
                                            {4309}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {4310}event endCli(Sess,Cli,Ns_4085)
                                        )
                                        else
                                            {4311}let pkSess_4086: bitstring = pub(sk(Sess)) in
                                            {4312}out(c, GetEndpointRequest);
                                            {4313}in(c, (=GetEndpointResponse,=pkSess_4086,=None,SP_4087: bitstring,UP_4088: bitstring));
                                            {4314}new Nc_4089: bitstring;
                                            {4315}let wNc_4090: bitstring = enc(Nc_4089,pkSess_4086) in
                                            {4316}let m1_4091: bitstring = (OpenSecureChannelRequest,pkCli_3602,wNc_4090) in
                                            {4317}event beginCli(Cli,Sess,Nc_4089);
                                            {4318}out(c, (pkCli_3602,m1_4091));
                                            {4319}in(c, em2_4092: bitstring);
                                            {4320}let m2_4093: bitstring = em2_4092 in
                                            {4321}let (=OpenSecureChannelResponse,wNs_4094: bitstring,ST_4095: bitstring,TTL_4096: bitstring) = m2_4093 in
                                            {4322}let Ns_4097: bitstring = dec(wNs_4094,skCli_3601) in
                                            {4323}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {4324}event endCli(Sess,Cli,Ns_4097)
                                    )
                                    else
                                        {4325}let pkSess_4098: bitstring = fail-any in
                                        {4326}out(c, GetEndpointRequest);
                                        {4327}in(c, (=GetEndpointResponse,=pkSess_4098,=None,SP_4099: bitstring,UP_4100: bitstring));
                                        {4328}new Nc_4101: bitstring;
                                        {4329}let wNc_4102: bitstring = enc(Nc_4101,pkSess_4098) in
                                        {4330}let m1_4103: bitstring = (OpenSecureChannelRequest,pkCli_3602,wNc_4102) in
                                        {4331}event beginCli(Cli,Sess,Nc_4101);
                                        {4332}out(c, (pkCli_3602,m1_4103));
                                        {4333}in(c, em2_4104: bitstring);
                                        {4334}let m2_4105: bitstring = em2_4104 in
                                        {4335}let (=OpenSecureChannelResponse,wNs_4106: bitstring,ST_4107: bitstring,TTL_4108: bitstring) = m2_4105 in
                                        {4336}let Ns_4109: bitstring = dec(wNs_4106,skCli_3601) in
                                        {4337}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                        {4338}event endCli(Sess,Cli,Ns_4109)
                            )
                            else
                                {4339}let pkSess_4110: bitstring = fail-any in
                                {4340}out(c, GetEndpointRequest);
                                {4341}in(c, (=GetEndpointResponse,=pkSess_4110,=None,SP_4111: bitstring,UP_4112: bitstring));
                                {4342}new Nc_4113: bitstring;
                                {4343}let wNc_4114: bitstring = enc(Nc_4113,pkSess_4110) in
                                {4344}let m1_4115: bitstring = (OpenSecureChannelRequest,pkCli_3602,wNc_4114) in
                                {4345}event beginCli(Cli,Sess,Nc_4113);
                                {4346}out(c, (pkCli_3602,m1_4115));
                                {4347}in(c, em2_4116: bitstring);
                                {4348}let m2_4117: bitstring = em2_4116 in
                                {4349}let (=OpenSecureChannelResponse,wNs_4118: bitstring,ST_4119: bitstring,TTL_4120: bitstring) = m2_4117 in
                                {4350}let Ns_4121: bitstring = dec(wNs_4118,skCli_3601) in
                                {4351}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                {4352}event endCli(Sess,Cli,Ns_4121)
                    )
                    else
                        {4353}let pkSess_4122: bitstring = fail-any in
                        {4354}out(c, GetEndpointRequest);
                        {4355}in(c, (=GetEndpointResponse,=pkSess_4122,=None,SP_4123: bitstring,UP_4124: bitstring));
                        {4356}new Nc_4125: bitstring;
                        {4357}let wNc_4126: bitstring = enc(Nc_4125,pkSess_4122) in
                        {4358}let m1_4127: bitstring = (OpenSecureChannelRequest,pkCli_3602,wNc_4126) in
                        {4359}event beginCli(Cli,Sess,Nc_4125);
                        {4360}out(c, (pkCli_3602,m1_4127));
                        {4361}in(c, em2_4128: bitstring);
                        {4362}let m2_4129: bitstring = em2_4128 in
                        {4363}let (=OpenSecureChannelResponse,wNs_4130: bitstring,ST_4131: bitstring,TTL_4132: bitstring) = m2_4129 in
                        {4364}let Ns_4133: bitstring = dec(wNs_4130,skCli_3601) in
                        {4365}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                        {4366}event endCli(Sess,Cli,Ns_4133)
        )
        else
            {4367}let pkDisco_4134: bitstring = fail-any in
            {4368}let v_4135: bool = (Sess = A) in
            (
                {4369}if v_4135 then
                (
                    {4370}let pkSess_4136: bitstring = pub(skA) in
                    {4371}out(c, GetEndpointRequest);
                    {4372}in(c, (=GetEndpointResponse,=pkSess_4136,=None,SP_4137: bitstring,UP_4138: bitstring));
                    {4373}new Nc_4139: bitstring;
                    {4374}let wNc_4140: bitstring = enc(Nc_4139,pkSess_4136) in
                    {4375}let m1_4141: bitstring = (OpenSecureChannelRequest,pkCli_3602,wNc_4140) in
                    {4376}event beginCli(Cli,Sess,Nc_4139);
                    {4377}out(c, (pkCli_3602,m1_4141));
                    {4378}in(c, em2_4142: bitstring);
                    {4379}let m2_4143: bitstring = em2_4142 in
                    {4380}let (=OpenSecureChannelResponse,wNs_4144: bitstring,ST_4145: bitstring,TTL_4146: bitstring) = m2_4143 in
                    {4381}let Ns_4147: bitstring = dec(wNs_4144,skCli_3601) in
                    {4382}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                    {4383}event endCli(Sess,Cli,Ns_4147)
                )
                else
                    {4384}let v_4148: bool = (Sess = B) in
                    (
                        {4385}if v_4148 then
                        (
                            {4386}let pkSess_4149: bitstring = pub(skB) in
                            {4387}out(c, GetEndpointRequest);
                            {4388}in(c, (=GetEndpointResponse,=pkSess_4149,=None,SP_4150: bitstring,UP_4151: bitstring));
                            {4389}new Nc_4152: bitstring;
                            {4390}let wNc_4153: bitstring = enc(Nc_4152,pkSess_4149) in
                            {4391}let m1_4154: bitstring = (OpenSecureChannelRequest,pkCli_3602,wNc_4153) in
                            {4392}event beginCli(Cli,Sess,Nc_4152);
                            {4393}out(c, (pkCli_3602,m1_4154));
                            {4394}in(c, em2_4155: bitstring);
                            {4395}let m2_4156: bitstring = em2_4155 in
                            {4396}let (=OpenSecureChannelResponse,wNs_4157: bitstring,ST_4158: bitstring,TTL_4159: bitstring) = m2_4156 in
                            {4397}let Ns_4160: bitstring = dec(wNs_4157,skCli_3601) in
                            {4398}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                            {4399}event endCli(Sess,Cli,Ns_4160)
                        )
                        else
                            {4400}let v_4161: bool = (Sess = C) in
                            (
                                {4401}if v_4161 then
                                (
                                    {4402}let pkSess_4162: bitstring = pub(skC) in
                                    {4403}out(c, GetEndpointRequest);
                                    {4404}in(c, (=GetEndpointResponse,=pkSess_4162,=None,SP_4163: bitstring,UP_4164: bitstring));
                                    {4405}new Nc_4165: bitstring;
                                    {4406}let wNc_4166: bitstring = enc(Nc_4165,pkSess_4162) in
                                    {4407}let m1_4167: bitstring = (OpenSecureChannelRequest,pkCli_3602,wNc_4166) in
                                    {4408}event beginCli(Cli,Sess,Nc_4165);
                                    {4409}out(c, (pkCli_3602,m1_4167));
                                    {4410}in(c, em2_4168: bitstring);
                                    {4411}let m2_4169: bitstring = em2_4168 in
                                    {4412}let (=OpenSecureChannelResponse,wNs_4170: bitstring,ST_4171: bitstring,TTL_4172: bitstring) = m2_4169 in
                                    {4413}let Ns_4173: bitstring = dec(wNs_4170,skCli_3601) in
                                    {4414}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                    {4415}event endCli(Sess,Cli,Ns_4173)
                                )
                                else
                                    {4416}let pkSess_4174: bitstring = pub(sk(Sess)) in
                                    {4417}out(c, GetEndpointRequest);
                                    {4418}in(c, (=GetEndpointResponse,=pkSess_4174,=None,SP_4175: bitstring,UP_4176: bitstring));
                                    {4419}new Nc_4177: bitstring;
                                    {4420}let wNc_4178: bitstring = enc(Nc_4177,pkSess_4174) in
                                    {4421}let m1_4179: bitstring = (OpenSecureChannelRequest,pkCli_3602,wNc_4178) in
                                    {4422}event beginCli(Cli,Sess,Nc_4177);
                                    {4423}out(c, (pkCli_3602,m1_4179));
                                    {4424}in(c, em2_4180: bitstring);
                                    {4425}let m2_4181: bitstring = em2_4180 in
                                    {4426}let (=OpenSecureChannelResponse,wNs_4182: bitstring,ST_4183: bitstring,TTL_4184: bitstring) = m2_4181 in
                                    {4427}let Ns_4185: bitstring = dec(wNs_4182,skCli_3601) in
                                    {4428}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                    {4429}event endCli(Sess,Cli,Ns_4185)
                            )
                            else
                                {4430}let pkSess_4186: bitstring = fail-any in
                                {4431}out(c, GetEndpointRequest);
                                {4432}in(c, (=GetEndpointResponse,=pkSess_4186,=None,SP_4187: bitstring,UP_4188: bitstring));
                                {4433}new Nc_4189: bitstring;
                                {4434}let wNc_4190: bitstring = enc(Nc_4189,pkSess_4186) in
                                {4435}let m1_4191: bitstring = (OpenSecureChannelRequest,pkCli_3602,wNc_4190) in
                                {4436}event beginCli(Cli,Sess,Nc_4189);
                                {4437}out(c, (pkCli_3602,m1_4191));
                                {4438}in(c, em2_4192: bitstring);
                                {4439}let m2_4193: bitstring = em2_4192 in
                                {4440}let (=OpenSecureChannelResponse,wNs_4194: bitstring,ST_4195: bitstring,TTL_4196: bitstring) = m2_4193 in
                                {4441}let Ns_4197: bitstring = dec(wNs_4194,skCli_3601) in
                                {4442}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                {4443}event endCli(Sess,Cli,Ns_4197)
                    )
                    else
                        {4444}let pkSess_4198: bitstring = fail-any in
                        {4445}out(c, GetEndpointRequest);
                        {4446}in(c, (=GetEndpointResponse,=pkSess_4198,=None,SP_4199: bitstring,UP_4200: bitstring));
                        {4447}new Nc_4201: bitstring;
                        {4448}let wNc_4202: bitstring = enc(Nc_4201,pkSess_4198) in
                        {4449}let m1_4203: bitstring = (OpenSecureChannelRequest,pkCli_3602,wNc_4202) in
                        {4450}event beginCli(Cli,Sess,Nc_4201);
                        {4451}out(c, (pkCli_3602,m1_4203));
                        {4452}in(c, em2_4204: bitstring);
                        {4453}let m2_4205: bitstring = em2_4204 in
                        {4454}let (=OpenSecureChannelResponse,wNs_4206: bitstring,ST_4207: bitstring,TTL_4208: bitstring) = m2_4205 in
                        {4455}let Ns_4209: bitstring = dec(wNs_4206,skCli_3601) in
                        {4456}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                        {4457}event endCli(Sess,Cli,Ns_4209)
            )
            else
                {4458}let pkSess_4210: bitstring = fail-any in
                {4459}out(c, GetEndpointRequest);
                {4460}in(c, (=GetEndpointResponse,=pkSess_4210,=None,SP_4211: bitstring,UP_4212: bitstring));
                {4461}new Nc_4213: bitstring;
                {4462}let wNc_4214: bitstring = enc(Nc_4213,pkSess_4210) in
                {4463}let m1_4215: bitstring = (OpenSecureChannelRequest,pkCli_3602,wNc_4214) in
                {4464}event beginCli(Cli,Sess,Nc_4213);
                {4465}out(c, (pkCli_3602,m1_4215));
                {4466}in(c, em2_4216: bitstring);
                {4467}let m2_4217: bitstring = em2_4216 in
                {4468}let (=OpenSecureChannelResponse,wNs_4218: bitstring,ST_4219: bitstring,TTL_4220: bitstring) = m2_4217 in
                {4469}let Ns_4221: bitstring = dec(wNs_4218,skCli_3601) in
                {4470}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                {4471}event endCli(Sess,Cli,Ns_4221)
) | (
    {4472}!
    {4473}in(c, (Cli_4222: host,Disco_4223: host,Sess_4224: host));
    {4474}let v_4225: bool = (Disco_4223 = A) in
    (
        {4475}if v_4225 then
        (
            {4476}let skDisco: bitstring = skA in
            {4477}let pkDisco_4226: bitstring = pub(skDisco) in
            {4478}let v_4227: bool = (Cli_4222 = A) in
            (
                {4479}if v_4227 then
                (
                    {4480}let pkCli_4228: bitstring = pub(skA) in
                    {4481}let v_4229: bool = (Sess_4224 = A) in
                    (
                        {4482}if v_4229 then
                        (
                            {4483}let pkSess_4230: bitstring = pub(skA) in
                            {4484}in(c, =GetEndpointRequest);
                            {4485}new SP_4231: bitstring;
                            {4486}new UP_4232: bitstring;
                            {4487}out(c, (GetEndpointResponse,pkSess_4230,None,SP_4231,UP_4232))
                        )
                        else
                            {4488}let v_4233: bool = (Sess_4224 = B) in
                            (
                                {4489}if v_4233 then
                                (
                                    {4490}let pkSess_4234: bitstring = pub(skB) in
                                    {4491}in(c, =GetEndpointRequest);
                                    {4492}new SP_4235: bitstring;
                                    {4493}new UP_4236: bitstring;
                                    {4494}out(c, (GetEndpointResponse,pkSess_4234,None,SP_4235,UP_4236))
                                )
                                else
                                    {4495}let v_4237: bool = (Sess_4224 = C) in
                                    (
                                        {4496}if v_4237 then
                                        (
                                            {4497}let pkSess_4238: bitstring = pub(skC) in
                                            {4498}in(c, =GetEndpointRequest);
                                            {4499}new SP_4239: bitstring;
                                            {4500}new UP_4240: bitstring;
                                            {4501}out(c, (GetEndpointResponse,pkSess_4238,None,SP_4239,UP_4240))
                                        )
                                        else
                                            {4502}let pkSess_4241: bitstring = pub(sk(Sess_4224)) in
                                            {4503}in(c, =GetEndpointRequest);
                                            {4504}new SP_4242: bitstring;
                                            {4505}new UP_4243: bitstring;
                                            {4506}out(c, (GetEndpointResponse,pkSess_4241,None,SP_4242,UP_4243))
                                    )
                                    else
                                        {4507}let pkSess_4244: bitstring = fail-any in
                                        {4508}in(c, =GetEndpointRequest);
                                        {4509}new SP_4245: bitstring;
                                        {4510}new UP_4246: bitstring;
                                        {4511}out(c, (GetEndpointResponse,pkSess_4244,None,SP_4245,UP_4246))
                            )
                            else
                                {4512}let pkSess_4247: bitstring = fail-any in
                                {4513}in(c, =GetEndpointRequest);
                                {4514}new SP_4248: bitstring;
                                {4515}new UP_4249: bitstring;
                                {4516}out(c, (GetEndpointResponse,pkSess_4247,None,SP_4248,UP_4249))
                    )
                    else
                        {4517}let pkSess_4250: bitstring = fail-any in
                        {4518}in(c, =GetEndpointRequest);
                        {4519}new SP_4251: bitstring;
                        {4520}new UP_4252: bitstring;
                        {4521}out(c, (GetEndpointResponse,pkSess_4250,None,SP_4251,UP_4252))
                )
                else
                    {4522}let v_4253: bool = (Cli_4222 = B) in
                    (
                        {4523}if v_4253 then
                        (
                            {4524}let pkCli_4254: bitstring = pub(skB) in
                            {4525}let v_4255: bool = (Sess_4224 = A) in
                            (
                                {4526}if v_4255 then
                                (
                                    {4527}let pkSess_4256: bitstring = pub(skA) in
                                    {4528}in(c, =GetEndpointRequest);
                                    {4529}new SP_4257: bitstring;
                                    {4530}new UP_4258: bitstring;
                                    {4531}out(c, (GetEndpointResponse,pkSess_4256,None,SP_4257,UP_4258))
                                )
                                else
                                    {4532}let v_4259: bool = (Sess_4224 = B) in
                                    (
                                        {4533}if v_4259 then
                                        (
                                            {4534}let pkSess_4260: bitstring = pub(skB) in
                                            {4535}in(c, =GetEndpointRequest);
                                            {4536}new SP_4261: bitstring;
                                            {4537}new UP_4262: bitstring;
                                            {4538}out(c, (GetEndpointResponse,pkSess_4260,None,SP_4261,UP_4262))
                                        )
                                        else
                                            {4539}let v_4263: bool = (Sess_4224 = C) in
                                            (
                                                {4540}if v_4263 then
                                                (
                                                    {4541}let pkSess_4264: bitstring = pub(skC) in
                                                    {4542}in(c, =GetEndpointRequest);
                                                    {4543}new SP_4265: bitstring;
                                                    {4544}new UP_4266: bitstring;
                                                    {4545}out(c, (GetEndpointResponse,pkSess_4264,None,SP_4265,UP_4266))
                                                )
                                                else
                                                    {4546}let pkSess_4267: bitstring = pub(sk(Sess_4224)) in
                                                    {4547}in(c, =GetEndpointRequest);
                                                    {4548}new SP_4268: bitstring;
                                                    {4549}new UP_4269: bitstring;
                                                    {4550}out(c, (GetEndpointResponse,pkSess_4267,None,SP_4268,UP_4269))
                                            )
                                            else
                                                {4551}let pkSess_4270: bitstring = fail-any in
                                                {4552}in(c, =GetEndpointRequest);
                                                {4553}new SP_4271: bitstring;
                                                {4554}new UP_4272: bitstring;
                                                {4555}out(c, (GetEndpointResponse,pkSess_4270,None,SP_4271,UP_4272))
                                    )
                                    else
                                        {4556}let pkSess_4273: bitstring = fail-any in
                                        {4557}in(c, =GetEndpointRequest);
                                        {4558}new SP_4274: bitstring;
                                        {4559}new UP_4275: bitstring;
                                        {4560}out(c, (GetEndpointResponse,pkSess_4273,None,SP_4274,UP_4275))
                            )
                            else
                                {4561}let pkSess_4276: bitstring = fail-any in
                                {4562}in(c, =GetEndpointRequest);
                                {4563}new SP_4277: bitstring;
                                {4564}new UP_4278: bitstring;
                                {4565}out(c, (GetEndpointResponse,pkSess_4276,None,SP_4277,UP_4278))
                        )
                        else
                            {4566}let v_4279: bool = (Cli_4222 = C) in
                            (
                                {4567}if v_4279 then
                                (
                                    {4568}let pkCli_4280: bitstring = pub(skC) in
                                    {4569}let v_4281: bool = (Sess_4224 = A) in
                                    (
                                        {4570}if v_4281 then
                                        (
                                            {4571}let pkSess_4282: bitstring = pub(skA) in
                                            {4572}in(c, =GetEndpointRequest);
                                            {4573}new SP_4283: bitstring;
                                            {4574}new UP_4284: bitstring;
                                            {4575}out(c, (GetEndpointResponse,pkSess_4282,None,SP_4283,UP_4284))
                                        )
                                        else
                                            {4576}let v_4285: bool = (Sess_4224 = B) in
                                            (
                                                {4577}if v_4285 then
                                                (
                                                    {4578}let pkSess_4286: bitstring = pub(skB) in
                                                    {4579}in(c, =GetEndpointRequest);
                                                    {4580}new SP_4287: bitstring;
                                                    {4581}new UP_4288: bitstring;
                                                    {4582}out(c, (GetEndpointResponse,pkSess_4286,None,SP_4287,UP_4288))
                                                )
                                                else
                                                    {4583}let v_4289: bool = (Sess_4224 = C) in
                                                    (
                                                        {4584}if v_4289 then
                                                        (
                                                            {4585}let pkSess_4290: bitstring = pub(skC) in
                                                            {4586}in(c, =GetEndpointRequest);
                                                            {4587}new SP_4291: bitstring;
                                                            {4588}new UP_4292: bitstring;
                                                            {4589}out(c, (GetEndpointResponse,pkSess_4290,None,SP_4291,UP_4292))
                                                        )
                                                        else
                                                            {4590}let pkSess_4293: bitstring = pub(sk(Sess_4224)) in
                                                            {4591}in(c, =GetEndpointRequest);
                                                            {4592}new SP_4294: bitstring;
                                                            {4593}new UP_4295: bitstring;
                                                            {4594}out(c, (GetEndpointResponse,pkSess_4293,None,SP_4294,UP_4295))
                                                    )
                                                    else
                                                        {4595}let pkSess_4296: bitstring = fail-any in
                                                        {4596}in(c, =GetEndpointRequest);
                                                        {4597}new SP_4297: bitstring;
                                                        {4598}new UP_4298: bitstring;
                                                        {4599}out(c, (GetEndpointResponse,pkSess_4296,None,SP_4297,UP_4298))
                                            )
                                            else
                                                {4600}let pkSess_4299: bitstring = fail-any in
                                                {4601}in(c, =GetEndpointRequest);
                                                {4602}new SP_4300: bitstring;
                                                {4603}new UP_4301: bitstring;
                                                {4604}out(c, (GetEndpointResponse,pkSess_4299,None,SP_4300,UP_4301))
                                    )
                                    else
                                        {4605}let pkSess_4302: bitstring = fail-any in
                                        {4606}in(c, =GetEndpointRequest);
                                        {4607}new SP_4303: bitstring;
                                        {4608}new UP_4304: bitstring;
                                        {4609}out(c, (GetEndpointResponse,pkSess_4302,None,SP_4303,UP_4304))
                                )
                                else
                                    {4610}let pkCli_4305: bitstring = pub(sk(Cli_4222)) in
                                    {4611}let v_4306: bool = (Sess_4224 = A) in
                                    (
                                        {4612}if v_4306 then
                                        (
                                            {4613}let pkSess_4307: bitstring = pub(skA) in
                                            {4614}in(c, =GetEndpointRequest);
                                            {4615}new SP_4308: bitstring;
                                            {4616}new UP_4309: bitstring;
                                            {4617}out(c, (GetEndpointResponse,pkSess_4307,None,SP_4308,UP_4309))
                                        )
                                        else
                                            {4618}let v_4310: bool = (Sess_4224 = B) in
                                            (
                                                {4619}if v_4310 then
                                                (
                                                    {4620}let pkSess_4311: bitstring = pub(skB) in
                                                    {4621}in(c, =GetEndpointRequest);
                                                    {4622}new SP_4312: bitstring;
                                                    {4623}new UP_4313: bitstring;
                                                    {4624}out(c, (GetEndpointResponse,pkSess_4311,None,SP_4312,UP_4313))
                                                )
                                                else
                                                    {4625}let v_4314: bool = (Sess_4224 = C) in
                                                    (
                                                        {4626}if v_4314 then
                                                        (
                                                            {4627}let pkSess_4315: bitstring = pub(skC) in
                                                            {4628}in(c, =GetEndpointRequest);
                                                            {4629}new SP_4316: bitstring;
                                                            {4630}new UP_4317: bitstring;
                                                            {4631}out(c, (GetEndpointResponse,pkSess_4315,None,SP_4316,UP_4317))
                                                        )
                                                        else
                                                            {4632}let pkSess_4318: bitstring = pub(sk(Sess_4224)) in
                                                            {4633}in(c, =GetEndpointRequest);
                                                            {4634}new SP_4319: bitstring;
                                                            {4635}new UP_4320: bitstring;
                                                            {4636}out(c, (GetEndpointResponse,pkSess_4318,None,SP_4319,UP_4320))
                                                    )
                                                    else
                                                        {4637}let pkSess_4321: bitstring = fail-any in
                                                        {4638}in(c, =GetEndpointRequest);
                                                        {4639}new SP_4322: bitstring;
                                                        {4640}new UP_4323: bitstring;
                                                        {4641}out(c, (GetEndpointResponse,pkSess_4321,None,SP_4322,UP_4323))
                                            )
                                            else
                                                {4642}let pkSess_4324: bitstring = fail-any in
                                                {4643}in(c, =GetEndpointRequest);
                                                {4644}new SP_4325: bitstring;
                                                {4645}new UP_4326: bitstring;
                                                {4646}out(c, (GetEndpointResponse,pkSess_4324,None,SP_4325,UP_4326))
                                    )
                                    else
                                        {4647}let pkSess_4327: bitstring = fail-any in
                                        {4648}in(c, =GetEndpointRequest);
                                        {4649}new SP_4328: bitstring;
                                        {4650}new UP_4329: bitstring;
                                        {4651}out(c, (GetEndpointResponse,pkSess_4327,None,SP_4328,UP_4329))
                            )
                            else
                                {4652}let pkCli_4330: bitstring = fail-any in
                                {4653}let v_4331: bool = (Sess_4224 = A) in
                                (
                                    {4654}if v_4331 then
                                    (
                                        {4655}let pkSess_4332: bitstring = pub(skA) in
                                        {4656}in(c, =GetEndpointRequest);
                                        {4657}new SP_4333: bitstring;
                                        {4658}new UP_4334: bitstring;
                                        {4659}out(c, (GetEndpointResponse,pkSess_4332,None,SP_4333,UP_4334))
                                    )
                                    else
                                        {4660}let v_4335: bool = (Sess_4224 = B) in
                                        (
                                            {4661}if v_4335 then
                                            (
                                                {4662}let pkSess_4336: bitstring = pub(skB) in
                                                {4663}in(c, =GetEndpointRequest);
                                                {4664}new SP_4337: bitstring;
                                                {4665}new UP_4338: bitstring;
                                                {4666}out(c, (GetEndpointResponse,pkSess_4336,None,SP_4337,UP_4338))
                                            )
                                            else
                                                {4667}let v_4339: bool = (Sess_4224 = C) in
                                                (
                                                    {4668}if v_4339 then
                                                    (
                                                        {4669}let pkSess_4340: bitstring = pub(skC) in
                                                        {4670}in(c, =GetEndpointRequest);
                                                        {4671}new SP_4341: bitstring;
                                                        {4672}new UP_4342: bitstring;
                                                        {4673}out(c, (GetEndpointResponse,pkSess_4340,None,SP_4341,UP_4342))
                                                    )
                                                    else
                                                        {4674}let pkSess_4343: bitstring = pub(sk(Sess_4224)) in
                                                        {4675}in(c, =GetEndpointRequest);
                                                        {4676}new SP_4344: bitstring;
                                                        {4677}new UP_4345: bitstring;
                                                        {4678}out(c, (GetEndpointResponse,pkSess_4343,None,SP_4344,UP_4345))
                                                )
                                                else
                                                    {4679}let pkSess_4346: bitstring = fail-any in
                                                    {4680}in(c, =GetEndpointRequest);
                                                    {4681}new SP_4347: bitstring;
                                                    {4682}new UP_4348: bitstring;
                                                    {4683}out(c, (GetEndpointResponse,pkSess_4346,None,SP_4347,UP_4348))
                                        )
                                        else
                                            {4684}let pkSess_4349: bitstring = fail-any in
                                            {4685}in(c, =GetEndpointRequest);
                                            {4686}new SP_4350: bitstring;
                                            {4687}new UP_4351: bitstring;
                                            {4688}out(c, (GetEndpointResponse,pkSess_4349,None,SP_4350,UP_4351))
                                )
                                else
                                    {4689}let pkSess_4352: bitstring = fail-any in
                                    {4690}in(c, =GetEndpointRequest);
                                    {4691}new SP_4353: bitstring;
                                    {4692}new UP_4354: bitstring;
                                    {4693}out(c, (GetEndpointResponse,pkSess_4352,None,SP_4353,UP_4354))
                    )
                    else
                        {4694}let pkCli_4355: bitstring = fail-any in
                        {4695}let v_4356: bool = (Sess_4224 = A) in
                        (
                            {4696}if v_4356 then
                            (
                                {4697}let pkSess_4357: bitstring = pub(skA) in
                                {4698}in(c, =GetEndpointRequest);
                                {4699}new SP_4358: bitstring;
                                {4700}new UP_4359: bitstring;
                                {4701}out(c, (GetEndpointResponse,pkSess_4357,None,SP_4358,UP_4359))
                            )
                            else
                                {4702}let v_4360: bool = (Sess_4224 = B) in
                                (
                                    {4703}if v_4360 then
                                    (
                                        {4704}let pkSess_4361: bitstring = pub(skB) in
                                        {4705}in(c, =GetEndpointRequest);
                                        {4706}new SP_4362: bitstring;
                                        {4707}new UP_4363: bitstring;
                                        {4708}out(c, (GetEndpointResponse,pkSess_4361,None,SP_4362,UP_4363))
                                    )
                                    else
                                        {4709}let v_4364: bool = (Sess_4224 = C) in
                                        (
                                            {4710}if v_4364 then
                                            (
                                                {4711}let pkSess_4365: bitstring = pub(skC) in
                                                {4712}in(c, =GetEndpointRequest);
                                                {4713}new SP_4366: bitstring;
                                                {4714}new UP_4367: bitstring;
                                                {4715}out(c, (GetEndpointResponse,pkSess_4365,None,SP_4366,UP_4367))
                                            )
                                            else
                                                {4716}let pkSess_4368: bitstring = pub(sk(Sess_4224)) in
                                                {4717}in(c, =GetEndpointRequest);
                                                {4718}new SP_4369: bitstring;
                                                {4719}new UP_4370: bitstring;
                                                {4720}out(c, (GetEndpointResponse,pkSess_4368,None,SP_4369,UP_4370))
                                        )
                                        else
                                            {4721}let pkSess_4371: bitstring = fail-any in
                                            {4722}in(c, =GetEndpointRequest);
                                            {4723}new SP_4372: bitstring;
                                            {4724}new UP_4373: bitstring;
                                            {4725}out(c, (GetEndpointResponse,pkSess_4371,None,SP_4372,UP_4373))
                                )
                                else
                                    {4726}let pkSess_4374: bitstring = fail-any in
                                    {4727}in(c, =GetEndpointRequest);
                                    {4728}new SP_4375: bitstring;
                                    {4729}new UP_4376: bitstring;
                                    {4730}out(c, (GetEndpointResponse,pkSess_4374,None,SP_4375,UP_4376))
                        )
                        else
                            {4731}let pkSess_4377: bitstring = fail-any in
                            {4732}in(c, =GetEndpointRequest);
                            {4733}new SP_4378: bitstring;
                            {4734}new UP_4379: bitstring;
                            {4735}out(c, (GetEndpointResponse,pkSess_4377,None,SP_4378,UP_4379))
            )
            else
                {4736}let pkCli_4380: bitstring = fail-any in
                {4737}let v_4381: bool = (Sess_4224 = A) in
                (
                    {4738}if v_4381 then
                    (
                        {4739}let pkSess_4382: bitstring = pub(skA) in
                        {4740}in(c, =GetEndpointRequest);
                        {4741}new SP_4383: bitstring;
                        {4742}new UP_4384: bitstring;
                        {4743}out(c, (GetEndpointResponse,pkSess_4382,None,SP_4383,UP_4384))
                    )
                    else
                        {4744}let v_4385: bool = (Sess_4224 = B) in
                        (
                            {4745}if v_4385 then
                            (
                                {4746}let pkSess_4386: bitstring = pub(skB) in
                                {4747}in(c, =GetEndpointRequest);
                                {4748}new SP_4387: bitstring;
                                {4749}new UP_4388: bitstring;
                                {4750}out(c, (GetEndpointResponse,pkSess_4386,None,SP_4387,UP_4388))
                            )
                            else
                                {4751}let v_4389: bool = (Sess_4224 = C) in
                                (
                                    {4752}if v_4389 then
                                    (
                                        {4753}let pkSess_4390: bitstring = pub(skC) in
                                        {4754}in(c, =GetEndpointRequest);
                                        {4755}new SP_4391: bitstring;
                                        {4756}new UP_4392: bitstring;
                                        {4757}out(c, (GetEndpointResponse,pkSess_4390,None,SP_4391,UP_4392))
                                    )
                                    else
                                        {4758}let pkSess_4393: bitstring = pub(sk(Sess_4224)) in
                                        {4759}in(c, =GetEndpointRequest);
                                        {4760}new SP_4394: bitstring;
                                        {4761}new UP_4395: bitstring;
                                        {4762}out(c, (GetEndpointResponse,pkSess_4393,None,SP_4394,UP_4395))
                                )
                                else
                                    {4763}let pkSess_4396: bitstring = fail-any in
                                    {4764}in(c, =GetEndpointRequest);
                                    {4765}new SP_4397: bitstring;
                                    {4766}new UP_4398: bitstring;
                                    {4767}out(c, (GetEndpointResponse,pkSess_4396,None,SP_4397,UP_4398))
                        )
                        else
                            {4768}let pkSess_4399: bitstring = fail-any in
                            {4769}in(c, =GetEndpointRequest);
                            {4770}new SP_4400: bitstring;
                            {4771}new UP_4401: bitstring;
                            {4772}out(c, (GetEndpointResponse,pkSess_4399,None,SP_4400,UP_4401))
                )
                else
                    {4773}let pkSess_4402: bitstring = fail-any in
                    {4774}in(c, =GetEndpointRequest);
                    {4775}new SP_4403: bitstring;
                    {4776}new UP_4404: bitstring;
                    {4777}out(c, (GetEndpointResponse,pkSess_4402,None,SP_4403,UP_4404))
        )
        else
            {4778}let v_4405: bool = (Disco_4223 = B) in
            (
                {4779}if v_4405 then
                (
                    {4780}let skDisco_4406: bitstring = skB in
                    {4781}let pkDisco_4407: bitstring = pub(skDisco_4406) in
                    {4782}let v_4408: bool = (Cli_4222 = A) in
                    (
                        {4783}if v_4408 then
                        (
                            {4784}let pkCli_4409: bitstring = pub(skA) in
                            {4785}let v_4410: bool = (Sess_4224 = A) in
                            (
                                {4786}if v_4410 then
                                (
                                    {4787}let pkSess_4411: bitstring = pub(skA) in
                                    {4788}in(c, =GetEndpointRequest);
                                    {4789}new SP_4412: bitstring;
                                    {4790}new UP_4413: bitstring;
                                    {4791}out(c, (GetEndpointResponse,pkSess_4411,None,SP_4412,UP_4413))
                                )
                                else
                                    {4792}let v_4414: bool = (Sess_4224 = B) in
                                    (
                                        {4793}if v_4414 then
                                        (
                                            {4794}let pkSess_4415: bitstring = pub(skB) in
                                            {4795}in(c, =GetEndpointRequest);
                                            {4796}new SP_4416: bitstring;
                                            {4797}new UP_4417: bitstring;
                                            {4798}out(c, (GetEndpointResponse,pkSess_4415,None,SP_4416,UP_4417))
                                        )
                                        else
                                            {4799}let v_4418: bool = (Sess_4224 = C) in
                                            (
                                                {4800}if v_4418 then
                                                (
                                                    {4801}let pkSess_4419: bitstring = pub(skC) in
                                                    {4802}in(c, =GetEndpointRequest);
                                                    {4803}new SP_4420: bitstring;
                                                    {4804}new UP_4421: bitstring;
                                                    {4805}out(c, (GetEndpointResponse,pkSess_4419,None,SP_4420,UP_4421))
                                                )
                                                else
                                                    {4806}let pkSess_4422: bitstring = pub(sk(Sess_4224)) in
                                                    {4807}in(c, =GetEndpointRequest);
                                                    {4808}new SP_4423: bitstring;
                                                    {4809}new UP_4424: bitstring;
                                                    {4810}out(c, (GetEndpointResponse,pkSess_4422,None,SP_4423,UP_4424))
                                            )
                                            else
                                                {4811}let pkSess_4425: bitstring = fail-any in
                                                {4812}in(c, =GetEndpointRequest);
                                                {4813}new SP_4426: bitstring;
                                                {4814}new UP_4427: bitstring;
                                                {4815}out(c, (GetEndpointResponse,pkSess_4425,None,SP_4426,UP_4427))
                                    )
                                    else
                                        {4816}let pkSess_4428: bitstring = fail-any in
                                        {4817}in(c, =GetEndpointRequest);
                                        {4818}new SP_4429: bitstring;
                                        {4819}new UP_4430: bitstring;
                                        {4820}out(c, (GetEndpointResponse,pkSess_4428,None,SP_4429,UP_4430))
                            )
                            else
                                {4821}let pkSess_4431: bitstring = fail-any in
                                {4822}in(c, =GetEndpointRequest);
                                {4823}new SP_4432: bitstring;
                                {4824}new UP_4433: bitstring;
                                {4825}out(c, (GetEndpointResponse,pkSess_4431,None,SP_4432,UP_4433))
                        )
                        else
                            {4826}let v_4434: bool = (Cli_4222 = B) in
                            (
                                {4827}if v_4434 then
                                (
                                    {4828}let pkCli_4435: bitstring = pub(skB) in
                                    {4829}let v_4436: bool = (Sess_4224 = A) in
                                    (
                                        {4830}if v_4436 then
                                        (
                                            {4831}let pkSess_4437: bitstring = pub(skA) in
                                            {4832}in(c, =GetEndpointRequest);
                                            {4833}new SP_4438: bitstring;
                                            {4834}new UP_4439: bitstring;
                                            {4835}out(c, (GetEndpointResponse,pkSess_4437,None,SP_4438,UP_4439))
                                        )
                                        else
                                            {4836}let v_4440: bool = (Sess_4224 = B) in
                                            (
                                                {4837}if v_4440 then
                                                (
                                                    {4838}let pkSess_4441: bitstring = pub(skB) in
                                                    {4839}in(c, =GetEndpointRequest);
                                                    {4840}new SP_4442: bitstring;
                                                    {4841}new UP_4443: bitstring;
                                                    {4842}out(c, (GetEndpointResponse,pkSess_4441,None,SP_4442,UP_4443))
                                                )
                                                else
                                                    {4843}let v_4444: bool = (Sess_4224 = C) in
                                                    (
                                                        {4844}if v_4444 then
                                                        (
                                                            {4845}let pkSess_4445: bitstring = pub(skC) in
                                                            {4846}in(c, =GetEndpointRequest);
                                                            {4847}new SP_4446: bitstring;
                                                            {4848}new UP_4447: bitstring;
                                                            {4849}out(c, (GetEndpointResponse,pkSess_4445,None,SP_4446,UP_4447))
                                                        )
                                                        else
                                                            {4850}let pkSess_4448: bitstring = pub(sk(Sess_4224)) in
                                                            {4851}in(c, =GetEndpointRequest);
                                                            {4852}new SP_4449: bitstring;
                                                            {4853}new UP_4450: bitstring;
                                                            {4854}out(c, (GetEndpointResponse,pkSess_4448,None,SP_4449,UP_4450))
                                                    )
                                                    else
                                                        {4855}let pkSess_4451: bitstring = fail-any in
                                                        {4856}in(c, =GetEndpointRequest);
                                                        {4857}new SP_4452: bitstring;
                                                        {4858}new UP_4453: bitstring;
                                                        {4859}out(c, (GetEndpointResponse,pkSess_4451,None,SP_4452,UP_4453))
                                            )
                                            else
                                                {4860}let pkSess_4454: bitstring = fail-any in
                                                {4861}in(c, =GetEndpointRequest);
                                                {4862}new SP_4455: bitstring;
                                                {4863}new UP_4456: bitstring;
                                                {4864}out(c, (GetEndpointResponse,pkSess_4454,None,SP_4455,UP_4456))
                                    )
                                    else
                                        {4865}let pkSess_4457: bitstring = fail-any in
                                        {4866}in(c, =GetEndpointRequest);
                                        {4867}new SP_4458: bitstring;
                                        {4868}new UP_4459: bitstring;
                                        {4869}out(c, (GetEndpointResponse,pkSess_4457,None,SP_4458,UP_4459))
                                )
                                else
                                    {4870}let v_4460: bool = (Cli_4222 = C) in
                                    (
                                        {4871}if v_4460 then
                                        (
                                            {4872}let pkCli_4461: bitstring = pub(skC) in
                                            {4873}let v_4462: bool = (Sess_4224 = A) in
                                            (
                                                {4874}if v_4462 then
                                                (
                                                    {4875}let pkSess_4463: bitstring = pub(skA) in
                                                    {4876}in(c, =GetEndpointRequest);
                                                    {4877}new SP_4464: bitstring;
                                                    {4878}new UP_4465: bitstring;
                                                    {4879}out(c, (GetEndpointResponse,pkSess_4463,None,SP_4464,UP_4465))
                                                )
                                                else
                                                    {4880}let v_4466: bool = (Sess_4224 = B) in
                                                    (
                                                        {4881}if v_4466 then
                                                        (
                                                            {4882}let pkSess_4467: bitstring = pub(skB) in
                                                            {4883}in(c, =GetEndpointRequest);
                                                            {4884}new SP_4468: bitstring;
                                                            {4885}new UP_4469: bitstring;
                                                            {4886}out(c, (GetEndpointResponse,pkSess_4467,None,SP_4468,UP_4469))
                                                        )
                                                        else
                                                            {4887}let v_4470: bool = (Sess_4224 = C) in
                                                            (
                                                                {4888}if v_4470 then
                                                                (
                                                                    {4889}let pkSess_4471: bitstring = pub(skC) in
                                                                    {4890}in(c, =GetEndpointRequest);
                                                                    {4891}new SP_4472: bitstring;
                                                                    {4892}new UP_4473: bitstring;
                                                                    {4893}out(c, (GetEndpointResponse,pkSess_4471,None,SP_4472,UP_4473))
                                                                )
                                                                else
                                                                    {4894}let pkSess_4474: bitstring = pub(sk(Sess_4224)) in
                                                                    {4895}in(c, =GetEndpointRequest);
                                                                    {4896}new SP_4475: bitstring;
                                                                    {4897}new UP_4476: bitstring;
                                                                    {4898}out(c, (GetEndpointResponse,pkSess_4474,None,SP_4475,UP_4476))
                                                            )
                                                            else
                                                                {4899}let pkSess_4477: bitstring = fail-any in
                                                                {4900}in(c, =GetEndpointRequest);
                                                                {4901}new SP_4478: bitstring;
                                                                {4902}new UP_4479: bitstring;
                                                                {4903}out(c, (GetEndpointResponse,pkSess_4477,None,SP_4478,UP_4479))
                                                    )
                                                    else
                                                        {4904}let pkSess_4480: bitstring = fail-any in
                                                        {4905}in(c, =GetEndpointRequest);
                                                        {4906}new SP_4481: bitstring;
                                                        {4907}new UP_4482: bitstring;
                                                        {4908}out(c, (GetEndpointResponse,pkSess_4480,None,SP_4481,UP_4482))
                                            )
                                            else
                                                {4909}let pkSess_4483: bitstring = fail-any in
                                                {4910}in(c, =GetEndpointRequest);
                                                {4911}new SP_4484: bitstring;
                                                {4912}new UP_4485: bitstring;
                                                {4913}out(c, (GetEndpointResponse,pkSess_4483,None,SP_4484,UP_4485))
                                        )
                                        else
                                            {4914}let pkCli_4486: bitstring = pub(sk(Cli_4222)) in
                                            {4915}let v_4487: bool = (Sess_4224 = A) in
                                            (
                                                {4916}if v_4487 then
                                                (
                                                    {4917}let pkSess_4488: bitstring = pub(skA) in
                                                    {4918}in(c, =GetEndpointRequest);
                                                    {4919}new SP_4489: bitstring;
                                                    {4920}new UP_4490: bitstring;
                                                    {4921}out(c, (GetEndpointResponse,pkSess_4488,None,SP_4489,UP_4490))
                                                )
                                                else
                                                    {4922}let v_4491: bool = (Sess_4224 = B) in
                                                    (
                                                        {4923}if v_4491 then
                                                        (
                                                            {4924}let pkSess_4492: bitstring = pub(skB) in
                                                            {4925}in(c, =GetEndpointRequest);
                                                            {4926}new SP_4493: bitstring;
                                                            {4927}new UP_4494: bitstring;
                                                            {4928}out(c, (GetEndpointResponse,pkSess_4492,None,SP_4493,UP_4494))
                                                        )
                                                        else
                                                            {4929}let v_4495: bool = (Sess_4224 = C) in
                                                            (
                                                                {4930}if v_4495 then
                                                                (
                                                                    {4931}let pkSess_4496: bitstring = pub(skC) in
                                                                    {4932}in(c, =GetEndpointRequest);
                                                                    {4933}new SP_4497: bitstring;
                                                                    {4934}new UP_4498: bitstring;
                                                                    {4935}out(c, (GetEndpointResponse,pkSess_4496,None,SP_4497,UP_4498))
                                                                )
                                                                else
                                                                    {4936}let pkSess_4499: bitstring = pub(sk(Sess_4224)) in
                                                                    {4937}in(c, =GetEndpointRequest);
                                                                    {4938}new SP_4500: bitstring;
                                                                    {4939}new UP_4501: bitstring;
                                                                    {4940}out(c, (GetEndpointResponse,pkSess_4499,None,SP_4500,UP_4501))
                                                            )
                                                            else
                                                                {4941}let pkSess_4502: bitstring = fail-any in
                                                                {4942}in(c, =GetEndpointRequest);
                                                                {4943}new SP_4503: bitstring;
                                                                {4944}new UP_4504: bitstring;
                                                                {4945}out(c, (GetEndpointResponse,pkSess_4502,None,SP_4503,UP_4504))
                                                    )
                                                    else
                                                        {4946}let pkSess_4505: bitstring = fail-any in
                                                        {4947}in(c, =GetEndpointRequest);
                                                        {4948}new SP_4506: bitstring;
                                                        {4949}new UP_4507: bitstring;
                                                        {4950}out(c, (GetEndpointResponse,pkSess_4505,None,SP_4506,UP_4507))
                                            )
                                            else
                                                {4951}let pkSess_4508: bitstring = fail-any in
                                                {4952}in(c, =GetEndpointRequest);
                                                {4953}new SP_4509: bitstring;
                                                {4954}new UP_4510: bitstring;
                                                {4955}out(c, (GetEndpointResponse,pkSess_4508,None,SP_4509,UP_4510))
                                    )
                                    else
                                        {4956}let pkCli_4511: bitstring = fail-any in
                                        {4957}let v_4512: bool = (Sess_4224 = A) in
                                        (
                                            {4958}if v_4512 then
                                            (
                                                {4959}let pkSess_4513: bitstring = pub(skA) in
                                                {4960}in(c, =GetEndpointRequest);
                                                {4961}new SP_4514: bitstring;
                                                {4962}new UP_4515: bitstring;
                                                {4963}out(c, (GetEndpointResponse,pkSess_4513,None,SP_4514,UP_4515))
                                            )
                                            else
                                                {4964}let v_4516: bool = (Sess_4224 = B) in
                                                (
                                                    {4965}if v_4516 then
                                                    (
                                                        {4966}let pkSess_4517: bitstring = pub(skB) in
                                                        {4967}in(c, =GetEndpointRequest);
                                                        {4968}new SP_4518: bitstring;
                                                        {4969}new UP_4519: bitstring;
                                                        {4970}out(c, (GetEndpointResponse,pkSess_4517,None,SP_4518,UP_4519))
                                                    )
                                                    else
                                                        {4971}let v_4520: bool = (Sess_4224 = C) in
                                                        (
                                                            {4972}if v_4520 then
                                                            (
                                                                {4973}let pkSess_4521: bitstring = pub(skC) in
                                                                {4974}in(c, =GetEndpointRequest);
                                                                {4975}new SP_4522: bitstring;
                                                                {4976}new UP_4523: bitstring;
                                                                {4977}out(c, (GetEndpointResponse,pkSess_4521,None,SP_4522,UP_4523))
                                                            )
                                                            else
                                                                {4978}let pkSess_4524: bitstring = pub(sk(Sess_4224)) in
                                                                {4979}in(c, =GetEndpointRequest);
                                                                {4980}new SP_4525: bitstring;
                                                                {4981}new UP_4526: bitstring;
                                                                {4982}out(c, (GetEndpointResponse,pkSess_4524,None,SP_4525,UP_4526))
                                                        )
                                                        else
                                                            {4983}let pkSess_4527: bitstring = fail-any in
                                                            {4984}in(c, =GetEndpointRequest);
                                                            {4985}new SP_4528: bitstring;
                                                            {4986}new UP_4529: bitstring;
                                                            {4987}out(c, (GetEndpointResponse,pkSess_4527,None,SP_4528,UP_4529))
                                                )
                                                else
                                                    {4988}let pkSess_4530: bitstring = fail-any in
                                                    {4989}in(c, =GetEndpointRequest);
                                                    {4990}new SP_4531: bitstring;
                                                    {4991}new UP_4532: bitstring;
                                                    {4992}out(c, (GetEndpointResponse,pkSess_4530,None,SP_4531,UP_4532))
                                        )
                                        else
                                            {4993}let pkSess_4533: bitstring = fail-any in
                                            {4994}in(c, =GetEndpointRequest);
                                            {4995}new SP_4534: bitstring;
                                            {4996}new UP_4535: bitstring;
                                            {4997}out(c, (GetEndpointResponse,pkSess_4533,None,SP_4534,UP_4535))
                            )
                            else
                                {4998}let pkCli_4536: bitstring = fail-any in
                                {4999}let v_4537: bool = (Sess_4224 = A) in
                                (
                                    {5000}if v_4537 then
                                    (
                                        {5001}let pkSess_4538: bitstring = pub(skA) in
                                        {5002}in(c, =GetEndpointRequest);
                                        {5003}new SP_4539: bitstring;
                                        {5004}new UP_4540: bitstring;
                                        {5005}out(c, (GetEndpointResponse,pkSess_4538,None,SP_4539,UP_4540))
                                    )
                                    else
                                        {5006}let v_4541: bool = (Sess_4224 = B) in
                                        (
                                            {5007}if v_4541 then
                                            (
                                                {5008}let pkSess_4542: bitstring = pub(skB) in
                                                {5009}in(c, =GetEndpointRequest);
                                                {5010}new SP_4543: bitstring;
                                                {5011}new UP_4544: bitstring;
                                                {5012}out(c, (GetEndpointResponse,pkSess_4542,None,SP_4543,UP_4544))
                                            )
                                            else
                                                {5013}let v_4545: bool = (Sess_4224 = C) in
                                                (
                                                    {5014}if v_4545 then
                                                    (
                                                        {5015}let pkSess_4546: bitstring = pub(skC) in
                                                        {5016}in(c, =GetEndpointRequest);
                                                        {5017}new SP_4547: bitstring;
                                                        {5018}new UP_4548: bitstring;
                                                        {5019}out(c, (GetEndpointResponse,pkSess_4546,None,SP_4547,UP_4548))
                                                    )
                                                    else
                                                        {5020}let pkSess_4549: bitstring = pub(sk(Sess_4224)) in
                                                        {5021}in(c, =GetEndpointRequest);
                                                        {5022}new SP_4550: bitstring;
                                                        {5023}new UP_4551: bitstring;
                                                        {5024}out(c, (GetEndpointResponse,pkSess_4549,None,SP_4550,UP_4551))
                                                )
                                                else
                                                    {5025}let pkSess_4552: bitstring = fail-any in
                                                    {5026}in(c, =GetEndpointRequest);
                                                    {5027}new SP_4553: bitstring;
                                                    {5028}new UP_4554: bitstring;
                                                    {5029}out(c, (GetEndpointResponse,pkSess_4552,None,SP_4553,UP_4554))
                                        )
                                        else
                                            {5030}let pkSess_4555: bitstring = fail-any in
                                            {5031}in(c, =GetEndpointRequest);
                                            {5032}new SP_4556: bitstring;
                                            {5033}new UP_4557: bitstring;
                                            {5034}out(c, (GetEndpointResponse,pkSess_4555,None,SP_4556,UP_4557))
                                )
                                else
                                    {5035}let pkSess_4558: bitstring = fail-any in
                                    {5036}in(c, =GetEndpointRequest);
                                    {5037}new SP_4559: bitstring;
                                    {5038}new UP_4560: bitstring;
                                    {5039}out(c, (GetEndpointResponse,pkSess_4558,None,SP_4559,UP_4560))
                    )
                    else
                        {5040}let pkCli_4561: bitstring = fail-any in
                        {5041}let v_4562: bool = (Sess_4224 = A) in
                        (
                            {5042}if v_4562 then
                            (
                                {5043}let pkSess_4563: bitstring = pub(skA) in
                                {5044}in(c, =GetEndpointRequest);
                                {5045}new SP_4564: bitstring;
                                {5046}new UP_4565: bitstring;
                                {5047}out(c, (GetEndpointResponse,pkSess_4563,None,SP_4564,UP_4565))
                            )
                            else
                                {5048}let v_4566: bool = (Sess_4224 = B) in
                                (
                                    {5049}if v_4566 then
                                    (
                                        {5050}let pkSess_4567: bitstring = pub(skB) in
                                        {5051}in(c, =GetEndpointRequest);
                                        {5052}new SP_4568: bitstring;
                                        {5053}new UP_4569: bitstring;
                                        {5054}out(c, (GetEndpointResponse,pkSess_4567,None,SP_4568,UP_4569))
                                    )
                                    else
                                        {5055}let v_4570: bool = (Sess_4224 = C) in
                                        (
                                            {5056}if v_4570 then
                                            (
                                                {5057}let pkSess_4571: bitstring = pub(skC) in
                                                {5058}in(c, =GetEndpointRequest);
                                                {5059}new SP_4572: bitstring;
                                                {5060}new UP_4573: bitstring;
                                                {5061}out(c, (GetEndpointResponse,pkSess_4571,None,SP_4572,UP_4573))
                                            )
                                            else
                                                {5062}let pkSess_4574: bitstring = pub(sk(Sess_4224)) in
                                                {5063}in(c, =GetEndpointRequest);
                                                {5064}new SP_4575: bitstring;
                                                {5065}new UP_4576: bitstring;
                                                {5066}out(c, (GetEndpointResponse,pkSess_4574,None,SP_4575,UP_4576))
                                        )
                                        else
                                            {5067}let pkSess_4577: bitstring = fail-any in
                                            {5068}in(c, =GetEndpointRequest);
                                            {5069}new SP_4578: bitstring;
                                            {5070}new UP_4579: bitstring;
                                            {5071}out(c, (GetEndpointResponse,pkSess_4577,None,SP_4578,UP_4579))
                                )
                                else
                                    {5072}let pkSess_4580: bitstring = fail-any in
                                    {5073}in(c, =GetEndpointRequest);
                                    {5074}new SP_4581: bitstring;
                                    {5075}new UP_4582: bitstring;
                                    {5076}out(c, (GetEndpointResponse,pkSess_4580,None,SP_4581,UP_4582))
                        )
                        else
                            {5077}let pkSess_4583: bitstring = fail-any in
                            {5078}in(c, =GetEndpointRequest);
                            {5079}new SP_4584: bitstring;
                            {5080}new UP_4585: bitstring;
                            {5081}out(c, (GetEndpointResponse,pkSess_4583,None,SP_4584,UP_4585))
                )
                else
                    {5082}let =true = (Disco_4223 = C) in
                    (
                        {5083}let skDisco_4586: bitstring = skC in
                        {5084}let pkDisco_4587: bitstring = pub(skDisco_4586) in
                        {5085}let v_4588: bool = (Cli_4222 = A) in
                        (
                            {5086}if v_4588 then
                            (
                                {5087}let pkCli_4589: bitstring = pub(skA) in
                                {5088}let v_4590: bool = (Sess_4224 = A) in
                                (
                                    {5089}if v_4590 then
                                    (
                                        {5090}let pkSess_4591: bitstring = pub(skA) in
                                        {5091}in(c, =GetEndpointRequest);
                                        {5092}new SP_4592: bitstring;
                                        {5093}new UP_4593: bitstring;
                                        {5094}out(c, (GetEndpointResponse,pkSess_4591,None,SP_4592,UP_4593))
                                    )
                                    else
                                        {5095}let v_4594: bool = (Sess_4224 = B) in
                                        (
                                            {5096}if v_4594 then
                                            (
                                                {5097}let pkSess_4595: bitstring = pub(skB) in
                                                {5098}in(c, =GetEndpointRequest);
                                                {5099}new SP_4596: bitstring;
                                                {5100}new UP_4597: bitstring;
                                                {5101}out(c, (GetEndpointResponse,pkSess_4595,None,SP_4596,UP_4597))
                                            )
                                            else
                                                {5102}let v_4598: bool = (Sess_4224 = C) in
                                                (
                                                    {5103}if v_4598 then
                                                    (
                                                        {5104}let pkSess_4599: bitstring = pub(skC) in
                                                        {5105}in(c, =GetEndpointRequest);
                                                        {5106}new SP_4600: bitstring;
                                                        {5107}new UP_4601: bitstring;
                                                        {5108}out(c, (GetEndpointResponse,pkSess_4599,None,SP_4600,UP_4601))
                                                    )
                                                    else
                                                        {5109}let pkSess_4602: bitstring = pub(sk(Sess_4224)) in
                                                        {5110}in(c, =GetEndpointRequest);
                                                        {5111}new SP_4603: bitstring;
                                                        {5112}new UP_4604: bitstring;
                                                        {5113}out(c, (GetEndpointResponse,pkSess_4602,None,SP_4603,UP_4604))
                                                )
                                                else
                                                    {5114}let pkSess_4605: bitstring = fail-any in
                                                    {5115}in(c, =GetEndpointRequest);
                                                    {5116}new SP_4606: bitstring;
                                                    {5117}new UP_4607: bitstring;
                                                    {5118}out(c, (GetEndpointResponse,pkSess_4605,None,SP_4606,UP_4607))
                                        )
                                        else
                                            {5119}let pkSess_4608: bitstring = fail-any in
                                            {5120}in(c, =GetEndpointRequest);
                                            {5121}new SP_4609: bitstring;
                                            {5122}new UP_4610: bitstring;
                                            {5123}out(c, (GetEndpointResponse,pkSess_4608,None,SP_4609,UP_4610))
                                )
                                else
                                    {5124}let pkSess_4611: bitstring = fail-any in
                                    {5125}in(c, =GetEndpointRequest);
                                    {5126}new SP_4612: bitstring;
                                    {5127}new UP_4613: bitstring;
                                    {5128}out(c, (GetEndpointResponse,pkSess_4611,None,SP_4612,UP_4613))
                            )
                            else
                                {5129}let v_4614: bool = (Cli_4222 = B) in
                                (
                                    {5130}if v_4614 then
                                    (
                                        {5131}let pkCli_4615: bitstring = pub(skB) in
                                        {5132}let v_4616: bool = (Sess_4224 = A) in
                                        (
                                            {5133}if v_4616 then
                                            (
                                                {5134}let pkSess_4617: bitstring = pub(skA) in
                                                {5135}in(c, =GetEndpointRequest);
                                                {5136}new SP_4618: bitstring;
                                                {5137}new UP_4619: bitstring;
                                                {5138}out(c, (GetEndpointResponse,pkSess_4617,None,SP_4618,UP_4619))
                                            )
                                            else
                                                {5139}let v_4620: bool = (Sess_4224 = B) in
                                                (
                                                    {5140}if v_4620 then
                                                    (
                                                        {5141}let pkSess_4621: bitstring = pub(skB) in
                                                        {5142}in(c, =GetEndpointRequest);
                                                        {5143}new SP_4622: bitstring;
                                                        {5144}new UP_4623: bitstring;
                                                        {5145}out(c, (GetEndpointResponse,pkSess_4621,None,SP_4622,UP_4623))
                                                    )
                                                    else
                                                        {5146}let v_4624: bool = (Sess_4224 = C) in
                                                        (
                                                            {5147}if v_4624 then
                                                            (
                                                                {5148}let pkSess_4625: bitstring = pub(skC) in
                                                                {5149}in(c, =GetEndpointRequest);
                                                                {5150}new SP_4626: bitstring;
                                                                {5151}new UP_4627: bitstring;
                                                                {5152}out(c, (GetEndpointResponse,pkSess_4625,None,SP_4626,UP_4627))
                                                            )
                                                            else
                                                                {5153}let pkSess_4628: bitstring = pub(sk(Sess_4224)) in
                                                                {5154}in(c, =GetEndpointRequest);
                                                                {5155}new SP_4629: bitstring;
                                                                {5156}new UP_4630: bitstring;
                                                                {5157}out(c, (GetEndpointResponse,pkSess_4628,None,SP_4629,UP_4630))
                                                        )
                                                        else
                                                            {5158}let pkSess_4631: bitstring = fail-any in
                                                            {5159}in(c, =GetEndpointRequest);
                                                            {5160}new SP_4632: bitstring;
                                                            {5161}new UP_4633: bitstring;
                                                            {5162}out(c, (GetEndpointResponse,pkSess_4631,None,SP_4632,UP_4633))
                                                )
                                                else
                                                    {5163}let pkSess_4634: bitstring = fail-any in
                                                    {5164}in(c, =GetEndpointRequest);
                                                    {5165}new SP_4635: bitstring;
                                                    {5166}new UP_4636: bitstring;
                                                    {5167}out(c, (GetEndpointResponse,pkSess_4634,None,SP_4635,UP_4636))
                                        )
                                        else
                                            {5168}let pkSess_4637: bitstring = fail-any in
                                            {5169}in(c, =GetEndpointRequest);
                                            {5170}new SP_4638: bitstring;
                                            {5171}new UP_4639: bitstring;
                                            {5172}out(c, (GetEndpointResponse,pkSess_4637,None,SP_4638,UP_4639))
                                    )
                                    else
                                        {5173}let v_4640: bool = (Cli_4222 = C) in
                                        (
                                            {5174}if v_4640 then
                                            (
                                                {5175}let pkCli_4641: bitstring = pub(skC) in
                                                {5176}let v_4642: bool = (Sess_4224 = A) in
                                                (
                                                    {5177}if v_4642 then
                                                    (
                                                        {5178}let pkSess_4643: bitstring = pub(skA) in
                                                        {5179}in(c, =GetEndpointRequest);
                                                        {5180}new SP_4644: bitstring;
                                                        {5181}new UP_4645: bitstring;
                                                        {5182}out(c, (GetEndpointResponse,pkSess_4643,None,SP_4644,UP_4645))
                                                    )
                                                    else
                                                        {5183}let v_4646: bool = (Sess_4224 = B) in
                                                        (
                                                            {5184}if v_4646 then
                                                            (
                                                                {5185}let pkSess_4647: bitstring = pub(skB) in
                                                                {5186}in(c, =GetEndpointRequest);
                                                                {5187}new SP_4648: bitstring;
                                                                {5188}new UP_4649: bitstring;
                                                                {5189}out(c, (GetEndpointResponse,pkSess_4647,None,SP_4648,UP_4649))
                                                            )
                                                            else
                                                                {5190}let v_4650: bool = (Sess_4224 = C) in
                                                                (
                                                                    {5191}if v_4650 then
                                                                    (
                                                                        {5192}let pkSess_4651: bitstring = pub(skC) in
                                                                        {5193}in(c, =GetEndpointRequest);
                                                                        {5194}new SP_4652: bitstring;
                                                                        {5195}new UP_4653: bitstring;
                                                                        {5196}out(c, (GetEndpointResponse,pkSess_4651,None,SP_4652,UP_4653))
                                                                    )
                                                                    else
                                                                        {5197}let pkSess_4654: bitstring = pub(sk(Sess_4224)) in
                                                                        {5198}in(c, =GetEndpointRequest);
                                                                        {5199}new SP_4655: bitstring;
                                                                        {5200}new UP_4656: bitstring;
                                                                        {5201}out(c, (GetEndpointResponse,pkSess_4654,None,SP_4655,UP_4656))
                                                                )
                                                                else
                                                                    {5202}let pkSess_4657: bitstring = fail-any in
                                                                    {5203}in(c, =GetEndpointRequest);
                                                                    {5204}new SP_4658: bitstring;
                                                                    {5205}new UP_4659: bitstring;
                                                                    {5206}out(c, (GetEndpointResponse,pkSess_4657,None,SP_4658,UP_4659))
                                                        )
                                                        else
                                                            {5207}let pkSess_4660: bitstring = fail-any in
                                                            {5208}in(c, =GetEndpointRequest);
                                                            {5209}new SP_4661: bitstring;
                                                            {5210}new UP_4662: bitstring;
                                                            {5211}out(c, (GetEndpointResponse,pkSess_4660,None,SP_4661,UP_4662))
                                                )
                                                else
                                                    {5212}let pkSess_4663: bitstring = fail-any in
                                                    {5213}in(c, =GetEndpointRequest);
                                                    {5214}new SP_4664: bitstring;
                                                    {5215}new UP_4665: bitstring;
                                                    {5216}out(c, (GetEndpointResponse,pkSess_4663,None,SP_4664,UP_4665))
                                            )
                                            else
                                                {5217}let pkCli_4666: bitstring = pub(sk(Cli_4222)) in
                                                {5218}let v_4667: bool = (Sess_4224 = A) in
                                                (
                                                    {5219}if v_4667 then
                                                    (
                                                        {5220}let pkSess_4668: bitstring = pub(skA) in
                                                        {5221}in(c, =GetEndpointRequest);
                                                        {5222}new SP_4669: bitstring;
                                                        {5223}new UP_4670: bitstring;
                                                        {5224}out(c, (GetEndpointResponse,pkSess_4668,None,SP_4669,UP_4670))
                                                    )
                                                    else
                                                        {5225}let v_4671: bool = (Sess_4224 = B) in
                                                        (
                                                            {5226}if v_4671 then
                                                            (
                                                                {5227}let pkSess_4672: bitstring = pub(skB) in
                                                                {5228}in(c, =GetEndpointRequest);
                                                                {5229}new SP_4673: bitstring;
                                                                {5230}new UP_4674: bitstring;
                                                                {5231}out(c, (GetEndpointResponse,pkSess_4672,None,SP_4673,UP_4674))
                                                            )
                                                            else
                                                                {5232}let v_4675: bool = (Sess_4224 = C) in
                                                                (
                                                                    {5233}if v_4675 then
                                                                    (
                                                                        {5234}let pkSess_4676: bitstring = pub(skC) in
                                                                        {5235}in(c, =GetEndpointRequest);
                                                                        {5236}new SP_4677: bitstring;
                                                                        {5237}new UP_4678: bitstring;
                                                                        {5238}out(c, (GetEndpointResponse,pkSess_4676,None,SP_4677,UP_4678))
                                                                    )
                                                                    else
                                                                        {5239}let pkSess_4679: bitstring = pub(sk(Sess_4224)) in
                                                                        {5240}in(c, =GetEndpointRequest);
                                                                        {5241}new SP_4680: bitstring;
                                                                        {5242}new UP_4681: bitstring;
                                                                        {5243}out(c, (GetEndpointResponse,pkSess_4679,None,SP_4680,UP_4681))
                                                                )
                                                                else
                                                                    {5244}let pkSess_4682: bitstring = fail-any in
                                                                    {5245}in(c, =GetEndpointRequest);
                                                                    {5246}new SP_4683: bitstring;
                                                                    {5247}new UP_4684: bitstring;
                                                                    {5248}out(c, (GetEndpointResponse,pkSess_4682,None,SP_4683,UP_4684))
                                                        )
                                                        else
                                                            {5249}let pkSess_4685: bitstring = fail-any in
                                                            {5250}in(c, =GetEndpointRequest);
                                                            {5251}new SP_4686: bitstring;
                                                            {5252}new UP_4687: bitstring;
                                                            {5253}out(c, (GetEndpointResponse,pkSess_4685,None,SP_4686,UP_4687))
                                                )
                                                else
                                                    {5254}let pkSess_4688: bitstring = fail-any in
                                                    {5255}in(c, =GetEndpointRequest);
                                                    {5256}new SP_4689: bitstring;
                                                    {5257}new UP_4690: bitstring;
                                                    {5258}out(c, (GetEndpointResponse,pkSess_4688,None,SP_4689,UP_4690))
                                        )
                                        else
                                            {5259}let pkCli_4691: bitstring = fail-any in
                                            {5260}let v_4692: bool = (Sess_4224 = A) in
                                            (
                                                {5261}if v_4692 then
                                                (
                                                    {5262}let pkSess_4693: bitstring = pub(skA) in
                                                    {5263}in(c, =GetEndpointRequest);
                                                    {5264}new SP_4694: bitstring;
                                                    {5265}new UP_4695: bitstring;
                                                    {5266}out(c, (GetEndpointResponse,pkSess_4693,None,SP_4694,UP_4695))
                                                )
                                                else
                                                    {5267}let v_4696: bool = (Sess_4224 = B) in
                                                    (
                                                        {5268}if v_4696 then
                                                        (
                                                            {5269}let pkSess_4697: bitstring = pub(skB) in
                                                            {5270}in(c, =GetEndpointRequest);
                                                            {5271}new SP_4698: bitstring;
                                                            {5272}new UP_4699: bitstring;
                                                            {5273}out(c, (GetEndpointResponse,pkSess_4697,None,SP_4698,UP_4699))
                                                        )
                                                        else
                                                            {5274}let v_4700: bool = (Sess_4224 = C) in
                                                            (
                                                                {5275}if v_4700 then
                                                                (
                                                                    {5276}let pkSess_4701: bitstring = pub(skC) in
                                                                    {5277}in(c, =GetEndpointRequest);
                                                                    {5278}new SP_4702: bitstring;
                                                                    {5279}new UP_4703: bitstring;
                                                                    {5280}out(c, (GetEndpointResponse,pkSess_4701,None,SP_4702,UP_4703))
                                                                )
                                                                else
                                                                    {5281}let pkSess_4704: bitstring = pub(sk(Sess_4224)) in
                                                                    {5282}in(c, =GetEndpointRequest);
                                                                    {5283}new SP_4705: bitstring;
                                                                    {5284}new UP_4706: bitstring;
                                                                    {5285}out(c, (GetEndpointResponse,pkSess_4704,None,SP_4705,UP_4706))
                                                            )
                                                            else
                                                                {5286}let pkSess_4707: bitstring = fail-any in
                                                                {5287}in(c, =GetEndpointRequest);
                                                                {5288}new SP_4708: bitstring;
                                                                {5289}new UP_4709: bitstring;
                                                                {5290}out(c, (GetEndpointResponse,pkSess_4707,None,SP_4708,UP_4709))
                                                    )
                                                    else
                                                        {5291}let pkSess_4710: bitstring = fail-any in
                                                        {5292}in(c, =GetEndpointRequest);
                                                        {5293}new SP_4711: bitstring;
                                                        {5294}new UP_4712: bitstring;
                                                        {5295}out(c, (GetEndpointResponse,pkSess_4710,None,SP_4711,UP_4712))
                                            )
                                            else
                                                {5296}let pkSess_4713: bitstring = fail-any in
                                                {5297}in(c, =GetEndpointRequest);
                                                {5298}new SP_4714: bitstring;
                                                {5299}new UP_4715: bitstring;
                                                {5300}out(c, (GetEndpointResponse,pkSess_4713,None,SP_4714,UP_4715))
                                )
                                else
                                    {5301}let pkCli_4716: bitstring = fail-any in
                                    {5302}let v_4717: bool = (Sess_4224 = A) in
                                    (
                                        {5303}if v_4717 then
                                        (
                                            {5304}let pkSess_4718: bitstring = pub(skA) in
                                            {5305}in(c, =GetEndpointRequest);
                                            {5306}new SP_4719: bitstring;
                                            {5307}new UP_4720: bitstring;
                                            {5308}out(c, (GetEndpointResponse,pkSess_4718,None,SP_4719,UP_4720))
                                        )
                                        else
                                            {5309}let v_4721: bool = (Sess_4224 = B) in
                                            (
                                                {5310}if v_4721 then
                                                (
                                                    {5311}let pkSess_4722: bitstring = pub(skB) in
                                                    {5312}in(c, =GetEndpointRequest);
                                                    {5313}new SP_4723: bitstring;
                                                    {5314}new UP_4724: bitstring;
                                                    {5315}out(c, (GetEndpointResponse,pkSess_4722,None,SP_4723,UP_4724))
                                                )
                                                else
                                                    {5316}let v_4725: bool = (Sess_4224 = C) in
                                                    (
                                                        {5317}if v_4725 then
                                                        (
                                                            {5318}let pkSess_4726: bitstring = pub(skC) in
                                                            {5319}in(c, =GetEndpointRequest);
                                                            {5320}new SP_4727: bitstring;
                                                            {5321}new UP_4728: bitstring;
                                                            {5322}out(c, (GetEndpointResponse,pkSess_4726,None,SP_4727,UP_4728))
                                                        )
                                                        else
                                                            {5323}let pkSess_4729: bitstring = pub(sk(Sess_4224)) in
                                                            {5324}in(c, =GetEndpointRequest);
                                                            {5325}new SP_4730: bitstring;
                                                            {5326}new UP_4731: bitstring;
                                                            {5327}out(c, (GetEndpointResponse,pkSess_4729,None,SP_4730,UP_4731))
                                                    )
                                                    else
                                                        {5328}let pkSess_4732: bitstring = fail-any in
                                                        {5329}in(c, =GetEndpointRequest);
                                                        {5330}new SP_4733: bitstring;
                                                        {5331}new UP_4734: bitstring;
                                                        {5332}out(c, (GetEndpointResponse,pkSess_4732,None,SP_4733,UP_4734))
                                            )
                                            else
                                                {5333}let pkSess_4735: bitstring = fail-any in
                                                {5334}in(c, =GetEndpointRequest);
                                                {5335}new SP_4736: bitstring;
                                                {5336}new UP_4737: bitstring;
                                                {5337}out(c, (GetEndpointResponse,pkSess_4735,None,SP_4736,UP_4737))
                                    )
                                    else
                                        {5338}let pkSess_4738: bitstring = fail-any in
                                        {5339}in(c, =GetEndpointRequest);
                                        {5340}new SP_4739: bitstring;
                                        {5341}new UP_4740: bitstring;
                                        {5342}out(c, (GetEndpointResponse,pkSess_4738,None,SP_4739,UP_4740))
                        )
                        else
                            {5343}let pkCli_4741: bitstring = fail-any in
                            {5344}let v_4742: bool = (Sess_4224 = A) in
                            (
                                {5345}if v_4742 then
                                (
                                    {5346}let pkSess_4743: bitstring = pub(skA) in
                                    {5347}in(c, =GetEndpointRequest);
                                    {5348}new SP_4744: bitstring;
                                    {5349}new UP_4745: bitstring;
                                    {5350}out(c, (GetEndpointResponse,pkSess_4743,None,SP_4744,UP_4745))
                                )
                                else
                                    {5351}let v_4746: bool = (Sess_4224 = B) in
                                    (
                                        {5352}if v_4746 then
                                        (
                                            {5353}let pkSess_4747: bitstring = pub(skB) in
                                            {5354}in(c, =GetEndpointRequest);
                                            {5355}new SP_4748: bitstring;
                                            {5356}new UP_4749: bitstring;
                                            {5357}out(c, (GetEndpointResponse,pkSess_4747,None,SP_4748,UP_4749))
                                        )
                                        else
                                            {5358}let v_4750: bool = (Sess_4224 = C) in
                                            (
                                                {5359}if v_4750 then
                                                (
                                                    {5360}let pkSess_4751: bitstring = pub(skC) in
                                                    {5361}in(c, =GetEndpointRequest);
                                                    {5362}new SP_4752: bitstring;
                                                    {5363}new UP_4753: bitstring;
                                                    {5364}out(c, (GetEndpointResponse,pkSess_4751,None,SP_4752,UP_4753))
                                                )
                                                else
                                                    {5365}let pkSess_4754: bitstring = pub(sk(Sess_4224)) in
                                                    {5366}in(c, =GetEndpointRequest);
                                                    {5367}new SP_4755: bitstring;
                                                    {5368}new UP_4756: bitstring;
                                                    {5369}out(c, (GetEndpointResponse,pkSess_4754,None,SP_4755,UP_4756))
                                            )
                                            else
                                                {5370}let pkSess_4757: bitstring = fail-any in
                                                {5371}in(c, =GetEndpointRequest);
                                                {5372}new SP_4758: bitstring;
                                                {5373}new UP_4759: bitstring;
                                                {5374}out(c, (GetEndpointResponse,pkSess_4757,None,SP_4758,UP_4759))
                                    )
                                    else
                                        {5375}let pkSess_4760: bitstring = fail-any in
                                        {5376}in(c, =GetEndpointRequest);
                                        {5377}new SP_4761: bitstring;
                                        {5378}new UP_4762: bitstring;
                                        {5379}out(c, (GetEndpointResponse,pkSess_4760,None,SP_4761,UP_4762))
                            )
                            else
                                {5380}let pkSess_4763: bitstring = fail-any in
                                {5381}in(c, =GetEndpointRequest);
                                {5382}new SP_4764: bitstring;
                                {5383}new UP_4765: bitstring;
                                {5384}out(c, (GetEndpointResponse,pkSess_4763,None,SP_4764,UP_4765))
                    )
                    else
                        {5385}let skDisco_4766: bitstring = fail-any in
                        {5386}let pkDisco_4767: bitstring = pub(skDisco_4766) in
                        {5387}let v_4768: bool = (Cli_4222 = A) in
                        (
                            {5388}if v_4768 then
                            (
                                {5389}let pkCli_4769: bitstring = pub(skA) in
                                {5390}let v_4770: bool = (Sess_4224 = A) in
                                (
                                    {5391}if v_4770 then
                                    (
                                        {5392}let pkSess_4771: bitstring = pub(skA) in
                                        {5393}in(c, =GetEndpointRequest);
                                        {5394}new SP_4772: bitstring;
                                        {5395}new UP_4773: bitstring;
                                        {5396}out(c, (GetEndpointResponse,pkSess_4771,None,SP_4772,UP_4773))
                                    )
                                    else
                                        {5397}let v_4774: bool = (Sess_4224 = B) in
                                        (
                                            {5398}if v_4774 then
                                            (
                                                {5399}let pkSess_4775: bitstring = pub(skB) in
                                                {5400}in(c, =GetEndpointRequest);
                                                {5401}new SP_4776: bitstring;
                                                {5402}new UP_4777: bitstring;
                                                {5403}out(c, (GetEndpointResponse,pkSess_4775,None,SP_4776,UP_4777))
                                            )
                                            else
                                                {5404}let v_4778: bool = (Sess_4224 = C) in
                                                (
                                                    {5405}if v_4778 then
                                                    (
                                                        {5406}let pkSess_4779: bitstring = pub(skC) in
                                                        {5407}in(c, =GetEndpointRequest);
                                                        {5408}new SP_4780: bitstring;
                                                        {5409}new UP_4781: bitstring;
                                                        {5410}out(c, (GetEndpointResponse,pkSess_4779,None,SP_4780,UP_4781))
                                                    )
                                                    else
                                                        {5411}let pkSess_4782: bitstring = pub(sk(Sess_4224)) in
                                                        {5412}in(c, =GetEndpointRequest);
                                                        {5413}new SP_4783: bitstring;
                                                        {5414}new UP_4784: bitstring;
                                                        {5415}out(c, (GetEndpointResponse,pkSess_4782,None,SP_4783,UP_4784))
                                                )
                                                else
                                                    {5416}let pkSess_4785: bitstring = fail-any in
                                                    {5417}in(c, =GetEndpointRequest);
                                                    {5418}new SP_4786: bitstring;
                                                    {5419}new UP_4787: bitstring;
                                                    {5420}out(c, (GetEndpointResponse,pkSess_4785,None,SP_4786,UP_4787))
                                        )
                                        else
                                            {5421}let pkSess_4788: bitstring = fail-any in
                                            {5422}in(c, =GetEndpointRequest);
                                            {5423}new SP_4789: bitstring;
                                            {5424}new UP_4790: bitstring;
                                            {5425}out(c, (GetEndpointResponse,pkSess_4788,None,SP_4789,UP_4790))
                                )
                                else
                                    {5426}let pkSess_4791: bitstring = fail-any in
                                    {5427}in(c, =GetEndpointRequest);
                                    {5428}new SP_4792: bitstring;
                                    {5429}new UP_4793: bitstring;
                                    {5430}out(c, (GetEndpointResponse,pkSess_4791,None,SP_4792,UP_4793))
                            )
                            else
                                {5431}let v_4794: bool = (Cli_4222 = B) in
                                (
                                    {5432}if v_4794 then
                                    (
                                        {5433}let pkCli_4795: bitstring = pub(skB) in
                                        {5434}let v_4796: bool = (Sess_4224 = A) in
                                        (
                                            {5435}if v_4796 then
                                            (
                                                {5436}let pkSess_4797: bitstring = pub(skA) in
                                                {5437}in(c, =GetEndpointRequest);
                                                {5438}new SP_4798: bitstring;
                                                {5439}new UP_4799: bitstring;
                                                {5440}out(c, (GetEndpointResponse,pkSess_4797,None,SP_4798,UP_4799))
                                            )
                                            else
                                                {5441}let v_4800: bool = (Sess_4224 = B) in
                                                (
                                                    {5442}if v_4800 then
                                                    (
                                                        {5443}let pkSess_4801: bitstring = pub(skB) in
                                                        {5444}in(c, =GetEndpointRequest);
                                                        {5445}new SP_4802: bitstring;
                                                        {5446}new UP_4803: bitstring;
                                                        {5447}out(c, (GetEndpointResponse,pkSess_4801,None,SP_4802,UP_4803))
                                                    )
                                                    else
                                                        {5448}let v_4804: bool = (Sess_4224 = C) in
                                                        (
                                                            {5449}if v_4804 then
                                                            (
                                                                {5450}let pkSess_4805: bitstring = pub(skC) in
                                                                {5451}in(c, =GetEndpointRequest);
                                                                {5452}new SP_4806: bitstring;
                                                                {5453}new UP_4807: bitstring;
                                                                {5454}out(c, (GetEndpointResponse,pkSess_4805,None,SP_4806,UP_4807))
                                                            )
                                                            else
                                                                {5455}let pkSess_4808: bitstring = pub(sk(Sess_4224)) in
                                                                {5456}in(c, =GetEndpointRequest);
                                                                {5457}new SP_4809: bitstring;
                                                                {5458}new UP_4810: bitstring;
                                                                {5459}out(c, (GetEndpointResponse,pkSess_4808,None,SP_4809,UP_4810))
                                                        )
                                                        else
                                                            {5460}let pkSess_4811: bitstring = fail-any in
                                                            {5461}in(c, =GetEndpointRequest);
                                                            {5462}new SP_4812: bitstring;
                                                            {5463}new UP_4813: bitstring;
                                                            {5464}out(c, (GetEndpointResponse,pkSess_4811,None,SP_4812,UP_4813))
                                                )
                                                else
                                                    {5465}let pkSess_4814: bitstring = fail-any in
                                                    {5466}in(c, =GetEndpointRequest);
                                                    {5467}new SP_4815: bitstring;
                                                    {5468}new UP_4816: bitstring;
                                                    {5469}out(c, (GetEndpointResponse,pkSess_4814,None,SP_4815,UP_4816))
                                        )
                                        else
                                            {5470}let pkSess_4817: bitstring = fail-any in
                                            {5471}in(c, =GetEndpointRequest);
                                            {5472}new SP_4818: bitstring;
                                            {5473}new UP_4819: bitstring;
                                            {5474}out(c, (GetEndpointResponse,pkSess_4817,None,SP_4818,UP_4819))
                                    )
                                    else
                                        {5475}let v_4820: bool = (Cli_4222 = C) in
                                        (
                                            {5476}if v_4820 then
                                            (
                                                {5477}let pkCli_4821: bitstring = pub(skC) in
                                                {5478}let v_4822: bool = (Sess_4224 = A) in
                                                (
                                                    {5479}if v_4822 then
                                                    (
                                                        {5480}let pkSess_4823: bitstring = pub(skA) in
                                                        {5481}in(c, =GetEndpointRequest);
                                                        {5482}new SP_4824: bitstring;
                                                        {5483}new UP_4825: bitstring;
                                                        {5484}out(c, (GetEndpointResponse,pkSess_4823,None,SP_4824,UP_4825))
                                                    )
                                                    else
                                                        {5485}let v_4826: bool = (Sess_4224 = B) in
                                                        (
                                                            {5486}if v_4826 then
                                                            (
                                                                {5487}let pkSess_4827: bitstring = pub(skB) in
                                                                {5488}in(c, =GetEndpointRequest);
                                                                {5489}new SP_4828: bitstring;
                                                                {5490}new UP_4829: bitstring;
                                                                {5491}out(c, (GetEndpointResponse,pkSess_4827,None,SP_4828,UP_4829))
                                                            )
                                                            else
                                                                {5492}let v_4830: bool = (Sess_4224 = C) in
                                                                (
                                                                    {5493}if v_4830 then
                                                                    (
                                                                        {5494}let pkSess_4831: bitstring = pub(skC) in
                                                                        {5495}in(c, =GetEndpointRequest);
                                                                        {5496}new SP_4832: bitstring;
                                                                        {5497}new UP_4833: bitstring;
                                                                        {5498}out(c, (GetEndpointResponse,pkSess_4831,None,SP_4832,UP_4833))
                                                                    )
                                                                    else
                                                                        {5499}let pkSess_4834: bitstring = pub(sk(Sess_4224)) in
                                                                        {5500}in(c, =GetEndpointRequest);
                                                                        {5501}new SP_4835: bitstring;
                                                                        {5502}new UP_4836: bitstring;
                                                                        {5503}out(c, (GetEndpointResponse,pkSess_4834,None,SP_4835,UP_4836))
                                                                )
                                                                else
                                                                    {5504}let pkSess_4837: bitstring = fail-any in
                                                                    {5505}in(c, =GetEndpointRequest);
                                                                    {5506}new SP_4838: bitstring;
                                                                    {5507}new UP_4839: bitstring;
                                                                    {5508}out(c, (GetEndpointResponse,pkSess_4837,None,SP_4838,UP_4839))
                                                        )
                                                        else
                                                            {5509}let pkSess_4840: bitstring = fail-any in
                                                            {5510}in(c, =GetEndpointRequest);
                                                            {5511}new SP_4841: bitstring;
                                                            {5512}new UP_4842: bitstring;
                                                            {5513}out(c, (GetEndpointResponse,pkSess_4840,None,SP_4841,UP_4842))
                                                )
                                                else
                                                    {5514}let pkSess_4843: bitstring = fail-any in
                                                    {5515}in(c, =GetEndpointRequest);
                                                    {5516}new SP_4844: bitstring;
                                                    {5517}new UP_4845: bitstring;
                                                    {5518}out(c, (GetEndpointResponse,pkSess_4843,None,SP_4844,UP_4845))
                                            )
                                            else
                                                {5519}let pkCli_4846: bitstring = pub(sk(Cli_4222)) in
                                                {5520}let v_4847: bool = (Sess_4224 = A) in
                                                (
                                                    {5521}if v_4847 then
                                                    (
                                                        {5522}let pkSess_4848: bitstring = pub(skA) in
                                                        {5523}in(c, =GetEndpointRequest);
                                                        {5524}new SP_4849: bitstring;
                                                        {5525}new UP_4850: bitstring;
                                                        {5526}out(c, (GetEndpointResponse,pkSess_4848,None,SP_4849,UP_4850))
                                                    )
                                                    else
                                                        {5527}let v_4851: bool = (Sess_4224 = B) in
                                                        (
                                                            {5528}if v_4851 then
                                                            (
                                                                {5529}let pkSess_4852: bitstring = pub(skB) in
                                                                {5530}in(c, =GetEndpointRequest);
                                                                {5531}new SP_4853: bitstring;
                                                                {5532}new UP_4854: bitstring;
                                                                {5533}out(c, (GetEndpointResponse,pkSess_4852,None,SP_4853,UP_4854))
                                                            )
                                                            else
                                                                {5534}let v_4855: bool = (Sess_4224 = C) in
                                                                (
                                                                    {5535}if v_4855 then
                                                                    (
                                                                        {5536}let pkSess_4856: bitstring = pub(skC) in
                                                                        {5537}in(c, =GetEndpointRequest);
                                                                        {5538}new SP_4857: bitstring;
                                                                        {5539}new UP_4858: bitstring;
                                                                        {5540}out(c, (GetEndpointResponse,pkSess_4856,None,SP_4857,UP_4858))
                                                                    )
                                                                    else
                                                                        {5541}let pkSess_4859: bitstring = pub(sk(Sess_4224)) in
                                                                        {5542}in(c, =GetEndpointRequest);
                                                                        {5543}new SP_4860: bitstring;
                                                                        {5544}new UP_4861: bitstring;
                                                                        {5545}out(c, (GetEndpointResponse,pkSess_4859,None,SP_4860,UP_4861))
                                                                )
                                                                else
                                                                    {5546}let pkSess_4862: bitstring = fail-any in
                                                                    {5547}in(c, =GetEndpointRequest);
                                                                    {5548}new SP_4863: bitstring;
                                                                    {5549}new UP_4864: bitstring;
                                                                    {5550}out(c, (GetEndpointResponse,pkSess_4862,None,SP_4863,UP_4864))
                                                        )
                                                        else
                                                            {5551}let pkSess_4865: bitstring = fail-any in
                                                            {5552}in(c, =GetEndpointRequest);
                                                            {5553}new SP_4866: bitstring;
                                                            {5554}new UP_4867: bitstring;
                                                            {5555}out(c, (GetEndpointResponse,pkSess_4865,None,SP_4866,UP_4867))
                                                )
                                                else
                                                    {5556}let pkSess_4868: bitstring = fail-any in
                                                    {5557}in(c, =GetEndpointRequest);
                                                    {5558}new SP_4869: bitstring;
                                                    {5559}new UP_4870: bitstring;
                                                    {5560}out(c, (GetEndpointResponse,pkSess_4868,None,SP_4869,UP_4870))
                                        )
                                        else
                                            {5561}let pkCli_4871: bitstring = fail-any in
                                            {5562}let v_4872: bool = (Sess_4224 = A) in
                                            (
                                                {5563}if v_4872 then
                                                (
                                                    {5564}let pkSess_4873: bitstring = pub(skA) in
                                                    {5565}in(c, =GetEndpointRequest);
                                                    {5566}new SP_4874: bitstring;
                                                    {5567}new UP_4875: bitstring;
                                                    {5568}out(c, (GetEndpointResponse,pkSess_4873,None,SP_4874,UP_4875))
                                                )
                                                else
                                                    {5569}let v_4876: bool = (Sess_4224 = B) in
                                                    (
                                                        {5570}if v_4876 then
                                                        (
                                                            {5571}let pkSess_4877: bitstring = pub(skB) in
                                                            {5572}in(c, =GetEndpointRequest);
                                                            {5573}new SP_4878: bitstring;
                                                            {5574}new UP_4879: bitstring;
                                                            {5575}out(c, (GetEndpointResponse,pkSess_4877,None,SP_4878,UP_4879))
                                                        )
                                                        else
                                                            {5576}let v_4880: bool = (Sess_4224 = C) in
                                                            (
                                                                {5577}if v_4880 then
                                                                (
                                                                    {5578}let pkSess_4881: bitstring = pub(skC) in
                                                                    {5579}in(c, =GetEndpointRequest);
                                                                    {5580}new SP_4882: bitstring;
                                                                    {5581}new UP_4883: bitstring;
                                                                    {5582}out(c, (GetEndpointResponse,pkSess_4881,None,SP_4882,UP_4883))
                                                                )
                                                                else
                                                                    {5583}let pkSess_4884: bitstring = pub(sk(Sess_4224)) in
                                                                    {5584}in(c, =GetEndpointRequest);
                                                                    {5585}new SP_4885: bitstring;
                                                                    {5586}new UP_4886: bitstring;
                                                                    {5587}out(c, (GetEndpointResponse,pkSess_4884,None,SP_4885,UP_4886))
                                                            )
                                                            else
                                                                {5588}let pkSess_4887: bitstring = fail-any in
                                                                {5589}in(c, =GetEndpointRequest);
                                                                {5590}new SP_4888: bitstring;
                                                                {5591}new UP_4889: bitstring;
                                                                {5592}out(c, (GetEndpointResponse,pkSess_4887,None,SP_4888,UP_4889))
                                                    )
                                                    else
                                                        {5593}let pkSess_4890: bitstring = fail-any in
                                                        {5594}in(c, =GetEndpointRequest);
                                                        {5595}new SP_4891: bitstring;
                                                        {5596}new UP_4892: bitstring;
                                                        {5597}out(c, (GetEndpointResponse,pkSess_4890,None,SP_4891,UP_4892))
                                            )
                                            else
                                                {5598}let pkSess_4893: bitstring = fail-any in
                                                {5599}in(c, =GetEndpointRequest);
                                                {5600}new SP_4894: bitstring;
                                                {5601}new UP_4895: bitstring;
                                                {5602}out(c, (GetEndpointResponse,pkSess_4893,None,SP_4894,UP_4895))
                                )
                                else
                                    {5603}let pkCli_4896: bitstring = fail-any in
                                    {5604}let v_4897: bool = (Sess_4224 = A) in
                                    (
                                        {5605}if v_4897 then
                                        (
                                            {5606}let pkSess_4898: bitstring = pub(skA) in
                                            {5607}in(c, =GetEndpointRequest);
                                            {5608}new SP_4899: bitstring;
                                            {5609}new UP_4900: bitstring;
                                            {5610}out(c, (GetEndpointResponse,pkSess_4898,None,SP_4899,UP_4900))
                                        )
                                        else
                                            {5611}let v_4901: bool = (Sess_4224 = B) in
                                            (
                                                {5612}if v_4901 then
                                                (
                                                    {5613}let pkSess_4902: bitstring = pub(skB) in
                                                    {5614}in(c, =GetEndpointRequest);
                                                    {5615}new SP_4903: bitstring;
                                                    {5616}new UP_4904: bitstring;
                                                    {5617}out(c, (GetEndpointResponse,pkSess_4902,None,SP_4903,UP_4904))
                                                )
                                                else
                                                    {5618}let v_4905: bool = (Sess_4224 = C) in
                                                    (
                                                        {5619}if v_4905 then
                                                        (
                                                            {5620}let pkSess_4906: bitstring = pub(skC) in
                                                            {5621}in(c, =GetEndpointRequest);
                                                            {5622}new SP_4907: bitstring;
                                                            {5623}new UP_4908: bitstring;
                                                            {5624}out(c, (GetEndpointResponse,pkSess_4906,None,SP_4907,UP_4908))
                                                        )
                                                        else
                                                            {5625}let pkSess_4909: bitstring = pub(sk(Sess_4224)) in
                                                            {5626}in(c, =GetEndpointRequest);
                                                            {5627}new SP_4910: bitstring;
                                                            {5628}new UP_4911: bitstring;
                                                            {5629}out(c, (GetEndpointResponse,pkSess_4909,None,SP_4910,UP_4911))
                                                    )
                                                    else
                                                        {5630}let pkSess_4912: bitstring = fail-any in
                                                        {5631}in(c, =GetEndpointRequest);
                                                        {5632}new SP_4913: bitstring;
                                                        {5633}new UP_4914: bitstring;
                                                        {5634}out(c, (GetEndpointResponse,pkSess_4912,None,SP_4913,UP_4914))
                                            )
                                            else
                                                {5635}let pkSess_4915: bitstring = fail-any in
                                                {5636}in(c, =GetEndpointRequest);
                                                {5637}new SP_4916: bitstring;
                                                {5638}new UP_4917: bitstring;
                                                {5639}out(c, (GetEndpointResponse,pkSess_4915,None,SP_4916,UP_4917))
                                    )
                                    else
                                        {5640}let pkSess_4918: bitstring = fail-any in
                                        {5641}in(c, =GetEndpointRequest);
                                        {5642}new SP_4919: bitstring;
                                        {5643}new UP_4920: bitstring;
                                        {5644}out(c, (GetEndpointResponse,pkSess_4918,None,SP_4919,UP_4920))
                        )
                        else
                            {5645}let pkCli_4921: bitstring = fail-any in
                            {5646}let v_4922: bool = (Sess_4224 = A) in
                            (
                                {5647}if v_4922 then
                                (
                                    {5648}let pkSess_4923: bitstring = pub(skA) in
                                    {5649}in(c, =GetEndpointRequest);
                                    {5650}new SP_4924: bitstring;
                                    {5651}new UP_4925: bitstring;
                                    {5652}out(c, (GetEndpointResponse,pkSess_4923,None,SP_4924,UP_4925))
                                )
                                else
                                    {5653}let v_4926: bool = (Sess_4224 = B) in
                                    (
                                        {5654}if v_4926 then
                                        (
                                            {5655}let pkSess_4927: bitstring = pub(skB) in
                                            {5656}in(c, =GetEndpointRequest);
                                            {5657}new SP_4928: bitstring;
                                            {5658}new UP_4929: bitstring;
                                            {5659}out(c, (GetEndpointResponse,pkSess_4927,None,SP_4928,UP_4929))
                                        )
                                        else
                                            {5660}let v_4930: bool = (Sess_4224 = C) in
                                            (
                                                {5661}if v_4930 then
                                                (
                                                    {5662}let pkSess_4931: bitstring = pub(skC) in
                                                    {5663}in(c, =GetEndpointRequest);
                                                    {5664}new SP_4932: bitstring;
                                                    {5665}new UP_4933: bitstring;
                                                    {5666}out(c, (GetEndpointResponse,pkSess_4931,None,SP_4932,UP_4933))
                                                )
                                                else
                                                    {5667}let pkSess_4934: bitstring = pub(sk(Sess_4224)) in
                                                    {5668}in(c, =GetEndpointRequest);
                                                    {5669}new SP_4935: bitstring;
                                                    {5670}new UP_4936: bitstring;
                                                    {5671}out(c, (GetEndpointResponse,pkSess_4934,None,SP_4935,UP_4936))
                                            )
                                            else
                                                {5672}let pkSess_4937: bitstring = fail-any in
                                                {5673}in(c, =GetEndpointRequest);
                                                {5674}new SP_4938: bitstring;
                                                {5675}new UP_4939: bitstring;
                                                {5676}out(c, (GetEndpointResponse,pkSess_4937,None,SP_4938,UP_4939))
                                    )
                                    else
                                        {5677}let pkSess_4940: bitstring = fail-any in
                                        {5678}in(c, =GetEndpointRequest);
                                        {5679}new SP_4941: bitstring;
                                        {5680}new UP_4942: bitstring;
                                        {5681}out(c, (GetEndpointResponse,pkSess_4940,None,SP_4941,UP_4942))
                            )
                            else
                                {5682}let pkSess_4943: bitstring = fail-any in
                                {5683}in(c, =GetEndpointRequest);
                                {5684}new SP_4944: bitstring;
                                {5685}new UP_4945: bitstring;
                                {5686}out(c, (GetEndpointResponse,pkSess_4943,None,SP_4944,UP_4945))
            )
            else
                {5687}let skDisco_4946: bitstring = fail-any in
                {5688}let pkDisco_4947: bitstring = pub(skDisco_4946) in
                {5689}let v_4948: bool = (Cli_4222 = A) in
                (
                    {5690}if v_4948 then
                    (
                        {5691}let pkCli_4949: bitstring = pub(skA) in
                        {5692}let v_4950: bool = (Sess_4224 = A) in
                        (
                            {5693}if v_4950 then
                            (
                                {5694}let pkSess_4951: bitstring = pub(skA) in
                                {5695}in(c, =GetEndpointRequest);
                                {5696}new SP_4952: bitstring;
                                {5697}new UP_4953: bitstring;
                                {5698}out(c, (GetEndpointResponse,pkSess_4951,None,SP_4952,UP_4953))
                            )
                            else
                                {5699}let v_4954: bool = (Sess_4224 = B) in
                                (
                                    {5700}if v_4954 then
                                    (
                                        {5701}let pkSess_4955: bitstring = pub(skB) in
                                        {5702}in(c, =GetEndpointRequest);
                                        {5703}new SP_4956: bitstring;
                                        {5704}new UP_4957: bitstring;
                                        {5705}out(c, (GetEndpointResponse,pkSess_4955,None,SP_4956,UP_4957))
                                    )
                                    else
                                        {5706}let v_4958: bool = (Sess_4224 = C) in
                                        (
                                            {5707}if v_4958 then
                                            (
                                                {5708}let pkSess_4959: bitstring = pub(skC) in
                                                {5709}in(c, =GetEndpointRequest);
                                                {5710}new SP_4960: bitstring;
                                                {5711}new UP_4961: bitstring;
                                                {5712}out(c, (GetEndpointResponse,pkSess_4959,None,SP_4960,UP_4961))
                                            )
                                            else
                                                {5713}let pkSess_4962: bitstring = pub(sk(Sess_4224)) in
                                                {5714}in(c, =GetEndpointRequest);
                                                {5715}new SP_4963: bitstring;
                                                {5716}new UP_4964: bitstring;
                                                {5717}out(c, (GetEndpointResponse,pkSess_4962,None,SP_4963,UP_4964))
                                        )
                                        else
                                            {5718}let pkSess_4965: bitstring = fail-any in
                                            {5719}in(c, =GetEndpointRequest);
                                            {5720}new SP_4966: bitstring;
                                            {5721}new UP_4967: bitstring;
                                            {5722}out(c, (GetEndpointResponse,pkSess_4965,None,SP_4966,UP_4967))
                                )
                                else
                                    {5723}let pkSess_4968: bitstring = fail-any in
                                    {5724}in(c, =GetEndpointRequest);
                                    {5725}new SP_4969: bitstring;
                                    {5726}new UP_4970: bitstring;
                                    {5727}out(c, (GetEndpointResponse,pkSess_4968,None,SP_4969,UP_4970))
                        )
                        else
                            {5728}let pkSess_4971: bitstring = fail-any in
                            {5729}in(c, =GetEndpointRequest);
                            {5730}new SP_4972: bitstring;
                            {5731}new UP_4973: bitstring;
                            {5732}out(c, (GetEndpointResponse,pkSess_4971,None,SP_4972,UP_4973))
                    )
                    else
                        {5733}let v_4974: bool = (Cli_4222 = B) in
                        (
                            {5734}if v_4974 then
                            (
                                {5735}let pkCli_4975: bitstring = pub(skB) in
                                {5736}let v_4976: bool = (Sess_4224 = A) in
                                (
                                    {5737}if v_4976 then
                                    (
                                        {5738}let pkSess_4977: bitstring = pub(skA) in
                                        {5739}in(c, =GetEndpointRequest);
                                        {5740}new SP_4978: bitstring;
                                        {5741}new UP_4979: bitstring;
                                        {5742}out(c, (GetEndpointResponse,pkSess_4977,None,SP_4978,UP_4979))
                                    )
                                    else
                                        {5743}let v_4980: bool = (Sess_4224 = B) in
                                        (
                                            {5744}if v_4980 then
                                            (
                                                {5745}let pkSess_4981: bitstring = pub(skB) in
                                                {5746}in(c, =GetEndpointRequest);
                                                {5747}new SP_4982: bitstring;
                                                {5748}new UP_4983: bitstring;
                                                {5749}out(c, (GetEndpointResponse,pkSess_4981,None,SP_4982,UP_4983))
                                            )
                                            else
                                                {5750}let v_4984: bool = (Sess_4224 = C) in
                                                (
                                                    {5751}if v_4984 then
                                                    (
                                                        {5752}let pkSess_4985: bitstring = pub(skC) in
                                                        {5753}in(c, =GetEndpointRequest);
                                                        {5754}new SP_4986: bitstring;
                                                        {5755}new UP_4987: bitstring;
                                                        {5756}out(c, (GetEndpointResponse,pkSess_4985,None,SP_4986,UP_4987))
                                                    )
                                                    else
                                                        {5757}let pkSess_4988: bitstring = pub(sk(Sess_4224)) in
                                                        {5758}in(c, =GetEndpointRequest);
                                                        {5759}new SP_4989: bitstring;
                                                        {5760}new UP_4990: bitstring;
                                                        {5761}out(c, (GetEndpointResponse,pkSess_4988,None,SP_4989,UP_4990))
                                                )
                                                else
                                                    {5762}let pkSess_4991: bitstring = fail-any in
                                                    {5763}in(c, =GetEndpointRequest);
                                                    {5764}new SP_4992: bitstring;
                                                    {5765}new UP_4993: bitstring;
                                                    {5766}out(c, (GetEndpointResponse,pkSess_4991,None,SP_4992,UP_4993))
                                        )
                                        else
                                            {5767}let pkSess_4994: bitstring = fail-any in
                                            {5768}in(c, =GetEndpointRequest);
                                            {5769}new SP_4995: bitstring;
                                            {5770}new UP_4996: bitstring;
                                            {5771}out(c, (GetEndpointResponse,pkSess_4994,None,SP_4995,UP_4996))
                                )
                                else
                                    {5772}let pkSess_4997: bitstring = fail-any in
                                    {5773}in(c, =GetEndpointRequest);
                                    {5774}new SP_4998: bitstring;
                                    {5775}new UP_4999: bitstring;
                                    {5776}out(c, (GetEndpointResponse,pkSess_4997,None,SP_4998,UP_4999))
                            )
                            else
                                {5777}let v_5000: bool = (Cli_4222 = C) in
                                (
                                    {5778}if v_5000 then
                                    (
                                        {5779}let pkCli_5001: bitstring = pub(skC) in
                                        {5780}let v_5002: bool = (Sess_4224 = A) in
                                        (
                                            {5781}if v_5002 then
                                            (
                                                {5782}let pkSess_5003: bitstring = pub(skA) in
                                                {5783}in(c, =GetEndpointRequest);
                                                {5784}new SP_5004: bitstring;
                                                {5785}new UP_5005: bitstring;
                                                {5786}out(c, (GetEndpointResponse,pkSess_5003,None,SP_5004,UP_5005))
                                            )
                                            else
                                                {5787}let v_5006: bool = (Sess_4224 = B) in
                                                (
                                                    {5788}if v_5006 then
                                                    (
                                                        {5789}let pkSess_5007: bitstring = pub(skB) in
                                                        {5790}in(c, =GetEndpointRequest);
                                                        {5791}new SP_5008: bitstring;
                                                        {5792}new UP_5009: bitstring;
                                                        {5793}out(c, (GetEndpointResponse,pkSess_5007,None,SP_5008,UP_5009))
                                                    )
                                                    else
                                                        {5794}let v_5010: bool = (Sess_4224 = C) in
                                                        (
                                                            {5795}if v_5010 then
                                                            (
                                                                {5796}let pkSess_5011: bitstring = pub(skC) in
                                                                {5797}in(c, =GetEndpointRequest);
                                                                {5798}new SP_5012: bitstring;
                                                                {5799}new UP_5013: bitstring;
                                                                {5800}out(c, (GetEndpointResponse,pkSess_5011,None,SP_5012,UP_5013))
                                                            )
                                                            else
                                                                {5801}let pkSess_5014: bitstring = pub(sk(Sess_4224)) in
                                                                {5802}in(c, =GetEndpointRequest);
                                                                {5803}new SP_5015: bitstring;
                                                                {5804}new UP_5016: bitstring;
                                                                {5805}out(c, (GetEndpointResponse,pkSess_5014,None,SP_5015,UP_5016))
                                                        )
                                                        else
                                                            {5806}let pkSess_5017: bitstring = fail-any in
                                                            {5807}in(c, =GetEndpointRequest);
                                                            {5808}new SP_5018: bitstring;
                                                            {5809}new UP_5019: bitstring;
                                                            {5810}out(c, (GetEndpointResponse,pkSess_5017,None,SP_5018,UP_5019))
                                                )
                                                else
                                                    {5811}let pkSess_5020: bitstring = fail-any in
                                                    {5812}in(c, =GetEndpointRequest);
                                                    {5813}new SP_5021: bitstring;
                                                    {5814}new UP_5022: bitstring;
                                                    {5815}out(c, (GetEndpointResponse,pkSess_5020,None,SP_5021,UP_5022))
                                        )
                                        else
                                            {5816}let pkSess_5023: bitstring = fail-any in
                                            {5817}in(c, =GetEndpointRequest);
                                            {5818}new SP_5024: bitstring;
                                            {5819}new UP_5025: bitstring;
                                            {5820}out(c, (GetEndpointResponse,pkSess_5023,None,SP_5024,UP_5025))
                                    )
                                    else
                                        {5821}let pkCli_5026: bitstring = pub(sk(Cli_4222)) in
                                        {5822}let v_5027: bool = (Sess_4224 = A) in
                                        (
                                            {5823}if v_5027 then
                                            (
                                                {5824}let pkSess_5028: bitstring = pub(skA) in
                                                {5825}in(c, =GetEndpointRequest);
                                                {5826}new SP_5029: bitstring;
                                                {5827}new UP_5030: bitstring;
                                                {5828}out(c, (GetEndpointResponse,pkSess_5028,None,SP_5029,UP_5030))
                                            )
                                            else
                                                {5829}let v_5031: bool = (Sess_4224 = B) in
                                                (
                                                    {5830}if v_5031 then
                                                    (
                                                        {5831}let pkSess_5032: bitstring = pub(skB) in
                                                        {5832}in(c, =GetEndpointRequest);
                                                        {5833}new SP_5033: bitstring;
                                                        {5834}new UP_5034: bitstring;
                                                        {5835}out(c, (GetEndpointResponse,pkSess_5032,None,SP_5033,UP_5034))
                                                    )
                                                    else
                                                        {5836}let v_5035: bool = (Sess_4224 = C) in
                                                        (
                                                            {5837}if v_5035 then
                                                            (
                                                                {5838}let pkSess_5036: bitstring = pub(skC) in
                                                                {5839}in(c, =GetEndpointRequest);
                                                                {5840}new SP_5037: bitstring;
                                                                {5841}new UP_5038: bitstring;
                                                                {5842}out(c, (GetEndpointResponse,pkSess_5036,None,SP_5037,UP_5038))
                                                            )
                                                            else
                                                                {5843}let pkSess_5039: bitstring = pub(sk(Sess_4224)) in
                                                                {5844}in(c, =GetEndpointRequest);
                                                                {5845}new SP_5040: bitstring;
                                                                {5846}new UP_5041: bitstring;
                                                                {5847}out(c, (GetEndpointResponse,pkSess_5039,None,SP_5040,UP_5041))
                                                        )
                                                        else
                                                            {5848}let pkSess_5042: bitstring = fail-any in
                                                            {5849}in(c, =GetEndpointRequest);
                                                            {5850}new SP_5043: bitstring;
                                                            {5851}new UP_5044: bitstring;
                                                            {5852}out(c, (GetEndpointResponse,pkSess_5042,None,SP_5043,UP_5044))
                                                )
                                                else
                                                    {5853}let pkSess_5045: bitstring = fail-any in
                                                    {5854}in(c, =GetEndpointRequest);
                                                    {5855}new SP_5046: bitstring;
                                                    {5856}new UP_5047: bitstring;
                                                    {5857}out(c, (GetEndpointResponse,pkSess_5045,None,SP_5046,UP_5047))
                                        )
                                        else
                                            {5858}let pkSess_5048: bitstring = fail-any in
                                            {5859}in(c, =GetEndpointRequest);
                                            {5860}new SP_5049: bitstring;
                                            {5861}new UP_5050: bitstring;
                                            {5862}out(c, (GetEndpointResponse,pkSess_5048,None,SP_5049,UP_5050))
                                )
                                else
                                    {5863}let pkCli_5051: bitstring = fail-any in
                                    {5864}let v_5052: bool = (Sess_4224 = A) in
                                    (
                                        {5865}if v_5052 then
                                        (
                                            {5866}let pkSess_5053: bitstring = pub(skA) in
                                            {5867}in(c, =GetEndpointRequest);
                                            {5868}new SP_5054: bitstring;
                                            {5869}new UP_5055: bitstring;
                                            {5870}out(c, (GetEndpointResponse,pkSess_5053,None,SP_5054,UP_5055))
                                        )
                                        else
                                            {5871}let v_5056: bool = (Sess_4224 = B) in
                                            (
                                                {5872}if v_5056 then
                                                (
                                                    {5873}let pkSess_5057: bitstring = pub(skB) in
                                                    {5874}in(c, =GetEndpointRequest);
                                                    {5875}new SP_5058: bitstring;
                                                    {5876}new UP_5059: bitstring;
                                                    {5877}out(c, (GetEndpointResponse,pkSess_5057,None,SP_5058,UP_5059))
                                                )
                                                else
                                                    {5878}let v_5060: bool = (Sess_4224 = C) in
                                                    (
                                                        {5879}if v_5060 then
                                                        (
                                                            {5880}let pkSess_5061: bitstring = pub(skC) in
                                                            {5881}in(c, =GetEndpointRequest);
                                                            {5882}new SP_5062: bitstring;
                                                            {5883}new UP_5063: bitstring;
                                                            {5884}out(c, (GetEndpointResponse,pkSess_5061,None,SP_5062,UP_5063))
                                                        )
                                                        else
                                                            {5885}let pkSess_5064: bitstring = pub(sk(Sess_4224)) in
                                                            {5886}in(c, =GetEndpointRequest);
                                                            {5887}new SP_5065: bitstring;
                                                            {5888}new UP_5066: bitstring;
                                                            {5889}out(c, (GetEndpointResponse,pkSess_5064,None,SP_5065,UP_5066))
                                                    )
                                                    else
                                                        {5890}let pkSess_5067: bitstring = fail-any in
                                                        {5891}in(c, =GetEndpointRequest);
                                                        {5892}new SP_5068: bitstring;
                                                        {5893}new UP_5069: bitstring;
                                                        {5894}out(c, (GetEndpointResponse,pkSess_5067,None,SP_5068,UP_5069))
                                            )
                                            else
                                                {5895}let pkSess_5070: bitstring = fail-any in
                                                {5896}in(c, =GetEndpointRequest);
                                                {5897}new SP_5071: bitstring;
                                                {5898}new UP_5072: bitstring;
                                                {5899}out(c, (GetEndpointResponse,pkSess_5070,None,SP_5071,UP_5072))
                                    )
                                    else
                                        {5900}let pkSess_5073: bitstring = fail-any in
                                        {5901}in(c, =GetEndpointRequest);
                                        {5902}new SP_5074: bitstring;
                                        {5903}new UP_5075: bitstring;
                                        {5904}out(c, (GetEndpointResponse,pkSess_5073,None,SP_5074,UP_5075))
                        )
                        else
                            {5905}let pkCli_5076: bitstring = fail-any in
                            {5906}let v_5077: bool = (Sess_4224 = A) in
                            (
                                {5907}if v_5077 then
                                (
                                    {5908}let pkSess_5078: bitstring = pub(skA) in
                                    {5909}in(c, =GetEndpointRequest);
                                    {5910}new SP_5079: bitstring;
                                    {5911}new UP_5080: bitstring;
                                    {5912}out(c, (GetEndpointResponse,pkSess_5078,None,SP_5079,UP_5080))
                                )
                                else
                                    {5913}let v_5081: bool = (Sess_4224 = B) in
                                    (
                                        {5914}if v_5081 then
                                        (
                                            {5915}let pkSess_5082: bitstring = pub(skB) in
                                            {5916}in(c, =GetEndpointRequest);
                                            {5917}new SP_5083: bitstring;
                                            {5918}new UP_5084: bitstring;
                                            {5919}out(c, (GetEndpointResponse,pkSess_5082,None,SP_5083,UP_5084))
                                        )
                                        else
                                            {5920}let v_5085: bool = (Sess_4224 = C) in
                                            (
                                                {5921}if v_5085 then
                                                (
                                                    {5922}let pkSess_5086: bitstring = pub(skC) in
                                                    {5923}in(c, =GetEndpointRequest);
                                                    {5924}new SP_5087: bitstring;
                                                    {5925}new UP_5088: bitstring;
                                                    {5926}out(c, (GetEndpointResponse,pkSess_5086,None,SP_5087,UP_5088))
                                                )
                                                else
                                                    {5927}let pkSess_5089: bitstring = pub(sk(Sess_4224)) in
                                                    {5928}in(c, =GetEndpointRequest);
                                                    {5929}new SP_5090: bitstring;
                                                    {5930}new UP_5091: bitstring;
                                                    {5931}out(c, (GetEndpointResponse,pkSess_5089,None,SP_5090,UP_5091))
                                            )
                                            else
                                                {5932}let pkSess_5092: bitstring = fail-any in
                                                {5933}in(c, =GetEndpointRequest);
                                                {5934}new SP_5093: bitstring;
                                                {5935}new UP_5094: bitstring;
                                                {5936}out(c, (GetEndpointResponse,pkSess_5092,None,SP_5093,UP_5094))
                                    )
                                    else
                                        {5937}let pkSess_5095: bitstring = fail-any in
                                        {5938}in(c, =GetEndpointRequest);
                                        {5939}new SP_5096: bitstring;
                                        {5940}new UP_5097: bitstring;
                                        {5941}out(c, (GetEndpointResponse,pkSess_5095,None,SP_5096,UP_5097))
                            )
                            else
                                {5942}let pkSess_5098: bitstring = fail-any in
                                {5943}in(c, =GetEndpointRequest);
                                {5944}new SP_5099: bitstring;
                                {5945}new UP_5100: bitstring;
                                {5946}out(c, (GetEndpointResponse,pkSess_5098,None,SP_5099,UP_5100))
                )
                else
                    {5947}let pkCli_5101: bitstring = fail-any in
                    {5948}let v_5102: bool = (Sess_4224 = A) in
                    (
                        {5949}if v_5102 then
                        (
                            {5950}let pkSess_5103: bitstring = pub(skA) in
                            {5951}in(c, =GetEndpointRequest);
                            {5952}new SP_5104: bitstring;
                            {5953}new UP_5105: bitstring;
                            {5954}out(c, (GetEndpointResponse,pkSess_5103,None,SP_5104,UP_5105))
                        )
                        else
                            {5955}let v_5106: bool = (Sess_4224 = B) in
                            (
                                {5956}if v_5106 then
                                (
                                    {5957}let pkSess_5107: bitstring = pub(skB) in
                                    {5958}in(c, =GetEndpointRequest);
                                    {5959}new SP_5108: bitstring;
                                    {5960}new UP_5109: bitstring;
                                    {5961}out(c, (GetEndpointResponse,pkSess_5107,None,SP_5108,UP_5109))
                                )
                                else
                                    {5962}let v_5110: bool = (Sess_4224 = C) in
                                    (
                                        {5963}if v_5110 then
                                        (
                                            {5964}let pkSess_5111: bitstring = pub(skC) in
                                            {5965}in(c, =GetEndpointRequest);
                                            {5966}new SP_5112: bitstring;
                                            {5967}new UP_5113: bitstring;
                                            {5968}out(c, (GetEndpointResponse,pkSess_5111,None,SP_5112,UP_5113))
                                        )
                                        else
                                            {5969}let pkSess_5114: bitstring = pub(sk(Sess_4224)) in
                                            {5970}in(c, =GetEndpointRequest);
                                            {5971}new SP_5115: bitstring;
                                            {5972}new UP_5116: bitstring;
                                            {5973}out(c, (GetEndpointResponse,pkSess_5114,None,SP_5115,UP_5116))
                                    )
                                    else
                                        {5974}let pkSess_5117: bitstring = fail-any in
                                        {5975}in(c, =GetEndpointRequest);
                                        {5976}new SP_5118: bitstring;
                                        {5977}new UP_5119: bitstring;
                                        {5978}out(c, (GetEndpointResponse,pkSess_5117,None,SP_5118,UP_5119))
                            )
                            else
                                {5979}let pkSess_5120: bitstring = fail-any in
                                {5980}in(c, =GetEndpointRequest);
                                {5981}new SP_5121: bitstring;
                                {5982}new UP_5122: bitstring;
                                {5983}out(c, (GetEndpointResponse,pkSess_5120,None,SP_5121,UP_5122))
                    )
                    else
                        {5984}let pkSess_5123: bitstring = fail-any in
                        {5985}in(c, =GetEndpointRequest);
                        {5986}new SP_5124: bitstring;
                        {5987}new UP_5125: bitstring;
                        {5988}out(c, (GetEndpointResponse,pkSess_5123,None,SP_5124,UP_5125))
    )
    else
        {5989}let skDisco_5126: bitstring = fail-any in
        {5990}let pkDisco_5127: bitstring = pub(skDisco_5126) in
        {5991}let v_5128: bool = (Cli_4222 = A) in
        (
            {5992}if v_5128 then
            (
                {5993}let pkCli_5129: bitstring = pub(skA) in
                {5994}let v_5130: bool = (Sess_4224 = A) in
                (
                    {5995}if v_5130 then
                    (
                        {5996}let pkSess_5131: bitstring = pub(skA) in
                        {5997}in(c, =GetEndpointRequest);
                        {5998}new SP_5132: bitstring;
                        {5999}new UP_5133: bitstring;
                        {6000}out(c, (GetEndpointResponse,pkSess_5131,None,SP_5132,UP_5133))
                    )
                    else
                        {6001}let v_5134: bool = (Sess_4224 = B) in
                        (
                            {6002}if v_5134 then
                            (
                                {6003}let pkSess_5135: bitstring = pub(skB) in
                                {6004}in(c, =GetEndpointRequest);
                                {6005}new SP_5136: bitstring;
                                {6006}new UP_5137: bitstring;
                                {6007}out(c, (GetEndpointResponse,pkSess_5135,None,SP_5136,UP_5137))
                            )
                            else
                                {6008}let v_5138: bool = (Sess_4224 = C) in
                                (
                                    {6009}if v_5138 then
                                    (
                                        {6010}let pkSess_5139: bitstring = pub(skC) in
                                        {6011}in(c, =GetEndpointRequest);
                                        {6012}new SP_5140: bitstring;
                                        {6013}new UP_5141: bitstring;
                                        {6014}out(c, (GetEndpointResponse,pkSess_5139,None,SP_5140,UP_5141))
                                    )
                                    else
                                        {6015}let pkSess_5142: bitstring = pub(sk(Sess_4224)) in
                                        {6016}in(c, =GetEndpointRequest);
                                        {6017}new SP_5143: bitstring;
                                        {6018}new UP_5144: bitstring;
                                        {6019}out(c, (GetEndpointResponse,pkSess_5142,None,SP_5143,UP_5144))
                                )
                                else
                                    {6020}let pkSess_5145: bitstring = fail-any in
                                    {6021}in(c, =GetEndpointRequest);
                                    {6022}new SP_5146: bitstring;
                                    {6023}new UP_5147: bitstring;
                                    {6024}out(c, (GetEndpointResponse,pkSess_5145,None,SP_5146,UP_5147))
                        )
                        else
                            {6025}let pkSess_5148: bitstring = fail-any in
                            {6026}in(c, =GetEndpointRequest);
                            {6027}new SP_5149: bitstring;
                            {6028}new UP_5150: bitstring;
                            {6029}out(c, (GetEndpointResponse,pkSess_5148,None,SP_5149,UP_5150))
                )
                else
                    {6030}let pkSess_5151: bitstring = fail-any in
                    {6031}in(c, =GetEndpointRequest);
                    {6032}new SP_5152: bitstring;
                    {6033}new UP_5153: bitstring;
                    {6034}out(c, (GetEndpointResponse,pkSess_5151,None,SP_5152,UP_5153))
            )
            else
                {6035}let v_5154: bool = (Cli_4222 = B) in
                (
                    {6036}if v_5154 then
                    (
                        {6037}let pkCli_5155: bitstring = pub(skB) in
                        {6038}let v_5156: bool = (Sess_4224 = A) in
                        (
                            {6039}if v_5156 then
                            (
                                {6040}let pkSess_5157: bitstring = pub(skA) in
                                {6041}in(c, =GetEndpointRequest);
                                {6042}new SP_5158: bitstring;
                                {6043}new UP_5159: bitstring;
                                {6044}out(c, (GetEndpointResponse,pkSess_5157,None,SP_5158,UP_5159))
                            )
                            else
                                {6045}let v_5160: bool = (Sess_4224 = B) in
                                (
                                    {6046}if v_5160 then
                                    (
                                        {6047}let pkSess_5161: bitstring = pub(skB) in
                                        {6048}in(c, =GetEndpointRequest);
                                        {6049}new SP_5162: bitstring;
                                        {6050}new UP_5163: bitstring;
                                        {6051}out(c, (GetEndpointResponse,pkSess_5161,None,SP_5162,UP_5163))
                                    )
                                    else
                                        {6052}let v_5164: bool = (Sess_4224 = C) in
                                        (
                                            {6053}if v_5164 then
                                            (
                                                {6054}let pkSess_5165: bitstring = pub(skC) in
                                                {6055}in(c, =GetEndpointRequest);
                                                {6056}new SP_5166: bitstring;
                                                {6057}new UP_5167: bitstring;
                                                {6058}out(c, (GetEndpointResponse,pkSess_5165,None,SP_5166,UP_5167))
                                            )
                                            else
                                                {6059}let pkSess_5168: bitstring = pub(sk(Sess_4224)) in
                                                {6060}in(c, =GetEndpointRequest);
                                                {6061}new SP_5169: bitstring;
                                                {6062}new UP_5170: bitstring;
                                                {6063}out(c, (GetEndpointResponse,pkSess_5168,None,SP_5169,UP_5170))
                                        )
                                        else
                                            {6064}let pkSess_5171: bitstring = fail-any in
                                            {6065}in(c, =GetEndpointRequest);
                                            {6066}new SP_5172: bitstring;
                                            {6067}new UP_5173: bitstring;
                                            {6068}out(c, (GetEndpointResponse,pkSess_5171,None,SP_5172,UP_5173))
                                )
                                else
                                    {6069}let pkSess_5174: bitstring = fail-any in
                                    {6070}in(c, =GetEndpointRequest);
                                    {6071}new SP_5175: bitstring;
                                    {6072}new UP_5176: bitstring;
                                    {6073}out(c, (GetEndpointResponse,pkSess_5174,None,SP_5175,UP_5176))
                        )
                        else
                            {6074}let pkSess_5177: bitstring = fail-any in
                            {6075}in(c, =GetEndpointRequest);
                            {6076}new SP_5178: bitstring;
                            {6077}new UP_5179: bitstring;
                            {6078}out(c, (GetEndpointResponse,pkSess_5177,None,SP_5178,UP_5179))
                    )
                    else
                        {6079}let v_5180: bool = (Cli_4222 = C) in
                        (
                            {6080}if v_5180 then
                            (
                                {6081}let pkCli_5181: bitstring = pub(skC) in
                                {6082}let v_5182: bool = (Sess_4224 = A) in
                                (
                                    {6083}if v_5182 then
                                    (
                                        {6084}let pkSess_5183: bitstring = pub(skA) in
                                        {6085}in(c, =GetEndpointRequest);
                                        {6086}new SP_5184: bitstring;
                                        {6087}new UP_5185: bitstring;
                                        {6088}out(c, (GetEndpointResponse,pkSess_5183,None,SP_5184,UP_5185))
                                    )
                                    else
                                        {6089}let v_5186: bool = (Sess_4224 = B) in
                                        (
                                            {6090}if v_5186 then
                                            (
                                                {6091}let pkSess_5187: bitstring = pub(skB) in
                                                {6092}in(c, =GetEndpointRequest);
                                                {6093}new SP_5188: bitstring;
                                                {6094}new UP_5189: bitstring;
                                                {6095}out(c, (GetEndpointResponse,pkSess_5187,None,SP_5188,UP_5189))
                                            )
                                            else
                                                {6096}let v_5190: bool = (Sess_4224 = C) in
                                                (
                                                    {6097}if v_5190 then
                                                    (
                                                        {6098}let pkSess_5191: bitstring = pub(skC) in
                                                        {6099}in(c, =GetEndpointRequest);
                                                        {6100}new SP_5192: bitstring;
                                                        {6101}new UP_5193: bitstring;
                                                        {6102}out(c, (GetEndpointResponse,pkSess_5191,None,SP_5192,UP_5193))
                                                    )
                                                    else
                                                        {6103}let pkSess_5194: bitstring = pub(sk(Sess_4224)) in
                                                        {6104}in(c, =GetEndpointRequest);
                                                        {6105}new SP_5195: bitstring;
                                                        {6106}new UP_5196: bitstring;
                                                        {6107}out(c, (GetEndpointResponse,pkSess_5194,None,SP_5195,UP_5196))
                                                )
                                                else
                                                    {6108}let pkSess_5197: bitstring = fail-any in
                                                    {6109}in(c, =GetEndpointRequest);
                                                    {6110}new SP_5198: bitstring;
                                                    {6111}new UP_5199: bitstring;
                                                    {6112}out(c, (GetEndpointResponse,pkSess_5197,None,SP_5198,UP_5199))
                                        )
                                        else
                                            {6113}let pkSess_5200: bitstring = fail-any in
                                            {6114}in(c, =GetEndpointRequest);
                                            {6115}new SP_5201: bitstring;
                                            {6116}new UP_5202: bitstring;
                                            {6117}out(c, (GetEndpointResponse,pkSess_5200,None,SP_5201,UP_5202))
                                )
                                else
                                    {6118}let pkSess_5203: bitstring = fail-any in
                                    {6119}in(c, =GetEndpointRequest);
                                    {6120}new SP_5204: bitstring;
                                    {6121}new UP_5205: bitstring;
                                    {6122}out(c, (GetEndpointResponse,pkSess_5203,None,SP_5204,UP_5205))
                            )
                            else
                                {6123}let pkCli_5206: bitstring = pub(sk(Cli_4222)) in
                                {6124}let v_5207: bool = (Sess_4224 = A) in
                                (
                                    {6125}if v_5207 then
                                    (
                                        {6126}let pkSess_5208: bitstring = pub(skA) in
                                        {6127}in(c, =GetEndpointRequest);
                                        {6128}new SP_5209: bitstring;
                                        {6129}new UP_5210: bitstring;
                                        {6130}out(c, (GetEndpointResponse,pkSess_5208,None,SP_5209,UP_5210))
                                    )
                                    else
                                        {6131}let v_5211: bool = (Sess_4224 = B) in
                                        (
                                            {6132}if v_5211 then
                                            (
                                                {6133}let pkSess_5212: bitstring = pub(skB) in
                                                {6134}in(c, =GetEndpointRequest);
                                                {6135}new SP_5213: bitstring;
                                                {6136}new UP_5214: bitstring;
                                                {6137}out(c, (GetEndpointResponse,pkSess_5212,None,SP_5213,UP_5214))
                                            )
                                            else
                                                {6138}let v_5215: bool = (Sess_4224 = C) in
                                                (
                                                    {6139}if v_5215 then
                                                    (
                                                        {6140}let pkSess_5216: bitstring = pub(skC) in
                                                        {6141}in(c, =GetEndpointRequest);
                                                        {6142}new SP_5217: bitstring;
                                                        {6143}new UP_5218: bitstring;
                                                        {6144}out(c, (GetEndpointResponse,pkSess_5216,None,SP_5217,UP_5218))
                                                    )
                                                    else
                                                        {6145}let pkSess_5219: bitstring = pub(sk(Sess_4224)) in
                                                        {6146}in(c, =GetEndpointRequest);
                                                        {6147}new SP_5220: bitstring;
                                                        {6148}new UP_5221: bitstring;
                                                        {6149}out(c, (GetEndpointResponse,pkSess_5219,None,SP_5220,UP_5221))
                                                )
                                                else
                                                    {6150}let pkSess_5222: bitstring = fail-any in
                                                    {6151}in(c, =GetEndpointRequest);
                                                    {6152}new SP_5223: bitstring;
                                                    {6153}new UP_5224: bitstring;
                                                    {6154}out(c, (GetEndpointResponse,pkSess_5222,None,SP_5223,UP_5224))
                                        )
                                        else
                                            {6155}let pkSess_5225: bitstring = fail-any in
                                            {6156}in(c, =GetEndpointRequest);
                                            {6157}new SP_5226: bitstring;
                                            {6158}new UP_5227: bitstring;
                                            {6159}out(c, (GetEndpointResponse,pkSess_5225,None,SP_5226,UP_5227))
                                )
                                else
                                    {6160}let pkSess_5228: bitstring = fail-any in
                                    {6161}in(c, =GetEndpointRequest);
                                    {6162}new SP_5229: bitstring;
                                    {6163}new UP_5230: bitstring;
                                    {6164}out(c, (GetEndpointResponse,pkSess_5228,None,SP_5229,UP_5230))
                        )
                        else
                            {6165}let pkCli_5231: bitstring = fail-any in
                            {6166}let v_5232: bool = (Sess_4224 = A) in
                            (
                                {6167}if v_5232 then
                                (
                                    {6168}let pkSess_5233: bitstring = pub(skA) in
                                    {6169}in(c, =GetEndpointRequest);
                                    {6170}new SP_5234: bitstring;
                                    {6171}new UP_5235: bitstring;
                                    {6172}out(c, (GetEndpointResponse,pkSess_5233,None,SP_5234,UP_5235))
                                )
                                else
                                    {6173}let v_5236: bool = (Sess_4224 = B) in
                                    (
                                        {6174}if v_5236 then
                                        (
                                            {6175}let pkSess_5237: bitstring = pub(skB) in
                                            {6176}in(c, =GetEndpointRequest);
                                            {6177}new SP_5238: bitstring;
                                            {6178}new UP_5239: bitstring;
                                            {6179}out(c, (GetEndpointResponse,pkSess_5237,None,SP_5238,UP_5239))
                                        )
                                        else
                                            {6180}let v_5240: bool = (Sess_4224 = C) in
                                            (
                                                {6181}if v_5240 then
                                                (
                                                    {6182}let pkSess_5241: bitstring = pub(skC) in
                                                    {6183}in(c, =GetEndpointRequest);
                                                    {6184}new SP_5242: bitstring;
                                                    {6185}new UP_5243: bitstring;
                                                    {6186}out(c, (GetEndpointResponse,pkSess_5241,None,SP_5242,UP_5243))
                                                )
                                                else
                                                    {6187}let pkSess_5244: bitstring = pub(sk(Sess_4224)) in
                                                    {6188}in(c, =GetEndpointRequest);
                                                    {6189}new SP_5245: bitstring;
                                                    {6190}new UP_5246: bitstring;
                                                    {6191}out(c, (GetEndpointResponse,pkSess_5244,None,SP_5245,UP_5246))
                                            )
                                            else
                                                {6192}let pkSess_5247: bitstring = fail-any in
                                                {6193}in(c, =GetEndpointRequest);
                                                {6194}new SP_5248: bitstring;
                                                {6195}new UP_5249: bitstring;
                                                {6196}out(c, (GetEndpointResponse,pkSess_5247,None,SP_5248,UP_5249))
                                    )
                                    else
                                        {6197}let pkSess_5250: bitstring = fail-any in
                                        {6198}in(c, =GetEndpointRequest);
                                        {6199}new SP_5251: bitstring;
                                        {6200}new UP_5252: bitstring;
                                        {6201}out(c, (GetEndpointResponse,pkSess_5250,None,SP_5251,UP_5252))
                            )
                            else
                                {6202}let pkSess_5253: bitstring = fail-any in
                                {6203}in(c, =GetEndpointRequest);
                                {6204}new SP_5254: bitstring;
                                {6205}new UP_5255: bitstring;
                                {6206}out(c, (GetEndpointResponse,pkSess_5253,None,SP_5254,UP_5255))
                )
                else
                    {6207}let pkCli_5256: bitstring = fail-any in
                    {6208}let v_5257: bool = (Sess_4224 = A) in
                    (
                        {6209}if v_5257 then
                        (
                            {6210}let pkSess_5258: bitstring = pub(skA) in
                            {6211}in(c, =GetEndpointRequest);
                            {6212}new SP_5259: bitstring;
                            {6213}new UP_5260: bitstring;
                            {6214}out(c, (GetEndpointResponse,pkSess_5258,None,SP_5259,UP_5260))
                        )
                        else
                            {6215}let v_5261: bool = (Sess_4224 = B) in
                            (
                                {6216}if v_5261 then
                                (
                                    {6217}let pkSess_5262: bitstring = pub(skB) in
                                    {6218}in(c, =GetEndpointRequest);
                                    {6219}new SP_5263: bitstring;
                                    {6220}new UP_5264: bitstring;
                                    {6221}out(c, (GetEndpointResponse,pkSess_5262,None,SP_5263,UP_5264))
                                )
                                else
                                    {6222}let v_5265: bool = (Sess_4224 = C) in
                                    (
                                        {6223}if v_5265 then
                                        (
                                            {6224}let pkSess_5266: bitstring = pub(skC) in
                                            {6225}in(c, =GetEndpointRequest);
                                            {6226}new SP_5267: bitstring;
                                            {6227}new UP_5268: bitstring;
                                            {6228}out(c, (GetEndpointResponse,pkSess_5266,None,SP_5267,UP_5268))
                                        )
                                        else
                                            {6229}let pkSess_5269: bitstring = pub(sk(Sess_4224)) in
                                            {6230}in(c, =GetEndpointRequest);
                                            {6231}new SP_5270: bitstring;
                                            {6232}new UP_5271: bitstring;
                                            {6233}out(c, (GetEndpointResponse,pkSess_5269,None,SP_5270,UP_5271))
                                    )
                                    else
                                        {6234}let pkSess_5272: bitstring = fail-any in
                                        {6235}in(c, =GetEndpointRequest);
                                        {6236}new SP_5273: bitstring;
                                        {6237}new UP_5274: bitstring;
                                        {6238}out(c, (GetEndpointResponse,pkSess_5272,None,SP_5273,UP_5274))
                            )
                            else
                                {6239}let pkSess_5275: bitstring = fail-any in
                                {6240}in(c, =GetEndpointRequest);
                                {6241}new SP_5276: bitstring;
                                {6242}new UP_5277: bitstring;
                                {6243}out(c, (GetEndpointResponse,pkSess_5275,None,SP_5276,UP_5277))
                    )
                    else
                        {6244}let pkSess_5278: bitstring = fail-any in
                        {6245}in(c, =GetEndpointRequest);
                        {6246}new SP_5279: bitstring;
                        {6247}new UP_5280: bitstring;
                        {6248}out(c, (GetEndpointResponse,pkSess_5278,None,SP_5279,UP_5280))
        )
        else
            {6249}let pkCli_5281: bitstring = fail-any in
            {6250}let v_5282: bool = (Sess_4224 = A) in
            (
                {6251}if v_5282 then
                (
                    {6252}let pkSess_5283: bitstring = pub(skA) in
                    {6253}in(c, =GetEndpointRequest);
                    {6254}new SP_5284: bitstring;
                    {6255}new UP_5285: bitstring;
                    {6256}out(c, (GetEndpointResponse,pkSess_5283,None,SP_5284,UP_5285))
                )
                else
                    {6257}let v_5286: bool = (Sess_4224 = B) in
                    (
                        {6258}if v_5286 then
                        (
                            {6259}let pkSess_5287: bitstring = pub(skB) in
                            {6260}in(c, =GetEndpointRequest);
                            {6261}new SP_5288: bitstring;
                            {6262}new UP_5289: bitstring;
                            {6263}out(c, (GetEndpointResponse,pkSess_5287,None,SP_5288,UP_5289))
                        )
                        else
                            {6264}let v_5290: bool = (Sess_4224 = C) in
                            (
                                {6265}if v_5290 then
                                (
                                    {6266}let pkSess_5291: bitstring = pub(skC) in
                                    {6267}in(c, =GetEndpointRequest);
                                    {6268}new SP_5292: bitstring;
                                    {6269}new UP_5293: bitstring;
                                    {6270}out(c, (GetEndpointResponse,pkSess_5291,None,SP_5292,UP_5293))
                                )
                                else
                                    {6271}let pkSess_5294: bitstring = pub(sk(Sess_4224)) in
                                    {6272}in(c, =GetEndpointRequest);
                                    {6273}new SP_5295: bitstring;
                                    {6274}new UP_5296: bitstring;
                                    {6275}out(c, (GetEndpointResponse,pkSess_5294,None,SP_5295,UP_5296))
                            )
                            else
                                {6276}let pkSess_5297: bitstring = fail-any in
                                {6277}in(c, =GetEndpointRequest);
                                {6278}new SP_5298: bitstring;
                                {6279}new UP_5299: bitstring;
                                {6280}out(c, (GetEndpointResponse,pkSess_5297,None,SP_5298,UP_5299))
                    )
                    else
                        {6281}let pkSess_5300: bitstring = fail-any in
                        {6282}in(c, =GetEndpointRequest);
                        {6283}new SP_5301: bitstring;
                        {6284}new UP_5302: bitstring;
                        {6285}out(c, (GetEndpointResponse,pkSess_5300,None,SP_5301,UP_5302))
            )
            else
                {6286}let pkSess_5303: bitstring = fail-any in
                {6287}in(c, =GetEndpointRequest);
                {6288}new SP_5304: bitstring;
                {6289}new UP_5305: bitstring;
                {6290}out(c, (GetEndpointResponse,pkSess_5303,None,SP_5304,UP_5305))
) | (
    {6291}!
    {6292}in(c, (Cli_5306: host,Disco_5307: host,Sess_5308: host));
    {6293}let v_5309: bool = (Sess_5308 = A) in
    (
        {6294}if v_5309 then
        (
            {6295}let skSess: bitstring = skA in
            {6296}let pkSess_5310: bitstring = pub(skSess) in
            {6297}let v_5311: bool = (Cli_5306 = A) in
            (
                {6298}if v_5311 then
                (
                    {6299}let pkCli_5312: bitstring = pub(skA) in
                    {6300}let v_5313: bool = (Disco_5307 = A) in
                    (
                        {6301}if v_5313 then
                        (
                            {6302}let pkDisco_5314: bitstring = pub(skA) in
                            {6303}in(c, (=pkCli_5312,em1: bitstring));
                            {6304}let m1_5315: bitstring = em1 in
                            {6305}let (=OpenSecureChannelRequest,=pkCli_5312,wNc_5316: bitstring) = m1_5315 in
                            {6306}let Nc_5317: bitstring = dec(wNc_5316,skSess) in
                            {6307}new Ns_5318: bitstring;
                            {6308}new ST_5319: bitstring;
                            {6309}new TTL_5320: bitstring;
                            {6310}let wNs_5321: bitstring = enc(Ns_5318,pkCli_5312) in
                            {6311}let m2_5322: bitstring = (OpenSecureChannelResponse,wNs_5321,ST_5319,TTL_5320) in
                            {6312}event beginSrv(Sess_5308,Cli_5306,Ns_5318);
                            {6313}out(c, m2_5322);
                            {6314}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                            {6315}event endSrv(Cli_5306,Sess_5308,Nc_5317)
                        )
                        else
                            {6316}let v_5323: bool = (Disco_5307 = B) in
                            (
                                {6317}if v_5323 then
                                (
                                    {6318}let pkDisco_5324: bitstring = pub(skB) in
                                    {6319}in(c, (=pkCli_5312,em1_5325: bitstring));
                                    {6320}let m1_5326: bitstring = em1_5325 in
                                    {6321}let (=OpenSecureChannelRequest,=pkCli_5312,wNc_5327: bitstring) = m1_5326 in
                                    {6322}let Nc_5328: bitstring = dec(wNc_5327,skSess) in
                                    {6323}new Ns_5329: bitstring;
                                    {6324}new ST_5330: bitstring;
                                    {6325}new TTL_5331: bitstring;
                                    {6326}let wNs_5332: bitstring = enc(Ns_5329,pkCli_5312) in
                                    {6327}let m2_5333: bitstring = (OpenSecureChannelResponse,wNs_5332,ST_5330,TTL_5331) in
                                    {6328}event beginSrv(Sess_5308,Cli_5306,Ns_5329);
                                    {6329}out(c, m2_5333);
                                    {6330}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                    {6331}event endSrv(Cli_5306,Sess_5308,Nc_5328)
                                )
                                else
                                    {6332}let v_5334: bool = (Disco_5307 = C) in
                                    (
                                        {6333}if v_5334 then
                                        (
                                            {6334}let pkDisco_5335: bitstring = pub(skC) in
                                            {6335}in(c, (=pkCli_5312,em1_5336: bitstring));
                                            {6336}let m1_5337: bitstring = em1_5336 in
                                            {6337}let (=OpenSecureChannelRequest,=pkCli_5312,wNc_5338: bitstring) = m1_5337 in
                                            {6338}let Nc_5339: bitstring = dec(wNc_5338,skSess) in
                                            {6339}new Ns_5340: bitstring;
                                            {6340}new ST_5341: bitstring;
                                            {6341}new TTL_5342: bitstring;
                                            {6342}let wNs_5343: bitstring = enc(Ns_5340,pkCli_5312) in
                                            {6343}let m2_5344: bitstring = (OpenSecureChannelResponse,wNs_5343,ST_5341,TTL_5342) in
                                            {6344}event beginSrv(Sess_5308,Cli_5306,Ns_5340);
                                            {6345}out(c, m2_5344);
                                            {6346}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                            {6347}event endSrv(Cli_5306,Sess_5308,Nc_5339)
                                        )
                                        else
                                            {6348}let pkDisco_5345: bitstring = pub(sk(Disco_5307)) in
                                            {6349}in(c, (=pkCli_5312,em1_5346: bitstring));
                                            {6350}let m1_5347: bitstring = em1_5346 in
                                            {6351}let (=OpenSecureChannelRequest,=pkCli_5312,wNc_5348: bitstring) = m1_5347 in
                                            {6352}let Nc_5349: bitstring = dec(wNc_5348,skSess) in
                                            {6353}new Ns_5350: bitstring;
                                            {6354}new ST_5351: bitstring;
                                            {6355}new TTL_5352: bitstring;
                                            {6356}let wNs_5353: bitstring = enc(Ns_5350,pkCli_5312) in
                                            {6357}let m2_5354: bitstring = (OpenSecureChannelResponse,wNs_5353,ST_5351,TTL_5352) in
                                            {6358}event beginSrv(Sess_5308,Cli_5306,Ns_5350);
                                            {6359}out(c, m2_5354);
                                            {6360}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                            {6361}event endSrv(Cli_5306,Sess_5308,Nc_5349)
                                    )
                                    else
                                        {6362}let pkDisco_5355: bitstring = fail-any in
                                        {6363}in(c, (=pkCli_5312,em1_5356: bitstring));
                                        {6364}let m1_5357: bitstring = em1_5356 in
                                        {6365}let (=OpenSecureChannelRequest,=pkCli_5312,wNc_5358: bitstring) = m1_5357 in
                                        {6366}let Nc_5359: bitstring = dec(wNc_5358,skSess) in
                                        {6367}new Ns_5360: bitstring;
                                        {6368}new ST_5361: bitstring;
                                        {6369}new TTL_5362: bitstring;
                                        {6370}let wNs_5363: bitstring = enc(Ns_5360,pkCli_5312) in
                                        {6371}let m2_5364: bitstring = (OpenSecureChannelResponse,wNs_5363,ST_5361,TTL_5362) in
                                        {6372}event beginSrv(Sess_5308,Cli_5306,Ns_5360);
                                        {6373}out(c, m2_5364);
                                        {6374}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                        {6375}event endSrv(Cli_5306,Sess_5308,Nc_5359)
                            )
                            else
                                {6376}let pkDisco_5365: bitstring = fail-any in
                                {6377}in(c, (=pkCli_5312,em1_5366: bitstring));
                                {6378}let m1_5367: bitstring = em1_5366 in
                                {6379}let (=OpenSecureChannelRequest,=pkCli_5312,wNc_5368: bitstring) = m1_5367 in
                                {6380}let Nc_5369: bitstring = dec(wNc_5368,skSess) in
                                {6381}new Ns_5370: bitstring;
                                {6382}new ST_5371: bitstring;
                                {6383}new TTL_5372: bitstring;
                                {6384}let wNs_5373: bitstring = enc(Ns_5370,pkCli_5312) in
                                {6385}let m2_5374: bitstring = (OpenSecureChannelResponse,wNs_5373,ST_5371,TTL_5372) in
                                {6386}event beginSrv(Sess_5308,Cli_5306,Ns_5370);
                                {6387}out(c, m2_5374);
                                {6388}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                {6389}event endSrv(Cli_5306,Sess_5308,Nc_5369)
                    )
                    else
                        {6390}let pkDisco_5375: bitstring = fail-any in
                        {6391}in(c, (=pkCli_5312,em1_5376: bitstring));
                        {6392}let m1_5377: bitstring = em1_5376 in
                        {6393}let (=OpenSecureChannelRequest,=pkCli_5312,wNc_5378: bitstring) = m1_5377 in
                        {6394}let Nc_5379: bitstring = dec(wNc_5378,skSess) in
                        {6395}new Ns_5380: bitstring;
                        {6396}new ST_5381: bitstring;
                        {6397}new TTL_5382: bitstring;
                        {6398}let wNs_5383: bitstring = enc(Ns_5380,pkCli_5312) in
                        {6399}let m2_5384: bitstring = (OpenSecureChannelResponse,wNs_5383,ST_5381,TTL_5382) in
                        {6400}event beginSrv(Sess_5308,Cli_5306,Ns_5380);
                        {6401}out(c, m2_5384);
                        {6402}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                        {6403}event endSrv(Cli_5306,Sess_5308,Nc_5379)
                )
                else
                    {6404}let v_5385: bool = (Cli_5306 = B) in
                    (
                        {6405}if v_5385 then
                        (
                            {6406}let pkCli_5386: bitstring = pub(skB) in
                            {6407}let v_5387: bool = (Disco_5307 = A) in
                            (
                                {6408}if v_5387 then
                                (
                                    {6409}let pkDisco_5388: bitstring = pub(skA) in
                                    {6410}in(c, (=pkCli_5386,em1_5389: bitstring));
                                    {6411}let m1_5390: bitstring = em1_5389 in
                                    {6412}let (=OpenSecureChannelRequest,=pkCli_5386,wNc_5391: bitstring) = m1_5390 in
                                    {6413}let Nc_5392: bitstring = dec(wNc_5391,skSess) in
                                    {6414}new Ns_5393: bitstring;
                                    {6415}new ST_5394: bitstring;
                                    {6416}new TTL_5395: bitstring;
                                    {6417}let wNs_5396: bitstring = enc(Ns_5393,pkCli_5386) in
                                    {6418}let m2_5397: bitstring = (OpenSecureChannelResponse,wNs_5396,ST_5394,TTL_5395) in
                                    {6419}event beginSrv(Sess_5308,Cli_5306,Ns_5393);
                                    {6420}out(c, m2_5397);
                                    {6421}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                    {6422}event endSrv(Cli_5306,Sess_5308,Nc_5392)
                                )
                                else
                                    {6423}let v_5398: bool = (Disco_5307 = B) in
                                    (
                                        {6424}if v_5398 then
                                        (
                                            {6425}let pkDisco_5399: bitstring = pub(skB) in
                                            {6426}in(c, (=pkCli_5386,em1_5400: bitstring));
                                            {6427}let m1_5401: bitstring = em1_5400 in
                                            {6428}let (=OpenSecureChannelRequest,=pkCli_5386,wNc_5402: bitstring) = m1_5401 in
                                            {6429}let Nc_5403: bitstring = dec(wNc_5402,skSess) in
                                            {6430}new Ns_5404: bitstring;
                                            {6431}new ST_5405: bitstring;
                                            {6432}new TTL_5406: bitstring;
                                            {6433}let wNs_5407: bitstring = enc(Ns_5404,pkCli_5386) in
                                            {6434}let m2_5408: bitstring = (OpenSecureChannelResponse,wNs_5407,ST_5405,TTL_5406) in
                                            {6435}event beginSrv(Sess_5308,Cli_5306,Ns_5404);
                                            {6436}out(c, m2_5408);
                                            {6437}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                            {6438}event endSrv(Cli_5306,Sess_5308,Nc_5403)
                                        )
                                        else
                                            {6439}let v_5409: bool = (Disco_5307 = C) in
                                            (
                                                {6440}if v_5409 then
                                                (
                                                    {6441}let pkDisco_5410: bitstring = pub(skC) in
                                                    {6442}in(c, (=pkCli_5386,em1_5411: bitstring));
                                                    {6443}let m1_5412: bitstring = em1_5411 in
                                                    {6444}let (=OpenSecureChannelRequest,=pkCli_5386,wNc_5413: bitstring) = m1_5412 in
                                                    {6445}let Nc_5414: bitstring = dec(wNc_5413,skSess) in
                                                    {6446}new Ns_5415: bitstring;
                                                    {6447}new ST_5416: bitstring;
                                                    {6448}new TTL_5417: bitstring;
                                                    {6449}let wNs_5418: bitstring = enc(Ns_5415,pkCli_5386) in
                                                    {6450}let m2_5419: bitstring = (OpenSecureChannelResponse,wNs_5418,ST_5416,TTL_5417) in
                                                    {6451}event beginSrv(Sess_5308,Cli_5306,Ns_5415);
                                                    {6452}out(c, m2_5419);
                                                    {6453}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                                    {6454}event endSrv(Cli_5306,Sess_5308,Nc_5414)
                                                )
                                                else
                                                    {6455}let pkDisco_5420: bitstring = pub(sk(Disco_5307)) in
                                                    {6456}in(c, (=pkCli_5386,em1_5421: bitstring));
                                                    {6457}let m1_5422: bitstring = em1_5421 in
                                                    {6458}let (=OpenSecureChannelRequest,=pkCli_5386,wNc_5423: bitstring) = m1_5422 in
                                                    {6459}let Nc_5424: bitstring = dec(wNc_5423,skSess) in
                                                    {6460}new Ns_5425: bitstring;
                                                    {6461}new ST_5426: bitstring;
                                                    {6462}new TTL_5427: bitstring;
                                                    {6463}let wNs_5428: bitstring = enc(Ns_5425,pkCli_5386) in
                                                    {6464}let m2_5429: bitstring = (OpenSecureChannelResponse,wNs_5428,ST_5426,TTL_5427) in
                                                    {6465}event beginSrv(Sess_5308,Cli_5306,Ns_5425);
                                                    {6466}out(c, m2_5429);
                                                    {6467}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                                    {6468}event endSrv(Cli_5306,Sess_5308,Nc_5424)
                                            )
                                            else
                                                {6469}let pkDisco_5430: bitstring = fail-any in
                                                {6470}in(c, (=pkCli_5386,em1_5431: bitstring));
                                                {6471}let m1_5432: bitstring = em1_5431 in
                                                {6472}let (=OpenSecureChannelRequest,=pkCli_5386,wNc_5433: bitstring) = m1_5432 in
                                                {6473}let Nc_5434: bitstring = dec(wNc_5433,skSess) in
                                                {6474}new Ns_5435: bitstring;
                                                {6475}new ST_5436: bitstring;
                                                {6476}new TTL_5437: bitstring;
                                                {6477}let wNs_5438: bitstring = enc(Ns_5435,pkCli_5386) in
                                                {6478}let m2_5439: bitstring = (OpenSecureChannelResponse,wNs_5438,ST_5436,TTL_5437) in
                                                {6479}event beginSrv(Sess_5308,Cli_5306,Ns_5435);
                                                {6480}out(c, m2_5439);
                                                {6481}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                                {6482}event endSrv(Cli_5306,Sess_5308,Nc_5434)
                                    )
                                    else
                                        {6483}let pkDisco_5440: bitstring = fail-any in
                                        {6484}in(c, (=pkCli_5386,em1_5441: bitstring));
                                        {6485}let m1_5442: bitstring = em1_5441 in
                                        {6486}let (=OpenSecureChannelRequest,=pkCli_5386,wNc_5443: bitstring) = m1_5442 in
                                        {6487}let Nc_5444: bitstring = dec(wNc_5443,skSess) in
                                        {6488}new Ns_5445: bitstring;
                                        {6489}new ST_5446: bitstring;
                                        {6490}new TTL_5447: bitstring;
                                        {6491}let wNs_5448: bitstring = enc(Ns_5445,pkCli_5386) in
                                        {6492}let m2_5449: bitstring = (OpenSecureChannelResponse,wNs_5448,ST_5446,TTL_5447) in
                                        {6493}event beginSrv(Sess_5308,Cli_5306,Ns_5445);
                                        {6494}out(c, m2_5449);
                                        {6495}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                        {6496}event endSrv(Cli_5306,Sess_5308,Nc_5444)
                            )
                            else
                                {6497}let pkDisco_5450: bitstring = fail-any in
                                {6498}in(c, (=pkCli_5386,em1_5451: bitstring));
                                {6499}let m1_5452: bitstring = em1_5451 in
                                {6500}let (=OpenSecureChannelRequest,=pkCli_5386,wNc_5453: bitstring) = m1_5452 in
                                {6501}let Nc_5454: bitstring = dec(wNc_5453,skSess) in
                                {6502}new Ns_5455: bitstring;
                                {6503}new ST_5456: bitstring;
                                {6504}new TTL_5457: bitstring;
                                {6505}let wNs_5458: bitstring = enc(Ns_5455,pkCli_5386) in
                                {6506}let m2_5459: bitstring = (OpenSecureChannelResponse,wNs_5458,ST_5456,TTL_5457) in
                                {6507}event beginSrv(Sess_5308,Cli_5306,Ns_5455);
                                {6508}out(c, m2_5459);
                                {6509}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                {6510}event endSrv(Cli_5306,Sess_5308,Nc_5454)
                        )
                        else
                            {6511}let v_5460: bool = (Cli_5306 = C) in
                            (
                                {6512}if v_5460 then
                                (
                                    {6513}let pkCli_5461: bitstring = pub(skC) in
                                    {6514}let v_5462: bool = (Disco_5307 = A) in
                                    (
                                        {6515}if v_5462 then
                                        (
                                            {6516}let pkDisco_5463: bitstring = pub(skA) in
                                            {6517}in(c, (=pkCli_5461,em1_5464: bitstring));
                                            {6518}let m1_5465: bitstring = em1_5464 in
                                            {6519}let (=OpenSecureChannelRequest,=pkCli_5461,wNc_5466: bitstring) = m1_5465 in
                                            {6520}let Nc_5467: bitstring = dec(wNc_5466,skSess) in
                                            {6521}new Ns_5468: bitstring;
                                            {6522}new ST_5469: bitstring;
                                            {6523}new TTL_5470: bitstring;
                                            {6524}let wNs_5471: bitstring = enc(Ns_5468,pkCli_5461) in
                                            {6525}let m2_5472: bitstring = (OpenSecureChannelResponse,wNs_5471,ST_5469,TTL_5470) in
                                            {6526}event beginSrv(Sess_5308,Cli_5306,Ns_5468);
                                            {6527}out(c, m2_5472);
                                            {6528}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                            {6529}event endSrv(Cli_5306,Sess_5308,Nc_5467)
                                        )
                                        else
                                            {6530}let v_5473: bool = (Disco_5307 = B) in
                                            (
                                                {6531}if v_5473 then
                                                (
                                                    {6532}let pkDisco_5474: bitstring = pub(skB) in
                                                    {6533}in(c, (=pkCli_5461,em1_5475: bitstring));
                                                    {6534}let m1_5476: bitstring = em1_5475 in
                                                    {6535}let (=OpenSecureChannelRequest,=pkCli_5461,wNc_5477: bitstring) = m1_5476 in
                                                    {6536}let Nc_5478: bitstring = dec(wNc_5477,skSess) in
                                                    {6537}new Ns_5479: bitstring;
                                                    {6538}new ST_5480: bitstring;
                                                    {6539}new TTL_5481: bitstring;
                                                    {6540}let wNs_5482: bitstring = enc(Ns_5479,pkCli_5461) in
                                                    {6541}let m2_5483: bitstring = (OpenSecureChannelResponse,wNs_5482,ST_5480,TTL_5481) in
                                                    {6542}event beginSrv(Sess_5308,Cli_5306,Ns_5479);
                                                    {6543}out(c, m2_5483);
                                                    {6544}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                                    {6545}event endSrv(Cli_5306,Sess_5308,Nc_5478)
                                                )
                                                else
                                                    {6546}let v_5484: bool = (Disco_5307 = C) in
                                                    (
                                                        {6547}if v_5484 then
                                                        (
                                                            {6548}let pkDisco_5485: bitstring = pub(skC) in
                                                            {6549}in(c, (=pkCli_5461,em1_5486: bitstring));
                                                            {6550}let m1_5487: bitstring = em1_5486 in
                                                            {6551}let (=OpenSecureChannelRequest,=pkCli_5461,wNc_5488: bitstring) = m1_5487 in
                                                            {6552}let Nc_5489: bitstring = dec(wNc_5488,skSess) in
                                                            {6553}new Ns_5490: bitstring;
                                                            {6554}new ST_5491: bitstring;
                                                            {6555}new TTL_5492: bitstring;
                                                            {6556}let wNs_5493: bitstring = enc(Ns_5490,pkCli_5461) in
                                                            {6557}let m2_5494: bitstring = (OpenSecureChannelResponse,wNs_5493,ST_5491,TTL_5492) in
                                                            {6558}event beginSrv(Sess_5308,Cli_5306,Ns_5490);
                                                            {6559}out(c, m2_5494);
                                                            {6560}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                                            {6561}event endSrv(Cli_5306,Sess_5308,Nc_5489)
                                                        )
                                                        else
                                                            {6562}let pkDisco_5495: bitstring = pub(sk(Disco_5307)) in
                                                            {6563}in(c, (=pkCli_5461,em1_5496: bitstring));
                                                            {6564}let m1_5497: bitstring = em1_5496 in
                                                            {6565}let (=OpenSecureChannelRequest,=pkCli_5461,wNc_5498: bitstring) = m1_5497 in
                                                            {6566}let Nc_5499: bitstring = dec(wNc_5498,skSess) in
                                                            {6567}new Ns_5500: bitstring;
                                                            {6568}new ST_5501: bitstring;
                                                            {6569}new TTL_5502: bitstring;
                                                            {6570}let wNs_5503: bitstring = enc(Ns_5500,pkCli_5461) in
                                                            {6571}let m2_5504: bitstring = (OpenSecureChannelResponse,wNs_5503,ST_5501,TTL_5502) in
                                                            {6572}event beginSrv(Sess_5308,Cli_5306,Ns_5500);
                                                            {6573}out(c, m2_5504);
                                                            {6574}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                                            {6575}event endSrv(Cli_5306,Sess_5308,Nc_5499)
                                                    )
                                                    else
                                                        {6576}let pkDisco_5505: bitstring = fail-any in
                                                        {6577}in(c, (=pkCli_5461,em1_5506: bitstring));
                                                        {6578}let m1_5507: bitstring = em1_5506 in
                                                        {6579}let (=OpenSecureChannelRequest,=pkCli_5461,wNc_5508: bitstring) = m1_5507 in
                                                        {6580}let Nc_5509: bitstring = dec(wNc_5508,skSess) in
                                                        {6581}new Ns_5510: bitstring;
                                                        {6582}new ST_5511: bitstring;
                                                        {6583}new TTL_5512: bitstring;
                                                        {6584}let wNs_5513: bitstring = enc(Ns_5510,pkCli_5461) in
                                                        {6585}let m2_5514: bitstring = (OpenSecureChannelResponse,wNs_5513,ST_5511,TTL_5512) in
                                                        {6586}event beginSrv(Sess_5308,Cli_5306,Ns_5510);
                                                        {6587}out(c, m2_5514);
                                                        {6588}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                                        {6589}event endSrv(Cli_5306,Sess_5308,Nc_5509)
                                            )
                                            else
                                                {6590}let pkDisco_5515: bitstring = fail-any in
                                                {6591}in(c, (=pkCli_5461,em1_5516: bitstring));
                                                {6592}let m1_5517: bitstring = em1_5516 in
                                                {6593}let (=OpenSecureChannelRequest,=pkCli_5461,wNc_5518: bitstring) = m1_5517 in
                                                {6594}let Nc_5519: bitstring = dec(wNc_5518,skSess) in
                                                {6595}new Ns_5520: bitstring;
                                                {6596}new ST_5521: bitstring;
                                                {6597}new TTL_5522: bitstring;
                                                {6598}let wNs_5523: bitstring = enc(Ns_5520,pkCli_5461) in
                                                {6599}let m2_5524: bitstring = (OpenSecureChannelResponse,wNs_5523,ST_5521,TTL_5522) in
                                                {6600}event beginSrv(Sess_5308,Cli_5306,Ns_5520);
                                                {6601}out(c, m2_5524);
                                                {6602}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                                {6603}event endSrv(Cli_5306,Sess_5308,Nc_5519)
                                    )
                                    else
                                        {6604}let pkDisco_5525: bitstring = fail-any in
                                        {6605}in(c, (=pkCli_5461,em1_5526: bitstring));
                                        {6606}let m1_5527: bitstring = em1_5526 in
                                        {6607}let (=OpenSecureChannelRequest,=pkCli_5461,wNc_5528: bitstring) = m1_5527 in
                                        {6608}let Nc_5529: bitstring = dec(wNc_5528,skSess) in
                                        {6609}new Ns_5530: bitstring;
                                        {6610}new ST_5531: bitstring;
                                        {6611}new TTL_5532: bitstring;
                                        {6612}let wNs_5533: bitstring = enc(Ns_5530,pkCli_5461) in
                                        {6613}let m2_5534: bitstring = (OpenSecureChannelResponse,wNs_5533,ST_5531,TTL_5532) in
                                        {6614}event beginSrv(Sess_5308,Cli_5306,Ns_5530);
                                        {6615}out(c, m2_5534);
                                        {6616}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                        {6617}event endSrv(Cli_5306,Sess_5308,Nc_5529)
                                )
                                else
                                    {6618}let pkCli_5535: bitstring = pub(sk(Cli_5306)) in
                                    {6619}let v_5536: bool = (Disco_5307 = A) in
                                    (
                                        {6620}if v_5536 then
                                        (
                                            {6621}let pkDisco_5537: bitstring = pub(skA) in
                                            {6622}in(c, (=pkCli_5535,em1_5538: bitstring));
                                            {6623}let m1_5539: bitstring = em1_5538 in
                                            {6624}let (=OpenSecureChannelRequest,=pkCli_5535,wNc_5540: bitstring) = m1_5539 in
                                            {6625}let Nc_5541: bitstring = dec(wNc_5540,skSess) in
                                            {6626}new Ns_5542: bitstring;
                                            {6627}new ST_5543: bitstring;
                                            {6628}new TTL_5544: bitstring;
                                            {6629}let wNs_5545: bitstring = enc(Ns_5542,pkCli_5535) in
                                            {6630}let m2_5546: bitstring = (OpenSecureChannelResponse,wNs_5545,ST_5543,TTL_5544) in
                                            {6631}event beginSrv(Sess_5308,Cli_5306,Ns_5542);
                                            {6632}out(c, m2_5546);
                                            {6633}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                            {6634}event endSrv(Cli_5306,Sess_5308,Nc_5541)
                                        )
                                        else
                                            {6635}let v_5547: bool = (Disco_5307 = B) in
                                            (
                                                {6636}if v_5547 then
                                                (
                                                    {6637}let pkDisco_5548: bitstring = pub(skB) in
                                                    {6638}in(c, (=pkCli_5535,em1_5549: bitstring));
                                                    {6639}let m1_5550: bitstring = em1_5549 in
                                                    {6640}let (=OpenSecureChannelRequest,=pkCli_5535,wNc_5551: bitstring) = m1_5550 in
                                                    {6641}let Nc_5552: bitstring = dec(wNc_5551,skSess) in
                                                    {6642}new Ns_5553: bitstring;
                                                    {6643}new ST_5554: bitstring;
                                                    {6644}new TTL_5555: bitstring;
                                                    {6645}let wNs_5556: bitstring = enc(Ns_5553,pkCli_5535) in
                                                    {6646}let m2_5557: bitstring = (OpenSecureChannelResponse,wNs_5556,ST_5554,TTL_5555) in
                                                    {6647}event beginSrv(Sess_5308,Cli_5306,Ns_5553);
                                                    {6648}out(c, m2_5557);
                                                    {6649}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                                    {6650}event endSrv(Cli_5306,Sess_5308,Nc_5552)
                                                )
                                                else
                                                    {6651}let v_5558: bool = (Disco_5307 = C) in
                                                    (
                                                        {6652}if v_5558 then
                                                        (
                                                            {6653}let pkDisco_5559: bitstring = pub(skC) in
                                                            {6654}in(c, (=pkCli_5535,em1_5560: bitstring));
                                                            {6655}let m1_5561: bitstring = em1_5560 in
                                                            {6656}let (=OpenSecureChannelRequest,=pkCli_5535,wNc_5562: bitstring) = m1_5561 in
                                                            {6657}let Nc_5563: bitstring = dec(wNc_5562,skSess) in
                                                            {6658}new Ns_5564: bitstring;
                                                            {6659}new ST_5565: bitstring;
                                                            {6660}new TTL_5566: bitstring;
                                                            {6661}let wNs_5567: bitstring = enc(Ns_5564,pkCli_5535) in
                                                            {6662}let m2_5568: bitstring = (OpenSecureChannelResponse,wNs_5567,ST_5565,TTL_5566) in
                                                            {6663}event beginSrv(Sess_5308,Cli_5306,Ns_5564);
                                                            {6664}out(c, m2_5568);
                                                            {6665}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                                            {6666}event endSrv(Cli_5306,Sess_5308,Nc_5563)
                                                        )
                                                        else
                                                            {6667}let pkDisco_5569: bitstring = pub(sk(Disco_5307)) in
                                                            {6668}in(c, (=pkCli_5535,em1_5570: bitstring));
                                                            {6669}let m1_5571: bitstring = em1_5570 in
                                                            {6670}let (=OpenSecureChannelRequest,=pkCli_5535,wNc_5572: bitstring) = m1_5571 in
                                                            {6671}let Nc_5573: bitstring = dec(wNc_5572,skSess) in
                                                            {6672}new Ns_5574: bitstring;
                                                            {6673}new ST_5575: bitstring;
                                                            {6674}new TTL_5576: bitstring;
                                                            {6675}let wNs_5577: bitstring = enc(Ns_5574,pkCli_5535) in
                                                            {6676}let m2_5578: bitstring = (OpenSecureChannelResponse,wNs_5577,ST_5575,TTL_5576) in
                                                            {6677}event beginSrv(Sess_5308,Cli_5306,Ns_5574);
                                                            {6678}out(c, m2_5578);
                                                            {6679}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                                            {6680}event endSrv(Cli_5306,Sess_5308,Nc_5573)
                                                    )
                                                    else
                                                        {6681}let pkDisco_5579: bitstring = fail-any in
                                                        {6682}in(c, (=pkCli_5535,em1_5580: bitstring));
                                                        {6683}let m1_5581: bitstring = em1_5580 in
                                                        {6684}let (=OpenSecureChannelRequest,=pkCli_5535,wNc_5582: bitstring) = m1_5581 in
                                                        {6685}let Nc_5583: bitstring = dec(wNc_5582,skSess) in
                                                        {6686}new Ns_5584: bitstring;
                                                        {6687}new ST_5585: bitstring;
                                                        {6688}new TTL_5586: bitstring;
                                                        {6689}let wNs_5587: bitstring = enc(Ns_5584,pkCli_5535) in
                                                        {6690}let m2_5588: bitstring = (OpenSecureChannelResponse,wNs_5587,ST_5585,TTL_5586) in
                                                        {6691}event beginSrv(Sess_5308,Cli_5306,Ns_5584);
                                                        {6692}out(c, m2_5588);
                                                        {6693}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                                        {6694}event endSrv(Cli_5306,Sess_5308,Nc_5583)
                                            )
                                            else
                                                {6695}let pkDisco_5589: bitstring = fail-any in
                                                {6696}in(c, (=pkCli_5535,em1_5590: bitstring));
                                                {6697}let m1_5591: bitstring = em1_5590 in
                                                {6698}let (=OpenSecureChannelRequest,=pkCli_5535,wNc_5592: bitstring) = m1_5591 in
                                                {6699}let Nc_5593: bitstring = dec(wNc_5592,skSess) in
                                                {6700}new Ns_5594: bitstring;
                                                {6701}new ST_5595: bitstring;
                                                {6702}new TTL_5596: bitstring;
                                                {6703}let wNs_5597: bitstring = enc(Ns_5594,pkCli_5535) in
                                                {6704}let m2_5598: bitstring = (OpenSecureChannelResponse,wNs_5597,ST_5595,TTL_5596) in
                                                {6705}event beginSrv(Sess_5308,Cli_5306,Ns_5594);
                                                {6706}out(c, m2_5598);
                                                {6707}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                                {6708}event endSrv(Cli_5306,Sess_5308,Nc_5593)
                                    )
                                    else
                                        {6709}let pkDisco_5599: bitstring = fail-any in
                                        {6710}in(c, (=pkCli_5535,em1_5600: bitstring));
                                        {6711}let m1_5601: bitstring = em1_5600 in
                                        {6712}let (=OpenSecureChannelRequest,=pkCli_5535,wNc_5602: bitstring) = m1_5601 in
                                        {6713}let Nc_5603: bitstring = dec(wNc_5602,skSess) in
                                        {6714}new Ns_5604: bitstring;
                                        {6715}new ST_5605: bitstring;
                                        {6716}new TTL_5606: bitstring;
                                        {6717}let wNs_5607: bitstring = enc(Ns_5604,pkCli_5535) in
                                        {6718}let m2_5608: bitstring = (OpenSecureChannelResponse,wNs_5607,ST_5605,TTL_5606) in
                                        {6719}event beginSrv(Sess_5308,Cli_5306,Ns_5604);
                                        {6720}out(c, m2_5608);
                                        {6721}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                        {6722}event endSrv(Cli_5306,Sess_5308,Nc_5603)
                            )
                            else
                                {6723}let pkCli_5609: bitstring = fail-any in
                                {6724}let v_5610: bool = (Disco_5307 = A) in
                                (
                                    {6725}if v_5610 then
                                    (
                                        {6726}let pkDisco_5611: bitstring = pub(skA) in
                                        {6727}in(c, (=pkCli_5609,em1_5612: bitstring));
                                        {6728}let m1_5613: bitstring = em1_5612 in
                                        {6729}let (=OpenSecureChannelRequest,=pkCli_5609,wNc_5614: bitstring) = m1_5613 in
                                        {6730}let Nc_5615: bitstring = dec(wNc_5614,skSess) in
                                        {6731}new Ns_5616: bitstring;
                                        {6732}new ST_5617: bitstring;
                                        {6733}new TTL_5618: bitstring;
                                        {6734}let wNs_5619: bitstring = enc(Ns_5616,pkCli_5609) in
                                        {6735}let m2_5620: bitstring = (OpenSecureChannelResponse,wNs_5619,ST_5617,TTL_5618) in
                                        {6736}event beginSrv(Sess_5308,Cli_5306,Ns_5616);
                                        {6737}out(c, m2_5620);
                                        {6738}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                        {6739}event endSrv(Cli_5306,Sess_5308,Nc_5615)
                                    )
                                    else
                                        {6740}let v_5621: bool = (Disco_5307 = B) in
                                        (
                                            {6741}if v_5621 then
                                            (
                                                {6742}let pkDisco_5622: bitstring = pub(skB) in
                                                {6743}in(c, (=pkCli_5609,em1_5623: bitstring));
                                                {6744}let m1_5624: bitstring = em1_5623 in
                                                {6745}let (=OpenSecureChannelRequest,=pkCli_5609,wNc_5625: bitstring) = m1_5624 in
                                                {6746}let Nc_5626: bitstring = dec(wNc_5625,skSess) in
                                                {6747}new Ns_5627: bitstring;
                                                {6748}new ST_5628: bitstring;
                                                {6749}new TTL_5629: bitstring;
                                                {6750}let wNs_5630: bitstring = enc(Ns_5627,pkCli_5609) in
                                                {6751}let m2_5631: bitstring = (OpenSecureChannelResponse,wNs_5630,ST_5628,TTL_5629) in
                                                {6752}event beginSrv(Sess_5308,Cli_5306,Ns_5627);
                                                {6753}out(c, m2_5631);
                                                {6754}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                                {6755}event endSrv(Cli_5306,Sess_5308,Nc_5626)
                                            )
                                            else
                                                {6756}let v_5632: bool = (Disco_5307 = C) in
                                                (
                                                    {6757}if v_5632 then
                                                    (
                                                        {6758}let pkDisco_5633: bitstring = pub(skC) in
                                                        {6759}in(c, (=pkCli_5609,em1_5634: bitstring));
                                                        {6760}let m1_5635: bitstring = em1_5634 in
                                                        {6761}let (=OpenSecureChannelRequest,=pkCli_5609,wNc_5636: bitstring) = m1_5635 in
                                                        {6762}let Nc_5637: bitstring = dec(wNc_5636,skSess) in
                                                        {6763}new Ns_5638: bitstring;
                                                        {6764}new ST_5639: bitstring;
                                                        {6765}new TTL_5640: bitstring;
                                                        {6766}let wNs_5641: bitstring = enc(Ns_5638,pkCli_5609) in
                                                        {6767}let m2_5642: bitstring = (OpenSecureChannelResponse,wNs_5641,ST_5639,TTL_5640) in
                                                        {6768}event beginSrv(Sess_5308,Cli_5306,Ns_5638);
                                                        {6769}out(c, m2_5642);
                                                        {6770}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                                        {6771}event endSrv(Cli_5306,Sess_5308,Nc_5637)
                                                    )
                                                    else
                                                        {6772}let pkDisco_5643: bitstring = pub(sk(Disco_5307)) in
                                                        {6773}in(c, (=pkCli_5609,em1_5644: bitstring));
                                                        {6774}let m1_5645: bitstring = em1_5644 in
                                                        {6775}let (=OpenSecureChannelRequest,=pkCli_5609,wNc_5646: bitstring) = m1_5645 in
                                                        {6776}let Nc_5647: bitstring = dec(wNc_5646,skSess) in
                                                        {6777}new Ns_5648: bitstring;
                                                        {6778}new ST_5649: bitstring;
                                                        {6779}new TTL_5650: bitstring;
                                                        {6780}let wNs_5651: bitstring = enc(Ns_5648,pkCli_5609) in
                                                        {6781}let m2_5652: bitstring = (OpenSecureChannelResponse,wNs_5651,ST_5649,TTL_5650) in
                                                        {6782}event beginSrv(Sess_5308,Cli_5306,Ns_5648);
                                                        {6783}out(c, m2_5652);
                                                        {6784}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                                        {6785}event endSrv(Cli_5306,Sess_5308,Nc_5647)
                                                )
                                                else
                                                    {6786}let pkDisco_5653: bitstring = fail-any in
                                                    {6787}in(c, (=pkCli_5609,em1_5654: bitstring));
                                                    {6788}let m1_5655: bitstring = em1_5654 in
                                                    {6789}let (=OpenSecureChannelRequest,=pkCli_5609,wNc_5656: bitstring) = m1_5655 in
                                                    {6790}let Nc_5657: bitstring = dec(wNc_5656,skSess) in
                                                    {6791}new Ns_5658: bitstring;
                                                    {6792}new ST_5659: bitstring;
                                                    {6793}new TTL_5660: bitstring;
                                                    {6794}let wNs_5661: bitstring = enc(Ns_5658,pkCli_5609) in
                                                    {6795}let m2_5662: bitstring = (OpenSecureChannelResponse,wNs_5661,ST_5659,TTL_5660) in
                                                    {6796}event beginSrv(Sess_5308,Cli_5306,Ns_5658);
                                                    {6797}out(c, m2_5662);
                                                    {6798}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                                    {6799}event endSrv(Cli_5306,Sess_5308,Nc_5657)
                                        )
                                        else
                                            {6800}let pkDisco_5663: bitstring = fail-any in
                                            {6801}in(c, (=pkCli_5609,em1_5664: bitstring));
                                            {6802}let m1_5665: bitstring = em1_5664 in
                                            {6803}let (=OpenSecureChannelRequest,=pkCli_5609,wNc_5666: bitstring) = m1_5665 in
                                            {6804}let Nc_5667: bitstring = dec(wNc_5666,skSess) in
                                            {6805}new Ns_5668: bitstring;
                                            {6806}new ST_5669: bitstring;
                                            {6807}new TTL_5670: bitstring;
                                            {6808}let wNs_5671: bitstring = enc(Ns_5668,pkCli_5609) in
                                            {6809}let m2_5672: bitstring = (OpenSecureChannelResponse,wNs_5671,ST_5669,TTL_5670) in
                                            {6810}event beginSrv(Sess_5308,Cli_5306,Ns_5668);
                                            {6811}out(c, m2_5672);
                                            {6812}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                            {6813}event endSrv(Cli_5306,Sess_5308,Nc_5667)
                                )
                                else
                                    {6814}let pkDisco_5673: bitstring = fail-any in
                                    {6815}in(c, (=pkCli_5609,em1_5674: bitstring));
                                    {6816}let m1_5675: bitstring = em1_5674 in
                                    {6817}let (=OpenSecureChannelRequest,=pkCli_5609,wNc_5676: bitstring) = m1_5675 in
                                    {6818}let Nc_5677: bitstring = dec(wNc_5676,skSess) in
                                    {6819}new Ns_5678: bitstring;
                                    {6820}new ST_5679: bitstring;
                                    {6821}new TTL_5680: bitstring;
                                    {6822}let wNs_5681: bitstring = enc(Ns_5678,pkCli_5609) in
                                    {6823}let m2_5682: bitstring = (OpenSecureChannelResponse,wNs_5681,ST_5679,TTL_5680) in
                                    {6824}event beginSrv(Sess_5308,Cli_5306,Ns_5678);
                                    {6825}out(c, m2_5682);
                                    {6826}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                    {6827}event endSrv(Cli_5306,Sess_5308,Nc_5677)
                    )
                    else
                        {6828}let pkCli_5683: bitstring = fail-any in
                        {6829}let v_5684: bool = (Disco_5307 = A) in
                        (
                            {6830}if v_5684 then
                            (
                                {6831}let pkDisco_5685: bitstring = pub(skA) in
                                {6832}in(c, (=pkCli_5683,em1_5686: bitstring));
                                {6833}let m1_5687: bitstring = em1_5686 in
                                {6834}let (=OpenSecureChannelRequest,=pkCli_5683,wNc_5688: bitstring) = m1_5687 in
                                {6835}let Nc_5689: bitstring = dec(wNc_5688,skSess) in
                                {6836}new Ns_5690: bitstring;
                                {6837}new ST_5691: bitstring;
                                {6838}new TTL_5692: bitstring;
                                {6839}let wNs_5693: bitstring = enc(Ns_5690,pkCli_5683) in
                                {6840}let m2_5694: bitstring = (OpenSecureChannelResponse,wNs_5693,ST_5691,TTL_5692) in
                                {6841}event beginSrv(Sess_5308,Cli_5306,Ns_5690);
                                {6842}out(c, m2_5694);
                                {6843}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                {6844}event endSrv(Cli_5306,Sess_5308,Nc_5689)
                            )
                            else
                                {6845}let v_5695: bool = (Disco_5307 = B) in
                                (
                                    {6846}if v_5695 then
                                    (
                                        {6847}let pkDisco_5696: bitstring = pub(skB) in
                                        {6848}in(c, (=pkCli_5683,em1_5697: bitstring));
                                        {6849}let m1_5698: bitstring = em1_5697 in
                                        {6850}let (=OpenSecureChannelRequest,=pkCli_5683,wNc_5699: bitstring) = m1_5698 in
                                        {6851}let Nc_5700: bitstring = dec(wNc_5699,skSess) in
                                        {6852}new Ns_5701: bitstring;
                                        {6853}new ST_5702: bitstring;
                                        {6854}new TTL_5703: bitstring;
                                        {6855}let wNs_5704: bitstring = enc(Ns_5701,pkCli_5683) in
                                        {6856}let m2_5705: bitstring = (OpenSecureChannelResponse,wNs_5704,ST_5702,TTL_5703) in
                                        {6857}event beginSrv(Sess_5308,Cli_5306,Ns_5701);
                                        {6858}out(c, m2_5705);
                                        {6859}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                        {6860}event endSrv(Cli_5306,Sess_5308,Nc_5700)
                                    )
                                    else
                                        {6861}let v_5706: bool = (Disco_5307 = C) in
                                        (
                                            {6862}if v_5706 then
                                            (
                                                {6863}let pkDisco_5707: bitstring = pub(skC) in
                                                {6864}in(c, (=pkCli_5683,em1_5708: bitstring));
                                                {6865}let m1_5709: bitstring = em1_5708 in
                                                {6866}let (=OpenSecureChannelRequest,=pkCli_5683,wNc_5710: bitstring) = m1_5709 in
                                                {6867}let Nc_5711: bitstring = dec(wNc_5710,skSess) in
                                                {6868}new Ns_5712: bitstring;
                                                {6869}new ST_5713: bitstring;
                                                {6870}new TTL_5714: bitstring;
                                                {6871}let wNs_5715: bitstring = enc(Ns_5712,pkCli_5683) in
                                                {6872}let m2_5716: bitstring = (OpenSecureChannelResponse,wNs_5715,ST_5713,TTL_5714) in
                                                {6873}event beginSrv(Sess_5308,Cli_5306,Ns_5712);
                                                {6874}out(c, m2_5716);
                                                {6875}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                                {6876}event endSrv(Cli_5306,Sess_5308,Nc_5711)
                                            )
                                            else
                                                {6877}let pkDisco_5717: bitstring = pub(sk(Disco_5307)) in
                                                {6878}in(c, (=pkCli_5683,em1_5718: bitstring));
                                                {6879}let m1_5719: bitstring = em1_5718 in
                                                {6880}let (=OpenSecureChannelRequest,=pkCli_5683,wNc_5720: bitstring) = m1_5719 in
                                                {6881}let Nc_5721: bitstring = dec(wNc_5720,skSess) in
                                                {6882}new Ns_5722: bitstring;
                                                {6883}new ST_5723: bitstring;
                                                {6884}new TTL_5724: bitstring;
                                                {6885}let wNs_5725: bitstring = enc(Ns_5722,pkCli_5683) in
                                                {6886}let m2_5726: bitstring = (OpenSecureChannelResponse,wNs_5725,ST_5723,TTL_5724) in
                                                {6887}event beginSrv(Sess_5308,Cli_5306,Ns_5722);
                                                {6888}out(c, m2_5726);
                                                {6889}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                                {6890}event endSrv(Cli_5306,Sess_5308,Nc_5721)
                                        )
                                        else
                                            {6891}let pkDisco_5727: bitstring = fail-any in
                                            {6892}in(c, (=pkCli_5683,em1_5728: bitstring));
                                            {6893}let m1_5729: bitstring = em1_5728 in
                                            {6894}let (=OpenSecureChannelRequest,=pkCli_5683,wNc_5730: bitstring) = m1_5729 in
                                            {6895}let Nc_5731: bitstring = dec(wNc_5730,skSess) in
                                            {6896}new Ns_5732: bitstring;
                                            {6897}new ST_5733: bitstring;
                                            {6898}new TTL_5734: bitstring;
                                            {6899}let wNs_5735: bitstring = enc(Ns_5732,pkCli_5683) in
                                            {6900}let m2_5736: bitstring = (OpenSecureChannelResponse,wNs_5735,ST_5733,TTL_5734) in
                                            {6901}event beginSrv(Sess_5308,Cli_5306,Ns_5732);
                                            {6902}out(c, m2_5736);
                                            {6903}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                            {6904}event endSrv(Cli_5306,Sess_5308,Nc_5731)
                                )
                                else
                                    {6905}let pkDisco_5737: bitstring = fail-any in
                                    {6906}in(c, (=pkCli_5683,em1_5738: bitstring));
                                    {6907}let m1_5739: bitstring = em1_5738 in
                                    {6908}let (=OpenSecureChannelRequest,=pkCli_5683,wNc_5740: bitstring) = m1_5739 in
                                    {6909}let Nc_5741: bitstring = dec(wNc_5740,skSess) in
                                    {6910}new Ns_5742: bitstring;
                                    {6911}new ST_5743: bitstring;
                                    {6912}new TTL_5744: bitstring;
                                    {6913}let wNs_5745: bitstring = enc(Ns_5742,pkCli_5683) in
                                    {6914}let m2_5746: bitstring = (OpenSecureChannelResponse,wNs_5745,ST_5743,TTL_5744) in
                                    {6915}event beginSrv(Sess_5308,Cli_5306,Ns_5742);
                                    {6916}out(c, m2_5746);
                                    {6917}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                    {6918}event endSrv(Cli_5306,Sess_5308,Nc_5741)
                        )
                        else
                            {6919}let pkDisco_5747: bitstring = fail-any in
                            {6920}in(c, (=pkCli_5683,em1_5748: bitstring));
                            {6921}let m1_5749: bitstring = em1_5748 in
                            {6922}let (=OpenSecureChannelRequest,=pkCli_5683,wNc_5750: bitstring) = m1_5749 in
                            {6923}let Nc_5751: bitstring = dec(wNc_5750,skSess) in
                            {6924}new Ns_5752: bitstring;
                            {6925}new ST_5753: bitstring;
                            {6926}new TTL_5754: bitstring;
                            {6927}let wNs_5755: bitstring = enc(Ns_5752,pkCli_5683) in
                            {6928}let m2_5756: bitstring = (OpenSecureChannelResponse,wNs_5755,ST_5753,TTL_5754) in
                            {6929}event beginSrv(Sess_5308,Cli_5306,Ns_5752);
                            {6930}out(c, m2_5756);
                            {6931}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                            {6932}event endSrv(Cli_5306,Sess_5308,Nc_5751)
            )
            else
                {6933}let pkCli_5757: bitstring = fail-any in
                {6934}let v_5758: bool = (Disco_5307 = A) in
                (
                    {6935}if v_5758 then
                    (
                        {6936}let pkDisco_5759: bitstring = pub(skA) in
                        {6937}in(c, (=pkCli_5757,em1_5760: bitstring));
                        {6938}let m1_5761: bitstring = em1_5760 in
                        {6939}let (=OpenSecureChannelRequest,=pkCli_5757,wNc_5762: bitstring) = m1_5761 in
                        {6940}let Nc_5763: bitstring = dec(wNc_5762,skSess) in
                        {6941}new Ns_5764: bitstring;
                        {6942}new ST_5765: bitstring;
                        {6943}new TTL_5766: bitstring;
                        {6944}let wNs_5767: bitstring = enc(Ns_5764,pkCli_5757) in
                        {6945}let m2_5768: bitstring = (OpenSecureChannelResponse,wNs_5767,ST_5765,TTL_5766) in
                        {6946}event beginSrv(Sess_5308,Cli_5306,Ns_5764);
                        {6947}out(c, m2_5768);
                        {6948}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                        {6949}event endSrv(Cli_5306,Sess_5308,Nc_5763)
                    )
                    else
                        {6950}let v_5769: bool = (Disco_5307 = B) in
                        (
                            {6951}if v_5769 then
                            (
                                {6952}let pkDisco_5770: bitstring = pub(skB) in
                                {6953}in(c, (=pkCli_5757,em1_5771: bitstring));
                                {6954}let m1_5772: bitstring = em1_5771 in
                                {6955}let (=OpenSecureChannelRequest,=pkCli_5757,wNc_5773: bitstring) = m1_5772 in
                                {6956}let Nc_5774: bitstring = dec(wNc_5773,skSess) in
                                {6957}new Ns_5775: bitstring;
                                {6958}new ST_5776: bitstring;
                                {6959}new TTL_5777: bitstring;
                                {6960}let wNs_5778: bitstring = enc(Ns_5775,pkCli_5757) in
                                {6961}let m2_5779: bitstring = (OpenSecureChannelResponse,wNs_5778,ST_5776,TTL_5777) in
                                {6962}event beginSrv(Sess_5308,Cli_5306,Ns_5775);
                                {6963}out(c, m2_5779);
                                {6964}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                {6965}event endSrv(Cli_5306,Sess_5308,Nc_5774)
                            )
                            else
                                {6966}let v_5780: bool = (Disco_5307 = C) in
                                (
                                    {6967}if v_5780 then
                                    (
                                        {6968}let pkDisco_5781: bitstring = pub(skC) in
                                        {6969}in(c, (=pkCli_5757,em1_5782: bitstring));
                                        {6970}let m1_5783: bitstring = em1_5782 in
                                        {6971}let (=OpenSecureChannelRequest,=pkCli_5757,wNc_5784: bitstring) = m1_5783 in
                                        {6972}let Nc_5785: bitstring = dec(wNc_5784,skSess) in
                                        {6973}new Ns_5786: bitstring;
                                        {6974}new ST_5787: bitstring;
                                        {6975}new TTL_5788: bitstring;
                                        {6976}let wNs_5789: bitstring = enc(Ns_5786,pkCli_5757) in
                                        {6977}let m2_5790: bitstring = (OpenSecureChannelResponse,wNs_5789,ST_5787,TTL_5788) in
                                        {6978}event beginSrv(Sess_5308,Cli_5306,Ns_5786);
                                        {6979}out(c, m2_5790);
                                        {6980}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                        {6981}event endSrv(Cli_5306,Sess_5308,Nc_5785)
                                    )
                                    else
                                        {6982}let pkDisco_5791: bitstring = pub(sk(Disco_5307)) in
                                        {6983}in(c, (=pkCli_5757,em1_5792: bitstring));
                                        {6984}let m1_5793: bitstring = em1_5792 in
                                        {6985}let (=OpenSecureChannelRequest,=pkCli_5757,wNc_5794: bitstring) = m1_5793 in
                                        {6986}let Nc_5795: bitstring = dec(wNc_5794,skSess) in
                                        {6987}new Ns_5796: bitstring;
                                        {6988}new ST_5797: bitstring;
                                        {6989}new TTL_5798: bitstring;
                                        {6990}let wNs_5799: bitstring = enc(Ns_5796,pkCli_5757) in
                                        {6991}let m2_5800: bitstring = (OpenSecureChannelResponse,wNs_5799,ST_5797,TTL_5798) in
                                        {6992}event beginSrv(Sess_5308,Cli_5306,Ns_5796);
                                        {6993}out(c, m2_5800);
                                        {6994}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                        {6995}event endSrv(Cli_5306,Sess_5308,Nc_5795)
                                )
                                else
                                    {6996}let pkDisco_5801: bitstring = fail-any in
                                    {6997}in(c, (=pkCli_5757,em1_5802: bitstring));
                                    {6998}let m1_5803: bitstring = em1_5802 in
                                    {6999}let (=OpenSecureChannelRequest,=pkCli_5757,wNc_5804: bitstring) = m1_5803 in
                                    {7000}let Nc_5805: bitstring = dec(wNc_5804,skSess) in
                                    {7001}new Ns_5806: bitstring;
                                    {7002}new ST_5807: bitstring;
                                    {7003}new TTL_5808: bitstring;
                                    {7004}let wNs_5809: bitstring = enc(Ns_5806,pkCli_5757) in
                                    {7005}let m2_5810: bitstring = (OpenSecureChannelResponse,wNs_5809,ST_5807,TTL_5808) in
                                    {7006}event beginSrv(Sess_5308,Cli_5306,Ns_5806);
                                    {7007}out(c, m2_5810);
                                    {7008}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                    {7009}event endSrv(Cli_5306,Sess_5308,Nc_5805)
                        )
                        else
                            {7010}let pkDisco_5811: bitstring = fail-any in
                            {7011}in(c, (=pkCli_5757,em1_5812: bitstring));
                            {7012}let m1_5813: bitstring = em1_5812 in
                            {7013}let (=OpenSecureChannelRequest,=pkCli_5757,wNc_5814: bitstring) = m1_5813 in
                            {7014}let Nc_5815: bitstring = dec(wNc_5814,skSess) in
                            {7015}new Ns_5816: bitstring;
                            {7016}new ST_5817: bitstring;
                            {7017}new TTL_5818: bitstring;
                            {7018}let wNs_5819: bitstring = enc(Ns_5816,pkCli_5757) in
                            {7019}let m2_5820: bitstring = (OpenSecureChannelResponse,wNs_5819,ST_5817,TTL_5818) in
                            {7020}event beginSrv(Sess_5308,Cli_5306,Ns_5816);
                            {7021}out(c, m2_5820);
                            {7022}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                            {7023}event endSrv(Cli_5306,Sess_5308,Nc_5815)
                )
                else
                    {7024}let pkDisco_5821: bitstring = fail-any in
                    {7025}in(c, (=pkCli_5757,em1_5822: bitstring));
                    {7026}let m1_5823: bitstring = em1_5822 in
                    {7027}let (=OpenSecureChannelRequest,=pkCli_5757,wNc_5824: bitstring) = m1_5823 in
                    {7028}let Nc_5825: bitstring = dec(wNc_5824,skSess) in
                    {7029}new Ns_5826: bitstring;
                    {7030}new ST_5827: bitstring;
                    {7031}new TTL_5828: bitstring;
                    {7032}let wNs_5829: bitstring = enc(Ns_5826,pkCli_5757) in
                    {7033}let m2_5830: bitstring = (OpenSecureChannelResponse,wNs_5829,ST_5827,TTL_5828) in
                    {7034}event beginSrv(Sess_5308,Cli_5306,Ns_5826);
                    {7035}out(c, m2_5830);
                    {7036}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                    {7037}event endSrv(Cli_5306,Sess_5308,Nc_5825)
        )
        else
            {7038}let v_5831: bool = (Sess_5308 = B) in
            (
                {7039}if v_5831 then
                (
                    {7040}let skSess_5832: bitstring = skB in
                    {7041}let pkSess_5833: bitstring = pub(skSess_5832) in
                    {7042}let v_5834: bool = (Cli_5306 = A) in
                    (
                        {7043}if v_5834 then
                        (
                            {7044}let pkCli_5835: bitstring = pub(skA) in
                            {7045}let v_5836: bool = (Disco_5307 = A) in
                            (
                                {7046}if v_5836 then
                                (
                                    {7047}let pkDisco_5837: bitstring = pub(skA) in
                                    {7048}in(c, (=pkCli_5835,em1_5838: bitstring));
                                    {7049}let m1_5839: bitstring = em1_5838 in
                                    {7050}let (=OpenSecureChannelRequest,=pkCli_5835,wNc_5840: bitstring) = m1_5839 in
                                    {7051}let Nc_5841: bitstring = dec(wNc_5840,skSess_5832) in
                                    {7052}new Ns_5842: bitstring;
                                    {7053}new ST_5843: bitstring;
                                    {7054}new TTL_5844: bitstring;
                                    {7055}let wNs_5845: bitstring = enc(Ns_5842,pkCli_5835) in
                                    {7056}let m2_5846: bitstring = (OpenSecureChannelResponse,wNs_5845,ST_5843,TTL_5844) in
                                    {7057}event beginSrv(Sess_5308,Cli_5306,Ns_5842);
                                    {7058}out(c, m2_5846);
                                    {7059}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                    {7060}event endSrv(Cli_5306,Sess_5308,Nc_5841)
                                )
                                else
                                    {7061}let v_5847: bool = (Disco_5307 = B) in
                                    (
                                        {7062}if v_5847 then
                                        (
                                            {7063}let pkDisco_5848: bitstring = pub(skB) in
                                            {7064}in(c, (=pkCli_5835,em1_5849: bitstring));
                                            {7065}let m1_5850: bitstring = em1_5849 in
                                            {7066}let (=OpenSecureChannelRequest,=pkCli_5835,wNc_5851: bitstring) = m1_5850 in
                                            {7067}let Nc_5852: bitstring = dec(wNc_5851,skSess_5832) in
                                            {7068}new Ns_5853: bitstring;
                                            {7069}new ST_5854: bitstring;
                                            {7070}new TTL_5855: bitstring;
                                            {7071}let wNs_5856: bitstring = enc(Ns_5853,pkCli_5835) in
                                            {7072}let m2_5857: bitstring = (OpenSecureChannelResponse,wNs_5856,ST_5854,TTL_5855) in
                                            {7073}event beginSrv(Sess_5308,Cli_5306,Ns_5853);
                                            {7074}out(c, m2_5857);
                                            {7075}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                            {7076}event endSrv(Cli_5306,Sess_5308,Nc_5852)
                                        )
                                        else
                                            {7077}let v_5858: bool = (Disco_5307 = C) in
                                            (
                                                {7078}if v_5858 then
                                                (
                                                    {7079}let pkDisco_5859: bitstring = pub(skC) in
                                                    {7080}in(c, (=pkCli_5835,em1_5860: bitstring));
                                                    {7081}let m1_5861: bitstring = em1_5860 in
                                                    {7082}let (=OpenSecureChannelRequest,=pkCli_5835,wNc_5862: bitstring) = m1_5861 in
                                                    {7083}let Nc_5863: bitstring = dec(wNc_5862,skSess_5832) in
                                                    {7084}new Ns_5864: bitstring;
                                                    {7085}new ST_5865: bitstring;
                                                    {7086}new TTL_5866: bitstring;
                                                    {7087}let wNs_5867: bitstring = enc(Ns_5864,pkCli_5835) in
                                                    {7088}let m2_5868: bitstring = (OpenSecureChannelResponse,wNs_5867,ST_5865,TTL_5866) in
                                                    {7089}event beginSrv(Sess_5308,Cli_5306,Ns_5864);
                                                    {7090}out(c, m2_5868);
                                                    {7091}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                                    {7092}event endSrv(Cli_5306,Sess_5308,Nc_5863)
                                                )
                                                else
                                                    {7093}let pkDisco_5869: bitstring = pub(sk(Disco_5307)) in
                                                    {7094}in(c, (=pkCli_5835,em1_5870: bitstring));
                                                    {7095}let m1_5871: bitstring = em1_5870 in
                                                    {7096}let (=OpenSecureChannelRequest,=pkCli_5835,wNc_5872: bitstring) = m1_5871 in
                                                    {7097}let Nc_5873: bitstring = dec(wNc_5872,skSess_5832) in
                                                    {7098}new Ns_5874: bitstring;
                                                    {7099}new ST_5875: bitstring;
                                                    {7100}new TTL_5876: bitstring;
                                                    {7101}let wNs_5877: bitstring = enc(Ns_5874,pkCli_5835) in
                                                    {7102}let m2_5878: bitstring = (OpenSecureChannelResponse,wNs_5877,ST_5875,TTL_5876) in
                                                    {7103}event beginSrv(Sess_5308,Cli_5306,Ns_5874);
                                                    {7104}out(c, m2_5878);
                                                    {7105}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                                    {7106}event endSrv(Cli_5306,Sess_5308,Nc_5873)
                                            )
                                            else
                                                {7107}let pkDisco_5879: bitstring = fail-any in
                                                {7108}in(c, (=pkCli_5835,em1_5880: bitstring));
                                                {7109}let m1_5881: bitstring = em1_5880 in
                                                {7110}let (=OpenSecureChannelRequest,=pkCli_5835,wNc_5882: bitstring) = m1_5881 in
                                                {7111}let Nc_5883: bitstring = dec(wNc_5882,skSess_5832) in
                                                {7112}new Ns_5884: bitstring;
                                                {7113}new ST_5885: bitstring;
                                                {7114}new TTL_5886: bitstring;
                                                {7115}let wNs_5887: bitstring = enc(Ns_5884,pkCli_5835) in
                                                {7116}let m2_5888: bitstring = (OpenSecureChannelResponse,wNs_5887,ST_5885,TTL_5886) in
                                                {7117}event beginSrv(Sess_5308,Cli_5306,Ns_5884);
                                                {7118}out(c, m2_5888);
                                                {7119}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                                {7120}event endSrv(Cli_5306,Sess_5308,Nc_5883)
                                    )
                                    else
                                        {7121}let pkDisco_5889: bitstring = fail-any in
                                        {7122}in(c, (=pkCli_5835,em1_5890: bitstring));
                                        {7123}let m1_5891: bitstring = em1_5890 in
                                        {7124}let (=OpenSecureChannelRequest,=pkCli_5835,wNc_5892: bitstring) = m1_5891 in
                                        {7125}let Nc_5893: bitstring = dec(wNc_5892,skSess_5832) in
                                        {7126}new Ns_5894: bitstring;
                                        {7127}new ST_5895: bitstring;
                                        {7128}new TTL_5896: bitstring;
                                        {7129}let wNs_5897: bitstring = enc(Ns_5894,pkCli_5835) in
                                        {7130}let m2_5898: bitstring = (OpenSecureChannelResponse,wNs_5897,ST_5895,TTL_5896) in
                                        {7131}event beginSrv(Sess_5308,Cli_5306,Ns_5894);
                                        {7132}out(c, m2_5898);
                                        {7133}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                        {7134}event endSrv(Cli_5306,Sess_5308,Nc_5893)
                            )
                            else
                                {7135}let pkDisco_5899: bitstring = fail-any in
                                {7136}in(c, (=pkCli_5835,em1_5900: bitstring));
                                {7137}let m1_5901: bitstring = em1_5900 in
                                {7138}let (=OpenSecureChannelRequest,=pkCli_5835,wNc_5902: bitstring) = m1_5901 in
                                {7139}let Nc_5903: bitstring = dec(wNc_5902,skSess_5832) in
                                {7140}new Ns_5904: bitstring;
                                {7141}new ST_5905: bitstring;
                                {7142}new TTL_5906: bitstring;
                                {7143}let wNs_5907: bitstring = enc(Ns_5904,pkCli_5835) in
                                {7144}let m2_5908: bitstring = (OpenSecureChannelResponse,wNs_5907,ST_5905,TTL_5906) in
                                {7145}event beginSrv(Sess_5308,Cli_5306,Ns_5904);
                                {7146}out(c, m2_5908);
                                {7147}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                {7148}event endSrv(Cli_5306,Sess_5308,Nc_5903)
                        )
                        else
                            {7149}let v_5909: bool = (Cli_5306 = B) in
                            (
                                {7150}if v_5909 then
                                (
                                    {7151}let pkCli_5910: bitstring = pub(skB) in
                                    {7152}let v_5911: bool = (Disco_5307 = A) in
                                    (
                                        {7153}if v_5911 then
                                        (
                                            {7154}let pkDisco_5912: bitstring = pub(skA) in
                                            {7155}in(c, (=pkCli_5910,em1_5913: bitstring));
                                            {7156}let m1_5914: bitstring = em1_5913 in
                                            {7157}let (=OpenSecureChannelRequest,=pkCli_5910,wNc_5915: bitstring) = m1_5914 in
                                            {7158}let Nc_5916: bitstring = dec(wNc_5915,skSess_5832) in
                                            {7159}new Ns_5917: bitstring;
                                            {7160}new ST_5918: bitstring;
                                            {7161}new TTL_5919: bitstring;
                                            {7162}let wNs_5920: bitstring = enc(Ns_5917,pkCli_5910) in
                                            {7163}let m2_5921: bitstring = (OpenSecureChannelResponse,wNs_5920,ST_5918,TTL_5919) in
                                            {7164}event beginSrv(Sess_5308,Cli_5306,Ns_5917);
                                            {7165}out(c, m2_5921);
                                            {7166}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                            {7167}event endSrv(Cli_5306,Sess_5308,Nc_5916)
                                        )
                                        else
                                            {7168}let v_5922: bool = (Disco_5307 = B) in
                                            (
                                                {7169}if v_5922 then
                                                (
                                                    {7170}let pkDisco_5923: bitstring = pub(skB) in
                                                    {7171}in(c, (=pkCli_5910,em1_5924: bitstring));
                                                    {7172}let m1_5925: bitstring = em1_5924 in
                                                    {7173}let (=OpenSecureChannelRequest,=pkCli_5910,wNc_5926: bitstring) = m1_5925 in
                                                    {7174}let Nc_5927: bitstring = dec(wNc_5926,skSess_5832) in
                                                    {7175}new Ns_5928: bitstring;
                                                    {7176}new ST_5929: bitstring;
                                                    {7177}new TTL_5930: bitstring;
                                                    {7178}let wNs_5931: bitstring = enc(Ns_5928,pkCli_5910) in
                                                    {7179}let m2_5932: bitstring = (OpenSecureChannelResponse,wNs_5931,ST_5929,TTL_5930) in
                                                    {7180}event beginSrv(Sess_5308,Cli_5306,Ns_5928);
                                                    {7181}out(c, m2_5932);
                                                    {7182}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                                    {7183}event endSrv(Cli_5306,Sess_5308,Nc_5927)
                                                )
                                                else
                                                    {7184}let v_5933: bool = (Disco_5307 = C) in
                                                    (
                                                        {7185}if v_5933 then
                                                        (
                                                            {7186}let pkDisco_5934: bitstring = pub(skC) in
                                                            {7187}in(c, (=pkCli_5910,em1_5935: bitstring));
                                                            {7188}let m1_5936: bitstring = em1_5935 in
                                                            {7189}let (=OpenSecureChannelRequest,=pkCli_5910,wNc_5937: bitstring) = m1_5936 in
                                                            {7190}let Nc_5938: bitstring = dec(wNc_5937,skSess_5832) in
                                                            {7191}new Ns_5939: bitstring;
                                                            {7192}new ST_5940: bitstring;
                                                            {7193}new TTL_5941: bitstring;
                                                            {7194}let wNs_5942: bitstring = enc(Ns_5939,pkCli_5910) in
                                                            {7195}let m2_5943: bitstring = (OpenSecureChannelResponse,wNs_5942,ST_5940,TTL_5941) in
                                                            {7196}event beginSrv(Sess_5308,Cli_5306,Ns_5939);
                                                            {7197}out(c, m2_5943);
                                                            {7198}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                                            {7199}event endSrv(Cli_5306,Sess_5308,Nc_5938)
                                                        )
                                                        else
                                                            {7200}let pkDisco_5944: bitstring = pub(sk(Disco_5307)) in
                                                            {7201}in(c, (=pkCli_5910,em1_5945: bitstring));
                                                            {7202}let m1_5946: bitstring = em1_5945 in
                                                            {7203}let (=OpenSecureChannelRequest,=pkCli_5910,wNc_5947: bitstring) = m1_5946 in
                                                            {7204}let Nc_5948: bitstring = dec(wNc_5947,skSess_5832) in
                                                            {7205}new Ns_5949: bitstring;
                                                            {7206}new ST_5950: bitstring;
                                                            {7207}new TTL_5951: bitstring;
                                                            {7208}let wNs_5952: bitstring = enc(Ns_5949,pkCli_5910) in
                                                            {7209}let m2_5953: bitstring = (OpenSecureChannelResponse,wNs_5952,ST_5950,TTL_5951) in
                                                            {7210}event beginSrv(Sess_5308,Cli_5306,Ns_5949);
                                                            {7211}out(c, m2_5953);
                                                            {7212}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                                            {7213}event endSrv(Cli_5306,Sess_5308,Nc_5948)
                                                    )
                                                    else
                                                        {7214}let pkDisco_5954: bitstring = fail-any in
                                                        {7215}in(c, (=pkCli_5910,em1_5955: bitstring));
                                                        {7216}let m1_5956: bitstring = em1_5955 in
                                                        {7217}let (=OpenSecureChannelRequest,=pkCli_5910,wNc_5957: bitstring) = m1_5956 in
                                                        {7218}let Nc_5958: bitstring = dec(wNc_5957,skSess_5832) in
                                                        {7219}new Ns_5959: bitstring;
                                                        {7220}new ST_5960: bitstring;
                                                        {7221}new TTL_5961: bitstring;
                                                        {7222}let wNs_5962: bitstring = enc(Ns_5959,pkCli_5910) in
                                                        {7223}let m2_5963: bitstring = (OpenSecureChannelResponse,wNs_5962,ST_5960,TTL_5961) in
                                                        {7224}event beginSrv(Sess_5308,Cli_5306,Ns_5959);
                                                        {7225}out(c, m2_5963);
                                                        {7226}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                                        {7227}event endSrv(Cli_5306,Sess_5308,Nc_5958)
                                            )
                                            else
                                                {7228}let pkDisco_5964: bitstring = fail-any in
                                                {7229}in(c, (=pkCli_5910,em1_5965: bitstring));
                                                {7230}let m1_5966: bitstring = em1_5965 in
                                                {7231}let (=OpenSecureChannelRequest,=pkCli_5910,wNc_5967: bitstring) = m1_5966 in
                                                {7232}let Nc_5968: bitstring = dec(wNc_5967,skSess_5832) in
                                                {7233}new Ns_5969: bitstring;
                                                {7234}new ST_5970: bitstring;
                                                {7235}new TTL_5971: bitstring;
                                                {7236}let wNs_5972: bitstring = enc(Ns_5969,pkCli_5910) in
                                                {7237}let m2_5973: bitstring = (OpenSecureChannelResponse,wNs_5972,ST_5970,TTL_5971) in
                                                {7238}event beginSrv(Sess_5308,Cli_5306,Ns_5969);
                                                {7239}out(c, m2_5973);
                                                {7240}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                                {7241}event endSrv(Cli_5306,Sess_5308,Nc_5968)
                                    )
                                    else
                                        {7242}let pkDisco_5974: bitstring = fail-any in
                                        {7243}in(c, (=pkCli_5910,em1_5975: bitstring));
                                        {7244}let m1_5976: bitstring = em1_5975 in
                                        {7245}let (=OpenSecureChannelRequest,=pkCli_5910,wNc_5977: bitstring) = m1_5976 in
                                        {7246}let Nc_5978: bitstring = dec(wNc_5977,skSess_5832) in
                                        {7247}new Ns_5979: bitstring;
                                        {7248}new ST_5980: bitstring;
                                        {7249}new TTL_5981: bitstring;
                                        {7250}let wNs_5982: bitstring = enc(Ns_5979,pkCli_5910) in
                                        {7251}let m2_5983: bitstring = (OpenSecureChannelResponse,wNs_5982,ST_5980,TTL_5981) in
                                        {7252}event beginSrv(Sess_5308,Cli_5306,Ns_5979);
                                        {7253}out(c, m2_5983);
                                        {7254}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                        {7255}event endSrv(Cli_5306,Sess_5308,Nc_5978)
                                )
                                else
                                    {7256}let v_5984: bool = (Cli_5306 = C) in
                                    (
                                        {7257}if v_5984 then
                                        (
                                            {7258}let pkCli_5985: bitstring = pub(skC) in
                                            {7259}let v_5986: bool = (Disco_5307 = A) in
                                            (
                                                {7260}if v_5986 then
                                                (
                                                    {7261}let pkDisco_5987: bitstring = pub(skA) in
                                                    {7262}in(c, (=pkCli_5985,em1_5988: bitstring));
                                                    {7263}let m1_5989: bitstring = em1_5988 in
                                                    {7264}let (=OpenSecureChannelRequest,=pkCli_5985,wNc_5990: bitstring) = m1_5989 in
                                                    {7265}let Nc_5991: bitstring = dec(wNc_5990,skSess_5832) in
                                                    {7266}new Ns_5992: bitstring;
                                                    {7267}new ST_5993: bitstring;
                                                    {7268}new TTL_5994: bitstring;
                                                    {7269}let wNs_5995: bitstring = enc(Ns_5992,pkCli_5985) in
                                                    {7270}let m2_5996: bitstring = (OpenSecureChannelResponse,wNs_5995,ST_5993,TTL_5994) in
                                                    {7271}event beginSrv(Sess_5308,Cli_5306,Ns_5992);
                                                    {7272}out(c, m2_5996);
                                                    {7273}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                                    {7274}event endSrv(Cli_5306,Sess_5308,Nc_5991)
                                                )
                                                else
                                                    {7275}let v_5997: bool = (Disco_5307 = B) in
                                                    (
                                                        {7276}if v_5997 then
                                                        (
                                                            {7277}let pkDisco_5998: bitstring = pub(skB) in
                                                            {7278}in(c, (=pkCli_5985,em1_5999: bitstring));
                                                            {7279}let m1_6000: bitstring = em1_5999 in
                                                            {7280}let (=OpenSecureChannelRequest,=pkCli_5985,wNc_6001: bitstring) = m1_6000 in
                                                            {7281}let Nc_6002: bitstring = dec(wNc_6001,skSess_5832) in
                                                            {7282}new Ns_6003: bitstring;
                                                            {7283}new ST_6004: bitstring;
                                                            {7284}new TTL_6005: bitstring;
                                                            {7285}let wNs_6006: bitstring = enc(Ns_6003,pkCli_5985) in
                                                            {7286}let m2_6007: bitstring = (OpenSecureChannelResponse,wNs_6006,ST_6004,TTL_6005) in
                                                            {7287}event beginSrv(Sess_5308,Cli_5306,Ns_6003);
                                                            {7288}out(c, m2_6007);
                                                            {7289}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                                            {7290}event endSrv(Cli_5306,Sess_5308,Nc_6002)
                                                        )
                                                        else
                                                            {7291}let v_6008: bool = (Disco_5307 = C) in
                                                            (
                                                                {7292}if v_6008 then
                                                                (
                                                                    {7293}let pkDisco_6009: bitstring = pub(skC) in
                                                                    {7294}in(c, (=pkCli_5985,em1_6010: bitstring));
                                                                    {7295}let m1_6011: bitstring = em1_6010 in
                                                                    {7296}let (=OpenSecureChannelRequest,=pkCli_5985,wNc_6012: bitstring) = m1_6011 in
                                                                    {7297}let Nc_6013: bitstring = dec(wNc_6012,skSess_5832) in
                                                                    {7298}new Ns_6014: bitstring;
                                                                    {7299}new ST_6015: bitstring;
                                                                    {7300}new TTL_6016: bitstring;
                                                                    {7301}let wNs_6017: bitstring = enc(Ns_6014,pkCli_5985) in
                                                                    {7302}let m2_6018: bitstring = (OpenSecureChannelResponse,wNs_6017,ST_6015,TTL_6016) in
                                                                    {7303}event beginSrv(Sess_5308,Cli_5306,Ns_6014);
                                                                    {7304}out(c, m2_6018);
                                                                    {7305}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                                                    {7306}event endSrv(Cli_5306,Sess_5308,Nc_6013)
                                                                )
                                                                else
                                                                    {7307}let pkDisco_6019: bitstring = pub(sk(Disco_5307)) in
                                                                    {7308}in(c, (=pkCli_5985,em1_6020: bitstring));
                                                                    {7309}let m1_6021: bitstring = em1_6020 in
                                                                    {7310}let (=OpenSecureChannelRequest,=pkCli_5985,wNc_6022: bitstring) = m1_6021 in
                                                                    {7311}let Nc_6023: bitstring = dec(wNc_6022,skSess_5832) in
                                                                    {7312}new Ns_6024: bitstring;
                                                                    {7313}new ST_6025: bitstring;
                                                                    {7314}new TTL_6026: bitstring;
                                                                    {7315}let wNs_6027: bitstring = enc(Ns_6024,pkCli_5985) in
                                                                    {7316}let m2_6028: bitstring = (OpenSecureChannelResponse,wNs_6027,ST_6025,TTL_6026) in
                                                                    {7317}event beginSrv(Sess_5308,Cli_5306,Ns_6024);
                                                                    {7318}out(c, m2_6028);
                                                                    {7319}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                                                    {7320}event endSrv(Cli_5306,Sess_5308,Nc_6023)
                                                            )
                                                            else
                                                                {7321}let pkDisco_6029: bitstring = fail-any in
                                                                {7322}in(c, (=pkCli_5985,em1_6030: bitstring));
                                                                {7323}let m1_6031: bitstring = em1_6030 in
                                                                {7324}let (=OpenSecureChannelRequest,=pkCli_5985,wNc_6032: bitstring) = m1_6031 in
                                                                {7325}let Nc_6033: bitstring = dec(wNc_6032,skSess_5832) in
                                                                {7326}new Ns_6034: bitstring;
                                                                {7327}new ST_6035: bitstring;
                                                                {7328}new TTL_6036: bitstring;
                                                                {7329}let wNs_6037: bitstring = enc(Ns_6034,pkCli_5985) in
                                                                {7330}let m2_6038: bitstring = (OpenSecureChannelResponse,wNs_6037,ST_6035,TTL_6036) in
                                                                {7331}event beginSrv(Sess_5308,Cli_5306,Ns_6034);
                                                                {7332}out(c, m2_6038);
                                                                {7333}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                                                {7334}event endSrv(Cli_5306,Sess_5308,Nc_6033)
                                                    )
                                                    else
                                                        {7335}let pkDisco_6039: bitstring = fail-any in
                                                        {7336}in(c, (=pkCli_5985,em1_6040: bitstring));
                                                        {7337}let m1_6041: bitstring = em1_6040 in
                                                        {7338}let (=OpenSecureChannelRequest,=pkCli_5985,wNc_6042: bitstring) = m1_6041 in
                                                        {7339}let Nc_6043: bitstring = dec(wNc_6042,skSess_5832) in
                                                        {7340}new Ns_6044: bitstring;
                                                        {7341}new ST_6045: bitstring;
                                                        {7342}new TTL_6046: bitstring;
                                                        {7343}let wNs_6047: bitstring = enc(Ns_6044,pkCli_5985) in
                                                        {7344}let m2_6048: bitstring = (OpenSecureChannelResponse,wNs_6047,ST_6045,TTL_6046) in
                                                        {7345}event beginSrv(Sess_5308,Cli_5306,Ns_6044);
                                                        {7346}out(c, m2_6048);
                                                        {7347}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                                        {7348}event endSrv(Cli_5306,Sess_5308,Nc_6043)
                                            )
                                            else
                                                {7349}let pkDisco_6049: bitstring = fail-any in
                                                {7350}in(c, (=pkCli_5985,em1_6050: bitstring));
                                                {7351}let m1_6051: bitstring = em1_6050 in
                                                {7352}let (=OpenSecureChannelRequest,=pkCli_5985,wNc_6052: bitstring) = m1_6051 in
                                                {7353}let Nc_6053: bitstring = dec(wNc_6052,skSess_5832) in
                                                {7354}new Ns_6054: bitstring;
                                                {7355}new ST_6055: bitstring;
                                                {7356}new TTL_6056: bitstring;
                                                {7357}let wNs_6057: bitstring = enc(Ns_6054,pkCli_5985) in
                                                {7358}let m2_6058: bitstring = (OpenSecureChannelResponse,wNs_6057,ST_6055,TTL_6056) in
                                                {7359}event beginSrv(Sess_5308,Cli_5306,Ns_6054);
                                                {7360}out(c, m2_6058);
                                                {7361}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                                {7362}event endSrv(Cli_5306,Sess_5308,Nc_6053)
                                        )
                                        else
                                            {7363}let pkCli_6059: bitstring = pub(sk(Cli_5306)) in
                                            {7364}let v_6060: bool = (Disco_5307 = A) in
                                            (
                                                {7365}if v_6060 then
                                                (
                                                    {7366}let pkDisco_6061: bitstring = pub(skA) in
                                                    {7367}in(c, (=pkCli_6059,em1_6062: bitstring));
                                                    {7368}let m1_6063: bitstring = em1_6062 in
                                                    {7369}let (=OpenSecureChannelRequest,=pkCli_6059,wNc_6064: bitstring) = m1_6063 in
                                                    {7370}let Nc_6065: bitstring = dec(wNc_6064,skSess_5832) in
                                                    {7371}new Ns_6066: bitstring;
                                                    {7372}new ST_6067: bitstring;
                                                    {7373}new TTL_6068: bitstring;
                                                    {7374}let wNs_6069: bitstring = enc(Ns_6066,pkCli_6059) in
                                                    {7375}let m2_6070: bitstring = (OpenSecureChannelResponse,wNs_6069,ST_6067,TTL_6068) in
                                                    {7376}event beginSrv(Sess_5308,Cli_5306,Ns_6066);
                                                    {7377}out(c, m2_6070);
                                                    {7378}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                                    {7379}event endSrv(Cli_5306,Sess_5308,Nc_6065)
                                                )
                                                else
                                                    {7380}let v_6071: bool = (Disco_5307 = B) in
                                                    (
                                                        {7381}if v_6071 then
                                                        (
                                                            {7382}let pkDisco_6072: bitstring = pub(skB) in
                                                            {7383}in(c, (=pkCli_6059,em1_6073: bitstring));
                                                            {7384}let m1_6074: bitstring = em1_6073 in
                                                            {7385}let (=OpenSecureChannelRequest,=pkCli_6059,wNc_6075: bitstring) = m1_6074 in
                                                            {7386}let Nc_6076: bitstring = dec(wNc_6075,skSess_5832) in
                                                            {7387}new Ns_6077: bitstring;
                                                            {7388}new ST_6078: bitstring;
                                                            {7389}new TTL_6079: bitstring;
                                                            {7390}let wNs_6080: bitstring = enc(Ns_6077,pkCli_6059) in
                                                            {7391}let m2_6081: bitstring = (OpenSecureChannelResponse,wNs_6080,ST_6078,TTL_6079) in
                                                            {7392}event beginSrv(Sess_5308,Cli_5306,Ns_6077);
                                                            {7393}out(c, m2_6081);
                                                            {7394}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                                            {7395}event endSrv(Cli_5306,Sess_5308,Nc_6076)
                                                        )
                                                        else
                                                            {7396}let v_6082: bool = (Disco_5307 = C) in
                                                            (
                                                                {7397}if v_6082 then
                                                                (
                                                                    {7398}let pkDisco_6083: bitstring = pub(skC) in
                                                                    {7399}in(c, (=pkCli_6059,em1_6084: bitstring));
                                                                    {7400}let m1_6085: bitstring = em1_6084 in
                                                                    {7401}let (=OpenSecureChannelRequest,=pkCli_6059,wNc_6086: bitstring) = m1_6085 in
                                                                    {7402}let Nc_6087: bitstring = dec(wNc_6086,skSess_5832) in
                                                                    {7403}new Ns_6088: bitstring;
                                                                    {7404}new ST_6089: bitstring;
                                                                    {7405}new TTL_6090: bitstring;
                                                                    {7406}let wNs_6091: bitstring = enc(Ns_6088,pkCli_6059) in
                                                                    {7407}let m2_6092: bitstring = (OpenSecureChannelResponse,wNs_6091,ST_6089,TTL_6090) in
                                                                    {7408}event beginSrv(Sess_5308,Cli_5306,Ns_6088);
                                                                    {7409}out(c, m2_6092);
                                                                    {7410}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                                                    {7411}event endSrv(Cli_5306,Sess_5308,Nc_6087)
                                                                )
                                                                else
                                                                    {7412}let pkDisco_6093: bitstring = pub(sk(Disco_5307)) in
                                                                    {7413}in(c, (=pkCli_6059,em1_6094: bitstring));
                                                                    {7414}let m1_6095: bitstring = em1_6094 in
                                                                    {7415}let (=OpenSecureChannelRequest,=pkCli_6059,wNc_6096: bitstring) = m1_6095 in
                                                                    {7416}let Nc_6097: bitstring = dec(wNc_6096,skSess_5832) in
                                                                    {7417}new Ns_6098: bitstring;
                                                                    {7418}new ST_6099: bitstring;
                                                                    {7419}new TTL_6100: bitstring;
                                                                    {7420}let wNs_6101: bitstring = enc(Ns_6098,pkCli_6059) in
                                                                    {7421}let m2_6102: bitstring = (OpenSecureChannelResponse,wNs_6101,ST_6099,TTL_6100) in
                                                                    {7422}event beginSrv(Sess_5308,Cli_5306,Ns_6098);
                                                                    {7423}out(c, m2_6102);
                                                                    {7424}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                                                    {7425}event endSrv(Cli_5306,Sess_5308,Nc_6097)
                                                            )
                                                            else
                                                                {7426}let pkDisco_6103: bitstring = fail-any in
                                                                {7427}in(c, (=pkCli_6059,em1_6104: bitstring));
                                                                {7428}let m1_6105: bitstring = em1_6104 in
                                                                {7429}let (=OpenSecureChannelRequest,=pkCli_6059,wNc_6106: bitstring) = m1_6105 in
                                                                {7430}let Nc_6107: bitstring = dec(wNc_6106,skSess_5832) in
                                                                {7431}new Ns_6108: bitstring;
                                                                {7432}new ST_6109: bitstring;
                                                                {7433}new TTL_6110: bitstring;
                                                                {7434}let wNs_6111: bitstring = enc(Ns_6108,pkCli_6059) in
                                                                {7435}let m2_6112: bitstring = (OpenSecureChannelResponse,wNs_6111,ST_6109,TTL_6110) in
                                                                {7436}event beginSrv(Sess_5308,Cli_5306,Ns_6108);
                                                                {7437}out(c, m2_6112);
                                                                {7438}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                                                {7439}event endSrv(Cli_5306,Sess_5308,Nc_6107)
                                                    )
                                                    else
                                                        {7440}let pkDisco_6113: bitstring = fail-any in
                                                        {7441}in(c, (=pkCli_6059,em1_6114: bitstring));
                                                        {7442}let m1_6115: bitstring = em1_6114 in
                                                        {7443}let (=OpenSecureChannelRequest,=pkCli_6059,wNc_6116: bitstring) = m1_6115 in
                                                        {7444}let Nc_6117: bitstring = dec(wNc_6116,skSess_5832) in
                                                        {7445}new Ns_6118: bitstring;
                                                        {7446}new ST_6119: bitstring;
                                                        {7447}new TTL_6120: bitstring;
                                                        {7448}let wNs_6121: bitstring = enc(Ns_6118,pkCli_6059) in
                                                        {7449}let m2_6122: bitstring = (OpenSecureChannelResponse,wNs_6121,ST_6119,TTL_6120) in
                                                        {7450}event beginSrv(Sess_5308,Cli_5306,Ns_6118);
                                                        {7451}out(c, m2_6122);
                                                        {7452}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                                        {7453}event endSrv(Cli_5306,Sess_5308,Nc_6117)
                                            )
                                            else
                                                {7454}let pkDisco_6123: bitstring = fail-any in
                                                {7455}in(c, (=pkCli_6059,em1_6124: bitstring));
                                                {7456}let m1_6125: bitstring = em1_6124 in
                                                {7457}let (=OpenSecureChannelRequest,=pkCli_6059,wNc_6126: bitstring) = m1_6125 in
                                                {7458}let Nc_6127: bitstring = dec(wNc_6126,skSess_5832) in
                                                {7459}new Ns_6128: bitstring;
                                                {7460}new ST_6129: bitstring;
                                                {7461}new TTL_6130: bitstring;
                                                {7462}let wNs_6131: bitstring = enc(Ns_6128,pkCli_6059) in
                                                {7463}let m2_6132: bitstring = (OpenSecureChannelResponse,wNs_6131,ST_6129,TTL_6130) in
                                                {7464}event beginSrv(Sess_5308,Cli_5306,Ns_6128);
                                                {7465}out(c, m2_6132);
                                                {7466}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                                {7467}event endSrv(Cli_5306,Sess_5308,Nc_6127)
                                    )
                                    else
                                        {7468}let pkCli_6133: bitstring = fail-any in
                                        {7469}let v_6134: bool = (Disco_5307 = A) in
                                        (
                                            {7470}if v_6134 then
                                            (
                                                {7471}let pkDisco_6135: bitstring = pub(skA) in
                                                {7472}in(c, (=pkCli_6133,em1_6136: bitstring));
                                                {7473}let m1_6137: bitstring = em1_6136 in
                                                {7474}let (=OpenSecureChannelRequest,=pkCli_6133,wNc_6138: bitstring) = m1_6137 in
                                                {7475}let Nc_6139: bitstring = dec(wNc_6138,skSess_5832) in
                                                {7476}new Ns_6140: bitstring;
                                                {7477}new ST_6141: bitstring;
                                                {7478}new TTL_6142: bitstring;
                                                {7479}let wNs_6143: bitstring = enc(Ns_6140,pkCli_6133) in
                                                {7480}let m2_6144: bitstring = (OpenSecureChannelResponse,wNs_6143,ST_6141,TTL_6142) in
                                                {7481}event beginSrv(Sess_5308,Cli_5306,Ns_6140);
                                                {7482}out(c, m2_6144);
                                                {7483}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                                {7484}event endSrv(Cli_5306,Sess_5308,Nc_6139)
                                            )
                                            else
                                                {7485}let v_6145: bool = (Disco_5307 = B) in
                                                (
                                                    {7486}if v_6145 then
                                                    (
                                                        {7487}let pkDisco_6146: bitstring = pub(skB) in
                                                        {7488}in(c, (=pkCli_6133,em1_6147: bitstring));
                                                        {7489}let m1_6148: bitstring = em1_6147 in
                                                        {7490}let (=OpenSecureChannelRequest,=pkCli_6133,wNc_6149: bitstring) = m1_6148 in
                                                        {7491}let Nc_6150: bitstring = dec(wNc_6149,skSess_5832) in
                                                        {7492}new Ns_6151: bitstring;
                                                        {7493}new ST_6152: bitstring;
                                                        {7494}new TTL_6153: bitstring;
                                                        {7495}let wNs_6154: bitstring = enc(Ns_6151,pkCli_6133) in
                                                        {7496}let m2_6155: bitstring = (OpenSecureChannelResponse,wNs_6154,ST_6152,TTL_6153) in
                                                        {7497}event beginSrv(Sess_5308,Cli_5306,Ns_6151);
                                                        {7498}out(c, m2_6155);
                                                        {7499}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                                        {7500}event endSrv(Cli_5306,Sess_5308,Nc_6150)
                                                    )
                                                    else
                                                        {7501}let v_6156: bool = (Disco_5307 = C) in
                                                        (
                                                            {7502}if v_6156 then
                                                            (
                                                                {7503}let pkDisco_6157: bitstring = pub(skC) in
                                                                {7504}in(c, (=pkCli_6133,em1_6158: bitstring));
                                                                {7505}let m1_6159: bitstring = em1_6158 in
                                                                {7506}let (=OpenSecureChannelRequest,=pkCli_6133,wNc_6160: bitstring) = m1_6159 in
                                                                {7507}let Nc_6161: bitstring = dec(wNc_6160,skSess_5832) in
                                                                {7508}new Ns_6162: bitstring;
                                                                {7509}new ST_6163: bitstring;
                                                                {7510}new TTL_6164: bitstring;
                                                                {7511}let wNs_6165: bitstring = enc(Ns_6162,pkCli_6133) in
                                                                {7512}let m2_6166: bitstring = (OpenSecureChannelResponse,wNs_6165,ST_6163,TTL_6164) in
                                                                {7513}event beginSrv(Sess_5308,Cli_5306,Ns_6162);
                                                                {7514}out(c, m2_6166);
                                                                {7515}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                                                {7516}event endSrv(Cli_5306,Sess_5308,Nc_6161)
                                                            )
                                                            else
                                                                {7517}let pkDisco_6167: bitstring = pub(sk(Disco_5307)) in
                                                                {7518}in(c, (=pkCli_6133,em1_6168: bitstring));
                                                                {7519}let m1_6169: bitstring = em1_6168 in
                                                                {7520}let (=OpenSecureChannelRequest,=pkCli_6133,wNc_6170: bitstring) = m1_6169 in
                                                                {7521}let Nc_6171: bitstring = dec(wNc_6170,skSess_5832) in
                                                                {7522}new Ns_6172: bitstring;
                                                                {7523}new ST_6173: bitstring;
                                                                {7524}new TTL_6174: bitstring;
                                                                {7525}let wNs_6175: bitstring = enc(Ns_6172,pkCli_6133) in
                                                                {7526}let m2_6176: bitstring = (OpenSecureChannelResponse,wNs_6175,ST_6173,TTL_6174) in
                                                                {7527}event beginSrv(Sess_5308,Cli_5306,Ns_6172);
                                                                {7528}out(c, m2_6176);
                                                                {7529}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                                                {7530}event endSrv(Cli_5306,Sess_5308,Nc_6171)
                                                        )
                                                        else
                                                            {7531}let pkDisco_6177: bitstring = fail-any in
                                                            {7532}in(c, (=pkCli_6133,em1_6178: bitstring));
                                                            {7533}let m1_6179: bitstring = em1_6178 in
                                                            {7534}let (=OpenSecureChannelRequest,=pkCli_6133,wNc_6180: bitstring) = m1_6179 in
                                                            {7535}let Nc_6181: bitstring = dec(wNc_6180,skSess_5832) in
                                                            {7536}new Ns_6182: bitstring;
                                                            {7537}new ST_6183: bitstring;
                                                            {7538}new TTL_6184: bitstring;
                                                            {7539}let wNs_6185: bitstring = enc(Ns_6182,pkCli_6133) in
                                                            {7540}let m2_6186: bitstring = (OpenSecureChannelResponse,wNs_6185,ST_6183,TTL_6184) in
                                                            {7541}event beginSrv(Sess_5308,Cli_5306,Ns_6182);
                                                            {7542}out(c, m2_6186);
                                                            {7543}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                                            {7544}event endSrv(Cli_5306,Sess_5308,Nc_6181)
                                                )
                                                else
                                                    {7545}let pkDisco_6187: bitstring = fail-any in
                                                    {7546}in(c, (=pkCli_6133,em1_6188: bitstring));
                                                    {7547}let m1_6189: bitstring = em1_6188 in
                                                    {7548}let (=OpenSecureChannelRequest,=pkCli_6133,wNc_6190: bitstring) = m1_6189 in
                                                    {7549}let Nc_6191: bitstring = dec(wNc_6190,skSess_5832) in
                                                    {7550}new Ns_6192: bitstring;
                                                    {7551}new ST_6193: bitstring;
                                                    {7552}new TTL_6194: bitstring;
                                                    {7553}let wNs_6195: bitstring = enc(Ns_6192,pkCli_6133) in
                                                    {7554}let m2_6196: bitstring = (OpenSecureChannelResponse,wNs_6195,ST_6193,TTL_6194) in
                                                    {7555}event beginSrv(Sess_5308,Cli_5306,Ns_6192);
                                                    {7556}out(c, m2_6196);
                                                    {7557}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                                    {7558}event endSrv(Cli_5306,Sess_5308,Nc_6191)
                                        )
                                        else
                                            {7559}let pkDisco_6197: bitstring = fail-any in
                                            {7560}in(c, (=pkCli_6133,em1_6198: bitstring));
                                            {7561}let m1_6199: bitstring = em1_6198 in
                                            {7562}let (=OpenSecureChannelRequest,=pkCli_6133,wNc_6200: bitstring) = m1_6199 in
                                            {7563}let Nc_6201: bitstring = dec(wNc_6200,skSess_5832) in
                                            {7564}new Ns_6202: bitstring;
                                            {7565}new ST_6203: bitstring;
                                            {7566}new TTL_6204: bitstring;
                                            {7567}let wNs_6205: bitstring = enc(Ns_6202,pkCli_6133) in
                                            {7568}let m2_6206: bitstring = (OpenSecureChannelResponse,wNs_6205,ST_6203,TTL_6204) in
                                            {7569}event beginSrv(Sess_5308,Cli_5306,Ns_6202);
                                            {7570}out(c, m2_6206);
                                            {7571}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                            {7572}event endSrv(Cli_5306,Sess_5308,Nc_6201)
                            )
                            else
                                {7573}let pkCli_6207: bitstring = fail-any in
                                {7574}let v_6208: bool = (Disco_5307 = A) in
                                (
                                    {7575}if v_6208 then
                                    (
                                        {7576}let pkDisco_6209: bitstring = pub(skA) in
                                        {7577}in(c, (=pkCli_6207,em1_6210: bitstring));
                                        {7578}let m1_6211: bitstring = em1_6210 in
                                        {7579}let (=OpenSecureChannelRequest,=pkCli_6207,wNc_6212: bitstring) = m1_6211 in
                                        {7580}let Nc_6213: bitstring = dec(wNc_6212,skSess_5832) in
                                        {7581}new Ns_6214: bitstring;
                                        {7582}new ST_6215: bitstring;
                                        {7583}new TTL_6216: bitstring;
                                        {7584}let wNs_6217: bitstring = enc(Ns_6214,pkCli_6207) in
                                        {7585}let m2_6218: bitstring = (OpenSecureChannelResponse,wNs_6217,ST_6215,TTL_6216) in
                                        {7586}event beginSrv(Sess_5308,Cli_5306,Ns_6214);
                                        {7587}out(c, m2_6218);
                                        {7588}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                        {7589}event endSrv(Cli_5306,Sess_5308,Nc_6213)
                                    )
                                    else
                                        {7590}let v_6219: bool = (Disco_5307 = B) in
                                        (
                                            {7591}if v_6219 then
                                            (
                                                {7592}let pkDisco_6220: bitstring = pub(skB) in
                                                {7593}in(c, (=pkCli_6207,em1_6221: bitstring));
                                                {7594}let m1_6222: bitstring = em1_6221 in
                                                {7595}let (=OpenSecureChannelRequest,=pkCli_6207,wNc_6223: bitstring) = m1_6222 in
                                                {7596}let Nc_6224: bitstring = dec(wNc_6223,skSess_5832) in
                                                {7597}new Ns_6225: bitstring;
                                                {7598}new ST_6226: bitstring;
                                                {7599}new TTL_6227: bitstring;
                                                {7600}let wNs_6228: bitstring = enc(Ns_6225,pkCli_6207) in
                                                {7601}let m2_6229: bitstring = (OpenSecureChannelResponse,wNs_6228,ST_6226,TTL_6227) in
                                                {7602}event beginSrv(Sess_5308,Cli_5306,Ns_6225);
                                                {7603}out(c, m2_6229);
                                                {7604}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                                {7605}event endSrv(Cli_5306,Sess_5308,Nc_6224)
                                            )
                                            else
                                                {7606}let v_6230: bool = (Disco_5307 = C) in
                                                (
                                                    {7607}if v_6230 then
                                                    (
                                                        {7608}let pkDisco_6231: bitstring = pub(skC) in
                                                        {7609}in(c, (=pkCli_6207,em1_6232: bitstring));
                                                        {7610}let m1_6233: bitstring = em1_6232 in
                                                        {7611}let (=OpenSecureChannelRequest,=pkCli_6207,wNc_6234: bitstring) = m1_6233 in
                                                        {7612}let Nc_6235: bitstring = dec(wNc_6234,skSess_5832) in
                                                        {7613}new Ns_6236: bitstring;
                                                        {7614}new ST_6237: bitstring;
                                                        {7615}new TTL_6238: bitstring;
                                                        {7616}let wNs_6239: bitstring = enc(Ns_6236,pkCli_6207) in
                                                        {7617}let m2_6240: bitstring = (OpenSecureChannelResponse,wNs_6239,ST_6237,TTL_6238) in
                                                        {7618}event beginSrv(Sess_5308,Cli_5306,Ns_6236);
                                                        {7619}out(c, m2_6240);
                                                        {7620}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                                        {7621}event endSrv(Cli_5306,Sess_5308,Nc_6235)
                                                    )
                                                    else
                                                        {7622}let pkDisco_6241: bitstring = pub(sk(Disco_5307)) in
                                                        {7623}in(c, (=pkCli_6207,em1_6242: bitstring));
                                                        {7624}let m1_6243: bitstring = em1_6242 in
                                                        {7625}let (=OpenSecureChannelRequest,=pkCli_6207,wNc_6244: bitstring) = m1_6243 in
                                                        {7626}let Nc_6245: bitstring = dec(wNc_6244,skSess_5832) in
                                                        {7627}new Ns_6246: bitstring;
                                                        {7628}new ST_6247: bitstring;
                                                        {7629}new TTL_6248: bitstring;
                                                        {7630}let wNs_6249: bitstring = enc(Ns_6246,pkCli_6207) in
                                                        {7631}let m2_6250: bitstring = (OpenSecureChannelResponse,wNs_6249,ST_6247,TTL_6248) in
                                                        {7632}event beginSrv(Sess_5308,Cli_5306,Ns_6246);
                                                        {7633}out(c, m2_6250);
                                                        {7634}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                                        {7635}event endSrv(Cli_5306,Sess_5308,Nc_6245)
                                                )
                                                else
                                                    {7636}let pkDisco_6251: bitstring = fail-any in
                                                    {7637}in(c, (=pkCli_6207,em1_6252: bitstring));
                                                    {7638}let m1_6253: bitstring = em1_6252 in
                                                    {7639}let (=OpenSecureChannelRequest,=pkCli_6207,wNc_6254: bitstring) = m1_6253 in
                                                    {7640}let Nc_6255: bitstring = dec(wNc_6254,skSess_5832) in
                                                    {7641}new Ns_6256: bitstring;
                                                    {7642}new ST_6257: bitstring;
                                                    {7643}new TTL_6258: bitstring;
                                                    {7644}let wNs_6259: bitstring = enc(Ns_6256,pkCli_6207) in
                                                    {7645}let m2_6260: bitstring = (OpenSecureChannelResponse,wNs_6259,ST_6257,TTL_6258) in
                                                    {7646}event beginSrv(Sess_5308,Cli_5306,Ns_6256);
                                                    {7647}out(c, m2_6260);
                                                    {7648}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                                    {7649}event endSrv(Cli_5306,Sess_5308,Nc_6255)
                                        )
                                        else
                                            {7650}let pkDisco_6261: bitstring = fail-any in
                                            {7651}in(c, (=pkCli_6207,em1_6262: bitstring));
                                            {7652}let m1_6263: bitstring = em1_6262 in
                                            {7653}let (=OpenSecureChannelRequest,=pkCli_6207,wNc_6264: bitstring) = m1_6263 in
                                            {7654}let Nc_6265: bitstring = dec(wNc_6264,skSess_5832) in
                                            {7655}new Ns_6266: bitstring;
                                            {7656}new ST_6267: bitstring;
                                            {7657}new TTL_6268: bitstring;
                                            {7658}let wNs_6269: bitstring = enc(Ns_6266,pkCli_6207) in
                                            {7659}let m2_6270: bitstring = (OpenSecureChannelResponse,wNs_6269,ST_6267,TTL_6268) in
                                            {7660}event beginSrv(Sess_5308,Cli_5306,Ns_6266);
                                            {7661}out(c, m2_6270);
                                            {7662}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                            {7663}event endSrv(Cli_5306,Sess_5308,Nc_6265)
                                )
                                else
                                    {7664}let pkDisco_6271: bitstring = fail-any in
                                    {7665}in(c, (=pkCli_6207,em1_6272: bitstring));
                                    {7666}let m1_6273: bitstring = em1_6272 in
                                    {7667}let (=OpenSecureChannelRequest,=pkCli_6207,wNc_6274: bitstring) = m1_6273 in
                                    {7668}let Nc_6275: bitstring = dec(wNc_6274,skSess_5832) in
                                    {7669}new Ns_6276: bitstring;
                                    {7670}new ST_6277: bitstring;
                                    {7671}new TTL_6278: bitstring;
                                    {7672}let wNs_6279: bitstring = enc(Ns_6276,pkCli_6207) in
                                    {7673}let m2_6280: bitstring = (OpenSecureChannelResponse,wNs_6279,ST_6277,TTL_6278) in
                                    {7674}event beginSrv(Sess_5308,Cli_5306,Ns_6276);
                                    {7675}out(c, m2_6280);
                                    {7676}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                    {7677}event endSrv(Cli_5306,Sess_5308,Nc_6275)
                    )
                    else
                        {7678}let pkCli_6281: bitstring = fail-any in
                        {7679}let v_6282: bool = (Disco_5307 = A) in
                        (
                            {7680}if v_6282 then
                            (
                                {7681}let pkDisco_6283: bitstring = pub(skA) in
                                {7682}in(c, (=pkCli_6281,em1_6284: bitstring));
                                {7683}let m1_6285: bitstring = em1_6284 in
                                {7684}let (=OpenSecureChannelRequest,=pkCli_6281,wNc_6286: bitstring) = m1_6285 in
                                {7685}let Nc_6287: bitstring = dec(wNc_6286,skSess_5832) in
                                {7686}new Ns_6288: bitstring;
                                {7687}new ST_6289: bitstring;
                                {7688}new TTL_6290: bitstring;
                                {7689}let wNs_6291: bitstring = enc(Ns_6288,pkCli_6281) in
                                {7690}let m2_6292: bitstring = (OpenSecureChannelResponse,wNs_6291,ST_6289,TTL_6290) in
                                {7691}event beginSrv(Sess_5308,Cli_5306,Ns_6288);
                                {7692}out(c, m2_6292);
                                {7693}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                {7694}event endSrv(Cli_5306,Sess_5308,Nc_6287)
                            )
                            else
                                {7695}let v_6293: bool = (Disco_5307 = B) in
                                (
                                    {7696}if v_6293 then
                                    (
                                        {7697}let pkDisco_6294: bitstring = pub(skB) in
                                        {7698}in(c, (=pkCli_6281,em1_6295: bitstring));
                                        {7699}let m1_6296: bitstring = em1_6295 in
                                        {7700}let (=OpenSecureChannelRequest,=pkCli_6281,wNc_6297: bitstring) = m1_6296 in
                                        {7701}let Nc_6298: bitstring = dec(wNc_6297,skSess_5832) in
                                        {7702}new Ns_6299: bitstring;
                                        {7703}new ST_6300: bitstring;
                                        {7704}new TTL_6301: bitstring;
                                        {7705}let wNs_6302: bitstring = enc(Ns_6299,pkCli_6281) in
                                        {7706}let m2_6303: bitstring = (OpenSecureChannelResponse,wNs_6302,ST_6300,TTL_6301) in
                                        {7707}event beginSrv(Sess_5308,Cli_5306,Ns_6299);
                                        {7708}out(c, m2_6303);
                                        {7709}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                        {7710}event endSrv(Cli_5306,Sess_5308,Nc_6298)
                                    )
                                    else
                                        {7711}let v_6304: bool = (Disco_5307 = C) in
                                        (
                                            {7712}if v_6304 then
                                            (
                                                {7713}let pkDisco_6305: bitstring = pub(skC) in
                                                {7714}in(c, (=pkCli_6281,em1_6306: bitstring));
                                                {7715}let m1_6307: bitstring = em1_6306 in
                                                {7716}let (=OpenSecureChannelRequest,=pkCli_6281,wNc_6308: bitstring) = m1_6307 in
                                                {7717}let Nc_6309: bitstring = dec(wNc_6308,skSess_5832) in
                                                {7718}new Ns_6310: bitstring;
                                                {7719}new ST_6311: bitstring;
                                                {7720}new TTL_6312: bitstring;
                                                {7721}let wNs_6313: bitstring = enc(Ns_6310,pkCli_6281) in
                                                {7722}let m2_6314: bitstring = (OpenSecureChannelResponse,wNs_6313,ST_6311,TTL_6312) in
                                                {7723}event beginSrv(Sess_5308,Cli_5306,Ns_6310);
                                                {7724}out(c, m2_6314);
                                                {7725}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                                {7726}event endSrv(Cli_5306,Sess_5308,Nc_6309)
                                            )
                                            else
                                                {7727}let pkDisco_6315: bitstring = pub(sk(Disco_5307)) in
                                                {7728}in(c, (=pkCli_6281,em1_6316: bitstring));
                                                {7729}let m1_6317: bitstring = em1_6316 in
                                                {7730}let (=OpenSecureChannelRequest,=pkCli_6281,wNc_6318: bitstring) = m1_6317 in
                                                {7731}let Nc_6319: bitstring = dec(wNc_6318,skSess_5832) in
                                                {7732}new Ns_6320: bitstring;
                                                {7733}new ST_6321: bitstring;
                                                {7734}new TTL_6322: bitstring;
                                                {7735}let wNs_6323: bitstring = enc(Ns_6320,pkCli_6281) in
                                                {7736}let m2_6324: bitstring = (OpenSecureChannelResponse,wNs_6323,ST_6321,TTL_6322) in
                                                {7737}event beginSrv(Sess_5308,Cli_5306,Ns_6320);
                                                {7738}out(c, m2_6324);
                                                {7739}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                                {7740}event endSrv(Cli_5306,Sess_5308,Nc_6319)
                                        )
                                        else
                                            {7741}let pkDisco_6325: bitstring = fail-any in
                                            {7742}in(c, (=pkCli_6281,em1_6326: bitstring));
                                            {7743}let m1_6327: bitstring = em1_6326 in
                                            {7744}let (=OpenSecureChannelRequest,=pkCli_6281,wNc_6328: bitstring) = m1_6327 in
                                            {7745}let Nc_6329: bitstring = dec(wNc_6328,skSess_5832) in
                                            {7746}new Ns_6330: bitstring;
                                            {7747}new ST_6331: bitstring;
                                            {7748}new TTL_6332: bitstring;
                                            {7749}let wNs_6333: bitstring = enc(Ns_6330,pkCli_6281) in
                                            {7750}let m2_6334: bitstring = (OpenSecureChannelResponse,wNs_6333,ST_6331,TTL_6332) in
                                            {7751}event beginSrv(Sess_5308,Cli_5306,Ns_6330);
                                            {7752}out(c, m2_6334);
                                            {7753}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                            {7754}event endSrv(Cli_5306,Sess_5308,Nc_6329)
                                )
                                else
                                    {7755}let pkDisco_6335: bitstring = fail-any in
                                    {7756}in(c, (=pkCli_6281,em1_6336: bitstring));
                                    {7757}let m1_6337: bitstring = em1_6336 in
                                    {7758}let (=OpenSecureChannelRequest,=pkCli_6281,wNc_6338: bitstring) = m1_6337 in
                                    {7759}let Nc_6339: bitstring = dec(wNc_6338,skSess_5832) in
                                    {7760}new Ns_6340: bitstring;
                                    {7761}new ST_6341: bitstring;
                                    {7762}new TTL_6342: bitstring;
                                    {7763}let wNs_6343: bitstring = enc(Ns_6340,pkCli_6281) in
                                    {7764}let m2_6344: bitstring = (OpenSecureChannelResponse,wNs_6343,ST_6341,TTL_6342) in
                                    {7765}event beginSrv(Sess_5308,Cli_5306,Ns_6340);
                                    {7766}out(c, m2_6344);
                                    {7767}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                    {7768}event endSrv(Cli_5306,Sess_5308,Nc_6339)
                        )
                        else
                            {7769}let pkDisco_6345: bitstring = fail-any in
                            {7770}in(c, (=pkCli_6281,em1_6346: bitstring));
                            {7771}let m1_6347: bitstring = em1_6346 in
                            {7772}let (=OpenSecureChannelRequest,=pkCli_6281,wNc_6348: bitstring) = m1_6347 in
                            {7773}let Nc_6349: bitstring = dec(wNc_6348,skSess_5832) in
                            {7774}new Ns_6350: bitstring;
                            {7775}new ST_6351: bitstring;
                            {7776}new TTL_6352: bitstring;
                            {7777}let wNs_6353: bitstring = enc(Ns_6350,pkCli_6281) in
                            {7778}let m2_6354: bitstring = (OpenSecureChannelResponse,wNs_6353,ST_6351,TTL_6352) in
                            {7779}event beginSrv(Sess_5308,Cli_5306,Ns_6350);
                            {7780}out(c, m2_6354);
                            {7781}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                            {7782}event endSrv(Cli_5306,Sess_5308,Nc_6349)
                )
                else
                    {7783}let =true = (Sess_5308 = C) in
                    (
                        {7784}let skSess_6355: bitstring = skC in
                        {7785}let pkSess_6356: bitstring = pub(skSess_6355) in
                        {7786}let v_6357: bool = (Cli_5306 = A) in
                        (
                            {7787}if v_6357 then
                            (
                                {7788}let pkCli_6358: bitstring = pub(skA) in
                                {7789}let v_6359: bool = (Disco_5307 = A) in
                                (
                                    {7790}if v_6359 then
                                    (
                                        {7791}let pkDisco_6360: bitstring = pub(skA) in
                                        {7792}in(c, (=pkCli_6358,em1_6361: bitstring));
                                        {7793}let m1_6362: bitstring = em1_6361 in
                                        {7794}let (=OpenSecureChannelRequest,=pkCli_6358,wNc_6363: bitstring) = m1_6362 in
                                        {7795}let Nc_6364: bitstring = dec(wNc_6363,skSess_6355) in
                                        {7796}new Ns_6365: bitstring;
                                        {7797}new ST_6366: bitstring;
                                        {7798}new TTL_6367: bitstring;
                                        {7799}let wNs_6368: bitstring = enc(Ns_6365,pkCli_6358) in
                                        {7800}let m2_6369: bitstring = (OpenSecureChannelResponse,wNs_6368,ST_6366,TTL_6367) in
                                        {7801}event beginSrv(Sess_5308,Cli_5306,Ns_6365);
                                        {7802}out(c, m2_6369);
                                        {7803}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                        {7804}event endSrv(Cli_5306,Sess_5308,Nc_6364)
                                    )
                                    else
                                        {7805}let v_6370: bool = (Disco_5307 = B) in
                                        (
                                            {7806}if v_6370 then
                                            (
                                                {7807}let pkDisco_6371: bitstring = pub(skB) in
                                                {7808}in(c, (=pkCli_6358,em1_6372: bitstring));
                                                {7809}let m1_6373: bitstring = em1_6372 in
                                                {7810}let (=OpenSecureChannelRequest,=pkCli_6358,wNc_6374: bitstring) = m1_6373 in
                                                {7811}let Nc_6375: bitstring = dec(wNc_6374,skSess_6355) in
                                                {7812}new Ns_6376: bitstring;
                                                {7813}new ST_6377: bitstring;
                                                {7814}new TTL_6378: bitstring;
                                                {7815}let wNs_6379: bitstring = enc(Ns_6376,pkCli_6358) in
                                                {7816}let m2_6380: bitstring = (OpenSecureChannelResponse,wNs_6379,ST_6377,TTL_6378) in
                                                {7817}event beginSrv(Sess_5308,Cli_5306,Ns_6376);
                                                {7818}out(c, m2_6380);
                                                {7819}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                                {7820}event endSrv(Cli_5306,Sess_5308,Nc_6375)
                                            )
                                            else
                                                {7821}let v_6381: bool = (Disco_5307 = C) in
                                                (
                                                    {7822}if v_6381 then
                                                    (
                                                        {7823}let pkDisco_6382: bitstring = pub(skC) in
                                                        {7824}in(c, (=pkCli_6358,em1_6383: bitstring));
                                                        {7825}let m1_6384: bitstring = em1_6383 in
                                                        {7826}let (=OpenSecureChannelRequest,=pkCli_6358,wNc_6385: bitstring) = m1_6384 in
                                                        {7827}let Nc_6386: bitstring = dec(wNc_6385,skSess_6355) in
                                                        {7828}new Ns_6387: bitstring;
                                                        {7829}new ST_6388: bitstring;
                                                        {7830}new TTL_6389: bitstring;
                                                        {7831}let wNs_6390: bitstring = enc(Ns_6387,pkCli_6358) in
                                                        {7832}let m2_6391: bitstring = (OpenSecureChannelResponse,wNs_6390,ST_6388,TTL_6389) in
                                                        {7833}event beginSrv(Sess_5308,Cli_5306,Ns_6387);
                                                        {7834}out(c, m2_6391);
                                                        {7835}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                                        {7836}event endSrv(Cli_5306,Sess_5308,Nc_6386)
                                                    )
                                                    else
                                                        {7837}let pkDisco_6392: bitstring = pub(sk(Disco_5307)) in
                                                        {7838}in(c, (=pkCli_6358,em1_6393: bitstring));
                                                        {7839}let m1_6394: bitstring = em1_6393 in
                                                        {7840}let (=OpenSecureChannelRequest,=pkCli_6358,wNc_6395: bitstring) = m1_6394 in
                                                        {7841}let Nc_6396: bitstring = dec(wNc_6395,skSess_6355) in
                                                        {7842}new Ns_6397: bitstring;
                                                        {7843}new ST_6398: bitstring;
                                                        {7844}new TTL_6399: bitstring;
                                                        {7845}let wNs_6400: bitstring = enc(Ns_6397,pkCli_6358) in
                                                        {7846}let m2_6401: bitstring = (OpenSecureChannelResponse,wNs_6400,ST_6398,TTL_6399) in
                                                        {7847}event beginSrv(Sess_5308,Cli_5306,Ns_6397);
                                                        {7848}out(c, m2_6401);
                                                        {7849}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                                        {7850}event endSrv(Cli_5306,Sess_5308,Nc_6396)
                                                )
                                                else
                                                    {7851}let pkDisco_6402: bitstring = fail-any in
                                                    {7852}in(c, (=pkCli_6358,em1_6403: bitstring));
                                                    {7853}let m1_6404: bitstring = em1_6403 in
                                                    {7854}let (=OpenSecureChannelRequest,=pkCli_6358,wNc_6405: bitstring) = m1_6404 in
                                                    {7855}let Nc_6406: bitstring = dec(wNc_6405,skSess_6355) in
                                                    {7856}new Ns_6407: bitstring;
                                                    {7857}new ST_6408: bitstring;
                                                    {7858}new TTL_6409: bitstring;
                                                    {7859}let wNs_6410: bitstring = enc(Ns_6407,pkCli_6358) in
                                                    {7860}let m2_6411: bitstring = (OpenSecureChannelResponse,wNs_6410,ST_6408,TTL_6409) in
                                                    {7861}event beginSrv(Sess_5308,Cli_5306,Ns_6407);
                                                    {7862}out(c, m2_6411);
                                                    {7863}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                                    {7864}event endSrv(Cli_5306,Sess_5308,Nc_6406)
                                        )
                                        else
                                            {7865}let pkDisco_6412: bitstring = fail-any in
                                            {7866}in(c, (=pkCli_6358,em1_6413: bitstring));
                                            {7867}let m1_6414: bitstring = em1_6413 in
                                            {7868}let (=OpenSecureChannelRequest,=pkCli_6358,wNc_6415: bitstring) = m1_6414 in
                                            {7869}let Nc_6416: bitstring = dec(wNc_6415,skSess_6355) in
                                            {7870}new Ns_6417: bitstring;
                                            {7871}new ST_6418: bitstring;
                                            {7872}new TTL_6419: bitstring;
                                            {7873}let wNs_6420: bitstring = enc(Ns_6417,pkCli_6358) in
                                            {7874}let m2_6421: bitstring = (OpenSecureChannelResponse,wNs_6420,ST_6418,TTL_6419) in
                                            {7875}event beginSrv(Sess_5308,Cli_5306,Ns_6417);
                                            {7876}out(c, m2_6421);
                                            {7877}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                            {7878}event endSrv(Cli_5306,Sess_5308,Nc_6416)
                                )
                                else
                                    {7879}let pkDisco_6422: bitstring = fail-any in
                                    {7880}in(c, (=pkCli_6358,em1_6423: bitstring));
                                    {7881}let m1_6424: bitstring = em1_6423 in
                                    {7882}let (=OpenSecureChannelRequest,=pkCli_6358,wNc_6425: bitstring) = m1_6424 in
                                    {7883}let Nc_6426: bitstring = dec(wNc_6425,skSess_6355) in
                                    {7884}new Ns_6427: bitstring;
                                    {7885}new ST_6428: bitstring;
                                    {7886}new TTL_6429: bitstring;
                                    {7887}let wNs_6430: bitstring = enc(Ns_6427,pkCli_6358) in
                                    {7888}let m2_6431: bitstring = (OpenSecureChannelResponse,wNs_6430,ST_6428,TTL_6429) in
                                    {7889}event beginSrv(Sess_5308,Cli_5306,Ns_6427);
                                    {7890}out(c, m2_6431);
                                    {7891}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                    {7892}event endSrv(Cli_5306,Sess_5308,Nc_6426)
                            )
                            else
                                {7893}let v_6432: bool = (Cli_5306 = B) in
                                (
                                    {7894}if v_6432 then
                                    (
                                        {7895}let pkCli_6433: bitstring = pub(skB) in
                                        {7896}let v_6434: bool = (Disco_5307 = A) in
                                        (
                                            {7897}if v_6434 then
                                            (
                                                {7898}let pkDisco_6435: bitstring = pub(skA) in
                                                {7899}in(c, (=pkCli_6433,em1_6436: bitstring));
                                                {7900}let m1_6437: bitstring = em1_6436 in
                                                {7901}let (=OpenSecureChannelRequest,=pkCli_6433,wNc_6438: bitstring) = m1_6437 in
                                                {7902}let Nc_6439: bitstring = dec(wNc_6438,skSess_6355) in
                                                {7903}new Ns_6440: bitstring;
                                                {7904}new ST_6441: bitstring;
                                                {7905}new TTL_6442: bitstring;
                                                {7906}let wNs_6443: bitstring = enc(Ns_6440,pkCli_6433) in
                                                {7907}let m2_6444: bitstring = (OpenSecureChannelResponse,wNs_6443,ST_6441,TTL_6442) in
                                                {7908}event beginSrv(Sess_5308,Cli_5306,Ns_6440);
                                                {7909}out(c, m2_6444);
                                                {7910}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                                {7911}event endSrv(Cli_5306,Sess_5308,Nc_6439)
                                            )
                                            else
                                                {7912}let v_6445: bool = (Disco_5307 = B) in
                                                (
                                                    {7913}if v_6445 then
                                                    (
                                                        {7914}let pkDisco_6446: bitstring = pub(skB) in
                                                        {7915}in(c, (=pkCli_6433,em1_6447: bitstring));
                                                        {7916}let m1_6448: bitstring = em1_6447 in
                                                        {7917}let (=OpenSecureChannelRequest,=pkCli_6433,wNc_6449: bitstring) = m1_6448 in
                                                        {7918}let Nc_6450: bitstring = dec(wNc_6449,skSess_6355) in
                                                        {7919}new Ns_6451: bitstring;
                                                        {7920}new ST_6452: bitstring;
                                                        {7921}new TTL_6453: bitstring;
                                                        {7922}let wNs_6454: bitstring = enc(Ns_6451,pkCli_6433) in
                                                        {7923}let m2_6455: bitstring = (OpenSecureChannelResponse,wNs_6454,ST_6452,TTL_6453) in
                                                        {7924}event beginSrv(Sess_5308,Cli_5306,Ns_6451);
                                                        {7925}out(c, m2_6455);
                                                        {7926}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                                        {7927}event endSrv(Cli_5306,Sess_5308,Nc_6450)
                                                    )
                                                    else
                                                        {7928}let v_6456: bool = (Disco_5307 = C) in
                                                        (
                                                            {7929}if v_6456 then
                                                            (
                                                                {7930}let pkDisco_6457: bitstring = pub(skC) in
                                                                {7931}in(c, (=pkCli_6433,em1_6458: bitstring));
                                                                {7932}let m1_6459: bitstring = em1_6458 in
                                                                {7933}let (=OpenSecureChannelRequest,=pkCli_6433,wNc_6460: bitstring) = m1_6459 in
                                                                {7934}let Nc_6461: bitstring = dec(wNc_6460,skSess_6355) in
                                                                {7935}new Ns_6462: bitstring;
                                                                {7936}new ST_6463: bitstring;
                                                                {7937}new TTL_6464: bitstring;
                                                                {7938}let wNs_6465: bitstring = enc(Ns_6462,pkCli_6433) in
                                                                {7939}let m2_6466: bitstring = (OpenSecureChannelResponse,wNs_6465,ST_6463,TTL_6464) in
                                                                {7940}event beginSrv(Sess_5308,Cli_5306,Ns_6462);
                                                                {7941}out(c, m2_6466);
                                                                {7942}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                                                {7943}event endSrv(Cli_5306,Sess_5308,Nc_6461)
                                                            )
                                                            else
                                                                {7944}let pkDisco_6467: bitstring = pub(sk(Disco_5307)) in
                                                                {7945}in(c, (=pkCli_6433,em1_6468: bitstring));
                                                                {7946}let m1_6469: bitstring = em1_6468 in
                                                                {7947}let (=OpenSecureChannelRequest,=pkCli_6433,wNc_6470: bitstring) = m1_6469 in
                                                                {7948}let Nc_6471: bitstring = dec(wNc_6470,skSess_6355) in
                                                                {7949}new Ns_6472: bitstring;
                                                                {7950}new ST_6473: bitstring;
                                                                {7951}new TTL_6474: bitstring;
                                                                {7952}let wNs_6475: bitstring = enc(Ns_6472,pkCli_6433) in
                                                                {7953}let m2_6476: bitstring = (OpenSecureChannelResponse,wNs_6475,ST_6473,TTL_6474) in
                                                                {7954}event beginSrv(Sess_5308,Cli_5306,Ns_6472);
                                                                {7955}out(c, m2_6476);
                                                                {7956}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                                                {7957}event endSrv(Cli_5306,Sess_5308,Nc_6471)
                                                        )
                                                        else
                                                            {7958}let pkDisco_6477: bitstring = fail-any in
                                                            {7959}in(c, (=pkCli_6433,em1_6478: bitstring));
                                                            {7960}let m1_6479: bitstring = em1_6478 in
                                                            {7961}let (=OpenSecureChannelRequest,=pkCli_6433,wNc_6480: bitstring) = m1_6479 in
                                                            {7962}let Nc_6481: bitstring = dec(wNc_6480,skSess_6355) in
                                                            {7963}new Ns_6482: bitstring;
                                                            {7964}new ST_6483: bitstring;
                                                            {7965}new TTL_6484: bitstring;
                                                            {7966}let wNs_6485: bitstring = enc(Ns_6482,pkCli_6433) in
                                                            {7967}let m2_6486: bitstring = (OpenSecureChannelResponse,wNs_6485,ST_6483,TTL_6484) in
                                                            {7968}event beginSrv(Sess_5308,Cli_5306,Ns_6482);
                                                            {7969}out(c, m2_6486);
                                                            {7970}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                                            {7971}event endSrv(Cli_5306,Sess_5308,Nc_6481)
                                                )
                                                else
                                                    {7972}let pkDisco_6487: bitstring = fail-any in
                                                    {7973}in(c, (=pkCli_6433,em1_6488: bitstring));
                                                    {7974}let m1_6489: bitstring = em1_6488 in
                                                    {7975}let (=OpenSecureChannelRequest,=pkCli_6433,wNc_6490: bitstring) = m1_6489 in
                                                    {7976}let Nc_6491: bitstring = dec(wNc_6490,skSess_6355) in
                                                    {7977}new Ns_6492: bitstring;
                                                    {7978}new ST_6493: bitstring;
                                                    {7979}new TTL_6494: bitstring;
                                                    {7980}let wNs_6495: bitstring = enc(Ns_6492,pkCli_6433) in
                                                    {7981}let m2_6496: bitstring = (OpenSecureChannelResponse,wNs_6495,ST_6493,TTL_6494) in
                                                    {7982}event beginSrv(Sess_5308,Cli_5306,Ns_6492);
                                                    {7983}out(c, m2_6496);
                                                    {7984}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                                    {7985}event endSrv(Cli_5306,Sess_5308,Nc_6491)
                                        )
                                        else
                                            {7986}let pkDisco_6497: bitstring = fail-any in
                                            {7987}in(c, (=pkCli_6433,em1_6498: bitstring));
                                            {7988}let m1_6499: bitstring = em1_6498 in
                                            {7989}let (=OpenSecureChannelRequest,=pkCli_6433,wNc_6500: bitstring) = m1_6499 in
                                            {7990}let Nc_6501: bitstring = dec(wNc_6500,skSess_6355) in
                                            {7991}new Ns_6502: bitstring;
                                            {7992}new ST_6503: bitstring;
                                            {7993}new TTL_6504: bitstring;
                                            {7994}let wNs_6505: bitstring = enc(Ns_6502,pkCli_6433) in
                                            {7995}let m2_6506: bitstring = (OpenSecureChannelResponse,wNs_6505,ST_6503,TTL_6504) in
                                            {7996}event beginSrv(Sess_5308,Cli_5306,Ns_6502);
                                            {7997}out(c, m2_6506);
                                            {7998}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                            {7999}event endSrv(Cli_5306,Sess_5308,Nc_6501)
                                    )
                                    else
                                        {8000}let v_6507: bool = (Cli_5306 = C) in
                                        (
                                            {8001}if v_6507 then
                                            (
                                                {8002}let pkCli_6508: bitstring = pub(skC) in
                                                {8003}let v_6509: bool = (Disco_5307 = A) in
                                                (
                                                    {8004}if v_6509 then
                                                    (
                                                        {8005}let pkDisco_6510: bitstring = pub(skA) in
                                                        {8006}in(c, (=pkCli_6508,em1_6511: bitstring));
                                                        {8007}let m1_6512: bitstring = em1_6511 in
                                                        {8008}let (=OpenSecureChannelRequest,=pkCli_6508,wNc_6513: bitstring) = m1_6512 in
                                                        {8009}let Nc_6514: bitstring = dec(wNc_6513,skSess_6355) in
                                                        {8010}new Ns_6515: bitstring;
                                                        {8011}new ST_6516: bitstring;
                                                        {8012}new TTL_6517: bitstring;
                                                        {8013}let wNs_6518: bitstring = enc(Ns_6515,pkCli_6508) in
                                                        {8014}let m2_6519: bitstring = (OpenSecureChannelResponse,wNs_6518,ST_6516,TTL_6517) in
                                                        {8015}event beginSrv(Sess_5308,Cli_5306,Ns_6515);
                                                        {8016}out(c, m2_6519);
                                                        {8017}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                                        {8018}event endSrv(Cli_5306,Sess_5308,Nc_6514)
                                                    )
                                                    else
                                                        {8019}let v_6520: bool = (Disco_5307 = B) in
                                                        (
                                                            {8020}if v_6520 then
                                                            (
                                                                {8021}let pkDisco_6521: bitstring = pub(skB) in
                                                                {8022}in(c, (=pkCli_6508,em1_6522: bitstring));
                                                                {8023}let m1_6523: bitstring = em1_6522 in
                                                                {8024}let (=OpenSecureChannelRequest,=pkCli_6508,wNc_6524: bitstring) = m1_6523 in
                                                                {8025}let Nc_6525: bitstring = dec(wNc_6524,skSess_6355) in
                                                                {8026}new Ns_6526: bitstring;
                                                                {8027}new ST_6527: bitstring;
                                                                {8028}new TTL_6528: bitstring;
                                                                {8029}let wNs_6529: bitstring = enc(Ns_6526,pkCli_6508) in
                                                                {8030}let m2_6530: bitstring = (OpenSecureChannelResponse,wNs_6529,ST_6527,TTL_6528) in
                                                                {8031}event beginSrv(Sess_5308,Cli_5306,Ns_6526);
                                                                {8032}out(c, m2_6530);
                                                                {8033}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                                                {8034}event endSrv(Cli_5306,Sess_5308,Nc_6525)
                                                            )
                                                            else
                                                                {8035}let v_6531: bool = (Disco_5307 = C) in
                                                                (
                                                                    {8036}if v_6531 then
                                                                    (
                                                                        {8037}let pkDisco_6532: bitstring = pub(skC) in
                                                                        {8038}in(c, (=pkCli_6508,em1_6533: bitstring));
                                                                        {8039}let m1_6534: bitstring = em1_6533 in
                                                                        {8040}let (=OpenSecureChannelRequest,=pkCli_6508,wNc_6535: bitstring) = m1_6534 in
                                                                        {8041}let Nc_6536: bitstring = dec(wNc_6535,skSess_6355) in
                                                                        {8042}new Ns_6537: bitstring;
                                                                        {8043}new ST_6538: bitstring;
                                                                        {8044}new TTL_6539: bitstring;
                                                                        {8045}let wNs_6540: bitstring = enc(Ns_6537,pkCli_6508) in
                                                                        {8046}let m2_6541: bitstring = (OpenSecureChannelResponse,wNs_6540,ST_6538,TTL_6539) in
                                                                        {8047}event beginSrv(Sess_5308,Cli_5306,Ns_6537);
                                                                        {8048}out(c, m2_6541);
                                                                        {8049}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                                                        {8050}event endSrv(Cli_5306,Sess_5308,Nc_6536)
                                                                    )
                                                                    else
                                                                        {8051}let pkDisco_6542: bitstring = pub(sk(Disco_5307)) in
                                                                        {8052}in(c, (=pkCli_6508,em1_6543: bitstring));
                                                                        {8053}let m1_6544: bitstring = em1_6543 in
                                                                        {8054}let (=OpenSecureChannelRequest,=pkCli_6508,wNc_6545: bitstring) = m1_6544 in
                                                                        {8055}let Nc_6546: bitstring = dec(wNc_6545,skSess_6355) in
                                                                        {8056}new Ns_6547: bitstring;
                                                                        {8057}new ST_6548: bitstring;
                                                                        {8058}new TTL_6549: bitstring;
                                                                        {8059}let wNs_6550: bitstring = enc(Ns_6547,pkCli_6508) in
                                                                        {8060}let m2_6551: bitstring = (OpenSecureChannelResponse,wNs_6550,ST_6548,TTL_6549) in
                                                                        {8061}event beginSrv(Sess_5308,Cli_5306,Ns_6547);
                                                                        {8062}out(c, m2_6551);
                                                                        {8063}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                                                        {8064}event endSrv(Cli_5306,Sess_5308,Nc_6546)
                                                                )
                                                                else
                                                                    {8065}let pkDisco_6552: bitstring = fail-any in
                                                                    {8066}in(c, (=pkCli_6508,em1_6553: bitstring));
                                                                    {8067}let m1_6554: bitstring = em1_6553 in
                                                                    {8068}let (=OpenSecureChannelRequest,=pkCli_6508,wNc_6555: bitstring) = m1_6554 in
                                                                    {8069}let Nc_6556: bitstring = dec(wNc_6555,skSess_6355) in
                                                                    {8070}new Ns_6557: bitstring;
                                                                    {8071}new ST_6558: bitstring;
                                                                    {8072}new TTL_6559: bitstring;
                                                                    {8073}let wNs_6560: bitstring = enc(Ns_6557,pkCli_6508) in
                                                                    {8074}let m2_6561: bitstring = (OpenSecureChannelResponse,wNs_6560,ST_6558,TTL_6559) in
                                                                    {8075}event beginSrv(Sess_5308,Cli_5306,Ns_6557);
                                                                    {8076}out(c, m2_6561);
                                                                    {8077}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                                                    {8078}event endSrv(Cli_5306,Sess_5308,Nc_6556)
                                                        )
                                                        else
                                                            {8079}let pkDisco_6562: bitstring = fail-any in
                                                            {8080}in(c, (=pkCli_6508,em1_6563: bitstring));
                                                            {8081}let m1_6564: bitstring = em1_6563 in
                                                            {8082}let (=OpenSecureChannelRequest,=pkCli_6508,wNc_6565: bitstring) = m1_6564 in
                                                            {8083}let Nc_6566: bitstring = dec(wNc_6565,skSess_6355) in
                                                            {8084}new Ns_6567: bitstring;
                                                            {8085}new ST_6568: bitstring;
                                                            {8086}new TTL_6569: bitstring;
                                                            {8087}let wNs_6570: bitstring = enc(Ns_6567,pkCli_6508) in
                                                            {8088}let m2_6571: bitstring = (OpenSecureChannelResponse,wNs_6570,ST_6568,TTL_6569) in
                                                            {8089}event beginSrv(Sess_5308,Cli_5306,Ns_6567);
                                                            {8090}out(c, m2_6571);
                                                            {8091}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                                            {8092}event endSrv(Cli_5306,Sess_5308,Nc_6566)
                                                )
                                                else
                                                    {8093}let pkDisco_6572: bitstring = fail-any in
                                                    {8094}in(c, (=pkCli_6508,em1_6573: bitstring));
                                                    {8095}let m1_6574: bitstring = em1_6573 in
                                                    {8096}let (=OpenSecureChannelRequest,=pkCli_6508,wNc_6575: bitstring) = m1_6574 in
                                                    {8097}let Nc_6576: bitstring = dec(wNc_6575,skSess_6355) in
                                                    {8098}new Ns_6577: bitstring;
                                                    {8099}new ST_6578: bitstring;
                                                    {8100}new TTL_6579: bitstring;
                                                    {8101}let wNs_6580: bitstring = enc(Ns_6577,pkCli_6508) in
                                                    {8102}let m2_6581: bitstring = (OpenSecureChannelResponse,wNs_6580,ST_6578,TTL_6579) in
                                                    {8103}event beginSrv(Sess_5308,Cli_5306,Ns_6577);
                                                    {8104}out(c, m2_6581);
                                                    {8105}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                                    {8106}event endSrv(Cli_5306,Sess_5308,Nc_6576)
                                            )
                                            else
                                                {8107}let pkCli_6582: bitstring = pub(sk(Cli_5306)) in
                                                {8108}let v_6583: bool = (Disco_5307 = A) in
                                                (
                                                    {8109}if v_6583 then
                                                    (
                                                        {8110}let pkDisco_6584: bitstring = pub(skA) in
                                                        {8111}in(c, (=pkCli_6582,em1_6585: bitstring));
                                                        {8112}let m1_6586: bitstring = em1_6585 in
                                                        {8113}let (=OpenSecureChannelRequest,=pkCli_6582,wNc_6587: bitstring) = m1_6586 in
                                                        {8114}let Nc_6588: bitstring = dec(wNc_6587,skSess_6355) in
                                                        {8115}new Ns_6589: bitstring;
                                                        {8116}new ST_6590: bitstring;
                                                        {8117}new TTL_6591: bitstring;
                                                        {8118}let wNs_6592: bitstring = enc(Ns_6589,pkCli_6582) in
                                                        {8119}let m2_6593: bitstring = (OpenSecureChannelResponse,wNs_6592,ST_6590,TTL_6591) in
                                                        {8120}event beginSrv(Sess_5308,Cli_5306,Ns_6589);
                                                        {8121}out(c, m2_6593);
                                                        {8122}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                                        {8123}event endSrv(Cli_5306,Sess_5308,Nc_6588)
                                                    )
                                                    else
                                                        {8124}let v_6594: bool = (Disco_5307 = B) in
                                                        (
                                                            {8125}if v_6594 then
                                                            (
                                                                {8126}let pkDisco_6595: bitstring = pub(skB) in
                                                                {8127}in(c, (=pkCli_6582,em1_6596: bitstring));
                                                                {8128}let m1_6597: bitstring = em1_6596 in
                                                                {8129}let (=OpenSecureChannelRequest,=pkCli_6582,wNc_6598: bitstring) = m1_6597 in
                                                                {8130}let Nc_6599: bitstring = dec(wNc_6598,skSess_6355) in
                                                                {8131}new Ns_6600: bitstring;
                                                                {8132}new ST_6601: bitstring;
                                                                {8133}new TTL_6602: bitstring;
                                                                {8134}let wNs_6603: bitstring = enc(Ns_6600,pkCli_6582) in
                                                                {8135}let m2_6604: bitstring = (OpenSecureChannelResponse,wNs_6603,ST_6601,TTL_6602) in
                                                                {8136}event beginSrv(Sess_5308,Cli_5306,Ns_6600);
                                                                {8137}out(c, m2_6604);
                                                                {8138}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                                                {8139}event endSrv(Cli_5306,Sess_5308,Nc_6599)
                                                            )
                                                            else
                                                                {8140}let v_6605: bool = (Disco_5307 = C) in
                                                                (
                                                                    {8141}if v_6605 then
                                                                    (
                                                                        {8142}let pkDisco_6606: bitstring = pub(skC) in
                                                                        {8143}in(c, (=pkCli_6582,em1_6607: bitstring));
                                                                        {8144}let m1_6608: bitstring = em1_6607 in
                                                                        {8145}let (=OpenSecureChannelRequest,=pkCli_6582,wNc_6609: bitstring) = m1_6608 in
                                                                        {8146}let Nc_6610: bitstring = dec(wNc_6609,skSess_6355) in
                                                                        {8147}new Ns_6611: bitstring;
                                                                        {8148}new ST_6612: bitstring;
                                                                        {8149}new TTL_6613: bitstring;
                                                                        {8150}let wNs_6614: bitstring = enc(Ns_6611,pkCli_6582) in
                                                                        {8151}let m2_6615: bitstring = (OpenSecureChannelResponse,wNs_6614,ST_6612,TTL_6613) in
                                                                        {8152}event beginSrv(Sess_5308,Cli_5306,Ns_6611);
                                                                        {8153}out(c, m2_6615);
                                                                        {8154}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                                                        {8155}event endSrv(Cli_5306,Sess_5308,Nc_6610)
                                                                    )
                                                                    else
                                                                        {8156}let pkDisco_6616: bitstring = pub(sk(Disco_5307)) in
                                                                        {8157}in(c, (=pkCli_6582,em1_6617: bitstring));
                                                                        {8158}let m1_6618: bitstring = em1_6617 in
                                                                        {8159}let (=OpenSecureChannelRequest,=pkCli_6582,wNc_6619: bitstring) = m1_6618 in
                                                                        {8160}let Nc_6620: bitstring = dec(wNc_6619,skSess_6355) in
                                                                        {8161}new Ns_6621: bitstring;
                                                                        {8162}new ST_6622: bitstring;
                                                                        {8163}new TTL_6623: bitstring;
                                                                        {8164}let wNs_6624: bitstring = enc(Ns_6621,pkCli_6582) in
                                                                        {8165}let m2_6625: bitstring = (OpenSecureChannelResponse,wNs_6624,ST_6622,TTL_6623) in
                                                                        {8166}event beginSrv(Sess_5308,Cli_5306,Ns_6621);
                                                                        {8167}out(c, m2_6625);
                                                                        {8168}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                                                        {8169}event endSrv(Cli_5306,Sess_5308,Nc_6620)
                                                                )
                                                                else
                                                                    {8170}let pkDisco_6626: bitstring = fail-any in
                                                                    {8171}in(c, (=pkCli_6582,em1_6627: bitstring));
                                                                    {8172}let m1_6628: bitstring = em1_6627 in
                                                                    {8173}let (=OpenSecureChannelRequest,=pkCli_6582,wNc_6629: bitstring) = m1_6628 in
                                                                    {8174}let Nc_6630: bitstring = dec(wNc_6629,skSess_6355) in
                                                                    {8175}new Ns_6631: bitstring;
                                                                    {8176}new ST_6632: bitstring;
                                                                    {8177}new TTL_6633: bitstring;
                                                                    {8178}let wNs_6634: bitstring = enc(Ns_6631,pkCli_6582) in
                                                                    {8179}let m2_6635: bitstring = (OpenSecureChannelResponse,wNs_6634,ST_6632,TTL_6633) in
                                                                    {8180}event beginSrv(Sess_5308,Cli_5306,Ns_6631);
                                                                    {8181}out(c, m2_6635);
                                                                    {8182}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                                                    {8183}event endSrv(Cli_5306,Sess_5308,Nc_6630)
                                                        )
                                                        else
                                                            {8184}let pkDisco_6636: bitstring = fail-any in
                                                            {8185}in(c, (=pkCli_6582,em1_6637: bitstring));
                                                            {8186}let m1_6638: bitstring = em1_6637 in
                                                            {8187}let (=OpenSecureChannelRequest,=pkCli_6582,wNc_6639: bitstring) = m1_6638 in
                                                            {8188}let Nc_6640: bitstring = dec(wNc_6639,skSess_6355) in
                                                            {8189}new Ns_6641: bitstring;
                                                            {8190}new ST_6642: bitstring;
                                                            {8191}new TTL_6643: bitstring;
                                                            {8192}let wNs_6644: bitstring = enc(Ns_6641,pkCli_6582) in
                                                            {8193}let m2_6645: bitstring = (OpenSecureChannelResponse,wNs_6644,ST_6642,TTL_6643) in
                                                            {8194}event beginSrv(Sess_5308,Cli_5306,Ns_6641);
                                                            {8195}out(c, m2_6645);
                                                            {8196}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                                            {8197}event endSrv(Cli_5306,Sess_5308,Nc_6640)
                                                )
                                                else
                                                    {8198}let pkDisco_6646: bitstring = fail-any in
                                                    {8199}in(c, (=pkCli_6582,em1_6647: bitstring));
                                                    {8200}let m1_6648: bitstring = em1_6647 in
                                                    {8201}let (=OpenSecureChannelRequest,=pkCli_6582,wNc_6649: bitstring) = m1_6648 in
                                                    {8202}let Nc_6650: bitstring = dec(wNc_6649,skSess_6355) in
                                                    {8203}new Ns_6651: bitstring;
                                                    {8204}new ST_6652: bitstring;
                                                    {8205}new TTL_6653: bitstring;
                                                    {8206}let wNs_6654: bitstring = enc(Ns_6651,pkCli_6582) in
                                                    {8207}let m2_6655: bitstring = (OpenSecureChannelResponse,wNs_6654,ST_6652,TTL_6653) in
                                                    {8208}event beginSrv(Sess_5308,Cli_5306,Ns_6651);
                                                    {8209}out(c, m2_6655);
                                                    {8210}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                                    {8211}event endSrv(Cli_5306,Sess_5308,Nc_6650)
                                        )
                                        else
                                            {8212}let pkCli_6656: bitstring = fail-any in
                                            {8213}let v_6657: bool = (Disco_5307 = A) in
                                            (
                                                {8214}if v_6657 then
                                                (
                                                    {8215}let pkDisco_6658: bitstring = pub(skA) in
                                                    {8216}in(c, (=pkCli_6656,em1_6659: bitstring));
                                                    {8217}let m1_6660: bitstring = em1_6659 in
                                                    {8218}let (=OpenSecureChannelRequest,=pkCli_6656,wNc_6661: bitstring) = m1_6660 in
                                                    {8219}let Nc_6662: bitstring = dec(wNc_6661,skSess_6355) in
                                                    {8220}new Ns_6663: bitstring;
                                                    {8221}new ST_6664: bitstring;
                                                    {8222}new TTL_6665: bitstring;
                                                    {8223}let wNs_6666: bitstring = enc(Ns_6663,pkCli_6656) in
                                                    {8224}let m2_6667: bitstring = (OpenSecureChannelResponse,wNs_6666,ST_6664,TTL_6665) in
                                                    {8225}event beginSrv(Sess_5308,Cli_5306,Ns_6663);
                                                    {8226}out(c, m2_6667);
                                                    {8227}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                                    {8228}event endSrv(Cli_5306,Sess_5308,Nc_6662)
                                                )
                                                else
                                                    {8229}let v_6668: bool = (Disco_5307 = B) in
                                                    (
                                                        {8230}if v_6668 then
                                                        (
                                                            {8231}let pkDisco_6669: bitstring = pub(skB) in
                                                            {8232}in(c, (=pkCli_6656,em1_6670: bitstring));
                                                            {8233}let m1_6671: bitstring = em1_6670 in
                                                            {8234}let (=OpenSecureChannelRequest,=pkCli_6656,wNc_6672: bitstring) = m1_6671 in
                                                            {8235}let Nc_6673: bitstring = dec(wNc_6672,skSess_6355) in
                                                            {8236}new Ns_6674: bitstring;
                                                            {8237}new ST_6675: bitstring;
                                                            {8238}new TTL_6676: bitstring;
                                                            {8239}let wNs_6677: bitstring = enc(Ns_6674,pkCli_6656) in
                                                            {8240}let m2_6678: bitstring = (OpenSecureChannelResponse,wNs_6677,ST_6675,TTL_6676) in
                                                            {8241}event beginSrv(Sess_5308,Cli_5306,Ns_6674);
                                                            {8242}out(c, m2_6678);
                                                            {8243}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                                            {8244}event endSrv(Cli_5306,Sess_5308,Nc_6673)
                                                        )
                                                        else
                                                            {8245}let v_6679: bool = (Disco_5307 = C) in
                                                            (
                                                                {8246}if v_6679 then
                                                                (
                                                                    {8247}let pkDisco_6680: bitstring = pub(skC) in
                                                                    {8248}in(c, (=pkCli_6656,em1_6681: bitstring));
                                                                    {8249}let m1_6682: bitstring = em1_6681 in
                                                                    {8250}let (=OpenSecureChannelRequest,=pkCli_6656,wNc_6683: bitstring) = m1_6682 in
                                                                    {8251}let Nc_6684: bitstring = dec(wNc_6683,skSess_6355) in
                                                                    {8252}new Ns_6685: bitstring;
                                                                    {8253}new ST_6686: bitstring;
                                                                    {8254}new TTL_6687: bitstring;
                                                                    {8255}let wNs_6688: bitstring = enc(Ns_6685,pkCli_6656) in
                                                                    {8256}let m2_6689: bitstring = (OpenSecureChannelResponse,wNs_6688,ST_6686,TTL_6687) in
                                                                    {8257}event beginSrv(Sess_5308,Cli_5306,Ns_6685);
                                                                    {8258}out(c, m2_6689);
                                                                    {8259}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                                                    {8260}event endSrv(Cli_5306,Sess_5308,Nc_6684)
                                                                )
                                                                else
                                                                    {8261}let pkDisco_6690: bitstring = pub(sk(Disco_5307)) in
                                                                    {8262}in(c, (=pkCli_6656,em1_6691: bitstring));
                                                                    {8263}let m1_6692: bitstring = em1_6691 in
                                                                    {8264}let (=OpenSecureChannelRequest,=pkCli_6656,wNc_6693: bitstring) = m1_6692 in
                                                                    {8265}let Nc_6694: bitstring = dec(wNc_6693,skSess_6355) in
                                                                    {8266}new Ns_6695: bitstring;
                                                                    {8267}new ST_6696: bitstring;
                                                                    {8268}new TTL_6697: bitstring;
                                                                    {8269}let wNs_6698: bitstring = enc(Ns_6695,pkCli_6656) in
                                                                    {8270}let m2_6699: bitstring = (OpenSecureChannelResponse,wNs_6698,ST_6696,TTL_6697) in
                                                                    {8271}event beginSrv(Sess_5308,Cli_5306,Ns_6695);
                                                                    {8272}out(c, m2_6699);
                                                                    {8273}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                                                    {8274}event endSrv(Cli_5306,Sess_5308,Nc_6694)
                                                            )
                                                            else
                                                                {8275}let pkDisco_6700: bitstring = fail-any in
                                                                {8276}in(c, (=pkCli_6656,em1_6701: bitstring));
                                                                {8277}let m1_6702: bitstring = em1_6701 in
                                                                {8278}let (=OpenSecureChannelRequest,=pkCli_6656,wNc_6703: bitstring) = m1_6702 in
                                                                {8279}let Nc_6704: bitstring = dec(wNc_6703,skSess_6355) in
                                                                {8280}new Ns_6705: bitstring;
                                                                {8281}new ST_6706: bitstring;
                                                                {8282}new TTL_6707: bitstring;
                                                                {8283}let wNs_6708: bitstring = enc(Ns_6705,pkCli_6656) in
                                                                {8284}let m2_6709: bitstring = (OpenSecureChannelResponse,wNs_6708,ST_6706,TTL_6707) in
                                                                {8285}event beginSrv(Sess_5308,Cli_5306,Ns_6705);
                                                                {8286}out(c, m2_6709);
                                                                {8287}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                                                {8288}event endSrv(Cli_5306,Sess_5308,Nc_6704)
                                                    )
                                                    else
                                                        {8289}let pkDisco_6710: bitstring = fail-any in
                                                        {8290}in(c, (=pkCli_6656,em1_6711: bitstring));
                                                        {8291}let m1_6712: bitstring = em1_6711 in
                                                        {8292}let (=OpenSecureChannelRequest,=pkCli_6656,wNc_6713: bitstring) = m1_6712 in
                                                        {8293}let Nc_6714: bitstring = dec(wNc_6713,skSess_6355) in
                                                        {8294}new Ns_6715: bitstring;
                                                        {8295}new ST_6716: bitstring;
                                                        {8296}new TTL_6717: bitstring;
                                                        {8297}let wNs_6718: bitstring = enc(Ns_6715,pkCli_6656) in
                                                        {8298}let m2_6719: bitstring = (OpenSecureChannelResponse,wNs_6718,ST_6716,TTL_6717) in
                                                        {8299}event beginSrv(Sess_5308,Cli_5306,Ns_6715);
                                                        {8300}out(c, m2_6719);
                                                        {8301}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                                        {8302}event endSrv(Cli_5306,Sess_5308,Nc_6714)
                                            )
                                            else
                                                {8303}let pkDisco_6720: bitstring = fail-any in
                                                {8304}in(c, (=pkCli_6656,em1_6721: bitstring));
                                                {8305}let m1_6722: bitstring = em1_6721 in
                                                {8306}let (=OpenSecureChannelRequest,=pkCli_6656,wNc_6723: bitstring) = m1_6722 in
                                                {8307}let Nc_6724: bitstring = dec(wNc_6723,skSess_6355) in
                                                {8308}new Ns_6725: bitstring;
                                                {8309}new ST_6726: bitstring;
                                                {8310}new TTL_6727: bitstring;
                                                {8311}let wNs_6728: bitstring = enc(Ns_6725,pkCli_6656) in
                                                {8312}let m2_6729: bitstring = (OpenSecureChannelResponse,wNs_6728,ST_6726,TTL_6727) in
                                                {8313}event beginSrv(Sess_5308,Cli_5306,Ns_6725);
                                                {8314}out(c, m2_6729);
                                                {8315}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                                {8316}event endSrv(Cli_5306,Sess_5308,Nc_6724)
                                )
                                else
                                    {8317}let pkCli_6730: bitstring = fail-any in
                                    {8318}let v_6731: bool = (Disco_5307 = A) in
                                    (
                                        {8319}if v_6731 then
                                        (
                                            {8320}let pkDisco_6732: bitstring = pub(skA) in
                                            {8321}in(c, (=pkCli_6730,em1_6733: bitstring));
                                            {8322}let m1_6734: bitstring = em1_6733 in
                                            {8323}let (=OpenSecureChannelRequest,=pkCli_6730,wNc_6735: bitstring) = m1_6734 in
                                            {8324}let Nc_6736: bitstring = dec(wNc_6735,skSess_6355) in
                                            {8325}new Ns_6737: bitstring;
                                            {8326}new ST_6738: bitstring;
                                            {8327}new TTL_6739: bitstring;
                                            {8328}let wNs_6740: bitstring = enc(Ns_6737,pkCli_6730) in
                                            {8329}let m2_6741: bitstring = (OpenSecureChannelResponse,wNs_6740,ST_6738,TTL_6739) in
                                            {8330}event beginSrv(Sess_5308,Cli_5306,Ns_6737);
                                            {8331}out(c, m2_6741);
                                            {8332}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                            {8333}event endSrv(Cli_5306,Sess_5308,Nc_6736)
                                        )
                                        else
                                            {8334}let v_6742: bool = (Disco_5307 = B) in
                                            (
                                                {8335}if v_6742 then
                                                (
                                                    {8336}let pkDisco_6743: bitstring = pub(skB) in
                                                    {8337}in(c, (=pkCli_6730,em1_6744: bitstring));
                                                    {8338}let m1_6745: bitstring = em1_6744 in
                                                    {8339}let (=OpenSecureChannelRequest,=pkCli_6730,wNc_6746: bitstring) = m1_6745 in
                                                    {8340}let Nc_6747: bitstring = dec(wNc_6746,skSess_6355) in
                                                    {8341}new Ns_6748: bitstring;
                                                    {8342}new ST_6749: bitstring;
                                                    {8343}new TTL_6750: bitstring;
                                                    {8344}let wNs_6751: bitstring = enc(Ns_6748,pkCli_6730) in
                                                    {8345}let m2_6752: bitstring = (OpenSecureChannelResponse,wNs_6751,ST_6749,TTL_6750) in
                                                    {8346}event beginSrv(Sess_5308,Cli_5306,Ns_6748);
                                                    {8347}out(c, m2_6752);
                                                    {8348}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                                    {8349}event endSrv(Cli_5306,Sess_5308,Nc_6747)
                                                )
                                                else
                                                    {8350}let v_6753: bool = (Disco_5307 = C) in
                                                    (
                                                        {8351}if v_6753 then
                                                        (
                                                            {8352}let pkDisco_6754: bitstring = pub(skC) in
                                                            {8353}in(c, (=pkCli_6730,em1_6755: bitstring));
                                                            {8354}let m1_6756: bitstring = em1_6755 in
                                                            {8355}let (=OpenSecureChannelRequest,=pkCli_6730,wNc_6757: bitstring) = m1_6756 in
                                                            {8356}let Nc_6758: bitstring = dec(wNc_6757,skSess_6355) in
                                                            {8357}new Ns_6759: bitstring;
                                                            {8358}new ST_6760: bitstring;
                                                            {8359}new TTL_6761: bitstring;
                                                            {8360}let wNs_6762: bitstring = enc(Ns_6759,pkCli_6730) in
                                                            {8361}let m2_6763: bitstring = (OpenSecureChannelResponse,wNs_6762,ST_6760,TTL_6761) in
                                                            {8362}event beginSrv(Sess_5308,Cli_5306,Ns_6759);
                                                            {8363}out(c, m2_6763);
                                                            {8364}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                                            {8365}event endSrv(Cli_5306,Sess_5308,Nc_6758)
                                                        )
                                                        else
                                                            {8366}let pkDisco_6764: bitstring = pub(sk(Disco_5307)) in
                                                            {8367}in(c, (=pkCli_6730,em1_6765: bitstring));
                                                            {8368}let m1_6766: bitstring = em1_6765 in
                                                            {8369}let (=OpenSecureChannelRequest,=pkCli_6730,wNc_6767: bitstring) = m1_6766 in
                                                            {8370}let Nc_6768: bitstring = dec(wNc_6767,skSess_6355) in
                                                            {8371}new Ns_6769: bitstring;
                                                            {8372}new ST_6770: bitstring;
                                                            {8373}new TTL_6771: bitstring;
                                                            {8374}let wNs_6772: bitstring = enc(Ns_6769,pkCli_6730) in
                                                            {8375}let m2_6773: bitstring = (OpenSecureChannelResponse,wNs_6772,ST_6770,TTL_6771) in
                                                            {8376}event beginSrv(Sess_5308,Cli_5306,Ns_6769);
                                                            {8377}out(c, m2_6773);
                                                            {8378}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                                            {8379}event endSrv(Cli_5306,Sess_5308,Nc_6768)
                                                    )
                                                    else
                                                        {8380}let pkDisco_6774: bitstring = fail-any in
                                                        {8381}in(c, (=pkCli_6730,em1_6775: bitstring));
                                                        {8382}let m1_6776: bitstring = em1_6775 in
                                                        {8383}let (=OpenSecureChannelRequest,=pkCli_6730,wNc_6777: bitstring) = m1_6776 in
                                                        {8384}let Nc_6778: bitstring = dec(wNc_6777,skSess_6355) in
                                                        {8385}new Ns_6779: bitstring;
                                                        {8386}new ST_6780: bitstring;
                                                        {8387}new TTL_6781: bitstring;
                                                        {8388}let wNs_6782: bitstring = enc(Ns_6779,pkCli_6730) in
                                                        {8389}let m2_6783: bitstring = (OpenSecureChannelResponse,wNs_6782,ST_6780,TTL_6781) in
                                                        {8390}event beginSrv(Sess_5308,Cli_5306,Ns_6779);
                                                        {8391}out(c, m2_6783);
                                                        {8392}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                                        {8393}event endSrv(Cli_5306,Sess_5308,Nc_6778)
                                            )
                                            else
                                                {8394}let pkDisco_6784: bitstring = fail-any in
                                                {8395}in(c, (=pkCli_6730,em1_6785: bitstring));
                                                {8396}let m1_6786: bitstring = em1_6785 in
                                                {8397}let (=OpenSecureChannelRequest,=pkCli_6730,wNc_6787: bitstring) = m1_6786 in
                                                {8398}let Nc_6788: bitstring = dec(wNc_6787,skSess_6355) in
                                                {8399}new Ns_6789: bitstring;
                                                {8400}new ST_6790: bitstring;
                                                {8401}new TTL_6791: bitstring;
                                                {8402}let wNs_6792: bitstring = enc(Ns_6789,pkCli_6730) in
                                                {8403}let m2_6793: bitstring = (OpenSecureChannelResponse,wNs_6792,ST_6790,TTL_6791) in
                                                {8404}event beginSrv(Sess_5308,Cli_5306,Ns_6789);
                                                {8405}out(c, m2_6793);
                                                {8406}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                                {8407}event endSrv(Cli_5306,Sess_5308,Nc_6788)
                                    )
                                    else
                                        {8408}let pkDisco_6794: bitstring = fail-any in
                                        {8409}in(c, (=pkCli_6730,em1_6795: bitstring));
                                        {8410}let m1_6796: bitstring = em1_6795 in
                                        {8411}let (=OpenSecureChannelRequest,=pkCli_6730,wNc_6797: bitstring) = m1_6796 in
                                        {8412}let Nc_6798: bitstring = dec(wNc_6797,skSess_6355) in
                                        {8413}new Ns_6799: bitstring;
                                        {8414}new ST_6800: bitstring;
                                        {8415}new TTL_6801: bitstring;
                                        {8416}let wNs_6802: bitstring = enc(Ns_6799,pkCli_6730) in
                                        {8417}let m2_6803: bitstring = (OpenSecureChannelResponse,wNs_6802,ST_6800,TTL_6801) in
                                        {8418}event beginSrv(Sess_5308,Cli_5306,Ns_6799);
                                        {8419}out(c, m2_6803);
                                        {8420}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                        {8421}event endSrv(Cli_5306,Sess_5308,Nc_6798)
                        )
                        else
                            {8422}let pkCli_6804: bitstring = fail-any in
                            {8423}let v_6805: bool = (Disco_5307 = A) in
                            (
                                {8424}if v_6805 then
                                (
                                    {8425}let pkDisco_6806: bitstring = pub(skA) in
                                    {8426}in(c, (=pkCli_6804,em1_6807: bitstring));
                                    {8427}let m1_6808: bitstring = em1_6807 in
                                    {8428}let (=OpenSecureChannelRequest,=pkCli_6804,wNc_6809: bitstring) = m1_6808 in
                                    {8429}let Nc_6810: bitstring = dec(wNc_6809,skSess_6355) in
                                    {8430}new Ns_6811: bitstring;
                                    {8431}new ST_6812: bitstring;
                                    {8432}new TTL_6813: bitstring;
                                    {8433}let wNs_6814: bitstring = enc(Ns_6811,pkCli_6804) in
                                    {8434}let m2_6815: bitstring = (OpenSecureChannelResponse,wNs_6814,ST_6812,TTL_6813) in
                                    {8435}event beginSrv(Sess_5308,Cli_5306,Ns_6811);
                                    {8436}out(c, m2_6815);
                                    {8437}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                    {8438}event endSrv(Cli_5306,Sess_5308,Nc_6810)
                                )
                                else
                                    {8439}let v_6816: bool = (Disco_5307 = B) in
                                    (
                                        {8440}if v_6816 then
                                        (
                                            {8441}let pkDisco_6817: bitstring = pub(skB) in
                                            {8442}in(c, (=pkCli_6804,em1_6818: bitstring));
                                            {8443}let m1_6819: bitstring = em1_6818 in
                                            {8444}let (=OpenSecureChannelRequest,=pkCli_6804,wNc_6820: bitstring) = m1_6819 in
                                            {8445}let Nc_6821: bitstring = dec(wNc_6820,skSess_6355) in
                                            {8446}new Ns_6822: bitstring;
                                            {8447}new ST_6823: bitstring;
                                            {8448}new TTL_6824: bitstring;
                                            {8449}let wNs_6825: bitstring = enc(Ns_6822,pkCli_6804) in
                                            {8450}let m2_6826: bitstring = (OpenSecureChannelResponse,wNs_6825,ST_6823,TTL_6824) in
                                            {8451}event beginSrv(Sess_5308,Cli_5306,Ns_6822);
                                            {8452}out(c, m2_6826);
                                            {8453}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                            {8454}event endSrv(Cli_5306,Sess_5308,Nc_6821)
                                        )
                                        else
                                            {8455}let v_6827: bool = (Disco_5307 = C) in
                                            (
                                                {8456}if v_6827 then
                                                (
                                                    {8457}let pkDisco_6828: bitstring = pub(skC) in
                                                    {8458}in(c, (=pkCli_6804,em1_6829: bitstring));
                                                    {8459}let m1_6830: bitstring = em1_6829 in
                                                    {8460}let (=OpenSecureChannelRequest,=pkCli_6804,wNc_6831: bitstring) = m1_6830 in
                                                    {8461}let Nc_6832: bitstring = dec(wNc_6831,skSess_6355) in
                                                    {8462}new Ns_6833: bitstring;
                                                    {8463}new ST_6834: bitstring;
                                                    {8464}new TTL_6835: bitstring;
                                                    {8465}let wNs_6836: bitstring = enc(Ns_6833,pkCli_6804) in
                                                    {8466}let m2_6837: bitstring = (OpenSecureChannelResponse,wNs_6836,ST_6834,TTL_6835) in
                                                    {8467}event beginSrv(Sess_5308,Cli_5306,Ns_6833);
                                                    {8468}out(c, m2_6837);
                                                    {8469}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                                    {8470}event endSrv(Cli_5306,Sess_5308,Nc_6832)
                                                )
                                                else
                                                    {8471}let pkDisco_6838: bitstring = pub(sk(Disco_5307)) in
                                                    {8472}in(c, (=pkCli_6804,em1_6839: bitstring));
                                                    {8473}let m1_6840: bitstring = em1_6839 in
                                                    {8474}let (=OpenSecureChannelRequest,=pkCli_6804,wNc_6841: bitstring) = m1_6840 in
                                                    {8475}let Nc_6842: bitstring = dec(wNc_6841,skSess_6355) in
                                                    {8476}new Ns_6843: bitstring;
                                                    {8477}new ST_6844: bitstring;
                                                    {8478}new TTL_6845: bitstring;
                                                    {8479}let wNs_6846: bitstring = enc(Ns_6843,pkCli_6804) in
                                                    {8480}let m2_6847: bitstring = (OpenSecureChannelResponse,wNs_6846,ST_6844,TTL_6845) in
                                                    {8481}event beginSrv(Sess_5308,Cli_5306,Ns_6843);
                                                    {8482}out(c, m2_6847);
                                                    {8483}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                                    {8484}event endSrv(Cli_5306,Sess_5308,Nc_6842)
                                            )
                                            else
                                                {8485}let pkDisco_6848: bitstring = fail-any in
                                                {8486}in(c, (=pkCli_6804,em1_6849: bitstring));
                                                {8487}let m1_6850: bitstring = em1_6849 in
                                                {8488}let (=OpenSecureChannelRequest,=pkCli_6804,wNc_6851: bitstring) = m1_6850 in
                                                {8489}let Nc_6852: bitstring = dec(wNc_6851,skSess_6355) in
                                                {8490}new Ns_6853: bitstring;
                                                {8491}new ST_6854: bitstring;
                                                {8492}new TTL_6855: bitstring;
                                                {8493}let wNs_6856: bitstring = enc(Ns_6853,pkCli_6804) in
                                                {8494}let m2_6857: bitstring = (OpenSecureChannelResponse,wNs_6856,ST_6854,TTL_6855) in
                                                {8495}event beginSrv(Sess_5308,Cli_5306,Ns_6853);
                                                {8496}out(c, m2_6857);
                                                {8497}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                                {8498}event endSrv(Cli_5306,Sess_5308,Nc_6852)
                                    )
                                    else
                                        {8499}let pkDisco_6858: bitstring = fail-any in
                                        {8500}in(c, (=pkCli_6804,em1_6859: bitstring));
                                        {8501}let m1_6860: bitstring = em1_6859 in
                                        {8502}let (=OpenSecureChannelRequest,=pkCli_6804,wNc_6861: bitstring) = m1_6860 in
                                        {8503}let Nc_6862: bitstring = dec(wNc_6861,skSess_6355) in
                                        {8504}new Ns_6863: bitstring;
                                        {8505}new ST_6864: bitstring;
                                        {8506}new TTL_6865: bitstring;
                                        {8507}let wNs_6866: bitstring = enc(Ns_6863,pkCli_6804) in
                                        {8508}let m2_6867: bitstring = (OpenSecureChannelResponse,wNs_6866,ST_6864,TTL_6865) in
                                        {8509}event beginSrv(Sess_5308,Cli_5306,Ns_6863);
                                        {8510}out(c, m2_6867);
                                        {8511}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                        {8512}event endSrv(Cli_5306,Sess_5308,Nc_6862)
                            )
                            else
                                {8513}let pkDisco_6868: bitstring = fail-any in
                                {8514}in(c, (=pkCli_6804,em1_6869: bitstring));
                                {8515}let m1_6870: bitstring = em1_6869 in
                                {8516}let (=OpenSecureChannelRequest,=pkCli_6804,wNc_6871: bitstring) = m1_6870 in
                                {8517}let Nc_6872: bitstring = dec(wNc_6871,skSess_6355) in
                                {8518}new Ns_6873: bitstring;
                                {8519}new ST_6874: bitstring;
                                {8520}new TTL_6875: bitstring;
                                {8521}let wNs_6876: bitstring = enc(Ns_6873,pkCli_6804) in
                                {8522}let m2_6877: bitstring = (OpenSecureChannelResponse,wNs_6876,ST_6874,TTL_6875) in
                                {8523}event beginSrv(Sess_5308,Cli_5306,Ns_6873);
                                {8524}out(c, m2_6877);
                                {8525}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                {8526}event endSrv(Cli_5306,Sess_5308,Nc_6872)
                    )
                    else
                        {8527}let skSess_6878: bitstring = fail-any in
                        {8528}let pkSess_6879: bitstring = pub(skSess_6878) in
                        {8529}let v_6880: bool = (Cli_5306 = A) in
                        (
                            {8530}if v_6880 then
                            (
                                {8531}let pkCli_6881: bitstring = pub(skA) in
                                {8532}let v_6882: bool = (Disco_5307 = A) in
                                (
                                    {8533}if v_6882 then
                                    (
                                        {8534}let pkDisco_6883: bitstring = pub(skA) in
                                        {8535}in(c, (=pkCli_6881,em1_6884: bitstring));
                                        {8536}let m1_6885: bitstring = em1_6884 in
                                        {8537}let (=OpenSecureChannelRequest,=pkCli_6881,wNc_6886: bitstring) = m1_6885 in
                                        {8538}let Nc_6887: bitstring = dec(wNc_6886,skSess_6878) in
                                        {8539}new Ns_6888: bitstring;
                                        {8540}new ST_6889: bitstring;
                                        {8541}new TTL_6890: bitstring;
                                        {8542}let wNs_6891: bitstring = enc(Ns_6888,pkCli_6881) in
                                        {8543}let m2_6892: bitstring = (OpenSecureChannelResponse,wNs_6891,ST_6889,TTL_6890) in
                                        {8544}event beginSrv(Sess_5308,Cli_5306,Ns_6888);
                                        {8545}out(c, m2_6892);
                                        {8546}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                        {8547}event endSrv(Cli_5306,Sess_5308,Nc_6887)
                                    )
                                    else
                                        {8548}let v_6893: bool = (Disco_5307 = B) in
                                        (
                                            {8549}if v_6893 then
                                            (
                                                {8550}let pkDisco_6894: bitstring = pub(skB) in
                                                {8551}in(c, (=pkCli_6881,em1_6895: bitstring));
                                                {8552}let m1_6896: bitstring = em1_6895 in
                                                {8553}let (=OpenSecureChannelRequest,=pkCli_6881,wNc_6897: bitstring) = m1_6896 in
                                                {8554}let Nc_6898: bitstring = dec(wNc_6897,skSess_6878) in
                                                {8555}new Ns_6899: bitstring;
                                                {8556}new ST_6900: bitstring;
                                                {8557}new TTL_6901: bitstring;
                                                {8558}let wNs_6902: bitstring = enc(Ns_6899,pkCli_6881) in
                                                {8559}let m2_6903: bitstring = (OpenSecureChannelResponse,wNs_6902,ST_6900,TTL_6901) in
                                                {8560}event beginSrv(Sess_5308,Cli_5306,Ns_6899);
                                                {8561}out(c, m2_6903);
                                                {8562}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                                {8563}event endSrv(Cli_5306,Sess_5308,Nc_6898)
                                            )
                                            else
                                                {8564}let v_6904: bool = (Disco_5307 = C) in
                                                (
                                                    {8565}if v_6904 then
                                                    (
                                                        {8566}let pkDisco_6905: bitstring = pub(skC) in
                                                        {8567}in(c, (=pkCli_6881,em1_6906: bitstring));
                                                        {8568}let m1_6907: bitstring = em1_6906 in
                                                        {8569}let (=OpenSecureChannelRequest,=pkCli_6881,wNc_6908: bitstring) = m1_6907 in
                                                        {8570}let Nc_6909: bitstring = dec(wNc_6908,skSess_6878) in
                                                        {8571}new Ns_6910: bitstring;
                                                        {8572}new ST_6911: bitstring;
                                                        {8573}new TTL_6912: bitstring;
                                                        {8574}let wNs_6913: bitstring = enc(Ns_6910,pkCli_6881) in
                                                        {8575}let m2_6914: bitstring = (OpenSecureChannelResponse,wNs_6913,ST_6911,TTL_6912) in
                                                        {8576}event beginSrv(Sess_5308,Cli_5306,Ns_6910);
                                                        {8577}out(c, m2_6914);
                                                        {8578}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                                        {8579}event endSrv(Cli_5306,Sess_5308,Nc_6909)
                                                    )
                                                    else
                                                        {8580}let pkDisco_6915: bitstring = pub(sk(Disco_5307)) in
                                                        {8581}in(c, (=pkCli_6881,em1_6916: bitstring));
                                                        {8582}let m1_6917: bitstring = em1_6916 in
                                                        {8583}let (=OpenSecureChannelRequest,=pkCli_6881,wNc_6918: bitstring) = m1_6917 in
                                                        {8584}let Nc_6919: bitstring = dec(wNc_6918,skSess_6878) in
                                                        {8585}new Ns_6920: bitstring;
                                                        {8586}new ST_6921: bitstring;
                                                        {8587}new TTL_6922: bitstring;
                                                        {8588}let wNs_6923: bitstring = enc(Ns_6920,pkCli_6881) in
                                                        {8589}let m2_6924: bitstring = (OpenSecureChannelResponse,wNs_6923,ST_6921,TTL_6922) in
                                                        {8590}event beginSrv(Sess_5308,Cli_5306,Ns_6920);
                                                        {8591}out(c, m2_6924);
                                                        {8592}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                                        {8593}event endSrv(Cli_5306,Sess_5308,Nc_6919)
                                                )
                                                else
                                                    {8594}let pkDisco_6925: bitstring = fail-any in
                                                    {8595}in(c, (=pkCli_6881,em1_6926: bitstring));
                                                    {8596}let m1_6927: bitstring = em1_6926 in
                                                    {8597}let (=OpenSecureChannelRequest,=pkCli_6881,wNc_6928: bitstring) = m1_6927 in
                                                    {8598}let Nc_6929: bitstring = dec(wNc_6928,skSess_6878) in
                                                    {8599}new Ns_6930: bitstring;
                                                    {8600}new ST_6931: bitstring;
                                                    {8601}new TTL_6932: bitstring;
                                                    {8602}let wNs_6933: bitstring = enc(Ns_6930,pkCli_6881) in
                                                    {8603}let m2_6934: bitstring = (OpenSecureChannelResponse,wNs_6933,ST_6931,TTL_6932) in
                                                    {8604}event beginSrv(Sess_5308,Cli_5306,Ns_6930);
                                                    {8605}out(c, m2_6934);
                                                    {8606}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                                    {8607}event endSrv(Cli_5306,Sess_5308,Nc_6929)
                                        )
                                        else
                                            {8608}let pkDisco_6935: bitstring = fail-any in
                                            {8609}in(c, (=pkCli_6881,em1_6936: bitstring));
                                            {8610}let m1_6937: bitstring = em1_6936 in
                                            {8611}let (=OpenSecureChannelRequest,=pkCli_6881,wNc_6938: bitstring) = m1_6937 in
                                            {8612}let Nc_6939: bitstring = dec(wNc_6938,skSess_6878) in
                                            {8613}new Ns_6940: bitstring;
                                            {8614}new ST_6941: bitstring;
                                            {8615}new TTL_6942: bitstring;
                                            {8616}let wNs_6943: bitstring = enc(Ns_6940,pkCli_6881) in
                                            {8617}let m2_6944: bitstring = (OpenSecureChannelResponse,wNs_6943,ST_6941,TTL_6942) in
                                            {8618}event beginSrv(Sess_5308,Cli_5306,Ns_6940);
                                            {8619}out(c, m2_6944);
                                            {8620}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                            {8621}event endSrv(Cli_5306,Sess_5308,Nc_6939)
                                )
                                else
                                    {8622}let pkDisco_6945: bitstring = fail-any in
                                    {8623}in(c, (=pkCli_6881,em1_6946: bitstring));
                                    {8624}let m1_6947: bitstring = em1_6946 in
                                    {8625}let (=OpenSecureChannelRequest,=pkCli_6881,wNc_6948: bitstring) = m1_6947 in
                                    {8626}let Nc_6949: bitstring = dec(wNc_6948,skSess_6878) in
                                    {8627}new Ns_6950: bitstring;
                                    {8628}new ST_6951: bitstring;
                                    {8629}new TTL_6952: bitstring;
                                    {8630}let wNs_6953: bitstring = enc(Ns_6950,pkCli_6881) in
                                    {8631}let m2_6954: bitstring = (OpenSecureChannelResponse,wNs_6953,ST_6951,TTL_6952) in
                                    {8632}event beginSrv(Sess_5308,Cli_5306,Ns_6950);
                                    {8633}out(c, m2_6954);
                                    {8634}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                    {8635}event endSrv(Cli_5306,Sess_5308,Nc_6949)
                            )
                            else
                                {8636}let v_6955: bool = (Cli_5306 = B) in
                                (
                                    {8637}if v_6955 then
                                    (
                                        {8638}let pkCli_6956: bitstring = pub(skB) in
                                        {8639}let v_6957: bool = (Disco_5307 = A) in
                                        (
                                            {8640}if v_6957 then
                                            (
                                                {8641}let pkDisco_6958: bitstring = pub(skA) in
                                                {8642}in(c, (=pkCli_6956,em1_6959: bitstring));
                                                {8643}let m1_6960: bitstring = em1_6959 in
                                                {8644}let (=OpenSecureChannelRequest,=pkCli_6956,wNc_6961: bitstring) = m1_6960 in
                                                {8645}let Nc_6962: bitstring = dec(wNc_6961,skSess_6878) in
                                                {8646}new Ns_6963: bitstring;
                                                {8647}new ST_6964: bitstring;
                                                {8648}new TTL_6965: bitstring;
                                                {8649}let wNs_6966: bitstring = enc(Ns_6963,pkCli_6956) in
                                                {8650}let m2_6967: bitstring = (OpenSecureChannelResponse,wNs_6966,ST_6964,TTL_6965) in
                                                {8651}event beginSrv(Sess_5308,Cli_5306,Ns_6963);
                                                {8652}out(c, m2_6967);
                                                {8653}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                                {8654}event endSrv(Cli_5306,Sess_5308,Nc_6962)
                                            )
                                            else
                                                {8655}let v_6968: bool = (Disco_5307 = B) in
                                                (
                                                    {8656}if v_6968 then
                                                    (
                                                        {8657}let pkDisco_6969: bitstring = pub(skB) in
                                                        {8658}in(c, (=pkCli_6956,em1_6970: bitstring));
                                                        {8659}let m1_6971: bitstring = em1_6970 in
                                                        {8660}let (=OpenSecureChannelRequest,=pkCli_6956,wNc_6972: bitstring) = m1_6971 in
                                                        {8661}let Nc_6973: bitstring = dec(wNc_6972,skSess_6878) in
                                                        {8662}new Ns_6974: bitstring;
                                                        {8663}new ST_6975: bitstring;
                                                        {8664}new TTL_6976: bitstring;
                                                        {8665}let wNs_6977: bitstring = enc(Ns_6974,pkCli_6956) in
                                                        {8666}let m2_6978: bitstring = (OpenSecureChannelResponse,wNs_6977,ST_6975,TTL_6976) in
                                                        {8667}event beginSrv(Sess_5308,Cli_5306,Ns_6974);
                                                        {8668}out(c, m2_6978);
                                                        {8669}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                                        {8670}event endSrv(Cli_5306,Sess_5308,Nc_6973)
                                                    )
                                                    else
                                                        {8671}let v_6979: bool = (Disco_5307 = C) in
                                                        (
                                                            {8672}if v_6979 then
                                                            (
                                                                {8673}let pkDisco_6980: bitstring = pub(skC) in
                                                                {8674}in(c, (=pkCli_6956,em1_6981: bitstring));
                                                                {8675}let m1_6982: bitstring = em1_6981 in
                                                                {8676}let (=OpenSecureChannelRequest,=pkCli_6956,wNc_6983: bitstring) = m1_6982 in
                                                                {8677}let Nc_6984: bitstring = dec(wNc_6983,skSess_6878) in
                                                                {8678}new Ns_6985: bitstring;
                                                                {8679}new ST_6986: bitstring;
                                                                {8680}new TTL_6987: bitstring;
                                                                {8681}let wNs_6988: bitstring = enc(Ns_6985,pkCli_6956) in
                                                                {8682}let m2_6989: bitstring = (OpenSecureChannelResponse,wNs_6988,ST_6986,TTL_6987) in
                                                                {8683}event beginSrv(Sess_5308,Cli_5306,Ns_6985);
                                                                {8684}out(c, m2_6989);
                                                                {8685}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                                                {8686}event endSrv(Cli_5306,Sess_5308,Nc_6984)
                                                            )
                                                            else
                                                                {8687}let pkDisco_6990: bitstring = pub(sk(Disco_5307)) in
                                                                {8688}in(c, (=pkCli_6956,em1_6991: bitstring));
                                                                {8689}let m1_6992: bitstring = em1_6991 in
                                                                {8690}let (=OpenSecureChannelRequest,=pkCli_6956,wNc_6993: bitstring) = m1_6992 in
                                                                {8691}let Nc_6994: bitstring = dec(wNc_6993,skSess_6878) in
                                                                {8692}new Ns_6995: bitstring;
                                                                {8693}new ST_6996: bitstring;
                                                                {8694}new TTL_6997: bitstring;
                                                                {8695}let wNs_6998: bitstring = enc(Ns_6995,pkCli_6956) in
                                                                {8696}let m2_6999: bitstring = (OpenSecureChannelResponse,wNs_6998,ST_6996,TTL_6997) in
                                                                {8697}event beginSrv(Sess_5308,Cli_5306,Ns_6995);
                                                                {8698}out(c, m2_6999);
                                                                {8699}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                                                {8700}event endSrv(Cli_5306,Sess_5308,Nc_6994)
                                                        )
                                                        else
                                                            {8701}let pkDisco_7000: bitstring = fail-any in
                                                            {8702}in(c, (=pkCli_6956,em1_7001: bitstring));
                                                            {8703}let m1_7002: bitstring = em1_7001 in
                                                            {8704}let (=OpenSecureChannelRequest,=pkCli_6956,wNc_7003: bitstring) = m1_7002 in
                                                            {8705}let Nc_7004: bitstring = dec(wNc_7003,skSess_6878) in
                                                            {8706}new Ns_7005: bitstring;
                                                            {8707}new ST_7006: bitstring;
                                                            {8708}new TTL_7007: bitstring;
                                                            {8709}let wNs_7008: bitstring = enc(Ns_7005,pkCli_6956) in
                                                            {8710}let m2_7009: bitstring = (OpenSecureChannelResponse,wNs_7008,ST_7006,TTL_7007) in
                                                            {8711}event beginSrv(Sess_5308,Cli_5306,Ns_7005);
                                                            {8712}out(c, m2_7009);
                                                            {8713}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                                            {8714}event endSrv(Cli_5306,Sess_5308,Nc_7004)
                                                )
                                                else
                                                    {8715}let pkDisco_7010: bitstring = fail-any in
                                                    {8716}in(c, (=pkCli_6956,em1_7011: bitstring));
                                                    {8717}let m1_7012: bitstring = em1_7011 in
                                                    {8718}let (=OpenSecureChannelRequest,=pkCli_6956,wNc_7013: bitstring) = m1_7012 in
                                                    {8719}let Nc_7014: bitstring = dec(wNc_7013,skSess_6878) in
                                                    {8720}new Ns_7015: bitstring;
                                                    {8721}new ST_7016: bitstring;
                                                    {8722}new TTL_7017: bitstring;
                                                    {8723}let wNs_7018: bitstring = enc(Ns_7015,pkCli_6956) in
                                                    {8724}let m2_7019: bitstring = (OpenSecureChannelResponse,wNs_7018,ST_7016,TTL_7017) in
                                                    {8725}event beginSrv(Sess_5308,Cli_5306,Ns_7015);
                                                    {8726}out(c, m2_7019);
                                                    {8727}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                                    {8728}event endSrv(Cli_5306,Sess_5308,Nc_7014)
                                        )
                                        else
                                            {8729}let pkDisco_7020: bitstring = fail-any in
                                            {8730}in(c, (=pkCli_6956,em1_7021: bitstring));
                                            {8731}let m1_7022: bitstring = em1_7021 in
                                            {8732}let (=OpenSecureChannelRequest,=pkCli_6956,wNc_7023: bitstring) = m1_7022 in
                                            {8733}let Nc_7024: bitstring = dec(wNc_7023,skSess_6878) in
                                            {8734}new Ns_7025: bitstring;
                                            {8735}new ST_7026: bitstring;
                                            {8736}new TTL_7027: bitstring;
                                            {8737}let wNs_7028: bitstring = enc(Ns_7025,pkCli_6956) in
                                            {8738}let m2_7029: bitstring = (OpenSecureChannelResponse,wNs_7028,ST_7026,TTL_7027) in
                                            {8739}event beginSrv(Sess_5308,Cli_5306,Ns_7025);
                                            {8740}out(c, m2_7029);
                                            {8741}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                            {8742}event endSrv(Cli_5306,Sess_5308,Nc_7024)
                                    )
                                    else
                                        {8743}let v_7030: bool = (Cli_5306 = C) in
                                        (
                                            {8744}if v_7030 then
                                            (
                                                {8745}let pkCli_7031: bitstring = pub(skC) in
                                                {8746}let v_7032: bool = (Disco_5307 = A) in
                                                (
                                                    {8747}if v_7032 then
                                                    (
                                                        {8748}let pkDisco_7033: bitstring = pub(skA) in
                                                        {8749}in(c, (=pkCli_7031,em1_7034: bitstring));
                                                        {8750}let m1_7035: bitstring = em1_7034 in
                                                        {8751}let (=OpenSecureChannelRequest,=pkCli_7031,wNc_7036: bitstring) = m1_7035 in
                                                        {8752}let Nc_7037: bitstring = dec(wNc_7036,skSess_6878) in
                                                        {8753}new Ns_7038: bitstring;
                                                        {8754}new ST_7039: bitstring;
                                                        {8755}new TTL_7040: bitstring;
                                                        {8756}let wNs_7041: bitstring = enc(Ns_7038,pkCli_7031) in
                                                        {8757}let m2_7042: bitstring = (OpenSecureChannelResponse,wNs_7041,ST_7039,TTL_7040) in
                                                        {8758}event beginSrv(Sess_5308,Cli_5306,Ns_7038);
                                                        {8759}out(c, m2_7042);
                                                        {8760}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                                        {8761}event endSrv(Cli_5306,Sess_5308,Nc_7037)
                                                    )
                                                    else
                                                        {8762}let v_7043: bool = (Disco_5307 = B) in
                                                        (
                                                            {8763}if v_7043 then
                                                            (
                                                                {8764}let pkDisco_7044: bitstring = pub(skB) in
                                                                {8765}in(c, (=pkCli_7031,em1_7045: bitstring));
                                                                {8766}let m1_7046: bitstring = em1_7045 in
                                                                {8767}let (=OpenSecureChannelRequest,=pkCli_7031,wNc_7047: bitstring) = m1_7046 in
                                                                {8768}let Nc_7048: bitstring = dec(wNc_7047,skSess_6878) in
                                                                {8769}new Ns_7049: bitstring;
                                                                {8770}new ST_7050: bitstring;
                                                                {8771}new TTL_7051: bitstring;
                                                                {8772}let wNs_7052: bitstring = enc(Ns_7049,pkCli_7031) in
                                                                {8773}let m2_7053: bitstring = (OpenSecureChannelResponse,wNs_7052,ST_7050,TTL_7051) in
                                                                {8774}event beginSrv(Sess_5308,Cli_5306,Ns_7049);
                                                                {8775}out(c, m2_7053);
                                                                {8776}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                                                {8777}event endSrv(Cli_5306,Sess_5308,Nc_7048)
                                                            )
                                                            else
                                                                {8778}let v_7054: bool = (Disco_5307 = C) in
                                                                (
                                                                    {8779}if v_7054 then
                                                                    (
                                                                        {8780}let pkDisco_7055: bitstring = pub(skC) in
                                                                        {8781}in(c, (=pkCli_7031,em1_7056: bitstring));
                                                                        {8782}let m1_7057: bitstring = em1_7056 in
                                                                        {8783}let (=OpenSecureChannelRequest,=pkCli_7031,wNc_7058: bitstring) = m1_7057 in
                                                                        {8784}let Nc_7059: bitstring = dec(wNc_7058,skSess_6878) in
                                                                        {8785}new Ns_7060: bitstring;
                                                                        {8786}new ST_7061: bitstring;
                                                                        {8787}new TTL_7062: bitstring;
                                                                        {8788}let wNs_7063: bitstring = enc(Ns_7060,pkCli_7031) in
                                                                        {8789}let m2_7064: bitstring = (OpenSecureChannelResponse,wNs_7063,ST_7061,TTL_7062) in
                                                                        {8790}event beginSrv(Sess_5308,Cli_5306,Ns_7060);
                                                                        {8791}out(c, m2_7064);
                                                                        {8792}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                                                        {8793}event endSrv(Cli_5306,Sess_5308,Nc_7059)
                                                                    )
                                                                    else
                                                                        {8794}let pkDisco_7065: bitstring = pub(sk(Disco_5307)) in
                                                                        {8795}in(c, (=pkCli_7031,em1_7066: bitstring));
                                                                        {8796}let m1_7067: bitstring = em1_7066 in
                                                                        {8797}let (=OpenSecureChannelRequest,=pkCli_7031,wNc_7068: bitstring) = m1_7067 in
                                                                        {8798}let Nc_7069: bitstring = dec(wNc_7068,skSess_6878) in
                                                                        {8799}new Ns_7070: bitstring;
                                                                        {8800}new ST_7071: bitstring;
                                                                        {8801}new TTL_7072: bitstring;
                                                                        {8802}let wNs_7073: bitstring = enc(Ns_7070,pkCli_7031) in
                                                                        {8803}let m2_7074: bitstring = (OpenSecureChannelResponse,wNs_7073,ST_7071,TTL_7072) in
                                                                        {8804}event beginSrv(Sess_5308,Cli_5306,Ns_7070);
                                                                        {8805}out(c, m2_7074);
                                                                        {8806}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                                                        {8807}event endSrv(Cli_5306,Sess_5308,Nc_7069)
                                                                )
                                                                else
                                                                    {8808}let pkDisco_7075: bitstring = fail-any in
                                                                    {8809}in(c, (=pkCli_7031,em1_7076: bitstring));
                                                                    {8810}let m1_7077: bitstring = em1_7076 in
                                                                    {8811}let (=OpenSecureChannelRequest,=pkCli_7031,wNc_7078: bitstring) = m1_7077 in
                                                                    {8812}let Nc_7079: bitstring = dec(wNc_7078,skSess_6878) in
                                                                    {8813}new Ns_7080: bitstring;
                                                                    {8814}new ST_7081: bitstring;
                                                                    {8815}new TTL_7082: bitstring;
                                                                    {8816}let wNs_7083: bitstring = enc(Ns_7080,pkCli_7031) in
                                                                    {8817}let m2_7084: bitstring = (OpenSecureChannelResponse,wNs_7083,ST_7081,TTL_7082) in
                                                                    {8818}event beginSrv(Sess_5308,Cli_5306,Ns_7080);
                                                                    {8819}out(c, m2_7084);
                                                                    {8820}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                                                    {8821}event endSrv(Cli_5306,Sess_5308,Nc_7079)
                                                        )
                                                        else
                                                            {8822}let pkDisco_7085: bitstring = fail-any in
                                                            {8823}in(c, (=pkCli_7031,em1_7086: bitstring));
                                                            {8824}let m1_7087: bitstring = em1_7086 in
                                                            {8825}let (=OpenSecureChannelRequest,=pkCli_7031,wNc_7088: bitstring) = m1_7087 in
                                                            {8826}let Nc_7089: bitstring = dec(wNc_7088,skSess_6878) in
                                                            {8827}new Ns_7090: bitstring;
                                                            {8828}new ST_7091: bitstring;
                                                            {8829}new TTL_7092: bitstring;
                                                            {8830}let wNs_7093: bitstring = enc(Ns_7090,pkCli_7031) in
                                                            {8831}let m2_7094: bitstring = (OpenSecureChannelResponse,wNs_7093,ST_7091,TTL_7092) in
                                                            {8832}event beginSrv(Sess_5308,Cli_5306,Ns_7090);
                                                            {8833}out(c, m2_7094);
                                                            {8834}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                                            {8835}event endSrv(Cli_5306,Sess_5308,Nc_7089)
                                                )
                                                else
                                                    {8836}let pkDisco_7095: bitstring = fail-any in
                                                    {8837}in(c, (=pkCli_7031,em1_7096: bitstring));
                                                    {8838}let m1_7097: bitstring = em1_7096 in
                                                    {8839}let (=OpenSecureChannelRequest,=pkCli_7031,wNc_7098: bitstring) = m1_7097 in
                                                    {8840}let Nc_7099: bitstring = dec(wNc_7098,skSess_6878) in
                                                    {8841}new Ns_7100: bitstring;
                                                    {8842}new ST_7101: bitstring;
                                                    {8843}new TTL_7102: bitstring;
                                                    {8844}let wNs_7103: bitstring = enc(Ns_7100,pkCli_7031) in
                                                    {8845}let m2_7104: bitstring = (OpenSecureChannelResponse,wNs_7103,ST_7101,TTL_7102) in
                                                    {8846}event beginSrv(Sess_5308,Cli_5306,Ns_7100);
                                                    {8847}out(c, m2_7104);
                                                    {8848}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                                    {8849}event endSrv(Cli_5306,Sess_5308,Nc_7099)
                                            )
                                            else
                                                {8850}let pkCli_7105: bitstring = pub(sk(Cli_5306)) in
                                                {8851}let v_7106: bool = (Disco_5307 = A) in
                                                (
                                                    {8852}if v_7106 then
                                                    (
                                                        {8853}let pkDisco_7107: bitstring = pub(skA) in
                                                        {8854}in(c, (=pkCli_7105,em1_7108: bitstring));
                                                        {8855}let m1_7109: bitstring = em1_7108 in
                                                        {8856}let (=OpenSecureChannelRequest,=pkCli_7105,wNc_7110: bitstring) = m1_7109 in
                                                        {8857}let Nc_7111: bitstring = dec(wNc_7110,skSess_6878) in
                                                        {8858}new Ns_7112: bitstring;
                                                        {8859}new ST_7113: bitstring;
                                                        {8860}new TTL_7114: bitstring;
                                                        {8861}let wNs_7115: bitstring = enc(Ns_7112,pkCli_7105) in
                                                        {8862}let m2_7116: bitstring = (OpenSecureChannelResponse,wNs_7115,ST_7113,TTL_7114) in
                                                        {8863}event beginSrv(Sess_5308,Cli_5306,Ns_7112);
                                                        {8864}out(c, m2_7116);
                                                        {8865}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                                        {8866}event endSrv(Cli_5306,Sess_5308,Nc_7111)
                                                    )
                                                    else
                                                        {8867}let v_7117: bool = (Disco_5307 = B) in
                                                        (
                                                            {8868}if v_7117 then
                                                            (
                                                                {8869}let pkDisco_7118: bitstring = pub(skB) in
                                                                {8870}in(c, (=pkCli_7105,em1_7119: bitstring));
                                                                {8871}let m1_7120: bitstring = em1_7119 in
                                                                {8872}let (=OpenSecureChannelRequest,=pkCli_7105,wNc_7121: bitstring) = m1_7120 in
                                                                {8873}let Nc_7122: bitstring = dec(wNc_7121,skSess_6878) in
                                                                {8874}new Ns_7123: bitstring;
                                                                {8875}new ST_7124: bitstring;
                                                                {8876}new TTL_7125: bitstring;
                                                                {8877}let wNs_7126: bitstring = enc(Ns_7123,pkCli_7105) in
                                                                {8878}let m2_7127: bitstring = (OpenSecureChannelResponse,wNs_7126,ST_7124,TTL_7125) in
                                                                {8879}event beginSrv(Sess_5308,Cli_5306,Ns_7123);
                                                                {8880}out(c, m2_7127);
                                                                {8881}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                                                {8882}event endSrv(Cli_5306,Sess_5308,Nc_7122)
                                                            )
                                                            else
                                                                {8883}let v_7128: bool = (Disco_5307 = C) in
                                                                (
                                                                    {8884}if v_7128 then
                                                                    (
                                                                        {8885}let pkDisco_7129: bitstring = pub(skC) in
                                                                        {8886}in(c, (=pkCli_7105,em1_7130: bitstring));
                                                                        {8887}let m1_7131: bitstring = em1_7130 in
                                                                        {8888}let (=OpenSecureChannelRequest,=pkCli_7105,wNc_7132: bitstring) = m1_7131 in
                                                                        {8889}let Nc_7133: bitstring = dec(wNc_7132,skSess_6878) in
                                                                        {8890}new Ns_7134: bitstring;
                                                                        {8891}new ST_7135: bitstring;
                                                                        {8892}new TTL_7136: bitstring;
                                                                        {8893}let wNs_7137: bitstring = enc(Ns_7134,pkCli_7105) in
                                                                        {8894}let m2_7138: bitstring = (OpenSecureChannelResponse,wNs_7137,ST_7135,TTL_7136) in
                                                                        {8895}event beginSrv(Sess_5308,Cli_5306,Ns_7134);
                                                                        {8896}out(c, m2_7138);
                                                                        {8897}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                                                        {8898}event endSrv(Cli_5306,Sess_5308,Nc_7133)
                                                                    )
                                                                    else
                                                                        {8899}let pkDisco_7139: bitstring = pub(sk(Disco_5307)) in
                                                                        {8900}in(c, (=pkCli_7105,em1_7140: bitstring));
                                                                        {8901}let m1_7141: bitstring = em1_7140 in
                                                                        {8902}let (=OpenSecureChannelRequest,=pkCli_7105,wNc_7142: bitstring) = m1_7141 in
                                                                        {8903}let Nc_7143: bitstring = dec(wNc_7142,skSess_6878) in
                                                                        {8904}new Ns_7144: bitstring;
                                                                        {8905}new ST_7145: bitstring;
                                                                        {8906}new TTL_7146: bitstring;
                                                                        {8907}let wNs_7147: bitstring = enc(Ns_7144,pkCli_7105) in
                                                                        {8908}let m2_7148: bitstring = (OpenSecureChannelResponse,wNs_7147,ST_7145,TTL_7146) in
                                                                        {8909}event beginSrv(Sess_5308,Cli_5306,Ns_7144);
                                                                        {8910}out(c, m2_7148);
                                                                        {8911}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                                                        {8912}event endSrv(Cli_5306,Sess_5308,Nc_7143)
                                                                )
                                                                else
                                                                    {8913}let pkDisco_7149: bitstring = fail-any in
                                                                    {8914}in(c, (=pkCli_7105,em1_7150: bitstring));
                                                                    {8915}let m1_7151: bitstring = em1_7150 in
                                                                    {8916}let (=OpenSecureChannelRequest,=pkCli_7105,wNc_7152: bitstring) = m1_7151 in
                                                                    {8917}let Nc_7153: bitstring = dec(wNc_7152,skSess_6878) in
                                                                    {8918}new Ns_7154: bitstring;
                                                                    {8919}new ST_7155: bitstring;
                                                                    {8920}new TTL_7156: bitstring;
                                                                    {8921}let wNs_7157: bitstring = enc(Ns_7154,pkCli_7105) in
                                                                    {8922}let m2_7158: bitstring = (OpenSecureChannelResponse,wNs_7157,ST_7155,TTL_7156) in
                                                                    {8923}event beginSrv(Sess_5308,Cli_5306,Ns_7154);
                                                                    {8924}out(c, m2_7158);
                                                                    {8925}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                                                    {8926}event endSrv(Cli_5306,Sess_5308,Nc_7153)
                                                        )
                                                        else
                                                            {8927}let pkDisco_7159: bitstring = fail-any in
                                                            {8928}in(c, (=pkCli_7105,em1_7160: bitstring));
                                                            {8929}let m1_7161: bitstring = em1_7160 in
                                                            {8930}let (=OpenSecureChannelRequest,=pkCli_7105,wNc_7162: bitstring) = m1_7161 in
                                                            {8931}let Nc_7163: bitstring = dec(wNc_7162,skSess_6878) in
                                                            {8932}new Ns_7164: bitstring;
                                                            {8933}new ST_7165: bitstring;
                                                            {8934}new TTL_7166: bitstring;
                                                            {8935}let wNs_7167: bitstring = enc(Ns_7164,pkCli_7105) in
                                                            {8936}let m2_7168: bitstring = (OpenSecureChannelResponse,wNs_7167,ST_7165,TTL_7166) in
                                                            {8937}event beginSrv(Sess_5308,Cli_5306,Ns_7164);
                                                            {8938}out(c, m2_7168);
                                                            {8939}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                                            {8940}event endSrv(Cli_5306,Sess_5308,Nc_7163)
                                                )
                                                else
                                                    {8941}let pkDisco_7169: bitstring = fail-any in
                                                    {8942}in(c, (=pkCli_7105,em1_7170: bitstring));
                                                    {8943}let m1_7171: bitstring = em1_7170 in
                                                    {8944}let (=OpenSecureChannelRequest,=pkCli_7105,wNc_7172: bitstring) = m1_7171 in
                                                    {8945}let Nc_7173: bitstring = dec(wNc_7172,skSess_6878) in
                                                    {8946}new Ns_7174: bitstring;
                                                    {8947}new ST_7175: bitstring;
                                                    {8948}new TTL_7176: bitstring;
                                                    {8949}let wNs_7177: bitstring = enc(Ns_7174,pkCli_7105) in
                                                    {8950}let m2_7178: bitstring = (OpenSecureChannelResponse,wNs_7177,ST_7175,TTL_7176) in
                                                    {8951}event beginSrv(Sess_5308,Cli_5306,Ns_7174);
                                                    {8952}out(c, m2_7178);
                                                    {8953}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                                    {8954}event endSrv(Cli_5306,Sess_5308,Nc_7173)
                                        )
                                        else
                                            {8955}let pkCli_7179: bitstring = fail-any in
                                            {8956}let v_7180: bool = (Disco_5307 = A) in
                                            (
                                                {8957}if v_7180 then
                                                (
                                                    {8958}let pkDisco_7181: bitstring = pub(skA) in
                                                    {8959}in(c, (=pkCli_7179,em1_7182: bitstring));
                                                    {8960}let m1_7183: bitstring = em1_7182 in
                                                    {8961}let (=OpenSecureChannelRequest,=pkCli_7179,wNc_7184: bitstring) = m1_7183 in
                                                    {8962}let Nc_7185: bitstring = dec(wNc_7184,skSess_6878) in
                                                    {8963}new Ns_7186: bitstring;
                                                    {8964}new ST_7187: bitstring;
                                                    {8965}new TTL_7188: bitstring;
                                                    {8966}let wNs_7189: bitstring = enc(Ns_7186,pkCli_7179) in
                                                    {8967}let m2_7190: bitstring = (OpenSecureChannelResponse,wNs_7189,ST_7187,TTL_7188) in
                                                    {8968}event beginSrv(Sess_5308,Cli_5306,Ns_7186);
                                                    {8969}out(c, m2_7190);
                                                    {8970}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                                    {8971}event endSrv(Cli_5306,Sess_5308,Nc_7185)
                                                )
                                                else
                                                    {8972}let v_7191: bool = (Disco_5307 = B) in
                                                    (
                                                        {8973}if v_7191 then
                                                        (
                                                            {8974}let pkDisco_7192: bitstring = pub(skB) in
                                                            {8975}in(c, (=pkCli_7179,em1_7193: bitstring));
                                                            {8976}let m1_7194: bitstring = em1_7193 in
                                                            {8977}let (=OpenSecureChannelRequest,=pkCli_7179,wNc_7195: bitstring) = m1_7194 in
                                                            {8978}let Nc_7196: bitstring = dec(wNc_7195,skSess_6878) in
                                                            {8979}new Ns_7197: bitstring;
                                                            {8980}new ST_7198: bitstring;
                                                            {8981}new TTL_7199: bitstring;
                                                            {8982}let wNs_7200: bitstring = enc(Ns_7197,pkCli_7179) in
                                                            {8983}let m2_7201: bitstring = (OpenSecureChannelResponse,wNs_7200,ST_7198,TTL_7199) in
                                                            {8984}event beginSrv(Sess_5308,Cli_5306,Ns_7197);
                                                            {8985}out(c, m2_7201);
                                                            {8986}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                                            {8987}event endSrv(Cli_5306,Sess_5308,Nc_7196)
                                                        )
                                                        else
                                                            {8988}let v_7202: bool = (Disco_5307 = C) in
                                                            (
                                                                {8989}if v_7202 then
                                                                (
                                                                    {8990}let pkDisco_7203: bitstring = pub(skC) in
                                                                    {8991}in(c, (=pkCli_7179,em1_7204: bitstring));
                                                                    {8992}let m1_7205: bitstring = em1_7204 in
                                                                    {8993}let (=OpenSecureChannelRequest,=pkCli_7179,wNc_7206: bitstring) = m1_7205 in
                                                                    {8994}let Nc_7207: bitstring = dec(wNc_7206,skSess_6878) in
                                                                    {8995}new Ns_7208: bitstring;
                                                                    {8996}new ST_7209: bitstring;
                                                                    {8997}new TTL_7210: bitstring;
                                                                    {8998}let wNs_7211: bitstring = enc(Ns_7208,pkCli_7179) in
                                                                    {8999}let m2_7212: bitstring = (OpenSecureChannelResponse,wNs_7211,ST_7209,TTL_7210) in
                                                                    {9000}event beginSrv(Sess_5308,Cli_5306,Ns_7208);
                                                                    {9001}out(c, m2_7212);
                                                                    {9002}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                                                    {9003}event endSrv(Cli_5306,Sess_5308,Nc_7207)
                                                                )
                                                                else
                                                                    {9004}let pkDisco_7213: bitstring = pub(sk(Disco_5307)) in
                                                                    {9005}in(c, (=pkCli_7179,em1_7214: bitstring));
                                                                    {9006}let m1_7215: bitstring = em1_7214 in
                                                                    {9007}let (=OpenSecureChannelRequest,=pkCli_7179,wNc_7216: bitstring) = m1_7215 in
                                                                    {9008}let Nc_7217: bitstring = dec(wNc_7216,skSess_6878) in
                                                                    {9009}new Ns_7218: bitstring;
                                                                    {9010}new ST_7219: bitstring;
                                                                    {9011}new TTL_7220: bitstring;
                                                                    {9012}let wNs_7221: bitstring = enc(Ns_7218,pkCli_7179) in
                                                                    {9013}let m2_7222: bitstring = (OpenSecureChannelResponse,wNs_7221,ST_7219,TTL_7220) in
                                                                    {9014}event beginSrv(Sess_5308,Cli_5306,Ns_7218);
                                                                    {9015}out(c, m2_7222);
                                                                    {9016}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                                                    {9017}event endSrv(Cli_5306,Sess_5308,Nc_7217)
                                                            )
                                                            else
                                                                {9018}let pkDisco_7223: bitstring = fail-any in
                                                                {9019}in(c, (=pkCli_7179,em1_7224: bitstring));
                                                                {9020}let m1_7225: bitstring = em1_7224 in
                                                                {9021}let (=OpenSecureChannelRequest,=pkCli_7179,wNc_7226: bitstring) = m1_7225 in
                                                                {9022}let Nc_7227: bitstring = dec(wNc_7226,skSess_6878) in
                                                                {9023}new Ns_7228: bitstring;
                                                                {9024}new ST_7229: bitstring;
                                                                {9025}new TTL_7230: bitstring;
                                                                {9026}let wNs_7231: bitstring = enc(Ns_7228,pkCli_7179) in
                                                                {9027}let m2_7232: bitstring = (OpenSecureChannelResponse,wNs_7231,ST_7229,TTL_7230) in
                                                                {9028}event beginSrv(Sess_5308,Cli_5306,Ns_7228);
                                                                {9029}out(c, m2_7232);
                                                                {9030}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                                                {9031}event endSrv(Cli_5306,Sess_5308,Nc_7227)
                                                    )
                                                    else
                                                        {9032}let pkDisco_7233: bitstring = fail-any in
                                                        {9033}in(c, (=pkCli_7179,em1_7234: bitstring));
                                                        {9034}let m1_7235: bitstring = em1_7234 in
                                                        {9035}let (=OpenSecureChannelRequest,=pkCli_7179,wNc_7236: bitstring) = m1_7235 in
                                                        {9036}let Nc_7237: bitstring = dec(wNc_7236,skSess_6878) in
                                                        {9037}new Ns_7238: bitstring;
                                                        {9038}new ST_7239: bitstring;
                                                        {9039}new TTL_7240: bitstring;
                                                        {9040}let wNs_7241: bitstring = enc(Ns_7238,pkCli_7179) in
                                                        {9041}let m2_7242: bitstring = (OpenSecureChannelResponse,wNs_7241,ST_7239,TTL_7240) in
                                                        {9042}event beginSrv(Sess_5308,Cli_5306,Ns_7238);
                                                        {9043}out(c, m2_7242);
                                                        {9044}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                                        {9045}event endSrv(Cli_5306,Sess_5308,Nc_7237)
                                            )
                                            else
                                                {9046}let pkDisco_7243: bitstring = fail-any in
                                                {9047}in(c, (=pkCli_7179,em1_7244: bitstring));
                                                {9048}let m1_7245: bitstring = em1_7244 in
                                                {9049}let (=OpenSecureChannelRequest,=pkCli_7179,wNc_7246: bitstring) = m1_7245 in
                                                {9050}let Nc_7247: bitstring = dec(wNc_7246,skSess_6878) in
                                                {9051}new Ns_7248: bitstring;
                                                {9052}new ST_7249: bitstring;
                                                {9053}new TTL_7250: bitstring;
                                                {9054}let wNs_7251: bitstring = enc(Ns_7248,pkCli_7179) in
                                                {9055}let m2_7252: bitstring = (OpenSecureChannelResponse,wNs_7251,ST_7249,TTL_7250) in
                                                {9056}event beginSrv(Sess_5308,Cli_5306,Ns_7248);
                                                {9057}out(c, m2_7252);
                                                {9058}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                                {9059}event endSrv(Cli_5306,Sess_5308,Nc_7247)
                                )
                                else
                                    {9060}let pkCli_7253: bitstring = fail-any in
                                    {9061}let v_7254: bool = (Disco_5307 = A) in
                                    (
                                        {9062}if v_7254 then
                                        (
                                            {9063}let pkDisco_7255: bitstring = pub(skA) in
                                            {9064}in(c, (=pkCli_7253,em1_7256: bitstring));
                                            {9065}let m1_7257: bitstring = em1_7256 in
                                            {9066}let (=OpenSecureChannelRequest,=pkCli_7253,wNc_7258: bitstring) = m1_7257 in
                                            {9067}let Nc_7259: bitstring = dec(wNc_7258,skSess_6878) in
                                            {9068}new Ns_7260: bitstring;
                                            {9069}new ST_7261: bitstring;
                                            {9070}new TTL_7262: bitstring;
                                            {9071}let wNs_7263: bitstring = enc(Ns_7260,pkCli_7253) in
                                            {9072}let m2_7264: bitstring = (OpenSecureChannelResponse,wNs_7263,ST_7261,TTL_7262) in
                                            {9073}event beginSrv(Sess_5308,Cli_5306,Ns_7260);
                                            {9074}out(c, m2_7264);
                                            {9075}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                            {9076}event endSrv(Cli_5306,Sess_5308,Nc_7259)
                                        )
                                        else
                                            {9077}let v_7265: bool = (Disco_5307 = B) in
                                            (
                                                {9078}if v_7265 then
                                                (
                                                    {9079}let pkDisco_7266: bitstring = pub(skB) in
                                                    {9080}in(c, (=pkCli_7253,em1_7267: bitstring));
                                                    {9081}let m1_7268: bitstring = em1_7267 in
                                                    {9082}let (=OpenSecureChannelRequest,=pkCli_7253,wNc_7269: bitstring) = m1_7268 in
                                                    {9083}let Nc_7270: bitstring = dec(wNc_7269,skSess_6878) in
                                                    {9084}new Ns_7271: bitstring;
                                                    {9085}new ST_7272: bitstring;
                                                    {9086}new TTL_7273: bitstring;
                                                    {9087}let wNs_7274: bitstring = enc(Ns_7271,pkCli_7253) in
                                                    {9088}let m2_7275: bitstring = (OpenSecureChannelResponse,wNs_7274,ST_7272,TTL_7273) in
                                                    {9089}event beginSrv(Sess_5308,Cli_5306,Ns_7271);
                                                    {9090}out(c, m2_7275);
                                                    {9091}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                                    {9092}event endSrv(Cli_5306,Sess_5308,Nc_7270)
                                                )
                                                else
                                                    {9093}let v_7276: bool = (Disco_5307 = C) in
                                                    (
                                                        {9094}if v_7276 then
                                                        (
                                                            {9095}let pkDisco_7277: bitstring = pub(skC) in
                                                            {9096}in(c, (=pkCli_7253,em1_7278: bitstring));
                                                            {9097}let m1_7279: bitstring = em1_7278 in
                                                            {9098}let (=OpenSecureChannelRequest,=pkCli_7253,wNc_7280: bitstring) = m1_7279 in
                                                            {9099}let Nc_7281: bitstring = dec(wNc_7280,skSess_6878) in
                                                            {9100}new Ns_7282: bitstring;
                                                            {9101}new ST_7283: bitstring;
                                                            {9102}new TTL_7284: bitstring;
                                                            {9103}let wNs_7285: bitstring = enc(Ns_7282,pkCli_7253) in
                                                            {9104}let m2_7286: bitstring = (OpenSecureChannelResponse,wNs_7285,ST_7283,TTL_7284) in
                                                            {9105}event beginSrv(Sess_5308,Cli_5306,Ns_7282);
                                                            {9106}out(c, m2_7286);
                                                            {9107}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                                            {9108}event endSrv(Cli_5306,Sess_5308,Nc_7281)
                                                        )
                                                        else
                                                            {9109}let pkDisco_7287: bitstring = pub(sk(Disco_5307)) in
                                                            {9110}in(c, (=pkCli_7253,em1_7288: bitstring));
                                                            {9111}let m1_7289: bitstring = em1_7288 in
                                                            {9112}let (=OpenSecureChannelRequest,=pkCli_7253,wNc_7290: bitstring) = m1_7289 in
                                                            {9113}let Nc_7291: bitstring = dec(wNc_7290,skSess_6878) in
                                                            {9114}new Ns_7292: bitstring;
                                                            {9115}new ST_7293: bitstring;
                                                            {9116}new TTL_7294: bitstring;
                                                            {9117}let wNs_7295: bitstring = enc(Ns_7292,pkCli_7253) in
                                                            {9118}let m2_7296: bitstring = (OpenSecureChannelResponse,wNs_7295,ST_7293,TTL_7294) in
                                                            {9119}event beginSrv(Sess_5308,Cli_5306,Ns_7292);
                                                            {9120}out(c, m2_7296);
                                                            {9121}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                                            {9122}event endSrv(Cli_5306,Sess_5308,Nc_7291)
                                                    )
                                                    else
                                                        {9123}let pkDisco_7297: bitstring = fail-any in
                                                        {9124}in(c, (=pkCli_7253,em1_7298: bitstring));
                                                        {9125}let m1_7299: bitstring = em1_7298 in
                                                        {9126}let (=OpenSecureChannelRequest,=pkCli_7253,wNc_7300: bitstring) = m1_7299 in
                                                        {9127}let Nc_7301: bitstring = dec(wNc_7300,skSess_6878) in
                                                        {9128}new Ns_7302: bitstring;
                                                        {9129}new ST_7303: bitstring;
                                                        {9130}new TTL_7304: bitstring;
                                                        {9131}let wNs_7305: bitstring = enc(Ns_7302,pkCli_7253) in
                                                        {9132}let m2_7306: bitstring = (OpenSecureChannelResponse,wNs_7305,ST_7303,TTL_7304) in
                                                        {9133}event beginSrv(Sess_5308,Cli_5306,Ns_7302);
                                                        {9134}out(c, m2_7306);
                                                        {9135}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                                        {9136}event endSrv(Cli_5306,Sess_5308,Nc_7301)
                                            )
                                            else
                                                {9137}let pkDisco_7307: bitstring = fail-any in
                                                {9138}in(c, (=pkCli_7253,em1_7308: bitstring));
                                                {9139}let m1_7309: bitstring = em1_7308 in
                                                {9140}let (=OpenSecureChannelRequest,=pkCli_7253,wNc_7310: bitstring) = m1_7309 in
                                                {9141}let Nc_7311: bitstring = dec(wNc_7310,skSess_6878) in
                                                {9142}new Ns_7312: bitstring;
                                                {9143}new ST_7313: bitstring;
                                                {9144}new TTL_7314: bitstring;
                                                {9145}let wNs_7315: bitstring = enc(Ns_7312,pkCli_7253) in
                                                {9146}let m2_7316: bitstring = (OpenSecureChannelResponse,wNs_7315,ST_7313,TTL_7314) in
                                                {9147}event beginSrv(Sess_5308,Cli_5306,Ns_7312);
                                                {9148}out(c, m2_7316);
                                                {9149}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                                {9150}event endSrv(Cli_5306,Sess_5308,Nc_7311)
                                    )
                                    else
                                        {9151}let pkDisco_7317: bitstring = fail-any in
                                        {9152}in(c, (=pkCli_7253,em1_7318: bitstring));
                                        {9153}let m1_7319: bitstring = em1_7318 in
                                        {9154}let (=OpenSecureChannelRequest,=pkCli_7253,wNc_7320: bitstring) = m1_7319 in
                                        {9155}let Nc_7321: bitstring = dec(wNc_7320,skSess_6878) in
                                        {9156}new Ns_7322: bitstring;
                                        {9157}new ST_7323: bitstring;
                                        {9158}new TTL_7324: bitstring;
                                        {9159}let wNs_7325: bitstring = enc(Ns_7322,pkCli_7253) in
                                        {9160}let m2_7326: bitstring = (OpenSecureChannelResponse,wNs_7325,ST_7323,TTL_7324) in
                                        {9161}event beginSrv(Sess_5308,Cli_5306,Ns_7322);
                                        {9162}out(c, m2_7326);
                                        {9163}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                        {9164}event endSrv(Cli_5306,Sess_5308,Nc_7321)
                        )
                        else
                            {9165}let pkCli_7327: bitstring = fail-any in
                            {9166}let v_7328: bool = (Disco_5307 = A) in
                            (
                                {9167}if v_7328 then
                                (
                                    {9168}let pkDisco_7329: bitstring = pub(skA) in
                                    {9169}in(c, (=pkCli_7327,em1_7330: bitstring));
                                    {9170}let m1_7331: bitstring = em1_7330 in
                                    {9171}let (=OpenSecureChannelRequest,=pkCli_7327,wNc_7332: bitstring) = m1_7331 in
                                    {9172}let Nc_7333: bitstring = dec(wNc_7332,skSess_6878) in
                                    {9173}new Ns_7334: bitstring;
                                    {9174}new ST_7335: bitstring;
                                    {9175}new TTL_7336: bitstring;
                                    {9176}let wNs_7337: bitstring = enc(Ns_7334,pkCli_7327) in
                                    {9177}let m2_7338: bitstring = (OpenSecureChannelResponse,wNs_7337,ST_7335,TTL_7336) in
                                    {9178}event beginSrv(Sess_5308,Cli_5306,Ns_7334);
                                    {9179}out(c, m2_7338);
                                    {9180}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                    {9181}event endSrv(Cli_5306,Sess_5308,Nc_7333)
                                )
                                else
                                    {9182}let v_7339: bool = (Disco_5307 = B) in
                                    (
                                        {9183}if v_7339 then
                                        (
                                            {9184}let pkDisco_7340: bitstring = pub(skB) in
                                            {9185}in(c, (=pkCli_7327,em1_7341: bitstring));
                                            {9186}let m1_7342: bitstring = em1_7341 in
                                            {9187}let (=OpenSecureChannelRequest,=pkCli_7327,wNc_7343: bitstring) = m1_7342 in
                                            {9188}let Nc_7344: bitstring = dec(wNc_7343,skSess_6878) in
                                            {9189}new Ns_7345: bitstring;
                                            {9190}new ST_7346: bitstring;
                                            {9191}new TTL_7347: bitstring;
                                            {9192}let wNs_7348: bitstring = enc(Ns_7345,pkCli_7327) in
                                            {9193}let m2_7349: bitstring = (OpenSecureChannelResponse,wNs_7348,ST_7346,TTL_7347) in
                                            {9194}event beginSrv(Sess_5308,Cli_5306,Ns_7345);
                                            {9195}out(c, m2_7349);
                                            {9196}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                            {9197}event endSrv(Cli_5306,Sess_5308,Nc_7344)
                                        )
                                        else
                                            {9198}let v_7350: bool = (Disco_5307 = C) in
                                            (
                                                {9199}if v_7350 then
                                                (
                                                    {9200}let pkDisco_7351: bitstring = pub(skC) in
                                                    {9201}in(c, (=pkCli_7327,em1_7352: bitstring));
                                                    {9202}let m1_7353: bitstring = em1_7352 in
                                                    {9203}let (=OpenSecureChannelRequest,=pkCli_7327,wNc_7354: bitstring) = m1_7353 in
                                                    {9204}let Nc_7355: bitstring = dec(wNc_7354,skSess_6878) in
                                                    {9205}new Ns_7356: bitstring;
                                                    {9206}new ST_7357: bitstring;
                                                    {9207}new TTL_7358: bitstring;
                                                    {9208}let wNs_7359: bitstring = enc(Ns_7356,pkCli_7327) in
                                                    {9209}let m2_7360: bitstring = (OpenSecureChannelResponse,wNs_7359,ST_7357,TTL_7358) in
                                                    {9210}event beginSrv(Sess_5308,Cli_5306,Ns_7356);
                                                    {9211}out(c, m2_7360);
                                                    {9212}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                                    {9213}event endSrv(Cli_5306,Sess_5308,Nc_7355)
                                                )
                                                else
                                                    {9214}let pkDisco_7361: bitstring = pub(sk(Disco_5307)) in
                                                    {9215}in(c, (=pkCli_7327,em1_7362: bitstring));
                                                    {9216}let m1_7363: bitstring = em1_7362 in
                                                    {9217}let (=OpenSecureChannelRequest,=pkCli_7327,wNc_7364: bitstring) = m1_7363 in
                                                    {9218}let Nc_7365: bitstring = dec(wNc_7364,skSess_6878) in
                                                    {9219}new Ns_7366: bitstring;
                                                    {9220}new ST_7367: bitstring;
                                                    {9221}new TTL_7368: bitstring;
                                                    {9222}let wNs_7369: bitstring = enc(Ns_7366,pkCli_7327) in
                                                    {9223}let m2_7370: bitstring = (OpenSecureChannelResponse,wNs_7369,ST_7367,TTL_7368) in
                                                    {9224}event beginSrv(Sess_5308,Cli_5306,Ns_7366);
                                                    {9225}out(c, m2_7370);
                                                    {9226}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                                    {9227}event endSrv(Cli_5306,Sess_5308,Nc_7365)
                                            )
                                            else
                                                {9228}let pkDisco_7371: bitstring = fail-any in
                                                {9229}in(c, (=pkCli_7327,em1_7372: bitstring));
                                                {9230}let m1_7373: bitstring = em1_7372 in
                                                {9231}let (=OpenSecureChannelRequest,=pkCli_7327,wNc_7374: bitstring) = m1_7373 in
                                                {9232}let Nc_7375: bitstring = dec(wNc_7374,skSess_6878) in
                                                {9233}new Ns_7376: bitstring;
                                                {9234}new ST_7377: bitstring;
                                                {9235}new TTL_7378: bitstring;
                                                {9236}let wNs_7379: bitstring = enc(Ns_7376,pkCli_7327) in
                                                {9237}let m2_7380: bitstring = (OpenSecureChannelResponse,wNs_7379,ST_7377,TTL_7378) in
                                                {9238}event beginSrv(Sess_5308,Cli_5306,Ns_7376);
                                                {9239}out(c, m2_7380);
                                                {9240}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                                {9241}event endSrv(Cli_5306,Sess_5308,Nc_7375)
                                    )
                                    else
                                        {9242}let pkDisco_7381: bitstring = fail-any in
                                        {9243}in(c, (=pkCli_7327,em1_7382: bitstring));
                                        {9244}let m1_7383: bitstring = em1_7382 in
                                        {9245}let (=OpenSecureChannelRequest,=pkCli_7327,wNc_7384: bitstring) = m1_7383 in
                                        {9246}let Nc_7385: bitstring = dec(wNc_7384,skSess_6878) in
                                        {9247}new Ns_7386: bitstring;
                                        {9248}new ST_7387: bitstring;
                                        {9249}new TTL_7388: bitstring;
                                        {9250}let wNs_7389: bitstring = enc(Ns_7386,pkCli_7327) in
                                        {9251}let m2_7390: bitstring = (OpenSecureChannelResponse,wNs_7389,ST_7387,TTL_7388) in
                                        {9252}event beginSrv(Sess_5308,Cli_5306,Ns_7386);
                                        {9253}out(c, m2_7390);
                                        {9254}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                        {9255}event endSrv(Cli_5306,Sess_5308,Nc_7385)
                            )
                            else
                                {9256}let pkDisco_7391: bitstring = fail-any in
                                {9257}in(c, (=pkCli_7327,em1_7392: bitstring));
                                {9258}let m1_7393: bitstring = em1_7392 in
                                {9259}let (=OpenSecureChannelRequest,=pkCli_7327,wNc_7394: bitstring) = m1_7393 in
                                {9260}let Nc_7395: bitstring = dec(wNc_7394,skSess_6878) in
                                {9261}new Ns_7396: bitstring;
                                {9262}new ST_7397: bitstring;
                                {9263}new TTL_7398: bitstring;
                                {9264}let wNs_7399: bitstring = enc(Ns_7396,pkCli_7327) in
                                {9265}let m2_7400: bitstring = (OpenSecureChannelResponse,wNs_7399,ST_7397,TTL_7398) in
                                {9266}event beginSrv(Sess_5308,Cli_5306,Ns_7396);
                                {9267}out(c, m2_7400);
                                {9268}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                {9269}event endSrv(Cli_5306,Sess_5308,Nc_7395)
            )
            else
                {9270}let skSess_7401: bitstring = fail-any in
                {9271}let pkSess_7402: bitstring = pub(skSess_7401) in
                {9272}let v_7403: bool = (Cli_5306 = A) in
                (
                    {9273}if v_7403 then
                    (
                        {9274}let pkCli_7404: bitstring = pub(skA) in
                        {9275}let v_7405: bool = (Disco_5307 = A) in
                        (
                            {9276}if v_7405 then
                            (
                                {9277}let pkDisco_7406: bitstring = pub(skA) in
                                {9278}in(c, (=pkCli_7404,em1_7407: bitstring));
                                {9279}let m1_7408: bitstring = em1_7407 in
                                {9280}let (=OpenSecureChannelRequest,=pkCli_7404,wNc_7409: bitstring) = m1_7408 in
                                {9281}let Nc_7410: bitstring = dec(wNc_7409,skSess_7401) in
                                {9282}new Ns_7411: bitstring;
                                {9283}new ST_7412: bitstring;
                                {9284}new TTL_7413: bitstring;
                                {9285}let wNs_7414: bitstring = enc(Ns_7411,pkCli_7404) in
                                {9286}let m2_7415: bitstring = (OpenSecureChannelResponse,wNs_7414,ST_7412,TTL_7413) in
                                {9287}event beginSrv(Sess_5308,Cli_5306,Ns_7411);
                                {9288}out(c, m2_7415);
                                {9289}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                {9290}event endSrv(Cli_5306,Sess_5308,Nc_7410)
                            )
                            else
                                {9291}let v_7416: bool = (Disco_5307 = B) in
                                (
                                    {9292}if v_7416 then
                                    (
                                        {9293}let pkDisco_7417: bitstring = pub(skB) in
                                        {9294}in(c, (=pkCli_7404,em1_7418: bitstring));
                                        {9295}let m1_7419: bitstring = em1_7418 in
                                        {9296}let (=OpenSecureChannelRequest,=pkCli_7404,wNc_7420: bitstring) = m1_7419 in
                                        {9297}let Nc_7421: bitstring = dec(wNc_7420,skSess_7401) in
                                        {9298}new Ns_7422: bitstring;
                                        {9299}new ST_7423: bitstring;
                                        {9300}new TTL_7424: bitstring;
                                        {9301}let wNs_7425: bitstring = enc(Ns_7422,pkCli_7404) in
                                        {9302}let m2_7426: bitstring = (OpenSecureChannelResponse,wNs_7425,ST_7423,TTL_7424) in
                                        {9303}event beginSrv(Sess_5308,Cli_5306,Ns_7422);
                                        {9304}out(c, m2_7426);
                                        {9305}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                        {9306}event endSrv(Cli_5306,Sess_5308,Nc_7421)
                                    )
                                    else
                                        {9307}let v_7427: bool = (Disco_5307 = C) in
                                        (
                                            {9308}if v_7427 then
                                            (
                                                {9309}let pkDisco_7428: bitstring = pub(skC) in
                                                {9310}in(c, (=pkCli_7404,em1_7429: bitstring));
                                                {9311}let m1_7430: bitstring = em1_7429 in
                                                {9312}let (=OpenSecureChannelRequest,=pkCli_7404,wNc_7431: bitstring) = m1_7430 in
                                                {9313}let Nc_7432: bitstring = dec(wNc_7431,skSess_7401) in
                                                {9314}new Ns_7433: bitstring;
                                                {9315}new ST_7434: bitstring;
                                                {9316}new TTL_7435: bitstring;
                                                {9317}let wNs_7436: bitstring = enc(Ns_7433,pkCli_7404) in
                                                {9318}let m2_7437: bitstring = (OpenSecureChannelResponse,wNs_7436,ST_7434,TTL_7435) in
                                                {9319}event beginSrv(Sess_5308,Cli_5306,Ns_7433);
                                                {9320}out(c, m2_7437);
                                                {9321}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                                {9322}event endSrv(Cli_5306,Sess_5308,Nc_7432)
                                            )
                                            else
                                                {9323}let pkDisco_7438: bitstring = pub(sk(Disco_5307)) in
                                                {9324}in(c, (=pkCli_7404,em1_7439: bitstring));
                                                {9325}let m1_7440: bitstring = em1_7439 in
                                                {9326}let (=OpenSecureChannelRequest,=pkCli_7404,wNc_7441: bitstring) = m1_7440 in
                                                {9327}let Nc_7442: bitstring = dec(wNc_7441,skSess_7401) in
                                                {9328}new Ns_7443: bitstring;
                                                {9329}new ST_7444: bitstring;
                                                {9330}new TTL_7445: bitstring;
                                                {9331}let wNs_7446: bitstring = enc(Ns_7443,pkCli_7404) in
                                                {9332}let m2_7447: bitstring = (OpenSecureChannelResponse,wNs_7446,ST_7444,TTL_7445) in
                                                {9333}event beginSrv(Sess_5308,Cli_5306,Ns_7443);
                                                {9334}out(c, m2_7447);
                                                {9335}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                                {9336}event endSrv(Cli_5306,Sess_5308,Nc_7442)
                                        )
                                        else
                                            {9337}let pkDisco_7448: bitstring = fail-any in
                                            {9338}in(c, (=pkCli_7404,em1_7449: bitstring));
                                            {9339}let m1_7450: bitstring = em1_7449 in
                                            {9340}let (=OpenSecureChannelRequest,=pkCli_7404,wNc_7451: bitstring) = m1_7450 in
                                            {9341}let Nc_7452: bitstring = dec(wNc_7451,skSess_7401) in
                                            {9342}new Ns_7453: bitstring;
                                            {9343}new ST_7454: bitstring;
                                            {9344}new TTL_7455: bitstring;
                                            {9345}let wNs_7456: bitstring = enc(Ns_7453,pkCli_7404) in
                                            {9346}let m2_7457: bitstring = (OpenSecureChannelResponse,wNs_7456,ST_7454,TTL_7455) in
                                            {9347}event beginSrv(Sess_5308,Cli_5306,Ns_7453);
                                            {9348}out(c, m2_7457);
                                            {9349}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                            {9350}event endSrv(Cli_5306,Sess_5308,Nc_7452)
                                )
                                else
                                    {9351}let pkDisco_7458: bitstring = fail-any in
                                    {9352}in(c, (=pkCli_7404,em1_7459: bitstring));
                                    {9353}let m1_7460: bitstring = em1_7459 in
                                    {9354}let (=OpenSecureChannelRequest,=pkCli_7404,wNc_7461: bitstring) = m1_7460 in
                                    {9355}let Nc_7462: bitstring = dec(wNc_7461,skSess_7401) in
                                    {9356}new Ns_7463: bitstring;
                                    {9357}new ST_7464: bitstring;
                                    {9358}new TTL_7465: bitstring;
                                    {9359}let wNs_7466: bitstring = enc(Ns_7463,pkCli_7404) in
                                    {9360}let m2_7467: bitstring = (OpenSecureChannelResponse,wNs_7466,ST_7464,TTL_7465) in
                                    {9361}event beginSrv(Sess_5308,Cli_5306,Ns_7463);
                                    {9362}out(c, m2_7467);
                                    {9363}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                    {9364}event endSrv(Cli_5306,Sess_5308,Nc_7462)
                        )
                        else
                            {9365}let pkDisco_7468: bitstring = fail-any in
                            {9366}in(c, (=pkCli_7404,em1_7469: bitstring));
                            {9367}let m1_7470: bitstring = em1_7469 in
                            {9368}let (=OpenSecureChannelRequest,=pkCli_7404,wNc_7471: bitstring) = m1_7470 in
                            {9369}let Nc_7472: bitstring = dec(wNc_7471,skSess_7401) in
                            {9370}new Ns_7473: bitstring;
                            {9371}new ST_7474: bitstring;
                            {9372}new TTL_7475: bitstring;
                            {9373}let wNs_7476: bitstring = enc(Ns_7473,pkCli_7404) in
                            {9374}let m2_7477: bitstring = (OpenSecureChannelResponse,wNs_7476,ST_7474,TTL_7475) in
                            {9375}event beginSrv(Sess_5308,Cli_5306,Ns_7473);
                            {9376}out(c, m2_7477);
                            {9377}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                            {9378}event endSrv(Cli_5306,Sess_5308,Nc_7472)
                    )
                    else
                        {9379}let v_7478: bool = (Cli_5306 = B) in
                        (
                            {9380}if v_7478 then
                            (
                                {9381}let pkCli_7479: bitstring = pub(skB) in
                                {9382}let v_7480: bool = (Disco_5307 = A) in
                                (
                                    {9383}if v_7480 then
                                    (
                                        {9384}let pkDisco_7481: bitstring = pub(skA) in
                                        {9385}in(c, (=pkCli_7479,em1_7482: bitstring));
                                        {9386}let m1_7483: bitstring = em1_7482 in
                                        {9387}let (=OpenSecureChannelRequest,=pkCli_7479,wNc_7484: bitstring) = m1_7483 in
                                        {9388}let Nc_7485: bitstring = dec(wNc_7484,skSess_7401) in
                                        {9389}new Ns_7486: bitstring;
                                        {9390}new ST_7487: bitstring;
                                        {9391}new TTL_7488: bitstring;
                                        {9392}let wNs_7489: bitstring = enc(Ns_7486,pkCli_7479) in
                                        {9393}let m2_7490: bitstring = (OpenSecureChannelResponse,wNs_7489,ST_7487,TTL_7488) in
                                        {9394}event beginSrv(Sess_5308,Cli_5306,Ns_7486);
                                        {9395}out(c, m2_7490);
                                        {9396}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                        {9397}event endSrv(Cli_5306,Sess_5308,Nc_7485)
                                    )
                                    else
                                        {9398}let v_7491: bool = (Disco_5307 = B) in
                                        (
                                            {9399}if v_7491 then
                                            (
                                                {9400}let pkDisco_7492: bitstring = pub(skB) in
                                                {9401}in(c, (=pkCli_7479,em1_7493: bitstring));
                                                {9402}let m1_7494: bitstring = em1_7493 in
                                                {9403}let (=OpenSecureChannelRequest,=pkCli_7479,wNc_7495: bitstring) = m1_7494 in
                                                {9404}let Nc_7496: bitstring = dec(wNc_7495,skSess_7401) in
                                                {9405}new Ns_7497: bitstring;
                                                {9406}new ST_7498: bitstring;
                                                {9407}new TTL_7499: bitstring;
                                                {9408}let wNs_7500: bitstring = enc(Ns_7497,pkCli_7479) in
                                                {9409}let m2_7501: bitstring = (OpenSecureChannelResponse,wNs_7500,ST_7498,TTL_7499) in
                                                {9410}event beginSrv(Sess_5308,Cli_5306,Ns_7497);
                                                {9411}out(c, m2_7501);
                                                {9412}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                                {9413}event endSrv(Cli_5306,Sess_5308,Nc_7496)
                                            )
                                            else
                                                {9414}let v_7502: bool = (Disco_5307 = C) in
                                                (
                                                    {9415}if v_7502 then
                                                    (
                                                        {9416}let pkDisco_7503: bitstring = pub(skC) in
                                                        {9417}in(c, (=pkCli_7479,em1_7504: bitstring));
                                                        {9418}let m1_7505: bitstring = em1_7504 in
                                                        {9419}let (=OpenSecureChannelRequest,=pkCli_7479,wNc_7506: bitstring) = m1_7505 in
                                                        {9420}let Nc_7507: bitstring = dec(wNc_7506,skSess_7401) in
                                                        {9421}new Ns_7508: bitstring;
                                                        {9422}new ST_7509: bitstring;
                                                        {9423}new TTL_7510: bitstring;
                                                        {9424}let wNs_7511: bitstring = enc(Ns_7508,pkCli_7479) in
                                                        {9425}let m2_7512: bitstring = (OpenSecureChannelResponse,wNs_7511,ST_7509,TTL_7510) in
                                                        {9426}event beginSrv(Sess_5308,Cli_5306,Ns_7508);
                                                        {9427}out(c, m2_7512);
                                                        {9428}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                                        {9429}event endSrv(Cli_5306,Sess_5308,Nc_7507)
                                                    )
                                                    else
                                                        {9430}let pkDisco_7513: bitstring = pub(sk(Disco_5307)) in
                                                        {9431}in(c, (=pkCli_7479,em1_7514: bitstring));
                                                        {9432}let m1_7515: bitstring = em1_7514 in
                                                        {9433}let (=OpenSecureChannelRequest,=pkCli_7479,wNc_7516: bitstring) = m1_7515 in
                                                        {9434}let Nc_7517: bitstring = dec(wNc_7516,skSess_7401) in
                                                        {9435}new Ns_7518: bitstring;
                                                        {9436}new ST_7519: bitstring;
                                                        {9437}new TTL_7520: bitstring;
                                                        {9438}let wNs_7521: bitstring = enc(Ns_7518,pkCli_7479) in
                                                        {9439}let m2_7522: bitstring = (OpenSecureChannelResponse,wNs_7521,ST_7519,TTL_7520) in
                                                        {9440}event beginSrv(Sess_5308,Cli_5306,Ns_7518);
                                                        {9441}out(c, m2_7522);
                                                        {9442}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                                        {9443}event endSrv(Cli_5306,Sess_5308,Nc_7517)
                                                )
                                                else
                                                    {9444}let pkDisco_7523: bitstring = fail-any in
                                                    {9445}in(c, (=pkCli_7479,em1_7524: bitstring));
                                                    {9446}let m1_7525: bitstring = em1_7524 in
                                                    {9447}let (=OpenSecureChannelRequest,=pkCli_7479,wNc_7526: bitstring) = m1_7525 in
                                                    {9448}let Nc_7527: bitstring = dec(wNc_7526,skSess_7401) in
                                                    {9449}new Ns_7528: bitstring;
                                                    {9450}new ST_7529: bitstring;
                                                    {9451}new TTL_7530: bitstring;
                                                    {9452}let wNs_7531: bitstring = enc(Ns_7528,pkCli_7479) in
                                                    {9453}let m2_7532: bitstring = (OpenSecureChannelResponse,wNs_7531,ST_7529,TTL_7530) in
                                                    {9454}event beginSrv(Sess_5308,Cli_5306,Ns_7528);
                                                    {9455}out(c, m2_7532);
                                                    {9456}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                                    {9457}event endSrv(Cli_5306,Sess_5308,Nc_7527)
                                        )
                                        else
                                            {9458}let pkDisco_7533: bitstring = fail-any in
                                            {9459}in(c, (=pkCli_7479,em1_7534: bitstring));
                                            {9460}let m1_7535: bitstring = em1_7534 in
                                            {9461}let (=OpenSecureChannelRequest,=pkCli_7479,wNc_7536: bitstring) = m1_7535 in
                                            {9462}let Nc_7537: bitstring = dec(wNc_7536,skSess_7401) in
                                            {9463}new Ns_7538: bitstring;
                                            {9464}new ST_7539: bitstring;
                                            {9465}new TTL_7540: bitstring;
                                            {9466}let wNs_7541: bitstring = enc(Ns_7538,pkCli_7479) in
                                            {9467}let m2_7542: bitstring = (OpenSecureChannelResponse,wNs_7541,ST_7539,TTL_7540) in
                                            {9468}event beginSrv(Sess_5308,Cli_5306,Ns_7538);
                                            {9469}out(c, m2_7542);
                                            {9470}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                            {9471}event endSrv(Cli_5306,Sess_5308,Nc_7537)
                                )
                                else
                                    {9472}let pkDisco_7543: bitstring = fail-any in
                                    {9473}in(c, (=pkCli_7479,em1_7544: bitstring));
                                    {9474}let m1_7545: bitstring = em1_7544 in
                                    {9475}let (=OpenSecureChannelRequest,=pkCli_7479,wNc_7546: bitstring) = m1_7545 in
                                    {9476}let Nc_7547: bitstring = dec(wNc_7546,skSess_7401) in
                                    {9477}new Ns_7548: bitstring;
                                    {9478}new ST_7549: bitstring;
                                    {9479}new TTL_7550: bitstring;
                                    {9480}let wNs_7551: bitstring = enc(Ns_7548,pkCli_7479) in
                                    {9481}let m2_7552: bitstring = (OpenSecureChannelResponse,wNs_7551,ST_7549,TTL_7550) in
                                    {9482}event beginSrv(Sess_5308,Cli_5306,Ns_7548);
                                    {9483}out(c, m2_7552);
                                    {9484}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                    {9485}event endSrv(Cli_5306,Sess_5308,Nc_7547)
                            )
                            else
                                {9486}let v_7553: bool = (Cli_5306 = C) in
                                (
                                    {9487}if v_7553 then
                                    (
                                        {9488}let pkCli_7554: bitstring = pub(skC) in
                                        {9489}let v_7555: bool = (Disco_5307 = A) in
                                        (
                                            {9490}if v_7555 then
                                            (
                                                {9491}let pkDisco_7556: bitstring = pub(skA) in
                                                {9492}in(c, (=pkCli_7554,em1_7557: bitstring));
                                                {9493}let m1_7558: bitstring = em1_7557 in
                                                {9494}let (=OpenSecureChannelRequest,=pkCli_7554,wNc_7559: bitstring) = m1_7558 in
                                                {9495}let Nc_7560: bitstring = dec(wNc_7559,skSess_7401) in
                                                {9496}new Ns_7561: bitstring;
                                                {9497}new ST_7562: bitstring;
                                                {9498}new TTL_7563: bitstring;
                                                {9499}let wNs_7564: bitstring = enc(Ns_7561,pkCli_7554) in
                                                {9500}let m2_7565: bitstring = (OpenSecureChannelResponse,wNs_7564,ST_7562,TTL_7563) in
                                                {9501}event beginSrv(Sess_5308,Cli_5306,Ns_7561);
                                                {9502}out(c, m2_7565);
                                                {9503}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                                {9504}event endSrv(Cli_5306,Sess_5308,Nc_7560)
                                            )
                                            else
                                                {9505}let v_7566: bool = (Disco_5307 = B) in
                                                (
                                                    {9506}if v_7566 then
                                                    (
                                                        {9507}let pkDisco_7567: bitstring = pub(skB) in
                                                        {9508}in(c, (=pkCli_7554,em1_7568: bitstring));
                                                        {9509}let m1_7569: bitstring = em1_7568 in
                                                        {9510}let (=OpenSecureChannelRequest,=pkCli_7554,wNc_7570: bitstring) = m1_7569 in
                                                        {9511}let Nc_7571: bitstring = dec(wNc_7570,skSess_7401) in
                                                        {9512}new Ns_7572: bitstring;
                                                        {9513}new ST_7573: bitstring;
                                                        {9514}new TTL_7574: bitstring;
                                                        {9515}let wNs_7575: bitstring = enc(Ns_7572,pkCli_7554) in
                                                        {9516}let m2_7576: bitstring = (OpenSecureChannelResponse,wNs_7575,ST_7573,TTL_7574) in
                                                        {9517}event beginSrv(Sess_5308,Cli_5306,Ns_7572);
                                                        {9518}out(c, m2_7576);
                                                        {9519}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                                        {9520}event endSrv(Cli_5306,Sess_5308,Nc_7571)
                                                    )
                                                    else
                                                        {9521}let v_7577: bool = (Disco_5307 = C) in
                                                        (
                                                            {9522}if v_7577 then
                                                            (
                                                                {9523}let pkDisco_7578: bitstring = pub(skC) in
                                                                {9524}in(c, (=pkCli_7554,em1_7579: bitstring));
                                                                {9525}let m1_7580: bitstring = em1_7579 in
                                                                {9526}let (=OpenSecureChannelRequest,=pkCli_7554,wNc_7581: bitstring) = m1_7580 in
                                                                {9527}let Nc_7582: bitstring = dec(wNc_7581,skSess_7401) in
                                                                {9528}new Ns_7583: bitstring;
                                                                {9529}new ST_7584: bitstring;
                                                                {9530}new TTL_7585: bitstring;
                                                                {9531}let wNs_7586: bitstring = enc(Ns_7583,pkCli_7554) in
                                                                {9532}let m2_7587: bitstring = (OpenSecureChannelResponse,wNs_7586,ST_7584,TTL_7585) in
                                                                {9533}event beginSrv(Sess_5308,Cli_5306,Ns_7583);
                                                                {9534}out(c, m2_7587);
                                                                {9535}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                                                {9536}event endSrv(Cli_5306,Sess_5308,Nc_7582)
                                                            )
                                                            else
                                                                {9537}let pkDisco_7588: bitstring = pub(sk(Disco_5307)) in
                                                                {9538}in(c, (=pkCli_7554,em1_7589: bitstring));
                                                                {9539}let m1_7590: bitstring = em1_7589 in
                                                                {9540}let (=OpenSecureChannelRequest,=pkCli_7554,wNc_7591: bitstring) = m1_7590 in
                                                                {9541}let Nc_7592: bitstring = dec(wNc_7591,skSess_7401) in
                                                                {9542}new Ns_7593: bitstring;
                                                                {9543}new ST_7594: bitstring;
                                                                {9544}new TTL_7595: bitstring;
                                                                {9545}let wNs_7596: bitstring = enc(Ns_7593,pkCli_7554) in
                                                                {9546}let m2_7597: bitstring = (OpenSecureChannelResponse,wNs_7596,ST_7594,TTL_7595) in
                                                                {9547}event beginSrv(Sess_5308,Cli_5306,Ns_7593);
                                                                {9548}out(c, m2_7597);
                                                                {9549}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                                                {9550}event endSrv(Cli_5306,Sess_5308,Nc_7592)
                                                        )
                                                        else
                                                            {9551}let pkDisco_7598: bitstring = fail-any in
                                                            {9552}in(c, (=pkCli_7554,em1_7599: bitstring));
                                                            {9553}let m1_7600: bitstring = em1_7599 in
                                                            {9554}let (=OpenSecureChannelRequest,=pkCli_7554,wNc_7601: bitstring) = m1_7600 in
                                                            {9555}let Nc_7602: bitstring = dec(wNc_7601,skSess_7401) in
                                                            {9556}new Ns_7603: bitstring;
                                                            {9557}new ST_7604: bitstring;
                                                            {9558}new TTL_7605: bitstring;
                                                            {9559}let wNs_7606: bitstring = enc(Ns_7603,pkCli_7554) in
                                                            {9560}let m2_7607: bitstring = (OpenSecureChannelResponse,wNs_7606,ST_7604,TTL_7605) in
                                                            {9561}event beginSrv(Sess_5308,Cli_5306,Ns_7603);
                                                            {9562}out(c, m2_7607);
                                                            {9563}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                                            {9564}event endSrv(Cli_5306,Sess_5308,Nc_7602)
                                                )
                                                else
                                                    {9565}let pkDisco_7608: bitstring = fail-any in
                                                    {9566}in(c, (=pkCli_7554,em1_7609: bitstring));
                                                    {9567}let m1_7610: bitstring = em1_7609 in
                                                    {9568}let (=OpenSecureChannelRequest,=pkCli_7554,wNc_7611: bitstring) = m1_7610 in
                                                    {9569}let Nc_7612: bitstring = dec(wNc_7611,skSess_7401) in
                                                    {9570}new Ns_7613: bitstring;
                                                    {9571}new ST_7614: bitstring;
                                                    {9572}new TTL_7615: bitstring;
                                                    {9573}let wNs_7616: bitstring = enc(Ns_7613,pkCli_7554) in
                                                    {9574}let m2_7617: bitstring = (OpenSecureChannelResponse,wNs_7616,ST_7614,TTL_7615) in
                                                    {9575}event beginSrv(Sess_5308,Cli_5306,Ns_7613);
                                                    {9576}out(c, m2_7617);
                                                    {9577}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                                    {9578}event endSrv(Cli_5306,Sess_5308,Nc_7612)
                                        )
                                        else
                                            {9579}let pkDisco_7618: bitstring = fail-any in
                                            {9580}in(c, (=pkCli_7554,em1_7619: bitstring));
                                            {9581}let m1_7620: bitstring = em1_7619 in
                                            {9582}let (=OpenSecureChannelRequest,=pkCli_7554,wNc_7621: bitstring) = m1_7620 in
                                            {9583}let Nc_7622: bitstring = dec(wNc_7621,skSess_7401) in
                                            {9584}new Ns_7623: bitstring;
                                            {9585}new ST_7624: bitstring;
                                            {9586}new TTL_7625: bitstring;
                                            {9587}let wNs_7626: bitstring = enc(Ns_7623,pkCli_7554) in
                                            {9588}let m2_7627: bitstring = (OpenSecureChannelResponse,wNs_7626,ST_7624,TTL_7625) in
                                            {9589}event beginSrv(Sess_5308,Cli_5306,Ns_7623);
                                            {9590}out(c, m2_7627);
                                            {9591}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                            {9592}event endSrv(Cli_5306,Sess_5308,Nc_7622)
                                    )
                                    else
                                        {9593}let pkCli_7628: bitstring = pub(sk(Cli_5306)) in
                                        {9594}let v_7629: bool = (Disco_5307 = A) in
                                        (
                                            {9595}if v_7629 then
                                            (
                                                {9596}let pkDisco_7630: bitstring = pub(skA) in
                                                {9597}in(c, (=pkCli_7628,em1_7631: bitstring));
                                                {9598}let m1_7632: bitstring = em1_7631 in
                                                {9599}let (=OpenSecureChannelRequest,=pkCli_7628,wNc_7633: bitstring) = m1_7632 in
                                                {9600}let Nc_7634: bitstring = dec(wNc_7633,skSess_7401) in
                                                {9601}new Ns_7635: bitstring;
                                                {9602}new ST_7636: bitstring;
                                                {9603}new TTL_7637: bitstring;
                                                {9604}let wNs_7638: bitstring = enc(Ns_7635,pkCli_7628) in
                                                {9605}let m2_7639: bitstring = (OpenSecureChannelResponse,wNs_7638,ST_7636,TTL_7637) in
                                                {9606}event beginSrv(Sess_5308,Cli_5306,Ns_7635);
                                                {9607}out(c, m2_7639);
                                                {9608}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                                {9609}event endSrv(Cli_5306,Sess_5308,Nc_7634)
                                            )
                                            else
                                                {9610}let v_7640: bool = (Disco_5307 = B) in
                                                (
                                                    {9611}if v_7640 then
                                                    (
                                                        {9612}let pkDisco_7641: bitstring = pub(skB) in
                                                        {9613}in(c, (=pkCli_7628,em1_7642: bitstring));
                                                        {9614}let m1_7643: bitstring = em1_7642 in
                                                        {9615}let (=OpenSecureChannelRequest,=pkCli_7628,wNc_7644: bitstring) = m1_7643 in
                                                        {9616}let Nc_7645: bitstring = dec(wNc_7644,skSess_7401) in
                                                        {9617}new Ns_7646: bitstring;
                                                        {9618}new ST_7647: bitstring;
                                                        {9619}new TTL_7648: bitstring;
                                                        {9620}let wNs_7649: bitstring = enc(Ns_7646,pkCli_7628) in
                                                        {9621}let m2_7650: bitstring = (OpenSecureChannelResponse,wNs_7649,ST_7647,TTL_7648) in
                                                        {9622}event beginSrv(Sess_5308,Cli_5306,Ns_7646);
                                                        {9623}out(c, m2_7650);
                                                        {9624}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                                        {9625}event endSrv(Cli_5306,Sess_5308,Nc_7645)
                                                    )
                                                    else
                                                        {9626}let v_7651: bool = (Disco_5307 = C) in
                                                        (
                                                            {9627}if v_7651 then
                                                            (
                                                                {9628}let pkDisco_7652: bitstring = pub(skC) in
                                                                {9629}in(c, (=pkCli_7628,em1_7653: bitstring));
                                                                {9630}let m1_7654: bitstring = em1_7653 in
                                                                {9631}let (=OpenSecureChannelRequest,=pkCli_7628,wNc_7655: bitstring) = m1_7654 in
                                                                {9632}let Nc_7656: bitstring = dec(wNc_7655,skSess_7401) in
                                                                {9633}new Ns_7657: bitstring;
                                                                {9634}new ST_7658: bitstring;
                                                                {9635}new TTL_7659: bitstring;
                                                                {9636}let wNs_7660: bitstring = enc(Ns_7657,pkCli_7628) in
                                                                {9637}let m2_7661: bitstring = (OpenSecureChannelResponse,wNs_7660,ST_7658,TTL_7659) in
                                                                {9638}event beginSrv(Sess_5308,Cli_5306,Ns_7657);
                                                                {9639}out(c, m2_7661);
                                                                {9640}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                                                {9641}event endSrv(Cli_5306,Sess_5308,Nc_7656)
                                                            )
                                                            else
                                                                {9642}let pkDisco_7662: bitstring = pub(sk(Disco_5307)) in
                                                                {9643}in(c, (=pkCli_7628,em1_7663: bitstring));
                                                                {9644}let m1_7664: bitstring = em1_7663 in
                                                                {9645}let (=OpenSecureChannelRequest,=pkCli_7628,wNc_7665: bitstring) = m1_7664 in
                                                                {9646}let Nc_7666: bitstring = dec(wNc_7665,skSess_7401) in
                                                                {9647}new Ns_7667: bitstring;
                                                                {9648}new ST_7668: bitstring;
                                                                {9649}new TTL_7669: bitstring;
                                                                {9650}let wNs_7670: bitstring = enc(Ns_7667,pkCli_7628) in
                                                                {9651}let m2_7671: bitstring = (OpenSecureChannelResponse,wNs_7670,ST_7668,TTL_7669) in
                                                                {9652}event beginSrv(Sess_5308,Cli_5306,Ns_7667);
                                                                {9653}out(c, m2_7671);
                                                                {9654}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                                                {9655}event endSrv(Cli_5306,Sess_5308,Nc_7666)
                                                        )
                                                        else
                                                            {9656}let pkDisco_7672: bitstring = fail-any in
                                                            {9657}in(c, (=pkCli_7628,em1_7673: bitstring));
                                                            {9658}let m1_7674: bitstring = em1_7673 in
                                                            {9659}let (=OpenSecureChannelRequest,=pkCli_7628,wNc_7675: bitstring) = m1_7674 in
                                                            {9660}let Nc_7676: bitstring = dec(wNc_7675,skSess_7401) in
                                                            {9661}new Ns_7677: bitstring;
                                                            {9662}new ST_7678: bitstring;
                                                            {9663}new TTL_7679: bitstring;
                                                            {9664}let wNs_7680: bitstring = enc(Ns_7677,pkCli_7628) in
                                                            {9665}let m2_7681: bitstring = (OpenSecureChannelResponse,wNs_7680,ST_7678,TTL_7679) in
                                                            {9666}event beginSrv(Sess_5308,Cli_5306,Ns_7677);
                                                            {9667}out(c, m2_7681);
                                                            {9668}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                                            {9669}event endSrv(Cli_5306,Sess_5308,Nc_7676)
                                                )
                                                else
                                                    {9670}let pkDisco_7682: bitstring = fail-any in
                                                    {9671}in(c, (=pkCli_7628,em1_7683: bitstring));
                                                    {9672}let m1_7684: bitstring = em1_7683 in
                                                    {9673}let (=OpenSecureChannelRequest,=pkCli_7628,wNc_7685: bitstring) = m1_7684 in
                                                    {9674}let Nc_7686: bitstring = dec(wNc_7685,skSess_7401) in
                                                    {9675}new Ns_7687: bitstring;
                                                    {9676}new ST_7688: bitstring;
                                                    {9677}new TTL_7689: bitstring;
                                                    {9678}let wNs_7690: bitstring = enc(Ns_7687,pkCli_7628) in
                                                    {9679}let m2_7691: bitstring = (OpenSecureChannelResponse,wNs_7690,ST_7688,TTL_7689) in
                                                    {9680}event beginSrv(Sess_5308,Cli_5306,Ns_7687);
                                                    {9681}out(c, m2_7691);
                                                    {9682}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                                    {9683}event endSrv(Cli_5306,Sess_5308,Nc_7686)
                                        )
                                        else
                                            {9684}let pkDisco_7692: bitstring = fail-any in
                                            {9685}in(c, (=pkCli_7628,em1_7693: bitstring));
                                            {9686}let m1_7694: bitstring = em1_7693 in
                                            {9687}let (=OpenSecureChannelRequest,=pkCli_7628,wNc_7695: bitstring) = m1_7694 in
                                            {9688}let Nc_7696: bitstring = dec(wNc_7695,skSess_7401) in
                                            {9689}new Ns_7697: bitstring;
                                            {9690}new ST_7698: bitstring;
                                            {9691}new TTL_7699: bitstring;
                                            {9692}let wNs_7700: bitstring = enc(Ns_7697,pkCli_7628) in
                                            {9693}let m2_7701: bitstring = (OpenSecureChannelResponse,wNs_7700,ST_7698,TTL_7699) in
                                            {9694}event beginSrv(Sess_5308,Cli_5306,Ns_7697);
                                            {9695}out(c, m2_7701);
                                            {9696}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                            {9697}event endSrv(Cli_5306,Sess_5308,Nc_7696)
                                )
                                else
                                    {9698}let pkCli_7702: bitstring = fail-any in
                                    {9699}let v_7703: bool = (Disco_5307 = A) in
                                    (
                                        {9700}if v_7703 then
                                        (
                                            {9701}let pkDisco_7704: bitstring = pub(skA) in
                                            {9702}in(c, (=pkCli_7702,em1_7705: bitstring));
                                            {9703}let m1_7706: bitstring = em1_7705 in
                                            {9704}let (=OpenSecureChannelRequest,=pkCli_7702,wNc_7707: bitstring) = m1_7706 in
                                            {9705}let Nc_7708: bitstring = dec(wNc_7707,skSess_7401) in
                                            {9706}new Ns_7709: bitstring;
                                            {9707}new ST_7710: bitstring;
                                            {9708}new TTL_7711: bitstring;
                                            {9709}let wNs_7712: bitstring = enc(Ns_7709,pkCli_7702) in
                                            {9710}let m2_7713: bitstring = (OpenSecureChannelResponse,wNs_7712,ST_7710,TTL_7711) in
                                            {9711}event beginSrv(Sess_5308,Cli_5306,Ns_7709);
                                            {9712}out(c, m2_7713);
                                            {9713}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                            {9714}event endSrv(Cli_5306,Sess_5308,Nc_7708)
                                        )
                                        else
                                            {9715}let v_7714: bool = (Disco_5307 = B) in
                                            (
                                                {9716}if v_7714 then
                                                (
                                                    {9717}let pkDisco_7715: bitstring = pub(skB) in
                                                    {9718}in(c, (=pkCli_7702,em1_7716: bitstring));
                                                    {9719}let m1_7717: bitstring = em1_7716 in
                                                    {9720}let (=OpenSecureChannelRequest,=pkCli_7702,wNc_7718: bitstring) = m1_7717 in
                                                    {9721}let Nc_7719: bitstring = dec(wNc_7718,skSess_7401) in
                                                    {9722}new Ns_7720: bitstring;
                                                    {9723}new ST_7721: bitstring;
                                                    {9724}new TTL_7722: bitstring;
                                                    {9725}let wNs_7723: bitstring = enc(Ns_7720,pkCli_7702) in
                                                    {9726}let m2_7724: bitstring = (OpenSecureChannelResponse,wNs_7723,ST_7721,TTL_7722) in
                                                    {9727}event beginSrv(Sess_5308,Cli_5306,Ns_7720);
                                                    {9728}out(c, m2_7724);
                                                    {9729}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                                    {9730}event endSrv(Cli_5306,Sess_5308,Nc_7719)
                                                )
                                                else
                                                    {9731}let v_7725: bool = (Disco_5307 = C) in
                                                    (
                                                        {9732}if v_7725 then
                                                        (
                                                            {9733}let pkDisco_7726: bitstring = pub(skC) in
                                                            {9734}in(c, (=pkCli_7702,em1_7727: bitstring));
                                                            {9735}let m1_7728: bitstring = em1_7727 in
                                                            {9736}let (=OpenSecureChannelRequest,=pkCli_7702,wNc_7729: bitstring) = m1_7728 in
                                                            {9737}let Nc_7730: bitstring = dec(wNc_7729,skSess_7401) in
                                                            {9738}new Ns_7731: bitstring;
                                                            {9739}new ST_7732: bitstring;
                                                            {9740}new TTL_7733: bitstring;
                                                            {9741}let wNs_7734: bitstring = enc(Ns_7731,pkCli_7702) in
                                                            {9742}let m2_7735: bitstring = (OpenSecureChannelResponse,wNs_7734,ST_7732,TTL_7733) in
                                                            {9743}event beginSrv(Sess_5308,Cli_5306,Ns_7731);
                                                            {9744}out(c, m2_7735);
                                                            {9745}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                                            {9746}event endSrv(Cli_5306,Sess_5308,Nc_7730)
                                                        )
                                                        else
                                                            {9747}let pkDisco_7736: bitstring = pub(sk(Disco_5307)) in
                                                            {9748}in(c, (=pkCli_7702,em1_7737: bitstring));
                                                            {9749}let m1_7738: bitstring = em1_7737 in
                                                            {9750}let (=OpenSecureChannelRequest,=pkCli_7702,wNc_7739: bitstring) = m1_7738 in
                                                            {9751}let Nc_7740: bitstring = dec(wNc_7739,skSess_7401) in
                                                            {9752}new Ns_7741: bitstring;
                                                            {9753}new ST_7742: bitstring;
                                                            {9754}new TTL_7743: bitstring;
                                                            {9755}let wNs_7744: bitstring = enc(Ns_7741,pkCli_7702) in
                                                            {9756}let m2_7745: bitstring = (OpenSecureChannelResponse,wNs_7744,ST_7742,TTL_7743) in
                                                            {9757}event beginSrv(Sess_5308,Cli_5306,Ns_7741);
                                                            {9758}out(c, m2_7745);
                                                            {9759}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                                            {9760}event endSrv(Cli_5306,Sess_5308,Nc_7740)
                                                    )
                                                    else
                                                        {9761}let pkDisco_7746: bitstring = fail-any in
                                                        {9762}in(c, (=pkCli_7702,em1_7747: bitstring));
                                                        {9763}let m1_7748: bitstring = em1_7747 in
                                                        {9764}let (=OpenSecureChannelRequest,=pkCli_7702,wNc_7749: bitstring) = m1_7748 in
                                                        {9765}let Nc_7750: bitstring = dec(wNc_7749,skSess_7401) in
                                                        {9766}new Ns_7751: bitstring;
                                                        {9767}new ST_7752: bitstring;
                                                        {9768}new TTL_7753: bitstring;
                                                        {9769}let wNs_7754: bitstring = enc(Ns_7751,pkCli_7702) in
                                                        {9770}let m2_7755: bitstring = (OpenSecureChannelResponse,wNs_7754,ST_7752,TTL_7753) in
                                                        {9771}event beginSrv(Sess_5308,Cli_5306,Ns_7751);
                                                        {9772}out(c, m2_7755);
                                                        {9773}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                                        {9774}event endSrv(Cli_5306,Sess_5308,Nc_7750)
                                            )
                                            else
                                                {9775}let pkDisco_7756: bitstring = fail-any in
                                                {9776}in(c, (=pkCli_7702,em1_7757: bitstring));
                                                {9777}let m1_7758: bitstring = em1_7757 in
                                                {9778}let (=OpenSecureChannelRequest,=pkCli_7702,wNc_7759: bitstring) = m1_7758 in
                                                {9779}let Nc_7760: bitstring = dec(wNc_7759,skSess_7401) in
                                                {9780}new Ns_7761: bitstring;
                                                {9781}new ST_7762: bitstring;
                                                {9782}new TTL_7763: bitstring;
                                                {9783}let wNs_7764: bitstring = enc(Ns_7761,pkCli_7702) in
                                                {9784}let m2_7765: bitstring = (OpenSecureChannelResponse,wNs_7764,ST_7762,TTL_7763) in
                                                {9785}event beginSrv(Sess_5308,Cli_5306,Ns_7761);
                                                {9786}out(c, m2_7765);
                                                {9787}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                                {9788}event endSrv(Cli_5306,Sess_5308,Nc_7760)
                                    )
                                    else
                                        {9789}let pkDisco_7766: bitstring = fail-any in
                                        {9790}in(c, (=pkCli_7702,em1_7767: bitstring));
                                        {9791}let m1_7768: bitstring = em1_7767 in
                                        {9792}let (=OpenSecureChannelRequest,=pkCli_7702,wNc_7769: bitstring) = m1_7768 in
                                        {9793}let Nc_7770: bitstring = dec(wNc_7769,skSess_7401) in
                                        {9794}new Ns_7771: bitstring;
                                        {9795}new ST_7772: bitstring;
                                        {9796}new TTL_7773: bitstring;
                                        {9797}let wNs_7774: bitstring = enc(Ns_7771,pkCli_7702) in
                                        {9798}let m2_7775: bitstring = (OpenSecureChannelResponse,wNs_7774,ST_7772,TTL_7773) in
                                        {9799}event beginSrv(Sess_5308,Cli_5306,Ns_7771);
                                        {9800}out(c, m2_7775);
                                        {9801}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                        {9802}event endSrv(Cli_5306,Sess_5308,Nc_7770)
                        )
                        else
                            {9803}let pkCli_7776: bitstring = fail-any in
                            {9804}let v_7777: bool = (Disco_5307 = A) in
                            (
                                {9805}if v_7777 then
                                (
                                    {9806}let pkDisco_7778: bitstring = pub(skA) in
                                    {9807}in(c, (=pkCli_7776,em1_7779: bitstring));
                                    {9808}let m1_7780: bitstring = em1_7779 in
                                    {9809}let (=OpenSecureChannelRequest,=pkCli_7776,wNc_7781: bitstring) = m1_7780 in
                                    {9810}let Nc_7782: bitstring = dec(wNc_7781,skSess_7401) in
                                    {9811}new Ns_7783: bitstring;
                                    {9812}new ST_7784: bitstring;
                                    {9813}new TTL_7785: bitstring;
                                    {9814}let wNs_7786: bitstring = enc(Ns_7783,pkCli_7776) in
                                    {9815}let m2_7787: bitstring = (OpenSecureChannelResponse,wNs_7786,ST_7784,TTL_7785) in
                                    {9816}event beginSrv(Sess_5308,Cli_5306,Ns_7783);
                                    {9817}out(c, m2_7787);
                                    {9818}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                    {9819}event endSrv(Cli_5306,Sess_5308,Nc_7782)
                                )
                                else
                                    {9820}let v_7788: bool = (Disco_5307 = B) in
                                    (
                                        {9821}if v_7788 then
                                        (
                                            {9822}let pkDisco_7789: bitstring = pub(skB) in
                                            {9823}in(c, (=pkCli_7776,em1_7790: bitstring));
                                            {9824}let m1_7791: bitstring = em1_7790 in
                                            {9825}let (=OpenSecureChannelRequest,=pkCli_7776,wNc_7792: bitstring) = m1_7791 in
                                            {9826}let Nc_7793: bitstring = dec(wNc_7792,skSess_7401) in
                                            {9827}new Ns_7794: bitstring;
                                            {9828}new ST_7795: bitstring;
                                            {9829}new TTL_7796: bitstring;
                                            {9830}let wNs_7797: bitstring = enc(Ns_7794,pkCli_7776) in
                                            {9831}let m2_7798: bitstring = (OpenSecureChannelResponse,wNs_7797,ST_7795,TTL_7796) in
                                            {9832}event beginSrv(Sess_5308,Cli_5306,Ns_7794);
                                            {9833}out(c, m2_7798);
                                            {9834}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                            {9835}event endSrv(Cli_5306,Sess_5308,Nc_7793)
                                        )
                                        else
                                            {9836}let v_7799: bool = (Disco_5307 = C) in
                                            (
                                                {9837}if v_7799 then
                                                (
                                                    {9838}let pkDisco_7800: bitstring = pub(skC) in
                                                    {9839}in(c, (=pkCli_7776,em1_7801: bitstring));
                                                    {9840}let m1_7802: bitstring = em1_7801 in
                                                    {9841}let (=OpenSecureChannelRequest,=pkCli_7776,wNc_7803: bitstring) = m1_7802 in
                                                    {9842}let Nc_7804: bitstring = dec(wNc_7803,skSess_7401) in
                                                    {9843}new Ns_7805: bitstring;
                                                    {9844}new ST_7806: bitstring;
                                                    {9845}new TTL_7807: bitstring;
                                                    {9846}let wNs_7808: bitstring = enc(Ns_7805,pkCli_7776) in
                                                    {9847}let m2_7809: bitstring = (OpenSecureChannelResponse,wNs_7808,ST_7806,TTL_7807) in
                                                    {9848}event beginSrv(Sess_5308,Cli_5306,Ns_7805);
                                                    {9849}out(c, m2_7809);
                                                    {9850}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                                    {9851}event endSrv(Cli_5306,Sess_5308,Nc_7804)
                                                )
                                                else
                                                    {9852}let pkDisco_7810: bitstring = pub(sk(Disco_5307)) in
                                                    {9853}in(c, (=pkCli_7776,em1_7811: bitstring));
                                                    {9854}let m1_7812: bitstring = em1_7811 in
                                                    {9855}let (=OpenSecureChannelRequest,=pkCli_7776,wNc_7813: bitstring) = m1_7812 in
                                                    {9856}let Nc_7814: bitstring = dec(wNc_7813,skSess_7401) in
                                                    {9857}new Ns_7815: bitstring;
                                                    {9858}new ST_7816: bitstring;
                                                    {9859}new TTL_7817: bitstring;
                                                    {9860}let wNs_7818: bitstring = enc(Ns_7815,pkCli_7776) in
                                                    {9861}let m2_7819: bitstring = (OpenSecureChannelResponse,wNs_7818,ST_7816,TTL_7817) in
                                                    {9862}event beginSrv(Sess_5308,Cli_5306,Ns_7815);
                                                    {9863}out(c, m2_7819);
                                                    {9864}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                                    {9865}event endSrv(Cli_5306,Sess_5308,Nc_7814)
                                            )
                                            else
                                                {9866}let pkDisco_7820: bitstring = fail-any in
                                                {9867}in(c, (=pkCli_7776,em1_7821: bitstring));
                                                {9868}let m1_7822: bitstring = em1_7821 in
                                                {9869}let (=OpenSecureChannelRequest,=pkCli_7776,wNc_7823: bitstring) = m1_7822 in
                                                {9870}let Nc_7824: bitstring = dec(wNc_7823,skSess_7401) in
                                                {9871}new Ns_7825: bitstring;
                                                {9872}new ST_7826: bitstring;
                                                {9873}new TTL_7827: bitstring;
                                                {9874}let wNs_7828: bitstring = enc(Ns_7825,pkCli_7776) in
                                                {9875}let m2_7829: bitstring = (OpenSecureChannelResponse,wNs_7828,ST_7826,TTL_7827) in
                                                {9876}event beginSrv(Sess_5308,Cli_5306,Ns_7825);
                                                {9877}out(c, m2_7829);
                                                {9878}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                                {9879}event endSrv(Cli_5306,Sess_5308,Nc_7824)
                                    )
                                    else
                                        {9880}let pkDisco_7830: bitstring = fail-any in
                                        {9881}in(c, (=pkCli_7776,em1_7831: bitstring));
                                        {9882}let m1_7832: bitstring = em1_7831 in
                                        {9883}let (=OpenSecureChannelRequest,=pkCli_7776,wNc_7833: bitstring) = m1_7832 in
                                        {9884}let Nc_7834: bitstring = dec(wNc_7833,skSess_7401) in
                                        {9885}new Ns_7835: bitstring;
                                        {9886}new ST_7836: bitstring;
                                        {9887}new TTL_7837: bitstring;
                                        {9888}let wNs_7838: bitstring = enc(Ns_7835,pkCli_7776) in
                                        {9889}let m2_7839: bitstring = (OpenSecureChannelResponse,wNs_7838,ST_7836,TTL_7837) in
                                        {9890}event beginSrv(Sess_5308,Cli_5306,Ns_7835);
                                        {9891}out(c, m2_7839);
                                        {9892}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                        {9893}event endSrv(Cli_5306,Sess_5308,Nc_7834)
                            )
                            else
                                {9894}let pkDisco_7840: bitstring = fail-any in
                                {9895}in(c, (=pkCli_7776,em1_7841: bitstring));
                                {9896}let m1_7842: bitstring = em1_7841 in
                                {9897}let (=OpenSecureChannelRequest,=pkCli_7776,wNc_7843: bitstring) = m1_7842 in
                                {9898}let Nc_7844: bitstring = dec(wNc_7843,skSess_7401) in
                                {9899}new Ns_7845: bitstring;
                                {9900}new ST_7846: bitstring;
                                {9901}new TTL_7847: bitstring;
                                {9902}let wNs_7848: bitstring = enc(Ns_7845,pkCli_7776) in
                                {9903}let m2_7849: bitstring = (OpenSecureChannelResponse,wNs_7848,ST_7846,TTL_7847) in
                                {9904}event beginSrv(Sess_5308,Cli_5306,Ns_7845);
                                {9905}out(c, m2_7849);
                                {9906}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                {9907}event endSrv(Cli_5306,Sess_5308,Nc_7844)
                )
                else
                    {9908}let pkCli_7850: bitstring = fail-any in
                    {9909}let v_7851: bool = (Disco_5307 = A) in
                    (
                        {9910}if v_7851 then
                        (
                            {9911}let pkDisco_7852: bitstring = pub(skA) in
                            {9912}in(c, (=pkCli_7850,em1_7853: bitstring));
                            {9913}let m1_7854: bitstring = em1_7853 in
                            {9914}let (=OpenSecureChannelRequest,=pkCli_7850,wNc_7855: bitstring) = m1_7854 in
                            {9915}let Nc_7856: bitstring = dec(wNc_7855,skSess_7401) in
                            {9916}new Ns_7857: bitstring;
                            {9917}new ST_7858: bitstring;
                            {9918}new TTL_7859: bitstring;
                            {9919}let wNs_7860: bitstring = enc(Ns_7857,pkCli_7850) in
                            {9920}let m2_7861: bitstring = (OpenSecureChannelResponse,wNs_7860,ST_7858,TTL_7859) in
                            {9921}event beginSrv(Sess_5308,Cli_5306,Ns_7857);
                            {9922}out(c, m2_7861);
                            {9923}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                            {9924}event endSrv(Cli_5306,Sess_5308,Nc_7856)
                        )
                        else
                            {9925}let v_7862: bool = (Disco_5307 = B) in
                            (
                                {9926}if v_7862 then
                                (
                                    {9927}let pkDisco_7863: bitstring = pub(skB) in
                                    {9928}in(c, (=pkCli_7850,em1_7864: bitstring));
                                    {9929}let m1_7865: bitstring = em1_7864 in
                                    {9930}let (=OpenSecureChannelRequest,=pkCli_7850,wNc_7866: bitstring) = m1_7865 in
                                    {9931}let Nc_7867: bitstring = dec(wNc_7866,skSess_7401) in
                                    {9932}new Ns_7868: bitstring;
                                    {9933}new ST_7869: bitstring;
                                    {9934}new TTL_7870: bitstring;
                                    {9935}let wNs_7871: bitstring = enc(Ns_7868,pkCli_7850) in
                                    {9936}let m2_7872: bitstring = (OpenSecureChannelResponse,wNs_7871,ST_7869,TTL_7870) in
                                    {9937}event beginSrv(Sess_5308,Cli_5306,Ns_7868);
                                    {9938}out(c, m2_7872);
                                    {9939}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                    {9940}event endSrv(Cli_5306,Sess_5308,Nc_7867)
                                )
                                else
                                    {9941}let v_7873: bool = (Disco_5307 = C) in
                                    (
                                        {9942}if v_7873 then
                                        (
                                            {9943}let pkDisco_7874: bitstring = pub(skC) in
                                            {9944}in(c, (=pkCli_7850,em1_7875: bitstring));
                                            {9945}let m1_7876: bitstring = em1_7875 in
                                            {9946}let (=OpenSecureChannelRequest,=pkCli_7850,wNc_7877: bitstring) = m1_7876 in
                                            {9947}let Nc_7878: bitstring = dec(wNc_7877,skSess_7401) in
                                            {9948}new Ns_7879: bitstring;
                                            {9949}new ST_7880: bitstring;
                                            {9950}new TTL_7881: bitstring;
                                            {9951}let wNs_7882: bitstring = enc(Ns_7879,pkCli_7850) in
                                            {9952}let m2_7883: bitstring = (OpenSecureChannelResponse,wNs_7882,ST_7880,TTL_7881) in
                                            {9953}event beginSrv(Sess_5308,Cli_5306,Ns_7879);
                                            {9954}out(c, m2_7883);
                                            {9955}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                            {9956}event endSrv(Cli_5306,Sess_5308,Nc_7878)
                                        )
                                        else
                                            {9957}let pkDisco_7884: bitstring = pub(sk(Disco_5307)) in
                                            {9958}in(c, (=pkCli_7850,em1_7885: bitstring));
                                            {9959}let m1_7886: bitstring = em1_7885 in
                                            {9960}let (=OpenSecureChannelRequest,=pkCli_7850,wNc_7887: bitstring) = m1_7886 in
                                            {9961}let Nc_7888: bitstring = dec(wNc_7887,skSess_7401) in
                                            {9962}new Ns_7889: bitstring;
                                            {9963}new ST_7890: bitstring;
                                            {9964}new TTL_7891: bitstring;
                                            {9965}let wNs_7892: bitstring = enc(Ns_7889,pkCli_7850) in
                                            {9966}let m2_7893: bitstring = (OpenSecureChannelResponse,wNs_7892,ST_7890,TTL_7891) in
                                            {9967}event beginSrv(Sess_5308,Cli_5306,Ns_7889);
                                            {9968}out(c, m2_7893);
                                            {9969}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                            {9970}event endSrv(Cli_5306,Sess_5308,Nc_7888)
                                    )
                                    else
                                        {9971}let pkDisco_7894: bitstring = fail-any in
                                        {9972}in(c, (=pkCli_7850,em1_7895: bitstring));
                                        {9973}let m1_7896: bitstring = em1_7895 in
                                        {9974}let (=OpenSecureChannelRequest,=pkCli_7850,wNc_7897: bitstring) = m1_7896 in
                                        {9975}let Nc_7898: bitstring = dec(wNc_7897,skSess_7401) in
                                        {9976}new Ns_7899: bitstring;
                                        {9977}new ST_7900: bitstring;
                                        {9978}new TTL_7901: bitstring;
                                        {9979}let wNs_7902: bitstring = enc(Ns_7899,pkCli_7850) in
                                        {9980}let m2_7903: bitstring = (OpenSecureChannelResponse,wNs_7902,ST_7900,TTL_7901) in
                                        {9981}event beginSrv(Sess_5308,Cli_5306,Ns_7899);
                                        {9982}out(c, m2_7903);
                                        {9983}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                        {9984}event endSrv(Cli_5306,Sess_5308,Nc_7898)
                            )
                            else
                                {9985}let pkDisco_7904: bitstring = fail-any in
                                {9986}in(c, (=pkCli_7850,em1_7905: bitstring));
                                {9987}let m1_7906: bitstring = em1_7905 in
                                {9988}let (=OpenSecureChannelRequest,=pkCli_7850,wNc_7907: bitstring) = m1_7906 in
                                {9989}let Nc_7908: bitstring = dec(wNc_7907,skSess_7401) in
                                {9990}new Ns_7909: bitstring;
                                {9991}new ST_7910: bitstring;
                                {9992}new TTL_7911: bitstring;
                                {9993}let wNs_7912: bitstring = enc(Ns_7909,pkCli_7850) in
                                {9994}let m2_7913: bitstring = (OpenSecureChannelResponse,wNs_7912,ST_7910,TTL_7911) in
                                {9995}event beginSrv(Sess_5308,Cli_5306,Ns_7909);
                                {9996}out(c, m2_7913);
                                {9997}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                {9998}event endSrv(Cli_5306,Sess_5308,Nc_7908)
                    )
                    else
                        {9999}let pkDisco_7914: bitstring = fail-any in
                        {10000}in(c, (=pkCli_7850,em1_7915: bitstring));
                        {10001}let m1_7916: bitstring = em1_7915 in
                        {10002}let (=OpenSecureChannelRequest,=pkCli_7850,wNc_7917: bitstring) = m1_7916 in
                        {10003}let Nc_7918: bitstring = dec(wNc_7917,skSess_7401) in
                        {10004}new Ns_7919: bitstring;
                        {10005}new ST_7920: bitstring;
                        {10006}new TTL_7921: bitstring;
                        {10007}let wNs_7922: bitstring = enc(Ns_7919,pkCli_7850) in
                        {10008}let m2_7923: bitstring = (OpenSecureChannelResponse,wNs_7922,ST_7920,TTL_7921) in
                        {10009}event beginSrv(Sess_5308,Cli_5306,Ns_7919);
                        {10010}out(c, m2_7923);
                        {10011}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                        {10012}event endSrv(Cli_5306,Sess_5308,Nc_7918)
    )
    else
        {10013}let skSess_7924: bitstring = fail-any in
        {10014}let pkSess_7925: bitstring = pub(skSess_7924) in
        {10015}let v_7926: bool = (Cli_5306 = A) in
        (
            {10016}if v_7926 then
            (
                {10017}let pkCli_7927: bitstring = pub(skA) in
                {10018}let v_7928: bool = (Disco_5307 = A) in
                (
                    {10019}if v_7928 then
                    (
                        {10020}let pkDisco_7929: bitstring = pub(skA) in
                        {10021}in(c, (=pkCli_7927,em1_7930: bitstring));
                        {10022}let m1_7931: bitstring = em1_7930 in
                        {10023}let (=OpenSecureChannelRequest,=pkCli_7927,wNc_7932: bitstring) = m1_7931 in
                        {10024}let Nc_7933: bitstring = dec(wNc_7932,skSess_7924) in
                        {10025}new Ns_7934: bitstring;
                        {10026}new ST_7935: bitstring;
                        {10027}new TTL_7936: bitstring;
                        {10028}let wNs_7937: bitstring = enc(Ns_7934,pkCli_7927) in
                        {10029}let m2_7938: bitstring = (OpenSecureChannelResponse,wNs_7937,ST_7935,TTL_7936) in
                        {10030}event beginSrv(Sess_5308,Cli_5306,Ns_7934);
                        {10031}out(c, m2_7938);
                        {10032}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                        {10033}event endSrv(Cli_5306,Sess_5308,Nc_7933)
                    )
                    else
                        {10034}let v_7939: bool = (Disco_5307 = B) in
                        (
                            {10035}if v_7939 then
                            (
                                {10036}let pkDisco_7940: bitstring = pub(skB) in
                                {10037}in(c, (=pkCli_7927,em1_7941: bitstring));
                                {10038}let m1_7942: bitstring = em1_7941 in
                                {10039}let (=OpenSecureChannelRequest,=pkCli_7927,wNc_7943: bitstring) = m1_7942 in
                                {10040}let Nc_7944: bitstring = dec(wNc_7943,skSess_7924) in
                                {10041}new Ns_7945: bitstring;
                                {10042}new ST_7946: bitstring;
                                {10043}new TTL_7947: bitstring;
                                {10044}let wNs_7948: bitstring = enc(Ns_7945,pkCli_7927) in
                                {10045}let m2_7949: bitstring = (OpenSecureChannelResponse,wNs_7948,ST_7946,TTL_7947) in
                                {10046}event beginSrv(Sess_5308,Cli_5306,Ns_7945);
                                {10047}out(c, m2_7949);
                                {10048}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                {10049}event endSrv(Cli_5306,Sess_5308,Nc_7944)
                            )
                            else
                                {10050}let v_7950: bool = (Disco_5307 = C) in
                                (
                                    {10051}if v_7950 then
                                    (
                                        {10052}let pkDisco_7951: bitstring = pub(skC) in
                                        {10053}in(c, (=pkCli_7927,em1_7952: bitstring));
                                        {10054}let m1_7953: bitstring = em1_7952 in
                                        {10055}let (=OpenSecureChannelRequest,=pkCli_7927,wNc_7954: bitstring) = m1_7953 in
                                        {10056}let Nc_7955: bitstring = dec(wNc_7954,skSess_7924) in
                                        {10057}new Ns_7956: bitstring;
                                        {10058}new ST_7957: bitstring;
                                        {10059}new TTL_7958: bitstring;
                                        {10060}let wNs_7959: bitstring = enc(Ns_7956,pkCli_7927) in
                                        {10061}let m2_7960: bitstring = (OpenSecureChannelResponse,wNs_7959,ST_7957,TTL_7958) in
                                        {10062}event beginSrv(Sess_5308,Cli_5306,Ns_7956);
                                        {10063}out(c, m2_7960);
                                        {10064}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                        {10065}event endSrv(Cli_5306,Sess_5308,Nc_7955)
                                    )
                                    else
                                        {10066}let pkDisco_7961: bitstring = pub(sk(Disco_5307)) in
                                        {10067}in(c, (=pkCli_7927,em1_7962: bitstring));
                                        {10068}let m1_7963: bitstring = em1_7962 in
                                        {10069}let (=OpenSecureChannelRequest,=pkCli_7927,wNc_7964: bitstring) = m1_7963 in
                                        {10070}let Nc_7965: bitstring = dec(wNc_7964,skSess_7924) in
                                        {10071}new Ns_7966: bitstring;
                                        {10072}new ST_7967: bitstring;
                                        {10073}new TTL_7968: bitstring;
                                        {10074}let wNs_7969: bitstring = enc(Ns_7966,pkCli_7927) in
                                        {10075}let m2_7970: bitstring = (OpenSecureChannelResponse,wNs_7969,ST_7967,TTL_7968) in
                                        {10076}event beginSrv(Sess_5308,Cli_5306,Ns_7966);
                                        {10077}out(c, m2_7970);
                                        {10078}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                        {10079}event endSrv(Cli_5306,Sess_5308,Nc_7965)
                                )
                                else
                                    {10080}let pkDisco_7971: bitstring = fail-any in
                                    {10081}in(c, (=pkCli_7927,em1_7972: bitstring));
                                    {10082}let m1_7973: bitstring = em1_7972 in
                                    {10083}let (=OpenSecureChannelRequest,=pkCli_7927,wNc_7974: bitstring) = m1_7973 in
                                    {10084}let Nc_7975: bitstring = dec(wNc_7974,skSess_7924) in
                                    {10085}new Ns_7976: bitstring;
                                    {10086}new ST_7977: bitstring;
                                    {10087}new TTL_7978: bitstring;
                                    {10088}let wNs_7979: bitstring = enc(Ns_7976,pkCli_7927) in
                                    {10089}let m2_7980: bitstring = (OpenSecureChannelResponse,wNs_7979,ST_7977,TTL_7978) in
                                    {10090}event beginSrv(Sess_5308,Cli_5306,Ns_7976);
                                    {10091}out(c, m2_7980);
                                    {10092}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                    {10093}event endSrv(Cli_5306,Sess_5308,Nc_7975)
                        )
                        else
                            {10094}let pkDisco_7981: bitstring = fail-any in
                            {10095}in(c, (=pkCli_7927,em1_7982: bitstring));
                            {10096}let m1_7983: bitstring = em1_7982 in
                            {10097}let (=OpenSecureChannelRequest,=pkCli_7927,wNc_7984: bitstring) = m1_7983 in
                            {10098}let Nc_7985: bitstring = dec(wNc_7984,skSess_7924) in
                            {10099}new Ns_7986: bitstring;
                            {10100}new ST_7987: bitstring;
                            {10101}new TTL_7988: bitstring;
                            {10102}let wNs_7989: bitstring = enc(Ns_7986,pkCli_7927) in
                            {10103}let m2_7990: bitstring = (OpenSecureChannelResponse,wNs_7989,ST_7987,TTL_7988) in
                            {10104}event beginSrv(Sess_5308,Cli_5306,Ns_7986);
                            {10105}out(c, m2_7990);
                            {10106}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                            {10107}event endSrv(Cli_5306,Sess_5308,Nc_7985)
                )
                else
                    {10108}let pkDisco_7991: bitstring = fail-any in
                    {10109}in(c, (=pkCli_7927,em1_7992: bitstring));
                    {10110}let m1_7993: bitstring = em1_7992 in
                    {10111}let (=OpenSecureChannelRequest,=pkCli_7927,wNc_7994: bitstring) = m1_7993 in
                    {10112}let Nc_7995: bitstring = dec(wNc_7994,skSess_7924) in
                    {10113}new Ns_7996: bitstring;
                    {10114}new ST_7997: bitstring;
                    {10115}new TTL_7998: bitstring;
                    {10116}let wNs_7999: bitstring = enc(Ns_7996,pkCli_7927) in
                    {10117}let m2_8000: bitstring = (OpenSecureChannelResponse,wNs_7999,ST_7997,TTL_7998) in
                    {10118}event beginSrv(Sess_5308,Cli_5306,Ns_7996);
                    {10119}out(c, m2_8000);
                    {10120}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                    {10121}event endSrv(Cli_5306,Sess_5308,Nc_7995)
            )
            else
                {10122}let v_8001: bool = (Cli_5306 = B) in
                (
                    {10123}if v_8001 then
                    (
                        {10124}let pkCli_8002: bitstring = pub(skB) in
                        {10125}let v_8003: bool = (Disco_5307 = A) in
                        (
                            {10126}if v_8003 then
                            (
                                {10127}let pkDisco_8004: bitstring = pub(skA) in
                                {10128}in(c, (=pkCli_8002,em1_8005: bitstring));
                                {10129}let m1_8006: bitstring = em1_8005 in
                                {10130}let (=OpenSecureChannelRequest,=pkCli_8002,wNc_8007: bitstring) = m1_8006 in
                                {10131}let Nc_8008: bitstring = dec(wNc_8007,skSess_7924) in
                                {10132}new Ns_8009: bitstring;
                                {10133}new ST_8010: bitstring;
                                {10134}new TTL_8011: bitstring;
                                {10135}let wNs_8012: bitstring = enc(Ns_8009,pkCli_8002) in
                                {10136}let m2_8013: bitstring = (OpenSecureChannelResponse,wNs_8012,ST_8010,TTL_8011) in
                                {10137}event beginSrv(Sess_5308,Cli_5306,Ns_8009);
                                {10138}out(c, m2_8013);
                                {10139}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                {10140}event endSrv(Cli_5306,Sess_5308,Nc_8008)
                            )
                            else
                                {10141}let v_8014: bool = (Disco_5307 = B) in
                                (
                                    {10142}if v_8014 then
                                    (
                                        {10143}let pkDisco_8015: bitstring = pub(skB) in
                                        {10144}in(c, (=pkCli_8002,em1_8016: bitstring));
                                        {10145}let m1_8017: bitstring = em1_8016 in
                                        {10146}let (=OpenSecureChannelRequest,=pkCli_8002,wNc_8018: bitstring) = m1_8017 in
                                        {10147}let Nc_8019: bitstring = dec(wNc_8018,skSess_7924) in
                                        {10148}new Ns_8020: bitstring;
                                        {10149}new ST_8021: bitstring;
                                        {10150}new TTL_8022: bitstring;
                                        {10151}let wNs_8023: bitstring = enc(Ns_8020,pkCli_8002) in
                                        {10152}let m2_8024: bitstring = (OpenSecureChannelResponse,wNs_8023,ST_8021,TTL_8022) in
                                        {10153}event beginSrv(Sess_5308,Cli_5306,Ns_8020);
                                        {10154}out(c, m2_8024);
                                        {10155}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                        {10156}event endSrv(Cli_5306,Sess_5308,Nc_8019)
                                    )
                                    else
                                        {10157}let v_8025: bool = (Disco_5307 = C) in
                                        (
                                            {10158}if v_8025 then
                                            (
                                                {10159}let pkDisco_8026: bitstring = pub(skC) in
                                                {10160}in(c, (=pkCli_8002,em1_8027: bitstring));
                                                {10161}let m1_8028: bitstring = em1_8027 in
                                                {10162}let (=OpenSecureChannelRequest,=pkCli_8002,wNc_8029: bitstring) = m1_8028 in
                                                {10163}let Nc_8030: bitstring = dec(wNc_8029,skSess_7924) in
                                                {10164}new Ns_8031: bitstring;
                                                {10165}new ST_8032: bitstring;
                                                {10166}new TTL_8033: bitstring;
                                                {10167}let wNs_8034: bitstring = enc(Ns_8031,pkCli_8002) in
                                                {10168}let m2_8035: bitstring = (OpenSecureChannelResponse,wNs_8034,ST_8032,TTL_8033) in
                                                {10169}event beginSrv(Sess_5308,Cli_5306,Ns_8031);
                                                {10170}out(c, m2_8035);
                                                {10171}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                                {10172}event endSrv(Cli_5306,Sess_5308,Nc_8030)
                                            )
                                            else
                                                {10173}let pkDisco_8036: bitstring = pub(sk(Disco_5307)) in
                                                {10174}in(c, (=pkCli_8002,em1_8037: bitstring));
                                                {10175}let m1_8038: bitstring = em1_8037 in
                                                {10176}let (=OpenSecureChannelRequest,=pkCli_8002,wNc_8039: bitstring) = m1_8038 in
                                                {10177}let Nc_8040: bitstring = dec(wNc_8039,skSess_7924) in
                                                {10178}new Ns_8041: bitstring;
                                                {10179}new ST_8042: bitstring;
                                                {10180}new TTL_8043: bitstring;
                                                {10181}let wNs_8044: bitstring = enc(Ns_8041,pkCli_8002) in
                                                {10182}let m2_8045: bitstring = (OpenSecureChannelResponse,wNs_8044,ST_8042,TTL_8043) in
                                                {10183}event beginSrv(Sess_5308,Cli_5306,Ns_8041);
                                                {10184}out(c, m2_8045);
                                                {10185}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                                {10186}event endSrv(Cli_5306,Sess_5308,Nc_8040)
                                        )
                                        else
                                            {10187}let pkDisco_8046: bitstring = fail-any in
                                            {10188}in(c, (=pkCli_8002,em1_8047: bitstring));
                                            {10189}let m1_8048: bitstring = em1_8047 in
                                            {10190}let (=OpenSecureChannelRequest,=pkCli_8002,wNc_8049: bitstring) = m1_8048 in
                                            {10191}let Nc_8050: bitstring = dec(wNc_8049,skSess_7924) in
                                            {10192}new Ns_8051: bitstring;
                                            {10193}new ST_8052: bitstring;
                                            {10194}new TTL_8053: bitstring;
                                            {10195}let wNs_8054: bitstring = enc(Ns_8051,pkCli_8002) in
                                            {10196}let m2_8055: bitstring = (OpenSecureChannelResponse,wNs_8054,ST_8052,TTL_8053) in
                                            {10197}event beginSrv(Sess_5308,Cli_5306,Ns_8051);
                                            {10198}out(c, m2_8055);
                                            {10199}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                            {10200}event endSrv(Cli_5306,Sess_5308,Nc_8050)
                                )
                                else
                                    {10201}let pkDisco_8056: bitstring = fail-any in
                                    {10202}in(c, (=pkCli_8002,em1_8057: bitstring));
                                    {10203}let m1_8058: bitstring = em1_8057 in
                                    {10204}let (=OpenSecureChannelRequest,=pkCli_8002,wNc_8059: bitstring) = m1_8058 in
                                    {10205}let Nc_8060: bitstring = dec(wNc_8059,skSess_7924) in
                                    {10206}new Ns_8061: bitstring;
                                    {10207}new ST_8062: bitstring;
                                    {10208}new TTL_8063: bitstring;
                                    {10209}let wNs_8064: bitstring = enc(Ns_8061,pkCli_8002) in
                                    {10210}let m2_8065: bitstring = (OpenSecureChannelResponse,wNs_8064,ST_8062,TTL_8063) in
                                    {10211}event beginSrv(Sess_5308,Cli_5306,Ns_8061);
                                    {10212}out(c, m2_8065);
                                    {10213}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                    {10214}event endSrv(Cli_5306,Sess_5308,Nc_8060)
                        )
                        else
                            {10215}let pkDisco_8066: bitstring = fail-any in
                            {10216}in(c, (=pkCli_8002,em1_8067: bitstring));
                            {10217}let m1_8068: bitstring = em1_8067 in
                            {10218}let (=OpenSecureChannelRequest,=pkCli_8002,wNc_8069: bitstring) = m1_8068 in
                            {10219}let Nc_8070: bitstring = dec(wNc_8069,skSess_7924) in
                            {10220}new Ns_8071: bitstring;
                            {10221}new ST_8072: bitstring;
                            {10222}new TTL_8073: bitstring;
                            {10223}let wNs_8074: bitstring = enc(Ns_8071,pkCli_8002) in
                            {10224}let m2_8075: bitstring = (OpenSecureChannelResponse,wNs_8074,ST_8072,TTL_8073) in
                            {10225}event beginSrv(Sess_5308,Cli_5306,Ns_8071);
                            {10226}out(c, m2_8075);
                            {10227}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                            {10228}event endSrv(Cli_5306,Sess_5308,Nc_8070)
                    )
                    else
                        {10229}let v_8076: bool = (Cli_5306 = C) in
                        (
                            {10230}if v_8076 then
                            (
                                {10231}let pkCli_8077: bitstring = pub(skC) in
                                {10232}let v_8078: bool = (Disco_5307 = A) in
                                (
                                    {10233}if v_8078 then
                                    (
                                        {10234}let pkDisco_8079: bitstring = pub(skA) in
                                        {10235}in(c, (=pkCli_8077,em1_8080: bitstring));
                                        {10236}let m1_8081: bitstring = em1_8080 in
                                        {10237}let (=OpenSecureChannelRequest,=pkCli_8077,wNc_8082: bitstring) = m1_8081 in
                                        {10238}let Nc_8083: bitstring = dec(wNc_8082,skSess_7924) in
                                        {10239}new Ns_8084: bitstring;
                                        {10240}new ST_8085: bitstring;
                                        {10241}new TTL_8086: bitstring;
                                        {10242}let wNs_8087: bitstring = enc(Ns_8084,pkCli_8077) in
                                        {10243}let m2_8088: bitstring = (OpenSecureChannelResponse,wNs_8087,ST_8085,TTL_8086) in
                                        {10244}event beginSrv(Sess_5308,Cli_5306,Ns_8084);
                                        {10245}out(c, m2_8088);
                                        {10246}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                        {10247}event endSrv(Cli_5306,Sess_5308,Nc_8083)
                                    )
                                    else
                                        {10248}let v_8089: bool = (Disco_5307 = B) in
                                        (
                                            {10249}if v_8089 then
                                            (
                                                {10250}let pkDisco_8090: bitstring = pub(skB) in
                                                {10251}in(c, (=pkCli_8077,em1_8091: bitstring));
                                                {10252}let m1_8092: bitstring = em1_8091 in
                                                {10253}let (=OpenSecureChannelRequest,=pkCli_8077,wNc_8093: bitstring) = m1_8092 in
                                                {10254}let Nc_8094: bitstring = dec(wNc_8093,skSess_7924) in
                                                {10255}new Ns_8095: bitstring;
                                                {10256}new ST_8096: bitstring;
                                                {10257}new TTL_8097: bitstring;
                                                {10258}let wNs_8098: bitstring = enc(Ns_8095,pkCli_8077) in
                                                {10259}let m2_8099: bitstring = (OpenSecureChannelResponse,wNs_8098,ST_8096,TTL_8097) in
                                                {10260}event beginSrv(Sess_5308,Cli_5306,Ns_8095);
                                                {10261}out(c, m2_8099);
                                                {10262}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                                {10263}event endSrv(Cli_5306,Sess_5308,Nc_8094)
                                            )
                                            else
                                                {10264}let v_8100: bool = (Disco_5307 = C) in
                                                (
                                                    {10265}if v_8100 then
                                                    (
                                                        {10266}let pkDisco_8101: bitstring = pub(skC) in
                                                        {10267}in(c, (=pkCli_8077,em1_8102: bitstring));
                                                        {10268}let m1_8103: bitstring = em1_8102 in
                                                        {10269}let (=OpenSecureChannelRequest,=pkCli_8077,wNc_8104: bitstring) = m1_8103 in
                                                        {10270}let Nc_8105: bitstring = dec(wNc_8104,skSess_7924) in
                                                        {10271}new Ns_8106: bitstring;
                                                        {10272}new ST_8107: bitstring;
                                                        {10273}new TTL_8108: bitstring;
                                                        {10274}let wNs_8109: bitstring = enc(Ns_8106,pkCli_8077) in
                                                        {10275}let m2_8110: bitstring = (OpenSecureChannelResponse,wNs_8109,ST_8107,TTL_8108) in
                                                        {10276}event beginSrv(Sess_5308,Cli_5306,Ns_8106);
                                                        {10277}out(c, m2_8110);
                                                        {10278}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                                        {10279}event endSrv(Cli_5306,Sess_5308,Nc_8105)
                                                    )
                                                    else
                                                        {10280}let pkDisco_8111: bitstring = pub(sk(Disco_5307)) in
                                                        {10281}in(c, (=pkCli_8077,em1_8112: bitstring));
                                                        {10282}let m1_8113: bitstring = em1_8112 in
                                                        {10283}let (=OpenSecureChannelRequest,=pkCli_8077,wNc_8114: bitstring) = m1_8113 in
                                                        {10284}let Nc_8115: bitstring = dec(wNc_8114,skSess_7924) in
                                                        {10285}new Ns_8116: bitstring;
                                                        {10286}new ST_8117: bitstring;
                                                        {10287}new TTL_8118: bitstring;
                                                        {10288}let wNs_8119: bitstring = enc(Ns_8116,pkCli_8077) in
                                                        {10289}let m2_8120: bitstring = (OpenSecureChannelResponse,wNs_8119,ST_8117,TTL_8118) in
                                                        {10290}event beginSrv(Sess_5308,Cli_5306,Ns_8116);
                                                        {10291}out(c, m2_8120);
                                                        {10292}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                                        {10293}event endSrv(Cli_5306,Sess_5308,Nc_8115)
                                                )
                                                else
                                                    {10294}let pkDisco_8121: bitstring = fail-any in
                                                    {10295}in(c, (=pkCli_8077,em1_8122: bitstring));
                                                    {10296}let m1_8123: bitstring = em1_8122 in
                                                    {10297}let (=OpenSecureChannelRequest,=pkCli_8077,wNc_8124: bitstring) = m1_8123 in
                                                    {10298}let Nc_8125: bitstring = dec(wNc_8124,skSess_7924) in
                                                    {10299}new Ns_8126: bitstring;
                                                    {10300}new ST_8127: bitstring;
                                                    {10301}new TTL_8128: bitstring;
                                                    {10302}let wNs_8129: bitstring = enc(Ns_8126,pkCli_8077) in
                                                    {10303}let m2_8130: bitstring = (OpenSecureChannelResponse,wNs_8129,ST_8127,TTL_8128) in
                                                    {10304}event beginSrv(Sess_5308,Cli_5306,Ns_8126);
                                                    {10305}out(c, m2_8130);
                                                    {10306}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                                    {10307}event endSrv(Cli_5306,Sess_5308,Nc_8125)
                                        )
                                        else
                                            {10308}let pkDisco_8131: bitstring = fail-any in
                                            {10309}in(c, (=pkCli_8077,em1_8132: bitstring));
                                            {10310}let m1_8133: bitstring = em1_8132 in
                                            {10311}let (=OpenSecureChannelRequest,=pkCli_8077,wNc_8134: bitstring) = m1_8133 in
                                            {10312}let Nc_8135: bitstring = dec(wNc_8134,skSess_7924) in
                                            {10313}new Ns_8136: bitstring;
                                            {10314}new ST_8137: bitstring;
                                            {10315}new TTL_8138: bitstring;
                                            {10316}let wNs_8139: bitstring = enc(Ns_8136,pkCli_8077) in
                                            {10317}let m2_8140: bitstring = (OpenSecureChannelResponse,wNs_8139,ST_8137,TTL_8138) in
                                            {10318}event beginSrv(Sess_5308,Cli_5306,Ns_8136);
                                            {10319}out(c, m2_8140);
                                            {10320}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                            {10321}event endSrv(Cli_5306,Sess_5308,Nc_8135)
                                )
                                else
                                    {10322}let pkDisco_8141: bitstring = fail-any in
                                    {10323}in(c, (=pkCli_8077,em1_8142: bitstring));
                                    {10324}let m1_8143: bitstring = em1_8142 in
                                    {10325}let (=OpenSecureChannelRequest,=pkCli_8077,wNc_8144: bitstring) = m1_8143 in
                                    {10326}let Nc_8145: bitstring = dec(wNc_8144,skSess_7924) in
                                    {10327}new Ns_8146: bitstring;
                                    {10328}new ST_8147: bitstring;
                                    {10329}new TTL_8148: bitstring;
                                    {10330}let wNs_8149: bitstring = enc(Ns_8146,pkCli_8077) in
                                    {10331}let m2_8150: bitstring = (OpenSecureChannelResponse,wNs_8149,ST_8147,TTL_8148) in
                                    {10332}event beginSrv(Sess_5308,Cli_5306,Ns_8146);
                                    {10333}out(c, m2_8150);
                                    {10334}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                    {10335}event endSrv(Cli_5306,Sess_5308,Nc_8145)
                            )
                            else
                                {10336}let pkCli_8151: bitstring = pub(sk(Cli_5306)) in
                                {10337}let v_8152: bool = (Disco_5307 = A) in
                                (
                                    {10338}if v_8152 then
                                    (
                                        {10339}let pkDisco_8153: bitstring = pub(skA) in
                                        {10340}in(c, (=pkCli_8151,em1_8154: bitstring));
                                        {10341}let m1_8155: bitstring = em1_8154 in
                                        {10342}let (=OpenSecureChannelRequest,=pkCli_8151,wNc_8156: bitstring) = m1_8155 in
                                        {10343}let Nc_8157: bitstring = dec(wNc_8156,skSess_7924) in
                                        {10344}new Ns_8158: bitstring;
                                        {10345}new ST_8159: bitstring;
                                        {10346}new TTL_8160: bitstring;
                                        {10347}let wNs_8161: bitstring = enc(Ns_8158,pkCli_8151) in
                                        {10348}let m2_8162: bitstring = (OpenSecureChannelResponse,wNs_8161,ST_8159,TTL_8160) in
                                        {10349}event beginSrv(Sess_5308,Cli_5306,Ns_8158);
                                        {10350}out(c, m2_8162);
                                        {10351}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                        {10352}event endSrv(Cli_5306,Sess_5308,Nc_8157)
                                    )
                                    else
                                        {10353}let v_8163: bool = (Disco_5307 = B) in
                                        (
                                            {10354}if v_8163 then
                                            (
                                                {10355}let pkDisco_8164: bitstring = pub(skB) in
                                                {10356}in(c, (=pkCli_8151,em1_8165: bitstring));
                                                {10357}let m1_8166: bitstring = em1_8165 in
                                                {10358}let (=OpenSecureChannelRequest,=pkCli_8151,wNc_8167: bitstring) = m1_8166 in
                                                {10359}let Nc_8168: bitstring = dec(wNc_8167,skSess_7924) in
                                                {10360}new Ns_8169: bitstring;
                                                {10361}new ST_8170: bitstring;
                                                {10362}new TTL_8171: bitstring;
                                                {10363}let wNs_8172: bitstring = enc(Ns_8169,pkCli_8151) in
                                                {10364}let m2_8173: bitstring = (OpenSecureChannelResponse,wNs_8172,ST_8170,TTL_8171) in
                                                {10365}event beginSrv(Sess_5308,Cli_5306,Ns_8169);
                                                {10366}out(c, m2_8173);
                                                {10367}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                                {10368}event endSrv(Cli_5306,Sess_5308,Nc_8168)
                                            )
                                            else
                                                {10369}let v_8174: bool = (Disco_5307 = C) in
                                                (
                                                    {10370}if v_8174 then
                                                    (
                                                        {10371}let pkDisco_8175: bitstring = pub(skC) in
                                                        {10372}in(c, (=pkCli_8151,em1_8176: bitstring));
                                                        {10373}let m1_8177: bitstring = em1_8176 in
                                                        {10374}let (=OpenSecureChannelRequest,=pkCli_8151,wNc_8178: bitstring) = m1_8177 in
                                                        {10375}let Nc_8179: bitstring = dec(wNc_8178,skSess_7924) in
                                                        {10376}new Ns_8180: bitstring;
                                                        {10377}new ST_8181: bitstring;
                                                        {10378}new TTL_8182: bitstring;
                                                        {10379}let wNs_8183: bitstring = enc(Ns_8180,pkCli_8151) in
                                                        {10380}let m2_8184: bitstring = (OpenSecureChannelResponse,wNs_8183,ST_8181,TTL_8182) in
                                                        {10381}event beginSrv(Sess_5308,Cli_5306,Ns_8180);
                                                        {10382}out(c, m2_8184);
                                                        {10383}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                                        {10384}event endSrv(Cli_5306,Sess_5308,Nc_8179)
                                                    )
                                                    else
                                                        {10385}let pkDisco_8185: bitstring = pub(sk(Disco_5307)) in
                                                        {10386}in(c, (=pkCli_8151,em1_8186: bitstring));
                                                        {10387}let m1_8187: bitstring = em1_8186 in
                                                        {10388}let (=OpenSecureChannelRequest,=pkCli_8151,wNc_8188: bitstring) = m1_8187 in
                                                        {10389}let Nc_8189: bitstring = dec(wNc_8188,skSess_7924) in
                                                        {10390}new Ns_8190: bitstring;
                                                        {10391}new ST_8191: bitstring;
                                                        {10392}new TTL_8192: bitstring;
                                                        {10393}let wNs_8193: bitstring = enc(Ns_8190,pkCli_8151) in
                                                        {10394}let m2_8194: bitstring = (OpenSecureChannelResponse,wNs_8193,ST_8191,TTL_8192) in
                                                        {10395}event beginSrv(Sess_5308,Cli_5306,Ns_8190);
                                                        {10396}out(c, m2_8194);
                                                        {10397}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                                        {10398}event endSrv(Cli_5306,Sess_5308,Nc_8189)
                                                )
                                                else
                                                    {10399}let pkDisco_8195: bitstring = fail-any in
                                                    {10400}in(c, (=pkCli_8151,em1_8196: bitstring));
                                                    {10401}let m1_8197: bitstring = em1_8196 in
                                                    {10402}let (=OpenSecureChannelRequest,=pkCli_8151,wNc_8198: bitstring) = m1_8197 in
                                                    {10403}let Nc_8199: bitstring = dec(wNc_8198,skSess_7924) in
                                                    {10404}new Ns_8200: bitstring;
                                                    {10405}new ST_8201: bitstring;
                                                    {10406}new TTL_8202: bitstring;
                                                    {10407}let wNs_8203: bitstring = enc(Ns_8200,pkCli_8151) in
                                                    {10408}let m2_8204: bitstring = (OpenSecureChannelResponse,wNs_8203,ST_8201,TTL_8202) in
                                                    {10409}event beginSrv(Sess_5308,Cli_5306,Ns_8200);
                                                    {10410}out(c, m2_8204);
                                                    {10411}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                                    {10412}event endSrv(Cli_5306,Sess_5308,Nc_8199)
                                        )
                                        else
                                            {10413}let pkDisco_8205: bitstring = fail-any in
                                            {10414}in(c, (=pkCli_8151,em1_8206: bitstring));
                                            {10415}let m1_8207: bitstring = em1_8206 in
                                            {10416}let (=OpenSecureChannelRequest,=pkCli_8151,wNc_8208: bitstring) = m1_8207 in
                                            {10417}let Nc_8209: bitstring = dec(wNc_8208,skSess_7924) in
                                            {10418}new Ns_8210: bitstring;
                                            {10419}new ST_8211: bitstring;
                                            {10420}new TTL_8212: bitstring;
                                            {10421}let wNs_8213: bitstring = enc(Ns_8210,pkCli_8151) in
                                            {10422}let m2_8214: bitstring = (OpenSecureChannelResponse,wNs_8213,ST_8211,TTL_8212) in
                                            {10423}event beginSrv(Sess_5308,Cli_5306,Ns_8210);
                                            {10424}out(c, m2_8214);
                                            {10425}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                            {10426}event endSrv(Cli_5306,Sess_5308,Nc_8209)
                                )
                                else
                                    {10427}let pkDisco_8215: bitstring = fail-any in
                                    {10428}in(c, (=pkCli_8151,em1_8216: bitstring));
                                    {10429}let m1_8217: bitstring = em1_8216 in
                                    {10430}let (=OpenSecureChannelRequest,=pkCli_8151,wNc_8218: bitstring) = m1_8217 in
                                    {10431}let Nc_8219: bitstring = dec(wNc_8218,skSess_7924) in
                                    {10432}new Ns_8220: bitstring;
                                    {10433}new ST_8221: bitstring;
                                    {10434}new TTL_8222: bitstring;
                                    {10435}let wNs_8223: bitstring = enc(Ns_8220,pkCli_8151) in
                                    {10436}let m2_8224: bitstring = (OpenSecureChannelResponse,wNs_8223,ST_8221,TTL_8222) in
                                    {10437}event beginSrv(Sess_5308,Cli_5306,Ns_8220);
                                    {10438}out(c, m2_8224);
                                    {10439}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                    {10440}event endSrv(Cli_5306,Sess_5308,Nc_8219)
                        )
                        else
                            {10441}let pkCli_8225: bitstring = fail-any in
                            {10442}let v_8226: bool = (Disco_5307 = A) in
                            (
                                {10443}if v_8226 then
                                (
                                    {10444}let pkDisco_8227: bitstring = pub(skA) in
                                    {10445}in(c, (=pkCli_8225,em1_8228: bitstring));
                                    {10446}let m1_8229: bitstring = em1_8228 in
                                    {10447}let (=OpenSecureChannelRequest,=pkCli_8225,wNc_8230: bitstring) = m1_8229 in
                                    {10448}let Nc_8231: bitstring = dec(wNc_8230,skSess_7924) in
                                    {10449}new Ns_8232: bitstring;
                                    {10450}new ST_8233: bitstring;
                                    {10451}new TTL_8234: bitstring;
                                    {10452}let wNs_8235: bitstring = enc(Ns_8232,pkCli_8225) in
                                    {10453}let m2_8236: bitstring = (OpenSecureChannelResponse,wNs_8235,ST_8233,TTL_8234) in
                                    {10454}event beginSrv(Sess_5308,Cli_5306,Ns_8232);
                                    {10455}out(c, m2_8236);
                                    {10456}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                    {10457}event endSrv(Cli_5306,Sess_5308,Nc_8231)
                                )
                                else
                                    {10458}let v_8237: bool = (Disco_5307 = B) in
                                    (
                                        {10459}if v_8237 then
                                        (
                                            {10460}let pkDisco_8238: bitstring = pub(skB) in
                                            {10461}in(c, (=pkCli_8225,em1_8239: bitstring));
                                            {10462}let m1_8240: bitstring = em1_8239 in
                                            {10463}let (=OpenSecureChannelRequest,=pkCli_8225,wNc_8241: bitstring) = m1_8240 in
                                            {10464}let Nc_8242: bitstring = dec(wNc_8241,skSess_7924) in
                                            {10465}new Ns_8243: bitstring;
                                            {10466}new ST_8244: bitstring;
                                            {10467}new TTL_8245: bitstring;
                                            {10468}let wNs_8246: bitstring = enc(Ns_8243,pkCli_8225) in
                                            {10469}let m2_8247: bitstring = (OpenSecureChannelResponse,wNs_8246,ST_8244,TTL_8245) in
                                            {10470}event beginSrv(Sess_5308,Cli_5306,Ns_8243);
                                            {10471}out(c, m2_8247);
                                            {10472}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                            {10473}event endSrv(Cli_5306,Sess_5308,Nc_8242)
                                        )
                                        else
                                            {10474}let v_8248: bool = (Disco_5307 = C) in
                                            (
                                                {10475}if v_8248 then
                                                (
                                                    {10476}let pkDisco_8249: bitstring = pub(skC) in
                                                    {10477}in(c, (=pkCli_8225,em1_8250: bitstring));
                                                    {10478}let m1_8251: bitstring = em1_8250 in
                                                    {10479}let (=OpenSecureChannelRequest,=pkCli_8225,wNc_8252: bitstring) = m1_8251 in
                                                    {10480}let Nc_8253: bitstring = dec(wNc_8252,skSess_7924) in
                                                    {10481}new Ns_8254: bitstring;
                                                    {10482}new ST_8255: bitstring;
                                                    {10483}new TTL_8256: bitstring;
                                                    {10484}let wNs_8257: bitstring = enc(Ns_8254,pkCli_8225) in
                                                    {10485}let m2_8258: bitstring = (OpenSecureChannelResponse,wNs_8257,ST_8255,TTL_8256) in
                                                    {10486}event beginSrv(Sess_5308,Cli_5306,Ns_8254);
                                                    {10487}out(c, m2_8258);
                                                    {10488}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                                    {10489}event endSrv(Cli_5306,Sess_5308,Nc_8253)
                                                )
                                                else
                                                    {10490}let pkDisco_8259: bitstring = pub(sk(Disco_5307)) in
                                                    {10491}in(c, (=pkCli_8225,em1_8260: bitstring));
                                                    {10492}let m1_8261: bitstring = em1_8260 in
                                                    {10493}let (=OpenSecureChannelRequest,=pkCli_8225,wNc_8262: bitstring) = m1_8261 in
                                                    {10494}let Nc_8263: bitstring = dec(wNc_8262,skSess_7924) in
                                                    {10495}new Ns_8264: bitstring;
                                                    {10496}new ST_8265: bitstring;
                                                    {10497}new TTL_8266: bitstring;
                                                    {10498}let wNs_8267: bitstring = enc(Ns_8264,pkCli_8225) in
                                                    {10499}let m2_8268: bitstring = (OpenSecureChannelResponse,wNs_8267,ST_8265,TTL_8266) in
                                                    {10500}event beginSrv(Sess_5308,Cli_5306,Ns_8264);
                                                    {10501}out(c, m2_8268);
                                                    {10502}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                                    {10503}event endSrv(Cli_5306,Sess_5308,Nc_8263)
                                            )
                                            else
                                                {10504}let pkDisco_8269: bitstring = fail-any in
                                                {10505}in(c, (=pkCli_8225,em1_8270: bitstring));
                                                {10506}let m1_8271: bitstring = em1_8270 in
                                                {10507}let (=OpenSecureChannelRequest,=pkCli_8225,wNc_8272: bitstring) = m1_8271 in
                                                {10508}let Nc_8273: bitstring = dec(wNc_8272,skSess_7924) in
                                                {10509}new Ns_8274: bitstring;
                                                {10510}new ST_8275: bitstring;
                                                {10511}new TTL_8276: bitstring;
                                                {10512}let wNs_8277: bitstring = enc(Ns_8274,pkCli_8225) in
                                                {10513}let m2_8278: bitstring = (OpenSecureChannelResponse,wNs_8277,ST_8275,TTL_8276) in
                                                {10514}event beginSrv(Sess_5308,Cli_5306,Ns_8274);
                                                {10515}out(c, m2_8278);
                                                {10516}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                                {10517}event endSrv(Cli_5306,Sess_5308,Nc_8273)
                                    )
                                    else
                                        {10518}let pkDisco_8279: bitstring = fail-any in
                                        {10519}in(c, (=pkCli_8225,em1_8280: bitstring));
                                        {10520}let m1_8281: bitstring = em1_8280 in
                                        {10521}let (=OpenSecureChannelRequest,=pkCli_8225,wNc_8282: bitstring) = m1_8281 in
                                        {10522}let Nc_8283: bitstring = dec(wNc_8282,skSess_7924) in
                                        {10523}new Ns_8284: bitstring;
                                        {10524}new ST_8285: bitstring;
                                        {10525}new TTL_8286: bitstring;
                                        {10526}let wNs_8287: bitstring = enc(Ns_8284,pkCli_8225) in
                                        {10527}let m2_8288: bitstring = (OpenSecureChannelResponse,wNs_8287,ST_8285,TTL_8286) in
                                        {10528}event beginSrv(Sess_5308,Cli_5306,Ns_8284);
                                        {10529}out(c, m2_8288);
                                        {10530}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                        {10531}event endSrv(Cli_5306,Sess_5308,Nc_8283)
                            )
                            else
                                {10532}let pkDisco_8289: bitstring = fail-any in
                                {10533}in(c, (=pkCli_8225,em1_8290: bitstring));
                                {10534}let m1_8291: bitstring = em1_8290 in
                                {10535}let (=OpenSecureChannelRequest,=pkCli_8225,wNc_8292: bitstring) = m1_8291 in
                                {10536}let Nc_8293: bitstring = dec(wNc_8292,skSess_7924) in
                                {10537}new Ns_8294: bitstring;
                                {10538}new ST_8295: bitstring;
                                {10539}new TTL_8296: bitstring;
                                {10540}let wNs_8297: bitstring = enc(Ns_8294,pkCli_8225) in
                                {10541}let m2_8298: bitstring = (OpenSecureChannelResponse,wNs_8297,ST_8295,TTL_8296) in
                                {10542}event beginSrv(Sess_5308,Cli_5306,Ns_8294);
                                {10543}out(c, m2_8298);
                                {10544}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                {10545}event endSrv(Cli_5306,Sess_5308,Nc_8293)
                )
                else
                    {10546}let pkCli_8299: bitstring = fail-any in
                    {10547}let v_8300: bool = (Disco_5307 = A) in
                    (
                        {10548}if v_8300 then
                        (
                            {10549}let pkDisco_8301: bitstring = pub(skA) in
                            {10550}in(c, (=pkCli_8299,em1_8302: bitstring));
                            {10551}let m1_8303: bitstring = em1_8302 in
                            {10552}let (=OpenSecureChannelRequest,=pkCli_8299,wNc_8304: bitstring) = m1_8303 in
                            {10553}let Nc_8305: bitstring = dec(wNc_8304,skSess_7924) in
                            {10554}new Ns_8306: bitstring;
                            {10555}new ST_8307: bitstring;
                            {10556}new TTL_8308: bitstring;
                            {10557}let wNs_8309: bitstring = enc(Ns_8306,pkCli_8299) in
                            {10558}let m2_8310: bitstring = (OpenSecureChannelResponse,wNs_8309,ST_8307,TTL_8308) in
                            {10559}event beginSrv(Sess_5308,Cli_5306,Ns_8306);
                            {10560}out(c, m2_8310);
                            {10561}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                            {10562}event endSrv(Cli_5306,Sess_5308,Nc_8305)
                        )
                        else
                            {10563}let v_8311: bool = (Disco_5307 = B) in
                            (
                                {10564}if v_8311 then
                                (
                                    {10565}let pkDisco_8312: bitstring = pub(skB) in
                                    {10566}in(c, (=pkCli_8299,em1_8313: bitstring));
                                    {10567}let m1_8314: bitstring = em1_8313 in
                                    {10568}let (=OpenSecureChannelRequest,=pkCli_8299,wNc_8315: bitstring) = m1_8314 in
                                    {10569}let Nc_8316: bitstring = dec(wNc_8315,skSess_7924) in
                                    {10570}new Ns_8317: bitstring;
                                    {10571}new ST_8318: bitstring;
                                    {10572}new TTL_8319: bitstring;
                                    {10573}let wNs_8320: bitstring = enc(Ns_8317,pkCli_8299) in
                                    {10574}let m2_8321: bitstring = (OpenSecureChannelResponse,wNs_8320,ST_8318,TTL_8319) in
                                    {10575}event beginSrv(Sess_5308,Cli_5306,Ns_8317);
                                    {10576}out(c, m2_8321);
                                    {10577}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                    {10578}event endSrv(Cli_5306,Sess_5308,Nc_8316)
                                )
                                else
                                    {10579}let v_8322: bool = (Disco_5307 = C) in
                                    (
                                        {10580}if v_8322 then
                                        (
                                            {10581}let pkDisco_8323: bitstring = pub(skC) in
                                            {10582}in(c, (=pkCli_8299,em1_8324: bitstring));
                                            {10583}let m1_8325: bitstring = em1_8324 in
                                            {10584}let (=OpenSecureChannelRequest,=pkCli_8299,wNc_8326: bitstring) = m1_8325 in
                                            {10585}let Nc_8327: bitstring = dec(wNc_8326,skSess_7924) in
                                            {10586}new Ns_8328: bitstring;
                                            {10587}new ST_8329: bitstring;
                                            {10588}new TTL_8330: bitstring;
                                            {10589}let wNs_8331: bitstring = enc(Ns_8328,pkCli_8299) in
                                            {10590}let m2_8332: bitstring = (OpenSecureChannelResponse,wNs_8331,ST_8329,TTL_8330) in
                                            {10591}event beginSrv(Sess_5308,Cli_5306,Ns_8328);
                                            {10592}out(c, m2_8332);
                                            {10593}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                            {10594}event endSrv(Cli_5306,Sess_5308,Nc_8327)
                                        )
                                        else
                                            {10595}let pkDisco_8333: bitstring = pub(sk(Disco_5307)) in
                                            {10596}in(c, (=pkCli_8299,em1_8334: bitstring));
                                            {10597}let m1_8335: bitstring = em1_8334 in
                                            {10598}let (=OpenSecureChannelRequest,=pkCli_8299,wNc_8336: bitstring) = m1_8335 in
                                            {10599}let Nc_8337: bitstring = dec(wNc_8336,skSess_7924) in
                                            {10600}new Ns_8338: bitstring;
                                            {10601}new ST_8339: bitstring;
                                            {10602}new TTL_8340: bitstring;
                                            {10603}let wNs_8341: bitstring = enc(Ns_8338,pkCli_8299) in
                                            {10604}let m2_8342: bitstring = (OpenSecureChannelResponse,wNs_8341,ST_8339,TTL_8340) in
                                            {10605}event beginSrv(Sess_5308,Cli_5306,Ns_8338);
                                            {10606}out(c, m2_8342);
                                            {10607}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                            {10608}event endSrv(Cli_5306,Sess_5308,Nc_8337)
                                    )
                                    else
                                        {10609}let pkDisco_8343: bitstring = fail-any in
                                        {10610}in(c, (=pkCli_8299,em1_8344: bitstring));
                                        {10611}let m1_8345: bitstring = em1_8344 in
                                        {10612}let (=OpenSecureChannelRequest,=pkCli_8299,wNc_8346: bitstring) = m1_8345 in
                                        {10613}let Nc_8347: bitstring = dec(wNc_8346,skSess_7924) in
                                        {10614}new Ns_8348: bitstring;
                                        {10615}new ST_8349: bitstring;
                                        {10616}new TTL_8350: bitstring;
                                        {10617}let wNs_8351: bitstring = enc(Ns_8348,pkCli_8299) in
                                        {10618}let m2_8352: bitstring = (OpenSecureChannelResponse,wNs_8351,ST_8349,TTL_8350) in
                                        {10619}event beginSrv(Sess_5308,Cli_5306,Ns_8348);
                                        {10620}out(c, m2_8352);
                                        {10621}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                        {10622}event endSrv(Cli_5306,Sess_5308,Nc_8347)
                            )
                            else
                                {10623}let pkDisco_8353: bitstring = fail-any in
                                {10624}in(c, (=pkCli_8299,em1_8354: bitstring));
                                {10625}let m1_8355: bitstring = em1_8354 in
                                {10626}let (=OpenSecureChannelRequest,=pkCli_8299,wNc_8356: bitstring) = m1_8355 in
                                {10627}let Nc_8357: bitstring = dec(wNc_8356,skSess_7924) in
                                {10628}new Ns_8358: bitstring;
                                {10629}new ST_8359: bitstring;
                                {10630}new TTL_8360: bitstring;
                                {10631}let wNs_8361: bitstring = enc(Ns_8358,pkCli_8299) in
                                {10632}let m2_8362: bitstring = (OpenSecureChannelResponse,wNs_8361,ST_8359,TTL_8360) in
                                {10633}event beginSrv(Sess_5308,Cli_5306,Ns_8358);
                                {10634}out(c, m2_8362);
                                {10635}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                {10636}event endSrv(Cli_5306,Sess_5308,Nc_8357)
                    )
                    else
                        {10637}let pkDisco_8363: bitstring = fail-any in
                        {10638}in(c, (=pkCli_8299,em1_8364: bitstring));
                        {10639}let m1_8365: bitstring = em1_8364 in
                        {10640}let (=OpenSecureChannelRequest,=pkCli_8299,wNc_8366: bitstring) = m1_8365 in
                        {10641}let Nc_8367: bitstring = dec(wNc_8366,skSess_7924) in
                        {10642}new Ns_8368: bitstring;
                        {10643}new ST_8369: bitstring;
                        {10644}new TTL_8370: bitstring;
                        {10645}let wNs_8371: bitstring = enc(Ns_8368,pkCli_8299) in
                        {10646}let m2_8372: bitstring = (OpenSecureChannelResponse,wNs_8371,ST_8369,TTL_8370) in
                        {10647}event beginSrv(Sess_5308,Cli_5306,Ns_8368);
                        {10648}out(c, m2_8372);
                        {10649}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                        {10650}event endSrv(Cli_5306,Sess_5308,Nc_8367)
        )
        else
            {10651}let pkCli_8373: bitstring = fail-any in
            {10652}let v_8374: bool = (Disco_5307 = A) in
            (
                {10653}if v_8374 then
                (
                    {10654}let pkDisco_8375: bitstring = pub(skA) in
                    {10655}in(c, (=pkCli_8373,em1_8376: bitstring));
                    {10656}let m1_8377: bitstring = em1_8376 in
                    {10657}let (=OpenSecureChannelRequest,=pkCli_8373,wNc_8378: bitstring) = m1_8377 in
                    {10658}let Nc_8379: bitstring = dec(wNc_8378,skSess_7924) in
                    {10659}new Ns_8380: bitstring;
                    {10660}new ST_8381: bitstring;
                    {10661}new TTL_8382: bitstring;
                    {10662}let wNs_8383: bitstring = enc(Ns_8380,pkCli_8373) in
                    {10663}let m2_8384: bitstring = (OpenSecureChannelResponse,wNs_8383,ST_8381,TTL_8382) in
                    {10664}event beginSrv(Sess_5308,Cli_5306,Ns_8380);
                    {10665}out(c, m2_8384);
                    {10666}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                    {10667}event endSrv(Cli_5306,Sess_5308,Nc_8379)
                )
                else
                    {10668}let v_8385: bool = (Disco_5307 = B) in
                    (
                        {10669}if v_8385 then
                        (
                            {10670}let pkDisco_8386: bitstring = pub(skB) in
                            {10671}in(c, (=pkCli_8373,em1_8387: bitstring));
                            {10672}let m1_8388: bitstring = em1_8387 in
                            {10673}let (=OpenSecureChannelRequest,=pkCli_8373,wNc_8389: bitstring) = m1_8388 in
                            {10674}let Nc_8390: bitstring = dec(wNc_8389,skSess_7924) in
                            {10675}new Ns_8391: bitstring;
                            {10676}new ST_8392: bitstring;
                            {10677}new TTL_8393: bitstring;
                            {10678}let wNs_8394: bitstring = enc(Ns_8391,pkCli_8373) in
                            {10679}let m2_8395: bitstring = (OpenSecureChannelResponse,wNs_8394,ST_8392,TTL_8393) in
                            {10680}event beginSrv(Sess_5308,Cli_5306,Ns_8391);
                            {10681}out(c, m2_8395);
                            {10682}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                            {10683}event endSrv(Cli_5306,Sess_5308,Nc_8390)
                        )
                        else
                            {10684}let v_8396: bool = (Disco_5307 = C) in
                            (
                                {10685}if v_8396 then
                                (
                                    {10686}let pkDisco_8397: bitstring = pub(skC) in
                                    {10687}in(c, (=pkCli_8373,em1_8398: bitstring));
                                    {10688}let m1_8399: bitstring = em1_8398 in
                                    {10689}let (=OpenSecureChannelRequest,=pkCli_8373,wNc_8400: bitstring) = m1_8399 in
                                    {10690}let Nc_8401: bitstring = dec(wNc_8400,skSess_7924) in
                                    {10691}new Ns_8402: bitstring;
                                    {10692}new ST_8403: bitstring;
                                    {10693}new TTL_8404: bitstring;
                                    {10694}let wNs_8405: bitstring = enc(Ns_8402,pkCli_8373) in
                                    {10695}let m2_8406: bitstring = (OpenSecureChannelResponse,wNs_8405,ST_8403,TTL_8404) in
                                    {10696}event beginSrv(Sess_5308,Cli_5306,Ns_8402);
                                    {10697}out(c, m2_8406);
                                    {10698}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                    {10699}event endSrv(Cli_5306,Sess_5308,Nc_8401)
                                )
                                else
                                    {10700}let pkDisco_8407: bitstring = pub(sk(Disco_5307)) in
                                    {10701}in(c, (=pkCli_8373,em1_8408: bitstring));
                                    {10702}let m1_8409: bitstring = em1_8408 in
                                    {10703}let (=OpenSecureChannelRequest,=pkCli_8373,wNc_8410: bitstring) = m1_8409 in
                                    {10704}let Nc_8411: bitstring = dec(wNc_8410,skSess_7924) in
                                    {10705}new Ns_8412: bitstring;
                                    {10706}new ST_8413: bitstring;
                                    {10707}new TTL_8414: bitstring;
                                    {10708}let wNs_8415: bitstring = enc(Ns_8412,pkCli_8373) in
                                    {10709}let m2_8416: bitstring = (OpenSecureChannelResponse,wNs_8415,ST_8413,TTL_8414) in
                                    {10710}event beginSrv(Sess_5308,Cli_5306,Ns_8412);
                                    {10711}out(c, m2_8416);
                                    {10712}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                    {10713}event endSrv(Cli_5306,Sess_5308,Nc_8411)
                            )
                            else
                                {10714}let pkDisco_8417: bitstring = fail-any in
                                {10715}in(c, (=pkCli_8373,em1_8418: bitstring));
                                {10716}let m1_8419: bitstring = em1_8418 in
                                {10717}let (=OpenSecureChannelRequest,=pkCli_8373,wNc_8420: bitstring) = m1_8419 in
                                {10718}let Nc_8421: bitstring = dec(wNc_8420,skSess_7924) in
                                {10719}new Ns_8422: bitstring;
                                {10720}new ST_8423: bitstring;
                                {10721}new TTL_8424: bitstring;
                                {10722}let wNs_8425: bitstring = enc(Ns_8422,pkCli_8373) in
                                {10723}let m2_8426: bitstring = (OpenSecureChannelResponse,wNs_8425,ST_8423,TTL_8424) in
                                {10724}event beginSrv(Sess_5308,Cli_5306,Ns_8422);
                                {10725}out(c, m2_8426);
                                {10726}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                                {10727}event endSrv(Cli_5306,Sess_5308,Nc_8421)
                    )
                    else
                        {10728}let pkDisco_8427: bitstring = fail-any in
                        {10729}in(c, (=pkCli_8373,em1_8428: bitstring));
                        {10730}let m1_8429: bitstring = em1_8428 in
                        {10731}let (=OpenSecureChannelRequest,=pkCli_8373,wNc_8430: bitstring) = m1_8429 in
                        {10732}let Nc_8431: bitstring = dec(wNc_8430,skSess_7924) in
                        {10733}new Ns_8432: bitstring;
                        {10734}new ST_8433: bitstring;
                        {10735}new TTL_8434: bitstring;
                        {10736}let wNs_8435: bitstring = enc(Ns_8432,pkCli_8373) in
                        {10737}let m2_8436: bitstring = (OpenSecureChannelResponse,wNs_8435,ST_8433,TTL_8434) in
                        {10738}event beginSrv(Sess_5308,Cli_5306,Ns_8432);
                        {10739}out(c, m2_8436);
                        {10740}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                        {10741}event endSrv(Cli_5306,Sess_5308,Nc_8431)
            )
            else
                {10742}let pkDisco_8437: bitstring = fail-any in
                {10743}in(c, (=pkCli_8373,em1_8438: bitstring));
                {10744}let m1_8439: bitstring = em1_8438 in
                {10745}let (=OpenSecureChannelRequest,=pkCli_8373,wNc_8440: bitstring) = m1_8439 in
                {10746}let Nc_8441: bitstring = dec(wNc_8440,skSess_7924) in
                {10747}new Ns_8442: bitstring;
                {10748}new ST_8443: bitstring;
                {10749}new TTL_8444: bitstring;
                {10750}let wNs_8445: bitstring = enc(Ns_8442,pkCli_8373) in
                {10751}let m2_8446: bitstring = (OpenSecureChannelResponse,wNs_8445,ST_8443,TTL_8444) in
                {10752}event beginSrv(Sess_5308,Cli_5306,Ns_8442);
                {10753}out(c, m2_8446);
                {10754}if ((Cli_5306 = A) || ((Cli_5306 = B) || (Cli_5306 = C))) then
                {10755}event endSrv(Cli_5306,Sess_5308,Nc_8441)
)

-- Query event(endCli(X,Y,N)) ==> event(beginSrv(X,Y,N))
Completing...
200 rules inserted. The rule base contains 73 rules. 310 rules in the queue.
400 rules inserted. The rule base contains 109 rules. 310 rules in the queue.
600 rules inserted. The rule base contains 109 rules. 308 rules in the queue.
800 rules inserted. The rule base contains 112 rules. 291 rules in the queue.
1000 rules inserted. The rule base contains 85 rules. 282 rules in the queue.
1200 rules inserted. The rule base contains 157 rules. 226 rules in the queue.
1400 rules inserted. The rule base contains 223 rules. 238 rules in the queue.
1600 rules inserted. The rule base contains 324 rules. 299 rules in the queue.
1800 rules inserted. The rule base contains 399 rules. 265 rules in the queue.
2000 rules inserted. The rule base contains 433 rules. 246 rules in the queue.
2200 rules inserted. The rule base contains 447 rules. 232 rules in the queue.
2400 rules inserted. The rule base contains 463 rules. 216 rules in the queue.
2600 rules inserted. The rule base contains 465 rules. 214 rules in the queue.
2800 rules inserted. The rule base contains 477 rules. 202 rules in the queue.
3000 rules inserted. The rule base contains 545 rules. 134 rules in the queue.
Starting query event(endCli(X,Y,N)) ==> event(beginSrv(X,Y,N))
goal reachable: attacker(SP_55656) && attacker(UP_55657) -> end(endCli(B[],A[],Nc_1835[UP_1834 = UP_55657,SP_1833 = SP_55656,Sess = A[],Disco = B[],Cli = C[],!1 = @sid_55658]))
Abbreviations:
Nc_57523 = Nc_1835[UP_1834 = UP_57495,SP_1833 = SP_57494,Sess = A[],Disco = B[],Cli = C[],!1 = @sid_57496]

1. The attacker initially knows B[].
attacker(B[]).

2. The attacker initially knows A[].
attacker(A[]).

3. By 2, the attacker may know A[].
By 2, the attacker may know A[].
By 1, the attacker may know B[].
Using the function 3-tuple the attacker may obtain (A[],A[],B[]).
attacker((A[],A[],B[])).

4. The attacker has some term UP_57518.
attacker(UP_57518).

5. The attacker has some term SP_57517.
attacker(SP_57517).

6. Using the function None the attacker may obtain None.
attacker(None).

7. The message pub(skB[]) may be sent to the attacker at output {4}.
attacker(pub(skB[])).

8. Using the function GetEndpointResponse the attacker may obtain GetEndpointResponse.
attacker(GetEndpointResponse).

9. By 8, the attacker may know GetEndpointResponse.
By 7, the attacker may know pub(skB[]).
By 6, the attacker may know None.
By 5, the attacker may know SP_57517.
By 4, the attacker may know UP_57518.
Using the function 5-tuple the attacker may obtain (GetEndpointResponse,pub(skB[]),None,SP_57517,UP_57518).
attacker((GetEndpointResponse,pub(skB[]),None,SP_57517,UP_57518)).

10. The attacker has some term TTL_57516.
attacker(TTL_57516).

11. The attacker has some term ST_57515.
attacker(ST_57515).

12. The attacker initially knows C[].
attacker(C[]).

13. By 12, the attacker may know C[].
By 1, the attacker may know B[].
By 2, the attacker may know A[].
Using the function 3-tuple the attacker may obtain (C[],B[],A[]).
attacker((C[],B[],A[])).

14. We assume as hypothesis that
attacker(UP_57495).

15. We assume as hypothesis that
attacker(SP_57494).

16. The message pub(skA[]) may be sent to the attacker at output {2}.
attacker(pub(skA[])).

17. By 8, the attacker may know GetEndpointResponse.
By 16, the attacker may know pub(skA[]).
By 6, the attacker may know None.
By 15, the attacker may know SP_57494.
By 14, the attacker may know UP_57495.
Using the function 5-tuple the attacker may obtain (GetEndpointResponse,pub(skA[]),None,SP_57494,UP_57495).
attacker((GetEndpointResponse,pub(skA[]),None,SP_57494,UP_57495)).

18. The message (C[],B[],A[]) that the attacker may have by 13 may be received at input {8}.
The message (GetEndpointResponse,pub(skA[]),None,SP_57494,UP_57495) that the attacker may have by 17 may be received at input {1616}.
So the message (pub(skC[]),(OpenSecureChannelRequest,pub(skC[]),enc(Nc_57523,pub(skA[])))) may be sent to the attacker at output {1621}.
attacker((pub(skC[]),(OpenSecureChannelRequest,pub(skC[]),enc(Nc_57523,pub(skA[]))))).

19. By 18, the attacker may know (pub(skC[]),(OpenSecureChannelRequest,pub(skC[]),enc(Nc_57523,pub(skA[])))).
Using the function 2-proj-2-tuple the attacker may obtain (OpenSecureChannelRequest,pub(skC[]),enc(Nc_57523,pub(skA[]))).
attacker((OpenSecureChannelRequest,pub(skC[]),enc(Nc_57523,pub(skA[])))).

20. By 19, the attacker may know (OpenSecureChannelRequest,pub(skC[]),enc(Nc_57523,pub(skA[]))).
Using the function 3-proj-3-tuple the attacker may obtain enc(Nc_57523,pub(skA[])).
attacker(enc(Nc_57523,pub(skA[]))).

21. Using the function OpenSecureChannelResponse the attacker may obtain OpenSecureChannelResponse.
attacker(OpenSecureChannelResponse).

22. By 21, the attacker may know OpenSecureChannelResponse.
By 20, the attacker may know enc(Nc_57523,pub(skA[])).
By 11, the attacker may know ST_57515.
By 10, the attacker may know TTL_57516.
Using the function 4-tuple the attacker may obtain (OpenSecureChannelResponse,enc(Nc_57523,pub(skA[])),ST_57515,TTL_57516).
attacker((OpenSecureChannelResponse,enc(Nc_57523,pub(skA[])),ST_57515,TTL_57516)).

23. The message (A[],A[],B[]) that the attacker may have by 3 may be received at input {8}.
The message (GetEndpointResponse,pub(skB[]),None,SP_57517,UP_57518) that the attacker may have by 9 may be received at input {36}.
The message (OpenSecureChannelResponse,enc(Nc_57523,pub(skA[])),ST_57515,TTL_57516) that the attacker may have by 22 may be received at input {42}.
So event endCli(B[],A[],Nc_57523) may be executed at {47}.
end(endCli(B[],A[],Nc_57523)).


A more detailed output of the traces is available with
  set traceDisplay = long.

out(c, pub(skA)) at {2}

out(c, pub(skB)) at {4}

out(c, pub(skC)) at {6}

in(c, (C,B,A)) at {8} in copy a_57525

out(c, GetEndpointRequest) at {1615} in copy a_57525

in(c, (GetEndpointResponse,pub(skA),None,a_57524,a)) at {1616} in copy a_57525

new Nc_1835 creating Nc_57531 at {1617} in copy a_57525

event(beginCli(C,A,Nc_57531)) at {1620} in copy a_57525

out(c, (pub(skC),(OpenSecureChannelRequest,pub(skC),enc(Nc_57531,pub(skA))))) at {1621} in copy a_57525

in(c, (A,A,B)) at {8} in copy a_57530

out(c, GetEndpointRequest) at {35} in copy a_57530

in(c, (GetEndpointResponse,pub(skB),None,a_57528,a_57529)) at {36} in copy a_57530

new Nc_516 creating Nc_101886 at {37} in copy a_57530

event(beginCli(A,B,Nc_101886)) at {40} in copy a_57530

out(c, (pub(skA),(OpenSecureChannelRequest,pub(skA),enc(Nc_101886,pub(skB))))) at {41} in copy a_57530

in(c, (OpenSecureChannelResponse,enc(Nc_57531,pub(skA)),a_57526,a_57527)) at {42} in copy a_57530

event(endCli(B,A,dec(enc(Nc_57531,pub(skA)),skA))) at {47} in copy a_57530

The event endCli(B,A,Nc_57531) is executed.
A trace has been found.
RESULT event(endCli(X,Y,N)) ==> event(beginSrv(X,Y,N)) is false.
-- Query event(endSrv(X_101926,Y_101927,N_101928)) ==> event(beginCli(X_101926,Y_101927,N_101928))
Completing...
200 rules inserted. The rule base contains 64 rules. 310 rules in the queue.
400 rules inserted. The rule base contains 109 rules. 310 rules in the queue.
600 rules inserted. The rule base contains 109 rules. 308 rules in the queue.
800 rules inserted. The rule base contains 113 rules. 290 rules in the queue.
1000 rules inserted. The rule base contains 85 rules. 282 rules in the queue.
1200 rules inserted. The rule base contains 159 rules. 224 rules in the queue.
1400 rules inserted. The rule base contains 237 rules. 232 rules in the queue.
1600 rules inserted. The rule base contains 342 rules. 286 rules in the queue.
1800 rules inserted. The rule base contains 409 rules. 260 rules in the queue.
2000 rules inserted. The rule base contains 441 rules. 238 rules in the queue.
2200 rules inserted. The rule base contains 459 rules. 220 rules in the queue.
2400 rules inserted. The rule base contains 499 rules. 180 rules in the queue.
2600 rules inserted. The rule base contains 601 rules. 78 rules in the queue.
Starting query event(endSrv(X_101926,Y_101927,N_101928)) ==> event(beginCli(X_101926,Y_101927,N_101928))
goal reachable: begin(beginCli(C[],A[],Nc_1835[UP_1834 = UP_146609,SP_1833 = SP_146610,Sess = A[],Disco = B[],Cli = C[],!1 = @sid_146611])) && attacker(SP_146610) && attacker(UP_146609) -> end(endSrv(B[],A[],Nc_1835[UP_1834 = UP_146609,SP_1833 = SP_146610,Sess = A[],Disco = B[],Cli = C[],!1 = @sid_146611]))
Abbreviations:
Nc_148468 = Nc_1835[UP_1834 = UP_148447,SP_1833 = SP_148448,Sess = A[],Disco = B[],Cli = C[],!1 = @sid_148449]

1. The attacker initially knows A[].
attacker(A[]).

2. The attacker initially knows B[].
attacker(B[]).

3. By 2, the attacker may know B[].
By 1, the attacker may know A[].
By 1, the attacker may know A[].
Using the function 3-tuple the attacker may obtain (B[],A[],A[]).
attacker((B[],A[],A[])).

4. The attacker initially knows C[].
attacker(C[]).

5. By 4, the attacker may know C[].
By 2, the attacker may know B[].
By 1, the attacker may know A[].
Using the function 3-tuple the attacker may obtain (C[],B[],A[]).
attacker((C[],B[],A[])).

6. We assume as hypothesis that
attacker(UP_148447).

7. We assume as hypothesis that
attacker(SP_148448).

8. Using the function None the attacker may obtain None.
attacker(None).

9. The message pub(skA[]) may be sent to the attacker at output {2}.
attacker(pub(skA[])).

10. Using the function GetEndpointResponse the attacker may obtain GetEndpointResponse.
attacker(GetEndpointResponse).

11. By 10, the attacker may know GetEndpointResponse.
By 9, the attacker may know pub(skA[]).
By 8, the attacker may know None.
By 7, the attacker may know SP_148448.
By 6, the attacker may know UP_148447.
Using the function 5-tuple the attacker may obtain (GetEndpointResponse,pub(skA[]),None,SP_148448,UP_148447).
attacker((GetEndpointResponse,pub(skA[]),None,SP_148448,UP_148447)).

12. The message (C[],B[],A[]) that the attacker may have by 5 may be received at input {8}.
The message (GetEndpointResponse,pub(skA[]),None,SP_148448,UP_148447) that the attacker may have by 11 may be received at input {1616}.
The event beginCli(C[],A[],Nc_148468) may be executed at {1620}.
So the message (pub(skC[]),(OpenSecureChannelRequest,pub(skC[]),enc(Nc_148468,pub(skA[])))) may be sent to the attacker at output {1621}.
attacker((pub(skC[]),(OpenSecureChannelRequest,pub(skC[]),enc(Nc_148468,pub(skA[]))))).

13. By 12, the attacker may know (pub(skC[]),(OpenSecureChannelRequest,pub(skC[]),enc(Nc_148468,pub(skA[])))).
Using the function 2-proj-2-tuple the attacker may obtain (OpenSecureChannelRequest,pub(skC[]),enc(Nc_148468,pub(skA[]))).
attacker((OpenSecureChannelRequest,pub(skC[]),enc(Nc_148468,pub(skA[])))).

14. By 13, the attacker may know (OpenSecureChannelRequest,pub(skC[]),enc(Nc_148468,pub(skA[]))).
Using the function 3-proj-3-tuple the attacker may obtain enc(Nc_148468,pub(skA[])).
attacker(enc(Nc_148468,pub(skA[]))).

15. The message pub(skB[]) may be sent to the attacker at output {4}.
attacker(pub(skB[])).

16. Using the function OpenSecureChannelRequest the attacker may obtain OpenSecureChannelRequest.
attacker(OpenSecureChannelRequest).

17. By 16, the attacker may know OpenSecureChannelRequest.
By 15, the attacker may know pub(skB[]).
By 14, the attacker may know enc(Nc_148468,pub(skA[])).
Using the function 3-tuple the attacker may obtain (OpenSecureChannelRequest,pub(skB[]),enc(Nc_148468,pub(skA[]))).
attacker((OpenSecureChannelRequest,pub(skB[]),enc(Nc_148468,pub(skA[])))).

18. By 15, the attacker may know pub(skB[]).
By 17, the attacker may know (OpenSecureChannelRequest,pub(skB[]),enc(Nc_148468,pub(skA[]))).
Using the function 2-tuple the attacker may obtain (pub(skB[]),(OpenSecureChannelRequest,pub(skB[]),enc(Nc_148468,pub(skA[])))).
attacker((pub(skB[]),(OpenSecureChannelRequest,pub(skB[]),enc(Nc_148468,pub(skA[]))))).

19. The message (B[],A[],A[]) that the attacker may have by 3 may be received at input {6292}.
The message (pub(skB[]),(OpenSecureChannelRequest,pub(skB[]),enc(Nc_148468,pub(skA[])))) that the attacker may have by 18 may be received at input {6410}.
So event endSrv(B[],A[],Nc_148468) may be executed at {6422}.
end(endSrv(B[],A[],Nc_148468)).


A more detailed output of the traces is available with
  set traceDisplay = long.

out(c, pub(skA)) at {2}

out(c, pub(skB)) at {4}

out(c, pub(skC)) at {6}

in(c, (C,B,A)) at {8} in copy a_148471

out(c, GetEndpointRequest) at {1615} in copy a_148471

in(c, (GetEndpointResponse,pub(skA),None,a_148470,a_148469)) at {1616} in copy a_148471

new Nc_1835 creating Nc_148473 at {1617} in copy a_148471

event(beginCli(C,A,Nc_148473)) at {1620} in copy a_148471

out(c, (pub(skC),(OpenSecureChannelRequest,pub(skC),enc(Nc_148473,pub(skA))))) at {1621} in copy a_148471

in(c, (B,A,A)) at {6292} in copy a_148472

in(c, (pub(skB),(OpenSecureChannelRequest,pub(skB),enc(Nc_148473,pub(skA))))) at {6410} in copy a_148472

new Ns_5393 creating Ns_189055 at {6414} in copy a_148472

new ST_5394 creating ST_189056 at {6415} in copy a_148472

new TTL_5395 creating TTL_189057 at {6416} in copy a_148472

event(beginSrv(A,B,Ns_189055)) at {6419} in copy a_148472

out(c, (OpenSecureChannelResponse,enc(Ns_189055,pub(skB)),ST_189056,TTL_189057)) at {6420} in copy a_148472

event(endSrv(B,A,dec(enc(Nc_148473,pub(skA)),skA))) at {6422} in copy a_148472

The event endSrv(B,A,Nc_148473) is executed.
A trace has been found.
RESULT event(endSrv(X_101926,Y_101927,N_101928)) ==> event(beginCli(X_101926,Y_101927,N_101928)) is false.
