Linear part:
exp(exp(g,x_26),y) = exp(exp(g,y),x_26)
Completing equations...
Completed equations:
exp(exp(g,x_26),y) = exp(exp(g,y),x_26)
Convergent part:
dec(enc(x_13,pub(k_14)),k_14) = x_13
Completing equations...
Completed equations:
dec(enc(x_13,pub(k_14)),k_14) = x_13
Process:
{1}let pkA: bitstring = pub(skA) in
{2}out(c, pkA);
{3}let pkB: bitstring = pub(skB) in
{4}out(c, pkB);
{5}let pkC: bitstring = pub(skC) in
{6}out(c, pkC);
(
    {7}!
    {8}in(c, (Cli: host,Disco: host,Sess: host));
    {9}let v_509: bool = (Cli = A) in
    (
        {10}if v_509 then
        (
            {11}let skCli: bitstring = skA in
            {12}let pkCli: bitstring = pub(skCli) in
            {13}let v_510: bool = (Disco = A) in
            (
                {14}if v_510 then
                (
                    {15}let pkDisco: bitstring = pub(skA) in
                    {16}let v_511: bool = (Sess = A) in
                    (
                        {17}if v_511 then
                        (
                            {18}let pkSess: bitstring = pub(skA) in
                            {19}out(c, GetEndpointRequest);
                            {20}in(c, (=GetEndpointResponse,=pkSess,=None,SP: bitstring,UP: bitstring));
                            {21}new Nc: bitstring;
                            {22}let wNc: bitstring = enc(Nc,pkSess) in
                            {23}let m1: bitstring = (OpenSecureChannelRequest,pkCli,wNc) in
                            {24}out(c, (pkCli,m1));
                            {25}in(c, em2: bitstring);
                            {26}let m2: bitstring = em2 in
                            {27}let (=OpenSecureChannelResponse,wNs: bitstring,ST: bitstring,TTL: bitstring) = m2 in
                            {28}let Ns: bitstring = dec(wNs,skCli) in
                            {29}let Kcli: bitstring = h((Nc,Ns)) in
                            {30}out(c, senc(mCli(pkCli,pkSess),Kcli))
                        )
                        else
                            {31}let v_512: bool = (Sess = B) in
                            (
                                {32}if v_512 then
                                (
                                    {33}let pkSess_513: bitstring = pub(skB) in
                                    {34}out(c, GetEndpointRequest);
                                    {35}in(c, (=GetEndpointResponse,=pkSess_513,=None,SP_514: bitstring,UP_515: bitstring));
                                    {36}new Nc_516: bitstring;
                                    {37}let wNc_517: bitstring = enc(Nc_516,pkSess_513) in
                                    {38}let m1_518: bitstring = (OpenSecureChannelRequest,pkCli,wNc_517) in
                                    {39}out(c, (pkCli,m1_518));
                                    {40}in(c, em2_519: bitstring);
                                    {41}let m2_520: bitstring = em2_519 in
                                    {42}let (=OpenSecureChannelResponse,wNs_521: bitstring,ST_522: bitstring,TTL_523: bitstring) = m2_520 in
                                    {43}let Ns_524: bitstring = dec(wNs_521,skCli) in
                                    {44}let Kcli_525: bitstring = h((Nc_516,Ns_524)) in
                                    {45}out(c, senc(mCli(pkCli,pkSess_513),Kcli_525))
                                )
                                else
                                    {46}let v_526: bool = (Sess = C) in
                                    (
                                        {47}if v_526 then
                                        (
                                            {48}let pkSess_527: bitstring = pub(skC) in
                                            {49}out(c, GetEndpointRequest);
                                            {50}in(c, (=GetEndpointResponse,=pkSess_527,=None,SP_528: bitstring,UP_529: bitstring));
                                            {51}new Nc_530: bitstring;
                                            {52}let wNc_531: bitstring = enc(Nc_530,pkSess_527) in
                                            {53}let m1_532: bitstring = (OpenSecureChannelRequest,pkCli,wNc_531) in
                                            {54}out(c, (pkCli,m1_532));
                                            {55}in(c, em2_533: bitstring);
                                            {56}let m2_534: bitstring = em2_533 in
                                            {57}let (=OpenSecureChannelResponse,wNs_535: bitstring,ST_536: bitstring,TTL_537: bitstring) = m2_534 in
                                            {58}let Ns_538: bitstring = dec(wNs_535,skCli) in
                                            {59}let Kcli_539: bitstring = h((Nc_530,Ns_538)) in
                                            {60}out(c, senc(mCli(pkCli,pkSess_527),Kcli_539))
                                        )
                                        else
                                            {61}let pkSess_540: bitstring = pub(sk(Sess)) in
                                            {62}out(c, GetEndpointRequest);
                                            {63}in(c, (=GetEndpointResponse,=pkSess_540,=None,SP_541: bitstring,UP_542: bitstring));
                                            {64}new Nc_543: bitstring;
                                            {65}let wNc_544: bitstring = enc(Nc_543,pkSess_540) in
                                            {66}let m1_545: bitstring = (OpenSecureChannelRequest,pkCli,wNc_544) in
                                            {67}out(c, (pkCli,m1_545));
                                            {68}in(c, em2_546: bitstring);
                                            {69}let m2_547: bitstring = em2_546 in
                                            {70}let (=OpenSecureChannelResponse,wNs_548: bitstring,ST_549: bitstring,TTL_550: bitstring) = m2_547 in
                                            {71}let Ns_551: bitstring = dec(wNs_548,skCli) in
                                            {72}let Kcli_552: bitstring = h((Nc_543,Ns_551)) in
                                            {73}out(c, senc(mCli(pkCli,pkSess_540),Kcli_552))
                                    )
                                    else
                                        {74}let pkSess_553: bitstring = fail-any in
                                        {75}out(c, GetEndpointRequest);
                                        {76}in(c, (=GetEndpointResponse,=pkSess_553,=None,SP_554: bitstring,UP_555: bitstring));
                                        {77}new Nc_556: bitstring;
                                        {78}let wNc_557: bitstring = enc(Nc_556,pkSess_553) in
                                        {79}let m1_558: bitstring = (OpenSecureChannelRequest,pkCli,wNc_557) in
                                        {80}out(c, (pkCli,m1_558));
                                        {81}in(c, em2_559: bitstring);
                                        {82}let m2_560: bitstring = em2_559 in
                                        {83}let (=OpenSecureChannelResponse,wNs_561: bitstring,ST_562: bitstring,TTL_563: bitstring) = m2_560 in
                                        {84}let Ns_564: bitstring = dec(wNs_561,skCli) in
                                        {85}let Kcli_565: bitstring = h((Nc_556,Ns_564)) in
                                        {86}out(c, senc(mCli(pkCli,pkSess_553),Kcli_565))
                            )
                            else
                                {87}let pkSess_566: bitstring = fail-any in
                                {88}out(c, GetEndpointRequest);
                                {89}in(c, (=GetEndpointResponse,=pkSess_566,=None,SP_567: bitstring,UP_568: bitstring));
                                {90}new Nc_569: bitstring;
                                {91}let wNc_570: bitstring = enc(Nc_569,pkSess_566) in
                                {92}let m1_571: bitstring = (OpenSecureChannelRequest,pkCli,wNc_570) in
                                {93}out(c, (pkCli,m1_571));
                                {94}in(c, em2_572: bitstring);
                                {95}let m2_573: bitstring = em2_572 in
                                {96}let (=OpenSecureChannelResponse,wNs_574: bitstring,ST_575: bitstring,TTL_576: bitstring) = m2_573 in
                                {97}let Ns_577: bitstring = dec(wNs_574,skCli) in
                                {98}let Kcli_578: bitstring = h((Nc_569,Ns_577)) in
                                {99}out(c, senc(mCli(pkCli,pkSess_566),Kcli_578))
                    )
                    else
                        {100}let pkSess_579: bitstring = fail-any in
                        {101}out(c, GetEndpointRequest);
                        {102}in(c, (=GetEndpointResponse,=pkSess_579,=None,SP_580: bitstring,UP_581: bitstring));
                        {103}new Nc_582: bitstring;
                        {104}let wNc_583: bitstring = enc(Nc_582,pkSess_579) in
                        {105}let m1_584: bitstring = (OpenSecureChannelRequest,pkCli,wNc_583) in
                        {106}out(c, (pkCli,m1_584));
                        {107}in(c, em2_585: bitstring);
                        {108}let m2_586: bitstring = em2_585 in
                        {109}let (=OpenSecureChannelResponse,wNs_587: bitstring,ST_588: bitstring,TTL_589: bitstring) = m2_586 in
                        {110}let Ns_590: bitstring = dec(wNs_587,skCli) in
                        {111}let Kcli_591: bitstring = h((Nc_582,Ns_590)) in
                        {112}out(c, senc(mCli(pkCli,pkSess_579),Kcli_591))
                )
                else
                    {113}let v_592: bool = (Disco = B) in
                    (
                        {114}if v_592 then
                        (
                            {115}let pkDisco_593: bitstring = pub(skB) in
                            {116}let v_594: bool = (Sess = A) in
                            (
                                {117}if v_594 then
                                (
                                    {118}let pkSess_595: bitstring = pub(skA) in
                                    {119}out(c, GetEndpointRequest);
                                    {120}in(c, (=GetEndpointResponse,=pkSess_595,=None,SP_596: bitstring,UP_597: bitstring));
                                    {121}new Nc_598: bitstring;
                                    {122}let wNc_599: bitstring = enc(Nc_598,pkSess_595) in
                                    {123}let m1_600: bitstring = (OpenSecureChannelRequest,pkCli,wNc_599) in
                                    {124}out(c, (pkCli,m1_600));
                                    {125}in(c, em2_601: bitstring);
                                    {126}let m2_602: bitstring = em2_601 in
                                    {127}let (=OpenSecureChannelResponse,wNs_603: bitstring,ST_604: bitstring,TTL_605: bitstring) = m2_602 in
                                    {128}let Ns_606: bitstring = dec(wNs_603,skCli) in
                                    {129}let Kcli_607: bitstring = h((Nc_598,Ns_606)) in
                                    {130}out(c, senc(mCli(pkCli,pkSess_595),Kcli_607))
                                )
                                else
                                    {131}let v_608: bool = (Sess = B) in
                                    (
                                        {132}if v_608 then
                                        (
                                            {133}let pkSess_609: bitstring = pub(skB) in
                                            {134}out(c, GetEndpointRequest);
                                            {135}in(c, (=GetEndpointResponse,=pkSess_609,=None,SP_610: bitstring,UP_611: bitstring));
                                            {136}new Nc_612: bitstring;
                                            {137}let wNc_613: bitstring = enc(Nc_612,pkSess_609) in
                                            {138}let m1_614: bitstring = (OpenSecureChannelRequest,pkCli,wNc_613) in
                                            {139}out(c, (pkCli,m1_614));
                                            {140}in(c, em2_615: bitstring);
                                            {141}let m2_616: bitstring = em2_615 in
                                            {142}let (=OpenSecureChannelResponse,wNs_617: bitstring,ST_618: bitstring,TTL_619: bitstring) = m2_616 in
                                            {143}let Ns_620: bitstring = dec(wNs_617,skCli) in
                                            {144}let Kcli_621: bitstring = h((Nc_612,Ns_620)) in
                                            {145}out(c, senc(mCli(pkCli,pkSess_609),Kcli_621))
                                        )
                                        else
                                            {146}let v_622: bool = (Sess = C) in
                                            (
                                                {147}if v_622 then
                                                (
                                                    {148}let pkSess_623: bitstring = pub(skC) in
                                                    {149}out(c, GetEndpointRequest);
                                                    {150}in(c, (=GetEndpointResponse,=pkSess_623,=None,SP_624: bitstring,UP_625: bitstring));
                                                    {151}new Nc_626: bitstring;
                                                    {152}let wNc_627: bitstring = enc(Nc_626,pkSess_623) in
                                                    {153}let m1_628: bitstring = (OpenSecureChannelRequest,pkCli,wNc_627) in
                                                    {154}out(c, (pkCli,m1_628));
                                                    {155}in(c, em2_629: bitstring);
                                                    {156}let m2_630: bitstring = em2_629 in
                                                    {157}let (=OpenSecureChannelResponse,wNs_631: bitstring,ST_632: bitstring,TTL_633: bitstring) = m2_630 in
                                                    {158}let Ns_634: bitstring = dec(wNs_631,skCli) in
                                                    {159}let Kcli_635: bitstring = h((Nc_626,Ns_634)) in
                                                    {160}out(c, senc(mCli(pkCli,pkSess_623),Kcli_635))
                                                )
                                                else
                                                    {161}let pkSess_636: bitstring = pub(sk(Sess)) in
                                                    {162}out(c, GetEndpointRequest);
                                                    {163}in(c, (=GetEndpointResponse,=pkSess_636,=None,SP_637: bitstring,UP_638: bitstring));
                                                    {164}new Nc_639: bitstring;
                                                    {165}let wNc_640: bitstring = enc(Nc_639,pkSess_636) in
                                                    {166}let m1_641: bitstring = (OpenSecureChannelRequest,pkCli,wNc_640) in
                                                    {167}out(c, (pkCli,m1_641));
                                                    {168}in(c, em2_642: bitstring);
                                                    {169}let m2_643: bitstring = em2_642 in
                                                    {170}let (=OpenSecureChannelResponse,wNs_644: bitstring,ST_645: bitstring,TTL_646: bitstring) = m2_643 in
                                                    {171}let Ns_647: bitstring = dec(wNs_644,skCli) in
                                                    {172}let Kcli_648: bitstring = h((Nc_639,Ns_647)) in
                                                    {173}out(c, senc(mCli(pkCli,pkSess_636),Kcli_648))
                                            )
                                            else
                                                {174}let pkSess_649: bitstring = fail-any in
                                                {175}out(c, GetEndpointRequest);
                                                {176}in(c, (=GetEndpointResponse,=pkSess_649,=None,SP_650: bitstring,UP_651: bitstring));
                                                {177}new Nc_652: bitstring;
                                                {178}let wNc_653: bitstring = enc(Nc_652,pkSess_649) in
                                                {179}let m1_654: bitstring = (OpenSecureChannelRequest,pkCli,wNc_653) in
                                                {180}out(c, (pkCli,m1_654));
                                                {181}in(c, em2_655: bitstring);
                                                {182}let m2_656: bitstring = em2_655 in
                                                {183}let (=OpenSecureChannelResponse,wNs_657: bitstring,ST_658: bitstring,TTL_659: bitstring) = m2_656 in
                                                {184}let Ns_660: bitstring = dec(wNs_657,skCli) in
                                                {185}let Kcli_661: bitstring = h((Nc_652,Ns_660)) in
                                                {186}out(c, senc(mCli(pkCli,pkSess_649),Kcli_661))
                                    )
                                    else
                                        {187}let pkSess_662: bitstring = fail-any in
                                        {188}out(c, GetEndpointRequest);
                                        {189}in(c, (=GetEndpointResponse,=pkSess_662,=None,SP_663: bitstring,UP_664: bitstring));
                                        {190}new Nc_665: bitstring;
                                        {191}let wNc_666: bitstring = enc(Nc_665,pkSess_662) in
                                        {192}let m1_667: bitstring = (OpenSecureChannelRequest,pkCli,wNc_666) in
                                        {193}out(c, (pkCli,m1_667));
                                        {194}in(c, em2_668: bitstring);
                                        {195}let m2_669: bitstring = em2_668 in
                                        {196}let (=OpenSecureChannelResponse,wNs_670: bitstring,ST_671: bitstring,TTL_672: bitstring) = m2_669 in
                                        {197}let Ns_673: bitstring = dec(wNs_670,skCli) in
                                        {198}let Kcli_674: bitstring = h((Nc_665,Ns_673)) in
                                        {199}out(c, senc(mCli(pkCli,pkSess_662),Kcli_674))
                            )
                            else
                                {200}let pkSess_675: bitstring = fail-any in
                                {201}out(c, GetEndpointRequest);
                                {202}in(c, (=GetEndpointResponse,=pkSess_675,=None,SP_676: bitstring,UP_677: bitstring));
                                {203}new Nc_678: bitstring;
                                {204}let wNc_679: bitstring = enc(Nc_678,pkSess_675) in
                                {205}let m1_680: bitstring = (OpenSecureChannelRequest,pkCli,wNc_679) in
                                {206}out(c, (pkCli,m1_680));
                                {207}in(c, em2_681: bitstring);
                                {208}let m2_682: bitstring = em2_681 in
                                {209}let (=OpenSecureChannelResponse,wNs_683: bitstring,ST_684: bitstring,TTL_685: bitstring) = m2_682 in
                                {210}let Ns_686: bitstring = dec(wNs_683,skCli) in
                                {211}let Kcli_687: bitstring = h((Nc_678,Ns_686)) in
                                {212}out(c, senc(mCli(pkCli,pkSess_675),Kcli_687))
                        )
                        else
                            {213}let v_688: bool = (Disco = C) in
                            (
                                {214}if v_688 then
                                (
                                    {215}let pkDisco_689: bitstring = pub(skC) in
                                    {216}let v_690: bool = (Sess = A) in
                                    (
                                        {217}if v_690 then
                                        (
                                            {218}let pkSess_691: bitstring = pub(skA) in
                                            {219}out(c, GetEndpointRequest);
                                            {220}in(c, (=GetEndpointResponse,=pkSess_691,=None,SP_692: bitstring,UP_693: bitstring));
                                            {221}new Nc_694: bitstring;
                                            {222}let wNc_695: bitstring = enc(Nc_694,pkSess_691) in
                                            {223}let m1_696: bitstring = (OpenSecureChannelRequest,pkCli,wNc_695) in
                                            {224}out(c, (pkCli,m1_696));
                                            {225}in(c, em2_697: bitstring);
                                            {226}let m2_698: bitstring = em2_697 in
                                            {227}let (=OpenSecureChannelResponse,wNs_699: bitstring,ST_700: bitstring,TTL_701: bitstring) = m2_698 in
                                            {228}let Ns_702: bitstring = dec(wNs_699,skCli) in
                                            {229}let Kcli_703: bitstring = h((Nc_694,Ns_702)) in
                                            {230}out(c, senc(mCli(pkCli,pkSess_691),Kcli_703))
                                        )
                                        else
                                            {231}let v_704: bool = (Sess = B) in
                                            (
                                                {232}if v_704 then
                                                (
                                                    {233}let pkSess_705: bitstring = pub(skB) in
                                                    {234}out(c, GetEndpointRequest);
                                                    {235}in(c, (=GetEndpointResponse,=pkSess_705,=None,SP_706: bitstring,UP_707: bitstring));
                                                    {236}new Nc_708: bitstring;
                                                    {237}let wNc_709: bitstring = enc(Nc_708,pkSess_705) in
                                                    {238}let m1_710: bitstring = (OpenSecureChannelRequest,pkCli,wNc_709) in
                                                    {239}out(c, (pkCli,m1_710));
                                                    {240}in(c, em2_711: bitstring);
                                                    {241}let m2_712: bitstring = em2_711 in
                                                    {242}let (=OpenSecureChannelResponse,wNs_713: bitstring,ST_714: bitstring,TTL_715: bitstring) = m2_712 in
                                                    {243}let Ns_716: bitstring = dec(wNs_713,skCli) in
                                                    {244}let Kcli_717: bitstring = h((Nc_708,Ns_716)) in
                                                    {245}out(c, senc(mCli(pkCli,pkSess_705),Kcli_717))
                                                )
                                                else
                                                    {246}let v_718: bool = (Sess = C) in
                                                    (
                                                        {247}if v_718 then
                                                        (
                                                            {248}let pkSess_719: bitstring = pub(skC) in
                                                            {249}out(c, GetEndpointRequest);
                                                            {250}in(c, (=GetEndpointResponse,=pkSess_719,=None,SP_720: bitstring,UP_721: bitstring));
                                                            {251}new Nc_722: bitstring;
                                                            {252}let wNc_723: bitstring = enc(Nc_722,pkSess_719) in
                                                            {253}let m1_724: bitstring = (OpenSecureChannelRequest,pkCli,wNc_723) in
                                                            {254}out(c, (pkCli,m1_724));
                                                            {255}in(c, em2_725: bitstring);
                                                            {256}let m2_726: bitstring = em2_725 in
                                                            {257}let (=OpenSecureChannelResponse,wNs_727: bitstring,ST_728: bitstring,TTL_729: bitstring) = m2_726 in
                                                            {258}let Ns_730: bitstring = dec(wNs_727,skCli) in
                                                            {259}let Kcli_731: bitstring = h((Nc_722,Ns_730)) in
                                                            {260}out(c, senc(mCli(pkCli,pkSess_719),Kcli_731))
                                                        )
                                                        else
                                                            {261}let pkSess_732: bitstring = pub(sk(Sess)) in
                                                            {262}out(c, GetEndpointRequest);
                                                            {263}in(c, (=GetEndpointResponse,=pkSess_732,=None,SP_733: bitstring,UP_734: bitstring));
                                                            {264}new Nc_735: bitstring;
                                                            {265}let wNc_736: bitstring = enc(Nc_735,pkSess_732) in
                                                            {266}let m1_737: bitstring = (OpenSecureChannelRequest,pkCli,wNc_736) in
                                                            {267}out(c, (pkCli,m1_737));
                                                            {268}in(c, em2_738: bitstring);
                                                            {269}let m2_739: bitstring = em2_738 in
                                                            {270}let (=OpenSecureChannelResponse,wNs_740: bitstring,ST_741: bitstring,TTL_742: bitstring) = m2_739 in
                                                            {271}let Ns_743: bitstring = dec(wNs_740,skCli) in
                                                            {272}let Kcli_744: bitstring = h((Nc_735,Ns_743)) in
                                                            {273}out(c, senc(mCli(pkCli,pkSess_732),Kcli_744))
                                                    )
                                                    else
                                                        {274}let pkSess_745: bitstring = fail-any in
                                                        {275}out(c, GetEndpointRequest);
                                                        {276}in(c, (=GetEndpointResponse,=pkSess_745,=None,SP_746: bitstring,UP_747: bitstring));
                                                        {277}new Nc_748: bitstring;
                                                        {278}let wNc_749: bitstring = enc(Nc_748,pkSess_745) in
                                                        {279}let m1_750: bitstring = (OpenSecureChannelRequest,pkCli,wNc_749) in
                                                        {280}out(c, (pkCli,m1_750));
                                                        {281}in(c, em2_751: bitstring);
                                                        {282}let m2_752: bitstring = em2_751 in
                                                        {283}let (=OpenSecureChannelResponse,wNs_753: bitstring,ST_754: bitstring,TTL_755: bitstring) = m2_752 in
                                                        {284}let Ns_756: bitstring = dec(wNs_753,skCli) in
                                                        {285}let Kcli_757: bitstring = h((Nc_748,Ns_756)) in
                                                        {286}out(c, senc(mCli(pkCli,pkSess_745),Kcli_757))
                                            )
                                            else
                                                {287}let pkSess_758: bitstring = fail-any in
                                                {288}out(c, GetEndpointRequest);
                                                {289}in(c, (=GetEndpointResponse,=pkSess_758,=None,SP_759: bitstring,UP_760: bitstring));
                                                {290}new Nc_761: bitstring;
                                                {291}let wNc_762: bitstring = enc(Nc_761,pkSess_758) in
                                                {292}let m1_763: bitstring = (OpenSecureChannelRequest,pkCli,wNc_762) in
                                                {293}out(c, (pkCli,m1_763));
                                                {294}in(c, em2_764: bitstring);
                                                {295}let m2_765: bitstring = em2_764 in
                                                {296}let (=OpenSecureChannelResponse,wNs_766: bitstring,ST_767: bitstring,TTL_768: bitstring) = m2_765 in
                                                {297}let Ns_769: bitstring = dec(wNs_766,skCli) in
                                                {298}let Kcli_770: bitstring = h((Nc_761,Ns_769)) in
                                                {299}out(c, senc(mCli(pkCli,pkSess_758),Kcli_770))
                                    )
                                    else
                                        {300}let pkSess_771: bitstring = fail-any in
                                        {301}out(c, GetEndpointRequest);
                                        {302}in(c, (=GetEndpointResponse,=pkSess_771,=None,SP_772: bitstring,UP_773: bitstring));
                                        {303}new Nc_774: bitstring;
                                        {304}let wNc_775: bitstring = enc(Nc_774,pkSess_771) in
                                        {305}let m1_776: bitstring = (OpenSecureChannelRequest,pkCli,wNc_775) in
                                        {306}out(c, (pkCli,m1_776));
                                        {307}in(c, em2_777: bitstring);
                                        {308}let m2_778: bitstring = em2_777 in
                                        {309}let (=OpenSecureChannelResponse,wNs_779: bitstring,ST_780: bitstring,TTL_781: bitstring) = m2_778 in
                                        {310}let Ns_782: bitstring = dec(wNs_779,skCli) in
                                        {311}let Kcli_783: bitstring = h((Nc_774,Ns_782)) in
                                        {312}out(c, senc(mCli(pkCli,pkSess_771),Kcli_783))
                                )
                                else
                                    {313}let pkDisco_784: bitstring = pub(sk(Disco)) in
                                    {314}let v_785: bool = (Sess = A) in
                                    (
                                        {315}if v_785 then
                                        (
                                            {316}let pkSess_786: bitstring = pub(skA) in
                                            {317}out(c, GetEndpointRequest);
                                            {318}in(c, (=GetEndpointResponse,=pkSess_786,=None,SP_787: bitstring,UP_788: bitstring));
                                            {319}new Nc_789: bitstring;
                                            {320}let wNc_790: bitstring = enc(Nc_789,pkSess_786) in
                                            {321}let m1_791: bitstring = (OpenSecureChannelRequest,pkCli,wNc_790) in
                                            {322}out(c, (pkCli,m1_791));
                                            {323}in(c, em2_792: bitstring);
                                            {324}let m2_793: bitstring = em2_792 in
                                            {325}let (=OpenSecureChannelResponse,wNs_794: bitstring,ST_795: bitstring,TTL_796: bitstring) = m2_793 in
                                            {326}let Ns_797: bitstring = dec(wNs_794,skCli) in
                                            {327}let Kcli_798: bitstring = h((Nc_789,Ns_797)) in
                                            {328}out(c, senc(mCli(pkCli,pkSess_786),Kcli_798))
                                        )
                                        else
                                            {329}let v_799: bool = (Sess = B) in
                                            (
                                                {330}if v_799 then
                                                (
                                                    {331}let pkSess_800: bitstring = pub(skB) in
                                                    {332}out(c, GetEndpointRequest);
                                                    {333}in(c, (=GetEndpointResponse,=pkSess_800,=None,SP_801: bitstring,UP_802: bitstring));
                                                    {334}new Nc_803: bitstring;
                                                    {335}let wNc_804: bitstring = enc(Nc_803,pkSess_800) in
                                                    {336}let m1_805: bitstring = (OpenSecureChannelRequest,pkCli,wNc_804) in
                                                    {337}out(c, (pkCli,m1_805));
                                                    {338}in(c, em2_806: bitstring);
                                                    {339}let m2_807: bitstring = em2_806 in
                                                    {340}let (=OpenSecureChannelResponse,wNs_808: bitstring,ST_809: bitstring,TTL_810: bitstring) = m2_807 in
                                                    {341}let Ns_811: bitstring = dec(wNs_808,skCli) in
                                                    {342}let Kcli_812: bitstring = h((Nc_803,Ns_811)) in
                                                    {343}out(c, senc(mCli(pkCli,pkSess_800),Kcli_812))
                                                )
                                                else
                                                    {344}let v_813: bool = (Sess = C) in
                                                    (
                                                        {345}if v_813 then
                                                        (
                                                            {346}let pkSess_814: bitstring = pub(skC) in
                                                            {347}out(c, GetEndpointRequest);
                                                            {348}in(c, (=GetEndpointResponse,=pkSess_814,=None,SP_815: bitstring,UP_816: bitstring));
                                                            {349}new Nc_817: bitstring;
                                                            {350}let wNc_818: bitstring = enc(Nc_817,pkSess_814) in
                                                            {351}let m1_819: bitstring = (OpenSecureChannelRequest,pkCli,wNc_818) in
                                                            {352}out(c, (pkCli,m1_819));
                                                            {353}in(c, em2_820: bitstring);
                                                            {354}let m2_821: bitstring = em2_820 in
                                                            {355}let (=OpenSecureChannelResponse,wNs_822: bitstring,ST_823: bitstring,TTL_824: bitstring) = m2_821 in
                                                            {356}let Ns_825: bitstring = dec(wNs_822,skCli) in
                                                            {357}let Kcli_826: bitstring = h((Nc_817,Ns_825)) in
                                                            {358}out(c, senc(mCli(pkCli,pkSess_814),Kcli_826))
                                                        )
                                                        else
                                                            {359}let pkSess_827: bitstring = pub(sk(Sess)) in
                                                            {360}out(c, GetEndpointRequest);
                                                            {361}in(c, (=GetEndpointResponse,=pkSess_827,=None,SP_828: bitstring,UP_829: bitstring));
                                                            {362}new Nc_830: bitstring;
                                                            {363}let wNc_831: bitstring = enc(Nc_830,pkSess_827) in
                                                            {364}let m1_832: bitstring = (OpenSecureChannelRequest,pkCli,wNc_831) in
                                                            {365}out(c, (pkCli,m1_832));
                                                            {366}in(c, em2_833: bitstring);
                                                            {367}let m2_834: bitstring = em2_833 in
                                                            {368}let (=OpenSecureChannelResponse,wNs_835: bitstring,ST_836: bitstring,TTL_837: bitstring) = m2_834 in
                                                            {369}let Ns_838: bitstring = dec(wNs_835,skCli) in
                                                            {370}let Kcli_839: bitstring = h((Nc_830,Ns_838)) in
                                                            {371}out(c, senc(mCli(pkCli,pkSess_827),Kcli_839))
                                                    )
                                                    else
                                                        {372}let pkSess_840: bitstring = fail-any in
                                                        {373}out(c, GetEndpointRequest);
                                                        {374}in(c, (=GetEndpointResponse,=pkSess_840,=None,SP_841: bitstring,UP_842: bitstring));
                                                        {375}new Nc_843: bitstring;
                                                        {376}let wNc_844: bitstring = enc(Nc_843,pkSess_840) in
                                                        {377}let m1_845: bitstring = (OpenSecureChannelRequest,pkCli,wNc_844) in
                                                        {378}out(c, (pkCli,m1_845));
                                                        {379}in(c, em2_846: bitstring);
                                                        {380}let m2_847: bitstring = em2_846 in
                                                        {381}let (=OpenSecureChannelResponse,wNs_848: bitstring,ST_849: bitstring,TTL_850: bitstring) = m2_847 in
                                                        {382}let Ns_851: bitstring = dec(wNs_848,skCli) in
                                                        {383}let Kcli_852: bitstring = h((Nc_843,Ns_851)) in
                                                        {384}out(c, senc(mCli(pkCli,pkSess_840),Kcli_852))
                                            )
                                            else
                                                {385}let pkSess_853: bitstring = fail-any in
                                                {386}out(c, GetEndpointRequest);
                                                {387}in(c, (=GetEndpointResponse,=pkSess_853,=None,SP_854: bitstring,UP_855: bitstring));
                                                {388}new Nc_856: bitstring;
                                                {389}let wNc_857: bitstring = enc(Nc_856,pkSess_853) in
                                                {390}let m1_858: bitstring = (OpenSecureChannelRequest,pkCli,wNc_857) in
                                                {391}out(c, (pkCli,m1_858));
                                                {392}in(c, em2_859: bitstring);
                                                {393}let m2_860: bitstring = em2_859 in
                                                {394}let (=OpenSecureChannelResponse,wNs_861: bitstring,ST_862: bitstring,TTL_863: bitstring) = m2_860 in
                                                {395}let Ns_864: bitstring = dec(wNs_861,skCli) in
                                                {396}let Kcli_865: bitstring = h((Nc_856,Ns_864)) in
                                                {397}out(c, senc(mCli(pkCli,pkSess_853),Kcli_865))
                                    )
                                    else
                                        {398}let pkSess_866: bitstring = fail-any in
                                        {399}out(c, GetEndpointRequest);
                                        {400}in(c, (=GetEndpointResponse,=pkSess_866,=None,SP_867: bitstring,UP_868: bitstring));
                                        {401}new Nc_869: bitstring;
                                        {402}let wNc_870: bitstring = enc(Nc_869,pkSess_866) in
                                        {403}let m1_871: bitstring = (OpenSecureChannelRequest,pkCli,wNc_870) in
                                        {404}out(c, (pkCli,m1_871));
                                        {405}in(c, em2_872: bitstring);
                                        {406}let m2_873: bitstring = em2_872 in
                                        {407}let (=OpenSecureChannelResponse,wNs_874: bitstring,ST_875: bitstring,TTL_876: bitstring) = m2_873 in
                                        {408}let Ns_877: bitstring = dec(wNs_874,skCli) in
                                        {409}let Kcli_878: bitstring = h((Nc_869,Ns_877)) in
                                        {410}out(c, senc(mCli(pkCli,pkSess_866),Kcli_878))
                            )
                            else
                                {411}let pkDisco_879: bitstring = fail-any in
                                {412}let v_880: bool = (Sess = A) in
                                (
                                    {413}if v_880 then
                                    (
                                        {414}let pkSess_881: bitstring = pub(skA) in
                                        {415}out(c, GetEndpointRequest);
                                        {416}in(c, (=GetEndpointResponse,=pkSess_881,=None,SP_882: bitstring,UP_883: bitstring));
                                        {417}new Nc_884: bitstring;
                                        {418}let wNc_885: bitstring = enc(Nc_884,pkSess_881) in
                                        {419}let m1_886: bitstring = (OpenSecureChannelRequest,pkCli,wNc_885) in
                                        {420}out(c, (pkCli,m1_886));
                                        {421}in(c, em2_887: bitstring);
                                        {422}let m2_888: bitstring = em2_887 in
                                        {423}let (=OpenSecureChannelResponse,wNs_889: bitstring,ST_890: bitstring,TTL_891: bitstring) = m2_888 in
                                        {424}let Ns_892: bitstring = dec(wNs_889,skCli) in
                                        {425}let Kcli_893: bitstring = h((Nc_884,Ns_892)) in
                                        {426}out(c, senc(mCli(pkCli,pkSess_881),Kcli_893))
                                    )
                                    else
                                        {427}let v_894: bool = (Sess = B) in
                                        (
                                            {428}if v_894 then
                                            (
                                                {429}let pkSess_895: bitstring = pub(skB) in
                                                {430}out(c, GetEndpointRequest);
                                                {431}in(c, (=GetEndpointResponse,=pkSess_895,=None,SP_896: bitstring,UP_897: bitstring));
                                                {432}new Nc_898: bitstring;
                                                {433}let wNc_899: bitstring = enc(Nc_898,pkSess_895) in
                                                {434}let m1_900: bitstring = (OpenSecureChannelRequest,pkCli,wNc_899) in
                                                {435}out(c, (pkCli,m1_900));
                                                {436}in(c, em2_901: bitstring);
                                                {437}let m2_902: bitstring = em2_901 in
                                                {438}let (=OpenSecureChannelResponse,wNs_903: bitstring,ST_904: bitstring,TTL_905: bitstring) = m2_902 in
                                                {439}let Ns_906: bitstring = dec(wNs_903,skCli) in
                                                {440}let Kcli_907: bitstring = h((Nc_898,Ns_906)) in
                                                {441}out(c, senc(mCli(pkCli,pkSess_895),Kcli_907))
                                            )
                                            else
                                                {442}let v_908: bool = (Sess = C) in
                                                (
                                                    {443}if v_908 then
                                                    (
                                                        {444}let pkSess_909: bitstring = pub(skC) in
                                                        {445}out(c, GetEndpointRequest);
                                                        {446}in(c, (=GetEndpointResponse,=pkSess_909,=None,SP_910: bitstring,UP_911: bitstring));
                                                        {447}new Nc_912: bitstring;
                                                        {448}let wNc_913: bitstring = enc(Nc_912,pkSess_909) in
                                                        {449}let m1_914: bitstring = (OpenSecureChannelRequest,pkCli,wNc_913) in
                                                        {450}out(c, (pkCli,m1_914));
                                                        {451}in(c, em2_915: bitstring);
                                                        {452}let m2_916: bitstring = em2_915 in
                                                        {453}let (=OpenSecureChannelResponse,wNs_917: bitstring,ST_918: bitstring,TTL_919: bitstring) = m2_916 in
                                                        {454}let Ns_920: bitstring = dec(wNs_917,skCli) in
                                                        {455}let Kcli_921: bitstring = h((Nc_912,Ns_920)) in
                                                        {456}out(c, senc(mCli(pkCli,pkSess_909),Kcli_921))
                                                    )
                                                    else
                                                        {457}let pkSess_922: bitstring = pub(sk(Sess)) in
                                                        {458}out(c, GetEndpointRequest);
                                                        {459}in(c, (=GetEndpointResponse,=pkSess_922,=None,SP_923: bitstring,UP_924: bitstring));
                                                        {460}new Nc_925: bitstring;
                                                        {461}let wNc_926: bitstring = enc(Nc_925,pkSess_922) in
                                                        {462}let m1_927: bitstring = (OpenSecureChannelRequest,pkCli,wNc_926) in
                                                        {463}out(c, (pkCli,m1_927));
                                                        {464}in(c, em2_928: bitstring);
                                                        {465}let m2_929: bitstring = em2_928 in
                                                        {466}let (=OpenSecureChannelResponse,wNs_930: bitstring,ST_931: bitstring,TTL_932: bitstring) = m2_929 in
                                                        {467}let Ns_933: bitstring = dec(wNs_930,skCli) in
                                                        {468}let Kcli_934: bitstring = h((Nc_925,Ns_933)) in
                                                        {469}out(c, senc(mCli(pkCli,pkSess_922),Kcli_934))
                                                )
                                                else
                                                    {470}let pkSess_935: bitstring = fail-any in
                                                    {471}out(c, GetEndpointRequest);
                                                    {472}in(c, (=GetEndpointResponse,=pkSess_935,=None,SP_936: bitstring,UP_937: bitstring));
                                                    {473}new Nc_938: bitstring;
                                                    {474}let wNc_939: bitstring = enc(Nc_938,pkSess_935) in
                                                    {475}let m1_940: bitstring = (OpenSecureChannelRequest,pkCli,wNc_939) in
                                                    {476}out(c, (pkCli,m1_940));
                                                    {477}in(c, em2_941: bitstring);
                                                    {478}let m2_942: bitstring = em2_941 in
                                                    {479}let (=OpenSecureChannelResponse,wNs_943: bitstring,ST_944: bitstring,TTL_945: bitstring) = m2_942 in
                                                    {480}let Ns_946: bitstring = dec(wNs_943,skCli) in
                                                    {481}let Kcli_947: bitstring = h((Nc_938,Ns_946)) in
                                                    {482}out(c, senc(mCli(pkCli,pkSess_935),Kcli_947))
                                        )
                                        else
                                            {483}let pkSess_948: bitstring = fail-any in
                                            {484}out(c, GetEndpointRequest);
                                            {485}in(c, (=GetEndpointResponse,=pkSess_948,=None,SP_949: bitstring,UP_950: bitstring));
                                            {486}new Nc_951: bitstring;
                                            {487}let wNc_952: bitstring = enc(Nc_951,pkSess_948) in
                                            {488}let m1_953: bitstring = (OpenSecureChannelRequest,pkCli,wNc_952) in
                                            {489}out(c, (pkCli,m1_953));
                                            {490}in(c, em2_954: bitstring);
                                            {491}let m2_955: bitstring = em2_954 in
                                            {492}let (=OpenSecureChannelResponse,wNs_956: bitstring,ST_957: bitstring,TTL_958: bitstring) = m2_955 in
                                            {493}let Ns_959: bitstring = dec(wNs_956,skCli) in
                                            {494}let Kcli_960: bitstring = h((Nc_951,Ns_959)) in
                                            {495}out(c, senc(mCli(pkCli,pkSess_948),Kcli_960))
                                )
                                else
                                    {496}let pkSess_961: bitstring = fail-any in
                                    {497}out(c, GetEndpointRequest);
                                    {498}in(c, (=GetEndpointResponse,=pkSess_961,=None,SP_962: bitstring,UP_963: bitstring));
                                    {499}new Nc_964: bitstring;
                                    {500}let wNc_965: bitstring = enc(Nc_964,pkSess_961) in
                                    {501}let m1_966: bitstring = (OpenSecureChannelRequest,pkCli,wNc_965) in
                                    {502}out(c, (pkCli,m1_966));
                                    {503}in(c, em2_967: bitstring);
                                    {504}let m2_968: bitstring = em2_967 in
                                    {505}let (=OpenSecureChannelResponse,wNs_969: bitstring,ST_970: bitstring,TTL_971: bitstring) = m2_968 in
                                    {506}let Ns_972: bitstring = dec(wNs_969,skCli) in
                                    {507}let Kcli_973: bitstring = h((Nc_964,Ns_972)) in
                                    {508}out(c, senc(mCli(pkCli,pkSess_961),Kcli_973))
                    )
                    else
                        {509}let pkDisco_974: bitstring = fail-any in
                        {510}let v_975: bool = (Sess = A) in
                        (
                            {511}if v_975 then
                            (
                                {512}let pkSess_976: bitstring = pub(skA) in
                                {513}out(c, GetEndpointRequest);
                                {514}in(c, (=GetEndpointResponse,=pkSess_976,=None,SP_977: bitstring,UP_978: bitstring));
                                {515}new Nc_979: bitstring;
                                {516}let wNc_980: bitstring = enc(Nc_979,pkSess_976) in
                                {517}let m1_981: bitstring = (OpenSecureChannelRequest,pkCli,wNc_980) in
                                {518}out(c, (pkCli,m1_981));
                                {519}in(c, em2_982: bitstring);
                                {520}let m2_983: bitstring = em2_982 in
                                {521}let (=OpenSecureChannelResponse,wNs_984: bitstring,ST_985: bitstring,TTL_986: bitstring) = m2_983 in
                                {522}let Ns_987: bitstring = dec(wNs_984,skCli) in
                                {523}let Kcli_988: bitstring = h((Nc_979,Ns_987)) in
                                {524}out(c, senc(mCli(pkCli,pkSess_976),Kcli_988))
                            )
                            else
                                {525}let v_989: bool = (Sess = B) in
                                (
                                    {526}if v_989 then
                                    (
                                        {527}let pkSess_990: bitstring = pub(skB) in
                                        {528}out(c, GetEndpointRequest);
                                        {529}in(c, (=GetEndpointResponse,=pkSess_990,=None,SP_991: bitstring,UP_992: bitstring));
                                        {530}new Nc_993: bitstring;
                                        {531}let wNc_994: bitstring = enc(Nc_993,pkSess_990) in
                                        {532}let m1_995: bitstring = (OpenSecureChannelRequest,pkCli,wNc_994) in
                                        {533}out(c, (pkCli,m1_995));
                                        {534}in(c, em2_996: bitstring);
                                        {535}let m2_997: bitstring = em2_996 in
                                        {536}let (=OpenSecureChannelResponse,wNs_998: bitstring,ST_999: bitstring,TTL_1000: bitstring) = m2_997 in
                                        {537}let Ns_1001: bitstring = dec(wNs_998,skCli) in
                                        {538}let Kcli_1002: bitstring = h((Nc_993,Ns_1001)) in
                                        {539}out(c, senc(mCli(pkCli,pkSess_990),Kcli_1002))
                                    )
                                    else
                                        {540}let v_1003: bool = (Sess = C) in
                                        (
                                            {541}if v_1003 then
                                            (
                                                {542}let pkSess_1004: bitstring = pub(skC) in
                                                {543}out(c, GetEndpointRequest);
                                                {544}in(c, (=GetEndpointResponse,=pkSess_1004,=None,SP_1005: bitstring,UP_1006: bitstring));
                                                {545}new Nc_1007: bitstring;
                                                {546}let wNc_1008: bitstring = enc(Nc_1007,pkSess_1004) in
                                                {547}let m1_1009: bitstring = (OpenSecureChannelRequest,pkCli,wNc_1008) in
                                                {548}out(c, (pkCli,m1_1009));
                                                {549}in(c, em2_1010: bitstring);
                                                {550}let m2_1011: bitstring = em2_1010 in
                                                {551}let (=OpenSecureChannelResponse,wNs_1012: bitstring,ST_1013: bitstring,TTL_1014: bitstring) = m2_1011 in
                                                {552}let Ns_1015: bitstring = dec(wNs_1012,skCli) in
                                                {553}let Kcli_1016: bitstring = h((Nc_1007,Ns_1015)) in
                                                {554}out(c, senc(mCli(pkCli,pkSess_1004),Kcli_1016))
                                            )
                                            else
                                                {555}let pkSess_1017: bitstring = pub(sk(Sess)) in
                                                {556}out(c, GetEndpointRequest);
                                                {557}in(c, (=GetEndpointResponse,=pkSess_1017,=None,SP_1018: bitstring,UP_1019: bitstring));
                                                {558}new Nc_1020: bitstring;
                                                {559}let wNc_1021: bitstring = enc(Nc_1020,pkSess_1017) in
                                                {560}let m1_1022: bitstring = (OpenSecureChannelRequest,pkCli,wNc_1021) in
                                                {561}out(c, (pkCli,m1_1022));
                                                {562}in(c, em2_1023: bitstring);
                                                {563}let m2_1024: bitstring = em2_1023 in
                                                {564}let (=OpenSecureChannelResponse,wNs_1025: bitstring,ST_1026: bitstring,TTL_1027: bitstring) = m2_1024 in
                                                {565}let Ns_1028: bitstring = dec(wNs_1025,skCli) in
                                                {566}let Kcli_1029: bitstring = h((Nc_1020,Ns_1028)) in
                                                {567}out(c, senc(mCli(pkCli,pkSess_1017),Kcli_1029))
                                        )
                                        else
                                            {568}let pkSess_1030: bitstring = fail-any in
                                            {569}out(c, GetEndpointRequest);
                                            {570}in(c, (=GetEndpointResponse,=pkSess_1030,=None,SP_1031: bitstring,UP_1032: bitstring));
                                            {571}new Nc_1033: bitstring;
                                            {572}let wNc_1034: bitstring = enc(Nc_1033,pkSess_1030) in
                                            {573}let m1_1035: bitstring = (OpenSecureChannelRequest,pkCli,wNc_1034) in
                                            {574}out(c, (pkCli,m1_1035));
                                            {575}in(c, em2_1036: bitstring);
                                            {576}let m2_1037: bitstring = em2_1036 in
                                            {577}let (=OpenSecureChannelResponse,wNs_1038: bitstring,ST_1039: bitstring,TTL_1040: bitstring) = m2_1037 in
                                            {578}let Ns_1041: bitstring = dec(wNs_1038,skCli) in
                                            {579}let Kcli_1042: bitstring = h((Nc_1033,Ns_1041)) in
                                            {580}out(c, senc(mCli(pkCli,pkSess_1030),Kcli_1042))
                                )
                                else
                                    {581}let pkSess_1043: bitstring = fail-any in
                                    {582}out(c, GetEndpointRequest);
                                    {583}in(c, (=GetEndpointResponse,=pkSess_1043,=None,SP_1044: bitstring,UP_1045: bitstring));
                                    {584}new Nc_1046: bitstring;
                                    {585}let wNc_1047: bitstring = enc(Nc_1046,pkSess_1043) in
                                    {586}let m1_1048: bitstring = (OpenSecureChannelRequest,pkCli,wNc_1047) in
                                    {587}out(c, (pkCli,m1_1048));
                                    {588}in(c, em2_1049: bitstring);
                                    {589}let m2_1050: bitstring = em2_1049 in
                                    {590}let (=OpenSecureChannelResponse,wNs_1051: bitstring,ST_1052: bitstring,TTL_1053: bitstring) = m2_1050 in
                                    {591}let Ns_1054: bitstring = dec(wNs_1051,skCli) in
                                    {592}let Kcli_1055: bitstring = h((Nc_1046,Ns_1054)) in
                                    {593}out(c, senc(mCli(pkCli,pkSess_1043),Kcli_1055))
                        )
                        else
                            {594}let pkSess_1056: bitstring = fail-any in
                            {595}out(c, GetEndpointRequest);
                            {596}in(c, (=GetEndpointResponse,=pkSess_1056,=None,SP_1057: bitstring,UP_1058: bitstring));
                            {597}new Nc_1059: bitstring;
                            {598}let wNc_1060: bitstring = enc(Nc_1059,pkSess_1056) in
                            {599}let m1_1061: bitstring = (OpenSecureChannelRequest,pkCli,wNc_1060) in
                            {600}out(c, (pkCli,m1_1061));
                            {601}in(c, em2_1062: bitstring);
                            {602}let m2_1063: bitstring = em2_1062 in
                            {603}let (=OpenSecureChannelResponse,wNs_1064: bitstring,ST_1065: bitstring,TTL_1066: bitstring) = m2_1063 in
                            {604}let Ns_1067: bitstring = dec(wNs_1064,skCli) in
                            {605}let Kcli_1068: bitstring = h((Nc_1059,Ns_1067)) in
                            {606}out(c, senc(mCli(pkCli,pkSess_1056),Kcli_1068))
            )
            else
                {607}let pkDisco_1069: bitstring = fail-any in
                {608}let v_1070: bool = (Sess = A) in
                (
                    {609}if v_1070 then
                    (
                        {610}let pkSess_1071: bitstring = pub(skA) in
                        {611}out(c, GetEndpointRequest);
                        {612}in(c, (=GetEndpointResponse,=pkSess_1071,=None,SP_1072: bitstring,UP_1073: bitstring));
                        {613}new Nc_1074: bitstring;
                        {614}let wNc_1075: bitstring = enc(Nc_1074,pkSess_1071) in
                        {615}let m1_1076: bitstring = (OpenSecureChannelRequest,pkCli,wNc_1075) in
                        {616}out(c, (pkCli,m1_1076));
                        {617}in(c, em2_1077: bitstring);
                        {618}let m2_1078: bitstring = em2_1077 in
                        {619}let (=OpenSecureChannelResponse,wNs_1079: bitstring,ST_1080: bitstring,TTL_1081: bitstring) = m2_1078 in
                        {620}let Ns_1082: bitstring = dec(wNs_1079,skCli) in
                        {621}let Kcli_1083: bitstring = h((Nc_1074,Ns_1082)) in
                        {622}out(c, senc(mCli(pkCli,pkSess_1071),Kcli_1083))
                    )
                    else
                        {623}let v_1084: bool = (Sess = B) in
                        (
                            {624}if v_1084 then
                            (
                                {625}let pkSess_1085: bitstring = pub(skB) in
                                {626}out(c, GetEndpointRequest);
                                {627}in(c, (=GetEndpointResponse,=pkSess_1085,=None,SP_1086: bitstring,UP_1087: bitstring));
                                {628}new Nc_1088: bitstring;
                                {629}let wNc_1089: bitstring = enc(Nc_1088,pkSess_1085) in
                                {630}let m1_1090: bitstring = (OpenSecureChannelRequest,pkCli,wNc_1089) in
                                {631}out(c, (pkCli,m1_1090));
                                {632}in(c, em2_1091: bitstring);
                                {633}let m2_1092: bitstring = em2_1091 in
                                {634}let (=OpenSecureChannelResponse,wNs_1093: bitstring,ST_1094: bitstring,TTL_1095: bitstring) = m2_1092 in
                                {635}let Ns_1096: bitstring = dec(wNs_1093,skCli) in
                                {636}let Kcli_1097: bitstring = h((Nc_1088,Ns_1096)) in
                                {637}out(c, senc(mCli(pkCli,pkSess_1085),Kcli_1097))
                            )
                            else
                                {638}let v_1098: bool = (Sess = C) in
                                (
                                    {639}if v_1098 then
                                    (
                                        {640}let pkSess_1099: bitstring = pub(skC) in
                                        {641}out(c, GetEndpointRequest);
                                        {642}in(c, (=GetEndpointResponse,=pkSess_1099,=None,SP_1100: bitstring,UP_1101: bitstring));
                                        {643}new Nc_1102: bitstring;
                                        {644}let wNc_1103: bitstring = enc(Nc_1102,pkSess_1099) in
                                        {645}let m1_1104: bitstring = (OpenSecureChannelRequest,pkCli,wNc_1103) in
                                        {646}out(c, (pkCli,m1_1104));
                                        {647}in(c, em2_1105: bitstring);
                                        {648}let m2_1106: bitstring = em2_1105 in
                                        {649}let (=OpenSecureChannelResponse,wNs_1107: bitstring,ST_1108: bitstring,TTL_1109: bitstring) = m2_1106 in
                                        {650}let Ns_1110: bitstring = dec(wNs_1107,skCli) in
                                        {651}let Kcli_1111: bitstring = h((Nc_1102,Ns_1110)) in
                                        {652}out(c, senc(mCli(pkCli,pkSess_1099),Kcli_1111))
                                    )
                                    else
                                        {653}let pkSess_1112: bitstring = pub(sk(Sess)) in
                                        {654}out(c, GetEndpointRequest);
                                        {655}in(c, (=GetEndpointResponse,=pkSess_1112,=None,SP_1113: bitstring,UP_1114: bitstring));
                                        {656}new Nc_1115: bitstring;
                                        {657}let wNc_1116: bitstring = enc(Nc_1115,pkSess_1112) in
                                        {658}let m1_1117: bitstring = (OpenSecureChannelRequest,pkCli,wNc_1116) in
                                        {659}out(c, (pkCli,m1_1117));
                                        {660}in(c, em2_1118: bitstring);
                                        {661}let m2_1119: bitstring = em2_1118 in
                                        {662}let (=OpenSecureChannelResponse,wNs_1120: bitstring,ST_1121: bitstring,TTL_1122: bitstring) = m2_1119 in
                                        {663}let Ns_1123: bitstring = dec(wNs_1120,skCli) in
                                        {664}let Kcli_1124: bitstring = h((Nc_1115,Ns_1123)) in
                                        {665}out(c, senc(mCli(pkCli,pkSess_1112),Kcli_1124))
                                )
                                else
                                    {666}let pkSess_1125: bitstring = fail-any in
                                    {667}out(c, GetEndpointRequest);
                                    {668}in(c, (=GetEndpointResponse,=pkSess_1125,=None,SP_1126: bitstring,UP_1127: bitstring));
                                    {669}new Nc_1128: bitstring;
                                    {670}let wNc_1129: bitstring = enc(Nc_1128,pkSess_1125) in
                                    {671}let m1_1130: bitstring = (OpenSecureChannelRequest,pkCli,wNc_1129) in
                                    {672}out(c, (pkCli,m1_1130));
                                    {673}in(c, em2_1131: bitstring);
                                    {674}let m2_1132: bitstring = em2_1131 in
                                    {675}let (=OpenSecureChannelResponse,wNs_1133: bitstring,ST_1134: bitstring,TTL_1135: bitstring) = m2_1132 in
                                    {676}let Ns_1136: bitstring = dec(wNs_1133,skCli) in
                                    {677}let Kcli_1137: bitstring = h((Nc_1128,Ns_1136)) in
                                    {678}out(c, senc(mCli(pkCli,pkSess_1125),Kcli_1137))
                        )
                        else
                            {679}let pkSess_1138: bitstring = fail-any in
                            {680}out(c, GetEndpointRequest);
                            {681}in(c, (=GetEndpointResponse,=pkSess_1138,=None,SP_1139: bitstring,UP_1140: bitstring));
                            {682}new Nc_1141: bitstring;
                            {683}let wNc_1142: bitstring = enc(Nc_1141,pkSess_1138) in
                            {684}let m1_1143: bitstring = (OpenSecureChannelRequest,pkCli,wNc_1142) in
                            {685}out(c, (pkCli,m1_1143));
                            {686}in(c, em2_1144: bitstring);
                            {687}let m2_1145: bitstring = em2_1144 in
                            {688}let (=OpenSecureChannelResponse,wNs_1146: bitstring,ST_1147: bitstring,TTL_1148: bitstring) = m2_1145 in
                            {689}let Ns_1149: bitstring = dec(wNs_1146,skCli) in
                            {690}let Kcli_1150: bitstring = h((Nc_1141,Ns_1149)) in
                            {691}out(c, senc(mCli(pkCli,pkSess_1138),Kcli_1150))
                )
                else
                    {692}let pkSess_1151: bitstring = fail-any in
                    {693}out(c, GetEndpointRequest);
                    {694}in(c, (=GetEndpointResponse,=pkSess_1151,=None,SP_1152: bitstring,UP_1153: bitstring));
                    {695}new Nc_1154: bitstring;
                    {696}let wNc_1155: bitstring = enc(Nc_1154,pkSess_1151) in
                    {697}let m1_1156: bitstring = (OpenSecureChannelRequest,pkCli,wNc_1155) in
                    {698}out(c, (pkCli,m1_1156));
                    {699}in(c, em2_1157: bitstring);
                    {700}let m2_1158: bitstring = em2_1157 in
                    {701}let (=OpenSecureChannelResponse,wNs_1159: bitstring,ST_1160: bitstring,TTL_1161: bitstring) = m2_1158 in
                    {702}let Ns_1162: bitstring = dec(wNs_1159,skCli) in
                    {703}let Kcli_1163: bitstring = h((Nc_1154,Ns_1162)) in
                    {704}out(c, senc(mCli(pkCli,pkSess_1151),Kcli_1163))
        )
        else
            {705}let v_1164: bool = (Cli = B) in
            (
                {706}if v_1164 then
                (
                    {707}let skCli_1165: bitstring = skB in
                    {708}let pkCli_1166: bitstring = pub(skCli_1165) in
                    {709}let v_1167: bool = (Disco = A) in
                    (
                        {710}if v_1167 then
                        (
                            {711}let pkDisco_1168: bitstring = pub(skA) in
                            {712}let v_1169: bool = (Sess = A) in
                            (
                                {713}if v_1169 then
                                (
                                    {714}let pkSess_1170: bitstring = pub(skA) in
                                    {715}out(c, GetEndpointRequest);
                                    {716}in(c, (=GetEndpointResponse,=pkSess_1170,=None,SP_1171: bitstring,UP_1172: bitstring));
                                    {717}new Nc_1173: bitstring;
                                    {718}let wNc_1174: bitstring = enc(Nc_1173,pkSess_1170) in
                                    {719}let m1_1175: bitstring = (OpenSecureChannelRequest,pkCli_1166,wNc_1174) in
                                    {720}out(c, (pkCli_1166,m1_1175));
                                    {721}in(c, em2_1176: bitstring);
                                    {722}let m2_1177: bitstring = em2_1176 in
                                    {723}let (=OpenSecureChannelResponse,wNs_1178: bitstring,ST_1179: bitstring,TTL_1180: bitstring) = m2_1177 in
                                    {724}let Ns_1181: bitstring = dec(wNs_1178,skCli_1165) in
                                    {725}let Kcli_1182: bitstring = h((Nc_1173,Ns_1181)) in
                                    {726}out(c, senc(mCli(pkCli_1166,pkSess_1170),Kcli_1182))
                                )
                                else
                                    {727}let v_1183: bool = (Sess = B) in
                                    (
                                        {728}if v_1183 then
                                        (
                                            {729}let pkSess_1184: bitstring = pub(skB) in
                                            {730}out(c, GetEndpointRequest);
                                            {731}in(c, (=GetEndpointResponse,=pkSess_1184,=None,SP_1185: bitstring,UP_1186: bitstring));
                                            {732}new Nc_1187: bitstring;
                                            {733}let wNc_1188: bitstring = enc(Nc_1187,pkSess_1184) in
                                            {734}let m1_1189: bitstring = (OpenSecureChannelRequest,pkCli_1166,wNc_1188) in
                                            {735}out(c, (pkCli_1166,m1_1189));
                                            {736}in(c, em2_1190: bitstring);
                                            {737}let m2_1191: bitstring = em2_1190 in
                                            {738}let (=OpenSecureChannelResponse,wNs_1192: bitstring,ST_1193: bitstring,TTL_1194: bitstring) = m2_1191 in
                                            {739}let Ns_1195: bitstring = dec(wNs_1192,skCli_1165) in
                                            {740}let Kcli_1196: bitstring = h((Nc_1187,Ns_1195)) in
                                            {741}out(c, senc(mCli(pkCli_1166,pkSess_1184),Kcli_1196))
                                        )
                                        else
                                            {742}let v_1197: bool = (Sess = C) in
                                            (
                                                {743}if v_1197 then
                                                (
                                                    {744}let pkSess_1198: bitstring = pub(skC) in
                                                    {745}out(c, GetEndpointRequest);
                                                    {746}in(c, (=GetEndpointResponse,=pkSess_1198,=None,SP_1199: bitstring,UP_1200: bitstring));
                                                    {747}new Nc_1201: bitstring;
                                                    {748}let wNc_1202: bitstring = enc(Nc_1201,pkSess_1198) in
                                                    {749}let m1_1203: bitstring = (OpenSecureChannelRequest,pkCli_1166,wNc_1202) in
                                                    {750}out(c, (pkCli_1166,m1_1203));
                                                    {751}in(c, em2_1204: bitstring);
                                                    {752}let m2_1205: bitstring = em2_1204 in
                                                    {753}let (=OpenSecureChannelResponse,wNs_1206: bitstring,ST_1207: bitstring,TTL_1208: bitstring) = m2_1205 in
                                                    {754}let Ns_1209: bitstring = dec(wNs_1206,skCli_1165) in
                                                    {755}let Kcli_1210: bitstring = h((Nc_1201,Ns_1209)) in
                                                    {756}out(c, senc(mCli(pkCli_1166,pkSess_1198),Kcli_1210))
                                                )
                                                else
                                                    {757}let pkSess_1211: bitstring = pub(sk(Sess)) in
                                                    {758}out(c, GetEndpointRequest);
                                                    {759}in(c, (=GetEndpointResponse,=pkSess_1211,=None,SP_1212: bitstring,UP_1213: bitstring));
                                                    {760}new Nc_1214: bitstring;
                                                    {761}let wNc_1215: bitstring = enc(Nc_1214,pkSess_1211) in
                                                    {762}let m1_1216: bitstring = (OpenSecureChannelRequest,pkCli_1166,wNc_1215) in
                                                    {763}out(c, (pkCli_1166,m1_1216));
                                                    {764}in(c, em2_1217: bitstring);
                                                    {765}let m2_1218: bitstring = em2_1217 in
                                                    {766}let (=OpenSecureChannelResponse,wNs_1219: bitstring,ST_1220: bitstring,TTL_1221: bitstring) = m2_1218 in
                                                    {767}let Ns_1222: bitstring = dec(wNs_1219,skCli_1165) in
                                                    {768}let Kcli_1223: bitstring = h((Nc_1214,Ns_1222)) in
                                                    {769}out(c, senc(mCli(pkCli_1166,pkSess_1211),Kcli_1223))
                                            )
                                            else
                                                {770}let pkSess_1224: bitstring = fail-any in
                                                {771}out(c, GetEndpointRequest);
                                                {772}in(c, (=GetEndpointResponse,=pkSess_1224,=None,SP_1225: bitstring,UP_1226: bitstring));
                                                {773}new Nc_1227: bitstring;
                                                {774}let wNc_1228: bitstring = enc(Nc_1227,pkSess_1224) in
                                                {775}let m1_1229: bitstring = (OpenSecureChannelRequest,pkCli_1166,wNc_1228) in
                                                {776}out(c, (pkCli_1166,m1_1229));
                                                {777}in(c, em2_1230: bitstring);
                                                {778}let m2_1231: bitstring = em2_1230 in
                                                {779}let (=OpenSecureChannelResponse,wNs_1232: bitstring,ST_1233: bitstring,TTL_1234: bitstring) = m2_1231 in
                                                {780}let Ns_1235: bitstring = dec(wNs_1232,skCli_1165) in
                                                {781}let Kcli_1236: bitstring = h((Nc_1227,Ns_1235)) in
                                                {782}out(c, senc(mCli(pkCli_1166,pkSess_1224),Kcli_1236))
                                    )
                                    else
                                        {783}let pkSess_1237: bitstring = fail-any in
                                        {784}out(c, GetEndpointRequest);
                                        {785}in(c, (=GetEndpointResponse,=pkSess_1237,=None,SP_1238: bitstring,UP_1239: bitstring));
                                        {786}new Nc_1240: bitstring;
                                        {787}let wNc_1241: bitstring = enc(Nc_1240,pkSess_1237) in
                                        {788}let m1_1242: bitstring = (OpenSecureChannelRequest,pkCli_1166,wNc_1241) in
                                        {789}out(c, (pkCli_1166,m1_1242));
                                        {790}in(c, em2_1243: bitstring);
                                        {791}let m2_1244: bitstring = em2_1243 in
                                        {792}let (=OpenSecureChannelResponse,wNs_1245: bitstring,ST_1246: bitstring,TTL_1247: bitstring) = m2_1244 in
                                        {793}let Ns_1248: bitstring = dec(wNs_1245,skCli_1165) in
                                        {794}let Kcli_1249: bitstring = h((Nc_1240,Ns_1248)) in
                                        {795}out(c, senc(mCli(pkCli_1166,pkSess_1237),Kcli_1249))
                            )
                            else
                                {796}let pkSess_1250: bitstring = fail-any in
                                {797}out(c, GetEndpointRequest);
                                {798}in(c, (=GetEndpointResponse,=pkSess_1250,=None,SP_1251: bitstring,UP_1252: bitstring));
                                {799}new Nc_1253: bitstring;
                                {800}let wNc_1254: bitstring = enc(Nc_1253,pkSess_1250) in
                                {801}let m1_1255: bitstring = (OpenSecureChannelRequest,pkCli_1166,wNc_1254) in
                                {802}out(c, (pkCli_1166,m1_1255));
                                {803}in(c, em2_1256: bitstring);
                                {804}let m2_1257: bitstring = em2_1256 in
                                {805}let (=OpenSecureChannelResponse,wNs_1258: bitstring,ST_1259: bitstring,TTL_1260: bitstring) = m2_1257 in
                                {806}let Ns_1261: bitstring = dec(wNs_1258,skCli_1165) in
                                {807}let Kcli_1262: bitstring = h((Nc_1253,Ns_1261)) in
                                {808}out(c, senc(mCli(pkCli_1166,pkSess_1250),Kcli_1262))
                        )
                        else
                            {809}let v_1263: bool = (Disco = B) in
                            (
                                {810}if v_1263 then
                                (
                                    {811}let pkDisco_1264: bitstring = pub(skB) in
                                    {812}let v_1265: bool = (Sess = A) in
                                    (
                                        {813}if v_1265 then
                                        (
                                            {814}let pkSess_1266: bitstring = pub(skA) in
                                            {815}out(c, GetEndpointRequest);
                                            {816}in(c, (=GetEndpointResponse,=pkSess_1266,=None,SP_1267: bitstring,UP_1268: bitstring));
                                            {817}new Nc_1269: bitstring;
                                            {818}let wNc_1270: bitstring = enc(Nc_1269,pkSess_1266) in
                                            {819}let m1_1271: bitstring = (OpenSecureChannelRequest,pkCli_1166,wNc_1270) in
                                            {820}out(c, (pkCli_1166,m1_1271));
                                            {821}in(c, em2_1272: bitstring);
                                            {822}let m2_1273: bitstring = em2_1272 in
                                            {823}let (=OpenSecureChannelResponse,wNs_1274: bitstring,ST_1275: bitstring,TTL_1276: bitstring) = m2_1273 in
                                            {824}let Ns_1277: bitstring = dec(wNs_1274,skCli_1165) in
                                            {825}let Kcli_1278: bitstring = h((Nc_1269,Ns_1277)) in
                                            {826}out(c, senc(mCli(pkCli_1166,pkSess_1266),Kcli_1278))
                                        )
                                        else
                                            {827}let v_1279: bool = (Sess = B) in
                                            (
                                                {828}if v_1279 then
                                                (
                                                    {829}let pkSess_1280: bitstring = pub(skB) in
                                                    {830}out(c, GetEndpointRequest);
                                                    {831}in(c, (=GetEndpointResponse,=pkSess_1280,=None,SP_1281: bitstring,UP_1282: bitstring));
                                                    {832}new Nc_1283: bitstring;
                                                    {833}let wNc_1284: bitstring = enc(Nc_1283,pkSess_1280) in
                                                    {834}let m1_1285: bitstring = (OpenSecureChannelRequest,pkCli_1166,wNc_1284) in
                                                    {835}out(c, (pkCli_1166,m1_1285));
                                                    {836}in(c, em2_1286: bitstring);
                                                    {837}let m2_1287: bitstring = em2_1286 in
                                                    {838}let (=OpenSecureChannelResponse,wNs_1288: bitstring,ST_1289: bitstring,TTL_1290: bitstring) = m2_1287 in
                                                    {839}let Ns_1291: bitstring = dec(wNs_1288,skCli_1165) in
                                                    {840}let Kcli_1292: bitstring = h((Nc_1283,Ns_1291)) in
                                                    {841}out(c, senc(mCli(pkCli_1166,pkSess_1280),Kcli_1292))
                                                )
                                                else
                                                    {842}let v_1293: bool = (Sess = C) in
                                                    (
                                                        {843}if v_1293 then
                                                        (
                                                            {844}let pkSess_1294: bitstring = pub(skC) in
                                                            {845}out(c, GetEndpointRequest);
                                                            {846}in(c, (=GetEndpointResponse,=pkSess_1294,=None,SP_1295: bitstring,UP_1296: bitstring));
                                                            {847}new Nc_1297: bitstring;
                                                            {848}let wNc_1298: bitstring = enc(Nc_1297,pkSess_1294) in
                                                            {849}let m1_1299: bitstring = (OpenSecureChannelRequest,pkCli_1166,wNc_1298) in
                                                            {850}out(c, (pkCli_1166,m1_1299));
                                                            {851}in(c, em2_1300: bitstring);
                                                            {852}let m2_1301: bitstring = em2_1300 in
                                                            {853}let (=OpenSecureChannelResponse,wNs_1302: bitstring,ST_1303: bitstring,TTL_1304: bitstring) = m2_1301 in
                                                            {854}let Ns_1305: bitstring = dec(wNs_1302,skCli_1165) in
                                                            {855}let Kcli_1306: bitstring = h((Nc_1297,Ns_1305)) in
                                                            {856}out(c, senc(mCli(pkCli_1166,pkSess_1294),Kcli_1306))
                                                        )
                                                        else
                                                            {857}let pkSess_1307: bitstring = pub(sk(Sess)) in
                                                            {858}out(c, GetEndpointRequest);
                                                            {859}in(c, (=GetEndpointResponse,=pkSess_1307,=None,SP_1308: bitstring,UP_1309: bitstring));
                                                            {860}new Nc_1310: bitstring;
                                                            {861}let wNc_1311: bitstring = enc(Nc_1310,pkSess_1307) in
                                                            {862}let m1_1312: bitstring = (OpenSecureChannelRequest,pkCli_1166,wNc_1311) in
                                                            {863}out(c, (pkCli_1166,m1_1312));
                                                            {864}in(c, em2_1313: bitstring);
                                                            {865}let m2_1314: bitstring = em2_1313 in
                                                            {866}let (=OpenSecureChannelResponse,wNs_1315: bitstring,ST_1316: bitstring,TTL_1317: bitstring) = m2_1314 in
                                                            {867}let Ns_1318: bitstring = dec(wNs_1315,skCli_1165) in
                                                            {868}let Kcli_1319: bitstring = h((Nc_1310,Ns_1318)) in
                                                            {869}out(c, senc(mCli(pkCli_1166,pkSess_1307),Kcli_1319))
                                                    )
                                                    else
                                                        {870}let pkSess_1320: bitstring = fail-any in
                                                        {871}out(c, GetEndpointRequest);
                                                        {872}in(c, (=GetEndpointResponse,=pkSess_1320,=None,SP_1321: bitstring,UP_1322: bitstring));
                                                        {873}new Nc_1323: bitstring;
                                                        {874}let wNc_1324: bitstring = enc(Nc_1323,pkSess_1320) in
                                                        {875}let m1_1325: bitstring = (OpenSecureChannelRequest,pkCli_1166,wNc_1324) in
                                                        {876}out(c, (pkCli_1166,m1_1325));
                                                        {877}in(c, em2_1326: bitstring);
                                                        {878}let m2_1327: bitstring = em2_1326 in
                                                        {879}let (=OpenSecureChannelResponse,wNs_1328: bitstring,ST_1329: bitstring,TTL_1330: bitstring) = m2_1327 in
                                                        {880}let Ns_1331: bitstring = dec(wNs_1328,skCli_1165) in
                                                        {881}let Kcli_1332: bitstring = h((Nc_1323,Ns_1331)) in
                                                        {882}out(c, senc(mCli(pkCli_1166,pkSess_1320),Kcli_1332))
                                            )
                                            else
                                                {883}let pkSess_1333: bitstring = fail-any in
                                                {884}out(c, GetEndpointRequest);
                                                {885}in(c, (=GetEndpointResponse,=pkSess_1333,=None,SP_1334: bitstring,UP_1335: bitstring));
                                                {886}new Nc_1336: bitstring;
                                                {887}let wNc_1337: bitstring = enc(Nc_1336,pkSess_1333) in
                                                {888}let m1_1338: bitstring = (OpenSecureChannelRequest,pkCli_1166,wNc_1337) in
                                                {889}out(c, (pkCli_1166,m1_1338));
                                                {890}in(c, em2_1339: bitstring);
                                                {891}let m2_1340: bitstring = em2_1339 in
                                                {892}let (=OpenSecureChannelResponse,wNs_1341: bitstring,ST_1342: bitstring,TTL_1343: bitstring) = m2_1340 in
                                                {893}let Ns_1344: bitstring = dec(wNs_1341,skCli_1165) in
                                                {894}let Kcli_1345: bitstring = h((Nc_1336,Ns_1344)) in
                                                {895}out(c, senc(mCli(pkCli_1166,pkSess_1333),Kcli_1345))
                                    )
                                    else
                                        {896}let pkSess_1346: bitstring = fail-any in
                                        {897}out(c, GetEndpointRequest);
                                        {898}in(c, (=GetEndpointResponse,=pkSess_1346,=None,SP_1347: bitstring,UP_1348: bitstring));
                                        {899}new Nc_1349: bitstring;
                                        {900}let wNc_1350: bitstring = enc(Nc_1349,pkSess_1346) in
                                        {901}let m1_1351: bitstring = (OpenSecureChannelRequest,pkCli_1166,wNc_1350) in
                                        {902}out(c, (pkCli_1166,m1_1351));
                                        {903}in(c, em2_1352: bitstring);
                                        {904}let m2_1353: bitstring = em2_1352 in
                                        {905}let (=OpenSecureChannelResponse,wNs_1354: bitstring,ST_1355: bitstring,TTL_1356: bitstring) = m2_1353 in
                                        {906}let Ns_1357: bitstring = dec(wNs_1354,skCli_1165) in
                                        {907}let Kcli_1358: bitstring = h((Nc_1349,Ns_1357)) in
                                        {908}out(c, senc(mCli(pkCli_1166,pkSess_1346),Kcli_1358))
                                )
                                else
                                    {909}let v_1359: bool = (Disco = C) in
                                    (
                                        {910}if v_1359 then
                                        (
                                            {911}let pkDisco_1360: bitstring = pub(skC) in
                                            {912}let v_1361: bool = (Sess = A) in
                                            (
                                                {913}if v_1361 then
                                                (
                                                    {914}let pkSess_1362: bitstring = pub(skA) in
                                                    {915}out(c, GetEndpointRequest);
                                                    {916}in(c, (=GetEndpointResponse,=pkSess_1362,=None,SP_1363: bitstring,UP_1364: bitstring));
                                                    {917}new Nc_1365: bitstring;
                                                    {918}let wNc_1366: bitstring = enc(Nc_1365,pkSess_1362) in
                                                    {919}let m1_1367: bitstring = (OpenSecureChannelRequest,pkCli_1166,wNc_1366) in
                                                    {920}out(c, (pkCli_1166,m1_1367));
                                                    {921}in(c, em2_1368: bitstring);
                                                    {922}let m2_1369: bitstring = em2_1368 in
                                                    {923}let (=OpenSecureChannelResponse,wNs_1370: bitstring,ST_1371: bitstring,TTL_1372: bitstring) = m2_1369 in
                                                    {924}let Ns_1373: bitstring = dec(wNs_1370,skCli_1165) in
                                                    {925}let Kcli_1374: bitstring = h((Nc_1365,Ns_1373)) in
                                                    {926}out(c, senc(mCli(pkCli_1166,pkSess_1362),Kcli_1374))
                                                )
                                                else
                                                    {927}let v_1375: bool = (Sess = B) in
                                                    (
                                                        {928}if v_1375 then
                                                        (
                                                            {929}let pkSess_1376: bitstring = pub(skB) in
                                                            {930}out(c, GetEndpointRequest);
                                                            {931}in(c, (=GetEndpointResponse,=pkSess_1376,=None,SP_1377: bitstring,UP_1378: bitstring));
                                                            {932}new Nc_1379: bitstring;
                                                            {933}let wNc_1380: bitstring = enc(Nc_1379,pkSess_1376) in
                                                            {934}let m1_1381: bitstring = (OpenSecureChannelRequest,pkCli_1166,wNc_1380) in
                                                            {935}out(c, (pkCli_1166,m1_1381));
                                                            {936}in(c, em2_1382: bitstring);
                                                            {937}let m2_1383: bitstring = em2_1382 in
                                                            {938}let (=OpenSecureChannelResponse,wNs_1384: bitstring,ST_1385: bitstring,TTL_1386: bitstring) = m2_1383 in
                                                            {939}let Ns_1387: bitstring = dec(wNs_1384,skCli_1165) in
                                                            {940}let Kcli_1388: bitstring = h((Nc_1379,Ns_1387)) in
                                                            {941}out(c, senc(mCli(pkCli_1166,pkSess_1376),Kcli_1388))
                                                        )
                                                        else
                                                            {942}let v_1389: bool = (Sess = C) in
                                                            (
                                                                {943}if v_1389 then
                                                                (
                                                                    {944}let pkSess_1390: bitstring = pub(skC) in
                                                                    {945}out(c, GetEndpointRequest);
                                                                    {946}in(c, (=GetEndpointResponse,=pkSess_1390,=None,SP_1391: bitstring,UP_1392: bitstring));
                                                                    {947}new Nc_1393: bitstring;
                                                                    {948}let wNc_1394: bitstring = enc(Nc_1393,pkSess_1390) in
                                                                    {949}let m1_1395: bitstring = (OpenSecureChannelRequest,pkCli_1166,wNc_1394) in
                                                                    {950}out(c, (pkCli_1166,m1_1395));
                                                                    {951}in(c, em2_1396: bitstring);
                                                                    {952}let m2_1397: bitstring = em2_1396 in
                                                                    {953}let (=OpenSecureChannelResponse,wNs_1398: bitstring,ST_1399: bitstring,TTL_1400: bitstring) = m2_1397 in
                                                                    {954}let Ns_1401: bitstring = dec(wNs_1398,skCli_1165) in
                                                                    {955}let Kcli_1402: bitstring = h((Nc_1393,Ns_1401)) in
                                                                    {956}out(c, senc(mCli(pkCli_1166,pkSess_1390),Kcli_1402))
                                                                )
                                                                else
                                                                    {957}let pkSess_1403: bitstring = pub(sk(Sess)) in
                                                                    {958}out(c, GetEndpointRequest);
                                                                    {959}in(c, (=GetEndpointResponse,=pkSess_1403,=None,SP_1404: bitstring,UP_1405: bitstring));
                                                                    {960}new Nc_1406: bitstring;
                                                                    {961}let wNc_1407: bitstring = enc(Nc_1406,pkSess_1403) in
                                                                    {962}let m1_1408: bitstring = (OpenSecureChannelRequest,pkCli_1166,wNc_1407) in
                                                                    {963}out(c, (pkCli_1166,m1_1408));
                                                                    {964}in(c, em2_1409: bitstring);
                                                                    {965}let m2_1410: bitstring = em2_1409 in
                                                                    {966}let (=OpenSecureChannelResponse,wNs_1411: bitstring,ST_1412: bitstring,TTL_1413: bitstring) = m2_1410 in
                                                                    {967}let Ns_1414: bitstring = dec(wNs_1411,skCli_1165) in
                                                                    {968}let Kcli_1415: bitstring = h((Nc_1406,Ns_1414)) in
                                                                    {969}out(c, senc(mCli(pkCli_1166,pkSess_1403),Kcli_1415))
                                                            )
                                                            else
                                                                {970}let pkSess_1416: bitstring = fail-any in
                                                                {971}out(c, GetEndpointRequest);
                                                                {972}in(c, (=GetEndpointResponse,=pkSess_1416,=None,SP_1417: bitstring,UP_1418: bitstring));
                                                                {973}new Nc_1419: bitstring;
                                                                {974}let wNc_1420: bitstring = enc(Nc_1419,pkSess_1416) in
                                                                {975}let m1_1421: bitstring = (OpenSecureChannelRequest,pkCli_1166,wNc_1420) in
                                                                {976}out(c, (pkCli_1166,m1_1421));
                                                                {977}in(c, em2_1422: bitstring);
                                                                {978}let m2_1423: bitstring = em2_1422 in
                                                                {979}let (=OpenSecureChannelResponse,wNs_1424: bitstring,ST_1425: bitstring,TTL_1426: bitstring) = m2_1423 in
                                                                {980}let Ns_1427: bitstring = dec(wNs_1424,skCli_1165) in
                                                                {981}let Kcli_1428: bitstring = h((Nc_1419,Ns_1427)) in
                                                                {982}out(c, senc(mCli(pkCli_1166,pkSess_1416),Kcli_1428))
                                                    )
                                                    else
                                                        {983}let pkSess_1429: bitstring = fail-any in
                                                        {984}out(c, GetEndpointRequest);
                                                        {985}in(c, (=GetEndpointResponse,=pkSess_1429,=None,SP_1430: bitstring,UP_1431: bitstring));
                                                        {986}new Nc_1432: bitstring;
                                                        {987}let wNc_1433: bitstring = enc(Nc_1432,pkSess_1429) in
                                                        {988}let m1_1434: bitstring = (OpenSecureChannelRequest,pkCli_1166,wNc_1433) in
                                                        {989}out(c, (pkCli_1166,m1_1434));
                                                        {990}in(c, em2_1435: bitstring);
                                                        {991}let m2_1436: bitstring = em2_1435 in
                                                        {992}let (=OpenSecureChannelResponse,wNs_1437: bitstring,ST_1438: bitstring,TTL_1439: bitstring) = m2_1436 in
                                                        {993}let Ns_1440: bitstring = dec(wNs_1437,skCli_1165) in
                                                        {994}let Kcli_1441: bitstring = h((Nc_1432,Ns_1440)) in
                                                        {995}out(c, senc(mCli(pkCli_1166,pkSess_1429),Kcli_1441))
                                            )
                                            else
                                                {996}let pkSess_1442: bitstring = fail-any in
                                                {997}out(c, GetEndpointRequest);
                                                {998}in(c, (=GetEndpointResponse,=pkSess_1442,=None,SP_1443: bitstring,UP_1444: bitstring));
                                                {999}new Nc_1445: bitstring;
                                                {1000}let wNc_1446: bitstring = enc(Nc_1445,pkSess_1442) in
                                                {1001}let m1_1447: bitstring = (OpenSecureChannelRequest,pkCli_1166,wNc_1446) in
                                                {1002}out(c, (pkCli_1166,m1_1447));
                                                {1003}in(c, em2_1448: bitstring);
                                                {1004}let m2_1449: bitstring = em2_1448 in
                                                {1005}let (=OpenSecureChannelResponse,wNs_1450: bitstring,ST_1451: bitstring,TTL_1452: bitstring) = m2_1449 in
                                                {1006}let Ns_1453: bitstring = dec(wNs_1450,skCli_1165) in
                                                {1007}let Kcli_1454: bitstring = h((Nc_1445,Ns_1453)) in
                                                {1008}out(c, senc(mCli(pkCli_1166,pkSess_1442),Kcli_1454))
                                        )
                                        else
                                            {1009}let pkDisco_1455: bitstring = pub(sk(Disco)) in
                                            {1010}let v_1456: bool = (Sess = A) in
                                            (
                                                {1011}if v_1456 then
                                                (
                                                    {1012}let pkSess_1457: bitstring = pub(skA) in
                                                    {1013}out(c, GetEndpointRequest);
                                                    {1014}in(c, (=GetEndpointResponse,=pkSess_1457,=None,SP_1458: bitstring,UP_1459: bitstring));
                                                    {1015}new Nc_1460: bitstring;
                                                    {1016}let wNc_1461: bitstring = enc(Nc_1460,pkSess_1457) in
                                                    {1017}let m1_1462: bitstring = (OpenSecureChannelRequest,pkCli_1166,wNc_1461) in
                                                    {1018}out(c, (pkCli_1166,m1_1462));
                                                    {1019}in(c, em2_1463: bitstring);
                                                    {1020}let m2_1464: bitstring = em2_1463 in
                                                    {1021}let (=OpenSecureChannelResponse,wNs_1465: bitstring,ST_1466: bitstring,TTL_1467: bitstring) = m2_1464 in
                                                    {1022}let Ns_1468: bitstring = dec(wNs_1465,skCli_1165) in
                                                    {1023}let Kcli_1469: bitstring = h((Nc_1460,Ns_1468)) in
                                                    {1024}out(c, senc(mCli(pkCli_1166,pkSess_1457),Kcli_1469))
                                                )
                                                else
                                                    {1025}let v_1470: bool = (Sess = B) in
                                                    (
                                                        {1026}if v_1470 then
                                                        (
                                                            {1027}let pkSess_1471: bitstring = pub(skB) in
                                                            {1028}out(c, GetEndpointRequest);
                                                            {1029}in(c, (=GetEndpointResponse,=pkSess_1471,=None,SP_1472: bitstring,UP_1473: bitstring));
                                                            {1030}new Nc_1474: bitstring;
                                                            {1031}let wNc_1475: bitstring = enc(Nc_1474,pkSess_1471) in
                                                            {1032}let m1_1476: bitstring = (OpenSecureChannelRequest,pkCli_1166,wNc_1475) in
                                                            {1033}out(c, (pkCli_1166,m1_1476));
                                                            {1034}in(c, em2_1477: bitstring);
                                                            {1035}let m2_1478: bitstring = em2_1477 in
                                                            {1036}let (=OpenSecureChannelResponse,wNs_1479: bitstring,ST_1480: bitstring,TTL_1481: bitstring) = m2_1478 in
                                                            {1037}let Ns_1482: bitstring = dec(wNs_1479,skCli_1165) in
                                                            {1038}let Kcli_1483: bitstring = h((Nc_1474,Ns_1482)) in
                                                            {1039}out(c, senc(mCli(pkCli_1166,pkSess_1471),Kcli_1483))
                                                        )
                                                        else
                                                            {1040}let v_1484: bool = (Sess = C) in
                                                            (
                                                                {1041}if v_1484 then
                                                                (
                                                                    {1042}let pkSess_1485: bitstring = pub(skC) in
                                                                    {1043}out(c, GetEndpointRequest);
                                                                    {1044}in(c, (=GetEndpointResponse,=pkSess_1485,=None,SP_1486: bitstring,UP_1487: bitstring));
                                                                    {1045}new Nc_1488: bitstring;
                                                                    {1046}let wNc_1489: bitstring = enc(Nc_1488,pkSess_1485) in
                                                                    {1047}let m1_1490: bitstring = (OpenSecureChannelRequest,pkCli_1166,wNc_1489) in
                                                                    {1048}out(c, (pkCli_1166,m1_1490));
                                                                    {1049}in(c, em2_1491: bitstring);
                                                                    {1050}let m2_1492: bitstring = em2_1491 in
                                                                    {1051}let (=OpenSecureChannelResponse,wNs_1493: bitstring,ST_1494: bitstring,TTL_1495: bitstring) = m2_1492 in
                                                                    {1052}let Ns_1496: bitstring = dec(wNs_1493,skCli_1165) in
                                                                    {1053}let Kcli_1497: bitstring = h((Nc_1488,Ns_1496)) in
                                                                    {1054}out(c, senc(mCli(pkCli_1166,pkSess_1485),Kcli_1497))
                                                                )
                                                                else
                                                                    {1055}let pkSess_1498: bitstring = pub(sk(Sess)) in
                                                                    {1056}out(c, GetEndpointRequest);
                                                                    {1057}in(c, (=GetEndpointResponse,=pkSess_1498,=None,SP_1499: bitstring,UP_1500: bitstring));
                                                                    {1058}new Nc_1501: bitstring;
                                                                    {1059}let wNc_1502: bitstring = enc(Nc_1501,pkSess_1498) in
                                                                    {1060}let m1_1503: bitstring = (OpenSecureChannelRequest,pkCli_1166,wNc_1502) in
                                                                    {1061}out(c, (pkCli_1166,m1_1503));
                                                                    {1062}in(c, em2_1504: bitstring);
                                                                    {1063}let m2_1505: bitstring = em2_1504 in
                                                                    {1064}let (=OpenSecureChannelResponse,wNs_1506: bitstring,ST_1507: bitstring,TTL_1508: bitstring) = m2_1505 in
                                                                    {1065}let Ns_1509: bitstring = dec(wNs_1506,skCli_1165) in
                                                                    {1066}let Kcli_1510: bitstring = h((Nc_1501,Ns_1509)) in
                                                                    {1067}out(c, senc(mCli(pkCli_1166,pkSess_1498),Kcli_1510))
                                                            )
                                                            else
                                                                {1068}let pkSess_1511: bitstring = fail-any in
                                                                {1069}out(c, GetEndpointRequest);
                                                                {1070}in(c, (=GetEndpointResponse,=pkSess_1511,=None,SP_1512: bitstring,UP_1513: bitstring));
                                                                {1071}new Nc_1514: bitstring;
                                                                {1072}let wNc_1515: bitstring = enc(Nc_1514,pkSess_1511) in
                                                                {1073}let m1_1516: bitstring = (OpenSecureChannelRequest,pkCli_1166,wNc_1515) in
                                                                {1074}out(c, (pkCli_1166,m1_1516));
                                                                {1075}in(c, em2_1517: bitstring);
                                                                {1076}let m2_1518: bitstring = em2_1517 in
                                                                {1077}let (=OpenSecureChannelResponse,wNs_1519: bitstring,ST_1520: bitstring,TTL_1521: bitstring) = m2_1518 in
                                                                {1078}let Ns_1522: bitstring = dec(wNs_1519,skCli_1165) in
                                                                {1079}let Kcli_1523: bitstring = h((Nc_1514,Ns_1522)) in
                                                                {1080}out(c, senc(mCli(pkCli_1166,pkSess_1511),Kcli_1523))
                                                    )
                                                    else
                                                        {1081}let pkSess_1524: bitstring = fail-any in
                                                        {1082}out(c, GetEndpointRequest);
                                                        {1083}in(c, (=GetEndpointResponse,=pkSess_1524,=None,SP_1525: bitstring,UP_1526: bitstring));
                                                        {1084}new Nc_1527: bitstring;
                                                        {1085}let wNc_1528: bitstring = enc(Nc_1527,pkSess_1524) in
                                                        {1086}let m1_1529: bitstring = (OpenSecureChannelRequest,pkCli_1166,wNc_1528) in
                                                        {1087}out(c, (pkCli_1166,m1_1529));
                                                        {1088}in(c, em2_1530: bitstring);
                                                        {1089}let m2_1531: bitstring = em2_1530 in
                                                        {1090}let (=OpenSecureChannelResponse,wNs_1532: bitstring,ST_1533: bitstring,TTL_1534: bitstring) = m2_1531 in
                                                        {1091}let Ns_1535: bitstring = dec(wNs_1532,skCli_1165) in
                                                        {1092}let Kcli_1536: bitstring = h((Nc_1527,Ns_1535)) in
                                                        {1093}out(c, senc(mCli(pkCli_1166,pkSess_1524),Kcli_1536))
                                            )
                                            else
                                                {1094}let pkSess_1537: bitstring = fail-any in
                                                {1095}out(c, GetEndpointRequest);
                                                {1096}in(c, (=GetEndpointResponse,=pkSess_1537,=None,SP_1538: bitstring,UP_1539: bitstring));
                                                {1097}new Nc_1540: bitstring;
                                                {1098}let wNc_1541: bitstring = enc(Nc_1540,pkSess_1537) in
                                                {1099}let m1_1542: bitstring = (OpenSecureChannelRequest,pkCli_1166,wNc_1541) in
                                                {1100}out(c, (pkCli_1166,m1_1542));
                                                {1101}in(c, em2_1543: bitstring);
                                                {1102}let m2_1544: bitstring = em2_1543 in
                                                {1103}let (=OpenSecureChannelResponse,wNs_1545: bitstring,ST_1546: bitstring,TTL_1547: bitstring) = m2_1544 in
                                                {1104}let Ns_1548: bitstring = dec(wNs_1545,skCli_1165) in
                                                {1105}let Kcli_1549: bitstring = h((Nc_1540,Ns_1548)) in
                                                {1106}out(c, senc(mCli(pkCli_1166,pkSess_1537),Kcli_1549))
                                    )
                                    else
                                        {1107}let pkDisco_1550: bitstring = fail-any in
                                        {1108}let v_1551: bool = (Sess = A) in
                                        (
                                            {1109}if v_1551 then
                                            (
                                                {1110}let pkSess_1552: bitstring = pub(skA) in
                                                {1111}out(c, GetEndpointRequest);
                                                {1112}in(c, (=GetEndpointResponse,=pkSess_1552,=None,SP_1553: bitstring,UP_1554: bitstring));
                                                {1113}new Nc_1555: bitstring;
                                                {1114}let wNc_1556: bitstring = enc(Nc_1555,pkSess_1552) in
                                                {1115}let m1_1557: bitstring = (OpenSecureChannelRequest,pkCli_1166,wNc_1556) in
                                                {1116}out(c, (pkCli_1166,m1_1557));
                                                {1117}in(c, em2_1558: bitstring);
                                                {1118}let m2_1559: bitstring = em2_1558 in
                                                {1119}let (=OpenSecureChannelResponse,wNs_1560: bitstring,ST_1561: bitstring,TTL_1562: bitstring) = m2_1559 in
                                                {1120}let Ns_1563: bitstring = dec(wNs_1560,skCli_1165) in
                                                {1121}let Kcli_1564: bitstring = h((Nc_1555,Ns_1563)) in
                                                {1122}out(c, senc(mCli(pkCli_1166,pkSess_1552),Kcli_1564))
                                            )
                                            else
                                                {1123}let v_1565: bool = (Sess = B) in
                                                (
                                                    {1124}if v_1565 then
                                                    (
                                                        {1125}let pkSess_1566: bitstring = pub(skB) in
                                                        {1126}out(c, GetEndpointRequest);
                                                        {1127}in(c, (=GetEndpointResponse,=pkSess_1566,=None,SP_1567: bitstring,UP_1568: bitstring));
                                                        {1128}new Nc_1569: bitstring;
                                                        {1129}let wNc_1570: bitstring = enc(Nc_1569,pkSess_1566) in
                                                        {1130}let m1_1571: bitstring = (OpenSecureChannelRequest,pkCli_1166,wNc_1570) in
                                                        {1131}out(c, (pkCli_1166,m1_1571));
                                                        {1132}in(c, em2_1572: bitstring);
                                                        {1133}let m2_1573: bitstring = em2_1572 in
                                                        {1134}let (=OpenSecureChannelResponse,wNs_1574: bitstring,ST_1575: bitstring,TTL_1576: bitstring) = m2_1573 in
                                                        {1135}let Ns_1577: bitstring = dec(wNs_1574,skCli_1165) in
                                                        {1136}let Kcli_1578: bitstring = h((Nc_1569,Ns_1577)) in
                                                        {1137}out(c, senc(mCli(pkCli_1166,pkSess_1566),Kcli_1578))
                                                    )
                                                    else
                                                        {1138}let v_1579: bool = (Sess = C) in
                                                        (
                                                            {1139}if v_1579 then
                                                            (
                                                                {1140}let pkSess_1580: bitstring = pub(skC) in
                                                                {1141}out(c, GetEndpointRequest);
                                                                {1142}in(c, (=GetEndpointResponse,=pkSess_1580,=None,SP_1581: bitstring,UP_1582: bitstring));
                                                                {1143}new Nc_1583: bitstring;
                                                                {1144}let wNc_1584: bitstring = enc(Nc_1583,pkSess_1580) in
                                                                {1145}let m1_1585: bitstring = (OpenSecureChannelRequest,pkCli_1166,wNc_1584) in
                                                                {1146}out(c, (pkCli_1166,m1_1585));
                                                                {1147}in(c, em2_1586: bitstring);
                                                                {1148}let m2_1587: bitstring = em2_1586 in
                                                                {1149}let (=OpenSecureChannelResponse,wNs_1588: bitstring,ST_1589: bitstring,TTL_1590: bitstring) = m2_1587 in
                                                                {1150}let Ns_1591: bitstring = dec(wNs_1588,skCli_1165) in
                                                                {1151}let Kcli_1592: bitstring = h((Nc_1583,Ns_1591)) in
                                                                {1152}out(c, senc(mCli(pkCli_1166,pkSess_1580),Kcli_1592))
                                                            )
                                                            else
                                                                {1153}let pkSess_1593: bitstring = pub(sk(Sess)) in
                                                                {1154}out(c, GetEndpointRequest);
                                                                {1155}in(c, (=GetEndpointResponse,=pkSess_1593,=None,SP_1594: bitstring,UP_1595: bitstring));
                                                                {1156}new Nc_1596: bitstring;
                                                                {1157}let wNc_1597: bitstring = enc(Nc_1596,pkSess_1593) in
                                                                {1158}let m1_1598: bitstring = (OpenSecureChannelRequest,pkCli_1166,wNc_1597) in
                                                                {1159}out(c, (pkCli_1166,m1_1598));
                                                                {1160}in(c, em2_1599: bitstring);
                                                                {1161}let m2_1600: bitstring = em2_1599 in
                                                                {1162}let (=OpenSecureChannelResponse,wNs_1601: bitstring,ST_1602: bitstring,TTL_1603: bitstring) = m2_1600 in
                                                                {1163}let Ns_1604: bitstring = dec(wNs_1601,skCli_1165) in
                                                                {1164}let Kcli_1605: bitstring = h((Nc_1596,Ns_1604)) in
                                                                {1165}out(c, senc(mCli(pkCli_1166,pkSess_1593),Kcli_1605))
                                                        )
                                                        else
                                                            {1166}let pkSess_1606: bitstring = fail-any in
                                                            {1167}out(c, GetEndpointRequest);
                                                            {1168}in(c, (=GetEndpointResponse,=pkSess_1606,=None,SP_1607: bitstring,UP_1608: bitstring));
                                                            {1169}new Nc_1609: bitstring;
                                                            {1170}let wNc_1610: bitstring = enc(Nc_1609,pkSess_1606) in
                                                            {1171}let m1_1611: bitstring = (OpenSecureChannelRequest,pkCli_1166,wNc_1610) in
                                                            {1172}out(c, (pkCli_1166,m1_1611));
                                                            {1173}in(c, em2_1612: bitstring);
                                                            {1174}let m2_1613: bitstring = em2_1612 in
                                                            {1175}let (=OpenSecureChannelResponse,wNs_1614: bitstring,ST_1615: bitstring,TTL_1616: bitstring) = m2_1613 in
                                                            {1176}let Ns_1617: bitstring = dec(wNs_1614,skCli_1165) in
                                                            {1177}let Kcli_1618: bitstring = h((Nc_1609,Ns_1617)) in
                                                            {1178}out(c, senc(mCli(pkCli_1166,pkSess_1606),Kcli_1618))
                                                )
                                                else
                                                    {1179}let pkSess_1619: bitstring = fail-any in
                                                    {1180}out(c, GetEndpointRequest);
                                                    {1181}in(c, (=GetEndpointResponse,=pkSess_1619,=None,SP_1620: bitstring,UP_1621: bitstring));
                                                    {1182}new Nc_1622: bitstring;
                                                    {1183}let wNc_1623: bitstring = enc(Nc_1622,pkSess_1619) in
                                                    {1184}let m1_1624: bitstring = (OpenSecureChannelRequest,pkCli_1166,wNc_1623) in
                                                    {1185}out(c, (pkCli_1166,m1_1624));
                                                    {1186}in(c, em2_1625: bitstring);
                                                    {1187}let m2_1626: bitstring = em2_1625 in
                                                    {1188}let (=OpenSecureChannelResponse,wNs_1627: bitstring,ST_1628: bitstring,TTL_1629: bitstring) = m2_1626 in
                                                    {1189}let Ns_1630: bitstring = dec(wNs_1627,skCli_1165) in
                                                    {1190}let Kcli_1631: bitstring = h((Nc_1622,Ns_1630)) in
                                                    {1191}out(c, senc(mCli(pkCli_1166,pkSess_1619),Kcli_1631))
                                        )
                                        else
                                            {1192}let pkSess_1632: bitstring = fail-any in
                                            {1193}out(c, GetEndpointRequest);
                                            {1194}in(c, (=GetEndpointResponse,=pkSess_1632,=None,SP_1633: bitstring,UP_1634: bitstring));
                                            {1195}new Nc_1635: bitstring;
                                            {1196}let wNc_1636: bitstring = enc(Nc_1635,pkSess_1632) in
                                            {1197}let m1_1637: bitstring = (OpenSecureChannelRequest,pkCli_1166,wNc_1636) in
                                            {1198}out(c, (pkCli_1166,m1_1637));
                                            {1199}in(c, em2_1638: bitstring);
                                            {1200}let m2_1639: bitstring = em2_1638 in
                                            {1201}let (=OpenSecureChannelResponse,wNs_1640: bitstring,ST_1641: bitstring,TTL_1642: bitstring) = m2_1639 in
                                            {1202}let Ns_1643: bitstring = dec(wNs_1640,skCli_1165) in
                                            {1203}let Kcli_1644: bitstring = h((Nc_1635,Ns_1643)) in
                                            {1204}out(c, senc(mCli(pkCli_1166,pkSess_1632),Kcli_1644))
                            )
                            else
                                {1205}let pkDisco_1645: bitstring = fail-any in
                                {1206}let v_1646: bool = (Sess = A) in
                                (
                                    {1207}if v_1646 then
                                    (
                                        {1208}let pkSess_1647: bitstring = pub(skA) in
                                        {1209}out(c, GetEndpointRequest);
                                        {1210}in(c, (=GetEndpointResponse,=pkSess_1647,=None,SP_1648: bitstring,UP_1649: bitstring));
                                        {1211}new Nc_1650: bitstring;
                                        {1212}let wNc_1651: bitstring = enc(Nc_1650,pkSess_1647) in
                                        {1213}let m1_1652: bitstring = (OpenSecureChannelRequest,pkCli_1166,wNc_1651) in
                                        {1214}out(c, (pkCli_1166,m1_1652));
                                        {1215}in(c, em2_1653: bitstring);
                                        {1216}let m2_1654: bitstring = em2_1653 in
                                        {1217}let (=OpenSecureChannelResponse,wNs_1655: bitstring,ST_1656: bitstring,TTL_1657: bitstring) = m2_1654 in
                                        {1218}let Ns_1658: bitstring = dec(wNs_1655,skCli_1165) in
                                        {1219}let Kcli_1659: bitstring = h((Nc_1650,Ns_1658)) in
                                        {1220}out(c, senc(mCli(pkCli_1166,pkSess_1647),Kcli_1659))
                                    )
                                    else
                                        {1221}let v_1660: bool = (Sess = B) in
                                        (
                                            {1222}if v_1660 then
                                            (
                                                {1223}let pkSess_1661: bitstring = pub(skB) in
                                                {1224}out(c, GetEndpointRequest);
                                                {1225}in(c, (=GetEndpointResponse,=pkSess_1661,=None,SP_1662: bitstring,UP_1663: bitstring));
                                                {1226}new Nc_1664: bitstring;
                                                {1227}let wNc_1665: bitstring = enc(Nc_1664,pkSess_1661) in
                                                {1228}let m1_1666: bitstring = (OpenSecureChannelRequest,pkCli_1166,wNc_1665) in
                                                {1229}out(c, (pkCli_1166,m1_1666));
                                                {1230}in(c, em2_1667: bitstring);
                                                {1231}let m2_1668: bitstring = em2_1667 in
                                                {1232}let (=OpenSecureChannelResponse,wNs_1669: bitstring,ST_1670: bitstring,TTL_1671: bitstring) = m2_1668 in
                                                {1233}let Ns_1672: bitstring = dec(wNs_1669,skCli_1165) in
                                                {1234}let Kcli_1673: bitstring = h((Nc_1664,Ns_1672)) in
                                                {1235}out(c, senc(mCli(pkCli_1166,pkSess_1661),Kcli_1673))
                                            )
                                            else
                                                {1236}let v_1674: bool = (Sess = C) in
                                                (
                                                    {1237}if v_1674 then
                                                    (
                                                        {1238}let pkSess_1675: bitstring = pub(skC) in
                                                        {1239}out(c, GetEndpointRequest);
                                                        {1240}in(c, (=GetEndpointResponse,=pkSess_1675,=None,SP_1676: bitstring,UP_1677: bitstring));
                                                        {1241}new Nc_1678: bitstring;
                                                        {1242}let wNc_1679: bitstring = enc(Nc_1678,pkSess_1675) in
                                                        {1243}let m1_1680: bitstring = (OpenSecureChannelRequest,pkCli_1166,wNc_1679) in
                                                        {1244}out(c, (pkCli_1166,m1_1680));
                                                        {1245}in(c, em2_1681: bitstring);
                                                        {1246}let m2_1682: bitstring = em2_1681 in
                                                        {1247}let (=OpenSecureChannelResponse,wNs_1683: bitstring,ST_1684: bitstring,TTL_1685: bitstring) = m2_1682 in
                                                        {1248}let Ns_1686: bitstring = dec(wNs_1683,skCli_1165) in
                                                        {1249}let Kcli_1687: bitstring = h((Nc_1678,Ns_1686)) in
                                                        {1250}out(c, senc(mCli(pkCli_1166,pkSess_1675),Kcli_1687))
                                                    )
                                                    else
                                                        {1251}let pkSess_1688: bitstring = pub(sk(Sess)) in
                                                        {1252}out(c, GetEndpointRequest);
                                                        {1253}in(c, (=GetEndpointResponse,=pkSess_1688,=None,SP_1689: bitstring,UP_1690: bitstring));
                                                        {1254}new Nc_1691: bitstring;
                                                        {1255}let wNc_1692: bitstring = enc(Nc_1691,pkSess_1688) in
                                                        {1256}let m1_1693: bitstring = (OpenSecureChannelRequest,pkCli_1166,wNc_1692) in
                                                        {1257}out(c, (pkCli_1166,m1_1693));
                                                        {1258}in(c, em2_1694: bitstring);
                                                        {1259}let m2_1695: bitstring = em2_1694 in
                                                        {1260}let (=OpenSecureChannelResponse,wNs_1696: bitstring,ST_1697: bitstring,TTL_1698: bitstring) = m2_1695 in
                                                        {1261}let Ns_1699: bitstring = dec(wNs_1696,skCli_1165) in
                                                        {1262}let Kcli_1700: bitstring = h((Nc_1691,Ns_1699)) in
                                                        {1263}out(c, senc(mCli(pkCli_1166,pkSess_1688),Kcli_1700))
                                                )
                                                else
                                                    {1264}let pkSess_1701: bitstring = fail-any in
                                                    {1265}out(c, GetEndpointRequest);
                                                    {1266}in(c, (=GetEndpointResponse,=pkSess_1701,=None,SP_1702: bitstring,UP_1703: bitstring));
                                                    {1267}new Nc_1704: bitstring;
                                                    {1268}let wNc_1705: bitstring = enc(Nc_1704,pkSess_1701) in
                                                    {1269}let m1_1706: bitstring = (OpenSecureChannelRequest,pkCli_1166,wNc_1705) in
                                                    {1270}out(c, (pkCli_1166,m1_1706));
                                                    {1271}in(c, em2_1707: bitstring);
                                                    {1272}let m2_1708: bitstring = em2_1707 in
                                                    {1273}let (=OpenSecureChannelResponse,wNs_1709: bitstring,ST_1710: bitstring,TTL_1711: bitstring) = m2_1708 in
                                                    {1274}let Ns_1712: bitstring = dec(wNs_1709,skCli_1165) in
                                                    {1275}let Kcli_1713: bitstring = h((Nc_1704,Ns_1712)) in
                                                    {1276}out(c, senc(mCli(pkCli_1166,pkSess_1701),Kcli_1713))
                                        )
                                        else
                                            {1277}let pkSess_1714: bitstring = fail-any in
                                            {1278}out(c, GetEndpointRequest);
                                            {1279}in(c, (=GetEndpointResponse,=pkSess_1714,=None,SP_1715: bitstring,UP_1716: bitstring));
                                            {1280}new Nc_1717: bitstring;
                                            {1281}let wNc_1718: bitstring = enc(Nc_1717,pkSess_1714) in
                                            {1282}let m1_1719: bitstring = (OpenSecureChannelRequest,pkCli_1166,wNc_1718) in
                                            {1283}out(c, (pkCli_1166,m1_1719));
                                            {1284}in(c, em2_1720: bitstring);
                                            {1285}let m2_1721: bitstring = em2_1720 in
                                            {1286}let (=OpenSecureChannelResponse,wNs_1722: bitstring,ST_1723: bitstring,TTL_1724: bitstring) = m2_1721 in
                                            {1287}let Ns_1725: bitstring = dec(wNs_1722,skCli_1165) in
                                            {1288}let Kcli_1726: bitstring = h((Nc_1717,Ns_1725)) in
                                            {1289}out(c, senc(mCli(pkCli_1166,pkSess_1714),Kcli_1726))
                                )
                                else
                                    {1290}let pkSess_1727: bitstring = fail-any in
                                    {1291}out(c, GetEndpointRequest);
                                    {1292}in(c, (=GetEndpointResponse,=pkSess_1727,=None,SP_1728: bitstring,UP_1729: bitstring));
                                    {1293}new Nc_1730: bitstring;
                                    {1294}let wNc_1731: bitstring = enc(Nc_1730,pkSess_1727) in
                                    {1295}let m1_1732: bitstring = (OpenSecureChannelRequest,pkCli_1166,wNc_1731) in
                                    {1296}out(c, (pkCli_1166,m1_1732));
                                    {1297}in(c, em2_1733: bitstring);
                                    {1298}let m2_1734: bitstring = em2_1733 in
                                    {1299}let (=OpenSecureChannelResponse,wNs_1735: bitstring,ST_1736: bitstring,TTL_1737: bitstring) = m2_1734 in
                                    {1300}let Ns_1738: bitstring = dec(wNs_1735,skCli_1165) in
                                    {1301}let Kcli_1739: bitstring = h((Nc_1730,Ns_1738)) in
                                    {1302}out(c, senc(mCli(pkCli_1166,pkSess_1727),Kcli_1739))
                    )
                    else
                        {1303}let pkDisco_1740: bitstring = fail-any in
                        {1304}let v_1741: bool = (Sess = A) in
                        (
                            {1305}if v_1741 then
                            (
                                {1306}let pkSess_1742: bitstring = pub(skA) in
                                {1307}out(c, GetEndpointRequest);
                                {1308}in(c, (=GetEndpointResponse,=pkSess_1742,=None,SP_1743: bitstring,UP_1744: bitstring));
                                {1309}new Nc_1745: bitstring;
                                {1310}let wNc_1746: bitstring = enc(Nc_1745,pkSess_1742) in
                                {1311}let m1_1747: bitstring = (OpenSecureChannelRequest,pkCli_1166,wNc_1746) in
                                {1312}out(c, (pkCli_1166,m1_1747));
                                {1313}in(c, em2_1748: bitstring);
                                {1314}let m2_1749: bitstring = em2_1748 in
                                {1315}let (=OpenSecureChannelResponse,wNs_1750: bitstring,ST_1751: bitstring,TTL_1752: bitstring) = m2_1749 in
                                {1316}let Ns_1753: bitstring = dec(wNs_1750,skCli_1165) in
                                {1317}let Kcli_1754: bitstring = h((Nc_1745,Ns_1753)) in
                                {1318}out(c, senc(mCli(pkCli_1166,pkSess_1742),Kcli_1754))
                            )
                            else
                                {1319}let v_1755: bool = (Sess = B) in
                                (
                                    {1320}if v_1755 then
                                    (
                                        {1321}let pkSess_1756: bitstring = pub(skB) in
                                        {1322}out(c, GetEndpointRequest);
                                        {1323}in(c, (=GetEndpointResponse,=pkSess_1756,=None,SP_1757: bitstring,UP_1758: bitstring));
                                        {1324}new Nc_1759: bitstring;
                                        {1325}let wNc_1760: bitstring = enc(Nc_1759,pkSess_1756) in
                                        {1326}let m1_1761: bitstring = (OpenSecureChannelRequest,pkCli_1166,wNc_1760) in
                                        {1327}out(c, (pkCli_1166,m1_1761));
                                        {1328}in(c, em2_1762: bitstring);
                                        {1329}let m2_1763: bitstring = em2_1762 in
                                        {1330}let (=OpenSecureChannelResponse,wNs_1764: bitstring,ST_1765: bitstring,TTL_1766: bitstring) = m2_1763 in
                                        {1331}let Ns_1767: bitstring = dec(wNs_1764,skCli_1165) in
                                        {1332}let Kcli_1768: bitstring = h((Nc_1759,Ns_1767)) in
                                        {1333}out(c, senc(mCli(pkCli_1166,pkSess_1756),Kcli_1768))
                                    )
                                    else
                                        {1334}let v_1769: bool = (Sess = C) in
                                        (
                                            {1335}if v_1769 then
                                            (
                                                {1336}let pkSess_1770: bitstring = pub(skC) in
                                                {1337}out(c, GetEndpointRequest);
                                                {1338}in(c, (=GetEndpointResponse,=pkSess_1770,=None,SP_1771: bitstring,UP_1772: bitstring));
                                                {1339}new Nc_1773: bitstring;
                                                {1340}let wNc_1774: bitstring = enc(Nc_1773,pkSess_1770) in
                                                {1341}let m1_1775: bitstring = (OpenSecureChannelRequest,pkCli_1166,wNc_1774) in
                                                {1342}out(c, (pkCli_1166,m1_1775));
                                                {1343}in(c, em2_1776: bitstring);
                                                {1344}let m2_1777: bitstring = em2_1776 in
                                                {1345}let (=OpenSecureChannelResponse,wNs_1778: bitstring,ST_1779: bitstring,TTL_1780: bitstring) = m2_1777 in
                                                {1346}let Ns_1781: bitstring = dec(wNs_1778,skCli_1165) in
                                                {1347}let Kcli_1782: bitstring = h((Nc_1773,Ns_1781)) in
                                                {1348}out(c, senc(mCli(pkCli_1166,pkSess_1770),Kcli_1782))
                                            )
                                            else
                                                {1349}let pkSess_1783: bitstring = pub(sk(Sess)) in
                                                {1350}out(c, GetEndpointRequest);
                                                {1351}in(c, (=GetEndpointResponse,=pkSess_1783,=None,SP_1784: bitstring,UP_1785: bitstring));
                                                {1352}new Nc_1786: bitstring;
                                                {1353}let wNc_1787: bitstring = enc(Nc_1786,pkSess_1783) in
                                                {1354}let m1_1788: bitstring = (OpenSecureChannelRequest,pkCli_1166,wNc_1787) in
                                                {1355}out(c, (pkCli_1166,m1_1788));
                                                {1356}in(c, em2_1789: bitstring);
                                                {1357}let m2_1790: bitstring = em2_1789 in
                                                {1358}let (=OpenSecureChannelResponse,wNs_1791: bitstring,ST_1792: bitstring,TTL_1793: bitstring) = m2_1790 in
                                                {1359}let Ns_1794: bitstring = dec(wNs_1791,skCli_1165) in
                                                {1360}let Kcli_1795: bitstring = h((Nc_1786,Ns_1794)) in
                                                {1361}out(c, senc(mCli(pkCli_1166,pkSess_1783),Kcli_1795))
                                        )
                                        else
                                            {1362}let pkSess_1796: bitstring = fail-any in
                                            {1363}out(c, GetEndpointRequest);
                                            {1364}in(c, (=GetEndpointResponse,=pkSess_1796,=None,SP_1797: bitstring,UP_1798: bitstring));
                                            {1365}new Nc_1799: bitstring;
                                            {1366}let wNc_1800: bitstring = enc(Nc_1799,pkSess_1796) in
                                            {1367}let m1_1801: bitstring = (OpenSecureChannelRequest,pkCli_1166,wNc_1800) in
                                            {1368}out(c, (pkCli_1166,m1_1801));
                                            {1369}in(c, em2_1802: bitstring);
                                            {1370}let m2_1803: bitstring = em2_1802 in
                                            {1371}let (=OpenSecureChannelResponse,wNs_1804: bitstring,ST_1805: bitstring,TTL_1806: bitstring) = m2_1803 in
                                            {1372}let Ns_1807: bitstring = dec(wNs_1804,skCli_1165) in
                                            {1373}let Kcli_1808: bitstring = h((Nc_1799,Ns_1807)) in
                                            {1374}out(c, senc(mCli(pkCli_1166,pkSess_1796),Kcli_1808))
                                )
                                else
                                    {1375}let pkSess_1809: bitstring = fail-any in
                                    {1376}out(c, GetEndpointRequest);
                                    {1377}in(c, (=GetEndpointResponse,=pkSess_1809,=None,SP_1810: bitstring,UP_1811: bitstring));
                                    {1378}new Nc_1812: bitstring;
                                    {1379}let wNc_1813: bitstring = enc(Nc_1812,pkSess_1809) in
                                    {1380}let m1_1814: bitstring = (OpenSecureChannelRequest,pkCli_1166,wNc_1813) in
                                    {1381}out(c, (pkCli_1166,m1_1814));
                                    {1382}in(c, em2_1815: bitstring);
                                    {1383}let m2_1816: bitstring = em2_1815 in
                                    {1384}let (=OpenSecureChannelResponse,wNs_1817: bitstring,ST_1818: bitstring,TTL_1819: bitstring) = m2_1816 in
                                    {1385}let Ns_1820: bitstring = dec(wNs_1817,skCli_1165) in
                                    {1386}let Kcli_1821: bitstring = h((Nc_1812,Ns_1820)) in
                                    {1387}out(c, senc(mCli(pkCli_1166,pkSess_1809),Kcli_1821))
                        )
                        else
                            {1388}let pkSess_1822: bitstring = fail-any in
                            {1389}out(c, GetEndpointRequest);
                            {1390}in(c, (=GetEndpointResponse,=pkSess_1822,=None,SP_1823: bitstring,UP_1824: bitstring));
                            {1391}new Nc_1825: bitstring;
                            {1392}let wNc_1826: bitstring = enc(Nc_1825,pkSess_1822) in
                            {1393}let m1_1827: bitstring = (OpenSecureChannelRequest,pkCli_1166,wNc_1826) in
                            {1394}out(c, (pkCli_1166,m1_1827));
                            {1395}in(c, em2_1828: bitstring);
                            {1396}let m2_1829: bitstring = em2_1828 in
                            {1397}let (=OpenSecureChannelResponse,wNs_1830: bitstring,ST_1831: bitstring,TTL_1832: bitstring) = m2_1829 in
                            {1398}let Ns_1833: bitstring = dec(wNs_1830,skCli_1165) in
                            {1399}let Kcli_1834: bitstring = h((Nc_1825,Ns_1833)) in
                            {1400}out(c, senc(mCli(pkCli_1166,pkSess_1822),Kcli_1834))
                )
                else
                    {1401}let =true = (Cli = C) in
                    (
                        {1402}let skCli_1835: bitstring = skC in
                        {1403}let pkCli_1836: bitstring = pub(skCli_1835) in
                        {1404}let v_1837: bool = (Disco = A) in
                        (
                            {1405}if v_1837 then
                            (
                                {1406}let pkDisco_1838: bitstring = pub(skA) in
                                {1407}let v_1839: bool = (Sess = A) in
                                (
                                    {1408}if v_1839 then
                                    (
                                        {1409}let pkSess_1840: bitstring = pub(skA) in
                                        {1410}out(c, GetEndpointRequest);
                                        {1411}in(c, (=GetEndpointResponse,=pkSess_1840,=None,SP_1841: bitstring,UP_1842: bitstring));
                                        {1412}new Nc_1843: bitstring;
                                        {1413}let wNc_1844: bitstring = enc(Nc_1843,pkSess_1840) in
                                        {1414}let m1_1845: bitstring = (OpenSecureChannelRequest,pkCli_1836,wNc_1844) in
                                        {1415}out(c, (pkCli_1836,m1_1845));
                                        {1416}in(c, em2_1846: bitstring);
                                        {1417}let m2_1847: bitstring = em2_1846 in
                                        {1418}let (=OpenSecureChannelResponse,wNs_1848: bitstring,ST_1849: bitstring,TTL_1850: bitstring) = m2_1847 in
                                        {1419}let Ns_1851: bitstring = dec(wNs_1848,skCli_1835) in
                                        {1420}let Kcli_1852: bitstring = h((Nc_1843,Ns_1851)) in
                                        {1421}out(c, senc(mCli(pkCli_1836,pkSess_1840),Kcli_1852))
                                    )
                                    else
                                        {1422}let v_1853: bool = (Sess = B) in
                                        (
                                            {1423}if v_1853 then
                                            (
                                                {1424}let pkSess_1854: bitstring = pub(skB) in
                                                {1425}out(c, GetEndpointRequest);
                                                {1426}in(c, (=GetEndpointResponse,=pkSess_1854,=None,SP_1855: bitstring,UP_1856: bitstring));
                                                {1427}new Nc_1857: bitstring;
                                                {1428}let wNc_1858: bitstring = enc(Nc_1857,pkSess_1854) in
                                                {1429}let m1_1859: bitstring = (OpenSecureChannelRequest,pkCli_1836,wNc_1858) in
                                                {1430}out(c, (pkCli_1836,m1_1859));
                                                {1431}in(c, em2_1860: bitstring);
                                                {1432}let m2_1861: bitstring = em2_1860 in
                                                {1433}let (=OpenSecureChannelResponse,wNs_1862: bitstring,ST_1863: bitstring,TTL_1864: bitstring) = m2_1861 in
                                                {1434}let Ns_1865: bitstring = dec(wNs_1862,skCli_1835) in
                                                {1435}let Kcli_1866: bitstring = h((Nc_1857,Ns_1865)) in
                                                {1436}out(c, senc(mCli(pkCli_1836,pkSess_1854),Kcli_1866))
                                            )
                                            else
                                                {1437}let v_1867: bool = (Sess = C) in
                                                (
                                                    {1438}if v_1867 then
                                                    (
                                                        {1439}let pkSess_1868: bitstring = pub(skC) in
                                                        {1440}out(c, GetEndpointRequest);
                                                        {1441}in(c, (=GetEndpointResponse,=pkSess_1868,=None,SP_1869: bitstring,UP_1870: bitstring));
                                                        {1442}new Nc_1871: bitstring;
                                                        {1443}let wNc_1872: bitstring = enc(Nc_1871,pkSess_1868) in
                                                        {1444}let m1_1873: bitstring = (OpenSecureChannelRequest,pkCli_1836,wNc_1872) in
                                                        {1445}out(c, (pkCli_1836,m1_1873));
                                                        {1446}in(c, em2_1874: bitstring);
                                                        {1447}let m2_1875: bitstring = em2_1874 in
                                                        {1448}let (=OpenSecureChannelResponse,wNs_1876: bitstring,ST_1877: bitstring,TTL_1878: bitstring) = m2_1875 in
                                                        {1449}let Ns_1879: bitstring = dec(wNs_1876,skCli_1835) in
                                                        {1450}let Kcli_1880: bitstring = h((Nc_1871,Ns_1879)) in
                                                        {1451}out(c, senc(mCli(pkCli_1836,pkSess_1868),Kcli_1880))
                                                    )
                                                    else
                                                        {1452}let pkSess_1881: bitstring = pub(sk(Sess)) in
                                                        {1453}out(c, GetEndpointRequest);
                                                        {1454}in(c, (=GetEndpointResponse,=pkSess_1881,=None,SP_1882: bitstring,UP_1883: bitstring));
                                                        {1455}new Nc_1884: bitstring;
                                                        {1456}let wNc_1885: bitstring = enc(Nc_1884,pkSess_1881) in
                                                        {1457}let m1_1886: bitstring = (OpenSecureChannelRequest,pkCli_1836,wNc_1885) in
                                                        {1458}out(c, (pkCli_1836,m1_1886));
                                                        {1459}in(c, em2_1887: bitstring);
                                                        {1460}let m2_1888: bitstring = em2_1887 in
                                                        {1461}let (=OpenSecureChannelResponse,wNs_1889: bitstring,ST_1890: bitstring,TTL_1891: bitstring) = m2_1888 in
                                                        {1462}let Ns_1892: bitstring = dec(wNs_1889,skCli_1835) in
                                                        {1463}let Kcli_1893: bitstring = h((Nc_1884,Ns_1892)) in
                                                        {1464}out(c, senc(mCli(pkCli_1836,pkSess_1881),Kcli_1893))
                                                )
                                                else
                                                    {1465}let pkSess_1894: bitstring = fail-any in
                                                    {1466}out(c, GetEndpointRequest);
                                                    {1467}in(c, (=GetEndpointResponse,=pkSess_1894,=None,SP_1895: bitstring,UP_1896: bitstring));
                                                    {1468}new Nc_1897: bitstring;
                                                    {1469}let wNc_1898: bitstring = enc(Nc_1897,pkSess_1894) in
                                                    {1470}let m1_1899: bitstring = (OpenSecureChannelRequest,pkCli_1836,wNc_1898) in
                                                    {1471}out(c, (pkCli_1836,m1_1899));
                                                    {1472}in(c, em2_1900: bitstring);
                                                    {1473}let m2_1901: bitstring = em2_1900 in
                                                    {1474}let (=OpenSecureChannelResponse,wNs_1902: bitstring,ST_1903: bitstring,TTL_1904: bitstring) = m2_1901 in
                                                    {1475}let Ns_1905: bitstring = dec(wNs_1902,skCli_1835) in
                                                    {1476}let Kcli_1906: bitstring = h((Nc_1897,Ns_1905)) in
                                                    {1477}out(c, senc(mCli(pkCli_1836,pkSess_1894),Kcli_1906))
                                        )
                                        else
                                            {1478}let pkSess_1907: bitstring = fail-any in
                                            {1479}out(c, GetEndpointRequest);
                                            {1480}in(c, (=GetEndpointResponse,=pkSess_1907,=None,SP_1908: bitstring,UP_1909: bitstring));
                                            {1481}new Nc_1910: bitstring;
                                            {1482}let wNc_1911: bitstring = enc(Nc_1910,pkSess_1907) in
                                            {1483}let m1_1912: bitstring = (OpenSecureChannelRequest,pkCli_1836,wNc_1911) in
                                            {1484}out(c, (pkCli_1836,m1_1912));
                                            {1485}in(c, em2_1913: bitstring);
                                            {1486}let m2_1914: bitstring = em2_1913 in
                                            {1487}let (=OpenSecureChannelResponse,wNs_1915: bitstring,ST_1916: bitstring,TTL_1917: bitstring) = m2_1914 in
                                            {1488}let Ns_1918: bitstring = dec(wNs_1915,skCli_1835) in
                                            {1489}let Kcli_1919: bitstring = h((Nc_1910,Ns_1918)) in
                                            {1490}out(c, senc(mCli(pkCli_1836,pkSess_1907),Kcli_1919))
                                )
                                else
                                    {1491}let pkSess_1920: bitstring = fail-any in
                                    {1492}out(c, GetEndpointRequest);
                                    {1493}in(c, (=GetEndpointResponse,=pkSess_1920,=None,SP_1921: bitstring,UP_1922: bitstring));
                                    {1494}new Nc_1923: bitstring;
                                    {1495}let wNc_1924: bitstring = enc(Nc_1923,pkSess_1920) in
                                    {1496}let m1_1925: bitstring = (OpenSecureChannelRequest,pkCli_1836,wNc_1924) in
                                    {1497}out(c, (pkCli_1836,m1_1925));
                                    {1498}in(c, em2_1926: bitstring);
                                    {1499}let m2_1927: bitstring = em2_1926 in
                                    {1500}let (=OpenSecureChannelResponse,wNs_1928: bitstring,ST_1929: bitstring,TTL_1930: bitstring) = m2_1927 in
                                    {1501}let Ns_1931: bitstring = dec(wNs_1928,skCli_1835) in
                                    {1502}let Kcli_1932: bitstring = h((Nc_1923,Ns_1931)) in
                                    {1503}out(c, senc(mCli(pkCli_1836,pkSess_1920),Kcli_1932))
                            )
                            else
                                {1504}let v_1933: bool = (Disco = B) in
                                (
                                    {1505}if v_1933 then
                                    (
                                        {1506}let pkDisco_1934: bitstring = pub(skB) in
                                        {1507}let v_1935: bool = (Sess = A) in
                                        (
                                            {1508}if v_1935 then
                                            (
                                                {1509}let pkSess_1936: bitstring = pub(skA) in
                                                {1510}out(c, GetEndpointRequest);
                                                {1511}in(c, (=GetEndpointResponse,=pkSess_1936,=None,SP_1937: bitstring,UP_1938: bitstring));
                                                {1512}new Nc_1939: bitstring;
                                                {1513}let wNc_1940: bitstring = enc(Nc_1939,pkSess_1936) in
                                                {1514}let m1_1941: bitstring = (OpenSecureChannelRequest,pkCli_1836,wNc_1940) in
                                                {1515}out(c, (pkCli_1836,m1_1941));
                                                {1516}in(c, em2_1942: bitstring);
                                                {1517}let m2_1943: bitstring = em2_1942 in
                                                {1518}let (=OpenSecureChannelResponse,wNs_1944: bitstring,ST_1945: bitstring,TTL_1946: bitstring) = m2_1943 in
                                                {1519}let Ns_1947: bitstring = dec(wNs_1944,skCli_1835) in
                                                {1520}let Kcli_1948: bitstring = h((Nc_1939,Ns_1947)) in
                                                {1521}out(c, senc(mCli(pkCli_1836,pkSess_1936),Kcli_1948))
                                            )
                                            else
                                                {1522}let v_1949: bool = (Sess = B) in
                                                (
                                                    {1523}if v_1949 then
                                                    (
                                                        {1524}let pkSess_1950: bitstring = pub(skB) in
                                                        {1525}out(c, GetEndpointRequest);
                                                        {1526}in(c, (=GetEndpointResponse,=pkSess_1950,=None,SP_1951: bitstring,UP_1952: bitstring));
                                                        {1527}new Nc_1953: bitstring;
                                                        {1528}let wNc_1954: bitstring = enc(Nc_1953,pkSess_1950) in
                                                        {1529}let m1_1955: bitstring = (OpenSecureChannelRequest,pkCli_1836,wNc_1954) in
                                                        {1530}out(c, (pkCli_1836,m1_1955));
                                                        {1531}in(c, em2_1956: bitstring);
                                                        {1532}let m2_1957: bitstring = em2_1956 in
                                                        {1533}let (=OpenSecureChannelResponse,wNs_1958: bitstring,ST_1959: bitstring,TTL_1960: bitstring) = m2_1957 in
                                                        {1534}let Ns_1961: bitstring = dec(wNs_1958,skCli_1835) in
                                                        {1535}let Kcli_1962: bitstring = h((Nc_1953,Ns_1961)) in
                                                        {1536}out(c, senc(mCli(pkCli_1836,pkSess_1950),Kcli_1962))
                                                    )
                                                    else
                                                        {1537}let v_1963: bool = (Sess = C) in
                                                        (
                                                            {1538}if v_1963 then
                                                            (
                                                                {1539}let pkSess_1964: bitstring = pub(skC) in
                                                                {1540}out(c, GetEndpointRequest);
                                                                {1541}in(c, (=GetEndpointResponse,=pkSess_1964,=None,SP_1965: bitstring,UP_1966: bitstring));
                                                                {1542}new Nc_1967: bitstring;
                                                                {1543}let wNc_1968: bitstring = enc(Nc_1967,pkSess_1964) in
                                                                {1544}let m1_1969: bitstring = (OpenSecureChannelRequest,pkCli_1836,wNc_1968) in
                                                                {1545}out(c, (pkCli_1836,m1_1969));
                                                                {1546}in(c, em2_1970: bitstring);
                                                                {1547}let m2_1971: bitstring = em2_1970 in
                                                                {1548}let (=OpenSecureChannelResponse,wNs_1972: bitstring,ST_1973: bitstring,TTL_1974: bitstring) = m2_1971 in
                                                                {1549}let Ns_1975: bitstring = dec(wNs_1972,skCli_1835) in
                                                                {1550}let Kcli_1976: bitstring = h((Nc_1967,Ns_1975)) in
                                                                {1551}out(c, senc(mCli(pkCli_1836,pkSess_1964),Kcli_1976))
                                                            )
                                                            else
                                                                {1552}let pkSess_1977: bitstring = pub(sk(Sess)) in
                                                                {1553}out(c, GetEndpointRequest);
                                                                {1554}in(c, (=GetEndpointResponse,=pkSess_1977,=None,SP_1978: bitstring,UP_1979: bitstring));
                                                                {1555}new Nc_1980: bitstring;
                                                                {1556}let wNc_1981: bitstring = enc(Nc_1980,pkSess_1977) in
                                                                {1557}let m1_1982: bitstring = (OpenSecureChannelRequest,pkCli_1836,wNc_1981) in
                                                                {1558}out(c, (pkCli_1836,m1_1982));
                                                                {1559}in(c, em2_1983: bitstring);
                                                                {1560}let m2_1984: bitstring = em2_1983 in
                                                                {1561}let (=OpenSecureChannelResponse,wNs_1985: bitstring,ST_1986: bitstring,TTL_1987: bitstring) = m2_1984 in
                                                                {1562}let Ns_1988: bitstring = dec(wNs_1985,skCli_1835) in
                                                                {1563}let Kcli_1989: bitstring = h((Nc_1980,Ns_1988)) in
                                                                {1564}out(c, senc(mCli(pkCli_1836,pkSess_1977),Kcli_1989))
                                                        )
                                                        else
                                                            {1565}let pkSess_1990: bitstring = fail-any in
                                                            {1566}out(c, GetEndpointRequest);
                                                            {1567}in(c, (=GetEndpointResponse,=pkSess_1990,=None,SP_1991: bitstring,UP_1992: bitstring));
                                                            {1568}new Nc_1993: bitstring;
                                                            {1569}let wNc_1994: bitstring = enc(Nc_1993,pkSess_1990) in
                                                            {1570}let m1_1995: bitstring = (OpenSecureChannelRequest,pkCli_1836,wNc_1994) in
                                                            {1571}out(c, (pkCli_1836,m1_1995));
                                                            {1572}in(c, em2_1996: bitstring);
                                                            {1573}let m2_1997: bitstring = em2_1996 in
                                                            {1574}let (=OpenSecureChannelResponse,wNs_1998: bitstring,ST_1999: bitstring,TTL_2000: bitstring) = m2_1997 in
                                                            {1575}let Ns_2001: bitstring = dec(wNs_1998,skCli_1835) in
                                                            {1576}let Kcli_2002: bitstring = h((Nc_1993,Ns_2001)) in
                                                            {1577}out(c, senc(mCli(pkCli_1836,pkSess_1990),Kcli_2002))
                                                )
                                                else
                                                    {1578}let pkSess_2003: bitstring = fail-any in
                                                    {1579}out(c, GetEndpointRequest);
                                                    {1580}in(c, (=GetEndpointResponse,=pkSess_2003,=None,SP_2004: bitstring,UP_2005: bitstring));
                                                    {1581}new Nc_2006: bitstring;
                                                    {1582}let wNc_2007: bitstring = enc(Nc_2006,pkSess_2003) in
                                                    {1583}let m1_2008: bitstring = (OpenSecureChannelRequest,pkCli_1836,wNc_2007) in
                                                    {1584}out(c, (pkCli_1836,m1_2008));
                                                    {1585}in(c, em2_2009: bitstring);
                                                    {1586}let m2_2010: bitstring = em2_2009 in
                                                    {1587}let (=OpenSecureChannelResponse,wNs_2011: bitstring,ST_2012: bitstring,TTL_2013: bitstring) = m2_2010 in
                                                    {1588}let Ns_2014: bitstring = dec(wNs_2011,skCli_1835) in
                                                    {1589}let Kcli_2015: bitstring = h((Nc_2006,Ns_2014)) in
                                                    {1590}out(c, senc(mCli(pkCli_1836,pkSess_2003),Kcli_2015))
                                        )
                                        else
                                            {1591}let pkSess_2016: bitstring = fail-any in
                                            {1592}out(c, GetEndpointRequest);
                                            {1593}in(c, (=GetEndpointResponse,=pkSess_2016,=None,SP_2017: bitstring,UP_2018: bitstring));
                                            {1594}new Nc_2019: bitstring;
                                            {1595}let wNc_2020: bitstring = enc(Nc_2019,pkSess_2016) in
                                            {1596}let m1_2021: bitstring = (OpenSecureChannelRequest,pkCli_1836,wNc_2020) in
                                            {1597}out(c, (pkCli_1836,m1_2021));
                                            {1598}in(c, em2_2022: bitstring);
                                            {1599}let m2_2023: bitstring = em2_2022 in
                                            {1600}let (=OpenSecureChannelResponse,wNs_2024: bitstring,ST_2025: bitstring,TTL_2026: bitstring) = m2_2023 in
                                            {1601}let Ns_2027: bitstring = dec(wNs_2024,skCli_1835) in
                                            {1602}let Kcli_2028: bitstring = h((Nc_2019,Ns_2027)) in
                                            {1603}out(c, senc(mCli(pkCli_1836,pkSess_2016),Kcli_2028))
                                    )
                                    else
                                        {1604}let v_2029: bool = (Disco = C) in
                                        (
                                            {1605}if v_2029 then
                                            (
                                                {1606}let pkDisco_2030: bitstring = pub(skC) in
                                                {1607}let v_2031: bool = (Sess = A) in
                                                (
                                                    {1608}if v_2031 then
                                                    (
                                                        {1609}let pkSess_2032: bitstring = pub(skA) in
                                                        {1610}out(c, GetEndpointRequest);
                                                        {1611}in(c, (=GetEndpointResponse,=pkSess_2032,=None,SP_2033: bitstring,UP_2034: bitstring));
                                                        {1612}new Nc_2035: bitstring;
                                                        {1613}let wNc_2036: bitstring = enc(Nc_2035,pkSess_2032) in
                                                        {1614}let m1_2037: bitstring = (OpenSecureChannelRequest,pkCli_1836,wNc_2036) in
                                                        {1615}out(c, (pkCli_1836,m1_2037));
                                                        {1616}in(c, em2_2038: bitstring);
                                                        {1617}let m2_2039: bitstring = em2_2038 in
                                                        {1618}let (=OpenSecureChannelResponse,wNs_2040: bitstring,ST_2041: bitstring,TTL_2042: bitstring) = m2_2039 in
                                                        {1619}let Ns_2043: bitstring = dec(wNs_2040,skCli_1835) in
                                                        {1620}let Kcli_2044: bitstring = h((Nc_2035,Ns_2043)) in
                                                        {1621}out(c, senc(mCli(pkCli_1836,pkSess_2032),Kcli_2044))
                                                    )
                                                    else
                                                        {1622}let v_2045: bool = (Sess = B) in
                                                        (
                                                            {1623}if v_2045 then
                                                            (
                                                                {1624}let pkSess_2046: bitstring = pub(skB) in
                                                                {1625}out(c, GetEndpointRequest);
                                                                {1626}in(c, (=GetEndpointResponse,=pkSess_2046,=None,SP_2047: bitstring,UP_2048: bitstring));
                                                                {1627}new Nc_2049: bitstring;
                                                                {1628}let wNc_2050: bitstring = enc(Nc_2049,pkSess_2046) in
                                                                {1629}let m1_2051: bitstring = (OpenSecureChannelRequest,pkCli_1836,wNc_2050) in
                                                                {1630}out(c, (pkCli_1836,m1_2051));
                                                                {1631}in(c, em2_2052: bitstring);
                                                                {1632}let m2_2053: bitstring = em2_2052 in
                                                                {1633}let (=OpenSecureChannelResponse,wNs_2054: bitstring,ST_2055: bitstring,TTL_2056: bitstring) = m2_2053 in
                                                                {1634}let Ns_2057: bitstring = dec(wNs_2054,skCli_1835) in
                                                                {1635}let Kcli_2058: bitstring = h((Nc_2049,Ns_2057)) in
                                                                {1636}out(c, senc(mCli(pkCli_1836,pkSess_2046),Kcli_2058))
                                                            )
                                                            else
                                                                {1637}let v_2059: bool = (Sess = C) in
                                                                (
                                                                    {1638}if v_2059 then
                                                                    (
                                                                        {1639}let pkSess_2060: bitstring = pub(skC) in
                                                                        {1640}out(c, GetEndpointRequest);
                                                                        {1641}in(c, (=GetEndpointResponse,=pkSess_2060,=None,SP_2061: bitstring,UP_2062: bitstring));
                                                                        {1642}new Nc_2063: bitstring;
                                                                        {1643}let wNc_2064: bitstring = enc(Nc_2063,pkSess_2060) in
                                                                        {1644}let m1_2065: bitstring = (OpenSecureChannelRequest,pkCli_1836,wNc_2064) in
                                                                        {1645}out(c, (pkCli_1836,m1_2065));
                                                                        {1646}in(c, em2_2066: bitstring);
                                                                        {1647}let m2_2067: bitstring = em2_2066 in
                                                                        {1648}let (=OpenSecureChannelResponse,wNs_2068: bitstring,ST_2069: bitstring,TTL_2070: bitstring) = m2_2067 in
                                                                        {1649}let Ns_2071: bitstring = dec(wNs_2068,skCli_1835) in
                                                                        {1650}let Kcli_2072: bitstring = h((Nc_2063,Ns_2071)) in
                                                                        {1651}out(c, senc(mCli(pkCli_1836,pkSess_2060),Kcli_2072))
                                                                    )
                                                                    else
                                                                        {1652}let pkSess_2073: bitstring = pub(sk(Sess)) in
                                                                        {1653}out(c, GetEndpointRequest);
                                                                        {1654}in(c, (=GetEndpointResponse,=pkSess_2073,=None,SP_2074: bitstring,UP_2075: bitstring));
                                                                        {1655}new Nc_2076: bitstring;
                                                                        {1656}let wNc_2077: bitstring = enc(Nc_2076,pkSess_2073) in
                                                                        {1657}let m1_2078: bitstring = (OpenSecureChannelRequest,pkCli_1836,wNc_2077) in
                                                                        {1658}out(c, (pkCli_1836,m1_2078));
                                                                        {1659}in(c, em2_2079: bitstring);
                                                                        {1660}let m2_2080: bitstring = em2_2079 in
                                                                        {1661}let (=OpenSecureChannelResponse,wNs_2081: bitstring,ST_2082: bitstring,TTL_2083: bitstring) = m2_2080 in
                                                                        {1662}let Ns_2084: bitstring = dec(wNs_2081,skCli_1835) in
                                                                        {1663}let Kcli_2085: bitstring = h((Nc_2076,Ns_2084)) in
                                                                        {1664}out(c, senc(mCli(pkCli_1836,pkSess_2073),Kcli_2085))
                                                                )
                                                                else
                                                                    {1665}let pkSess_2086: bitstring = fail-any in
                                                                    {1666}out(c, GetEndpointRequest);
                                                                    {1667}in(c, (=GetEndpointResponse,=pkSess_2086,=None,SP_2087: bitstring,UP_2088: bitstring));
                                                                    {1668}new Nc_2089: bitstring;
                                                                    {1669}let wNc_2090: bitstring = enc(Nc_2089,pkSess_2086) in
                                                                    {1670}let m1_2091: bitstring = (OpenSecureChannelRequest,pkCli_1836,wNc_2090) in
                                                                    {1671}out(c, (pkCli_1836,m1_2091));
                                                                    {1672}in(c, em2_2092: bitstring);
                                                                    {1673}let m2_2093: bitstring = em2_2092 in
                                                                    {1674}let (=OpenSecureChannelResponse,wNs_2094: bitstring,ST_2095: bitstring,TTL_2096: bitstring) = m2_2093 in
                                                                    {1675}let Ns_2097: bitstring = dec(wNs_2094,skCli_1835) in
                                                                    {1676}let Kcli_2098: bitstring = h((Nc_2089,Ns_2097)) in
                                                                    {1677}out(c, senc(mCli(pkCli_1836,pkSess_2086),Kcli_2098))
                                                        )
                                                        else
                                                            {1678}let pkSess_2099: bitstring = fail-any in
                                                            {1679}out(c, GetEndpointRequest);
                                                            {1680}in(c, (=GetEndpointResponse,=pkSess_2099,=None,SP_2100: bitstring,UP_2101: bitstring));
                                                            {1681}new Nc_2102: bitstring;
                                                            {1682}let wNc_2103: bitstring = enc(Nc_2102,pkSess_2099) in
                                                            {1683}let m1_2104: bitstring = (OpenSecureChannelRequest,pkCli_1836,wNc_2103) in
                                                            {1684}out(c, (pkCli_1836,m1_2104));
                                                            {1685}in(c, em2_2105: bitstring);
                                                            {1686}let m2_2106: bitstring = em2_2105 in
                                                            {1687}let (=OpenSecureChannelResponse,wNs_2107: bitstring,ST_2108: bitstring,TTL_2109: bitstring) = m2_2106 in
                                                            {1688}let Ns_2110: bitstring = dec(wNs_2107,skCli_1835) in
                                                            {1689}let Kcli_2111: bitstring = h((Nc_2102,Ns_2110)) in
                                                            {1690}out(c, senc(mCli(pkCli_1836,pkSess_2099),Kcli_2111))
                                                )
                                                else
                                                    {1691}let pkSess_2112: bitstring = fail-any in
                                                    {1692}out(c, GetEndpointRequest);
                                                    {1693}in(c, (=GetEndpointResponse,=pkSess_2112,=None,SP_2113: bitstring,UP_2114: bitstring));
                                                    {1694}new Nc_2115: bitstring;
                                                    {1695}let wNc_2116: bitstring = enc(Nc_2115,pkSess_2112) in
                                                    {1696}let m1_2117: bitstring = (OpenSecureChannelRequest,pkCli_1836,wNc_2116) in
                                                    {1697}out(c, (pkCli_1836,m1_2117));
                                                    {1698}in(c, em2_2118: bitstring);
                                                    {1699}let m2_2119: bitstring = em2_2118 in
                                                    {1700}let (=OpenSecureChannelResponse,wNs_2120: bitstring,ST_2121: bitstring,TTL_2122: bitstring) = m2_2119 in
                                                    {1701}let Ns_2123: bitstring = dec(wNs_2120,skCli_1835) in
                                                    {1702}let Kcli_2124: bitstring = h((Nc_2115,Ns_2123)) in
                                                    {1703}out(c, senc(mCli(pkCli_1836,pkSess_2112),Kcli_2124))
                                            )
                                            else
                                                {1704}let pkDisco_2125: bitstring = pub(sk(Disco)) in
                                                {1705}let v_2126: bool = (Sess = A) in
                                                (
                                                    {1706}if v_2126 then
                                                    (
                                                        {1707}let pkSess_2127: bitstring = pub(skA) in
                                                        {1708}out(c, GetEndpointRequest);
                                                        {1709}in(c, (=GetEndpointResponse,=pkSess_2127,=None,SP_2128: bitstring,UP_2129: bitstring));
                                                        {1710}new Nc_2130: bitstring;
                                                        {1711}let wNc_2131: bitstring = enc(Nc_2130,pkSess_2127) in
                                                        {1712}let m1_2132: bitstring = (OpenSecureChannelRequest,pkCli_1836,wNc_2131) in
                                                        {1713}out(c, (pkCli_1836,m1_2132));
                                                        {1714}in(c, em2_2133: bitstring);
                                                        {1715}let m2_2134: bitstring = em2_2133 in
                                                        {1716}let (=OpenSecureChannelResponse,wNs_2135: bitstring,ST_2136: bitstring,TTL_2137: bitstring) = m2_2134 in
                                                        {1717}let Ns_2138: bitstring = dec(wNs_2135,skCli_1835) in
                                                        {1718}let Kcli_2139: bitstring = h((Nc_2130,Ns_2138)) in
                                                        {1719}out(c, senc(mCli(pkCli_1836,pkSess_2127),Kcli_2139))
                                                    )
                                                    else
                                                        {1720}let v_2140: bool = (Sess = B) in
                                                        (
                                                            {1721}if v_2140 then
                                                            (
                                                                {1722}let pkSess_2141: bitstring = pub(skB) in
                                                                {1723}out(c, GetEndpointRequest);
                                                                {1724}in(c, (=GetEndpointResponse,=pkSess_2141,=None,SP_2142: bitstring,UP_2143: bitstring));
                                                                {1725}new Nc_2144: bitstring;
                                                                {1726}let wNc_2145: bitstring = enc(Nc_2144,pkSess_2141) in
                                                                {1727}let m1_2146: bitstring = (OpenSecureChannelRequest,pkCli_1836,wNc_2145) in
                                                                {1728}out(c, (pkCli_1836,m1_2146));
                                                                {1729}in(c, em2_2147: bitstring);
                                                                {1730}let m2_2148: bitstring = em2_2147 in
                                                                {1731}let (=OpenSecureChannelResponse,wNs_2149: bitstring,ST_2150: bitstring,TTL_2151: bitstring) = m2_2148 in
                                                                {1732}let Ns_2152: bitstring = dec(wNs_2149,skCli_1835) in
                                                                {1733}let Kcli_2153: bitstring = h((Nc_2144,Ns_2152)) in
                                                                {1734}out(c, senc(mCli(pkCli_1836,pkSess_2141),Kcli_2153))
                                                            )
                                                            else
                                                                {1735}let v_2154: bool = (Sess = C) in
                                                                (
                                                                    {1736}if v_2154 then
                                                                    (
                                                                        {1737}let pkSess_2155: bitstring = pub(skC) in
                                                                        {1738}out(c, GetEndpointRequest);
                                                                        {1739}in(c, (=GetEndpointResponse,=pkSess_2155,=None,SP_2156: bitstring,UP_2157: bitstring));
                                                                        {1740}new Nc_2158: bitstring;
                                                                        {1741}let wNc_2159: bitstring = enc(Nc_2158,pkSess_2155) in
                                                                        {1742}let m1_2160: bitstring = (OpenSecureChannelRequest,pkCli_1836,wNc_2159) in
                                                                        {1743}out(c, (pkCli_1836,m1_2160));
                                                                        {1744}in(c, em2_2161: bitstring);
                                                                        {1745}let m2_2162: bitstring = em2_2161 in
                                                                        {1746}let (=OpenSecureChannelResponse,wNs_2163: bitstring,ST_2164: bitstring,TTL_2165: bitstring) = m2_2162 in
                                                                        {1747}let Ns_2166: bitstring = dec(wNs_2163,skCli_1835) in
                                                                        {1748}let Kcli_2167: bitstring = h((Nc_2158,Ns_2166)) in
                                                                        {1749}out(c, senc(mCli(pkCli_1836,pkSess_2155),Kcli_2167))
                                                                    )
                                                                    else
                                                                        {1750}let pkSess_2168: bitstring = pub(sk(Sess)) in
                                                                        {1751}out(c, GetEndpointRequest);
                                                                        {1752}in(c, (=GetEndpointResponse,=pkSess_2168,=None,SP_2169: bitstring,UP_2170: bitstring));
                                                                        {1753}new Nc_2171: bitstring;
                                                                        {1754}let wNc_2172: bitstring = enc(Nc_2171,pkSess_2168) in
                                                                        {1755}let m1_2173: bitstring = (OpenSecureChannelRequest,pkCli_1836,wNc_2172) in
                                                                        {1756}out(c, (pkCli_1836,m1_2173));
                                                                        {1757}in(c, em2_2174: bitstring);
                                                                        {1758}let m2_2175: bitstring = em2_2174 in
                                                                        {1759}let (=OpenSecureChannelResponse,wNs_2176: bitstring,ST_2177: bitstring,TTL_2178: bitstring) = m2_2175 in
                                                                        {1760}let Ns_2179: bitstring = dec(wNs_2176,skCli_1835) in
                                                                        {1761}let Kcli_2180: bitstring = h((Nc_2171,Ns_2179)) in
                                                                        {1762}out(c, senc(mCli(pkCli_1836,pkSess_2168),Kcli_2180))
                                                                )
                                                                else
                                                                    {1763}let pkSess_2181: bitstring = fail-any in
                                                                    {1764}out(c, GetEndpointRequest);
                                                                    {1765}in(c, (=GetEndpointResponse,=pkSess_2181,=None,SP_2182: bitstring,UP_2183: bitstring));
                                                                    {1766}new Nc_2184: bitstring;
                                                                    {1767}let wNc_2185: bitstring = enc(Nc_2184,pkSess_2181) in
                                                                    {1768}let m1_2186: bitstring = (OpenSecureChannelRequest,pkCli_1836,wNc_2185) in
                                                                    {1769}out(c, (pkCli_1836,m1_2186));
                                                                    {1770}in(c, em2_2187: bitstring);
                                                                    {1771}let m2_2188: bitstring = em2_2187 in
                                                                    {1772}let (=OpenSecureChannelResponse,wNs_2189: bitstring,ST_2190: bitstring,TTL_2191: bitstring) = m2_2188 in
                                                                    {1773}let Ns_2192: bitstring = dec(wNs_2189,skCli_1835) in
                                                                    {1774}let Kcli_2193: bitstring = h((Nc_2184,Ns_2192)) in
                                                                    {1775}out(c, senc(mCli(pkCli_1836,pkSess_2181),Kcli_2193))
                                                        )
                                                        else
                                                            {1776}let pkSess_2194: bitstring = fail-any in
                                                            {1777}out(c, GetEndpointRequest);
                                                            {1778}in(c, (=GetEndpointResponse,=pkSess_2194,=None,SP_2195: bitstring,UP_2196: bitstring));
                                                            {1779}new Nc_2197: bitstring;
                                                            {1780}let wNc_2198: bitstring = enc(Nc_2197,pkSess_2194) in
                                                            {1781}let m1_2199: bitstring = (OpenSecureChannelRequest,pkCli_1836,wNc_2198) in
                                                            {1782}out(c, (pkCli_1836,m1_2199));
                                                            {1783}in(c, em2_2200: bitstring);
                                                            {1784}let m2_2201: bitstring = em2_2200 in
                                                            {1785}let (=OpenSecureChannelResponse,wNs_2202: bitstring,ST_2203: bitstring,TTL_2204: bitstring) = m2_2201 in
                                                            {1786}let Ns_2205: bitstring = dec(wNs_2202,skCli_1835) in
                                                            {1787}let Kcli_2206: bitstring = h((Nc_2197,Ns_2205)) in
                                                            {1788}out(c, senc(mCli(pkCli_1836,pkSess_2194),Kcli_2206))
                                                )
                                                else
                                                    {1789}let pkSess_2207: bitstring = fail-any in
                                                    {1790}out(c, GetEndpointRequest);
                                                    {1791}in(c, (=GetEndpointResponse,=pkSess_2207,=None,SP_2208: bitstring,UP_2209: bitstring));
                                                    {1792}new Nc_2210: bitstring;
                                                    {1793}let wNc_2211: bitstring = enc(Nc_2210,pkSess_2207) in
                                                    {1794}let m1_2212: bitstring = (OpenSecureChannelRequest,pkCli_1836,wNc_2211) in
                                                    {1795}out(c, (pkCli_1836,m1_2212));
                                                    {1796}in(c, em2_2213: bitstring);
                                                    {1797}let m2_2214: bitstring = em2_2213 in
                                                    {1798}let (=OpenSecureChannelResponse,wNs_2215: bitstring,ST_2216: bitstring,TTL_2217: bitstring) = m2_2214 in
                                                    {1799}let Ns_2218: bitstring = dec(wNs_2215,skCli_1835) in
                                                    {1800}let Kcli_2219: bitstring = h((Nc_2210,Ns_2218)) in
                                                    {1801}out(c, senc(mCli(pkCli_1836,pkSess_2207),Kcli_2219))
                                        )
                                        else
                                            {1802}let pkDisco_2220: bitstring = fail-any in
                                            {1803}let v_2221: bool = (Sess = A) in
                                            (
                                                {1804}if v_2221 then
                                                (
                                                    {1805}let pkSess_2222: bitstring = pub(skA) in
                                                    {1806}out(c, GetEndpointRequest);
                                                    {1807}in(c, (=GetEndpointResponse,=pkSess_2222,=None,SP_2223: bitstring,UP_2224: bitstring));
                                                    {1808}new Nc_2225: bitstring;
                                                    {1809}let wNc_2226: bitstring = enc(Nc_2225,pkSess_2222) in
                                                    {1810}let m1_2227: bitstring = (OpenSecureChannelRequest,pkCli_1836,wNc_2226) in
                                                    {1811}out(c, (pkCli_1836,m1_2227));
                                                    {1812}in(c, em2_2228: bitstring);
                                                    {1813}let m2_2229: bitstring = em2_2228 in
                                                    {1814}let (=OpenSecureChannelResponse,wNs_2230: bitstring,ST_2231: bitstring,TTL_2232: bitstring) = m2_2229 in
                                                    {1815}let Ns_2233: bitstring = dec(wNs_2230,skCli_1835) in
                                                    {1816}let Kcli_2234: bitstring = h((Nc_2225,Ns_2233)) in
                                                    {1817}out(c, senc(mCli(pkCli_1836,pkSess_2222),Kcli_2234))
                                                )
                                                else
                                                    {1818}let v_2235: bool = (Sess = B) in
                                                    (
                                                        {1819}if v_2235 then
                                                        (
                                                            {1820}let pkSess_2236: bitstring = pub(skB) in
                                                            {1821}out(c, GetEndpointRequest);
                                                            {1822}in(c, (=GetEndpointResponse,=pkSess_2236,=None,SP_2237: bitstring,UP_2238: bitstring));
                                                            {1823}new Nc_2239: bitstring;
                                                            {1824}let wNc_2240: bitstring = enc(Nc_2239,pkSess_2236) in
                                                            {1825}let m1_2241: bitstring = (OpenSecureChannelRequest,pkCli_1836,wNc_2240) in
                                                            {1826}out(c, (pkCli_1836,m1_2241));
                                                            {1827}in(c, em2_2242: bitstring);
                                                            {1828}let m2_2243: bitstring = em2_2242 in
                                                            {1829}let (=OpenSecureChannelResponse,wNs_2244: bitstring,ST_2245: bitstring,TTL_2246: bitstring) = m2_2243 in
                                                            {1830}let Ns_2247: bitstring = dec(wNs_2244,skCli_1835) in
                                                            {1831}let Kcli_2248: bitstring = h((Nc_2239,Ns_2247)) in
                                                            {1832}out(c, senc(mCli(pkCli_1836,pkSess_2236),Kcli_2248))
                                                        )
                                                        else
                                                            {1833}let v_2249: bool = (Sess = C) in
                                                            (
                                                                {1834}if v_2249 then
                                                                (
                                                                    {1835}let pkSess_2250: bitstring = pub(skC) in
                                                                    {1836}out(c, GetEndpointRequest);
                                                                    {1837}in(c, (=GetEndpointResponse,=pkSess_2250,=None,SP_2251: bitstring,UP_2252: bitstring));
                                                                    {1838}new Nc_2253: bitstring;
                                                                    {1839}let wNc_2254: bitstring = enc(Nc_2253,pkSess_2250) in
                                                                    {1840}let m1_2255: bitstring = (OpenSecureChannelRequest,pkCli_1836,wNc_2254) in
                                                                    {1841}out(c, (pkCli_1836,m1_2255));
                                                                    {1842}in(c, em2_2256: bitstring);
                                                                    {1843}let m2_2257: bitstring = em2_2256 in
                                                                    {1844}let (=OpenSecureChannelResponse,wNs_2258: bitstring,ST_2259: bitstring,TTL_2260: bitstring) = m2_2257 in
                                                                    {1845}let Ns_2261: bitstring = dec(wNs_2258,skCli_1835) in
                                                                    {1846}let Kcli_2262: bitstring = h((Nc_2253,Ns_2261)) in
                                                                    {1847}out(c, senc(mCli(pkCli_1836,pkSess_2250),Kcli_2262))
                                                                )
                                                                else
                                                                    {1848}let pkSess_2263: bitstring = pub(sk(Sess)) in
                                                                    {1849}out(c, GetEndpointRequest);
                                                                    {1850}in(c, (=GetEndpointResponse,=pkSess_2263,=None,SP_2264: bitstring,UP_2265: bitstring));
                                                                    {1851}new Nc_2266: bitstring;
                                                                    {1852}let wNc_2267: bitstring = enc(Nc_2266,pkSess_2263) in
                                                                    {1853}let m1_2268: bitstring = (OpenSecureChannelRequest,pkCli_1836,wNc_2267) in
                                                                    {1854}out(c, (pkCli_1836,m1_2268));
                                                                    {1855}in(c, em2_2269: bitstring);
                                                                    {1856}let m2_2270: bitstring = em2_2269 in
                                                                    {1857}let (=OpenSecureChannelResponse,wNs_2271: bitstring,ST_2272: bitstring,TTL_2273: bitstring) = m2_2270 in
                                                                    {1858}let Ns_2274: bitstring = dec(wNs_2271,skCli_1835) in
                                                                    {1859}let Kcli_2275: bitstring = h((Nc_2266,Ns_2274)) in
                                                                    {1860}out(c, senc(mCli(pkCli_1836,pkSess_2263),Kcli_2275))
                                                            )
                                                            else
                                                                {1861}let pkSess_2276: bitstring = fail-any in
                                                                {1862}out(c, GetEndpointRequest);
                                                                {1863}in(c, (=GetEndpointResponse,=pkSess_2276,=None,SP_2277: bitstring,UP_2278: bitstring));
                                                                {1864}new Nc_2279: bitstring;
                                                                {1865}let wNc_2280: bitstring = enc(Nc_2279,pkSess_2276) in
                                                                {1866}let m1_2281: bitstring = (OpenSecureChannelRequest,pkCli_1836,wNc_2280) in
                                                                {1867}out(c, (pkCli_1836,m1_2281));
                                                                {1868}in(c, em2_2282: bitstring);
                                                                {1869}let m2_2283: bitstring = em2_2282 in
                                                                {1870}let (=OpenSecureChannelResponse,wNs_2284: bitstring,ST_2285: bitstring,TTL_2286: bitstring) = m2_2283 in
                                                                {1871}let Ns_2287: bitstring = dec(wNs_2284,skCli_1835) in
                                                                {1872}let Kcli_2288: bitstring = h((Nc_2279,Ns_2287)) in
                                                                {1873}out(c, senc(mCli(pkCli_1836,pkSess_2276),Kcli_2288))
                                                    )
                                                    else
                                                        {1874}let pkSess_2289: bitstring = fail-any in
                                                        {1875}out(c, GetEndpointRequest);
                                                        {1876}in(c, (=GetEndpointResponse,=pkSess_2289,=None,SP_2290: bitstring,UP_2291: bitstring));
                                                        {1877}new Nc_2292: bitstring;
                                                        {1878}let wNc_2293: bitstring = enc(Nc_2292,pkSess_2289) in
                                                        {1879}let m1_2294: bitstring = (OpenSecureChannelRequest,pkCli_1836,wNc_2293) in
                                                        {1880}out(c, (pkCli_1836,m1_2294));
                                                        {1881}in(c, em2_2295: bitstring);
                                                        {1882}let m2_2296: bitstring = em2_2295 in
                                                        {1883}let (=OpenSecureChannelResponse,wNs_2297: bitstring,ST_2298: bitstring,TTL_2299: bitstring) = m2_2296 in
                                                        {1884}let Ns_2300: bitstring = dec(wNs_2297,skCli_1835) in
                                                        {1885}let Kcli_2301: bitstring = h((Nc_2292,Ns_2300)) in
                                                        {1886}out(c, senc(mCli(pkCli_1836,pkSess_2289),Kcli_2301))
                                            )
                                            else
                                                {1887}let pkSess_2302: bitstring = fail-any in
                                                {1888}out(c, GetEndpointRequest);
                                                {1889}in(c, (=GetEndpointResponse,=pkSess_2302,=None,SP_2303: bitstring,UP_2304: bitstring));
                                                {1890}new Nc_2305: bitstring;
                                                {1891}let wNc_2306: bitstring = enc(Nc_2305,pkSess_2302) in
                                                {1892}let m1_2307: bitstring = (OpenSecureChannelRequest,pkCli_1836,wNc_2306) in
                                                {1893}out(c, (pkCli_1836,m1_2307));
                                                {1894}in(c, em2_2308: bitstring);
                                                {1895}let m2_2309: bitstring = em2_2308 in
                                                {1896}let (=OpenSecureChannelResponse,wNs_2310: bitstring,ST_2311: bitstring,TTL_2312: bitstring) = m2_2309 in
                                                {1897}let Ns_2313: bitstring = dec(wNs_2310,skCli_1835) in
                                                {1898}let Kcli_2314: bitstring = h((Nc_2305,Ns_2313)) in
                                                {1899}out(c, senc(mCli(pkCli_1836,pkSess_2302),Kcli_2314))
                                )
                                else
                                    {1900}let pkDisco_2315: bitstring = fail-any in
                                    {1901}let v_2316: bool = (Sess = A) in
                                    (
                                        {1902}if v_2316 then
                                        (
                                            {1903}let pkSess_2317: bitstring = pub(skA) in
                                            {1904}out(c, GetEndpointRequest);
                                            {1905}in(c, (=GetEndpointResponse,=pkSess_2317,=None,SP_2318: bitstring,UP_2319: bitstring));
                                            {1906}new Nc_2320: bitstring;
                                            {1907}let wNc_2321: bitstring = enc(Nc_2320,pkSess_2317) in
                                            {1908}let m1_2322: bitstring = (OpenSecureChannelRequest,pkCli_1836,wNc_2321) in
                                            {1909}out(c, (pkCli_1836,m1_2322));
                                            {1910}in(c, em2_2323: bitstring);
                                            {1911}let m2_2324: bitstring = em2_2323 in
                                            {1912}let (=OpenSecureChannelResponse,wNs_2325: bitstring,ST_2326: bitstring,TTL_2327: bitstring) = m2_2324 in
                                            {1913}let Ns_2328: bitstring = dec(wNs_2325,skCli_1835) in
                                            {1914}let Kcli_2329: bitstring = h((Nc_2320,Ns_2328)) in
                                            {1915}out(c, senc(mCli(pkCli_1836,pkSess_2317),Kcli_2329))
                                        )
                                        else
                                            {1916}let v_2330: bool = (Sess = B) in
                                            (
                                                {1917}if v_2330 then
                                                (
                                                    {1918}let pkSess_2331: bitstring = pub(skB) in
                                                    {1919}out(c, GetEndpointRequest);
                                                    {1920}in(c, (=GetEndpointResponse,=pkSess_2331,=None,SP_2332: bitstring,UP_2333: bitstring));
                                                    {1921}new Nc_2334: bitstring;
                                                    {1922}let wNc_2335: bitstring = enc(Nc_2334,pkSess_2331) in
                                                    {1923}let m1_2336: bitstring = (OpenSecureChannelRequest,pkCli_1836,wNc_2335) in
                                                    {1924}out(c, (pkCli_1836,m1_2336));
                                                    {1925}in(c, em2_2337: bitstring);
                                                    {1926}let m2_2338: bitstring = em2_2337 in
                                                    {1927}let (=OpenSecureChannelResponse,wNs_2339: bitstring,ST_2340: bitstring,TTL_2341: bitstring) = m2_2338 in
                                                    {1928}let Ns_2342: bitstring = dec(wNs_2339,skCli_1835) in
                                                    {1929}let Kcli_2343: bitstring = h((Nc_2334,Ns_2342)) in
                                                    {1930}out(c, senc(mCli(pkCli_1836,pkSess_2331),Kcli_2343))
                                                )
                                                else
                                                    {1931}let v_2344: bool = (Sess = C) in
                                                    (
                                                        {1932}if v_2344 then
                                                        (
                                                            {1933}let pkSess_2345: bitstring = pub(skC) in
                                                            {1934}out(c, GetEndpointRequest);
                                                            {1935}in(c, (=GetEndpointResponse,=pkSess_2345,=None,SP_2346: bitstring,UP_2347: bitstring));
                                                            {1936}new Nc_2348: bitstring;
                                                            {1937}let wNc_2349: bitstring = enc(Nc_2348,pkSess_2345) in
                                                            {1938}let m1_2350: bitstring = (OpenSecureChannelRequest,pkCli_1836,wNc_2349) in
                                                            {1939}out(c, (pkCli_1836,m1_2350));
                                                            {1940}in(c, em2_2351: bitstring);
                                                            {1941}let m2_2352: bitstring = em2_2351 in
                                                            {1942}let (=OpenSecureChannelResponse,wNs_2353: bitstring,ST_2354: bitstring,TTL_2355: bitstring) = m2_2352 in
                                                            {1943}let Ns_2356: bitstring = dec(wNs_2353,skCli_1835) in
                                                            {1944}let Kcli_2357: bitstring = h((Nc_2348,Ns_2356)) in
                                                            {1945}out(c, senc(mCli(pkCli_1836,pkSess_2345),Kcli_2357))
                                                        )
                                                        else
                                                            {1946}let pkSess_2358: bitstring = pub(sk(Sess)) in
                                                            {1947}out(c, GetEndpointRequest);
                                                            {1948}in(c, (=GetEndpointResponse,=pkSess_2358,=None,SP_2359: bitstring,UP_2360: bitstring));
                                                            {1949}new Nc_2361: bitstring;
                                                            {1950}let wNc_2362: bitstring = enc(Nc_2361,pkSess_2358) in
                                                            {1951}let m1_2363: bitstring = (OpenSecureChannelRequest,pkCli_1836,wNc_2362) in
                                                            {1952}out(c, (pkCli_1836,m1_2363));
                                                            {1953}in(c, em2_2364: bitstring);
                                                            {1954}let m2_2365: bitstring = em2_2364 in
                                                            {1955}let (=OpenSecureChannelResponse,wNs_2366: bitstring,ST_2367: bitstring,TTL_2368: bitstring) = m2_2365 in
                                                            {1956}let Ns_2369: bitstring = dec(wNs_2366,skCli_1835) in
                                                            {1957}let Kcli_2370: bitstring = h((Nc_2361,Ns_2369)) in
                                                            {1958}out(c, senc(mCli(pkCli_1836,pkSess_2358),Kcli_2370))
                                                    )
                                                    else
                                                        {1959}let pkSess_2371: bitstring = fail-any in
                                                        {1960}out(c, GetEndpointRequest);
                                                        {1961}in(c, (=GetEndpointResponse,=pkSess_2371,=None,SP_2372: bitstring,UP_2373: bitstring));
                                                        {1962}new Nc_2374: bitstring;
                                                        {1963}let wNc_2375: bitstring = enc(Nc_2374,pkSess_2371) in
                                                        {1964}let m1_2376: bitstring = (OpenSecureChannelRequest,pkCli_1836,wNc_2375) in
                                                        {1965}out(c, (pkCli_1836,m1_2376));
                                                        {1966}in(c, em2_2377: bitstring);
                                                        {1967}let m2_2378: bitstring = em2_2377 in
                                                        {1968}let (=OpenSecureChannelResponse,wNs_2379: bitstring,ST_2380: bitstring,TTL_2381: bitstring) = m2_2378 in
                                                        {1969}let Ns_2382: bitstring = dec(wNs_2379,skCli_1835) in
                                                        {1970}let Kcli_2383: bitstring = h((Nc_2374,Ns_2382)) in
                                                        {1971}out(c, senc(mCli(pkCli_1836,pkSess_2371),Kcli_2383))
                                            )
                                            else
                                                {1972}let pkSess_2384: bitstring = fail-any in
                                                {1973}out(c, GetEndpointRequest);
                                                {1974}in(c, (=GetEndpointResponse,=pkSess_2384,=None,SP_2385: bitstring,UP_2386: bitstring));
                                                {1975}new Nc_2387: bitstring;
                                                {1976}let wNc_2388: bitstring = enc(Nc_2387,pkSess_2384) in
                                                {1977}let m1_2389: bitstring = (OpenSecureChannelRequest,pkCli_1836,wNc_2388) in
                                                {1978}out(c, (pkCli_1836,m1_2389));
                                                {1979}in(c, em2_2390: bitstring);
                                                {1980}let m2_2391: bitstring = em2_2390 in
                                                {1981}let (=OpenSecureChannelResponse,wNs_2392: bitstring,ST_2393: bitstring,TTL_2394: bitstring) = m2_2391 in
                                                {1982}let Ns_2395: bitstring = dec(wNs_2392,skCli_1835) in
                                                {1983}let Kcli_2396: bitstring = h((Nc_2387,Ns_2395)) in
                                                {1984}out(c, senc(mCli(pkCli_1836,pkSess_2384),Kcli_2396))
                                    )
                                    else
                                        {1985}let pkSess_2397: bitstring = fail-any in
                                        {1986}out(c, GetEndpointRequest);
                                        {1987}in(c, (=GetEndpointResponse,=pkSess_2397,=None,SP_2398: bitstring,UP_2399: bitstring));
                                        {1988}new Nc_2400: bitstring;
                                        {1989}let wNc_2401: bitstring = enc(Nc_2400,pkSess_2397) in
                                        {1990}let m1_2402: bitstring = (OpenSecureChannelRequest,pkCli_1836,wNc_2401) in
                                        {1991}out(c, (pkCli_1836,m1_2402));
                                        {1992}in(c, em2_2403: bitstring);
                                        {1993}let m2_2404: bitstring = em2_2403 in
                                        {1994}let (=OpenSecureChannelResponse,wNs_2405: bitstring,ST_2406: bitstring,TTL_2407: bitstring) = m2_2404 in
                                        {1995}let Ns_2408: bitstring = dec(wNs_2405,skCli_1835) in
                                        {1996}let Kcli_2409: bitstring = h((Nc_2400,Ns_2408)) in
                                        {1997}out(c, senc(mCli(pkCli_1836,pkSess_2397),Kcli_2409))
                        )
                        else
                            {1998}let pkDisco_2410: bitstring = fail-any in
                            {1999}let v_2411: bool = (Sess = A) in
                            (
                                {2000}if v_2411 then
                                (
                                    {2001}let pkSess_2412: bitstring = pub(skA) in
                                    {2002}out(c, GetEndpointRequest);
                                    {2003}in(c, (=GetEndpointResponse,=pkSess_2412,=None,SP_2413: bitstring,UP_2414: bitstring));
                                    {2004}new Nc_2415: bitstring;
                                    {2005}let wNc_2416: bitstring = enc(Nc_2415,pkSess_2412) in
                                    {2006}let m1_2417: bitstring = (OpenSecureChannelRequest,pkCli_1836,wNc_2416) in
                                    {2007}out(c, (pkCli_1836,m1_2417));
                                    {2008}in(c, em2_2418: bitstring);
                                    {2009}let m2_2419: bitstring = em2_2418 in
                                    {2010}let (=OpenSecureChannelResponse,wNs_2420: bitstring,ST_2421: bitstring,TTL_2422: bitstring) = m2_2419 in
                                    {2011}let Ns_2423: bitstring = dec(wNs_2420,skCli_1835) in
                                    {2012}let Kcli_2424: bitstring = h((Nc_2415,Ns_2423)) in
                                    {2013}out(c, senc(mCli(pkCli_1836,pkSess_2412),Kcli_2424))
                                )
                                else
                                    {2014}let v_2425: bool = (Sess = B) in
                                    (
                                        {2015}if v_2425 then
                                        (
                                            {2016}let pkSess_2426: bitstring = pub(skB) in
                                            {2017}out(c, GetEndpointRequest);
                                            {2018}in(c, (=GetEndpointResponse,=pkSess_2426,=None,SP_2427: bitstring,UP_2428: bitstring));
                                            {2019}new Nc_2429: bitstring;
                                            {2020}let wNc_2430: bitstring = enc(Nc_2429,pkSess_2426) in
                                            {2021}let m1_2431: bitstring = (OpenSecureChannelRequest,pkCli_1836,wNc_2430) in
                                            {2022}out(c, (pkCli_1836,m1_2431));
                                            {2023}in(c, em2_2432: bitstring);
                                            {2024}let m2_2433: bitstring = em2_2432 in
                                            {2025}let (=OpenSecureChannelResponse,wNs_2434: bitstring,ST_2435: bitstring,TTL_2436: bitstring) = m2_2433 in
                                            {2026}let Ns_2437: bitstring = dec(wNs_2434,skCli_1835) in
                                            {2027}let Kcli_2438: bitstring = h((Nc_2429,Ns_2437)) in
                                            {2028}out(c, senc(mCli(pkCli_1836,pkSess_2426),Kcli_2438))
                                        )
                                        else
                                            {2029}let v_2439: bool = (Sess = C) in
                                            (
                                                {2030}if v_2439 then
                                                (
                                                    {2031}let pkSess_2440: bitstring = pub(skC) in
                                                    {2032}out(c, GetEndpointRequest);
                                                    {2033}in(c, (=GetEndpointResponse,=pkSess_2440,=None,SP_2441: bitstring,UP_2442: bitstring));
                                                    {2034}new Nc_2443: bitstring;
                                                    {2035}let wNc_2444: bitstring = enc(Nc_2443,pkSess_2440) in
                                                    {2036}let m1_2445: bitstring = (OpenSecureChannelRequest,pkCli_1836,wNc_2444) in
                                                    {2037}out(c, (pkCli_1836,m1_2445));
                                                    {2038}in(c, em2_2446: bitstring);
                                                    {2039}let m2_2447: bitstring = em2_2446 in
                                                    {2040}let (=OpenSecureChannelResponse,wNs_2448: bitstring,ST_2449: bitstring,TTL_2450: bitstring) = m2_2447 in
                                                    {2041}let Ns_2451: bitstring = dec(wNs_2448,skCli_1835) in
                                                    {2042}let Kcli_2452: bitstring = h((Nc_2443,Ns_2451)) in
                                                    {2043}out(c, senc(mCli(pkCli_1836,pkSess_2440),Kcli_2452))
                                                )
                                                else
                                                    {2044}let pkSess_2453: bitstring = pub(sk(Sess)) in
                                                    {2045}out(c, GetEndpointRequest);
                                                    {2046}in(c, (=GetEndpointResponse,=pkSess_2453,=None,SP_2454: bitstring,UP_2455: bitstring));
                                                    {2047}new Nc_2456: bitstring;
                                                    {2048}let wNc_2457: bitstring = enc(Nc_2456,pkSess_2453) in
                                                    {2049}let m1_2458: bitstring = (OpenSecureChannelRequest,pkCli_1836,wNc_2457) in
                                                    {2050}out(c, (pkCli_1836,m1_2458));
                                                    {2051}in(c, em2_2459: bitstring);
                                                    {2052}let m2_2460: bitstring = em2_2459 in
                                                    {2053}let (=OpenSecureChannelResponse,wNs_2461: bitstring,ST_2462: bitstring,TTL_2463: bitstring) = m2_2460 in
                                                    {2054}let Ns_2464: bitstring = dec(wNs_2461,skCli_1835) in
                                                    {2055}let Kcli_2465: bitstring = h((Nc_2456,Ns_2464)) in
                                                    {2056}out(c, senc(mCli(pkCli_1836,pkSess_2453),Kcli_2465))
                                            )
                                            else
                                                {2057}let pkSess_2466: bitstring = fail-any in
                                                {2058}out(c, GetEndpointRequest);
                                                {2059}in(c, (=GetEndpointResponse,=pkSess_2466,=None,SP_2467: bitstring,UP_2468: bitstring));
                                                {2060}new Nc_2469: bitstring;
                                                {2061}let wNc_2470: bitstring = enc(Nc_2469,pkSess_2466) in
                                                {2062}let m1_2471: bitstring = (OpenSecureChannelRequest,pkCli_1836,wNc_2470) in
                                                {2063}out(c, (pkCli_1836,m1_2471));
                                                {2064}in(c, em2_2472: bitstring);
                                                {2065}let m2_2473: bitstring = em2_2472 in
                                                {2066}let (=OpenSecureChannelResponse,wNs_2474: bitstring,ST_2475: bitstring,TTL_2476: bitstring) = m2_2473 in
                                                {2067}let Ns_2477: bitstring = dec(wNs_2474,skCli_1835) in
                                                {2068}let Kcli_2478: bitstring = h((Nc_2469,Ns_2477)) in
                                                {2069}out(c, senc(mCli(pkCli_1836,pkSess_2466),Kcli_2478))
                                    )
                                    else
                                        {2070}let pkSess_2479: bitstring = fail-any in
                                        {2071}out(c, GetEndpointRequest);
                                        {2072}in(c, (=GetEndpointResponse,=pkSess_2479,=None,SP_2480: bitstring,UP_2481: bitstring));
                                        {2073}new Nc_2482: bitstring;
                                        {2074}let wNc_2483: bitstring = enc(Nc_2482,pkSess_2479) in
                                        {2075}let m1_2484: bitstring = (OpenSecureChannelRequest,pkCli_1836,wNc_2483) in
                                        {2076}out(c, (pkCli_1836,m1_2484));
                                        {2077}in(c, em2_2485: bitstring);
                                        {2078}let m2_2486: bitstring = em2_2485 in
                                        {2079}let (=OpenSecureChannelResponse,wNs_2487: bitstring,ST_2488: bitstring,TTL_2489: bitstring) = m2_2486 in
                                        {2080}let Ns_2490: bitstring = dec(wNs_2487,skCli_1835) in
                                        {2081}let Kcli_2491: bitstring = h((Nc_2482,Ns_2490)) in
                                        {2082}out(c, senc(mCli(pkCli_1836,pkSess_2479),Kcli_2491))
                            )
                            else
                                {2083}let pkSess_2492: bitstring = fail-any in
                                {2084}out(c, GetEndpointRequest);
                                {2085}in(c, (=GetEndpointResponse,=pkSess_2492,=None,SP_2493: bitstring,UP_2494: bitstring));
                                {2086}new Nc_2495: bitstring;
                                {2087}let wNc_2496: bitstring = enc(Nc_2495,pkSess_2492) in
                                {2088}let m1_2497: bitstring = (OpenSecureChannelRequest,pkCli_1836,wNc_2496) in
                                {2089}out(c, (pkCli_1836,m1_2497));
                                {2090}in(c, em2_2498: bitstring);
                                {2091}let m2_2499: bitstring = em2_2498 in
                                {2092}let (=OpenSecureChannelResponse,wNs_2500: bitstring,ST_2501: bitstring,TTL_2502: bitstring) = m2_2499 in
                                {2093}let Ns_2503: bitstring = dec(wNs_2500,skCli_1835) in
                                {2094}let Kcli_2504: bitstring = h((Nc_2495,Ns_2503)) in
                                {2095}out(c, senc(mCli(pkCli_1836,pkSess_2492),Kcli_2504))
                    )
                    else
                        {2096}let skCli_2505: bitstring = fail-any in
                        {2097}let pkCli_2506: bitstring = pub(skCli_2505) in
                        {2098}let v_2507: bool = (Disco = A) in
                        (
                            {2099}if v_2507 then
                            (
                                {2100}let pkDisco_2508: bitstring = pub(skA) in
                                {2101}let v_2509: bool = (Sess = A) in
                                (
                                    {2102}if v_2509 then
                                    (
                                        {2103}let pkSess_2510: bitstring = pub(skA) in
                                        {2104}out(c, GetEndpointRequest);
                                        {2105}in(c, (=GetEndpointResponse,=pkSess_2510,=None,SP_2511: bitstring,UP_2512: bitstring));
                                        {2106}new Nc_2513: bitstring;
                                        {2107}let wNc_2514: bitstring = enc(Nc_2513,pkSess_2510) in
                                        {2108}let m1_2515: bitstring = (OpenSecureChannelRequest,pkCli_2506,wNc_2514) in
                                        {2109}out(c, (pkCli_2506,m1_2515));
                                        {2110}in(c, em2_2516: bitstring);
                                        {2111}let m2_2517: bitstring = em2_2516 in
                                        {2112}let (=OpenSecureChannelResponse,wNs_2518: bitstring,ST_2519: bitstring,TTL_2520: bitstring) = m2_2517 in
                                        {2113}let Ns_2521: bitstring = dec(wNs_2518,skCli_2505) in
                                        {2114}let Kcli_2522: bitstring = h((Nc_2513,Ns_2521)) in
                                        {2115}out(c, senc(mCli(pkCli_2506,pkSess_2510),Kcli_2522))
                                    )
                                    else
                                        {2116}let v_2523: bool = (Sess = B) in
                                        (
                                            {2117}if v_2523 then
                                            (
                                                {2118}let pkSess_2524: bitstring = pub(skB) in
                                                {2119}out(c, GetEndpointRequest);
                                                {2120}in(c, (=GetEndpointResponse,=pkSess_2524,=None,SP_2525: bitstring,UP_2526: bitstring));
                                                {2121}new Nc_2527: bitstring;
                                                {2122}let wNc_2528: bitstring = enc(Nc_2527,pkSess_2524) in
                                                {2123}let m1_2529: bitstring = (OpenSecureChannelRequest,pkCli_2506,wNc_2528) in
                                                {2124}out(c, (pkCli_2506,m1_2529));
                                                {2125}in(c, em2_2530: bitstring);
                                                {2126}let m2_2531: bitstring = em2_2530 in
                                                {2127}let (=OpenSecureChannelResponse,wNs_2532: bitstring,ST_2533: bitstring,TTL_2534: bitstring) = m2_2531 in
                                                {2128}let Ns_2535: bitstring = dec(wNs_2532,skCli_2505) in
                                                {2129}let Kcli_2536: bitstring = h((Nc_2527,Ns_2535)) in
                                                {2130}out(c, senc(mCli(pkCli_2506,pkSess_2524),Kcli_2536))
                                            )
                                            else
                                                {2131}let v_2537: bool = (Sess = C) in
                                                (
                                                    {2132}if v_2537 then
                                                    (
                                                        {2133}let pkSess_2538: bitstring = pub(skC) in
                                                        {2134}out(c, GetEndpointRequest);
                                                        {2135}in(c, (=GetEndpointResponse,=pkSess_2538,=None,SP_2539: bitstring,UP_2540: bitstring));
                                                        {2136}new Nc_2541: bitstring;
                                                        {2137}let wNc_2542: bitstring = enc(Nc_2541,pkSess_2538) in
                                                        {2138}let m1_2543: bitstring = (OpenSecureChannelRequest,pkCli_2506,wNc_2542) in
                                                        {2139}out(c, (pkCli_2506,m1_2543));
                                                        {2140}in(c, em2_2544: bitstring);
                                                        {2141}let m2_2545: bitstring = em2_2544 in
                                                        {2142}let (=OpenSecureChannelResponse,wNs_2546: bitstring,ST_2547: bitstring,TTL_2548: bitstring) = m2_2545 in
                                                        {2143}let Ns_2549: bitstring = dec(wNs_2546,skCli_2505) in
                                                        {2144}let Kcli_2550: bitstring = h((Nc_2541,Ns_2549)) in
                                                        {2145}out(c, senc(mCli(pkCli_2506,pkSess_2538),Kcli_2550))
                                                    )
                                                    else
                                                        {2146}let pkSess_2551: bitstring = pub(sk(Sess)) in
                                                        {2147}out(c, GetEndpointRequest);
                                                        {2148}in(c, (=GetEndpointResponse,=pkSess_2551,=None,SP_2552: bitstring,UP_2553: bitstring));
                                                        {2149}new Nc_2554: bitstring;
                                                        {2150}let wNc_2555: bitstring = enc(Nc_2554,pkSess_2551) in
                                                        {2151}let m1_2556: bitstring = (OpenSecureChannelRequest,pkCli_2506,wNc_2555) in
                                                        {2152}out(c, (pkCli_2506,m1_2556));
                                                        {2153}in(c, em2_2557: bitstring);
                                                        {2154}let m2_2558: bitstring = em2_2557 in
                                                        {2155}let (=OpenSecureChannelResponse,wNs_2559: bitstring,ST_2560: bitstring,TTL_2561: bitstring) = m2_2558 in
                                                        {2156}let Ns_2562: bitstring = dec(wNs_2559,skCli_2505) in
                                                        {2157}let Kcli_2563: bitstring = h((Nc_2554,Ns_2562)) in
                                                        {2158}out(c, senc(mCli(pkCli_2506,pkSess_2551),Kcli_2563))
                                                )
                                                else
                                                    {2159}let pkSess_2564: bitstring = fail-any in
                                                    {2160}out(c, GetEndpointRequest);
                                                    {2161}in(c, (=GetEndpointResponse,=pkSess_2564,=None,SP_2565: bitstring,UP_2566: bitstring));
                                                    {2162}new Nc_2567: bitstring;
                                                    {2163}let wNc_2568: bitstring = enc(Nc_2567,pkSess_2564) in
                                                    {2164}let m1_2569: bitstring = (OpenSecureChannelRequest,pkCli_2506,wNc_2568) in
                                                    {2165}out(c, (pkCli_2506,m1_2569));
                                                    {2166}in(c, em2_2570: bitstring);
                                                    {2167}let m2_2571: bitstring = em2_2570 in
                                                    {2168}let (=OpenSecureChannelResponse,wNs_2572: bitstring,ST_2573: bitstring,TTL_2574: bitstring) = m2_2571 in
                                                    {2169}let Ns_2575: bitstring = dec(wNs_2572,skCli_2505) in
                                                    {2170}let Kcli_2576: bitstring = h((Nc_2567,Ns_2575)) in
                                                    {2171}out(c, senc(mCli(pkCli_2506,pkSess_2564),Kcli_2576))
                                        )
                                        else
                                            {2172}let pkSess_2577: bitstring = fail-any in
                                            {2173}out(c, GetEndpointRequest);
                                            {2174}in(c, (=GetEndpointResponse,=pkSess_2577,=None,SP_2578: bitstring,UP_2579: bitstring));
                                            {2175}new Nc_2580: bitstring;
                                            {2176}let wNc_2581: bitstring = enc(Nc_2580,pkSess_2577) in
                                            {2177}let m1_2582: bitstring = (OpenSecureChannelRequest,pkCli_2506,wNc_2581) in
                                            {2178}out(c, (pkCli_2506,m1_2582));
                                            {2179}in(c, em2_2583: bitstring);
                                            {2180}let m2_2584: bitstring = em2_2583 in
                                            {2181}let (=OpenSecureChannelResponse,wNs_2585: bitstring,ST_2586: bitstring,TTL_2587: bitstring) = m2_2584 in
                                            {2182}let Ns_2588: bitstring = dec(wNs_2585,skCli_2505) in
                                            {2183}let Kcli_2589: bitstring = h((Nc_2580,Ns_2588)) in
                                            {2184}out(c, senc(mCli(pkCli_2506,pkSess_2577),Kcli_2589))
                                )
                                else
                                    {2185}let pkSess_2590: bitstring = fail-any in
                                    {2186}out(c, GetEndpointRequest);
                                    {2187}in(c, (=GetEndpointResponse,=pkSess_2590,=None,SP_2591: bitstring,UP_2592: bitstring));
                                    {2188}new Nc_2593: bitstring;
                                    {2189}let wNc_2594: bitstring = enc(Nc_2593,pkSess_2590) in
                                    {2190}let m1_2595: bitstring = (OpenSecureChannelRequest,pkCli_2506,wNc_2594) in
                                    {2191}out(c, (pkCli_2506,m1_2595));
                                    {2192}in(c, em2_2596: bitstring);
                                    {2193}let m2_2597: bitstring = em2_2596 in
                                    {2194}let (=OpenSecureChannelResponse,wNs_2598: bitstring,ST_2599: bitstring,TTL_2600: bitstring) = m2_2597 in
                                    {2195}let Ns_2601: bitstring = dec(wNs_2598,skCli_2505) in
                                    {2196}let Kcli_2602: bitstring = h((Nc_2593,Ns_2601)) in
                                    {2197}out(c, senc(mCli(pkCli_2506,pkSess_2590),Kcli_2602))
                            )
                            else
                                {2198}let v_2603: bool = (Disco = B) in
                                (
                                    {2199}if v_2603 then
                                    (
                                        {2200}let pkDisco_2604: bitstring = pub(skB) in
                                        {2201}let v_2605: bool = (Sess = A) in
                                        (
                                            {2202}if v_2605 then
                                            (
                                                {2203}let pkSess_2606: bitstring = pub(skA) in
                                                {2204}out(c, GetEndpointRequest);
                                                {2205}in(c, (=GetEndpointResponse,=pkSess_2606,=None,SP_2607: bitstring,UP_2608: bitstring));
                                                {2206}new Nc_2609: bitstring;
                                                {2207}let wNc_2610: bitstring = enc(Nc_2609,pkSess_2606) in
                                                {2208}let m1_2611: bitstring = (OpenSecureChannelRequest,pkCli_2506,wNc_2610) in
                                                {2209}out(c, (pkCli_2506,m1_2611));
                                                {2210}in(c, em2_2612: bitstring);
                                                {2211}let m2_2613: bitstring = em2_2612 in
                                                {2212}let (=OpenSecureChannelResponse,wNs_2614: bitstring,ST_2615: bitstring,TTL_2616: bitstring) = m2_2613 in
                                                {2213}let Ns_2617: bitstring = dec(wNs_2614,skCli_2505) in
                                                {2214}let Kcli_2618: bitstring = h((Nc_2609,Ns_2617)) in
                                                {2215}out(c, senc(mCli(pkCli_2506,pkSess_2606),Kcli_2618))
                                            )
                                            else
                                                {2216}let v_2619: bool = (Sess = B) in
                                                (
                                                    {2217}if v_2619 then
                                                    (
                                                        {2218}let pkSess_2620: bitstring = pub(skB) in
                                                        {2219}out(c, GetEndpointRequest);
                                                        {2220}in(c, (=GetEndpointResponse,=pkSess_2620,=None,SP_2621: bitstring,UP_2622: bitstring));
                                                        {2221}new Nc_2623: bitstring;
                                                        {2222}let wNc_2624: bitstring = enc(Nc_2623,pkSess_2620) in
                                                        {2223}let m1_2625: bitstring = (OpenSecureChannelRequest,pkCli_2506,wNc_2624) in
                                                        {2224}out(c, (pkCli_2506,m1_2625));
                                                        {2225}in(c, em2_2626: bitstring);
                                                        {2226}let m2_2627: bitstring = em2_2626 in
                                                        {2227}let (=OpenSecureChannelResponse,wNs_2628: bitstring,ST_2629: bitstring,TTL_2630: bitstring) = m2_2627 in
                                                        {2228}let Ns_2631: bitstring = dec(wNs_2628,skCli_2505) in
                                                        {2229}let Kcli_2632: bitstring = h((Nc_2623,Ns_2631)) in
                                                        {2230}out(c, senc(mCli(pkCli_2506,pkSess_2620),Kcli_2632))
                                                    )
                                                    else
                                                        {2231}let v_2633: bool = (Sess = C) in
                                                        (
                                                            {2232}if v_2633 then
                                                            (
                                                                {2233}let pkSess_2634: bitstring = pub(skC) in
                                                                {2234}out(c, GetEndpointRequest);
                                                                {2235}in(c, (=GetEndpointResponse,=pkSess_2634,=None,SP_2635: bitstring,UP_2636: bitstring));
                                                                {2236}new Nc_2637: bitstring;
                                                                {2237}let wNc_2638: bitstring = enc(Nc_2637,pkSess_2634) in
                                                                {2238}let m1_2639: bitstring = (OpenSecureChannelRequest,pkCli_2506,wNc_2638) in
                                                                {2239}out(c, (pkCli_2506,m1_2639));
                                                                {2240}in(c, em2_2640: bitstring);
                                                                {2241}let m2_2641: bitstring = em2_2640 in
                                                                {2242}let (=OpenSecureChannelResponse,wNs_2642: bitstring,ST_2643: bitstring,TTL_2644: bitstring) = m2_2641 in
                                                                {2243}let Ns_2645: bitstring = dec(wNs_2642,skCli_2505) in
                                                                {2244}let Kcli_2646: bitstring = h((Nc_2637,Ns_2645)) in
                                                                {2245}out(c, senc(mCli(pkCli_2506,pkSess_2634),Kcli_2646))
                                                            )
                                                            else
                                                                {2246}let pkSess_2647: bitstring = pub(sk(Sess)) in
                                                                {2247}out(c, GetEndpointRequest);
                                                                {2248}in(c, (=GetEndpointResponse,=pkSess_2647,=None,SP_2648: bitstring,UP_2649: bitstring));
                                                                {2249}new Nc_2650: bitstring;
                                                                {2250}let wNc_2651: bitstring = enc(Nc_2650,pkSess_2647) in
                                                                {2251}let m1_2652: bitstring = (OpenSecureChannelRequest,pkCli_2506,wNc_2651) in
                                                                {2252}out(c, (pkCli_2506,m1_2652));
                                                                {2253}in(c, em2_2653: bitstring);
                                                                {2254}let m2_2654: bitstring = em2_2653 in
                                                                {2255}let (=OpenSecureChannelResponse,wNs_2655: bitstring,ST_2656: bitstring,TTL_2657: bitstring) = m2_2654 in
                                                                {2256}let Ns_2658: bitstring = dec(wNs_2655,skCli_2505) in
                                                                {2257}let Kcli_2659: bitstring = h((Nc_2650,Ns_2658)) in
                                                                {2258}out(c, senc(mCli(pkCli_2506,pkSess_2647),Kcli_2659))
                                                        )
                                                        else
                                                            {2259}let pkSess_2660: bitstring = fail-any in
                                                            {2260}out(c, GetEndpointRequest);
                                                            {2261}in(c, (=GetEndpointResponse,=pkSess_2660,=None,SP_2661: bitstring,UP_2662: bitstring));
                                                            {2262}new Nc_2663: bitstring;
                                                            {2263}let wNc_2664: bitstring = enc(Nc_2663,pkSess_2660) in
                                                            {2264}let m1_2665: bitstring = (OpenSecureChannelRequest,pkCli_2506,wNc_2664) in
                                                            {2265}out(c, (pkCli_2506,m1_2665));
                                                            {2266}in(c, em2_2666: bitstring);
                                                            {2267}let m2_2667: bitstring = em2_2666 in
                                                            {2268}let (=OpenSecureChannelResponse,wNs_2668: bitstring,ST_2669: bitstring,TTL_2670: bitstring) = m2_2667 in
                                                            {2269}let Ns_2671: bitstring = dec(wNs_2668,skCli_2505) in
                                                            {2270}let Kcli_2672: bitstring = h((Nc_2663,Ns_2671)) in
                                                            {2271}out(c, senc(mCli(pkCli_2506,pkSess_2660),Kcli_2672))
                                                )
                                                else
                                                    {2272}let pkSess_2673: bitstring = fail-any in
                                                    {2273}out(c, GetEndpointRequest);
                                                    {2274}in(c, (=GetEndpointResponse,=pkSess_2673,=None,SP_2674: bitstring,UP_2675: bitstring));
                                                    {2275}new Nc_2676: bitstring;
                                                    {2276}let wNc_2677: bitstring = enc(Nc_2676,pkSess_2673) in
                                                    {2277}let m1_2678: bitstring = (OpenSecureChannelRequest,pkCli_2506,wNc_2677) in
                                                    {2278}out(c, (pkCli_2506,m1_2678));
                                                    {2279}in(c, em2_2679: bitstring);
                                                    {2280}let m2_2680: bitstring = em2_2679 in
                                                    {2281}let (=OpenSecureChannelResponse,wNs_2681: bitstring,ST_2682: bitstring,TTL_2683: bitstring) = m2_2680 in
                                                    {2282}let Ns_2684: bitstring = dec(wNs_2681,skCli_2505) in
                                                    {2283}let Kcli_2685: bitstring = h((Nc_2676,Ns_2684)) in
                                                    {2284}out(c, senc(mCli(pkCli_2506,pkSess_2673),Kcli_2685))
                                        )
                                        else
                                            {2285}let pkSess_2686: bitstring = fail-any in
                                            {2286}out(c, GetEndpointRequest);
                                            {2287}in(c, (=GetEndpointResponse,=pkSess_2686,=None,SP_2687: bitstring,UP_2688: bitstring));
                                            {2288}new Nc_2689: bitstring;
                                            {2289}let wNc_2690: bitstring = enc(Nc_2689,pkSess_2686) in
                                            {2290}let m1_2691: bitstring = (OpenSecureChannelRequest,pkCli_2506,wNc_2690) in
                                            {2291}out(c, (pkCli_2506,m1_2691));
                                            {2292}in(c, em2_2692: bitstring);
                                            {2293}let m2_2693: bitstring = em2_2692 in
                                            {2294}let (=OpenSecureChannelResponse,wNs_2694: bitstring,ST_2695: bitstring,TTL_2696: bitstring) = m2_2693 in
                                            {2295}let Ns_2697: bitstring = dec(wNs_2694,skCli_2505) in
                                            {2296}let Kcli_2698: bitstring = h((Nc_2689,Ns_2697)) in
                                            {2297}out(c, senc(mCli(pkCli_2506,pkSess_2686),Kcli_2698))
                                    )
                                    else
                                        {2298}let v_2699: bool = (Disco = C) in
                                        (
                                            {2299}if v_2699 then
                                            (
                                                {2300}let pkDisco_2700: bitstring = pub(skC) in
                                                {2301}let v_2701: bool = (Sess = A) in
                                                (
                                                    {2302}if v_2701 then
                                                    (
                                                        {2303}let pkSess_2702: bitstring = pub(skA) in
                                                        {2304}out(c, GetEndpointRequest);
                                                        {2305}in(c, (=GetEndpointResponse,=pkSess_2702,=None,SP_2703: bitstring,UP_2704: bitstring));
                                                        {2306}new Nc_2705: bitstring;
                                                        {2307}let wNc_2706: bitstring = enc(Nc_2705,pkSess_2702) in
                                                        {2308}let m1_2707: bitstring = (OpenSecureChannelRequest,pkCli_2506,wNc_2706) in
                                                        {2309}out(c, (pkCli_2506,m1_2707));
                                                        {2310}in(c, em2_2708: bitstring);
                                                        {2311}let m2_2709: bitstring = em2_2708 in
                                                        {2312}let (=OpenSecureChannelResponse,wNs_2710: bitstring,ST_2711: bitstring,TTL_2712: bitstring) = m2_2709 in
                                                        {2313}let Ns_2713: bitstring = dec(wNs_2710,skCli_2505) in
                                                        {2314}let Kcli_2714: bitstring = h((Nc_2705,Ns_2713)) in
                                                        {2315}out(c, senc(mCli(pkCli_2506,pkSess_2702),Kcli_2714))
                                                    )
                                                    else
                                                        {2316}let v_2715: bool = (Sess = B) in
                                                        (
                                                            {2317}if v_2715 then
                                                            (
                                                                {2318}let pkSess_2716: bitstring = pub(skB) in
                                                                {2319}out(c, GetEndpointRequest);
                                                                {2320}in(c, (=GetEndpointResponse,=pkSess_2716,=None,SP_2717: bitstring,UP_2718: bitstring));
                                                                {2321}new Nc_2719: bitstring;
                                                                {2322}let wNc_2720: bitstring = enc(Nc_2719,pkSess_2716) in
                                                                {2323}let m1_2721: bitstring = (OpenSecureChannelRequest,pkCli_2506,wNc_2720) in
                                                                {2324}out(c, (pkCli_2506,m1_2721));
                                                                {2325}in(c, em2_2722: bitstring);
                                                                {2326}let m2_2723: bitstring = em2_2722 in
                                                                {2327}let (=OpenSecureChannelResponse,wNs_2724: bitstring,ST_2725: bitstring,TTL_2726: bitstring) = m2_2723 in
                                                                {2328}let Ns_2727: bitstring = dec(wNs_2724,skCli_2505) in
                                                                {2329}let Kcli_2728: bitstring = h((Nc_2719,Ns_2727)) in
                                                                {2330}out(c, senc(mCli(pkCli_2506,pkSess_2716),Kcli_2728))
                                                            )
                                                            else
                                                                {2331}let v_2729: bool = (Sess = C) in
                                                                (
                                                                    {2332}if v_2729 then
                                                                    (
                                                                        {2333}let pkSess_2730: bitstring = pub(skC) in
                                                                        {2334}out(c, GetEndpointRequest);
                                                                        {2335}in(c, (=GetEndpointResponse,=pkSess_2730,=None,SP_2731: bitstring,UP_2732: bitstring));
                                                                        {2336}new Nc_2733: bitstring;
                                                                        {2337}let wNc_2734: bitstring = enc(Nc_2733,pkSess_2730) in
                                                                        {2338}let m1_2735: bitstring = (OpenSecureChannelRequest,pkCli_2506,wNc_2734) in
                                                                        {2339}out(c, (pkCli_2506,m1_2735));
                                                                        {2340}in(c, em2_2736: bitstring);
                                                                        {2341}let m2_2737: bitstring = em2_2736 in
                                                                        {2342}let (=OpenSecureChannelResponse,wNs_2738: bitstring,ST_2739: bitstring,TTL_2740: bitstring) = m2_2737 in
                                                                        {2343}let Ns_2741: bitstring = dec(wNs_2738,skCli_2505) in
                                                                        {2344}let Kcli_2742: bitstring = h((Nc_2733,Ns_2741)) in
                                                                        {2345}out(c, senc(mCli(pkCli_2506,pkSess_2730),Kcli_2742))
                                                                    )
                                                                    else
                                                                        {2346}let pkSess_2743: bitstring = pub(sk(Sess)) in
                                                                        {2347}out(c, GetEndpointRequest);
                                                                        {2348}in(c, (=GetEndpointResponse,=pkSess_2743,=None,SP_2744: bitstring,UP_2745: bitstring));
                                                                        {2349}new Nc_2746: bitstring;
                                                                        {2350}let wNc_2747: bitstring = enc(Nc_2746,pkSess_2743) in
                                                                        {2351}let m1_2748: bitstring = (OpenSecureChannelRequest,pkCli_2506,wNc_2747) in
                                                                        {2352}out(c, (pkCli_2506,m1_2748));
                                                                        {2353}in(c, em2_2749: bitstring);
                                                                        {2354}let m2_2750: bitstring = em2_2749 in
                                                                        {2355}let (=OpenSecureChannelResponse,wNs_2751: bitstring,ST_2752: bitstring,TTL_2753: bitstring) = m2_2750 in
                                                                        {2356}let Ns_2754: bitstring = dec(wNs_2751,skCli_2505) in
                                                                        {2357}let Kcli_2755: bitstring = h((Nc_2746,Ns_2754)) in
                                                                        {2358}out(c, senc(mCli(pkCli_2506,pkSess_2743),Kcli_2755))
                                                                )
                                                                else
                                                                    {2359}let pkSess_2756: bitstring = fail-any in
                                                                    {2360}out(c, GetEndpointRequest);
                                                                    {2361}in(c, (=GetEndpointResponse,=pkSess_2756,=None,SP_2757: bitstring,UP_2758: bitstring));
                                                                    {2362}new Nc_2759: bitstring;
                                                                    {2363}let wNc_2760: bitstring = enc(Nc_2759,pkSess_2756) in
                                                                    {2364}let m1_2761: bitstring = (OpenSecureChannelRequest,pkCli_2506,wNc_2760) in
                                                                    {2365}out(c, (pkCli_2506,m1_2761));
                                                                    {2366}in(c, em2_2762: bitstring);
                                                                    {2367}let m2_2763: bitstring = em2_2762 in
                                                                    {2368}let (=OpenSecureChannelResponse,wNs_2764: bitstring,ST_2765: bitstring,TTL_2766: bitstring) = m2_2763 in
                                                                    {2369}let Ns_2767: bitstring = dec(wNs_2764,skCli_2505) in
                                                                    {2370}let Kcli_2768: bitstring = h((Nc_2759,Ns_2767)) in
                                                                    {2371}out(c, senc(mCli(pkCli_2506,pkSess_2756),Kcli_2768))
                                                        )
                                                        else
                                                            {2372}let pkSess_2769: bitstring = fail-any in
                                                            {2373}out(c, GetEndpointRequest);
                                                            {2374}in(c, (=GetEndpointResponse,=pkSess_2769,=None,SP_2770: bitstring,UP_2771: bitstring));
                                                            {2375}new Nc_2772: bitstring;
                                                            {2376}let wNc_2773: bitstring = enc(Nc_2772,pkSess_2769) in
                                                            {2377}let m1_2774: bitstring = (OpenSecureChannelRequest,pkCli_2506,wNc_2773) in
                                                            {2378}out(c, (pkCli_2506,m1_2774));
                                                            {2379}in(c, em2_2775: bitstring);
                                                            {2380}let m2_2776: bitstring = em2_2775 in
                                                            {2381}let (=OpenSecureChannelResponse,wNs_2777: bitstring,ST_2778: bitstring,TTL_2779: bitstring) = m2_2776 in
                                                            {2382}let Ns_2780: bitstring = dec(wNs_2777,skCli_2505) in
                                                            {2383}let Kcli_2781: bitstring = h((Nc_2772,Ns_2780)) in
                                                            {2384}out(c, senc(mCli(pkCli_2506,pkSess_2769),Kcli_2781))
                                                )
                                                else
                                                    {2385}let pkSess_2782: bitstring = fail-any in
                                                    {2386}out(c, GetEndpointRequest);
                                                    {2387}in(c, (=GetEndpointResponse,=pkSess_2782,=None,SP_2783: bitstring,UP_2784: bitstring));
                                                    {2388}new Nc_2785: bitstring;
                                                    {2389}let wNc_2786: bitstring = enc(Nc_2785,pkSess_2782) in
                                                    {2390}let m1_2787: bitstring = (OpenSecureChannelRequest,pkCli_2506,wNc_2786) in
                                                    {2391}out(c, (pkCli_2506,m1_2787));
                                                    {2392}in(c, em2_2788: bitstring);
                                                    {2393}let m2_2789: bitstring = em2_2788 in
                                                    {2394}let (=OpenSecureChannelResponse,wNs_2790: bitstring,ST_2791: bitstring,TTL_2792: bitstring) = m2_2789 in
                                                    {2395}let Ns_2793: bitstring = dec(wNs_2790,skCli_2505) in
                                                    {2396}let Kcli_2794: bitstring = h((Nc_2785,Ns_2793)) in
                                                    {2397}out(c, senc(mCli(pkCli_2506,pkSess_2782),Kcli_2794))
                                            )
                                            else
                                                {2398}let pkDisco_2795: bitstring = pub(sk(Disco)) in
                                                {2399}let v_2796: bool = (Sess = A) in
                                                (
                                                    {2400}if v_2796 then
                                                    (
                                                        {2401}let pkSess_2797: bitstring = pub(skA) in
                                                        {2402}out(c, GetEndpointRequest);
                                                        {2403}in(c, (=GetEndpointResponse,=pkSess_2797,=None,SP_2798: bitstring,UP_2799: bitstring));
                                                        {2404}new Nc_2800: bitstring;
                                                        {2405}let wNc_2801: bitstring = enc(Nc_2800,pkSess_2797) in
                                                        {2406}let m1_2802: bitstring = (OpenSecureChannelRequest,pkCli_2506,wNc_2801) in
                                                        {2407}out(c, (pkCli_2506,m1_2802));
                                                        {2408}in(c, em2_2803: bitstring);
                                                        {2409}let m2_2804: bitstring = em2_2803 in
                                                        {2410}let (=OpenSecureChannelResponse,wNs_2805: bitstring,ST_2806: bitstring,TTL_2807: bitstring) = m2_2804 in
                                                        {2411}let Ns_2808: bitstring = dec(wNs_2805,skCli_2505) in
                                                        {2412}let Kcli_2809: bitstring = h((Nc_2800,Ns_2808)) in
                                                        {2413}out(c, senc(mCli(pkCli_2506,pkSess_2797),Kcli_2809))
                                                    )
                                                    else
                                                        {2414}let v_2810: bool = (Sess = B) in
                                                        (
                                                            {2415}if v_2810 then
                                                            (
                                                                {2416}let pkSess_2811: bitstring = pub(skB) in
                                                                {2417}out(c, GetEndpointRequest);
                                                                {2418}in(c, (=GetEndpointResponse,=pkSess_2811,=None,SP_2812: bitstring,UP_2813: bitstring));
                                                                {2419}new Nc_2814: bitstring;
                                                                {2420}let wNc_2815: bitstring = enc(Nc_2814,pkSess_2811) in
                                                                {2421}let m1_2816: bitstring = (OpenSecureChannelRequest,pkCli_2506,wNc_2815) in
                                                                {2422}out(c, (pkCli_2506,m1_2816));
                                                                {2423}in(c, em2_2817: bitstring);
                                                                {2424}let m2_2818: bitstring = em2_2817 in
                                                                {2425}let (=OpenSecureChannelResponse,wNs_2819: bitstring,ST_2820: bitstring,TTL_2821: bitstring) = m2_2818 in
                                                                {2426}let Ns_2822: bitstring = dec(wNs_2819,skCli_2505) in
                                                                {2427}let Kcli_2823: bitstring = h((Nc_2814,Ns_2822)) in
                                                                {2428}out(c, senc(mCli(pkCli_2506,pkSess_2811),Kcli_2823))
                                                            )
                                                            else
                                                                {2429}let v_2824: bool = (Sess = C) in
                                                                (
                                                                    {2430}if v_2824 then
                                                                    (
                                                                        {2431}let pkSess_2825: bitstring = pub(skC) in
                                                                        {2432}out(c, GetEndpointRequest);
                                                                        {2433}in(c, (=GetEndpointResponse,=pkSess_2825,=None,SP_2826: bitstring,UP_2827: bitstring));
                                                                        {2434}new Nc_2828: bitstring;
                                                                        {2435}let wNc_2829: bitstring = enc(Nc_2828,pkSess_2825) in
                                                                        {2436}let m1_2830: bitstring = (OpenSecureChannelRequest,pkCli_2506,wNc_2829) in
                                                                        {2437}out(c, (pkCli_2506,m1_2830));
                                                                        {2438}in(c, em2_2831: bitstring);
                                                                        {2439}let m2_2832: bitstring = em2_2831 in
                                                                        {2440}let (=OpenSecureChannelResponse,wNs_2833: bitstring,ST_2834: bitstring,TTL_2835: bitstring) = m2_2832 in
                                                                        {2441}let Ns_2836: bitstring = dec(wNs_2833,skCli_2505) in
                                                                        {2442}let Kcli_2837: bitstring = h((Nc_2828,Ns_2836)) in
                                                                        {2443}out(c, senc(mCli(pkCli_2506,pkSess_2825),Kcli_2837))
                                                                    )
                                                                    else
                                                                        {2444}let pkSess_2838: bitstring = pub(sk(Sess)) in
                                                                        {2445}out(c, GetEndpointRequest);
                                                                        {2446}in(c, (=GetEndpointResponse,=pkSess_2838,=None,SP_2839: bitstring,UP_2840: bitstring));
                                                                        {2447}new Nc_2841: bitstring;
                                                                        {2448}let wNc_2842: bitstring = enc(Nc_2841,pkSess_2838) in
                                                                        {2449}let m1_2843: bitstring = (OpenSecureChannelRequest,pkCli_2506,wNc_2842) in
                                                                        {2450}out(c, (pkCli_2506,m1_2843));
                                                                        {2451}in(c, em2_2844: bitstring);
                                                                        {2452}let m2_2845: bitstring = em2_2844 in
                                                                        {2453}let (=OpenSecureChannelResponse,wNs_2846: bitstring,ST_2847: bitstring,TTL_2848: bitstring) = m2_2845 in
                                                                        {2454}let Ns_2849: bitstring = dec(wNs_2846,skCli_2505) in
                                                                        {2455}let Kcli_2850: bitstring = h((Nc_2841,Ns_2849)) in
                                                                        {2456}out(c, senc(mCli(pkCli_2506,pkSess_2838),Kcli_2850))
                                                                )
                                                                else
                                                                    {2457}let pkSess_2851: bitstring = fail-any in
                                                                    {2458}out(c, GetEndpointRequest);
                                                                    {2459}in(c, (=GetEndpointResponse,=pkSess_2851,=None,SP_2852: bitstring,UP_2853: bitstring));
                                                                    {2460}new Nc_2854: bitstring;
                                                                    {2461}let wNc_2855: bitstring = enc(Nc_2854,pkSess_2851) in
                                                                    {2462}let m1_2856: bitstring = (OpenSecureChannelRequest,pkCli_2506,wNc_2855) in
                                                                    {2463}out(c, (pkCli_2506,m1_2856));
                                                                    {2464}in(c, em2_2857: bitstring);
                                                                    {2465}let m2_2858: bitstring = em2_2857 in
                                                                    {2466}let (=OpenSecureChannelResponse,wNs_2859: bitstring,ST_2860: bitstring,TTL_2861: bitstring) = m2_2858 in
                                                                    {2467}let Ns_2862: bitstring = dec(wNs_2859,skCli_2505) in
                                                                    {2468}let Kcli_2863: bitstring = h((Nc_2854,Ns_2862)) in
                                                                    {2469}out(c, senc(mCli(pkCli_2506,pkSess_2851),Kcli_2863))
                                                        )
                                                        else
                                                            {2470}let pkSess_2864: bitstring = fail-any in
                                                            {2471}out(c, GetEndpointRequest);
                                                            {2472}in(c, (=GetEndpointResponse,=pkSess_2864,=None,SP_2865: bitstring,UP_2866: bitstring));
                                                            {2473}new Nc_2867: bitstring;
                                                            {2474}let wNc_2868: bitstring = enc(Nc_2867,pkSess_2864) in
                                                            {2475}let m1_2869: bitstring = (OpenSecureChannelRequest,pkCli_2506,wNc_2868) in
                                                            {2476}out(c, (pkCli_2506,m1_2869));
                                                            {2477}in(c, em2_2870: bitstring);
                                                            {2478}let m2_2871: bitstring = em2_2870 in
                                                            {2479}let (=OpenSecureChannelResponse,wNs_2872: bitstring,ST_2873: bitstring,TTL_2874: bitstring) = m2_2871 in
                                                            {2480}let Ns_2875: bitstring = dec(wNs_2872,skCli_2505) in
                                                            {2481}let Kcli_2876: bitstring = h((Nc_2867,Ns_2875)) in
                                                            {2482}out(c, senc(mCli(pkCli_2506,pkSess_2864),Kcli_2876))
                                                )
                                                else
                                                    {2483}let pkSess_2877: bitstring = fail-any in
                                                    {2484}out(c, GetEndpointRequest);
                                                    {2485}in(c, (=GetEndpointResponse,=pkSess_2877,=None,SP_2878: bitstring,UP_2879: bitstring));
                                                    {2486}new Nc_2880: bitstring;
                                                    {2487}let wNc_2881: bitstring = enc(Nc_2880,pkSess_2877) in
                                                    {2488}let m1_2882: bitstring = (OpenSecureChannelRequest,pkCli_2506,wNc_2881) in
                                                    {2489}out(c, (pkCli_2506,m1_2882));
                                                    {2490}in(c, em2_2883: bitstring);
                                                    {2491}let m2_2884: bitstring = em2_2883 in
                                                    {2492}let (=OpenSecureChannelResponse,wNs_2885: bitstring,ST_2886: bitstring,TTL_2887: bitstring) = m2_2884 in
                                                    {2493}let Ns_2888: bitstring = dec(wNs_2885,skCli_2505) in
                                                    {2494}let Kcli_2889: bitstring = h((Nc_2880,Ns_2888)) in
                                                    {2495}out(c, senc(mCli(pkCli_2506,pkSess_2877),Kcli_2889))
                                        )
                                        else
                                            {2496}let pkDisco_2890: bitstring = fail-any in
                                            {2497}let v_2891: bool = (Sess = A) in
                                            (
                                                {2498}if v_2891 then
                                                (
                                                    {2499}let pkSess_2892: bitstring = pub(skA) in
                                                    {2500}out(c, GetEndpointRequest);
                                                    {2501}in(c, (=GetEndpointResponse,=pkSess_2892,=None,SP_2893: bitstring,UP_2894: bitstring));
                                                    {2502}new Nc_2895: bitstring;
                                                    {2503}let wNc_2896: bitstring = enc(Nc_2895,pkSess_2892) in
                                                    {2504}let m1_2897: bitstring = (OpenSecureChannelRequest,pkCli_2506,wNc_2896) in
                                                    {2505}out(c, (pkCli_2506,m1_2897));
                                                    {2506}in(c, em2_2898: bitstring);
                                                    {2507}let m2_2899: bitstring = em2_2898 in
                                                    {2508}let (=OpenSecureChannelResponse,wNs_2900: bitstring,ST_2901: bitstring,TTL_2902: bitstring) = m2_2899 in
                                                    {2509}let Ns_2903: bitstring = dec(wNs_2900,skCli_2505) in
                                                    {2510}let Kcli_2904: bitstring = h((Nc_2895,Ns_2903)) in
                                                    {2511}out(c, senc(mCli(pkCli_2506,pkSess_2892),Kcli_2904))
                                                )
                                                else
                                                    {2512}let v_2905: bool = (Sess = B) in
                                                    (
                                                        {2513}if v_2905 then
                                                        (
                                                            {2514}let pkSess_2906: bitstring = pub(skB) in
                                                            {2515}out(c, GetEndpointRequest);
                                                            {2516}in(c, (=GetEndpointResponse,=pkSess_2906,=None,SP_2907: bitstring,UP_2908: bitstring));
                                                            {2517}new Nc_2909: bitstring;
                                                            {2518}let wNc_2910: bitstring = enc(Nc_2909,pkSess_2906) in
                                                            {2519}let m1_2911: bitstring = (OpenSecureChannelRequest,pkCli_2506,wNc_2910) in
                                                            {2520}out(c, (pkCli_2506,m1_2911));
                                                            {2521}in(c, em2_2912: bitstring);
                                                            {2522}let m2_2913: bitstring = em2_2912 in
                                                            {2523}let (=OpenSecureChannelResponse,wNs_2914: bitstring,ST_2915: bitstring,TTL_2916: bitstring) = m2_2913 in
                                                            {2524}let Ns_2917: bitstring = dec(wNs_2914,skCli_2505) in
                                                            {2525}let Kcli_2918: bitstring = h((Nc_2909,Ns_2917)) in
                                                            {2526}out(c, senc(mCli(pkCli_2506,pkSess_2906),Kcli_2918))
                                                        )
                                                        else
                                                            {2527}let v_2919: bool = (Sess = C) in
                                                            (
                                                                {2528}if v_2919 then
                                                                (
                                                                    {2529}let pkSess_2920: bitstring = pub(skC) in
                                                                    {2530}out(c, GetEndpointRequest);
                                                                    {2531}in(c, (=GetEndpointResponse,=pkSess_2920,=None,SP_2921: bitstring,UP_2922: bitstring));
                                                                    {2532}new Nc_2923: bitstring;
                                                                    {2533}let wNc_2924: bitstring = enc(Nc_2923,pkSess_2920) in
                                                                    {2534}let m1_2925: bitstring = (OpenSecureChannelRequest,pkCli_2506,wNc_2924) in
                                                                    {2535}out(c, (pkCli_2506,m1_2925));
                                                                    {2536}in(c, em2_2926: bitstring);
                                                                    {2537}let m2_2927: bitstring = em2_2926 in
                                                                    {2538}let (=OpenSecureChannelResponse,wNs_2928: bitstring,ST_2929: bitstring,TTL_2930: bitstring) = m2_2927 in
                                                                    {2539}let Ns_2931: bitstring = dec(wNs_2928,skCli_2505) in
                                                                    {2540}let Kcli_2932: bitstring = h((Nc_2923,Ns_2931)) in
                                                                    {2541}out(c, senc(mCli(pkCli_2506,pkSess_2920),Kcli_2932))
                                                                )
                                                                else
                                                                    {2542}let pkSess_2933: bitstring = pub(sk(Sess)) in
                                                                    {2543}out(c, GetEndpointRequest);
                                                                    {2544}in(c, (=GetEndpointResponse,=pkSess_2933,=None,SP_2934: bitstring,UP_2935: bitstring));
                                                                    {2545}new Nc_2936: bitstring;
                                                                    {2546}let wNc_2937: bitstring = enc(Nc_2936,pkSess_2933) in
                                                                    {2547}let m1_2938: bitstring = (OpenSecureChannelRequest,pkCli_2506,wNc_2937) in
                                                                    {2548}out(c, (pkCli_2506,m1_2938));
                                                                    {2549}in(c, em2_2939: bitstring);
                                                                    {2550}let m2_2940: bitstring = em2_2939 in
                                                                    {2551}let (=OpenSecureChannelResponse,wNs_2941: bitstring,ST_2942: bitstring,TTL_2943: bitstring) = m2_2940 in
                                                                    {2552}let Ns_2944: bitstring = dec(wNs_2941,skCli_2505) in
                                                                    {2553}let Kcli_2945: bitstring = h((Nc_2936,Ns_2944)) in
                                                                    {2554}out(c, senc(mCli(pkCli_2506,pkSess_2933),Kcli_2945))
                                                            )
                                                            else
                                                                {2555}let pkSess_2946: bitstring = fail-any in
                                                                {2556}out(c, GetEndpointRequest);
                                                                {2557}in(c, (=GetEndpointResponse,=pkSess_2946,=None,SP_2947: bitstring,UP_2948: bitstring));
                                                                {2558}new Nc_2949: bitstring;
                                                                {2559}let wNc_2950: bitstring = enc(Nc_2949,pkSess_2946) in
                                                                {2560}let m1_2951: bitstring = (OpenSecureChannelRequest,pkCli_2506,wNc_2950) in
                                                                {2561}out(c, (pkCli_2506,m1_2951));
                                                                {2562}in(c, em2_2952: bitstring);
                                                                {2563}let m2_2953: bitstring = em2_2952 in
                                                                {2564}let (=OpenSecureChannelResponse,wNs_2954: bitstring,ST_2955: bitstring,TTL_2956: bitstring) = m2_2953 in
                                                                {2565}let Ns_2957: bitstring = dec(wNs_2954,skCli_2505) in
                                                                {2566}let Kcli_2958: bitstring = h((Nc_2949,Ns_2957)) in
                                                                {2567}out(c, senc(mCli(pkCli_2506,pkSess_2946),Kcli_2958))
                                                    )
                                                    else
                                                        {2568}let pkSess_2959: bitstring = fail-any in
                                                        {2569}out(c, GetEndpointRequest);
                                                        {2570}in(c, (=GetEndpointResponse,=pkSess_2959,=None,SP_2960: bitstring,UP_2961: bitstring));
                                                        {2571}new Nc_2962: bitstring;
                                                        {2572}let wNc_2963: bitstring = enc(Nc_2962,pkSess_2959) in
                                                        {2573}let m1_2964: bitstring = (OpenSecureChannelRequest,pkCli_2506,wNc_2963) in
                                                        {2574}out(c, (pkCli_2506,m1_2964));
                                                        {2575}in(c, em2_2965: bitstring);
                                                        {2576}let m2_2966: bitstring = em2_2965 in
                                                        {2577}let (=OpenSecureChannelResponse,wNs_2967: bitstring,ST_2968: bitstring,TTL_2969: bitstring) = m2_2966 in
                                                        {2578}let Ns_2970: bitstring = dec(wNs_2967,skCli_2505) in
                                                        {2579}let Kcli_2971: bitstring = h((Nc_2962,Ns_2970)) in
                                                        {2580}out(c, senc(mCli(pkCli_2506,pkSess_2959),Kcli_2971))
                                            )
                                            else
                                                {2581}let pkSess_2972: bitstring = fail-any in
                                                {2582}out(c, GetEndpointRequest);
                                                {2583}in(c, (=GetEndpointResponse,=pkSess_2972,=None,SP_2973: bitstring,UP_2974: bitstring));
                                                {2584}new Nc_2975: bitstring;
                                                {2585}let wNc_2976: bitstring = enc(Nc_2975,pkSess_2972) in
                                                {2586}let m1_2977: bitstring = (OpenSecureChannelRequest,pkCli_2506,wNc_2976) in
                                                {2587}out(c, (pkCli_2506,m1_2977));
                                                {2588}in(c, em2_2978: bitstring);
                                                {2589}let m2_2979: bitstring = em2_2978 in
                                                {2590}let (=OpenSecureChannelResponse,wNs_2980: bitstring,ST_2981: bitstring,TTL_2982: bitstring) = m2_2979 in
                                                {2591}let Ns_2983: bitstring = dec(wNs_2980,skCli_2505) in
                                                {2592}let Kcli_2984: bitstring = h((Nc_2975,Ns_2983)) in
                                                {2593}out(c, senc(mCli(pkCli_2506,pkSess_2972),Kcli_2984))
                                )
                                else
                                    {2594}let pkDisco_2985: bitstring = fail-any in
                                    {2595}let v_2986: bool = (Sess = A) in
                                    (
                                        {2596}if v_2986 then
                                        (
                                            {2597}let pkSess_2987: bitstring = pub(skA) in
                                            {2598}out(c, GetEndpointRequest);
                                            {2599}in(c, (=GetEndpointResponse,=pkSess_2987,=None,SP_2988: bitstring,UP_2989: bitstring));
                                            {2600}new Nc_2990: bitstring;
                                            {2601}let wNc_2991: bitstring = enc(Nc_2990,pkSess_2987) in
                                            {2602}let m1_2992: bitstring = (OpenSecureChannelRequest,pkCli_2506,wNc_2991) in
                                            {2603}out(c, (pkCli_2506,m1_2992));
                                            {2604}in(c, em2_2993: bitstring);
                                            {2605}let m2_2994: bitstring = em2_2993 in
                                            {2606}let (=OpenSecureChannelResponse,wNs_2995: bitstring,ST_2996: bitstring,TTL_2997: bitstring) = m2_2994 in
                                            {2607}let Ns_2998: bitstring = dec(wNs_2995,skCli_2505) in
                                            {2608}let Kcli_2999: bitstring = h((Nc_2990,Ns_2998)) in
                                            {2609}out(c, senc(mCli(pkCli_2506,pkSess_2987),Kcli_2999))
                                        )
                                        else
                                            {2610}let v_3000: bool = (Sess = B) in
                                            (
                                                {2611}if v_3000 then
                                                (
                                                    {2612}let pkSess_3001: bitstring = pub(skB) in
                                                    {2613}out(c, GetEndpointRequest);
                                                    {2614}in(c, (=GetEndpointResponse,=pkSess_3001,=None,SP_3002: bitstring,UP_3003: bitstring));
                                                    {2615}new Nc_3004: bitstring;
                                                    {2616}let wNc_3005: bitstring = enc(Nc_3004,pkSess_3001) in
                                                    {2617}let m1_3006: bitstring = (OpenSecureChannelRequest,pkCli_2506,wNc_3005) in
                                                    {2618}out(c, (pkCli_2506,m1_3006));
                                                    {2619}in(c, em2_3007: bitstring);
                                                    {2620}let m2_3008: bitstring = em2_3007 in
                                                    {2621}let (=OpenSecureChannelResponse,wNs_3009: bitstring,ST_3010: bitstring,TTL_3011: bitstring) = m2_3008 in
                                                    {2622}let Ns_3012: bitstring = dec(wNs_3009,skCli_2505) in
                                                    {2623}let Kcli_3013: bitstring = h((Nc_3004,Ns_3012)) in
                                                    {2624}out(c, senc(mCli(pkCli_2506,pkSess_3001),Kcli_3013))
                                                )
                                                else
                                                    {2625}let v_3014: bool = (Sess = C) in
                                                    (
                                                        {2626}if v_3014 then
                                                        (
                                                            {2627}let pkSess_3015: bitstring = pub(skC) in
                                                            {2628}out(c, GetEndpointRequest);
                                                            {2629}in(c, (=GetEndpointResponse,=pkSess_3015,=None,SP_3016: bitstring,UP_3017: bitstring));
                                                            {2630}new Nc_3018: bitstring;
                                                            {2631}let wNc_3019: bitstring = enc(Nc_3018,pkSess_3015) in
                                                            {2632}let m1_3020: bitstring = (OpenSecureChannelRequest,pkCli_2506,wNc_3019) in
                                                            {2633}out(c, (pkCli_2506,m1_3020));
                                                            {2634}in(c, em2_3021: bitstring);
                                                            {2635}let m2_3022: bitstring = em2_3021 in
                                                            {2636}let (=OpenSecureChannelResponse,wNs_3023: bitstring,ST_3024: bitstring,TTL_3025: bitstring) = m2_3022 in
                                                            {2637}let Ns_3026: bitstring = dec(wNs_3023,skCli_2505) in
                                                            {2638}let Kcli_3027: bitstring = h((Nc_3018,Ns_3026)) in
                                                            {2639}out(c, senc(mCli(pkCli_2506,pkSess_3015),Kcli_3027))
                                                        )
                                                        else
                                                            {2640}let pkSess_3028: bitstring = pub(sk(Sess)) in
                                                            {2641}out(c, GetEndpointRequest);
                                                            {2642}in(c, (=GetEndpointResponse,=pkSess_3028,=None,SP_3029: bitstring,UP_3030: bitstring));
                                                            {2643}new Nc_3031: bitstring;
                                                            {2644}let wNc_3032: bitstring = enc(Nc_3031,pkSess_3028) in
                                                            {2645}let m1_3033: bitstring = (OpenSecureChannelRequest,pkCli_2506,wNc_3032) in
                                                            {2646}out(c, (pkCli_2506,m1_3033));
                                                            {2647}in(c, em2_3034: bitstring);
                                                            {2648}let m2_3035: bitstring = em2_3034 in
                                                            {2649}let (=OpenSecureChannelResponse,wNs_3036: bitstring,ST_3037: bitstring,TTL_3038: bitstring) = m2_3035 in
                                                            {2650}let Ns_3039: bitstring = dec(wNs_3036,skCli_2505) in
                                                            {2651}let Kcli_3040: bitstring = h((Nc_3031,Ns_3039)) in
                                                            {2652}out(c, senc(mCli(pkCli_2506,pkSess_3028),Kcli_3040))
                                                    )
                                                    else
                                                        {2653}let pkSess_3041: bitstring = fail-any in
                                                        {2654}out(c, GetEndpointRequest);
                                                        {2655}in(c, (=GetEndpointResponse,=pkSess_3041,=None,SP_3042: bitstring,UP_3043: bitstring));
                                                        {2656}new Nc_3044: bitstring;
                                                        {2657}let wNc_3045: bitstring = enc(Nc_3044,pkSess_3041) in
                                                        {2658}let m1_3046: bitstring = (OpenSecureChannelRequest,pkCli_2506,wNc_3045) in
                                                        {2659}out(c, (pkCli_2506,m1_3046));
                                                        {2660}in(c, em2_3047: bitstring);
                                                        {2661}let m2_3048: bitstring = em2_3047 in
                                                        {2662}let (=OpenSecureChannelResponse,wNs_3049: bitstring,ST_3050: bitstring,TTL_3051: bitstring) = m2_3048 in
                                                        {2663}let Ns_3052: bitstring = dec(wNs_3049,skCli_2505) in
                                                        {2664}let Kcli_3053: bitstring = h((Nc_3044,Ns_3052)) in
                                                        {2665}out(c, senc(mCli(pkCli_2506,pkSess_3041),Kcli_3053))
                                            )
                                            else
                                                {2666}let pkSess_3054: bitstring = fail-any in
                                                {2667}out(c, GetEndpointRequest);
                                                {2668}in(c, (=GetEndpointResponse,=pkSess_3054,=None,SP_3055: bitstring,UP_3056: bitstring));
                                                {2669}new Nc_3057: bitstring;
                                                {2670}let wNc_3058: bitstring = enc(Nc_3057,pkSess_3054) in
                                                {2671}let m1_3059: bitstring = (OpenSecureChannelRequest,pkCli_2506,wNc_3058) in
                                                {2672}out(c, (pkCli_2506,m1_3059));
                                                {2673}in(c, em2_3060: bitstring);
                                                {2674}let m2_3061: bitstring = em2_3060 in
                                                {2675}let (=OpenSecureChannelResponse,wNs_3062: bitstring,ST_3063: bitstring,TTL_3064: bitstring) = m2_3061 in
                                                {2676}let Ns_3065: bitstring = dec(wNs_3062,skCli_2505) in
                                                {2677}let Kcli_3066: bitstring = h((Nc_3057,Ns_3065)) in
                                                {2678}out(c, senc(mCli(pkCli_2506,pkSess_3054),Kcli_3066))
                                    )
                                    else
                                        {2679}let pkSess_3067: bitstring = fail-any in
                                        {2680}out(c, GetEndpointRequest);
                                        {2681}in(c, (=GetEndpointResponse,=pkSess_3067,=None,SP_3068: bitstring,UP_3069: bitstring));
                                        {2682}new Nc_3070: bitstring;
                                        {2683}let wNc_3071: bitstring = enc(Nc_3070,pkSess_3067) in
                                        {2684}let m1_3072: bitstring = (OpenSecureChannelRequest,pkCli_2506,wNc_3071) in
                                        {2685}out(c, (pkCli_2506,m1_3072));
                                        {2686}in(c, em2_3073: bitstring);
                                        {2687}let m2_3074: bitstring = em2_3073 in
                                        {2688}let (=OpenSecureChannelResponse,wNs_3075: bitstring,ST_3076: bitstring,TTL_3077: bitstring) = m2_3074 in
                                        {2689}let Ns_3078: bitstring = dec(wNs_3075,skCli_2505) in
                                        {2690}let Kcli_3079: bitstring = h((Nc_3070,Ns_3078)) in
                                        {2691}out(c, senc(mCli(pkCli_2506,pkSess_3067),Kcli_3079))
                        )
                        else
                            {2692}let pkDisco_3080: bitstring = fail-any in
                            {2693}let v_3081: bool = (Sess = A) in
                            (
                                {2694}if v_3081 then
                                (
                                    {2695}let pkSess_3082: bitstring = pub(skA) in
                                    {2696}out(c, GetEndpointRequest);
                                    {2697}in(c, (=GetEndpointResponse,=pkSess_3082,=None,SP_3083: bitstring,UP_3084: bitstring));
                                    {2698}new Nc_3085: bitstring;
                                    {2699}let wNc_3086: bitstring = enc(Nc_3085,pkSess_3082) in
                                    {2700}let m1_3087: bitstring = (OpenSecureChannelRequest,pkCli_2506,wNc_3086) in
                                    {2701}out(c, (pkCli_2506,m1_3087));
                                    {2702}in(c, em2_3088: bitstring);
                                    {2703}let m2_3089: bitstring = em2_3088 in
                                    {2704}let (=OpenSecureChannelResponse,wNs_3090: bitstring,ST_3091: bitstring,TTL_3092: bitstring) = m2_3089 in
                                    {2705}let Ns_3093: bitstring = dec(wNs_3090,skCli_2505) in
                                    {2706}let Kcli_3094: bitstring = h((Nc_3085,Ns_3093)) in
                                    {2707}out(c, senc(mCli(pkCli_2506,pkSess_3082),Kcli_3094))
                                )
                                else
                                    {2708}let v_3095: bool = (Sess = B) in
                                    (
                                        {2709}if v_3095 then
                                        (
                                            {2710}let pkSess_3096: bitstring = pub(skB) in
                                            {2711}out(c, GetEndpointRequest);
                                            {2712}in(c, (=GetEndpointResponse,=pkSess_3096,=None,SP_3097: bitstring,UP_3098: bitstring));
                                            {2713}new Nc_3099: bitstring;
                                            {2714}let wNc_3100: bitstring = enc(Nc_3099,pkSess_3096) in
                                            {2715}let m1_3101: bitstring = (OpenSecureChannelRequest,pkCli_2506,wNc_3100) in
                                            {2716}out(c, (pkCli_2506,m1_3101));
                                            {2717}in(c, em2_3102: bitstring);
                                            {2718}let m2_3103: bitstring = em2_3102 in
                                            {2719}let (=OpenSecureChannelResponse,wNs_3104: bitstring,ST_3105: bitstring,TTL_3106: bitstring) = m2_3103 in
                                            {2720}let Ns_3107: bitstring = dec(wNs_3104,skCli_2505) in
                                            {2721}let Kcli_3108: bitstring = h((Nc_3099,Ns_3107)) in
                                            {2722}out(c, senc(mCli(pkCli_2506,pkSess_3096),Kcli_3108))
                                        )
                                        else
                                            {2723}let v_3109: bool = (Sess = C) in
                                            (
                                                {2724}if v_3109 then
                                                (
                                                    {2725}let pkSess_3110: bitstring = pub(skC) in
                                                    {2726}out(c, GetEndpointRequest);
                                                    {2727}in(c, (=GetEndpointResponse,=pkSess_3110,=None,SP_3111: bitstring,UP_3112: bitstring));
                                                    {2728}new Nc_3113: bitstring;
                                                    {2729}let wNc_3114: bitstring = enc(Nc_3113,pkSess_3110) in
                                                    {2730}let m1_3115: bitstring = (OpenSecureChannelRequest,pkCli_2506,wNc_3114) in
                                                    {2731}out(c, (pkCli_2506,m1_3115));
                                                    {2732}in(c, em2_3116: bitstring);
                                                    {2733}let m2_3117: bitstring = em2_3116 in
                                                    {2734}let (=OpenSecureChannelResponse,wNs_3118: bitstring,ST_3119: bitstring,TTL_3120: bitstring) = m2_3117 in
                                                    {2735}let Ns_3121: bitstring = dec(wNs_3118,skCli_2505) in
                                                    {2736}let Kcli_3122: bitstring = h((Nc_3113,Ns_3121)) in
                                                    {2737}out(c, senc(mCli(pkCli_2506,pkSess_3110),Kcli_3122))
                                                )
                                                else
                                                    {2738}let pkSess_3123: bitstring = pub(sk(Sess)) in
                                                    {2739}out(c, GetEndpointRequest);
                                                    {2740}in(c, (=GetEndpointResponse,=pkSess_3123,=None,SP_3124: bitstring,UP_3125: bitstring));
                                                    {2741}new Nc_3126: bitstring;
                                                    {2742}let wNc_3127: bitstring = enc(Nc_3126,pkSess_3123) in
                                                    {2743}let m1_3128: bitstring = (OpenSecureChannelRequest,pkCli_2506,wNc_3127) in
                                                    {2744}out(c, (pkCli_2506,m1_3128));
                                                    {2745}in(c, em2_3129: bitstring);
                                                    {2746}let m2_3130: bitstring = em2_3129 in
                                                    {2747}let (=OpenSecureChannelResponse,wNs_3131: bitstring,ST_3132: bitstring,TTL_3133: bitstring) = m2_3130 in
                                                    {2748}let Ns_3134: bitstring = dec(wNs_3131,skCli_2505) in
                                                    {2749}let Kcli_3135: bitstring = h((Nc_3126,Ns_3134)) in
                                                    {2750}out(c, senc(mCli(pkCli_2506,pkSess_3123),Kcli_3135))
                                            )
                                            else
                                                {2751}let pkSess_3136: bitstring = fail-any in
                                                {2752}out(c, GetEndpointRequest);
                                                {2753}in(c, (=GetEndpointResponse,=pkSess_3136,=None,SP_3137: bitstring,UP_3138: bitstring));
                                                {2754}new Nc_3139: bitstring;
                                                {2755}let wNc_3140: bitstring = enc(Nc_3139,pkSess_3136) in
                                                {2756}let m1_3141: bitstring = (OpenSecureChannelRequest,pkCli_2506,wNc_3140) in
                                                {2757}out(c, (pkCli_2506,m1_3141));
                                                {2758}in(c, em2_3142: bitstring);
                                                {2759}let m2_3143: bitstring = em2_3142 in
                                                {2760}let (=OpenSecureChannelResponse,wNs_3144: bitstring,ST_3145: bitstring,TTL_3146: bitstring) = m2_3143 in
                                                {2761}let Ns_3147: bitstring = dec(wNs_3144,skCli_2505) in
                                                {2762}let Kcli_3148: bitstring = h((Nc_3139,Ns_3147)) in
                                                {2763}out(c, senc(mCli(pkCli_2506,pkSess_3136),Kcli_3148))
                                    )
                                    else
                                        {2764}let pkSess_3149: bitstring = fail-any in
                                        {2765}out(c, GetEndpointRequest);
                                        {2766}in(c, (=GetEndpointResponse,=pkSess_3149,=None,SP_3150: bitstring,UP_3151: bitstring));
                                        {2767}new Nc_3152: bitstring;
                                        {2768}let wNc_3153: bitstring = enc(Nc_3152,pkSess_3149) in
                                        {2769}let m1_3154: bitstring = (OpenSecureChannelRequest,pkCli_2506,wNc_3153) in
                                        {2770}out(c, (pkCli_2506,m1_3154));
                                        {2771}in(c, em2_3155: bitstring);
                                        {2772}let m2_3156: bitstring = em2_3155 in
                                        {2773}let (=OpenSecureChannelResponse,wNs_3157: bitstring,ST_3158: bitstring,TTL_3159: bitstring) = m2_3156 in
                                        {2774}let Ns_3160: bitstring = dec(wNs_3157,skCli_2505) in
                                        {2775}let Kcli_3161: bitstring = h((Nc_3152,Ns_3160)) in
                                        {2776}out(c, senc(mCli(pkCli_2506,pkSess_3149),Kcli_3161))
                            )
                            else
                                {2777}let pkSess_3162: bitstring = fail-any in
                                {2778}out(c, GetEndpointRequest);
                                {2779}in(c, (=GetEndpointResponse,=pkSess_3162,=None,SP_3163: bitstring,UP_3164: bitstring));
                                {2780}new Nc_3165: bitstring;
                                {2781}let wNc_3166: bitstring = enc(Nc_3165,pkSess_3162) in
                                {2782}let m1_3167: bitstring = (OpenSecureChannelRequest,pkCli_2506,wNc_3166) in
                                {2783}out(c, (pkCli_2506,m1_3167));
                                {2784}in(c, em2_3168: bitstring);
                                {2785}let m2_3169: bitstring = em2_3168 in
                                {2786}let (=OpenSecureChannelResponse,wNs_3170: bitstring,ST_3171: bitstring,TTL_3172: bitstring) = m2_3169 in
                                {2787}let Ns_3173: bitstring = dec(wNs_3170,skCli_2505) in
                                {2788}let Kcli_3174: bitstring = h((Nc_3165,Ns_3173)) in
                                {2789}out(c, senc(mCli(pkCli_2506,pkSess_3162),Kcli_3174))
            )
            else
                {2790}let skCli_3175: bitstring = fail-any in
                {2791}let pkCli_3176: bitstring = pub(skCli_3175) in
                {2792}let v_3177: bool = (Disco = A) in
                (
                    {2793}if v_3177 then
                    (
                        {2794}let pkDisco_3178: bitstring = pub(skA) in
                        {2795}let v_3179: bool = (Sess = A) in
                        (
                            {2796}if v_3179 then
                            (
                                {2797}let pkSess_3180: bitstring = pub(skA) in
                                {2798}out(c, GetEndpointRequest);
                                {2799}in(c, (=GetEndpointResponse,=pkSess_3180,=None,SP_3181: bitstring,UP_3182: bitstring));
                                {2800}new Nc_3183: bitstring;
                                {2801}let wNc_3184: bitstring = enc(Nc_3183,pkSess_3180) in
                                {2802}let m1_3185: bitstring = (OpenSecureChannelRequest,pkCli_3176,wNc_3184) in
                                {2803}out(c, (pkCli_3176,m1_3185));
                                {2804}in(c, em2_3186: bitstring);
                                {2805}let m2_3187: bitstring = em2_3186 in
                                {2806}let (=OpenSecureChannelResponse,wNs_3188: bitstring,ST_3189: bitstring,TTL_3190: bitstring) = m2_3187 in
                                {2807}let Ns_3191: bitstring = dec(wNs_3188,skCli_3175) in
                                {2808}let Kcli_3192: bitstring = h((Nc_3183,Ns_3191)) in
                                {2809}out(c, senc(mCli(pkCli_3176,pkSess_3180),Kcli_3192))
                            )
                            else
                                {2810}let v_3193: bool = (Sess = B) in
                                (
                                    {2811}if v_3193 then
                                    (
                                        {2812}let pkSess_3194: bitstring = pub(skB) in
                                        {2813}out(c, GetEndpointRequest);
                                        {2814}in(c, (=GetEndpointResponse,=pkSess_3194,=None,SP_3195: bitstring,UP_3196: bitstring));
                                        {2815}new Nc_3197: bitstring;
                                        {2816}let wNc_3198: bitstring = enc(Nc_3197,pkSess_3194) in
                                        {2817}let m1_3199: bitstring = (OpenSecureChannelRequest,pkCli_3176,wNc_3198) in
                                        {2818}out(c, (pkCli_3176,m1_3199));
                                        {2819}in(c, em2_3200: bitstring);
                                        {2820}let m2_3201: bitstring = em2_3200 in
                                        {2821}let (=OpenSecureChannelResponse,wNs_3202: bitstring,ST_3203: bitstring,TTL_3204: bitstring) = m2_3201 in
                                        {2822}let Ns_3205: bitstring = dec(wNs_3202,skCli_3175) in
                                        {2823}let Kcli_3206: bitstring = h((Nc_3197,Ns_3205)) in
                                        {2824}out(c, senc(mCli(pkCli_3176,pkSess_3194),Kcli_3206))
                                    )
                                    else
                                        {2825}let v_3207: bool = (Sess = C) in
                                        (
                                            {2826}if v_3207 then
                                            (
                                                {2827}let pkSess_3208: bitstring = pub(skC) in
                                                {2828}out(c, GetEndpointRequest);
                                                {2829}in(c, (=GetEndpointResponse,=pkSess_3208,=None,SP_3209: bitstring,UP_3210: bitstring));
                                                {2830}new Nc_3211: bitstring;
                                                {2831}let wNc_3212: bitstring = enc(Nc_3211,pkSess_3208) in
                                                {2832}let m1_3213: bitstring = (OpenSecureChannelRequest,pkCli_3176,wNc_3212) in
                                                {2833}out(c, (pkCli_3176,m1_3213));
                                                {2834}in(c, em2_3214: bitstring);
                                                {2835}let m2_3215: bitstring = em2_3214 in
                                                {2836}let (=OpenSecureChannelResponse,wNs_3216: bitstring,ST_3217: bitstring,TTL_3218: bitstring) = m2_3215 in
                                                {2837}let Ns_3219: bitstring = dec(wNs_3216,skCli_3175) in
                                                {2838}let Kcli_3220: bitstring = h((Nc_3211,Ns_3219)) in
                                                {2839}out(c, senc(mCli(pkCli_3176,pkSess_3208),Kcli_3220))
                                            )
                                            else
                                                {2840}let pkSess_3221: bitstring = pub(sk(Sess)) in
                                                {2841}out(c, GetEndpointRequest);
                                                {2842}in(c, (=GetEndpointResponse,=pkSess_3221,=None,SP_3222: bitstring,UP_3223: bitstring));
                                                {2843}new Nc_3224: bitstring;
                                                {2844}let wNc_3225: bitstring = enc(Nc_3224,pkSess_3221) in
                                                {2845}let m1_3226: bitstring = (OpenSecureChannelRequest,pkCli_3176,wNc_3225) in
                                                {2846}out(c, (pkCli_3176,m1_3226));
                                                {2847}in(c, em2_3227: bitstring);
                                                {2848}let m2_3228: bitstring = em2_3227 in
                                                {2849}let (=OpenSecureChannelResponse,wNs_3229: bitstring,ST_3230: bitstring,TTL_3231: bitstring) = m2_3228 in
                                                {2850}let Ns_3232: bitstring = dec(wNs_3229,skCli_3175) in
                                                {2851}let Kcli_3233: bitstring = h((Nc_3224,Ns_3232)) in
                                                {2852}out(c, senc(mCli(pkCli_3176,pkSess_3221),Kcli_3233))
                                        )
                                        else
                                            {2853}let pkSess_3234: bitstring = fail-any in
                                            {2854}out(c, GetEndpointRequest);
                                            {2855}in(c, (=GetEndpointResponse,=pkSess_3234,=None,SP_3235: bitstring,UP_3236: bitstring));
                                            {2856}new Nc_3237: bitstring;
                                            {2857}let wNc_3238: bitstring = enc(Nc_3237,pkSess_3234) in
                                            {2858}let m1_3239: bitstring = (OpenSecureChannelRequest,pkCli_3176,wNc_3238) in
                                            {2859}out(c, (pkCli_3176,m1_3239));
                                            {2860}in(c, em2_3240: bitstring);
                                            {2861}let m2_3241: bitstring = em2_3240 in
                                            {2862}let (=OpenSecureChannelResponse,wNs_3242: bitstring,ST_3243: bitstring,TTL_3244: bitstring) = m2_3241 in
                                            {2863}let Ns_3245: bitstring = dec(wNs_3242,skCli_3175) in
                                            {2864}let Kcli_3246: bitstring = h((Nc_3237,Ns_3245)) in
                                            {2865}out(c, senc(mCli(pkCli_3176,pkSess_3234),Kcli_3246))
                                )
                                else
                                    {2866}let pkSess_3247: bitstring = fail-any in
                                    {2867}out(c, GetEndpointRequest);
                                    {2868}in(c, (=GetEndpointResponse,=pkSess_3247,=None,SP_3248: bitstring,UP_3249: bitstring));
                                    {2869}new Nc_3250: bitstring;
                                    {2870}let wNc_3251: bitstring = enc(Nc_3250,pkSess_3247) in
                                    {2871}let m1_3252: bitstring = (OpenSecureChannelRequest,pkCli_3176,wNc_3251) in
                                    {2872}out(c, (pkCli_3176,m1_3252));
                                    {2873}in(c, em2_3253: bitstring);
                                    {2874}let m2_3254: bitstring = em2_3253 in
                                    {2875}let (=OpenSecureChannelResponse,wNs_3255: bitstring,ST_3256: bitstring,TTL_3257: bitstring) = m2_3254 in
                                    {2876}let Ns_3258: bitstring = dec(wNs_3255,skCli_3175) in
                                    {2877}let Kcli_3259: bitstring = h((Nc_3250,Ns_3258)) in
                                    {2878}out(c, senc(mCli(pkCli_3176,pkSess_3247),Kcli_3259))
                        )
                        else
                            {2879}let pkSess_3260: bitstring = fail-any in
                            {2880}out(c, GetEndpointRequest);
                            {2881}in(c, (=GetEndpointResponse,=pkSess_3260,=None,SP_3261: bitstring,UP_3262: bitstring));
                            {2882}new Nc_3263: bitstring;
                            {2883}let wNc_3264: bitstring = enc(Nc_3263,pkSess_3260) in
                            {2884}let m1_3265: bitstring = (OpenSecureChannelRequest,pkCli_3176,wNc_3264) in
                            {2885}out(c, (pkCli_3176,m1_3265));
                            {2886}in(c, em2_3266: bitstring);
                            {2887}let m2_3267: bitstring = em2_3266 in
                            {2888}let (=OpenSecureChannelResponse,wNs_3268: bitstring,ST_3269: bitstring,TTL_3270: bitstring) = m2_3267 in
                            {2889}let Ns_3271: bitstring = dec(wNs_3268,skCli_3175) in
                            {2890}let Kcli_3272: bitstring = h((Nc_3263,Ns_3271)) in
                            {2891}out(c, senc(mCli(pkCli_3176,pkSess_3260),Kcli_3272))
                    )
                    else
                        {2892}let v_3273: bool = (Disco = B) in
                        (
                            {2893}if v_3273 then
                            (
                                {2894}let pkDisco_3274: bitstring = pub(skB) in
                                {2895}let v_3275: bool = (Sess = A) in
                                (
                                    {2896}if v_3275 then
                                    (
                                        {2897}let pkSess_3276: bitstring = pub(skA) in
                                        {2898}out(c, GetEndpointRequest);
                                        {2899}in(c, (=GetEndpointResponse,=pkSess_3276,=None,SP_3277: bitstring,UP_3278: bitstring));
                                        {2900}new Nc_3279: bitstring;
                                        {2901}let wNc_3280: bitstring = enc(Nc_3279,pkSess_3276) in
                                        {2902}let m1_3281: bitstring = (OpenSecureChannelRequest,pkCli_3176,wNc_3280) in
                                        {2903}out(c, (pkCli_3176,m1_3281));
                                        {2904}in(c, em2_3282: bitstring);
                                        {2905}let m2_3283: bitstring = em2_3282 in
                                        {2906}let (=OpenSecureChannelResponse,wNs_3284: bitstring,ST_3285: bitstring,TTL_3286: bitstring) = m2_3283 in
                                        {2907}let Ns_3287: bitstring = dec(wNs_3284,skCli_3175) in
                                        {2908}let Kcli_3288: bitstring = h((Nc_3279,Ns_3287)) in
                                        {2909}out(c, senc(mCli(pkCli_3176,pkSess_3276),Kcli_3288))
                                    )
                                    else
                                        {2910}let v_3289: bool = (Sess = B) in
                                        (
                                            {2911}if v_3289 then
                                            (
                                                {2912}let pkSess_3290: bitstring = pub(skB) in
                                                {2913}out(c, GetEndpointRequest);
                                                {2914}in(c, (=GetEndpointResponse,=pkSess_3290,=None,SP_3291: bitstring,UP_3292: bitstring));
                                                {2915}new Nc_3293: bitstring;
                                                {2916}let wNc_3294: bitstring = enc(Nc_3293,pkSess_3290) in
                                                {2917}let m1_3295: bitstring = (OpenSecureChannelRequest,pkCli_3176,wNc_3294) in
                                                {2918}out(c, (pkCli_3176,m1_3295));
                                                {2919}in(c, em2_3296: bitstring);
                                                {2920}let m2_3297: bitstring = em2_3296 in
                                                {2921}let (=OpenSecureChannelResponse,wNs_3298: bitstring,ST_3299: bitstring,TTL_3300: bitstring) = m2_3297 in
                                                {2922}let Ns_3301: bitstring = dec(wNs_3298,skCli_3175) in
                                                {2923}let Kcli_3302: bitstring = h((Nc_3293,Ns_3301)) in
                                                {2924}out(c, senc(mCli(pkCli_3176,pkSess_3290),Kcli_3302))
                                            )
                                            else
                                                {2925}let v_3303: bool = (Sess = C) in
                                                (
                                                    {2926}if v_3303 then
                                                    (
                                                        {2927}let pkSess_3304: bitstring = pub(skC) in
                                                        {2928}out(c, GetEndpointRequest);
                                                        {2929}in(c, (=GetEndpointResponse,=pkSess_3304,=None,SP_3305: bitstring,UP_3306: bitstring));
                                                        {2930}new Nc_3307: bitstring;
                                                        {2931}let wNc_3308: bitstring = enc(Nc_3307,pkSess_3304) in
                                                        {2932}let m1_3309: bitstring = (OpenSecureChannelRequest,pkCli_3176,wNc_3308) in
                                                        {2933}out(c, (pkCli_3176,m1_3309));
                                                        {2934}in(c, em2_3310: bitstring);
                                                        {2935}let m2_3311: bitstring = em2_3310 in
                                                        {2936}let (=OpenSecureChannelResponse,wNs_3312: bitstring,ST_3313: bitstring,TTL_3314: bitstring) = m2_3311 in
                                                        {2937}let Ns_3315: bitstring = dec(wNs_3312,skCli_3175) in
                                                        {2938}let Kcli_3316: bitstring = h((Nc_3307,Ns_3315)) in
                                                        {2939}out(c, senc(mCli(pkCli_3176,pkSess_3304),Kcli_3316))
                                                    )
                                                    else
                                                        {2940}let pkSess_3317: bitstring = pub(sk(Sess)) in
                                                        {2941}out(c, GetEndpointRequest);
                                                        {2942}in(c, (=GetEndpointResponse,=pkSess_3317,=None,SP_3318: bitstring,UP_3319: bitstring));
                                                        {2943}new Nc_3320: bitstring;
                                                        {2944}let wNc_3321: bitstring = enc(Nc_3320,pkSess_3317) in
                                                        {2945}let m1_3322: bitstring = (OpenSecureChannelRequest,pkCli_3176,wNc_3321) in
                                                        {2946}out(c, (pkCli_3176,m1_3322));
                                                        {2947}in(c, em2_3323: bitstring);
                                                        {2948}let m2_3324: bitstring = em2_3323 in
                                                        {2949}let (=OpenSecureChannelResponse,wNs_3325: bitstring,ST_3326: bitstring,TTL_3327: bitstring) = m2_3324 in
                                                        {2950}let Ns_3328: bitstring = dec(wNs_3325,skCli_3175) in
                                                        {2951}let Kcli_3329: bitstring = h((Nc_3320,Ns_3328)) in
                                                        {2952}out(c, senc(mCli(pkCli_3176,pkSess_3317),Kcli_3329))
                                                )
                                                else
                                                    {2953}let pkSess_3330: bitstring = fail-any in
                                                    {2954}out(c, GetEndpointRequest);
                                                    {2955}in(c, (=GetEndpointResponse,=pkSess_3330,=None,SP_3331: bitstring,UP_3332: bitstring));
                                                    {2956}new Nc_3333: bitstring;
                                                    {2957}let wNc_3334: bitstring = enc(Nc_3333,pkSess_3330) in
                                                    {2958}let m1_3335: bitstring = (OpenSecureChannelRequest,pkCli_3176,wNc_3334) in
                                                    {2959}out(c, (pkCli_3176,m1_3335));
                                                    {2960}in(c, em2_3336: bitstring);
                                                    {2961}let m2_3337: bitstring = em2_3336 in
                                                    {2962}let (=OpenSecureChannelResponse,wNs_3338: bitstring,ST_3339: bitstring,TTL_3340: bitstring) = m2_3337 in
                                                    {2963}let Ns_3341: bitstring = dec(wNs_3338,skCli_3175) in
                                                    {2964}let Kcli_3342: bitstring = h((Nc_3333,Ns_3341)) in
                                                    {2965}out(c, senc(mCli(pkCli_3176,pkSess_3330),Kcli_3342))
                                        )
                                        else
                                            {2966}let pkSess_3343: bitstring = fail-any in
                                            {2967}out(c, GetEndpointRequest);
                                            {2968}in(c, (=GetEndpointResponse,=pkSess_3343,=None,SP_3344: bitstring,UP_3345: bitstring));
                                            {2969}new Nc_3346: bitstring;
                                            {2970}let wNc_3347: bitstring = enc(Nc_3346,pkSess_3343) in
                                            {2971}let m1_3348: bitstring = (OpenSecureChannelRequest,pkCli_3176,wNc_3347) in
                                            {2972}out(c, (pkCli_3176,m1_3348));
                                            {2973}in(c, em2_3349: bitstring);
                                            {2974}let m2_3350: bitstring = em2_3349 in
                                            {2975}let (=OpenSecureChannelResponse,wNs_3351: bitstring,ST_3352: bitstring,TTL_3353: bitstring) = m2_3350 in
                                            {2976}let Ns_3354: bitstring = dec(wNs_3351,skCli_3175) in
                                            {2977}let Kcli_3355: bitstring = h((Nc_3346,Ns_3354)) in
                                            {2978}out(c, senc(mCli(pkCli_3176,pkSess_3343),Kcli_3355))
                                )
                                else
                                    {2979}let pkSess_3356: bitstring = fail-any in
                                    {2980}out(c, GetEndpointRequest);
                                    {2981}in(c, (=GetEndpointResponse,=pkSess_3356,=None,SP_3357: bitstring,UP_3358: bitstring));
                                    {2982}new Nc_3359: bitstring;
                                    {2983}let wNc_3360: bitstring = enc(Nc_3359,pkSess_3356) in
                                    {2984}let m1_3361: bitstring = (OpenSecureChannelRequest,pkCli_3176,wNc_3360) in
                                    {2985}out(c, (pkCli_3176,m1_3361));
                                    {2986}in(c, em2_3362: bitstring);
                                    {2987}let m2_3363: bitstring = em2_3362 in
                                    {2988}let (=OpenSecureChannelResponse,wNs_3364: bitstring,ST_3365: bitstring,TTL_3366: bitstring) = m2_3363 in
                                    {2989}let Ns_3367: bitstring = dec(wNs_3364,skCli_3175) in
                                    {2990}let Kcli_3368: bitstring = h((Nc_3359,Ns_3367)) in
                                    {2991}out(c, senc(mCli(pkCli_3176,pkSess_3356),Kcli_3368))
                            )
                            else
                                {2992}let v_3369: bool = (Disco = C) in
                                (
                                    {2993}if v_3369 then
                                    (
                                        {2994}let pkDisco_3370: bitstring = pub(skC) in
                                        {2995}let v_3371: bool = (Sess = A) in
                                        (
                                            {2996}if v_3371 then
                                            (
                                                {2997}let pkSess_3372: bitstring = pub(skA) in
                                                {2998}out(c, GetEndpointRequest);
                                                {2999}in(c, (=GetEndpointResponse,=pkSess_3372,=None,SP_3373: bitstring,UP_3374: bitstring));
                                                {3000}new Nc_3375: bitstring;
                                                {3001}let wNc_3376: bitstring = enc(Nc_3375,pkSess_3372) in
                                                {3002}let m1_3377: bitstring = (OpenSecureChannelRequest,pkCli_3176,wNc_3376) in
                                                {3003}out(c, (pkCli_3176,m1_3377));
                                                {3004}in(c, em2_3378: bitstring);
                                                {3005}let m2_3379: bitstring = em2_3378 in
                                                {3006}let (=OpenSecureChannelResponse,wNs_3380: bitstring,ST_3381: bitstring,TTL_3382: bitstring) = m2_3379 in
                                                {3007}let Ns_3383: bitstring = dec(wNs_3380,skCli_3175) in
                                                {3008}let Kcli_3384: bitstring = h((Nc_3375,Ns_3383)) in
                                                {3009}out(c, senc(mCli(pkCli_3176,pkSess_3372),Kcli_3384))
                                            )
                                            else
                                                {3010}let v_3385: bool = (Sess = B) in
                                                (
                                                    {3011}if v_3385 then
                                                    (
                                                        {3012}let pkSess_3386: bitstring = pub(skB) in
                                                        {3013}out(c, GetEndpointRequest);
                                                        {3014}in(c, (=GetEndpointResponse,=pkSess_3386,=None,SP_3387: bitstring,UP_3388: bitstring));
                                                        {3015}new Nc_3389: bitstring;
                                                        {3016}let wNc_3390: bitstring = enc(Nc_3389,pkSess_3386) in
                                                        {3017}let m1_3391: bitstring = (OpenSecureChannelRequest,pkCli_3176,wNc_3390) in
                                                        {3018}out(c, (pkCli_3176,m1_3391));
                                                        {3019}in(c, em2_3392: bitstring);
                                                        {3020}let m2_3393: bitstring = em2_3392 in
                                                        {3021}let (=OpenSecureChannelResponse,wNs_3394: bitstring,ST_3395: bitstring,TTL_3396: bitstring) = m2_3393 in
                                                        {3022}let Ns_3397: bitstring = dec(wNs_3394,skCli_3175) in
                                                        {3023}let Kcli_3398: bitstring = h((Nc_3389,Ns_3397)) in
                                                        {3024}out(c, senc(mCli(pkCli_3176,pkSess_3386),Kcli_3398))
                                                    )
                                                    else
                                                        {3025}let v_3399: bool = (Sess = C) in
                                                        (
                                                            {3026}if v_3399 then
                                                            (
                                                                {3027}let pkSess_3400: bitstring = pub(skC) in
                                                                {3028}out(c, GetEndpointRequest);
                                                                {3029}in(c, (=GetEndpointResponse,=pkSess_3400,=None,SP_3401: bitstring,UP_3402: bitstring));
                                                                {3030}new Nc_3403: bitstring;
                                                                {3031}let wNc_3404: bitstring = enc(Nc_3403,pkSess_3400) in
                                                                {3032}let m1_3405: bitstring = (OpenSecureChannelRequest,pkCli_3176,wNc_3404) in
                                                                {3033}out(c, (pkCli_3176,m1_3405));
                                                                {3034}in(c, em2_3406: bitstring);
                                                                {3035}let m2_3407: bitstring = em2_3406 in
                                                                {3036}let (=OpenSecureChannelResponse,wNs_3408: bitstring,ST_3409: bitstring,TTL_3410: bitstring) = m2_3407 in
                                                                {3037}let Ns_3411: bitstring = dec(wNs_3408,skCli_3175) in
                                                                {3038}let Kcli_3412: bitstring = h((Nc_3403,Ns_3411)) in
                                                                {3039}out(c, senc(mCli(pkCli_3176,pkSess_3400),Kcli_3412))
                                                            )
                                                            else
                                                                {3040}let pkSess_3413: bitstring = pub(sk(Sess)) in
                                                                {3041}out(c, GetEndpointRequest);
                                                                {3042}in(c, (=GetEndpointResponse,=pkSess_3413,=None,SP_3414: bitstring,UP_3415: bitstring));
                                                                {3043}new Nc_3416: bitstring;
                                                                {3044}let wNc_3417: bitstring = enc(Nc_3416,pkSess_3413) in
                                                                {3045}let m1_3418: bitstring = (OpenSecureChannelRequest,pkCli_3176,wNc_3417) in
                                                                {3046}out(c, (pkCli_3176,m1_3418));
                                                                {3047}in(c, em2_3419: bitstring);
                                                                {3048}let m2_3420: bitstring = em2_3419 in
                                                                {3049}let (=OpenSecureChannelResponse,wNs_3421: bitstring,ST_3422: bitstring,TTL_3423: bitstring) = m2_3420 in
                                                                {3050}let Ns_3424: bitstring = dec(wNs_3421,skCli_3175) in
                                                                {3051}let Kcli_3425: bitstring = h((Nc_3416,Ns_3424)) in
                                                                {3052}out(c, senc(mCli(pkCli_3176,pkSess_3413),Kcli_3425))
                                                        )
                                                        else
                                                            {3053}let pkSess_3426: bitstring = fail-any in
                                                            {3054}out(c, GetEndpointRequest);
                                                            {3055}in(c, (=GetEndpointResponse,=pkSess_3426,=None,SP_3427: bitstring,UP_3428: bitstring));
                                                            {3056}new Nc_3429: bitstring;
                                                            {3057}let wNc_3430: bitstring = enc(Nc_3429,pkSess_3426) in
                                                            {3058}let m1_3431: bitstring = (OpenSecureChannelRequest,pkCli_3176,wNc_3430) in
                                                            {3059}out(c, (pkCli_3176,m1_3431));
                                                            {3060}in(c, em2_3432: bitstring);
                                                            {3061}let m2_3433: bitstring = em2_3432 in
                                                            {3062}let (=OpenSecureChannelResponse,wNs_3434: bitstring,ST_3435: bitstring,TTL_3436: bitstring) = m2_3433 in
                                                            {3063}let Ns_3437: bitstring = dec(wNs_3434,skCli_3175) in
                                                            {3064}let Kcli_3438: bitstring = h((Nc_3429,Ns_3437)) in
                                                            {3065}out(c, senc(mCli(pkCli_3176,pkSess_3426),Kcli_3438))
                                                )
                                                else
                                                    {3066}let pkSess_3439: bitstring = fail-any in
                                                    {3067}out(c, GetEndpointRequest);
                                                    {3068}in(c, (=GetEndpointResponse,=pkSess_3439,=None,SP_3440: bitstring,UP_3441: bitstring));
                                                    {3069}new Nc_3442: bitstring;
                                                    {3070}let wNc_3443: bitstring = enc(Nc_3442,pkSess_3439) in
                                                    {3071}let m1_3444: bitstring = (OpenSecureChannelRequest,pkCli_3176,wNc_3443) in
                                                    {3072}out(c, (pkCli_3176,m1_3444));
                                                    {3073}in(c, em2_3445: bitstring);
                                                    {3074}let m2_3446: bitstring = em2_3445 in
                                                    {3075}let (=OpenSecureChannelResponse,wNs_3447: bitstring,ST_3448: bitstring,TTL_3449: bitstring) = m2_3446 in
                                                    {3076}let Ns_3450: bitstring = dec(wNs_3447,skCli_3175) in
                                                    {3077}let Kcli_3451: bitstring = h((Nc_3442,Ns_3450)) in
                                                    {3078}out(c, senc(mCli(pkCli_3176,pkSess_3439),Kcli_3451))
                                        )
                                        else
                                            {3079}let pkSess_3452: bitstring = fail-any in
                                            {3080}out(c, GetEndpointRequest);
                                            {3081}in(c, (=GetEndpointResponse,=pkSess_3452,=None,SP_3453: bitstring,UP_3454: bitstring));
                                            {3082}new Nc_3455: bitstring;
                                            {3083}let wNc_3456: bitstring = enc(Nc_3455,pkSess_3452) in
                                            {3084}let m1_3457: bitstring = (OpenSecureChannelRequest,pkCli_3176,wNc_3456) in
                                            {3085}out(c, (pkCli_3176,m1_3457));
                                            {3086}in(c, em2_3458: bitstring);
                                            {3087}let m2_3459: bitstring = em2_3458 in
                                            {3088}let (=OpenSecureChannelResponse,wNs_3460: bitstring,ST_3461: bitstring,TTL_3462: bitstring) = m2_3459 in
                                            {3089}let Ns_3463: bitstring = dec(wNs_3460,skCli_3175) in
                                            {3090}let Kcli_3464: bitstring = h((Nc_3455,Ns_3463)) in
                                            {3091}out(c, senc(mCli(pkCli_3176,pkSess_3452),Kcli_3464))
                                    )
                                    else
                                        {3092}let pkDisco_3465: bitstring = pub(sk(Disco)) in
                                        {3093}let v_3466: bool = (Sess = A) in
                                        (
                                            {3094}if v_3466 then
                                            (
                                                {3095}let pkSess_3467: bitstring = pub(skA) in
                                                {3096}out(c, GetEndpointRequest);
                                                {3097}in(c, (=GetEndpointResponse,=pkSess_3467,=None,SP_3468: bitstring,UP_3469: bitstring));
                                                {3098}new Nc_3470: bitstring;
                                                {3099}let wNc_3471: bitstring = enc(Nc_3470,pkSess_3467) in
                                                {3100}let m1_3472: bitstring = (OpenSecureChannelRequest,pkCli_3176,wNc_3471) in
                                                {3101}out(c, (pkCli_3176,m1_3472));
                                                {3102}in(c, em2_3473: bitstring);
                                                {3103}let m2_3474: bitstring = em2_3473 in
                                                {3104}let (=OpenSecureChannelResponse,wNs_3475: bitstring,ST_3476: bitstring,TTL_3477: bitstring) = m2_3474 in
                                                {3105}let Ns_3478: bitstring = dec(wNs_3475,skCli_3175) in
                                                {3106}let Kcli_3479: bitstring = h((Nc_3470,Ns_3478)) in
                                                {3107}out(c, senc(mCli(pkCli_3176,pkSess_3467),Kcli_3479))
                                            )
                                            else
                                                {3108}let v_3480: bool = (Sess = B) in
                                                (
                                                    {3109}if v_3480 then
                                                    (
                                                        {3110}let pkSess_3481: bitstring = pub(skB) in
                                                        {3111}out(c, GetEndpointRequest);
                                                        {3112}in(c, (=GetEndpointResponse,=pkSess_3481,=None,SP_3482: bitstring,UP_3483: bitstring));
                                                        {3113}new Nc_3484: bitstring;
                                                        {3114}let wNc_3485: bitstring = enc(Nc_3484,pkSess_3481) in
                                                        {3115}let m1_3486: bitstring = (OpenSecureChannelRequest,pkCli_3176,wNc_3485) in
                                                        {3116}out(c, (pkCli_3176,m1_3486));
                                                        {3117}in(c, em2_3487: bitstring);
                                                        {3118}let m2_3488: bitstring = em2_3487 in
                                                        {3119}let (=OpenSecureChannelResponse,wNs_3489: bitstring,ST_3490: bitstring,TTL_3491: bitstring) = m2_3488 in
                                                        {3120}let Ns_3492: bitstring = dec(wNs_3489,skCli_3175) in
                                                        {3121}let Kcli_3493: bitstring = h((Nc_3484,Ns_3492)) in
                                                        {3122}out(c, senc(mCli(pkCli_3176,pkSess_3481),Kcli_3493))
                                                    )
                                                    else
                                                        {3123}let v_3494: bool = (Sess = C) in
                                                        (
                                                            {3124}if v_3494 then
                                                            (
                                                                {3125}let pkSess_3495: bitstring = pub(skC) in
                                                                {3126}out(c, GetEndpointRequest);
                                                                {3127}in(c, (=GetEndpointResponse,=pkSess_3495,=None,SP_3496: bitstring,UP_3497: bitstring));
                                                                {3128}new Nc_3498: bitstring;
                                                                {3129}let wNc_3499: bitstring = enc(Nc_3498,pkSess_3495) in
                                                                {3130}let m1_3500: bitstring = (OpenSecureChannelRequest,pkCli_3176,wNc_3499) in
                                                                {3131}out(c, (pkCli_3176,m1_3500));
                                                                {3132}in(c, em2_3501: bitstring);
                                                                {3133}let m2_3502: bitstring = em2_3501 in
                                                                {3134}let (=OpenSecureChannelResponse,wNs_3503: bitstring,ST_3504: bitstring,TTL_3505: bitstring) = m2_3502 in
                                                                {3135}let Ns_3506: bitstring = dec(wNs_3503,skCli_3175) in
                                                                {3136}let Kcli_3507: bitstring = h((Nc_3498,Ns_3506)) in
                                                                {3137}out(c, senc(mCli(pkCli_3176,pkSess_3495),Kcli_3507))
                                                            )
                                                            else
                                                                {3138}let pkSess_3508: bitstring = pub(sk(Sess)) in
                                                                {3139}out(c, GetEndpointRequest);
                                                                {3140}in(c, (=GetEndpointResponse,=pkSess_3508,=None,SP_3509: bitstring,UP_3510: bitstring));
                                                                {3141}new Nc_3511: bitstring;
                                                                {3142}let wNc_3512: bitstring = enc(Nc_3511,pkSess_3508) in
                                                                {3143}let m1_3513: bitstring = (OpenSecureChannelRequest,pkCli_3176,wNc_3512) in
                                                                {3144}out(c, (pkCli_3176,m1_3513));
                                                                {3145}in(c, em2_3514: bitstring);
                                                                {3146}let m2_3515: bitstring = em2_3514 in
                                                                {3147}let (=OpenSecureChannelResponse,wNs_3516: bitstring,ST_3517: bitstring,TTL_3518: bitstring) = m2_3515 in
                                                                {3148}let Ns_3519: bitstring = dec(wNs_3516,skCli_3175) in
                                                                {3149}let Kcli_3520: bitstring = h((Nc_3511,Ns_3519)) in
                                                                {3150}out(c, senc(mCli(pkCli_3176,pkSess_3508),Kcli_3520))
                                                        )
                                                        else
                                                            {3151}let pkSess_3521: bitstring = fail-any in
                                                            {3152}out(c, GetEndpointRequest);
                                                            {3153}in(c, (=GetEndpointResponse,=pkSess_3521,=None,SP_3522: bitstring,UP_3523: bitstring));
                                                            {3154}new Nc_3524: bitstring;
                                                            {3155}let wNc_3525: bitstring = enc(Nc_3524,pkSess_3521) in
                                                            {3156}let m1_3526: bitstring = (OpenSecureChannelRequest,pkCli_3176,wNc_3525) in
                                                            {3157}out(c, (pkCli_3176,m1_3526));
                                                            {3158}in(c, em2_3527: bitstring);
                                                            {3159}let m2_3528: bitstring = em2_3527 in
                                                            {3160}let (=OpenSecureChannelResponse,wNs_3529: bitstring,ST_3530: bitstring,TTL_3531: bitstring) = m2_3528 in
                                                            {3161}let Ns_3532: bitstring = dec(wNs_3529,skCli_3175) in
                                                            {3162}let Kcli_3533: bitstring = h((Nc_3524,Ns_3532)) in
                                                            {3163}out(c, senc(mCli(pkCli_3176,pkSess_3521),Kcli_3533))
                                                )
                                                else
                                                    {3164}let pkSess_3534: bitstring = fail-any in
                                                    {3165}out(c, GetEndpointRequest);
                                                    {3166}in(c, (=GetEndpointResponse,=pkSess_3534,=None,SP_3535: bitstring,UP_3536: bitstring));
                                                    {3167}new Nc_3537: bitstring;
                                                    {3168}let wNc_3538: bitstring = enc(Nc_3537,pkSess_3534) in
                                                    {3169}let m1_3539: bitstring = (OpenSecureChannelRequest,pkCli_3176,wNc_3538) in
                                                    {3170}out(c, (pkCli_3176,m1_3539));
                                                    {3171}in(c, em2_3540: bitstring);
                                                    {3172}let m2_3541: bitstring = em2_3540 in
                                                    {3173}let (=OpenSecureChannelResponse,wNs_3542: bitstring,ST_3543: bitstring,TTL_3544: bitstring) = m2_3541 in
                                                    {3174}let Ns_3545: bitstring = dec(wNs_3542,skCli_3175) in
                                                    {3175}let Kcli_3546: bitstring = h((Nc_3537,Ns_3545)) in
                                                    {3176}out(c, senc(mCli(pkCli_3176,pkSess_3534),Kcli_3546))
                                        )
                                        else
                                            {3177}let pkSess_3547: bitstring = fail-any in
                                            {3178}out(c, GetEndpointRequest);
                                            {3179}in(c, (=GetEndpointResponse,=pkSess_3547,=None,SP_3548: bitstring,UP_3549: bitstring));
                                            {3180}new Nc_3550: bitstring;
                                            {3181}let wNc_3551: bitstring = enc(Nc_3550,pkSess_3547) in
                                            {3182}let m1_3552: bitstring = (OpenSecureChannelRequest,pkCli_3176,wNc_3551) in
                                            {3183}out(c, (pkCli_3176,m1_3552));
                                            {3184}in(c, em2_3553: bitstring);
                                            {3185}let m2_3554: bitstring = em2_3553 in
                                            {3186}let (=OpenSecureChannelResponse,wNs_3555: bitstring,ST_3556: bitstring,TTL_3557: bitstring) = m2_3554 in
                                            {3187}let Ns_3558: bitstring = dec(wNs_3555,skCli_3175) in
                                            {3188}let Kcli_3559: bitstring = h((Nc_3550,Ns_3558)) in
                                            {3189}out(c, senc(mCli(pkCli_3176,pkSess_3547),Kcli_3559))
                                )
                                else
                                    {3190}let pkDisco_3560: bitstring = fail-any in
                                    {3191}let v_3561: bool = (Sess = A) in
                                    (
                                        {3192}if v_3561 then
                                        (
                                            {3193}let pkSess_3562: bitstring = pub(skA) in
                                            {3194}out(c, GetEndpointRequest);
                                            {3195}in(c, (=GetEndpointResponse,=pkSess_3562,=None,SP_3563: bitstring,UP_3564: bitstring));
                                            {3196}new Nc_3565: bitstring;
                                            {3197}let wNc_3566: bitstring = enc(Nc_3565,pkSess_3562) in
                                            {3198}let m1_3567: bitstring = (OpenSecureChannelRequest,pkCli_3176,wNc_3566) in
                                            {3199}out(c, (pkCli_3176,m1_3567));
                                            {3200}in(c, em2_3568: bitstring);
                                            {3201}let m2_3569: bitstring = em2_3568 in
                                            {3202}let (=OpenSecureChannelResponse,wNs_3570: bitstring,ST_3571: bitstring,TTL_3572: bitstring) = m2_3569 in
                                            {3203}let Ns_3573: bitstring = dec(wNs_3570,skCli_3175) in
                                            {3204}let Kcli_3574: bitstring = h((Nc_3565,Ns_3573)) in
                                            {3205}out(c, senc(mCli(pkCli_3176,pkSess_3562),Kcli_3574))
                                        )
                                        else
                                            {3206}let v_3575: bool = (Sess = B) in
                                            (
                                                {3207}if v_3575 then
                                                (
                                                    {3208}let pkSess_3576: bitstring = pub(skB) in
                                                    {3209}out(c, GetEndpointRequest);
                                                    {3210}in(c, (=GetEndpointResponse,=pkSess_3576,=None,SP_3577: bitstring,UP_3578: bitstring));
                                                    {3211}new Nc_3579: bitstring;
                                                    {3212}let wNc_3580: bitstring = enc(Nc_3579,pkSess_3576) in
                                                    {3213}let m1_3581: bitstring = (OpenSecureChannelRequest,pkCli_3176,wNc_3580) in
                                                    {3214}out(c, (pkCli_3176,m1_3581));
                                                    {3215}in(c, em2_3582: bitstring);
                                                    {3216}let m2_3583: bitstring = em2_3582 in
                                                    {3217}let (=OpenSecureChannelResponse,wNs_3584: bitstring,ST_3585: bitstring,TTL_3586: bitstring) = m2_3583 in
                                                    {3218}let Ns_3587: bitstring = dec(wNs_3584,skCli_3175) in
                                                    {3219}let Kcli_3588: bitstring = h((Nc_3579,Ns_3587)) in
                                                    {3220}out(c, senc(mCli(pkCli_3176,pkSess_3576),Kcli_3588))
                                                )
                                                else
                                                    {3221}let v_3589: bool = (Sess = C) in
                                                    (
                                                        {3222}if v_3589 then
                                                        (
                                                            {3223}let pkSess_3590: bitstring = pub(skC) in
                                                            {3224}out(c, GetEndpointRequest);
                                                            {3225}in(c, (=GetEndpointResponse,=pkSess_3590,=None,SP_3591: bitstring,UP_3592: bitstring));
                                                            {3226}new Nc_3593: bitstring;
                                                            {3227}let wNc_3594: bitstring = enc(Nc_3593,pkSess_3590) in
                                                            {3228}let m1_3595: bitstring = (OpenSecureChannelRequest,pkCli_3176,wNc_3594) in
                                                            {3229}out(c, (pkCli_3176,m1_3595));
                                                            {3230}in(c, em2_3596: bitstring);
                                                            {3231}let m2_3597: bitstring = em2_3596 in
                                                            {3232}let (=OpenSecureChannelResponse,wNs_3598: bitstring,ST_3599: bitstring,TTL_3600: bitstring) = m2_3597 in
                                                            {3233}let Ns_3601: bitstring = dec(wNs_3598,skCli_3175) in
                                                            {3234}let Kcli_3602: bitstring = h((Nc_3593,Ns_3601)) in
                                                            {3235}out(c, senc(mCli(pkCli_3176,pkSess_3590),Kcli_3602))
                                                        )
                                                        else
                                                            {3236}let pkSess_3603: bitstring = pub(sk(Sess)) in
                                                            {3237}out(c, GetEndpointRequest);
                                                            {3238}in(c, (=GetEndpointResponse,=pkSess_3603,=None,SP_3604: bitstring,UP_3605: bitstring));
                                                            {3239}new Nc_3606: bitstring;
                                                            {3240}let wNc_3607: bitstring = enc(Nc_3606,pkSess_3603) in
                                                            {3241}let m1_3608: bitstring = (OpenSecureChannelRequest,pkCli_3176,wNc_3607) in
                                                            {3242}out(c, (pkCli_3176,m1_3608));
                                                            {3243}in(c, em2_3609: bitstring);
                                                            {3244}let m2_3610: bitstring = em2_3609 in
                                                            {3245}let (=OpenSecureChannelResponse,wNs_3611: bitstring,ST_3612: bitstring,TTL_3613: bitstring) = m2_3610 in
                                                            {3246}let Ns_3614: bitstring = dec(wNs_3611,skCli_3175) in
                                                            {3247}let Kcli_3615: bitstring = h((Nc_3606,Ns_3614)) in
                                                            {3248}out(c, senc(mCli(pkCli_3176,pkSess_3603),Kcli_3615))
                                                    )
                                                    else
                                                        {3249}let pkSess_3616: bitstring = fail-any in
                                                        {3250}out(c, GetEndpointRequest);
                                                        {3251}in(c, (=GetEndpointResponse,=pkSess_3616,=None,SP_3617: bitstring,UP_3618: bitstring));
                                                        {3252}new Nc_3619: bitstring;
                                                        {3253}let wNc_3620: bitstring = enc(Nc_3619,pkSess_3616) in
                                                        {3254}let m1_3621: bitstring = (OpenSecureChannelRequest,pkCli_3176,wNc_3620) in
                                                        {3255}out(c, (pkCli_3176,m1_3621));
                                                        {3256}in(c, em2_3622: bitstring);
                                                        {3257}let m2_3623: bitstring = em2_3622 in
                                                        {3258}let (=OpenSecureChannelResponse,wNs_3624: bitstring,ST_3625: bitstring,TTL_3626: bitstring) = m2_3623 in
                                                        {3259}let Ns_3627: bitstring = dec(wNs_3624,skCli_3175) in
                                                        {3260}let Kcli_3628: bitstring = h((Nc_3619,Ns_3627)) in
                                                        {3261}out(c, senc(mCli(pkCli_3176,pkSess_3616),Kcli_3628))
                                            )
                                            else
                                                {3262}let pkSess_3629: bitstring = fail-any in
                                                {3263}out(c, GetEndpointRequest);
                                                {3264}in(c, (=GetEndpointResponse,=pkSess_3629,=None,SP_3630: bitstring,UP_3631: bitstring));
                                                {3265}new Nc_3632: bitstring;
                                                {3266}let wNc_3633: bitstring = enc(Nc_3632,pkSess_3629) in
                                                {3267}let m1_3634: bitstring = (OpenSecureChannelRequest,pkCli_3176,wNc_3633) in
                                                {3268}out(c, (pkCli_3176,m1_3634));
                                                {3269}in(c, em2_3635: bitstring);
                                                {3270}let m2_3636: bitstring = em2_3635 in
                                                {3271}let (=OpenSecureChannelResponse,wNs_3637: bitstring,ST_3638: bitstring,TTL_3639: bitstring) = m2_3636 in
                                                {3272}let Ns_3640: bitstring = dec(wNs_3637,skCli_3175) in
                                                {3273}let Kcli_3641: bitstring = h((Nc_3632,Ns_3640)) in
                                                {3274}out(c, senc(mCli(pkCli_3176,pkSess_3629),Kcli_3641))
                                    )
                                    else
                                        {3275}let pkSess_3642: bitstring = fail-any in
                                        {3276}out(c, GetEndpointRequest);
                                        {3277}in(c, (=GetEndpointResponse,=pkSess_3642,=None,SP_3643: bitstring,UP_3644: bitstring));
                                        {3278}new Nc_3645: bitstring;
                                        {3279}let wNc_3646: bitstring = enc(Nc_3645,pkSess_3642) in
                                        {3280}let m1_3647: bitstring = (OpenSecureChannelRequest,pkCli_3176,wNc_3646) in
                                        {3281}out(c, (pkCli_3176,m1_3647));
                                        {3282}in(c, em2_3648: bitstring);
                                        {3283}let m2_3649: bitstring = em2_3648 in
                                        {3284}let (=OpenSecureChannelResponse,wNs_3650: bitstring,ST_3651: bitstring,TTL_3652: bitstring) = m2_3649 in
                                        {3285}let Ns_3653: bitstring = dec(wNs_3650,skCli_3175) in
                                        {3286}let Kcli_3654: bitstring = h((Nc_3645,Ns_3653)) in
                                        {3287}out(c, senc(mCli(pkCli_3176,pkSess_3642),Kcli_3654))
                        )
                        else
                            {3288}let pkDisco_3655: bitstring = fail-any in
                            {3289}let v_3656: bool = (Sess = A) in
                            (
                                {3290}if v_3656 then
                                (
                                    {3291}let pkSess_3657: bitstring = pub(skA) in
                                    {3292}out(c, GetEndpointRequest);
                                    {3293}in(c, (=GetEndpointResponse,=pkSess_3657,=None,SP_3658: bitstring,UP_3659: bitstring));
                                    {3294}new Nc_3660: bitstring;
                                    {3295}let wNc_3661: bitstring = enc(Nc_3660,pkSess_3657) in
                                    {3296}let m1_3662: bitstring = (OpenSecureChannelRequest,pkCli_3176,wNc_3661) in
                                    {3297}out(c, (pkCli_3176,m1_3662));
                                    {3298}in(c, em2_3663: bitstring);
                                    {3299}let m2_3664: bitstring = em2_3663 in
                                    {3300}let (=OpenSecureChannelResponse,wNs_3665: bitstring,ST_3666: bitstring,TTL_3667: bitstring) = m2_3664 in
                                    {3301}let Ns_3668: bitstring = dec(wNs_3665,skCli_3175) in
                                    {3302}let Kcli_3669: bitstring = h((Nc_3660,Ns_3668)) in
                                    {3303}out(c, senc(mCli(pkCli_3176,pkSess_3657),Kcli_3669))
                                )
                                else
                                    {3304}let v_3670: bool = (Sess = B) in
                                    (
                                        {3305}if v_3670 then
                                        (
                                            {3306}let pkSess_3671: bitstring = pub(skB) in
                                            {3307}out(c, GetEndpointRequest);
                                            {3308}in(c, (=GetEndpointResponse,=pkSess_3671,=None,SP_3672: bitstring,UP_3673: bitstring));
                                            {3309}new Nc_3674: bitstring;
                                            {3310}let wNc_3675: bitstring = enc(Nc_3674,pkSess_3671) in
                                            {3311}let m1_3676: bitstring = (OpenSecureChannelRequest,pkCli_3176,wNc_3675) in
                                            {3312}out(c, (pkCli_3176,m1_3676));
                                            {3313}in(c, em2_3677: bitstring);
                                            {3314}let m2_3678: bitstring = em2_3677 in
                                            {3315}let (=OpenSecureChannelResponse,wNs_3679: bitstring,ST_3680: bitstring,TTL_3681: bitstring) = m2_3678 in
                                            {3316}let Ns_3682: bitstring = dec(wNs_3679,skCli_3175) in
                                            {3317}let Kcli_3683: bitstring = h((Nc_3674,Ns_3682)) in
                                            {3318}out(c, senc(mCli(pkCli_3176,pkSess_3671),Kcli_3683))
                                        )
                                        else
                                            {3319}let v_3684: bool = (Sess = C) in
                                            (
                                                {3320}if v_3684 then
                                                (
                                                    {3321}let pkSess_3685: bitstring = pub(skC) in
                                                    {3322}out(c, GetEndpointRequest);
                                                    {3323}in(c, (=GetEndpointResponse,=pkSess_3685,=None,SP_3686: bitstring,UP_3687: bitstring));
                                                    {3324}new Nc_3688: bitstring;
                                                    {3325}let wNc_3689: bitstring = enc(Nc_3688,pkSess_3685) in
                                                    {3326}let m1_3690: bitstring = (OpenSecureChannelRequest,pkCli_3176,wNc_3689) in
                                                    {3327}out(c, (pkCli_3176,m1_3690));
                                                    {3328}in(c, em2_3691: bitstring);
                                                    {3329}let m2_3692: bitstring = em2_3691 in
                                                    {3330}let (=OpenSecureChannelResponse,wNs_3693: bitstring,ST_3694: bitstring,TTL_3695: bitstring) = m2_3692 in
                                                    {3331}let Ns_3696: bitstring = dec(wNs_3693,skCli_3175) in
                                                    {3332}let Kcli_3697: bitstring = h((Nc_3688,Ns_3696)) in
                                                    {3333}out(c, senc(mCli(pkCli_3176,pkSess_3685),Kcli_3697))
                                                )
                                                else
                                                    {3334}let pkSess_3698: bitstring = pub(sk(Sess)) in
                                                    {3335}out(c, GetEndpointRequest);
                                                    {3336}in(c, (=GetEndpointResponse,=pkSess_3698,=None,SP_3699: bitstring,UP_3700: bitstring));
                                                    {3337}new Nc_3701: bitstring;
                                                    {3338}let wNc_3702: bitstring = enc(Nc_3701,pkSess_3698) in
                                                    {3339}let m1_3703: bitstring = (OpenSecureChannelRequest,pkCli_3176,wNc_3702) in
                                                    {3340}out(c, (pkCli_3176,m1_3703));
                                                    {3341}in(c, em2_3704: bitstring);
                                                    {3342}let m2_3705: bitstring = em2_3704 in
                                                    {3343}let (=OpenSecureChannelResponse,wNs_3706: bitstring,ST_3707: bitstring,TTL_3708: bitstring) = m2_3705 in
                                                    {3344}let Ns_3709: bitstring = dec(wNs_3706,skCli_3175) in
                                                    {3345}let Kcli_3710: bitstring = h((Nc_3701,Ns_3709)) in
                                                    {3346}out(c, senc(mCli(pkCli_3176,pkSess_3698),Kcli_3710))
                                            )
                                            else
                                                {3347}let pkSess_3711: bitstring = fail-any in
                                                {3348}out(c, GetEndpointRequest);
                                                {3349}in(c, (=GetEndpointResponse,=pkSess_3711,=None,SP_3712: bitstring,UP_3713: bitstring));
                                                {3350}new Nc_3714: bitstring;
                                                {3351}let wNc_3715: bitstring = enc(Nc_3714,pkSess_3711) in
                                                {3352}let m1_3716: bitstring = (OpenSecureChannelRequest,pkCli_3176,wNc_3715) in
                                                {3353}out(c, (pkCli_3176,m1_3716));
                                                {3354}in(c, em2_3717: bitstring);
                                                {3355}let m2_3718: bitstring = em2_3717 in
                                                {3356}let (=OpenSecureChannelResponse,wNs_3719: bitstring,ST_3720: bitstring,TTL_3721: bitstring) = m2_3718 in
                                                {3357}let Ns_3722: bitstring = dec(wNs_3719,skCli_3175) in
                                                {3358}let Kcli_3723: bitstring = h((Nc_3714,Ns_3722)) in
                                                {3359}out(c, senc(mCli(pkCli_3176,pkSess_3711),Kcli_3723))
                                    )
                                    else
                                        {3360}let pkSess_3724: bitstring = fail-any in
                                        {3361}out(c, GetEndpointRequest);
                                        {3362}in(c, (=GetEndpointResponse,=pkSess_3724,=None,SP_3725: bitstring,UP_3726: bitstring));
                                        {3363}new Nc_3727: bitstring;
                                        {3364}let wNc_3728: bitstring = enc(Nc_3727,pkSess_3724) in
                                        {3365}let m1_3729: bitstring = (OpenSecureChannelRequest,pkCli_3176,wNc_3728) in
                                        {3366}out(c, (pkCli_3176,m1_3729));
                                        {3367}in(c, em2_3730: bitstring);
                                        {3368}let m2_3731: bitstring = em2_3730 in
                                        {3369}let (=OpenSecureChannelResponse,wNs_3732: bitstring,ST_3733: bitstring,TTL_3734: bitstring) = m2_3731 in
                                        {3370}let Ns_3735: bitstring = dec(wNs_3732,skCli_3175) in
                                        {3371}let Kcli_3736: bitstring = h((Nc_3727,Ns_3735)) in
                                        {3372}out(c, senc(mCli(pkCli_3176,pkSess_3724),Kcli_3736))
                            )
                            else
                                {3373}let pkSess_3737: bitstring = fail-any in
                                {3374}out(c, GetEndpointRequest);
                                {3375}in(c, (=GetEndpointResponse,=pkSess_3737,=None,SP_3738: bitstring,UP_3739: bitstring));
                                {3376}new Nc_3740: bitstring;
                                {3377}let wNc_3741: bitstring = enc(Nc_3740,pkSess_3737) in
                                {3378}let m1_3742: bitstring = (OpenSecureChannelRequest,pkCli_3176,wNc_3741) in
                                {3379}out(c, (pkCli_3176,m1_3742));
                                {3380}in(c, em2_3743: bitstring);
                                {3381}let m2_3744: bitstring = em2_3743 in
                                {3382}let (=OpenSecureChannelResponse,wNs_3745: bitstring,ST_3746: bitstring,TTL_3747: bitstring) = m2_3744 in
                                {3383}let Ns_3748: bitstring = dec(wNs_3745,skCli_3175) in
                                {3384}let Kcli_3749: bitstring = h((Nc_3740,Ns_3748)) in
                                {3385}out(c, senc(mCli(pkCli_3176,pkSess_3737),Kcli_3749))
                )
                else
                    {3386}let pkDisco_3750: bitstring = fail-any in
                    {3387}let v_3751: bool = (Sess = A) in
                    (
                        {3388}if v_3751 then
                        (
                            {3389}let pkSess_3752: bitstring = pub(skA) in
                            {3390}out(c, GetEndpointRequest);
                            {3391}in(c, (=GetEndpointResponse,=pkSess_3752,=None,SP_3753: bitstring,UP_3754: bitstring));
                            {3392}new Nc_3755: bitstring;
                            {3393}let wNc_3756: bitstring = enc(Nc_3755,pkSess_3752) in
                            {3394}let m1_3757: bitstring = (OpenSecureChannelRequest,pkCli_3176,wNc_3756) in
                            {3395}out(c, (pkCli_3176,m1_3757));
                            {3396}in(c, em2_3758: bitstring);
                            {3397}let m2_3759: bitstring = em2_3758 in
                            {3398}let (=OpenSecureChannelResponse,wNs_3760: bitstring,ST_3761: bitstring,TTL_3762: bitstring) = m2_3759 in
                            {3399}let Ns_3763: bitstring = dec(wNs_3760,skCli_3175) in
                            {3400}let Kcli_3764: bitstring = h((Nc_3755,Ns_3763)) in
                            {3401}out(c, senc(mCli(pkCli_3176,pkSess_3752),Kcli_3764))
                        )
                        else
                            {3402}let v_3765: bool = (Sess = B) in
                            (
                                {3403}if v_3765 then
                                (
                                    {3404}let pkSess_3766: bitstring = pub(skB) in
                                    {3405}out(c, GetEndpointRequest);
                                    {3406}in(c, (=GetEndpointResponse,=pkSess_3766,=None,SP_3767: bitstring,UP_3768: bitstring));
                                    {3407}new Nc_3769: bitstring;
                                    {3408}let wNc_3770: bitstring = enc(Nc_3769,pkSess_3766) in
                                    {3409}let m1_3771: bitstring = (OpenSecureChannelRequest,pkCli_3176,wNc_3770) in
                                    {3410}out(c, (pkCli_3176,m1_3771));
                                    {3411}in(c, em2_3772: bitstring);
                                    {3412}let m2_3773: bitstring = em2_3772 in
                                    {3413}let (=OpenSecureChannelResponse,wNs_3774: bitstring,ST_3775: bitstring,TTL_3776: bitstring) = m2_3773 in
                                    {3414}let Ns_3777: bitstring = dec(wNs_3774,skCli_3175) in
                                    {3415}let Kcli_3778: bitstring = h((Nc_3769,Ns_3777)) in
                                    {3416}out(c, senc(mCli(pkCli_3176,pkSess_3766),Kcli_3778))
                                )
                                else
                                    {3417}let v_3779: bool = (Sess = C) in
                                    (
                                        {3418}if v_3779 then
                                        (
                                            {3419}let pkSess_3780: bitstring = pub(skC) in
                                            {3420}out(c, GetEndpointRequest);
                                            {3421}in(c, (=GetEndpointResponse,=pkSess_3780,=None,SP_3781: bitstring,UP_3782: bitstring));
                                            {3422}new Nc_3783: bitstring;
                                            {3423}let wNc_3784: bitstring = enc(Nc_3783,pkSess_3780) in
                                            {3424}let m1_3785: bitstring = (OpenSecureChannelRequest,pkCli_3176,wNc_3784) in
                                            {3425}out(c, (pkCli_3176,m1_3785));
                                            {3426}in(c, em2_3786: bitstring);
                                            {3427}let m2_3787: bitstring = em2_3786 in
                                            {3428}let (=OpenSecureChannelResponse,wNs_3788: bitstring,ST_3789: bitstring,TTL_3790: bitstring) = m2_3787 in
                                            {3429}let Ns_3791: bitstring = dec(wNs_3788,skCli_3175) in
                                            {3430}let Kcli_3792: bitstring = h((Nc_3783,Ns_3791)) in
                                            {3431}out(c, senc(mCli(pkCli_3176,pkSess_3780),Kcli_3792))
                                        )
                                        else
                                            {3432}let pkSess_3793: bitstring = pub(sk(Sess)) in
                                            {3433}out(c, GetEndpointRequest);
                                            {3434}in(c, (=GetEndpointResponse,=pkSess_3793,=None,SP_3794: bitstring,UP_3795: bitstring));
                                            {3435}new Nc_3796: bitstring;
                                            {3436}let wNc_3797: bitstring = enc(Nc_3796,pkSess_3793) in
                                            {3437}let m1_3798: bitstring = (OpenSecureChannelRequest,pkCli_3176,wNc_3797) in
                                            {3438}out(c, (pkCli_3176,m1_3798));
                                            {3439}in(c, em2_3799: bitstring);
                                            {3440}let m2_3800: bitstring = em2_3799 in
                                            {3441}let (=OpenSecureChannelResponse,wNs_3801: bitstring,ST_3802: bitstring,TTL_3803: bitstring) = m2_3800 in
                                            {3442}let Ns_3804: bitstring = dec(wNs_3801,skCli_3175) in
                                            {3443}let Kcli_3805: bitstring = h((Nc_3796,Ns_3804)) in
                                            {3444}out(c, senc(mCli(pkCli_3176,pkSess_3793),Kcli_3805))
                                    )
                                    else
                                        {3445}let pkSess_3806: bitstring = fail-any in
                                        {3446}out(c, GetEndpointRequest);
                                        {3447}in(c, (=GetEndpointResponse,=pkSess_3806,=None,SP_3807: bitstring,UP_3808: bitstring));
                                        {3448}new Nc_3809: bitstring;
                                        {3449}let wNc_3810: bitstring = enc(Nc_3809,pkSess_3806) in
                                        {3450}let m1_3811: bitstring = (OpenSecureChannelRequest,pkCli_3176,wNc_3810) in
                                        {3451}out(c, (pkCli_3176,m1_3811));
                                        {3452}in(c, em2_3812: bitstring);
                                        {3453}let m2_3813: bitstring = em2_3812 in
                                        {3454}let (=OpenSecureChannelResponse,wNs_3814: bitstring,ST_3815: bitstring,TTL_3816: bitstring) = m2_3813 in
                                        {3455}let Ns_3817: bitstring = dec(wNs_3814,skCli_3175) in
                                        {3456}let Kcli_3818: bitstring = h((Nc_3809,Ns_3817)) in
                                        {3457}out(c, senc(mCli(pkCli_3176,pkSess_3806),Kcli_3818))
                            )
                            else
                                {3458}let pkSess_3819: bitstring = fail-any in
                                {3459}out(c, GetEndpointRequest);
                                {3460}in(c, (=GetEndpointResponse,=pkSess_3819,=None,SP_3820: bitstring,UP_3821: bitstring));
                                {3461}new Nc_3822: bitstring;
                                {3462}let wNc_3823: bitstring = enc(Nc_3822,pkSess_3819) in
                                {3463}let m1_3824: bitstring = (OpenSecureChannelRequest,pkCli_3176,wNc_3823) in
                                {3464}out(c, (pkCli_3176,m1_3824));
                                {3465}in(c, em2_3825: bitstring);
                                {3466}let m2_3826: bitstring = em2_3825 in
                                {3467}let (=OpenSecureChannelResponse,wNs_3827: bitstring,ST_3828: bitstring,TTL_3829: bitstring) = m2_3826 in
                                {3468}let Ns_3830: bitstring = dec(wNs_3827,skCli_3175) in
                                {3469}let Kcli_3831: bitstring = h((Nc_3822,Ns_3830)) in
                                {3470}out(c, senc(mCli(pkCli_3176,pkSess_3819),Kcli_3831))
                    )
                    else
                        {3471}let pkSess_3832: bitstring = fail-any in
                        {3472}out(c, GetEndpointRequest);
                        {3473}in(c, (=GetEndpointResponse,=pkSess_3832,=None,SP_3833: bitstring,UP_3834: bitstring));
                        {3474}new Nc_3835: bitstring;
                        {3475}let wNc_3836: bitstring = enc(Nc_3835,pkSess_3832) in
                        {3476}let m1_3837: bitstring = (OpenSecureChannelRequest,pkCli_3176,wNc_3836) in
                        {3477}out(c, (pkCli_3176,m1_3837));
                        {3478}in(c, em2_3838: bitstring);
                        {3479}let m2_3839: bitstring = em2_3838 in
                        {3480}let (=OpenSecureChannelResponse,wNs_3840: bitstring,ST_3841: bitstring,TTL_3842: bitstring) = m2_3839 in
                        {3481}let Ns_3843: bitstring = dec(wNs_3840,skCli_3175) in
                        {3482}let Kcli_3844: bitstring = h((Nc_3835,Ns_3843)) in
                        {3483}out(c, senc(mCli(pkCli_3176,pkSess_3832),Kcli_3844))
    )
    else
        {3484}let skCli_3845: bitstring = fail-any in
        {3485}let pkCli_3846: bitstring = pub(skCli_3845) in
        {3486}let v_3847: bool = (Disco = A) in
        (
            {3487}if v_3847 then
            (
                {3488}let pkDisco_3848: bitstring = pub(skA) in
                {3489}let v_3849: bool = (Sess = A) in
                (
                    {3490}if v_3849 then
                    (
                        {3491}let pkSess_3850: bitstring = pub(skA) in
                        {3492}out(c, GetEndpointRequest);
                        {3493}in(c, (=GetEndpointResponse,=pkSess_3850,=None,SP_3851: bitstring,UP_3852: bitstring));
                        {3494}new Nc_3853: bitstring;
                        {3495}let wNc_3854: bitstring = enc(Nc_3853,pkSess_3850) in
                        {3496}let m1_3855: bitstring = (OpenSecureChannelRequest,pkCli_3846,wNc_3854) in
                        {3497}out(c, (pkCli_3846,m1_3855));
                        {3498}in(c, em2_3856: bitstring);
                        {3499}let m2_3857: bitstring = em2_3856 in
                        {3500}let (=OpenSecureChannelResponse,wNs_3858: bitstring,ST_3859: bitstring,TTL_3860: bitstring) = m2_3857 in
                        {3501}let Ns_3861: bitstring = dec(wNs_3858,skCli_3845) in
                        {3502}let Kcli_3862: bitstring = h((Nc_3853,Ns_3861)) in
                        {3503}out(c, senc(mCli(pkCli_3846,pkSess_3850),Kcli_3862))
                    )
                    else
                        {3504}let v_3863: bool = (Sess = B) in
                        (
                            {3505}if v_3863 then
                            (
                                {3506}let pkSess_3864: bitstring = pub(skB) in
                                {3507}out(c, GetEndpointRequest);
                                {3508}in(c, (=GetEndpointResponse,=pkSess_3864,=None,SP_3865: bitstring,UP_3866: bitstring));
                                {3509}new Nc_3867: bitstring;
                                {3510}let wNc_3868: bitstring = enc(Nc_3867,pkSess_3864) in
                                {3511}let m1_3869: bitstring = (OpenSecureChannelRequest,pkCli_3846,wNc_3868) in
                                {3512}out(c, (pkCli_3846,m1_3869));
                                {3513}in(c, em2_3870: bitstring);
                                {3514}let m2_3871: bitstring = em2_3870 in
                                {3515}let (=OpenSecureChannelResponse,wNs_3872: bitstring,ST_3873: bitstring,TTL_3874: bitstring) = m2_3871 in
                                {3516}let Ns_3875: bitstring = dec(wNs_3872,skCli_3845) in
                                {3517}let Kcli_3876: bitstring = h((Nc_3867,Ns_3875)) in
                                {3518}out(c, senc(mCli(pkCli_3846,pkSess_3864),Kcli_3876))
                            )
                            else
                                {3519}let v_3877: bool = (Sess = C) in
                                (
                                    {3520}if v_3877 then
                                    (
                                        {3521}let pkSess_3878: bitstring = pub(skC) in
                                        {3522}out(c, GetEndpointRequest);
                                        {3523}in(c, (=GetEndpointResponse,=pkSess_3878,=None,SP_3879: bitstring,UP_3880: bitstring));
                                        {3524}new Nc_3881: bitstring;
                                        {3525}let wNc_3882: bitstring = enc(Nc_3881,pkSess_3878) in
                                        {3526}let m1_3883: bitstring = (OpenSecureChannelRequest,pkCli_3846,wNc_3882) in
                                        {3527}out(c, (pkCli_3846,m1_3883));
                                        {3528}in(c, em2_3884: bitstring);
                                        {3529}let m2_3885: bitstring = em2_3884 in
                                        {3530}let (=OpenSecureChannelResponse,wNs_3886: bitstring,ST_3887: bitstring,TTL_3888: bitstring) = m2_3885 in
                                        {3531}let Ns_3889: bitstring = dec(wNs_3886,skCli_3845) in
                                        {3532}let Kcli_3890: bitstring = h((Nc_3881,Ns_3889)) in
                                        {3533}out(c, senc(mCli(pkCli_3846,pkSess_3878),Kcli_3890))
                                    )
                                    else
                                        {3534}let pkSess_3891: bitstring = pub(sk(Sess)) in
                                        {3535}out(c, GetEndpointRequest);
                                        {3536}in(c, (=GetEndpointResponse,=pkSess_3891,=None,SP_3892: bitstring,UP_3893: bitstring));
                                        {3537}new Nc_3894: bitstring;
                                        {3538}let wNc_3895: bitstring = enc(Nc_3894,pkSess_3891) in
                                        {3539}let m1_3896: bitstring = (OpenSecureChannelRequest,pkCli_3846,wNc_3895) in
                                        {3540}out(c, (pkCli_3846,m1_3896));
                                        {3541}in(c, em2_3897: bitstring);
                                        {3542}let m2_3898: bitstring = em2_3897 in
                                        {3543}let (=OpenSecureChannelResponse,wNs_3899: bitstring,ST_3900: bitstring,TTL_3901: bitstring) = m2_3898 in
                                        {3544}let Ns_3902: bitstring = dec(wNs_3899,skCli_3845) in
                                        {3545}let Kcli_3903: bitstring = h((Nc_3894,Ns_3902)) in
                                        {3546}out(c, senc(mCli(pkCli_3846,pkSess_3891),Kcli_3903))
                                )
                                else
                                    {3547}let pkSess_3904: bitstring = fail-any in
                                    {3548}out(c, GetEndpointRequest);
                                    {3549}in(c, (=GetEndpointResponse,=pkSess_3904,=None,SP_3905: bitstring,UP_3906: bitstring));
                                    {3550}new Nc_3907: bitstring;
                                    {3551}let wNc_3908: bitstring = enc(Nc_3907,pkSess_3904) in
                                    {3552}let m1_3909: bitstring = (OpenSecureChannelRequest,pkCli_3846,wNc_3908) in
                                    {3553}out(c, (pkCli_3846,m1_3909));
                                    {3554}in(c, em2_3910: bitstring);
                                    {3555}let m2_3911: bitstring = em2_3910 in
                                    {3556}let (=OpenSecureChannelResponse,wNs_3912: bitstring,ST_3913: bitstring,TTL_3914: bitstring) = m2_3911 in
                                    {3557}let Ns_3915: bitstring = dec(wNs_3912,skCli_3845) in
                                    {3558}let Kcli_3916: bitstring = h((Nc_3907,Ns_3915)) in
                                    {3559}out(c, senc(mCli(pkCli_3846,pkSess_3904),Kcli_3916))
                        )
                        else
                            {3560}let pkSess_3917: bitstring = fail-any in
                            {3561}out(c, GetEndpointRequest);
                            {3562}in(c, (=GetEndpointResponse,=pkSess_3917,=None,SP_3918: bitstring,UP_3919: bitstring));
                            {3563}new Nc_3920: bitstring;
                            {3564}let wNc_3921: bitstring = enc(Nc_3920,pkSess_3917) in
                            {3565}let m1_3922: bitstring = (OpenSecureChannelRequest,pkCli_3846,wNc_3921) in
                            {3566}out(c, (pkCli_3846,m1_3922));
                            {3567}in(c, em2_3923: bitstring);
                            {3568}let m2_3924: bitstring = em2_3923 in
                            {3569}let (=OpenSecureChannelResponse,wNs_3925: bitstring,ST_3926: bitstring,TTL_3927: bitstring) = m2_3924 in
                            {3570}let Ns_3928: bitstring = dec(wNs_3925,skCli_3845) in
                            {3571}let Kcli_3929: bitstring = h((Nc_3920,Ns_3928)) in
                            {3572}out(c, senc(mCli(pkCli_3846,pkSess_3917),Kcli_3929))
                )
                else
                    {3573}let pkSess_3930: bitstring = fail-any in
                    {3574}out(c, GetEndpointRequest);
                    {3575}in(c, (=GetEndpointResponse,=pkSess_3930,=None,SP_3931: bitstring,UP_3932: bitstring));
                    {3576}new Nc_3933: bitstring;
                    {3577}let wNc_3934: bitstring = enc(Nc_3933,pkSess_3930) in
                    {3578}let m1_3935: bitstring = (OpenSecureChannelRequest,pkCli_3846,wNc_3934) in
                    {3579}out(c, (pkCli_3846,m1_3935));
                    {3580}in(c, em2_3936: bitstring);
                    {3581}let m2_3937: bitstring = em2_3936 in
                    {3582}let (=OpenSecureChannelResponse,wNs_3938: bitstring,ST_3939: bitstring,TTL_3940: bitstring) = m2_3937 in
                    {3583}let Ns_3941: bitstring = dec(wNs_3938,skCli_3845) in
                    {3584}let Kcli_3942: bitstring = h((Nc_3933,Ns_3941)) in
                    {3585}out(c, senc(mCli(pkCli_3846,pkSess_3930),Kcli_3942))
            )
            else
                {3586}let v_3943: bool = (Disco = B) in
                (
                    {3587}if v_3943 then
                    (
                        {3588}let pkDisco_3944: bitstring = pub(skB) in
                        {3589}let v_3945: bool = (Sess = A) in
                        (
                            {3590}if v_3945 then
                            (
                                {3591}let pkSess_3946: bitstring = pub(skA) in
                                {3592}out(c, GetEndpointRequest);
                                {3593}in(c, (=GetEndpointResponse,=pkSess_3946,=None,SP_3947: bitstring,UP_3948: bitstring));
                                {3594}new Nc_3949: bitstring;
                                {3595}let wNc_3950: bitstring = enc(Nc_3949,pkSess_3946) in
                                {3596}let m1_3951: bitstring = (OpenSecureChannelRequest,pkCli_3846,wNc_3950) in
                                {3597}out(c, (pkCli_3846,m1_3951));
                                {3598}in(c, em2_3952: bitstring);
                                {3599}let m2_3953: bitstring = em2_3952 in
                                {3600}let (=OpenSecureChannelResponse,wNs_3954: bitstring,ST_3955: bitstring,TTL_3956: bitstring) = m2_3953 in
                                {3601}let Ns_3957: bitstring = dec(wNs_3954,skCli_3845) in
                                {3602}let Kcli_3958: bitstring = h((Nc_3949,Ns_3957)) in
                                {3603}out(c, senc(mCli(pkCli_3846,pkSess_3946),Kcli_3958))
                            )
                            else
                                {3604}let v_3959: bool = (Sess = B) in
                                (
                                    {3605}if v_3959 then
                                    (
                                        {3606}let pkSess_3960: bitstring = pub(skB) in
                                        {3607}out(c, GetEndpointRequest);
                                        {3608}in(c, (=GetEndpointResponse,=pkSess_3960,=None,SP_3961: bitstring,UP_3962: bitstring));
                                        {3609}new Nc_3963: bitstring;
                                        {3610}let wNc_3964: bitstring = enc(Nc_3963,pkSess_3960) in
                                        {3611}let m1_3965: bitstring = (OpenSecureChannelRequest,pkCli_3846,wNc_3964) in
                                        {3612}out(c, (pkCli_3846,m1_3965));
                                        {3613}in(c, em2_3966: bitstring);
                                        {3614}let m2_3967: bitstring = em2_3966 in
                                        {3615}let (=OpenSecureChannelResponse,wNs_3968: bitstring,ST_3969: bitstring,TTL_3970: bitstring) = m2_3967 in
                                        {3616}let Ns_3971: bitstring = dec(wNs_3968,skCli_3845) in
                                        {3617}let Kcli_3972: bitstring = h((Nc_3963,Ns_3971)) in
                                        {3618}out(c, senc(mCli(pkCli_3846,pkSess_3960),Kcli_3972))
                                    )
                                    else
                                        {3619}let v_3973: bool = (Sess = C) in
                                        (
                                            {3620}if v_3973 then
                                            (
                                                {3621}let pkSess_3974: bitstring = pub(skC) in
                                                {3622}out(c, GetEndpointRequest);
                                                {3623}in(c, (=GetEndpointResponse,=pkSess_3974,=None,SP_3975: bitstring,UP_3976: bitstring));
                                                {3624}new Nc_3977: bitstring;
                                                {3625}let wNc_3978: bitstring = enc(Nc_3977,pkSess_3974) in
                                                {3626}let m1_3979: bitstring = (OpenSecureChannelRequest,pkCli_3846,wNc_3978) in
                                                {3627}out(c, (pkCli_3846,m1_3979));
                                                {3628}in(c, em2_3980: bitstring);
                                                {3629}let m2_3981: bitstring = em2_3980 in
                                                {3630}let (=OpenSecureChannelResponse,wNs_3982: bitstring,ST_3983: bitstring,TTL_3984: bitstring) = m2_3981 in
                                                {3631}let Ns_3985: bitstring = dec(wNs_3982,skCli_3845) in
                                                {3632}let Kcli_3986: bitstring = h((Nc_3977,Ns_3985)) in
                                                {3633}out(c, senc(mCli(pkCli_3846,pkSess_3974),Kcli_3986))
                                            )
                                            else
                                                {3634}let pkSess_3987: bitstring = pub(sk(Sess)) in
                                                {3635}out(c, GetEndpointRequest);
                                                {3636}in(c, (=GetEndpointResponse,=pkSess_3987,=None,SP_3988: bitstring,UP_3989: bitstring));
                                                {3637}new Nc_3990: bitstring;
                                                {3638}let wNc_3991: bitstring = enc(Nc_3990,pkSess_3987) in
                                                {3639}let m1_3992: bitstring = (OpenSecureChannelRequest,pkCli_3846,wNc_3991) in
                                                {3640}out(c, (pkCli_3846,m1_3992));
                                                {3641}in(c, em2_3993: bitstring);
                                                {3642}let m2_3994: bitstring = em2_3993 in
                                                {3643}let (=OpenSecureChannelResponse,wNs_3995: bitstring,ST_3996: bitstring,TTL_3997: bitstring) = m2_3994 in
                                                {3644}let Ns_3998: bitstring = dec(wNs_3995,skCli_3845) in
                                                {3645}let Kcli_3999: bitstring = h((Nc_3990,Ns_3998)) in
                                                {3646}out(c, senc(mCli(pkCli_3846,pkSess_3987),Kcli_3999))
                                        )
                                        else
                                            {3647}let pkSess_4000: bitstring = fail-any in
                                            {3648}out(c, GetEndpointRequest);
                                            {3649}in(c, (=GetEndpointResponse,=pkSess_4000,=None,SP_4001: bitstring,UP_4002: bitstring));
                                            {3650}new Nc_4003: bitstring;
                                            {3651}let wNc_4004: bitstring = enc(Nc_4003,pkSess_4000) in
                                            {3652}let m1_4005: bitstring = (OpenSecureChannelRequest,pkCli_3846,wNc_4004) in
                                            {3653}out(c, (pkCli_3846,m1_4005));
                                            {3654}in(c, em2_4006: bitstring);
                                            {3655}let m2_4007: bitstring = em2_4006 in
                                            {3656}let (=OpenSecureChannelResponse,wNs_4008: bitstring,ST_4009: bitstring,TTL_4010: bitstring) = m2_4007 in
                                            {3657}let Ns_4011: bitstring = dec(wNs_4008,skCli_3845) in
                                            {3658}let Kcli_4012: bitstring = h((Nc_4003,Ns_4011)) in
                                            {3659}out(c, senc(mCli(pkCli_3846,pkSess_4000),Kcli_4012))
                                )
                                else
                                    {3660}let pkSess_4013: bitstring = fail-any in
                                    {3661}out(c, GetEndpointRequest);
                                    {3662}in(c, (=GetEndpointResponse,=pkSess_4013,=None,SP_4014: bitstring,UP_4015: bitstring));
                                    {3663}new Nc_4016: bitstring;
                                    {3664}let wNc_4017: bitstring = enc(Nc_4016,pkSess_4013) in
                                    {3665}let m1_4018: bitstring = (OpenSecureChannelRequest,pkCli_3846,wNc_4017) in
                                    {3666}out(c, (pkCli_3846,m1_4018));
                                    {3667}in(c, em2_4019: bitstring);
                                    {3668}let m2_4020: bitstring = em2_4019 in
                                    {3669}let (=OpenSecureChannelResponse,wNs_4021: bitstring,ST_4022: bitstring,TTL_4023: bitstring) = m2_4020 in
                                    {3670}let Ns_4024: bitstring = dec(wNs_4021,skCli_3845) in
                                    {3671}let Kcli_4025: bitstring = h((Nc_4016,Ns_4024)) in
                                    {3672}out(c, senc(mCli(pkCli_3846,pkSess_4013),Kcli_4025))
                        )
                        else
                            {3673}let pkSess_4026: bitstring = fail-any in
                            {3674}out(c, GetEndpointRequest);
                            {3675}in(c, (=GetEndpointResponse,=pkSess_4026,=None,SP_4027: bitstring,UP_4028: bitstring));
                            {3676}new Nc_4029: bitstring;
                            {3677}let wNc_4030: bitstring = enc(Nc_4029,pkSess_4026) in
                            {3678}let m1_4031: bitstring = (OpenSecureChannelRequest,pkCli_3846,wNc_4030) in
                            {3679}out(c, (pkCli_3846,m1_4031));
                            {3680}in(c, em2_4032: bitstring);
                            {3681}let m2_4033: bitstring = em2_4032 in
                            {3682}let (=OpenSecureChannelResponse,wNs_4034: bitstring,ST_4035: bitstring,TTL_4036: bitstring) = m2_4033 in
                            {3683}let Ns_4037: bitstring = dec(wNs_4034,skCli_3845) in
                            {3684}let Kcli_4038: bitstring = h((Nc_4029,Ns_4037)) in
                            {3685}out(c, senc(mCli(pkCli_3846,pkSess_4026),Kcli_4038))
                    )
                    else
                        {3686}let v_4039: bool = (Disco = C) in
                        (
                            {3687}if v_4039 then
                            (
                                {3688}let pkDisco_4040: bitstring = pub(skC) in
                                {3689}let v_4041: bool = (Sess = A) in
                                (
                                    {3690}if v_4041 then
                                    (
                                        {3691}let pkSess_4042: bitstring = pub(skA) in
                                        {3692}out(c, GetEndpointRequest);
                                        {3693}in(c, (=GetEndpointResponse,=pkSess_4042,=None,SP_4043: bitstring,UP_4044: bitstring));
                                        {3694}new Nc_4045: bitstring;
                                        {3695}let wNc_4046: bitstring = enc(Nc_4045,pkSess_4042) in
                                        {3696}let m1_4047: bitstring = (OpenSecureChannelRequest,pkCli_3846,wNc_4046) in
                                        {3697}out(c, (pkCli_3846,m1_4047));
                                        {3698}in(c, em2_4048: bitstring);
                                        {3699}let m2_4049: bitstring = em2_4048 in
                                        {3700}let (=OpenSecureChannelResponse,wNs_4050: bitstring,ST_4051: bitstring,TTL_4052: bitstring) = m2_4049 in
                                        {3701}let Ns_4053: bitstring = dec(wNs_4050,skCli_3845) in
                                        {3702}let Kcli_4054: bitstring = h((Nc_4045,Ns_4053)) in
                                        {3703}out(c, senc(mCli(pkCli_3846,pkSess_4042),Kcli_4054))
                                    )
                                    else
                                        {3704}let v_4055: bool = (Sess = B) in
                                        (
                                            {3705}if v_4055 then
                                            (
                                                {3706}let pkSess_4056: bitstring = pub(skB) in
                                                {3707}out(c, GetEndpointRequest);
                                                {3708}in(c, (=GetEndpointResponse,=pkSess_4056,=None,SP_4057: bitstring,UP_4058: bitstring));
                                                {3709}new Nc_4059: bitstring;
                                                {3710}let wNc_4060: bitstring = enc(Nc_4059,pkSess_4056) in
                                                {3711}let m1_4061: bitstring = (OpenSecureChannelRequest,pkCli_3846,wNc_4060) in
                                                {3712}out(c, (pkCli_3846,m1_4061));
                                                {3713}in(c, em2_4062: bitstring);
                                                {3714}let m2_4063: bitstring = em2_4062 in
                                                {3715}let (=OpenSecureChannelResponse,wNs_4064: bitstring,ST_4065: bitstring,TTL_4066: bitstring) = m2_4063 in
                                                {3716}let Ns_4067: bitstring = dec(wNs_4064,skCli_3845) in
                                                {3717}let Kcli_4068: bitstring = h((Nc_4059,Ns_4067)) in
                                                {3718}out(c, senc(mCli(pkCli_3846,pkSess_4056),Kcli_4068))
                                            )
                                            else
                                                {3719}let v_4069: bool = (Sess = C) in
                                                (
                                                    {3720}if v_4069 then
                                                    (
                                                        {3721}let pkSess_4070: bitstring = pub(skC) in
                                                        {3722}out(c, GetEndpointRequest);
                                                        {3723}in(c, (=GetEndpointResponse,=pkSess_4070,=None,SP_4071: bitstring,UP_4072: bitstring));
                                                        {3724}new Nc_4073: bitstring;
                                                        {3725}let wNc_4074: bitstring = enc(Nc_4073,pkSess_4070) in
                                                        {3726}let m1_4075: bitstring = (OpenSecureChannelRequest,pkCli_3846,wNc_4074) in
                                                        {3727}out(c, (pkCli_3846,m1_4075));
                                                        {3728}in(c, em2_4076: bitstring);
                                                        {3729}let m2_4077: bitstring = em2_4076 in
                                                        {3730}let (=OpenSecureChannelResponse,wNs_4078: bitstring,ST_4079: bitstring,TTL_4080: bitstring) = m2_4077 in
                                                        {3731}let Ns_4081: bitstring = dec(wNs_4078,skCli_3845) in
                                                        {3732}let Kcli_4082: bitstring = h((Nc_4073,Ns_4081)) in
                                                        {3733}out(c, senc(mCli(pkCli_3846,pkSess_4070),Kcli_4082))
                                                    )
                                                    else
                                                        {3734}let pkSess_4083: bitstring = pub(sk(Sess)) in
                                                        {3735}out(c, GetEndpointRequest);
                                                        {3736}in(c, (=GetEndpointResponse,=pkSess_4083,=None,SP_4084: bitstring,UP_4085: bitstring));
                                                        {3737}new Nc_4086: bitstring;
                                                        {3738}let wNc_4087: bitstring = enc(Nc_4086,pkSess_4083) in
                                                        {3739}let m1_4088: bitstring = (OpenSecureChannelRequest,pkCli_3846,wNc_4087) in
                                                        {3740}out(c, (pkCli_3846,m1_4088));
                                                        {3741}in(c, em2_4089: bitstring);
                                                        {3742}let m2_4090: bitstring = em2_4089 in
                                                        {3743}let (=OpenSecureChannelResponse,wNs_4091: bitstring,ST_4092: bitstring,TTL_4093: bitstring) = m2_4090 in
                                                        {3744}let Ns_4094: bitstring = dec(wNs_4091,skCli_3845) in
                                                        {3745}let Kcli_4095: bitstring = h((Nc_4086,Ns_4094)) in
                                                        {3746}out(c, senc(mCli(pkCli_3846,pkSess_4083),Kcli_4095))
                                                )
                                                else
                                                    {3747}let pkSess_4096: bitstring = fail-any in
                                                    {3748}out(c, GetEndpointRequest);
                                                    {3749}in(c, (=GetEndpointResponse,=pkSess_4096,=None,SP_4097: bitstring,UP_4098: bitstring));
                                                    {3750}new Nc_4099: bitstring;
                                                    {3751}let wNc_4100: bitstring = enc(Nc_4099,pkSess_4096) in
                                                    {3752}let m1_4101: bitstring = (OpenSecureChannelRequest,pkCli_3846,wNc_4100) in
                                                    {3753}out(c, (pkCli_3846,m1_4101));
                                                    {3754}in(c, em2_4102: bitstring);
                                                    {3755}let m2_4103: bitstring = em2_4102 in
                                                    {3756}let (=OpenSecureChannelResponse,wNs_4104: bitstring,ST_4105: bitstring,TTL_4106: bitstring) = m2_4103 in
                                                    {3757}let Ns_4107: bitstring = dec(wNs_4104,skCli_3845) in
                                                    {3758}let Kcli_4108: bitstring = h((Nc_4099,Ns_4107)) in
                                                    {3759}out(c, senc(mCli(pkCli_3846,pkSess_4096),Kcli_4108))
                                        )
                                        else
                                            {3760}let pkSess_4109: bitstring = fail-any in
                                            {3761}out(c, GetEndpointRequest);
                                            {3762}in(c, (=GetEndpointResponse,=pkSess_4109,=None,SP_4110: bitstring,UP_4111: bitstring));
                                            {3763}new Nc_4112: bitstring;
                                            {3764}let wNc_4113: bitstring = enc(Nc_4112,pkSess_4109) in
                                            {3765}let m1_4114: bitstring = (OpenSecureChannelRequest,pkCli_3846,wNc_4113) in
                                            {3766}out(c, (pkCli_3846,m1_4114));
                                            {3767}in(c, em2_4115: bitstring);
                                            {3768}let m2_4116: bitstring = em2_4115 in
                                            {3769}let (=OpenSecureChannelResponse,wNs_4117: bitstring,ST_4118: bitstring,TTL_4119: bitstring) = m2_4116 in
                                            {3770}let Ns_4120: bitstring = dec(wNs_4117,skCli_3845) in
                                            {3771}let Kcli_4121: bitstring = h((Nc_4112,Ns_4120)) in
                                            {3772}out(c, senc(mCli(pkCli_3846,pkSess_4109),Kcli_4121))
                                )
                                else
                                    {3773}let pkSess_4122: bitstring = fail-any in
                                    {3774}out(c, GetEndpointRequest);
                                    {3775}in(c, (=GetEndpointResponse,=pkSess_4122,=None,SP_4123: bitstring,UP_4124: bitstring));
                                    {3776}new Nc_4125: bitstring;
                                    {3777}let wNc_4126: bitstring = enc(Nc_4125,pkSess_4122) in
                                    {3778}let m1_4127: bitstring = (OpenSecureChannelRequest,pkCli_3846,wNc_4126) in
                                    {3779}out(c, (pkCli_3846,m1_4127));
                                    {3780}in(c, em2_4128: bitstring);
                                    {3781}let m2_4129: bitstring = em2_4128 in
                                    {3782}let (=OpenSecureChannelResponse,wNs_4130: bitstring,ST_4131: bitstring,TTL_4132: bitstring) = m2_4129 in
                                    {3783}let Ns_4133: bitstring = dec(wNs_4130,skCli_3845) in
                                    {3784}let Kcli_4134: bitstring = h((Nc_4125,Ns_4133)) in
                                    {3785}out(c, senc(mCli(pkCli_3846,pkSess_4122),Kcli_4134))
                            )
                            else
                                {3786}let pkDisco_4135: bitstring = pub(sk(Disco)) in
                                {3787}let v_4136: bool = (Sess = A) in
                                (
                                    {3788}if v_4136 then
                                    (
                                        {3789}let pkSess_4137: bitstring = pub(skA) in
                                        {3790}out(c, GetEndpointRequest);
                                        {3791}in(c, (=GetEndpointResponse,=pkSess_4137,=None,SP_4138: bitstring,UP_4139: bitstring));
                                        {3792}new Nc_4140: bitstring;
                                        {3793}let wNc_4141: bitstring = enc(Nc_4140,pkSess_4137) in
                                        {3794}let m1_4142: bitstring = (OpenSecureChannelRequest,pkCli_3846,wNc_4141) in
                                        {3795}out(c, (pkCli_3846,m1_4142));
                                        {3796}in(c, em2_4143: bitstring);
                                        {3797}let m2_4144: bitstring = em2_4143 in
                                        {3798}let (=OpenSecureChannelResponse,wNs_4145: bitstring,ST_4146: bitstring,TTL_4147: bitstring) = m2_4144 in
                                        {3799}let Ns_4148: bitstring = dec(wNs_4145,skCli_3845) in
                                        {3800}let Kcli_4149: bitstring = h((Nc_4140,Ns_4148)) in
                                        {3801}out(c, senc(mCli(pkCli_3846,pkSess_4137),Kcli_4149))
                                    )
                                    else
                                        {3802}let v_4150: bool = (Sess = B) in
                                        (
                                            {3803}if v_4150 then
                                            (
                                                {3804}let pkSess_4151: bitstring = pub(skB) in
                                                {3805}out(c, GetEndpointRequest);
                                                {3806}in(c, (=GetEndpointResponse,=pkSess_4151,=None,SP_4152: bitstring,UP_4153: bitstring));
                                                {3807}new Nc_4154: bitstring;
                                                {3808}let wNc_4155: bitstring = enc(Nc_4154,pkSess_4151) in
                                                {3809}let m1_4156: bitstring = (OpenSecureChannelRequest,pkCli_3846,wNc_4155) in
                                                {3810}out(c, (pkCli_3846,m1_4156));
                                                {3811}in(c, em2_4157: bitstring);
                                                {3812}let m2_4158: bitstring = em2_4157 in
                                                {3813}let (=OpenSecureChannelResponse,wNs_4159: bitstring,ST_4160: bitstring,TTL_4161: bitstring) = m2_4158 in
                                                {3814}let Ns_4162: bitstring = dec(wNs_4159,skCli_3845) in
                                                {3815}let Kcli_4163: bitstring = h((Nc_4154,Ns_4162)) in
                                                {3816}out(c, senc(mCli(pkCli_3846,pkSess_4151),Kcli_4163))
                                            )
                                            else
                                                {3817}let v_4164: bool = (Sess = C) in
                                                (
                                                    {3818}if v_4164 then
                                                    (
                                                        {3819}let pkSess_4165: bitstring = pub(skC) in
                                                        {3820}out(c, GetEndpointRequest);
                                                        {3821}in(c, (=GetEndpointResponse,=pkSess_4165,=None,SP_4166: bitstring,UP_4167: bitstring));
                                                        {3822}new Nc_4168: bitstring;
                                                        {3823}let wNc_4169: bitstring = enc(Nc_4168,pkSess_4165) in
                                                        {3824}let m1_4170: bitstring = (OpenSecureChannelRequest,pkCli_3846,wNc_4169) in
                                                        {3825}out(c, (pkCli_3846,m1_4170));
                                                        {3826}in(c, em2_4171: bitstring);
                                                        {3827}let m2_4172: bitstring = em2_4171 in
                                                        {3828}let (=OpenSecureChannelResponse,wNs_4173: bitstring,ST_4174: bitstring,TTL_4175: bitstring) = m2_4172 in
                                                        {3829}let Ns_4176: bitstring = dec(wNs_4173,skCli_3845) in
                                                        {3830}let Kcli_4177: bitstring = h((Nc_4168,Ns_4176)) in
                                                        {3831}out(c, senc(mCli(pkCli_3846,pkSess_4165),Kcli_4177))
                                                    )
                                                    else
                                                        {3832}let pkSess_4178: bitstring = pub(sk(Sess)) in
                                                        {3833}out(c, GetEndpointRequest);
                                                        {3834}in(c, (=GetEndpointResponse,=pkSess_4178,=None,SP_4179: bitstring,UP_4180: bitstring));
                                                        {3835}new Nc_4181: bitstring;
                                                        {3836}let wNc_4182: bitstring = enc(Nc_4181,pkSess_4178) in
                                                        {3837}let m1_4183: bitstring = (OpenSecureChannelRequest,pkCli_3846,wNc_4182) in
                                                        {3838}out(c, (pkCli_3846,m1_4183));
                                                        {3839}in(c, em2_4184: bitstring);
                                                        {3840}let m2_4185: bitstring = em2_4184 in
                                                        {3841}let (=OpenSecureChannelResponse,wNs_4186: bitstring,ST_4187: bitstring,TTL_4188: bitstring) = m2_4185 in
                                                        {3842}let Ns_4189: bitstring = dec(wNs_4186,skCli_3845) in
                                                        {3843}let Kcli_4190: bitstring = h((Nc_4181,Ns_4189)) in
                                                        {3844}out(c, senc(mCli(pkCli_3846,pkSess_4178),Kcli_4190))
                                                )
                                                else
                                                    {3845}let pkSess_4191: bitstring = fail-any in
                                                    {3846}out(c, GetEndpointRequest);
                                                    {3847}in(c, (=GetEndpointResponse,=pkSess_4191,=None,SP_4192: bitstring,UP_4193: bitstring));
                                                    {3848}new Nc_4194: bitstring;
                                                    {3849}let wNc_4195: bitstring = enc(Nc_4194,pkSess_4191) in
                                                    {3850}let m1_4196: bitstring = (OpenSecureChannelRequest,pkCli_3846,wNc_4195) in
                                                    {3851}out(c, (pkCli_3846,m1_4196));
                                                    {3852}in(c, em2_4197: bitstring);
                                                    {3853}let m2_4198: bitstring = em2_4197 in
                                                    {3854}let (=OpenSecureChannelResponse,wNs_4199: bitstring,ST_4200: bitstring,TTL_4201: bitstring) = m2_4198 in
                                                    {3855}let Ns_4202: bitstring = dec(wNs_4199,skCli_3845) in
                                                    {3856}let Kcli_4203: bitstring = h((Nc_4194,Ns_4202)) in
                                                    {3857}out(c, senc(mCli(pkCli_3846,pkSess_4191),Kcli_4203))
                                        )
                                        else
                                            {3858}let pkSess_4204: bitstring = fail-any in
                                            {3859}out(c, GetEndpointRequest);
                                            {3860}in(c, (=GetEndpointResponse,=pkSess_4204,=None,SP_4205: bitstring,UP_4206: bitstring));
                                            {3861}new Nc_4207: bitstring;
                                            {3862}let wNc_4208: bitstring = enc(Nc_4207,pkSess_4204) in
                                            {3863}let m1_4209: bitstring = (OpenSecureChannelRequest,pkCli_3846,wNc_4208) in
                                            {3864}out(c, (pkCli_3846,m1_4209));
                                            {3865}in(c, em2_4210: bitstring);
                                            {3866}let m2_4211: bitstring = em2_4210 in
                                            {3867}let (=OpenSecureChannelResponse,wNs_4212: bitstring,ST_4213: bitstring,TTL_4214: bitstring) = m2_4211 in
                                            {3868}let Ns_4215: bitstring = dec(wNs_4212,skCli_3845) in
                                            {3869}let Kcli_4216: bitstring = h((Nc_4207,Ns_4215)) in
                                            {3870}out(c, senc(mCli(pkCli_3846,pkSess_4204),Kcli_4216))
                                )
                                else
                                    {3871}let pkSess_4217: bitstring = fail-any in
                                    {3872}out(c, GetEndpointRequest);
                                    {3873}in(c, (=GetEndpointResponse,=pkSess_4217,=None,SP_4218: bitstring,UP_4219: bitstring));
                                    {3874}new Nc_4220: bitstring;
                                    {3875}let wNc_4221: bitstring = enc(Nc_4220,pkSess_4217) in
                                    {3876}let m1_4222: bitstring = (OpenSecureChannelRequest,pkCli_3846,wNc_4221) in
                                    {3877}out(c, (pkCli_3846,m1_4222));
                                    {3878}in(c, em2_4223: bitstring);
                                    {3879}let m2_4224: bitstring = em2_4223 in
                                    {3880}let (=OpenSecureChannelResponse,wNs_4225: bitstring,ST_4226: bitstring,TTL_4227: bitstring) = m2_4224 in
                                    {3881}let Ns_4228: bitstring = dec(wNs_4225,skCli_3845) in
                                    {3882}let Kcli_4229: bitstring = h((Nc_4220,Ns_4228)) in
                                    {3883}out(c, senc(mCli(pkCli_3846,pkSess_4217),Kcli_4229))
                        )
                        else
                            {3884}let pkDisco_4230: bitstring = fail-any in
                            {3885}let v_4231: bool = (Sess = A) in
                            (
                                {3886}if v_4231 then
                                (
                                    {3887}let pkSess_4232: bitstring = pub(skA) in
                                    {3888}out(c, GetEndpointRequest);
                                    {3889}in(c, (=GetEndpointResponse,=pkSess_4232,=None,SP_4233: bitstring,UP_4234: bitstring));
                                    {3890}new Nc_4235: bitstring;
                                    {3891}let wNc_4236: bitstring = enc(Nc_4235,pkSess_4232) in
                                    {3892}let m1_4237: bitstring = (OpenSecureChannelRequest,pkCli_3846,wNc_4236) in
                                    {3893}out(c, (pkCli_3846,m1_4237));
                                    {3894}in(c, em2_4238: bitstring);
                                    {3895}let m2_4239: bitstring = em2_4238 in
                                    {3896}let (=OpenSecureChannelResponse,wNs_4240: bitstring,ST_4241: bitstring,TTL_4242: bitstring) = m2_4239 in
                                    {3897}let Ns_4243: bitstring = dec(wNs_4240,skCli_3845) in
                                    {3898}let Kcli_4244: bitstring = h((Nc_4235,Ns_4243)) in
                                    {3899}out(c, senc(mCli(pkCli_3846,pkSess_4232),Kcli_4244))
                                )
                                else
                                    {3900}let v_4245: bool = (Sess = B) in
                                    (
                                        {3901}if v_4245 then
                                        (
                                            {3902}let pkSess_4246: bitstring = pub(skB) in
                                            {3903}out(c, GetEndpointRequest);
                                            {3904}in(c, (=GetEndpointResponse,=pkSess_4246,=None,SP_4247: bitstring,UP_4248: bitstring));
                                            {3905}new Nc_4249: bitstring;
                                            {3906}let wNc_4250: bitstring = enc(Nc_4249,pkSess_4246) in
                                            {3907}let m1_4251: bitstring = (OpenSecureChannelRequest,pkCli_3846,wNc_4250) in
                                            {3908}out(c, (pkCli_3846,m1_4251));
                                            {3909}in(c, em2_4252: bitstring);
                                            {3910}let m2_4253: bitstring = em2_4252 in
                                            {3911}let (=OpenSecureChannelResponse,wNs_4254: bitstring,ST_4255: bitstring,TTL_4256: bitstring) = m2_4253 in
                                            {3912}let Ns_4257: bitstring = dec(wNs_4254,skCli_3845) in
                                            {3913}let Kcli_4258: bitstring = h((Nc_4249,Ns_4257)) in
                                            {3914}out(c, senc(mCli(pkCli_3846,pkSess_4246),Kcli_4258))
                                        )
                                        else
                                            {3915}let v_4259: bool = (Sess = C) in
                                            (
                                                {3916}if v_4259 then
                                                (
                                                    {3917}let pkSess_4260: bitstring = pub(skC) in
                                                    {3918}out(c, GetEndpointRequest);
                                                    {3919}in(c, (=GetEndpointResponse,=pkSess_4260,=None,SP_4261: bitstring,UP_4262: bitstring));
                                                    {3920}new Nc_4263: bitstring;
                                                    {3921}let wNc_4264: bitstring = enc(Nc_4263,pkSess_4260) in
                                                    {3922}let m1_4265: bitstring = (OpenSecureChannelRequest,pkCli_3846,wNc_4264) in
                                                    {3923}out(c, (pkCli_3846,m1_4265));
                                                    {3924}in(c, em2_4266: bitstring);
                                                    {3925}let m2_4267: bitstring = em2_4266 in
                                                    {3926}let (=OpenSecureChannelResponse,wNs_4268: bitstring,ST_4269: bitstring,TTL_4270: bitstring) = m2_4267 in
                                                    {3927}let Ns_4271: bitstring = dec(wNs_4268,skCli_3845) in
                                                    {3928}let Kcli_4272: bitstring = h((Nc_4263,Ns_4271)) in
                                                    {3929}out(c, senc(mCli(pkCli_3846,pkSess_4260),Kcli_4272))
                                                )
                                                else
                                                    {3930}let pkSess_4273: bitstring = pub(sk(Sess)) in
                                                    {3931}out(c, GetEndpointRequest);
                                                    {3932}in(c, (=GetEndpointResponse,=pkSess_4273,=None,SP_4274: bitstring,UP_4275: bitstring));
                                                    {3933}new Nc_4276: bitstring;
                                                    {3934}let wNc_4277: bitstring = enc(Nc_4276,pkSess_4273) in
                                                    {3935}let m1_4278: bitstring = (OpenSecureChannelRequest,pkCli_3846,wNc_4277) in
                                                    {3936}out(c, (pkCli_3846,m1_4278));
                                                    {3937}in(c, em2_4279: bitstring);
                                                    {3938}let m2_4280: bitstring = em2_4279 in
                                                    {3939}let (=OpenSecureChannelResponse,wNs_4281: bitstring,ST_4282: bitstring,TTL_4283: bitstring) = m2_4280 in
                                                    {3940}let Ns_4284: bitstring = dec(wNs_4281,skCli_3845) in
                                                    {3941}let Kcli_4285: bitstring = h((Nc_4276,Ns_4284)) in
                                                    {3942}out(c, senc(mCli(pkCli_3846,pkSess_4273),Kcli_4285))
                                            )
                                            else
                                                {3943}let pkSess_4286: bitstring = fail-any in
                                                {3944}out(c, GetEndpointRequest);
                                                {3945}in(c, (=GetEndpointResponse,=pkSess_4286,=None,SP_4287: bitstring,UP_4288: bitstring));
                                                {3946}new Nc_4289: bitstring;
                                                {3947}let wNc_4290: bitstring = enc(Nc_4289,pkSess_4286) in
                                                {3948}let m1_4291: bitstring = (OpenSecureChannelRequest,pkCli_3846,wNc_4290) in
                                                {3949}out(c, (pkCli_3846,m1_4291));
                                                {3950}in(c, em2_4292: bitstring);
                                                {3951}let m2_4293: bitstring = em2_4292 in
                                                {3952}let (=OpenSecureChannelResponse,wNs_4294: bitstring,ST_4295: bitstring,TTL_4296: bitstring) = m2_4293 in
                                                {3953}let Ns_4297: bitstring = dec(wNs_4294,skCli_3845) in
                                                {3954}let Kcli_4298: bitstring = h((Nc_4289,Ns_4297)) in
                                                {3955}out(c, senc(mCli(pkCli_3846,pkSess_4286),Kcli_4298))
                                    )
                                    else
                                        {3956}let pkSess_4299: bitstring = fail-any in
                                        {3957}out(c, GetEndpointRequest);
                                        {3958}in(c, (=GetEndpointResponse,=pkSess_4299,=None,SP_4300: bitstring,UP_4301: bitstring));
                                        {3959}new Nc_4302: bitstring;
                                        {3960}let wNc_4303: bitstring = enc(Nc_4302,pkSess_4299) in
                                        {3961}let m1_4304: bitstring = (OpenSecureChannelRequest,pkCli_3846,wNc_4303) in
                                        {3962}out(c, (pkCli_3846,m1_4304));
                                        {3963}in(c, em2_4305: bitstring);
                                        {3964}let m2_4306: bitstring = em2_4305 in
                                        {3965}let (=OpenSecureChannelResponse,wNs_4307: bitstring,ST_4308: bitstring,TTL_4309: bitstring) = m2_4306 in
                                        {3966}let Ns_4310: bitstring = dec(wNs_4307,skCli_3845) in
                                        {3967}let Kcli_4311: bitstring = h((Nc_4302,Ns_4310)) in
                                        {3968}out(c, senc(mCli(pkCli_3846,pkSess_4299),Kcli_4311))
                            )
                            else
                                {3969}let pkSess_4312: bitstring = fail-any in
                                {3970}out(c, GetEndpointRequest);
                                {3971}in(c, (=GetEndpointResponse,=pkSess_4312,=None,SP_4313: bitstring,UP_4314: bitstring));
                                {3972}new Nc_4315: bitstring;
                                {3973}let wNc_4316: bitstring = enc(Nc_4315,pkSess_4312) in
                                {3974}let m1_4317: bitstring = (OpenSecureChannelRequest,pkCli_3846,wNc_4316) in
                                {3975}out(c, (pkCli_3846,m1_4317));
                                {3976}in(c, em2_4318: bitstring);
                                {3977}let m2_4319: bitstring = em2_4318 in
                                {3978}let (=OpenSecureChannelResponse,wNs_4320: bitstring,ST_4321: bitstring,TTL_4322: bitstring) = m2_4319 in
                                {3979}let Ns_4323: bitstring = dec(wNs_4320,skCli_3845) in
                                {3980}let Kcli_4324: bitstring = h((Nc_4315,Ns_4323)) in
                                {3981}out(c, senc(mCli(pkCli_3846,pkSess_4312),Kcli_4324))
                )
                else
                    {3982}let pkDisco_4325: bitstring = fail-any in
                    {3983}let v_4326: bool = (Sess = A) in
                    (
                        {3984}if v_4326 then
                        (
                            {3985}let pkSess_4327: bitstring = pub(skA) in
                            {3986}out(c, GetEndpointRequest);
                            {3987}in(c, (=GetEndpointResponse,=pkSess_4327,=None,SP_4328: bitstring,UP_4329: bitstring));
                            {3988}new Nc_4330: bitstring;
                            {3989}let wNc_4331: bitstring = enc(Nc_4330,pkSess_4327) in
                            {3990}let m1_4332: bitstring = (OpenSecureChannelRequest,pkCli_3846,wNc_4331) in
                            {3991}out(c, (pkCli_3846,m1_4332));
                            {3992}in(c, em2_4333: bitstring);
                            {3993}let m2_4334: bitstring = em2_4333 in
                            {3994}let (=OpenSecureChannelResponse,wNs_4335: bitstring,ST_4336: bitstring,TTL_4337: bitstring) = m2_4334 in
                            {3995}let Ns_4338: bitstring = dec(wNs_4335,skCli_3845) in
                            {3996}let Kcli_4339: bitstring = h((Nc_4330,Ns_4338)) in
                            {3997}out(c, senc(mCli(pkCli_3846,pkSess_4327),Kcli_4339))
                        )
                        else
                            {3998}let v_4340: bool = (Sess = B) in
                            (
                                {3999}if v_4340 then
                                (
                                    {4000}let pkSess_4341: bitstring = pub(skB) in
                                    {4001}out(c, GetEndpointRequest);
                                    {4002}in(c, (=GetEndpointResponse,=pkSess_4341,=None,SP_4342: bitstring,UP_4343: bitstring));
                                    {4003}new Nc_4344: bitstring;
                                    {4004}let wNc_4345: bitstring = enc(Nc_4344,pkSess_4341) in
                                    {4005}let m1_4346: bitstring = (OpenSecureChannelRequest,pkCli_3846,wNc_4345) in
                                    {4006}out(c, (pkCli_3846,m1_4346));
                                    {4007}in(c, em2_4347: bitstring);
                                    {4008}let m2_4348: bitstring = em2_4347 in
                                    {4009}let (=OpenSecureChannelResponse,wNs_4349: bitstring,ST_4350: bitstring,TTL_4351: bitstring) = m2_4348 in
                                    {4010}let Ns_4352: bitstring = dec(wNs_4349,skCli_3845) in
                                    {4011}let Kcli_4353: bitstring = h((Nc_4344,Ns_4352)) in
                                    {4012}out(c, senc(mCli(pkCli_3846,pkSess_4341),Kcli_4353))
                                )
                                else
                                    {4013}let v_4354: bool = (Sess = C) in
                                    (
                                        {4014}if v_4354 then
                                        (
                                            {4015}let pkSess_4355: bitstring = pub(skC) in
                                            {4016}out(c, GetEndpointRequest);
                                            {4017}in(c, (=GetEndpointResponse,=pkSess_4355,=None,SP_4356: bitstring,UP_4357: bitstring));
                                            {4018}new Nc_4358: bitstring;
                                            {4019}let wNc_4359: bitstring = enc(Nc_4358,pkSess_4355) in
                                            {4020}let m1_4360: bitstring = (OpenSecureChannelRequest,pkCli_3846,wNc_4359) in
                                            {4021}out(c, (pkCli_3846,m1_4360));
                                            {4022}in(c, em2_4361: bitstring);
                                            {4023}let m2_4362: bitstring = em2_4361 in
                                            {4024}let (=OpenSecureChannelResponse,wNs_4363: bitstring,ST_4364: bitstring,TTL_4365: bitstring) = m2_4362 in
                                            {4025}let Ns_4366: bitstring = dec(wNs_4363,skCli_3845) in
                                            {4026}let Kcli_4367: bitstring = h((Nc_4358,Ns_4366)) in
                                            {4027}out(c, senc(mCli(pkCli_3846,pkSess_4355),Kcli_4367))
                                        )
                                        else
                                            {4028}let pkSess_4368: bitstring = pub(sk(Sess)) in
                                            {4029}out(c, GetEndpointRequest);
                                            {4030}in(c, (=GetEndpointResponse,=pkSess_4368,=None,SP_4369: bitstring,UP_4370: bitstring));
                                            {4031}new Nc_4371: bitstring;
                                            {4032}let wNc_4372: bitstring = enc(Nc_4371,pkSess_4368) in
                                            {4033}let m1_4373: bitstring = (OpenSecureChannelRequest,pkCli_3846,wNc_4372) in
                                            {4034}out(c, (pkCli_3846,m1_4373));
                                            {4035}in(c, em2_4374: bitstring);
                                            {4036}let m2_4375: bitstring = em2_4374 in
                                            {4037}let (=OpenSecureChannelResponse,wNs_4376: bitstring,ST_4377: bitstring,TTL_4378: bitstring) = m2_4375 in
                                            {4038}let Ns_4379: bitstring = dec(wNs_4376,skCli_3845) in
                                            {4039}let Kcli_4380: bitstring = h((Nc_4371,Ns_4379)) in
                                            {4040}out(c, senc(mCli(pkCli_3846,pkSess_4368),Kcli_4380))
                                    )
                                    else
                                        {4041}let pkSess_4381: bitstring = fail-any in
                                        {4042}out(c, GetEndpointRequest);
                                        {4043}in(c, (=GetEndpointResponse,=pkSess_4381,=None,SP_4382: bitstring,UP_4383: bitstring));
                                        {4044}new Nc_4384: bitstring;
                                        {4045}let wNc_4385: bitstring = enc(Nc_4384,pkSess_4381) in
                                        {4046}let m1_4386: bitstring = (OpenSecureChannelRequest,pkCli_3846,wNc_4385) in
                                        {4047}out(c, (pkCli_3846,m1_4386));
                                        {4048}in(c, em2_4387: bitstring);
                                        {4049}let m2_4388: bitstring = em2_4387 in
                                        {4050}let (=OpenSecureChannelResponse,wNs_4389: bitstring,ST_4390: bitstring,TTL_4391: bitstring) = m2_4388 in
                                        {4051}let Ns_4392: bitstring = dec(wNs_4389,skCli_3845) in
                                        {4052}let Kcli_4393: bitstring = h((Nc_4384,Ns_4392)) in
                                        {4053}out(c, senc(mCli(pkCli_3846,pkSess_4381),Kcli_4393))
                            )
                            else
                                {4054}let pkSess_4394: bitstring = fail-any in
                                {4055}out(c, GetEndpointRequest);
                                {4056}in(c, (=GetEndpointResponse,=pkSess_4394,=None,SP_4395: bitstring,UP_4396: bitstring));
                                {4057}new Nc_4397: bitstring;
                                {4058}let wNc_4398: bitstring = enc(Nc_4397,pkSess_4394) in
                                {4059}let m1_4399: bitstring = (OpenSecureChannelRequest,pkCli_3846,wNc_4398) in
                                {4060}out(c, (pkCli_3846,m1_4399));
                                {4061}in(c, em2_4400: bitstring);
                                {4062}let m2_4401: bitstring = em2_4400 in
                                {4063}let (=OpenSecureChannelResponse,wNs_4402: bitstring,ST_4403: bitstring,TTL_4404: bitstring) = m2_4401 in
                                {4064}let Ns_4405: bitstring = dec(wNs_4402,skCli_3845) in
                                {4065}let Kcli_4406: bitstring = h((Nc_4397,Ns_4405)) in
                                {4066}out(c, senc(mCli(pkCli_3846,pkSess_4394),Kcli_4406))
                    )
                    else
                        {4067}let pkSess_4407: bitstring = fail-any in
                        {4068}out(c, GetEndpointRequest);
                        {4069}in(c, (=GetEndpointResponse,=pkSess_4407,=None,SP_4408: bitstring,UP_4409: bitstring));
                        {4070}new Nc_4410: bitstring;
                        {4071}let wNc_4411: bitstring = enc(Nc_4410,pkSess_4407) in
                        {4072}let m1_4412: bitstring = (OpenSecureChannelRequest,pkCli_3846,wNc_4411) in
                        {4073}out(c, (pkCli_3846,m1_4412));
                        {4074}in(c, em2_4413: bitstring);
                        {4075}let m2_4414: bitstring = em2_4413 in
                        {4076}let (=OpenSecureChannelResponse,wNs_4415: bitstring,ST_4416: bitstring,TTL_4417: bitstring) = m2_4414 in
                        {4077}let Ns_4418: bitstring = dec(wNs_4415,skCli_3845) in
                        {4078}let Kcli_4419: bitstring = h((Nc_4410,Ns_4418)) in
                        {4079}out(c, senc(mCli(pkCli_3846,pkSess_4407),Kcli_4419))
        )
        else
            {4080}let pkDisco_4420: bitstring = fail-any in
            {4081}let v_4421: bool = (Sess = A) in
            (
                {4082}if v_4421 then
                (
                    {4083}let pkSess_4422: bitstring = pub(skA) in
                    {4084}out(c, GetEndpointRequest);
                    {4085}in(c, (=GetEndpointResponse,=pkSess_4422,=None,SP_4423: bitstring,UP_4424: bitstring));
                    {4086}new Nc_4425: bitstring;
                    {4087}let wNc_4426: bitstring = enc(Nc_4425,pkSess_4422) in
                    {4088}let m1_4427: bitstring = (OpenSecureChannelRequest,pkCli_3846,wNc_4426) in
                    {4089}out(c, (pkCli_3846,m1_4427));
                    {4090}in(c, em2_4428: bitstring);
                    {4091}let m2_4429: bitstring = em2_4428 in
                    {4092}let (=OpenSecureChannelResponse,wNs_4430: bitstring,ST_4431: bitstring,TTL_4432: bitstring) = m2_4429 in
                    {4093}let Ns_4433: bitstring = dec(wNs_4430,skCli_3845) in
                    {4094}let Kcli_4434: bitstring = h((Nc_4425,Ns_4433)) in
                    {4095}out(c, senc(mCli(pkCli_3846,pkSess_4422),Kcli_4434))
                )
                else
                    {4096}let v_4435: bool = (Sess = B) in
                    (
                        {4097}if v_4435 then
                        (
                            {4098}let pkSess_4436: bitstring = pub(skB) in
                            {4099}out(c, GetEndpointRequest);
                            {4100}in(c, (=GetEndpointResponse,=pkSess_4436,=None,SP_4437: bitstring,UP_4438: bitstring));
                            {4101}new Nc_4439: bitstring;
                            {4102}let wNc_4440: bitstring = enc(Nc_4439,pkSess_4436) in
                            {4103}let m1_4441: bitstring = (OpenSecureChannelRequest,pkCli_3846,wNc_4440) in
                            {4104}out(c, (pkCli_3846,m1_4441));
                            {4105}in(c, em2_4442: bitstring);
                            {4106}let m2_4443: bitstring = em2_4442 in
                            {4107}let (=OpenSecureChannelResponse,wNs_4444: bitstring,ST_4445: bitstring,TTL_4446: bitstring) = m2_4443 in
                            {4108}let Ns_4447: bitstring = dec(wNs_4444,skCli_3845) in
                            {4109}let Kcli_4448: bitstring = h((Nc_4439,Ns_4447)) in
                            {4110}out(c, senc(mCli(pkCli_3846,pkSess_4436),Kcli_4448))
                        )
                        else
                            {4111}let v_4449: bool = (Sess = C) in
                            (
                                {4112}if v_4449 then
                                (
                                    {4113}let pkSess_4450: bitstring = pub(skC) in
                                    {4114}out(c, GetEndpointRequest);
                                    {4115}in(c, (=GetEndpointResponse,=pkSess_4450,=None,SP_4451: bitstring,UP_4452: bitstring));
                                    {4116}new Nc_4453: bitstring;
                                    {4117}let wNc_4454: bitstring = enc(Nc_4453,pkSess_4450) in
                                    {4118}let m1_4455: bitstring = (OpenSecureChannelRequest,pkCli_3846,wNc_4454) in
                                    {4119}out(c, (pkCli_3846,m1_4455));
                                    {4120}in(c, em2_4456: bitstring);
                                    {4121}let m2_4457: bitstring = em2_4456 in
                                    {4122}let (=OpenSecureChannelResponse,wNs_4458: bitstring,ST_4459: bitstring,TTL_4460: bitstring) = m2_4457 in
                                    {4123}let Ns_4461: bitstring = dec(wNs_4458,skCli_3845) in
                                    {4124}let Kcli_4462: bitstring = h((Nc_4453,Ns_4461)) in
                                    {4125}out(c, senc(mCli(pkCli_3846,pkSess_4450),Kcli_4462))
                                )
                                else
                                    {4126}let pkSess_4463: bitstring = pub(sk(Sess)) in
                                    {4127}out(c, GetEndpointRequest);
                                    {4128}in(c, (=GetEndpointResponse,=pkSess_4463,=None,SP_4464: bitstring,UP_4465: bitstring));
                                    {4129}new Nc_4466: bitstring;
                                    {4130}let wNc_4467: bitstring = enc(Nc_4466,pkSess_4463) in
                                    {4131}let m1_4468: bitstring = (OpenSecureChannelRequest,pkCli_3846,wNc_4467) in
                                    {4132}out(c, (pkCli_3846,m1_4468));
                                    {4133}in(c, em2_4469: bitstring);
                                    {4134}let m2_4470: bitstring = em2_4469 in
                                    {4135}let (=OpenSecureChannelResponse,wNs_4471: bitstring,ST_4472: bitstring,TTL_4473: bitstring) = m2_4470 in
                                    {4136}let Ns_4474: bitstring = dec(wNs_4471,skCli_3845) in
                                    {4137}let Kcli_4475: bitstring = h((Nc_4466,Ns_4474)) in
                                    {4138}out(c, senc(mCli(pkCli_3846,pkSess_4463),Kcli_4475))
                            )
                            else
                                {4139}let pkSess_4476: bitstring = fail-any in
                                {4140}out(c, GetEndpointRequest);
                                {4141}in(c, (=GetEndpointResponse,=pkSess_4476,=None,SP_4477: bitstring,UP_4478: bitstring));
                                {4142}new Nc_4479: bitstring;
                                {4143}let wNc_4480: bitstring = enc(Nc_4479,pkSess_4476) in
                                {4144}let m1_4481: bitstring = (OpenSecureChannelRequest,pkCli_3846,wNc_4480) in
                                {4145}out(c, (pkCli_3846,m1_4481));
                                {4146}in(c, em2_4482: bitstring);
                                {4147}let m2_4483: bitstring = em2_4482 in
                                {4148}let (=OpenSecureChannelResponse,wNs_4484: bitstring,ST_4485: bitstring,TTL_4486: bitstring) = m2_4483 in
                                {4149}let Ns_4487: bitstring = dec(wNs_4484,skCli_3845) in
                                {4150}let Kcli_4488: bitstring = h((Nc_4479,Ns_4487)) in
                                {4151}out(c, senc(mCli(pkCli_3846,pkSess_4476),Kcli_4488))
                    )
                    else
                        {4152}let pkSess_4489: bitstring = fail-any in
                        {4153}out(c, GetEndpointRequest);
                        {4154}in(c, (=GetEndpointResponse,=pkSess_4489,=None,SP_4490: bitstring,UP_4491: bitstring));
                        {4155}new Nc_4492: bitstring;
                        {4156}let wNc_4493: bitstring = enc(Nc_4492,pkSess_4489) in
                        {4157}let m1_4494: bitstring = (OpenSecureChannelRequest,pkCli_3846,wNc_4493) in
                        {4158}out(c, (pkCli_3846,m1_4494));
                        {4159}in(c, em2_4495: bitstring);
                        {4160}let m2_4496: bitstring = em2_4495 in
                        {4161}let (=OpenSecureChannelResponse,wNs_4497: bitstring,ST_4498: bitstring,TTL_4499: bitstring) = m2_4496 in
                        {4162}let Ns_4500: bitstring = dec(wNs_4497,skCli_3845) in
                        {4163}let Kcli_4501: bitstring = h((Nc_4492,Ns_4500)) in
                        {4164}out(c, senc(mCli(pkCli_3846,pkSess_4489),Kcli_4501))
            )
            else
                {4165}let pkSess_4502: bitstring = fail-any in
                {4166}out(c, GetEndpointRequest);
                {4167}in(c, (=GetEndpointResponse,=pkSess_4502,=None,SP_4503: bitstring,UP_4504: bitstring));
                {4168}new Nc_4505: bitstring;
                {4169}let wNc_4506: bitstring = enc(Nc_4505,pkSess_4502) in
                {4170}let m1_4507: bitstring = (OpenSecureChannelRequest,pkCli_3846,wNc_4506) in
                {4171}out(c, (pkCli_3846,m1_4507));
                {4172}in(c, em2_4508: bitstring);
                {4173}let m2_4509: bitstring = em2_4508 in
                {4174}let (=OpenSecureChannelResponse,wNs_4510: bitstring,ST_4511: bitstring,TTL_4512: bitstring) = m2_4509 in
                {4175}let Ns_4513: bitstring = dec(wNs_4510,skCli_3845) in
                {4176}let Kcli_4514: bitstring = h((Nc_4505,Ns_4513)) in
                {4177}out(c, senc(mCli(pkCli_3846,pkSess_4502),Kcli_4514))
) | (
    {4178}!
    {4179}in(c, (Cli_4515: host,Disco_4516: host,Sess_4517: host));
    {4180}let v_4518: bool = (Disco_4516 = A) in
    (
        {4181}if v_4518 then
        (
            {4182}let skDisco: bitstring = skA in
            {4183}let pkDisco_4519: bitstring = pub(skDisco) in
            {4184}let v_4520: bool = (Cli_4515 = A) in
            (
                {4185}if v_4520 then
                (
                    {4186}let pkCli_4521: bitstring = pub(skA) in
                    {4187}let v_4522: bool = (Sess_4517 = A) in
                    (
                        {4188}if v_4522 then
                        (
                            {4189}let pkSess_4523: bitstring = pub(skA) in
                            {4190}in(c, =GetEndpointRequest);
                            {4191}new SP_4524: bitstring;
                            {4192}new UP_4525: bitstring;
                            {4193}out(c, (GetEndpointResponse,pkSess_4523,None,SP_4524,UP_4525))
                        )
                        else
                            {4194}let v_4526: bool = (Sess_4517 = B) in
                            (
                                {4195}if v_4526 then
                                (
                                    {4196}let pkSess_4527: bitstring = pub(skB) in
                                    {4197}in(c, =GetEndpointRequest);
                                    {4198}new SP_4528: bitstring;
                                    {4199}new UP_4529: bitstring;
                                    {4200}out(c, (GetEndpointResponse,pkSess_4527,None,SP_4528,UP_4529))
                                )
                                else
                                    {4201}let v_4530: bool = (Sess_4517 = C) in
                                    (
                                        {4202}if v_4530 then
                                        (
                                            {4203}let pkSess_4531: bitstring = pub(skC) in
                                            {4204}in(c, =GetEndpointRequest);
                                            {4205}new SP_4532: bitstring;
                                            {4206}new UP_4533: bitstring;
                                            {4207}out(c, (GetEndpointResponse,pkSess_4531,None,SP_4532,UP_4533))
                                        )
                                        else
                                            {4208}let pkSess_4534: bitstring = pub(sk(Sess_4517)) in
                                            {4209}in(c, =GetEndpointRequest);
                                            {4210}new SP_4535: bitstring;
                                            {4211}new UP_4536: bitstring;
                                            {4212}out(c, (GetEndpointResponse,pkSess_4534,None,SP_4535,UP_4536))
                                    )
                                    else
                                        {4213}let pkSess_4537: bitstring = fail-any in
                                        {4214}in(c, =GetEndpointRequest);
                                        {4215}new SP_4538: bitstring;
                                        {4216}new UP_4539: bitstring;
                                        {4217}out(c, (GetEndpointResponse,pkSess_4537,None,SP_4538,UP_4539))
                            )
                            else
                                {4218}let pkSess_4540: bitstring = fail-any in
                                {4219}in(c, =GetEndpointRequest);
                                {4220}new SP_4541: bitstring;
                                {4221}new UP_4542: bitstring;
                                {4222}out(c, (GetEndpointResponse,pkSess_4540,None,SP_4541,UP_4542))
                    )
                    else
                        {4223}let pkSess_4543: bitstring = fail-any in
                        {4224}in(c, =GetEndpointRequest);
                        {4225}new SP_4544: bitstring;
                        {4226}new UP_4545: bitstring;
                        {4227}out(c, (GetEndpointResponse,pkSess_4543,None,SP_4544,UP_4545))
                )
                else
                    {4228}let v_4546: bool = (Cli_4515 = B) in
                    (
                        {4229}if v_4546 then
                        (
                            {4230}let pkCli_4547: bitstring = pub(skB) in
                            {4231}let v_4548: bool = (Sess_4517 = A) in
                            (
                                {4232}if v_4548 then
                                (
                                    {4233}let pkSess_4549: bitstring = pub(skA) in
                                    {4234}in(c, =GetEndpointRequest);
                                    {4235}new SP_4550: bitstring;
                                    {4236}new UP_4551: bitstring;
                                    {4237}out(c, (GetEndpointResponse,pkSess_4549,None,SP_4550,UP_4551))
                                )
                                else
                                    {4238}let v_4552: bool = (Sess_4517 = B) in
                                    (
                                        {4239}if v_4552 then
                                        (
                                            {4240}let pkSess_4553: bitstring = pub(skB) in
                                            {4241}in(c, =GetEndpointRequest);
                                            {4242}new SP_4554: bitstring;
                                            {4243}new UP_4555: bitstring;
                                            {4244}out(c, (GetEndpointResponse,pkSess_4553,None,SP_4554,UP_4555))
                                        )
                                        else
                                            {4245}let v_4556: bool = (Sess_4517 = C) in
                                            (
                                                {4246}if v_4556 then
                                                (
                                                    {4247}let pkSess_4557: bitstring = pub(skC) in
                                                    {4248}in(c, =GetEndpointRequest);
                                                    {4249}new SP_4558: bitstring;
                                                    {4250}new UP_4559: bitstring;
                                                    {4251}out(c, (GetEndpointResponse,pkSess_4557,None,SP_4558,UP_4559))
                                                )
                                                else
                                                    {4252}let pkSess_4560: bitstring = pub(sk(Sess_4517)) in
                                                    {4253}in(c, =GetEndpointRequest);
                                                    {4254}new SP_4561: bitstring;
                                                    {4255}new UP_4562: bitstring;
                                                    {4256}out(c, (GetEndpointResponse,pkSess_4560,None,SP_4561,UP_4562))
                                            )
                                            else
                                                {4257}let pkSess_4563: bitstring = fail-any in
                                                {4258}in(c, =GetEndpointRequest);
                                                {4259}new SP_4564: bitstring;
                                                {4260}new UP_4565: bitstring;
                                                {4261}out(c, (GetEndpointResponse,pkSess_4563,None,SP_4564,UP_4565))
                                    )
                                    else
                                        {4262}let pkSess_4566: bitstring = fail-any in
                                        {4263}in(c, =GetEndpointRequest);
                                        {4264}new SP_4567: bitstring;
                                        {4265}new UP_4568: bitstring;
                                        {4266}out(c, (GetEndpointResponse,pkSess_4566,None,SP_4567,UP_4568))
                            )
                            else
                                {4267}let pkSess_4569: bitstring = fail-any in
                                {4268}in(c, =GetEndpointRequest);
                                {4269}new SP_4570: bitstring;
                                {4270}new UP_4571: bitstring;
                                {4271}out(c, (GetEndpointResponse,pkSess_4569,None,SP_4570,UP_4571))
                        )
                        else
                            {4272}let v_4572: bool = (Cli_4515 = C) in
                            (
                                {4273}if v_4572 then
                                (
                                    {4274}let pkCli_4573: bitstring = pub(skC) in
                                    {4275}let v_4574: bool = (Sess_4517 = A) in
                                    (
                                        {4276}if v_4574 then
                                        (
                                            {4277}let pkSess_4575: bitstring = pub(skA) in
                                            {4278}in(c, =GetEndpointRequest);
                                            {4279}new SP_4576: bitstring;
                                            {4280}new UP_4577: bitstring;
                                            {4281}out(c, (GetEndpointResponse,pkSess_4575,None,SP_4576,UP_4577))
                                        )
                                        else
                                            {4282}let v_4578: bool = (Sess_4517 = B) in
                                            (
                                                {4283}if v_4578 then
                                                (
                                                    {4284}let pkSess_4579: bitstring = pub(skB) in
                                                    {4285}in(c, =GetEndpointRequest);
                                                    {4286}new SP_4580: bitstring;
                                                    {4287}new UP_4581: bitstring;
                                                    {4288}out(c, (GetEndpointResponse,pkSess_4579,None,SP_4580,UP_4581))
                                                )
                                                else
                                                    {4289}let v_4582: bool = (Sess_4517 = C) in
                                                    (
                                                        {4290}if v_4582 then
                                                        (
                                                            {4291}let pkSess_4583: bitstring = pub(skC) in
                                                            {4292}in(c, =GetEndpointRequest);
                                                            {4293}new SP_4584: bitstring;
                                                            {4294}new UP_4585: bitstring;
                                                            {4295}out(c, (GetEndpointResponse,pkSess_4583,None,SP_4584,UP_4585))
                                                        )
                                                        else
                                                            {4296}let pkSess_4586: bitstring = pub(sk(Sess_4517)) in
                                                            {4297}in(c, =GetEndpointRequest);
                                                            {4298}new SP_4587: bitstring;
                                                            {4299}new UP_4588: bitstring;
                                                            {4300}out(c, (GetEndpointResponse,pkSess_4586,None,SP_4587,UP_4588))
                                                    )
                                                    else
                                                        {4301}let pkSess_4589: bitstring = fail-any in
                                                        {4302}in(c, =GetEndpointRequest);
                                                        {4303}new SP_4590: bitstring;
                                                        {4304}new UP_4591: bitstring;
                                                        {4305}out(c, (GetEndpointResponse,pkSess_4589,None,SP_4590,UP_4591))
                                            )
                                            else
                                                {4306}let pkSess_4592: bitstring = fail-any in
                                                {4307}in(c, =GetEndpointRequest);
                                                {4308}new SP_4593: bitstring;
                                                {4309}new UP_4594: bitstring;
                                                {4310}out(c, (GetEndpointResponse,pkSess_4592,None,SP_4593,UP_4594))
                                    )
                                    else
                                        {4311}let pkSess_4595: bitstring = fail-any in
                                        {4312}in(c, =GetEndpointRequest);
                                        {4313}new SP_4596: bitstring;
                                        {4314}new UP_4597: bitstring;
                                        {4315}out(c, (GetEndpointResponse,pkSess_4595,None,SP_4596,UP_4597))
                                )
                                else
                                    {4316}let pkCli_4598: bitstring = pub(sk(Cli_4515)) in
                                    {4317}let v_4599: bool = (Sess_4517 = A) in
                                    (
                                        {4318}if v_4599 then
                                        (
                                            {4319}let pkSess_4600: bitstring = pub(skA) in
                                            {4320}in(c, =GetEndpointRequest);
                                            {4321}new SP_4601: bitstring;
                                            {4322}new UP_4602: bitstring;
                                            {4323}out(c, (GetEndpointResponse,pkSess_4600,None,SP_4601,UP_4602))
                                        )
                                        else
                                            {4324}let v_4603: bool = (Sess_4517 = B) in
                                            (
                                                {4325}if v_4603 then
                                                (
                                                    {4326}let pkSess_4604: bitstring = pub(skB) in
                                                    {4327}in(c, =GetEndpointRequest);
                                                    {4328}new SP_4605: bitstring;
                                                    {4329}new UP_4606: bitstring;
                                                    {4330}out(c, (GetEndpointResponse,pkSess_4604,None,SP_4605,UP_4606))
                                                )
                                                else
                                                    {4331}let v_4607: bool = (Sess_4517 = C) in
                                                    (
                                                        {4332}if v_4607 then
                                                        (
                                                            {4333}let pkSess_4608: bitstring = pub(skC) in
                                                            {4334}in(c, =GetEndpointRequest);
                                                            {4335}new SP_4609: bitstring;
                                                            {4336}new UP_4610: bitstring;
                                                            {4337}out(c, (GetEndpointResponse,pkSess_4608,None,SP_4609,UP_4610))
                                                        )
                                                        else
                                                            {4338}let pkSess_4611: bitstring = pub(sk(Sess_4517)) in
                                                            {4339}in(c, =GetEndpointRequest);
                                                            {4340}new SP_4612: bitstring;
                                                            {4341}new UP_4613: bitstring;
                                                            {4342}out(c, (GetEndpointResponse,pkSess_4611,None,SP_4612,UP_4613))
                                                    )
                                                    else
                                                        {4343}let pkSess_4614: bitstring = fail-any in
                                                        {4344}in(c, =GetEndpointRequest);
                                                        {4345}new SP_4615: bitstring;
                                                        {4346}new UP_4616: bitstring;
                                                        {4347}out(c, (GetEndpointResponse,pkSess_4614,None,SP_4615,UP_4616))
                                            )
                                            else
                                                {4348}let pkSess_4617: bitstring = fail-any in
                                                {4349}in(c, =GetEndpointRequest);
                                                {4350}new SP_4618: bitstring;
                                                {4351}new UP_4619: bitstring;
                                                {4352}out(c, (GetEndpointResponse,pkSess_4617,None,SP_4618,UP_4619))
                                    )
                                    else
                                        {4353}let pkSess_4620: bitstring = fail-any in
                                        {4354}in(c, =GetEndpointRequest);
                                        {4355}new SP_4621: bitstring;
                                        {4356}new UP_4622: bitstring;
                                        {4357}out(c, (GetEndpointResponse,pkSess_4620,None,SP_4621,UP_4622))
                            )
                            else
                                {4358}let pkCli_4623: bitstring = fail-any in
                                {4359}let v_4624: bool = (Sess_4517 = A) in
                                (
                                    {4360}if v_4624 then
                                    (
                                        {4361}let pkSess_4625: bitstring = pub(skA) in
                                        {4362}in(c, =GetEndpointRequest);
                                        {4363}new SP_4626: bitstring;
                                        {4364}new UP_4627: bitstring;
                                        {4365}out(c, (GetEndpointResponse,pkSess_4625,None,SP_4626,UP_4627))
                                    )
                                    else
                                        {4366}let v_4628: bool = (Sess_4517 = B) in
                                        (
                                            {4367}if v_4628 then
                                            (
                                                {4368}let pkSess_4629: bitstring = pub(skB) in
                                                {4369}in(c, =GetEndpointRequest);
                                                {4370}new SP_4630: bitstring;
                                                {4371}new UP_4631: bitstring;
                                                {4372}out(c, (GetEndpointResponse,pkSess_4629,None,SP_4630,UP_4631))
                                            )
                                            else
                                                {4373}let v_4632: bool = (Sess_4517 = C) in
                                                (
                                                    {4374}if v_4632 then
                                                    (
                                                        {4375}let pkSess_4633: bitstring = pub(skC) in
                                                        {4376}in(c, =GetEndpointRequest);
                                                        {4377}new SP_4634: bitstring;
                                                        {4378}new UP_4635: bitstring;
                                                        {4379}out(c, (GetEndpointResponse,pkSess_4633,None,SP_4634,UP_4635))
                                                    )
                                                    else
                                                        {4380}let pkSess_4636: bitstring = pub(sk(Sess_4517)) in
                                                        {4381}in(c, =GetEndpointRequest);
                                                        {4382}new SP_4637: bitstring;
                                                        {4383}new UP_4638: bitstring;
                                                        {4384}out(c, (GetEndpointResponse,pkSess_4636,None,SP_4637,UP_4638))
                                                )
                                                else
                                                    {4385}let pkSess_4639: bitstring = fail-any in
                                                    {4386}in(c, =GetEndpointRequest);
                                                    {4387}new SP_4640: bitstring;
                                                    {4388}new UP_4641: bitstring;
                                                    {4389}out(c, (GetEndpointResponse,pkSess_4639,None,SP_4640,UP_4641))
                                        )
                                        else
                                            {4390}let pkSess_4642: bitstring = fail-any in
                                            {4391}in(c, =GetEndpointRequest);
                                            {4392}new SP_4643: bitstring;
                                            {4393}new UP_4644: bitstring;
                                            {4394}out(c, (GetEndpointResponse,pkSess_4642,None,SP_4643,UP_4644))
                                )
                                else
                                    {4395}let pkSess_4645: bitstring = fail-any in
                                    {4396}in(c, =GetEndpointRequest);
                                    {4397}new SP_4646: bitstring;
                                    {4398}new UP_4647: bitstring;
                                    {4399}out(c, (GetEndpointResponse,pkSess_4645,None,SP_4646,UP_4647))
                    )
                    else
                        {4400}let pkCli_4648: bitstring = fail-any in
                        {4401}let v_4649: bool = (Sess_4517 = A) in
                        (
                            {4402}if v_4649 then
                            (
                                {4403}let pkSess_4650: bitstring = pub(skA) in
                                {4404}in(c, =GetEndpointRequest);
                                {4405}new SP_4651: bitstring;
                                {4406}new UP_4652: bitstring;
                                {4407}out(c, (GetEndpointResponse,pkSess_4650,None,SP_4651,UP_4652))
                            )
                            else
                                {4408}let v_4653: bool = (Sess_4517 = B) in
                                (
                                    {4409}if v_4653 then
                                    (
                                        {4410}let pkSess_4654: bitstring = pub(skB) in
                                        {4411}in(c, =GetEndpointRequest);
                                        {4412}new SP_4655: bitstring;
                                        {4413}new UP_4656: bitstring;
                                        {4414}out(c, (GetEndpointResponse,pkSess_4654,None,SP_4655,UP_4656))
                                    )
                                    else
                                        {4415}let v_4657: bool = (Sess_4517 = C) in
                                        (
                                            {4416}if v_4657 then
                                            (
                                                {4417}let pkSess_4658: bitstring = pub(skC) in
                                                {4418}in(c, =GetEndpointRequest);
                                                {4419}new SP_4659: bitstring;
                                                {4420}new UP_4660: bitstring;
                                                {4421}out(c, (GetEndpointResponse,pkSess_4658,None,SP_4659,UP_4660))
                                            )
                                            else
                                                {4422}let pkSess_4661: bitstring = pub(sk(Sess_4517)) in
                                                {4423}in(c, =GetEndpointRequest);
                                                {4424}new SP_4662: bitstring;
                                                {4425}new UP_4663: bitstring;
                                                {4426}out(c, (GetEndpointResponse,pkSess_4661,None,SP_4662,UP_4663))
                                        )
                                        else
                                            {4427}let pkSess_4664: bitstring = fail-any in
                                            {4428}in(c, =GetEndpointRequest);
                                            {4429}new SP_4665: bitstring;
                                            {4430}new UP_4666: bitstring;
                                            {4431}out(c, (GetEndpointResponse,pkSess_4664,None,SP_4665,UP_4666))
                                )
                                else
                                    {4432}let pkSess_4667: bitstring = fail-any in
                                    {4433}in(c, =GetEndpointRequest);
                                    {4434}new SP_4668: bitstring;
                                    {4435}new UP_4669: bitstring;
                                    {4436}out(c, (GetEndpointResponse,pkSess_4667,None,SP_4668,UP_4669))
                        )
                        else
                            {4437}let pkSess_4670: bitstring = fail-any in
                            {4438}in(c, =GetEndpointRequest);
                            {4439}new SP_4671: bitstring;
                            {4440}new UP_4672: bitstring;
                            {4441}out(c, (GetEndpointResponse,pkSess_4670,None,SP_4671,UP_4672))
            )
            else
                {4442}let pkCli_4673: bitstring = fail-any in
                {4443}let v_4674: bool = (Sess_4517 = A) in
                (
                    {4444}if v_4674 then
                    (
                        {4445}let pkSess_4675: bitstring = pub(skA) in
                        {4446}in(c, =GetEndpointRequest);
                        {4447}new SP_4676: bitstring;
                        {4448}new UP_4677: bitstring;
                        {4449}out(c, (GetEndpointResponse,pkSess_4675,None,SP_4676,UP_4677))
                    )
                    else
                        {4450}let v_4678: bool = (Sess_4517 = B) in
                        (
                            {4451}if v_4678 then
                            (
                                {4452}let pkSess_4679: bitstring = pub(skB) in
                                {4453}in(c, =GetEndpointRequest);
                                {4454}new SP_4680: bitstring;
                                {4455}new UP_4681: bitstring;
                                {4456}out(c, (GetEndpointResponse,pkSess_4679,None,SP_4680,UP_4681))
                            )
                            else
                                {4457}let v_4682: bool = (Sess_4517 = C) in
                                (
                                    {4458}if v_4682 then
                                    (
                                        {4459}let pkSess_4683: bitstring = pub(skC) in
                                        {4460}in(c, =GetEndpointRequest);
                                        {4461}new SP_4684: bitstring;
                                        {4462}new UP_4685: bitstring;
                                        {4463}out(c, (GetEndpointResponse,pkSess_4683,None,SP_4684,UP_4685))
                                    )
                                    else
                                        {4464}let pkSess_4686: bitstring = pub(sk(Sess_4517)) in
                                        {4465}in(c, =GetEndpointRequest);
                                        {4466}new SP_4687: bitstring;
                                        {4467}new UP_4688: bitstring;
                                        {4468}out(c, (GetEndpointResponse,pkSess_4686,None,SP_4687,UP_4688))
                                )
                                else
                                    {4469}let pkSess_4689: bitstring = fail-any in
                                    {4470}in(c, =GetEndpointRequest);
                                    {4471}new SP_4690: bitstring;
                                    {4472}new UP_4691: bitstring;
                                    {4473}out(c, (GetEndpointResponse,pkSess_4689,None,SP_4690,UP_4691))
                        )
                        else
                            {4474}let pkSess_4692: bitstring = fail-any in
                            {4475}in(c, =GetEndpointRequest);
                            {4476}new SP_4693: bitstring;
                            {4477}new UP_4694: bitstring;
                            {4478}out(c, (GetEndpointResponse,pkSess_4692,None,SP_4693,UP_4694))
                )
                else
                    {4479}let pkSess_4695: bitstring = fail-any in
                    {4480}in(c, =GetEndpointRequest);
                    {4481}new SP_4696: bitstring;
                    {4482}new UP_4697: bitstring;
                    {4483}out(c, (GetEndpointResponse,pkSess_4695,None,SP_4696,UP_4697))
        )
        else
            {4484}let v_4698: bool = (Disco_4516 = B) in
            (
                {4485}if v_4698 then
                (
                    {4486}let skDisco_4699: bitstring = skB in
                    {4487}let pkDisco_4700: bitstring = pub(skDisco_4699) in
                    {4488}let v_4701: bool = (Cli_4515 = A) in
                    (
                        {4489}if v_4701 then
                        (
                            {4490}let pkCli_4702: bitstring = pub(skA) in
                            {4491}let v_4703: bool = (Sess_4517 = A) in
                            (
                                {4492}if v_4703 then
                                (
                                    {4493}let pkSess_4704: bitstring = pub(skA) in
                                    {4494}in(c, =GetEndpointRequest);
                                    {4495}new SP_4705: bitstring;
                                    {4496}new UP_4706: bitstring;
                                    {4497}out(c, (GetEndpointResponse,pkSess_4704,None,SP_4705,UP_4706))
                                )
                                else
                                    {4498}let v_4707: bool = (Sess_4517 = B) in
                                    (
                                        {4499}if v_4707 then
                                        (
                                            {4500}let pkSess_4708: bitstring = pub(skB) in
                                            {4501}in(c, =GetEndpointRequest);
                                            {4502}new SP_4709: bitstring;
                                            {4503}new UP_4710: bitstring;
                                            {4504}out(c, (GetEndpointResponse,pkSess_4708,None,SP_4709,UP_4710))
                                        )
                                        else
                                            {4505}let v_4711: bool = (Sess_4517 = C) in
                                            (
                                                {4506}if v_4711 then
                                                (
                                                    {4507}let pkSess_4712: bitstring = pub(skC) in
                                                    {4508}in(c, =GetEndpointRequest);
                                                    {4509}new SP_4713: bitstring;
                                                    {4510}new UP_4714: bitstring;
                                                    {4511}out(c, (GetEndpointResponse,pkSess_4712,None,SP_4713,UP_4714))
                                                )
                                                else
                                                    {4512}let pkSess_4715: bitstring = pub(sk(Sess_4517)) in
                                                    {4513}in(c, =GetEndpointRequest);
                                                    {4514}new SP_4716: bitstring;
                                                    {4515}new UP_4717: bitstring;
                                                    {4516}out(c, (GetEndpointResponse,pkSess_4715,None,SP_4716,UP_4717))
                                            )
                                            else
                                                {4517}let pkSess_4718: bitstring = fail-any in
                                                {4518}in(c, =GetEndpointRequest);
                                                {4519}new SP_4719: bitstring;
                                                {4520}new UP_4720: bitstring;
                                                {4521}out(c, (GetEndpointResponse,pkSess_4718,None,SP_4719,UP_4720))
                                    )
                                    else
                                        {4522}let pkSess_4721: bitstring = fail-any in
                                        {4523}in(c, =GetEndpointRequest);
                                        {4524}new SP_4722: bitstring;
                                        {4525}new UP_4723: bitstring;
                                        {4526}out(c, (GetEndpointResponse,pkSess_4721,None,SP_4722,UP_4723))
                            )
                            else
                                {4527}let pkSess_4724: bitstring = fail-any in
                                {4528}in(c, =GetEndpointRequest);
                                {4529}new SP_4725: bitstring;
                                {4530}new UP_4726: bitstring;
                                {4531}out(c, (GetEndpointResponse,pkSess_4724,None,SP_4725,UP_4726))
                        )
                        else
                            {4532}let v_4727: bool = (Cli_4515 = B) in
                            (
                                {4533}if v_4727 then
                                (
                                    {4534}let pkCli_4728: bitstring = pub(skB) in
                                    {4535}let v_4729: bool = (Sess_4517 = A) in
                                    (
                                        {4536}if v_4729 then
                                        (
                                            {4537}let pkSess_4730: bitstring = pub(skA) in
                                            {4538}in(c, =GetEndpointRequest);
                                            {4539}new SP_4731: bitstring;
                                            {4540}new UP_4732: bitstring;
                                            {4541}out(c, (GetEndpointResponse,pkSess_4730,None,SP_4731,UP_4732))
                                        )
                                        else
                                            {4542}let v_4733: bool = (Sess_4517 = B) in
                                            (
                                                {4543}if v_4733 then
                                                (
                                                    {4544}let pkSess_4734: bitstring = pub(skB) in
                                                    {4545}in(c, =GetEndpointRequest);
                                                    {4546}new SP_4735: bitstring;
                                                    {4547}new UP_4736: bitstring;
                                                    {4548}out(c, (GetEndpointResponse,pkSess_4734,None,SP_4735,UP_4736))
                                                )
                                                else
                                                    {4549}let v_4737: bool = (Sess_4517 = C) in
                                                    (
                                                        {4550}if v_4737 then
                                                        (
                                                            {4551}let pkSess_4738: bitstring = pub(skC) in
                                                            {4552}in(c, =GetEndpointRequest);
                                                            {4553}new SP_4739: bitstring;
                                                            {4554}new UP_4740: bitstring;
                                                            {4555}out(c, (GetEndpointResponse,pkSess_4738,None,SP_4739,UP_4740))
                                                        )
                                                        else
                                                            {4556}let pkSess_4741: bitstring = pub(sk(Sess_4517)) in
                                                            {4557}in(c, =GetEndpointRequest);
                                                            {4558}new SP_4742: bitstring;
                                                            {4559}new UP_4743: bitstring;
                                                            {4560}out(c, (GetEndpointResponse,pkSess_4741,None,SP_4742,UP_4743))
                                                    )
                                                    else
                                                        {4561}let pkSess_4744: bitstring = fail-any in
                                                        {4562}in(c, =GetEndpointRequest);
                                                        {4563}new SP_4745: bitstring;
                                                        {4564}new UP_4746: bitstring;
                                                        {4565}out(c, (GetEndpointResponse,pkSess_4744,None,SP_4745,UP_4746))
                                            )
                                            else
                                                {4566}let pkSess_4747: bitstring = fail-any in
                                                {4567}in(c, =GetEndpointRequest);
                                                {4568}new SP_4748: bitstring;
                                                {4569}new UP_4749: bitstring;
                                                {4570}out(c, (GetEndpointResponse,pkSess_4747,None,SP_4748,UP_4749))
                                    )
                                    else
                                        {4571}let pkSess_4750: bitstring = fail-any in
                                        {4572}in(c, =GetEndpointRequest);
                                        {4573}new SP_4751: bitstring;
                                        {4574}new UP_4752: bitstring;
                                        {4575}out(c, (GetEndpointResponse,pkSess_4750,None,SP_4751,UP_4752))
                                )
                                else
                                    {4576}let v_4753: bool = (Cli_4515 = C) in
                                    (
                                        {4577}if v_4753 then
                                        (
                                            {4578}let pkCli_4754: bitstring = pub(skC) in
                                            {4579}let v_4755: bool = (Sess_4517 = A) in
                                            (
                                                {4580}if v_4755 then
                                                (
                                                    {4581}let pkSess_4756: bitstring = pub(skA) in
                                                    {4582}in(c, =GetEndpointRequest);
                                                    {4583}new SP_4757: bitstring;
                                                    {4584}new UP_4758: bitstring;
                                                    {4585}out(c, (GetEndpointResponse,pkSess_4756,None,SP_4757,UP_4758))
                                                )
                                                else
                                                    {4586}let v_4759: bool = (Sess_4517 = B) in
                                                    (
                                                        {4587}if v_4759 then
                                                        (
                                                            {4588}let pkSess_4760: bitstring = pub(skB) in
                                                            {4589}in(c, =GetEndpointRequest);
                                                            {4590}new SP_4761: bitstring;
                                                            {4591}new UP_4762: bitstring;
                                                            {4592}out(c, (GetEndpointResponse,pkSess_4760,None,SP_4761,UP_4762))
                                                        )
                                                        else
                                                            {4593}let v_4763: bool = (Sess_4517 = C) in
                                                            (
                                                                {4594}if v_4763 then
                                                                (
                                                                    {4595}let pkSess_4764: bitstring = pub(skC) in
                                                                    {4596}in(c, =GetEndpointRequest);
                                                                    {4597}new SP_4765: bitstring;
                                                                    {4598}new UP_4766: bitstring;
                                                                    {4599}out(c, (GetEndpointResponse,pkSess_4764,None,SP_4765,UP_4766))
                                                                )
                                                                else
                                                                    {4600}let pkSess_4767: bitstring = pub(sk(Sess_4517)) in
                                                                    {4601}in(c, =GetEndpointRequest);
                                                                    {4602}new SP_4768: bitstring;
                                                                    {4603}new UP_4769: bitstring;
                                                                    {4604}out(c, (GetEndpointResponse,pkSess_4767,None,SP_4768,UP_4769))
                                                            )
                                                            else
                                                                {4605}let pkSess_4770: bitstring = fail-any in
                                                                {4606}in(c, =GetEndpointRequest);
                                                                {4607}new SP_4771: bitstring;
                                                                {4608}new UP_4772: bitstring;
                                                                {4609}out(c, (GetEndpointResponse,pkSess_4770,None,SP_4771,UP_4772))
                                                    )
                                                    else
                                                        {4610}let pkSess_4773: bitstring = fail-any in
                                                        {4611}in(c, =GetEndpointRequest);
                                                        {4612}new SP_4774: bitstring;
                                                        {4613}new UP_4775: bitstring;
                                                        {4614}out(c, (GetEndpointResponse,pkSess_4773,None,SP_4774,UP_4775))
                                            )
                                            else
                                                {4615}let pkSess_4776: bitstring = fail-any in
                                                {4616}in(c, =GetEndpointRequest);
                                                {4617}new SP_4777: bitstring;
                                                {4618}new UP_4778: bitstring;
                                                {4619}out(c, (GetEndpointResponse,pkSess_4776,None,SP_4777,UP_4778))
                                        )
                                        else
                                            {4620}let pkCli_4779: bitstring = pub(sk(Cli_4515)) in
                                            {4621}let v_4780: bool = (Sess_4517 = A) in
                                            (
                                                {4622}if v_4780 then
                                                (
                                                    {4623}let pkSess_4781: bitstring = pub(skA) in
                                                    {4624}in(c, =GetEndpointRequest);
                                                    {4625}new SP_4782: bitstring;
                                                    {4626}new UP_4783: bitstring;
                                                    {4627}out(c, (GetEndpointResponse,pkSess_4781,None,SP_4782,UP_4783))
                                                )
                                                else
                                                    {4628}let v_4784: bool = (Sess_4517 = B) in
                                                    (
                                                        {4629}if v_4784 then
                                                        (
                                                            {4630}let pkSess_4785: bitstring = pub(skB) in
                                                            {4631}in(c, =GetEndpointRequest);
                                                            {4632}new SP_4786: bitstring;
                                                            {4633}new UP_4787: bitstring;
                                                            {4634}out(c, (GetEndpointResponse,pkSess_4785,None,SP_4786,UP_4787))
                                                        )
                                                        else
                                                            {4635}let v_4788: bool = (Sess_4517 = C) in
                                                            (
                                                                {4636}if v_4788 then
                                                                (
                                                                    {4637}let pkSess_4789: bitstring = pub(skC) in
                                                                    {4638}in(c, =GetEndpointRequest);
                                                                    {4639}new SP_4790: bitstring;
                                                                    {4640}new UP_4791: bitstring;
                                                                    {4641}out(c, (GetEndpointResponse,pkSess_4789,None,SP_4790,UP_4791))
                                                                )
                                                                else
                                                                    {4642}let pkSess_4792: bitstring = pub(sk(Sess_4517)) in
                                                                    {4643}in(c, =GetEndpointRequest);
                                                                    {4644}new SP_4793: bitstring;
                                                                    {4645}new UP_4794: bitstring;
                                                                    {4646}out(c, (GetEndpointResponse,pkSess_4792,None,SP_4793,UP_4794))
                                                            )
                                                            else
                                                                {4647}let pkSess_4795: bitstring = fail-any in
                                                                {4648}in(c, =GetEndpointRequest);
                                                                {4649}new SP_4796: bitstring;
                                                                {4650}new UP_4797: bitstring;
                                                                {4651}out(c, (GetEndpointResponse,pkSess_4795,None,SP_4796,UP_4797))
                                                    )
                                                    else
                                                        {4652}let pkSess_4798: bitstring = fail-any in
                                                        {4653}in(c, =GetEndpointRequest);
                                                        {4654}new SP_4799: bitstring;
                                                        {4655}new UP_4800: bitstring;
                                                        {4656}out(c, (GetEndpointResponse,pkSess_4798,None,SP_4799,UP_4800))
                                            )
                                            else
                                                {4657}let pkSess_4801: bitstring = fail-any in
                                                {4658}in(c, =GetEndpointRequest);
                                                {4659}new SP_4802: bitstring;
                                                {4660}new UP_4803: bitstring;
                                                {4661}out(c, (GetEndpointResponse,pkSess_4801,None,SP_4802,UP_4803))
                                    )
                                    else
                                        {4662}let pkCli_4804: bitstring = fail-any in
                                        {4663}let v_4805: bool = (Sess_4517 = A) in
                                        (
                                            {4664}if v_4805 then
                                            (
                                                {4665}let pkSess_4806: bitstring = pub(skA) in
                                                {4666}in(c, =GetEndpointRequest);
                                                {4667}new SP_4807: bitstring;
                                                {4668}new UP_4808: bitstring;
                                                {4669}out(c, (GetEndpointResponse,pkSess_4806,None,SP_4807,UP_4808))
                                            )
                                            else
                                                {4670}let v_4809: bool = (Sess_4517 = B) in
                                                (
                                                    {4671}if v_4809 then
                                                    (
                                                        {4672}let pkSess_4810: bitstring = pub(skB) in
                                                        {4673}in(c, =GetEndpointRequest);
                                                        {4674}new SP_4811: bitstring;
                                                        {4675}new UP_4812: bitstring;
                                                        {4676}out(c, (GetEndpointResponse,pkSess_4810,None,SP_4811,UP_4812))
                                                    )
                                                    else
                                                        {4677}let v_4813: bool = (Sess_4517 = C) in
                                                        (
                                                            {4678}if v_4813 then
                                                            (
                                                                {4679}let pkSess_4814: bitstring = pub(skC) in
                                                                {4680}in(c, =GetEndpointRequest);
                                                                {4681}new SP_4815: bitstring;
                                                                {4682}new UP_4816: bitstring;
                                                                {4683}out(c, (GetEndpointResponse,pkSess_4814,None,SP_4815,UP_4816))
                                                            )
                                                            else
                                                                {4684}let pkSess_4817: bitstring = pub(sk(Sess_4517)) in
                                                                {4685}in(c, =GetEndpointRequest);
                                                                {4686}new SP_4818: bitstring;
                                                                {4687}new UP_4819: bitstring;
                                                                {4688}out(c, (GetEndpointResponse,pkSess_4817,None,SP_4818,UP_4819))
                                                        )
                                                        else
                                                            {4689}let pkSess_4820: bitstring = fail-any in
                                                            {4690}in(c, =GetEndpointRequest);
                                                            {4691}new SP_4821: bitstring;
                                                            {4692}new UP_4822: bitstring;
                                                            {4693}out(c, (GetEndpointResponse,pkSess_4820,None,SP_4821,UP_4822))
                                                )
                                                else
                                                    {4694}let pkSess_4823: bitstring = fail-any in
                                                    {4695}in(c, =GetEndpointRequest);
                                                    {4696}new SP_4824: bitstring;
                                                    {4697}new UP_4825: bitstring;
                                                    {4698}out(c, (GetEndpointResponse,pkSess_4823,None,SP_4824,UP_4825))
                                        )
                                        else
                                            {4699}let pkSess_4826: bitstring = fail-any in
                                            {4700}in(c, =GetEndpointRequest);
                                            {4701}new SP_4827: bitstring;
                                            {4702}new UP_4828: bitstring;
                                            {4703}out(c, (GetEndpointResponse,pkSess_4826,None,SP_4827,UP_4828))
                            )
                            else
                                {4704}let pkCli_4829: bitstring = fail-any in
                                {4705}let v_4830: bool = (Sess_4517 = A) in
                                (
                                    {4706}if v_4830 then
                                    (
                                        {4707}let pkSess_4831: bitstring = pub(skA) in
                                        {4708}in(c, =GetEndpointRequest);
                                        {4709}new SP_4832: bitstring;
                                        {4710}new UP_4833: bitstring;
                                        {4711}out(c, (GetEndpointResponse,pkSess_4831,None,SP_4832,UP_4833))
                                    )
                                    else
                                        {4712}let v_4834: bool = (Sess_4517 = B) in
                                        (
                                            {4713}if v_4834 then
                                            (
                                                {4714}let pkSess_4835: bitstring = pub(skB) in
                                                {4715}in(c, =GetEndpointRequest);
                                                {4716}new SP_4836: bitstring;
                                                {4717}new UP_4837: bitstring;
                                                {4718}out(c, (GetEndpointResponse,pkSess_4835,None,SP_4836,UP_4837))
                                            )
                                            else
                                                {4719}let v_4838: bool = (Sess_4517 = C) in
                                                (
                                                    {4720}if v_4838 then
                                                    (
                                                        {4721}let pkSess_4839: bitstring = pub(skC) in
                                                        {4722}in(c, =GetEndpointRequest);
                                                        {4723}new SP_4840: bitstring;
                                                        {4724}new UP_4841: bitstring;
                                                        {4725}out(c, (GetEndpointResponse,pkSess_4839,None,SP_4840,UP_4841))
                                                    )
                                                    else
                                                        {4726}let pkSess_4842: bitstring = pub(sk(Sess_4517)) in
                                                        {4727}in(c, =GetEndpointRequest);
                                                        {4728}new SP_4843: bitstring;
                                                        {4729}new UP_4844: bitstring;
                                                        {4730}out(c, (GetEndpointResponse,pkSess_4842,None,SP_4843,UP_4844))
                                                )
                                                else
                                                    {4731}let pkSess_4845: bitstring = fail-any in
                                                    {4732}in(c, =GetEndpointRequest);
                                                    {4733}new SP_4846: bitstring;
                                                    {4734}new UP_4847: bitstring;
                                                    {4735}out(c, (GetEndpointResponse,pkSess_4845,None,SP_4846,UP_4847))
                                        )
                                        else
                                            {4736}let pkSess_4848: bitstring = fail-any in
                                            {4737}in(c, =GetEndpointRequest);
                                            {4738}new SP_4849: bitstring;
                                            {4739}new UP_4850: bitstring;
                                            {4740}out(c, (GetEndpointResponse,pkSess_4848,None,SP_4849,UP_4850))
                                )
                                else
                                    {4741}let pkSess_4851: bitstring = fail-any in
                                    {4742}in(c, =GetEndpointRequest);
                                    {4743}new SP_4852: bitstring;
                                    {4744}new UP_4853: bitstring;
                                    {4745}out(c, (GetEndpointResponse,pkSess_4851,None,SP_4852,UP_4853))
                    )
                    else
                        {4746}let pkCli_4854: bitstring = fail-any in
                        {4747}let v_4855: bool = (Sess_4517 = A) in
                        (
                            {4748}if v_4855 then
                            (
                                {4749}let pkSess_4856: bitstring = pub(skA) in
                                {4750}in(c, =GetEndpointRequest);
                                {4751}new SP_4857: bitstring;
                                {4752}new UP_4858: bitstring;
                                {4753}out(c, (GetEndpointResponse,pkSess_4856,None,SP_4857,UP_4858))
                            )
                            else
                                {4754}let v_4859: bool = (Sess_4517 = B) in
                                (
                                    {4755}if v_4859 then
                                    (
                                        {4756}let pkSess_4860: bitstring = pub(skB) in
                                        {4757}in(c, =GetEndpointRequest);
                                        {4758}new SP_4861: bitstring;
                                        {4759}new UP_4862: bitstring;
                                        {4760}out(c, (GetEndpointResponse,pkSess_4860,None,SP_4861,UP_4862))
                                    )
                                    else
                                        {4761}let v_4863: bool = (Sess_4517 = C) in
                                        (
                                            {4762}if v_4863 then
                                            (
                                                {4763}let pkSess_4864: bitstring = pub(skC) in
                                                {4764}in(c, =GetEndpointRequest);
                                                {4765}new SP_4865: bitstring;
                                                {4766}new UP_4866: bitstring;
                                                {4767}out(c, (GetEndpointResponse,pkSess_4864,None,SP_4865,UP_4866))
                                            )
                                            else
                                                {4768}let pkSess_4867: bitstring = pub(sk(Sess_4517)) in
                                                {4769}in(c, =GetEndpointRequest);
                                                {4770}new SP_4868: bitstring;
                                                {4771}new UP_4869: bitstring;
                                                {4772}out(c, (GetEndpointResponse,pkSess_4867,None,SP_4868,UP_4869))
                                        )
                                        else
                                            {4773}let pkSess_4870: bitstring = fail-any in
                                            {4774}in(c, =GetEndpointRequest);
                                            {4775}new SP_4871: bitstring;
                                            {4776}new UP_4872: bitstring;
                                            {4777}out(c, (GetEndpointResponse,pkSess_4870,None,SP_4871,UP_4872))
                                )
                                else
                                    {4778}let pkSess_4873: bitstring = fail-any in
                                    {4779}in(c, =GetEndpointRequest);
                                    {4780}new SP_4874: bitstring;
                                    {4781}new UP_4875: bitstring;
                                    {4782}out(c, (GetEndpointResponse,pkSess_4873,None,SP_4874,UP_4875))
                        )
                        else
                            {4783}let pkSess_4876: bitstring = fail-any in
                            {4784}in(c, =GetEndpointRequest);
                            {4785}new SP_4877: bitstring;
                            {4786}new UP_4878: bitstring;
                            {4787}out(c, (GetEndpointResponse,pkSess_4876,None,SP_4877,UP_4878))
                )
                else
                    {4788}let =true = (Disco_4516 = C) in
                    (
                        {4789}let skDisco_4879: bitstring = skC in
                        {4790}let pkDisco_4880: bitstring = pub(skDisco_4879) in
                        {4791}let v_4881: bool = (Cli_4515 = A) in
                        (
                            {4792}if v_4881 then
                            (
                                {4793}let pkCli_4882: bitstring = pub(skA) in
                                {4794}let v_4883: bool = (Sess_4517 = A) in
                                (
                                    {4795}if v_4883 then
                                    (
                                        {4796}let pkSess_4884: bitstring = pub(skA) in
                                        {4797}in(c, =GetEndpointRequest);
                                        {4798}new SP_4885: bitstring;
                                        {4799}new UP_4886: bitstring;
                                        {4800}out(c, (GetEndpointResponse,pkSess_4884,None,SP_4885,UP_4886))
                                    )
                                    else
                                        {4801}let v_4887: bool = (Sess_4517 = B) in
                                        (
                                            {4802}if v_4887 then
                                            (
                                                {4803}let pkSess_4888: bitstring = pub(skB) in
                                                {4804}in(c, =GetEndpointRequest);
                                                {4805}new SP_4889: bitstring;
                                                {4806}new UP_4890: bitstring;
                                                {4807}out(c, (GetEndpointResponse,pkSess_4888,None,SP_4889,UP_4890))
                                            )
                                            else
                                                {4808}let v_4891: bool = (Sess_4517 = C) in
                                                (
                                                    {4809}if v_4891 then
                                                    (
                                                        {4810}let pkSess_4892: bitstring = pub(skC) in
                                                        {4811}in(c, =GetEndpointRequest);
                                                        {4812}new SP_4893: bitstring;
                                                        {4813}new UP_4894: bitstring;
                                                        {4814}out(c, (GetEndpointResponse,pkSess_4892,None,SP_4893,UP_4894))
                                                    )
                                                    else
                                                        {4815}let pkSess_4895: bitstring = pub(sk(Sess_4517)) in
                                                        {4816}in(c, =GetEndpointRequest);
                                                        {4817}new SP_4896: bitstring;
                                                        {4818}new UP_4897: bitstring;
                                                        {4819}out(c, (GetEndpointResponse,pkSess_4895,None,SP_4896,UP_4897))
                                                )
                                                else
                                                    {4820}let pkSess_4898: bitstring = fail-any in
                                                    {4821}in(c, =GetEndpointRequest);
                                                    {4822}new SP_4899: bitstring;
                                                    {4823}new UP_4900: bitstring;
                                                    {4824}out(c, (GetEndpointResponse,pkSess_4898,None,SP_4899,UP_4900))
                                        )
                                        else
                                            {4825}let pkSess_4901: bitstring = fail-any in
                                            {4826}in(c, =GetEndpointRequest);
                                            {4827}new SP_4902: bitstring;
                                            {4828}new UP_4903: bitstring;
                                            {4829}out(c, (GetEndpointResponse,pkSess_4901,None,SP_4902,UP_4903))
                                )
                                else
                                    {4830}let pkSess_4904: bitstring = fail-any in
                                    {4831}in(c, =GetEndpointRequest);
                                    {4832}new SP_4905: bitstring;
                                    {4833}new UP_4906: bitstring;
                                    {4834}out(c, (GetEndpointResponse,pkSess_4904,None,SP_4905,UP_4906))
                            )
                            else
                                {4835}let v_4907: bool = (Cli_4515 = B) in
                                (
                                    {4836}if v_4907 then
                                    (
                                        {4837}let pkCli_4908: bitstring = pub(skB) in
                                        {4838}let v_4909: bool = (Sess_4517 = A) in
                                        (
                                            {4839}if v_4909 then
                                            (
                                                {4840}let pkSess_4910: bitstring = pub(skA) in
                                                {4841}in(c, =GetEndpointRequest);
                                                {4842}new SP_4911: bitstring;
                                                {4843}new UP_4912: bitstring;
                                                {4844}out(c, (GetEndpointResponse,pkSess_4910,None,SP_4911,UP_4912))
                                            )
                                            else
                                                {4845}let v_4913: bool = (Sess_4517 = B) in
                                                (
                                                    {4846}if v_4913 then
                                                    (
                                                        {4847}let pkSess_4914: bitstring = pub(skB) in
                                                        {4848}in(c, =GetEndpointRequest);
                                                        {4849}new SP_4915: bitstring;
                                                        {4850}new UP_4916: bitstring;
                                                        {4851}out(c, (GetEndpointResponse,pkSess_4914,None,SP_4915,UP_4916))
                                                    )
                                                    else
                                                        {4852}let v_4917: bool = (Sess_4517 = C) in
                                                        (
                                                            {4853}if v_4917 then
                                                            (
                                                                {4854}let pkSess_4918: bitstring = pub(skC) in
                                                                {4855}in(c, =GetEndpointRequest);
                                                                {4856}new SP_4919: bitstring;
                                                                {4857}new UP_4920: bitstring;
                                                                {4858}out(c, (GetEndpointResponse,pkSess_4918,None,SP_4919,UP_4920))
                                                            )
                                                            else
                                                                {4859}let pkSess_4921: bitstring = pub(sk(Sess_4517)) in
                                                                {4860}in(c, =GetEndpointRequest);
                                                                {4861}new SP_4922: bitstring;
                                                                {4862}new UP_4923: bitstring;
                                                                {4863}out(c, (GetEndpointResponse,pkSess_4921,None,SP_4922,UP_4923))
                                                        )
                                                        else
                                                            {4864}let pkSess_4924: bitstring = fail-any in
                                                            {4865}in(c, =GetEndpointRequest);
                                                            {4866}new SP_4925: bitstring;
                                                            {4867}new UP_4926: bitstring;
                                                            {4868}out(c, (GetEndpointResponse,pkSess_4924,None,SP_4925,UP_4926))
                                                )
                                                else
                                                    {4869}let pkSess_4927: bitstring = fail-any in
                                                    {4870}in(c, =GetEndpointRequest);
                                                    {4871}new SP_4928: bitstring;
                                                    {4872}new UP_4929: bitstring;
                                                    {4873}out(c, (GetEndpointResponse,pkSess_4927,None,SP_4928,UP_4929))
                                        )
                                        else
                                            {4874}let pkSess_4930: bitstring = fail-any in
                                            {4875}in(c, =GetEndpointRequest);
                                            {4876}new SP_4931: bitstring;
                                            {4877}new UP_4932: bitstring;
                                            {4878}out(c, (GetEndpointResponse,pkSess_4930,None,SP_4931,UP_4932))
                                    )
                                    else
                                        {4879}let v_4933: bool = (Cli_4515 = C) in
                                        (
                                            {4880}if v_4933 then
                                            (
                                                {4881}let pkCli_4934: bitstring = pub(skC) in
                                                {4882}let v_4935: bool = (Sess_4517 = A) in
                                                (
                                                    {4883}if v_4935 then
                                                    (
                                                        {4884}let pkSess_4936: bitstring = pub(skA) in
                                                        {4885}in(c, =GetEndpointRequest);
                                                        {4886}new SP_4937: bitstring;
                                                        {4887}new UP_4938: bitstring;
                                                        {4888}out(c, (GetEndpointResponse,pkSess_4936,None,SP_4937,UP_4938))
                                                    )
                                                    else
                                                        {4889}let v_4939: bool = (Sess_4517 = B) in
                                                        (
                                                            {4890}if v_4939 then
                                                            (
                                                                {4891}let pkSess_4940: bitstring = pub(skB) in
                                                                {4892}in(c, =GetEndpointRequest);
                                                                {4893}new SP_4941: bitstring;
                                                                {4894}new UP_4942: bitstring;
                                                                {4895}out(c, (GetEndpointResponse,pkSess_4940,None,SP_4941,UP_4942))
                                                            )
                                                            else
                                                                {4896}let v_4943: bool = (Sess_4517 = C) in
                                                                (
                                                                    {4897}if v_4943 then
                                                                    (
                                                                        {4898}let pkSess_4944: bitstring = pub(skC) in
                                                                        {4899}in(c, =GetEndpointRequest);
                                                                        {4900}new SP_4945: bitstring;
                                                                        {4901}new UP_4946: bitstring;
                                                                        {4902}out(c, (GetEndpointResponse,pkSess_4944,None,SP_4945,UP_4946))
                                                                    )
                                                                    else
                                                                        {4903}let pkSess_4947: bitstring = pub(sk(Sess_4517)) in
                                                                        {4904}in(c, =GetEndpointRequest);
                                                                        {4905}new SP_4948: bitstring;
                                                                        {4906}new UP_4949: bitstring;
                                                                        {4907}out(c, (GetEndpointResponse,pkSess_4947,None,SP_4948,UP_4949))
                                                                )
                                                                else
                                                                    {4908}let pkSess_4950: bitstring = fail-any in
                                                                    {4909}in(c, =GetEndpointRequest);
                                                                    {4910}new SP_4951: bitstring;
                                                                    {4911}new UP_4952: bitstring;
                                                                    {4912}out(c, (GetEndpointResponse,pkSess_4950,None,SP_4951,UP_4952))
                                                        )
                                                        else
                                                            {4913}let pkSess_4953: bitstring = fail-any in
                                                            {4914}in(c, =GetEndpointRequest);
                                                            {4915}new SP_4954: bitstring;
                                                            {4916}new UP_4955: bitstring;
                                                            {4917}out(c, (GetEndpointResponse,pkSess_4953,None,SP_4954,UP_4955))
                                                )
                                                else
                                                    {4918}let pkSess_4956: bitstring = fail-any in
                                                    {4919}in(c, =GetEndpointRequest);
                                                    {4920}new SP_4957: bitstring;
                                                    {4921}new UP_4958: bitstring;
                                                    {4922}out(c, (GetEndpointResponse,pkSess_4956,None,SP_4957,UP_4958))
                                            )
                                            else
                                                {4923}let pkCli_4959: bitstring = pub(sk(Cli_4515)) in
                                                {4924}let v_4960: bool = (Sess_4517 = A) in
                                                (
                                                    {4925}if v_4960 then
                                                    (
                                                        {4926}let pkSess_4961: bitstring = pub(skA) in
                                                        {4927}in(c, =GetEndpointRequest);
                                                        {4928}new SP_4962: bitstring;
                                                        {4929}new UP_4963: bitstring;
                                                        {4930}out(c, (GetEndpointResponse,pkSess_4961,None,SP_4962,UP_4963))
                                                    )
                                                    else
                                                        {4931}let v_4964: bool = (Sess_4517 = B) in
                                                        (
                                                            {4932}if v_4964 then
                                                            (
                                                                {4933}let pkSess_4965: bitstring = pub(skB) in
                                                                {4934}in(c, =GetEndpointRequest);
                                                                {4935}new SP_4966: bitstring;
                                                                {4936}new UP_4967: bitstring;
                                                                {4937}out(c, (GetEndpointResponse,pkSess_4965,None,SP_4966,UP_4967))
                                                            )
                                                            else
                                                                {4938}let v_4968: bool = (Sess_4517 = C) in
                                                                (
                                                                    {4939}if v_4968 then
                                                                    (
                                                                        {4940}let pkSess_4969: bitstring = pub(skC) in
                                                                        {4941}in(c, =GetEndpointRequest);
                                                                        {4942}new SP_4970: bitstring;
                                                                        {4943}new UP_4971: bitstring;
                                                                        {4944}out(c, (GetEndpointResponse,pkSess_4969,None,SP_4970,UP_4971))
                                                                    )
                                                                    else
                                                                        {4945}let pkSess_4972: bitstring = pub(sk(Sess_4517)) in
                                                                        {4946}in(c, =GetEndpointRequest);
                                                                        {4947}new SP_4973: bitstring;
                                                                        {4948}new UP_4974: bitstring;
                                                                        {4949}out(c, (GetEndpointResponse,pkSess_4972,None,SP_4973,UP_4974))
                                                                )
                                                                else
                                                                    {4950}let pkSess_4975: bitstring = fail-any in
                                                                    {4951}in(c, =GetEndpointRequest);
                                                                    {4952}new SP_4976: bitstring;
                                                                    {4953}new UP_4977: bitstring;
                                                                    {4954}out(c, (GetEndpointResponse,pkSess_4975,None,SP_4976,UP_4977))
                                                        )
                                                        else
                                                            {4955}let pkSess_4978: bitstring = fail-any in
                                                            {4956}in(c, =GetEndpointRequest);
                                                            {4957}new SP_4979: bitstring;
                                                            {4958}new UP_4980: bitstring;
                                                            {4959}out(c, (GetEndpointResponse,pkSess_4978,None,SP_4979,UP_4980))
                                                )
                                                else
                                                    {4960}let pkSess_4981: bitstring = fail-any in
                                                    {4961}in(c, =GetEndpointRequest);
                                                    {4962}new SP_4982: bitstring;
                                                    {4963}new UP_4983: bitstring;
                                                    {4964}out(c, (GetEndpointResponse,pkSess_4981,None,SP_4982,UP_4983))
                                        )
                                        else
                                            {4965}let pkCli_4984: bitstring = fail-any in
                                            {4966}let v_4985: bool = (Sess_4517 = A) in
                                            (
                                                {4967}if v_4985 then
                                                (
                                                    {4968}let pkSess_4986: bitstring = pub(skA) in
                                                    {4969}in(c, =GetEndpointRequest);
                                                    {4970}new SP_4987: bitstring;
                                                    {4971}new UP_4988: bitstring;
                                                    {4972}out(c, (GetEndpointResponse,pkSess_4986,None,SP_4987,UP_4988))
                                                )
                                                else
                                                    {4973}let v_4989: bool = (Sess_4517 = B) in
                                                    (
                                                        {4974}if v_4989 then
                                                        (
                                                            {4975}let pkSess_4990: bitstring = pub(skB) in
                                                            {4976}in(c, =GetEndpointRequest);
                                                            {4977}new SP_4991: bitstring;
                                                            {4978}new UP_4992: bitstring;
                                                            {4979}out(c, (GetEndpointResponse,pkSess_4990,None,SP_4991,UP_4992))
                                                        )
                                                        else
                                                            {4980}let v_4993: bool = (Sess_4517 = C) in
                                                            (
                                                                {4981}if v_4993 then
                                                                (
                                                                    {4982}let pkSess_4994: bitstring = pub(skC) in
                                                                    {4983}in(c, =GetEndpointRequest);
                                                                    {4984}new SP_4995: bitstring;
                                                                    {4985}new UP_4996: bitstring;
                                                                    {4986}out(c, (GetEndpointResponse,pkSess_4994,None,SP_4995,UP_4996))
                                                                )
                                                                else
                                                                    {4987}let pkSess_4997: bitstring = pub(sk(Sess_4517)) in
                                                                    {4988}in(c, =GetEndpointRequest);
                                                                    {4989}new SP_4998: bitstring;
                                                                    {4990}new UP_4999: bitstring;
                                                                    {4991}out(c, (GetEndpointResponse,pkSess_4997,None,SP_4998,UP_4999))
                                                            )
                                                            else
                                                                {4992}let pkSess_5000: bitstring = fail-any in
                                                                {4993}in(c, =GetEndpointRequest);
                                                                {4994}new SP_5001: bitstring;
                                                                {4995}new UP_5002: bitstring;
                                                                {4996}out(c, (GetEndpointResponse,pkSess_5000,None,SP_5001,UP_5002))
                                                    )
                                                    else
                                                        {4997}let pkSess_5003: bitstring = fail-any in
                                                        {4998}in(c, =GetEndpointRequest);
                                                        {4999}new SP_5004: bitstring;
                                                        {5000}new UP_5005: bitstring;
                                                        {5001}out(c, (GetEndpointResponse,pkSess_5003,None,SP_5004,UP_5005))
                                            )
                                            else
                                                {5002}let pkSess_5006: bitstring = fail-any in
                                                {5003}in(c, =GetEndpointRequest);
                                                {5004}new SP_5007: bitstring;
                                                {5005}new UP_5008: bitstring;
                                                {5006}out(c, (GetEndpointResponse,pkSess_5006,None,SP_5007,UP_5008))
                                )
                                else
                                    {5007}let pkCli_5009: bitstring = fail-any in
                                    {5008}let v_5010: bool = (Sess_4517 = A) in
                                    (
                                        {5009}if v_5010 then
                                        (
                                            {5010}let pkSess_5011: bitstring = pub(skA) in
                                            {5011}in(c, =GetEndpointRequest);
                                            {5012}new SP_5012: bitstring;
                                            {5013}new UP_5013: bitstring;
                                            {5014}out(c, (GetEndpointResponse,pkSess_5011,None,SP_5012,UP_5013))
                                        )
                                        else
                                            {5015}let v_5014: bool = (Sess_4517 = B) in
                                            (
                                                {5016}if v_5014 then
                                                (
                                                    {5017}let pkSess_5015: bitstring = pub(skB) in
                                                    {5018}in(c, =GetEndpointRequest);
                                                    {5019}new SP_5016: bitstring;
                                                    {5020}new UP_5017: bitstring;
                                                    {5021}out(c, (GetEndpointResponse,pkSess_5015,None,SP_5016,UP_5017))
                                                )
                                                else
                                                    {5022}let v_5018: bool = (Sess_4517 = C) in
                                                    (
                                                        {5023}if v_5018 then
                                                        (
                                                            {5024}let pkSess_5019: bitstring = pub(skC) in
                                                            {5025}in(c, =GetEndpointRequest);
                                                            {5026}new SP_5020: bitstring;
                                                            {5027}new UP_5021: bitstring;
                                                            {5028}out(c, (GetEndpointResponse,pkSess_5019,None,SP_5020,UP_5021))
                                                        )
                                                        else
                                                            {5029}let pkSess_5022: bitstring = pub(sk(Sess_4517)) in
                                                            {5030}in(c, =GetEndpointRequest);
                                                            {5031}new SP_5023: bitstring;
                                                            {5032}new UP_5024: bitstring;
                                                            {5033}out(c, (GetEndpointResponse,pkSess_5022,None,SP_5023,UP_5024))
                                                    )
                                                    else
                                                        {5034}let pkSess_5025: bitstring = fail-any in
                                                        {5035}in(c, =GetEndpointRequest);
                                                        {5036}new SP_5026: bitstring;
                                                        {5037}new UP_5027: bitstring;
                                                        {5038}out(c, (GetEndpointResponse,pkSess_5025,None,SP_5026,UP_5027))
                                            )
                                            else
                                                {5039}let pkSess_5028: bitstring = fail-any in
                                                {5040}in(c, =GetEndpointRequest);
                                                {5041}new SP_5029: bitstring;
                                                {5042}new UP_5030: bitstring;
                                                {5043}out(c, (GetEndpointResponse,pkSess_5028,None,SP_5029,UP_5030))
                                    )
                                    else
                                        {5044}let pkSess_5031: bitstring = fail-any in
                                        {5045}in(c, =GetEndpointRequest);
                                        {5046}new SP_5032: bitstring;
                                        {5047}new UP_5033: bitstring;
                                        {5048}out(c, (GetEndpointResponse,pkSess_5031,None,SP_5032,UP_5033))
                        )
                        else
                            {5049}let pkCli_5034: bitstring = fail-any in
                            {5050}let v_5035: bool = (Sess_4517 = A) in
                            (
                                {5051}if v_5035 then
                                (
                                    {5052}let pkSess_5036: bitstring = pub(skA) in
                                    {5053}in(c, =GetEndpointRequest);
                                    {5054}new SP_5037: bitstring;
                                    {5055}new UP_5038: bitstring;
                                    {5056}out(c, (GetEndpointResponse,pkSess_5036,None,SP_5037,UP_5038))
                                )
                                else
                                    {5057}let v_5039: bool = (Sess_4517 = B) in
                                    (
                                        {5058}if v_5039 then
                                        (
                                            {5059}let pkSess_5040: bitstring = pub(skB) in
                                            {5060}in(c, =GetEndpointRequest);
                                            {5061}new SP_5041: bitstring;
                                            {5062}new UP_5042: bitstring;
                                            {5063}out(c, (GetEndpointResponse,pkSess_5040,None,SP_5041,UP_5042))
                                        )
                                        else
                                            {5064}let v_5043: bool = (Sess_4517 = C) in
                                            (
                                                {5065}if v_5043 then
                                                (
                                                    {5066}let pkSess_5044: bitstring = pub(skC) in
                                                    {5067}in(c, =GetEndpointRequest);
                                                    {5068}new SP_5045: bitstring;
                                                    {5069}new UP_5046: bitstring;
                                                    {5070}out(c, (GetEndpointResponse,pkSess_5044,None,SP_5045,UP_5046))
                                                )
                                                else
                                                    {5071}let pkSess_5047: bitstring = pub(sk(Sess_4517)) in
                                                    {5072}in(c, =GetEndpointRequest);
                                                    {5073}new SP_5048: bitstring;
                                                    {5074}new UP_5049: bitstring;
                                                    {5075}out(c, (GetEndpointResponse,pkSess_5047,None,SP_5048,UP_5049))
                                            )
                                            else
                                                {5076}let pkSess_5050: bitstring = fail-any in
                                                {5077}in(c, =GetEndpointRequest);
                                                {5078}new SP_5051: bitstring;
                                                {5079}new UP_5052: bitstring;
                                                {5080}out(c, (GetEndpointResponse,pkSess_5050,None,SP_5051,UP_5052))
                                    )
                                    else
                                        {5081}let pkSess_5053: bitstring = fail-any in
                                        {5082}in(c, =GetEndpointRequest);
                                        {5083}new SP_5054: bitstring;
                                        {5084}new UP_5055: bitstring;
                                        {5085}out(c, (GetEndpointResponse,pkSess_5053,None,SP_5054,UP_5055))
                            )
                            else
                                {5086}let pkSess_5056: bitstring = fail-any in
                                {5087}in(c, =GetEndpointRequest);
                                {5088}new SP_5057: bitstring;
                                {5089}new UP_5058: bitstring;
                                {5090}out(c, (GetEndpointResponse,pkSess_5056,None,SP_5057,UP_5058))
                    )
                    else
                        {5091}let skDisco_5059: bitstring = fail-any in
                        {5092}let pkDisco_5060: bitstring = pub(skDisco_5059) in
                        {5093}let v_5061: bool = (Cli_4515 = A) in
                        (
                            {5094}if v_5061 then
                            (
                                {5095}let pkCli_5062: bitstring = pub(skA) in
                                {5096}let v_5063: bool = (Sess_4517 = A) in
                                (
                                    {5097}if v_5063 then
                                    (
                                        {5098}let pkSess_5064: bitstring = pub(skA) in
                                        {5099}in(c, =GetEndpointRequest);
                                        {5100}new SP_5065: bitstring;
                                        {5101}new UP_5066: bitstring;
                                        {5102}out(c, (GetEndpointResponse,pkSess_5064,None,SP_5065,UP_5066))
                                    )
                                    else
                                        {5103}let v_5067: bool = (Sess_4517 = B) in
                                        (
                                            {5104}if v_5067 then
                                            (
                                                {5105}let pkSess_5068: bitstring = pub(skB) in
                                                {5106}in(c, =GetEndpointRequest);
                                                {5107}new SP_5069: bitstring;
                                                {5108}new UP_5070: bitstring;
                                                {5109}out(c, (GetEndpointResponse,pkSess_5068,None,SP_5069,UP_5070))
                                            )
                                            else
                                                {5110}let v_5071: bool = (Sess_4517 = C) in
                                                (
                                                    {5111}if v_5071 then
                                                    (
                                                        {5112}let pkSess_5072: bitstring = pub(skC) in
                                                        {5113}in(c, =GetEndpointRequest);
                                                        {5114}new SP_5073: bitstring;
                                                        {5115}new UP_5074: bitstring;
                                                        {5116}out(c, (GetEndpointResponse,pkSess_5072,None,SP_5073,UP_5074))
                                                    )
                                                    else
                                                        {5117}let pkSess_5075: bitstring = pub(sk(Sess_4517)) in
                                                        {5118}in(c, =GetEndpointRequest);
                                                        {5119}new SP_5076: bitstring;
                                                        {5120}new UP_5077: bitstring;
                                                        {5121}out(c, (GetEndpointResponse,pkSess_5075,None,SP_5076,UP_5077))
                                                )
                                                else
                                                    {5122}let pkSess_5078: bitstring = fail-any in
                                                    {5123}in(c, =GetEndpointRequest);
                                                    {5124}new SP_5079: bitstring;
                                                    {5125}new UP_5080: bitstring;
                                                    {5126}out(c, (GetEndpointResponse,pkSess_5078,None,SP_5079,UP_5080))
                                        )
                                        else
                                            {5127}let pkSess_5081: bitstring = fail-any in
                                            {5128}in(c, =GetEndpointRequest);
                                            {5129}new SP_5082: bitstring;
                                            {5130}new UP_5083: bitstring;
                                            {5131}out(c, (GetEndpointResponse,pkSess_5081,None,SP_5082,UP_5083))
                                )
                                else
                                    {5132}let pkSess_5084: bitstring = fail-any in
                                    {5133}in(c, =GetEndpointRequest);
                                    {5134}new SP_5085: bitstring;
                                    {5135}new UP_5086: bitstring;
                                    {5136}out(c, (GetEndpointResponse,pkSess_5084,None,SP_5085,UP_5086))
                            )
                            else
                                {5137}let v_5087: bool = (Cli_4515 = B) in
                                (
                                    {5138}if v_5087 then
                                    (
                                        {5139}let pkCli_5088: bitstring = pub(skB) in
                                        {5140}let v_5089: bool = (Sess_4517 = A) in
                                        (
                                            {5141}if v_5089 then
                                            (
                                                {5142}let pkSess_5090: bitstring = pub(skA) in
                                                {5143}in(c, =GetEndpointRequest);
                                                {5144}new SP_5091: bitstring;
                                                {5145}new UP_5092: bitstring;
                                                {5146}out(c, (GetEndpointResponse,pkSess_5090,None,SP_5091,UP_5092))
                                            )
                                            else
                                                {5147}let v_5093: bool = (Sess_4517 = B) in
                                                (
                                                    {5148}if v_5093 then
                                                    (
                                                        {5149}let pkSess_5094: bitstring = pub(skB) in
                                                        {5150}in(c, =GetEndpointRequest);
                                                        {5151}new SP_5095: bitstring;
                                                        {5152}new UP_5096: bitstring;
                                                        {5153}out(c, (GetEndpointResponse,pkSess_5094,None,SP_5095,UP_5096))
                                                    )
                                                    else
                                                        {5154}let v_5097: bool = (Sess_4517 = C) in
                                                        (
                                                            {5155}if v_5097 then
                                                            (
                                                                {5156}let pkSess_5098: bitstring = pub(skC) in
                                                                {5157}in(c, =GetEndpointRequest);
                                                                {5158}new SP_5099: bitstring;
                                                                {5159}new UP_5100: bitstring;
                                                                {5160}out(c, (GetEndpointResponse,pkSess_5098,None,SP_5099,UP_5100))
                                                            )
                                                            else
                                                                {5161}let pkSess_5101: bitstring = pub(sk(Sess_4517)) in
                                                                {5162}in(c, =GetEndpointRequest);
                                                                {5163}new SP_5102: bitstring;
                                                                {5164}new UP_5103: bitstring;
                                                                {5165}out(c, (GetEndpointResponse,pkSess_5101,None,SP_5102,UP_5103))
                                                        )
                                                        else
                                                            {5166}let pkSess_5104: bitstring = fail-any in
                                                            {5167}in(c, =GetEndpointRequest);
                                                            {5168}new SP_5105: bitstring;
                                                            {5169}new UP_5106: bitstring;
                                                            {5170}out(c, (GetEndpointResponse,pkSess_5104,None,SP_5105,UP_5106))
                                                )
                                                else
                                                    {5171}let pkSess_5107: bitstring = fail-any in
                                                    {5172}in(c, =GetEndpointRequest);
                                                    {5173}new SP_5108: bitstring;
                                                    {5174}new UP_5109: bitstring;
                                                    {5175}out(c, (GetEndpointResponse,pkSess_5107,None,SP_5108,UP_5109))
                                        )
                                        else
                                            {5176}let pkSess_5110: bitstring = fail-any in
                                            {5177}in(c, =GetEndpointRequest);
                                            {5178}new SP_5111: bitstring;
                                            {5179}new UP_5112: bitstring;
                                            {5180}out(c, (GetEndpointResponse,pkSess_5110,None,SP_5111,UP_5112))
                                    )
                                    else
                                        {5181}let v_5113: bool = (Cli_4515 = C) in
                                        (
                                            {5182}if v_5113 then
                                            (
                                                {5183}let pkCli_5114: bitstring = pub(skC) in
                                                {5184}let v_5115: bool = (Sess_4517 = A) in
                                                (
                                                    {5185}if v_5115 then
                                                    (
                                                        {5186}let pkSess_5116: bitstring = pub(skA) in
                                                        {5187}in(c, =GetEndpointRequest);
                                                        {5188}new SP_5117: bitstring;
                                                        {5189}new UP_5118: bitstring;
                                                        {5190}out(c, (GetEndpointResponse,pkSess_5116,None,SP_5117,UP_5118))
                                                    )
                                                    else
                                                        {5191}let v_5119: bool = (Sess_4517 = B) in
                                                        (
                                                            {5192}if v_5119 then
                                                            (
                                                                {5193}let pkSess_5120: bitstring = pub(skB) in
                                                                {5194}in(c, =GetEndpointRequest);
                                                                {5195}new SP_5121: bitstring;
                                                                {5196}new UP_5122: bitstring;
                                                                {5197}out(c, (GetEndpointResponse,pkSess_5120,None,SP_5121,UP_5122))
                                                            )
                                                            else
                                                                {5198}let v_5123: bool = (Sess_4517 = C) in
                                                                (
                                                                    {5199}if v_5123 then
                                                                    (
                                                                        {5200}let pkSess_5124: bitstring = pub(skC) in
                                                                        {5201}in(c, =GetEndpointRequest);
                                                                        {5202}new SP_5125: bitstring;
                                                                        {5203}new UP_5126: bitstring;
                                                                        {5204}out(c, (GetEndpointResponse,pkSess_5124,None,SP_5125,UP_5126))
                                                                    )
                                                                    else
                                                                        {5205}let pkSess_5127: bitstring = pub(sk(Sess_4517)) in
                                                                        {5206}in(c, =GetEndpointRequest);
                                                                        {5207}new SP_5128: bitstring;
                                                                        {5208}new UP_5129: bitstring;
                                                                        {5209}out(c, (GetEndpointResponse,pkSess_5127,None,SP_5128,UP_5129))
                                                                )
                                                                else
                                                                    {5210}let pkSess_5130: bitstring = fail-any in
                                                                    {5211}in(c, =GetEndpointRequest);
                                                                    {5212}new SP_5131: bitstring;
                                                                    {5213}new UP_5132: bitstring;
                                                                    {5214}out(c, (GetEndpointResponse,pkSess_5130,None,SP_5131,UP_5132))
                                                        )
                                                        else
                                                            {5215}let pkSess_5133: bitstring = fail-any in
                                                            {5216}in(c, =GetEndpointRequest);
                                                            {5217}new SP_5134: bitstring;
                                                            {5218}new UP_5135: bitstring;
                                                            {5219}out(c, (GetEndpointResponse,pkSess_5133,None,SP_5134,UP_5135))
                                                )
                                                else
                                                    {5220}let pkSess_5136: bitstring = fail-any in
                                                    {5221}in(c, =GetEndpointRequest);
                                                    {5222}new SP_5137: bitstring;
                                                    {5223}new UP_5138: bitstring;
                                                    {5224}out(c, (GetEndpointResponse,pkSess_5136,None,SP_5137,UP_5138))
                                            )
                                            else
                                                {5225}let pkCli_5139: bitstring = pub(sk(Cli_4515)) in
                                                {5226}let v_5140: bool = (Sess_4517 = A) in
                                                (
                                                    {5227}if v_5140 then
                                                    (
                                                        {5228}let pkSess_5141: bitstring = pub(skA) in
                                                        {5229}in(c, =GetEndpointRequest);
                                                        {5230}new SP_5142: bitstring;
                                                        {5231}new UP_5143: bitstring;
                                                        {5232}out(c, (GetEndpointResponse,pkSess_5141,None,SP_5142,UP_5143))
                                                    )
                                                    else
                                                        {5233}let v_5144: bool = (Sess_4517 = B) in
                                                        (
                                                            {5234}if v_5144 then
                                                            (
                                                                {5235}let pkSess_5145: bitstring = pub(skB) in
                                                                {5236}in(c, =GetEndpointRequest);
                                                                {5237}new SP_5146: bitstring;
                                                                {5238}new UP_5147: bitstring;
                                                                {5239}out(c, (GetEndpointResponse,pkSess_5145,None,SP_5146,UP_5147))
                                                            )
                                                            else
                                                                {5240}let v_5148: bool = (Sess_4517 = C) in
                                                                (
                                                                    {5241}if v_5148 then
                                                                    (
                                                                        {5242}let pkSess_5149: bitstring = pub(skC) in
                                                                        {5243}in(c, =GetEndpointRequest);
                                                                        {5244}new SP_5150: bitstring;
                                                                        {5245}new UP_5151: bitstring;
                                                                        {5246}out(c, (GetEndpointResponse,pkSess_5149,None,SP_5150,UP_5151))
                                                                    )
                                                                    else
                                                                        {5247}let pkSess_5152: bitstring = pub(sk(Sess_4517)) in
                                                                        {5248}in(c, =GetEndpointRequest);
                                                                        {5249}new SP_5153: bitstring;
                                                                        {5250}new UP_5154: bitstring;
                                                                        {5251}out(c, (GetEndpointResponse,pkSess_5152,None,SP_5153,UP_5154))
                                                                )
                                                                else
                                                                    {5252}let pkSess_5155: bitstring = fail-any in
                                                                    {5253}in(c, =GetEndpointRequest);
                                                                    {5254}new SP_5156: bitstring;
                                                                    {5255}new UP_5157: bitstring;
                                                                    {5256}out(c, (GetEndpointResponse,pkSess_5155,None,SP_5156,UP_5157))
                                                        )
                                                        else
                                                            {5257}let pkSess_5158: bitstring = fail-any in
                                                            {5258}in(c, =GetEndpointRequest);
                                                            {5259}new SP_5159: bitstring;
                                                            {5260}new UP_5160: bitstring;
                                                            {5261}out(c, (GetEndpointResponse,pkSess_5158,None,SP_5159,UP_5160))
                                                )
                                                else
                                                    {5262}let pkSess_5161: bitstring = fail-any in
                                                    {5263}in(c, =GetEndpointRequest);
                                                    {5264}new SP_5162: bitstring;
                                                    {5265}new UP_5163: bitstring;
                                                    {5266}out(c, (GetEndpointResponse,pkSess_5161,None,SP_5162,UP_5163))
                                        )
                                        else
                                            {5267}let pkCli_5164: bitstring = fail-any in
                                            {5268}let v_5165: bool = (Sess_4517 = A) in
                                            (
                                                {5269}if v_5165 then
                                                (
                                                    {5270}let pkSess_5166: bitstring = pub(skA) in
                                                    {5271}in(c, =GetEndpointRequest);
                                                    {5272}new SP_5167: bitstring;
                                                    {5273}new UP_5168: bitstring;
                                                    {5274}out(c, (GetEndpointResponse,pkSess_5166,None,SP_5167,UP_5168))
                                                )
                                                else
                                                    {5275}let v_5169: bool = (Sess_4517 = B) in
                                                    (
                                                        {5276}if v_5169 then
                                                        (
                                                            {5277}let pkSess_5170: bitstring = pub(skB) in
                                                            {5278}in(c, =GetEndpointRequest);
                                                            {5279}new SP_5171: bitstring;
                                                            {5280}new UP_5172: bitstring;
                                                            {5281}out(c, (GetEndpointResponse,pkSess_5170,None,SP_5171,UP_5172))
                                                        )
                                                        else
                                                            {5282}let v_5173: bool = (Sess_4517 = C) in
                                                            (
                                                                {5283}if v_5173 then
                                                                (
                                                                    {5284}let pkSess_5174: bitstring = pub(skC) in
                                                                    {5285}in(c, =GetEndpointRequest);
                                                                    {5286}new SP_5175: bitstring;
                                                                    {5287}new UP_5176: bitstring;
                                                                    {5288}out(c, (GetEndpointResponse,pkSess_5174,None,SP_5175,UP_5176))
                                                                )
                                                                else
                                                                    {5289}let pkSess_5177: bitstring = pub(sk(Sess_4517)) in
                                                                    {5290}in(c, =GetEndpointRequest);
                                                                    {5291}new SP_5178: bitstring;
                                                                    {5292}new UP_5179: bitstring;
                                                                    {5293}out(c, (GetEndpointResponse,pkSess_5177,None,SP_5178,UP_5179))
                                                            )
                                                            else
                                                                {5294}let pkSess_5180: bitstring = fail-any in
                                                                {5295}in(c, =GetEndpointRequest);
                                                                {5296}new SP_5181: bitstring;
                                                                {5297}new UP_5182: bitstring;
                                                                {5298}out(c, (GetEndpointResponse,pkSess_5180,None,SP_5181,UP_5182))
                                                    )
                                                    else
                                                        {5299}let pkSess_5183: bitstring = fail-any in
                                                        {5300}in(c, =GetEndpointRequest);
                                                        {5301}new SP_5184: bitstring;
                                                        {5302}new UP_5185: bitstring;
                                                        {5303}out(c, (GetEndpointResponse,pkSess_5183,None,SP_5184,UP_5185))
                                            )
                                            else
                                                {5304}let pkSess_5186: bitstring = fail-any in
                                                {5305}in(c, =GetEndpointRequest);
                                                {5306}new SP_5187: bitstring;
                                                {5307}new UP_5188: bitstring;
                                                {5308}out(c, (GetEndpointResponse,pkSess_5186,None,SP_5187,UP_5188))
                                )
                                else
                                    {5309}let pkCli_5189: bitstring = fail-any in
                                    {5310}let v_5190: bool = (Sess_4517 = A) in
                                    (
                                        {5311}if v_5190 then
                                        (
                                            {5312}let pkSess_5191: bitstring = pub(skA) in
                                            {5313}in(c, =GetEndpointRequest);
                                            {5314}new SP_5192: bitstring;
                                            {5315}new UP_5193: bitstring;
                                            {5316}out(c, (GetEndpointResponse,pkSess_5191,None,SP_5192,UP_5193))
                                        )
                                        else
                                            {5317}let v_5194: bool = (Sess_4517 = B) in
                                            (
                                                {5318}if v_5194 then
                                                (
                                                    {5319}let pkSess_5195: bitstring = pub(skB) in
                                                    {5320}in(c, =GetEndpointRequest);
                                                    {5321}new SP_5196: bitstring;
                                                    {5322}new UP_5197: bitstring;
                                                    {5323}out(c, (GetEndpointResponse,pkSess_5195,None,SP_5196,UP_5197))
                                                )
                                                else
                                                    {5324}let v_5198: bool = (Sess_4517 = C) in
                                                    (
                                                        {5325}if v_5198 then
                                                        (
                                                            {5326}let pkSess_5199: bitstring = pub(skC) in
                                                            {5327}in(c, =GetEndpointRequest);
                                                            {5328}new SP_5200: bitstring;
                                                            {5329}new UP_5201: bitstring;
                                                            {5330}out(c, (GetEndpointResponse,pkSess_5199,None,SP_5200,UP_5201))
                                                        )
                                                        else
                                                            {5331}let pkSess_5202: bitstring = pub(sk(Sess_4517)) in
                                                            {5332}in(c, =GetEndpointRequest);
                                                            {5333}new SP_5203: bitstring;
                                                            {5334}new UP_5204: bitstring;
                                                            {5335}out(c, (GetEndpointResponse,pkSess_5202,None,SP_5203,UP_5204))
                                                    )
                                                    else
                                                        {5336}let pkSess_5205: bitstring = fail-any in
                                                        {5337}in(c, =GetEndpointRequest);
                                                        {5338}new SP_5206: bitstring;
                                                        {5339}new UP_5207: bitstring;
                                                        {5340}out(c, (GetEndpointResponse,pkSess_5205,None,SP_5206,UP_5207))
                                            )
                                            else
                                                {5341}let pkSess_5208: bitstring = fail-any in
                                                {5342}in(c, =GetEndpointRequest);
                                                {5343}new SP_5209: bitstring;
                                                {5344}new UP_5210: bitstring;
                                                {5345}out(c, (GetEndpointResponse,pkSess_5208,None,SP_5209,UP_5210))
                                    )
                                    else
                                        {5346}let pkSess_5211: bitstring = fail-any in
                                        {5347}in(c, =GetEndpointRequest);
                                        {5348}new SP_5212: bitstring;
                                        {5349}new UP_5213: bitstring;
                                        {5350}out(c, (GetEndpointResponse,pkSess_5211,None,SP_5212,UP_5213))
                        )
                        else
                            {5351}let pkCli_5214: bitstring = fail-any in
                            {5352}let v_5215: bool = (Sess_4517 = A) in
                            (
                                {5353}if v_5215 then
                                (
                                    {5354}let pkSess_5216: bitstring = pub(skA) in
                                    {5355}in(c, =GetEndpointRequest);
                                    {5356}new SP_5217: bitstring;
                                    {5357}new UP_5218: bitstring;
                                    {5358}out(c, (GetEndpointResponse,pkSess_5216,None,SP_5217,UP_5218))
                                )
                                else
                                    {5359}let v_5219: bool = (Sess_4517 = B) in
                                    (
                                        {5360}if v_5219 then
                                        (
                                            {5361}let pkSess_5220: bitstring = pub(skB) in
                                            {5362}in(c, =GetEndpointRequest);
                                            {5363}new SP_5221: bitstring;
                                            {5364}new UP_5222: bitstring;
                                            {5365}out(c, (GetEndpointResponse,pkSess_5220,None,SP_5221,UP_5222))
                                        )
                                        else
                                            {5366}let v_5223: bool = (Sess_4517 = C) in
                                            (
                                                {5367}if v_5223 then
                                                (
                                                    {5368}let pkSess_5224: bitstring = pub(skC) in
                                                    {5369}in(c, =GetEndpointRequest);
                                                    {5370}new SP_5225: bitstring;
                                                    {5371}new UP_5226: bitstring;
                                                    {5372}out(c, (GetEndpointResponse,pkSess_5224,None,SP_5225,UP_5226))
                                                )
                                                else
                                                    {5373}let pkSess_5227: bitstring = pub(sk(Sess_4517)) in
                                                    {5374}in(c, =GetEndpointRequest);
                                                    {5375}new SP_5228: bitstring;
                                                    {5376}new UP_5229: bitstring;
                                                    {5377}out(c, (GetEndpointResponse,pkSess_5227,None,SP_5228,UP_5229))
                                            )
                                            else
                                                {5378}let pkSess_5230: bitstring = fail-any in
                                                {5379}in(c, =GetEndpointRequest);
                                                {5380}new SP_5231: bitstring;
                                                {5381}new UP_5232: bitstring;
                                                {5382}out(c, (GetEndpointResponse,pkSess_5230,None,SP_5231,UP_5232))
                                    )
                                    else
                                        {5383}let pkSess_5233: bitstring = fail-any in
                                        {5384}in(c, =GetEndpointRequest);
                                        {5385}new SP_5234: bitstring;
                                        {5386}new UP_5235: bitstring;
                                        {5387}out(c, (GetEndpointResponse,pkSess_5233,None,SP_5234,UP_5235))
                            )
                            else
                                {5388}let pkSess_5236: bitstring = fail-any in
                                {5389}in(c, =GetEndpointRequest);
                                {5390}new SP_5237: bitstring;
                                {5391}new UP_5238: bitstring;
                                {5392}out(c, (GetEndpointResponse,pkSess_5236,None,SP_5237,UP_5238))
            )
            else
                {5393}let skDisco_5239: bitstring = fail-any in
                {5394}let pkDisco_5240: bitstring = pub(skDisco_5239) in
                {5395}let v_5241: bool = (Cli_4515 = A) in
                (
                    {5396}if v_5241 then
                    (
                        {5397}let pkCli_5242: bitstring = pub(skA) in
                        {5398}let v_5243: bool = (Sess_4517 = A) in
                        (
                            {5399}if v_5243 then
                            (
                                {5400}let pkSess_5244: bitstring = pub(skA) in
                                {5401}in(c, =GetEndpointRequest);
                                {5402}new SP_5245: bitstring;
                                {5403}new UP_5246: bitstring;
                                {5404}out(c, (GetEndpointResponse,pkSess_5244,None,SP_5245,UP_5246))
                            )
                            else
                                {5405}let v_5247: bool = (Sess_4517 = B) in
                                (
                                    {5406}if v_5247 then
                                    (
                                        {5407}let pkSess_5248: bitstring = pub(skB) in
                                        {5408}in(c, =GetEndpointRequest);
                                        {5409}new SP_5249: bitstring;
                                        {5410}new UP_5250: bitstring;
                                        {5411}out(c, (GetEndpointResponse,pkSess_5248,None,SP_5249,UP_5250))
                                    )
                                    else
                                        {5412}let v_5251: bool = (Sess_4517 = C) in
                                        (
                                            {5413}if v_5251 then
                                            (
                                                {5414}let pkSess_5252: bitstring = pub(skC) in
                                                {5415}in(c, =GetEndpointRequest);
                                                {5416}new SP_5253: bitstring;
                                                {5417}new UP_5254: bitstring;
                                                {5418}out(c, (GetEndpointResponse,pkSess_5252,None,SP_5253,UP_5254))
                                            )
                                            else
                                                {5419}let pkSess_5255: bitstring = pub(sk(Sess_4517)) in
                                                {5420}in(c, =GetEndpointRequest);
                                                {5421}new SP_5256: bitstring;
                                                {5422}new UP_5257: bitstring;
                                                {5423}out(c, (GetEndpointResponse,pkSess_5255,None,SP_5256,UP_5257))
                                        )
                                        else
                                            {5424}let pkSess_5258: bitstring = fail-any in
                                            {5425}in(c, =GetEndpointRequest);
                                            {5426}new SP_5259: bitstring;
                                            {5427}new UP_5260: bitstring;
                                            {5428}out(c, (GetEndpointResponse,pkSess_5258,None,SP_5259,UP_5260))
                                )
                                else
                                    {5429}let pkSess_5261: bitstring = fail-any in
                                    {5430}in(c, =GetEndpointRequest);
                                    {5431}new SP_5262: bitstring;
                                    {5432}new UP_5263: bitstring;
                                    {5433}out(c, (GetEndpointResponse,pkSess_5261,None,SP_5262,UP_5263))
                        )
                        else
                            {5434}let pkSess_5264: bitstring = fail-any in
                            {5435}in(c, =GetEndpointRequest);
                            {5436}new SP_5265: bitstring;
                            {5437}new UP_5266: bitstring;
                            {5438}out(c, (GetEndpointResponse,pkSess_5264,None,SP_5265,UP_5266))
                    )
                    else
                        {5439}let v_5267: bool = (Cli_4515 = B) in
                        (
                            {5440}if v_5267 then
                            (
                                {5441}let pkCli_5268: bitstring = pub(skB) in
                                {5442}let v_5269: bool = (Sess_4517 = A) in
                                (
                                    {5443}if v_5269 then
                                    (
                                        {5444}let pkSess_5270: bitstring = pub(skA) in
                                        {5445}in(c, =GetEndpointRequest);
                                        {5446}new SP_5271: bitstring;
                                        {5447}new UP_5272: bitstring;
                                        {5448}out(c, (GetEndpointResponse,pkSess_5270,None,SP_5271,UP_5272))
                                    )
                                    else
                                        {5449}let v_5273: bool = (Sess_4517 = B) in
                                        (
                                            {5450}if v_5273 then
                                            (
                                                {5451}let pkSess_5274: bitstring = pub(skB) in
                                                {5452}in(c, =GetEndpointRequest);
                                                {5453}new SP_5275: bitstring;
                                                {5454}new UP_5276: bitstring;
                                                {5455}out(c, (GetEndpointResponse,pkSess_5274,None,SP_5275,UP_5276))
                                            )
                                            else
                                                {5456}let v_5277: bool = (Sess_4517 = C) in
                                                (
                                                    {5457}if v_5277 then
                                                    (
                                                        {5458}let pkSess_5278: bitstring = pub(skC) in
                                                        {5459}in(c, =GetEndpointRequest);
                                                        {5460}new SP_5279: bitstring;
                                                        {5461}new UP_5280: bitstring;
                                                        {5462}out(c, (GetEndpointResponse,pkSess_5278,None,SP_5279,UP_5280))
                                                    )
                                                    else
                                                        {5463}let pkSess_5281: bitstring = pub(sk(Sess_4517)) in
                                                        {5464}in(c, =GetEndpointRequest);
                                                        {5465}new SP_5282: bitstring;
                                                        {5466}new UP_5283: bitstring;
                                                        {5467}out(c, (GetEndpointResponse,pkSess_5281,None,SP_5282,UP_5283))
                                                )
                                                else
                                                    {5468}let pkSess_5284: bitstring = fail-any in
                                                    {5469}in(c, =GetEndpointRequest);
                                                    {5470}new SP_5285: bitstring;
                                                    {5471}new UP_5286: bitstring;
                                                    {5472}out(c, (GetEndpointResponse,pkSess_5284,None,SP_5285,UP_5286))
                                        )
                                        else
                                            {5473}let pkSess_5287: bitstring = fail-any in
                                            {5474}in(c, =GetEndpointRequest);
                                            {5475}new SP_5288: bitstring;
                                            {5476}new UP_5289: bitstring;
                                            {5477}out(c, (GetEndpointResponse,pkSess_5287,None,SP_5288,UP_5289))
                                )
                                else
                                    {5478}let pkSess_5290: bitstring = fail-any in
                                    {5479}in(c, =GetEndpointRequest);
                                    {5480}new SP_5291: bitstring;
                                    {5481}new UP_5292: bitstring;
                                    {5482}out(c, (GetEndpointResponse,pkSess_5290,None,SP_5291,UP_5292))
                            )
                            else
                                {5483}let v_5293: bool = (Cli_4515 = C) in
                                (
                                    {5484}if v_5293 then
                                    (
                                        {5485}let pkCli_5294: bitstring = pub(skC) in
                                        {5486}let v_5295: bool = (Sess_4517 = A) in
                                        (
                                            {5487}if v_5295 then
                                            (
                                                {5488}let pkSess_5296: bitstring = pub(skA) in
                                                {5489}in(c, =GetEndpointRequest);
                                                {5490}new SP_5297: bitstring;
                                                {5491}new UP_5298: bitstring;
                                                {5492}out(c, (GetEndpointResponse,pkSess_5296,None,SP_5297,UP_5298))
                                            )
                                            else
                                                {5493}let v_5299: bool = (Sess_4517 = B) in
                                                (
                                                    {5494}if v_5299 then
                                                    (
                                                        {5495}let pkSess_5300: bitstring = pub(skB) in
                                                        {5496}in(c, =GetEndpointRequest);
                                                        {5497}new SP_5301: bitstring;
                                                        {5498}new UP_5302: bitstring;
                                                        {5499}out(c, (GetEndpointResponse,pkSess_5300,None,SP_5301,UP_5302))
                                                    )
                                                    else
                                                        {5500}let v_5303: bool = (Sess_4517 = C) in
                                                        (
                                                            {5501}if v_5303 then
                                                            (
                                                                {5502}let pkSess_5304: bitstring = pub(skC) in
                                                                {5503}in(c, =GetEndpointRequest);
                                                                {5504}new SP_5305: bitstring;
                                                                {5505}new UP_5306: bitstring;
                                                                {5506}out(c, (GetEndpointResponse,pkSess_5304,None,SP_5305,UP_5306))
                                                            )
                                                            else
                                                                {5507}let pkSess_5307: bitstring = pub(sk(Sess_4517)) in
                                                                {5508}in(c, =GetEndpointRequest);
                                                                {5509}new SP_5308: bitstring;
                                                                {5510}new UP_5309: bitstring;
                                                                {5511}out(c, (GetEndpointResponse,pkSess_5307,None,SP_5308,UP_5309))
                                                        )
                                                        else
                                                            {5512}let pkSess_5310: bitstring = fail-any in
                                                            {5513}in(c, =GetEndpointRequest);
                                                            {5514}new SP_5311: bitstring;
                                                            {5515}new UP_5312: bitstring;
                                                            {5516}out(c, (GetEndpointResponse,pkSess_5310,None,SP_5311,UP_5312))
                                                )
                                                else
                                                    {5517}let pkSess_5313: bitstring = fail-any in
                                                    {5518}in(c, =GetEndpointRequest);
                                                    {5519}new SP_5314: bitstring;
                                                    {5520}new UP_5315: bitstring;
                                                    {5521}out(c, (GetEndpointResponse,pkSess_5313,None,SP_5314,UP_5315))
                                        )
                                        else
                                            {5522}let pkSess_5316: bitstring = fail-any in
                                            {5523}in(c, =GetEndpointRequest);
                                            {5524}new SP_5317: bitstring;
                                            {5525}new UP_5318: bitstring;
                                            {5526}out(c, (GetEndpointResponse,pkSess_5316,None,SP_5317,UP_5318))
                                    )
                                    else
                                        {5527}let pkCli_5319: bitstring = pub(sk(Cli_4515)) in
                                        {5528}let v_5320: bool = (Sess_4517 = A) in
                                        (
                                            {5529}if v_5320 then
                                            (
                                                {5530}let pkSess_5321: bitstring = pub(skA) in
                                                {5531}in(c, =GetEndpointRequest);
                                                {5532}new SP_5322: bitstring;
                                                {5533}new UP_5323: bitstring;
                                                {5534}out(c, (GetEndpointResponse,pkSess_5321,None,SP_5322,UP_5323))
                                            )
                                            else
                                                {5535}let v_5324: bool = (Sess_4517 = B) in
                                                (
                                                    {5536}if v_5324 then
                                                    (
                                                        {5537}let pkSess_5325: bitstring = pub(skB) in
                                                        {5538}in(c, =GetEndpointRequest);
                                                        {5539}new SP_5326: bitstring;
                                                        {5540}new UP_5327: bitstring;
                                                        {5541}out(c, (GetEndpointResponse,pkSess_5325,None,SP_5326,UP_5327))
                                                    )
                                                    else
                                                        {5542}let v_5328: bool = (Sess_4517 = C) in
                                                        (
                                                            {5543}if v_5328 then
                                                            (
                                                                {5544}let pkSess_5329: bitstring = pub(skC) in
                                                                {5545}in(c, =GetEndpointRequest);
                                                                {5546}new SP_5330: bitstring;
                                                                {5547}new UP_5331: bitstring;
                                                                {5548}out(c, (GetEndpointResponse,pkSess_5329,None,SP_5330,UP_5331))
                                                            )
                                                            else
                                                                {5549}let pkSess_5332: bitstring = pub(sk(Sess_4517)) in
                                                                {5550}in(c, =GetEndpointRequest);
                                                                {5551}new SP_5333: bitstring;
                                                                {5552}new UP_5334: bitstring;
                                                                {5553}out(c, (GetEndpointResponse,pkSess_5332,None,SP_5333,UP_5334))
                                                        )
                                                        else
                                                            {5554}let pkSess_5335: bitstring = fail-any in
                                                            {5555}in(c, =GetEndpointRequest);
                                                            {5556}new SP_5336: bitstring;
                                                            {5557}new UP_5337: bitstring;
                                                            {5558}out(c, (GetEndpointResponse,pkSess_5335,None,SP_5336,UP_5337))
                                                )
                                                else
                                                    {5559}let pkSess_5338: bitstring = fail-any in
                                                    {5560}in(c, =GetEndpointRequest);
                                                    {5561}new SP_5339: bitstring;
                                                    {5562}new UP_5340: bitstring;
                                                    {5563}out(c, (GetEndpointResponse,pkSess_5338,None,SP_5339,UP_5340))
                                        )
                                        else
                                            {5564}let pkSess_5341: bitstring = fail-any in
                                            {5565}in(c, =GetEndpointRequest);
                                            {5566}new SP_5342: bitstring;
                                            {5567}new UP_5343: bitstring;
                                            {5568}out(c, (GetEndpointResponse,pkSess_5341,None,SP_5342,UP_5343))
                                )
                                else
                                    {5569}let pkCli_5344: bitstring = fail-any in
                                    {5570}let v_5345: bool = (Sess_4517 = A) in
                                    (
                                        {5571}if v_5345 then
                                        (
                                            {5572}let pkSess_5346: bitstring = pub(skA) in
                                            {5573}in(c, =GetEndpointRequest);
                                            {5574}new SP_5347: bitstring;
                                            {5575}new UP_5348: bitstring;
                                            {5576}out(c, (GetEndpointResponse,pkSess_5346,None,SP_5347,UP_5348))
                                        )
                                        else
                                            {5577}let v_5349: bool = (Sess_4517 = B) in
                                            (
                                                {5578}if v_5349 then
                                                (
                                                    {5579}let pkSess_5350: bitstring = pub(skB) in
                                                    {5580}in(c, =GetEndpointRequest);
                                                    {5581}new SP_5351: bitstring;
                                                    {5582}new UP_5352: bitstring;
                                                    {5583}out(c, (GetEndpointResponse,pkSess_5350,None,SP_5351,UP_5352))
                                                )
                                                else
                                                    {5584}let v_5353: bool = (Sess_4517 = C) in
                                                    (
                                                        {5585}if v_5353 then
                                                        (
                                                            {5586}let pkSess_5354: bitstring = pub(skC) in
                                                            {5587}in(c, =GetEndpointRequest);
                                                            {5588}new SP_5355: bitstring;
                                                            {5589}new UP_5356: bitstring;
                                                            {5590}out(c, (GetEndpointResponse,pkSess_5354,None,SP_5355,UP_5356))
                                                        )
                                                        else
                                                            {5591}let pkSess_5357: bitstring = pub(sk(Sess_4517)) in
                                                            {5592}in(c, =GetEndpointRequest);
                                                            {5593}new SP_5358: bitstring;
                                                            {5594}new UP_5359: bitstring;
                                                            {5595}out(c, (GetEndpointResponse,pkSess_5357,None,SP_5358,UP_5359))
                                                    )
                                                    else
                                                        {5596}let pkSess_5360: bitstring = fail-any in
                                                        {5597}in(c, =GetEndpointRequest);
                                                        {5598}new SP_5361: bitstring;
                                                        {5599}new UP_5362: bitstring;
                                                        {5600}out(c, (GetEndpointResponse,pkSess_5360,None,SP_5361,UP_5362))
                                            )
                                            else
                                                {5601}let pkSess_5363: bitstring = fail-any in
                                                {5602}in(c, =GetEndpointRequest);
                                                {5603}new SP_5364: bitstring;
                                                {5604}new UP_5365: bitstring;
                                                {5605}out(c, (GetEndpointResponse,pkSess_5363,None,SP_5364,UP_5365))
                                    )
                                    else
                                        {5606}let pkSess_5366: bitstring = fail-any in
                                        {5607}in(c, =GetEndpointRequest);
                                        {5608}new SP_5367: bitstring;
                                        {5609}new UP_5368: bitstring;
                                        {5610}out(c, (GetEndpointResponse,pkSess_5366,None,SP_5367,UP_5368))
                        )
                        else
                            {5611}let pkCli_5369: bitstring = fail-any in
                            {5612}let v_5370: bool = (Sess_4517 = A) in
                            (
                                {5613}if v_5370 then
                                (
                                    {5614}let pkSess_5371: bitstring = pub(skA) in
                                    {5615}in(c, =GetEndpointRequest);
                                    {5616}new SP_5372: bitstring;
                                    {5617}new UP_5373: bitstring;
                                    {5618}out(c, (GetEndpointResponse,pkSess_5371,None,SP_5372,UP_5373))
                                )
                                else
                                    {5619}let v_5374: bool = (Sess_4517 = B) in
                                    (
                                        {5620}if v_5374 then
                                        (
                                            {5621}let pkSess_5375: bitstring = pub(skB) in
                                            {5622}in(c, =GetEndpointRequest);
                                            {5623}new SP_5376: bitstring;
                                            {5624}new UP_5377: bitstring;
                                            {5625}out(c, (GetEndpointResponse,pkSess_5375,None,SP_5376,UP_5377))
                                        )
                                        else
                                            {5626}let v_5378: bool = (Sess_4517 = C) in
                                            (
                                                {5627}if v_5378 then
                                                (
                                                    {5628}let pkSess_5379: bitstring = pub(skC) in
                                                    {5629}in(c, =GetEndpointRequest);
                                                    {5630}new SP_5380: bitstring;
                                                    {5631}new UP_5381: bitstring;
                                                    {5632}out(c, (GetEndpointResponse,pkSess_5379,None,SP_5380,UP_5381))
                                                )
                                                else
                                                    {5633}let pkSess_5382: bitstring = pub(sk(Sess_4517)) in
                                                    {5634}in(c, =GetEndpointRequest);
                                                    {5635}new SP_5383: bitstring;
                                                    {5636}new UP_5384: bitstring;
                                                    {5637}out(c, (GetEndpointResponse,pkSess_5382,None,SP_5383,UP_5384))
                                            )
                                            else
                                                {5638}let pkSess_5385: bitstring = fail-any in
                                                {5639}in(c, =GetEndpointRequest);
                                                {5640}new SP_5386: bitstring;
                                                {5641}new UP_5387: bitstring;
                                                {5642}out(c, (GetEndpointResponse,pkSess_5385,None,SP_5386,UP_5387))
                                    )
                                    else
                                        {5643}let pkSess_5388: bitstring = fail-any in
                                        {5644}in(c, =GetEndpointRequest);
                                        {5645}new SP_5389: bitstring;
                                        {5646}new UP_5390: bitstring;
                                        {5647}out(c, (GetEndpointResponse,pkSess_5388,None,SP_5389,UP_5390))
                            )
                            else
                                {5648}let pkSess_5391: bitstring = fail-any in
                                {5649}in(c, =GetEndpointRequest);
                                {5650}new SP_5392: bitstring;
                                {5651}new UP_5393: bitstring;
                                {5652}out(c, (GetEndpointResponse,pkSess_5391,None,SP_5392,UP_5393))
                )
                else
                    {5653}let pkCli_5394: bitstring = fail-any in
                    {5654}let v_5395: bool = (Sess_4517 = A) in
                    (
                        {5655}if v_5395 then
                        (
                            {5656}let pkSess_5396: bitstring = pub(skA) in
                            {5657}in(c, =GetEndpointRequest);
                            {5658}new SP_5397: bitstring;
                            {5659}new UP_5398: bitstring;
                            {5660}out(c, (GetEndpointResponse,pkSess_5396,None,SP_5397,UP_5398))
                        )
                        else
                            {5661}let v_5399: bool = (Sess_4517 = B) in
                            (
                                {5662}if v_5399 then
                                (
                                    {5663}let pkSess_5400: bitstring = pub(skB) in
                                    {5664}in(c, =GetEndpointRequest);
                                    {5665}new SP_5401: bitstring;
                                    {5666}new UP_5402: bitstring;
                                    {5667}out(c, (GetEndpointResponse,pkSess_5400,None,SP_5401,UP_5402))
                                )
                                else
                                    {5668}let v_5403: bool = (Sess_4517 = C) in
                                    (
                                        {5669}if v_5403 then
                                        (
                                            {5670}let pkSess_5404: bitstring = pub(skC) in
                                            {5671}in(c, =GetEndpointRequest);
                                            {5672}new SP_5405: bitstring;
                                            {5673}new UP_5406: bitstring;
                                            {5674}out(c, (GetEndpointResponse,pkSess_5404,None,SP_5405,UP_5406))
                                        )
                                        else
                                            {5675}let pkSess_5407: bitstring = pub(sk(Sess_4517)) in
                                            {5676}in(c, =GetEndpointRequest);
                                            {5677}new SP_5408: bitstring;
                                            {5678}new UP_5409: bitstring;
                                            {5679}out(c, (GetEndpointResponse,pkSess_5407,None,SP_5408,UP_5409))
                                    )
                                    else
                                        {5680}let pkSess_5410: bitstring = fail-any in
                                        {5681}in(c, =GetEndpointRequest);
                                        {5682}new SP_5411: bitstring;
                                        {5683}new UP_5412: bitstring;
                                        {5684}out(c, (GetEndpointResponse,pkSess_5410,None,SP_5411,UP_5412))
                            )
                            else
                                {5685}let pkSess_5413: bitstring = fail-any in
                                {5686}in(c, =GetEndpointRequest);
                                {5687}new SP_5414: bitstring;
                                {5688}new UP_5415: bitstring;
                                {5689}out(c, (GetEndpointResponse,pkSess_5413,None,SP_5414,UP_5415))
                    )
                    else
                        {5690}let pkSess_5416: bitstring = fail-any in
                        {5691}in(c, =GetEndpointRequest);
                        {5692}new SP_5417: bitstring;
                        {5693}new UP_5418: bitstring;
                        {5694}out(c, (GetEndpointResponse,pkSess_5416,None,SP_5417,UP_5418))
    )
    else
        {5695}let skDisco_5419: bitstring = fail-any in
        {5696}let pkDisco_5420: bitstring = pub(skDisco_5419) in
        {5697}let v_5421: bool = (Cli_4515 = A) in
        (
            {5698}if v_5421 then
            (
                {5699}let pkCli_5422: bitstring = pub(skA) in
                {5700}let v_5423: bool = (Sess_4517 = A) in
                (
                    {5701}if v_5423 then
                    (
                        {5702}let pkSess_5424: bitstring = pub(skA) in
                        {5703}in(c, =GetEndpointRequest);
                        {5704}new SP_5425: bitstring;
                        {5705}new UP_5426: bitstring;
                        {5706}out(c, (GetEndpointResponse,pkSess_5424,None,SP_5425,UP_5426))
                    )
                    else
                        {5707}let v_5427: bool = (Sess_4517 = B) in
                        (
                            {5708}if v_5427 then
                            (
                                {5709}let pkSess_5428: bitstring = pub(skB) in
                                {5710}in(c, =GetEndpointRequest);
                                {5711}new SP_5429: bitstring;
                                {5712}new UP_5430: bitstring;
                                {5713}out(c, (GetEndpointResponse,pkSess_5428,None,SP_5429,UP_5430))
                            )
                            else
                                {5714}let v_5431: bool = (Sess_4517 = C) in
                                (
                                    {5715}if v_5431 then
                                    (
                                        {5716}let pkSess_5432: bitstring = pub(skC) in
                                        {5717}in(c, =GetEndpointRequest);
                                        {5718}new SP_5433: bitstring;
                                        {5719}new UP_5434: bitstring;
                                        {5720}out(c, (GetEndpointResponse,pkSess_5432,None,SP_5433,UP_5434))
                                    )
                                    else
                                        {5721}let pkSess_5435: bitstring = pub(sk(Sess_4517)) in
                                        {5722}in(c, =GetEndpointRequest);
                                        {5723}new SP_5436: bitstring;
                                        {5724}new UP_5437: bitstring;
                                        {5725}out(c, (GetEndpointResponse,pkSess_5435,None,SP_5436,UP_5437))
                                )
                                else
                                    {5726}let pkSess_5438: bitstring = fail-any in
                                    {5727}in(c, =GetEndpointRequest);
                                    {5728}new SP_5439: bitstring;
                                    {5729}new UP_5440: bitstring;
                                    {5730}out(c, (GetEndpointResponse,pkSess_5438,None,SP_5439,UP_5440))
                        )
                        else
                            {5731}let pkSess_5441: bitstring = fail-any in
                            {5732}in(c, =GetEndpointRequest);
                            {5733}new SP_5442: bitstring;
                            {5734}new UP_5443: bitstring;
                            {5735}out(c, (GetEndpointResponse,pkSess_5441,None,SP_5442,UP_5443))
                )
                else
                    {5736}let pkSess_5444: bitstring = fail-any in
                    {5737}in(c, =GetEndpointRequest);
                    {5738}new SP_5445: bitstring;
                    {5739}new UP_5446: bitstring;
                    {5740}out(c, (GetEndpointResponse,pkSess_5444,None,SP_5445,UP_5446))
            )
            else
                {5741}let v_5447: bool = (Cli_4515 = B) in
                (
                    {5742}if v_5447 then
                    (
                        {5743}let pkCli_5448: bitstring = pub(skB) in
                        {5744}let v_5449: bool = (Sess_4517 = A) in
                        (
                            {5745}if v_5449 then
                            (
                                {5746}let pkSess_5450: bitstring = pub(skA) in
                                {5747}in(c, =GetEndpointRequest);
                                {5748}new SP_5451: bitstring;
                                {5749}new UP_5452: bitstring;
                                {5750}out(c, (GetEndpointResponse,pkSess_5450,None,SP_5451,UP_5452))
                            )
                            else
                                {5751}let v_5453: bool = (Sess_4517 = B) in
                                (
                                    {5752}if v_5453 then
                                    (
                                        {5753}let pkSess_5454: bitstring = pub(skB) in
                                        {5754}in(c, =GetEndpointRequest);
                                        {5755}new SP_5455: bitstring;
                                        {5756}new UP_5456: bitstring;
                                        {5757}out(c, (GetEndpointResponse,pkSess_5454,None,SP_5455,UP_5456))
                                    )
                                    else
                                        {5758}let v_5457: bool = (Sess_4517 = C) in
                                        (
                                            {5759}if v_5457 then
                                            (
                                                {5760}let pkSess_5458: bitstring = pub(skC) in
                                                {5761}in(c, =GetEndpointRequest);
                                                {5762}new SP_5459: bitstring;
                                                {5763}new UP_5460: bitstring;
                                                {5764}out(c, (GetEndpointResponse,pkSess_5458,None,SP_5459,UP_5460))
                                            )
                                            else
                                                {5765}let pkSess_5461: bitstring = pub(sk(Sess_4517)) in
                                                {5766}in(c, =GetEndpointRequest);
                                                {5767}new SP_5462: bitstring;
                                                {5768}new UP_5463: bitstring;
                                                {5769}out(c, (GetEndpointResponse,pkSess_5461,None,SP_5462,UP_5463))
                                        )
                                        else
                                            {5770}let pkSess_5464: bitstring = fail-any in
                                            {5771}in(c, =GetEndpointRequest);
                                            {5772}new SP_5465: bitstring;
                                            {5773}new UP_5466: bitstring;
                                            {5774}out(c, (GetEndpointResponse,pkSess_5464,None,SP_5465,UP_5466))
                                )
                                else
                                    {5775}let pkSess_5467: bitstring = fail-any in
                                    {5776}in(c, =GetEndpointRequest);
                                    {5777}new SP_5468: bitstring;
                                    {5778}new UP_5469: bitstring;
                                    {5779}out(c, (GetEndpointResponse,pkSess_5467,None,SP_5468,UP_5469))
                        )
                        else
                            {5780}let pkSess_5470: bitstring = fail-any in
                            {5781}in(c, =GetEndpointRequest);
                            {5782}new SP_5471: bitstring;
                            {5783}new UP_5472: bitstring;
                            {5784}out(c, (GetEndpointResponse,pkSess_5470,None,SP_5471,UP_5472))
                    )
                    else
                        {5785}let v_5473: bool = (Cli_4515 = C) in
                        (
                            {5786}if v_5473 then
                            (
                                {5787}let pkCli_5474: bitstring = pub(skC) in
                                {5788}let v_5475: bool = (Sess_4517 = A) in
                                (
                                    {5789}if v_5475 then
                                    (
                                        {5790}let pkSess_5476: bitstring = pub(skA) in
                                        {5791}in(c, =GetEndpointRequest);
                                        {5792}new SP_5477: bitstring;
                                        {5793}new UP_5478: bitstring;
                                        {5794}out(c, (GetEndpointResponse,pkSess_5476,None,SP_5477,UP_5478))
                                    )
                                    else
                                        {5795}let v_5479: bool = (Sess_4517 = B) in
                                        (
                                            {5796}if v_5479 then
                                            (
                                                {5797}let pkSess_5480: bitstring = pub(skB) in
                                                {5798}in(c, =GetEndpointRequest);
                                                {5799}new SP_5481: bitstring;
                                                {5800}new UP_5482: bitstring;
                                                {5801}out(c, (GetEndpointResponse,pkSess_5480,None,SP_5481,UP_5482))
                                            )
                                            else
                                                {5802}let v_5483: bool = (Sess_4517 = C) in
                                                (
                                                    {5803}if v_5483 then
                                                    (
                                                        {5804}let pkSess_5484: bitstring = pub(skC) in
                                                        {5805}in(c, =GetEndpointRequest);
                                                        {5806}new SP_5485: bitstring;
                                                        {5807}new UP_5486: bitstring;
                                                        {5808}out(c, (GetEndpointResponse,pkSess_5484,None,SP_5485,UP_5486))
                                                    )
                                                    else
                                                        {5809}let pkSess_5487: bitstring = pub(sk(Sess_4517)) in
                                                        {5810}in(c, =GetEndpointRequest);
                                                        {5811}new SP_5488: bitstring;
                                                        {5812}new UP_5489: bitstring;
                                                        {5813}out(c, (GetEndpointResponse,pkSess_5487,None,SP_5488,UP_5489))
                                                )
                                                else
                                                    {5814}let pkSess_5490: bitstring = fail-any in
                                                    {5815}in(c, =GetEndpointRequest);
                                                    {5816}new SP_5491: bitstring;
                                                    {5817}new UP_5492: bitstring;
                                                    {5818}out(c, (GetEndpointResponse,pkSess_5490,None,SP_5491,UP_5492))
                                        )
                                        else
                                            {5819}let pkSess_5493: bitstring = fail-any in
                                            {5820}in(c, =GetEndpointRequest);
                                            {5821}new SP_5494: bitstring;
                                            {5822}new UP_5495: bitstring;
                                            {5823}out(c, (GetEndpointResponse,pkSess_5493,None,SP_5494,UP_5495))
                                )
                                else
                                    {5824}let pkSess_5496: bitstring = fail-any in
                                    {5825}in(c, =GetEndpointRequest);
                                    {5826}new SP_5497: bitstring;
                                    {5827}new UP_5498: bitstring;
                                    {5828}out(c, (GetEndpointResponse,pkSess_5496,None,SP_5497,UP_5498))
                            )
                            else
                                {5829}let pkCli_5499: bitstring = pub(sk(Cli_4515)) in
                                {5830}let v_5500: bool = (Sess_4517 = A) in
                                (
                                    {5831}if v_5500 then
                                    (
                                        {5832}let pkSess_5501: bitstring = pub(skA) in
                                        {5833}in(c, =GetEndpointRequest);
                                        {5834}new SP_5502: bitstring;
                                        {5835}new UP_5503: bitstring;
                                        {5836}out(c, (GetEndpointResponse,pkSess_5501,None,SP_5502,UP_5503))
                                    )
                                    else
                                        {5837}let v_5504: bool = (Sess_4517 = B) in
                                        (
                                            {5838}if v_5504 then
                                            (
                                                {5839}let pkSess_5505: bitstring = pub(skB) in
                                                {5840}in(c, =GetEndpointRequest);
                                                {5841}new SP_5506: bitstring;
                                                {5842}new UP_5507: bitstring;
                                                {5843}out(c, (GetEndpointResponse,pkSess_5505,None,SP_5506,UP_5507))
                                            )
                                            else
                                                {5844}let v_5508: bool = (Sess_4517 = C) in
                                                (
                                                    {5845}if v_5508 then
                                                    (
                                                        {5846}let pkSess_5509: bitstring = pub(skC) in
                                                        {5847}in(c, =GetEndpointRequest);
                                                        {5848}new SP_5510: bitstring;
                                                        {5849}new UP_5511: bitstring;
                                                        {5850}out(c, (GetEndpointResponse,pkSess_5509,None,SP_5510,UP_5511))
                                                    )
                                                    else
                                                        {5851}let pkSess_5512: bitstring = pub(sk(Sess_4517)) in
                                                        {5852}in(c, =GetEndpointRequest);
                                                        {5853}new SP_5513: bitstring;
                                                        {5854}new UP_5514: bitstring;
                                                        {5855}out(c, (GetEndpointResponse,pkSess_5512,None,SP_5513,UP_5514))
                                                )
                                                else
                                                    {5856}let pkSess_5515: bitstring = fail-any in
                                                    {5857}in(c, =GetEndpointRequest);
                                                    {5858}new SP_5516: bitstring;
                                                    {5859}new UP_5517: bitstring;
                                                    {5860}out(c, (GetEndpointResponse,pkSess_5515,None,SP_5516,UP_5517))
                                        )
                                        else
                                            {5861}let pkSess_5518: bitstring = fail-any in
                                            {5862}in(c, =GetEndpointRequest);
                                            {5863}new SP_5519: bitstring;
                                            {5864}new UP_5520: bitstring;
                                            {5865}out(c, (GetEndpointResponse,pkSess_5518,None,SP_5519,UP_5520))
                                )
                                else
                                    {5866}let pkSess_5521: bitstring = fail-any in
                                    {5867}in(c, =GetEndpointRequest);
                                    {5868}new SP_5522: bitstring;
                                    {5869}new UP_5523: bitstring;
                                    {5870}out(c, (GetEndpointResponse,pkSess_5521,None,SP_5522,UP_5523))
                        )
                        else
                            {5871}let pkCli_5524: bitstring = fail-any in
                            {5872}let v_5525: bool = (Sess_4517 = A) in
                            (
                                {5873}if v_5525 then
                                (
                                    {5874}let pkSess_5526: bitstring = pub(skA) in
                                    {5875}in(c, =GetEndpointRequest);
                                    {5876}new SP_5527: bitstring;
                                    {5877}new UP_5528: bitstring;
                                    {5878}out(c, (GetEndpointResponse,pkSess_5526,None,SP_5527,UP_5528))
                                )
                                else
                                    {5879}let v_5529: bool = (Sess_4517 = B) in
                                    (
                                        {5880}if v_5529 then
                                        (
                                            {5881}let pkSess_5530: bitstring = pub(skB) in
                                            {5882}in(c, =GetEndpointRequest);
                                            {5883}new SP_5531: bitstring;
                                            {5884}new UP_5532: bitstring;
                                            {5885}out(c, (GetEndpointResponse,pkSess_5530,None,SP_5531,UP_5532))
                                        )
                                        else
                                            {5886}let v_5533: bool = (Sess_4517 = C) in
                                            (
                                                {5887}if v_5533 then
                                                (
                                                    {5888}let pkSess_5534: bitstring = pub(skC) in
                                                    {5889}in(c, =GetEndpointRequest);
                                                    {5890}new SP_5535: bitstring;
                                                    {5891}new UP_5536: bitstring;
                                                    {5892}out(c, (GetEndpointResponse,pkSess_5534,None,SP_5535,UP_5536))
                                                )
                                                else
                                                    {5893}let pkSess_5537: bitstring = pub(sk(Sess_4517)) in
                                                    {5894}in(c, =GetEndpointRequest);
                                                    {5895}new SP_5538: bitstring;
                                                    {5896}new UP_5539: bitstring;
                                                    {5897}out(c, (GetEndpointResponse,pkSess_5537,None,SP_5538,UP_5539))
                                            )
                                            else
                                                {5898}let pkSess_5540: bitstring = fail-any in
                                                {5899}in(c, =GetEndpointRequest);
                                                {5900}new SP_5541: bitstring;
                                                {5901}new UP_5542: bitstring;
                                                {5902}out(c, (GetEndpointResponse,pkSess_5540,None,SP_5541,UP_5542))
                                    )
                                    else
                                        {5903}let pkSess_5543: bitstring = fail-any in
                                        {5904}in(c, =GetEndpointRequest);
                                        {5905}new SP_5544: bitstring;
                                        {5906}new UP_5545: bitstring;
                                        {5907}out(c, (GetEndpointResponse,pkSess_5543,None,SP_5544,UP_5545))
                            )
                            else
                                {5908}let pkSess_5546: bitstring = fail-any in
                                {5909}in(c, =GetEndpointRequest);
                                {5910}new SP_5547: bitstring;
                                {5911}new UP_5548: bitstring;
                                {5912}out(c, (GetEndpointResponse,pkSess_5546,None,SP_5547,UP_5548))
                )
                else
                    {5913}let pkCli_5549: bitstring = fail-any in
                    {5914}let v_5550: bool = (Sess_4517 = A) in
                    (
                        {5915}if v_5550 then
                        (
                            {5916}let pkSess_5551: bitstring = pub(skA) in
                            {5917}in(c, =GetEndpointRequest);
                            {5918}new SP_5552: bitstring;
                            {5919}new UP_5553: bitstring;
                            {5920}out(c, (GetEndpointResponse,pkSess_5551,None,SP_5552,UP_5553))
                        )
                        else
                            {5921}let v_5554: bool = (Sess_4517 = B) in
                            (
                                {5922}if v_5554 then
                                (
                                    {5923}let pkSess_5555: bitstring = pub(skB) in
                                    {5924}in(c, =GetEndpointRequest);
                                    {5925}new SP_5556: bitstring;
                                    {5926}new UP_5557: bitstring;
                                    {5927}out(c, (GetEndpointResponse,pkSess_5555,None,SP_5556,UP_5557))
                                )
                                else
                                    {5928}let v_5558: bool = (Sess_4517 = C) in
                                    (
                                        {5929}if v_5558 then
                                        (
                                            {5930}let pkSess_5559: bitstring = pub(skC) in
                                            {5931}in(c, =GetEndpointRequest);
                                            {5932}new SP_5560: bitstring;
                                            {5933}new UP_5561: bitstring;
                                            {5934}out(c, (GetEndpointResponse,pkSess_5559,None,SP_5560,UP_5561))
                                        )
                                        else
                                            {5935}let pkSess_5562: bitstring = pub(sk(Sess_4517)) in
                                            {5936}in(c, =GetEndpointRequest);
                                            {5937}new SP_5563: bitstring;
                                            {5938}new UP_5564: bitstring;
                                            {5939}out(c, (GetEndpointResponse,pkSess_5562,None,SP_5563,UP_5564))
                                    )
                                    else
                                        {5940}let pkSess_5565: bitstring = fail-any in
                                        {5941}in(c, =GetEndpointRequest);
                                        {5942}new SP_5566: bitstring;
                                        {5943}new UP_5567: bitstring;
                                        {5944}out(c, (GetEndpointResponse,pkSess_5565,None,SP_5566,UP_5567))
                            )
                            else
                                {5945}let pkSess_5568: bitstring = fail-any in
                                {5946}in(c, =GetEndpointRequest);
                                {5947}new SP_5569: bitstring;
                                {5948}new UP_5570: bitstring;
                                {5949}out(c, (GetEndpointResponse,pkSess_5568,None,SP_5569,UP_5570))
                    )
                    else
                        {5950}let pkSess_5571: bitstring = fail-any in
                        {5951}in(c, =GetEndpointRequest);
                        {5952}new SP_5572: bitstring;
                        {5953}new UP_5573: bitstring;
                        {5954}out(c, (GetEndpointResponse,pkSess_5571,None,SP_5572,UP_5573))
        )
        else
            {5955}let pkCli_5574: bitstring = fail-any in
            {5956}let v_5575: bool = (Sess_4517 = A) in
            (
                {5957}if v_5575 then
                (
                    {5958}let pkSess_5576: bitstring = pub(skA) in
                    {5959}in(c, =GetEndpointRequest);
                    {5960}new SP_5577: bitstring;
                    {5961}new UP_5578: bitstring;
                    {5962}out(c, (GetEndpointResponse,pkSess_5576,None,SP_5577,UP_5578))
                )
                else
                    {5963}let v_5579: bool = (Sess_4517 = B) in
                    (
                        {5964}if v_5579 then
                        (
                            {5965}let pkSess_5580: bitstring = pub(skB) in
                            {5966}in(c, =GetEndpointRequest);
                            {5967}new SP_5581: bitstring;
                            {5968}new UP_5582: bitstring;
                            {5969}out(c, (GetEndpointResponse,pkSess_5580,None,SP_5581,UP_5582))
                        )
                        else
                            {5970}let v_5583: bool = (Sess_4517 = C) in
                            (
                                {5971}if v_5583 then
                                (
                                    {5972}let pkSess_5584: bitstring = pub(skC) in
                                    {5973}in(c, =GetEndpointRequest);
                                    {5974}new SP_5585: bitstring;
                                    {5975}new UP_5586: bitstring;
                                    {5976}out(c, (GetEndpointResponse,pkSess_5584,None,SP_5585,UP_5586))
                                )
                                else
                                    {5977}let pkSess_5587: bitstring = pub(sk(Sess_4517)) in
                                    {5978}in(c, =GetEndpointRequest);
                                    {5979}new SP_5588: bitstring;
                                    {5980}new UP_5589: bitstring;
                                    {5981}out(c, (GetEndpointResponse,pkSess_5587,None,SP_5588,UP_5589))
                            )
                            else
                                {5982}let pkSess_5590: bitstring = fail-any in
                                {5983}in(c, =GetEndpointRequest);
                                {5984}new SP_5591: bitstring;
                                {5985}new UP_5592: bitstring;
                                {5986}out(c, (GetEndpointResponse,pkSess_5590,None,SP_5591,UP_5592))
                    )
                    else
                        {5987}let pkSess_5593: bitstring = fail-any in
                        {5988}in(c, =GetEndpointRequest);
                        {5989}new SP_5594: bitstring;
                        {5990}new UP_5595: bitstring;
                        {5991}out(c, (GetEndpointResponse,pkSess_5593,None,SP_5594,UP_5595))
            )
            else
                {5992}let pkSess_5596: bitstring = fail-any in
                {5993}in(c, =GetEndpointRequest);
                {5994}new SP_5597: bitstring;
                {5995}new UP_5598: bitstring;
                {5996}out(c, (GetEndpointResponse,pkSess_5596,None,SP_5597,UP_5598))
) | (
    {5997}!
    {5998}in(c, (Cli_5599: host,Disco_5600: host,Sess_5601: host));
    {5999}let v_5602: bool = (Sess_5601 = A) in
    (
        {6000}if v_5602 then
        (
            {6001}let skSess: bitstring = skA in
            {6002}let pkSess_5603: bitstring = pub(skSess) in
            {6003}let v_5604: bool = (Cli_5599 = A) in
            (
                {6004}if v_5604 then
                (
                    {6005}let pkCli_5605: bitstring = pub(skA) in
                    {6006}let v_5606: bool = (Disco_5600 = A) in
                    (
                        {6007}if v_5606 then
                        (
                            {6008}let pkDisco_5607: bitstring = pub(skA) in
                            {6009}in(c, (=pkCli_5605,em1: bitstring));
                            {6010}let m1_5608: bitstring = em1 in
                            {6011}let (=OpenSecureChannelRequest,=pkCli_5605,wNc_5609: bitstring) = m1_5608 in
                            {6012}let Nc_5610: bitstring = dec(wNc_5609,skSess) in
                            {6013}new Ns_5611: bitstring;
                            {6014}new ST_5612: bitstring;
                            {6015}new TTL_5613: bitstring;
                            {6016}let wNs_5614: bitstring = enc(Ns_5611,pkCli_5605) in
                            {6017}let m2_5615: bitstring = (OpenSecureChannelResponse,wNs_5614,ST_5612,TTL_5613) in
                            {6018}out(c, m2_5615);
                            {6019}let Ksrv: bitstring = h((Ns_5611,Nc_5610)) in
                            {6020}out(c, senc(mSrv(pkCli_5605,pkSess_5603),Ksrv))
                        )
                        else
                            {6021}let v_5616: bool = (Disco_5600 = B) in
                            (
                                {6022}if v_5616 then
                                (
                                    {6023}let pkDisco_5617: bitstring = pub(skB) in
                                    {6024}in(c, (=pkCli_5605,em1_5618: bitstring));
                                    {6025}let m1_5619: bitstring = em1_5618 in
                                    {6026}let (=OpenSecureChannelRequest,=pkCli_5605,wNc_5620: bitstring) = m1_5619 in
                                    {6027}let Nc_5621: bitstring = dec(wNc_5620,skSess) in
                                    {6028}new Ns_5622: bitstring;
                                    {6029}new ST_5623: bitstring;
                                    {6030}new TTL_5624: bitstring;
                                    {6031}let wNs_5625: bitstring = enc(Ns_5622,pkCli_5605) in
                                    {6032}let m2_5626: bitstring = (OpenSecureChannelResponse,wNs_5625,ST_5623,TTL_5624) in
                                    {6033}out(c, m2_5626);
                                    {6034}let Ksrv_5627: bitstring = h((Ns_5622,Nc_5621)) in
                                    {6035}out(c, senc(mSrv(pkCli_5605,pkSess_5603),Ksrv_5627))
                                )
                                else
                                    {6036}let v_5628: bool = (Disco_5600 = C) in
                                    (
                                        {6037}if v_5628 then
                                        (
                                            {6038}let pkDisco_5629: bitstring = pub(skC) in
                                            {6039}in(c, (=pkCli_5605,em1_5630: bitstring));
                                            {6040}let m1_5631: bitstring = em1_5630 in
                                            {6041}let (=OpenSecureChannelRequest,=pkCli_5605,wNc_5632: bitstring) = m1_5631 in
                                            {6042}let Nc_5633: bitstring = dec(wNc_5632,skSess) in
                                            {6043}new Ns_5634: bitstring;
                                            {6044}new ST_5635: bitstring;
                                            {6045}new TTL_5636: bitstring;
                                            {6046}let wNs_5637: bitstring = enc(Ns_5634,pkCli_5605) in
                                            {6047}let m2_5638: bitstring = (OpenSecureChannelResponse,wNs_5637,ST_5635,TTL_5636) in
                                            {6048}out(c, m2_5638);
                                            {6049}let Ksrv_5639: bitstring = h((Ns_5634,Nc_5633)) in
                                            {6050}out(c, senc(mSrv(pkCli_5605,pkSess_5603),Ksrv_5639))
                                        )
                                        else
                                            {6051}let pkDisco_5640: bitstring = pub(sk(Disco_5600)) in
                                            {6052}in(c, (=pkCli_5605,em1_5641: bitstring));
                                            {6053}let m1_5642: bitstring = em1_5641 in
                                            {6054}let (=OpenSecureChannelRequest,=pkCli_5605,wNc_5643: bitstring) = m1_5642 in
                                            {6055}let Nc_5644: bitstring = dec(wNc_5643,skSess) in
                                            {6056}new Ns_5645: bitstring;
                                            {6057}new ST_5646: bitstring;
                                            {6058}new TTL_5647: bitstring;
                                            {6059}let wNs_5648: bitstring = enc(Ns_5645,pkCli_5605) in
                                            {6060}let m2_5649: bitstring = (OpenSecureChannelResponse,wNs_5648,ST_5646,TTL_5647) in
                                            {6061}out(c, m2_5649);
                                            {6062}let Ksrv_5650: bitstring = h((Ns_5645,Nc_5644)) in
                                            {6063}out(c, senc(mSrv(pkCli_5605,pkSess_5603),Ksrv_5650))
                                    )
                                    else
                                        {6064}let pkDisco_5651: bitstring = fail-any in
                                        {6065}in(c, (=pkCli_5605,em1_5652: bitstring));
                                        {6066}let m1_5653: bitstring = em1_5652 in
                                        {6067}let (=OpenSecureChannelRequest,=pkCli_5605,wNc_5654: bitstring) = m1_5653 in
                                        {6068}let Nc_5655: bitstring = dec(wNc_5654,skSess) in
                                        {6069}new Ns_5656: bitstring;
                                        {6070}new ST_5657: bitstring;
                                        {6071}new TTL_5658: bitstring;
                                        {6072}let wNs_5659: bitstring = enc(Ns_5656,pkCli_5605) in
                                        {6073}let m2_5660: bitstring = (OpenSecureChannelResponse,wNs_5659,ST_5657,TTL_5658) in
                                        {6074}out(c, m2_5660);
                                        {6075}let Ksrv_5661: bitstring = h((Ns_5656,Nc_5655)) in
                                        {6076}out(c, senc(mSrv(pkCli_5605,pkSess_5603),Ksrv_5661))
                            )
                            else
                                {6077}let pkDisco_5662: bitstring = fail-any in
                                {6078}in(c, (=pkCli_5605,em1_5663: bitstring));
                                {6079}let m1_5664: bitstring = em1_5663 in
                                {6080}let (=OpenSecureChannelRequest,=pkCli_5605,wNc_5665: bitstring) = m1_5664 in
                                {6081}let Nc_5666: bitstring = dec(wNc_5665,skSess) in
                                {6082}new Ns_5667: bitstring;
                                {6083}new ST_5668: bitstring;
                                {6084}new TTL_5669: bitstring;
                                {6085}let wNs_5670: bitstring = enc(Ns_5667,pkCli_5605) in
                                {6086}let m2_5671: bitstring = (OpenSecureChannelResponse,wNs_5670,ST_5668,TTL_5669) in
                                {6087}out(c, m2_5671);
                                {6088}let Ksrv_5672: bitstring = h((Ns_5667,Nc_5666)) in
                                {6089}out(c, senc(mSrv(pkCli_5605,pkSess_5603),Ksrv_5672))
                    )
                    else
                        {6090}let pkDisco_5673: bitstring = fail-any in
                        {6091}in(c, (=pkCli_5605,em1_5674: bitstring));
                        {6092}let m1_5675: bitstring = em1_5674 in
                        {6093}let (=OpenSecureChannelRequest,=pkCli_5605,wNc_5676: bitstring) = m1_5675 in
                        {6094}let Nc_5677: bitstring = dec(wNc_5676,skSess) in
                        {6095}new Ns_5678: bitstring;
                        {6096}new ST_5679: bitstring;
                        {6097}new TTL_5680: bitstring;
                        {6098}let wNs_5681: bitstring = enc(Ns_5678,pkCli_5605) in
                        {6099}let m2_5682: bitstring = (OpenSecureChannelResponse,wNs_5681,ST_5679,TTL_5680) in
                        {6100}out(c, m2_5682);
                        {6101}let Ksrv_5683: bitstring = h((Ns_5678,Nc_5677)) in
                        {6102}out(c, senc(mSrv(pkCli_5605,pkSess_5603),Ksrv_5683))
                )
                else
                    {6103}let v_5684: bool = (Cli_5599 = B) in
                    (
                        {6104}if v_5684 then
                        (
                            {6105}let pkCli_5685: bitstring = pub(skB) in
                            {6106}let v_5686: bool = (Disco_5600 = A) in
                            (
                                {6107}if v_5686 then
                                (
                                    {6108}let pkDisco_5687: bitstring = pub(skA) in
                                    {6109}in(c, (=pkCli_5685,em1_5688: bitstring));
                                    {6110}let m1_5689: bitstring = em1_5688 in
                                    {6111}let (=OpenSecureChannelRequest,=pkCli_5685,wNc_5690: bitstring) = m1_5689 in
                                    {6112}let Nc_5691: bitstring = dec(wNc_5690,skSess) in
                                    {6113}new Ns_5692: bitstring;
                                    {6114}new ST_5693: bitstring;
                                    {6115}new TTL_5694: bitstring;
                                    {6116}let wNs_5695: bitstring = enc(Ns_5692,pkCli_5685) in
                                    {6117}let m2_5696: bitstring = (OpenSecureChannelResponse,wNs_5695,ST_5693,TTL_5694) in
                                    {6118}out(c, m2_5696);
                                    {6119}let Ksrv_5697: bitstring = h((Ns_5692,Nc_5691)) in
                                    {6120}out(c, senc(mSrv(pkCli_5685,pkSess_5603),Ksrv_5697))
                                )
                                else
                                    {6121}let v_5698: bool = (Disco_5600 = B) in
                                    (
                                        {6122}if v_5698 then
                                        (
                                            {6123}let pkDisco_5699: bitstring = pub(skB) in
                                            {6124}in(c, (=pkCli_5685,em1_5700: bitstring));
                                            {6125}let m1_5701: bitstring = em1_5700 in
                                            {6126}let (=OpenSecureChannelRequest,=pkCli_5685,wNc_5702: bitstring) = m1_5701 in
                                            {6127}let Nc_5703: bitstring = dec(wNc_5702,skSess) in
                                            {6128}new Ns_5704: bitstring;
                                            {6129}new ST_5705: bitstring;
                                            {6130}new TTL_5706: bitstring;
                                            {6131}let wNs_5707: bitstring = enc(Ns_5704,pkCli_5685) in
                                            {6132}let m2_5708: bitstring = (OpenSecureChannelResponse,wNs_5707,ST_5705,TTL_5706) in
                                            {6133}out(c, m2_5708);
                                            {6134}let Ksrv_5709: bitstring = h((Ns_5704,Nc_5703)) in
                                            {6135}out(c, senc(mSrv(pkCli_5685,pkSess_5603),Ksrv_5709))
                                        )
                                        else
                                            {6136}let v_5710: bool = (Disco_5600 = C) in
                                            (
                                                {6137}if v_5710 then
                                                (
                                                    {6138}let pkDisco_5711: bitstring = pub(skC) in
                                                    {6139}in(c, (=pkCli_5685,em1_5712: bitstring));
                                                    {6140}let m1_5713: bitstring = em1_5712 in
                                                    {6141}let (=OpenSecureChannelRequest,=pkCli_5685,wNc_5714: bitstring) = m1_5713 in
                                                    {6142}let Nc_5715: bitstring = dec(wNc_5714,skSess) in
                                                    {6143}new Ns_5716: bitstring;
                                                    {6144}new ST_5717: bitstring;
                                                    {6145}new TTL_5718: bitstring;
                                                    {6146}let wNs_5719: bitstring = enc(Ns_5716,pkCli_5685) in
                                                    {6147}let m2_5720: bitstring = (OpenSecureChannelResponse,wNs_5719,ST_5717,TTL_5718) in
                                                    {6148}out(c, m2_5720);
                                                    {6149}let Ksrv_5721: bitstring = h((Ns_5716,Nc_5715)) in
                                                    {6150}out(c, senc(mSrv(pkCli_5685,pkSess_5603),Ksrv_5721))
                                                )
                                                else
                                                    {6151}let pkDisco_5722: bitstring = pub(sk(Disco_5600)) in
                                                    {6152}in(c, (=pkCli_5685,em1_5723: bitstring));
                                                    {6153}let m1_5724: bitstring = em1_5723 in
                                                    {6154}let (=OpenSecureChannelRequest,=pkCli_5685,wNc_5725: bitstring) = m1_5724 in
                                                    {6155}let Nc_5726: bitstring = dec(wNc_5725,skSess) in
                                                    {6156}new Ns_5727: bitstring;
                                                    {6157}new ST_5728: bitstring;
                                                    {6158}new TTL_5729: bitstring;
                                                    {6159}let wNs_5730: bitstring = enc(Ns_5727,pkCli_5685) in
                                                    {6160}let m2_5731: bitstring = (OpenSecureChannelResponse,wNs_5730,ST_5728,TTL_5729) in
                                                    {6161}out(c, m2_5731);
                                                    {6162}let Ksrv_5732: bitstring = h((Ns_5727,Nc_5726)) in
                                                    {6163}out(c, senc(mSrv(pkCli_5685,pkSess_5603),Ksrv_5732))
                                            )
                                            else
                                                {6164}let pkDisco_5733: bitstring = fail-any in
                                                {6165}in(c, (=pkCli_5685,em1_5734: bitstring));
                                                {6166}let m1_5735: bitstring = em1_5734 in
                                                {6167}let (=OpenSecureChannelRequest,=pkCli_5685,wNc_5736: bitstring) = m1_5735 in
                                                {6168}let Nc_5737: bitstring = dec(wNc_5736,skSess) in
                                                {6169}new Ns_5738: bitstring;
                                                {6170}new ST_5739: bitstring;
                                                {6171}new TTL_5740: bitstring;
                                                {6172}let wNs_5741: bitstring = enc(Ns_5738,pkCli_5685) in
                                                {6173}let m2_5742: bitstring = (OpenSecureChannelResponse,wNs_5741,ST_5739,TTL_5740) in
                                                {6174}out(c, m2_5742);
                                                {6175}let Ksrv_5743: bitstring = h((Ns_5738,Nc_5737)) in
                                                {6176}out(c, senc(mSrv(pkCli_5685,pkSess_5603),Ksrv_5743))
                                    )
                                    else
                                        {6177}let pkDisco_5744: bitstring = fail-any in
                                        {6178}in(c, (=pkCli_5685,em1_5745: bitstring));
                                        {6179}let m1_5746: bitstring = em1_5745 in
                                        {6180}let (=OpenSecureChannelRequest,=pkCli_5685,wNc_5747: bitstring) = m1_5746 in
                                        {6181}let Nc_5748: bitstring = dec(wNc_5747,skSess) in
                                        {6182}new Ns_5749: bitstring;
                                        {6183}new ST_5750: bitstring;
                                        {6184}new TTL_5751: bitstring;
                                        {6185}let wNs_5752: bitstring = enc(Ns_5749,pkCli_5685) in
                                        {6186}let m2_5753: bitstring = (OpenSecureChannelResponse,wNs_5752,ST_5750,TTL_5751) in
                                        {6187}out(c, m2_5753);
                                        {6188}let Ksrv_5754: bitstring = h((Ns_5749,Nc_5748)) in
                                        {6189}out(c, senc(mSrv(pkCli_5685,pkSess_5603),Ksrv_5754))
                            )
                            else
                                {6190}let pkDisco_5755: bitstring = fail-any in
                                {6191}in(c, (=pkCli_5685,em1_5756: bitstring));
                                {6192}let m1_5757: bitstring = em1_5756 in
                                {6193}let (=OpenSecureChannelRequest,=pkCli_5685,wNc_5758: bitstring) = m1_5757 in
                                {6194}let Nc_5759: bitstring = dec(wNc_5758,skSess) in
                                {6195}new Ns_5760: bitstring;
                                {6196}new ST_5761: bitstring;
                                {6197}new TTL_5762: bitstring;
                                {6198}let wNs_5763: bitstring = enc(Ns_5760,pkCli_5685) in
                                {6199}let m2_5764: bitstring = (OpenSecureChannelResponse,wNs_5763,ST_5761,TTL_5762) in
                                {6200}out(c, m2_5764);
                                {6201}let Ksrv_5765: bitstring = h((Ns_5760,Nc_5759)) in
                                {6202}out(c, senc(mSrv(pkCli_5685,pkSess_5603),Ksrv_5765))
                        )
                        else
                            {6203}let v_5766: bool = (Cli_5599 = C) in
                            (
                                {6204}if v_5766 then
                                (
                                    {6205}let pkCli_5767: bitstring = pub(skC) in
                                    {6206}let v_5768: bool = (Disco_5600 = A) in
                                    (
                                        {6207}if v_5768 then
                                        (
                                            {6208}let pkDisco_5769: bitstring = pub(skA) in
                                            {6209}in(c, (=pkCli_5767,em1_5770: bitstring));
                                            {6210}let m1_5771: bitstring = em1_5770 in
                                            {6211}let (=OpenSecureChannelRequest,=pkCli_5767,wNc_5772: bitstring) = m1_5771 in
                                            {6212}let Nc_5773: bitstring = dec(wNc_5772,skSess) in
                                            {6213}new Ns_5774: bitstring;
                                            {6214}new ST_5775: bitstring;
                                            {6215}new TTL_5776: bitstring;
                                            {6216}let wNs_5777: bitstring = enc(Ns_5774,pkCli_5767) in
                                            {6217}let m2_5778: bitstring = (OpenSecureChannelResponse,wNs_5777,ST_5775,TTL_5776) in
                                            {6218}out(c, m2_5778);
                                            {6219}let Ksrv_5779: bitstring = h((Ns_5774,Nc_5773)) in
                                            {6220}out(c, senc(mSrv(pkCli_5767,pkSess_5603),Ksrv_5779))
                                        )
                                        else
                                            {6221}let v_5780: bool = (Disco_5600 = B) in
                                            (
                                                {6222}if v_5780 then
                                                (
                                                    {6223}let pkDisco_5781: bitstring = pub(skB) in
                                                    {6224}in(c, (=pkCli_5767,em1_5782: bitstring));
                                                    {6225}let m1_5783: bitstring = em1_5782 in
                                                    {6226}let (=OpenSecureChannelRequest,=pkCli_5767,wNc_5784: bitstring) = m1_5783 in
                                                    {6227}let Nc_5785: bitstring = dec(wNc_5784,skSess) in
                                                    {6228}new Ns_5786: bitstring;
                                                    {6229}new ST_5787: bitstring;
                                                    {6230}new TTL_5788: bitstring;
                                                    {6231}let wNs_5789: bitstring = enc(Ns_5786,pkCli_5767) in
                                                    {6232}let m2_5790: bitstring = (OpenSecureChannelResponse,wNs_5789,ST_5787,TTL_5788) in
                                                    {6233}out(c, m2_5790);
                                                    {6234}let Ksrv_5791: bitstring = h((Ns_5786,Nc_5785)) in
                                                    {6235}out(c, senc(mSrv(pkCli_5767,pkSess_5603),Ksrv_5791))
                                                )
                                                else
                                                    {6236}let v_5792: bool = (Disco_5600 = C) in
                                                    (
                                                        {6237}if v_5792 then
                                                        (
                                                            {6238}let pkDisco_5793: bitstring = pub(skC) in
                                                            {6239}in(c, (=pkCli_5767,em1_5794: bitstring));
                                                            {6240}let m1_5795: bitstring = em1_5794 in
                                                            {6241}let (=OpenSecureChannelRequest,=pkCli_5767,wNc_5796: bitstring) = m1_5795 in
                                                            {6242}let Nc_5797: bitstring = dec(wNc_5796,skSess) in
                                                            {6243}new Ns_5798: bitstring;
                                                            {6244}new ST_5799: bitstring;
                                                            {6245}new TTL_5800: bitstring;
                                                            {6246}let wNs_5801: bitstring = enc(Ns_5798,pkCli_5767) in
                                                            {6247}let m2_5802: bitstring = (OpenSecureChannelResponse,wNs_5801,ST_5799,TTL_5800) in
                                                            {6248}out(c, m2_5802);
                                                            {6249}let Ksrv_5803: bitstring = h((Ns_5798,Nc_5797)) in
                                                            {6250}out(c, senc(mSrv(pkCli_5767,pkSess_5603),Ksrv_5803))
                                                        )
                                                        else
                                                            {6251}let pkDisco_5804: bitstring = pub(sk(Disco_5600)) in
                                                            {6252}in(c, (=pkCli_5767,em1_5805: bitstring));
                                                            {6253}let m1_5806: bitstring = em1_5805 in
                                                            {6254}let (=OpenSecureChannelRequest,=pkCli_5767,wNc_5807: bitstring) = m1_5806 in
                                                            {6255}let Nc_5808: bitstring = dec(wNc_5807,skSess) in
                                                            {6256}new Ns_5809: bitstring;
                                                            {6257}new ST_5810: bitstring;
                                                            {6258}new TTL_5811: bitstring;
                                                            {6259}let wNs_5812: bitstring = enc(Ns_5809,pkCli_5767) in
                                                            {6260}let m2_5813: bitstring = (OpenSecureChannelResponse,wNs_5812,ST_5810,TTL_5811) in
                                                            {6261}out(c, m2_5813);
                                                            {6262}let Ksrv_5814: bitstring = h((Ns_5809,Nc_5808)) in
                                                            {6263}out(c, senc(mSrv(pkCli_5767,pkSess_5603),Ksrv_5814))
                                                    )
                                                    else
                                                        {6264}let pkDisco_5815: bitstring = fail-any in
                                                        {6265}in(c, (=pkCli_5767,em1_5816: bitstring));
                                                        {6266}let m1_5817: bitstring = em1_5816 in
                                                        {6267}let (=OpenSecureChannelRequest,=pkCli_5767,wNc_5818: bitstring) = m1_5817 in
                                                        {6268}let Nc_5819: bitstring = dec(wNc_5818,skSess) in
                                                        {6269}new Ns_5820: bitstring;
                                                        {6270}new ST_5821: bitstring;
                                                        {6271}new TTL_5822: bitstring;
                                                        {6272}let wNs_5823: bitstring = enc(Ns_5820,pkCli_5767) in
                                                        {6273}let m2_5824: bitstring = (OpenSecureChannelResponse,wNs_5823,ST_5821,TTL_5822) in
                                                        {6274}out(c, m2_5824);
                                                        {6275}let Ksrv_5825: bitstring = h((Ns_5820,Nc_5819)) in
                                                        {6276}out(c, senc(mSrv(pkCli_5767,pkSess_5603),Ksrv_5825))
                                            )
                                            else
                                                {6277}let pkDisco_5826: bitstring = fail-any in
                                                {6278}in(c, (=pkCli_5767,em1_5827: bitstring));
                                                {6279}let m1_5828: bitstring = em1_5827 in
                                                {6280}let (=OpenSecureChannelRequest,=pkCli_5767,wNc_5829: bitstring) = m1_5828 in
                                                {6281}let Nc_5830: bitstring = dec(wNc_5829,skSess) in
                                                {6282}new Ns_5831: bitstring;
                                                {6283}new ST_5832: bitstring;
                                                {6284}new TTL_5833: bitstring;
                                                {6285}let wNs_5834: bitstring = enc(Ns_5831,pkCli_5767) in
                                                {6286}let m2_5835: bitstring = (OpenSecureChannelResponse,wNs_5834,ST_5832,TTL_5833) in
                                                {6287}out(c, m2_5835);
                                                {6288}let Ksrv_5836: bitstring = h((Ns_5831,Nc_5830)) in
                                                {6289}out(c, senc(mSrv(pkCli_5767,pkSess_5603),Ksrv_5836))
                                    )
                                    else
                                        {6290}let pkDisco_5837: bitstring = fail-any in
                                        {6291}in(c, (=pkCli_5767,em1_5838: bitstring));
                                        {6292}let m1_5839: bitstring = em1_5838 in
                                        {6293}let (=OpenSecureChannelRequest,=pkCli_5767,wNc_5840: bitstring) = m1_5839 in
                                        {6294}let Nc_5841: bitstring = dec(wNc_5840,skSess) in
                                        {6295}new Ns_5842: bitstring;
                                        {6296}new ST_5843: bitstring;
                                        {6297}new TTL_5844: bitstring;
                                        {6298}let wNs_5845: bitstring = enc(Ns_5842,pkCli_5767) in
                                        {6299}let m2_5846: bitstring = (OpenSecureChannelResponse,wNs_5845,ST_5843,TTL_5844) in
                                        {6300}out(c, m2_5846);
                                        {6301}let Ksrv_5847: bitstring = h((Ns_5842,Nc_5841)) in
                                        {6302}out(c, senc(mSrv(pkCli_5767,pkSess_5603),Ksrv_5847))
                                )
                                else
                                    {6303}let pkCli_5848: bitstring = pub(sk(Cli_5599)) in
                                    {6304}let v_5849: bool = (Disco_5600 = A) in
                                    (
                                        {6305}if v_5849 then
                                        (
                                            {6306}let pkDisco_5850: bitstring = pub(skA) in
                                            {6307}in(c, (=pkCli_5848,em1_5851: bitstring));
                                            {6308}let m1_5852: bitstring = em1_5851 in
                                            {6309}let (=OpenSecureChannelRequest,=pkCli_5848,wNc_5853: bitstring) = m1_5852 in
                                            {6310}let Nc_5854: bitstring = dec(wNc_5853,skSess) in
                                            {6311}new Ns_5855: bitstring;
                                            {6312}new ST_5856: bitstring;
                                            {6313}new TTL_5857: bitstring;
                                            {6314}let wNs_5858: bitstring = enc(Ns_5855,pkCli_5848) in
                                            {6315}let m2_5859: bitstring = (OpenSecureChannelResponse,wNs_5858,ST_5856,TTL_5857) in
                                            {6316}out(c, m2_5859);
                                            {6317}let Ksrv_5860: bitstring = h((Ns_5855,Nc_5854)) in
                                            {6318}out(c, senc(mSrv(pkCli_5848,pkSess_5603),Ksrv_5860))
                                        )
                                        else
                                            {6319}let v_5861: bool = (Disco_5600 = B) in
                                            (
                                                {6320}if v_5861 then
                                                (
                                                    {6321}let pkDisco_5862: bitstring = pub(skB) in
                                                    {6322}in(c, (=pkCli_5848,em1_5863: bitstring));
                                                    {6323}let m1_5864: bitstring = em1_5863 in
                                                    {6324}let (=OpenSecureChannelRequest,=pkCli_5848,wNc_5865: bitstring) = m1_5864 in
                                                    {6325}let Nc_5866: bitstring = dec(wNc_5865,skSess) in
                                                    {6326}new Ns_5867: bitstring;
                                                    {6327}new ST_5868: bitstring;
                                                    {6328}new TTL_5869: bitstring;
                                                    {6329}let wNs_5870: bitstring = enc(Ns_5867,pkCli_5848) in
                                                    {6330}let m2_5871: bitstring = (OpenSecureChannelResponse,wNs_5870,ST_5868,TTL_5869) in
                                                    {6331}out(c, m2_5871);
                                                    {6332}let Ksrv_5872: bitstring = h((Ns_5867,Nc_5866)) in
                                                    {6333}out(c, senc(mSrv(pkCli_5848,pkSess_5603),Ksrv_5872))
                                                )
                                                else
                                                    {6334}let v_5873: bool = (Disco_5600 = C) in
                                                    (
                                                        {6335}if v_5873 then
                                                        (
                                                            {6336}let pkDisco_5874: bitstring = pub(skC) in
                                                            {6337}in(c, (=pkCli_5848,em1_5875: bitstring));
                                                            {6338}let m1_5876: bitstring = em1_5875 in
                                                            {6339}let (=OpenSecureChannelRequest,=pkCli_5848,wNc_5877: bitstring) = m1_5876 in
                                                            {6340}let Nc_5878: bitstring = dec(wNc_5877,skSess) in
                                                            {6341}new Ns_5879: bitstring;
                                                            {6342}new ST_5880: bitstring;
                                                            {6343}new TTL_5881: bitstring;
                                                            {6344}let wNs_5882: bitstring = enc(Ns_5879,pkCli_5848) in
                                                            {6345}let m2_5883: bitstring = (OpenSecureChannelResponse,wNs_5882,ST_5880,TTL_5881) in
                                                            {6346}out(c, m2_5883);
                                                            {6347}let Ksrv_5884: bitstring = h((Ns_5879,Nc_5878)) in
                                                            {6348}out(c, senc(mSrv(pkCli_5848,pkSess_5603),Ksrv_5884))
                                                        )
                                                        else
                                                            {6349}let pkDisco_5885: bitstring = pub(sk(Disco_5600)) in
                                                            {6350}in(c, (=pkCli_5848,em1_5886: bitstring));
                                                            {6351}let m1_5887: bitstring = em1_5886 in
                                                            {6352}let (=OpenSecureChannelRequest,=pkCli_5848,wNc_5888: bitstring) = m1_5887 in
                                                            {6353}let Nc_5889: bitstring = dec(wNc_5888,skSess) in
                                                            {6354}new Ns_5890: bitstring;
                                                            {6355}new ST_5891: bitstring;
                                                            {6356}new TTL_5892: bitstring;
                                                            {6357}let wNs_5893: bitstring = enc(Ns_5890,pkCli_5848) in
                                                            {6358}let m2_5894: bitstring = (OpenSecureChannelResponse,wNs_5893,ST_5891,TTL_5892) in
                                                            {6359}out(c, m2_5894);
                                                            {6360}let Ksrv_5895: bitstring = h((Ns_5890,Nc_5889)) in
                                                            {6361}out(c, senc(mSrv(pkCli_5848,pkSess_5603),Ksrv_5895))
                                                    )
                                                    else
                                                        {6362}let pkDisco_5896: bitstring = fail-any in
                                                        {6363}in(c, (=pkCli_5848,em1_5897: bitstring));
                                                        {6364}let m1_5898: bitstring = em1_5897 in
                                                        {6365}let (=OpenSecureChannelRequest,=pkCli_5848,wNc_5899: bitstring) = m1_5898 in
                                                        {6366}let Nc_5900: bitstring = dec(wNc_5899,skSess) in
                                                        {6367}new Ns_5901: bitstring;
                                                        {6368}new ST_5902: bitstring;
                                                        {6369}new TTL_5903: bitstring;
                                                        {6370}let wNs_5904: bitstring = enc(Ns_5901,pkCli_5848) in
                                                        {6371}let m2_5905: bitstring = (OpenSecureChannelResponse,wNs_5904,ST_5902,TTL_5903) in
                                                        {6372}out(c, m2_5905);
                                                        {6373}let Ksrv_5906: bitstring = h((Ns_5901,Nc_5900)) in
                                                        {6374}out(c, senc(mSrv(pkCli_5848,pkSess_5603),Ksrv_5906))
                                            )
                                            else
                                                {6375}let pkDisco_5907: bitstring = fail-any in
                                                {6376}in(c, (=pkCli_5848,em1_5908: bitstring));
                                                {6377}let m1_5909: bitstring = em1_5908 in
                                                {6378}let (=OpenSecureChannelRequest,=pkCli_5848,wNc_5910: bitstring) = m1_5909 in
                                                {6379}let Nc_5911: bitstring = dec(wNc_5910,skSess) in
                                                {6380}new Ns_5912: bitstring;
                                                {6381}new ST_5913: bitstring;
                                                {6382}new TTL_5914: bitstring;
                                                {6383}let wNs_5915: bitstring = enc(Ns_5912,pkCli_5848) in
                                                {6384}let m2_5916: bitstring = (OpenSecureChannelResponse,wNs_5915,ST_5913,TTL_5914) in
                                                {6385}out(c, m2_5916);
                                                {6386}let Ksrv_5917: bitstring = h((Ns_5912,Nc_5911)) in
                                                {6387}out(c, senc(mSrv(pkCli_5848,pkSess_5603),Ksrv_5917))
                                    )
                                    else
                                        {6388}let pkDisco_5918: bitstring = fail-any in
                                        {6389}in(c, (=pkCli_5848,em1_5919: bitstring));
                                        {6390}let m1_5920: bitstring = em1_5919 in
                                        {6391}let (=OpenSecureChannelRequest,=pkCli_5848,wNc_5921: bitstring) = m1_5920 in
                                        {6392}let Nc_5922: bitstring = dec(wNc_5921,skSess) in
                                        {6393}new Ns_5923: bitstring;
                                        {6394}new ST_5924: bitstring;
                                        {6395}new TTL_5925: bitstring;
                                        {6396}let wNs_5926: bitstring = enc(Ns_5923,pkCli_5848) in
                                        {6397}let m2_5927: bitstring = (OpenSecureChannelResponse,wNs_5926,ST_5924,TTL_5925) in
                                        {6398}out(c, m2_5927);
                                        {6399}let Ksrv_5928: bitstring = h((Ns_5923,Nc_5922)) in
                                        {6400}out(c, senc(mSrv(pkCli_5848,pkSess_5603),Ksrv_5928))
                            )
                            else
                                {6401}let pkCli_5929: bitstring = fail-any in
                                {6402}let v_5930: bool = (Disco_5600 = A) in
                                (
                                    {6403}if v_5930 then
                                    (
                                        {6404}let pkDisco_5931: bitstring = pub(skA) in
                                        {6405}in(c, (=pkCli_5929,em1_5932: bitstring));
                                        {6406}let m1_5933: bitstring = em1_5932 in
                                        {6407}let (=OpenSecureChannelRequest,=pkCli_5929,wNc_5934: bitstring) = m1_5933 in
                                        {6408}let Nc_5935: bitstring = dec(wNc_5934,skSess) in
                                        {6409}new Ns_5936: bitstring;
                                        {6410}new ST_5937: bitstring;
                                        {6411}new TTL_5938: bitstring;
                                        {6412}let wNs_5939: bitstring = enc(Ns_5936,pkCli_5929) in
                                        {6413}let m2_5940: bitstring = (OpenSecureChannelResponse,wNs_5939,ST_5937,TTL_5938) in
                                        {6414}out(c, m2_5940);
                                        {6415}let Ksrv_5941: bitstring = h((Ns_5936,Nc_5935)) in
                                        {6416}out(c, senc(mSrv(pkCli_5929,pkSess_5603),Ksrv_5941))
                                    )
                                    else
                                        {6417}let v_5942: bool = (Disco_5600 = B) in
                                        (
                                            {6418}if v_5942 then
                                            (
                                                {6419}let pkDisco_5943: bitstring = pub(skB) in
                                                {6420}in(c, (=pkCli_5929,em1_5944: bitstring));
                                                {6421}let m1_5945: bitstring = em1_5944 in
                                                {6422}let (=OpenSecureChannelRequest,=pkCli_5929,wNc_5946: bitstring) = m1_5945 in
                                                {6423}let Nc_5947: bitstring = dec(wNc_5946,skSess) in
                                                {6424}new Ns_5948: bitstring;
                                                {6425}new ST_5949: bitstring;
                                                {6426}new TTL_5950: bitstring;
                                                {6427}let wNs_5951: bitstring = enc(Ns_5948,pkCli_5929) in
                                                {6428}let m2_5952: bitstring = (OpenSecureChannelResponse,wNs_5951,ST_5949,TTL_5950) in
                                                {6429}out(c, m2_5952);
                                                {6430}let Ksrv_5953: bitstring = h((Ns_5948,Nc_5947)) in
                                                {6431}out(c, senc(mSrv(pkCli_5929,pkSess_5603),Ksrv_5953))
                                            )
                                            else
                                                {6432}let v_5954: bool = (Disco_5600 = C) in
                                                (
                                                    {6433}if v_5954 then
                                                    (
                                                        {6434}let pkDisco_5955: bitstring = pub(skC) in
                                                        {6435}in(c, (=pkCli_5929,em1_5956: bitstring));
                                                        {6436}let m1_5957: bitstring = em1_5956 in
                                                        {6437}let (=OpenSecureChannelRequest,=pkCli_5929,wNc_5958: bitstring) = m1_5957 in
                                                        {6438}let Nc_5959: bitstring = dec(wNc_5958,skSess) in
                                                        {6439}new Ns_5960: bitstring;
                                                        {6440}new ST_5961: bitstring;
                                                        {6441}new TTL_5962: bitstring;
                                                        {6442}let wNs_5963: bitstring = enc(Ns_5960,pkCli_5929) in
                                                        {6443}let m2_5964: bitstring = (OpenSecureChannelResponse,wNs_5963,ST_5961,TTL_5962) in
                                                        {6444}out(c, m2_5964);
                                                        {6445}let Ksrv_5965: bitstring = h((Ns_5960,Nc_5959)) in
                                                        {6446}out(c, senc(mSrv(pkCli_5929,pkSess_5603),Ksrv_5965))
                                                    )
                                                    else
                                                        {6447}let pkDisco_5966: bitstring = pub(sk(Disco_5600)) in
                                                        {6448}in(c, (=pkCli_5929,em1_5967: bitstring));
                                                        {6449}let m1_5968: bitstring = em1_5967 in
                                                        {6450}let (=OpenSecureChannelRequest,=pkCli_5929,wNc_5969: bitstring) = m1_5968 in
                                                        {6451}let Nc_5970: bitstring = dec(wNc_5969,skSess) in
                                                        {6452}new Ns_5971: bitstring;
                                                        {6453}new ST_5972: bitstring;
                                                        {6454}new TTL_5973: bitstring;
                                                        {6455}let wNs_5974: bitstring = enc(Ns_5971,pkCli_5929) in
                                                        {6456}let m2_5975: bitstring = (OpenSecureChannelResponse,wNs_5974,ST_5972,TTL_5973) in
                                                        {6457}out(c, m2_5975);
                                                        {6458}let Ksrv_5976: bitstring = h((Ns_5971,Nc_5970)) in
                                                        {6459}out(c, senc(mSrv(pkCli_5929,pkSess_5603),Ksrv_5976))
                                                )
                                                else
                                                    {6460}let pkDisco_5977: bitstring = fail-any in
                                                    {6461}in(c, (=pkCli_5929,em1_5978: bitstring));
                                                    {6462}let m1_5979: bitstring = em1_5978 in
                                                    {6463}let (=OpenSecureChannelRequest,=pkCli_5929,wNc_5980: bitstring) = m1_5979 in
                                                    {6464}let Nc_5981: bitstring = dec(wNc_5980,skSess) in
                                                    {6465}new Ns_5982: bitstring;
                                                    {6466}new ST_5983: bitstring;
                                                    {6467}new TTL_5984: bitstring;
                                                    {6468}let wNs_5985: bitstring = enc(Ns_5982,pkCli_5929) in
                                                    {6469}let m2_5986: bitstring = (OpenSecureChannelResponse,wNs_5985,ST_5983,TTL_5984) in
                                                    {6470}out(c, m2_5986);
                                                    {6471}let Ksrv_5987: bitstring = h((Ns_5982,Nc_5981)) in
                                                    {6472}out(c, senc(mSrv(pkCli_5929,pkSess_5603),Ksrv_5987))
                                        )
                                        else
                                            {6473}let pkDisco_5988: bitstring = fail-any in
                                            {6474}in(c, (=pkCli_5929,em1_5989: bitstring));
                                            {6475}let m1_5990: bitstring = em1_5989 in
                                            {6476}let (=OpenSecureChannelRequest,=pkCli_5929,wNc_5991: bitstring) = m1_5990 in
                                            {6477}let Nc_5992: bitstring = dec(wNc_5991,skSess) in
                                            {6478}new Ns_5993: bitstring;
                                            {6479}new ST_5994: bitstring;
                                            {6480}new TTL_5995: bitstring;
                                            {6481}let wNs_5996: bitstring = enc(Ns_5993,pkCli_5929) in
                                            {6482}let m2_5997: bitstring = (OpenSecureChannelResponse,wNs_5996,ST_5994,TTL_5995) in
                                            {6483}out(c, m2_5997);
                                            {6484}let Ksrv_5998: bitstring = h((Ns_5993,Nc_5992)) in
                                            {6485}out(c, senc(mSrv(pkCli_5929,pkSess_5603),Ksrv_5998))
                                )
                                else
                                    {6486}let pkDisco_5999: bitstring = fail-any in
                                    {6487}in(c, (=pkCli_5929,em1_6000: bitstring));
                                    {6488}let m1_6001: bitstring = em1_6000 in
                                    {6489}let (=OpenSecureChannelRequest,=pkCli_5929,wNc_6002: bitstring) = m1_6001 in
                                    {6490}let Nc_6003: bitstring = dec(wNc_6002,skSess) in
                                    {6491}new Ns_6004: bitstring;
                                    {6492}new ST_6005: bitstring;
                                    {6493}new TTL_6006: bitstring;
                                    {6494}let wNs_6007: bitstring = enc(Ns_6004,pkCli_5929) in
                                    {6495}let m2_6008: bitstring = (OpenSecureChannelResponse,wNs_6007,ST_6005,TTL_6006) in
                                    {6496}out(c, m2_6008);
                                    {6497}let Ksrv_6009: bitstring = h((Ns_6004,Nc_6003)) in
                                    {6498}out(c, senc(mSrv(pkCli_5929,pkSess_5603),Ksrv_6009))
                    )
                    else
                        {6499}let pkCli_6010: bitstring = fail-any in
                        {6500}let v_6011: bool = (Disco_5600 = A) in
                        (
                            {6501}if v_6011 then
                            (
                                {6502}let pkDisco_6012: bitstring = pub(skA) in
                                {6503}in(c, (=pkCli_6010,em1_6013: bitstring));
                                {6504}let m1_6014: bitstring = em1_6013 in
                                {6505}let (=OpenSecureChannelRequest,=pkCli_6010,wNc_6015: bitstring) = m1_6014 in
                                {6506}let Nc_6016: bitstring = dec(wNc_6015,skSess) in
                                {6507}new Ns_6017: bitstring;
                                {6508}new ST_6018: bitstring;
                                {6509}new TTL_6019: bitstring;
                                {6510}let wNs_6020: bitstring = enc(Ns_6017,pkCli_6010) in
                                {6511}let m2_6021: bitstring = (OpenSecureChannelResponse,wNs_6020,ST_6018,TTL_6019) in
                                {6512}out(c, m2_6021);
                                {6513}let Ksrv_6022: bitstring = h((Ns_6017,Nc_6016)) in
                                {6514}out(c, senc(mSrv(pkCli_6010,pkSess_5603),Ksrv_6022))
                            )
                            else
                                {6515}let v_6023: bool = (Disco_5600 = B) in
                                (
                                    {6516}if v_6023 then
                                    (
                                        {6517}let pkDisco_6024: bitstring = pub(skB) in
                                        {6518}in(c, (=pkCli_6010,em1_6025: bitstring));
                                        {6519}let m1_6026: bitstring = em1_6025 in
                                        {6520}let (=OpenSecureChannelRequest,=pkCli_6010,wNc_6027: bitstring) = m1_6026 in
                                        {6521}let Nc_6028: bitstring = dec(wNc_6027,skSess) in
                                        {6522}new Ns_6029: bitstring;
                                        {6523}new ST_6030: bitstring;
                                        {6524}new TTL_6031: bitstring;
                                        {6525}let wNs_6032: bitstring = enc(Ns_6029,pkCli_6010) in
                                        {6526}let m2_6033: bitstring = (OpenSecureChannelResponse,wNs_6032,ST_6030,TTL_6031) in
                                        {6527}out(c, m2_6033);
                                        {6528}let Ksrv_6034: bitstring = h((Ns_6029,Nc_6028)) in
                                        {6529}out(c, senc(mSrv(pkCli_6010,pkSess_5603),Ksrv_6034))
                                    )
                                    else
                                        {6530}let v_6035: bool = (Disco_5600 = C) in
                                        (
                                            {6531}if v_6035 then
                                            (
                                                {6532}let pkDisco_6036: bitstring = pub(skC) in
                                                {6533}in(c, (=pkCli_6010,em1_6037: bitstring));
                                                {6534}let m1_6038: bitstring = em1_6037 in
                                                {6535}let (=OpenSecureChannelRequest,=pkCli_6010,wNc_6039: bitstring) = m1_6038 in
                                                {6536}let Nc_6040: bitstring = dec(wNc_6039,skSess) in
                                                {6537}new Ns_6041: bitstring;
                                                {6538}new ST_6042: bitstring;
                                                {6539}new TTL_6043: bitstring;
                                                {6540}let wNs_6044: bitstring = enc(Ns_6041,pkCli_6010) in
                                                {6541}let m2_6045: bitstring = (OpenSecureChannelResponse,wNs_6044,ST_6042,TTL_6043) in
                                                {6542}out(c, m2_6045);
                                                {6543}let Ksrv_6046: bitstring = h((Ns_6041,Nc_6040)) in
                                                {6544}out(c, senc(mSrv(pkCli_6010,pkSess_5603),Ksrv_6046))
                                            )
                                            else
                                                {6545}let pkDisco_6047: bitstring = pub(sk(Disco_5600)) in
                                                {6546}in(c, (=pkCli_6010,em1_6048: bitstring));
                                                {6547}let m1_6049: bitstring = em1_6048 in
                                                {6548}let (=OpenSecureChannelRequest,=pkCli_6010,wNc_6050: bitstring) = m1_6049 in
                                                {6549}let Nc_6051: bitstring = dec(wNc_6050,skSess) in
                                                {6550}new Ns_6052: bitstring;
                                                {6551}new ST_6053: bitstring;
                                                {6552}new TTL_6054: bitstring;
                                                {6553}let wNs_6055: bitstring = enc(Ns_6052,pkCli_6010) in
                                                {6554}let m2_6056: bitstring = (OpenSecureChannelResponse,wNs_6055,ST_6053,TTL_6054) in
                                                {6555}out(c, m2_6056);
                                                {6556}let Ksrv_6057: bitstring = h((Ns_6052,Nc_6051)) in
                                                {6557}out(c, senc(mSrv(pkCli_6010,pkSess_5603),Ksrv_6057))
                                        )
                                        else
                                            {6558}let pkDisco_6058: bitstring = fail-any in
                                            {6559}in(c, (=pkCli_6010,em1_6059: bitstring));
                                            {6560}let m1_6060: bitstring = em1_6059 in
                                            {6561}let (=OpenSecureChannelRequest,=pkCli_6010,wNc_6061: bitstring) = m1_6060 in
                                            {6562}let Nc_6062: bitstring = dec(wNc_6061,skSess) in
                                            {6563}new Ns_6063: bitstring;
                                            {6564}new ST_6064: bitstring;
                                            {6565}new TTL_6065: bitstring;
                                            {6566}let wNs_6066: bitstring = enc(Ns_6063,pkCli_6010) in
                                            {6567}let m2_6067: bitstring = (OpenSecureChannelResponse,wNs_6066,ST_6064,TTL_6065) in
                                            {6568}out(c, m2_6067);
                                            {6569}let Ksrv_6068: bitstring = h((Ns_6063,Nc_6062)) in
                                            {6570}out(c, senc(mSrv(pkCli_6010,pkSess_5603),Ksrv_6068))
                                )
                                else
                                    {6571}let pkDisco_6069: bitstring = fail-any in
                                    {6572}in(c, (=pkCli_6010,em1_6070: bitstring));
                                    {6573}let m1_6071: bitstring = em1_6070 in
                                    {6574}let (=OpenSecureChannelRequest,=pkCli_6010,wNc_6072: bitstring) = m1_6071 in
                                    {6575}let Nc_6073: bitstring = dec(wNc_6072,skSess) in
                                    {6576}new Ns_6074: bitstring;
                                    {6577}new ST_6075: bitstring;
                                    {6578}new TTL_6076: bitstring;
                                    {6579}let wNs_6077: bitstring = enc(Ns_6074,pkCli_6010) in
                                    {6580}let m2_6078: bitstring = (OpenSecureChannelResponse,wNs_6077,ST_6075,TTL_6076) in
                                    {6581}out(c, m2_6078);
                                    {6582}let Ksrv_6079: bitstring = h((Ns_6074,Nc_6073)) in
                                    {6583}out(c, senc(mSrv(pkCli_6010,pkSess_5603),Ksrv_6079))
                        )
                        else
                            {6584}let pkDisco_6080: bitstring = fail-any in
                            {6585}in(c, (=pkCli_6010,em1_6081: bitstring));
                            {6586}let m1_6082: bitstring = em1_6081 in
                            {6587}let (=OpenSecureChannelRequest,=pkCli_6010,wNc_6083: bitstring) = m1_6082 in
                            {6588}let Nc_6084: bitstring = dec(wNc_6083,skSess) in
                            {6589}new Ns_6085: bitstring;
                            {6590}new ST_6086: bitstring;
                            {6591}new TTL_6087: bitstring;
                            {6592}let wNs_6088: bitstring = enc(Ns_6085,pkCli_6010) in
                            {6593}let m2_6089: bitstring = (OpenSecureChannelResponse,wNs_6088,ST_6086,TTL_6087) in
                            {6594}out(c, m2_6089);
                            {6595}let Ksrv_6090: bitstring = h((Ns_6085,Nc_6084)) in
                            {6596}out(c, senc(mSrv(pkCli_6010,pkSess_5603),Ksrv_6090))
            )
            else
                {6597}let pkCli_6091: bitstring = fail-any in
                {6598}let v_6092: bool = (Disco_5600 = A) in
                (
                    {6599}if v_6092 then
                    (
                        {6600}let pkDisco_6093: bitstring = pub(skA) in
                        {6601}in(c, (=pkCli_6091,em1_6094: bitstring));
                        {6602}let m1_6095: bitstring = em1_6094 in
                        {6603}let (=OpenSecureChannelRequest,=pkCli_6091,wNc_6096: bitstring) = m1_6095 in
                        {6604}let Nc_6097: bitstring = dec(wNc_6096,skSess) in
                        {6605}new Ns_6098: bitstring;
                        {6606}new ST_6099: bitstring;
                        {6607}new TTL_6100: bitstring;
                        {6608}let wNs_6101: bitstring = enc(Ns_6098,pkCli_6091) in
                        {6609}let m2_6102: bitstring = (OpenSecureChannelResponse,wNs_6101,ST_6099,TTL_6100) in
                        {6610}out(c, m2_6102);
                        {6611}let Ksrv_6103: bitstring = h((Ns_6098,Nc_6097)) in
                        {6612}out(c, senc(mSrv(pkCli_6091,pkSess_5603),Ksrv_6103))
                    )
                    else
                        {6613}let v_6104: bool = (Disco_5600 = B) in
                        (
                            {6614}if v_6104 then
                            (
                                {6615}let pkDisco_6105: bitstring = pub(skB) in
                                {6616}in(c, (=pkCli_6091,em1_6106: bitstring));
                                {6617}let m1_6107: bitstring = em1_6106 in
                                {6618}let (=OpenSecureChannelRequest,=pkCli_6091,wNc_6108: bitstring) = m1_6107 in
                                {6619}let Nc_6109: bitstring = dec(wNc_6108,skSess) in
                                {6620}new Ns_6110: bitstring;
                                {6621}new ST_6111: bitstring;
                                {6622}new TTL_6112: bitstring;
                                {6623}let wNs_6113: bitstring = enc(Ns_6110,pkCli_6091) in
                                {6624}let m2_6114: bitstring = (OpenSecureChannelResponse,wNs_6113,ST_6111,TTL_6112) in
                                {6625}out(c, m2_6114);
                                {6626}let Ksrv_6115: bitstring = h((Ns_6110,Nc_6109)) in
                                {6627}out(c, senc(mSrv(pkCli_6091,pkSess_5603),Ksrv_6115))
                            )
                            else
                                {6628}let v_6116: bool = (Disco_5600 = C) in
                                (
                                    {6629}if v_6116 then
                                    (
                                        {6630}let pkDisco_6117: bitstring = pub(skC) in
                                        {6631}in(c, (=pkCli_6091,em1_6118: bitstring));
                                        {6632}let m1_6119: bitstring = em1_6118 in
                                        {6633}let (=OpenSecureChannelRequest,=pkCli_6091,wNc_6120: bitstring) = m1_6119 in
                                        {6634}let Nc_6121: bitstring = dec(wNc_6120,skSess) in
                                        {6635}new Ns_6122: bitstring;
                                        {6636}new ST_6123: bitstring;
                                        {6637}new TTL_6124: bitstring;
                                        {6638}let wNs_6125: bitstring = enc(Ns_6122,pkCli_6091) in
                                        {6639}let m2_6126: bitstring = (OpenSecureChannelResponse,wNs_6125,ST_6123,TTL_6124) in
                                        {6640}out(c, m2_6126);
                                        {6641}let Ksrv_6127: bitstring = h((Ns_6122,Nc_6121)) in
                                        {6642}out(c, senc(mSrv(pkCli_6091,pkSess_5603),Ksrv_6127))
                                    )
                                    else
                                        {6643}let pkDisco_6128: bitstring = pub(sk(Disco_5600)) in
                                        {6644}in(c, (=pkCli_6091,em1_6129: bitstring));
                                        {6645}let m1_6130: bitstring = em1_6129 in
                                        {6646}let (=OpenSecureChannelRequest,=pkCli_6091,wNc_6131: bitstring) = m1_6130 in
                                        {6647}let Nc_6132: bitstring = dec(wNc_6131,skSess) in
                                        {6648}new Ns_6133: bitstring;
                                        {6649}new ST_6134: bitstring;
                                        {6650}new TTL_6135: bitstring;
                                        {6651}let wNs_6136: bitstring = enc(Ns_6133,pkCli_6091) in
                                        {6652}let m2_6137: bitstring = (OpenSecureChannelResponse,wNs_6136,ST_6134,TTL_6135) in
                                        {6653}out(c, m2_6137);
                                        {6654}let Ksrv_6138: bitstring = h((Ns_6133,Nc_6132)) in
                                        {6655}out(c, senc(mSrv(pkCli_6091,pkSess_5603),Ksrv_6138))
                                )
                                else
                                    {6656}let pkDisco_6139: bitstring = fail-any in
                                    {6657}in(c, (=pkCli_6091,em1_6140: bitstring));
                                    {6658}let m1_6141: bitstring = em1_6140 in
                                    {6659}let (=OpenSecureChannelRequest,=pkCli_6091,wNc_6142: bitstring) = m1_6141 in
                                    {6660}let Nc_6143: bitstring = dec(wNc_6142,skSess) in
                                    {6661}new Ns_6144: bitstring;
                                    {6662}new ST_6145: bitstring;
                                    {6663}new TTL_6146: bitstring;
                                    {6664}let wNs_6147: bitstring = enc(Ns_6144,pkCli_6091) in
                                    {6665}let m2_6148: bitstring = (OpenSecureChannelResponse,wNs_6147,ST_6145,TTL_6146) in
                                    {6666}out(c, m2_6148);
                                    {6667}let Ksrv_6149: bitstring = h((Ns_6144,Nc_6143)) in
                                    {6668}out(c, senc(mSrv(pkCli_6091,pkSess_5603),Ksrv_6149))
                        )
                        else
                            {6669}let pkDisco_6150: bitstring = fail-any in
                            {6670}in(c, (=pkCli_6091,em1_6151: bitstring));
                            {6671}let m1_6152: bitstring = em1_6151 in
                            {6672}let (=OpenSecureChannelRequest,=pkCli_6091,wNc_6153: bitstring) = m1_6152 in
                            {6673}let Nc_6154: bitstring = dec(wNc_6153,skSess) in
                            {6674}new Ns_6155: bitstring;
                            {6675}new ST_6156: bitstring;
                            {6676}new TTL_6157: bitstring;
                            {6677}let wNs_6158: bitstring = enc(Ns_6155,pkCli_6091) in
                            {6678}let m2_6159: bitstring = (OpenSecureChannelResponse,wNs_6158,ST_6156,TTL_6157) in
                            {6679}out(c, m2_6159);
                            {6680}let Ksrv_6160: bitstring = h((Ns_6155,Nc_6154)) in
                            {6681}out(c, senc(mSrv(pkCli_6091,pkSess_5603),Ksrv_6160))
                )
                else
                    {6682}let pkDisco_6161: bitstring = fail-any in
                    {6683}in(c, (=pkCli_6091,em1_6162: bitstring));
                    {6684}let m1_6163: bitstring = em1_6162 in
                    {6685}let (=OpenSecureChannelRequest,=pkCli_6091,wNc_6164: bitstring) = m1_6163 in
                    {6686}let Nc_6165: bitstring = dec(wNc_6164,skSess) in
                    {6687}new Ns_6166: bitstring;
                    {6688}new ST_6167: bitstring;
                    {6689}new TTL_6168: bitstring;
                    {6690}let wNs_6169: bitstring = enc(Ns_6166,pkCli_6091) in
                    {6691}let m2_6170: bitstring = (OpenSecureChannelResponse,wNs_6169,ST_6167,TTL_6168) in
                    {6692}out(c, m2_6170);
                    {6693}let Ksrv_6171: bitstring = h((Ns_6166,Nc_6165)) in
                    {6694}out(c, senc(mSrv(pkCli_6091,pkSess_5603),Ksrv_6171))
        )
        else
            {6695}let v_6172: bool = (Sess_5601 = B) in
            (
                {6696}if v_6172 then
                (
                    {6697}let skSess_6173: bitstring = skB in
                    {6698}let pkSess_6174: bitstring = pub(skSess_6173) in
                    {6699}let v_6175: bool = (Cli_5599 = A) in
                    (
                        {6700}if v_6175 then
                        (
                            {6701}let pkCli_6176: bitstring = pub(skA) in
                            {6702}let v_6177: bool = (Disco_5600 = A) in
                            (
                                {6703}if v_6177 then
                                (
                                    {6704}let pkDisco_6178: bitstring = pub(skA) in
                                    {6705}in(c, (=pkCli_6176,em1_6179: bitstring));
                                    {6706}let m1_6180: bitstring = em1_6179 in
                                    {6707}let (=OpenSecureChannelRequest,=pkCli_6176,wNc_6181: bitstring) = m1_6180 in
                                    {6708}let Nc_6182: bitstring = dec(wNc_6181,skSess_6173) in
                                    {6709}new Ns_6183: bitstring;
                                    {6710}new ST_6184: bitstring;
                                    {6711}new TTL_6185: bitstring;
                                    {6712}let wNs_6186: bitstring = enc(Ns_6183,pkCli_6176) in
                                    {6713}let m2_6187: bitstring = (OpenSecureChannelResponse,wNs_6186,ST_6184,TTL_6185) in
                                    {6714}out(c, m2_6187);
                                    {6715}let Ksrv_6188: bitstring = h((Ns_6183,Nc_6182)) in
                                    {6716}out(c, senc(mSrv(pkCli_6176,pkSess_6174),Ksrv_6188))
                                )
                                else
                                    {6717}let v_6189: bool = (Disco_5600 = B) in
                                    (
                                        {6718}if v_6189 then
                                        (
                                            {6719}let pkDisco_6190: bitstring = pub(skB) in
                                            {6720}in(c, (=pkCli_6176,em1_6191: bitstring));
                                            {6721}let m1_6192: bitstring = em1_6191 in
                                            {6722}let (=OpenSecureChannelRequest,=pkCli_6176,wNc_6193: bitstring) = m1_6192 in
                                            {6723}let Nc_6194: bitstring = dec(wNc_6193,skSess_6173) in
                                            {6724}new Ns_6195: bitstring;
                                            {6725}new ST_6196: bitstring;
                                            {6726}new TTL_6197: bitstring;
                                            {6727}let wNs_6198: bitstring = enc(Ns_6195,pkCli_6176) in
                                            {6728}let m2_6199: bitstring = (OpenSecureChannelResponse,wNs_6198,ST_6196,TTL_6197) in
                                            {6729}out(c, m2_6199);
                                            {6730}let Ksrv_6200: bitstring = h((Ns_6195,Nc_6194)) in
                                            {6731}out(c, senc(mSrv(pkCli_6176,pkSess_6174),Ksrv_6200))
                                        )
                                        else
                                            {6732}let v_6201: bool = (Disco_5600 = C) in
                                            (
                                                {6733}if v_6201 then
                                                (
                                                    {6734}let pkDisco_6202: bitstring = pub(skC) in
                                                    {6735}in(c, (=pkCli_6176,em1_6203: bitstring));
                                                    {6736}let m1_6204: bitstring = em1_6203 in
                                                    {6737}let (=OpenSecureChannelRequest,=pkCli_6176,wNc_6205: bitstring) = m1_6204 in
                                                    {6738}let Nc_6206: bitstring = dec(wNc_6205,skSess_6173) in
                                                    {6739}new Ns_6207: bitstring;
                                                    {6740}new ST_6208: bitstring;
                                                    {6741}new TTL_6209: bitstring;
                                                    {6742}let wNs_6210: bitstring = enc(Ns_6207,pkCli_6176) in
                                                    {6743}let m2_6211: bitstring = (OpenSecureChannelResponse,wNs_6210,ST_6208,TTL_6209) in
                                                    {6744}out(c, m2_6211);
                                                    {6745}let Ksrv_6212: bitstring = h((Ns_6207,Nc_6206)) in
                                                    {6746}out(c, senc(mSrv(pkCli_6176,pkSess_6174),Ksrv_6212))
                                                )
                                                else
                                                    {6747}let pkDisco_6213: bitstring = pub(sk(Disco_5600)) in
                                                    {6748}in(c, (=pkCli_6176,em1_6214: bitstring));
                                                    {6749}let m1_6215: bitstring = em1_6214 in
                                                    {6750}let (=OpenSecureChannelRequest,=pkCli_6176,wNc_6216: bitstring) = m1_6215 in
                                                    {6751}let Nc_6217: bitstring = dec(wNc_6216,skSess_6173) in
                                                    {6752}new Ns_6218: bitstring;
                                                    {6753}new ST_6219: bitstring;
                                                    {6754}new TTL_6220: bitstring;
                                                    {6755}let wNs_6221: bitstring = enc(Ns_6218,pkCli_6176) in
                                                    {6756}let m2_6222: bitstring = (OpenSecureChannelResponse,wNs_6221,ST_6219,TTL_6220) in
                                                    {6757}out(c, m2_6222);
                                                    {6758}let Ksrv_6223: bitstring = h((Ns_6218,Nc_6217)) in
                                                    {6759}out(c, senc(mSrv(pkCli_6176,pkSess_6174),Ksrv_6223))
                                            )
                                            else
                                                {6760}let pkDisco_6224: bitstring = fail-any in
                                                {6761}in(c, (=pkCli_6176,em1_6225: bitstring));
                                                {6762}let m1_6226: bitstring = em1_6225 in
                                                {6763}let (=OpenSecureChannelRequest,=pkCli_6176,wNc_6227: bitstring) = m1_6226 in
                                                {6764}let Nc_6228: bitstring = dec(wNc_6227,skSess_6173) in
                                                {6765}new Ns_6229: bitstring;
                                                {6766}new ST_6230: bitstring;
                                                {6767}new TTL_6231: bitstring;
                                                {6768}let wNs_6232: bitstring = enc(Ns_6229,pkCli_6176) in
                                                {6769}let m2_6233: bitstring = (OpenSecureChannelResponse,wNs_6232,ST_6230,TTL_6231) in
                                                {6770}out(c, m2_6233);
                                                {6771}let Ksrv_6234: bitstring = h((Ns_6229,Nc_6228)) in
                                                {6772}out(c, senc(mSrv(pkCli_6176,pkSess_6174),Ksrv_6234))
                                    )
                                    else
                                        {6773}let pkDisco_6235: bitstring = fail-any in
                                        {6774}in(c, (=pkCli_6176,em1_6236: bitstring));
                                        {6775}let m1_6237: bitstring = em1_6236 in
                                        {6776}let (=OpenSecureChannelRequest,=pkCli_6176,wNc_6238: bitstring) = m1_6237 in
                                        {6777}let Nc_6239: bitstring = dec(wNc_6238,skSess_6173) in
                                        {6778}new Ns_6240: bitstring;
                                        {6779}new ST_6241: bitstring;
                                        {6780}new TTL_6242: bitstring;
                                        {6781}let wNs_6243: bitstring = enc(Ns_6240,pkCli_6176) in
                                        {6782}let m2_6244: bitstring = (OpenSecureChannelResponse,wNs_6243,ST_6241,TTL_6242) in
                                        {6783}out(c, m2_6244);
                                        {6784}let Ksrv_6245: bitstring = h((Ns_6240,Nc_6239)) in
                                        {6785}out(c, senc(mSrv(pkCli_6176,pkSess_6174),Ksrv_6245))
                            )
                            else
                                {6786}let pkDisco_6246: bitstring = fail-any in
                                {6787}in(c, (=pkCli_6176,em1_6247: bitstring));
                                {6788}let m1_6248: bitstring = em1_6247 in
                                {6789}let (=OpenSecureChannelRequest,=pkCli_6176,wNc_6249: bitstring) = m1_6248 in
                                {6790}let Nc_6250: bitstring = dec(wNc_6249,skSess_6173) in
                                {6791}new Ns_6251: bitstring;
                                {6792}new ST_6252: bitstring;
                                {6793}new TTL_6253: bitstring;
                                {6794}let wNs_6254: bitstring = enc(Ns_6251,pkCli_6176) in
                                {6795}let m2_6255: bitstring = (OpenSecureChannelResponse,wNs_6254,ST_6252,TTL_6253) in
                                {6796}out(c, m2_6255);
                                {6797}let Ksrv_6256: bitstring = h((Ns_6251,Nc_6250)) in
                                {6798}out(c, senc(mSrv(pkCli_6176,pkSess_6174),Ksrv_6256))
                        )
                        else
                            {6799}let v_6257: bool = (Cli_5599 = B) in
                            (
                                {6800}if v_6257 then
                                (
                                    {6801}let pkCli_6258: bitstring = pub(skB) in
                                    {6802}let v_6259: bool = (Disco_5600 = A) in
                                    (
                                        {6803}if v_6259 then
                                        (
                                            {6804}let pkDisco_6260: bitstring = pub(skA) in
                                            {6805}in(c, (=pkCli_6258,em1_6261: bitstring));
                                            {6806}let m1_6262: bitstring = em1_6261 in
                                            {6807}let (=OpenSecureChannelRequest,=pkCli_6258,wNc_6263: bitstring) = m1_6262 in
                                            {6808}let Nc_6264: bitstring = dec(wNc_6263,skSess_6173) in
                                            {6809}new Ns_6265: bitstring;
                                            {6810}new ST_6266: bitstring;
                                            {6811}new TTL_6267: bitstring;
                                            {6812}let wNs_6268: bitstring = enc(Ns_6265,pkCli_6258) in
                                            {6813}let m2_6269: bitstring = (OpenSecureChannelResponse,wNs_6268,ST_6266,TTL_6267) in
                                            {6814}out(c, m2_6269);
                                            {6815}let Ksrv_6270: bitstring = h((Ns_6265,Nc_6264)) in
                                            {6816}out(c, senc(mSrv(pkCli_6258,pkSess_6174),Ksrv_6270))
                                        )
                                        else
                                            {6817}let v_6271: bool = (Disco_5600 = B) in
                                            (
                                                {6818}if v_6271 then
                                                (
                                                    {6819}let pkDisco_6272: bitstring = pub(skB) in
                                                    {6820}in(c, (=pkCli_6258,em1_6273: bitstring));
                                                    {6821}let m1_6274: bitstring = em1_6273 in
                                                    {6822}let (=OpenSecureChannelRequest,=pkCli_6258,wNc_6275: bitstring) = m1_6274 in
                                                    {6823}let Nc_6276: bitstring = dec(wNc_6275,skSess_6173) in
                                                    {6824}new Ns_6277: bitstring;
                                                    {6825}new ST_6278: bitstring;
                                                    {6826}new TTL_6279: bitstring;
                                                    {6827}let wNs_6280: bitstring = enc(Ns_6277,pkCli_6258) in
                                                    {6828}let m2_6281: bitstring = (OpenSecureChannelResponse,wNs_6280,ST_6278,TTL_6279) in
                                                    {6829}out(c, m2_6281);
                                                    {6830}let Ksrv_6282: bitstring = h((Ns_6277,Nc_6276)) in
                                                    {6831}out(c, senc(mSrv(pkCli_6258,pkSess_6174),Ksrv_6282))
                                                )
                                                else
                                                    {6832}let v_6283: bool = (Disco_5600 = C) in
                                                    (
                                                        {6833}if v_6283 then
                                                        (
                                                            {6834}let pkDisco_6284: bitstring = pub(skC) in
                                                            {6835}in(c, (=pkCli_6258,em1_6285: bitstring));
                                                            {6836}let m1_6286: bitstring = em1_6285 in
                                                            {6837}let (=OpenSecureChannelRequest,=pkCli_6258,wNc_6287: bitstring) = m1_6286 in
                                                            {6838}let Nc_6288: bitstring = dec(wNc_6287,skSess_6173) in
                                                            {6839}new Ns_6289: bitstring;
                                                            {6840}new ST_6290: bitstring;
                                                            {6841}new TTL_6291: bitstring;
                                                            {6842}let wNs_6292: bitstring = enc(Ns_6289,pkCli_6258) in
                                                            {6843}let m2_6293: bitstring = (OpenSecureChannelResponse,wNs_6292,ST_6290,TTL_6291) in
                                                            {6844}out(c, m2_6293);
                                                            {6845}let Ksrv_6294: bitstring = h((Ns_6289,Nc_6288)) in
                                                            {6846}out(c, senc(mSrv(pkCli_6258,pkSess_6174),Ksrv_6294))
                                                        )
                                                        else
                                                            {6847}let pkDisco_6295: bitstring = pub(sk(Disco_5600)) in
                                                            {6848}in(c, (=pkCli_6258,em1_6296: bitstring));
                                                            {6849}let m1_6297: bitstring = em1_6296 in
                                                            {6850}let (=OpenSecureChannelRequest,=pkCli_6258,wNc_6298: bitstring) = m1_6297 in
                                                            {6851}let Nc_6299: bitstring = dec(wNc_6298,skSess_6173) in
                                                            {6852}new Ns_6300: bitstring;
                                                            {6853}new ST_6301: bitstring;
                                                            {6854}new TTL_6302: bitstring;
                                                            {6855}let wNs_6303: bitstring = enc(Ns_6300,pkCli_6258) in
                                                            {6856}let m2_6304: bitstring = (OpenSecureChannelResponse,wNs_6303,ST_6301,TTL_6302) in
                                                            {6857}out(c, m2_6304);
                                                            {6858}let Ksrv_6305: bitstring = h((Ns_6300,Nc_6299)) in
                                                            {6859}out(c, senc(mSrv(pkCli_6258,pkSess_6174),Ksrv_6305))
                                                    )
                                                    else
                                                        {6860}let pkDisco_6306: bitstring = fail-any in
                                                        {6861}in(c, (=pkCli_6258,em1_6307: bitstring));
                                                        {6862}let m1_6308: bitstring = em1_6307 in
                                                        {6863}let (=OpenSecureChannelRequest,=pkCli_6258,wNc_6309: bitstring) = m1_6308 in
                                                        {6864}let Nc_6310: bitstring = dec(wNc_6309,skSess_6173) in
                                                        {6865}new Ns_6311: bitstring;
                                                        {6866}new ST_6312: bitstring;
                                                        {6867}new TTL_6313: bitstring;
                                                        {6868}let wNs_6314: bitstring = enc(Ns_6311,pkCli_6258) in
                                                        {6869}let m2_6315: bitstring = (OpenSecureChannelResponse,wNs_6314,ST_6312,TTL_6313) in
                                                        {6870}out(c, m2_6315);
                                                        {6871}let Ksrv_6316: bitstring = h((Ns_6311,Nc_6310)) in
                                                        {6872}out(c, senc(mSrv(pkCli_6258,pkSess_6174),Ksrv_6316))
                                            )
                                            else
                                                {6873}let pkDisco_6317: bitstring = fail-any in
                                                {6874}in(c, (=pkCli_6258,em1_6318: bitstring));
                                                {6875}let m1_6319: bitstring = em1_6318 in
                                                {6876}let (=OpenSecureChannelRequest,=pkCli_6258,wNc_6320: bitstring) = m1_6319 in
                                                {6877}let Nc_6321: bitstring = dec(wNc_6320,skSess_6173) in
                                                {6878}new Ns_6322: bitstring;
                                                {6879}new ST_6323: bitstring;
                                                {6880}new TTL_6324: bitstring;
                                                {6881}let wNs_6325: bitstring = enc(Ns_6322,pkCli_6258) in
                                                {6882}let m2_6326: bitstring = (OpenSecureChannelResponse,wNs_6325,ST_6323,TTL_6324) in
                                                {6883}out(c, m2_6326);
                                                {6884}let Ksrv_6327: bitstring = h((Ns_6322,Nc_6321)) in
                                                {6885}out(c, senc(mSrv(pkCli_6258,pkSess_6174),Ksrv_6327))
                                    )
                                    else
                                        {6886}let pkDisco_6328: bitstring = fail-any in
                                        {6887}in(c, (=pkCli_6258,em1_6329: bitstring));
                                        {6888}let m1_6330: bitstring = em1_6329 in
                                        {6889}let (=OpenSecureChannelRequest,=pkCli_6258,wNc_6331: bitstring) = m1_6330 in
                                        {6890}let Nc_6332: bitstring = dec(wNc_6331,skSess_6173) in
                                        {6891}new Ns_6333: bitstring;
                                        {6892}new ST_6334: bitstring;
                                        {6893}new TTL_6335: bitstring;
                                        {6894}let wNs_6336: bitstring = enc(Ns_6333,pkCli_6258) in
                                        {6895}let m2_6337: bitstring = (OpenSecureChannelResponse,wNs_6336,ST_6334,TTL_6335) in
                                        {6896}out(c, m2_6337);
                                        {6897}let Ksrv_6338: bitstring = h((Ns_6333,Nc_6332)) in
                                        {6898}out(c, senc(mSrv(pkCli_6258,pkSess_6174),Ksrv_6338))
                                )
                                else
                                    {6899}let v_6339: bool = (Cli_5599 = C) in
                                    (
                                        {6900}if v_6339 then
                                        (
                                            {6901}let pkCli_6340: bitstring = pub(skC) in
                                            {6902}let v_6341: bool = (Disco_5600 = A) in
                                            (
                                                {6903}if v_6341 then
                                                (
                                                    {6904}let pkDisco_6342: bitstring = pub(skA) in
                                                    {6905}in(c, (=pkCli_6340,em1_6343: bitstring));
                                                    {6906}let m1_6344: bitstring = em1_6343 in
                                                    {6907}let (=OpenSecureChannelRequest,=pkCli_6340,wNc_6345: bitstring) = m1_6344 in
                                                    {6908}let Nc_6346: bitstring = dec(wNc_6345,skSess_6173) in
                                                    {6909}new Ns_6347: bitstring;
                                                    {6910}new ST_6348: bitstring;
                                                    {6911}new TTL_6349: bitstring;
                                                    {6912}let wNs_6350: bitstring = enc(Ns_6347,pkCli_6340) in
                                                    {6913}let m2_6351: bitstring = (OpenSecureChannelResponse,wNs_6350,ST_6348,TTL_6349) in
                                                    {6914}out(c, m2_6351);
                                                    {6915}let Ksrv_6352: bitstring = h((Ns_6347,Nc_6346)) in
                                                    {6916}out(c, senc(mSrv(pkCli_6340,pkSess_6174),Ksrv_6352))
                                                )
                                                else
                                                    {6917}let v_6353: bool = (Disco_5600 = B) in
                                                    (
                                                        {6918}if v_6353 then
                                                        (
                                                            {6919}let pkDisco_6354: bitstring = pub(skB) in
                                                            {6920}in(c, (=pkCli_6340,em1_6355: bitstring));
                                                            {6921}let m1_6356: bitstring = em1_6355 in
                                                            {6922}let (=OpenSecureChannelRequest,=pkCli_6340,wNc_6357: bitstring) = m1_6356 in
                                                            {6923}let Nc_6358: bitstring = dec(wNc_6357,skSess_6173) in
                                                            {6924}new Ns_6359: bitstring;
                                                            {6925}new ST_6360: bitstring;
                                                            {6926}new TTL_6361: bitstring;
                                                            {6927}let wNs_6362: bitstring = enc(Ns_6359,pkCli_6340) in
                                                            {6928}let m2_6363: bitstring = (OpenSecureChannelResponse,wNs_6362,ST_6360,TTL_6361) in
                                                            {6929}out(c, m2_6363);
                                                            {6930}let Ksrv_6364: bitstring = h((Ns_6359,Nc_6358)) in
                                                            {6931}out(c, senc(mSrv(pkCli_6340,pkSess_6174),Ksrv_6364))
                                                        )
                                                        else
                                                            {6932}let v_6365: bool = (Disco_5600 = C) in
                                                            (
                                                                {6933}if v_6365 then
                                                                (
                                                                    {6934}let pkDisco_6366: bitstring = pub(skC) in
                                                                    {6935}in(c, (=pkCli_6340,em1_6367: bitstring));
                                                                    {6936}let m1_6368: bitstring = em1_6367 in
                                                                    {6937}let (=OpenSecureChannelRequest,=pkCli_6340,wNc_6369: bitstring) = m1_6368 in
                                                                    {6938}let Nc_6370: bitstring = dec(wNc_6369,skSess_6173) in
                                                                    {6939}new Ns_6371: bitstring;
                                                                    {6940}new ST_6372: bitstring;
                                                                    {6941}new TTL_6373: bitstring;
                                                                    {6942}let wNs_6374: bitstring = enc(Ns_6371,pkCli_6340) in
                                                                    {6943}let m2_6375: bitstring = (OpenSecureChannelResponse,wNs_6374,ST_6372,TTL_6373) in
                                                                    {6944}out(c, m2_6375);
                                                                    {6945}let Ksrv_6376: bitstring = h((Ns_6371,Nc_6370)) in
                                                                    {6946}out(c, senc(mSrv(pkCli_6340,pkSess_6174),Ksrv_6376))
                                                                )
                                                                else
                                                                    {6947}let pkDisco_6377: bitstring = pub(sk(Disco_5600)) in
                                                                    {6948}in(c, (=pkCli_6340,em1_6378: bitstring));
                                                                    {6949}let m1_6379: bitstring = em1_6378 in
                                                                    {6950}let (=OpenSecureChannelRequest,=pkCli_6340,wNc_6380: bitstring) = m1_6379 in
                                                                    {6951}let Nc_6381: bitstring = dec(wNc_6380,skSess_6173) in
                                                                    {6952}new Ns_6382: bitstring;
                                                                    {6953}new ST_6383: bitstring;
                                                                    {6954}new TTL_6384: bitstring;
                                                                    {6955}let wNs_6385: bitstring = enc(Ns_6382,pkCli_6340) in
                                                                    {6956}let m2_6386: bitstring = (OpenSecureChannelResponse,wNs_6385,ST_6383,TTL_6384) in
                                                                    {6957}out(c, m2_6386);
                                                                    {6958}let Ksrv_6387: bitstring = h((Ns_6382,Nc_6381)) in
                                                                    {6959}out(c, senc(mSrv(pkCli_6340,pkSess_6174),Ksrv_6387))
                                                            )
                                                            else
                                                                {6960}let pkDisco_6388: bitstring = fail-any in
                                                                {6961}in(c, (=pkCli_6340,em1_6389: bitstring));
                                                                {6962}let m1_6390: bitstring = em1_6389 in
                                                                {6963}let (=OpenSecureChannelRequest,=pkCli_6340,wNc_6391: bitstring) = m1_6390 in
                                                                {6964}let Nc_6392: bitstring = dec(wNc_6391,skSess_6173) in
                                                                {6965}new Ns_6393: bitstring;
                                                                {6966}new ST_6394: bitstring;
                                                                {6967}new TTL_6395: bitstring;
                                                                {6968}let wNs_6396: bitstring = enc(Ns_6393,pkCli_6340) in
                                                                {6969}let m2_6397: bitstring = (OpenSecureChannelResponse,wNs_6396,ST_6394,TTL_6395) in
                                                                {6970}out(c, m2_6397);
                                                                {6971}let Ksrv_6398: bitstring = h((Ns_6393,Nc_6392)) in
                                                                {6972}out(c, senc(mSrv(pkCli_6340,pkSess_6174),Ksrv_6398))
                                                    )
                                                    else
                                                        {6973}let pkDisco_6399: bitstring = fail-any in
                                                        {6974}in(c, (=pkCli_6340,em1_6400: bitstring));
                                                        {6975}let m1_6401: bitstring = em1_6400 in
                                                        {6976}let (=OpenSecureChannelRequest,=pkCli_6340,wNc_6402: bitstring) = m1_6401 in
                                                        {6977}let Nc_6403: bitstring = dec(wNc_6402,skSess_6173) in
                                                        {6978}new Ns_6404: bitstring;
                                                        {6979}new ST_6405: bitstring;
                                                        {6980}new TTL_6406: bitstring;
                                                        {6981}let wNs_6407: bitstring = enc(Ns_6404,pkCli_6340) in
                                                        {6982}let m2_6408: bitstring = (OpenSecureChannelResponse,wNs_6407,ST_6405,TTL_6406) in
                                                        {6983}out(c, m2_6408);
                                                        {6984}let Ksrv_6409: bitstring = h((Ns_6404,Nc_6403)) in
                                                        {6985}out(c, senc(mSrv(pkCli_6340,pkSess_6174),Ksrv_6409))
                                            )
                                            else
                                                {6986}let pkDisco_6410: bitstring = fail-any in
                                                {6987}in(c, (=pkCli_6340,em1_6411: bitstring));
                                                {6988}let m1_6412: bitstring = em1_6411 in
                                                {6989}let (=OpenSecureChannelRequest,=pkCli_6340,wNc_6413: bitstring) = m1_6412 in
                                                {6990}let Nc_6414: bitstring = dec(wNc_6413,skSess_6173) in
                                                {6991}new Ns_6415: bitstring;
                                                {6992}new ST_6416: bitstring;
                                                {6993}new TTL_6417: bitstring;
                                                {6994}let wNs_6418: bitstring = enc(Ns_6415,pkCli_6340) in
                                                {6995}let m2_6419: bitstring = (OpenSecureChannelResponse,wNs_6418,ST_6416,TTL_6417) in
                                                {6996}out(c, m2_6419);
                                                {6997}let Ksrv_6420: bitstring = h((Ns_6415,Nc_6414)) in
                                                {6998}out(c, senc(mSrv(pkCli_6340,pkSess_6174),Ksrv_6420))
                                        )
                                        else
                                            {6999}let pkCli_6421: bitstring = pub(sk(Cli_5599)) in
                                            {7000}let v_6422: bool = (Disco_5600 = A) in
                                            (
                                                {7001}if v_6422 then
                                                (
                                                    {7002}let pkDisco_6423: bitstring = pub(skA) in
                                                    {7003}in(c, (=pkCli_6421,em1_6424: bitstring));
                                                    {7004}let m1_6425: bitstring = em1_6424 in
                                                    {7005}let (=OpenSecureChannelRequest,=pkCli_6421,wNc_6426: bitstring) = m1_6425 in
                                                    {7006}let Nc_6427: bitstring = dec(wNc_6426,skSess_6173) in
                                                    {7007}new Ns_6428: bitstring;
                                                    {7008}new ST_6429: bitstring;
                                                    {7009}new TTL_6430: bitstring;
                                                    {7010}let wNs_6431: bitstring = enc(Ns_6428,pkCli_6421) in
                                                    {7011}let m2_6432: bitstring = (OpenSecureChannelResponse,wNs_6431,ST_6429,TTL_6430) in
                                                    {7012}out(c, m2_6432);
                                                    {7013}let Ksrv_6433: bitstring = h((Ns_6428,Nc_6427)) in
                                                    {7014}out(c, senc(mSrv(pkCli_6421,pkSess_6174),Ksrv_6433))
                                                )
                                                else
                                                    {7015}let v_6434: bool = (Disco_5600 = B) in
                                                    (
                                                        {7016}if v_6434 then
                                                        (
                                                            {7017}let pkDisco_6435: bitstring = pub(skB) in
                                                            {7018}in(c, (=pkCli_6421,em1_6436: bitstring));
                                                            {7019}let m1_6437: bitstring = em1_6436 in
                                                            {7020}let (=OpenSecureChannelRequest,=pkCli_6421,wNc_6438: bitstring) = m1_6437 in
                                                            {7021}let Nc_6439: bitstring = dec(wNc_6438,skSess_6173) in
                                                            {7022}new Ns_6440: bitstring;
                                                            {7023}new ST_6441: bitstring;
                                                            {7024}new TTL_6442: bitstring;
                                                            {7025}let wNs_6443: bitstring = enc(Ns_6440,pkCli_6421) in
                                                            {7026}let m2_6444: bitstring = (OpenSecureChannelResponse,wNs_6443,ST_6441,TTL_6442) in
                                                            {7027}out(c, m2_6444);
                                                            {7028}let Ksrv_6445: bitstring = h((Ns_6440,Nc_6439)) in
                                                            {7029}out(c, senc(mSrv(pkCli_6421,pkSess_6174),Ksrv_6445))
                                                        )
                                                        else
                                                            {7030}let v_6446: bool = (Disco_5600 = C) in
                                                            (
                                                                {7031}if v_6446 then
                                                                (
                                                                    {7032}let pkDisco_6447: bitstring = pub(skC) in
                                                                    {7033}in(c, (=pkCli_6421,em1_6448: bitstring));
                                                                    {7034}let m1_6449: bitstring = em1_6448 in
                                                                    {7035}let (=OpenSecureChannelRequest,=pkCli_6421,wNc_6450: bitstring) = m1_6449 in
                                                                    {7036}let Nc_6451: bitstring = dec(wNc_6450,skSess_6173) in
                                                                    {7037}new Ns_6452: bitstring;
                                                                    {7038}new ST_6453: bitstring;
                                                                    {7039}new TTL_6454: bitstring;
                                                                    {7040}let wNs_6455: bitstring = enc(Ns_6452,pkCli_6421) in
                                                                    {7041}let m2_6456: bitstring = (OpenSecureChannelResponse,wNs_6455,ST_6453,TTL_6454) in
                                                                    {7042}out(c, m2_6456);
                                                                    {7043}let Ksrv_6457: bitstring = h((Ns_6452,Nc_6451)) in
                                                                    {7044}out(c, senc(mSrv(pkCli_6421,pkSess_6174),Ksrv_6457))
                                                                )
                                                                else
                                                                    {7045}let pkDisco_6458: bitstring = pub(sk(Disco_5600)) in
                                                                    {7046}in(c, (=pkCli_6421,em1_6459: bitstring));
                                                                    {7047}let m1_6460: bitstring = em1_6459 in
                                                                    {7048}let (=OpenSecureChannelRequest,=pkCli_6421,wNc_6461: bitstring) = m1_6460 in
                                                                    {7049}let Nc_6462: bitstring = dec(wNc_6461,skSess_6173) in
                                                                    {7050}new Ns_6463: bitstring;
                                                                    {7051}new ST_6464: bitstring;
                                                                    {7052}new TTL_6465: bitstring;
                                                                    {7053}let wNs_6466: bitstring = enc(Ns_6463,pkCli_6421) in
                                                                    {7054}let m2_6467: bitstring = (OpenSecureChannelResponse,wNs_6466,ST_6464,TTL_6465) in
                                                                    {7055}out(c, m2_6467);
                                                                    {7056}let Ksrv_6468: bitstring = h((Ns_6463,Nc_6462)) in
                                                                    {7057}out(c, senc(mSrv(pkCli_6421,pkSess_6174),Ksrv_6468))
                                                            )
                                                            else
                                                                {7058}let pkDisco_6469: bitstring = fail-any in
                                                                {7059}in(c, (=pkCli_6421,em1_6470: bitstring));
                                                                {7060}let m1_6471: bitstring = em1_6470 in
                                                                {7061}let (=OpenSecureChannelRequest,=pkCli_6421,wNc_6472: bitstring) = m1_6471 in
                                                                {7062}let Nc_6473: bitstring = dec(wNc_6472,skSess_6173) in
                                                                {7063}new Ns_6474: bitstring;
                                                                {7064}new ST_6475: bitstring;
                                                                {7065}new TTL_6476: bitstring;
                                                                {7066}let wNs_6477: bitstring = enc(Ns_6474,pkCli_6421) in
                                                                {7067}let m2_6478: bitstring = (OpenSecureChannelResponse,wNs_6477,ST_6475,TTL_6476) in
                                                                {7068}out(c, m2_6478);
                                                                {7069}let Ksrv_6479: bitstring = h((Ns_6474,Nc_6473)) in
                                                                {7070}out(c, senc(mSrv(pkCli_6421,pkSess_6174),Ksrv_6479))
                                                    )
                                                    else
                                                        {7071}let pkDisco_6480: bitstring = fail-any in
                                                        {7072}in(c, (=pkCli_6421,em1_6481: bitstring));
                                                        {7073}let m1_6482: bitstring = em1_6481 in
                                                        {7074}let (=OpenSecureChannelRequest,=pkCli_6421,wNc_6483: bitstring) = m1_6482 in
                                                        {7075}let Nc_6484: bitstring = dec(wNc_6483,skSess_6173) in
                                                        {7076}new Ns_6485: bitstring;
                                                        {7077}new ST_6486: bitstring;
                                                        {7078}new TTL_6487: bitstring;
                                                        {7079}let wNs_6488: bitstring = enc(Ns_6485,pkCli_6421) in
                                                        {7080}let m2_6489: bitstring = (OpenSecureChannelResponse,wNs_6488,ST_6486,TTL_6487) in
                                                        {7081}out(c, m2_6489);
                                                        {7082}let Ksrv_6490: bitstring = h((Ns_6485,Nc_6484)) in
                                                        {7083}out(c, senc(mSrv(pkCli_6421,pkSess_6174),Ksrv_6490))
                                            )
                                            else
                                                {7084}let pkDisco_6491: bitstring = fail-any in
                                                {7085}in(c, (=pkCli_6421,em1_6492: bitstring));
                                                {7086}let m1_6493: bitstring = em1_6492 in
                                                {7087}let (=OpenSecureChannelRequest,=pkCli_6421,wNc_6494: bitstring) = m1_6493 in
                                                {7088}let Nc_6495: bitstring = dec(wNc_6494,skSess_6173) in
                                                {7089}new Ns_6496: bitstring;
                                                {7090}new ST_6497: bitstring;
                                                {7091}new TTL_6498: bitstring;
                                                {7092}let wNs_6499: bitstring = enc(Ns_6496,pkCli_6421) in
                                                {7093}let m2_6500: bitstring = (OpenSecureChannelResponse,wNs_6499,ST_6497,TTL_6498) in
                                                {7094}out(c, m2_6500);
                                                {7095}let Ksrv_6501: bitstring = h((Ns_6496,Nc_6495)) in
                                                {7096}out(c, senc(mSrv(pkCli_6421,pkSess_6174),Ksrv_6501))
                                    )
                                    else
                                        {7097}let pkCli_6502: bitstring = fail-any in
                                        {7098}let v_6503: bool = (Disco_5600 = A) in
                                        (
                                            {7099}if v_6503 then
                                            (
                                                {7100}let pkDisco_6504: bitstring = pub(skA) in
                                                {7101}in(c, (=pkCli_6502,em1_6505: bitstring));
                                                {7102}let m1_6506: bitstring = em1_6505 in
                                                {7103}let (=OpenSecureChannelRequest,=pkCli_6502,wNc_6507: bitstring) = m1_6506 in
                                                {7104}let Nc_6508: bitstring = dec(wNc_6507,skSess_6173) in
                                                {7105}new Ns_6509: bitstring;
                                                {7106}new ST_6510: bitstring;
                                                {7107}new TTL_6511: bitstring;
                                                {7108}let wNs_6512: bitstring = enc(Ns_6509,pkCli_6502) in
                                                {7109}let m2_6513: bitstring = (OpenSecureChannelResponse,wNs_6512,ST_6510,TTL_6511) in
                                                {7110}out(c, m2_6513);
                                                {7111}let Ksrv_6514: bitstring = h((Ns_6509,Nc_6508)) in
                                                {7112}out(c, senc(mSrv(pkCli_6502,pkSess_6174),Ksrv_6514))
                                            )
                                            else
                                                {7113}let v_6515: bool = (Disco_5600 = B) in
                                                (
                                                    {7114}if v_6515 then
                                                    (
                                                        {7115}let pkDisco_6516: bitstring = pub(skB) in
                                                        {7116}in(c, (=pkCli_6502,em1_6517: bitstring));
                                                        {7117}let m1_6518: bitstring = em1_6517 in
                                                        {7118}let (=OpenSecureChannelRequest,=pkCli_6502,wNc_6519: bitstring) = m1_6518 in
                                                        {7119}let Nc_6520: bitstring = dec(wNc_6519,skSess_6173) in
                                                        {7120}new Ns_6521: bitstring;
                                                        {7121}new ST_6522: bitstring;
                                                        {7122}new TTL_6523: bitstring;
                                                        {7123}let wNs_6524: bitstring = enc(Ns_6521,pkCli_6502) in
                                                        {7124}let m2_6525: bitstring = (OpenSecureChannelResponse,wNs_6524,ST_6522,TTL_6523) in
                                                        {7125}out(c, m2_6525);
                                                        {7126}let Ksrv_6526: bitstring = h((Ns_6521,Nc_6520)) in
                                                        {7127}out(c, senc(mSrv(pkCli_6502,pkSess_6174),Ksrv_6526))
                                                    )
                                                    else
                                                        {7128}let v_6527: bool = (Disco_5600 = C) in
                                                        (
                                                            {7129}if v_6527 then
                                                            (
                                                                {7130}let pkDisco_6528: bitstring = pub(skC) in
                                                                {7131}in(c, (=pkCli_6502,em1_6529: bitstring));
                                                                {7132}let m1_6530: bitstring = em1_6529 in
                                                                {7133}let (=OpenSecureChannelRequest,=pkCli_6502,wNc_6531: bitstring) = m1_6530 in
                                                                {7134}let Nc_6532: bitstring = dec(wNc_6531,skSess_6173) in
                                                                {7135}new Ns_6533: bitstring;
                                                                {7136}new ST_6534: bitstring;
                                                                {7137}new TTL_6535: bitstring;
                                                                {7138}let wNs_6536: bitstring = enc(Ns_6533,pkCli_6502) in
                                                                {7139}let m2_6537: bitstring = (OpenSecureChannelResponse,wNs_6536,ST_6534,TTL_6535) in
                                                                {7140}out(c, m2_6537);
                                                                {7141}let Ksrv_6538: bitstring = h((Ns_6533,Nc_6532)) in
                                                                {7142}out(c, senc(mSrv(pkCli_6502,pkSess_6174),Ksrv_6538))
                                                            )
                                                            else
                                                                {7143}let pkDisco_6539: bitstring = pub(sk(Disco_5600)) in
                                                                {7144}in(c, (=pkCli_6502,em1_6540: bitstring));
                                                                {7145}let m1_6541: bitstring = em1_6540 in
                                                                {7146}let (=OpenSecureChannelRequest,=pkCli_6502,wNc_6542: bitstring) = m1_6541 in
                                                                {7147}let Nc_6543: bitstring = dec(wNc_6542,skSess_6173) in
                                                                {7148}new Ns_6544: bitstring;
                                                                {7149}new ST_6545: bitstring;
                                                                {7150}new TTL_6546: bitstring;
                                                                {7151}let wNs_6547: bitstring = enc(Ns_6544,pkCli_6502) in
                                                                {7152}let m2_6548: bitstring = (OpenSecureChannelResponse,wNs_6547,ST_6545,TTL_6546) in
                                                                {7153}out(c, m2_6548);
                                                                {7154}let Ksrv_6549: bitstring = h((Ns_6544,Nc_6543)) in
                                                                {7155}out(c, senc(mSrv(pkCli_6502,pkSess_6174),Ksrv_6549))
                                                        )
                                                        else
                                                            {7156}let pkDisco_6550: bitstring = fail-any in
                                                            {7157}in(c, (=pkCli_6502,em1_6551: bitstring));
                                                            {7158}let m1_6552: bitstring = em1_6551 in
                                                            {7159}let (=OpenSecureChannelRequest,=pkCli_6502,wNc_6553: bitstring) = m1_6552 in
                                                            {7160}let Nc_6554: bitstring = dec(wNc_6553,skSess_6173) in
                                                            {7161}new Ns_6555: bitstring;
                                                            {7162}new ST_6556: bitstring;
                                                            {7163}new TTL_6557: bitstring;
                                                            {7164}let wNs_6558: bitstring = enc(Ns_6555,pkCli_6502) in
                                                            {7165}let m2_6559: bitstring = (OpenSecureChannelResponse,wNs_6558,ST_6556,TTL_6557) in
                                                            {7166}out(c, m2_6559);
                                                            {7167}let Ksrv_6560: bitstring = h((Ns_6555,Nc_6554)) in
                                                            {7168}out(c, senc(mSrv(pkCli_6502,pkSess_6174),Ksrv_6560))
                                                )
                                                else
                                                    {7169}let pkDisco_6561: bitstring = fail-any in
                                                    {7170}in(c, (=pkCli_6502,em1_6562: bitstring));
                                                    {7171}let m1_6563: bitstring = em1_6562 in
                                                    {7172}let (=OpenSecureChannelRequest,=pkCli_6502,wNc_6564: bitstring) = m1_6563 in
                                                    {7173}let Nc_6565: bitstring = dec(wNc_6564,skSess_6173) in
                                                    {7174}new Ns_6566: bitstring;
                                                    {7175}new ST_6567: bitstring;
                                                    {7176}new TTL_6568: bitstring;
                                                    {7177}let wNs_6569: bitstring = enc(Ns_6566,pkCli_6502) in
                                                    {7178}let m2_6570: bitstring = (OpenSecureChannelResponse,wNs_6569,ST_6567,TTL_6568) in
                                                    {7179}out(c, m2_6570);
                                                    {7180}let Ksrv_6571: bitstring = h((Ns_6566,Nc_6565)) in
                                                    {7181}out(c, senc(mSrv(pkCli_6502,pkSess_6174),Ksrv_6571))
                                        )
                                        else
                                            {7182}let pkDisco_6572: bitstring = fail-any in
                                            {7183}in(c, (=pkCli_6502,em1_6573: bitstring));
                                            {7184}let m1_6574: bitstring = em1_6573 in
                                            {7185}let (=OpenSecureChannelRequest,=pkCli_6502,wNc_6575: bitstring) = m1_6574 in
                                            {7186}let Nc_6576: bitstring = dec(wNc_6575,skSess_6173) in
                                            {7187}new Ns_6577: bitstring;
                                            {7188}new ST_6578: bitstring;
                                            {7189}new TTL_6579: bitstring;
                                            {7190}let wNs_6580: bitstring = enc(Ns_6577,pkCli_6502) in
                                            {7191}let m2_6581: bitstring = (OpenSecureChannelResponse,wNs_6580,ST_6578,TTL_6579) in
                                            {7192}out(c, m2_6581);
                                            {7193}let Ksrv_6582: bitstring = h((Ns_6577,Nc_6576)) in
                                            {7194}out(c, senc(mSrv(pkCli_6502,pkSess_6174),Ksrv_6582))
                            )
                            else
                                {7195}let pkCli_6583: bitstring = fail-any in
                                {7196}let v_6584: bool = (Disco_5600 = A) in
                                (
                                    {7197}if v_6584 then
                                    (
                                        {7198}let pkDisco_6585: bitstring = pub(skA) in
                                        {7199}in(c, (=pkCli_6583,em1_6586: bitstring));
                                        {7200}let m1_6587: bitstring = em1_6586 in
                                        {7201}let (=OpenSecureChannelRequest,=pkCli_6583,wNc_6588: bitstring) = m1_6587 in
                                        {7202}let Nc_6589: bitstring = dec(wNc_6588,skSess_6173) in
                                        {7203}new Ns_6590: bitstring;
                                        {7204}new ST_6591: bitstring;
                                        {7205}new TTL_6592: bitstring;
                                        {7206}let wNs_6593: bitstring = enc(Ns_6590,pkCli_6583) in
                                        {7207}let m2_6594: bitstring = (OpenSecureChannelResponse,wNs_6593,ST_6591,TTL_6592) in
                                        {7208}out(c, m2_6594);
                                        {7209}let Ksrv_6595: bitstring = h((Ns_6590,Nc_6589)) in
                                        {7210}out(c, senc(mSrv(pkCli_6583,pkSess_6174),Ksrv_6595))
                                    )
                                    else
                                        {7211}let v_6596: bool = (Disco_5600 = B) in
                                        (
                                            {7212}if v_6596 then
                                            (
                                                {7213}let pkDisco_6597: bitstring = pub(skB) in
                                                {7214}in(c, (=pkCli_6583,em1_6598: bitstring));
                                                {7215}let m1_6599: bitstring = em1_6598 in
                                                {7216}let (=OpenSecureChannelRequest,=pkCli_6583,wNc_6600: bitstring) = m1_6599 in
                                                {7217}let Nc_6601: bitstring = dec(wNc_6600,skSess_6173) in
                                                {7218}new Ns_6602: bitstring;
                                                {7219}new ST_6603: bitstring;
                                                {7220}new TTL_6604: bitstring;
                                                {7221}let wNs_6605: bitstring = enc(Ns_6602,pkCli_6583) in
                                                {7222}let m2_6606: bitstring = (OpenSecureChannelResponse,wNs_6605,ST_6603,TTL_6604) in
                                                {7223}out(c, m2_6606);
                                                {7224}let Ksrv_6607: bitstring = h((Ns_6602,Nc_6601)) in
                                                {7225}out(c, senc(mSrv(pkCli_6583,pkSess_6174),Ksrv_6607))
                                            )
                                            else
                                                {7226}let v_6608: bool = (Disco_5600 = C) in
                                                (
                                                    {7227}if v_6608 then
                                                    (
                                                        {7228}let pkDisco_6609: bitstring = pub(skC) in
                                                        {7229}in(c, (=pkCli_6583,em1_6610: bitstring));
                                                        {7230}let m1_6611: bitstring = em1_6610 in
                                                        {7231}let (=OpenSecureChannelRequest,=pkCli_6583,wNc_6612: bitstring) = m1_6611 in
                                                        {7232}let Nc_6613: bitstring = dec(wNc_6612,skSess_6173) in
                                                        {7233}new Ns_6614: bitstring;
                                                        {7234}new ST_6615: bitstring;
                                                        {7235}new TTL_6616: bitstring;
                                                        {7236}let wNs_6617: bitstring = enc(Ns_6614,pkCli_6583) in
                                                        {7237}let m2_6618: bitstring = (OpenSecureChannelResponse,wNs_6617,ST_6615,TTL_6616) in
                                                        {7238}out(c, m2_6618);
                                                        {7239}let Ksrv_6619: bitstring = h((Ns_6614,Nc_6613)) in
                                                        {7240}out(c, senc(mSrv(pkCli_6583,pkSess_6174),Ksrv_6619))
                                                    )
                                                    else
                                                        {7241}let pkDisco_6620: bitstring = pub(sk(Disco_5600)) in
                                                        {7242}in(c, (=pkCli_6583,em1_6621: bitstring));
                                                        {7243}let m1_6622: bitstring = em1_6621 in
                                                        {7244}let (=OpenSecureChannelRequest,=pkCli_6583,wNc_6623: bitstring) = m1_6622 in
                                                        {7245}let Nc_6624: bitstring = dec(wNc_6623,skSess_6173) in
                                                        {7246}new Ns_6625: bitstring;
                                                        {7247}new ST_6626: bitstring;
                                                        {7248}new TTL_6627: bitstring;
                                                        {7249}let wNs_6628: bitstring = enc(Ns_6625,pkCli_6583) in
                                                        {7250}let m2_6629: bitstring = (OpenSecureChannelResponse,wNs_6628,ST_6626,TTL_6627) in
                                                        {7251}out(c, m2_6629);
                                                        {7252}let Ksrv_6630: bitstring = h((Ns_6625,Nc_6624)) in
                                                        {7253}out(c, senc(mSrv(pkCli_6583,pkSess_6174),Ksrv_6630))
                                                )
                                                else
                                                    {7254}let pkDisco_6631: bitstring = fail-any in
                                                    {7255}in(c, (=pkCli_6583,em1_6632: bitstring));
                                                    {7256}let m1_6633: bitstring = em1_6632 in
                                                    {7257}let (=OpenSecureChannelRequest,=pkCli_6583,wNc_6634: bitstring) = m1_6633 in
                                                    {7258}let Nc_6635: bitstring = dec(wNc_6634,skSess_6173) in
                                                    {7259}new Ns_6636: bitstring;
                                                    {7260}new ST_6637: bitstring;
                                                    {7261}new TTL_6638: bitstring;
                                                    {7262}let wNs_6639: bitstring = enc(Ns_6636,pkCli_6583) in
                                                    {7263}let m2_6640: bitstring = (OpenSecureChannelResponse,wNs_6639,ST_6637,TTL_6638) in
                                                    {7264}out(c, m2_6640);
                                                    {7265}let Ksrv_6641: bitstring = h((Ns_6636,Nc_6635)) in
                                                    {7266}out(c, senc(mSrv(pkCli_6583,pkSess_6174),Ksrv_6641))
                                        )
                                        else
                                            {7267}let pkDisco_6642: bitstring = fail-any in
                                            {7268}in(c, (=pkCli_6583,em1_6643: bitstring));
                                            {7269}let m1_6644: bitstring = em1_6643 in
                                            {7270}let (=OpenSecureChannelRequest,=pkCli_6583,wNc_6645: bitstring) = m1_6644 in
                                            {7271}let Nc_6646: bitstring = dec(wNc_6645,skSess_6173) in
                                            {7272}new Ns_6647: bitstring;
                                            {7273}new ST_6648: bitstring;
                                            {7274}new TTL_6649: bitstring;
                                            {7275}let wNs_6650: bitstring = enc(Ns_6647,pkCli_6583) in
                                            {7276}let m2_6651: bitstring = (OpenSecureChannelResponse,wNs_6650,ST_6648,TTL_6649) in
                                            {7277}out(c, m2_6651);
                                            {7278}let Ksrv_6652: bitstring = h((Ns_6647,Nc_6646)) in
                                            {7279}out(c, senc(mSrv(pkCli_6583,pkSess_6174),Ksrv_6652))
                                )
                                else
                                    {7280}let pkDisco_6653: bitstring = fail-any in
                                    {7281}in(c, (=pkCli_6583,em1_6654: bitstring));
                                    {7282}let m1_6655: bitstring = em1_6654 in
                                    {7283}let (=OpenSecureChannelRequest,=pkCli_6583,wNc_6656: bitstring) = m1_6655 in
                                    {7284}let Nc_6657: bitstring = dec(wNc_6656,skSess_6173) in
                                    {7285}new Ns_6658: bitstring;
                                    {7286}new ST_6659: bitstring;
                                    {7287}new TTL_6660: bitstring;
                                    {7288}let wNs_6661: bitstring = enc(Ns_6658,pkCli_6583) in
                                    {7289}let m2_6662: bitstring = (OpenSecureChannelResponse,wNs_6661,ST_6659,TTL_6660) in
                                    {7290}out(c, m2_6662);
                                    {7291}let Ksrv_6663: bitstring = h((Ns_6658,Nc_6657)) in
                                    {7292}out(c, senc(mSrv(pkCli_6583,pkSess_6174),Ksrv_6663))
                    )
                    else
                        {7293}let pkCli_6664: bitstring = fail-any in
                        {7294}let v_6665: bool = (Disco_5600 = A) in
                        (
                            {7295}if v_6665 then
                            (
                                {7296}let pkDisco_6666: bitstring = pub(skA) in
                                {7297}in(c, (=pkCli_6664,em1_6667: bitstring));
                                {7298}let m1_6668: bitstring = em1_6667 in
                                {7299}let (=OpenSecureChannelRequest,=pkCli_6664,wNc_6669: bitstring) = m1_6668 in
                                {7300}let Nc_6670: bitstring = dec(wNc_6669,skSess_6173) in
                                {7301}new Ns_6671: bitstring;
                                {7302}new ST_6672: bitstring;
                                {7303}new TTL_6673: bitstring;
                                {7304}let wNs_6674: bitstring = enc(Ns_6671,pkCli_6664) in
                                {7305}let m2_6675: bitstring = (OpenSecureChannelResponse,wNs_6674,ST_6672,TTL_6673) in
                                {7306}out(c, m2_6675);
                                {7307}let Ksrv_6676: bitstring = h((Ns_6671,Nc_6670)) in
                                {7308}out(c, senc(mSrv(pkCli_6664,pkSess_6174),Ksrv_6676))
                            )
                            else
                                {7309}let v_6677: bool = (Disco_5600 = B) in
                                (
                                    {7310}if v_6677 then
                                    (
                                        {7311}let pkDisco_6678: bitstring = pub(skB) in
                                        {7312}in(c, (=pkCli_6664,em1_6679: bitstring));
                                        {7313}let m1_6680: bitstring = em1_6679 in
                                        {7314}let (=OpenSecureChannelRequest,=pkCli_6664,wNc_6681: bitstring) = m1_6680 in
                                        {7315}let Nc_6682: bitstring = dec(wNc_6681,skSess_6173) in
                                        {7316}new Ns_6683: bitstring;
                                        {7317}new ST_6684: bitstring;
                                        {7318}new TTL_6685: bitstring;
                                        {7319}let wNs_6686: bitstring = enc(Ns_6683,pkCli_6664) in
                                        {7320}let m2_6687: bitstring = (OpenSecureChannelResponse,wNs_6686,ST_6684,TTL_6685) in
                                        {7321}out(c, m2_6687);
                                        {7322}let Ksrv_6688: bitstring = h((Ns_6683,Nc_6682)) in
                                        {7323}out(c, senc(mSrv(pkCli_6664,pkSess_6174),Ksrv_6688))
                                    )
                                    else
                                        {7324}let v_6689: bool = (Disco_5600 = C) in
                                        (
                                            {7325}if v_6689 then
                                            (
                                                {7326}let pkDisco_6690: bitstring = pub(skC) in
                                                {7327}in(c, (=pkCli_6664,em1_6691: bitstring));
                                                {7328}let m1_6692: bitstring = em1_6691 in
                                                {7329}let (=OpenSecureChannelRequest,=pkCli_6664,wNc_6693: bitstring) = m1_6692 in
                                                {7330}let Nc_6694: bitstring = dec(wNc_6693,skSess_6173) in
                                                {7331}new Ns_6695: bitstring;
                                                {7332}new ST_6696: bitstring;
                                                {7333}new TTL_6697: bitstring;
                                                {7334}let wNs_6698: bitstring = enc(Ns_6695,pkCli_6664) in
                                                {7335}let m2_6699: bitstring = (OpenSecureChannelResponse,wNs_6698,ST_6696,TTL_6697) in
                                                {7336}out(c, m2_6699);
                                                {7337}let Ksrv_6700: bitstring = h((Ns_6695,Nc_6694)) in
                                                {7338}out(c, senc(mSrv(pkCli_6664,pkSess_6174),Ksrv_6700))
                                            )
                                            else
                                                {7339}let pkDisco_6701: bitstring = pub(sk(Disco_5600)) in
                                                {7340}in(c, (=pkCli_6664,em1_6702: bitstring));
                                                {7341}let m1_6703: bitstring = em1_6702 in
                                                {7342}let (=OpenSecureChannelRequest,=pkCli_6664,wNc_6704: bitstring) = m1_6703 in
                                                {7343}let Nc_6705: bitstring = dec(wNc_6704,skSess_6173) in
                                                {7344}new Ns_6706: bitstring;
                                                {7345}new ST_6707: bitstring;
                                                {7346}new TTL_6708: bitstring;
                                                {7347}let wNs_6709: bitstring = enc(Ns_6706,pkCli_6664) in
                                                {7348}let m2_6710: bitstring = (OpenSecureChannelResponse,wNs_6709,ST_6707,TTL_6708) in
                                                {7349}out(c, m2_6710);
                                                {7350}let Ksrv_6711: bitstring = h((Ns_6706,Nc_6705)) in
                                                {7351}out(c, senc(mSrv(pkCli_6664,pkSess_6174),Ksrv_6711))
                                        )
                                        else
                                            {7352}let pkDisco_6712: bitstring = fail-any in
                                            {7353}in(c, (=pkCli_6664,em1_6713: bitstring));
                                            {7354}let m1_6714: bitstring = em1_6713 in
                                            {7355}let (=OpenSecureChannelRequest,=pkCli_6664,wNc_6715: bitstring) = m1_6714 in
                                            {7356}let Nc_6716: bitstring = dec(wNc_6715,skSess_6173) in
                                            {7357}new Ns_6717: bitstring;
                                            {7358}new ST_6718: bitstring;
                                            {7359}new TTL_6719: bitstring;
                                            {7360}let wNs_6720: bitstring = enc(Ns_6717,pkCli_6664) in
                                            {7361}let m2_6721: bitstring = (OpenSecureChannelResponse,wNs_6720,ST_6718,TTL_6719) in
                                            {7362}out(c, m2_6721);
                                            {7363}let Ksrv_6722: bitstring = h((Ns_6717,Nc_6716)) in
                                            {7364}out(c, senc(mSrv(pkCli_6664,pkSess_6174),Ksrv_6722))
                                )
                                else
                                    {7365}let pkDisco_6723: bitstring = fail-any in
                                    {7366}in(c, (=pkCli_6664,em1_6724: bitstring));
                                    {7367}let m1_6725: bitstring = em1_6724 in
                                    {7368}let (=OpenSecureChannelRequest,=pkCli_6664,wNc_6726: bitstring) = m1_6725 in
                                    {7369}let Nc_6727: bitstring = dec(wNc_6726,skSess_6173) in
                                    {7370}new Ns_6728: bitstring;
                                    {7371}new ST_6729: bitstring;
                                    {7372}new TTL_6730: bitstring;
                                    {7373}let wNs_6731: bitstring = enc(Ns_6728,pkCli_6664) in
                                    {7374}let m2_6732: bitstring = (OpenSecureChannelResponse,wNs_6731,ST_6729,TTL_6730) in
                                    {7375}out(c, m2_6732);
                                    {7376}let Ksrv_6733: bitstring = h((Ns_6728,Nc_6727)) in
                                    {7377}out(c, senc(mSrv(pkCli_6664,pkSess_6174),Ksrv_6733))
                        )
                        else
                            {7378}let pkDisco_6734: bitstring = fail-any in
                            {7379}in(c, (=pkCli_6664,em1_6735: bitstring));
                            {7380}let m1_6736: bitstring = em1_6735 in
                            {7381}let (=OpenSecureChannelRequest,=pkCli_6664,wNc_6737: bitstring) = m1_6736 in
                            {7382}let Nc_6738: bitstring = dec(wNc_6737,skSess_6173) in
                            {7383}new Ns_6739: bitstring;
                            {7384}new ST_6740: bitstring;
                            {7385}new TTL_6741: bitstring;
                            {7386}let wNs_6742: bitstring = enc(Ns_6739,pkCli_6664) in
                            {7387}let m2_6743: bitstring = (OpenSecureChannelResponse,wNs_6742,ST_6740,TTL_6741) in
                            {7388}out(c, m2_6743);
                            {7389}let Ksrv_6744: bitstring = h((Ns_6739,Nc_6738)) in
                            {7390}out(c, senc(mSrv(pkCli_6664,pkSess_6174),Ksrv_6744))
                )
                else
                    {7391}let =true = (Sess_5601 = C) in
                    (
                        {7392}let skSess_6745: bitstring = skC in
                        {7393}let pkSess_6746: bitstring = pub(skSess_6745) in
                        {7394}let v_6747: bool = (Cli_5599 = A) in
                        (
                            {7395}if v_6747 then
                            (
                                {7396}let pkCli_6748: bitstring = pub(skA) in
                                {7397}let v_6749: bool = (Disco_5600 = A) in
                                (
                                    {7398}if v_6749 then
                                    (
                                        {7399}let pkDisco_6750: bitstring = pub(skA) in
                                        {7400}in(c, (=pkCli_6748,em1_6751: bitstring));
                                        {7401}let m1_6752: bitstring = em1_6751 in
                                        {7402}let (=OpenSecureChannelRequest,=pkCli_6748,wNc_6753: bitstring) = m1_6752 in
                                        {7403}let Nc_6754: bitstring = dec(wNc_6753,skSess_6745) in
                                        {7404}new Ns_6755: bitstring;
                                        {7405}new ST_6756: bitstring;
                                        {7406}new TTL_6757: bitstring;
                                        {7407}let wNs_6758: bitstring = enc(Ns_6755,pkCli_6748) in
                                        {7408}let m2_6759: bitstring = (OpenSecureChannelResponse,wNs_6758,ST_6756,TTL_6757) in
                                        {7409}out(c, m2_6759);
                                        {7410}let Ksrv_6760: bitstring = h((Ns_6755,Nc_6754)) in
                                        {7411}out(c, senc(mSrv(pkCli_6748,pkSess_6746),Ksrv_6760))
                                    )
                                    else
                                        {7412}let v_6761: bool = (Disco_5600 = B) in
                                        (
                                            {7413}if v_6761 then
                                            (
                                                {7414}let pkDisco_6762: bitstring = pub(skB) in
                                                {7415}in(c, (=pkCli_6748,em1_6763: bitstring));
                                                {7416}let m1_6764: bitstring = em1_6763 in
                                                {7417}let (=OpenSecureChannelRequest,=pkCli_6748,wNc_6765: bitstring) = m1_6764 in
                                                {7418}let Nc_6766: bitstring = dec(wNc_6765,skSess_6745) in
                                                {7419}new Ns_6767: bitstring;
                                                {7420}new ST_6768: bitstring;
                                                {7421}new TTL_6769: bitstring;
                                                {7422}let wNs_6770: bitstring = enc(Ns_6767,pkCli_6748) in
                                                {7423}let m2_6771: bitstring = (OpenSecureChannelResponse,wNs_6770,ST_6768,TTL_6769) in
                                                {7424}out(c, m2_6771);
                                                {7425}let Ksrv_6772: bitstring = h((Ns_6767,Nc_6766)) in
                                                {7426}out(c, senc(mSrv(pkCli_6748,pkSess_6746),Ksrv_6772))
                                            )
                                            else
                                                {7427}let v_6773: bool = (Disco_5600 = C) in
                                                (
                                                    {7428}if v_6773 then
                                                    (
                                                        {7429}let pkDisco_6774: bitstring = pub(skC) in
                                                        {7430}in(c, (=pkCli_6748,em1_6775: bitstring));
                                                        {7431}let m1_6776: bitstring = em1_6775 in
                                                        {7432}let (=OpenSecureChannelRequest,=pkCli_6748,wNc_6777: bitstring) = m1_6776 in
                                                        {7433}let Nc_6778: bitstring = dec(wNc_6777,skSess_6745) in
                                                        {7434}new Ns_6779: bitstring;
                                                        {7435}new ST_6780: bitstring;
                                                        {7436}new TTL_6781: bitstring;
                                                        {7437}let wNs_6782: bitstring = enc(Ns_6779,pkCli_6748) in
                                                        {7438}let m2_6783: bitstring = (OpenSecureChannelResponse,wNs_6782,ST_6780,TTL_6781) in
                                                        {7439}out(c, m2_6783);
                                                        {7440}let Ksrv_6784: bitstring = h((Ns_6779,Nc_6778)) in
                                                        {7441}out(c, senc(mSrv(pkCli_6748,pkSess_6746),Ksrv_6784))
                                                    )
                                                    else
                                                        {7442}let pkDisco_6785: bitstring = pub(sk(Disco_5600)) in
                                                        {7443}in(c, (=pkCli_6748,em1_6786: bitstring));
                                                        {7444}let m1_6787: bitstring = em1_6786 in
                                                        {7445}let (=OpenSecureChannelRequest,=pkCli_6748,wNc_6788: bitstring) = m1_6787 in
                                                        {7446}let Nc_6789: bitstring = dec(wNc_6788,skSess_6745) in
                                                        {7447}new Ns_6790: bitstring;
                                                        {7448}new ST_6791: bitstring;
                                                        {7449}new TTL_6792: bitstring;
                                                        {7450}let wNs_6793: bitstring = enc(Ns_6790,pkCli_6748) in
                                                        {7451}let m2_6794: bitstring = (OpenSecureChannelResponse,wNs_6793,ST_6791,TTL_6792) in
                                                        {7452}out(c, m2_6794);
                                                        {7453}let Ksrv_6795: bitstring = h((Ns_6790,Nc_6789)) in
                                                        {7454}out(c, senc(mSrv(pkCli_6748,pkSess_6746),Ksrv_6795))
                                                )
                                                else
                                                    {7455}let pkDisco_6796: bitstring = fail-any in
                                                    {7456}in(c, (=pkCli_6748,em1_6797: bitstring));
                                                    {7457}let m1_6798: bitstring = em1_6797 in
                                                    {7458}let (=OpenSecureChannelRequest,=pkCli_6748,wNc_6799: bitstring) = m1_6798 in
                                                    {7459}let Nc_6800: bitstring = dec(wNc_6799,skSess_6745) in
                                                    {7460}new Ns_6801: bitstring;
                                                    {7461}new ST_6802: bitstring;
                                                    {7462}new TTL_6803: bitstring;
                                                    {7463}let wNs_6804: bitstring = enc(Ns_6801,pkCli_6748) in
                                                    {7464}let m2_6805: bitstring = (OpenSecureChannelResponse,wNs_6804,ST_6802,TTL_6803) in
                                                    {7465}out(c, m2_6805);
                                                    {7466}let Ksrv_6806: bitstring = h((Ns_6801,Nc_6800)) in
                                                    {7467}out(c, senc(mSrv(pkCli_6748,pkSess_6746),Ksrv_6806))
                                        )
                                        else
                                            {7468}let pkDisco_6807: bitstring = fail-any in
                                            {7469}in(c, (=pkCli_6748,em1_6808: bitstring));
                                            {7470}let m1_6809: bitstring = em1_6808 in
                                            {7471}let (=OpenSecureChannelRequest,=pkCli_6748,wNc_6810: bitstring) = m1_6809 in
                                            {7472}let Nc_6811: bitstring = dec(wNc_6810,skSess_6745) in
                                            {7473}new Ns_6812: bitstring;
                                            {7474}new ST_6813: bitstring;
                                            {7475}new TTL_6814: bitstring;
                                            {7476}let wNs_6815: bitstring = enc(Ns_6812,pkCli_6748) in
                                            {7477}let m2_6816: bitstring = (OpenSecureChannelResponse,wNs_6815,ST_6813,TTL_6814) in
                                            {7478}out(c, m2_6816);
                                            {7479}let Ksrv_6817: bitstring = h((Ns_6812,Nc_6811)) in
                                            {7480}out(c, senc(mSrv(pkCli_6748,pkSess_6746),Ksrv_6817))
                                )
                                else
                                    {7481}let pkDisco_6818: bitstring = fail-any in
                                    {7482}in(c, (=pkCli_6748,em1_6819: bitstring));
                                    {7483}let m1_6820: bitstring = em1_6819 in
                                    {7484}let (=OpenSecureChannelRequest,=pkCli_6748,wNc_6821: bitstring) = m1_6820 in
                                    {7485}let Nc_6822: bitstring = dec(wNc_6821,skSess_6745) in
                                    {7486}new Ns_6823: bitstring;
                                    {7487}new ST_6824: bitstring;
                                    {7488}new TTL_6825: bitstring;
                                    {7489}let wNs_6826: bitstring = enc(Ns_6823,pkCli_6748) in
                                    {7490}let m2_6827: bitstring = (OpenSecureChannelResponse,wNs_6826,ST_6824,TTL_6825) in
                                    {7491}out(c, m2_6827);
                                    {7492}let Ksrv_6828: bitstring = h((Ns_6823,Nc_6822)) in
                                    {7493}out(c, senc(mSrv(pkCli_6748,pkSess_6746),Ksrv_6828))
                            )
                            else
                                {7494}let v_6829: bool = (Cli_5599 = B) in
                                (
                                    {7495}if v_6829 then
                                    (
                                        {7496}let pkCli_6830: bitstring = pub(skB) in
                                        {7497}let v_6831: bool = (Disco_5600 = A) in
                                        (
                                            {7498}if v_6831 then
                                            (
                                                {7499}let pkDisco_6832: bitstring = pub(skA) in
                                                {7500}in(c, (=pkCli_6830,em1_6833: bitstring));
                                                {7501}let m1_6834: bitstring = em1_6833 in
                                                {7502}let (=OpenSecureChannelRequest,=pkCli_6830,wNc_6835: bitstring) = m1_6834 in
                                                {7503}let Nc_6836: bitstring = dec(wNc_6835,skSess_6745) in
                                                {7504}new Ns_6837: bitstring;
                                                {7505}new ST_6838: bitstring;
                                                {7506}new TTL_6839: bitstring;
                                                {7507}let wNs_6840: bitstring = enc(Ns_6837,pkCli_6830) in
                                                {7508}let m2_6841: bitstring = (OpenSecureChannelResponse,wNs_6840,ST_6838,TTL_6839) in
                                                {7509}out(c, m2_6841);
                                                {7510}let Ksrv_6842: bitstring = h((Ns_6837,Nc_6836)) in
                                                {7511}out(c, senc(mSrv(pkCli_6830,pkSess_6746),Ksrv_6842))
                                            )
                                            else
                                                {7512}let v_6843: bool = (Disco_5600 = B) in
                                                (
                                                    {7513}if v_6843 then
                                                    (
                                                        {7514}let pkDisco_6844: bitstring = pub(skB) in
                                                        {7515}in(c, (=pkCli_6830,em1_6845: bitstring));
                                                        {7516}let m1_6846: bitstring = em1_6845 in
                                                        {7517}let (=OpenSecureChannelRequest,=pkCli_6830,wNc_6847: bitstring) = m1_6846 in
                                                        {7518}let Nc_6848: bitstring = dec(wNc_6847,skSess_6745) in
                                                        {7519}new Ns_6849: bitstring;
                                                        {7520}new ST_6850: bitstring;
                                                        {7521}new TTL_6851: bitstring;
                                                        {7522}let wNs_6852: bitstring = enc(Ns_6849,pkCli_6830) in
                                                        {7523}let m2_6853: bitstring = (OpenSecureChannelResponse,wNs_6852,ST_6850,TTL_6851) in
                                                        {7524}out(c, m2_6853);
                                                        {7525}let Ksrv_6854: bitstring = h((Ns_6849,Nc_6848)) in
                                                        {7526}out(c, senc(mSrv(pkCli_6830,pkSess_6746),Ksrv_6854))
                                                    )
                                                    else
                                                        {7527}let v_6855: bool = (Disco_5600 = C) in
                                                        (
                                                            {7528}if v_6855 then
                                                            (
                                                                {7529}let pkDisco_6856: bitstring = pub(skC) in
                                                                {7530}in(c, (=pkCli_6830,em1_6857: bitstring));
                                                                {7531}let m1_6858: bitstring = em1_6857 in
                                                                {7532}let (=OpenSecureChannelRequest,=pkCli_6830,wNc_6859: bitstring) = m1_6858 in
                                                                {7533}let Nc_6860: bitstring = dec(wNc_6859,skSess_6745) in
                                                                {7534}new Ns_6861: bitstring;
                                                                {7535}new ST_6862: bitstring;
                                                                {7536}new TTL_6863: bitstring;
                                                                {7537}let wNs_6864: bitstring = enc(Ns_6861,pkCli_6830) in
                                                                {7538}let m2_6865: bitstring = (OpenSecureChannelResponse,wNs_6864,ST_6862,TTL_6863) in
                                                                {7539}out(c, m2_6865);
                                                                {7540}let Ksrv_6866: bitstring = h((Ns_6861,Nc_6860)) in
                                                                {7541}out(c, senc(mSrv(pkCli_6830,pkSess_6746),Ksrv_6866))
                                                            )
                                                            else
                                                                {7542}let pkDisco_6867: bitstring = pub(sk(Disco_5600)) in
                                                                {7543}in(c, (=pkCli_6830,em1_6868: bitstring));
                                                                {7544}let m1_6869: bitstring = em1_6868 in
                                                                {7545}let (=OpenSecureChannelRequest,=pkCli_6830,wNc_6870: bitstring) = m1_6869 in
                                                                {7546}let Nc_6871: bitstring = dec(wNc_6870,skSess_6745) in
                                                                {7547}new Ns_6872: bitstring;
                                                                {7548}new ST_6873: bitstring;
                                                                {7549}new TTL_6874: bitstring;
                                                                {7550}let wNs_6875: bitstring = enc(Ns_6872,pkCli_6830) in
                                                                {7551}let m2_6876: bitstring = (OpenSecureChannelResponse,wNs_6875,ST_6873,TTL_6874) in
                                                                {7552}out(c, m2_6876);
                                                                {7553}let Ksrv_6877: bitstring = h((Ns_6872,Nc_6871)) in
                                                                {7554}out(c, senc(mSrv(pkCli_6830,pkSess_6746),Ksrv_6877))
                                                        )
                                                        else
                                                            {7555}let pkDisco_6878: bitstring = fail-any in
                                                            {7556}in(c, (=pkCli_6830,em1_6879: bitstring));
                                                            {7557}let m1_6880: bitstring = em1_6879 in
                                                            {7558}let (=OpenSecureChannelRequest,=pkCli_6830,wNc_6881: bitstring) = m1_6880 in
                                                            {7559}let Nc_6882: bitstring = dec(wNc_6881,skSess_6745) in
                                                            {7560}new Ns_6883: bitstring;
                                                            {7561}new ST_6884: bitstring;
                                                            {7562}new TTL_6885: bitstring;
                                                            {7563}let wNs_6886: bitstring = enc(Ns_6883,pkCli_6830) in
                                                            {7564}let m2_6887: bitstring = (OpenSecureChannelResponse,wNs_6886,ST_6884,TTL_6885) in
                                                            {7565}out(c, m2_6887);
                                                            {7566}let Ksrv_6888: bitstring = h((Ns_6883,Nc_6882)) in
                                                            {7567}out(c, senc(mSrv(pkCli_6830,pkSess_6746),Ksrv_6888))
                                                )
                                                else
                                                    {7568}let pkDisco_6889: bitstring = fail-any in
                                                    {7569}in(c, (=pkCli_6830,em1_6890: bitstring));
                                                    {7570}let m1_6891: bitstring = em1_6890 in
                                                    {7571}let (=OpenSecureChannelRequest,=pkCli_6830,wNc_6892: bitstring) = m1_6891 in
                                                    {7572}let Nc_6893: bitstring = dec(wNc_6892,skSess_6745) in
                                                    {7573}new Ns_6894: bitstring;
                                                    {7574}new ST_6895: bitstring;
                                                    {7575}new TTL_6896: bitstring;
                                                    {7576}let wNs_6897: bitstring = enc(Ns_6894,pkCli_6830) in
                                                    {7577}let m2_6898: bitstring = (OpenSecureChannelResponse,wNs_6897,ST_6895,TTL_6896) in
                                                    {7578}out(c, m2_6898);
                                                    {7579}let Ksrv_6899: bitstring = h((Ns_6894,Nc_6893)) in
                                                    {7580}out(c, senc(mSrv(pkCli_6830,pkSess_6746),Ksrv_6899))
                                        )
                                        else
                                            {7581}let pkDisco_6900: bitstring = fail-any in
                                            {7582}in(c, (=pkCli_6830,em1_6901: bitstring));
                                            {7583}let m1_6902: bitstring = em1_6901 in
                                            {7584}let (=OpenSecureChannelRequest,=pkCli_6830,wNc_6903: bitstring) = m1_6902 in
                                            {7585}let Nc_6904: bitstring = dec(wNc_6903,skSess_6745) in
                                            {7586}new Ns_6905: bitstring;
                                            {7587}new ST_6906: bitstring;
                                            {7588}new TTL_6907: bitstring;
                                            {7589}let wNs_6908: bitstring = enc(Ns_6905,pkCli_6830) in
                                            {7590}let m2_6909: bitstring = (OpenSecureChannelResponse,wNs_6908,ST_6906,TTL_6907) in
                                            {7591}out(c, m2_6909);
                                            {7592}let Ksrv_6910: bitstring = h((Ns_6905,Nc_6904)) in
                                            {7593}out(c, senc(mSrv(pkCli_6830,pkSess_6746),Ksrv_6910))
                                    )
                                    else
                                        {7594}let v_6911: bool = (Cli_5599 = C) in
                                        (
                                            {7595}if v_6911 then
                                            (
                                                {7596}let pkCli_6912: bitstring = pub(skC) in
                                                {7597}let v_6913: bool = (Disco_5600 = A) in
                                                (
                                                    {7598}if v_6913 then
                                                    (
                                                        {7599}let pkDisco_6914: bitstring = pub(skA) in
                                                        {7600}in(c, (=pkCli_6912,em1_6915: bitstring));
                                                        {7601}let m1_6916: bitstring = em1_6915 in
                                                        {7602}let (=OpenSecureChannelRequest,=pkCli_6912,wNc_6917: bitstring) = m1_6916 in
                                                        {7603}let Nc_6918: bitstring = dec(wNc_6917,skSess_6745) in
                                                        {7604}new Ns_6919: bitstring;
                                                        {7605}new ST_6920: bitstring;
                                                        {7606}new TTL_6921: bitstring;
                                                        {7607}let wNs_6922: bitstring = enc(Ns_6919,pkCli_6912) in
                                                        {7608}let m2_6923: bitstring = (OpenSecureChannelResponse,wNs_6922,ST_6920,TTL_6921) in
                                                        {7609}out(c, m2_6923);
                                                        {7610}let Ksrv_6924: bitstring = h((Ns_6919,Nc_6918)) in
                                                        {7611}out(c, senc(mSrv(pkCli_6912,pkSess_6746),Ksrv_6924))
                                                    )
                                                    else
                                                        {7612}let v_6925: bool = (Disco_5600 = B) in
                                                        (
                                                            {7613}if v_6925 then
                                                            (
                                                                {7614}let pkDisco_6926: bitstring = pub(skB) in
                                                                {7615}in(c, (=pkCli_6912,em1_6927: bitstring));
                                                                {7616}let m1_6928: bitstring = em1_6927 in
                                                                {7617}let (=OpenSecureChannelRequest,=pkCli_6912,wNc_6929: bitstring) = m1_6928 in
                                                                {7618}let Nc_6930: bitstring = dec(wNc_6929,skSess_6745) in
                                                                {7619}new Ns_6931: bitstring;
                                                                {7620}new ST_6932: bitstring;
                                                                {7621}new TTL_6933: bitstring;
                                                                {7622}let wNs_6934: bitstring = enc(Ns_6931,pkCli_6912) in
                                                                {7623}let m2_6935: bitstring = (OpenSecureChannelResponse,wNs_6934,ST_6932,TTL_6933) in
                                                                {7624}out(c, m2_6935);
                                                                {7625}let Ksrv_6936: bitstring = h((Ns_6931,Nc_6930)) in
                                                                {7626}out(c, senc(mSrv(pkCli_6912,pkSess_6746),Ksrv_6936))
                                                            )
                                                            else
                                                                {7627}let v_6937: bool = (Disco_5600 = C) in
                                                                (
                                                                    {7628}if v_6937 then
                                                                    (
                                                                        {7629}let pkDisco_6938: bitstring = pub(skC) in
                                                                        {7630}in(c, (=pkCli_6912,em1_6939: bitstring));
                                                                        {7631}let m1_6940: bitstring = em1_6939 in
                                                                        {7632}let (=OpenSecureChannelRequest,=pkCli_6912,wNc_6941: bitstring) = m1_6940 in
                                                                        {7633}let Nc_6942: bitstring = dec(wNc_6941,skSess_6745) in
                                                                        {7634}new Ns_6943: bitstring;
                                                                        {7635}new ST_6944: bitstring;
                                                                        {7636}new TTL_6945: bitstring;
                                                                        {7637}let wNs_6946: bitstring = enc(Ns_6943,pkCli_6912) in
                                                                        {7638}let m2_6947: bitstring = (OpenSecureChannelResponse,wNs_6946,ST_6944,TTL_6945) in
                                                                        {7639}out(c, m2_6947);
                                                                        {7640}let Ksrv_6948: bitstring = h((Ns_6943,Nc_6942)) in
                                                                        {7641}out(c, senc(mSrv(pkCli_6912,pkSess_6746),Ksrv_6948))
                                                                    )
                                                                    else
                                                                        {7642}let pkDisco_6949: bitstring = pub(sk(Disco_5600)) in
                                                                        {7643}in(c, (=pkCli_6912,em1_6950: bitstring));
                                                                        {7644}let m1_6951: bitstring = em1_6950 in
                                                                        {7645}let (=OpenSecureChannelRequest,=pkCli_6912,wNc_6952: bitstring) = m1_6951 in
                                                                        {7646}let Nc_6953: bitstring = dec(wNc_6952,skSess_6745) in
                                                                        {7647}new Ns_6954: bitstring;
                                                                        {7648}new ST_6955: bitstring;
                                                                        {7649}new TTL_6956: bitstring;
                                                                        {7650}let wNs_6957: bitstring = enc(Ns_6954,pkCli_6912) in
                                                                        {7651}let m2_6958: bitstring = (OpenSecureChannelResponse,wNs_6957,ST_6955,TTL_6956) in
                                                                        {7652}out(c, m2_6958);
                                                                        {7653}let Ksrv_6959: bitstring = h((Ns_6954,Nc_6953)) in
                                                                        {7654}out(c, senc(mSrv(pkCli_6912,pkSess_6746),Ksrv_6959))
                                                                )
                                                                else
                                                                    {7655}let pkDisco_6960: bitstring = fail-any in
                                                                    {7656}in(c, (=pkCli_6912,em1_6961: bitstring));
                                                                    {7657}let m1_6962: bitstring = em1_6961 in
                                                                    {7658}let (=OpenSecureChannelRequest,=pkCli_6912,wNc_6963: bitstring) = m1_6962 in
                                                                    {7659}let Nc_6964: bitstring = dec(wNc_6963,skSess_6745) in
                                                                    {7660}new Ns_6965: bitstring;
                                                                    {7661}new ST_6966: bitstring;
                                                                    {7662}new TTL_6967: bitstring;
                                                                    {7663}let wNs_6968: bitstring = enc(Ns_6965,pkCli_6912) in
                                                                    {7664}let m2_6969: bitstring = (OpenSecureChannelResponse,wNs_6968,ST_6966,TTL_6967) in
                                                                    {7665}out(c, m2_6969);
                                                                    {7666}let Ksrv_6970: bitstring = h((Ns_6965,Nc_6964)) in
                                                                    {7667}out(c, senc(mSrv(pkCli_6912,pkSess_6746),Ksrv_6970))
                                                        )
                                                        else
                                                            {7668}let pkDisco_6971: bitstring = fail-any in
                                                            {7669}in(c, (=pkCli_6912,em1_6972: bitstring));
                                                            {7670}let m1_6973: bitstring = em1_6972 in
                                                            {7671}let (=OpenSecureChannelRequest,=pkCli_6912,wNc_6974: bitstring) = m1_6973 in
                                                            {7672}let Nc_6975: bitstring = dec(wNc_6974,skSess_6745) in
                                                            {7673}new Ns_6976: bitstring;
                                                            {7674}new ST_6977: bitstring;
                                                            {7675}new TTL_6978: bitstring;
                                                            {7676}let wNs_6979: bitstring = enc(Ns_6976,pkCli_6912) in
                                                            {7677}let m2_6980: bitstring = (OpenSecureChannelResponse,wNs_6979,ST_6977,TTL_6978) in
                                                            {7678}out(c, m2_6980);
                                                            {7679}let Ksrv_6981: bitstring = h((Ns_6976,Nc_6975)) in
                                                            {7680}out(c, senc(mSrv(pkCli_6912,pkSess_6746),Ksrv_6981))
                                                )
                                                else
                                                    {7681}let pkDisco_6982: bitstring = fail-any in
                                                    {7682}in(c, (=pkCli_6912,em1_6983: bitstring));
                                                    {7683}let m1_6984: bitstring = em1_6983 in
                                                    {7684}let (=OpenSecureChannelRequest,=pkCli_6912,wNc_6985: bitstring) = m1_6984 in
                                                    {7685}let Nc_6986: bitstring = dec(wNc_6985,skSess_6745) in
                                                    {7686}new Ns_6987: bitstring;
                                                    {7687}new ST_6988: bitstring;
                                                    {7688}new TTL_6989: bitstring;
                                                    {7689}let wNs_6990: bitstring = enc(Ns_6987,pkCli_6912) in
                                                    {7690}let m2_6991: bitstring = (OpenSecureChannelResponse,wNs_6990,ST_6988,TTL_6989) in
                                                    {7691}out(c, m2_6991);
                                                    {7692}let Ksrv_6992: bitstring = h((Ns_6987,Nc_6986)) in
                                                    {7693}out(c, senc(mSrv(pkCli_6912,pkSess_6746),Ksrv_6992))
                                            )
                                            else
                                                {7694}let pkCli_6993: bitstring = pub(sk(Cli_5599)) in
                                                {7695}let v_6994: bool = (Disco_5600 = A) in
                                                (
                                                    {7696}if v_6994 then
                                                    (
                                                        {7697}let pkDisco_6995: bitstring = pub(skA) in
                                                        {7698}in(c, (=pkCli_6993,em1_6996: bitstring));
                                                        {7699}let m1_6997: bitstring = em1_6996 in
                                                        {7700}let (=OpenSecureChannelRequest,=pkCli_6993,wNc_6998: bitstring) = m1_6997 in
                                                        {7701}let Nc_6999: bitstring = dec(wNc_6998,skSess_6745) in
                                                        {7702}new Ns_7000: bitstring;
                                                        {7703}new ST_7001: bitstring;
                                                        {7704}new TTL_7002: bitstring;
                                                        {7705}let wNs_7003: bitstring = enc(Ns_7000,pkCli_6993) in
                                                        {7706}let m2_7004: bitstring = (OpenSecureChannelResponse,wNs_7003,ST_7001,TTL_7002) in
                                                        {7707}out(c, m2_7004);
                                                        {7708}let Ksrv_7005: bitstring = h((Ns_7000,Nc_6999)) in
                                                        {7709}out(c, senc(mSrv(pkCli_6993,pkSess_6746),Ksrv_7005))
                                                    )
                                                    else
                                                        {7710}let v_7006: bool = (Disco_5600 = B) in
                                                        (
                                                            {7711}if v_7006 then
                                                            (
                                                                {7712}let pkDisco_7007: bitstring = pub(skB) in
                                                                {7713}in(c, (=pkCli_6993,em1_7008: bitstring));
                                                                {7714}let m1_7009: bitstring = em1_7008 in
                                                                {7715}let (=OpenSecureChannelRequest,=pkCli_6993,wNc_7010: bitstring) = m1_7009 in
                                                                {7716}let Nc_7011: bitstring = dec(wNc_7010,skSess_6745) in
                                                                {7717}new Ns_7012: bitstring;
                                                                {7718}new ST_7013: bitstring;
                                                                {7719}new TTL_7014: bitstring;
                                                                {7720}let wNs_7015: bitstring = enc(Ns_7012,pkCli_6993) in
                                                                {7721}let m2_7016: bitstring = (OpenSecureChannelResponse,wNs_7015,ST_7013,TTL_7014) in
                                                                {7722}out(c, m2_7016);
                                                                {7723}let Ksrv_7017: bitstring = h((Ns_7012,Nc_7011)) in
                                                                {7724}out(c, senc(mSrv(pkCli_6993,pkSess_6746),Ksrv_7017))
                                                            )
                                                            else
                                                                {7725}let v_7018: bool = (Disco_5600 = C) in
                                                                (
                                                                    {7726}if v_7018 then
                                                                    (
                                                                        {7727}let pkDisco_7019: bitstring = pub(skC) in
                                                                        {7728}in(c, (=pkCli_6993,em1_7020: bitstring));
                                                                        {7729}let m1_7021: bitstring = em1_7020 in
                                                                        {7730}let (=OpenSecureChannelRequest,=pkCli_6993,wNc_7022: bitstring) = m1_7021 in
                                                                        {7731}let Nc_7023: bitstring = dec(wNc_7022,skSess_6745) in
                                                                        {7732}new Ns_7024: bitstring;
                                                                        {7733}new ST_7025: bitstring;
                                                                        {7734}new TTL_7026: bitstring;
                                                                        {7735}let wNs_7027: bitstring = enc(Ns_7024,pkCli_6993) in
                                                                        {7736}let m2_7028: bitstring = (OpenSecureChannelResponse,wNs_7027,ST_7025,TTL_7026) in
                                                                        {7737}out(c, m2_7028);
                                                                        {7738}let Ksrv_7029: bitstring = h((Ns_7024,Nc_7023)) in
                                                                        {7739}out(c, senc(mSrv(pkCli_6993,pkSess_6746),Ksrv_7029))
                                                                    )
                                                                    else
                                                                        {7740}let pkDisco_7030: bitstring = pub(sk(Disco_5600)) in
                                                                        {7741}in(c, (=pkCli_6993,em1_7031: bitstring));
                                                                        {7742}let m1_7032: bitstring = em1_7031 in
                                                                        {7743}let (=OpenSecureChannelRequest,=pkCli_6993,wNc_7033: bitstring) = m1_7032 in
                                                                        {7744}let Nc_7034: bitstring = dec(wNc_7033,skSess_6745) in
                                                                        {7745}new Ns_7035: bitstring;
                                                                        {7746}new ST_7036: bitstring;
                                                                        {7747}new TTL_7037: bitstring;
                                                                        {7748}let wNs_7038: bitstring = enc(Ns_7035,pkCli_6993) in
                                                                        {7749}let m2_7039: bitstring = (OpenSecureChannelResponse,wNs_7038,ST_7036,TTL_7037) in
                                                                        {7750}out(c, m2_7039);
                                                                        {7751}let Ksrv_7040: bitstring = h((Ns_7035,Nc_7034)) in
                                                                        {7752}out(c, senc(mSrv(pkCli_6993,pkSess_6746),Ksrv_7040))
                                                                )
                                                                else
                                                                    {7753}let pkDisco_7041: bitstring = fail-any in
                                                                    {7754}in(c, (=pkCli_6993,em1_7042: bitstring));
                                                                    {7755}let m1_7043: bitstring = em1_7042 in
                                                                    {7756}let (=OpenSecureChannelRequest,=pkCli_6993,wNc_7044: bitstring) = m1_7043 in
                                                                    {7757}let Nc_7045: bitstring = dec(wNc_7044,skSess_6745) in
                                                                    {7758}new Ns_7046: bitstring;
                                                                    {7759}new ST_7047: bitstring;
                                                                    {7760}new TTL_7048: bitstring;
                                                                    {7761}let wNs_7049: bitstring = enc(Ns_7046,pkCli_6993) in
                                                                    {7762}let m2_7050: bitstring = (OpenSecureChannelResponse,wNs_7049,ST_7047,TTL_7048) in
                                                                    {7763}out(c, m2_7050);
                                                                    {7764}let Ksrv_7051: bitstring = h((Ns_7046,Nc_7045)) in
                                                                    {7765}out(c, senc(mSrv(pkCli_6993,pkSess_6746),Ksrv_7051))
                                                        )
                                                        else
                                                            {7766}let pkDisco_7052: bitstring = fail-any in
                                                            {7767}in(c, (=pkCli_6993,em1_7053: bitstring));
                                                            {7768}let m1_7054: bitstring = em1_7053 in
                                                            {7769}let (=OpenSecureChannelRequest,=pkCli_6993,wNc_7055: bitstring) = m1_7054 in
                                                            {7770}let Nc_7056: bitstring = dec(wNc_7055,skSess_6745) in
                                                            {7771}new Ns_7057: bitstring;
                                                            {7772}new ST_7058: bitstring;
                                                            {7773}new TTL_7059: bitstring;
                                                            {7774}let wNs_7060: bitstring = enc(Ns_7057,pkCli_6993) in
                                                            {7775}let m2_7061: bitstring = (OpenSecureChannelResponse,wNs_7060,ST_7058,TTL_7059) in
                                                            {7776}out(c, m2_7061);
                                                            {7777}let Ksrv_7062: bitstring = h((Ns_7057,Nc_7056)) in
                                                            {7778}out(c, senc(mSrv(pkCli_6993,pkSess_6746),Ksrv_7062))
                                                )
                                                else
                                                    {7779}let pkDisco_7063: bitstring = fail-any in
                                                    {7780}in(c, (=pkCli_6993,em1_7064: bitstring));
                                                    {7781}let m1_7065: bitstring = em1_7064 in
                                                    {7782}let (=OpenSecureChannelRequest,=pkCli_6993,wNc_7066: bitstring) = m1_7065 in
                                                    {7783}let Nc_7067: bitstring = dec(wNc_7066,skSess_6745) in
                                                    {7784}new Ns_7068: bitstring;
                                                    {7785}new ST_7069: bitstring;
                                                    {7786}new TTL_7070: bitstring;
                                                    {7787}let wNs_7071: bitstring = enc(Ns_7068,pkCli_6993) in
                                                    {7788}let m2_7072: bitstring = (OpenSecureChannelResponse,wNs_7071,ST_7069,TTL_7070) in
                                                    {7789}out(c, m2_7072);
                                                    {7790}let Ksrv_7073: bitstring = h((Ns_7068,Nc_7067)) in
                                                    {7791}out(c, senc(mSrv(pkCli_6993,pkSess_6746),Ksrv_7073))
                                        )
                                        else
                                            {7792}let pkCli_7074: bitstring = fail-any in
                                            {7793}let v_7075: bool = (Disco_5600 = A) in
                                            (
                                                {7794}if v_7075 then
                                                (
                                                    {7795}let pkDisco_7076: bitstring = pub(skA) in
                                                    {7796}in(c, (=pkCli_7074,em1_7077: bitstring));
                                                    {7797}let m1_7078: bitstring = em1_7077 in
                                                    {7798}let (=OpenSecureChannelRequest,=pkCli_7074,wNc_7079: bitstring) = m1_7078 in
                                                    {7799}let Nc_7080: bitstring = dec(wNc_7079,skSess_6745) in
                                                    {7800}new Ns_7081: bitstring;
                                                    {7801}new ST_7082: bitstring;
                                                    {7802}new TTL_7083: bitstring;
                                                    {7803}let wNs_7084: bitstring = enc(Ns_7081,pkCli_7074) in
                                                    {7804}let m2_7085: bitstring = (OpenSecureChannelResponse,wNs_7084,ST_7082,TTL_7083) in
                                                    {7805}out(c, m2_7085);
                                                    {7806}let Ksrv_7086: bitstring = h((Ns_7081,Nc_7080)) in
                                                    {7807}out(c, senc(mSrv(pkCli_7074,pkSess_6746),Ksrv_7086))
                                                )
                                                else
                                                    {7808}let v_7087: bool = (Disco_5600 = B) in
                                                    (
                                                        {7809}if v_7087 then
                                                        (
                                                            {7810}let pkDisco_7088: bitstring = pub(skB) in
                                                            {7811}in(c, (=pkCli_7074,em1_7089: bitstring));
                                                            {7812}let m1_7090: bitstring = em1_7089 in
                                                            {7813}let (=OpenSecureChannelRequest,=pkCli_7074,wNc_7091: bitstring) = m1_7090 in
                                                            {7814}let Nc_7092: bitstring = dec(wNc_7091,skSess_6745) in
                                                            {7815}new Ns_7093: bitstring;
                                                            {7816}new ST_7094: bitstring;
                                                            {7817}new TTL_7095: bitstring;
                                                            {7818}let wNs_7096: bitstring = enc(Ns_7093,pkCli_7074) in
                                                            {7819}let m2_7097: bitstring = (OpenSecureChannelResponse,wNs_7096,ST_7094,TTL_7095) in
                                                            {7820}out(c, m2_7097);
                                                            {7821}let Ksrv_7098: bitstring = h((Ns_7093,Nc_7092)) in
                                                            {7822}out(c, senc(mSrv(pkCli_7074,pkSess_6746),Ksrv_7098))
                                                        )
                                                        else
                                                            {7823}let v_7099: bool = (Disco_5600 = C) in
                                                            (
                                                                {7824}if v_7099 then
                                                                (
                                                                    {7825}let pkDisco_7100: bitstring = pub(skC) in
                                                                    {7826}in(c, (=pkCli_7074,em1_7101: bitstring));
                                                                    {7827}let m1_7102: bitstring = em1_7101 in
                                                                    {7828}let (=OpenSecureChannelRequest,=pkCli_7074,wNc_7103: bitstring) = m1_7102 in
                                                                    {7829}let Nc_7104: bitstring = dec(wNc_7103,skSess_6745) in
                                                                    {7830}new Ns_7105: bitstring;
                                                                    {7831}new ST_7106: bitstring;
                                                                    {7832}new TTL_7107: bitstring;
                                                                    {7833}let wNs_7108: bitstring = enc(Ns_7105,pkCli_7074) in
                                                                    {7834}let m2_7109: bitstring = (OpenSecureChannelResponse,wNs_7108,ST_7106,TTL_7107) in
                                                                    {7835}out(c, m2_7109);
                                                                    {7836}let Ksrv_7110: bitstring = h((Ns_7105,Nc_7104)) in
                                                                    {7837}out(c, senc(mSrv(pkCli_7074,pkSess_6746),Ksrv_7110))
                                                                )
                                                                else
                                                                    {7838}let pkDisco_7111: bitstring = pub(sk(Disco_5600)) in
                                                                    {7839}in(c, (=pkCli_7074,em1_7112: bitstring));
                                                                    {7840}let m1_7113: bitstring = em1_7112 in
                                                                    {7841}let (=OpenSecureChannelRequest,=pkCli_7074,wNc_7114: bitstring) = m1_7113 in
                                                                    {7842}let Nc_7115: bitstring = dec(wNc_7114,skSess_6745) in
                                                                    {7843}new Ns_7116: bitstring;
                                                                    {7844}new ST_7117: bitstring;
                                                                    {7845}new TTL_7118: bitstring;
                                                                    {7846}let wNs_7119: bitstring = enc(Ns_7116,pkCli_7074) in
                                                                    {7847}let m2_7120: bitstring = (OpenSecureChannelResponse,wNs_7119,ST_7117,TTL_7118) in
                                                                    {7848}out(c, m2_7120);
                                                                    {7849}let Ksrv_7121: bitstring = h((Ns_7116,Nc_7115)) in
                                                                    {7850}out(c, senc(mSrv(pkCli_7074,pkSess_6746),Ksrv_7121))
                                                            )
                                                            else
                                                                {7851}let pkDisco_7122: bitstring = fail-any in
                                                                {7852}in(c, (=pkCli_7074,em1_7123: bitstring));
                                                                {7853}let m1_7124: bitstring = em1_7123 in
                                                                {7854}let (=OpenSecureChannelRequest,=pkCli_7074,wNc_7125: bitstring) = m1_7124 in
                                                                {7855}let Nc_7126: bitstring = dec(wNc_7125,skSess_6745) in
                                                                {7856}new Ns_7127: bitstring;
                                                                {7857}new ST_7128: bitstring;
                                                                {7858}new TTL_7129: bitstring;
                                                                {7859}let wNs_7130: bitstring = enc(Ns_7127,pkCli_7074) in
                                                                {7860}let m2_7131: bitstring = (OpenSecureChannelResponse,wNs_7130,ST_7128,TTL_7129) in
                                                                {7861}out(c, m2_7131);
                                                                {7862}let Ksrv_7132: bitstring = h((Ns_7127,Nc_7126)) in
                                                                {7863}out(c, senc(mSrv(pkCli_7074,pkSess_6746),Ksrv_7132))
                                                    )
                                                    else
                                                        {7864}let pkDisco_7133: bitstring = fail-any in
                                                        {7865}in(c, (=pkCli_7074,em1_7134: bitstring));
                                                        {7866}let m1_7135: bitstring = em1_7134 in
                                                        {7867}let (=OpenSecureChannelRequest,=pkCli_7074,wNc_7136: bitstring) = m1_7135 in
                                                        {7868}let Nc_7137: bitstring = dec(wNc_7136,skSess_6745) in
                                                        {7869}new Ns_7138: bitstring;
                                                        {7870}new ST_7139: bitstring;
                                                        {7871}new TTL_7140: bitstring;
                                                        {7872}let wNs_7141: bitstring = enc(Ns_7138,pkCli_7074) in
                                                        {7873}let m2_7142: bitstring = (OpenSecureChannelResponse,wNs_7141,ST_7139,TTL_7140) in
                                                        {7874}out(c, m2_7142);
                                                        {7875}let Ksrv_7143: bitstring = h((Ns_7138,Nc_7137)) in
                                                        {7876}out(c, senc(mSrv(pkCli_7074,pkSess_6746),Ksrv_7143))
                                            )
                                            else
                                                {7877}let pkDisco_7144: bitstring = fail-any in
                                                {7878}in(c, (=pkCli_7074,em1_7145: bitstring));
                                                {7879}let m1_7146: bitstring = em1_7145 in
                                                {7880}let (=OpenSecureChannelRequest,=pkCli_7074,wNc_7147: bitstring) = m1_7146 in
                                                {7881}let Nc_7148: bitstring = dec(wNc_7147,skSess_6745) in
                                                {7882}new Ns_7149: bitstring;
                                                {7883}new ST_7150: bitstring;
                                                {7884}new TTL_7151: bitstring;
                                                {7885}let wNs_7152: bitstring = enc(Ns_7149,pkCli_7074) in
                                                {7886}let m2_7153: bitstring = (OpenSecureChannelResponse,wNs_7152,ST_7150,TTL_7151) in
                                                {7887}out(c, m2_7153);
                                                {7888}let Ksrv_7154: bitstring = h((Ns_7149,Nc_7148)) in
                                                {7889}out(c, senc(mSrv(pkCli_7074,pkSess_6746),Ksrv_7154))
                                )
                                else
                                    {7890}let pkCli_7155: bitstring = fail-any in
                                    {7891}let v_7156: bool = (Disco_5600 = A) in
                                    (
                                        {7892}if v_7156 then
                                        (
                                            {7893}let pkDisco_7157: bitstring = pub(skA) in
                                            {7894}in(c, (=pkCli_7155,em1_7158: bitstring));
                                            {7895}let m1_7159: bitstring = em1_7158 in
                                            {7896}let (=OpenSecureChannelRequest,=pkCli_7155,wNc_7160: bitstring) = m1_7159 in
                                            {7897}let Nc_7161: bitstring = dec(wNc_7160,skSess_6745) in
                                            {7898}new Ns_7162: bitstring;
                                            {7899}new ST_7163: bitstring;
                                            {7900}new TTL_7164: bitstring;
                                            {7901}let wNs_7165: bitstring = enc(Ns_7162,pkCli_7155) in
                                            {7902}let m2_7166: bitstring = (OpenSecureChannelResponse,wNs_7165,ST_7163,TTL_7164) in
                                            {7903}out(c, m2_7166);
                                            {7904}let Ksrv_7167: bitstring = h((Ns_7162,Nc_7161)) in
                                            {7905}out(c, senc(mSrv(pkCli_7155,pkSess_6746),Ksrv_7167))
                                        )
                                        else
                                            {7906}let v_7168: bool = (Disco_5600 = B) in
                                            (
                                                {7907}if v_7168 then
                                                (
                                                    {7908}let pkDisco_7169: bitstring = pub(skB) in
                                                    {7909}in(c, (=pkCli_7155,em1_7170: bitstring));
                                                    {7910}let m1_7171: bitstring = em1_7170 in
                                                    {7911}let (=OpenSecureChannelRequest,=pkCli_7155,wNc_7172: bitstring) = m1_7171 in
                                                    {7912}let Nc_7173: bitstring = dec(wNc_7172,skSess_6745) in
                                                    {7913}new Ns_7174: bitstring;
                                                    {7914}new ST_7175: bitstring;
                                                    {7915}new TTL_7176: bitstring;
                                                    {7916}let wNs_7177: bitstring = enc(Ns_7174,pkCli_7155) in
                                                    {7917}let m2_7178: bitstring = (OpenSecureChannelResponse,wNs_7177,ST_7175,TTL_7176) in
                                                    {7918}out(c, m2_7178);
                                                    {7919}let Ksrv_7179: bitstring = h((Ns_7174,Nc_7173)) in
                                                    {7920}out(c, senc(mSrv(pkCli_7155,pkSess_6746),Ksrv_7179))
                                                )
                                                else
                                                    {7921}let v_7180: bool = (Disco_5600 = C) in
                                                    (
                                                        {7922}if v_7180 then
                                                        (
                                                            {7923}let pkDisco_7181: bitstring = pub(skC) in
                                                            {7924}in(c, (=pkCli_7155,em1_7182: bitstring));
                                                            {7925}let m1_7183: bitstring = em1_7182 in
                                                            {7926}let (=OpenSecureChannelRequest,=pkCli_7155,wNc_7184: bitstring) = m1_7183 in
                                                            {7927}let Nc_7185: bitstring = dec(wNc_7184,skSess_6745) in
                                                            {7928}new Ns_7186: bitstring;
                                                            {7929}new ST_7187: bitstring;
                                                            {7930}new TTL_7188: bitstring;
                                                            {7931}let wNs_7189: bitstring = enc(Ns_7186,pkCli_7155) in
                                                            {7932}let m2_7190: bitstring = (OpenSecureChannelResponse,wNs_7189,ST_7187,TTL_7188) in
                                                            {7933}out(c, m2_7190);
                                                            {7934}let Ksrv_7191: bitstring = h((Ns_7186,Nc_7185)) in
                                                            {7935}out(c, senc(mSrv(pkCli_7155,pkSess_6746),Ksrv_7191))
                                                        )
                                                        else
                                                            {7936}let pkDisco_7192: bitstring = pub(sk(Disco_5600)) in
                                                            {7937}in(c, (=pkCli_7155,em1_7193: bitstring));
                                                            {7938}let m1_7194: bitstring = em1_7193 in
                                                            {7939}let (=OpenSecureChannelRequest,=pkCli_7155,wNc_7195: bitstring) = m1_7194 in
                                                            {7940}let Nc_7196: bitstring = dec(wNc_7195,skSess_6745) in
                                                            {7941}new Ns_7197: bitstring;
                                                            {7942}new ST_7198: bitstring;
                                                            {7943}new TTL_7199: bitstring;
                                                            {7944}let wNs_7200: bitstring = enc(Ns_7197,pkCli_7155) in
                                                            {7945}let m2_7201: bitstring = (OpenSecureChannelResponse,wNs_7200,ST_7198,TTL_7199) in
                                                            {7946}out(c, m2_7201);
                                                            {7947}let Ksrv_7202: bitstring = h((Ns_7197,Nc_7196)) in
                                                            {7948}out(c, senc(mSrv(pkCli_7155,pkSess_6746),Ksrv_7202))
                                                    )
                                                    else
                                                        {7949}let pkDisco_7203: bitstring = fail-any in
                                                        {7950}in(c, (=pkCli_7155,em1_7204: bitstring));
                                                        {7951}let m1_7205: bitstring = em1_7204 in
                                                        {7952}let (=OpenSecureChannelRequest,=pkCli_7155,wNc_7206: bitstring) = m1_7205 in
                                                        {7953}let Nc_7207: bitstring = dec(wNc_7206,skSess_6745) in
                                                        {7954}new Ns_7208: bitstring;
                                                        {7955}new ST_7209: bitstring;
                                                        {7956}new TTL_7210: bitstring;
                                                        {7957}let wNs_7211: bitstring = enc(Ns_7208,pkCli_7155) in
                                                        {7958}let m2_7212: bitstring = (OpenSecureChannelResponse,wNs_7211,ST_7209,TTL_7210) in
                                                        {7959}out(c, m2_7212);
                                                        {7960}let Ksrv_7213: bitstring = h((Ns_7208,Nc_7207)) in
                                                        {7961}out(c, senc(mSrv(pkCli_7155,pkSess_6746),Ksrv_7213))
                                            )
                                            else
                                                {7962}let pkDisco_7214: bitstring = fail-any in
                                                {7963}in(c, (=pkCli_7155,em1_7215: bitstring));
                                                {7964}let m1_7216: bitstring = em1_7215 in
                                                {7965}let (=OpenSecureChannelRequest,=pkCli_7155,wNc_7217: bitstring) = m1_7216 in
                                                {7966}let Nc_7218: bitstring = dec(wNc_7217,skSess_6745) in
                                                {7967}new Ns_7219: bitstring;
                                                {7968}new ST_7220: bitstring;
                                                {7969}new TTL_7221: bitstring;
                                                {7970}let wNs_7222: bitstring = enc(Ns_7219,pkCli_7155) in
                                                {7971}let m2_7223: bitstring = (OpenSecureChannelResponse,wNs_7222,ST_7220,TTL_7221) in
                                                {7972}out(c, m2_7223);
                                                {7973}let Ksrv_7224: bitstring = h((Ns_7219,Nc_7218)) in
                                                {7974}out(c, senc(mSrv(pkCli_7155,pkSess_6746),Ksrv_7224))
                                    )
                                    else
                                        {7975}let pkDisco_7225: bitstring = fail-any in
                                        {7976}in(c, (=pkCli_7155,em1_7226: bitstring));
                                        {7977}let m1_7227: bitstring = em1_7226 in
                                        {7978}let (=OpenSecureChannelRequest,=pkCli_7155,wNc_7228: bitstring) = m1_7227 in
                                        {7979}let Nc_7229: bitstring = dec(wNc_7228,skSess_6745) in
                                        {7980}new Ns_7230: bitstring;
                                        {7981}new ST_7231: bitstring;
                                        {7982}new TTL_7232: bitstring;
                                        {7983}let wNs_7233: bitstring = enc(Ns_7230,pkCli_7155) in
                                        {7984}let m2_7234: bitstring = (OpenSecureChannelResponse,wNs_7233,ST_7231,TTL_7232) in
                                        {7985}out(c, m2_7234);
                                        {7986}let Ksrv_7235: bitstring = h((Ns_7230,Nc_7229)) in
                                        {7987}out(c, senc(mSrv(pkCli_7155,pkSess_6746),Ksrv_7235))
                        )
                        else
                            {7988}let pkCli_7236: bitstring = fail-any in
                            {7989}let v_7237: bool = (Disco_5600 = A) in
                            (
                                {7990}if v_7237 then
                                (
                                    {7991}let pkDisco_7238: bitstring = pub(skA) in
                                    {7992}in(c, (=pkCli_7236,em1_7239: bitstring));
                                    {7993}let m1_7240: bitstring = em1_7239 in
                                    {7994}let (=OpenSecureChannelRequest,=pkCli_7236,wNc_7241: bitstring) = m1_7240 in
                                    {7995}let Nc_7242: bitstring = dec(wNc_7241,skSess_6745) in
                                    {7996}new Ns_7243: bitstring;
                                    {7997}new ST_7244: bitstring;
                                    {7998}new TTL_7245: bitstring;
                                    {7999}let wNs_7246: bitstring = enc(Ns_7243,pkCli_7236) in
                                    {8000}let m2_7247: bitstring = (OpenSecureChannelResponse,wNs_7246,ST_7244,TTL_7245) in
                                    {8001}out(c, m2_7247);
                                    {8002}let Ksrv_7248: bitstring = h((Ns_7243,Nc_7242)) in
                                    {8003}out(c, senc(mSrv(pkCli_7236,pkSess_6746),Ksrv_7248))
                                )
                                else
                                    {8004}let v_7249: bool = (Disco_5600 = B) in
                                    (
                                        {8005}if v_7249 then
                                        (
                                            {8006}let pkDisco_7250: bitstring = pub(skB) in
                                            {8007}in(c, (=pkCli_7236,em1_7251: bitstring));
                                            {8008}let m1_7252: bitstring = em1_7251 in
                                            {8009}let (=OpenSecureChannelRequest,=pkCli_7236,wNc_7253: bitstring) = m1_7252 in
                                            {8010}let Nc_7254: bitstring = dec(wNc_7253,skSess_6745) in
                                            {8011}new Ns_7255: bitstring;
                                            {8012}new ST_7256: bitstring;
                                            {8013}new TTL_7257: bitstring;
                                            {8014}let wNs_7258: bitstring = enc(Ns_7255,pkCli_7236) in
                                            {8015}let m2_7259: bitstring = (OpenSecureChannelResponse,wNs_7258,ST_7256,TTL_7257) in
                                            {8016}out(c, m2_7259);
                                            {8017}let Ksrv_7260: bitstring = h((Ns_7255,Nc_7254)) in
                                            {8018}out(c, senc(mSrv(pkCli_7236,pkSess_6746),Ksrv_7260))
                                        )
                                        else
                                            {8019}let v_7261: bool = (Disco_5600 = C) in
                                            (
                                                {8020}if v_7261 then
                                                (
                                                    {8021}let pkDisco_7262: bitstring = pub(skC) in
                                                    {8022}in(c, (=pkCli_7236,em1_7263: bitstring));
                                                    {8023}let m1_7264: bitstring = em1_7263 in
                                                    {8024}let (=OpenSecureChannelRequest,=pkCli_7236,wNc_7265: bitstring) = m1_7264 in
                                                    {8025}let Nc_7266: bitstring = dec(wNc_7265,skSess_6745) in
                                                    {8026}new Ns_7267: bitstring;
                                                    {8027}new ST_7268: bitstring;
                                                    {8028}new TTL_7269: bitstring;
                                                    {8029}let wNs_7270: bitstring = enc(Ns_7267,pkCli_7236) in
                                                    {8030}let m2_7271: bitstring = (OpenSecureChannelResponse,wNs_7270,ST_7268,TTL_7269) in
                                                    {8031}out(c, m2_7271);
                                                    {8032}let Ksrv_7272: bitstring = h((Ns_7267,Nc_7266)) in
                                                    {8033}out(c, senc(mSrv(pkCli_7236,pkSess_6746),Ksrv_7272))
                                                )
                                                else
                                                    {8034}let pkDisco_7273: bitstring = pub(sk(Disco_5600)) in
                                                    {8035}in(c, (=pkCli_7236,em1_7274: bitstring));
                                                    {8036}let m1_7275: bitstring = em1_7274 in
                                                    {8037}let (=OpenSecureChannelRequest,=pkCli_7236,wNc_7276: bitstring) = m1_7275 in
                                                    {8038}let Nc_7277: bitstring = dec(wNc_7276,skSess_6745) in
                                                    {8039}new Ns_7278: bitstring;
                                                    {8040}new ST_7279: bitstring;
                                                    {8041}new TTL_7280: bitstring;
                                                    {8042}let wNs_7281: bitstring = enc(Ns_7278,pkCli_7236) in
                                                    {8043}let m2_7282: bitstring = (OpenSecureChannelResponse,wNs_7281,ST_7279,TTL_7280) in
                                                    {8044}out(c, m2_7282);
                                                    {8045}let Ksrv_7283: bitstring = h((Ns_7278,Nc_7277)) in
                                                    {8046}out(c, senc(mSrv(pkCli_7236,pkSess_6746),Ksrv_7283))
                                            )
                                            else
                                                {8047}let pkDisco_7284: bitstring = fail-any in
                                                {8048}in(c, (=pkCli_7236,em1_7285: bitstring));
                                                {8049}let m1_7286: bitstring = em1_7285 in
                                                {8050}let (=OpenSecureChannelRequest,=pkCli_7236,wNc_7287: bitstring) = m1_7286 in
                                                {8051}let Nc_7288: bitstring = dec(wNc_7287,skSess_6745) in
                                                {8052}new Ns_7289: bitstring;
                                                {8053}new ST_7290: bitstring;
                                                {8054}new TTL_7291: bitstring;
                                                {8055}let wNs_7292: bitstring = enc(Ns_7289,pkCli_7236) in
                                                {8056}let m2_7293: bitstring = (OpenSecureChannelResponse,wNs_7292,ST_7290,TTL_7291) in
                                                {8057}out(c, m2_7293);
                                                {8058}let Ksrv_7294: bitstring = h((Ns_7289,Nc_7288)) in
                                                {8059}out(c, senc(mSrv(pkCli_7236,pkSess_6746),Ksrv_7294))
                                    )
                                    else
                                        {8060}let pkDisco_7295: bitstring = fail-any in
                                        {8061}in(c, (=pkCli_7236,em1_7296: bitstring));
                                        {8062}let m1_7297: bitstring = em1_7296 in
                                        {8063}let (=OpenSecureChannelRequest,=pkCli_7236,wNc_7298: bitstring) = m1_7297 in
                                        {8064}let Nc_7299: bitstring = dec(wNc_7298,skSess_6745) in
                                        {8065}new Ns_7300: bitstring;
                                        {8066}new ST_7301: bitstring;
                                        {8067}new TTL_7302: bitstring;
                                        {8068}let wNs_7303: bitstring = enc(Ns_7300,pkCli_7236) in
                                        {8069}let m2_7304: bitstring = (OpenSecureChannelResponse,wNs_7303,ST_7301,TTL_7302) in
                                        {8070}out(c, m2_7304);
                                        {8071}let Ksrv_7305: bitstring = h((Ns_7300,Nc_7299)) in
                                        {8072}out(c, senc(mSrv(pkCli_7236,pkSess_6746),Ksrv_7305))
                            )
                            else
                                {8073}let pkDisco_7306: bitstring = fail-any in
                                {8074}in(c, (=pkCli_7236,em1_7307: bitstring));
                                {8075}let m1_7308: bitstring = em1_7307 in
                                {8076}let (=OpenSecureChannelRequest,=pkCli_7236,wNc_7309: bitstring) = m1_7308 in
                                {8077}let Nc_7310: bitstring = dec(wNc_7309,skSess_6745) in
                                {8078}new Ns_7311: bitstring;
                                {8079}new ST_7312: bitstring;
                                {8080}new TTL_7313: bitstring;
                                {8081}let wNs_7314: bitstring = enc(Ns_7311,pkCli_7236) in
                                {8082}let m2_7315: bitstring = (OpenSecureChannelResponse,wNs_7314,ST_7312,TTL_7313) in
                                {8083}out(c, m2_7315);
                                {8084}let Ksrv_7316: bitstring = h((Ns_7311,Nc_7310)) in
                                {8085}out(c, senc(mSrv(pkCli_7236,pkSess_6746),Ksrv_7316))
                    )
                    else
                        {8086}let skSess_7317: bitstring = fail-any in
                        {8087}let pkSess_7318: bitstring = pub(skSess_7317) in
                        {8088}let v_7319: bool = (Cli_5599 = A) in
                        (
                            {8089}if v_7319 then
                            (
                                {8090}let pkCli_7320: bitstring = pub(skA) in
                                {8091}let v_7321: bool = (Disco_5600 = A) in
                                (
                                    {8092}if v_7321 then
                                    (
                                        {8093}let pkDisco_7322: bitstring = pub(skA) in
                                        {8094}in(c, (=pkCli_7320,em1_7323: bitstring));
                                        {8095}let m1_7324: bitstring = em1_7323 in
                                        {8096}let (=OpenSecureChannelRequest,=pkCli_7320,wNc_7325: bitstring) = m1_7324 in
                                        {8097}let Nc_7326: bitstring = dec(wNc_7325,skSess_7317) in
                                        {8098}new Ns_7327: bitstring;
                                        {8099}new ST_7328: bitstring;
                                        {8100}new TTL_7329: bitstring;
                                        {8101}let wNs_7330: bitstring = enc(Ns_7327,pkCli_7320) in
                                        {8102}let m2_7331: bitstring = (OpenSecureChannelResponse,wNs_7330,ST_7328,TTL_7329) in
                                        {8103}out(c, m2_7331);
                                        {8104}let Ksrv_7332: bitstring = h((Ns_7327,Nc_7326)) in
                                        {8105}out(c, senc(mSrv(pkCli_7320,pkSess_7318),Ksrv_7332))
                                    )
                                    else
                                        {8106}let v_7333: bool = (Disco_5600 = B) in
                                        (
                                            {8107}if v_7333 then
                                            (
                                                {8108}let pkDisco_7334: bitstring = pub(skB) in
                                                {8109}in(c, (=pkCli_7320,em1_7335: bitstring));
                                                {8110}let m1_7336: bitstring = em1_7335 in
                                                {8111}let (=OpenSecureChannelRequest,=pkCli_7320,wNc_7337: bitstring) = m1_7336 in
                                                {8112}let Nc_7338: bitstring = dec(wNc_7337,skSess_7317) in
                                                {8113}new Ns_7339: bitstring;
                                                {8114}new ST_7340: bitstring;
                                                {8115}new TTL_7341: bitstring;
                                                {8116}let wNs_7342: bitstring = enc(Ns_7339,pkCli_7320) in
                                                {8117}let m2_7343: bitstring = (OpenSecureChannelResponse,wNs_7342,ST_7340,TTL_7341) in
                                                {8118}out(c, m2_7343);
                                                {8119}let Ksrv_7344: bitstring = h((Ns_7339,Nc_7338)) in
                                                {8120}out(c, senc(mSrv(pkCli_7320,pkSess_7318),Ksrv_7344))
                                            )
                                            else
                                                {8121}let v_7345: bool = (Disco_5600 = C) in
                                                (
                                                    {8122}if v_7345 then
                                                    (
                                                        {8123}let pkDisco_7346: bitstring = pub(skC) in
                                                        {8124}in(c, (=pkCli_7320,em1_7347: bitstring));
                                                        {8125}let m1_7348: bitstring = em1_7347 in
                                                        {8126}let (=OpenSecureChannelRequest,=pkCli_7320,wNc_7349: bitstring) = m1_7348 in
                                                        {8127}let Nc_7350: bitstring = dec(wNc_7349,skSess_7317) in
                                                        {8128}new Ns_7351: bitstring;
                                                        {8129}new ST_7352: bitstring;
                                                        {8130}new TTL_7353: bitstring;
                                                        {8131}let wNs_7354: bitstring = enc(Ns_7351,pkCli_7320) in
                                                        {8132}let m2_7355: bitstring = (OpenSecureChannelResponse,wNs_7354,ST_7352,TTL_7353) in
                                                        {8133}out(c, m2_7355);
                                                        {8134}let Ksrv_7356: bitstring = h((Ns_7351,Nc_7350)) in
                                                        {8135}out(c, senc(mSrv(pkCli_7320,pkSess_7318),Ksrv_7356))
                                                    )
                                                    else
                                                        {8136}let pkDisco_7357: bitstring = pub(sk(Disco_5600)) in
                                                        {8137}in(c, (=pkCli_7320,em1_7358: bitstring));
                                                        {8138}let m1_7359: bitstring = em1_7358 in
                                                        {8139}let (=OpenSecureChannelRequest,=pkCli_7320,wNc_7360: bitstring) = m1_7359 in
                                                        {8140}let Nc_7361: bitstring = dec(wNc_7360,skSess_7317) in
                                                        {8141}new Ns_7362: bitstring;
                                                        {8142}new ST_7363: bitstring;
                                                        {8143}new TTL_7364: bitstring;
                                                        {8144}let wNs_7365: bitstring = enc(Ns_7362,pkCli_7320) in
                                                        {8145}let m2_7366: bitstring = (OpenSecureChannelResponse,wNs_7365,ST_7363,TTL_7364) in
                                                        {8146}out(c, m2_7366);
                                                        {8147}let Ksrv_7367: bitstring = h((Ns_7362,Nc_7361)) in
                                                        {8148}out(c, senc(mSrv(pkCli_7320,pkSess_7318),Ksrv_7367))
                                                )
                                                else
                                                    {8149}let pkDisco_7368: bitstring = fail-any in
                                                    {8150}in(c, (=pkCli_7320,em1_7369: bitstring));
                                                    {8151}let m1_7370: bitstring = em1_7369 in
                                                    {8152}let (=OpenSecureChannelRequest,=pkCli_7320,wNc_7371: bitstring) = m1_7370 in
                                                    {8153}let Nc_7372: bitstring = dec(wNc_7371,skSess_7317) in
                                                    {8154}new Ns_7373: bitstring;
                                                    {8155}new ST_7374: bitstring;
                                                    {8156}new TTL_7375: bitstring;
                                                    {8157}let wNs_7376: bitstring = enc(Ns_7373,pkCli_7320) in
                                                    {8158}let m2_7377: bitstring = (OpenSecureChannelResponse,wNs_7376,ST_7374,TTL_7375) in
                                                    {8159}out(c, m2_7377);
                                                    {8160}let Ksrv_7378: bitstring = h((Ns_7373,Nc_7372)) in
                                                    {8161}out(c, senc(mSrv(pkCli_7320,pkSess_7318),Ksrv_7378))
                                        )
                                        else
                                            {8162}let pkDisco_7379: bitstring = fail-any in
                                            {8163}in(c, (=pkCli_7320,em1_7380: bitstring));
                                            {8164}let m1_7381: bitstring = em1_7380 in
                                            {8165}let (=OpenSecureChannelRequest,=pkCli_7320,wNc_7382: bitstring) = m1_7381 in
                                            {8166}let Nc_7383: bitstring = dec(wNc_7382,skSess_7317) in
                                            {8167}new Ns_7384: bitstring;
                                            {8168}new ST_7385: bitstring;
                                            {8169}new TTL_7386: bitstring;
                                            {8170}let wNs_7387: bitstring = enc(Ns_7384,pkCli_7320) in
                                            {8171}let m2_7388: bitstring = (OpenSecureChannelResponse,wNs_7387,ST_7385,TTL_7386) in
                                            {8172}out(c, m2_7388);
                                            {8173}let Ksrv_7389: bitstring = h((Ns_7384,Nc_7383)) in
                                            {8174}out(c, senc(mSrv(pkCli_7320,pkSess_7318),Ksrv_7389))
                                )
                                else
                                    {8175}let pkDisco_7390: bitstring = fail-any in
                                    {8176}in(c, (=pkCli_7320,em1_7391: bitstring));
                                    {8177}let m1_7392: bitstring = em1_7391 in
                                    {8178}let (=OpenSecureChannelRequest,=pkCli_7320,wNc_7393: bitstring) = m1_7392 in
                                    {8179}let Nc_7394: bitstring = dec(wNc_7393,skSess_7317) in
                                    {8180}new Ns_7395: bitstring;
                                    {8181}new ST_7396: bitstring;
                                    {8182}new TTL_7397: bitstring;
                                    {8183}let wNs_7398: bitstring = enc(Ns_7395,pkCli_7320) in
                                    {8184}let m2_7399: bitstring = (OpenSecureChannelResponse,wNs_7398,ST_7396,TTL_7397) in
                                    {8185}out(c, m2_7399);
                                    {8186}let Ksrv_7400: bitstring = h((Ns_7395,Nc_7394)) in
                                    {8187}out(c, senc(mSrv(pkCli_7320,pkSess_7318),Ksrv_7400))
                            )
                            else
                                {8188}let v_7401: bool = (Cli_5599 = B) in
                                (
                                    {8189}if v_7401 then
                                    (
                                        {8190}let pkCli_7402: bitstring = pub(skB) in
                                        {8191}let v_7403: bool = (Disco_5600 = A) in
                                        (
                                            {8192}if v_7403 then
                                            (
                                                {8193}let pkDisco_7404: bitstring = pub(skA) in
                                                {8194}in(c, (=pkCli_7402,em1_7405: bitstring));
                                                {8195}let m1_7406: bitstring = em1_7405 in
                                                {8196}let (=OpenSecureChannelRequest,=pkCli_7402,wNc_7407: bitstring) = m1_7406 in
                                                {8197}let Nc_7408: bitstring = dec(wNc_7407,skSess_7317) in
                                                {8198}new Ns_7409: bitstring;
                                                {8199}new ST_7410: bitstring;
                                                {8200}new TTL_7411: bitstring;
                                                {8201}let wNs_7412: bitstring = enc(Ns_7409,pkCli_7402) in
                                                {8202}let m2_7413: bitstring = (OpenSecureChannelResponse,wNs_7412,ST_7410,TTL_7411) in
                                                {8203}out(c, m2_7413);
                                                {8204}let Ksrv_7414: bitstring = h((Ns_7409,Nc_7408)) in
                                                {8205}out(c, senc(mSrv(pkCli_7402,pkSess_7318),Ksrv_7414))
                                            )
                                            else
                                                {8206}let v_7415: bool = (Disco_5600 = B) in
                                                (
                                                    {8207}if v_7415 then
                                                    (
                                                        {8208}let pkDisco_7416: bitstring = pub(skB) in
                                                        {8209}in(c, (=pkCli_7402,em1_7417: bitstring));
                                                        {8210}let m1_7418: bitstring = em1_7417 in
                                                        {8211}let (=OpenSecureChannelRequest,=pkCli_7402,wNc_7419: bitstring) = m1_7418 in
                                                        {8212}let Nc_7420: bitstring = dec(wNc_7419,skSess_7317) in
                                                        {8213}new Ns_7421: bitstring;
                                                        {8214}new ST_7422: bitstring;
                                                        {8215}new TTL_7423: bitstring;
                                                        {8216}let wNs_7424: bitstring = enc(Ns_7421,pkCli_7402) in
                                                        {8217}let m2_7425: bitstring = (OpenSecureChannelResponse,wNs_7424,ST_7422,TTL_7423) in
                                                        {8218}out(c, m2_7425);
                                                        {8219}let Ksrv_7426: bitstring = h((Ns_7421,Nc_7420)) in
                                                        {8220}out(c, senc(mSrv(pkCli_7402,pkSess_7318),Ksrv_7426))
                                                    )
                                                    else
                                                        {8221}let v_7427: bool = (Disco_5600 = C) in
                                                        (
                                                            {8222}if v_7427 then
                                                            (
                                                                {8223}let pkDisco_7428: bitstring = pub(skC) in
                                                                {8224}in(c, (=pkCli_7402,em1_7429: bitstring));
                                                                {8225}let m1_7430: bitstring = em1_7429 in
                                                                {8226}let (=OpenSecureChannelRequest,=pkCli_7402,wNc_7431: bitstring) = m1_7430 in
                                                                {8227}let Nc_7432: bitstring = dec(wNc_7431,skSess_7317) in
                                                                {8228}new Ns_7433: bitstring;
                                                                {8229}new ST_7434: bitstring;
                                                                {8230}new TTL_7435: bitstring;
                                                                {8231}let wNs_7436: bitstring = enc(Ns_7433,pkCli_7402) in
                                                                {8232}let m2_7437: bitstring = (OpenSecureChannelResponse,wNs_7436,ST_7434,TTL_7435) in
                                                                {8233}out(c, m2_7437);
                                                                {8234}let Ksrv_7438: bitstring = h((Ns_7433,Nc_7432)) in
                                                                {8235}out(c, senc(mSrv(pkCli_7402,pkSess_7318),Ksrv_7438))
                                                            )
                                                            else
                                                                {8236}let pkDisco_7439: bitstring = pub(sk(Disco_5600)) in
                                                                {8237}in(c, (=pkCli_7402,em1_7440: bitstring));
                                                                {8238}let m1_7441: bitstring = em1_7440 in
                                                                {8239}let (=OpenSecureChannelRequest,=pkCli_7402,wNc_7442: bitstring) = m1_7441 in
                                                                {8240}let Nc_7443: bitstring = dec(wNc_7442,skSess_7317) in
                                                                {8241}new Ns_7444: bitstring;
                                                                {8242}new ST_7445: bitstring;
                                                                {8243}new TTL_7446: bitstring;
                                                                {8244}let wNs_7447: bitstring = enc(Ns_7444,pkCli_7402) in
                                                                {8245}let m2_7448: bitstring = (OpenSecureChannelResponse,wNs_7447,ST_7445,TTL_7446) in
                                                                {8246}out(c, m2_7448);
                                                                {8247}let Ksrv_7449: bitstring = h((Ns_7444,Nc_7443)) in
                                                                {8248}out(c, senc(mSrv(pkCli_7402,pkSess_7318),Ksrv_7449))
                                                        )
                                                        else
                                                            {8249}let pkDisco_7450: bitstring = fail-any in
                                                            {8250}in(c, (=pkCli_7402,em1_7451: bitstring));
                                                            {8251}let m1_7452: bitstring = em1_7451 in
                                                            {8252}let (=OpenSecureChannelRequest,=pkCli_7402,wNc_7453: bitstring) = m1_7452 in
                                                            {8253}let Nc_7454: bitstring = dec(wNc_7453,skSess_7317) in
                                                            {8254}new Ns_7455: bitstring;
                                                            {8255}new ST_7456: bitstring;
                                                            {8256}new TTL_7457: bitstring;
                                                            {8257}let wNs_7458: bitstring = enc(Ns_7455,pkCli_7402) in
                                                            {8258}let m2_7459: bitstring = (OpenSecureChannelResponse,wNs_7458,ST_7456,TTL_7457) in
                                                            {8259}out(c, m2_7459);
                                                            {8260}let Ksrv_7460: bitstring = h((Ns_7455,Nc_7454)) in
                                                            {8261}out(c, senc(mSrv(pkCli_7402,pkSess_7318),Ksrv_7460))
                                                )
                                                else
                                                    {8262}let pkDisco_7461: bitstring = fail-any in
                                                    {8263}in(c, (=pkCli_7402,em1_7462: bitstring));
                                                    {8264}let m1_7463: bitstring = em1_7462 in
                                                    {8265}let (=OpenSecureChannelRequest,=pkCli_7402,wNc_7464: bitstring) = m1_7463 in
                                                    {8266}let Nc_7465: bitstring = dec(wNc_7464,skSess_7317) in
                                                    {8267}new Ns_7466: bitstring;
                                                    {8268}new ST_7467: bitstring;
                                                    {8269}new TTL_7468: bitstring;
                                                    {8270}let wNs_7469: bitstring = enc(Ns_7466,pkCli_7402) in
                                                    {8271}let m2_7470: bitstring = (OpenSecureChannelResponse,wNs_7469,ST_7467,TTL_7468) in
                                                    {8272}out(c, m2_7470);
                                                    {8273}let Ksrv_7471: bitstring = h((Ns_7466,Nc_7465)) in
                                                    {8274}out(c, senc(mSrv(pkCli_7402,pkSess_7318),Ksrv_7471))
                                        )
                                        else
                                            {8275}let pkDisco_7472: bitstring = fail-any in
                                            {8276}in(c, (=pkCli_7402,em1_7473: bitstring));
                                            {8277}let m1_7474: bitstring = em1_7473 in
                                            {8278}let (=OpenSecureChannelRequest,=pkCli_7402,wNc_7475: bitstring) = m1_7474 in
                                            {8279}let Nc_7476: bitstring = dec(wNc_7475,skSess_7317) in
                                            {8280}new Ns_7477: bitstring;
                                            {8281}new ST_7478: bitstring;
                                            {8282}new TTL_7479: bitstring;
                                            {8283}let wNs_7480: bitstring = enc(Ns_7477,pkCli_7402) in
                                            {8284}let m2_7481: bitstring = (OpenSecureChannelResponse,wNs_7480,ST_7478,TTL_7479) in
                                            {8285}out(c, m2_7481);
                                            {8286}let Ksrv_7482: bitstring = h((Ns_7477,Nc_7476)) in
                                            {8287}out(c, senc(mSrv(pkCli_7402,pkSess_7318),Ksrv_7482))
                                    )
                                    else
                                        {8288}let v_7483: bool = (Cli_5599 = C) in
                                        (
                                            {8289}if v_7483 then
                                            (
                                                {8290}let pkCli_7484: bitstring = pub(skC) in
                                                {8291}let v_7485: bool = (Disco_5600 = A) in
                                                (
                                                    {8292}if v_7485 then
                                                    (
                                                        {8293}let pkDisco_7486: bitstring = pub(skA) in
                                                        {8294}in(c, (=pkCli_7484,em1_7487: bitstring));
                                                        {8295}let m1_7488: bitstring = em1_7487 in
                                                        {8296}let (=OpenSecureChannelRequest,=pkCli_7484,wNc_7489: bitstring) = m1_7488 in
                                                        {8297}let Nc_7490: bitstring = dec(wNc_7489,skSess_7317) in
                                                        {8298}new Ns_7491: bitstring;
                                                        {8299}new ST_7492: bitstring;
                                                        {8300}new TTL_7493: bitstring;
                                                        {8301}let wNs_7494: bitstring = enc(Ns_7491,pkCli_7484) in
                                                        {8302}let m2_7495: bitstring = (OpenSecureChannelResponse,wNs_7494,ST_7492,TTL_7493) in
                                                        {8303}out(c, m2_7495);
                                                        {8304}let Ksrv_7496: bitstring = h((Ns_7491,Nc_7490)) in
                                                        {8305}out(c, senc(mSrv(pkCli_7484,pkSess_7318),Ksrv_7496))
                                                    )
                                                    else
                                                        {8306}let v_7497: bool = (Disco_5600 = B) in
                                                        (
                                                            {8307}if v_7497 then
                                                            (
                                                                {8308}let pkDisco_7498: bitstring = pub(skB) in
                                                                {8309}in(c, (=pkCli_7484,em1_7499: bitstring));
                                                                {8310}let m1_7500: bitstring = em1_7499 in
                                                                {8311}let (=OpenSecureChannelRequest,=pkCli_7484,wNc_7501: bitstring) = m1_7500 in
                                                                {8312}let Nc_7502: bitstring = dec(wNc_7501,skSess_7317) in
                                                                {8313}new Ns_7503: bitstring;
                                                                {8314}new ST_7504: bitstring;
                                                                {8315}new TTL_7505: bitstring;
                                                                {8316}let wNs_7506: bitstring = enc(Ns_7503,pkCli_7484) in
                                                                {8317}let m2_7507: bitstring = (OpenSecureChannelResponse,wNs_7506,ST_7504,TTL_7505) in
                                                                {8318}out(c, m2_7507);
                                                                {8319}let Ksrv_7508: bitstring = h((Ns_7503,Nc_7502)) in
                                                                {8320}out(c, senc(mSrv(pkCli_7484,pkSess_7318),Ksrv_7508))
                                                            )
                                                            else
                                                                {8321}let v_7509: bool = (Disco_5600 = C) in
                                                                (
                                                                    {8322}if v_7509 then
                                                                    (
                                                                        {8323}let pkDisco_7510: bitstring = pub(skC) in
                                                                        {8324}in(c, (=pkCli_7484,em1_7511: bitstring));
                                                                        {8325}let m1_7512: bitstring = em1_7511 in
                                                                        {8326}let (=OpenSecureChannelRequest,=pkCli_7484,wNc_7513: bitstring) = m1_7512 in
                                                                        {8327}let Nc_7514: bitstring = dec(wNc_7513,skSess_7317) in
                                                                        {8328}new Ns_7515: bitstring;
                                                                        {8329}new ST_7516: bitstring;
                                                                        {8330}new TTL_7517: bitstring;
                                                                        {8331}let wNs_7518: bitstring = enc(Ns_7515,pkCli_7484) in
                                                                        {8332}let m2_7519: bitstring = (OpenSecureChannelResponse,wNs_7518,ST_7516,TTL_7517) in
                                                                        {8333}out(c, m2_7519);
                                                                        {8334}let Ksrv_7520: bitstring = h((Ns_7515,Nc_7514)) in
                                                                        {8335}out(c, senc(mSrv(pkCli_7484,pkSess_7318),Ksrv_7520))
                                                                    )
                                                                    else
                                                                        {8336}let pkDisco_7521: bitstring = pub(sk(Disco_5600)) in
                                                                        {8337}in(c, (=pkCli_7484,em1_7522: bitstring));
                                                                        {8338}let m1_7523: bitstring = em1_7522 in
                                                                        {8339}let (=OpenSecureChannelRequest,=pkCli_7484,wNc_7524: bitstring) = m1_7523 in
                                                                        {8340}let Nc_7525: bitstring = dec(wNc_7524,skSess_7317) in
                                                                        {8341}new Ns_7526: bitstring;
                                                                        {8342}new ST_7527: bitstring;
                                                                        {8343}new TTL_7528: bitstring;
                                                                        {8344}let wNs_7529: bitstring = enc(Ns_7526,pkCli_7484) in
                                                                        {8345}let m2_7530: bitstring = (OpenSecureChannelResponse,wNs_7529,ST_7527,TTL_7528) in
                                                                        {8346}out(c, m2_7530);
                                                                        {8347}let Ksrv_7531: bitstring = h((Ns_7526,Nc_7525)) in
                                                                        {8348}out(c, senc(mSrv(pkCli_7484,pkSess_7318),Ksrv_7531))
                                                                )
                                                                else
                                                                    {8349}let pkDisco_7532: bitstring = fail-any in
                                                                    {8350}in(c, (=pkCli_7484,em1_7533: bitstring));
                                                                    {8351}let m1_7534: bitstring = em1_7533 in
                                                                    {8352}let (=OpenSecureChannelRequest,=pkCli_7484,wNc_7535: bitstring) = m1_7534 in
                                                                    {8353}let Nc_7536: bitstring = dec(wNc_7535,skSess_7317) in
                                                                    {8354}new Ns_7537: bitstring;
                                                                    {8355}new ST_7538: bitstring;
                                                                    {8356}new TTL_7539: bitstring;
                                                                    {8357}let wNs_7540: bitstring = enc(Ns_7537,pkCli_7484) in
                                                                    {8358}let m2_7541: bitstring = (OpenSecureChannelResponse,wNs_7540,ST_7538,TTL_7539) in
                                                                    {8359}out(c, m2_7541);
                                                                    {8360}let Ksrv_7542: bitstring = h((Ns_7537,Nc_7536)) in
                                                                    {8361}out(c, senc(mSrv(pkCli_7484,pkSess_7318),Ksrv_7542))
                                                        )
                                                        else
                                                            {8362}let pkDisco_7543: bitstring = fail-any in
                                                            {8363}in(c, (=pkCli_7484,em1_7544: bitstring));
                                                            {8364}let m1_7545: bitstring = em1_7544 in
                                                            {8365}let (=OpenSecureChannelRequest,=pkCli_7484,wNc_7546: bitstring) = m1_7545 in
                                                            {8366}let Nc_7547: bitstring = dec(wNc_7546,skSess_7317) in
                                                            {8367}new Ns_7548: bitstring;
                                                            {8368}new ST_7549: bitstring;
                                                            {8369}new TTL_7550: bitstring;
                                                            {8370}let wNs_7551: bitstring = enc(Ns_7548,pkCli_7484) in
                                                            {8371}let m2_7552: bitstring = (OpenSecureChannelResponse,wNs_7551,ST_7549,TTL_7550) in
                                                            {8372}out(c, m2_7552);
                                                            {8373}let Ksrv_7553: bitstring = h((Ns_7548,Nc_7547)) in
                                                            {8374}out(c, senc(mSrv(pkCli_7484,pkSess_7318),Ksrv_7553))
                                                )
                                                else
                                                    {8375}let pkDisco_7554: bitstring = fail-any in
                                                    {8376}in(c, (=pkCli_7484,em1_7555: bitstring));
                                                    {8377}let m1_7556: bitstring = em1_7555 in
                                                    {8378}let (=OpenSecureChannelRequest,=pkCli_7484,wNc_7557: bitstring) = m1_7556 in
                                                    {8379}let Nc_7558: bitstring = dec(wNc_7557,skSess_7317) in
                                                    {8380}new Ns_7559: bitstring;
                                                    {8381}new ST_7560: bitstring;
                                                    {8382}new TTL_7561: bitstring;
                                                    {8383}let wNs_7562: bitstring = enc(Ns_7559,pkCli_7484) in
                                                    {8384}let m2_7563: bitstring = (OpenSecureChannelResponse,wNs_7562,ST_7560,TTL_7561) in
                                                    {8385}out(c, m2_7563);
                                                    {8386}let Ksrv_7564: bitstring = h((Ns_7559,Nc_7558)) in
                                                    {8387}out(c, senc(mSrv(pkCli_7484,pkSess_7318),Ksrv_7564))
                                            )
                                            else
                                                {8388}let pkCli_7565: bitstring = pub(sk(Cli_5599)) in
                                                {8389}let v_7566: bool = (Disco_5600 = A) in
                                                (
                                                    {8390}if v_7566 then
                                                    (
                                                        {8391}let pkDisco_7567: bitstring = pub(skA) in
                                                        {8392}in(c, (=pkCli_7565,em1_7568: bitstring));
                                                        {8393}let m1_7569: bitstring = em1_7568 in
                                                        {8394}let (=OpenSecureChannelRequest,=pkCli_7565,wNc_7570: bitstring) = m1_7569 in
                                                        {8395}let Nc_7571: bitstring = dec(wNc_7570,skSess_7317) in
                                                        {8396}new Ns_7572: bitstring;
                                                        {8397}new ST_7573: bitstring;
                                                        {8398}new TTL_7574: bitstring;
                                                        {8399}let wNs_7575: bitstring = enc(Ns_7572,pkCli_7565) in
                                                        {8400}let m2_7576: bitstring = (OpenSecureChannelResponse,wNs_7575,ST_7573,TTL_7574) in
                                                        {8401}out(c, m2_7576);
                                                        {8402}let Ksrv_7577: bitstring = h((Ns_7572,Nc_7571)) in
                                                        {8403}out(c, senc(mSrv(pkCli_7565,pkSess_7318),Ksrv_7577))
                                                    )
                                                    else
                                                        {8404}let v_7578: bool = (Disco_5600 = B) in
                                                        (
                                                            {8405}if v_7578 then
                                                            (
                                                                {8406}let pkDisco_7579: bitstring = pub(skB) in
                                                                {8407}in(c, (=pkCli_7565,em1_7580: bitstring));
                                                                {8408}let m1_7581: bitstring = em1_7580 in
                                                                {8409}let (=OpenSecureChannelRequest,=pkCli_7565,wNc_7582: bitstring) = m1_7581 in
                                                                {8410}let Nc_7583: bitstring = dec(wNc_7582,skSess_7317) in
                                                                {8411}new Ns_7584: bitstring;
                                                                {8412}new ST_7585: bitstring;
                                                                {8413}new TTL_7586: bitstring;
                                                                {8414}let wNs_7587: bitstring = enc(Ns_7584,pkCli_7565) in
                                                                {8415}let m2_7588: bitstring = (OpenSecureChannelResponse,wNs_7587,ST_7585,TTL_7586) in
                                                                {8416}out(c, m2_7588);
                                                                {8417}let Ksrv_7589: bitstring = h((Ns_7584,Nc_7583)) in
                                                                {8418}out(c, senc(mSrv(pkCli_7565,pkSess_7318),Ksrv_7589))
                                                            )
                                                            else
                                                                {8419}let v_7590: bool = (Disco_5600 = C) in
                                                                (
                                                                    {8420}if v_7590 then
                                                                    (
                                                                        {8421}let pkDisco_7591: bitstring = pub(skC) in
                                                                        {8422}in(c, (=pkCli_7565,em1_7592: bitstring));
                                                                        {8423}let m1_7593: bitstring = em1_7592 in
                                                                        {8424}let (=OpenSecureChannelRequest,=pkCli_7565,wNc_7594: bitstring) = m1_7593 in
                                                                        {8425}let Nc_7595: bitstring = dec(wNc_7594,skSess_7317) in
                                                                        {8426}new Ns_7596: bitstring;
                                                                        {8427}new ST_7597: bitstring;
                                                                        {8428}new TTL_7598: bitstring;
                                                                        {8429}let wNs_7599: bitstring = enc(Ns_7596,pkCli_7565) in
                                                                        {8430}let m2_7600: bitstring = (OpenSecureChannelResponse,wNs_7599,ST_7597,TTL_7598) in
                                                                        {8431}out(c, m2_7600);
                                                                        {8432}let Ksrv_7601: bitstring = h((Ns_7596,Nc_7595)) in
                                                                        {8433}out(c, senc(mSrv(pkCli_7565,pkSess_7318),Ksrv_7601))
                                                                    )
                                                                    else
                                                                        {8434}let pkDisco_7602: bitstring = pub(sk(Disco_5600)) in
                                                                        {8435}in(c, (=pkCli_7565,em1_7603: bitstring));
                                                                        {8436}let m1_7604: bitstring = em1_7603 in
                                                                        {8437}let (=OpenSecureChannelRequest,=pkCli_7565,wNc_7605: bitstring) = m1_7604 in
                                                                        {8438}let Nc_7606: bitstring = dec(wNc_7605,skSess_7317) in
                                                                        {8439}new Ns_7607: bitstring;
                                                                        {8440}new ST_7608: bitstring;
                                                                        {8441}new TTL_7609: bitstring;
                                                                        {8442}let wNs_7610: bitstring = enc(Ns_7607,pkCli_7565) in
                                                                        {8443}let m2_7611: bitstring = (OpenSecureChannelResponse,wNs_7610,ST_7608,TTL_7609) in
                                                                        {8444}out(c, m2_7611);
                                                                        {8445}let Ksrv_7612: bitstring = h((Ns_7607,Nc_7606)) in
                                                                        {8446}out(c, senc(mSrv(pkCli_7565,pkSess_7318),Ksrv_7612))
                                                                )
                                                                else
                                                                    {8447}let pkDisco_7613: bitstring = fail-any in
                                                                    {8448}in(c, (=pkCli_7565,em1_7614: bitstring));
                                                                    {8449}let m1_7615: bitstring = em1_7614 in
                                                                    {8450}let (=OpenSecureChannelRequest,=pkCli_7565,wNc_7616: bitstring) = m1_7615 in
                                                                    {8451}let Nc_7617: bitstring = dec(wNc_7616,skSess_7317) in
                                                                    {8452}new Ns_7618: bitstring;
                                                                    {8453}new ST_7619: bitstring;
                                                                    {8454}new TTL_7620: bitstring;
                                                                    {8455}let wNs_7621: bitstring = enc(Ns_7618,pkCli_7565) in
                                                                    {8456}let m2_7622: bitstring = (OpenSecureChannelResponse,wNs_7621,ST_7619,TTL_7620) in
                                                                    {8457}out(c, m2_7622);
                                                                    {8458}let Ksrv_7623: bitstring = h((Ns_7618,Nc_7617)) in
                                                                    {8459}out(c, senc(mSrv(pkCli_7565,pkSess_7318),Ksrv_7623))
                                                        )
                                                        else
                                                            {8460}let pkDisco_7624: bitstring = fail-any in
                                                            {8461}in(c, (=pkCli_7565,em1_7625: bitstring));
                                                            {8462}let m1_7626: bitstring = em1_7625 in
                                                            {8463}let (=OpenSecureChannelRequest,=pkCli_7565,wNc_7627: bitstring) = m1_7626 in
                                                            {8464}let Nc_7628: bitstring = dec(wNc_7627,skSess_7317) in
                                                            {8465}new Ns_7629: bitstring;
                                                            {8466}new ST_7630: bitstring;
                                                            {8467}new TTL_7631: bitstring;
                                                            {8468}let wNs_7632: bitstring = enc(Ns_7629,pkCli_7565) in
                                                            {8469}let m2_7633: bitstring = (OpenSecureChannelResponse,wNs_7632,ST_7630,TTL_7631) in
                                                            {8470}out(c, m2_7633);
                                                            {8471}let Ksrv_7634: bitstring = h((Ns_7629,Nc_7628)) in
                                                            {8472}out(c, senc(mSrv(pkCli_7565,pkSess_7318),Ksrv_7634))
                                                )
                                                else
                                                    {8473}let pkDisco_7635: bitstring = fail-any in
                                                    {8474}in(c, (=pkCli_7565,em1_7636: bitstring));
                                                    {8475}let m1_7637: bitstring = em1_7636 in
                                                    {8476}let (=OpenSecureChannelRequest,=pkCli_7565,wNc_7638: bitstring) = m1_7637 in
                                                    {8477}let Nc_7639: bitstring = dec(wNc_7638,skSess_7317) in
                                                    {8478}new Ns_7640: bitstring;
                                                    {8479}new ST_7641: bitstring;
                                                    {8480}new TTL_7642: bitstring;
                                                    {8481}let wNs_7643: bitstring = enc(Ns_7640,pkCli_7565) in
                                                    {8482}let m2_7644: bitstring = (OpenSecureChannelResponse,wNs_7643,ST_7641,TTL_7642) in
                                                    {8483}out(c, m2_7644);
                                                    {8484}let Ksrv_7645: bitstring = h((Ns_7640,Nc_7639)) in
                                                    {8485}out(c, senc(mSrv(pkCli_7565,pkSess_7318),Ksrv_7645))
                                        )
                                        else
                                            {8486}let pkCli_7646: bitstring = fail-any in
                                            {8487}let v_7647: bool = (Disco_5600 = A) in
                                            (
                                                {8488}if v_7647 then
                                                (
                                                    {8489}let pkDisco_7648: bitstring = pub(skA) in
                                                    {8490}in(c, (=pkCli_7646,em1_7649: bitstring));
                                                    {8491}let m1_7650: bitstring = em1_7649 in
                                                    {8492}let (=OpenSecureChannelRequest,=pkCli_7646,wNc_7651: bitstring) = m1_7650 in
                                                    {8493}let Nc_7652: bitstring = dec(wNc_7651,skSess_7317) in
                                                    {8494}new Ns_7653: bitstring;
                                                    {8495}new ST_7654: bitstring;
                                                    {8496}new TTL_7655: bitstring;
                                                    {8497}let wNs_7656: bitstring = enc(Ns_7653,pkCli_7646) in
                                                    {8498}let m2_7657: bitstring = (OpenSecureChannelResponse,wNs_7656,ST_7654,TTL_7655) in
                                                    {8499}out(c, m2_7657);
                                                    {8500}let Ksrv_7658: bitstring = h((Ns_7653,Nc_7652)) in
                                                    {8501}out(c, senc(mSrv(pkCli_7646,pkSess_7318),Ksrv_7658))
                                                )
                                                else
                                                    {8502}let v_7659: bool = (Disco_5600 = B) in
                                                    (
                                                        {8503}if v_7659 then
                                                        (
                                                            {8504}let pkDisco_7660: bitstring = pub(skB) in
                                                            {8505}in(c, (=pkCli_7646,em1_7661: bitstring));
                                                            {8506}let m1_7662: bitstring = em1_7661 in
                                                            {8507}let (=OpenSecureChannelRequest,=pkCli_7646,wNc_7663: bitstring) = m1_7662 in
                                                            {8508}let Nc_7664: bitstring = dec(wNc_7663,skSess_7317) in
                                                            {8509}new Ns_7665: bitstring;
                                                            {8510}new ST_7666: bitstring;
                                                            {8511}new TTL_7667: bitstring;
                                                            {8512}let wNs_7668: bitstring = enc(Ns_7665,pkCli_7646) in
                                                            {8513}let m2_7669: bitstring = (OpenSecureChannelResponse,wNs_7668,ST_7666,TTL_7667) in
                                                            {8514}out(c, m2_7669);
                                                            {8515}let Ksrv_7670: bitstring = h((Ns_7665,Nc_7664)) in
                                                            {8516}out(c, senc(mSrv(pkCli_7646,pkSess_7318),Ksrv_7670))
                                                        )
                                                        else
                                                            {8517}let v_7671: bool = (Disco_5600 = C) in
                                                            (
                                                                {8518}if v_7671 then
                                                                (
                                                                    {8519}let pkDisco_7672: bitstring = pub(skC) in
                                                                    {8520}in(c, (=pkCli_7646,em1_7673: bitstring));
                                                                    {8521}let m1_7674: bitstring = em1_7673 in
                                                                    {8522}let (=OpenSecureChannelRequest,=pkCli_7646,wNc_7675: bitstring) = m1_7674 in
                                                                    {8523}let Nc_7676: bitstring = dec(wNc_7675,skSess_7317) in
                                                                    {8524}new Ns_7677: bitstring;
                                                                    {8525}new ST_7678: bitstring;
                                                                    {8526}new TTL_7679: bitstring;
                                                                    {8527}let wNs_7680: bitstring = enc(Ns_7677,pkCli_7646) in
                                                                    {8528}let m2_7681: bitstring = (OpenSecureChannelResponse,wNs_7680,ST_7678,TTL_7679) in
                                                                    {8529}out(c, m2_7681);
                                                                    {8530}let Ksrv_7682: bitstring = h((Ns_7677,Nc_7676)) in
                                                                    {8531}out(c, senc(mSrv(pkCli_7646,pkSess_7318),Ksrv_7682))
                                                                )
                                                                else
                                                                    {8532}let pkDisco_7683: bitstring = pub(sk(Disco_5600)) in
                                                                    {8533}in(c, (=pkCli_7646,em1_7684: bitstring));
                                                                    {8534}let m1_7685: bitstring = em1_7684 in
                                                                    {8535}let (=OpenSecureChannelRequest,=pkCli_7646,wNc_7686: bitstring) = m1_7685 in
                                                                    {8536}let Nc_7687: bitstring = dec(wNc_7686,skSess_7317) in
                                                                    {8537}new Ns_7688: bitstring;
                                                                    {8538}new ST_7689: bitstring;
                                                                    {8539}new TTL_7690: bitstring;
                                                                    {8540}let wNs_7691: bitstring = enc(Ns_7688,pkCli_7646) in
                                                                    {8541}let m2_7692: bitstring = (OpenSecureChannelResponse,wNs_7691,ST_7689,TTL_7690) in
                                                                    {8542}out(c, m2_7692);
                                                                    {8543}let Ksrv_7693: bitstring = h((Ns_7688,Nc_7687)) in
                                                                    {8544}out(c, senc(mSrv(pkCli_7646,pkSess_7318),Ksrv_7693))
                                                            )
                                                            else
                                                                {8545}let pkDisco_7694: bitstring = fail-any in
                                                                {8546}in(c, (=pkCli_7646,em1_7695: bitstring));
                                                                {8547}let m1_7696: bitstring = em1_7695 in
                                                                {8548}let (=OpenSecureChannelRequest,=pkCli_7646,wNc_7697: bitstring) = m1_7696 in
                                                                {8549}let Nc_7698: bitstring = dec(wNc_7697,skSess_7317) in
                                                                {8550}new Ns_7699: bitstring;
                                                                {8551}new ST_7700: bitstring;
                                                                {8552}new TTL_7701: bitstring;
                                                                {8553}let wNs_7702: bitstring = enc(Ns_7699,pkCli_7646) in
                                                                {8554}let m2_7703: bitstring = (OpenSecureChannelResponse,wNs_7702,ST_7700,TTL_7701) in
                                                                {8555}out(c, m2_7703);
                                                                {8556}let Ksrv_7704: bitstring = h((Ns_7699,Nc_7698)) in
                                                                {8557}out(c, senc(mSrv(pkCli_7646,pkSess_7318),Ksrv_7704))
                                                    )
                                                    else
                                                        {8558}let pkDisco_7705: bitstring = fail-any in
                                                        {8559}in(c, (=pkCli_7646,em1_7706: bitstring));
                                                        {8560}let m1_7707: bitstring = em1_7706 in
                                                        {8561}let (=OpenSecureChannelRequest,=pkCli_7646,wNc_7708: bitstring) = m1_7707 in
                                                        {8562}let Nc_7709: bitstring = dec(wNc_7708,skSess_7317) in
                                                        {8563}new Ns_7710: bitstring;
                                                        {8564}new ST_7711: bitstring;
                                                        {8565}new TTL_7712: bitstring;
                                                        {8566}let wNs_7713: bitstring = enc(Ns_7710,pkCli_7646) in
                                                        {8567}let m2_7714: bitstring = (OpenSecureChannelResponse,wNs_7713,ST_7711,TTL_7712) in
                                                        {8568}out(c, m2_7714);
                                                        {8569}let Ksrv_7715: bitstring = h((Ns_7710,Nc_7709)) in
                                                        {8570}out(c, senc(mSrv(pkCli_7646,pkSess_7318),Ksrv_7715))
                                            )
                                            else
                                                {8571}let pkDisco_7716: bitstring = fail-any in
                                                {8572}in(c, (=pkCli_7646,em1_7717: bitstring));
                                                {8573}let m1_7718: bitstring = em1_7717 in
                                                {8574}let (=OpenSecureChannelRequest,=pkCli_7646,wNc_7719: bitstring) = m1_7718 in
                                                {8575}let Nc_7720: bitstring = dec(wNc_7719,skSess_7317) in
                                                {8576}new Ns_7721: bitstring;
                                                {8577}new ST_7722: bitstring;
                                                {8578}new TTL_7723: bitstring;
                                                {8579}let wNs_7724: bitstring = enc(Ns_7721,pkCli_7646) in
                                                {8580}let m2_7725: bitstring = (OpenSecureChannelResponse,wNs_7724,ST_7722,TTL_7723) in
                                                {8581}out(c, m2_7725);
                                                {8582}let Ksrv_7726: bitstring = h((Ns_7721,Nc_7720)) in
                                                {8583}out(c, senc(mSrv(pkCli_7646,pkSess_7318),Ksrv_7726))
                                )
                                else
                                    {8584}let pkCli_7727: bitstring = fail-any in
                                    {8585}let v_7728: bool = (Disco_5600 = A) in
                                    (
                                        {8586}if v_7728 then
                                        (
                                            {8587}let pkDisco_7729: bitstring = pub(skA) in
                                            {8588}in(c, (=pkCli_7727,em1_7730: bitstring));
                                            {8589}let m1_7731: bitstring = em1_7730 in
                                            {8590}let (=OpenSecureChannelRequest,=pkCli_7727,wNc_7732: bitstring) = m1_7731 in
                                            {8591}let Nc_7733: bitstring = dec(wNc_7732,skSess_7317) in
                                            {8592}new Ns_7734: bitstring;
                                            {8593}new ST_7735: bitstring;
                                            {8594}new TTL_7736: bitstring;
                                            {8595}let wNs_7737: bitstring = enc(Ns_7734,pkCli_7727) in
                                            {8596}let m2_7738: bitstring = (OpenSecureChannelResponse,wNs_7737,ST_7735,TTL_7736) in
                                            {8597}out(c, m2_7738);
                                            {8598}let Ksrv_7739: bitstring = h((Ns_7734,Nc_7733)) in
                                            {8599}out(c, senc(mSrv(pkCli_7727,pkSess_7318),Ksrv_7739))
                                        )
                                        else
                                            {8600}let v_7740: bool = (Disco_5600 = B) in
                                            (
                                                {8601}if v_7740 then
                                                (
                                                    {8602}let pkDisco_7741: bitstring = pub(skB) in
                                                    {8603}in(c, (=pkCli_7727,em1_7742: bitstring));
                                                    {8604}let m1_7743: bitstring = em1_7742 in
                                                    {8605}let (=OpenSecureChannelRequest,=pkCli_7727,wNc_7744: bitstring) = m1_7743 in
                                                    {8606}let Nc_7745: bitstring = dec(wNc_7744,skSess_7317) in
                                                    {8607}new Ns_7746: bitstring;
                                                    {8608}new ST_7747: bitstring;
                                                    {8609}new TTL_7748: bitstring;
                                                    {8610}let wNs_7749: bitstring = enc(Ns_7746,pkCli_7727) in
                                                    {8611}let m2_7750: bitstring = (OpenSecureChannelResponse,wNs_7749,ST_7747,TTL_7748) in
                                                    {8612}out(c, m2_7750);
                                                    {8613}let Ksrv_7751: bitstring = h((Ns_7746,Nc_7745)) in
                                                    {8614}out(c, senc(mSrv(pkCli_7727,pkSess_7318),Ksrv_7751))
                                                )
                                                else
                                                    {8615}let v_7752: bool = (Disco_5600 = C) in
                                                    (
                                                        {8616}if v_7752 then
                                                        (
                                                            {8617}let pkDisco_7753: bitstring = pub(skC) in
                                                            {8618}in(c, (=pkCli_7727,em1_7754: bitstring));
                                                            {8619}let m1_7755: bitstring = em1_7754 in
                                                            {8620}let (=OpenSecureChannelRequest,=pkCli_7727,wNc_7756: bitstring) = m1_7755 in
                                                            {8621}let Nc_7757: bitstring = dec(wNc_7756,skSess_7317) in
                                                            {8622}new Ns_7758: bitstring;
                                                            {8623}new ST_7759: bitstring;
                                                            {8624}new TTL_7760: bitstring;
                                                            {8625}let wNs_7761: bitstring = enc(Ns_7758,pkCli_7727) in
                                                            {8626}let m2_7762: bitstring = (OpenSecureChannelResponse,wNs_7761,ST_7759,TTL_7760) in
                                                            {8627}out(c, m2_7762);
                                                            {8628}let Ksrv_7763: bitstring = h((Ns_7758,Nc_7757)) in
                                                            {8629}out(c, senc(mSrv(pkCli_7727,pkSess_7318),Ksrv_7763))
                                                        )
                                                        else
                                                            {8630}let pkDisco_7764: bitstring = pub(sk(Disco_5600)) in
                                                            {8631}in(c, (=pkCli_7727,em1_7765: bitstring));
                                                            {8632}let m1_7766: bitstring = em1_7765 in
                                                            {8633}let (=OpenSecureChannelRequest,=pkCli_7727,wNc_7767: bitstring) = m1_7766 in
                                                            {8634}let Nc_7768: bitstring = dec(wNc_7767,skSess_7317) in
                                                            {8635}new Ns_7769: bitstring;
                                                            {8636}new ST_7770: bitstring;
                                                            {8637}new TTL_7771: bitstring;
                                                            {8638}let wNs_7772: bitstring = enc(Ns_7769,pkCli_7727) in
                                                            {8639}let m2_7773: bitstring = (OpenSecureChannelResponse,wNs_7772,ST_7770,TTL_7771) in
                                                            {8640}out(c, m2_7773);
                                                            {8641}let Ksrv_7774: bitstring = h((Ns_7769,Nc_7768)) in
                                                            {8642}out(c, senc(mSrv(pkCli_7727,pkSess_7318),Ksrv_7774))
                                                    )
                                                    else
                                                        {8643}let pkDisco_7775: bitstring = fail-any in
                                                        {8644}in(c, (=pkCli_7727,em1_7776: bitstring));
                                                        {8645}let m1_7777: bitstring = em1_7776 in
                                                        {8646}let (=OpenSecureChannelRequest,=pkCli_7727,wNc_7778: bitstring) = m1_7777 in
                                                        {8647}let Nc_7779: bitstring = dec(wNc_7778,skSess_7317) in
                                                        {8648}new Ns_7780: bitstring;
                                                        {8649}new ST_7781: bitstring;
                                                        {8650}new TTL_7782: bitstring;
                                                        {8651}let wNs_7783: bitstring = enc(Ns_7780,pkCli_7727) in
                                                        {8652}let m2_7784: bitstring = (OpenSecureChannelResponse,wNs_7783,ST_7781,TTL_7782) in
                                                        {8653}out(c, m2_7784);
                                                        {8654}let Ksrv_7785: bitstring = h((Ns_7780,Nc_7779)) in
                                                        {8655}out(c, senc(mSrv(pkCli_7727,pkSess_7318),Ksrv_7785))
                                            )
                                            else
                                                {8656}let pkDisco_7786: bitstring = fail-any in
                                                {8657}in(c, (=pkCli_7727,em1_7787: bitstring));
                                                {8658}let m1_7788: bitstring = em1_7787 in
                                                {8659}let (=OpenSecureChannelRequest,=pkCli_7727,wNc_7789: bitstring) = m1_7788 in
                                                {8660}let Nc_7790: bitstring = dec(wNc_7789,skSess_7317) in
                                                {8661}new Ns_7791: bitstring;
                                                {8662}new ST_7792: bitstring;
                                                {8663}new TTL_7793: bitstring;
                                                {8664}let wNs_7794: bitstring = enc(Ns_7791,pkCli_7727) in
                                                {8665}let m2_7795: bitstring = (OpenSecureChannelResponse,wNs_7794,ST_7792,TTL_7793) in
                                                {8666}out(c, m2_7795);
                                                {8667}let Ksrv_7796: bitstring = h((Ns_7791,Nc_7790)) in
                                                {8668}out(c, senc(mSrv(pkCli_7727,pkSess_7318),Ksrv_7796))
                                    )
                                    else
                                        {8669}let pkDisco_7797: bitstring = fail-any in
                                        {8670}in(c, (=pkCli_7727,em1_7798: bitstring));
                                        {8671}let m1_7799: bitstring = em1_7798 in
                                        {8672}let (=OpenSecureChannelRequest,=pkCli_7727,wNc_7800: bitstring) = m1_7799 in
                                        {8673}let Nc_7801: bitstring = dec(wNc_7800,skSess_7317) in
                                        {8674}new Ns_7802: bitstring;
                                        {8675}new ST_7803: bitstring;
                                        {8676}new TTL_7804: bitstring;
                                        {8677}let wNs_7805: bitstring = enc(Ns_7802,pkCli_7727) in
                                        {8678}let m2_7806: bitstring = (OpenSecureChannelResponse,wNs_7805,ST_7803,TTL_7804) in
                                        {8679}out(c, m2_7806);
                                        {8680}let Ksrv_7807: bitstring = h((Ns_7802,Nc_7801)) in
                                        {8681}out(c, senc(mSrv(pkCli_7727,pkSess_7318),Ksrv_7807))
                        )
                        else
                            {8682}let pkCli_7808: bitstring = fail-any in
                            {8683}let v_7809: bool = (Disco_5600 = A) in
                            (
                                {8684}if v_7809 then
                                (
                                    {8685}let pkDisco_7810: bitstring = pub(skA) in
                                    {8686}in(c, (=pkCli_7808,em1_7811: bitstring));
                                    {8687}let m1_7812: bitstring = em1_7811 in
                                    {8688}let (=OpenSecureChannelRequest,=pkCli_7808,wNc_7813: bitstring) = m1_7812 in
                                    {8689}let Nc_7814: bitstring = dec(wNc_7813,skSess_7317) in
                                    {8690}new Ns_7815: bitstring;
                                    {8691}new ST_7816: bitstring;
                                    {8692}new TTL_7817: bitstring;
                                    {8693}let wNs_7818: bitstring = enc(Ns_7815,pkCli_7808) in
                                    {8694}let m2_7819: bitstring = (OpenSecureChannelResponse,wNs_7818,ST_7816,TTL_7817) in
                                    {8695}out(c, m2_7819);
                                    {8696}let Ksrv_7820: bitstring = h((Ns_7815,Nc_7814)) in
                                    {8697}out(c, senc(mSrv(pkCli_7808,pkSess_7318),Ksrv_7820))
                                )
                                else
                                    {8698}let v_7821: bool = (Disco_5600 = B) in
                                    (
                                        {8699}if v_7821 then
                                        (
                                            {8700}let pkDisco_7822: bitstring = pub(skB) in
                                            {8701}in(c, (=pkCli_7808,em1_7823: bitstring));
                                            {8702}let m1_7824: bitstring = em1_7823 in
                                            {8703}let (=OpenSecureChannelRequest,=pkCli_7808,wNc_7825: bitstring) = m1_7824 in
                                            {8704}let Nc_7826: bitstring = dec(wNc_7825,skSess_7317) in
                                            {8705}new Ns_7827: bitstring;
                                            {8706}new ST_7828: bitstring;
                                            {8707}new TTL_7829: bitstring;
                                            {8708}let wNs_7830: bitstring = enc(Ns_7827,pkCli_7808) in
                                            {8709}let m2_7831: bitstring = (OpenSecureChannelResponse,wNs_7830,ST_7828,TTL_7829) in
                                            {8710}out(c, m2_7831);
                                            {8711}let Ksrv_7832: bitstring = h((Ns_7827,Nc_7826)) in
                                            {8712}out(c, senc(mSrv(pkCli_7808,pkSess_7318),Ksrv_7832))
                                        )
                                        else
                                            {8713}let v_7833: bool = (Disco_5600 = C) in
                                            (
                                                {8714}if v_7833 then
                                                (
                                                    {8715}let pkDisco_7834: bitstring = pub(skC) in
                                                    {8716}in(c, (=pkCli_7808,em1_7835: bitstring));
                                                    {8717}let m1_7836: bitstring = em1_7835 in
                                                    {8718}let (=OpenSecureChannelRequest,=pkCli_7808,wNc_7837: bitstring) = m1_7836 in
                                                    {8719}let Nc_7838: bitstring = dec(wNc_7837,skSess_7317) in
                                                    {8720}new Ns_7839: bitstring;
                                                    {8721}new ST_7840: bitstring;
                                                    {8722}new TTL_7841: bitstring;
                                                    {8723}let wNs_7842: bitstring = enc(Ns_7839,pkCli_7808) in
                                                    {8724}let m2_7843: bitstring = (OpenSecureChannelResponse,wNs_7842,ST_7840,TTL_7841) in
                                                    {8725}out(c, m2_7843);
                                                    {8726}let Ksrv_7844: bitstring = h((Ns_7839,Nc_7838)) in
                                                    {8727}out(c, senc(mSrv(pkCli_7808,pkSess_7318),Ksrv_7844))
                                                )
                                                else
                                                    {8728}let pkDisco_7845: bitstring = pub(sk(Disco_5600)) in
                                                    {8729}in(c, (=pkCli_7808,em1_7846: bitstring));
                                                    {8730}let m1_7847: bitstring = em1_7846 in
                                                    {8731}let (=OpenSecureChannelRequest,=pkCli_7808,wNc_7848: bitstring) = m1_7847 in
                                                    {8732}let Nc_7849: bitstring = dec(wNc_7848,skSess_7317) in
                                                    {8733}new Ns_7850: bitstring;
                                                    {8734}new ST_7851: bitstring;
                                                    {8735}new TTL_7852: bitstring;
                                                    {8736}let wNs_7853: bitstring = enc(Ns_7850,pkCli_7808) in
                                                    {8737}let m2_7854: bitstring = (OpenSecureChannelResponse,wNs_7853,ST_7851,TTL_7852) in
                                                    {8738}out(c, m2_7854);
                                                    {8739}let Ksrv_7855: bitstring = h((Ns_7850,Nc_7849)) in
                                                    {8740}out(c, senc(mSrv(pkCli_7808,pkSess_7318),Ksrv_7855))
                                            )
                                            else
                                                {8741}let pkDisco_7856: bitstring = fail-any in
                                                {8742}in(c, (=pkCli_7808,em1_7857: bitstring));
                                                {8743}let m1_7858: bitstring = em1_7857 in
                                                {8744}let (=OpenSecureChannelRequest,=pkCli_7808,wNc_7859: bitstring) = m1_7858 in
                                                {8745}let Nc_7860: bitstring = dec(wNc_7859,skSess_7317) in
                                                {8746}new Ns_7861: bitstring;
                                                {8747}new ST_7862: bitstring;
                                                {8748}new TTL_7863: bitstring;
                                                {8749}let wNs_7864: bitstring = enc(Ns_7861,pkCli_7808) in
                                                {8750}let m2_7865: bitstring = (OpenSecureChannelResponse,wNs_7864,ST_7862,TTL_7863) in
                                                {8751}out(c, m2_7865);
                                                {8752}let Ksrv_7866: bitstring = h((Ns_7861,Nc_7860)) in
                                                {8753}out(c, senc(mSrv(pkCli_7808,pkSess_7318),Ksrv_7866))
                                    )
                                    else
                                        {8754}let pkDisco_7867: bitstring = fail-any in
                                        {8755}in(c, (=pkCli_7808,em1_7868: bitstring));
                                        {8756}let m1_7869: bitstring = em1_7868 in
                                        {8757}let (=OpenSecureChannelRequest,=pkCli_7808,wNc_7870: bitstring) = m1_7869 in
                                        {8758}let Nc_7871: bitstring = dec(wNc_7870,skSess_7317) in
                                        {8759}new Ns_7872: bitstring;
                                        {8760}new ST_7873: bitstring;
                                        {8761}new TTL_7874: bitstring;
                                        {8762}let wNs_7875: bitstring = enc(Ns_7872,pkCli_7808) in
                                        {8763}let m2_7876: bitstring = (OpenSecureChannelResponse,wNs_7875,ST_7873,TTL_7874) in
                                        {8764}out(c, m2_7876);
                                        {8765}let Ksrv_7877: bitstring = h((Ns_7872,Nc_7871)) in
                                        {8766}out(c, senc(mSrv(pkCli_7808,pkSess_7318),Ksrv_7877))
                            )
                            else
                                {8767}let pkDisco_7878: bitstring = fail-any in
                                {8768}in(c, (=pkCli_7808,em1_7879: bitstring));
                                {8769}let m1_7880: bitstring = em1_7879 in
                                {8770}let (=OpenSecureChannelRequest,=pkCli_7808,wNc_7881: bitstring) = m1_7880 in
                                {8771}let Nc_7882: bitstring = dec(wNc_7881,skSess_7317) in
                                {8772}new Ns_7883: bitstring;
                                {8773}new ST_7884: bitstring;
                                {8774}new TTL_7885: bitstring;
                                {8775}let wNs_7886: bitstring = enc(Ns_7883,pkCli_7808) in
                                {8776}let m2_7887: bitstring = (OpenSecureChannelResponse,wNs_7886,ST_7884,TTL_7885) in
                                {8777}out(c, m2_7887);
                                {8778}let Ksrv_7888: bitstring = h((Ns_7883,Nc_7882)) in
                                {8779}out(c, senc(mSrv(pkCli_7808,pkSess_7318),Ksrv_7888))
            )
            else
                {8780}let skSess_7889: bitstring = fail-any in
                {8781}let pkSess_7890: bitstring = pub(skSess_7889) in
                {8782}let v_7891: bool = (Cli_5599 = A) in
                (
                    {8783}if v_7891 then
                    (
                        {8784}let pkCli_7892: bitstring = pub(skA) in
                        {8785}let v_7893: bool = (Disco_5600 = A) in
                        (
                            {8786}if v_7893 then
                            (
                                {8787}let pkDisco_7894: bitstring = pub(skA) in
                                {8788}in(c, (=pkCli_7892,em1_7895: bitstring));
                                {8789}let m1_7896: bitstring = em1_7895 in
                                {8790}let (=OpenSecureChannelRequest,=pkCli_7892,wNc_7897: bitstring) = m1_7896 in
                                {8791}let Nc_7898: bitstring = dec(wNc_7897,skSess_7889) in
                                {8792}new Ns_7899: bitstring;
                                {8793}new ST_7900: bitstring;
                                {8794}new TTL_7901: bitstring;
                                {8795}let wNs_7902: bitstring = enc(Ns_7899,pkCli_7892) in
                                {8796}let m2_7903: bitstring = (OpenSecureChannelResponse,wNs_7902,ST_7900,TTL_7901) in
                                {8797}out(c, m2_7903);
                                {8798}let Ksrv_7904: bitstring = h((Ns_7899,Nc_7898)) in
                                {8799}out(c, senc(mSrv(pkCli_7892,pkSess_7890),Ksrv_7904))
                            )
                            else
                                {8800}let v_7905: bool = (Disco_5600 = B) in
                                (
                                    {8801}if v_7905 then
                                    (
                                        {8802}let pkDisco_7906: bitstring = pub(skB) in
                                        {8803}in(c, (=pkCli_7892,em1_7907: bitstring));
                                        {8804}let m1_7908: bitstring = em1_7907 in
                                        {8805}let (=OpenSecureChannelRequest,=pkCli_7892,wNc_7909: bitstring) = m1_7908 in
                                        {8806}let Nc_7910: bitstring = dec(wNc_7909,skSess_7889) in
                                        {8807}new Ns_7911: bitstring;
                                        {8808}new ST_7912: bitstring;
                                        {8809}new TTL_7913: bitstring;
                                        {8810}let wNs_7914: bitstring = enc(Ns_7911,pkCli_7892) in
                                        {8811}let m2_7915: bitstring = (OpenSecureChannelResponse,wNs_7914,ST_7912,TTL_7913) in
                                        {8812}out(c, m2_7915);
                                        {8813}let Ksrv_7916: bitstring = h((Ns_7911,Nc_7910)) in
                                        {8814}out(c, senc(mSrv(pkCli_7892,pkSess_7890),Ksrv_7916))
                                    )
                                    else
                                        {8815}let v_7917: bool = (Disco_5600 = C) in
                                        (
                                            {8816}if v_7917 then
                                            (
                                                {8817}let pkDisco_7918: bitstring = pub(skC) in
                                                {8818}in(c, (=pkCli_7892,em1_7919: bitstring));
                                                {8819}let m1_7920: bitstring = em1_7919 in
                                                {8820}let (=OpenSecureChannelRequest,=pkCli_7892,wNc_7921: bitstring) = m1_7920 in
                                                {8821}let Nc_7922: bitstring = dec(wNc_7921,skSess_7889) in
                                                {8822}new Ns_7923: bitstring;
                                                {8823}new ST_7924: bitstring;
                                                {8824}new TTL_7925: bitstring;
                                                {8825}let wNs_7926: bitstring = enc(Ns_7923,pkCli_7892) in
                                                {8826}let m2_7927: bitstring = (OpenSecureChannelResponse,wNs_7926,ST_7924,TTL_7925) in
                                                {8827}out(c, m2_7927);
                                                {8828}let Ksrv_7928: bitstring = h((Ns_7923,Nc_7922)) in
                                                {8829}out(c, senc(mSrv(pkCli_7892,pkSess_7890),Ksrv_7928))
                                            )
                                            else
                                                {8830}let pkDisco_7929: bitstring = pub(sk(Disco_5600)) in
                                                {8831}in(c, (=pkCli_7892,em1_7930: bitstring));
                                                {8832}let m1_7931: bitstring = em1_7930 in
                                                {8833}let (=OpenSecureChannelRequest,=pkCli_7892,wNc_7932: bitstring) = m1_7931 in
                                                {8834}let Nc_7933: bitstring = dec(wNc_7932,skSess_7889) in
                                                {8835}new Ns_7934: bitstring;
                                                {8836}new ST_7935: bitstring;
                                                {8837}new TTL_7936: bitstring;
                                                {8838}let wNs_7937: bitstring = enc(Ns_7934,pkCli_7892) in
                                                {8839}let m2_7938: bitstring = (OpenSecureChannelResponse,wNs_7937,ST_7935,TTL_7936) in
                                                {8840}out(c, m2_7938);
                                                {8841}let Ksrv_7939: bitstring = h((Ns_7934,Nc_7933)) in
                                                {8842}out(c, senc(mSrv(pkCli_7892,pkSess_7890),Ksrv_7939))
                                        )
                                        else
                                            {8843}let pkDisco_7940: bitstring = fail-any in
                                            {8844}in(c, (=pkCli_7892,em1_7941: bitstring));
                                            {8845}let m1_7942: bitstring = em1_7941 in
                                            {8846}let (=OpenSecureChannelRequest,=pkCli_7892,wNc_7943: bitstring) = m1_7942 in
                                            {8847}let Nc_7944: bitstring = dec(wNc_7943,skSess_7889) in
                                            {8848}new Ns_7945: bitstring;
                                            {8849}new ST_7946: bitstring;
                                            {8850}new TTL_7947: bitstring;
                                            {8851}let wNs_7948: bitstring = enc(Ns_7945,pkCli_7892) in
                                            {8852}let m2_7949: bitstring = (OpenSecureChannelResponse,wNs_7948,ST_7946,TTL_7947) in
                                            {8853}out(c, m2_7949);
                                            {8854}let Ksrv_7950: bitstring = h((Ns_7945,Nc_7944)) in
                                            {8855}out(c, senc(mSrv(pkCli_7892,pkSess_7890),Ksrv_7950))
                                )
                                else
                                    {8856}let pkDisco_7951: bitstring = fail-any in
                                    {8857}in(c, (=pkCli_7892,em1_7952: bitstring));
                                    {8858}let m1_7953: bitstring = em1_7952 in
                                    {8859}let (=OpenSecureChannelRequest,=pkCli_7892,wNc_7954: bitstring) = m1_7953 in
                                    {8860}let Nc_7955: bitstring = dec(wNc_7954,skSess_7889) in
                                    {8861}new Ns_7956: bitstring;
                                    {8862}new ST_7957: bitstring;
                                    {8863}new TTL_7958: bitstring;
                                    {8864}let wNs_7959: bitstring = enc(Ns_7956,pkCli_7892) in
                                    {8865}let m2_7960: bitstring = (OpenSecureChannelResponse,wNs_7959,ST_7957,TTL_7958) in
                                    {8866}out(c, m2_7960);
                                    {8867}let Ksrv_7961: bitstring = h((Ns_7956,Nc_7955)) in
                                    {8868}out(c, senc(mSrv(pkCli_7892,pkSess_7890),Ksrv_7961))
                        )
                        else
                            {8869}let pkDisco_7962: bitstring = fail-any in
                            {8870}in(c, (=pkCli_7892,em1_7963: bitstring));
                            {8871}let m1_7964: bitstring = em1_7963 in
                            {8872}let (=OpenSecureChannelRequest,=pkCli_7892,wNc_7965: bitstring) = m1_7964 in
                            {8873}let Nc_7966: bitstring = dec(wNc_7965,skSess_7889) in
                            {8874}new Ns_7967: bitstring;
                            {8875}new ST_7968: bitstring;
                            {8876}new TTL_7969: bitstring;
                            {8877}let wNs_7970: bitstring = enc(Ns_7967,pkCli_7892) in
                            {8878}let m2_7971: bitstring = (OpenSecureChannelResponse,wNs_7970,ST_7968,TTL_7969) in
                            {8879}out(c, m2_7971);
                            {8880}let Ksrv_7972: bitstring = h((Ns_7967,Nc_7966)) in
                            {8881}out(c, senc(mSrv(pkCli_7892,pkSess_7890),Ksrv_7972))
                    )
                    else
                        {8882}let v_7973: bool = (Cli_5599 = B) in
                        (
                            {8883}if v_7973 then
                            (
                                {8884}let pkCli_7974: bitstring = pub(skB) in
                                {8885}let v_7975: bool = (Disco_5600 = A) in
                                (
                                    {8886}if v_7975 then
                                    (
                                        {8887}let pkDisco_7976: bitstring = pub(skA) in
                                        {8888}in(c, (=pkCli_7974,em1_7977: bitstring));
                                        {8889}let m1_7978: bitstring = em1_7977 in
                                        {8890}let (=OpenSecureChannelRequest,=pkCli_7974,wNc_7979: bitstring) = m1_7978 in
                                        {8891}let Nc_7980: bitstring = dec(wNc_7979,skSess_7889) in
                                        {8892}new Ns_7981: bitstring;
                                        {8893}new ST_7982: bitstring;
                                        {8894}new TTL_7983: bitstring;
                                        {8895}let wNs_7984: bitstring = enc(Ns_7981,pkCli_7974) in
                                        {8896}let m2_7985: bitstring = (OpenSecureChannelResponse,wNs_7984,ST_7982,TTL_7983) in
                                        {8897}out(c, m2_7985);
                                        {8898}let Ksrv_7986: bitstring = h((Ns_7981,Nc_7980)) in
                                        {8899}out(c, senc(mSrv(pkCli_7974,pkSess_7890),Ksrv_7986))
                                    )
                                    else
                                        {8900}let v_7987: bool = (Disco_5600 = B) in
                                        (
                                            {8901}if v_7987 then
                                            (
                                                {8902}let pkDisco_7988: bitstring = pub(skB) in
                                                {8903}in(c, (=pkCli_7974,em1_7989: bitstring));
                                                {8904}let m1_7990: bitstring = em1_7989 in
                                                {8905}let (=OpenSecureChannelRequest,=pkCli_7974,wNc_7991: bitstring) = m1_7990 in
                                                {8906}let Nc_7992: bitstring = dec(wNc_7991,skSess_7889) in
                                                {8907}new Ns_7993: bitstring;
                                                {8908}new ST_7994: bitstring;
                                                {8909}new TTL_7995: bitstring;
                                                {8910}let wNs_7996: bitstring = enc(Ns_7993,pkCli_7974) in
                                                {8911}let m2_7997: bitstring = (OpenSecureChannelResponse,wNs_7996,ST_7994,TTL_7995) in
                                                {8912}out(c, m2_7997);
                                                {8913}let Ksrv_7998: bitstring = h((Ns_7993,Nc_7992)) in
                                                {8914}out(c, senc(mSrv(pkCli_7974,pkSess_7890),Ksrv_7998))
                                            )
                                            else
                                                {8915}let v_7999: bool = (Disco_5600 = C) in
                                                (
                                                    {8916}if v_7999 then
                                                    (
                                                        {8917}let pkDisco_8000: bitstring = pub(skC) in
                                                        {8918}in(c, (=pkCli_7974,em1_8001: bitstring));
                                                        {8919}let m1_8002: bitstring = em1_8001 in
                                                        {8920}let (=OpenSecureChannelRequest,=pkCli_7974,wNc_8003: bitstring) = m1_8002 in
                                                        {8921}let Nc_8004: bitstring = dec(wNc_8003,skSess_7889) in
                                                        {8922}new Ns_8005: bitstring;
                                                        {8923}new ST_8006: bitstring;
                                                        {8924}new TTL_8007: bitstring;
                                                        {8925}let wNs_8008: bitstring = enc(Ns_8005,pkCli_7974) in
                                                        {8926}let m2_8009: bitstring = (OpenSecureChannelResponse,wNs_8008,ST_8006,TTL_8007) in
                                                        {8927}out(c, m2_8009);
                                                        {8928}let Ksrv_8010: bitstring = h((Ns_8005,Nc_8004)) in
                                                        {8929}out(c, senc(mSrv(pkCli_7974,pkSess_7890),Ksrv_8010))
                                                    )
                                                    else
                                                        {8930}let pkDisco_8011: bitstring = pub(sk(Disco_5600)) in
                                                        {8931}in(c, (=pkCli_7974,em1_8012: bitstring));
                                                        {8932}let m1_8013: bitstring = em1_8012 in
                                                        {8933}let (=OpenSecureChannelRequest,=pkCli_7974,wNc_8014: bitstring) = m1_8013 in
                                                        {8934}let Nc_8015: bitstring = dec(wNc_8014,skSess_7889) in
                                                        {8935}new Ns_8016: bitstring;
                                                        {8936}new ST_8017: bitstring;
                                                        {8937}new TTL_8018: bitstring;
                                                        {8938}let wNs_8019: bitstring = enc(Ns_8016,pkCli_7974) in
                                                        {8939}let m2_8020: bitstring = (OpenSecureChannelResponse,wNs_8019,ST_8017,TTL_8018) in
                                                        {8940}out(c, m2_8020);
                                                        {8941}let Ksrv_8021: bitstring = h((Ns_8016,Nc_8015)) in
                                                        {8942}out(c, senc(mSrv(pkCli_7974,pkSess_7890),Ksrv_8021))
                                                )
                                                else
                                                    {8943}let pkDisco_8022: bitstring = fail-any in
                                                    {8944}in(c, (=pkCli_7974,em1_8023: bitstring));
                                                    {8945}let m1_8024: bitstring = em1_8023 in
                                                    {8946}let (=OpenSecureChannelRequest,=pkCli_7974,wNc_8025: bitstring) = m1_8024 in
                                                    {8947}let Nc_8026: bitstring = dec(wNc_8025,skSess_7889) in
                                                    {8948}new Ns_8027: bitstring;
                                                    {8949}new ST_8028: bitstring;
                                                    {8950}new TTL_8029: bitstring;
                                                    {8951}let wNs_8030: bitstring = enc(Ns_8027,pkCli_7974) in
                                                    {8952}let m2_8031: bitstring = (OpenSecureChannelResponse,wNs_8030,ST_8028,TTL_8029) in
                                                    {8953}out(c, m2_8031);
                                                    {8954}let Ksrv_8032: bitstring = h((Ns_8027,Nc_8026)) in
                                                    {8955}out(c, senc(mSrv(pkCli_7974,pkSess_7890),Ksrv_8032))
                                        )
                                        else
                                            {8956}let pkDisco_8033: bitstring = fail-any in
                                            {8957}in(c, (=pkCli_7974,em1_8034: bitstring));
                                            {8958}let m1_8035: bitstring = em1_8034 in
                                            {8959}let (=OpenSecureChannelRequest,=pkCli_7974,wNc_8036: bitstring) = m1_8035 in
                                            {8960}let Nc_8037: bitstring = dec(wNc_8036,skSess_7889) in
                                            {8961}new Ns_8038: bitstring;
                                            {8962}new ST_8039: bitstring;
                                            {8963}new TTL_8040: bitstring;
                                            {8964}let wNs_8041: bitstring = enc(Ns_8038,pkCli_7974) in
                                            {8965}let m2_8042: bitstring = (OpenSecureChannelResponse,wNs_8041,ST_8039,TTL_8040) in
                                            {8966}out(c, m2_8042);
                                            {8967}let Ksrv_8043: bitstring = h((Ns_8038,Nc_8037)) in
                                            {8968}out(c, senc(mSrv(pkCli_7974,pkSess_7890),Ksrv_8043))
                                )
                                else
                                    {8969}let pkDisco_8044: bitstring = fail-any in
                                    {8970}in(c, (=pkCli_7974,em1_8045: bitstring));
                                    {8971}let m1_8046: bitstring = em1_8045 in
                                    {8972}let (=OpenSecureChannelRequest,=pkCli_7974,wNc_8047: bitstring) = m1_8046 in
                                    {8973}let Nc_8048: bitstring = dec(wNc_8047,skSess_7889) in
                                    {8974}new Ns_8049: bitstring;
                                    {8975}new ST_8050: bitstring;
                                    {8976}new TTL_8051: bitstring;
                                    {8977}let wNs_8052: bitstring = enc(Ns_8049,pkCli_7974) in
                                    {8978}let m2_8053: bitstring = (OpenSecureChannelResponse,wNs_8052,ST_8050,TTL_8051) in
                                    {8979}out(c, m2_8053);
                                    {8980}let Ksrv_8054: bitstring = h((Ns_8049,Nc_8048)) in
                                    {8981}out(c, senc(mSrv(pkCli_7974,pkSess_7890),Ksrv_8054))
                            )
                            else
                                {8982}let v_8055: bool = (Cli_5599 = C) in
                                (
                                    {8983}if v_8055 then
                                    (
                                        {8984}let pkCli_8056: bitstring = pub(skC) in
                                        {8985}let v_8057: bool = (Disco_5600 = A) in
                                        (
                                            {8986}if v_8057 then
                                            (
                                                {8987}let pkDisco_8058: bitstring = pub(skA) in
                                                {8988}in(c, (=pkCli_8056,em1_8059: bitstring));
                                                {8989}let m1_8060: bitstring = em1_8059 in
                                                {8990}let (=OpenSecureChannelRequest,=pkCli_8056,wNc_8061: bitstring) = m1_8060 in
                                                {8991}let Nc_8062: bitstring = dec(wNc_8061,skSess_7889) in
                                                {8992}new Ns_8063: bitstring;
                                                {8993}new ST_8064: bitstring;
                                                {8994}new TTL_8065: bitstring;
                                                {8995}let wNs_8066: bitstring = enc(Ns_8063,pkCli_8056) in
                                                {8996}let m2_8067: bitstring = (OpenSecureChannelResponse,wNs_8066,ST_8064,TTL_8065) in
                                                {8997}out(c, m2_8067);
                                                {8998}let Ksrv_8068: bitstring = h((Ns_8063,Nc_8062)) in
                                                {8999}out(c, senc(mSrv(pkCli_8056,pkSess_7890),Ksrv_8068))
                                            )
                                            else
                                                {9000}let v_8069: bool = (Disco_5600 = B) in
                                                (
                                                    {9001}if v_8069 then
                                                    (
                                                        {9002}let pkDisco_8070: bitstring = pub(skB) in
                                                        {9003}in(c, (=pkCli_8056,em1_8071: bitstring));
                                                        {9004}let m1_8072: bitstring = em1_8071 in
                                                        {9005}let (=OpenSecureChannelRequest,=pkCli_8056,wNc_8073: bitstring) = m1_8072 in
                                                        {9006}let Nc_8074: bitstring = dec(wNc_8073,skSess_7889) in
                                                        {9007}new Ns_8075: bitstring;
                                                        {9008}new ST_8076: bitstring;
                                                        {9009}new TTL_8077: bitstring;
                                                        {9010}let wNs_8078: bitstring = enc(Ns_8075,pkCli_8056) in
                                                        {9011}let m2_8079: bitstring = (OpenSecureChannelResponse,wNs_8078,ST_8076,TTL_8077) in
                                                        {9012}out(c, m2_8079);
                                                        {9013}let Ksrv_8080: bitstring = h((Ns_8075,Nc_8074)) in
                                                        {9014}out(c, senc(mSrv(pkCli_8056,pkSess_7890),Ksrv_8080))
                                                    )
                                                    else
                                                        {9015}let v_8081: bool = (Disco_5600 = C) in
                                                        (
                                                            {9016}if v_8081 then
                                                            (
                                                                {9017}let pkDisco_8082: bitstring = pub(skC) in
                                                                {9018}in(c, (=pkCli_8056,em1_8083: bitstring));
                                                                {9019}let m1_8084: bitstring = em1_8083 in
                                                                {9020}let (=OpenSecureChannelRequest,=pkCli_8056,wNc_8085: bitstring) = m1_8084 in
                                                                {9021}let Nc_8086: bitstring = dec(wNc_8085,skSess_7889) in
                                                                {9022}new Ns_8087: bitstring;
                                                                {9023}new ST_8088: bitstring;
                                                                {9024}new TTL_8089: bitstring;
                                                                {9025}let wNs_8090: bitstring = enc(Ns_8087,pkCli_8056) in
                                                                {9026}let m2_8091: bitstring = (OpenSecureChannelResponse,wNs_8090,ST_8088,TTL_8089) in
                                                                {9027}out(c, m2_8091);
                                                                {9028}let Ksrv_8092: bitstring = h((Ns_8087,Nc_8086)) in
                                                                {9029}out(c, senc(mSrv(pkCli_8056,pkSess_7890),Ksrv_8092))
                                                            )
                                                            else
                                                                {9030}let pkDisco_8093: bitstring = pub(sk(Disco_5600)) in
                                                                {9031}in(c, (=pkCli_8056,em1_8094: bitstring));
                                                                {9032}let m1_8095: bitstring = em1_8094 in
                                                                {9033}let (=OpenSecureChannelRequest,=pkCli_8056,wNc_8096: bitstring) = m1_8095 in
                                                                {9034}let Nc_8097: bitstring = dec(wNc_8096,skSess_7889) in
                                                                {9035}new Ns_8098: bitstring;
                                                                {9036}new ST_8099: bitstring;
                                                                {9037}new TTL_8100: bitstring;
                                                                {9038}let wNs_8101: bitstring = enc(Ns_8098,pkCli_8056) in
                                                                {9039}let m2_8102: bitstring = (OpenSecureChannelResponse,wNs_8101,ST_8099,TTL_8100) in
                                                                {9040}out(c, m2_8102);
                                                                {9041}let Ksrv_8103: bitstring = h((Ns_8098,Nc_8097)) in
                                                                {9042}out(c, senc(mSrv(pkCli_8056,pkSess_7890),Ksrv_8103))
                                                        )
                                                        else
                                                            {9043}let pkDisco_8104: bitstring = fail-any in
                                                            {9044}in(c, (=pkCli_8056,em1_8105: bitstring));
                                                            {9045}let m1_8106: bitstring = em1_8105 in
                                                            {9046}let (=OpenSecureChannelRequest,=pkCli_8056,wNc_8107: bitstring) = m1_8106 in
                                                            {9047}let Nc_8108: bitstring = dec(wNc_8107,skSess_7889) in
                                                            {9048}new Ns_8109: bitstring;
                                                            {9049}new ST_8110: bitstring;
                                                            {9050}new TTL_8111: bitstring;
                                                            {9051}let wNs_8112: bitstring = enc(Ns_8109,pkCli_8056) in
                                                            {9052}let m2_8113: bitstring = (OpenSecureChannelResponse,wNs_8112,ST_8110,TTL_8111) in
                                                            {9053}out(c, m2_8113);
                                                            {9054}let Ksrv_8114: bitstring = h((Ns_8109,Nc_8108)) in
                                                            {9055}out(c, senc(mSrv(pkCli_8056,pkSess_7890),Ksrv_8114))
                                                )
                                                else
                                                    {9056}let pkDisco_8115: bitstring = fail-any in
                                                    {9057}in(c, (=pkCli_8056,em1_8116: bitstring));
                                                    {9058}let m1_8117: bitstring = em1_8116 in
                                                    {9059}let (=OpenSecureChannelRequest,=pkCli_8056,wNc_8118: bitstring) = m1_8117 in
                                                    {9060}let Nc_8119: bitstring = dec(wNc_8118,skSess_7889) in
                                                    {9061}new Ns_8120: bitstring;
                                                    {9062}new ST_8121: bitstring;
                                                    {9063}new TTL_8122: bitstring;
                                                    {9064}let wNs_8123: bitstring = enc(Ns_8120,pkCli_8056) in
                                                    {9065}let m2_8124: bitstring = (OpenSecureChannelResponse,wNs_8123,ST_8121,TTL_8122) in
                                                    {9066}out(c, m2_8124);
                                                    {9067}let Ksrv_8125: bitstring = h((Ns_8120,Nc_8119)) in
                                                    {9068}out(c, senc(mSrv(pkCli_8056,pkSess_7890),Ksrv_8125))
                                        )
                                        else
                                            {9069}let pkDisco_8126: bitstring = fail-any in
                                            {9070}in(c, (=pkCli_8056,em1_8127: bitstring));
                                            {9071}let m1_8128: bitstring = em1_8127 in
                                            {9072}let (=OpenSecureChannelRequest,=pkCli_8056,wNc_8129: bitstring) = m1_8128 in
                                            {9073}let Nc_8130: bitstring = dec(wNc_8129,skSess_7889) in
                                            {9074}new Ns_8131: bitstring;
                                            {9075}new ST_8132: bitstring;
                                            {9076}new TTL_8133: bitstring;
                                            {9077}let wNs_8134: bitstring = enc(Ns_8131,pkCli_8056) in
                                            {9078}let m2_8135: bitstring = (OpenSecureChannelResponse,wNs_8134,ST_8132,TTL_8133) in
                                            {9079}out(c, m2_8135);
                                            {9080}let Ksrv_8136: bitstring = h((Ns_8131,Nc_8130)) in
                                            {9081}out(c, senc(mSrv(pkCli_8056,pkSess_7890),Ksrv_8136))
                                    )
                                    else
                                        {9082}let pkCli_8137: bitstring = pub(sk(Cli_5599)) in
                                        {9083}let v_8138: bool = (Disco_5600 = A) in
                                        (
                                            {9084}if v_8138 then
                                            (
                                                {9085}let pkDisco_8139: bitstring = pub(skA) in
                                                {9086}in(c, (=pkCli_8137,em1_8140: bitstring));
                                                {9087}let m1_8141: bitstring = em1_8140 in
                                                {9088}let (=OpenSecureChannelRequest,=pkCli_8137,wNc_8142: bitstring) = m1_8141 in
                                                {9089}let Nc_8143: bitstring = dec(wNc_8142,skSess_7889) in
                                                {9090}new Ns_8144: bitstring;
                                                {9091}new ST_8145: bitstring;
                                                {9092}new TTL_8146: bitstring;
                                                {9093}let wNs_8147: bitstring = enc(Ns_8144,pkCli_8137) in
                                                {9094}let m2_8148: bitstring = (OpenSecureChannelResponse,wNs_8147,ST_8145,TTL_8146) in
                                                {9095}out(c, m2_8148);
                                                {9096}let Ksrv_8149: bitstring = h((Ns_8144,Nc_8143)) in
                                                {9097}out(c, senc(mSrv(pkCli_8137,pkSess_7890),Ksrv_8149))
                                            )
                                            else
                                                {9098}let v_8150: bool = (Disco_5600 = B) in
                                                (
                                                    {9099}if v_8150 then
                                                    (
                                                        {9100}let pkDisco_8151: bitstring = pub(skB) in
                                                        {9101}in(c, (=pkCli_8137,em1_8152: bitstring));
                                                        {9102}let m1_8153: bitstring = em1_8152 in
                                                        {9103}let (=OpenSecureChannelRequest,=pkCli_8137,wNc_8154: bitstring) = m1_8153 in
                                                        {9104}let Nc_8155: bitstring = dec(wNc_8154,skSess_7889) in
                                                        {9105}new Ns_8156: bitstring;
                                                        {9106}new ST_8157: bitstring;
                                                        {9107}new TTL_8158: bitstring;
                                                        {9108}let wNs_8159: bitstring = enc(Ns_8156,pkCli_8137) in
                                                        {9109}let m2_8160: bitstring = (OpenSecureChannelResponse,wNs_8159,ST_8157,TTL_8158) in
                                                        {9110}out(c, m2_8160);
                                                        {9111}let Ksrv_8161: bitstring = h((Ns_8156,Nc_8155)) in
                                                        {9112}out(c, senc(mSrv(pkCli_8137,pkSess_7890),Ksrv_8161))
                                                    )
                                                    else
                                                        {9113}let v_8162: bool = (Disco_5600 = C) in
                                                        (
                                                            {9114}if v_8162 then
                                                            (
                                                                {9115}let pkDisco_8163: bitstring = pub(skC) in
                                                                {9116}in(c, (=pkCli_8137,em1_8164: bitstring));
                                                                {9117}let m1_8165: bitstring = em1_8164 in
                                                                {9118}let (=OpenSecureChannelRequest,=pkCli_8137,wNc_8166: bitstring) = m1_8165 in
                                                                {9119}let Nc_8167: bitstring = dec(wNc_8166,skSess_7889) in
                                                                {9120}new Ns_8168: bitstring;
                                                                {9121}new ST_8169: bitstring;
                                                                {9122}new TTL_8170: bitstring;
                                                                {9123}let wNs_8171: bitstring = enc(Ns_8168,pkCli_8137) in
                                                                {9124}let m2_8172: bitstring = (OpenSecureChannelResponse,wNs_8171,ST_8169,TTL_8170) in
                                                                {9125}out(c, m2_8172);
                                                                {9126}let Ksrv_8173: bitstring = h((Ns_8168,Nc_8167)) in
                                                                {9127}out(c, senc(mSrv(pkCli_8137,pkSess_7890),Ksrv_8173))
                                                            )
                                                            else
                                                                {9128}let pkDisco_8174: bitstring = pub(sk(Disco_5600)) in
                                                                {9129}in(c, (=pkCli_8137,em1_8175: bitstring));
                                                                {9130}let m1_8176: bitstring = em1_8175 in
                                                                {9131}let (=OpenSecureChannelRequest,=pkCli_8137,wNc_8177: bitstring) = m1_8176 in
                                                                {9132}let Nc_8178: bitstring = dec(wNc_8177,skSess_7889) in
                                                                {9133}new Ns_8179: bitstring;
                                                                {9134}new ST_8180: bitstring;
                                                                {9135}new TTL_8181: bitstring;
                                                                {9136}let wNs_8182: bitstring = enc(Ns_8179,pkCli_8137) in
                                                                {9137}let m2_8183: bitstring = (OpenSecureChannelResponse,wNs_8182,ST_8180,TTL_8181) in
                                                                {9138}out(c, m2_8183);
                                                                {9139}let Ksrv_8184: bitstring = h((Ns_8179,Nc_8178)) in
                                                                {9140}out(c, senc(mSrv(pkCli_8137,pkSess_7890),Ksrv_8184))
                                                        )
                                                        else
                                                            {9141}let pkDisco_8185: bitstring = fail-any in
                                                            {9142}in(c, (=pkCli_8137,em1_8186: bitstring));
                                                            {9143}let m1_8187: bitstring = em1_8186 in
                                                            {9144}let (=OpenSecureChannelRequest,=pkCli_8137,wNc_8188: bitstring) = m1_8187 in
                                                            {9145}let Nc_8189: bitstring = dec(wNc_8188,skSess_7889) in
                                                            {9146}new Ns_8190: bitstring;
                                                            {9147}new ST_8191: bitstring;
                                                            {9148}new TTL_8192: bitstring;
                                                            {9149}let wNs_8193: bitstring = enc(Ns_8190,pkCli_8137) in
                                                            {9150}let m2_8194: bitstring = (OpenSecureChannelResponse,wNs_8193,ST_8191,TTL_8192) in
                                                            {9151}out(c, m2_8194);
                                                            {9152}let Ksrv_8195: bitstring = h((Ns_8190,Nc_8189)) in
                                                            {9153}out(c, senc(mSrv(pkCli_8137,pkSess_7890),Ksrv_8195))
                                                )
                                                else
                                                    {9154}let pkDisco_8196: bitstring = fail-any in
                                                    {9155}in(c, (=pkCli_8137,em1_8197: bitstring));
                                                    {9156}let m1_8198: bitstring = em1_8197 in
                                                    {9157}let (=OpenSecureChannelRequest,=pkCli_8137,wNc_8199: bitstring) = m1_8198 in
                                                    {9158}let Nc_8200: bitstring = dec(wNc_8199,skSess_7889) in
                                                    {9159}new Ns_8201: bitstring;
                                                    {9160}new ST_8202: bitstring;
                                                    {9161}new TTL_8203: bitstring;
                                                    {9162}let wNs_8204: bitstring = enc(Ns_8201,pkCli_8137) in
                                                    {9163}let m2_8205: bitstring = (OpenSecureChannelResponse,wNs_8204,ST_8202,TTL_8203) in
                                                    {9164}out(c, m2_8205);
                                                    {9165}let Ksrv_8206: bitstring = h((Ns_8201,Nc_8200)) in
                                                    {9166}out(c, senc(mSrv(pkCli_8137,pkSess_7890),Ksrv_8206))
                                        )
                                        else
                                            {9167}let pkDisco_8207: bitstring = fail-any in
                                            {9168}in(c, (=pkCli_8137,em1_8208: bitstring));
                                            {9169}let m1_8209: bitstring = em1_8208 in
                                            {9170}let (=OpenSecureChannelRequest,=pkCli_8137,wNc_8210: bitstring) = m1_8209 in
                                            {9171}let Nc_8211: bitstring = dec(wNc_8210,skSess_7889) in
                                            {9172}new Ns_8212: bitstring;
                                            {9173}new ST_8213: bitstring;
                                            {9174}new TTL_8214: bitstring;
                                            {9175}let wNs_8215: bitstring = enc(Ns_8212,pkCli_8137) in
                                            {9176}let m2_8216: bitstring = (OpenSecureChannelResponse,wNs_8215,ST_8213,TTL_8214) in
                                            {9177}out(c, m2_8216);
                                            {9178}let Ksrv_8217: bitstring = h((Ns_8212,Nc_8211)) in
                                            {9179}out(c, senc(mSrv(pkCli_8137,pkSess_7890),Ksrv_8217))
                                )
                                else
                                    {9180}let pkCli_8218: bitstring = fail-any in
                                    {9181}let v_8219: bool = (Disco_5600 = A) in
                                    (
                                        {9182}if v_8219 then
                                        (
                                            {9183}let pkDisco_8220: bitstring = pub(skA) in
                                            {9184}in(c, (=pkCli_8218,em1_8221: bitstring));
                                            {9185}let m1_8222: bitstring = em1_8221 in
                                            {9186}let (=OpenSecureChannelRequest,=pkCli_8218,wNc_8223: bitstring) = m1_8222 in
                                            {9187}let Nc_8224: bitstring = dec(wNc_8223,skSess_7889) in
                                            {9188}new Ns_8225: bitstring;
                                            {9189}new ST_8226: bitstring;
                                            {9190}new TTL_8227: bitstring;
                                            {9191}let wNs_8228: bitstring = enc(Ns_8225,pkCli_8218) in
                                            {9192}let m2_8229: bitstring = (OpenSecureChannelResponse,wNs_8228,ST_8226,TTL_8227) in
                                            {9193}out(c, m2_8229);
                                            {9194}let Ksrv_8230: bitstring = h((Ns_8225,Nc_8224)) in
                                            {9195}out(c, senc(mSrv(pkCli_8218,pkSess_7890),Ksrv_8230))
                                        )
                                        else
                                            {9196}let v_8231: bool = (Disco_5600 = B) in
                                            (
                                                {9197}if v_8231 then
                                                (
                                                    {9198}let pkDisco_8232: bitstring = pub(skB) in
                                                    {9199}in(c, (=pkCli_8218,em1_8233: bitstring));
                                                    {9200}let m1_8234: bitstring = em1_8233 in
                                                    {9201}let (=OpenSecureChannelRequest,=pkCli_8218,wNc_8235: bitstring) = m1_8234 in
                                                    {9202}let Nc_8236: bitstring = dec(wNc_8235,skSess_7889) in
                                                    {9203}new Ns_8237: bitstring;
                                                    {9204}new ST_8238: bitstring;
                                                    {9205}new TTL_8239: bitstring;
                                                    {9206}let wNs_8240: bitstring = enc(Ns_8237,pkCli_8218) in
                                                    {9207}let m2_8241: bitstring = (OpenSecureChannelResponse,wNs_8240,ST_8238,TTL_8239) in
                                                    {9208}out(c, m2_8241);
                                                    {9209}let Ksrv_8242: bitstring = h((Ns_8237,Nc_8236)) in
                                                    {9210}out(c, senc(mSrv(pkCli_8218,pkSess_7890),Ksrv_8242))
                                                )
                                                else
                                                    {9211}let v_8243: bool = (Disco_5600 = C) in
                                                    (
                                                        {9212}if v_8243 then
                                                        (
                                                            {9213}let pkDisco_8244: bitstring = pub(skC) in
                                                            {9214}in(c, (=pkCli_8218,em1_8245: bitstring));
                                                            {9215}let m1_8246: bitstring = em1_8245 in
                                                            {9216}let (=OpenSecureChannelRequest,=pkCli_8218,wNc_8247: bitstring) = m1_8246 in
                                                            {9217}let Nc_8248: bitstring = dec(wNc_8247,skSess_7889) in
                                                            {9218}new Ns_8249: bitstring;
                                                            {9219}new ST_8250: bitstring;
                                                            {9220}new TTL_8251: bitstring;
                                                            {9221}let wNs_8252: bitstring = enc(Ns_8249,pkCli_8218) in
                                                            {9222}let m2_8253: bitstring = (OpenSecureChannelResponse,wNs_8252,ST_8250,TTL_8251) in
                                                            {9223}out(c, m2_8253);
                                                            {9224}let Ksrv_8254: bitstring = h((Ns_8249,Nc_8248)) in
                                                            {9225}out(c, senc(mSrv(pkCli_8218,pkSess_7890),Ksrv_8254))
                                                        )
                                                        else
                                                            {9226}let pkDisco_8255: bitstring = pub(sk(Disco_5600)) in
                                                            {9227}in(c, (=pkCli_8218,em1_8256: bitstring));
                                                            {9228}let m1_8257: bitstring = em1_8256 in
                                                            {9229}let (=OpenSecureChannelRequest,=pkCli_8218,wNc_8258: bitstring) = m1_8257 in
                                                            {9230}let Nc_8259: bitstring = dec(wNc_8258,skSess_7889) in
                                                            {9231}new Ns_8260: bitstring;
                                                            {9232}new ST_8261: bitstring;
                                                            {9233}new TTL_8262: bitstring;
                                                            {9234}let wNs_8263: bitstring = enc(Ns_8260,pkCli_8218) in
                                                            {9235}let m2_8264: bitstring = (OpenSecureChannelResponse,wNs_8263,ST_8261,TTL_8262) in
                                                            {9236}out(c, m2_8264);
                                                            {9237}let Ksrv_8265: bitstring = h((Ns_8260,Nc_8259)) in
                                                            {9238}out(c, senc(mSrv(pkCli_8218,pkSess_7890),Ksrv_8265))
                                                    )
                                                    else
                                                        {9239}let pkDisco_8266: bitstring = fail-any in
                                                        {9240}in(c, (=pkCli_8218,em1_8267: bitstring));
                                                        {9241}let m1_8268: bitstring = em1_8267 in
                                                        {9242}let (=OpenSecureChannelRequest,=pkCli_8218,wNc_8269: bitstring) = m1_8268 in
                                                        {9243}let Nc_8270: bitstring = dec(wNc_8269,skSess_7889) in
                                                        {9244}new Ns_8271: bitstring;
                                                        {9245}new ST_8272: bitstring;
                                                        {9246}new TTL_8273: bitstring;
                                                        {9247}let wNs_8274: bitstring = enc(Ns_8271,pkCli_8218) in
                                                        {9248}let m2_8275: bitstring = (OpenSecureChannelResponse,wNs_8274,ST_8272,TTL_8273) in
                                                        {9249}out(c, m2_8275);
                                                        {9250}let Ksrv_8276: bitstring = h((Ns_8271,Nc_8270)) in
                                                        {9251}out(c, senc(mSrv(pkCli_8218,pkSess_7890),Ksrv_8276))
                                            )
                                            else
                                                {9252}let pkDisco_8277: bitstring = fail-any in
                                                {9253}in(c, (=pkCli_8218,em1_8278: bitstring));
                                                {9254}let m1_8279: bitstring = em1_8278 in
                                                {9255}let (=OpenSecureChannelRequest,=pkCli_8218,wNc_8280: bitstring) = m1_8279 in
                                                {9256}let Nc_8281: bitstring = dec(wNc_8280,skSess_7889) in
                                                {9257}new Ns_8282: bitstring;
                                                {9258}new ST_8283: bitstring;
                                                {9259}new TTL_8284: bitstring;
                                                {9260}let wNs_8285: bitstring = enc(Ns_8282,pkCli_8218) in
                                                {9261}let m2_8286: bitstring = (OpenSecureChannelResponse,wNs_8285,ST_8283,TTL_8284) in
                                                {9262}out(c, m2_8286);
                                                {9263}let Ksrv_8287: bitstring = h((Ns_8282,Nc_8281)) in
                                                {9264}out(c, senc(mSrv(pkCli_8218,pkSess_7890),Ksrv_8287))
                                    )
                                    else
                                        {9265}let pkDisco_8288: bitstring = fail-any in
                                        {9266}in(c, (=pkCli_8218,em1_8289: bitstring));
                                        {9267}let m1_8290: bitstring = em1_8289 in
                                        {9268}let (=OpenSecureChannelRequest,=pkCli_8218,wNc_8291: bitstring) = m1_8290 in
                                        {9269}let Nc_8292: bitstring = dec(wNc_8291,skSess_7889) in
                                        {9270}new Ns_8293: bitstring;
                                        {9271}new ST_8294: bitstring;
                                        {9272}new TTL_8295: bitstring;
                                        {9273}let wNs_8296: bitstring = enc(Ns_8293,pkCli_8218) in
                                        {9274}let m2_8297: bitstring = (OpenSecureChannelResponse,wNs_8296,ST_8294,TTL_8295) in
                                        {9275}out(c, m2_8297);
                                        {9276}let Ksrv_8298: bitstring = h((Ns_8293,Nc_8292)) in
                                        {9277}out(c, senc(mSrv(pkCli_8218,pkSess_7890),Ksrv_8298))
                        )
                        else
                            {9278}let pkCli_8299: bitstring = fail-any in
                            {9279}let v_8300: bool = (Disco_5600 = A) in
                            (
                                {9280}if v_8300 then
                                (
                                    {9281}let pkDisco_8301: bitstring = pub(skA) in
                                    {9282}in(c, (=pkCli_8299,em1_8302: bitstring));
                                    {9283}let m1_8303: bitstring = em1_8302 in
                                    {9284}let (=OpenSecureChannelRequest,=pkCli_8299,wNc_8304: bitstring) = m1_8303 in
                                    {9285}let Nc_8305: bitstring = dec(wNc_8304,skSess_7889) in
                                    {9286}new Ns_8306: bitstring;
                                    {9287}new ST_8307: bitstring;
                                    {9288}new TTL_8308: bitstring;
                                    {9289}let wNs_8309: bitstring = enc(Ns_8306,pkCli_8299) in
                                    {9290}let m2_8310: bitstring = (OpenSecureChannelResponse,wNs_8309,ST_8307,TTL_8308) in
                                    {9291}out(c, m2_8310);
                                    {9292}let Ksrv_8311: bitstring = h((Ns_8306,Nc_8305)) in
                                    {9293}out(c, senc(mSrv(pkCli_8299,pkSess_7890),Ksrv_8311))
                                )
                                else
                                    {9294}let v_8312: bool = (Disco_5600 = B) in
                                    (
                                        {9295}if v_8312 then
                                        (
                                            {9296}let pkDisco_8313: bitstring = pub(skB) in
                                            {9297}in(c, (=pkCli_8299,em1_8314: bitstring));
                                            {9298}let m1_8315: bitstring = em1_8314 in
                                            {9299}let (=OpenSecureChannelRequest,=pkCli_8299,wNc_8316: bitstring) = m1_8315 in
                                            {9300}let Nc_8317: bitstring = dec(wNc_8316,skSess_7889) in
                                            {9301}new Ns_8318: bitstring;
                                            {9302}new ST_8319: bitstring;
                                            {9303}new TTL_8320: bitstring;
                                            {9304}let wNs_8321: bitstring = enc(Ns_8318,pkCli_8299) in
                                            {9305}let m2_8322: bitstring = (OpenSecureChannelResponse,wNs_8321,ST_8319,TTL_8320) in
                                            {9306}out(c, m2_8322);
                                            {9307}let Ksrv_8323: bitstring = h((Ns_8318,Nc_8317)) in
                                            {9308}out(c, senc(mSrv(pkCli_8299,pkSess_7890),Ksrv_8323))
                                        )
                                        else
                                            {9309}let v_8324: bool = (Disco_5600 = C) in
                                            (
                                                {9310}if v_8324 then
                                                (
                                                    {9311}let pkDisco_8325: bitstring = pub(skC) in
                                                    {9312}in(c, (=pkCli_8299,em1_8326: bitstring));
                                                    {9313}let m1_8327: bitstring = em1_8326 in
                                                    {9314}let (=OpenSecureChannelRequest,=pkCli_8299,wNc_8328: bitstring) = m1_8327 in
                                                    {9315}let Nc_8329: bitstring = dec(wNc_8328,skSess_7889) in
                                                    {9316}new Ns_8330: bitstring;
                                                    {9317}new ST_8331: bitstring;
                                                    {9318}new TTL_8332: bitstring;
                                                    {9319}let wNs_8333: bitstring = enc(Ns_8330,pkCli_8299) in
                                                    {9320}let m2_8334: bitstring = (OpenSecureChannelResponse,wNs_8333,ST_8331,TTL_8332) in
                                                    {9321}out(c, m2_8334);
                                                    {9322}let Ksrv_8335: bitstring = h((Ns_8330,Nc_8329)) in
                                                    {9323}out(c, senc(mSrv(pkCli_8299,pkSess_7890),Ksrv_8335))
                                                )
                                                else
                                                    {9324}let pkDisco_8336: bitstring = pub(sk(Disco_5600)) in
                                                    {9325}in(c, (=pkCli_8299,em1_8337: bitstring));
                                                    {9326}let m1_8338: bitstring = em1_8337 in
                                                    {9327}let (=OpenSecureChannelRequest,=pkCli_8299,wNc_8339: bitstring) = m1_8338 in
                                                    {9328}let Nc_8340: bitstring = dec(wNc_8339,skSess_7889) in
                                                    {9329}new Ns_8341: bitstring;
                                                    {9330}new ST_8342: bitstring;
                                                    {9331}new TTL_8343: bitstring;
                                                    {9332}let wNs_8344: bitstring = enc(Ns_8341,pkCli_8299) in
                                                    {9333}let m2_8345: bitstring = (OpenSecureChannelResponse,wNs_8344,ST_8342,TTL_8343) in
                                                    {9334}out(c, m2_8345);
                                                    {9335}let Ksrv_8346: bitstring = h((Ns_8341,Nc_8340)) in
                                                    {9336}out(c, senc(mSrv(pkCli_8299,pkSess_7890),Ksrv_8346))
                                            )
                                            else
                                                {9337}let pkDisco_8347: bitstring = fail-any in
                                                {9338}in(c, (=pkCli_8299,em1_8348: bitstring));
                                                {9339}let m1_8349: bitstring = em1_8348 in
                                                {9340}let (=OpenSecureChannelRequest,=pkCli_8299,wNc_8350: bitstring) = m1_8349 in
                                                {9341}let Nc_8351: bitstring = dec(wNc_8350,skSess_7889) in
                                                {9342}new Ns_8352: bitstring;
                                                {9343}new ST_8353: bitstring;
                                                {9344}new TTL_8354: bitstring;
                                                {9345}let wNs_8355: bitstring = enc(Ns_8352,pkCli_8299) in
                                                {9346}let m2_8356: bitstring = (OpenSecureChannelResponse,wNs_8355,ST_8353,TTL_8354) in
                                                {9347}out(c, m2_8356);
                                                {9348}let Ksrv_8357: bitstring = h((Ns_8352,Nc_8351)) in
                                                {9349}out(c, senc(mSrv(pkCli_8299,pkSess_7890),Ksrv_8357))
                                    )
                                    else
                                        {9350}let pkDisco_8358: bitstring = fail-any in
                                        {9351}in(c, (=pkCli_8299,em1_8359: bitstring));
                                        {9352}let m1_8360: bitstring = em1_8359 in
                                        {9353}let (=OpenSecureChannelRequest,=pkCli_8299,wNc_8361: bitstring) = m1_8360 in
                                        {9354}let Nc_8362: bitstring = dec(wNc_8361,skSess_7889) in
                                        {9355}new Ns_8363: bitstring;
                                        {9356}new ST_8364: bitstring;
                                        {9357}new TTL_8365: bitstring;
                                        {9358}let wNs_8366: bitstring = enc(Ns_8363,pkCli_8299) in
                                        {9359}let m2_8367: bitstring = (OpenSecureChannelResponse,wNs_8366,ST_8364,TTL_8365) in
                                        {9360}out(c, m2_8367);
                                        {9361}let Ksrv_8368: bitstring = h((Ns_8363,Nc_8362)) in
                                        {9362}out(c, senc(mSrv(pkCli_8299,pkSess_7890),Ksrv_8368))
                            )
                            else
                                {9363}let pkDisco_8369: bitstring = fail-any in
                                {9364}in(c, (=pkCli_8299,em1_8370: bitstring));
                                {9365}let m1_8371: bitstring = em1_8370 in
                                {9366}let (=OpenSecureChannelRequest,=pkCli_8299,wNc_8372: bitstring) = m1_8371 in
                                {9367}let Nc_8373: bitstring = dec(wNc_8372,skSess_7889) in
                                {9368}new Ns_8374: bitstring;
                                {9369}new ST_8375: bitstring;
                                {9370}new TTL_8376: bitstring;
                                {9371}let wNs_8377: bitstring = enc(Ns_8374,pkCli_8299) in
                                {9372}let m2_8378: bitstring = (OpenSecureChannelResponse,wNs_8377,ST_8375,TTL_8376) in
                                {9373}out(c, m2_8378);
                                {9374}let Ksrv_8379: bitstring = h((Ns_8374,Nc_8373)) in
                                {9375}out(c, senc(mSrv(pkCli_8299,pkSess_7890),Ksrv_8379))
                )
                else
                    {9376}let pkCli_8380: bitstring = fail-any in
                    {9377}let v_8381: bool = (Disco_5600 = A) in
                    (
                        {9378}if v_8381 then
                        (
                            {9379}let pkDisco_8382: bitstring = pub(skA) in
                            {9380}in(c, (=pkCli_8380,em1_8383: bitstring));
                            {9381}let m1_8384: bitstring = em1_8383 in
                            {9382}let (=OpenSecureChannelRequest,=pkCli_8380,wNc_8385: bitstring) = m1_8384 in
                            {9383}let Nc_8386: bitstring = dec(wNc_8385,skSess_7889) in
                            {9384}new Ns_8387: bitstring;
                            {9385}new ST_8388: bitstring;
                            {9386}new TTL_8389: bitstring;
                            {9387}let wNs_8390: bitstring = enc(Ns_8387,pkCli_8380) in
                            {9388}let m2_8391: bitstring = (OpenSecureChannelResponse,wNs_8390,ST_8388,TTL_8389) in
                            {9389}out(c, m2_8391);
                            {9390}let Ksrv_8392: bitstring = h((Ns_8387,Nc_8386)) in
                            {9391}out(c, senc(mSrv(pkCli_8380,pkSess_7890),Ksrv_8392))
                        )
                        else
                            {9392}let v_8393: bool = (Disco_5600 = B) in
                            (
                                {9393}if v_8393 then
                                (
                                    {9394}let pkDisco_8394: bitstring = pub(skB) in
                                    {9395}in(c, (=pkCli_8380,em1_8395: bitstring));
                                    {9396}let m1_8396: bitstring = em1_8395 in
                                    {9397}let (=OpenSecureChannelRequest,=pkCli_8380,wNc_8397: bitstring) = m1_8396 in
                                    {9398}let Nc_8398: bitstring = dec(wNc_8397,skSess_7889) in
                                    {9399}new Ns_8399: bitstring;
                                    {9400}new ST_8400: bitstring;
                                    {9401}new TTL_8401: bitstring;
                                    {9402}let wNs_8402: bitstring = enc(Ns_8399,pkCli_8380) in
                                    {9403}let m2_8403: bitstring = (OpenSecureChannelResponse,wNs_8402,ST_8400,TTL_8401) in
                                    {9404}out(c, m2_8403);
                                    {9405}let Ksrv_8404: bitstring = h((Ns_8399,Nc_8398)) in
                                    {9406}out(c, senc(mSrv(pkCli_8380,pkSess_7890),Ksrv_8404))
                                )
                                else
                                    {9407}let v_8405: bool = (Disco_5600 = C) in
                                    (
                                        {9408}if v_8405 then
                                        (
                                            {9409}let pkDisco_8406: bitstring = pub(skC) in
                                            {9410}in(c, (=pkCli_8380,em1_8407: bitstring));
                                            {9411}let m1_8408: bitstring = em1_8407 in
                                            {9412}let (=OpenSecureChannelRequest,=pkCli_8380,wNc_8409: bitstring) = m1_8408 in
                                            {9413}let Nc_8410: bitstring = dec(wNc_8409,skSess_7889) in
                                            {9414}new Ns_8411: bitstring;
                                            {9415}new ST_8412: bitstring;
                                            {9416}new TTL_8413: bitstring;
                                            {9417}let wNs_8414: bitstring = enc(Ns_8411,pkCli_8380) in
                                            {9418}let m2_8415: bitstring = (OpenSecureChannelResponse,wNs_8414,ST_8412,TTL_8413) in
                                            {9419}out(c, m2_8415);
                                            {9420}let Ksrv_8416: bitstring = h((Ns_8411,Nc_8410)) in
                                            {9421}out(c, senc(mSrv(pkCli_8380,pkSess_7890),Ksrv_8416))
                                        )
                                        else
                                            {9422}let pkDisco_8417: bitstring = pub(sk(Disco_5600)) in
                                            {9423}in(c, (=pkCli_8380,em1_8418: bitstring));
                                            {9424}let m1_8419: bitstring = em1_8418 in
                                            {9425}let (=OpenSecureChannelRequest,=pkCli_8380,wNc_8420: bitstring) = m1_8419 in
                                            {9426}let Nc_8421: bitstring = dec(wNc_8420,skSess_7889) in
                                            {9427}new Ns_8422: bitstring;
                                            {9428}new ST_8423: bitstring;
                                            {9429}new TTL_8424: bitstring;
                                            {9430}let wNs_8425: bitstring = enc(Ns_8422,pkCli_8380) in
                                            {9431}let m2_8426: bitstring = (OpenSecureChannelResponse,wNs_8425,ST_8423,TTL_8424) in
                                            {9432}out(c, m2_8426);
                                            {9433}let Ksrv_8427: bitstring = h((Ns_8422,Nc_8421)) in
                                            {9434}out(c, senc(mSrv(pkCli_8380,pkSess_7890),Ksrv_8427))
                                    )
                                    else
                                        {9435}let pkDisco_8428: bitstring = fail-any in
                                        {9436}in(c, (=pkCli_8380,em1_8429: bitstring));
                                        {9437}let m1_8430: bitstring = em1_8429 in
                                        {9438}let (=OpenSecureChannelRequest,=pkCli_8380,wNc_8431: bitstring) = m1_8430 in
                                        {9439}let Nc_8432: bitstring = dec(wNc_8431,skSess_7889) in
                                        {9440}new Ns_8433: bitstring;
                                        {9441}new ST_8434: bitstring;
                                        {9442}new TTL_8435: bitstring;
                                        {9443}let wNs_8436: bitstring = enc(Ns_8433,pkCli_8380) in
                                        {9444}let m2_8437: bitstring = (OpenSecureChannelResponse,wNs_8436,ST_8434,TTL_8435) in
                                        {9445}out(c, m2_8437);
                                        {9446}let Ksrv_8438: bitstring = h((Ns_8433,Nc_8432)) in
                                        {9447}out(c, senc(mSrv(pkCli_8380,pkSess_7890),Ksrv_8438))
                            )
                            else
                                {9448}let pkDisco_8439: bitstring = fail-any in
                                {9449}in(c, (=pkCli_8380,em1_8440: bitstring));
                                {9450}let m1_8441: bitstring = em1_8440 in
                                {9451}let (=OpenSecureChannelRequest,=pkCli_8380,wNc_8442: bitstring) = m1_8441 in
                                {9452}let Nc_8443: bitstring = dec(wNc_8442,skSess_7889) in
                                {9453}new Ns_8444: bitstring;
                                {9454}new ST_8445: bitstring;
                                {9455}new TTL_8446: bitstring;
                                {9456}let wNs_8447: bitstring = enc(Ns_8444,pkCli_8380) in
                                {9457}let m2_8448: bitstring = (OpenSecureChannelResponse,wNs_8447,ST_8445,TTL_8446) in
                                {9458}out(c, m2_8448);
                                {9459}let Ksrv_8449: bitstring = h((Ns_8444,Nc_8443)) in
                                {9460}out(c, senc(mSrv(pkCli_8380,pkSess_7890),Ksrv_8449))
                    )
                    else
                        {9461}let pkDisco_8450: bitstring = fail-any in
                        {9462}in(c, (=pkCli_8380,em1_8451: bitstring));
                        {9463}let m1_8452: bitstring = em1_8451 in
                        {9464}let (=OpenSecureChannelRequest,=pkCli_8380,wNc_8453: bitstring) = m1_8452 in
                        {9465}let Nc_8454: bitstring = dec(wNc_8453,skSess_7889) in
                        {9466}new Ns_8455: bitstring;
                        {9467}new ST_8456: bitstring;
                        {9468}new TTL_8457: bitstring;
                        {9469}let wNs_8458: bitstring = enc(Ns_8455,pkCli_8380) in
                        {9470}let m2_8459: bitstring = (OpenSecureChannelResponse,wNs_8458,ST_8456,TTL_8457) in
                        {9471}out(c, m2_8459);
                        {9472}let Ksrv_8460: bitstring = h((Ns_8455,Nc_8454)) in
                        {9473}out(c, senc(mSrv(pkCli_8380,pkSess_7890),Ksrv_8460))
    )
    else
        {9474}let skSess_8461: bitstring = fail-any in
        {9475}let pkSess_8462: bitstring = pub(skSess_8461) in
        {9476}let v_8463: bool = (Cli_5599 = A) in
        (
            {9477}if v_8463 then
            (
                {9478}let pkCli_8464: bitstring = pub(skA) in
                {9479}let v_8465: bool = (Disco_5600 = A) in
                (
                    {9480}if v_8465 then
                    (
                        {9481}let pkDisco_8466: bitstring = pub(skA) in
                        {9482}in(c, (=pkCli_8464,em1_8467: bitstring));
                        {9483}let m1_8468: bitstring = em1_8467 in
                        {9484}let (=OpenSecureChannelRequest,=pkCli_8464,wNc_8469: bitstring) = m1_8468 in
                        {9485}let Nc_8470: bitstring = dec(wNc_8469,skSess_8461) in
                        {9486}new Ns_8471: bitstring;
                        {9487}new ST_8472: bitstring;
                        {9488}new TTL_8473: bitstring;
                        {9489}let wNs_8474: bitstring = enc(Ns_8471,pkCli_8464) in
                        {9490}let m2_8475: bitstring = (OpenSecureChannelResponse,wNs_8474,ST_8472,TTL_8473) in
                        {9491}out(c, m2_8475);
                        {9492}let Ksrv_8476: bitstring = h((Ns_8471,Nc_8470)) in
                        {9493}out(c, senc(mSrv(pkCli_8464,pkSess_8462),Ksrv_8476))
                    )
                    else
                        {9494}let v_8477: bool = (Disco_5600 = B) in
                        (
                            {9495}if v_8477 then
                            (
                                {9496}let pkDisco_8478: bitstring = pub(skB) in
                                {9497}in(c, (=pkCli_8464,em1_8479: bitstring));
                                {9498}let m1_8480: bitstring = em1_8479 in
                                {9499}let (=OpenSecureChannelRequest,=pkCli_8464,wNc_8481: bitstring) = m1_8480 in
                                {9500}let Nc_8482: bitstring = dec(wNc_8481,skSess_8461) in
                                {9501}new Ns_8483: bitstring;
                                {9502}new ST_8484: bitstring;
                                {9503}new TTL_8485: bitstring;
                                {9504}let wNs_8486: bitstring = enc(Ns_8483,pkCli_8464) in
                                {9505}let m2_8487: bitstring = (OpenSecureChannelResponse,wNs_8486,ST_8484,TTL_8485) in
                                {9506}out(c, m2_8487);
                                {9507}let Ksrv_8488: bitstring = h((Ns_8483,Nc_8482)) in
                                {9508}out(c, senc(mSrv(pkCli_8464,pkSess_8462),Ksrv_8488))
                            )
                            else
                                {9509}let v_8489: bool = (Disco_5600 = C) in
                                (
                                    {9510}if v_8489 then
                                    (
                                        {9511}let pkDisco_8490: bitstring = pub(skC) in
                                        {9512}in(c, (=pkCli_8464,em1_8491: bitstring));
                                        {9513}let m1_8492: bitstring = em1_8491 in
                                        {9514}let (=OpenSecureChannelRequest,=pkCli_8464,wNc_8493: bitstring) = m1_8492 in
                                        {9515}let Nc_8494: bitstring = dec(wNc_8493,skSess_8461) in
                                        {9516}new Ns_8495: bitstring;
                                        {9517}new ST_8496: bitstring;
                                        {9518}new TTL_8497: bitstring;
                                        {9519}let wNs_8498: bitstring = enc(Ns_8495,pkCli_8464) in
                                        {9520}let m2_8499: bitstring = (OpenSecureChannelResponse,wNs_8498,ST_8496,TTL_8497) in
                                        {9521}out(c, m2_8499);
                                        {9522}let Ksrv_8500: bitstring = h((Ns_8495,Nc_8494)) in
                                        {9523}out(c, senc(mSrv(pkCli_8464,pkSess_8462),Ksrv_8500))
                                    )
                                    else
                                        {9524}let pkDisco_8501: bitstring = pub(sk(Disco_5600)) in
                                        {9525}in(c, (=pkCli_8464,em1_8502: bitstring));
                                        {9526}let m1_8503: bitstring = em1_8502 in
                                        {9527}let (=OpenSecureChannelRequest,=pkCli_8464,wNc_8504: bitstring) = m1_8503 in
                                        {9528}let Nc_8505: bitstring = dec(wNc_8504,skSess_8461) in
                                        {9529}new Ns_8506: bitstring;
                                        {9530}new ST_8507: bitstring;
                                        {9531}new TTL_8508: bitstring;
                                        {9532}let wNs_8509: bitstring = enc(Ns_8506,pkCli_8464) in
                                        {9533}let m2_8510: bitstring = (OpenSecureChannelResponse,wNs_8509,ST_8507,TTL_8508) in
                                        {9534}out(c, m2_8510);
                                        {9535}let Ksrv_8511: bitstring = h((Ns_8506,Nc_8505)) in
                                        {9536}out(c, senc(mSrv(pkCli_8464,pkSess_8462),Ksrv_8511))
                                )
                                else
                                    {9537}let pkDisco_8512: bitstring = fail-any in
                                    {9538}in(c, (=pkCli_8464,em1_8513: bitstring));
                                    {9539}let m1_8514: bitstring = em1_8513 in
                                    {9540}let (=OpenSecureChannelRequest,=pkCli_8464,wNc_8515: bitstring) = m1_8514 in
                                    {9541}let Nc_8516: bitstring = dec(wNc_8515,skSess_8461) in
                                    {9542}new Ns_8517: bitstring;
                                    {9543}new ST_8518: bitstring;
                                    {9544}new TTL_8519: bitstring;
                                    {9545}let wNs_8520: bitstring = enc(Ns_8517,pkCli_8464) in
                                    {9546}let m2_8521: bitstring = (OpenSecureChannelResponse,wNs_8520,ST_8518,TTL_8519) in
                                    {9547}out(c, m2_8521);
                                    {9548}let Ksrv_8522: bitstring = h((Ns_8517,Nc_8516)) in
                                    {9549}out(c, senc(mSrv(pkCli_8464,pkSess_8462),Ksrv_8522))
                        )
                        else
                            {9550}let pkDisco_8523: bitstring = fail-any in
                            {9551}in(c, (=pkCli_8464,em1_8524: bitstring));
                            {9552}let m1_8525: bitstring = em1_8524 in
                            {9553}let (=OpenSecureChannelRequest,=pkCli_8464,wNc_8526: bitstring) = m1_8525 in
                            {9554}let Nc_8527: bitstring = dec(wNc_8526,skSess_8461) in
                            {9555}new Ns_8528: bitstring;
                            {9556}new ST_8529: bitstring;
                            {9557}new TTL_8530: bitstring;
                            {9558}let wNs_8531: bitstring = enc(Ns_8528,pkCli_8464) in
                            {9559}let m2_8532: bitstring = (OpenSecureChannelResponse,wNs_8531,ST_8529,TTL_8530) in
                            {9560}out(c, m2_8532);
                            {9561}let Ksrv_8533: bitstring = h((Ns_8528,Nc_8527)) in
                            {9562}out(c, senc(mSrv(pkCli_8464,pkSess_8462),Ksrv_8533))
                )
                else
                    {9563}let pkDisco_8534: bitstring = fail-any in
                    {9564}in(c, (=pkCli_8464,em1_8535: bitstring));
                    {9565}let m1_8536: bitstring = em1_8535 in
                    {9566}let (=OpenSecureChannelRequest,=pkCli_8464,wNc_8537: bitstring) = m1_8536 in
                    {9567}let Nc_8538: bitstring = dec(wNc_8537,skSess_8461) in
                    {9568}new Ns_8539: bitstring;
                    {9569}new ST_8540: bitstring;
                    {9570}new TTL_8541: bitstring;
                    {9571}let wNs_8542: bitstring = enc(Ns_8539,pkCli_8464) in
                    {9572}let m2_8543: bitstring = (OpenSecureChannelResponse,wNs_8542,ST_8540,TTL_8541) in
                    {9573}out(c, m2_8543);
                    {9574}let Ksrv_8544: bitstring = h((Ns_8539,Nc_8538)) in
                    {9575}out(c, senc(mSrv(pkCli_8464,pkSess_8462),Ksrv_8544))
            )
            else
                {9576}let v_8545: bool = (Cli_5599 = B) in
                (
                    {9577}if v_8545 then
                    (
                        {9578}let pkCli_8546: bitstring = pub(skB) in
                        {9579}let v_8547: bool = (Disco_5600 = A) in
                        (
                            {9580}if v_8547 then
                            (
                                {9581}let pkDisco_8548: bitstring = pub(skA) in
                                {9582}in(c, (=pkCli_8546,em1_8549: bitstring));
                                {9583}let m1_8550: bitstring = em1_8549 in
                                {9584}let (=OpenSecureChannelRequest,=pkCli_8546,wNc_8551: bitstring) = m1_8550 in
                                {9585}let Nc_8552: bitstring = dec(wNc_8551,skSess_8461) in
                                {9586}new Ns_8553: bitstring;
                                {9587}new ST_8554: bitstring;
                                {9588}new TTL_8555: bitstring;
                                {9589}let wNs_8556: bitstring = enc(Ns_8553,pkCli_8546) in
                                {9590}let m2_8557: bitstring = (OpenSecureChannelResponse,wNs_8556,ST_8554,TTL_8555) in
                                {9591}out(c, m2_8557);
                                {9592}let Ksrv_8558: bitstring = h((Ns_8553,Nc_8552)) in
                                {9593}out(c, senc(mSrv(pkCli_8546,pkSess_8462),Ksrv_8558))
                            )
                            else
                                {9594}let v_8559: bool = (Disco_5600 = B) in
                                (
                                    {9595}if v_8559 then
                                    (
                                        {9596}let pkDisco_8560: bitstring = pub(skB) in
                                        {9597}in(c, (=pkCli_8546,em1_8561: bitstring));
                                        {9598}let m1_8562: bitstring = em1_8561 in
                                        {9599}let (=OpenSecureChannelRequest,=pkCli_8546,wNc_8563: bitstring) = m1_8562 in
                                        {9600}let Nc_8564: bitstring = dec(wNc_8563,skSess_8461) in
                                        {9601}new Ns_8565: bitstring;
                                        {9602}new ST_8566: bitstring;
                                        {9603}new TTL_8567: bitstring;
                                        {9604}let wNs_8568: bitstring = enc(Ns_8565,pkCli_8546) in
                                        {9605}let m2_8569: bitstring = (OpenSecureChannelResponse,wNs_8568,ST_8566,TTL_8567) in
                                        {9606}out(c, m2_8569);
                                        {9607}let Ksrv_8570: bitstring = h((Ns_8565,Nc_8564)) in
                                        {9608}out(c, senc(mSrv(pkCli_8546,pkSess_8462),Ksrv_8570))
                                    )
                                    else
                                        {9609}let v_8571: bool = (Disco_5600 = C) in
                                        (
                                            {9610}if v_8571 then
                                            (
                                                {9611}let pkDisco_8572: bitstring = pub(skC) in
                                                {9612}in(c, (=pkCli_8546,em1_8573: bitstring));
                                                {9613}let m1_8574: bitstring = em1_8573 in
                                                {9614}let (=OpenSecureChannelRequest,=pkCli_8546,wNc_8575: bitstring) = m1_8574 in
                                                {9615}let Nc_8576: bitstring = dec(wNc_8575,skSess_8461) in
                                                {9616}new Ns_8577: bitstring;
                                                {9617}new ST_8578: bitstring;
                                                {9618}new TTL_8579: bitstring;
                                                {9619}let wNs_8580: bitstring = enc(Ns_8577,pkCli_8546) in
                                                {9620}let m2_8581: bitstring = (OpenSecureChannelResponse,wNs_8580,ST_8578,TTL_8579) in
                                                {9621}out(c, m2_8581);
                                                {9622}let Ksrv_8582: bitstring = h((Ns_8577,Nc_8576)) in
                                                {9623}out(c, senc(mSrv(pkCli_8546,pkSess_8462),Ksrv_8582))
                                            )
                                            else
                                                {9624}let pkDisco_8583: bitstring = pub(sk(Disco_5600)) in
                                                {9625}in(c, (=pkCli_8546,em1_8584: bitstring));
                                                {9626}let m1_8585: bitstring = em1_8584 in
                                                {9627}let (=OpenSecureChannelRequest,=pkCli_8546,wNc_8586: bitstring) = m1_8585 in
                                                {9628}let Nc_8587: bitstring = dec(wNc_8586,skSess_8461) in
                                                {9629}new Ns_8588: bitstring;
                                                {9630}new ST_8589: bitstring;
                                                {9631}new TTL_8590: bitstring;
                                                {9632}let wNs_8591: bitstring = enc(Ns_8588,pkCli_8546) in
                                                {9633}let m2_8592: bitstring = (OpenSecureChannelResponse,wNs_8591,ST_8589,TTL_8590) in
                                                {9634}out(c, m2_8592);
                                                {9635}let Ksrv_8593: bitstring = h((Ns_8588,Nc_8587)) in
                                                {9636}out(c, senc(mSrv(pkCli_8546,pkSess_8462),Ksrv_8593))
                                        )
                                        else
                                            {9637}let pkDisco_8594: bitstring = fail-any in
                                            {9638}in(c, (=pkCli_8546,em1_8595: bitstring));
                                            {9639}let m1_8596: bitstring = em1_8595 in
                                            {9640}let (=OpenSecureChannelRequest,=pkCli_8546,wNc_8597: bitstring) = m1_8596 in
                                            {9641}let Nc_8598: bitstring = dec(wNc_8597,skSess_8461) in
                                            {9642}new Ns_8599: bitstring;
                                            {9643}new ST_8600: bitstring;
                                            {9644}new TTL_8601: bitstring;
                                            {9645}let wNs_8602: bitstring = enc(Ns_8599,pkCli_8546) in
                                            {9646}let m2_8603: bitstring = (OpenSecureChannelResponse,wNs_8602,ST_8600,TTL_8601) in
                                            {9647}out(c, m2_8603);
                                            {9648}let Ksrv_8604: bitstring = h((Ns_8599,Nc_8598)) in
                                            {9649}out(c, senc(mSrv(pkCli_8546,pkSess_8462),Ksrv_8604))
                                )
                                else
                                    {9650}let pkDisco_8605: bitstring = fail-any in
                                    {9651}in(c, (=pkCli_8546,em1_8606: bitstring));
                                    {9652}let m1_8607: bitstring = em1_8606 in
                                    {9653}let (=OpenSecureChannelRequest,=pkCli_8546,wNc_8608: bitstring) = m1_8607 in
                                    {9654}let Nc_8609: bitstring = dec(wNc_8608,skSess_8461) in
                                    {9655}new Ns_8610: bitstring;
                                    {9656}new ST_8611: bitstring;
                                    {9657}new TTL_8612: bitstring;
                                    {9658}let wNs_8613: bitstring = enc(Ns_8610,pkCli_8546) in
                                    {9659}let m2_8614: bitstring = (OpenSecureChannelResponse,wNs_8613,ST_8611,TTL_8612) in
                                    {9660}out(c, m2_8614);
                                    {9661}let Ksrv_8615: bitstring = h((Ns_8610,Nc_8609)) in
                                    {9662}out(c, senc(mSrv(pkCli_8546,pkSess_8462),Ksrv_8615))
                        )
                        else
                            {9663}let pkDisco_8616: bitstring = fail-any in
                            {9664}in(c, (=pkCli_8546,em1_8617: bitstring));
                            {9665}let m1_8618: bitstring = em1_8617 in
                            {9666}let (=OpenSecureChannelRequest,=pkCli_8546,wNc_8619: bitstring) = m1_8618 in
                            {9667}let Nc_8620: bitstring = dec(wNc_8619,skSess_8461) in
                            {9668}new Ns_8621: bitstring;
                            {9669}new ST_8622: bitstring;
                            {9670}new TTL_8623: bitstring;
                            {9671}let wNs_8624: bitstring = enc(Ns_8621,pkCli_8546) in
                            {9672}let m2_8625: bitstring = (OpenSecureChannelResponse,wNs_8624,ST_8622,TTL_8623) in
                            {9673}out(c, m2_8625);
                            {9674}let Ksrv_8626: bitstring = h((Ns_8621,Nc_8620)) in
                            {9675}out(c, senc(mSrv(pkCli_8546,pkSess_8462),Ksrv_8626))
                    )
                    else
                        {9676}let v_8627: bool = (Cli_5599 = C) in
                        (
                            {9677}if v_8627 then
                            (
                                {9678}let pkCli_8628: bitstring = pub(skC) in
                                {9679}let v_8629: bool = (Disco_5600 = A) in
                                (
                                    {9680}if v_8629 then
                                    (
                                        {9681}let pkDisco_8630: bitstring = pub(skA) in
                                        {9682}in(c, (=pkCli_8628,em1_8631: bitstring));
                                        {9683}let m1_8632: bitstring = em1_8631 in
                                        {9684}let (=OpenSecureChannelRequest,=pkCli_8628,wNc_8633: bitstring) = m1_8632 in
                                        {9685}let Nc_8634: bitstring = dec(wNc_8633,skSess_8461) in
                                        {9686}new Ns_8635: bitstring;
                                        {9687}new ST_8636: bitstring;
                                        {9688}new TTL_8637: bitstring;
                                        {9689}let wNs_8638: bitstring = enc(Ns_8635,pkCli_8628) in
                                        {9690}let m2_8639: bitstring = (OpenSecureChannelResponse,wNs_8638,ST_8636,TTL_8637) in
                                        {9691}out(c, m2_8639);
                                        {9692}let Ksrv_8640: bitstring = h((Ns_8635,Nc_8634)) in
                                        {9693}out(c, senc(mSrv(pkCli_8628,pkSess_8462),Ksrv_8640))
                                    )
                                    else
                                        {9694}let v_8641: bool = (Disco_5600 = B) in
                                        (
                                            {9695}if v_8641 then
                                            (
                                                {9696}let pkDisco_8642: bitstring = pub(skB) in
                                                {9697}in(c, (=pkCli_8628,em1_8643: bitstring));
                                                {9698}let m1_8644: bitstring = em1_8643 in
                                                {9699}let (=OpenSecureChannelRequest,=pkCli_8628,wNc_8645: bitstring) = m1_8644 in
                                                {9700}let Nc_8646: bitstring = dec(wNc_8645,skSess_8461) in
                                                {9701}new Ns_8647: bitstring;
                                                {9702}new ST_8648: bitstring;
                                                {9703}new TTL_8649: bitstring;
                                                {9704}let wNs_8650: bitstring = enc(Ns_8647,pkCli_8628) in
                                                {9705}let m2_8651: bitstring = (OpenSecureChannelResponse,wNs_8650,ST_8648,TTL_8649) in
                                                {9706}out(c, m2_8651);
                                                {9707}let Ksrv_8652: bitstring = h((Ns_8647,Nc_8646)) in
                                                {9708}out(c, senc(mSrv(pkCli_8628,pkSess_8462),Ksrv_8652))
                                            )
                                            else
                                                {9709}let v_8653: bool = (Disco_5600 = C) in
                                                (
                                                    {9710}if v_8653 then
                                                    (
                                                        {9711}let pkDisco_8654: bitstring = pub(skC) in
                                                        {9712}in(c, (=pkCli_8628,em1_8655: bitstring));
                                                        {9713}let m1_8656: bitstring = em1_8655 in
                                                        {9714}let (=OpenSecureChannelRequest,=pkCli_8628,wNc_8657: bitstring) = m1_8656 in
                                                        {9715}let Nc_8658: bitstring = dec(wNc_8657,skSess_8461) in
                                                        {9716}new Ns_8659: bitstring;
                                                        {9717}new ST_8660: bitstring;
                                                        {9718}new TTL_8661: bitstring;
                                                        {9719}let wNs_8662: bitstring = enc(Ns_8659,pkCli_8628) in
                                                        {9720}let m2_8663: bitstring = (OpenSecureChannelResponse,wNs_8662,ST_8660,TTL_8661) in
                                                        {9721}out(c, m2_8663);
                                                        {9722}let Ksrv_8664: bitstring = h((Ns_8659,Nc_8658)) in
                                                        {9723}out(c, senc(mSrv(pkCli_8628,pkSess_8462),Ksrv_8664))
                                                    )
                                                    else
                                                        {9724}let pkDisco_8665: bitstring = pub(sk(Disco_5600)) in
                                                        {9725}in(c, (=pkCli_8628,em1_8666: bitstring));
                                                        {9726}let m1_8667: bitstring = em1_8666 in
                                                        {9727}let (=OpenSecureChannelRequest,=pkCli_8628,wNc_8668: bitstring) = m1_8667 in
                                                        {9728}let Nc_8669: bitstring = dec(wNc_8668,skSess_8461) in
                                                        {9729}new Ns_8670: bitstring;
                                                        {9730}new ST_8671: bitstring;
                                                        {9731}new TTL_8672: bitstring;
                                                        {9732}let wNs_8673: bitstring = enc(Ns_8670,pkCli_8628) in
                                                        {9733}let m2_8674: bitstring = (OpenSecureChannelResponse,wNs_8673,ST_8671,TTL_8672) in
                                                        {9734}out(c, m2_8674);
                                                        {9735}let Ksrv_8675: bitstring = h((Ns_8670,Nc_8669)) in
                                                        {9736}out(c, senc(mSrv(pkCli_8628,pkSess_8462),Ksrv_8675))
                                                )
                                                else
                                                    {9737}let pkDisco_8676: bitstring = fail-any in
                                                    {9738}in(c, (=pkCli_8628,em1_8677: bitstring));
                                                    {9739}let m1_8678: bitstring = em1_8677 in
                                                    {9740}let (=OpenSecureChannelRequest,=pkCli_8628,wNc_8679: bitstring) = m1_8678 in
                                                    {9741}let Nc_8680: bitstring = dec(wNc_8679,skSess_8461) in
                                                    {9742}new Ns_8681: bitstring;
                                                    {9743}new ST_8682: bitstring;
                                                    {9744}new TTL_8683: bitstring;
                                                    {9745}let wNs_8684: bitstring = enc(Ns_8681,pkCli_8628) in
                                                    {9746}let m2_8685: bitstring = (OpenSecureChannelResponse,wNs_8684,ST_8682,TTL_8683) in
                                                    {9747}out(c, m2_8685);
                                                    {9748}let Ksrv_8686: bitstring = h((Ns_8681,Nc_8680)) in
                                                    {9749}out(c, senc(mSrv(pkCli_8628,pkSess_8462),Ksrv_8686))
                                        )
                                        else
                                            {9750}let pkDisco_8687: bitstring = fail-any in
                                            {9751}in(c, (=pkCli_8628,em1_8688: bitstring));
                                            {9752}let m1_8689: bitstring = em1_8688 in
                                            {9753}let (=OpenSecureChannelRequest,=pkCli_8628,wNc_8690: bitstring) = m1_8689 in
                                            {9754}let Nc_8691: bitstring = dec(wNc_8690,skSess_8461) in
                                            {9755}new Ns_8692: bitstring;
                                            {9756}new ST_8693: bitstring;
                                            {9757}new TTL_8694: bitstring;
                                            {9758}let wNs_8695: bitstring = enc(Ns_8692,pkCli_8628) in
                                            {9759}let m2_8696: bitstring = (OpenSecureChannelResponse,wNs_8695,ST_8693,TTL_8694) in
                                            {9760}out(c, m2_8696);
                                            {9761}let Ksrv_8697: bitstring = h((Ns_8692,Nc_8691)) in
                                            {9762}out(c, senc(mSrv(pkCli_8628,pkSess_8462),Ksrv_8697))
                                )
                                else
                                    {9763}let pkDisco_8698: bitstring = fail-any in
                                    {9764}in(c, (=pkCli_8628,em1_8699: bitstring));
                                    {9765}let m1_8700: bitstring = em1_8699 in
                                    {9766}let (=OpenSecureChannelRequest,=pkCli_8628,wNc_8701: bitstring) = m1_8700 in
                                    {9767}let Nc_8702: bitstring = dec(wNc_8701,skSess_8461) in
                                    {9768}new Ns_8703: bitstring;
                                    {9769}new ST_8704: bitstring;
                                    {9770}new TTL_8705: bitstring;
                                    {9771}let wNs_8706: bitstring = enc(Ns_8703,pkCli_8628) in
                                    {9772}let m2_8707: bitstring = (OpenSecureChannelResponse,wNs_8706,ST_8704,TTL_8705) in
                                    {9773}out(c, m2_8707);
                                    {9774}let Ksrv_8708: bitstring = h((Ns_8703,Nc_8702)) in
                                    {9775}out(c, senc(mSrv(pkCli_8628,pkSess_8462),Ksrv_8708))
                            )
                            else
                                {9776}let pkCli_8709: bitstring = pub(sk(Cli_5599)) in
                                {9777}let v_8710: bool = (Disco_5600 = A) in
                                (
                                    {9778}if v_8710 then
                                    (
                                        {9779}let pkDisco_8711: bitstring = pub(skA) in
                                        {9780}in(c, (=pkCli_8709,em1_8712: bitstring));
                                        {9781}let m1_8713: bitstring = em1_8712 in
                                        {9782}let (=OpenSecureChannelRequest,=pkCli_8709,wNc_8714: bitstring) = m1_8713 in
                                        {9783}let Nc_8715: bitstring = dec(wNc_8714,skSess_8461) in
                                        {9784}new Ns_8716: bitstring;
                                        {9785}new ST_8717: bitstring;
                                        {9786}new TTL_8718: bitstring;
                                        {9787}let wNs_8719: bitstring = enc(Ns_8716,pkCli_8709) in
                                        {9788}let m2_8720: bitstring = (OpenSecureChannelResponse,wNs_8719,ST_8717,TTL_8718) in
                                        {9789}out(c, m2_8720);
                                        {9790}let Ksrv_8721: bitstring = h((Ns_8716,Nc_8715)) in
                                        {9791}out(c, senc(mSrv(pkCli_8709,pkSess_8462),Ksrv_8721))
                                    )
                                    else
                                        {9792}let v_8722: bool = (Disco_5600 = B) in
                                        (
                                            {9793}if v_8722 then
                                            (
                                                {9794}let pkDisco_8723: bitstring = pub(skB) in
                                                {9795}in(c, (=pkCli_8709,em1_8724: bitstring));
                                                {9796}let m1_8725: bitstring = em1_8724 in
                                                {9797}let (=OpenSecureChannelRequest,=pkCli_8709,wNc_8726: bitstring) = m1_8725 in
                                                {9798}let Nc_8727: bitstring = dec(wNc_8726,skSess_8461) in
                                                {9799}new Ns_8728: bitstring;
                                                {9800}new ST_8729: bitstring;
                                                {9801}new TTL_8730: bitstring;
                                                {9802}let wNs_8731: bitstring = enc(Ns_8728,pkCli_8709) in
                                                {9803}let m2_8732: bitstring = (OpenSecureChannelResponse,wNs_8731,ST_8729,TTL_8730) in
                                                {9804}out(c, m2_8732);
                                                {9805}let Ksrv_8733: bitstring = h((Ns_8728,Nc_8727)) in
                                                {9806}out(c, senc(mSrv(pkCli_8709,pkSess_8462),Ksrv_8733))
                                            )
                                            else
                                                {9807}let v_8734: bool = (Disco_5600 = C) in
                                                (
                                                    {9808}if v_8734 then
                                                    (
                                                        {9809}let pkDisco_8735: bitstring = pub(skC) in
                                                        {9810}in(c, (=pkCli_8709,em1_8736: bitstring));
                                                        {9811}let m1_8737: bitstring = em1_8736 in
                                                        {9812}let (=OpenSecureChannelRequest,=pkCli_8709,wNc_8738: bitstring) = m1_8737 in
                                                        {9813}let Nc_8739: bitstring = dec(wNc_8738,skSess_8461) in
                                                        {9814}new Ns_8740: bitstring;
                                                        {9815}new ST_8741: bitstring;
                                                        {9816}new TTL_8742: bitstring;
                                                        {9817}let wNs_8743: bitstring = enc(Ns_8740,pkCli_8709) in
                                                        {9818}let m2_8744: bitstring = (OpenSecureChannelResponse,wNs_8743,ST_8741,TTL_8742) in
                                                        {9819}out(c, m2_8744);
                                                        {9820}let Ksrv_8745: bitstring = h((Ns_8740,Nc_8739)) in
                                                        {9821}out(c, senc(mSrv(pkCli_8709,pkSess_8462),Ksrv_8745))
                                                    )
                                                    else
                                                        {9822}let pkDisco_8746: bitstring = pub(sk(Disco_5600)) in
                                                        {9823}in(c, (=pkCli_8709,em1_8747: bitstring));
                                                        {9824}let m1_8748: bitstring = em1_8747 in
                                                        {9825}let (=OpenSecureChannelRequest,=pkCli_8709,wNc_8749: bitstring) = m1_8748 in
                                                        {9826}let Nc_8750: bitstring = dec(wNc_8749,skSess_8461) in
                                                        {9827}new Ns_8751: bitstring;
                                                        {9828}new ST_8752: bitstring;
                                                        {9829}new TTL_8753: bitstring;
                                                        {9830}let wNs_8754: bitstring = enc(Ns_8751,pkCli_8709) in
                                                        {9831}let m2_8755: bitstring = (OpenSecureChannelResponse,wNs_8754,ST_8752,TTL_8753) in
                                                        {9832}out(c, m2_8755);
                                                        {9833}let Ksrv_8756: bitstring = h((Ns_8751,Nc_8750)) in
                                                        {9834}out(c, senc(mSrv(pkCli_8709,pkSess_8462),Ksrv_8756))
                                                )
                                                else
                                                    {9835}let pkDisco_8757: bitstring = fail-any in
                                                    {9836}in(c, (=pkCli_8709,em1_8758: bitstring));
                                                    {9837}let m1_8759: bitstring = em1_8758 in
                                                    {9838}let (=OpenSecureChannelRequest,=pkCli_8709,wNc_8760: bitstring) = m1_8759 in
                                                    {9839}let Nc_8761: bitstring = dec(wNc_8760,skSess_8461) in
                                                    {9840}new Ns_8762: bitstring;
                                                    {9841}new ST_8763: bitstring;
                                                    {9842}new TTL_8764: bitstring;
                                                    {9843}let wNs_8765: bitstring = enc(Ns_8762,pkCli_8709) in
                                                    {9844}let m2_8766: bitstring = (OpenSecureChannelResponse,wNs_8765,ST_8763,TTL_8764) in
                                                    {9845}out(c, m2_8766);
                                                    {9846}let Ksrv_8767: bitstring = h((Ns_8762,Nc_8761)) in
                                                    {9847}out(c, senc(mSrv(pkCli_8709,pkSess_8462),Ksrv_8767))
                                        )
                                        else
                                            {9848}let pkDisco_8768: bitstring = fail-any in
                                            {9849}in(c, (=pkCli_8709,em1_8769: bitstring));
                                            {9850}let m1_8770: bitstring = em1_8769 in
                                            {9851}let (=OpenSecureChannelRequest,=pkCli_8709,wNc_8771: bitstring) = m1_8770 in
                                            {9852}let Nc_8772: bitstring = dec(wNc_8771,skSess_8461) in
                                            {9853}new Ns_8773: bitstring;
                                            {9854}new ST_8774: bitstring;
                                            {9855}new TTL_8775: bitstring;
                                            {9856}let wNs_8776: bitstring = enc(Ns_8773,pkCli_8709) in
                                            {9857}let m2_8777: bitstring = (OpenSecureChannelResponse,wNs_8776,ST_8774,TTL_8775) in
                                            {9858}out(c, m2_8777);
                                            {9859}let Ksrv_8778: bitstring = h((Ns_8773,Nc_8772)) in
                                            {9860}out(c, senc(mSrv(pkCli_8709,pkSess_8462),Ksrv_8778))
                                )
                                else
                                    {9861}let pkDisco_8779: bitstring = fail-any in
                                    {9862}in(c, (=pkCli_8709,em1_8780: bitstring));
                                    {9863}let m1_8781: bitstring = em1_8780 in
                                    {9864}let (=OpenSecureChannelRequest,=pkCli_8709,wNc_8782: bitstring) = m1_8781 in
                                    {9865}let Nc_8783: bitstring = dec(wNc_8782,skSess_8461) in
                                    {9866}new Ns_8784: bitstring;
                                    {9867}new ST_8785: bitstring;
                                    {9868}new TTL_8786: bitstring;
                                    {9869}let wNs_8787: bitstring = enc(Ns_8784,pkCli_8709) in
                                    {9870}let m2_8788: bitstring = (OpenSecureChannelResponse,wNs_8787,ST_8785,TTL_8786) in
                                    {9871}out(c, m2_8788);
                                    {9872}let Ksrv_8789: bitstring = h((Ns_8784,Nc_8783)) in
                                    {9873}out(c, senc(mSrv(pkCli_8709,pkSess_8462),Ksrv_8789))
                        )
                        else
                            {9874}let pkCli_8790: bitstring = fail-any in
                            {9875}let v_8791: bool = (Disco_5600 = A) in
                            (
                                {9876}if v_8791 then
                                (
                                    {9877}let pkDisco_8792: bitstring = pub(skA) in
                                    {9878}in(c, (=pkCli_8790,em1_8793: bitstring));
                                    {9879}let m1_8794: bitstring = em1_8793 in
                                    {9880}let (=OpenSecureChannelRequest,=pkCli_8790,wNc_8795: bitstring) = m1_8794 in
                                    {9881}let Nc_8796: bitstring = dec(wNc_8795,skSess_8461) in
                                    {9882}new Ns_8797: bitstring;
                                    {9883}new ST_8798: bitstring;
                                    {9884}new TTL_8799: bitstring;
                                    {9885}let wNs_8800: bitstring = enc(Ns_8797,pkCli_8790) in
                                    {9886}let m2_8801: bitstring = (OpenSecureChannelResponse,wNs_8800,ST_8798,TTL_8799) in
                                    {9887}out(c, m2_8801);
                                    {9888}let Ksrv_8802: bitstring = h((Ns_8797,Nc_8796)) in
                                    {9889}out(c, senc(mSrv(pkCli_8790,pkSess_8462),Ksrv_8802))
                                )
                                else
                                    {9890}let v_8803: bool = (Disco_5600 = B) in
                                    (
                                        {9891}if v_8803 then
                                        (
                                            {9892}let pkDisco_8804: bitstring = pub(skB) in
                                            {9893}in(c, (=pkCli_8790,em1_8805: bitstring));
                                            {9894}let m1_8806: bitstring = em1_8805 in
                                            {9895}let (=OpenSecureChannelRequest,=pkCli_8790,wNc_8807: bitstring) = m1_8806 in
                                            {9896}let Nc_8808: bitstring = dec(wNc_8807,skSess_8461) in
                                            {9897}new Ns_8809: bitstring;
                                            {9898}new ST_8810: bitstring;
                                            {9899}new TTL_8811: bitstring;
                                            {9900}let wNs_8812: bitstring = enc(Ns_8809,pkCli_8790) in
                                            {9901}let m2_8813: bitstring = (OpenSecureChannelResponse,wNs_8812,ST_8810,TTL_8811) in
                                            {9902}out(c, m2_8813);
                                            {9903}let Ksrv_8814: bitstring = h((Ns_8809,Nc_8808)) in
                                            {9904}out(c, senc(mSrv(pkCli_8790,pkSess_8462),Ksrv_8814))
                                        )
                                        else
                                            {9905}let v_8815: bool = (Disco_5600 = C) in
                                            (
                                                {9906}if v_8815 then
                                                (
                                                    {9907}let pkDisco_8816: bitstring = pub(skC) in
                                                    {9908}in(c, (=pkCli_8790,em1_8817: bitstring));
                                                    {9909}let m1_8818: bitstring = em1_8817 in
                                                    {9910}let (=OpenSecureChannelRequest,=pkCli_8790,wNc_8819: bitstring) = m1_8818 in
                                                    {9911}let Nc_8820: bitstring = dec(wNc_8819,skSess_8461) in
                                                    {9912}new Ns_8821: bitstring;
                                                    {9913}new ST_8822: bitstring;
                                                    {9914}new TTL_8823: bitstring;
                                                    {9915}let wNs_8824: bitstring = enc(Ns_8821,pkCli_8790) in
                                                    {9916}let m2_8825: bitstring = (OpenSecureChannelResponse,wNs_8824,ST_8822,TTL_8823) in
                                                    {9917}out(c, m2_8825);
                                                    {9918}let Ksrv_8826: bitstring = h((Ns_8821,Nc_8820)) in
                                                    {9919}out(c, senc(mSrv(pkCli_8790,pkSess_8462),Ksrv_8826))
                                                )
                                                else
                                                    {9920}let pkDisco_8827: bitstring = pub(sk(Disco_5600)) in
                                                    {9921}in(c, (=pkCli_8790,em1_8828: bitstring));
                                                    {9922}let m1_8829: bitstring = em1_8828 in
                                                    {9923}let (=OpenSecureChannelRequest,=pkCli_8790,wNc_8830: bitstring) = m1_8829 in
                                                    {9924}let Nc_8831: bitstring = dec(wNc_8830,skSess_8461) in
                                                    {9925}new Ns_8832: bitstring;
                                                    {9926}new ST_8833: bitstring;
                                                    {9927}new TTL_8834: bitstring;
                                                    {9928}let wNs_8835: bitstring = enc(Ns_8832,pkCli_8790) in
                                                    {9929}let m2_8836: bitstring = (OpenSecureChannelResponse,wNs_8835,ST_8833,TTL_8834) in
                                                    {9930}out(c, m2_8836);
                                                    {9931}let Ksrv_8837: bitstring = h((Ns_8832,Nc_8831)) in
                                                    {9932}out(c, senc(mSrv(pkCli_8790,pkSess_8462),Ksrv_8837))
                                            )
                                            else
                                                {9933}let pkDisco_8838: bitstring = fail-any in
                                                {9934}in(c, (=pkCli_8790,em1_8839: bitstring));
                                                {9935}let m1_8840: bitstring = em1_8839 in
                                                {9936}let (=OpenSecureChannelRequest,=pkCli_8790,wNc_8841: bitstring) = m1_8840 in
                                                {9937}let Nc_8842: bitstring = dec(wNc_8841,skSess_8461) in
                                                {9938}new Ns_8843: bitstring;
                                                {9939}new ST_8844: bitstring;
                                                {9940}new TTL_8845: bitstring;
                                                {9941}let wNs_8846: bitstring = enc(Ns_8843,pkCli_8790) in
                                                {9942}let m2_8847: bitstring = (OpenSecureChannelResponse,wNs_8846,ST_8844,TTL_8845) in
                                                {9943}out(c, m2_8847);
                                                {9944}let Ksrv_8848: bitstring = h((Ns_8843,Nc_8842)) in
                                                {9945}out(c, senc(mSrv(pkCli_8790,pkSess_8462),Ksrv_8848))
                                    )
                                    else
                                        {9946}let pkDisco_8849: bitstring = fail-any in
                                        {9947}in(c, (=pkCli_8790,em1_8850: bitstring));
                                        {9948}let m1_8851: bitstring = em1_8850 in
                                        {9949}let (=OpenSecureChannelRequest,=pkCli_8790,wNc_8852: bitstring) = m1_8851 in
                                        {9950}let Nc_8853: bitstring = dec(wNc_8852,skSess_8461) in
                                        {9951}new Ns_8854: bitstring;
                                        {9952}new ST_8855: bitstring;
                                        {9953}new TTL_8856: bitstring;
                                        {9954}let wNs_8857: bitstring = enc(Ns_8854,pkCli_8790) in
                                        {9955}let m2_8858: bitstring = (OpenSecureChannelResponse,wNs_8857,ST_8855,TTL_8856) in
                                        {9956}out(c, m2_8858);
                                        {9957}let Ksrv_8859: bitstring = h((Ns_8854,Nc_8853)) in
                                        {9958}out(c, senc(mSrv(pkCli_8790,pkSess_8462),Ksrv_8859))
                            )
                            else
                                {9959}let pkDisco_8860: bitstring = fail-any in
                                {9960}in(c, (=pkCli_8790,em1_8861: bitstring));
                                {9961}let m1_8862: bitstring = em1_8861 in
                                {9962}let (=OpenSecureChannelRequest,=pkCli_8790,wNc_8863: bitstring) = m1_8862 in
                                {9963}let Nc_8864: bitstring = dec(wNc_8863,skSess_8461) in
                                {9964}new Ns_8865: bitstring;
                                {9965}new ST_8866: bitstring;
                                {9966}new TTL_8867: bitstring;
                                {9967}let wNs_8868: bitstring = enc(Ns_8865,pkCli_8790) in
                                {9968}let m2_8869: bitstring = (OpenSecureChannelResponse,wNs_8868,ST_8866,TTL_8867) in
                                {9969}out(c, m2_8869);
                                {9970}let Ksrv_8870: bitstring = h((Ns_8865,Nc_8864)) in
                                {9971}out(c, senc(mSrv(pkCli_8790,pkSess_8462),Ksrv_8870))
                )
                else
                    {9972}let pkCli_8871: bitstring = fail-any in
                    {9973}let v_8872: bool = (Disco_5600 = A) in
                    (
                        {9974}if v_8872 then
                        (
                            {9975}let pkDisco_8873: bitstring = pub(skA) in
                            {9976}in(c, (=pkCli_8871,em1_8874: bitstring));
                            {9977}let m1_8875: bitstring = em1_8874 in
                            {9978}let (=OpenSecureChannelRequest,=pkCli_8871,wNc_8876: bitstring) = m1_8875 in
                            {9979}let Nc_8877: bitstring = dec(wNc_8876,skSess_8461) in
                            {9980}new Ns_8878: bitstring;
                            {9981}new ST_8879: bitstring;
                            {9982}new TTL_8880: bitstring;
                            {9983}let wNs_8881: bitstring = enc(Ns_8878,pkCli_8871) in
                            {9984}let m2_8882: bitstring = (OpenSecureChannelResponse,wNs_8881,ST_8879,TTL_8880) in
                            {9985}out(c, m2_8882);
                            {9986}let Ksrv_8883: bitstring = h((Ns_8878,Nc_8877)) in
                            {9987}out(c, senc(mSrv(pkCli_8871,pkSess_8462),Ksrv_8883))
                        )
                        else
                            {9988}let v_8884: bool = (Disco_5600 = B) in
                            (
                                {9989}if v_8884 then
                                (
                                    {9990}let pkDisco_8885: bitstring = pub(skB) in
                                    {9991}in(c, (=pkCli_8871,em1_8886: bitstring));
                                    {9992}let m1_8887: bitstring = em1_8886 in
                                    {9993}let (=OpenSecureChannelRequest,=pkCli_8871,wNc_8888: bitstring) = m1_8887 in
                                    {9994}let Nc_8889: bitstring = dec(wNc_8888,skSess_8461) in
                                    {9995}new Ns_8890: bitstring;
                                    {9996}new ST_8891: bitstring;
                                    {9997}new TTL_8892: bitstring;
                                    {9998}let wNs_8893: bitstring = enc(Ns_8890,pkCli_8871) in
                                    {9999}let m2_8894: bitstring = (OpenSecureChannelResponse,wNs_8893,ST_8891,TTL_8892) in
                                    {10000}out(c, m2_8894);
                                    {10001}let Ksrv_8895: bitstring = h((Ns_8890,Nc_8889)) in
                                    {10002}out(c, senc(mSrv(pkCli_8871,pkSess_8462),Ksrv_8895))
                                )
                                else
                                    {10003}let v_8896: bool = (Disco_5600 = C) in
                                    (
                                        {10004}if v_8896 then
                                        (
                                            {10005}let pkDisco_8897: bitstring = pub(skC) in
                                            {10006}in(c, (=pkCli_8871,em1_8898: bitstring));
                                            {10007}let m1_8899: bitstring = em1_8898 in
                                            {10008}let (=OpenSecureChannelRequest,=pkCli_8871,wNc_8900: bitstring) = m1_8899 in
                                            {10009}let Nc_8901: bitstring = dec(wNc_8900,skSess_8461) in
                                            {10010}new Ns_8902: bitstring;
                                            {10011}new ST_8903: bitstring;
                                            {10012}new TTL_8904: bitstring;
                                            {10013}let wNs_8905: bitstring = enc(Ns_8902,pkCli_8871) in
                                            {10014}let m2_8906: bitstring = (OpenSecureChannelResponse,wNs_8905,ST_8903,TTL_8904) in
                                            {10015}out(c, m2_8906);
                                            {10016}let Ksrv_8907: bitstring = h((Ns_8902,Nc_8901)) in
                                            {10017}out(c, senc(mSrv(pkCli_8871,pkSess_8462),Ksrv_8907))
                                        )
                                        else
                                            {10018}let pkDisco_8908: bitstring = pub(sk(Disco_5600)) in
                                            {10019}in(c, (=pkCli_8871,em1_8909: bitstring));
                                            {10020}let m1_8910: bitstring = em1_8909 in
                                            {10021}let (=OpenSecureChannelRequest,=pkCli_8871,wNc_8911: bitstring) = m1_8910 in
                                            {10022}let Nc_8912: bitstring = dec(wNc_8911,skSess_8461) in
                                            {10023}new Ns_8913: bitstring;
                                            {10024}new ST_8914: bitstring;
                                            {10025}new TTL_8915: bitstring;
                                            {10026}let wNs_8916: bitstring = enc(Ns_8913,pkCli_8871) in
                                            {10027}let m2_8917: bitstring = (OpenSecureChannelResponse,wNs_8916,ST_8914,TTL_8915) in
                                            {10028}out(c, m2_8917);
                                            {10029}let Ksrv_8918: bitstring = h((Ns_8913,Nc_8912)) in
                                            {10030}out(c, senc(mSrv(pkCli_8871,pkSess_8462),Ksrv_8918))
                                    )
                                    else
                                        {10031}let pkDisco_8919: bitstring = fail-any in
                                        {10032}in(c, (=pkCli_8871,em1_8920: bitstring));
                                        {10033}let m1_8921: bitstring = em1_8920 in
                                        {10034}let (=OpenSecureChannelRequest,=pkCli_8871,wNc_8922: bitstring) = m1_8921 in
                                        {10035}let Nc_8923: bitstring = dec(wNc_8922,skSess_8461) in
                                        {10036}new Ns_8924: bitstring;
                                        {10037}new ST_8925: bitstring;
                                        {10038}new TTL_8926: bitstring;
                                        {10039}let wNs_8927: bitstring = enc(Ns_8924,pkCli_8871) in
                                        {10040}let m2_8928: bitstring = (OpenSecureChannelResponse,wNs_8927,ST_8925,TTL_8926) in
                                        {10041}out(c, m2_8928);
                                        {10042}let Ksrv_8929: bitstring = h((Ns_8924,Nc_8923)) in
                                        {10043}out(c, senc(mSrv(pkCli_8871,pkSess_8462),Ksrv_8929))
                            )
                            else
                                {10044}let pkDisco_8930: bitstring = fail-any in
                                {10045}in(c, (=pkCli_8871,em1_8931: bitstring));
                                {10046}let m1_8932: bitstring = em1_8931 in
                                {10047}let (=OpenSecureChannelRequest,=pkCli_8871,wNc_8933: bitstring) = m1_8932 in
                                {10048}let Nc_8934: bitstring = dec(wNc_8933,skSess_8461) in
                                {10049}new Ns_8935: bitstring;
                                {10050}new ST_8936: bitstring;
                                {10051}new TTL_8937: bitstring;
                                {10052}let wNs_8938: bitstring = enc(Ns_8935,pkCli_8871) in
                                {10053}let m2_8939: bitstring = (OpenSecureChannelResponse,wNs_8938,ST_8936,TTL_8937) in
                                {10054}out(c, m2_8939);
                                {10055}let Ksrv_8940: bitstring = h((Ns_8935,Nc_8934)) in
                                {10056}out(c, senc(mSrv(pkCli_8871,pkSess_8462),Ksrv_8940))
                    )
                    else
                        {10057}let pkDisco_8941: bitstring = fail-any in
                        {10058}in(c, (=pkCli_8871,em1_8942: bitstring));
                        {10059}let m1_8943: bitstring = em1_8942 in
                        {10060}let (=OpenSecureChannelRequest,=pkCli_8871,wNc_8944: bitstring) = m1_8943 in
                        {10061}let Nc_8945: bitstring = dec(wNc_8944,skSess_8461) in
                        {10062}new Ns_8946: bitstring;
                        {10063}new ST_8947: bitstring;
                        {10064}new TTL_8948: bitstring;
                        {10065}let wNs_8949: bitstring = enc(Ns_8946,pkCli_8871) in
                        {10066}let m2_8950: bitstring = (OpenSecureChannelResponse,wNs_8949,ST_8947,TTL_8948) in
                        {10067}out(c, m2_8950);
                        {10068}let Ksrv_8951: bitstring = h((Ns_8946,Nc_8945)) in
                        {10069}out(c, senc(mSrv(pkCli_8871,pkSess_8462),Ksrv_8951))
        )
        else
            {10070}let pkCli_8952: bitstring = fail-any in
            {10071}let v_8953: bool = (Disco_5600 = A) in
            (
                {10072}if v_8953 then
                (
                    {10073}let pkDisco_8954: bitstring = pub(skA) in
                    {10074}in(c, (=pkCli_8952,em1_8955: bitstring));
                    {10075}let m1_8956: bitstring = em1_8955 in
                    {10076}let (=OpenSecureChannelRequest,=pkCli_8952,wNc_8957: bitstring) = m1_8956 in
                    {10077}let Nc_8958: bitstring = dec(wNc_8957,skSess_8461) in
                    {10078}new Ns_8959: bitstring;
                    {10079}new ST_8960: bitstring;
                    {10080}new TTL_8961: bitstring;
                    {10081}let wNs_8962: bitstring = enc(Ns_8959,pkCli_8952) in
                    {10082}let m2_8963: bitstring = (OpenSecureChannelResponse,wNs_8962,ST_8960,TTL_8961) in
                    {10083}out(c, m2_8963);
                    {10084}let Ksrv_8964: bitstring = h((Ns_8959,Nc_8958)) in
                    {10085}out(c, senc(mSrv(pkCli_8952,pkSess_8462),Ksrv_8964))
                )
                else
                    {10086}let v_8965: bool = (Disco_5600 = B) in
                    (
                        {10087}if v_8965 then
                        (
                            {10088}let pkDisco_8966: bitstring = pub(skB) in
                            {10089}in(c, (=pkCli_8952,em1_8967: bitstring));
                            {10090}let m1_8968: bitstring = em1_8967 in
                            {10091}let (=OpenSecureChannelRequest,=pkCli_8952,wNc_8969: bitstring) = m1_8968 in
                            {10092}let Nc_8970: bitstring = dec(wNc_8969,skSess_8461) in
                            {10093}new Ns_8971: bitstring;
                            {10094}new ST_8972: bitstring;
                            {10095}new TTL_8973: bitstring;
                            {10096}let wNs_8974: bitstring = enc(Ns_8971,pkCli_8952) in
                            {10097}let m2_8975: bitstring = (OpenSecureChannelResponse,wNs_8974,ST_8972,TTL_8973) in
                            {10098}out(c, m2_8975);
                            {10099}let Ksrv_8976: bitstring = h((Ns_8971,Nc_8970)) in
                            {10100}out(c, senc(mSrv(pkCli_8952,pkSess_8462),Ksrv_8976))
                        )
                        else
                            {10101}let v_8977: bool = (Disco_5600 = C) in
                            (
                                {10102}if v_8977 then
                                (
                                    {10103}let pkDisco_8978: bitstring = pub(skC) in
                                    {10104}in(c, (=pkCli_8952,em1_8979: bitstring));
                                    {10105}let m1_8980: bitstring = em1_8979 in
                                    {10106}let (=OpenSecureChannelRequest,=pkCli_8952,wNc_8981: bitstring) = m1_8980 in
                                    {10107}let Nc_8982: bitstring = dec(wNc_8981,skSess_8461) in
                                    {10108}new Ns_8983: bitstring;
                                    {10109}new ST_8984: bitstring;
                                    {10110}new TTL_8985: bitstring;
                                    {10111}let wNs_8986: bitstring = enc(Ns_8983,pkCli_8952) in
                                    {10112}let m2_8987: bitstring = (OpenSecureChannelResponse,wNs_8986,ST_8984,TTL_8985) in
                                    {10113}out(c, m2_8987);
                                    {10114}let Ksrv_8988: bitstring = h((Ns_8983,Nc_8982)) in
                                    {10115}out(c, senc(mSrv(pkCli_8952,pkSess_8462),Ksrv_8988))
                                )
                                else
                                    {10116}let pkDisco_8989: bitstring = pub(sk(Disco_5600)) in
                                    {10117}in(c, (=pkCli_8952,em1_8990: bitstring));
                                    {10118}let m1_8991: bitstring = em1_8990 in
                                    {10119}let (=OpenSecureChannelRequest,=pkCli_8952,wNc_8992: bitstring) = m1_8991 in
                                    {10120}let Nc_8993: bitstring = dec(wNc_8992,skSess_8461) in
                                    {10121}new Ns_8994: bitstring;
                                    {10122}new ST_8995: bitstring;
                                    {10123}new TTL_8996: bitstring;
                                    {10124}let wNs_8997: bitstring = enc(Ns_8994,pkCli_8952) in
                                    {10125}let m2_8998: bitstring = (OpenSecureChannelResponse,wNs_8997,ST_8995,TTL_8996) in
                                    {10126}out(c, m2_8998);
                                    {10127}let Ksrv_8999: bitstring = h((Ns_8994,Nc_8993)) in
                                    {10128}out(c, senc(mSrv(pkCli_8952,pkSess_8462),Ksrv_8999))
                            )
                            else
                                {10129}let pkDisco_9000: bitstring = fail-any in
                                {10130}in(c, (=pkCli_8952,em1_9001: bitstring));
                                {10131}let m1_9002: bitstring = em1_9001 in
                                {10132}let (=OpenSecureChannelRequest,=pkCli_8952,wNc_9003: bitstring) = m1_9002 in
                                {10133}let Nc_9004: bitstring = dec(wNc_9003,skSess_8461) in
                                {10134}new Ns_9005: bitstring;
                                {10135}new ST_9006: bitstring;
                                {10136}new TTL_9007: bitstring;
                                {10137}let wNs_9008: bitstring = enc(Ns_9005,pkCli_8952) in
                                {10138}let m2_9009: bitstring = (OpenSecureChannelResponse,wNs_9008,ST_9006,TTL_9007) in
                                {10139}out(c, m2_9009);
                                {10140}let Ksrv_9010: bitstring = h((Ns_9005,Nc_9004)) in
                                {10141}out(c, senc(mSrv(pkCli_8952,pkSess_8462),Ksrv_9010))
                    )
                    else
                        {10142}let pkDisco_9011: bitstring = fail-any in
                        {10143}in(c, (=pkCli_8952,em1_9012: bitstring));
                        {10144}let m1_9013: bitstring = em1_9012 in
                        {10145}let (=OpenSecureChannelRequest,=pkCli_8952,wNc_9014: bitstring) = m1_9013 in
                        {10146}let Nc_9015: bitstring = dec(wNc_9014,skSess_8461) in
                        {10147}new Ns_9016: bitstring;
                        {10148}new ST_9017: bitstring;
                        {10149}new TTL_9018: bitstring;
                        {10150}let wNs_9019: bitstring = enc(Ns_9016,pkCli_8952) in
                        {10151}let m2_9020: bitstring = (OpenSecureChannelResponse,wNs_9019,ST_9017,TTL_9018) in
                        {10152}out(c, m2_9020);
                        {10153}let Ksrv_9021: bitstring = h((Ns_9016,Nc_9015)) in
                        {10154}out(c, senc(mSrv(pkCli_8952,pkSess_8462),Ksrv_9021))
            )
            else
                {10155}let pkDisco_9022: bitstring = fail-any in
                {10156}in(c, (=pkCli_8952,em1_9023: bitstring));
                {10157}let m1_9024: bitstring = em1_9023 in
                {10158}let (=OpenSecureChannelRequest,=pkCli_8952,wNc_9025: bitstring) = m1_9024 in
                {10159}let Nc_9026: bitstring = dec(wNc_9025,skSess_8461) in
                {10160}new Ns_9027: bitstring;
                {10161}new ST_9028: bitstring;
                {10162}new TTL_9029: bitstring;
                {10163}let wNs_9030: bitstring = enc(Ns_9027,pkCli_8952) in
                {10164}let m2_9031: bitstring = (OpenSecureChannelResponse,wNs_9030,ST_9028,TTL_9029) in
                {10165}out(c, m2_9031);
                {10166}let Ksrv_9032: bitstring = h((Ns_9027,Nc_9026)) in
                {10167}out(c, senc(mSrv(pkCli_8952,pkSess_8462),Ksrv_9032))
)

-- Query not attacker(mSrv(pub(skA[]),pub(skC[])))
Completing...
200 rules inserted. The rule base contains 124 rules. 484 rules in the queue.
400 rules inserted. The rule base contains 161 rules. 484 rules in the queue.
600 rules inserted. The rule base contains 220 rules. 484 rules in the queue.
800 rules inserted. The rule base contains 220 rules. 482 rules in the queue.
1000 rules inserted. The rule base contains 228 rules. 482 rules in the queue.
1200 rules inserted. The rule base contains 240 rules. 472 rules in the queue.
1400 rules inserted. The rule base contains 239 rules. 456 rules in the queue.
1600 rules inserted. The rule base contains 200 rules. 456 rules in the queue.
1800 rules inserted. The rule base contains 264 rules. 456 rules in the queue.
2000 rules inserted. The rule base contains 282 rules. 640 rules in the queue.
2200 rules inserted. The rule base contains 336 rules. 874 rules in the queue.
2400 rules inserted. The rule base contains 418 rules. 1254 rules in the queue.
2600 rules inserted. The rule base contains 487 rules. 1649 rules in the queue.
2800 rules inserted. The rule base contains 532 rules. 2158 rules in the queue.
3000 rules inserted. The rule base contains 574 rules. 2217 rules in the queue.
3200 rules inserted. The rule base contains 638 rules. 2271 rules in the queue.
3400 rules inserted. The rule base contains 699 rules. 2292 rules in the queue.
3600 rules inserted. The rule base contains 749 rules. 2315 rules in the queue.
3800 rules inserted. The rule base contains 816 rules. 2367 rules in the queue.
4000 rules inserted. The rule base contains 862 rules. 2358 rules in the queue.
4200 rules inserted. The rule base contains 914 rules. 2386 rules in the queue.
4400 rules inserted. The rule base contains 966 rules. 2413 rules in the queue.
4600 rules inserted. The rule base contains 1014 rules. 2473 rules in the queue.
4800 rules inserted. The rule base contains 1065 rules. 2532 rules in the queue.
5000 rules inserted. The rule base contains 1114 rules. 2528 rules in the queue.
5200 rules inserted. The rule base contains 1129 rules. 2523 rules in the queue.
5400 rules inserted. The rule base contains 1152 rules. 2517 rules in the queue.
5600 rules inserted. The rule base contains 1179 rules. 2507 rules in the queue.
5800 rules inserted. The rule base contains 1188 rules. 2501 rules in the queue.
6000 rules inserted. The rule base contains 1216 rules. 2490 rules in the queue.
6200 rules inserted. The rule base contains 1236 rules. 2484 rules in the queue.
6400 rules inserted. The rule base contains 1237 rules. 2474 rules in the queue.
6600 rules inserted. The rule base contains 1261 rules. 2472 rules in the queue.
6800 rules inserted. The rule base contains 1271 rules. 2469 rules in the queue.
7000 rules inserted. The rule base contains 1291 rules. 2466 rules in the queue.
7200 rules inserted. The rule base contains 1300 rules. 2463 rules in the queue.
7400 rules inserted. The rule base contains 1328 rules. 2461 rules in the queue.
7600 rules inserted. The rule base contains 1327 rules. 2459 rules in the queue.
7800 rules inserted. The rule base contains 1313 rules. 2455 rules in the queue.
8000 rules inserted. The rule base contains 1305 rules. 2453 rules in the queue.
8200 rules inserted. The rule base contains 1303 rules. 2449 rules in the queue.
8400 rules inserted. The rule base contains 1288 rules. 2447 rules in the queue.
8600 rules inserted. The rule base contains 1287 rules. 2443 rules in the queue.
8800 rules inserted. The rule base contains 1275 rules. 2441 rules in the queue.
9000 rules inserted. The rule base contains 1270 rules. 2433 rules in the queue.
9200 rules inserted. The rule base contains 1267 rules. 2425 rules in the queue.
9400 rules inserted. The rule base contains 1262 rules. 2420 rules in the queue.
9600 rules inserted. The rule base contains 1258 rules. 2411 rules in the queue.
9800 rules inserted. The rule base contains 1250 rules. 2406 rules in the queue.
10000 rules inserted. The rule base contains 1241 rules. 2396 rules in the queue.
10200 rules inserted. The rule base contains 1263 rules. 2390 rules in the queue.
10400 rules inserted. The rule base contains 1255 rules. 2386 rules in the queue.
10600 rules inserted. The rule base contains 1250 rules. 2379 rules in the queue.
10800 rules inserted. The rule base contains 1268 rules. 2374 rules in the queue.
11000 rules inserted. The rule base contains 1259 rules. 2367 rules in the queue.
11200 rules inserted. The rule base contains 1264 rules. 2362 rules in the queue.
11400 rules inserted. The rule base contains 1293 rules. 2355 rules in the queue.
11600 rules inserted. The rule base contains 1298 rules. 2350 rules in the queue.
11800 rules inserted. The rule base contains 1294 rules. 2347 rules in the queue.
12000 rules inserted. The rule base contains 1299 rules. 2343 rules in the queue.
12200 rules inserted. The rule base contains 1298 rules. 2339 rules in the queue.
12400 rules inserted. The rule base contains 1304 rules. 2336 rules in the queue.
12600 rules inserted. The rule base contains 1383 rules. 2308 rules in the queue.
12800 rules inserted. The rule base contains 1429 rules. 2298 rules in the queue.
13000 rules inserted. The rule base contains 1491 rules. 2309 rules in the queue.
13200 rules inserted. The rule base contains 1563 rules. 2280 rules in the queue.
13400 rules inserted. The rule base contains 1614 rules. 2293 rules in the queue.
13600 rules inserted. The rule base contains 1699 rules. 2264 rules in the queue.
13800 rules inserted. The rule base contains 1762 rules. 2261 rules in the queue.
14000 rules inserted. The rule base contains 1824 rules. 2241 rules in the queue.
14200 rules inserted. The rule base contains 1883 rules. 2215 rules in the queue.
14400 rules inserted. The rule base contains 1952 rules. 2194 rules in the queue.
14600 rules inserted. The rule base contains 2001 rules. 2184 rules in the queue.
14800 rules inserted. The rule base contains 2081 rules. 2142 rules in the queue.
15000 rules inserted. The rule base contains 2194 rules. 2080 rules in the queue.
15200 rules inserted. The rule base contains 2251 rules. 1968 rules in the queue.
15400 rules inserted. The rule base contains 2354 rules. 1916 rules in the queue.
15600 rules inserted. The rule base contains 2404 rules. 1800 rules in the queue.
15800 rules inserted. The rule base contains 2505 rules. 1736 rules in the queue.
16000 rules inserted. The rule base contains 2564 rules. 1609 rules in the queue.
16200 rules inserted. The rule base contains 2661 rules. 1553 rules in the queue.
16400 rules inserted. The rule base contains 2759 rules. 1495 rules in the queue.
16600 rules inserted. The rule base contains 2865 rules. 1426 rules in the queue.
16800 rules inserted. The rule base contains 2966 rules. 1363 rules in the queue.
17000 rules inserted. The rule base contains 3105 rules. 1285 rules in the queue.
17200 rules inserted. The rule base contains 3248 rules. 1210 rules in the queue.
17400 rules inserted. The rule base contains 3393 rules. 1131 rules in the queue.
17600 rules inserted. The rule base contains 3547 rules. 1049 rules in the queue.
17800 rules inserted. The rule base contains 3691 rules. 972 rules in the queue.
18000 rules inserted. The rule base contains 3835 rules. 895 rules in the queue.
18200 rules inserted. The rule base contains 3979 rules. 818 rules in the queue.
18400 rules inserted. The rule base contains 4167 rules. 678 rules in the queue.
18600 rules inserted. The rule base contains 4355 rules. 537 rules in the queue.
18800 rules inserted. The rule base contains 4543 rules. 397 rules in the queue.
19000 rules inserted. The rule base contains 4731 rules. 256 rules in the queue.
19200 rules inserted. The rule base contains 4931 rules. 77 rules in the queue.
Starting query not attacker(mSrv(pub(skA[]),pub(skC[])))
RESULT not attacker(mSrv(pub(skA[]),pub(skC[]))) is true.
-- Query not attacker(mCli(pub(skA[]),pub(skC[])))
Completing...
200 rules inserted. The rule base contains 124 rules. 484 rules in the queue.
400 rules inserted. The rule base contains 161 rules. 484 rules in the queue.
600 rules inserted. The rule base contains 220 rules. 484 rules in the queue.
800 rules inserted. The rule base contains 220 rules. 482 rules in the queue.
1000 rules inserted. The rule base contains 228 rules. 482 rules in the queue.
1200 rules inserted. The rule base contains 240 rules. 472 rules in the queue.
1400 rules inserted. The rule base contains 239 rules. 456 rules in the queue.
1600 rules inserted. The rule base contains 200 rules. 456 rules in the queue.
1800 rules inserted. The rule base contains 264 rules. 456 rules in the queue.
2000 rules inserted. The rule base contains 282 rules. 640 rules in the queue.
2200 rules inserted. The rule base contains 336 rules. 874 rules in the queue.
2400 rules inserted. The rule base contains 418 rules. 1254 rules in the queue.
2600 rules inserted. The rule base contains 487 rules. 1649 rules in the queue.
2800 rules inserted. The rule base contains 532 rules. 2158 rules in the queue.
3000 rules inserted. The rule base contains 574 rules. 2217 rules in the queue.
3200 rules inserted. The rule base contains 638 rules. 2271 rules in the queue.
3400 rules inserted. The rule base contains 699 rules. 2292 rules in the queue.
3600 rules inserted. The rule base contains 749 rules. 2315 rules in the queue.
3800 rules inserted. The rule base contains 816 rules. 2367 rules in the queue.
4000 rules inserted. The rule base contains 862 rules. 2358 rules in the queue.
4200 rules inserted. The rule base contains 914 rules. 2386 rules in the queue.
4400 rules inserted. The rule base contains 966 rules. 2413 rules in the queue.
4600 rules inserted. The rule base contains 1014 rules. 2473 rules in the queue.
4800 rules inserted. The rule base contains 1065 rules. 2532 rules in the queue.
5000 rules inserted. The rule base contains 1114 rules. 2528 rules in the queue.
5200 rules inserted. The rule base contains 1129 rules. 2523 rules in the queue.
5400 rules inserted. The rule base contains 1152 rules. 2517 rules in the queue.
5600 rules inserted. The rule base contains 1179 rules. 2507 rules in the queue.
5800 rules inserted. The rule base contains 1188 rules. 2501 rules in the queue.
6000 rules inserted. The rule base contains 1216 rules. 2490 rules in the queue.
6200 rules inserted. The rule base contains 1236 rules. 2484 rules in the queue.
6400 rules inserted. The rule base contains 1237 rules. 2474 rules in the queue.
6600 rules inserted. The rule base contains 1261 rules. 2472 rules in the queue.
6800 rules inserted. The rule base contains 1271 rules. 2469 rules in the queue.
7000 rules inserted. The rule base contains 1291 rules. 2466 rules in the queue.
7200 rules inserted. The rule base contains 1300 rules. 2463 rules in the queue.
7400 rules inserted. The rule base contains 1328 rules. 2461 rules in the queue.
7600 rules inserted. The rule base contains 1327 rules. 2459 rules in the queue.
7800 rules inserted. The rule base contains 1313 rules. 2455 rules in the queue.
8000 rules inserted. The rule base contains 1305 rules. 2453 rules in the queue.
8200 rules inserted. The rule base contains 1303 rules. 2449 rules in the queue.
8400 rules inserted. The rule base contains 1288 rules. 2447 rules in the queue.
8600 rules inserted. The rule base contains 1287 rules. 2443 rules in the queue.
8800 rules inserted. The rule base contains 1275 rules. 2441 rules in the queue.
9000 rules inserted. The rule base contains 1270 rules. 2433 rules in the queue.
9200 rules inserted. The rule base contains 1267 rules. 2425 rules in the queue.
9400 rules inserted. The rule base contains 1262 rules. 2420 rules in the queue.
9600 rules inserted. The rule base contains 1258 rules. 2411 rules in the queue.
9800 rules inserted. The rule base contains 1250 rules. 2406 rules in the queue.
10000 rules inserted. The rule base contains 1241 rules. 2396 rules in the queue.
10200 rules inserted. The rule base contains 1263 rules. 2390 rules in the queue.
10400 rules inserted. The rule base contains 1255 rules. 2386 rules in the queue.
10600 rules inserted. The rule base contains 1250 rules. 2379 rules in the queue.
10800 rules inserted. The rule base contains 1268 rules. 2374 rules in the queue.
11000 rules inserted. The rule base contains 1259 rules. 2367 rules in the queue.
11200 rules inserted. The rule base contains 1264 rules. 2362 rules in the queue.
11400 rules inserted. The rule base contains 1293 rules. 2355 rules in the queue.
11600 rules inserted. The rule base contains 1298 rules. 2350 rules in the queue.
11800 rules inserted. The rule base contains 1294 rules. 2347 rules in the queue.
12000 rules inserted. The rule base contains 1299 rules. 2343 rules in the queue.
12200 rules inserted. The rule base contains 1298 rules. 2339 rules in the queue.
12400 rules inserted. The rule base contains 1304 rules. 2336 rules in the queue.
12600 rules inserted. The rule base contains 1383 rules. 2308 rules in the queue.
12800 rules inserted. The rule base contains 1429 rules. 2298 rules in the queue.
13000 rules inserted. The rule base contains 1491 rules. 2309 rules in the queue.
13200 rules inserted. The rule base contains 1563 rules. 2280 rules in the queue.
13400 rules inserted. The rule base contains 1614 rules. 2293 rules in the queue.
13600 rules inserted. The rule base contains 1699 rules. 2264 rules in the queue.
13800 rules inserted. The rule base contains 1762 rules. 2261 rules in the queue.
14000 rules inserted. The rule base contains 1824 rules. 2241 rules in the queue.
14200 rules inserted. The rule base contains 1883 rules. 2215 rules in the queue.
14400 rules inserted. The rule base contains 1952 rules. 2194 rules in the queue.
14600 rules inserted. The rule base contains 2001 rules. 2184 rules in the queue.
14800 rules inserted. The rule base contains 2081 rules. 2142 rules in the queue.
15000 rules inserted. The rule base contains 2194 rules. 2080 rules in the queue.
15200 rules inserted. The rule base contains 2251 rules. 1968 rules in the queue.
15400 rules inserted. The rule base contains 2354 rules. 1916 rules in the queue.
15600 rules inserted. The rule base contains 2404 rules. 1800 rules in the queue.
15800 rules inserted. The rule base contains 2505 rules. 1736 rules in the queue.
16000 rules inserted. The rule base contains 2564 rules. 1609 rules in the queue.
16200 rules inserted. The rule base contains 2661 rules. 1553 rules in the queue.
16400 rules inserted. The rule base contains 2759 rules. 1495 rules in the queue.
16600 rules inserted. The rule base contains 2865 rules. 1426 rules in the queue.
16800 rules inserted. The rule base contains 2966 rules. 1363 rules in the queue.
17000 rules inserted. The rule base contains 3105 rules. 1285 rules in the queue.
17200 rules inserted. The rule base contains 3248 rules. 1210 rules in the queue.
17400 rules inserted. The rule base contains 3393 rules. 1131 rules in the queue.
17600 rules inserted. The rule base contains 3547 rules. 1049 rules in the queue.
17800 rules inserted. The rule base contains 3691 rules. 972 rules in the queue.
18000 rules inserted. The rule base contains 3835 rules. 895 rules in the queue.
18200 rules inserted. The rule base contains 3979 rules. 818 rules in the queue.
18400 rules inserted. The rule base contains 4167 rules. 678 rules in the queue.
18600 rules inserted. The rule base contains 4355 rules. 537 rules in the queue.
18800 rules inserted. The rule base contains 4543 rules. 397 rules in the queue.
19000 rules inserted. The rule base contains 4731 rules. 256 rules in the queue.
19200 rules inserted. The rule base contains 4931 rules. 77 rules in the queue.
Starting query not attacker(mCli(pub(skA[]),pub(skC[])))
RESULT not attacker(mCli(pub(skA[]),pub(skC[]))) is true.
