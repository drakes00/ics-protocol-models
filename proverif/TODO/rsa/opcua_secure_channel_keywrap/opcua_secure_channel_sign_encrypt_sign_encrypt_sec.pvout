Linear part:
exp(exp(g,x_32),y) = exp(exp(g,y),x_32)
Completing equations...
Completed equations:
exp(exp(g,x_32),y) = exp(exp(g,y),x_32)
Convergent part:
Completing equations...
Completed equations:
Process:
{1}let pkA: bitstring = pub(skA) in
{2}out(c, pkA);
{3}let pkB: bitstring = pub(skB) in
{4}out(c, pkB);
{5}let pkC: bitstring = pub(skC) in
{6}out(c, pkC);
(
    {7}!
    {8}in(c, (Cli: host,Disco: host,Sess: host));
    {9}let v_519: bool = (Cli = A) in
    (
        {10}if v_519 then
        (
            {11}let skCli: bitstring = skA in
            {12}let pkCli: bitstring = pub(skCli) in
            {13}let v_520: bool = (Disco = A) in
            (
                {14}if v_520 then
                (
                    {15}let pkDisco: bitstring = pub(skA) in
                    {16}let v_521: bool = (Sess = A) in
                    (
                        {17}if v_521 then
                        (
                            {18}let pkSess: bitstring = pub(skA) in
                            {19}out(c, GetEndpointRequest);
                            {20}in(c, (=GetEndpointResponse,=pkSess,=SignAndEncrypt,SP: bitstring,UP: bitstring));
                            {21}new Nc: bitstring;
                            {22}let wNc: bitstring = enc(Nc,pkSess) in
                            {23}let m1: bitstring = (OpenSecureChannelRequest,pkCli,wNc) in
                            {24}out(c, (pkCli,enc(m1,pkSess),sign(h(m1),skCli)));
                            {25}in(c, (em2: bitstring,sigM2: bitstring));
                            {26}let m2: bitstring = dec(em2,skCli) in
                            {27}if (verify(h(m2),sigM2,pkSess) <> true) then
                                0
                            else
                                {28}let (=OpenSecureChannelResponse,wNs: bitstring,ST: bitstring,TTL: bitstring) = m2 in
                                {29}let Ns: bitstring = dec(wNs,skCli) in
                                {30}let Kcli: bitstring = h((Nc,Ns)) in
                                {31}out(c, senc(mCli(pkCli,pkSess),Kcli))
                        )
                        else
                            {32}let v_522: bool = (Sess = B) in
                            (
                                {33}if v_522 then
                                (
                                    {34}let pkSess_523: bitstring = pub(skB) in
                                    {35}out(c, GetEndpointRequest);
                                    {36}in(c, (=GetEndpointResponse,=pkSess_523,=SignAndEncrypt,SP_524: bitstring,UP_525: bitstring));
                                    {37}new Nc_526: bitstring;
                                    {38}let wNc_527: bitstring = enc(Nc_526,pkSess_523) in
                                    {39}let m1_528: bitstring = (OpenSecureChannelRequest,pkCli,wNc_527) in
                                    {40}out(c, (pkCli,enc(m1_528,pkSess_523),sign(h(m1_528),skCli)));
                                    {41}in(c, (em2_529: bitstring,sigM2_530: bitstring));
                                    {42}let m2_531: bitstring = dec(em2_529,skCli) in
                                    {43}if (verify(h(m2_531),sigM2_530,pkSess_523) <> true) then
                                        0
                                    else
                                        {44}let (=OpenSecureChannelResponse,wNs_532: bitstring,ST_533: bitstring,TTL_534: bitstring) = m2_531 in
                                        {45}let Ns_535: bitstring = dec(wNs_532,skCli) in
                                        {46}let Kcli_536: bitstring = h((Nc_526,Ns_535)) in
                                        {47}out(c, senc(mCli(pkCli,pkSess_523),Kcli_536))
                                )
                                else
                                    {48}let v_537: bool = (Sess = C) in
                                    (
                                        {49}if v_537 then
                                        (
                                            {50}let pkSess_538: bitstring = pub(skC) in
                                            {51}out(c, GetEndpointRequest);
                                            {52}in(c, (=GetEndpointResponse,=pkSess_538,=SignAndEncrypt,SP_539: bitstring,UP_540: bitstring));
                                            {53}new Nc_541: bitstring;
                                            {54}let wNc_542: bitstring = enc(Nc_541,pkSess_538) in
                                            {55}let m1_543: bitstring = (OpenSecureChannelRequest,pkCli,wNc_542) in
                                            {56}out(c, (pkCli,enc(m1_543,pkSess_538),sign(h(m1_543),skCli)));
                                            {57}in(c, (em2_544: bitstring,sigM2_545: bitstring));
                                            {58}let m2_546: bitstring = dec(em2_544,skCli) in
                                            {59}if (verify(h(m2_546),sigM2_545,pkSess_538) <> true) then
                                                0
                                            else
                                                {60}let (=OpenSecureChannelResponse,wNs_547: bitstring,ST_548: bitstring,TTL_549: bitstring) = m2_546 in
                                                {61}let Ns_550: bitstring = dec(wNs_547,skCli) in
                                                {62}let Kcli_551: bitstring = h((Nc_541,Ns_550)) in
                                                {63}out(c, senc(mCli(pkCli,pkSess_538),Kcli_551))
                                        )
                                        else
                                            {64}let pkSess_552: bitstring = pub(sk(Sess)) in
                                            {65}out(c, GetEndpointRequest);
                                            {66}in(c, (=GetEndpointResponse,=pkSess_552,=SignAndEncrypt,SP_553: bitstring,UP_554: bitstring));
                                            {67}new Nc_555: bitstring;
                                            {68}let wNc_556: bitstring = enc(Nc_555,pkSess_552) in
                                            {69}let m1_557: bitstring = (OpenSecureChannelRequest,pkCli,wNc_556) in
                                            {70}out(c, (pkCli,enc(m1_557,pkSess_552),sign(h(m1_557),skCli)));
                                            {71}in(c, (em2_558: bitstring,sigM2_559: bitstring));
                                            {72}let m2_560: bitstring = dec(em2_558,skCli) in
                                            {73}if (verify(h(m2_560),sigM2_559,pkSess_552) <> true) then
                                                0
                                            else
                                                {74}let (=OpenSecureChannelResponse,wNs_561: bitstring,ST_562: bitstring,TTL_563: bitstring) = m2_560 in
                                                {75}let Ns_564: bitstring = dec(wNs_561,skCli) in
                                                {76}let Kcli_565: bitstring = h((Nc_555,Ns_564)) in
                                                {77}out(c, senc(mCli(pkCli,pkSess_552),Kcli_565))
                                    )
                                    else
                                        {78}let pkSess_566: bitstring = fail-any in
                                        {79}out(c, GetEndpointRequest);
                                        {80}in(c, (=GetEndpointResponse,=pkSess_566,=SignAndEncrypt,SP_567: bitstring,UP_568: bitstring));
                                        {81}new Nc_569: bitstring;
                                        {82}let wNc_570: bitstring = enc(Nc_569,pkSess_566) in
                                        {83}let m1_571: bitstring = (OpenSecureChannelRequest,pkCli,wNc_570) in
                                        {84}out(c, (pkCli,enc(m1_571,pkSess_566),sign(h(m1_571),skCli)));
                                        {85}in(c, (em2_572: bitstring,sigM2_573: bitstring));
                                        {86}let m2_574: bitstring = dec(em2_572,skCli) in
                                        {87}if (verify(h(m2_574),sigM2_573,pkSess_566) <> true) then
                                            0
                                        else
                                            {88}let (=OpenSecureChannelResponse,wNs_575: bitstring,ST_576: bitstring,TTL_577: bitstring) = m2_574 in
                                            {89}let Ns_578: bitstring = dec(wNs_575,skCli) in
                                            {90}let Kcli_579: bitstring = h((Nc_569,Ns_578)) in
                                            {91}out(c, senc(mCli(pkCli,pkSess_566),Kcli_579))
                            )
                            else
                                {92}let pkSess_580: bitstring = fail-any in
                                {93}out(c, GetEndpointRequest);
                                {94}in(c, (=GetEndpointResponse,=pkSess_580,=SignAndEncrypt,SP_581: bitstring,UP_582: bitstring));
                                {95}new Nc_583: bitstring;
                                {96}let wNc_584: bitstring = enc(Nc_583,pkSess_580) in
                                {97}let m1_585: bitstring = (OpenSecureChannelRequest,pkCli,wNc_584) in
                                {98}out(c, (pkCli,enc(m1_585,pkSess_580),sign(h(m1_585),skCli)));
                                {99}in(c, (em2_586: bitstring,sigM2_587: bitstring));
                                {100}let m2_588: bitstring = dec(em2_586,skCli) in
                                {101}if (verify(h(m2_588),sigM2_587,pkSess_580) <> true) then
                                    0
                                else
                                    {102}let (=OpenSecureChannelResponse,wNs_589: bitstring,ST_590: bitstring,TTL_591: bitstring) = m2_588 in
                                    {103}let Ns_592: bitstring = dec(wNs_589,skCli) in
                                    {104}let Kcli_593: bitstring = h((Nc_583,Ns_592)) in
                                    {105}out(c, senc(mCli(pkCli,pkSess_580),Kcli_593))
                    )
                    else
                        {106}let pkSess_594: bitstring = fail-any in
                        {107}out(c, GetEndpointRequest);
                        {108}in(c, (=GetEndpointResponse,=pkSess_594,=SignAndEncrypt,SP_595: bitstring,UP_596: bitstring));
                        {109}new Nc_597: bitstring;
                        {110}let wNc_598: bitstring = enc(Nc_597,pkSess_594) in
                        {111}let m1_599: bitstring = (OpenSecureChannelRequest,pkCli,wNc_598) in
                        {112}out(c, (pkCli,enc(m1_599,pkSess_594),sign(h(m1_599),skCli)));
                        {113}in(c, (em2_600: bitstring,sigM2_601: bitstring));
                        {114}let m2_602: bitstring = dec(em2_600,skCli) in
                        {115}if (verify(h(m2_602),sigM2_601,pkSess_594) <> true) then
                            0
                        else
                            {116}let (=OpenSecureChannelResponse,wNs_603: bitstring,ST_604: bitstring,TTL_605: bitstring) = m2_602 in
                            {117}let Ns_606: bitstring = dec(wNs_603,skCli) in
                            {118}let Kcli_607: bitstring = h((Nc_597,Ns_606)) in
                            {119}out(c, senc(mCli(pkCli,pkSess_594),Kcli_607))
                )
                else
                    {120}let v_608: bool = (Disco = B) in
                    (
                        {121}if v_608 then
                        (
                            {122}let pkDisco_609: bitstring = pub(skB) in
                            {123}let v_610: bool = (Sess = A) in
                            (
                                {124}if v_610 then
                                (
                                    {125}let pkSess_611: bitstring = pub(skA) in
                                    {126}out(c, GetEndpointRequest);
                                    {127}in(c, (=GetEndpointResponse,=pkSess_611,=SignAndEncrypt,SP_612: bitstring,UP_613: bitstring));
                                    {128}new Nc_614: bitstring;
                                    {129}let wNc_615: bitstring = enc(Nc_614,pkSess_611) in
                                    {130}let m1_616: bitstring = (OpenSecureChannelRequest,pkCli,wNc_615) in
                                    {131}out(c, (pkCli,enc(m1_616,pkSess_611),sign(h(m1_616),skCli)));
                                    {132}in(c, (em2_617: bitstring,sigM2_618: bitstring));
                                    {133}let m2_619: bitstring = dec(em2_617,skCli) in
                                    {134}if (verify(h(m2_619),sigM2_618,pkSess_611) <> true) then
                                        0
                                    else
                                        {135}let (=OpenSecureChannelResponse,wNs_620: bitstring,ST_621: bitstring,TTL_622: bitstring) = m2_619 in
                                        {136}let Ns_623: bitstring = dec(wNs_620,skCli) in
                                        {137}let Kcli_624: bitstring = h((Nc_614,Ns_623)) in
                                        {138}out(c, senc(mCli(pkCli,pkSess_611),Kcli_624))
                                )
                                else
                                    {139}let v_625: bool = (Sess = B) in
                                    (
                                        {140}if v_625 then
                                        (
                                            {141}let pkSess_626: bitstring = pub(skB) in
                                            {142}out(c, GetEndpointRequest);
                                            {143}in(c, (=GetEndpointResponse,=pkSess_626,=SignAndEncrypt,SP_627: bitstring,UP_628: bitstring));
                                            {144}new Nc_629: bitstring;
                                            {145}let wNc_630: bitstring = enc(Nc_629,pkSess_626) in
                                            {146}let m1_631: bitstring = (OpenSecureChannelRequest,pkCli,wNc_630) in
                                            {147}out(c, (pkCli,enc(m1_631,pkSess_626),sign(h(m1_631),skCli)));
                                            {148}in(c, (em2_632: bitstring,sigM2_633: bitstring));
                                            {149}let m2_634: bitstring = dec(em2_632,skCli) in
                                            {150}if (verify(h(m2_634),sigM2_633,pkSess_626) <> true) then
                                                0
                                            else
                                                {151}let (=OpenSecureChannelResponse,wNs_635: bitstring,ST_636: bitstring,TTL_637: bitstring) = m2_634 in
                                                {152}let Ns_638: bitstring = dec(wNs_635,skCli) in
                                                {153}let Kcli_639: bitstring = h((Nc_629,Ns_638)) in
                                                {154}out(c, senc(mCli(pkCli,pkSess_626),Kcli_639))
                                        )
                                        else
                                            {155}let v_640: bool = (Sess = C) in
                                            (
                                                {156}if v_640 then
                                                (
                                                    {157}let pkSess_641: bitstring = pub(skC) in
                                                    {158}out(c, GetEndpointRequest);
                                                    {159}in(c, (=GetEndpointResponse,=pkSess_641,=SignAndEncrypt,SP_642: bitstring,UP_643: bitstring));
                                                    {160}new Nc_644: bitstring;
                                                    {161}let wNc_645: bitstring = enc(Nc_644,pkSess_641) in
                                                    {162}let m1_646: bitstring = (OpenSecureChannelRequest,pkCli,wNc_645) in
                                                    {163}out(c, (pkCli,enc(m1_646,pkSess_641),sign(h(m1_646),skCli)));
                                                    {164}in(c, (em2_647: bitstring,sigM2_648: bitstring));
                                                    {165}let m2_649: bitstring = dec(em2_647,skCli) in
                                                    {166}if (verify(h(m2_649),sigM2_648,pkSess_641) <> true) then
                                                        0
                                                    else
                                                        {167}let (=OpenSecureChannelResponse,wNs_650: bitstring,ST_651: bitstring,TTL_652: bitstring) = m2_649 in
                                                        {168}let Ns_653: bitstring = dec(wNs_650,skCli) in
                                                        {169}let Kcli_654: bitstring = h((Nc_644,Ns_653)) in
                                                        {170}out(c, senc(mCli(pkCli,pkSess_641),Kcli_654))
                                                )
                                                else
                                                    {171}let pkSess_655: bitstring = pub(sk(Sess)) in
                                                    {172}out(c, GetEndpointRequest);
                                                    {173}in(c, (=GetEndpointResponse,=pkSess_655,=SignAndEncrypt,SP_656: bitstring,UP_657: bitstring));
                                                    {174}new Nc_658: bitstring;
                                                    {175}let wNc_659: bitstring = enc(Nc_658,pkSess_655) in
                                                    {176}let m1_660: bitstring = (OpenSecureChannelRequest,pkCli,wNc_659) in
                                                    {177}out(c, (pkCli,enc(m1_660,pkSess_655),sign(h(m1_660),skCli)));
                                                    {178}in(c, (em2_661: bitstring,sigM2_662: bitstring));
                                                    {179}let m2_663: bitstring = dec(em2_661,skCli) in
                                                    {180}if (verify(h(m2_663),sigM2_662,pkSess_655) <> true) then
                                                        0
                                                    else
                                                        {181}let (=OpenSecureChannelResponse,wNs_664: bitstring,ST_665: bitstring,TTL_666: bitstring) = m2_663 in
                                                        {182}let Ns_667: bitstring = dec(wNs_664,skCli) in
                                                        {183}let Kcli_668: bitstring = h((Nc_658,Ns_667)) in
                                                        {184}out(c, senc(mCli(pkCli,pkSess_655),Kcli_668))
                                            )
                                            else
                                                {185}let pkSess_669: bitstring = fail-any in
                                                {186}out(c, GetEndpointRequest);
                                                {187}in(c, (=GetEndpointResponse,=pkSess_669,=SignAndEncrypt,SP_670: bitstring,UP_671: bitstring));
                                                {188}new Nc_672: bitstring;
                                                {189}let wNc_673: bitstring = enc(Nc_672,pkSess_669) in
                                                {190}let m1_674: bitstring = (OpenSecureChannelRequest,pkCli,wNc_673) in
                                                {191}out(c, (pkCli,enc(m1_674,pkSess_669),sign(h(m1_674),skCli)));
                                                {192}in(c, (em2_675: bitstring,sigM2_676: bitstring));
                                                {193}let m2_677: bitstring = dec(em2_675,skCli) in
                                                {194}if (verify(h(m2_677),sigM2_676,pkSess_669) <> true) then
                                                    0
                                                else
                                                    {195}let (=OpenSecureChannelResponse,wNs_678: bitstring,ST_679: bitstring,TTL_680: bitstring) = m2_677 in
                                                    {196}let Ns_681: bitstring = dec(wNs_678,skCli) in
                                                    {197}let Kcli_682: bitstring = h((Nc_672,Ns_681)) in
                                                    {198}out(c, senc(mCli(pkCli,pkSess_669),Kcli_682))
                                    )
                                    else
                                        {199}let pkSess_683: bitstring = fail-any in
                                        {200}out(c, GetEndpointRequest);
                                        {201}in(c, (=GetEndpointResponse,=pkSess_683,=SignAndEncrypt,SP_684: bitstring,UP_685: bitstring));
                                        {202}new Nc_686: bitstring;
                                        {203}let wNc_687: bitstring = enc(Nc_686,pkSess_683) in
                                        {204}let m1_688: bitstring = (OpenSecureChannelRequest,pkCli,wNc_687) in
                                        {205}out(c, (pkCli,enc(m1_688,pkSess_683),sign(h(m1_688),skCli)));
                                        {206}in(c, (em2_689: bitstring,sigM2_690: bitstring));
                                        {207}let m2_691: bitstring = dec(em2_689,skCli) in
                                        {208}if (verify(h(m2_691),sigM2_690,pkSess_683) <> true) then
                                            0
                                        else
                                            {209}let (=OpenSecureChannelResponse,wNs_692: bitstring,ST_693: bitstring,TTL_694: bitstring) = m2_691 in
                                            {210}let Ns_695: bitstring = dec(wNs_692,skCli) in
                                            {211}let Kcli_696: bitstring = h((Nc_686,Ns_695)) in
                                            {212}out(c, senc(mCli(pkCli,pkSess_683),Kcli_696))
                            )
                            else
                                {213}let pkSess_697: bitstring = fail-any in
                                {214}out(c, GetEndpointRequest);
                                {215}in(c, (=GetEndpointResponse,=pkSess_697,=SignAndEncrypt,SP_698: bitstring,UP_699: bitstring));
                                {216}new Nc_700: bitstring;
                                {217}let wNc_701: bitstring = enc(Nc_700,pkSess_697) in
                                {218}let m1_702: bitstring = (OpenSecureChannelRequest,pkCli,wNc_701) in
                                {219}out(c, (pkCli,enc(m1_702,pkSess_697),sign(h(m1_702),skCli)));
                                {220}in(c, (em2_703: bitstring,sigM2_704: bitstring));
                                {221}let m2_705: bitstring = dec(em2_703,skCli) in
                                {222}if (verify(h(m2_705),sigM2_704,pkSess_697) <> true) then
                                    0
                                else
                                    {223}let (=OpenSecureChannelResponse,wNs_706: bitstring,ST_707: bitstring,TTL_708: bitstring) = m2_705 in
                                    {224}let Ns_709: bitstring = dec(wNs_706,skCli) in
                                    {225}let Kcli_710: bitstring = h((Nc_700,Ns_709)) in
                                    {226}out(c, senc(mCli(pkCli,pkSess_697),Kcli_710))
                        )
                        else
                            {227}let v_711: bool = (Disco = C) in
                            (
                                {228}if v_711 then
                                (
                                    {229}let pkDisco_712: bitstring = pub(skC) in
                                    {230}let v_713: bool = (Sess = A) in
                                    (
                                        {231}if v_713 then
                                        (
                                            {232}let pkSess_714: bitstring = pub(skA) in
                                            {233}out(c, GetEndpointRequest);
                                            {234}in(c, (=GetEndpointResponse,=pkSess_714,=SignAndEncrypt,SP_715: bitstring,UP_716: bitstring));
                                            {235}new Nc_717: bitstring;
                                            {236}let wNc_718: bitstring = enc(Nc_717,pkSess_714) in
                                            {237}let m1_719: bitstring = (OpenSecureChannelRequest,pkCli,wNc_718) in
                                            {238}out(c, (pkCli,enc(m1_719,pkSess_714),sign(h(m1_719),skCli)));
                                            {239}in(c, (em2_720: bitstring,sigM2_721: bitstring));
                                            {240}let m2_722: bitstring = dec(em2_720,skCli) in
                                            {241}if (verify(h(m2_722),sigM2_721,pkSess_714) <> true) then
                                                0
                                            else
                                                {242}let (=OpenSecureChannelResponse,wNs_723: bitstring,ST_724: bitstring,TTL_725: bitstring) = m2_722 in
                                                {243}let Ns_726: bitstring = dec(wNs_723,skCli) in
                                                {244}let Kcli_727: bitstring = h((Nc_717,Ns_726)) in
                                                {245}out(c, senc(mCli(pkCli,pkSess_714),Kcli_727))
                                        )
                                        else
                                            {246}let v_728: bool = (Sess = B) in
                                            (
                                                {247}if v_728 then
                                                (
                                                    {248}let pkSess_729: bitstring = pub(skB) in
                                                    {249}out(c, GetEndpointRequest);
                                                    {250}in(c, (=GetEndpointResponse,=pkSess_729,=SignAndEncrypt,SP_730: bitstring,UP_731: bitstring));
                                                    {251}new Nc_732: bitstring;
                                                    {252}let wNc_733: bitstring = enc(Nc_732,pkSess_729) in
                                                    {253}let m1_734: bitstring = (OpenSecureChannelRequest,pkCli,wNc_733) in
                                                    {254}out(c, (pkCli,enc(m1_734,pkSess_729),sign(h(m1_734),skCli)));
                                                    {255}in(c, (em2_735: bitstring,sigM2_736: bitstring));
                                                    {256}let m2_737: bitstring = dec(em2_735,skCli) in
                                                    {257}if (verify(h(m2_737),sigM2_736,pkSess_729) <> true) then
                                                        0
                                                    else
                                                        {258}let (=OpenSecureChannelResponse,wNs_738: bitstring,ST_739: bitstring,TTL_740: bitstring) = m2_737 in
                                                        {259}let Ns_741: bitstring = dec(wNs_738,skCli) in
                                                        {260}let Kcli_742: bitstring = h((Nc_732,Ns_741)) in
                                                        {261}out(c, senc(mCli(pkCli,pkSess_729),Kcli_742))
                                                )
                                                else
                                                    {262}let v_743: bool = (Sess = C) in
                                                    (
                                                        {263}if v_743 then
                                                        (
                                                            {264}let pkSess_744: bitstring = pub(skC) in
                                                            {265}out(c, GetEndpointRequest);
                                                            {266}in(c, (=GetEndpointResponse,=pkSess_744,=SignAndEncrypt,SP_745: bitstring,UP_746: bitstring));
                                                            {267}new Nc_747: bitstring;
                                                            {268}let wNc_748: bitstring = enc(Nc_747,pkSess_744) in
                                                            {269}let m1_749: bitstring = (OpenSecureChannelRequest,pkCli,wNc_748) in
                                                            {270}out(c, (pkCli,enc(m1_749,pkSess_744),sign(h(m1_749),skCli)));
                                                            {271}in(c, (em2_750: bitstring,sigM2_751: bitstring));
                                                            {272}let m2_752: bitstring = dec(em2_750,skCli) in
                                                            {273}if (verify(h(m2_752),sigM2_751,pkSess_744) <> true) then
                                                                0
                                                            else
                                                                {274}let (=OpenSecureChannelResponse,wNs_753: bitstring,ST_754: bitstring,TTL_755: bitstring) = m2_752 in
                                                                {275}let Ns_756: bitstring = dec(wNs_753,skCli) in
                                                                {276}let Kcli_757: bitstring = h((Nc_747,Ns_756)) in
                                                                {277}out(c, senc(mCli(pkCli,pkSess_744),Kcli_757))
                                                        )
                                                        else
                                                            {278}let pkSess_758: bitstring = pub(sk(Sess)) in
                                                            {279}out(c, GetEndpointRequest);
                                                            {280}in(c, (=GetEndpointResponse,=pkSess_758,=SignAndEncrypt,SP_759: bitstring,UP_760: bitstring));
                                                            {281}new Nc_761: bitstring;
                                                            {282}let wNc_762: bitstring = enc(Nc_761,pkSess_758) in
                                                            {283}let m1_763: bitstring = (OpenSecureChannelRequest,pkCli,wNc_762) in
                                                            {284}out(c, (pkCli,enc(m1_763,pkSess_758),sign(h(m1_763),skCli)));
                                                            {285}in(c, (em2_764: bitstring,sigM2_765: bitstring));
                                                            {286}let m2_766: bitstring = dec(em2_764,skCli) in
                                                            {287}if (verify(h(m2_766),sigM2_765,pkSess_758) <> true) then
                                                                0
                                                            else
                                                                {288}let (=OpenSecureChannelResponse,wNs_767: bitstring,ST_768: bitstring,TTL_769: bitstring) = m2_766 in
                                                                {289}let Ns_770: bitstring = dec(wNs_767,skCli) in
                                                                {290}let Kcli_771: bitstring = h((Nc_761,Ns_770)) in
                                                                {291}out(c, senc(mCli(pkCli,pkSess_758),Kcli_771))
                                                    )
                                                    else
                                                        {292}let pkSess_772: bitstring = fail-any in
                                                        {293}out(c, GetEndpointRequest);
                                                        {294}in(c, (=GetEndpointResponse,=pkSess_772,=SignAndEncrypt,SP_773: bitstring,UP_774: bitstring));
                                                        {295}new Nc_775: bitstring;
                                                        {296}let wNc_776: bitstring = enc(Nc_775,pkSess_772) in
                                                        {297}let m1_777: bitstring = (OpenSecureChannelRequest,pkCli,wNc_776) in
                                                        {298}out(c, (pkCli,enc(m1_777,pkSess_772),sign(h(m1_777),skCli)));
                                                        {299}in(c, (em2_778: bitstring,sigM2_779: bitstring));
                                                        {300}let m2_780: bitstring = dec(em2_778,skCli) in
                                                        {301}if (verify(h(m2_780),sigM2_779,pkSess_772) <> true) then
                                                            0
                                                        else
                                                            {302}let (=OpenSecureChannelResponse,wNs_781: bitstring,ST_782: bitstring,TTL_783: bitstring) = m2_780 in
                                                            {303}let Ns_784: bitstring = dec(wNs_781,skCli) in
                                                            {304}let Kcli_785: bitstring = h((Nc_775,Ns_784)) in
                                                            {305}out(c, senc(mCli(pkCli,pkSess_772),Kcli_785))
                                            )
                                            else
                                                {306}let pkSess_786: bitstring = fail-any in
                                                {307}out(c, GetEndpointRequest);
                                                {308}in(c, (=GetEndpointResponse,=pkSess_786,=SignAndEncrypt,SP_787: bitstring,UP_788: bitstring));
                                                {309}new Nc_789: bitstring;
                                                {310}let wNc_790: bitstring = enc(Nc_789,pkSess_786) in
                                                {311}let m1_791: bitstring = (OpenSecureChannelRequest,pkCli,wNc_790) in
                                                {312}out(c, (pkCli,enc(m1_791,pkSess_786),sign(h(m1_791),skCli)));
                                                {313}in(c, (em2_792: bitstring,sigM2_793: bitstring));
                                                {314}let m2_794: bitstring = dec(em2_792,skCli) in
                                                {315}if (verify(h(m2_794),sigM2_793,pkSess_786) <> true) then
                                                    0
                                                else
                                                    {316}let (=OpenSecureChannelResponse,wNs_795: bitstring,ST_796: bitstring,TTL_797: bitstring) = m2_794 in
                                                    {317}let Ns_798: bitstring = dec(wNs_795,skCli) in
                                                    {318}let Kcli_799: bitstring = h((Nc_789,Ns_798)) in
                                                    {319}out(c, senc(mCli(pkCli,pkSess_786),Kcli_799))
                                    )
                                    else
                                        {320}let pkSess_800: bitstring = fail-any in
                                        {321}out(c, GetEndpointRequest);
                                        {322}in(c, (=GetEndpointResponse,=pkSess_800,=SignAndEncrypt,SP_801: bitstring,UP_802: bitstring));
                                        {323}new Nc_803: bitstring;
                                        {324}let wNc_804: bitstring = enc(Nc_803,pkSess_800) in
                                        {325}let m1_805: bitstring = (OpenSecureChannelRequest,pkCli,wNc_804) in
                                        {326}out(c, (pkCli,enc(m1_805,pkSess_800),sign(h(m1_805),skCli)));
                                        {327}in(c, (em2_806: bitstring,sigM2_807: bitstring));
                                        {328}let m2_808: bitstring = dec(em2_806,skCli) in
                                        {329}if (verify(h(m2_808),sigM2_807,pkSess_800) <> true) then
                                            0
                                        else
                                            {330}let (=OpenSecureChannelResponse,wNs_809: bitstring,ST_810: bitstring,TTL_811: bitstring) = m2_808 in
                                            {331}let Ns_812: bitstring = dec(wNs_809,skCli) in
                                            {332}let Kcli_813: bitstring = h((Nc_803,Ns_812)) in
                                            {333}out(c, senc(mCli(pkCli,pkSess_800),Kcli_813))
                                )
                                else
                                    {334}let pkDisco_814: bitstring = pub(sk(Disco)) in
                                    {335}let v_815: bool = (Sess = A) in
                                    (
                                        {336}if v_815 then
                                        (
                                            {337}let pkSess_816: bitstring = pub(skA) in
                                            {338}out(c, GetEndpointRequest);
                                            {339}in(c, (=GetEndpointResponse,=pkSess_816,=SignAndEncrypt,SP_817: bitstring,UP_818: bitstring));
                                            {340}new Nc_819: bitstring;
                                            {341}let wNc_820: bitstring = enc(Nc_819,pkSess_816) in
                                            {342}let m1_821: bitstring = (OpenSecureChannelRequest,pkCli,wNc_820) in
                                            {343}out(c, (pkCli,enc(m1_821,pkSess_816),sign(h(m1_821),skCli)));
                                            {344}in(c, (em2_822: bitstring,sigM2_823: bitstring));
                                            {345}let m2_824: bitstring = dec(em2_822,skCli) in
                                            {346}if (verify(h(m2_824),sigM2_823,pkSess_816) <> true) then
                                                0
                                            else
                                                {347}let (=OpenSecureChannelResponse,wNs_825: bitstring,ST_826: bitstring,TTL_827: bitstring) = m2_824 in
                                                {348}let Ns_828: bitstring = dec(wNs_825,skCli) in
                                                {349}let Kcli_829: bitstring = h((Nc_819,Ns_828)) in
                                                {350}out(c, senc(mCli(pkCli,pkSess_816),Kcli_829))
                                        )
                                        else
                                            {351}let v_830: bool = (Sess = B) in
                                            (
                                                {352}if v_830 then
                                                (
                                                    {353}let pkSess_831: bitstring = pub(skB) in
                                                    {354}out(c, GetEndpointRequest);
                                                    {355}in(c, (=GetEndpointResponse,=pkSess_831,=SignAndEncrypt,SP_832: bitstring,UP_833: bitstring));
                                                    {356}new Nc_834: bitstring;
                                                    {357}let wNc_835: bitstring = enc(Nc_834,pkSess_831) in
                                                    {358}let m1_836: bitstring = (OpenSecureChannelRequest,pkCli,wNc_835) in
                                                    {359}out(c, (pkCli,enc(m1_836,pkSess_831),sign(h(m1_836),skCli)));
                                                    {360}in(c, (em2_837: bitstring,sigM2_838: bitstring));
                                                    {361}let m2_839: bitstring = dec(em2_837,skCli) in
                                                    {362}if (verify(h(m2_839),sigM2_838,pkSess_831) <> true) then
                                                        0
                                                    else
                                                        {363}let (=OpenSecureChannelResponse,wNs_840: bitstring,ST_841: bitstring,TTL_842: bitstring) = m2_839 in
                                                        {364}let Ns_843: bitstring = dec(wNs_840,skCli) in
                                                        {365}let Kcli_844: bitstring = h((Nc_834,Ns_843)) in
                                                        {366}out(c, senc(mCli(pkCli,pkSess_831),Kcli_844))
                                                )
                                                else
                                                    {367}let v_845: bool = (Sess = C) in
                                                    (
                                                        {368}if v_845 then
                                                        (
                                                            {369}let pkSess_846: bitstring = pub(skC) in
                                                            {370}out(c, GetEndpointRequest);
                                                            {371}in(c, (=GetEndpointResponse,=pkSess_846,=SignAndEncrypt,SP_847: bitstring,UP_848: bitstring));
                                                            {372}new Nc_849: bitstring;
                                                            {373}let wNc_850: bitstring = enc(Nc_849,pkSess_846) in
                                                            {374}let m1_851: bitstring = (OpenSecureChannelRequest,pkCli,wNc_850) in
                                                            {375}out(c, (pkCli,enc(m1_851,pkSess_846),sign(h(m1_851),skCli)));
                                                            {376}in(c, (em2_852: bitstring,sigM2_853: bitstring));
                                                            {377}let m2_854: bitstring = dec(em2_852,skCli) in
                                                            {378}if (verify(h(m2_854),sigM2_853,pkSess_846) <> true) then
                                                                0
                                                            else
                                                                {379}let (=OpenSecureChannelResponse,wNs_855: bitstring,ST_856: bitstring,TTL_857: bitstring) = m2_854 in
                                                                {380}let Ns_858: bitstring = dec(wNs_855,skCli) in
                                                                {381}let Kcli_859: bitstring = h((Nc_849,Ns_858)) in
                                                                {382}out(c, senc(mCli(pkCli,pkSess_846),Kcli_859))
                                                        )
                                                        else
                                                            {383}let pkSess_860: bitstring = pub(sk(Sess)) in
                                                            {384}out(c, GetEndpointRequest);
                                                            {385}in(c, (=GetEndpointResponse,=pkSess_860,=SignAndEncrypt,SP_861: bitstring,UP_862: bitstring));
                                                            {386}new Nc_863: bitstring;
                                                            {387}let wNc_864: bitstring = enc(Nc_863,pkSess_860) in
                                                            {388}let m1_865: bitstring = (OpenSecureChannelRequest,pkCli,wNc_864) in
                                                            {389}out(c, (pkCli,enc(m1_865,pkSess_860),sign(h(m1_865),skCli)));
                                                            {390}in(c, (em2_866: bitstring,sigM2_867: bitstring));
                                                            {391}let m2_868: bitstring = dec(em2_866,skCli) in
                                                            {392}if (verify(h(m2_868),sigM2_867,pkSess_860) <> true) then
                                                                0
                                                            else
                                                                {393}let (=OpenSecureChannelResponse,wNs_869: bitstring,ST_870: bitstring,TTL_871: bitstring) = m2_868 in
                                                                {394}let Ns_872: bitstring = dec(wNs_869,skCli) in
                                                                {395}let Kcli_873: bitstring = h((Nc_863,Ns_872)) in
                                                                {396}out(c, senc(mCli(pkCli,pkSess_860),Kcli_873))
                                                    )
                                                    else
                                                        {397}let pkSess_874: bitstring = fail-any in
                                                        {398}out(c, GetEndpointRequest);
                                                        {399}in(c, (=GetEndpointResponse,=pkSess_874,=SignAndEncrypt,SP_875: bitstring,UP_876: bitstring));
                                                        {400}new Nc_877: bitstring;
                                                        {401}let wNc_878: bitstring = enc(Nc_877,pkSess_874) in
                                                        {402}let m1_879: bitstring = (OpenSecureChannelRequest,pkCli,wNc_878) in
                                                        {403}out(c, (pkCli,enc(m1_879,pkSess_874),sign(h(m1_879),skCli)));
                                                        {404}in(c, (em2_880: bitstring,sigM2_881: bitstring));
                                                        {405}let m2_882: bitstring = dec(em2_880,skCli) in
                                                        {406}if (verify(h(m2_882),sigM2_881,pkSess_874) <> true) then
                                                            0
                                                        else
                                                            {407}let (=OpenSecureChannelResponse,wNs_883: bitstring,ST_884: bitstring,TTL_885: bitstring) = m2_882 in
                                                            {408}let Ns_886: bitstring = dec(wNs_883,skCli) in
                                                            {409}let Kcli_887: bitstring = h((Nc_877,Ns_886)) in
                                                            {410}out(c, senc(mCli(pkCli,pkSess_874),Kcli_887))
                                            )
                                            else
                                                {411}let pkSess_888: bitstring = fail-any in
                                                {412}out(c, GetEndpointRequest);
                                                {413}in(c, (=GetEndpointResponse,=pkSess_888,=SignAndEncrypt,SP_889: bitstring,UP_890: bitstring));
                                                {414}new Nc_891: bitstring;
                                                {415}let wNc_892: bitstring = enc(Nc_891,pkSess_888) in
                                                {416}let m1_893: bitstring = (OpenSecureChannelRequest,pkCli,wNc_892) in
                                                {417}out(c, (pkCli,enc(m1_893,pkSess_888),sign(h(m1_893),skCli)));
                                                {418}in(c, (em2_894: bitstring,sigM2_895: bitstring));
                                                {419}let m2_896: bitstring = dec(em2_894,skCli) in
                                                {420}if (verify(h(m2_896),sigM2_895,pkSess_888) <> true) then
                                                    0
                                                else
                                                    {421}let (=OpenSecureChannelResponse,wNs_897: bitstring,ST_898: bitstring,TTL_899: bitstring) = m2_896 in
                                                    {422}let Ns_900: bitstring = dec(wNs_897,skCli) in
                                                    {423}let Kcli_901: bitstring = h((Nc_891,Ns_900)) in
                                                    {424}out(c, senc(mCli(pkCli,pkSess_888),Kcli_901))
                                    )
                                    else
                                        {425}let pkSess_902: bitstring = fail-any in
                                        {426}out(c, GetEndpointRequest);
                                        {427}in(c, (=GetEndpointResponse,=pkSess_902,=SignAndEncrypt,SP_903: bitstring,UP_904: bitstring));
                                        {428}new Nc_905: bitstring;
                                        {429}let wNc_906: bitstring = enc(Nc_905,pkSess_902) in
                                        {430}let m1_907: bitstring = (OpenSecureChannelRequest,pkCli,wNc_906) in
                                        {431}out(c, (pkCli,enc(m1_907,pkSess_902),sign(h(m1_907),skCli)));
                                        {432}in(c, (em2_908: bitstring,sigM2_909: bitstring));
                                        {433}let m2_910: bitstring = dec(em2_908,skCli) in
                                        {434}if (verify(h(m2_910),sigM2_909,pkSess_902) <> true) then
                                            0
                                        else
                                            {435}let (=OpenSecureChannelResponse,wNs_911: bitstring,ST_912: bitstring,TTL_913: bitstring) = m2_910 in
                                            {436}let Ns_914: bitstring = dec(wNs_911,skCli) in
                                            {437}let Kcli_915: bitstring = h((Nc_905,Ns_914)) in
                                            {438}out(c, senc(mCli(pkCli,pkSess_902),Kcli_915))
                            )
                            else
                                {439}let pkDisco_916: bitstring = fail-any in
                                {440}let v_917: bool = (Sess = A) in
                                (
                                    {441}if v_917 then
                                    (
                                        {442}let pkSess_918: bitstring = pub(skA) in
                                        {443}out(c, GetEndpointRequest);
                                        {444}in(c, (=GetEndpointResponse,=pkSess_918,=SignAndEncrypt,SP_919: bitstring,UP_920: bitstring));
                                        {445}new Nc_921: bitstring;
                                        {446}let wNc_922: bitstring = enc(Nc_921,pkSess_918) in
                                        {447}let m1_923: bitstring = (OpenSecureChannelRequest,pkCli,wNc_922) in
                                        {448}out(c, (pkCli,enc(m1_923,pkSess_918),sign(h(m1_923),skCli)));
                                        {449}in(c, (em2_924: bitstring,sigM2_925: bitstring));
                                        {450}let m2_926: bitstring = dec(em2_924,skCli) in
                                        {451}if (verify(h(m2_926),sigM2_925,pkSess_918) <> true) then
                                            0
                                        else
                                            {452}let (=OpenSecureChannelResponse,wNs_927: bitstring,ST_928: bitstring,TTL_929: bitstring) = m2_926 in
                                            {453}let Ns_930: bitstring = dec(wNs_927,skCli) in
                                            {454}let Kcli_931: bitstring = h((Nc_921,Ns_930)) in
                                            {455}out(c, senc(mCli(pkCli,pkSess_918),Kcli_931))
                                    )
                                    else
                                        {456}let v_932: bool = (Sess = B) in
                                        (
                                            {457}if v_932 then
                                            (
                                                {458}let pkSess_933: bitstring = pub(skB) in
                                                {459}out(c, GetEndpointRequest);
                                                {460}in(c, (=GetEndpointResponse,=pkSess_933,=SignAndEncrypt,SP_934: bitstring,UP_935: bitstring));
                                                {461}new Nc_936: bitstring;
                                                {462}let wNc_937: bitstring = enc(Nc_936,pkSess_933) in
                                                {463}let m1_938: bitstring = (OpenSecureChannelRequest,pkCli,wNc_937) in
                                                {464}out(c, (pkCli,enc(m1_938,pkSess_933),sign(h(m1_938),skCli)));
                                                {465}in(c, (em2_939: bitstring,sigM2_940: bitstring));
                                                {466}let m2_941: bitstring = dec(em2_939,skCli) in
                                                {467}if (verify(h(m2_941),sigM2_940,pkSess_933) <> true) then
                                                    0
                                                else
                                                    {468}let (=OpenSecureChannelResponse,wNs_942: bitstring,ST_943: bitstring,TTL_944: bitstring) = m2_941 in
                                                    {469}let Ns_945: bitstring = dec(wNs_942,skCli) in
                                                    {470}let Kcli_946: bitstring = h((Nc_936,Ns_945)) in
                                                    {471}out(c, senc(mCli(pkCli,pkSess_933),Kcli_946))
                                            )
                                            else
                                                {472}let v_947: bool = (Sess = C) in
                                                (
                                                    {473}if v_947 then
                                                    (
                                                        {474}let pkSess_948: bitstring = pub(skC) in
                                                        {475}out(c, GetEndpointRequest);
                                                        {476}in(c, (=GetEndpointResponse,=pkSess_948,=SignAndEncrypt,SP_949: bitstring,UP_950: bitstring));
                                                        {477}new Nc_951: bitstring;
                                                        {478}let wNc_952: bitstring = enc(Nc_951,pkSess_948) in
                                                        {479}let m1_953: bitstring = (OpenSecureChannelRequest,pkCli,wNc_952) in
                                                        {480}out(c, (pkCli,enc(m1_953,pkSess_948),sign(h(m1_953),skCli)));
                                                        {481}in(c, (em2_954: bitstring,sigM2_955: bitstring));
                                                        {482}let m2_956: bitstring = dec(em2_954,skCli) in
                                                        {483}if (verify(h(m2_956),sigM2_955,pkSess_948) <> true) then
                                                            0
                                                        else
                                                            {484}let (=OpenSecureChannelResponse,wNs_957: bitstring,ST_958: bitstring,TTL_959: bitstring) = m2_956 in
                                                            {485}let Ns_960: bitstring = dec(wNs_957,skCli) in
                                                            {486}let Kcli_961: bitstring = h((Nc_951,Ns_960)) in
                                                            {487}out(c, senc(mCli(pkCli,pkSess_948),Kcli_961))
                                                    )
                                                    else
                                                        {488}let pkSess_962: bitstring = pub(sk(Sess)) in
                                                        {489}out(c, GetEndpointRequest);
                                                        {490}in(c, (=GetEndpointResponse,=pkSess_962,=SignAndEncrypt,SP_963: bitstring,UP_964: bitstring));
                                                        {491}new Nc_965: bitstring;
                                                        {492}let wNc_966: bitstring = enc(Nc_965,pkSess_962) in
                                                        {493}let m1_967: bitstring = (OpenSecureChannelRequest,pkCli,wNc_966) in
                                                        {494}out(c, (pkCli,enc(m1_967,pkSess_962),sign(h(m1_967),skCli)));
                                                        {495}in(c, (em2_968: bitstring,sigM2_969: bitstring));
                                                        {496}let m2_970: bitstring = dec(em2_968,skCli) in
                                                        {497}if (verify(h(m2_970),sigM2_969,pkSess_962) <> true) then
                                                            0
                                                        else
                                                            {498}let (=OpenSecureChannelResponse,wNs_971: bitstring,ST_972: bitstring,TTL_973: bitstring) = m2_970 in
                                                            {499}let Ns_974: bitstring = dec(wNs_971,skCli) in
                                                            {500}let Kcli_975: bitstring = h((Nc_965,Ns_974)) in
                                                            {501}out(c, senc(mCli(pkCli,pkSess_962),Kcli_975))
                                                )
                                                else
                                                    {502}let pkSess_976: bitstring = fail-any in
                                                    {503}out(c, GetEndpointRequest);
                                                    {504}in(c, (=GetEndpointResponse,=pkSess_976,=SignAndEncrypt,SP_977: bitstring,UP_978: bitstring));
                                                    {505}new Nc_979: bitstring;
                                                    {506}let wNc_980: bitstring = enc(Nc_979,pkSess_976) in
                                                    {507}let m1_981: bitstring = (OpenSecureChannelRequest,pkCli,wNc_980) in
                                                    {508}out(c, (pkCli,enc(m1_981,pkSess_976),sign(h(m1_981),skCli)));
                                                    {509}in(c, (em2_982: bitstring,sigM2_983: bitstring));
                                                    {510}let m2_984: bitstring = dec(em2_982,skCli) in
                                                    {511}if (verify(h(m2_984),sigM2_983,pkSess_976) <> true) then
                                                        0
                                                    else
                                                        {512}let (=OpenSecureChannelResponse,wNs_985: bitstring,ST_986: bitstring,TTL_987: bitstring) = m2_984 in
                                                        {513}let Ns_988: bitstring = dec(wNs_985,skCli) in
                                                        {514}let Kcli_989: bitstring = h((Nc_979,Ns_988)) in
                                                        {515}out(c, senc(mCli(pkCli,pkSess_976),Kcli_989))
                                        )
                                        else
                                            {516}let pkSess_990: bitstring = fail-any in
                                            {517}out(c, GetEndpointRequest);
                                            {518}in(c, (=GetEndpointResponse,=pkSess_990,=SignAndEncrypt,SP_991: bitstring,UP_992: bitstring));
                                            {519}new Nc_993: bitstring;
                                            {520}let wNc_994: bitstring = enc(Nc_993,pkSess_990) in
                                            {521}let m1_995: bitstring = (OpenSecureChannelRequest,pkCli,wNc_994) in
                                            {522}out(c, (pkCli,enc(m1_995,pkSess_990),sign(h(m1_995),skCli)));
                                            {523}in(c, (em2_996: bitstring,sigM2_997: bitstring));
                                            {524}let m2_998: bitstring = dec(em2_996,skCli) in
                                            {525}if (verify(h(m2_998),sigM2_997,pkSess_990) <> true) then
                                                0
                                            else
                                                {526}let (=OpenSecureChannelResponse,wNs_999: bitstring,ST_1000: bitstring,TTL_1001: bitstring) = m2_998 in
                                                {527}let Ns_1002: bitstring = dec(wNs_999,skCli) in
                                                {528}let Kcli_1003: bitstring = h((Nc_993,Ns_1002)) in
                                                {529}out(c, senc(mCli(pkCli,pkSess_990),Kcli_1003))
                                )
                                else
                                    {530}let pkSess_1004: bitstring = fail-any in
                                    {531}out(c, GetEndpointRequest);
                                    {532}in(c, (=GetEndpointResponse,=pkSess_1004,=SignAndEncrypt,SP_1005: bitstring,UP_1006: bitstring));
                                    {533}new Nc_1007: bitstring;
                                    {534}let wNc_1008: bitstring = enc(Nc_1007,pkSess_1004) in
                                    {535}let m1_1009: bitstring = (OpenSecureChannelRequest,pkCli,wNc_1008) in
                                    {536}out(c, (pkCli,enc(m1_1009,pkSess_1004),sign(h(m1_1009),skCli)));
                                    {537}in(c, (em2_1010: bitstring,sigM2_1011: bitstring));
                                    {538}let m2_1012: bitstring = dec(em2_1010,skCli) in
                                    {539}if (verify(h(m2_1012),sigM2_1011,pkSess_1004) <> true) then
                                        0
                                    else
                                        {540}let (=OpenSecureChannelResponse,wNs_1013: bitstring,ST_1014: bitstring,TTL_1015: bitstring) = m2_1012 in
                                        {541}let Ns_1016: bitstring = dec(wNs_1013,skCli) in
                                        {542}let Kcli_1017: bitstring = h((Nc_1007,Ns_1016)) in
                                        {543}out(c, senc(mCli(pkCli,pkSess_1004),Kcli_1017))
                    )
                    else
                        {544}let pkDisco_1018: bitstring = fail-any in
                        {545}let v_1019: bool = (Sess = A) in
                        (
                            {546}if v_1019 then
                            (
                                {547}let pkSess_1020: bitstring = pub(skA) in
                                {548}out(c, GetEndpointRequest);
                                {549}in(c, (=GetEndpointResponse,=pkSess_1020,=SignAndEncrypt,SP_1021: bitstring,UP_1022: bitstring));
                                {550}new Nc_1023: bitstring;
                                {551}let wNc_1024: bitstring = enc(Nc_1023,pkSess_1020) in
                                {552}let m1_1025: bitstring = (OpenSecureChannelRequest,pkCli,wNc_1024) in
                                {553}out(c, (pkCli,enc(m1_1025,pkSess_1020),sign(h(m1_1025),skCli)));
                                {554}in(c, (em2_1026: bitstring,sigM2_1027: bitstring));
                                {555}let m2_1028: bitstring = dec(em2_1026,skCli) in
                                {556}if (verify(h(m2_1028),sigM2_1027,pkSess_1020) <> true) then
                                    0
                                else
                                    {557}let (=OpenSecureChannelResponse,wNs_1029: bitstring,ST_1030: bitstring,TTL_1031: bitstring) = m2_1028 in
                                    {558}let Ns_1032: bitstring = dec(wNs_1029,skCli) in
                                    {559}let Kcli_1033: bitstring = h((Nc_1023,Ns_1032)) in
                                    {560}out(c, senc(mCli(pkCli,pkSess_1020),Kcli_1033))
                            )
                            else
                                {561}let v_1034: bool = (Sess = B) in
                                (
                                    {562}if v_1034 then
                                    (
                                        {563}let pkSess_1035: bitstring = pub(skB) in
                                        {564}out(c, GetEndpointRequest);
                                        {565}in(c, (=GetEndpointResponse,=pkSess_1035,=SignAndEncrypt,SP_1036: bitstring,UP_1037: bitstring));
                                        {566}new Nc_1038: bitstring;
                                        {567}let wNc_1039: bitstring = enc(Nc_1038,pkSess_1035) in
                                        {568}let m1_1040: bitstring = (OpenSecureChannelRequest,pkCli,wNc_1039) in
                                        {569}out(c, (pkCli,enc(m1_1040,pkSess_1035),sign(h(m1_1040),skCli)));
                                        {570}in(c, (em2_1041: bitstring,sigM2_1042: bitstring));
                                        {571}let m2_1043: bitstring = dec(em2_1041,skCli) in
                                        {572}if (verify(h(m2_1043),sigM2_1042,pkSess_1035) <> true) then
                                            0
                                        else
                                            {573}let (=OpenSecureChannelResponse,wNs_1044: bitstring,ST_1045: bitstring,TTL_1046: bitstring) = m2_1043 in
                                            {574}let Ns_1047: bitstring = dec(wNs_1044,skCli) in
                                            {575}let Kcli_1048: bitstring = h((Nc_1038,Ns_1047)) in
                                            {576}out(c, senc(mCli(pkCli,pkSess_1035),Kcli_1048))
                                    )
                                    else
                                        {577}let v_1049: bool = (Sess = C) in
                                        (
                                            {578}if v_1049 then
                                            (
                                                {579}let pkSess_1050: bitstring = pub(skC) in
                                                {580}out(c, GetEndpointRequest);
                                                {581}in(c, (=GetEndpointResponse,=pkSess_1050,=SignAndEncrypt,SP_1051: bitstring,UP_1052: bitstring));
                                                {582}new Nc_1053: bitstring;
                                                {583}let wNc_1054: bitstring = enc(Nc_1053,pkSess_1050) in
                                                {584}let m1_1055: bitstring = (OpenSecureChannelRequest,pkCli,wNc_1054) in
                                                {585}out(c, (pkCli,enc(m1_1055,pkSess_1050),sign(h(m1_1055),skCli)));
                                                {586}in(c, (em2_1056: bitstring,sigM2_1057: bitstring));
                                                {587}let m2_1058: bitstring = dec(em2_1056,skCli) in
                                                {588}if (verify(h(m2_1058),sigM2_1057,pkSess_1050) <> true) then
                                                    0
                                                else
                                                    {589}let (=OpenSecureChannelResponse,wNs_1059: bitstring,ST_1060: bitstring,TTL_1061: bitstring) = m2_1058 in
                                                    {590}let Ns_1062: bitstring = dec(wNs_1059,skCli) in
                                                    {591}let Kcli_1063: bitstring = h((Nc_1053,Ns_1062)) in
                                                    {592}out(c, senc(mCli(pkCli,pkSess_1050),Kcli_1063))
                                            )
                                            else
                                                {593}let pkSess_1064: bitstring = pub(sk(Sess)) in
                                                {594}out(c, GetEndpointRequest);
                                                {595}in(c, (=GetEndpointResponse,=pkSess_1064,=SignAndEncrypt,SP_1065: bitstring,UP_1066: bitstring));
                                                {596}new Nc_1067: bitstring;
                                                {597}let wNc_1068: bitstring = enc(Nc_1067,pkSess_1064) in
                                                {598}let m1_1069: bitstring = (OpenSecureChannelRequest,pkCli,wNc_1068) in
                                                {599}out(c, (pkCli,enc(m1_1069,pkSess_1064),sign(h(m1_1069),skCli)));
                                                {600}in(c, (em2_1070: bitstring,sigM2_1071: bitstring));
                                                {601}let m2_1072: bitstring = dec(em2_1070,skCli) in
                                                {602}if (verify(h(m2_1072),sigM2_1071,pkSess_1064) <> true) then
                                                    0
                                                else
                                                    {603}let (=OpenSecureChannelResponse,wNs_1073: bitstring,ST_1074: bitstring,TTL_1075: bitstring) = m2_1072 in
                                                    {604}let Ns_1076: bitstring = dec(wNs_1073,skCli) in
                                                    {605}let Kcli_1077: bitstring = h((Nc_1067,Ns_1076)) in
                                                    {606}out(c, senc(mCli(pkCli,pkSess_1064),Kcli_1077))
                                        )
                                        else
                                            {607}let pkSess_1078: bitstring = fail-any in
                                            {608}out(c, GetEndpointRequest);
                                            {609}in(c, (=GetEndpointResponse,=pkSess_1078,=SignAndEncrypt,SP_1079: bitstring,UP_1080: bitstring));
                                            {610}new Nc_1081: bitstring;
                                            {611}let wNc_1082: bitstring = enc(Nc_1081,pkSess_1078) in
                                            {612}let m1_1083: bitstring = (OpenSecureChannelRequest,pkCli,wNc_1082) in
                                            {613}out(c, (pkCli,enc(m1_1083,pkSess_1078),sign(h(m1_1083),skCli)));
                                            {614}in(c, (em2_1084: bitstring,sigM2_1085: bitstring));
                                            {615}let m2_1086: bitstring = dec(em2_1084,skCli) in
                                            {616}if (verify(h(m2_1086),sigM2_1085,pkSess_1078) <> true) then
                                                0
                                            else
                                                {617}let (=OpenSecureChannelResponse,wNs_1087: bitstring,ST_1088: bitstring,TTL_1089: bitstring) = m2_1086 in
                                                {618}let Ns_1090: bitstring = dec(wNs_1087,skCli) in
                                                {619}let Kcli_1091: bitstring = h((Nc_1081,Ns_1090)) in
                                                {620}out(c, senc(mCli(pkCli,pkSess_1078),Kcli_1091))
                                )
                                else
                                    {621}let pkSess_1092: bitstring = fail-any in
                                    {622}out(c, GetEndpointRequest);
                                    {623}in(c, (=GetEndpointResponse,=pkSess_1092,=SignAndEncrypt,SP_1093: bitstring,UP_1094: bitstring));
                                    {624}new Nc_1095: bitstring;
                                    {625}let wNc_1096: bitstring = enc(Nc_1095,pkSess_1092) in
                                    {626}let m1_1097: bitstring = (OpenSecureChannelRequest,pkCli,wNc_1096) in
                                    {627}out(c, (pkCli,enc(m1_1097,pkSess_1092),sign(h(m1_1097),skCli)));
                                    {628}in(c, (em2_1098: bitstring,sigM2_1099: bitstring));
                                    {629}let m2_1100: bitstring = dec(em2_1098,skCli) in
                                    {630}if (verify(h(m2_1100),sigM2_1099,pkSess_1092) <> true) then
                                        0
                                    else
                                        {631}let (=OpenSecureChannelResponse,wNs_1101: bitstring,ST_1102: bitstring,TTL_1103: bitstring) = m2_1100 in
                                        {632}let Ns_1104: bitstring = dec(wNs_1101,skCli) in
                                        {633}let Kcli_1105: bitstring = h((Nc_1095,Ns_1104)) in
                                        {634}out(c, senc(mCli(pkCli,pkSess_1092),Kcli_1105))
                        )
                        else
                            {635}let pkSess_1106: bitstring = fail-any in
                            {636}out(c, GetEndpointRequest);
                            {637}in(c, (=GetEndpointResponse,=pkSess_1106,=SignAndEncrypt,SP_1107: bitstring,UP_1108: bitstring));
                            {638}new Nc_1109: bitstring;
                            {639}let wNc_1110: bitstring = enc(Nc_1109,pkSess_1106) in
                            {640}let m1_1111: bitstring = (OpenSecureChannelRequest,pkCli,wNc_1110) in
                            {641}out(c, (pkCli,enc(m1_1111,pkSess_1106),sign(h(m1_1111),skCli)));
                            {642}in(c, (em2_1112: bitstring,sigM2_1113: bitstring));
                            {643}let m2_1114: bitstring = dec(em2_1112,skCli) in
                            {644}if (verify(h(m2_1114),sigM2_1113,pkSess_1106) <> true) then
                                0
                            else
                                {645}let (=OpenSecureChannelResponse,wNs_1115: bitstring,ST_1116: bitstring,TTL_1117: bitstring) = m2_1114 in
                                {646}let Ns_1118: bitstring = dec(wNs_1115,skCli) in
                                {647}let Kcli_1119: bitstring = h((Nc_1109,Ns_1118)) in
                                {648}out(c, senc(mCli(pkCli,pkSess_1106),Kcli_1119))
            )
            else
                {649}let pkDisco_1120: bitstring = fail-any in
                {650}let v_1121: bool = (Sess = A) in
                (
                    {651}if v_1121 then
                    (
                        {652}let pkSess_1122: bitstring = pub(skA) in
                        {653}out(c, GetEndpointRequest);
                        {654}in(c, (=GetEndpointResponse,=pkSess_1122,=SignAndEncrypt,SP_1123: bitstring,UP_1124: bitstring));
                        {655}new Nc_1125: bitstring;
                        {656}let wNc_1126: bitstring = enc(Nc_1125,pkSess_1122) in
                        {657}let m1_1127: bitstring = (OpenSecureChannelRequest,pkCli,wNc_1126) in
                        {658}out(c, (pkCli,enc(m1_1127,pkSess_1122),sign(h(m1_1127),skCli)));
                        {659}in(c, (em2_1128: bitstring,sigM2_1129: bitstring));
                        {660}let m2_1130: bitstring = dec(em2_1128,skCli) in
                        {661}if (verify(h(m2_1130),sigM2_1129,pkSess_1122) <> true) then
                            0
                        else
                            {662}let (=OpenSecureChannelResponse,wNs_1131: bitstring,ST_1132: bitstring,TTL_1133: bitstring) = m2_1130 in
                            {663}let Ns_1134: bitstring = dec(wNs_1131,skCli) in
                            {664}let Kcli_1135: bitstring = h((Nc_1125,Ns_1134)) in
                            {665}out(c, senc(mCli(pkCli,pkSess_1122),Kcli_1135))
                    )
                    else
                        {666}let v_1136: bool = (Sess = B) in
                        (
                            {667}if v_1136 then
                            (
                                {668}let pkSess_1137: bitstring = pub(skB) in
                                {669}out(c, GetEndpointRequest);
                                {670}in(c, (=GetEndpointResponse,=pkSess_1137,=SignAndEncrypt,SP_1138: bitstring,UP_1139: bitstring));
                                {671}new Nc_1140: bitstring;
                                {672}let wNc_1141: bitstring = enc(Nc_1140,pkSess_1137) in
                                {673}let m1_1142: bitstring = (OpenSecureChannelRequest,pkCli,wNc_1141) in
                                {674}out(c, (pkCli,enc(m1_1142,pkSess_1137),sign(h(m1_1142),skCli)));
                                {675}in(c, (em2_1143: bitstring,sigM2_1144: bitstring));
                                {676}let m2_1145: bitstring = dec(em2_1143,skCli) in
                                {677}if (verify(h(m2_1145),sigM2_1144,pkSess_1137) <> true) then
                                    0
                                else
                                    {678}let (=OpenSecureChannelResponse,wNs_1146: bitstring,ST_1147: bitstring,TTL_1148: bitstring) = m2_1145 in
                                    {679}let Ns_1149: bitstring = dec(wNs_1146,skCli) in
                                    {680}let Kcli_1150: bitstring = h((Nc_1140,Ns_1149)) in
                                    {681}out(c, senc(mCli(pkCli,pkSess_1137),Kcli_1150))
                            )
                            else
                                {682}let v_1151: bool = (Sess = C) in
                                (
                                    {683}if v_1151 then
                                    (
                                        {684}let pkSess_1152: bitstring = pub(skC) in
                                        {685}out(c, GetEndpointRequest);
                                        {686}in(c, (=GetEndpointResponse,=pkSess_1152,=SignAndEncrypt,SP_1153: bitstring,UP_1154: bitstring));
                                        {687}new Nc_1155: bitstring;
                                        {688}let wNc_1156: bitstring = enc(Nc_1155,pkSess_1152) in
                                        {689}let m1_1157: bitstring = (OpenSecureChannelRequest,pkCli,wNc_1156) in
                                        {690}out(c, (pkCli,enc(m1_1157,pkSess_1152),sign(h(m1_1157),skCli)));
                                        {691}in(c, (em2_1158: bitstring,sigM2_1159: bitstring));
                                        {692}let m2_1160: bitstring = dec(em2_1158,skCli) in
                                        {693}if (verify(h(m2_1160),sigM2_1159,pkSess_1152) <> true) then
                                            0
                                        else
                                            {694}let (=OpenSecureChannelResponse,wNs_1161: bitstring,ST_1162: bitstring,TTL_1163: bitstring) = m2_1160 in
                                            {695}let Ns_1164: bitstring = dec(wNs_1161,skCli) in
                                            {696}let Kcli_1165: bitstring = h((Nc_1155,Ns_1164)) in
                                            {697}out(c, senc(mCli(pkCli,pkSess_1152),Kcli_1165))
                                    )
                                    else
                                        {698}let pkSess_1166: bitstring = pub(sk(Sess)) in
                                        {699}out(c, GetEndpointRequest);
                                        {700}in(c, (=GetEndpointResponse,=pkSess_1166,=SignAndEncrypt,SP_1167: bitstring,UP_1168: bitstring));
                                        {701}new Nc_1169: bitstring;
                                        {702}let wNc_1170: bitstring = enc(Nc_1169,pkSess_1166) in
                                        {703}let m1_1171: bitstring = (OpenSecureChannelRequest,pkCli,wNc_1170) in
                                        {704}out(c, (pkCli,enc(m1_1171,pkSess_1166),sign(h(m1_1171),skCli)));
                                        {705}in(c, (em2_1172: bitstring,sigM2_1173: bitstring));
                                        {706}let m2_1174: bitstring = dec(em2_1172,skCli) in
                                        {707}if (verify(h(m2_1174),sigM2_1173,pkSess_1166) <> true) then
                                            0
                                        else
                                            {708}let (=OpenSecureChannelResponse,wNs_1175: bitstring,ST_1176: bitstring,TTL_1177: bitstring) = m2_1174 in
                                            {709}let Ns_1178: bitstring = dec(wNs_1175,skCli) in
                                            {710}let Kcli_1179: bitstring = h((Nc_1169,Ns_1178)) in
                                            {711}out(c, senc(mCli(pkCli,pkSess_1166),Kcli_1179))
                                )
                                else
                                    {712}let pkSess_1180: bitstring = fail-any in
                                    {713}out(c, GetEndpointRequest);
                                    {714}in(c, (=GetEndpointResponse,=pkSess_1180,=SignAndEncrypt,SP_1181: bitstring,UP_1182: bitstring));
                                    {715}new Nc_1183: bitstring;
                                    {716}let wNc_1184: bitstring = enc(Nc_1183,pkSess_1180) in
                                    {717}let m1_1185: bitstring = (OpenSecureChannelRequest,pkCli,wNc_1184) in
                                    {718}out(c, (pkCli,enc(m1_1185,pkSess_1180),sign(h(m1_1185),skCli)));
                                    {719}in(c, (em2_1186: bitstring,sigM2_1187: bitstring));
                                    {720}let m2_1188: bitstring = dec(em2_1186,skCli) in
                                    {721}if (verify(h(m2_1188),sigM2_1187,pkSess_1180) <> true) then
                                        0
                                    else
                                        {722}let (=OpenSecureChannelResponse,wNs_1189: bitstring,ST_1190: bitstring,TTL_1191: bitstring) = m2_1188 in
                                        {723}let Ns_1192: bitstring = dec(wNs_1189,skCli) in
                                        {724}let Kcli_1193: bitstring = h((Nc_1183,Ns_1192)) in
                                        {725}out(c, senc(mCli(pkCli,pkSess_1180),Kcli_1193))
                        )
                        else
                            {726}let pkSess_1194: bitstring = fail-any in
                            {727}out(c, GetEndpointRequest);
                            {728}in(c, (=GetEndpointResponse,=pkSess_1194,=SignAndEncrypt,SP_1195: bitstring,UP_1196: bitstring));
                            {729}new Nc_1197: bitstring;
                            {730}let wNc_1198: bitstring = enc(Nc_1197,pkSess_1194) in
                            {731}let m1_1199: bitstring = (OpenSecureChannelRequest,pkCli,wNc_1198) in
                            {732}out(c, (pkCli,enc(m1_1199,pkSess_1194),sign(h(m1_1199),skCli)));
                            {733}in(c, (em2_1200: bitstring,sigM2_1201: bitstring));
                            {734}let m2_1202: bitstring = dec(em2_1200,skCli) in
                            {735}if (verify(h(m2_1202),sigM2_1201,pkSess_1194) <> true) then
                                0
                            else
                                {736}let (=OpenSecureChannelResponse,wNs_1203: bitstring,ST_1204: bitstring,TTL_1205: bitstring) = m2_1202 in
                                {737}let Ns_1206: bitstring = dec(wNs_1203,skCli) in
                                {738}let Kcli_1207: bitstring = h((Nc_1197,Ns_1206)) in
                                {739}out(c, senc(mCli(pkCli,pkSess_1194),Kcli_1207))
                )
                else
                    {740}let pkSess_1208: bitstring = fail-any in
                    {741}out(c, GetEndpointRequest);
                    {742}in(c, (=GetEndpointResponse,=pkSess_1208,=SignAndEncrypt,SP_1209: bitstring,UP_1210: bitstring));
                    {743}new Nc_1211: bitstring;
                    {744}let wNc_1212: bitstring = enc(Nc_1211,pkSess_1208) in
                    {745}let m1_1213: bitstring = (OpenSecureChannelRequest,pkCli,wNc_1212) in
                    {746}out(c, (pkCli,enc(m1_1213,pkSess_1208),sign(h(m1_1213),skCli)));
                    {747}in(c, (em2_1214: bitstring,sigM2_1215: bitstring));
                    {748}let m2_1216: bitstring = dec(em2_1214,skCli) in
                    {749}if (verify(h(m2_1216),sigM2_1215,pkSess_1208) <> true) then
                        0
                    else
                        {750}let (=OpenSecureChannelResponse,wNs_1217: bitstring,ST_1218: bitstring,TTL_1219: bitstring) = m2_1216 in
                        {751}let Ns_1220: bitstring = dec(wNs_1217,skCli) in
                        {752}let Kcli_1221: bitstring = h((Nc_1211,Ns_1220)) in
                        {753}out(c, senc(mCli(pkCli,pkSess_1208),Kcli_1221))
        )
        else
            {754}let v_1222: bool = (Cli = B) in
            (
                {755}if v_1222 then
                (
                    {756}let skCli_1223: bitstring = skB in
                    {757}let pkCli_1224: bitstring = pub(skCli_1223) in
                    {758}let v_1225: bool = (Disco = A) in
                    (
                        {759}if v_1225 then
                        (
                            {760}let pkDisco_1226: bitstring = pub(skA) in
                            {761}let v_1227: bool = (Sess = A) in
                            (
                                {762}if v_1227 then
                                (
                                    {763}let pkSess_1228: bitstring = pub(skA) in
                                    {764}out(c, GetEndpointRequest);
                                    {765}in(c, (=GetEndpointResponse,=pkSess_1228,=SignAndEncrypt,SP_1229: bitstring,UP_1230: bitstring));
                                    {766}new Nc_1231: bitstring;
                                    {767}let wNc_1232: bitstring = enc(Nc_1231,pkSess_1228) in
                                    {768}let m1_1233: bitstring = (OpenSecureChannelRequest,pkCli_1224,wNc_1232) in
                                    {769}out(c, (pkCli_1224,enc(m1_1233,pkSess_1228),sign(h(m1_1233),skCli_1223)));
                                    {770}in(c, (em2_1234: bitstring,sigM2_1235: bitstring));
                                    {771}let m2_1236: bitstring = dec(em2_1234,skCli_1223) in
                                    {772}if (verify(h(m2_1236),sigM2_1235,pkSess_1228) <> true) then
                                        0
                                    else
                                        {773}let (=OpenSecureChannelResponse,wNs_1237: bitstring,ST_1238: bitstring,TTL_1239: bitstring) = m2_1236 in
                                        {774}let Ns_1240: bitstring = dec(wNs_1237,skCli_1223) in
                                        {775}let Kcli_1241: bitstring = h((Nc_1231,Ns_1240)) in
                                        {776}out(c, senc(mCli(pkCli_1224,pkSess_1228),Kcli_1241))
                                )
                                else
                                    {777}let v_1242: bool = (Sess = B) in
                                    (
                                        {778}if v_1242 then
                                        (
                                            {779}let pkSess_1243: bitstring = pub(skB) in
                                            {780}out(c, GetEndpointRequest);
                                            {781}in(c, (=GetEndpointResponse,=pkSess_1243,=SignAndEncrypt,SP_1244: bitstring,UP_1245: bitstring));
                                            {782}new Nc_1246: bitstring;
                                            {783}let wNc_1247: bitstring = enc(Nc_1246,pkSess_1243) in
                                            {784}let m1_1248: bitstring = (OpenSecureChannelRequest,pkCli_1224,wNc_1247) in
                                            {785}out(c, (pkCli_1224,enc(m1_1248,pkSess_1243),sign(h(m1_1248),skCli_1223)));
                                            {786}in(c, (em2_1249: bitstring,sigM2_1250: bitstring));
                                            {787}let m2_1251: bitstring = dec(em2_1249,skCli_1223) in
                                            {788}if (verify(h(m2_1251),sigM2_1250,pkSess_1243) <> true) then
                                                0
                                            else
                                                {789}let (=OpenSecureChannelResponse,wNs_1252: bitstring,ST_1253: bitstring,TTL_1254: bitstring) = m2_1251 in
                                                {790}let Ns_1255: bitstring = dec(wNs_1252,skCli_1223) in
                                                {791}let Kcli_1256: bitstring = h((Nc_1246,Ns_1255)) in
                                                {792}out(c, senc(mCli(pkCli_1224,pkSess_1243),Kcli_1256))
                                        )
                                        else
                                            {793}let v_1257: bool = (Sess = C) in
                                            (
                                                {794}if v_1257 then
                                                (
                                                    {795}let pkSess_1258: bitstring = pub(skC) in
                                                    {796}out(c, GetEndpointRequest);
                                                    {797}in(c, (=GetEndpointResponse,=pkSess_1258,=SignAndEncrypt,SP_1259: bitstring,UP_1260: bitstring));
                                                    {798}new Nc_1261: bitstring;
                                                    {799}let wNc_1262: bitstring = enc(Nc_1261,pkSess_1258) in
                                                    {800}let m1_1263: bitstring = (OpenSecureChannelRequest,pkCli_1224,wNc_1262) in
                                                    {801}out(c, (pkCli_1224,enc(m1_1263,pkSess_1258),sign(h(m1_1263),skCli_1223)));
                                                    {802}in(c, (em2_1264: bitstring,sigM2_1265: bitstring));
                                                    {803}let m2_1266: bitstring = dec(em2_1264,skCli_1223) in
                                                    {804}if (verify(h(m2_1266),sigM2_1265,pkSess_1258) <> true) then
                                                        0
                                                    else
                                                        {805}let (=OpenSecureChannelResponse,wNs_1267: bitstring,ST_1268: bitstring,TTL_1269: bitstring) = m2_1266 in
                                                        {806}let Ns_1270: bitstring = dec(wNs_1267,skCli_1223) in
                                                        {807}let Kcli_1271: bitstring = h((Nc_1261,Ns_1270)) in
                                                        {808}out(c, senc(mCli(pkCli_1224,pkSess_1258),Kcli_1271))
                                                )
                                                else
                                                    {809}let pkSess_1272: bitstring = pub(sk(Sess)) in
                                                    {810}out(c, GetEndpointRequest);
                                                    {811}in(c, (=GetEndpointResponse,=pkSess_1272,=SignAndEncrypt,SP_1273: bitstring,UP_1274: bitstring));
                                                    {812}new Nc_1275: bitstring;
                                                    {813}let wNc_1276: bitstring = enc(Nc_1275,pkSess_1272) in
                                                    {814}let m1_1277: bitstring = (OpenSecureChannelRequest,pkCli_1224,wNc_1276) in
                                                    {815}out(c, (pkCli_1224,enc(m1_1277,pkSess_1272),sign(h(m1_1277),skCli_1223)));
                                                    {816}in(c, (em2_1278: bitstring,sigM2_1279: bitstring));
                                                    {817}let m2_1280: bitstring = dec(em2_1278,skCli_1223) in
                                                    {818}if (verify(h(m2_1280),sigM2_1279,pkSess_1272) <> true) then
                                                        0
                                                    else
                                                        {819}let (=OpenSecureChannelResponse,wNs_1281: bitstring,ST_1282: bitstring,TTL_1283: bitstring) = m2_1280 in
                                                        {820}let Ns_1284: bitstring = dec(wNs_1281,skCli_1223) in
                                                        {821}let Kcli_1285: bitstring = h((Nc_1275,Ns_1284)) in
                                                        {822}out(c, senc(mCli(pkCli_1224,pkSess_1272),Kcli_1285))
                                            )
                                            else
                                                {823}let pkSess_1286: bitstring = fail-any in
                                                {824}out(c, GetEndpointRequest);
                                                {825}in(c, (=GetEndpointResponse,=pkSess_1286,=SignAndEncrypt,SP_1287: bitstring,UP_1288: bitstring));
                                                {826}new Nc_1289: bitstring;
                                                {827}let wNc_1290: bitstring = enc(Nc_1289,pkSess_1286) in
                                                {828}let m1_1291: bitstring = (OpenSecureChannelRequest,pkCli_1224,wNc_1290) in
                                                {829}out(c, (pkCli_1224,enc(m1_1291,pkSess_1286),sign(h(m1_1291),skCli_1223)));
                                                {830}in(c, (em2_1292: bitstring,sigM2_1293: bitstring));
                                                {831}let m2_1294: bitstring = dec(em2_1292,skCli_1223) in
                                                {832}if (verify(h(m2_1294),sigM2_1293,pkSess_1286) <> true) then
                                                    0
                                                else
                                                    {833}let (=OpenSecureChannelResponse,wNs_1295: bitstring,ST_1296: bitstring,TTL_1297: bitstring) = m2_1294 in
                                                    {834}let Ns_1298: bitstring = dec(wNs_1295,skCli_1223) in
                                                    {835}let Kcli_1299: bitstring = h((Nc_1289,Ns_1298)) in
                                                    {836}out(c, senc(mCli(pkCli_1224,pkSess_1286),Kcli_1299))
                                    )
                                    else
                                        {837}let pkSess_1300: bitstring = fail-any in
                                        {838}out(c, GetEndpointRequest);
                                        {839}in(c, (=GetEndpointResponse,=pkSess_1300,=SignAndEncrypt,SP_1301: bitstring,UP_1302: bitstring));
                                        {840}new Nc_1303: bitstring;
                                        {841}let wNc_1304: bitstring = enc(Nc_1303,pkSess_1300) in
                                        {842}let m1_1305: bitstring = (OpenSecureChannelRequest,pkCli_1224,wNc_1304) in
                                        {843}out(c, (pkCli_1224,enc(m1_1305,pkSess_1300),sign(h(m1_1305),skCli_1223)));
                                        {844}in(c, (em2_1306: bitstring,sigM2_1307: bitstring));
                                        {845}let m2_1308: bitstring = dec(em2_1306,skCli_1223) in
                                        {846}if (verify(h(m2_1308),sigM2_1307,pkSess_1300) <> true) then
                                            0
                                        else
                                            {847}let (=OpenSecureChannelResponse,wNs_1309: bitstring,ST_1310: bitstring,TTL_1311: bitstring) = m2_1308 in
                                            {848}let Ns_1312: bitstring = dec(wNs_1309,skCli_1223) in
                                            {849}let Kcli_1313: bitstring = h((Nc_1303,Ns_1312)) in
                                            {850}out(c, senc(mCli(pkCli_1224,pkSess_1300),Kcli_1313))
                            )
                            else
                                {851}let pkSess_1314: bitstring = fail-any in
                                {852}out(c, GetEndpointRequest);
                                {853}in(c, (=GetEndpointResponse,=pkSess_1314,=SignAndEncrypt,SP_1315: bitstring,UP_1316: bitstring));
                                {854}new Nc_1317: bitstring;
                                {855}let wNc_1318: bitstring = enc(Nc_1317,pkSess_1314) in
                                {856}let m1_1319: bitstring = (OpenSecureChannelRequest,pkCli_1224,wNc_1318) in
                                {857}out(c, (pkCli_1224,enc(m1_1319,pkSess_1314),sign(h(m1_1319),skCli_1223)));
                                {858}in(c, (em2_1320: bitstring,sigM2_1321: bitstring));
                                {859}let m2_1322: bitstring = dec(em2_1320,skCli_1223) in
                                {860}if (verify(h(m2_1322),sigM2_1321,pkSess_1314) <> true) then
                                    0
                                else
                                    {861}let (=OpenSecureChannelResponse,wNs_1323: bitstring,ST_1324: bitstring,TTL_1325: bitstring) = m2_1322 in
                                    {862}let Ns_1326: bitstring = dec(wNs_1323,skCli_1223) in
                                    {863}let Kcli_1327: bitstring = h((Nc_1317,Ns_1326)) in
                                    {864}out(c, senc(mCli(pkCli_1224,pkSess_1314),Kcli_1327))
                        )
                        else
                            {865}let v_1328: bool = (Disco = B) in
                            (
                                {866}if v_1328 then
                                (
                                    {867}let pkDisco_1329: bitstring = pub(skB) in
                                    {868}let v_1330: bool = (Sess = A) in
                                    (
                                        {869}if v_1330 then
                                        (
                                            {870}let pkSess_1331: bitstring = pub(skA) in
                                            {871}out(c, GetEndpointRequest);
                                            {872}in(c, (=GetEndpointResponse,=pkSess_1331,=SignAndEncrypt,SP_1332: bitstring,UP_1333: bitstring));
                                            {873}new Nc_1334: bitstring;
                                            {874}let wNc_1335: bitstring = enc(Nc_1334,pkSess_1331) in
                                            {875}let m1_1336: bitstring = (OpenSecureChannelRequest,pkCli_1224,wNc_1335) in
                                            {876}out(c, (pkCli_1224,enc(m1_1336,pkSess_1331),sign(h(m1_1336),skCli_1223)));
                                            {877}in(c, (em2_1337: bitstring,sigM2_1338: bitstring));
                                            {878}let m2_1339: bitstring = dec(em2_1337,skCli_1223) in
                                            {879}if (verify(h(m2_1339),sigM2_1338,pkSess_1331) <> true) then
                                                0
                                            else
                                                {880}let (=OpenSecureChannelResponse,wNs_1340: bitstring,ST_1341: bitstring,TTL_1342: bitstring) = m2_1339 in
                                                {881}let Ns_1343: bitstring = dec(wNs_1340,skCli_1223) in
                                                {882}let Kcli_1344: bitstring = h((Nc_1334,Ns_1343)) in
                                                {883}out(c, senc(mCli(pkCli_1224,pkSess_1331),Kcli_1344))
                                        )
                                        else
                                            {884}let v_1345: bool = (Sess = B) in
                                            (
                                                {885}if v_1345 then
                                                (
                                                    {886}let pkSess_1346: bitstring = pub(skB) in
                                                    {887}out(c, GetEndpointRequest);
                                                    {888}in(c, (=GetEndpointResponse,=pkSess_1346,=SignAndEncrypt,SP_1347: bitstring,UP_1348: bitstring));
                                                    {889}new Nc_1349: bitstring;
                                                    {890}let wNc_1350: bitstring = enc(Nc_1349,pkSess_1346) in
                                                    {891}let m1_1351: bitstring = (OpenSecureChannelRequest,pkCli_1224,wNc_1350) in
                                                    {892}out(c, (pkCli_1224,enc(m1_1351,pkSess_1346),sign(h(m1_1351),skCli_1223)));
                                                    {893}in(c, (em2_1352: bitstring,sigM2_1353: bitstring));
                                                    {894}let m2_1354: bitstring = dec(em2_1352,skCli_1223) in
                                                    {895}if (verify(h(m2_1354),sigM2_1353,pkSess_1346) <> true) then
                                                        0
                                                    else
                                                        {896}let (=OpenSecureChannelResponse,wNs_1355: bitstring,ST_1356: bitstring,TTL_1357: bitstring) = m2_1354 in
                                                        {897}let Ns_1358: bitstring = dec(wNs_1355,skCli_1223) in
                                                        {898}let Kcli_1359: bitstring = h((Nc_1349,Ns_1358)) in
                                                        {899}out(c, senc(mCli(pkCli_1224,pkSess_1346),Kcli_1359))
                                                )
                                                else
                                                    {900}let v_1360: bool = (Sess = C) in
                                                    (
                                                        {901}if v_1360 then
                                                        (
                                                            {902}let pkSess_1361: bitstring = pub(skC) in
                                                            {903}out(c, GetEndpointRequest);
                                                            {904}in(c, (=GetEndpointResponse,=pkSess_1361,=SignAndEncrypt,SP_1362: bitstring,UP_1363: bitstring));
                                                            {905}new Nc_1364: bitstring;
                                                            {906}let wNc_1365: bitstring = enc(Nc_1364,pkSess_1361) in
                                                            {907}let m1_1366: bitstring = (OpenSecureChannelRequest,pkCli_1224,wNc_1365) in
                                                            {908}out(c, (pkCli_1224,enc(m1_1366,pkSess_1361),sign(h(m1_1366),skCli_1223)));
                                                            {909}in(c, (em2_1367: bitstring,sigM2_1368: bitstring));
                                                            {910}let m2_1369: bitstring = dec(em2_1367,skCli_1223) in
                                                            {911}if (verify(h(m2_1369),sigM2_1368,pkSess_1361) <> true) then
                                                                0
                                                            else
                                                                {912}let (=OpenSecureChannelResponse,wNs_1370: bitstring,ST_1371: bitstring,TTL_1372: bitstring) = m2_1369 in
                                                                {913}let Ns_1373: bitstring = dec(wNs_1370,skCli_1223) in
                                                                {914}let Kcli_1374: bitstring = h((Nc_1364,Ns_1373)) in
                                                                {915}out(c, senc(mCli(pkCli_1224,pkSess_1361),Kcli_1374))
                                                        )
                                                        else
                                                            {916}let pkSess_1375: bitstring = pub(sk(Sess)) in
                                                            {917}out(c, GetEndpointRequest);
                                                            {918}in(c, (=GetEndpointResponse,=pkSess_1375,=SignAndEncrypt,SP_1376: bitstring,UP_1377: bitstring));
                                                            {919}new Nc_1378: bitstring;
                                                            {920}let wNc_1379: bitstring = enc(Nc_1378,pkSess_1375) in
                                                            {921}let m1_1380: bitstring = (OpenSecureChannelRequest,pkCli_1224,wNc_1379) in
                                                            {922}out(c, (pkCli_1224,enc(m1_1380,pkSess_1375),sign(h(m1_1380),skCli_1223)));
                                                            {923}in(c, (em2_1381: bitstring,sigM2_1382: bitstring));
                                                            {924}let m2_1383: bitstring = dec(em2_1381,skCli_1223) in
                                                            {925}if (verify(h(m2_1383),sigM2_1382,pkSess_1375) <> true) then
                                                                0
                                                            else
                                                                {926}let (=OpenSecureChannelResponse,wNs_1384: bitstring,ST_1385: bitstring,TTL_1386: bitstring) = m2_1383 in
                                                                {927}let Ns_1387: bitstring = dec(wNs_1384,skCli_1223) in
                                                                {928}let Kcli_1388: bitstring = h((Nc_1378,Ns_1387)) in
                                                                {929}out(c, senc(mCli(pkCli_1224,pkSess_1375),Kcli_1388))
                                                    )
                                                    else
                                                        {930}let pkSess_1389: bitstring = fail-any in
                                                        {931}out(c, GetEndpointRequest);
                                                        {932}in(c, (=GetEndpointResponse,=pkSess_1389,=SignAndEncrypt,SP_1390: bitstring,UP_1391: bitstring));
                                                        {933}new Nc_1392: bitstring;
                                                        {934}let wNc_1393: bitstring = enc(Nc_1392,pkSess_1389) in
                                                        {935}let m1_1394: bitstring = (OpenSecureChannelRequest,pkCli_1224,wNc_1393) in
                                                        {936}out(c, (pkCli_1224,enc(m1_1394,pkSess_1389),sign(h(m1_1394),skCli_1223)));
                                                        {937}in(c, (em2_1395: bitstring,sigM2_1396: bitstring));
                                                        {938}let m2_1397: bitstring = dec(em2_1395,skCli_1223) in
                                                        {939}if (verify(h(m2_1397),sigM2_1396,pkSess_1389) <> true) then
                                                            0
                                                        else
                                                            {940}let (=OpenSecureChannelResponse,wNs_1398: bitstring,ST_1399: bitstring,TTL_1400: bitstring) = m2_1397 in
                                                            {941}let Ns_1401: bitstring = dec(wNs_1398,skCli_1223) in
                                                            {942}let Kcli_1402: bitstring = h((Nc_1392,Ns_1401)) in
                                                            {943}out(c, senc(mCli(pkCli_1224,pkSess_1389),Kcli_1402))
                                            )
                                            else
                                                {944}let pkSess_1403: bitstring = fail-any in
                                                {945}out(c, GetEndpointRequest);
                                                {946}in(c, (=GetEndpointResponse,=pkSess_1403,=SignAndEncrypt,SP_1404: bitstring,UP_1405: bitstring));
                                                {947}new Nc_1406: bitstring;
                                                {948}let wNc_1407: bitstring = enc(Nc_1406,pkSess_1403) in
                                                {949}let m1_1408: bitstring = (OpenSecureChannelRequest,pkCli_1224,wNc_1407) in
                                                {950}out(c, (pkCli_1224,enc(m1_1408,pkSess_1403),sign(h(m1_1408),skCli_1223)));
                                                {951}in(c, (em2_1409: bitstring,sigM2_1410: bitstring));
                                                {952}let m2_1411: bitstring = dec(em2_1409,skCli_1223) in
                                                {953}if (verify(h(m2_1411),sigM2_1410,pkSess_1403) <> true) then
                                                    0
                                                else
                                                    {954}let (=OpenSecureChannelResponse,wNs_1412: bitstring,ST_1413: bitstring,TTL_1414: bitstring) = m2_1411 in
                                                    {955}let Ns_1415: bitstring = dec(wNs_1412,skCli_1223) in
                                                    {956}let Kcli_1416: bitstring = h((Nc_1406,Ns_1415)) in
                                                    {957}out(c, senc(mCli(pkCli_1224,pkSess_1403),Kcli_1416))
                                    )
                                    else
                                        {958}let pkSess_1417: bitstring = fail-any in
                                        {959}out(c, GetEndpointRequest);
                                        {960}in(c, (=GetEndpointResponse,=pkSess_1417,=SignAndEncrypt,SP_1418: bitstring,UP_1419: bitstring));
                                        {961}new Nc_1420: bitstring;
                                        {962}let wNc_1421: bitstring = enc(Nc_1420,pkSess_1417) in
                                        {963}let m1_1422: bitstring = (OpenSecureChannelRequest,pkCli_1224,wNc_1421) in
                                        {964}out(c, (pkCli_1224,enc(m1_1422,pkSess_1417),sign(h(m1_1422),skCli_1223)));
                                        {965}in(c, (em2_1423: bitstring,sigM2_1424: bitstring));
                                        {966}let m2_1425: bitstring = dec(em2_1423,skCli_1223) in
                                        {967}if (verify(h(m2_1425),sigM2_1424,pkSess_1417) <> true) then
                                            0
                                        else
                                            {968}let (=OpenSecureChannelResponse,wNs_1426: bitstring,ST_1427: bitstring,TTL_1428: bitstring) = m2_1425 in
                                            {969}let Ns_1429: bitstring = dec(wNs_1426,skCli_1223) in
                                            {970}let Kcli_1430: bitstring = h((Nc_1420,Ns_1429)) in
                                            {971}out(c, senc(mCli(pkCli_1224,pkSess_1417),Kcli_1430))
                                )
                                else
                                    {972}let v_1431: bool = (Disco = C) in
                                    (
                                        {973}if v_1431 then
                                        (
                                            {974}let pkDisco_1432: bitstring = pub(skC) in
                                            {975}let v_1433: bool = (Sess = A) in
                                            (
                                                {976}if v_1433 then
                                                (
                                                    {977}let pkSess_1434: bitstring = pub(skA) in
                                                    {978}out(c, GetEndpointRequest);
                                                    {979}in(c, (=GetEndpointResponse,=pkSess_1434,=SignAndEncrypt,SP_1435: bitstring,UP_1436: bitstring));
                                                    {980}new Nc_1437: bitstring;
                                                    {981}let wNc_1438: bitstring = enc(Nc_1437,pkSess_1434) in
                                                    {982}let m1_1439: bitstring = (OpenSecureChannelRequest,pkCli_1224,wNc_1438) in
                                                    {983}out(c, (pkCli_1224,enc(m1_1439,pkSess_1434),sign(h(m1_1439),skCli_1223)));
                                                    {984}in(c, (em2_1440: bitstring,sigM2_1441: bitstring));
                                                    {985}let m2_1442: bitstring = dec(em2_1440,skCli_1223) in
                                                    {986}if (verify(h(m2_1442),sigM2_1441,pkSess_1434) <> true) then
                                                        0
                                                    else
                                                        {987}let (=OpenSecureChannelResponse,wNs_1443: bitstring,ST_1444: bitstring,TTL_1445: bitstring) = m2_1442 in
                                                        {988}let Ns_1446: bitstring = dec(wNs_1443,skCli_1223) in
                                                        {989}let Kcli_1447: bitstring = h((Nc_1437,Ns_1446)) in
                                                        {990}out(c, senc(mCli(pkCli_1224,pkSess_1434),Kcli_1447))
                                                )
                                                else
                                                    {991}let v_1448: bool = (Sess = B) in
                                                    (
                                                        {992}if v_1448 then
                                                        (
                                                            {993}let pkSess_1449: bitstring = pub(skB) in
                                                            {994}out(c, GetEndpointRequest);
                                                            {995}in(c, (=GetEndpointResponse,=pkSess_1449,=SignAndEncrypt,SP_1450: bitstring,UP_1451: bitstring));
                                                            {996}new Nc_1452: bitstring;
                                                            {997}let wNc_1453: bitstring = enc(Nc_1452,pkSess_1449) in
                                                            {998}let m1_1454: bitstring = (OpenSecureChannelRequest,pkCli_1224,wNc_1453) in
                                                            {999}out(c, (pkCli_1224,enc(m1_1454,pkSess_1449),sign(h(m1_1454),skCli_1223)));
                                                            {1000}in(c, (em2_1455: bitstring,sigM2_1456: bitstring));
                                                            {1001}let m2_1457: bitstring = dec(em2_1455,skCli_1223) in
                                                            {1002}if (verify(h(m2_1457),sigM2_1456,pkSess_1449) <> true) then
                                                                0
                                                            else
                                                                {1003}let (=OpenSecureChannelResponse,wNs_1458: bitstring,ST_1459: bitstring,TTL_1460: bitstring) = m2_1457 in
                                                                {1004}let Ns_1461: bitstring = dec(wNs_1458,skCli_1223) in
                                                                {1005}let Kcli_1462: bitstring = h((Nc_1452,Ns_1461)) in
                                                                {1006}out(c, senc(mCli(pkCli_1224,pkSess_1449),Kcli_1462))
                                                        )
                                                        else
                                                            {1007}let v_1463: bool = (Sess = C) in
                                                            (
                                                                {1008}if v_1463 then
                                                                (
                                                                    {1009}let pkSess_1464: bitstring = pub(skC) in
                                                                    {1010}out(c, GetEndpointRequest);
                                                                    {1011}in(c, (=GetEndpointResponse,=pkSess_1464,=SignAndEncrypt,SP_1465: bitstring,UP_1466: bitstring));
                                                                    {1012}new Nc_1467: bitstring;
                                                                    {1013}let wNc_1468: bitstring = enc(Nc_1467,pkSess_1464) in
                                                                    {1014}let m1_1469: bitstring = (OpenSecureChannelRequest,pkCli_1224,wNc_1468) in
                                                                    {1015}out(c, (pkCli_1224,enc(m1_1469,pkSess_1464),sign(h(m1_1469),skCli_1223)));
                                                                    {1016}in(c, (em2_1470: bitstring,sigM2_1471: bitstring));
                                                                    {1017}let m2_1472: bitstring = dec(em2_1470,skCli_1223) in
                                                                    {1018}if (verify(h(m2_1472),sigM2_1471,pkSess_1464) <> true) then
                                                                        0
                                                                    else
                                                                        {1019}let (=OpenSecureChannelResponse,wNs_1473: bitstring,ST_1474: bitstring,TTL_1475: bitstring) = m2_1472 in
                                                                        {1020}let Ns_1476: bitstring = dec(wNs_1473,skCli_1223) in
                                                                        {1021}let Kcli_1477: bitstring = h((Nc_1467,Ns_1476)) in
                                                                        {1022}out(c, senc(mCli(pkCli_1224,pkSess_1464),Kcli_1477))
                                                                )
                                                                else
                                                                    {1023}let pkSess_1478: bitstring = pub(sk(Sess)) in
                                                                    {1024}out(c, GetEndpointRequest);
                                                                    {1025}in(c, (=GetEndpointResponse,=pkSess_1478,=SignAndEncrypt,SP_1479: bitstring,UP_1480: bitstring));
                                                                    {1026}new Nc_1481: bitstring;
                                                                    {1027}let wNc_1482: bitstring = enc(Nc_1481,pkSess_1478) in
                                                                    {1028}let m1_1483: bitstring = (OpenSecureChannelRequest,pkCli_1224,wNc_1482) in
                                                                    {1029}out(c, (pkCli_1224,enc(m1_1483,pkSess_1478),sign(h(m1_1483),skCli_1223)));
                                                                    {1030}in(c, (em2_1484: bitstring,sigM2_1485: bitstring));
                                                                    {1031}let m2_1486: bitstring = dec(em2_1484,skCli_1223) in
                                                                    {1032}if (verify(h(m2_1486),sigM2_1485,pkSess_1478) <> true) then
                                                                        0
                                                                    else
                                                                        {1033}let (=OpenSecureChannelResponse,wNs_1487: bitstring,ST_1488: bitstring,TTL_1489: bitstring) = m2_1486 in
                                                                        {1034}let Ns_1490: bitstring = dec(wNs_1487,skCli_1223) in
                                                                        {1035}let Kcli_1491: bitstring = h((Nc_1481,Ns_1490)) in
                                                                        {1036}out(c, senc(mCli(pkCli_1224,pkSess_1478),Kcli_1491))
                                                            )
                                                            else
                                                                {1037}let pkSess_1492: bitstring = fail-any in
                                                                {1038}out(c, GetEndpointRequest);
                                                                {1039}in(c, (=GetEndpointResponse,=pkSess_1492,=SignAndEncrypt,SP_1493: bitstring,UP_1494: bitstring));
                                                                {1040}new Nc_1495: bitstring;
                                                                {1041}let wNc_1496: bitstring = enc(Nc_1495,pkSess_1492) in
                                                                {1042}let m1_1497: bitstring = (OpenSecureChannelRequest,pkCli_1224,wNc_1496) in
                                                                {1043}out(c, (pkCli_1224,enc(m1_1497,pkSess_1492),sign(h(m1_1497),skCli_1223)));
                                                                {1044}in(c, (em2_1498: bitstring,sigM2_1499: bitstring));
                                                                {1045}let m2_1500: bitstring = dec(em2_1498,skCli_1223) in
                                                                {1046}if (verify(h(m2_1500),sigM2_1499,pkSess_1492) <> true) then
                                                                    0
                                                                else
                                                                    {1047}let (=OpenSecureChannelResponse,wNs_1501: bitstring,ST_1502: bitstring,TTL_1503: bitstring) = m2_1500 in
                                                                    {1048}let Ns_1504: bitstring = dec(wNs_1501,skCli_1223) in
                                                                    {1049}let Kcli_1505: bitstring = h((Nc_1495,Ns_1504)) in
                                                                    {1050}out(c, senc(mCli(pkCli_1224,pkSess_1492),Kcli_1505))
                                                    )
                                                    else
                                                        {1051}let pkSess_1506: bitstring = fail-any in
                                                        {1052}out(c, GetEndpointRequest);
                                                        {1053}in(c, (=GetEndpointResponse,=pkSess_1506,=SignAndEncrypt,SP_1507: bitstring,UP_1508: bitstring));
                                                        {1054}new Nc_1509: bitstring;
                                                        {1055}let wNc_1510: bitstring = enc(Nc_1509,pkSess_1506) in
                                                        {1056}let m1_1511: bitstring = (OpenSecureChannelRequest,pkCli_1224,wNc_1510) in
                                                        {1057}out(c, (pkCli_1224,enc(m1_1511,pkSess_1506),sign(h(m1_1511),skCli_1223)));
                                                        {1058}in(c, (em2_1512: bitstring,sigM2_1513: bitstring));
                                                        {1059}let m2_1514: bitstring = dec(em2_1512,skCli_1223) in
                                                        {1060}if (verify(h(m2_1514),sigM2_1513,pkSess_1506) <> true) then
                                                            0
                                                        else
                                                            {1061}let (=OpenSecureChannelResponse,wNs_1515: bitstring,ST_1516: bitstring,TTL_1517: bitstring) = m2_1514 in
                                                            {1062}let Ns_1518: bitstring = dec(wNs_1515,skCli_1223) in
                                                            {1063}let Kcli_1519: bitstring = h((Nc_1509,Ns_1518)) in
                                                            {1064}out(c, senc(mCli(pkCli_1224,pkSess_1506),Kcli_1519))
                                            )
                                            else
                                                {1065}let pkSess_1520: bitstring = fail-any in
                                                {1066}out(c, GetEndpointRequest);
                                                {1067}in(c, (=GetEndpointResponse,=pkSess_1520,=SignAndEncrypt,SP_1521: bitstring,UP_1522: bitstring));
                                                {1068}new Nc_1523: bitstring;
                                                {1069}let wNc_1524: bitstring = enc(Nc_1523,pkSess_1520) in
                                                {1070}let m1_1525: bitstring = (OpenSecureChannelRequest,pkCli_1224,wNc_1524) in
                                                {1071}out(c, (pkCli_1224,enc(m1_1525,pkSess_1520),sign(h(m1_1525),skCli_1223)));
                                                {1072}in(c, (em2_1526: bitstring,sigM2_1527: bitstring));
                                                {1073}let m2_1528: bitstring = dec(em2_1526,skCli_1223) in
                                                {1074}if (verify(h(m2_1528),sigM2_1527,pkSess_1520) <> true) then
                                                    0
                                                else
                                                    {1075}let (=OpenSecureChannelResponse,wNs_1529: bitstring,ST_1530: bitstring,TTL_1531: bitstring) = m2_1528 in
                                                    {1076}let Ns_1532: bitstring = dec(wNs_1529,skCli_1223) in
                                                    {1077}let Kcli_1533: bitstring = h((Nc_1523,Ns_1532)) in
                                                    {1078}out(c, senc(mCli(pkCli_1224,pkSess_1520),Kcli_1533))
                                        )
                                        else
                                            {1079}let pkDisco_1534: bitstring = pub(sk(Disco)) in
                                            {1080}let v_1535: bool = (Sess = A) in
                                            (
                                                {1081}if v_1535 then
                                                (
                                                    {1082}let pkSess_1536: bitstring = pub(skA) in
                                                    {1083}out(c, GetEndpointRequest);
                                                    {1084}in(c, (=GetEndpointResponse,=pkSess_1536,=SignAndEncrypt,SP_1537: bitstring,UP_1538: bitstring));
                                                    {1085}new Nc_1539: bitstring;
                                                    {1086}let wNc_1540: bitstring = enc(Nc_1539,pkSess_1536) in
                                                    {1087}let m1_1541: bitstring = (OpenSecureChannelRequest,pkCli_1224,wNc_1540) in
                                                    {1088}out(c, (pkCli_1224,enc(m1_1541,pkSess_1536),sign(h(m1_1541),skCli_1223)));
                                                    {1089}in(c, (em2_1542: bitstring,sigM2_1543: bitstring));
                                                    {1090}let m2_1544: bitstring = dec(em2_1542,skCli_1223) in
                                                    {1091}if (verify(h(m2_1544),sigM2_1543,pkSess_1536) <> true) then
                                                        0
                                                    else
                                                        {1092}let (=OpenSecureChannelResponse,wNs_1545: bitstring,ST_1546: bitstring,TTL_1547: bitstring) = m2_1544 in
                                                        {1093}let Ns_1548: bitstring = dec(wNs_1545,skCli_1223) in
                                                        {1094}let Kcli_1549: bitstring = h((Nc_1539,Ns_1548)) in
                                                        {1095}out(c, senc(mCli(pkCli_1224,pkSess_1536),Kcli_1549))
                                                )
                                                else
                                                    {1096}let v_1550: bool = (Sess = B) in
                                                    (
                                                        {1097}if v_1550 then
                                                        (
                                                            {1098}let pkSess_1551: bitstring = pub(skB) in
                                                            {1099}out(c, GetEndpointRequest);
                                                            {1100}in(c, (=GetEndpointResponse,=pkSess_1551,=SignAndEncrypt,SP_1552: bitstring,UP_1553: bitstring));
                                                            {1101}new Nc_1554: bitstring;
                                                            {1102}let wNc_1555: bitstring = enc(Nc_1554,pkSess_1551) in
                                                            {1103}let m1_1556: bitstring = (OpenSecureChannelRequest,pkCli_1224,wNc_1555) in
                                                            {1104}out(c, (pkCli_1224,enc(m1_1556,pkSess_1551),sign(h(m1_1556),skCli_1223)));
                                                            {1105}in(c, (em2_1557: bitstring,sigM2_1558: bitstring));
                                                            {1106}let m2_1559: bitstring = dec(em2_1557,skCli_1223) in
                                                            {1107}if (verify(h(m2_1559),sigM2_1558,pkSess_1551) <> true) then
                                                                0
                                                            else
                                                                {1108}let (=OpenSecureChannelResponse,wNs_1560: bitstring,ST_1561: bitstring,TTL_1562: bitstring) = m2_1559 in
                                                                {1109}let Ns_1563: bitstring = dec(wNs_1560,skCli_1223) in
                                                                {1110}let Kcli_1564: bitstring = h((Nc_1554,Ns_1563)) in
                                                                {1111}out(c, senc(mCli(pkCli_1224,pkSess_1551),Kcli_1564))
                                                        )
                                                        else
                                                            {1112}let v_1565: bool = (Sess = C) in
                                                            (
                                                                {1113}if v_1565 then
                                                                (
                                                                    {1114}let pkSess_1566: bitstring = pub(skC) in
                                                                    {1115}out(c, GetEndpointRequest);
                                                                    {1116}in(c, (=GetEndpointResponse,=pkSess_1566,=SignAndEncrypt,SP_1567: bitstring,UP_1568: bitstring));
                                                                    {1117}new Nc_1569: bitstring;
                                                                    {1118}let wNc_1570: bitstring = enc(Nc_1569,pkSess_1566) in
                                                                    {1119}let m1_1571: bitstring = (OpenSecureChannelRequest,pkCli_1224,wNc_1570) in
                                                                    {1120}out(c, (pkCli_1224,enc(m1_1571,pkSess_1566),sign(h(m1_1571),skCli_1223)));
                                                                    {1121}in(c, (em2_1572: bitstring,sigM2_1573: bitstring));
                                                                    {1122}let m2_1574: bitstring = dec(em2_1572,skCli_1223) in
                                                                    {1123}if (verify(h(m2_1574),sigM2_1573,pkSess_1566) <> true) then
                                                                        0
                                                                    else
                                                                        {1124}let (=OpenSecureChannelResponse,wNs_1575: bitstring,ST_1576: bitstring,TTL_1577: bitstring) = m2_1574 in
                                                                        {1125}let Ns_1578: bitstring = dec(wNs_1575,skCli_1223) in
                                                                        {1126}let Kcli_1579: bitstring = h((Nc_1569,Ns_1578)) in
                                                                        {1127}out(c, senc(mCli(pkCli_1224,pkSess_1566),Kcli_1579))
                                                                )
                                                                else
                                                                    {1128}let pkSess_1580: bitstring = pub(sk(Sess)) in
                                                                    {1129}out(c, GetEndpointRequest);
                                                                    {1130}in(c, (=GetEndpointResponse,=pkSess_1580,=SignAndEncrypt,SP_1581: bitstring,UP_1582: bitstring));
                                                                    {1131}new Nc_1583: bitstring;
                                                                    {1132}let wNc_1584: bitstring = enc(Nc_1583,pkSess_1580) in
                                                                    {1133}let m1_1585: bitstring = (OpenSecureChannelRequest,pkCli_1224,wNc_1584) in
                                                                    {1134}out(c, (pkCli_1224,enc(m1_1585,pkSess_1580),sign(h(m1_1585),skCli_1223)));
                                                                    {1135}in(c, (em2_1586: bitstring,sigM2_1587: bitstring));
                                                                    {1136}let m2_1588: bitstring = dec(em2_1586,skCli_1223) in
                                                                    {1137}if (verify(h(m2_1588),sigM2_1587,pkSess_1580) <> true) then
                                                                        0
                                                                    else
                                                                        {1138}let (=OpenSecureChannelResponse,wNs_1589: bitstring,ST_1590: bitstring,TTL_1591: bitstring) = m2_1588 in
                                                                        {1139}let Ns_1592: bitstring = dec(wNs_1589,skCli_1223) in
                                                                        {1140}let Kcli_1593: bitstring = h((Nc_1583,Ns_1592)) in
                                                                        {1141}out(c, senc(mCli(pkCli_1224,pkSess_1580),Kcli_1593))
                                                            )
                                                            else
                                                                {1142}let pkSess_1594: bitstring = fail-any in
                                                                {1143}out(c, GetEndpointRequest);
                                                                {1144}in(c, (=GetEndpointResponse,=pkSess_1594,=SignAndEncrypt,SP_1595: bitstring,UP_1596: bitstring));
                                                                {1145}new Nc_1597: bitstring;
                                                                {1146}let wNc_1598: bitstring = enc(Nc_1597,pkSess_1594) in
                                                                {1147}let m1_1599: bitstring = (OpenSecureChannelRequest,pkCli_1224,wNc_1598) in
                                                                {1148}out(c, (pkCli_1224,enc(m1_1599,pkSess_1594),sign(h(m1_1599),skCli_1223)));
                                                                {1149}in(c, (em2_1600: bitstring,sigM2_1601: bitstring));
                                                                {1150}let m2_1602: bitstring = dec(em2_1600,skCli_1223) in
                                                                {1151}if (verify(h(m2_1602),sigM2_1601,pkSess_1594) <> true) then
                                                                    0
                                                                else
                                                                    {1152}let (=OpenSecureChannelResponse,wNs_1603: bitstring,ST_1604: bitstring,TTL_1605: bitstring) = m2_1602 in
                                                                    {1153}let Ns_1606: bitstring = dec(wNs_1603,skCli_1223) in
                                                                    {1154}let Kcli_1607: bitstring = h((Nc_1597,Ns_1606)) in
                                                                    {1155}out(c, senc(mCli(pkCli_1224,pkSess_1594),Kcli_1607))
                                                    )
                                                    else
                                                        {1156}let pkSess_1608: bitstring = fail-any in
                                                        {1157}out(c, GetEndpointRequest);
                                                        {1158}in(c, (=GetEndpointResponse,=pkSess_1608,=SignAndEncrypt,SP_1609: bitstring,UP_1610: bitstring));
                                                        {1159}new Nc_1611: bitstring;
                                                        {1160}let wNc_1612: bitstring = enc(Nc_1611,pkSess_1608) in
                                                        {1161}let m1_1613: bitstring = (OpenSecureChannelRequest,pkCli_1224,wNc_1612) in
                                                        {1162}out(c, (pkCli_1224,enc(m1_1613,pkSess_1608),sign(h(m1_1613),skCli_1223)));
                                                        {1163}in(c, (em2_1614: bitstring,sigM2_1615: bitstring));
                                                        {1164}let m2_1616: bitstring = dec(em2_1614,skCli_1223) in
                                                        {1165}if (verify(h(m2_1616),sigM2_1615,pkSess_1608) <> true) then
                                                            0
                                                        else
                                                            {1166}let (=OpenSecureChannelResponse,wNs_1617: bitstring,ST_1618: bitstring,TTL_1619: bitstring) = m2_1616 in
                                                            {1167}let Ns_1620: bitstring = dec(wNs_1617,skCli_1223) in
                                                            {1168}let Kcli_1621: bitstring = h((Nc_1611,Ns_1620)) in
                                                            {1169}out(c, senc(mCli(pkCli_1224,pkSess_1608),Kcli_1621))
                                            )
                                            else
                                                {1170}let pkSess_1622: bitstring = fail-any in
                                                {1171}out(c, GetEndpointRequest);
                                                {1172}in(c, (=GetEndpointResponse,=pkSess_1622,=SignAndEncrypt,SP_1623: bitstring,UP_1624: bitstring));
                                                {1173}new Nc_1625: bitstring;
                                                {1174}let wNc_1626: bitstring = enc(Nc_1625,pkSess_1622) in
                                                {1175}let m1_1627: bitstring = (OpenSecureChannelRequest,pkCli_1224,wNc_1626) in
                                                {1176}out(c, (pkCli_1224,enc(m1_1627,pkSess_1622),sign(h(m1_1627),skCli_1223)));
                                                {1177}in(c, (em2_1628: bitstring,sigM2_1629: bitstring));
                                                {1178}let m2_1630: bitstring = dec(em2_1628,skCli_1223) in
                                                {1179}if (verify(h(m2_1630),sigM2_1629,pkSess_1622) <> true) then
                                                    0
                                                else
                                                    {1180}let (=OpenSecureChannelResponse,wNs_1631: bitstring,ST_1632: bitstring,TTL_1633: bitstring) = m2_1630 in
                                                    {1181}let Ns_1634: bitstring = dec(wNs_1631,skCli_1223) in
                                                    {1182}let Kcli_1635: bitstring = h((Nc_1625,Ns_1634)) in
                                                    {1183}out(c, senc(mCli(pkCli_1224,pkSess_1622),Kcli_1635))
                                    )
                                    else
                                        {1184}let pkDisco_1636: bitstring = fail-any in
                                        {1185}let v_1637: bool = (Sess = A) in
                                        (
                                            {1186}if v_1637 then
                                            (
                                                {1187}let pkSess_1638: bitstring = pub(skA) in
                                                {1188}out(c, GetEndpointRequest);
                                                {1189}in(c, (=GetEndpointResponse,=pkSess_1638,=SignAndEncrypt,SP_1639: bitstring,UP_1640: bitstring));
                                                {1190}new Nc_1641: bitstring;
                                                {1191}let wNc_1642: bitstring = enc(Nc_1641,pkSess_1638) in
                                                {1192}let m1_1643: bitstring = (OpenSecureChannelRequest,pkCli_1224,wNc_1642) in
                                                {1193}out(c, (pkCli_1224,enc(m1_1643,pkSess_1638),sign(h(m1_1643),skCli_1223)));
                                                {1194}in(c, (em2_1644: bitstring,sigM2_1645: bitstring));
                                                {1195}let m2_1646: bitstring = dec(em2_1644,skCli_1223) in
                                                {1196}if (verify(h(m2_1646),sigM2_1645,pkSess_1638) <> true) then
                                                    0
                                                else
                                                    {1197}let (=OpenSecureChannelResponse,wNs_1647: bitstring,ST_1648: bitstring,TTL_1649: bitstring) = m2_1646 in
                                                    {1198}let Ns_1650: bitstring = dec(wNs_1647,skCli_1223) in
                                                    {1199}let Kcli_1651: bitstring = h((Nc_1641,Ns_1650)) in
                                                    {1200}out(c, senc(mCli(pkCli_1224,pkSess_1638),Kcli_1651))
                                            )
                                            else
                                                {1201}let v_1652: bool = (Sess = B) in
                                                (
                                                    {1202}if v_1652 then
                                                    (
                                                        {1203}let pkSess_1653: bitstring = pub(skB) in
                                                        {1204}out(c, GetEndpointRequest);
                                                        {1205}in(c, (=GetEndpointResponse,=pkSess_1653,=SignAndEncrypt,SP_1654: bitstring,UP_1655: bitstring));
                                                        {1206}new Nc_1656: bitstring;
                                                        {1207}let wNc_1657: bitstring = enc(Nc_1656,pkSess_1653) in
                                                        {1208}let m1_1658: bitstring = (OpenSecureChannelRequest,pkCli_1224,wNc_1657) in
                                                        {1209}out(c, (pkCli_1224,enc(m1_1658,pkSess_1653),sign(h(m1_1658),skCli_1223)));
                                                        {1210}in(c, (em2_1659: bitstring,sigM2_1660: bitstring));
                                                        {1211}let m2_1661: bitstring = dec(em2_1659,skCli_1223) in
                                                        {1212}if (verify(h(m2_1661),sigM2_1660,pkSess_1653) <> true) then
                                                            0
                                                        else
                                                            {1213}let (=OpenSecureChannelResponse,wNs_1662: bitstring,ST_1663: bitstring,TTL_1664: bitstring) = m2_1661 in
                                                            {1214}let Ns_1665: bitstring = dec(wNs_1662,skCli_1223) in
                                                            {1215}let Kcli_1666: bitstring = h((Nc_1656,Ns_1665)) in
                                                            {1216}out(c, senc(mCli(pkCli_1224,pkSess_1653),Kcli_1666))
                                                    )
                                                    else
                                                        {1217}let v_1667: bool = (Sess = C) in
                                                        (
                                                            {1218}if v_1667 then
                                                            (
                                                                {1219}let pkSess_1668: bitstring = pub(skC) in
                                                                {1220}out(c, GetEndpointRequest);
                                                                {1221}in(c, (=GetEndpointResponse,=pkSess_1668,=SignAndEncrypt,SP_1669: bitstring,UP_1670: bitstring));
                                                                {1222}new Nc_1671: bitstring;
                                                                {1223}let wNc_1672: bitstring = enc(Nc_1671,pkSess_1668) in
                                                                {1224}let m1_1673: bitstring = (OpenSecureChannelRequest,pkCli_1224,wNc_1672) in
                                                                {1225}out(c, (pkCli_1224,enc(m1_1673,pkSess_1668),sign(h(m1_1673),skCli_1223)));
                                                                {1226}in(c, (em2_1674: bitstring,sigM2_1675: bitstring));
                                                                {1227}let m2_1676: bitstring = dec(em2_1674,skCli_1223) in
                                                                {1228}if (verify(h(m2_1676),sigM2_1675,pkSess_1668) <> true) then
                                                                    0
                                                                else
                                                                    {1229}let (=OpenSecureChannelResponse,wNs_1677: bitstring,ST_1678: bitstring,TTL_1679: bitstring) = m2_1676 in
                                                                    {1230}let Ns_1680: bitstring = dec(wNs_1677,skCli_1223) in
                                                                    {1231}let Kcli_1681: bitstring = h((Nc_1671,Ns_1680)) in
                                                                    {1232}out(c, senc(mCli(pkCli_1224,pkSess_1668),Kcli_1681))
                                                            )
                                                            else
                                                                {1233}let pkSess_1682: bitstring = pub(sk(Sess)) in
                                                                {1234}out(c, GetEndpointRequest);
                                                                {1235}in(c, (=GetEndpointResponse,=pkSess_1682,=SignAndEncrypt,SP_1683: bitstring,UP_1684: bitstring));
                                                                {1236}new Nc_1685: bitstring;
                                                                {1237}let wNc_1686: bitstring = enc(Nc_1685,pkSess_1682) in
                                                                {1238}let m1_1687: bitstring = (OpenSecureChannelRequest,pkCli_1224,wNc_1686) in
                                                                {1239}out(c, (pkCli_1224,enc(m1_1687,pkSess_1682),sign(h(m1_1687),skCli_1223)));
                                                                {1240}in(c, (em2_1688: bitstring,sigM2_1689: bitstring));
                                                                {1241}let m2_1690: bitstring = dec(em2_1688,skCli_1223) in
                                                                {1242}if (verify(h(m2_1690),sigM2_1689,pkSess_1682) <> true) then
                                                                    0
                                                                else
                                                                    {1243}let (=OpenSecureChannelResponse,wNs_1691: bitstring,ST_1692: bitstring,TTL_1693: bitstring) = m2_1690 in
                                                                    {1244}let Ns_1694: bitstring = dec(wNs_1691,skCli_1223) in
                                                                    {1245}let Kcli_1695: bitstring = h((Nc_1685,Ns_1694)) in
                                                                    {1246}out(c, senc(mCli(pkCli_1224,pkSess_1682),Kcli_1695))
                                                        )
                                                        else
                                                            {1247}let pkSess_1696: bitstring = fail-any in
                                                            {1248}out(c, GetEndpointRequest);
                                                            {1249}in(c, (=GetEndpointResponse,=pkSess_1696,=SignAndEncrypt,SP_1697: bitstring,UP_1698: bitstring));
                                                            {1250}new Nc_1699: bitstring;
                                                            {1251}let wNc_1700: bitstring = enc(Nc_1699,pkSess_1696) in
                                                            {1252}let m1_1701: bitstring = (OpenSecureChannelRequest,pkCli_1224,wNc_1700) in
                                                            {1253}out(c, (pkCli_1224,enc(m1_1701,pkSess_1696),sign(h(m1_1701),skCli_1223)));
                                                            {1254}in(c, (em2_1702: bitstring,sigM2_1703: bitstring));
                                                            {1255}let m2_1704: bitstring = dec(em2_1702,skCli_1223) in
                                                            {1256}if (verify(h(m2_1704),sigM2_1703,pkSess_1696) <> true) then
                                                                0
                                                            else
                                                                {1257}let (=OpenSecureChannelResponse,wNs_1705: bitstring,ST_1706: bitstring,TTL_1707: bitstring) = m2_1704 in
                                                                {1258}let Ns_1708: bitstring = dec(wNs_1705,skCli_1223) in
                                                                {1259}let Kcli_1709: bitstring = h((Nc_1699,Ns_1708)) in
                                                                {1260}out(c, senc(mCli(pkCli_1224,pkSess_1696),Kcli_1709))
                                                )
                                                else
                                                    {1261}let pkSess_1710: bitstring = fail-any in
                                                    {1262}out(c, GetEndpointRequest);
                                                    {1263}in(c, (=GetEndpointResponse,=pkSess_1710,=SignAndEncrypt,SP_1711: bitstring,UP_1712: bitstring));
                                                    {1264}new Nc_1713: bitstring;
                                                    {1265}let wNc_1714: bitstring = enc(Nc_1713,pkSess_1710) in
                                                    {1266}let m1_1715: bitstring = (OpenSecureChannelRequest,pkCli_1224,wNc_1714) in
                                                    {1267}out(c, (pkCli_1224,enc(m1_1715,pkSess_1710),sign(h(m1_1715),skCli_1223)));
                                                    {1268}in(c, (em2_1716: bitstring,sigM2_1717: bitstring));
                                                    {1269}let m2_1718: bitstring = dec(em2_1716,skCli_1223) in
                                                    {1270}if (verify(h(m2_1718),sigM2_1717,pkSess_1710) <> true) then
                                                        0
                                                    else
                                                        {1271}let (=OpenSecureChannelResponse,wNs_1719: bitstring,ST_1720: bitstring,TTL_1721: bitstring) = m2_1718 in
                                                        {1272}let Ns_1722: bitstring = dec(wNs_1719,skCli_1223) in
                                                        {1273}let Kcli_1723: bitstring = h((Nc_1713,Ns_1722)) in
                                                        {1274}out(c, senc(mCli(pkCli_1224,pkSess_1710),Kcli_1723))
                                        )
                                        else
                                            {1275}let pkSess_1724: bitstring = fail-any in
                                            {1276}out(c, GetEndpointRequest);
                                            {1277}in(c, (=GetEndpointResponse,=pkSess_1724,=SignAndEncrypt,SP_1725: bitstring,UP_1726: bitstring));
                                            {1278}new Nc_1727: bitstring;
                                            {1279}let wNc_1728: bitstring = enc(Nc_1727,pkSess_1724) in
                                            {1280}let m1_1729: bitstring = (OpenSecureChannelRequest,pkCli_1224,wNc_1728) in
                                            {1281}out(c, (pkCli_1224,enc(m1_1729,pkSess_1724),sign(h(m1_1729),skCli_1223)));
                                            {1282}in(c, (em2_1730: bitstring,sigM2_1731: bitstring));
                                            {1283}let m2_1732: bitstring = dec(em2_1730,skCli_1223) in
                                            {1284}if (verify(h(m2_1732),sigM2_1731,pkSess_1724) <> true) then
                                                0
                                            else
                                                {1285}let (=OpenSecureChannelResponse,wNs_1733: bitstring,ST_1734: bitstring,TTL_1735: bitstring) = m2_1732 in
                                                {1286}let Ns_1736: bitstring = dec(wNs_1733,skCli_1223) in
                                                {1287}let Kcli_1737: bitstring = h((Nc_1727,Ns_1736)) in
                                                {1288}out(c, senc(mCli(pkCli_1224,pkSess_1724),Kcli_1737))
                            )
                            else
                                {1289}let pkDisco_1738: bitstring = fail-any in
                                {1290}let v_1739: bool = (Sess = A) in
                                (
                                    {1291}if v_1739 then
                                    (
                                        {1292}let pkSess_1740: bitstring = pub(skA) in
                                        {1293}out(c, GetEndpointRequest);
                                        {1294}in(c, (=GetEndpointResponse,=pkSess_1740,=SignAndEncrypt,SP_1741: bitstring,UP_1742: bitstring));
                                        {1295}new Nc_1743: bitstring;
                                        {1296}let wNc_1744: bitstring = enc(Nc_1743,pkSess_1740) in
                                        {1297}let m1_1745: bitstring = (OpenSecureChannelRequest,pkCli_1224,wNc_1744) in
                                        {1298}out(c, (pkCli_1224,enc(m1_1745,pkSess_1740),sign(h(m1_1745),skCli_1223)));
                                        {1299}in(c, (em2_1746: bitstring,sigM2_1747: bitstring));
                                        {1300}let m2_1748: bitstring = dec(em2_1746,skCli_1223) in
                                        {1301}if (verify(h(m2_1748),sigM2_1747,pkSess_1740) <> true) then
                                            0
                                        else
                                            {1302}let (=OpenSecureChannelResponse,wNs_1749: bitstring,ST_1750: bitstring,TTL_1751: bitstring) = m2_1748 in
                                            {1303}let Ns_1752: bitstring = dec(wNs_1749,skCli_1223) in
                                            {1304}let Kcli_1753: bitstring = h((Nc_1743,Ns_1752)) in
                                            {1305}out(c, senc(mCli(pkCli_1224,pkSess_1740),Kcli_1753))
                                    )
                                    else
                                        {1306}let v_1754: bool = (Sess = B) in
                                        (
                                            {1307}if v_1754 then
                                            (
                                                {1308}let pkSess_1755: bitstring = pub(skB) in
                                                {1309}out(c, GetEndpointRequest);
                                                {1310}in(c, (=GetEndpointResponse,=pkSess_1755,=SignAndEncrypt,SP_1756: bitstring,UP_1757: bitstring));
                                                {1311}new Nc_1758: bitstring;
                                                {1312}let wNc_1759: bitstring = enc(Nc_1758,pkSess_1755) in
                                                {1313}let m1_1760: bitstring = (OpenSecureChannelRequest,pkCli_1224,wNc_1759) in
                                                {1314}out(c, (pkCli_1224,enc(m1_1760,pkSess_1755),sign(h(m1_1760),skCli_1223)));
                                                {1315}in(c, (em2_1761: bitstring,sigM2_1762: bitstring));
                                                {1316}let m2_1763: bitstring = dec(em2_1761,skCli_1223) in
                                                {1317}if (verify(h(m2_1763),sigM2_1762,pkSess_1755) <> true) then
                                                    0
                                                else
                                                    {1318}let (=OpenSecureChannelResponse,wNs_1764: bitstring,ST_1765: bitstring,TTL_1766: bitstring) = m2_1763 in
                                                    {1319}let Ns_1767: bitstring = dec(wNs_1764,skCli_1223) in
                                                    {1320}let Kcli_1768: bitstring = h((Nc_1758,Ns_1767)) in
                                                    {1321}out(c, senc(mCli(pkCli_1224,pkSess_1755),Kcli_1768))
                                            )
                                            else
                                                {1322}let v_1769: bool = (Sess = C) in
                                                (
                                                    {1323}if v_1769 then
                                                    (
                                                        {1324}let pkSess_1770: bitstring = pub(skC) in
                                                        {1325}out(c, GetEndpointRequest);
                                                        {1326}in(c, (=GetEndpointResponse,=pkSess_1770,=SignAndEncrypt,SP_1771: bitstring,UP_1772: bitstring));
                                                        {1327}new Nc_1773: bitstring;
                                                        {1328}let wNc_1774: bitstring = enc(Nc_1773,pkSess_1770) in
                                                        {1329}let m1_1775: bitstring = (OpenSecureChannelRequest,pkCli_1224,wNc_1774) in
                                                        {1330}out(c, (pkCli_1224,enc(m1_1775,pkSess_1770),sign(h(m1_1775),skCli_1223)));
                                                        {1331}in(c, (em2_1776: bitstring,sigM2_1777: bitstring));
                                                        {1332}let m2_1778: bitstring = dec(em2_1776,skCli_1223) in
                                                        {1333}if (verify(h(m2_1778),sigM2_1777,pkSess_1770) <> true) then
                                                            0
                                                        else
                                                            {1334}let (=OpenSecureChannelResponse,wNs_1779: bitstring,ST_1780: bitstring,TTL_1781: bitstring) = m2_1778 in
                                                            {1335}let Ns_1782: bitstring = dec(wNs_1779,skCli_1223) in
                                                            {1336}let Kcli_1783: bitstring = h((Nc_1773,Ns_1782)) in
                                                            {1337}out(c, senc(mCli(pkCli_1224,pkSess_1770),Kcli_1783))
                                                    )
                                                    else
                                                        {1338}let pkSess_1784: bitstring = pub(sk(Sess)) in
                                                        {1339}out(c, GetEndpointRequest);
                                                        {1340}in(c, (=GetEndpointResponse,=pkSess_1784,=SignAndEncrypt,SP_1785: bitstring,UP_1786: bitstring));
                                                        {1341}new Nc_1787: bitstring;
                                                        {1342}let wNc_1788: bitstring = enc(Nc_1787,pkSess_1784) in
                                                        {1343}let m1_1789: bitstring = (OpenSecureChannelRequest,pkCli_1224,wNc_1788) in
                                                        {1344}out(c, (pkCli_1224,enc(m1_1789,pkSess_1784),sign(h(m1_1789),skCli_1223)));
                                                        {1345}in(c, (em2_1790: bitstring,sigM2_1791: bitstring));
                                                        {1346}let m2_1792: bitstring = dec(em2_1790,skCli_1223) in
                                                        {1347}if (verify(h(m2_1792),sigM2_1791,pkSess_1784) <> true) then
                                                            0
                                                        else
                                                            {1348}let (=OpenSecureChannelResponse,wNs_1793: bitstring,ST_1794: bitstring,TTL_1795: bitstring) = m2_1792 in
                                                            {1349}let Ns_1796: bitstring = dec(wNs_1793,skCli_1223) in
                                                            {1350}let Kcli_1797: bitstring = h((Nc_1787,Ns_1796)) in
                                                            {1351}out(c, senc(mCli(pkCli_1224,pkSess_1784),Kcli_1797))
                                                )
                                                else
                                                    {1352}let pkSess_1798: bitstring = fail-any in
                                                    {1353}out(c, GetEndpointRequest);
                                                    {1354}in(c, (=GetEndpointResponse,=pkSess_1798,=SignAndEncrypt,SP_1799: bitstring,UP_1800: bitstring));
                                                    {1355}new Nc_1801: bitstring;
                                                    {1356}let wNc_1802: bitstring = enc(Nc_1801,pkSess_1798) in
                                                    {1357}let m1_1803: bitstring = (OpenSecureChannelRequest,pkCli_1224,wNc_1802) in
                                                    {1358}out(c, (pkCli_1224,enc(m1_1803,pkSess_1798),sign(h(m1_1803),skCli_1223)));
                                                    {1359}in(c, (em2_1804: bitstring,sigM2_1805: bitstring));
                                                    {1360}let m2_1806: bitstring = dec(em2_1804,skCli_1223) in
                                                    {1361}if (verify(h(m2_1806),sigM2_1805,pkSess_1798) <> true) then
                                                        0
                                                    else
                                                        {1362}let (=OpenSecureChannelResponse,wNs_1807: bitstring,ST_1808: bitstring,TTL_1809: bitstring) = m2_1806 in
                                                        {1363}let Ns_1810: bitstring = dec(wNs_1807,skCli_1223) in
                                                        {1364}let Kcli_1811: bitstring = h((Nc_1801,Ns_1810)) in
                                                        {1365}out(c, senc(mCli(pkCli_1224,pkSess_1798),Kcli_1811))
                                        )
                                        else
                                            {1366}let pkSess_1812: bitstring = fail-any in
                                            {1367}out(c, GetEndpointRequest);
                                            {1368}in(c, (=GetEndpointResponse,=pkSess_1812,=SignAndEncrypt,SP_1813: bitstring,UP_1814: bitstring));
                                            {1369}new Nc_1815: bitstring;
                                            {1370}let wNc_1816: bitstring = enc(Nc_1815,pkSess_1812) in
                                            {1371}let m1_1817: bitstring = (OpenSecureChannelRequest,pkCli_1224,wNc_1816) in
                                            {1372}out(c, (pkCli_1224,enc(m1_1817,pkSess_1812),sign(h(m1_1817),skCli_1223)));
                                            {1373}in(c, (em2_1818: bitstring,sigM2_1819: bitstring));
                                            {1374}let m2_1820: bitstring = dec(em2_1818,skCli_1223) in
                                            {1375}if (verify(h(m2_1820),sigM2_1819,pkSess_1812) <> true) then
                                                0
                                            else
                                                {1376}let (=OpenSecureChannelResponse,wNs_1821: bitstring,ST_1822: bitstring,TTL_1823: bitstring) = m2_1820 in
                                                {1377}let Ns_1824: bitstring = dec(wNs_1821,skCli_1223) in
                                                {1378}let Kcli_1825: bitstring = h((Nc_1815,Ns_1824)) in
                                                {1379}out(c, senc(mCli(pkCli_1224,pkSess_1812),Kcli_1825))
                                )
                                else
                                    {1380}let pkSess_1826: bitstring = fail-any in
                                    {1381}out(c, GetEndpointRequest);
                                    {1382}in(c, (=GetEndpointResponse,=pkSess_1826,=SignAndEncrypt,SP_1827: bitstring,UP_1828: bitstring));
                                    {1383}new Nc_1829: bitstring;
                                    {1384}let wNc_1830: bitstring = enc(Nc_1829,pkSess_1826) in
                                    {1385}let m1_1831: bitstring = (OpenSecureChannelRequest,pkCli_1224,wNc_1830) in
                                    {1386}out(c, (pkCli_1224,enc(m1_1831,pkSess_1826),sign(h(m1_1831),skCli_1223)));
                                    {1387}in(c, (em2_1832: bitstring,sigM2_1833: bitstring));
                                    {1388}let m2_1834: bitstring = dec(em2_1832,skCli_1223) in
                                    {1389}if (verify(h(m2_1834),sigM2_1833,pkSess_1826) <> true) then
                                        0
                                    else
                                        {1390}let (=OpenSecureChannelResponse,wNs_1835: bitstring,ST_1836: bitstring,TTL_1837: bitstring) = m2_1834 in
                                        {1391}let Ns_1838: bitstring = dec(wNs_1835,skCli_1223) in
                                        {1392}let Kcli_1839: bitstring = h((Nc_1829,Ns_1838)) in
                                        {1393}out(c, senc(mCli(pkCli_1224,pkSess_1826),Kcli_1839))
                    )
                    else
                        {1394}let pkDisco_1840: bitstring = fail-any in
                        {1395}let v_1841: bool = (Sess = A) in
                        (
                            {1396}if v_1841 then
                            (
                                {1397}let pkSess_1842: bitstring = pub(skA) in
                                {1398}out(c, GetEndpointRequest);
                                {1399}in(c, (=GetEndpointResponse,=pkSess_1842,=SignAndEncrypt,SP_1843: bitstring,UP_1844: bitstring));
                                {1400}new Nc_1845: bitstring;
                                {1401}let wNc_1846: bitstring = enc(Nc_1845,pkSess_1842) in
                                {1402}let m1_1847: bitstring = (OpenSecureChannelRequest,pkCli_1224,wNc_1846) in
                                {1403}out(c, (pkCli_1224,enc(m1_1847,pkSess_1842),sign(h(m1_1847),skCli_1223)));
                                {1404}in(c, (em2_1848: bitstring,sigM2_1849: bitstring));
                                {1405}let m2_1850: bitstring = dec(em2_1848,skCli_1223) in
                                {1406}if (verify(h(m2_1850),sigM2_1849,pkSess_1842) <> true) then
                                    0
                                else
                                    {1407}let (=OpenSecureChannelResponse,wNs_1851: bitstring,ST_1852: bitstring,TTL_1853: bitstring) = m2_1850 in
                                    {1408}let Ns_1854: bitstring = dec(wNs_1851,skCli_1223) in
                                    {1409}let Kcli_1855: bitstring = h((Nc_1845,Ns_1854)) in
                                    {1410}out(c, senc(mCli(pkCli_1224,pkSess_1842),Kcli_1855))
                            )
                            else
                                {1411}let v_1856: bool = (Sess = B) in
                                (
                                    {1412}if v_1856 then
                                    (
                                        {1413}let pkSess_1857: bitstring = pub(skB) in
                                        {1414}out(c, GetEndpointRequest);
                                        {1415}in(c, (=GetEndpointResponse,=pkSess_1857,=SignAndEncrypt,SP_1858: bitstring,UP_1859: bitstring));
                                        {1416}new Nc_1860: bitstring;
                                        {1417}let wNc_1861: bitstring = enc(Nc_1860,pkSess_1857) in
                                        {1418}let m1_1862: bitstring = (OpenSecureChannelRequest,pkCli_1224,wNc_1861) in
                                        {1419}out(c, (pkCli_1224,enc(m1_1862,pkSess_1857),sign(h(m1_1862),skCli_1223)));
                                        {1420}in(c, (em2_1863: bitstring,sigM2_1864: bitstring));
                                        {1421}let m2_1865: bitstring = dec(em2_1863,skCli_1223) in
                                        {1422}if (verify(h(m2_1865),sigM2_1864,pkSess_1857) <> true) then
                                            0
                                        else
                                            {1423}let (=OpenSecureChannelResponse,wNs_1866: bitstring,ST_1867: bitstring,TTL_1868: bitstring) = m2_1865 in
                                            {1424}let Ns_1869: bitstring = dec(wNs_1866,skCli_1223) in
                                            {1425}let Kcli_1870: bitstring = h((Nc_1860,Ns_1869)) in
                                            {1426}out(c, senc(mCli(pkCli_1224,pkSess_1857),Kcli_1870))
                                    )
                                    else
                                        {1427}let v_1871: bool = (Sess = C) in
                                        (
                                            {1428}if v_1871 then
                                            (
                                                {1429}let pkSess_1872: bitstring = pub(skC) in
                                                {1430}out(c, GetEndpointRequest);
                                                {1431}in(c, (=GetEndpointResponse,=pkSess_1872,=SignAndEncrypt,SP_1873: bitstring,UP_1874: bitstring));
                                                {1432}new Nc_1875: bitstring;
                                                {1433}let wNc_1876: bitstring = enc(Nc_1875,pkSess_1872) in
                                                {1434}let m1_1877: bitstring = (OpenSecureChannelRequest,pkCli_1224,wNc_1876) in
                                                {1435}out(c, (pkCli_1224,enc(m1_1877,pkSess_1872),sign(h(m1_1877),skCli_1223)));
                                                {1436}in(c, (em2_1878: bitstring,sigM2_1879: bitstring));
                                                {1437}let m2_1880: bitstring = dec(em2_1878,skCli_1223) in
                                                {1438}if (verify(h(m2_1880),sigM2_1879,pkSess_1872) <> true) then
                                                    0
                                                else
                                                    {1439}let (=OpenSecureChannelResponse,wNs_1881: bitstring,ST_1882: bitstring,TTL_1883: bitstring) = m2_1880 in
                                                    {1440}let Ns_1884: bitstring = dec(wNs_1881,skCli_1223) in
                                                    {1441}let Kcli_1885: bitstring = h((Nc_1875,Ns_1884)) in
                                                    {1442}out(c, senc(mCli(pkCli_1224,pkSess_1872),Kcli_1885))
                                            )
                                            else
                                                {1443}let pkSess_1886: bitstring = pub(sk(Sess)) in
                                                {1444}out(c, GetEndpointRequest);
                                                {1445}in(c, (=GetEndpointResponse,=pkSess_1886,=SignAndEncrypt,SP_1887: bitstring,UP_1888: bitstring));
                                                {1446}new Nc_1889: bitstring;
                                                {1447}let wNc_1890: bitstring = enc(Nc_1889,pkSess_1886) in
                                                {1448}let m1_1891: bitstring = (OpenSecureChannelRequest,pkCli_1224,wNc_1890) in
                                                {1449}out(c, (pkCli_1224,enc(m1_1891,pkSess_1886),sign(h(m1_1891),skCli_1223)));
                                                {1450}in(c, (em2_1892: bitstring,sigM2_1893: bitstring));
                                                {1451}let m2_1894: bitstring = dec(em2_1892,skCli_1223) in
                                                {1452}if (verify(h(m2_1894),sigM2_1893,pkSess_1886) <> true) then
                                                    0
                                                else
                                                    {1453}let (=OpenSecureChannelResponse,wNs_1895: bitstring,ST_1896: bitstring,TTL_1897: bitstring) = m2_1894 in
                                                    {1454}let Ns_1898: bitstring = dec(wNs_1895,skCli_1223) in
                                                    {1455}let Kcli_1899: bitstring = h((Nc_1889,Ns_1898)) in
                                                    {1456}out(c, senc(mCli(pkCli_1224,pkSess_1886),Kcli_1899))
                                        )
                                        else
                                            {1457}let pkSess_1900: bitstring = fail-any in
                                            {1458}out(c, GetEndpointRequest);
                                            {1459}in(c, (=GetEndpointResponse,=pkSess_1900,=SignAndEncrypt,SP_1901: bitstring,UP_1902: bitstring));
                                            {1460}new Nc_1903: bitstring;
                                            {1461}let wNc_1904: bitstring = enc(Nc_1903,pkSess_1900) in
                                            {1462}let m1_1905: bitstring = (OpenSecureChannelRequest,pkCli_1224,wNc_1904) in
                                            {1463}out(c, (pkCli_1224,enc(m1_1905,pkSess_1900),sign(h(m1_1905),skCli_1223)));
                                            {1464}in(c, (em2_1906: bitstring,sigM2_1907: bitstring));
                                            {1465}let m2_1908: bitstring = dec(em2_1906,skCli_1223) in
                                            {1466}if (verify(h(m2_1908),sigM2_1907,pkSess_1900) <> true) then
                                                0
                                            else
                                                {1467}let (=OpenSecureChannelResponse,wNs_1909: bitstring,ST_1910: bitstring,TTL_1911: bitstring) = m2_1908 in
                                                {1468}let Ns_1912: bitstring = dec(wNs_1909,skCli_1223) in
                                                {1469}let Kcli_1913: bitstring = h((Nc_1903,Ns_1912)) in
                                                {1470}out(c, senc(mCli(pkCli_1224,pkSess_1900),Kcli_1913))
                                )
                                else
                                    {1471}let pkSess_1914: bitstring = fail-any in
                                    {1472}out(c, GetEndpointRequest);
                                    {1473}in(c, (=GetEndpointResponse,=pkSess_1914,=SignAndEncrypt,SP_1915: bitstring,UP_1916: bitstring));
                                    {1474}new Nc_1917: bitstring;
                                    {1475}let wNc_1918: bitstring = enc(Nc_1917,pkSess_1914) in
                                    {1476}let m1_1919: bitstring = (OpenSecureChannelRequest,pkCli_1224,wNc_1918) in
                                    {1477}out(c, (pkCli_1224,enc(m1_1919,pkSess_1914),sign(h(m1_1919),skCli_1223)));
                                    {1478}in(c, (em2_1920: bitstring,sigM2_1921: bitstring));
                                    {1479}let m2_1922: bitstring = dec(em2_1920,skCli_1223) in
                                    {1480}if (verify(h(m2_1922),sigM2_1921,pkSess_1914) <> true) then
                                        0
                                    else
                                        {1481}let (=OpenSecureChannelResponse,wNs_1923: bitstring,ST_1924: bitstring,TTL_1925: bitstring) = m2_1922 in
                                        {1482}let Ns_1926: bitstring = dec(wNs_1923,skCli_1223) in
                                        {1483}let Kcli_1927: bitstring = h((Nc_1917,Ns_1926)) in
                                        {1484}out(c, senc(mCli(pkCli_1224,pkSess_1914),Kcli_1927))
                        )
                        else
                            {1485}let pkSess_1928: bitstring = fail-any in
                            {1486}out(c, GetEndpointRequest);
                            {1487}in(c, (=GetEndpointResponse,=pkSess_1928,=SignAndEncrypt,SP_1929: bitstring,UP_1930: bitstring));
                            {1488}new Nc_1931: bitstring;
                            {1489}let wNc_1932: bitstring = enc(Nc_1931,pkSess_1928) in
                            {1490}let m1_1933: bitstring = (OpenSecureChannelRequest,pkCli_1224,wNc_1932) in
                            {1491}out(c, (pkCli_1224,enc(m1_1933,pkSess_1928),sign(h(m1_1933),skCli_1223)));
                            {1492}in(c, (em2_1934: bitstring,sigM2_1935: bitstring));
                            {1493}let m2_1936: bitstring = dec(em2_1934,skCli_1223) in
                            {1494}if (verify(h(m2_1936),sigM2_1935,pkSess_1928) <> true) then
                                0
                            else
                                {1495}let (=OpenSecureChannelResponse,wNs_1937: bitstring,ST_1938: bitstring,TTL_1939: bitstring) = m2_1936 in
                                {1496}let Ns_1940: bitstring = dec(wNs_1937,skCli_1223) in
                                {1497}let Kcli_1941: bitstring = h((Nc_1931,Ns_1940)) in
                                {1498}out(c, senc(mCli(pkCli_1224,pkSess_1928),Kcli_1941))
                )
                else
                    {1499}let =true = (Cli = C) in
                    (
                        {1500}let skCli_1942: bitstring = skC in
                        {1501}let pkCli_1943: bitstring = pub(skCli_1942) in
                        {1502}let v_1944: bool = (Disco = A) in
                        (
                            {1503}if v_1944 then
                            (
                                {1504}let pkDisco_1945: bitstring = pub(skA) in
                                {1505}let v_1946: bool = (Sess = A) in
                                (
                                    {1506}if v_1946 then
                                    (
                                        {1507}let pkSess_1947: bitstring = pub(skA) in
                                        {1508}out(c, GetEndpointRequest);
                                        {1509}in(c, (=GetEndpointResponse,=pkSess_1947,=SignAndEncrypt,SP_1948: bitstring,UP_1949: bitstring));
                                        {1510}new Nc_1950: bitstring;
                                        {1511}let wNc_1951: bitstring = enc(Nc_1950,pkSess_1947) in
                                        {1512}let m1_1952: bitstring = (OpenSecureChannelRequest,pkCli_1943,wNc_1951) in
                                        {1513}out(c, (pkCli_1943,enc(m1_1952,pkSess_1947),sign(h(m1_1952),skCli_1942)));
                                        {1514}in(c, (em2_1953: bitstring,sigM2_1954: bitstring));
                                        {1515}let m2_1955: bitstring = dec(em2_1953,skCli_1942) in
                                        {1516}if (verify(h(m2_1955),sigM2_1954,pkSess_1947) <> true) then
                                            0
                                        else
                                            {1517}let (=OpenSecureChannelResponse,wNs_1956: bitstring,ST_1957: bitstring,TTL_1958: bitstring) = m2_1955 in
                                            {1518}let Ns_1959: bitstring = dec(wNs_1956,skCli_1942) in
                                            {1519}let Kcli_1960: bitstring = h((Nc_1950,Ns_1959)) in
                                            {1520}out(c, senc(mCli(pkCli_1943,pkSess_1947),Kcli_1960))
                                    )
                                    else
                                        {1521}let v_1961: bool = (Sess = B) in
                                        (
                                            {1522}if v_1961 then
                                            (
                                                {1523}let pkSess_1962: bitstring = pub(skB) in
                                                {1524}out(c, GetEndpointRequest);
                                                {1525}in(c, (=GetEndpointResponse,=pkSess_1962,=SignAndEncrypt,SP_1963: bitstring,UP_1964: bitstring));
                                                {1526}new Nc_1965: bitstring;
                                                {1527}let wNc_1966: bitstring = enc(Nc_1965,pkSess_1962) in
                                                {1528}let m1_1967: bitstring = (OpenSecureChannelRequest,pkCli_1943,wNc_1966) in
                                                {1529}out(c, (pkCli_1943,enc(m1_1967,pkSess_1962),sign(h(m1_1967),skCli_1942)));
                                                {1530}in(c, (em2_1968: bitstring,sigM2_1969: bitstring));
                                                {1531}let m2_1970: bitstring = dec(em2_1968,skCli_1942) in
                                                {1532}if (verify(h(m2_1970),sigM2_1969,pkSess_1962) <> true) then
                                                    0
                                                else
                                                    {1533}let (=OpenSecureChannelResponse,wNs_1971: bitstring,ST_1972: bitstring,TTL_1973: bitstring) = m2_1970 in
                                                    {1534}let Ns_1974: bitstring = dec(wNs_1971,skCli_1942) in
                                                    {1535}let Kcli_1975: bitstring = h((Nc_1965,Ns_1974)) in
                                                    {1536}out(c, senc(mCli(pkCli_1943,pkSess_1962),Kcli_1975))
                                            )
                                            else
                                                {1537}let v_1976: bool = (Sess = C) in
                                                (
                                                    {1538}if v_1976 then
                                                    (
                                                        {1539}let pkSess_1977: bitstring = pub(skC) in
                                                        {1540}out(c, GetEndpointRequest);
                                                        {1541}in(c, (=GetEndpointResponse,=pkSess_1977,=SignAndEncrypt,SP_1978: bitstring,UP_1979: bitstring));
                                                        {1542}new Nc_1980: bitstring;
                                                        {1543}let wNc_1981: bitstring = enc(Nc_1980,pkSess_1977) in
                                                        {1544}let m1_1982: bitstring = (OpenSecureChannelRequest,pkCli_1943,wNc_1981) in
                                                        {1545}out(c, (pkCli_1943,enc(m1_1982,pkSess_1977),sign(h(m1_1982),skCli_1942)));
                                                        {1546}in(c, (em2_1983: bitstring,sigM2_1984: bitstring));
                                                        {1547}let m2_1985: bitstring = dec(em2_1983,skCli_1942) in
                                                        {1548}if (verify(h(m2_1985),sigM2_1984,pkSess_1977) <> true) then
                                                            0
                                                        else
                                                            {1549}let (=OpenSecureChannelResponse,wNs_1986: bitstring,ST_1987: bitstring,TTL_1988: bitstring) = m2_1985 in
                                                            {1550}let Ns_1989: bitstring = dec(wNs_1986,skCli_1942) in
                                                            {1551}let Kcli_1990: bitstring = h((Nc_1980,Ns_1989)) in
                                                            {1552}out(c, senc(mCli(pkCli_1943,pkSess_1977),Kcli_1990))
                                                    )
                                                    else
                                                        {1553}let pkSess_1991: bitstring = pub(sk(Sess)) in
                                                        {1554}out(c, GetEndpointRequest);
                                                        {1555}in(c, (=GetEndpointResponse,=pkSess_1991,=SignAndEncrypt,SP_1992: bitstring,UP_1993: bitstring));
                                                        {1556}new Nc_1994: bitstring;
                                                        {1557}let wNc_1995: bitstring = enc(Nc_1994,pkSess_1991) in
                                                        {1558}let m1_1996: bitstring = (OpenSecureChannelRequest,pkCli_1943,wNc_1995) in
                                                        {1559}out(c, (pkCli_1943,enc(m1_1996,pkSess_1991),sign(h(m1_1996),skCli_1942)));
                                                        {1560}in(c, (em2_1997: bitstring,sigM2_1998: bitstring));
                                                        {1561}let m2_1999: bitstring = dec(em2_1997,skCli_1942) in
                                                        {1562}if (verify(h(m2_1999),sigM2_1998,pkSess_1991) <> true) then
                                                            0
                                                        else
                                                            {1563}let (=OpenSecureChannelResponse,wNs_2000: bitstring,ST_2001: bitstring,TTL_2002: bitstring) = m2_1999 in
                                                            {1564}let Ns_2003: bitstring = dec(wNs_2000,skCli_1942) in
                                                            {1565}let Kcli_2004: bitstring = h((Nc_1994,Ns_2003)) in
                                                            {1566}out(c, senc(mCli(pkCli_1943,pkSess_1991),Kcli_2004))
                                                )
                                                else
                                                    {1567}let pkSess_2005: bitstring = fail-any in
                                                    {1568}out(c, GetEndpointRequest);
                                                    {1569}in(c, (=GetEndpointResponse,=pkSess_2005,=SignAndEncrypt,SP_2006: bitstring,UP_2007: bitstring));
                                                    {1570}new Nc_2008: bitstring;
                                                    {1571}let wNc_2009: bitstring = enc(Nc_2008,pkSess_2005) in
                                                    {1572}let m1_2010: bitstring = (OpenSecureChannelRequest,pkCli_1943,wNc_2009) in
                                                    {1573}out(c, (pkCli_1943,enc(m1_2010,pkSess_2005),sign(h(m1_2010),skCli_1942)));
                                                    {1574}in(c, (em2_2011: bitstring,sigM2_2012: bitstring));
                                                    {1575}let m2_2013: bitstring = dec(em2_2011,skCli_1942) in
                                                    {1576}if (verify(h(m2_2013),sigM2_2012,pkSess_2005) <> true) then
                                                        0
                                                    else
                                                        {1577}let (=OpenSecureChannelResponse,wNs_2014: bitstring,ST_2015: bitstring,TTL_2016: bitstring) = m2_2013 in
                                                        {1578}let Ns_2017: bitstring = dec(wNs_2014,skCli_1942) in
                                                        {1579}let Kcli_2018: bitstring = h((Nc_2008,Ns_2017)) in
                                                        {1580}out(c, senc(mCli(pkCli_1943,pkSess_2005),Kcli_2018))
                                        )
                                        else
                                            {1581}let pkSess_2019: bitstring = fail-any in
                                            {1582}out(c, GetEndpointRequest);
                                            {1583}in(c, (=GetEndpointResponse,=pkSess_2019,=SignAndEncrypt,SP_2020: bitstring,UP_2021: bitstring));
                                            {1584}new Nc_2022: bitstring;
                                            {1585}let wNc_2023: bitstring = enc(Nc_2022,pkSess_2019) in
                                            {1586}let m1_2024: bitstring = (OpenSecureChannelRequest,pkCli_1943,wNc_2023) in
                                            {1587}out(c, (pkCli_1943,enc(m1_2024,pkSess_2019),sign(h(m1_2024),skCli_1942)));
                                            {1588}in(c, (em2_2025: bitstring,sigM2_2026: bitstring));
                                            {1589}let m2_2027: bitstring = dec(em2_2025,skCli_1942) in
                                            {1590}if (verify(h(m2_2027),sigM2_2026,pkSess_2019) <> true) then
                                                0
                                            else
                                                {1591}let (=OpenSecureChannelResponse,wNs_2028: bitstring,ST_2029: bitstring,TTL_2030: bitstring) = m2_2027 in
                                                {1592}let Ns_2031: bitstring = dec(wNs_2028,skCli_1942) in
                                                {1593}let Kcli_2032: bitstring = h((Nc_2022,Ns_2031)) in
                                                {1594}out(c, senc(mCli(pkCli_1943,pkSess_2019),Kcli_2032))
                                )
                                else
                                    {1595}let pkSess_2033: bitstring = fail-any in
                                    {1596}out(c, GetEndpointRequest);
                                    {1597}in(c, (=GetEndpointResponse,=pkSess_2033,=SignAndEncrypt,SP_2034: bitstring,UP_2035: bitstring));
                                    {1598}new Nc_2036: bitstring;
                                    {1599}let wNc_2037: bitstring = enc(Nc_2036,pkSess_2033) in
                                    {1600}let m1_2038: bitstring = (OpenSecureChannelRequest,pkCli_1943,wNc_2037) in
                                    {1601}out(c, (pkCli_1943,enc(m1_2038,pkSess_2033),sign(h(m1_2038),skCli_1942)));
                                    {1602}in(c, (em2_2039: bitstring,sigM2_2040: bitstring));
                                    {1603}let m2_2041: bitstring = dec(em2_2039,skCli_1942) in
                                    {1604}if (verify(h(m2_2041),sigM2_2040,pkSess_2033) <> true) then
                                        0
                                    else
                                        {1605}let (=OpenSecureChannelResponse,wNs_2042: bitstring,ST_2043: bitstring,TTL_2044: bitstring) = m2_2041 in
                                        {1606}let Ns_2045: bitstring = dec(wNs_2042,skCli_1942) in
                                        {1607}let Kcli_2046: bitstring = h((Nc_2036,Ns_2045)) in
                                        {1608}out(c, senc(mCli(pkCli_1943,pkSess_2033),Kcli_2046))
                            )
                            else
                                {1609}let v_2047: bool = (Disco = B) in
                                (
                                    {1610}if v_2047 then
                                    (
                                        {1611}let pkDisco_2048: bitstring = pub(skB) in
                                        {1612}let v_2049: bool = (Sess = A) in
                                        (
                                            {1613}if v_2049 then
                                            (
                                                {1614}let pkSess_2050: bitstring = pub(skA) in
                                                {1615}out(c, GetEndpointRequest);
                                                {1616}in(c, (=GetEndpointResponse,=pkSess_2050,=SignAndEncrypt,SP_2051: bitstring,UP_2052: bitstring));
                                                {1617}new Nc_2053: bitstring;
                                                {1618}let wNc_2054: bitstring = enc(Nc_2053,pkSess_2050) in
                                                {1619}let m1_2055: bitstring = (OpenSecureChannelRequest,pkCli_1943,wNc_2054) in
                                                {1620}out(c, (pkCli_1943,enc(m1_2055,pkSess_2050),sign(h(m1_2055),skCli_1942)));
                                                {1621}in(c, (em2_2056: bitstring,sigM2_2057: bitstring));
                                                {1622}let m2_2058: bitstring = dec(em2_2056,skCli_1942) in
                                                {1623}if (verify(h(m2_2058),sigM2_2057,pkSess_2050) <> true) then
                                                    0
                                                else
                                                    {1624}let (=OpenSecureChannelResponse,wNs_2059: bitstring,ST_2060: bitstring,TTL_2061: bitstring) = m2_2058 in
                                                    {1625}let Ns_2062: bitstring = dec(wNs_2059,skCli_1942) in
                                                    {1626}let Kcli_2063: bitstring = h((Nc_2053,Ns_2062)) in
                                                    {1627}out(c, senc(mCli(pkCli_1943,pkSess_2050),Kcli_2063))
                                            )
                                            else
                                                {1628}let v_2064: bool = (Sess = B) in
                                                (
                                                    {1629}if v_2064 then
                                                    (
                                                        {1630}let pkSess_2065: bitstring = pub(skB) in
                                                        {1631}out(c, GetEndpointRequest);
                                                        {1632}in(c, (=GetEndpointResponse,=pkSess_2065,=SignAndEncrypt,SP_2066: bitstring,UP_2067: bitstring));
                                                        {1633}new Nc_2068: bitstring;
                                                        {1634}let wNc_2069: bitstring = enc(Nc_2068,pkSess_2065) in
                                                        {1635}let m1_2070: bitstring = (OpenSecureChannelRequest,pkCli_1943,wNc_2069) in
                                                        {1636}out(c, (pkCli_1943,enc(m1_2070,pkSess_2065),sign(h(m1_2070),skCli_1942)));
                                                        {1637}in(c, (em2_2071: bitstring,sigM2_2072: bitstring));
                                                        {1638}let m2_2073: bitstring = dec(em2_2071,skCli_1942) in
                                                        {1639}if (verify(h(m2_2073),sigM2_2072,pkSess_2065) <> true) then
                                                            0
                                                        else
                                                            {1640}let (=OpenSecureChannelResponse,wNs_2074: bitstring,ST_2075: bitstring,TTL_2076: bitstring) = m2_2073 in
                                                            {1641}let Ns_2077: bitstring = dec(wNs_2074,skCli_1942) in
                                                            {1642}let Kcli_2078: bitstring = h((Nc_2068,Ns_2077)) in
                                                            {1643}out(c, senc(mCli(pkCli_1943,pkSess_2065),Kcli_2078))
                                                    )
                                                    else
                                                        {1644}let v_2079: bool = (Sess = C) in
                                                        (
                                                            {1645}if v_2079 then
                                                            (
                                                                {1646}let pkSess_2080: bitstring = pub(skC) in
                                                                {1647}out(c, GetEndpointRequest);
                                                                {1648}in(c, (=GetEndpointResponse,=pkSess_2080,=SignAndEncrypt,SP_2081: bitstring,UP_2082: bitstring));
                                                                {1649}new Nc_2083: bitstring;
                                                                {1650}let wNc_2084: bitstring = enc(Nc_2083,pkSess_2080) in
                                                                {1651}let m1_2085: bitstring = (OpenSecureChannelRequest,pkCli_1943,wNc_2084) in
                                                                {1652}out(c, (pkCli_1943,enc(m1_2085,pkSess_2080),sign(h(m1_2085),skCli_1942)));
                                                                {1653}in(c, (em2_2086: bitstring,sigM2_2087: bitstring));
                                                                {1654}let m2_2088: bitstring = dec(em2_2086,skCli_1942) in
                                                                {1655}if (verify(h(m2_2088),sigM2_2087,pkSess_2080) <> true) then
                                                                    0
                                                                else
                                                                    {1656}let (=OpenSecureChannelResponse,wNs_2089: bitstring,ST_2090: bitstring,TTL_2091: bitstring) = m2_2088 in
                                                                    {1657}let Ns_2092: bitstring = dec(wNs_2089,skCli_1942) in
                                                                    {1658}let Kcli_2093: bitstring = h((Nc_2083,Ns_2092)) in
                                                                    {1659}out(c, senc(mCli(pkCli_1943,pkSess_2080),Kcli_2093))
                                                            )
                                                            else
                                                                {1660}let pkSess_2094: bitstring = pub(sk(Sess)) in
                                                                {1661}out(c, GetEndpointRequest);
                                                                {1662}in(c, (=GetEndpointResponse,=pkSess_2094,=SignAndEncrypt,SP_2095: bitstring,UP_2096: bitstring));
                                                                {1663}new Nc_2097: bitstring;
                                                                {1664}let wNc_2098: bitstring = enc(Nc_2097,pkSess_2094) in
                                                                {1665}let m1_2099: bitstring = (OpenSecureChannelRequest,pkCli_1943,wNc_2098) in
                                                                {1666}out(c, (pkCli_1943,enc(m1_2099,pkSess_2094),sign(h(m1_2099),skCli_1942)));
                                                                {1667}in(c, (em2_2100: bitstring,sigM2_2101: bitstring));
                                                                {1668}let m2_2102: bitstring = dec(em2_2100,skCli_1942) in
                                                                {1669}if (verify(h(m2_2102),sigM2_2101,pkSess_2094) <> true) then
                                                                    0
                                                                else
                                                                    {1670}let (=OpenSecureChannelResponse,wNs_2103: bitstring,ST_2104: bitstring,TTL_2105: bitstring) = m2_2102 in
                                                                    {1671}let Ns_2106: bitstring = dec(wNs_2103,skCli_1942) in
                                                                    {1672}let Kcli_2107: bitstring = h((Nc_2097,Ns_2106)) in
                                                                    {1673}out(c, senc(mCli(pkCli_1943,pkSess_2094),Kcli_2107))
                                                        )
                                                        else
                                                            {1674}let pkSess_2108: bitstring = fail-any in
                                                            {1675}out(c, GetEndpointRequest);
                                                            {1676}in(c, (=GetEndpointResponse,=pkSess_2108,=SignAndEncrypt,SP_2109: bitstring,UP_2110: bitstring));
                                                            {1677}new Nc_2111: bitstring;
                                                            {1678}let wNc_2112: bitstring = enc(Nc_2111,pkSess_2108) in
                                                            {1679}let m1_2113: bitstring = (OpenSecureChannelRequest,pkCli_1943,wNc_2112) in
                                                            {1680}out(c, (pkCli_1943,enc(m1_2113,pkSess_2108),sign(h(m1_2113),skCli_1942)));
                                                            {1681}in(c, (em2_2114: bitstring,sigM2_2115: bitstring));
                                                            {1682}let m2_2116: bitstring = dec(em2_2114,skCli_1942) in
                                                            {1683}if (verify(h(m2_2116),sigM2_2115,pkSess_2108) <> true) then
                                                                0
                                                            else
                                                                {1684}let (=OpenSecureChannelResponse,wNs_2117: bitstring,ST_2118: bitstring,TTL_2119: bitstring) = m2_2116 in
                                                                {1685}let Ns_2120: bitstring = dec(wNs_2117,skCli_1942) in
                                                                {1686}let Kcli_2121: bitstring = h((Nc_2111,Ns_2120)) in
                                                                {1687}out(c, senc(mCli(pkCli_1943,pkSess_2108),Kcli_2121))
                                                )
                                                else
                                                    {1688}let pkSess_2122: bitstring = fail-any in
                                                    {1689}out(c, GetEndpointRequest);
                                                    {1690}in(c, (=GetEndpointResponse,=pkSess_2122,=SignAndEncrypt,SP_2123: bitstring,UP_2124: bitstring));
                                                    {1691}new Nc_2125: bitstring;
                                                    {1692}let wNc_2126: bitstring = enc(Nc_2125,pkSess_2122) in
                                                    {1693}let m1_2127: bitstring = (OpenSecureChannelRequest,pkCli_1943,wNc_2126) in
                                                    {1694}out(c, (pkCli_1943,enc(m1_2127,pkSess_2122),sign(h(m1_2127),skCli_1942)));
                                                    {1695}in(c, (em2_2128: bitstring,sigM2_2129: bitstring));
                                                    {1696}let m2_2130: bitstring = dec(em2_2128,skCli_1942) in
                                                    {1697}if (verify(h(m2_2130),sigM2_2129,pkSess_2122) <> true) then
                                                        0
                                                    else
                                                        {1698}let (=OpenSecureChannelResponse,wNs_2131: bitstring,ST_2132: bitstring,TTL_2133: bitstring) = m2_2130 in
                                                        {1699}let Ns_2134: bitstring = dec(wNs_2131,skCli_1942) in
                                                        {1700}let Kcli_2135: bitstring = h((Nc_2125,Ns_2134)) in
                                                        {1701}out(c, senc(mCli(pkCli_1943,pkSess_2122),Kcli_2135))
                                        )
                                        else
                                            {1702}let pkSess_2136: bitstring = fail-any in
                                            {1703}out(c, GetEndpointRequest);
                                            {1704}in(c, (=GetEndpointResponse,=pkSess_2136,=SignAndEncrypt,SP_2137: bitstring,UP_2138: bitstring));
                                            {1705}new Nc_2139: bitstring;
                                            {1706}let wNc_2140: bitstring = enc(Nc_2139,pkSess_2136) in
                                            {1707}let m1_2141: bitstring = (OpenSecureChannelRequest,pkCli_1943,wNc_2140) in
                                            {1708}out(c, (pkCli_1943,enc(m1_2141,pkSess_2136),sign(h(m1_2141),skCli_1942)));
                                            {1709}in(c, (em2_2142: bitstring,sigM2_2143: bitstring));
                                            {1710}let m2_2144: bitstring = dec(em2_2142,skCli_1942) in
                                            {1711}if (verify(h(m2_2144),sigM2_2143,pkSess_2136) <> true) then
                                                0
                                            else
                                                {1712}let (=OpenSecureChannelResponse,wNs_2145: bitstring,ST_2146: bitstring,TTL_2147: bitstring) = m2_2144 in
                                                {1713}let Ns_2148: bitstring = dec(wNs_2145,skCli_1942) in
                                                {1714}let Kcli_2149: bitstring = h((Nc_2139,Ns_2148)) in
                                                {1715}out(c, senc(mCli(pkCli_1943,pkSess_2136),Kcli_2149))
                                    )
                                    else
                                        {1716}let v_2150: bool = (Disco = C) in
                                        (
                                            {1717}if v_2150 then
                                            (
                                                {1718}let pkDisco_2151: bitstring = pub(skC) in
                                                {1719}let v_2152: bool = (Sess = A) in
                                                (
                                                    {1720}if v_2152 then
                                                    (
                                                        {1721}let pkSess_2153: bitstring = pub(skA) in
                                                        {1722}out(c, GetEndpointRequest);
                                                        {1723}in(c, (=GetEndpointResponse,=pkSess_2153,=SignAndEncrypt,SP_2154: bitstring,UP_2155: bitstring));
                                                        {1724}new Nc_2156: bitstring;
                                                        {1725}let wNc_2157: bitstring = enc(Nc_2156,pkSess_2153) in
                                                        {1726}let m1_2158: bitstring = (OpenSecureChannelRequest,pkCli_1943,wNc_2157) in
                                                        {1727}out(c, (pkCli_1943,enc(m1_2158,pkSess_2153),sign(h(m1_2158),skCli_1942)));
                                                        {1728}in(c, (em2_2159: bitstring,sigM2_2160: bitstring));
                                                        {1729}let m2_2161: bitstring = dec(em2_2159,skCli_1942) in
                                                        {1730}if (verify(h(m2_2161),sigM2_2160,pkSess_2153) <> true) then
                                                            0
                                                        else
                                                            {1731}let (=OpenSecureChannelResponse,wNs_2162: bitstring,ST_2163: bitstring,TTL_2164: bitstring) = m2_2161 in
                                                            {1732}let Ns_2165: bitstring = dec(wNs_2162,skCli_1942) in
                                                            {1733}let Kcli_2166: bitstring = h((Nc_2156,Ns_2165)) in
                                                            {1734}out(c, senc(mCli(pkCli_1943,pkSess_2153),Kcli_2166))
                                                    )
                                                    else
                                                        {1735}let v_2167: bool = (Sess = B) in
                                                        (
                                                            {1736}if v_2167 then
                                                            (
                                                                {1737}let pkSess_2168: bitstring = pub(skB) in
                                                                {1738}out(c, GetEndpointRequest);
                                                                {1739}in(c, (=GetEndpointResponse,=pkSess_2168,=SignAndEncrypt,SP_2169: bitstring,UP_2170: bitstring));
                                                                {1740}new Nc_2171: bitstring;
                                                                {1741}let wNc_2172: bitstring = enc(Nc_2171,pkSess_2168) in
                                                                {1742}let m1_2173: bitstring = (OpenSecureChannelRequest,pkCli_1943,wNc_2172) in
                                                                {1743}out(c, (pkCli_1943,enc(m1_2173,pkSess_2168),sign(h(m1_2173),skCli_1942)));
                                                                {1744}in(c, (em2_2174: bitstring,sigM2_2175: bitstring));
                                                                {1745}let m2_2176: bitstring = dec(em2_2174,skCli_1942) in
                                                                {1746}if (verify(h(m2_2176),sigM2_2175,pkSess_2168) <> true) then
                                                                    0
                                                                else
                                                                    {1747}let (=OpenSecureChannelResponse,wNs_2177: bitstring,ST_2178: bitstring,TTL_2179: bitstring) = m2_2176 in
                                                                    {1748}let Ns_2180: bitstring = dec(wNs_2177,skCli_1942) in
                                                                    {1749}let Kcli_2181: bitstring = h((Nc_2171,Ns_2180)) in
                                                                    {1750}out(c, senc(mCli(pkCli_1943,pkSess_2168),Kcli_2181))
                                                            )
                                                            else
                                                                {1751}let v_2182: bool = (Sess = C) in
                                                                (
                                                                    {1752}if v_2182 then
                                                                    (
                                                                        {1753}let pkSess_2183: bitstring = pub(skC) in
                                                                        {1754}out(c, GetEndpointRequest);
                                                                        {1755}in(c, (=GetEndpointResponse,=pkSess_2183,=SignAndEncrypt,SP_2184: bitstring,UP_2185: bitstring));
                                                                        {1756}new Nc_2186: bitstring;
                                                                        {1757}let wNc_2187: bitstring = enc(Nc_2186,pkSess_2183) in
                                                                        {1758}let m1_2188: bitstring = (OpenSecureChannelRequest,pkCli_1943,wNc_2187) in
                                                                        {1759}out(c, (pkCli_1943,enc(m1_2188,pkSess_2183),sign(h(m1_2188),skCli_1942)));
                                                                        {1760}in(c, (em2_2189: bitstring,sigM2_2190: bitstring));
                                                                        {1761}let m2_2191: bitstring = dec(em2_2189,skCli_1942) in
                                                                        {1762}if (verify(h(m2_2191),sigM2_2190,pkSess_2183) <> true) then
                                                                            0
                                                                        else
                                                                            {1763}let (=OpenSecureChannelResponse,wNs_2192: bitstring,ST_2193: bitstring,TTL_2194: bitstring) = m2_2191 in
                                                                            {1764}let Ns_2195: bitstring = dec(wNs_2192,skCli_1942) in
                                                                            {1765}let Kcli_2196: bitstring = h((Nc_2186,Ns_2195)) in
                                                                            {1766}out(c, senc(mCli(pkCli_1943,pkSess_2183),Kcli_2196))
                                                                    )
                                                                    else
                                                                        {1767}let pkSess_2197: bitstring = pub(sk(Sess)) in
                                                                        {1768}out(c, GetEndpointRequest);
                                                                        {1769}in(c, (=GetEndpointResponse,=pkSess_2197,=SignAndEncrypt,SP_2198: bitstring,UP_2199: bitstring));
                                                                        {1770}new Nc_2200: bitstring;
                                                                        {1771}let wNc_2201: bitstring = enc(Nc_2200,pkSess_2197) in
                                                                        {1772}let m1_2202: bitstring = (OpenSecureChannelRequest,pkCli_1943,wNc_2201) in
                                                                        {1773}out(c, (pkCli_1943,enc(m1_2202,pkSess_2197),sign(h(m1_2202),skCli_1942)));
                                                                        {1774}in(c, (em2_2203: bitstring,sigM2_2204: bitstring));
                                                                        {1775}let m2_2205: bitstring = dec(em2_2203,skCli_1942) in
                                                                        {1776}if (verify(h(m2_2205),sigM2_2204,pkSess_2197) <> true) then
                                                                            0
                                                                        else
                                                                            {1777}let (=OpenSecureChannelResponse,wNs_2206: bitstring,ST_2207: bitstring,TTL_2208: bitstring) = m2_2205 in
                                                                            {1778}let Ns_2209: bitstring = dec(wNs_2206,skCli_1942) in
                                                                            {1779}let Kcli_2210: bitstring = h((Nc_2200,Ns_2209)) in
                                                                            {1780}out(c, senc(mCli(pkCli_1943,pkSess_2197),Kcli_2210))
                                                                )
                                                                else
                                                                    {1781}let pkSess_2211: bitstring = fail-any in
                                                                    {1782}out(c, GetEndpointRequest);
                                                                    {1783}in(c, (=GetEndpointResponse,=pkSess_2211,=SignAndEncrypt,SP_2212: bitstring,UP_2213: bitstring));
                                                                    {1784}new Nc_2214: bitstring;
                                                                    {1785}let wNc_2215: bitstring = enc(Nc_2214,pkSess_2211) in
                                                                    {1786}let m1_2216: bitstring = (OpenSecureChannelRequest,pkCli_1943,wNc_2215) in
                                                                    {1787}out(c, (pkCli_1943,enc(m1_2216,pkSess_2211),sign(h(m1_2216),skCli_1942)));
                                                                    {1788}in(c, (em2_2217: bitstring,sigM2_2218: bitstring));
                                                                    {1789}let m2_2219: bitstring = dec(em2_2217,skCli_1942) in
                                                                    {1790}if (verify(h(m2_2219),sigM2_2218,pkSess_2211) <> true) then
                                                                        0
                                                                    else
                                                                        {1791}let (=OpenSecureChannelResponse,wNs_2220: bitstring,ST_2221: bitstring,TTL_2222: bitstring) = m2_2219 in
                                                                        {1792}let Ns_2223: bitstring = dec(wNs_2220,skCli_1942) in
                                                                        {1793}let Kcli_2224: bitstring = h((Nc_2214,Ns_2223)) in
                                                                        {1794}out(c, senc(mCli(pkCli_1943,pkSess_2211),Kcli_2224))
                                                        )
                                                        else
                                                            {1795}let pkSess_2225: bitstring = fail-any in
                                                            {1796}out(c, GetEndpointRequest);
                                                            {1797}in(c, (=GetEndpointResponse,=pkSess_2225,=SignAndEncrypt,SP_2226: bitstring,UP_2227: bitstring));
                                                            {1798}new Nc_2228: bitstring;
                                                            {1799}let wNc_2229: bitstring = enc(Nc_2228,pkSess_2225) in
                                                            {1800}let m1_2230: bitstring = (OpenSecureChannelRequest,pkCli_1943,wNc_2229) in
                                                            {1801}out(c, (pkCli_1943,enc(m1_2230,pkSess_2225),sign(h(m1_2230),skCli_1942)));
                                                            {1802}in(c, (em2_2231: bitstring,sigM2_2232: bitstring));
                                                            {1803}let m2_2233: bitstring = dec(em2_2231,skCli_1942) in
                                                            {1804}if (verify(h(m2_2233),sigM2_2232,pkSess_2225) <> true) then
                                                                0
                                                            else
                                                                {1805}let (=OpenSecureChannelResponse,wNs_2234: bitstring,ST_2235: bitstring,TTL_2236: bitstring) = m2_2233 in
                                                                {1806}let Ns_2237: bitstring = dec(wNs_2234,skCli_1942) in
                                                                {1807}let Kcli_2238: bitstring = h((Nc_2228,Ns_2237)) in
                                                                {1808}out(c, senc(mCli(pkCli_1943,pkSess_2225),Kcli_2238))
                                                )
                                                else
                                                    {1809}let pkSess_2239: bitstring = fail-any in
                                                    {1810}out(c, GetEndpointRequest);
                                                    {1811}in(c, (=GetEndpointResponse,=pkSess_2239,=SignAndEncrypt,SP_2240: bitstring,UP_2241: bitstring));
                                                    {1812}new Nc_2242: bitstring;
                                                    {1813}let wNc_2243: bitstring = enc(Nc_2242,pkSess_2239) in
                                                    {1814}let m1_2244: bitstring = (OpenSecureChannelRequest,pkCli_1943,wNc_2243) in
                                                    {1815}out(c, (pkCli_1943,enc(m1_2244,pkSess_2239),sign(h(m1_2244),skCli_1942)));
                                                    {1816}in(c, (em2_2245: bitstring,sigM2_2246: bitstring));
                                                    {1817}let m2_2247: bitstring = dec(em2_2245,skCli_1942) in
                                                    {1818}if (verify(h(m2_2247),sigM2_2246,pkSess_2239) <> true) then
                                                        0
                                                    else
                                                        {1819}let (=OpenSecureChannelResponse,wNs_2248: bitstring,ST_2249: bitstring,TTL_2250: bitstring) = m2_2247 in
                                                        {1820}let Ns_2251: bitstring = dec(wNs_2248,skCli_1942) in
                                                        {1821}let Kcli_2252: bitstring = h((Nc_2242,Ns_2251)) in
                                                        {1822}out(c, senc(mCli(pkCli_1943,pkSess_2239),Kcli_2252))
                                            )
                                            else
                                                {1823}let pkDisco_2253: bitstring = pub(sk(Disco)) in
                                                {1824}let v_2254: bool = (Sess = A) in
                                                (
                                                    {1825}if v_2254 then
                                                    (
                                                        {1826}let pkSess_2255: bitstring = pub(skA) in
                                                        {1827}out(c, GetEndpointRequest);
                                                        {1828}in(c, (=GetEndpointResponse,=pkSess_2255,=SignAndEncrypt,SP_2256: bitstring,UP_2257: bitstring));
                                                        {1829}new Nc_2258: bitstring;
                                                        {1830}let wNc_2259: bitstring = enc(Nc_2258,pkSess_2255) in
                                                        {1831}let m1_2260: bitstring = (OpenSecureChannelRequest,pkCli_1943,wNc_2259) in
                                                        {1832}out(c, (pkCli_1943,enc(m1_2260,pkSess_2255),sign(h(m1_2260),skCli_1942)));
                                                        {1833}in(c, (em2_2261: bitstring,sigM2_2262: bitstring));
                                                        {1834}let m2_2263: bitstring = dec(em2_2261,skCli_1942) in
                                                        {1835}if (verify(h(m2_2263),sigM2_2262,pkSess_2255) <> true) then
                                                            0
                                                        else
                                                            {1836}let (=OpenSecureChannelResponse,wNs_2264: bitstring,ST_2265: bitstring,TTL_2266: bitstring) = m2_2263 in
                                                            {1837}let Ns_2267: bitstring = dec(wNs_2264,skCli_1942) in
                                                            {1838}let Kcli_2268: bitstring = h((Nc_2258,Ns_2267)) in
                                                            {1839}out(c, senc(mCli(pkCli_1943,pkSess_2255),Kcli_2268))
                                                    )
                                                    else
                                                        {1840}let v_2269: bool = (Sess = B) in
                                                        (
                                                            {1841}if v_2269 then
                                                            (
                                                                {1842}let pkSess_2270: bitstring = pub(skB) in
                                                                {1843}out(c, GetEndpointRequest);
                                                                {1844}in(c, (=GetEndpointResponse,=pkSess_2270,=SignAndEncrypt,SP_2271: bitstring,UP_2272: bitstring));
                                                                {1845}new Nc_2273: bitstring;
                                                                {1846}let wNc_2274: bitstring = enc(Nc_2273,pkSess_2270) in
                                                                {1847}let m1_2275: bitstring = (OpenSecureChannelRequest,pkCli_1943,wNc_2274) in
                                                                {1848}out(c, (pkCli_1943,enc(m1_2275,pkSess_2270),sign(h(m1_2275),skCli_1942)));
                                                                {1849}in(c, (em2_2276: bitstring,sigM2_2277: bitstring));
                                                                {1850}let m2_2278: bitstring = dec(em2_2276,skCli_1942) in
                                                                {1851}if (verify(h(m2_2278),sigM2_2277,pkSess_2270) <> true) then
                                                                    0
                                                                else
                                                                    {1852}let (=OpenSecureChannelResponse,wNs_2279: bitstring,ST_2280: bitstring,TTL_2281: bitstring) = m2_2278 in
                                                                    {1853}let Ns_2282: bitstring = dec(wNs_2279,skCli_1942) in
                                                                    {1854}let Kcli_2283: bitstring = h((Nc_2273,Ns_2282)) in
                                                                    {1855}out(c, senc(mCli(pkCli_1943,pkSess_2270),Kcli_2283))
                                                            )
                                                            else
                                                                {1856}let v_2284: bool = (Sess = C) in
                                                                (
                                                                    {1857}if v_2284 then
                                                                    (
                                                                        {1858}let pkSess_2285: bitstring = pub(skC) in
                                                                        {1859}out(c, GetEndpointRequest);
                                                                        {1860}in(c, (=GetEndpointResponse,=pkSess_2285,=SignAndEncrypt,SP_2286: bitstring,UP_2287: bitstring));
                                                                        {1861}new Nc_2288: bitstring;
                                                                        {1862}let wNc_2289: bitstring = enc(Nc_2288,pkSess_2285) in
                                                                        {1863}let m1_2290: bitstring = (OpenSecureChannelRequest,pkCli_1943,wNc_2289) in
                                                                        {1864}out(c, (pkCli_1943,enc(m1_2290,pkSess_2285),sign(h(m1_2290),skCli_1942)));
                                                                        {1865}in(c, (em2_2291: bitstring,sigM2_2292: bitstring));
                                                                        {1866}let m2_2293: bitstring = dec(em2_2291,skCli_1942) in
                                                                        {1867}if (verify(h(m2_2293),sigM2_2292,pkSess_2285) <> true) then
                                                                            0
                                                                        else
                                                                            {1868}let (=OpenSecureChannelResponse,wNs_2294: bitstring,ST_2295: bitstring,TTL_2296: bitstring) = m2_2293 in
                                                                            {1869}let Ns_2297: bitstring = dec(wNs_2294,skCli_1942) in
                                                                            {1870}let Kcli_2298: bitstring = h((Nc_2288,Ns_2297)) in
                                                                            {1871}out(c, senc(mCli(pkCli_1943,pkSess_2285),Kcli_2298))
                                                                    )
                                                                    else
                                                                        {1872}let pkSess_2299: bitstring = pub(sk(Sess)) in
                                                                        {1873}out(c, GetEndpointRequest);
                                                                        {1874}in(c, (=GetEndpointResponse,=pkSess_2299,=SignAndEncrypt,SP_2300: bitstring,UP_2301: bitstring));
                                                                        {1875}new Nc_2302: bitstring;
                                                                        {1876}let wNc_2303: bitstring = enc(Nc_2302,pkSess_2299) in
                                                                        {1877}let m1_2304: bitstring = (OpenSecureChannelRequest,pkCli_1943,wNc_2303) in
                                                                        {1878}out(c, (pkCli_1943,enc(m1_2304,pkSess_2299),sign(h(m1_2304),skCli_1942)));
                                                                        {1879}in(c, (em2_2305: bitstring,sigM2_2306: bitstring));
                                                                        {1880}let m2_2307: bitstring = dec(em2_2305,skCli_1942) in
                                                                        {1881}if (verify(h(m2_2307),sigM2_2306,pkSess_2299) <> true) then
                                                                            0
                                                                        else
                                                                            {1882}let (=OpenSecureChannelResponse,wNs_2308: bitstring,ST_2309: bitstring,TTL_2310: bitstring) = m2_2307 in
                                                                            {1883}let Ns_2311: bitstring = dec(wNs_2308,skCli_1942) in
                                                                            {1884}let Kcli_2312: bitstring = h((Nc_2302,Ns_2311)) in
                                                                            {1885}out(c, senc(mCli(pkCli_1943,pkSess_2299),Kcli_2312))
                                                                )
                                                                else
                                                                    {1886}let pkSess_2313: bitstring = fail-any in
                                                                    {1887}out(c, GetEndpointRequest);
                                                                    {1888}in(c, (=GetEndpointResponse,=pkSess_2313,=SignAndEncrypt,SP_2314: bitstring,UP_2315: bitstring));
                                                                    {1889}new Nc_2316: bitstring;
                                                                    {1890}let wNc_2317: bitstring = enc(Nc_2316,pkSess_2313) in
                                                                    {1891}let m1_2318: bitstring = (OpenSecureChannelRequest,pkCli_1943,wNc_2317) in
                                                                    {1892}out(c, (pkCli_1943,enc(m1_2318,pkSess_2313),sign(h(m1_2318),skCli_1942)));
                                                                    {1893}in(c, (em2_2319: bitstring,sigM2_2320: bitstring));
                                                                    {1894}let m2_2321: bitstring = dec(em2_2319,skCli_1942) in
                                                                    {1895}if (verify(h(m2_2321),sigM2_2320,pkSess_2313) <> true) then
                                                                        0
                                                                    else
                                                                        {1896}let (=OpenSecureChannelResponse,wNs_2322: bitstring,ST_2323: bitstring,TTL_2324: bitstring) = m2_2321 in
                                                                        {1897}let Ns_2325: bitstring = dec(wNs_2322,skCli_1942) in
                                                                        {1898}let Kcli_2326: bitstring = h((Nc_2316,Ns_2325)) in
                                                                        {1899}out(c, senc(mCli(pkCli_1943,pkSess_2313),Kcli_2326))
                                                        )
                                                        else
                                                            {1900}let pkSess_2327: bitstring = fail-any in
                                                            {1901}out(c, GetEndpointRequest);
                                                            {1902}in(c, (=GetEndpointResponse,=pkSess_2327,=SignAndEncrypt,SP_2328: bitstring,UP_2329: bitstring));
                                                            {1903}new Nc_2330: bitstring;
                                                            {1904}let wNc_2331: bitstring = enc(Nc_2330,pkSess_2327) in
                                                            {1905}let m1_2332: bitstring = (OpenSecureChannelRequest,pkCli_1943,wNc_2331) in
                                                            {1906}out(c, (pkCli_1943,enc(m1_2332,pkSess_2327),sign(h(m1_2332),skCli_1942)));
                                                            {1907}in(c, (em2_2333: bitstring,sigM2_2334: bitstring));
                                                            {1908}let m2_2335: bitstring = dec(em2_2333,skCli_1942) in
                                                            {1909}if (verify(h(m2_2335),sigM2_2334,pkSess_2327) <> true) then
                                                                0
                                                            else
                                                                {1910}let (=OpenSecureChannelResponse,wNs_2336: bitstring,ST_2337: bitstring,TTL_2338: bitstring) = m2_2335 in
                                                                {1911}let Ns_2339: bitstring = dec(wNs_2336,skCli_1942) in
                                                                {1912}let Kcli_2340: bitstring = h((Nc_2330,Ns_2339)) in
                                                                {1913}out(c, senc(mCli(pkCli_1943,pkSess_2327),Kcli_2340))
                                                )
                                                else
                                                    {1914}let pkSess_2341: bitstring = fail-any in
                                                    {1915}out(c, GetEndpointRequest);
                                                    {1916}in(c, (=GetEndpointResponse,=pkSess_2341,=SignAndEncrypt,SP_2342: bitstring,UP_2343: bitstring));
                                                    {1917}new Nc_2344: bitstring;
                                                    {1918}let wNc_2345: bitstring = enc(Nc_2344,pkSess_2341) in
                                                    {1919}let m1_2346: bitstring = (OpenSecureChannelRequest,pkCli_1943,wNc_2345) in
                                                    {1920}out(c, (pkCli_1943,enc(m1_2346,pkSess_2341),sign(h(m1_2346),skCli_1942)));
                                                    {1921}in(c, (em2_2347: bitstring,sigM2_2348: bitstring));
                                                    {1922}let m2_2349: bitstring = dec(em2_2347,skCli_1942) in
                                                    {1923}if (verify(h(m2_2349),sigM2_2348,pkSess_2341) <> true) then
                                                        0
                                                    else
                                                        {1924}let (=OpenSecureChannelResponse,wNs_2350: bitstring,ST_2351: bitstring,TTL_2352: bitstring) = m2_2349 in
                                                        {1925}let Ns_2353: bitstring = dec(wNs_2350,skCli_1942) in
                                                        {1926}let Kcli_2354: bitstring = h((Nc_2344,Ns_2353)) in
                                                        {1927}out(c, senc(mCli(pkCli_1943,pkSess_2341),Kcli_2354))
                                        )
                                        else
                                            {1928}let pkDisco_2355: bitstring = fail-any in
                                            {1929}let v_2356: bool = (Sess = A) in
                                            (
                                                {1930}if v_2356 then
                                                (
                                                    {1931}let pkSess_2357: bitstring = pub(skA) in
                                                    {1932}out(c, GetEndpointRequest);
                                                    {1933}in(c, (=GetEndpointResponse,=pkSess_2357,=SignAndEncrypt,SP_2358: bitstring,UP_2359: bitstring));
                                                    {1934}new Nc_2360: bitstring;
                                                    {1935}let wNc_2361: bitstring = enc(Nc_2360,pkSess_2357) in
                                                    {1936}let m1_2362: bitstring = (OpenSecureChannelRequest,pkCli_1943,wNc_2361) in
                                                    {1937}out(c, (pkCli_1943,enc(m1_2362,pkSess_2357),sign(h(m1_2362),skCli_1942)));
                                                    {1938}in(c, (em2_2363: bitstring,sigM2_2364: bitstring));
                                                    {1939}let m2_2365: bitstring = dec(em2_2363,skCli_1942) in
                                                    {1940}if (verify(h(m2_2365),sigM2_2364,pkSess_2357) <> true) then
                                                        0
                                                    else
                                                        {1941}let (=OpenSecureChannelResponse,wNs_2366: bitstring,ST_2367: bitstring,TTL_2368: bitstring) = m2_2365 in
                                                        {1942}let Ns_2369: bitstring = dec(wNs_2366,skCli_1942) in
                                                        {1943}let Kcli_2370: bitstring = h((Nc_2360,Ns_2369)) in
                                                        {1944}out(c, senc(mCli(pkCli_1943,pkSess_2357),Kcli_2370))
                                                )
                                                else
                                                    {1945}let v_2371: bool = (Sess = B) in
                                                    (
                                                        {1946}if v_2371 then
                                                        (
                                                            {1947}let pkSess_2372: bitstring = pub(skB) in
                                                            {1948}out(c, GetEndpointRequest);
                                                            {1949}in(c, (=GetEndpointResponse,=pkSess_2372,=SignAndEncrypt,SP_2373: bitstring,UP_2374: bitstring));
                                                            {1950}new Nc_2375: bitstring;
                                                            {1951}let wNc_2376: bitstring = enc(Nc_2375,pkSess_2372) in
                                                            {1952}let m1_2377: bitstring = (OpenSecureChannelRequest,pkCli_1943,wNc_2376) in
                                                            {1953}out(c, (pkCli_1943,enc(m1_2377,pkSess_2372),sign(h(m1_2377),skCli_1942)));
                                                            {1954}in(c, (em2_2378: bitstring,sigM2_2379: bitstring));
                                                            {1955}let m2_2380: bitstring = dec(em2_2378,skCli_1942) in
                                                            {1956}if (verify(h(m2_2380),sigM2_2379,pkSess_2372) <> true) then
                                                                0
                                                            else
                                                                {1957}let (=OpenSecureChannelResponse,wNs_2381: bitstring,ST_2382: bitstring,TTL_2383: bitstring) = m2_2380 in
                                                                {1958}let Ns_2384: bitstring = dec(wNs_2381,skCli_1942) in
                                                                {1959}let Kcli_2385: bitstring = h((Nc_2375,Ns_2384)) in
                                                                {1960}out(c, senc(mCli(pkCli_1943,pkSess_2372),Kcli_2385))
                                                        )
                                                        else
                                                            {1961}let v_2386: bool = (Sess = C) in
                                                            (
                                                                {1962}if v_2386 then
                                                                (
                                                                    {1963}let pkSess_2387: bitstring = pub(skC) in
                                                                    {1964}out(c, GetEndpointRequest);
                                                                    {1965}in(c, (=GetEndpointResponse,=pkSess_2387,=SignAndEncrypt,SP_2388: bitstring,UP_2389: bitstring));
                                                                    {1966}new Nc_2390: bitstring;
                                                                    {1967}let wNc_2391: bitstring = enc(Nc_2390,pkSess_2387) in
                                                                    {1968}let m1_2392: bitstring = (OpenSecureChannelRequest,pkCli_1943,wNc_2391) in
                                                                    {1969}out(c, (pkCli_1943,enc(m1_2392,pkSess_2387),sign(h(m1_2392),skCli_1942)));
                                                                    {1970}in(c, (em2_2393: bitstring,sigM2_2394: bitstring));
                                                                    {1971}let m2_2395: bitstring = dec(em2_2393,skCli_1942) in
                                                                    {1972}if (verify(h(m2_2395),sigM2_2394,pkSess_2387) <> true) then
                                                                        0
                                                                    else
                                                                        {1973}let (=OpenSecureChannelResponse,wNs_2396: bitstring,ST_2397: bitstring,TTL_2398: bitstring) = m2_2395 in
                                                                        {1974}let Ns_2399: bitstring = dec(wNs_2396,skCli_1942) in
                                                                        {1975}let Kcli_2400: bitstring = h((Nc_2390,Ns_2399)) in
                                                                        {1976}out(c, senc(mCli(pkCli_1943,pkSess_2387),Kcli_2400))
                                                                )
                                                                else
                                                                    {1977}let pkSess_2401: bitstring = pub(sk(Sess)) in
                                                                    {1978}out(c, GetEndpointRequest);
                                                                    {1979}in(c, (=GetEndpointResponse,=pkSess_2401,=SignAndEncrypt,SP_2402: bitstring,UP_2403: bitstring));
                                                                    {1980}new Nc_2404: bitstring;
                                                                    {1981}let wNc_2405: bitstring = enc(Nc_2404,pkSess_2401) in
                                                                    {1982}let m1_2406: bitstring = (OpenSecureChannelRequest,pkCli_1943,wNc_2405) in
                                                                    {1983}out(c, (pkCli_1943,enc(m1_2406,pkSess_2401),sign(h(m1_2406),skCli_1942)));
                                                                    {1984}in(c, (em2_2407: bitstring,sigM2_2408: bitstring));
                                                                    {1985}let m2_2409: bitstring = dec(em2_2407,skCli_1942) in
                                                                    {1986}if (verify(h(m2_2409),sigM2_2408,pkSess_2401) <> true) then
                                                                        0
                                                                    else
                                                                        {1987}let (=OpenSecureChannelResponse,wNs_2410: bitstring,ST_2411: bitstring,TTL_2412: bitstring) = m2_2409 in
                                                                        {1988}let Ns_2413: bitstring = dec(wNs_2410,skCli_1942) in
                                                                        {1989}let Kcli_2414: bitstring = h((Nc_2404,Ns_2413)) in
                                                                        {1990}out(c, senc(mCli(pkCli_1943,pkSess_2401),Kcli_2414))
                                                            )
                                                            else
                                                                {1991}let pkSess_2415: bitstring = fail-any in
                                                                {1992}out(c, GetEndpointRequest);
                                                                {1993}in(c, (=GetEndpointResponse,=pkSess_2415,=SignAndEncrypt,SP_2416: bitstring,UP_2417: bitstring));
                                                                {1994}new Nc_2418: bitstring;
                                                                {1995}let wNc_2419: bitstring = enc(Nc_2418,pkSess_2415) in
                                                                {1996}let m1_2420: bitstring = (OpenSecureChannelRequest,pkCli_1943,wNc_2419) in
                                                                {1997}out(c, (pkCli_1943,enc(m1_2420,pkSess_2415),sign(h(m1_2420),skCli_1942)));
                                                                {1998}in(c, (em2_2421: bitstring,sigM2_2422: bitstring));
                                                                {1999}let m2_2423: bitstring = dec(em2_2421,skCli_1942) in
                                                                {2000}if (verify(h(m2_2423),sigM2_2422,pkSess_2415) <> true) then
                                                                    0
                                                                else
                                                                    {2001}let (=OpenSecureChannelResponse,wNs_2424: bitstring,ST_2425: bitstring,TTL_2426: bitstring) = m2_2423 in
                                                                    {2002}let Ns_2427: bitstring = dec(wNs_2424,skCli_1942) in
                                                                    {2003}let Kcli_2428: bitstring = h((Nc_2418,Ns_2427)) in
                                                                    {2004}out(c, senc(mCli(pkCli_1943,pkSess_2415),Kcli_2428))
                                                    )
                                                    else
                                                        {2005}let pkSess_2429: bitstring = fail-any in
                                                        {2006}out(c, GetEndpointRequest);
                                                        {2007}in(c, (=GetEndpointResponse,=pkSess_2429,=SignAndEncrypt,SP_2430: bitstring,UP_2431: bitstring));
                                                        {2008}new Nc_2432: bitstring;
                                                        {2009}let wNc_2433: bitstring = enc(Nc_2432,pkSess_2429) in
                                                        {2010}let m1_2434: bitstring = (OpenSecureChannelRequest,pkCli_1943,wNc_2433) in
                                                        {2011}out(c, (pkCli_1943,enc(m1_2434,pkSess_2429),sign(h(m1_2434),skCli_1942)));
                                                        {2012}in(c, (em2_2435: bitstring,sigM2_2436: bitstring));
                                                        {2013}let m2_2437: bitstring = dec(em2_2435,skCli_1942) in
                                                        {2014}if (verify(h(m2_2437),sigM2_2436,pkSess_2429) <> true) then
                                                            0
                                                        else
                                                            {2015}let (=OpenSecureChannelResponse,wNs_2438: bitstring,ST_2439: bitstring,TTL_2440: bitstring) = m2_2437 in
                                                            {2016}let Ns_2441: bitstring = dec(wNs_2438,skCli_1942) in
                                                            {2017}let Kcli_2442: bitstring = h((Nc_2432,Ns_2441)) in
                                                            {2018}out(c, senc(mCli(pkCli_1943,pkSess_2429),Kcli_2442))
                                            )
                                            else
                                                {2019}let pkSess_2443: bitstring = fail-any in
                                                {2020}out(c, GetEndpointRequest);
                                                {2021}in(c, (=GetEndpointResponse,=pkSess_2443,=SignAndEncrypt,SP_2444: bitstring,UP_2445: bitstring));
                                                {2022}new Nc_2446: bitstring;
                                                {2023}let wNc_2447: bitstring = enc(Nc_2446,pkSess_2443) in
                                                {2024}let m1_2448: bitstring = (OpenSecureChannelRequest,pkCli_1943,wNc_2447) in
                                                {2025}out(c, (pkCli_1943,enc(m1_2448,pkSess_2443),sign(h(m1_2448),skCli_1942)));
                                                {2026}in(c, (em2_2449: bitstring,sigM2_2450: bitstring));
                                                {2027}let m2_2451: bitstring = dec(em2_2449,skCli_1942) in
                                                {2028}if (verify(h(m2_2451),sigM2_2450,pkSess_2443) <> true) then
                                                    0
                                                else
                                                    {2029}let (=OpenSecureChannelResponse,wNs_2452: bitstring,ST_2453: bitstring,TTL_2454: bitstring) = m2_2451 in
                                                    {2030}let Ns_2455: bitstring = dec(wNs_2452,skCli_1942) in
                                                    {2031}let Kcli_2456: bitstring = h((Nc_2446,Ns_2455)) in
                                                    {2032}out(c, senc(mCli(pkCli_1943,pkSess_2443),Kcli_2456))
                                )
                                else
                                    {2033}let pkDisco_2457: bitstring = fail-any in
                                    {2034}let v_2458: bool = (Sess = A) in
                                    (
                                        {2035}if v_2458 then
                                        (
                                            {2036}let pkSess_2459: bitstring = pub(skA) in
                                            {2037}out(c, GetEndpointRequest);
                                            {2038}in(c, (=GetEndpointResponse,=pkSess_2459,=SignAndEncrypt,SP_2460: bitstring,UP_2461: bitstring));
                                            {2039}new Nc_2462: bitstring;
                                            {2040}let wNc_2463: bitstring = enc(Nc_2462,pkSess_2459) in
                                            {2041}let m1_2464: bitstring = (OpenSecureChannelRequest,pkCli_1943,wNc_2463) in
                                            {2042}out(c, (pkCli_1943,enc(m1_2464,pkSess_2459),sign(h(m1_2464),skCli_1942)));
                                            {2043}in(c, (em2_2465: bitstring,sigM2_2466: bitstring));
                                            {2044}let m2_2467: bitstring = dec(em2_2465,skCli_1942) in
                                            {2045}if (verify(h(m2_2467),sigM2_2466,pkSess_2459) <> true) then
                                                0
                                            else
                                                {2046}let (=OpenSecureChannelResponse,wNs_2468: bitstring,ST_2469: bitstring,TTL_2470: bitstring) = m2_2467 in
                                                {2047}let Ns_2471: bitstring = dec(wNs_2468,skCli_1942) in
                                                {2048}let Kcli_2472: bitstring = h((Nc_2462,Ns_2471)) in
                                                {2049}out(c, senc(mCli(pkCli_1943,pkSess_2459),Kcli_2472))
                                        )
                                        else
                                            {2050}let v_2473: bool = (Sess = B) in
                                            (
                                                {2051}if v_2473 then
                                                (
                                                    {2052}let pkSess_2474: bitstring = pub(skB) in
                                                    {2053}out(c, GetEndpointRequest);
                                                    {2054}in(c, (=GetEndpointResponse,=pkSess_2474,=SignAndEncrypt,SP_2475: bitstring,UP_2476: bitstring));
                                                    {2055}new Nc_2477: bitstring;
                                                    {2056}let wNc_2478: bitstring = enc(Nc_2477,pkSess_2474) in
                                                    {2057}let m1_2479: bitstring = (OpenSecureChannelRequest,pkCli_1943,wNc_2478) in
                                                    {2058}out(c, (pkCli_1943,enc(m1_2479,pkSess_2474),sign(h(m1_2479),skCli_1942)));
                                                    {2059}in(c, (em2_2480: bitstring,sigM2_2481: bitstring));
                                                    {2060}let m2_2482: bitstring = dec(em2_2480,skCli_1942) in
                                                    {2061}if (verify(h(m2_2482),sigM2_2481,pkSess_2474) <> true) then
                                                        0
                                                    else
                                                        {2062}let (=OpenSecureChannelResponse,wNs_2483: bitstring,ST_2484: bitstring,TTL_2485: bitstring) = m2_2482 in
                                                        {2063}let Ns_2486: bitstring = dec(wNs_2483,skCli_1942) in
                                                        {2064}let Kcli_2487: bitstring = h((Nc_2477,Ns_2486)) in
                                                        {2065}out(c, senc(mCli(pkCli_1943,pkSess_2474),Kcli_2487))
                                                )
                                                else
                                                    {2066}let v_2488: bool = (Sess = C) in
                                                    (
                                                        {2067}if v_2488 then
                                                        (
                                                            {2068}let pkSess_2489: bitstring = pub(skC) in
                                                            {2069}out(c, GetEndpointRequest);
                                                            {2070}in(c, (=GetEndpointResponse,=pkSess_2489,=SignAndEncrypt,SP_2490: bitstring,UP_2491: bitstring));
                                                            {2071}new Nc_2492: bitstring;
                                                            {2072}let wNc_2493: bitstring = enc(Nc_2492,pkSess_2489) in
                                                            {2073}let m1_2494: bitstring = (OpenSecureChannelRequest,pkCli_1943,wNc_2493) in
                                                            {2074}out(c, (pkCli_1943,enc(m1_2494,pkSess_2489),sign(h(m1_2494),skCli_1942)));
                                                            {2075}in(c, (em2_2495: bitstring,sigM2_2496: bitstring));
                                                            {2076}let m2_2497: bitstring = dec(em2_2495,skCli_1942) in
                                                            {2077}if (verify(h(m2_2497),sigM2_2496,pkSess_2489) <> true) then
                                                                0
                                                            else
                                                                {2078}let (=OpenSecureChannelResponse,wNs_2498: bitstring,ST_2499: bitstring,TTL_2500: bitstring) = m2_2497 in
                                                                {2079}let Ns_2501: bitstring = dec(wNs_2498,skCli_1942) in
                                                                {2080}let Kcli_2502: bitstring = h((Nc_2492,Ns_2501)) in
                                                                {2081}out(c, senc(mCli(pkCli_1943,pkSess_2489),Kcli_2502))
                                                        )
                                                        else
                                                            {2082}let pkSess_2503: bitstring = pub(sk(Sess)) in
                                                            {2083}out(c, GetEndpointRequest);
                                                            {2084}in(c, (=GetEndpointResponse,=pkSess_2503,=SignAndEncrypt,SP_2504: bitstring,UP_2505: bitstring));
                                                            {2085}new Nc_2506: bitstring;
                                                            {2086}let wNc_2507: bitstring = enc(Nc_2506,pkSess_2503) in
                                                            {2087}let m1_2508: bitstring = (OpenSecureChannelRequest,pkCli_1943,wNc_2507) in
                                                            {2088}out(c, (pkCli_1943,enc(m1_2508,pkSess_2503),sign(h(m1_2508),skCli_1942)));
                                                            {2089}in(c, (em2_2509: bitstring,sigM2_2510: bitstring));
                                                            {2090}let m2_2511: bitstring = dec(em2_2509,skCli_1942) in
                                                            {2091}if (verify(h(m2_2511),sigM2_2510,pkSess_2503) <> true) then
                                                                0
                                                            else
                                                                {2092}let (=OpenSecureChannelResponse,wNs_2512: bitstring,ST_2513: bitstring,TTL_2514: bitstring) = m2_2511 in
                                                                {2093}let Ns_2515: bitstring = dec(wNs_2512,skCli_1942) in
                                                                {2094}let Kcli_2516: bitstring = h((Nc_2506,Ns_2515)) in
                                                                {2095}out(c, senc(mCli(pkCli_1943,pkSess_2503),Kcli_2516))
                                                    )
                                                    else
                                                        {2096}let pkSess_2517: bitstring = fail-any in
                                                        {2097}out(c, GetEndpointRequest);
                                                        {2098}in(c, (=GetEndpointResponse,=pkSess_2517,=SignAndEncrypt,SP_2518: bitstring,UP_2519: bitstring));
                                                        {2099}new Nc_2520: bitstring;
                                                        {2100}let wNc_2521: bitstring = enc(Nc_2520,pkSess_2517) in
                                                        {2101}let m1_2522: bitstring = (OpenSecureChannelRequest,pkCli_1943,wNc_2521) in
                                                        {2102}out(c, (pkCli_1943,enc(m1_2522,pkSess_2517),sign(h(m1_2522),skCli_1942)));
                                                        {2103}in(c, (em2_2523: bitstring,sigM2_2524: bitstring));
                                                        {2104}let m2_2525: bitstring = dec(em2_2523,skCli_1942) in
                                                        {2105}if (verify(h(m2_2525),sigM2_2524,pkSess_2517) <> true) then
                                                            0
                                                        else
                                                            {2106}let (=OpenSecureChannelResponse,wNs_2526: bitstring,ST_2527: bitstring,TTL_2528: bitstring) = m2_2525 in
                                                            {2107}let Ns_2529: bitstring = dec(wNs_2526,skCli_1942) in
                                                            {2108}let Kcli_2530: bitstring = h((Nc_2520,Ns_2529)) in
                                                            {2109}out(c, senc(mCli(pkCli_1943,pkSess_2517),Kcli_2530))
                                            )
                                            else
                                                {2110}let pkSess_2531: bitstring = fail-any in
                                                {2111}out(c, GetEndpointRequest);
                                                {2112}in(c, (=GetEndpointResponse,=pkSess_2531,=SignAndEncrypt,SP_2532: bitstring,UP_2533: bitstring));
                                                {2113}new Nc_2534: bitstring;
                                                {2114}let wNc_2535: bitstring = enc(Nc_2534,pkSess_2531) in
                                                {2115}let m1_2536: bitstring = (OpenSecureChannelRequest,pkCli_1943,wNc_2535) in
                                                {2116}out(c, (pkCli_1943,enc(m1_2536,pkSess_2531),sign(h(m1_2536),skCli_1942)));
                                                {2117}in(c, (em2_2537: bitstring,sigM2_2538: bitstring));
                                                {2118}let m2_2539: bitstring = dec(em2_2537,skCli_1942) in
                                                {2119}if (verify(h(m2_2539),sigM2_2538,pkSess_2531) <> true) then
                                                    0
                                                else
                                                    {2120}let (=OpenSecureChannelResponse,wNs_2540: bitstring,ST_2541: bitstring,TTL_2542: bitstring) = m2_2539 in
                                                    {2121}let Ns_2543: bitstring = dec(wNs_2540,skCli_1942) in
                                                    {2122}let Kcli_2544: bitstring = h((Nc_2534,Ns_2543)) in
                                                    {2123}out(c, senc(mCli(pkCli_1943,pkSess_2531),Kcli_2544))
                                    )
                                    else
                                        {2124}let pkSess_2545: bitstring = fail-any in
                                        {2125}out(c, GetEndpointRequest);
                                        {2126}in(c, (=GetEndpointResponse,=pkSess_2545,=SignAndEncrypt,SP_2546: bitstring,UP_2547: bitstring));
                                        {2127}new Nc_2548: bitstring;
                                        {2128}let wNc_2549: bitstring = enc(Nc_2548,pkSess_2545) in
                                        {2129}let m1_2550: bitstring = (OpenSecureChannelRequest,pkCli_1943,wNc_2549) in
                                        {2130}out(c, (pkCli_1943,enc(m1_2550,pkSess_2545),sign(h(m1_2550),skCli_1942)));
                                        {2131}in(c, (em2_2551: bitstring,sigM2_2552: bitstring));
                                        {2132}let m2_2553: bitstring = dec(em2_2551,skCli_1942) in
                                        {2133}if (verify(h(m2_2553),sigM2_2552,pkSess_2545) <> true) then
                                            0
                                        else
                                            {2134}let (=OpenSecureChannelResponse,wNs_2554: bitstring,ST_2555: bitstring,TTL_2556: bitstring) = m2_2553 in
                                            {2135}let Ns_2557: bitstring = dec(wNs_2554,skCli_1942) in
                                            {2136}let Kcli_2558: bitstring = h((Nc_2548,Ns_2557)) in
                                            {2137}out(c, senc(mCli(pkCli_1943,pkSess_2545),Kcli_2558))
                        )
                        else
                            {2138}let pkDisco_2559: bitstring = fail-any in
                            {2139}let v_2560: bool = (Sess = A) in
                            (
                                {2140}if v_2560 then
                                (
                                    {2141}let pkSess_2561: bitstring = pub(skA) in
                                    {2142}out(c, GetEndpointRequest);
                                    {2143}in(c, (=GetEndpointResponse,=pkSess_2561,=SignAndEncrypt,SP_2562: bitstring,UP_2563: bitstring));
                                    {2144}new Nc_2564: bitstring;
                                    {2145}let wNc_2565: bitstring = enc(Nc_2564,pkSess_2561) in
                                    {2146}let m1_2566: bitstring = (OpenSecureChannelRequest,pkCli_1943,wNc_2565) in
                                    {2147}out(c, (pkCli_1943,enc(m1_2566,pkSess_2561),sign(h(m1_2566),skCli_1942)));
                                    {2148}in(c, (em2_2567: bitstring,sigM2_2568: bitstring));
                                    {2149}let m2_2569: bitstring = dec(em2_2567,skCli_1942) in
                                    {2150}if (verify(h(m2_2569),sigM2_2568,pkSess_2561) <> true) then
                                        0
                                    else
                                        {2151}let (=OpenSecureChannelResponse,wNs_2570: bitstring,ST_2571: bitstring,TTL_2572: bitstring) = m2_2569 in
                                        {2152}let Ns_2573: bitstring = dec(wNs_2570,skCli_1942) in
                                        {2153}let Kcli_2574: bitstring = h((Nc_2564,Ns_2573)) in
                                        {2154}out(c, senc(mCli(pkCli_1943,pkSess_2561),Kcli_2574))
                                )
                                else
                                    {2155}let v_2575: bool = (Sess = B) in
                                    (
                                        {2156}if v_2575 then
                                        (
                                            {2157}let pkSess_2576: bitstring = pub(skB) in
                                            {2158}out(c, GetEndpointRequest);
                                            {2159}in(c, (=GetEndpointResponse,=pkSess_2576,=SignAndEncrypt,SP_2577: bitstring,UP_2578: bitstring));
                                            {2160}new Nc_2579: bitstring;
                                            {2161}let wNc_2580: bitstring = enc(Nc_2579,pkSess_2576) in
                                            {2162}let m1_2581: bitstring = (OpenSecureChannelRequest,pkCli_1943,wNc_2580) in
                                            {2163}out(c, (pkCli_1943,enc(m1_2581,pkSess_2576),sign(h(m1_2581),skCli_1942)));
                                            {2164}in(c, (em2_2582: bitstring,sigM2_2583: bitstring));
                                            {2165}let m2_2584: bitstring = dec(em2_2582,skCli_1942) in
                                            {2166}if (verify(h(m2_2584),sigM2_2583,pkSess_2576) <> true) then
                                                0
                                            else
                                                {2167}let (=OpenSecureChannelResponse,wNs_2585: bitstring,ST_2586: bitstring,TTL_2587: bitstring) = m2_2584 in
                                                {2168}let Ns_2588: bitstring = dec(wNs_2585,skCli_1942) in
                                                {2169}let Kcli_2589: bitstring = h((Nc_2579,Ns_2588)) in
                                                {2170}out(c, senc(mCli(pkCli_1943,pkSess_2576),Kcli_2589))
                                        )
                                        else
                                            {2171}let v_2590: bool = (Sess = C) in
                                            (
                                                {2172}if v_2590 then
                                                (
                                                    {2173}let pkSess_2591: bitstring = pub(skC) in
                                                    {2174}out(c, GetEndpointRequest);
                                                    {2175}in(c, (=GetEndpointResponse,=pkSess_2591,=SignAndEncrypt,SP_2592: bitstring,UP_2593: bitstring));
                                                    {2176}new Nc_2594: bitstring;
                                                    {2177}let wNc_2595: bitstring = enc(Nc_2594,pkSess_2591) in
                                                    {2178}let m1_2596: bitstring = (OpenSecureChannelRequest,pkCli_1943,wNc_2595) in
                                                    {2179}out(c, (pkCli_1943,enc(m1_2596,pkSess_2591),sign(h(m1_2596),skCli_1942)));
                                                    {2180}in(c, (em2_2597: bitstring,sigM2_2598: bitstring));
                                                    {2181}let m2_2599: bitstring = dec(em2_2597,skCli_1942) in
                                                    {2182}if (verify(h(m2_2599),sigM2_2598,pkSess_2591) <> true) then
                                                        0
                                                    else
                                                        {2183}let (=OpenSecureChannelResponse,wNs_2600: bitstring,ST_2601: bitstring,TTL_2602: bitstring) = m2_2599 in
                                                        {2184}let Ns_2603: bitstring = dec(wNs_2600,skCli_1942) in
                                                        {2185}let Kcli_2604: bitstring = h((Nc_2594,Ns_2603)) in
                                                        {2186}out(c, senc(mCli(pkCli_1943,pkSess_2591),Kcli_2604))
                                                )
                                                else
                                                    {2187}let pkSess_2605: bitstring = pub(sk(Sess)) in
                                                    {2188}out(c, GetEndpointRequest);
                                                    {2189}in(c, (=GetEndpointResponse,=pkSess_2605,=SignAndEncrypt,SP_2606: bitstring,UP_2607: bitstring));
                                                    {2190}new Nc_2608: bitstring;
                                                    {2191}let wNc_2609: bitstring = enc(Nc_2608,pkSess_2605) in
                                                    {2192}let m1_2610: bitstring = (OpenSecureChannelRequest,pkCli_1943,wNc_2609) in
                                                    {2193}out(c, (pkCli_1943,enc(m1_2610,pkSess_2605),sign(h(m1_2610),skCli_1942)));
                                                    {2194}in(c, (em2_2611: bitstring,sigM2_2612: bitstring));
                                                    {2195}let m2_2613: bitstring = dec(em2_2611,skCli_1942) in
                                                    {2196}if (verify(h(m2_2613),sigM2_2612,pkSess_2605) <> true) then
                                                        0
                                                    else
                                                        {2197}let (=OpenSecureChannelResponse,wNs_2614: bitstring,ST_2615: bitstring,TTL_2616: bitstring) = m2_2613 in
                                                        {2198}let Ns_2617: bitstring = dec(wNs_2614,skCli_1942) in
                                                        {2199}let Kcli_2618: bitstring = h((Nc_2608,Ns_2617)) in
                                                        {2200}out(c, senc(mCli(pkCli_1943,pkSess_2605),Kcli_2618))
                                            )
                                            else
                                                {2201}let pkSess_2619: bitstring = fail-any in
                                                {2202}out(c, GetEndpointRequest);
                                                {2203}in(c, (=GetEndpointResponse,=pkSess_2619,=SignAndEncrypt,SP_2620: bitstring,UP_2621: bitstring));
                                                {2204}new Nc_2622: bitstring;
                                                {2205}let wNc_2623: bitstring = enc(Nc_2622,pkSess_2619) in
                                                {2206}let m1_2624: bitstring = (OpenSecureChannelRequest,pkCli_1943,wNc_2623) in
                                                {2207}out(c, (pkCli_1943,enc(m1_2624,pkSess_2619),sign(h(m1_2624),skCli_1942)));
                                                {2208}in(c, (em2_2625: bitstring,sigM2_2626: bitstring));
                                                {2209}let m2_2627: bitstring = dec(em2_2625,skCli_1942) in
                                                {2210}if (verify(h(m2_2627),sigM2_2626,pkSess_2619) <> true) then
                                                    0
                                                else
                                                    {2211}let (=OpenSecureChannelResponse,wNs_2628: bitstring,ST_2629: bitstring,TTL_2630: bitstring) = m2_2627 in
                                                    {2212}let Ns_2631: bitstring = dec(wNs_2628,skCli_1942) in
                                                    {2213}let Kcli_2632: bitstring = h((Nc_2622,Ns_2631)) in
                                                    {2214}out(c, senc(mCli(pkCli_1943,pkSess_2619),Kcli_2632))
                                    )
                                    else
                                        {2215}let pkSess_2633: bitstring = fail-any in
                                        {2216}out(c, GetEndpointRequest);
                                        {2217}in(c, (=GetEndpointResponse,=pkSess_2633,=SignAndEncrypt,SP_2634: bitstring,UP_2635: bitstring));
                                        {2218}new Nc_2636: bitstring;
                                        {2219}let wNc_2637: bitstring = enc(Nc_2636,pkSess_2633) in
                                        {2220}let m1_2638: bitstring = (OpenSecureChannelRequest,pkCli_1943,wNc_2637) in
                                        {2221}out(c, (pkCli_1943,enc(m1_2638,pkSess_2633),sign(h(m1_2638),skCli_1942)));
                                        {2222}in(c, (em2_2639: bitstring,sigM2_2640: bitstring));
                                        {2223}let m2_2641: bitstring = dec(em2_2639,skCli_1942) in
                                        {2224}if (verify(h(m2_2641),sigM2_2640,pkSess_2633) <> true) then
                                            0
                                        else
                                            {2225}let (=OpenSecureChannelResponse,wNs_2642: bitstring,ST_2643: bitstring,TTL_2644: bitstring) = m2_2641 in
                                            {2226}let Ns_2645: bitstring = dec(wNs_2642,skCli_1942) in
                                            {2227}let Kcli_2646: bitstring = h((Nc_2636,Ns_2645)) in
                                            {2228}out(c, senc(mCli(pkCli_1943,pkSess_2633),Kcli_2646))
                            )
                            else
                                {2229}let pkSess_2647: bitstring = fail-any in
                                {2230}out(c, GetEndpointRequest);
                                {2231}in(c, (=GetEndpointResponse,=pkSess_2647,=SignAndEncrypt,SP_2648: bitstring,UP_2649: bitstring));
                                {2232}new Nc_2650: bitstring;
                                {2233}let wNc_2651: bitstring = enc(Nc_2650,pkSess_2647) in
                                {2234}let m1_2652: bitstring = (OpenSecureChannelRequest,pkCli_1943,wNc_2651) in
                                {2235}out(c, (pkCli_1943,enc(m1_2652,pkSess_2647),sign(h(m1_2652),skCli_1942)));
                                {2236}in(c, (em2_2653: bitstring,sigM2_2654: bitstring));
                                {2237}let m2_2655: bitstring = dec(em2_2653,skCli_1942) in
                                {2238}if (verify(h(m2_2655),sigM2_2654,pkSess_2647) <> true) then
                                    0
                                else
                                    {2239}let (=OpenSecureChannelResponse,wNs_2656: bitstring,ST_2657: bitstring,TTL_2658: bitstring) = m2_2655 in
                                    {2240}let Ns_2659: bitstring = dec(wNs_2656,skCli_1942) in
                                    {2241}let Kcli_2660: bitstring = h((Nc_2650,Ns_2659)) in
                                    {2242}out(c, senc(mCli(pkCli_1943,pkSess_2647),Kcli_2660))
                    )
                    else
                        {2243}let skCli_2661: bitstring = fail-any in
                        {2244}let pkCli_2662: bitstring = pub(skCli_2661) in
                        {2245}let v_2663: bool = (Disco = A) in
                        (
                            {2246}if v_2663 then
                            (
                                {2247}let pkDisco_2664: bitstring = pub(skA) in
                                {2248}let v_2665: bool = (Sess = A) in
                                (
                                    {2249}if v_2665 then
                                    (
                                        {2250}let pkSess_2666: bitstring = pub(skA) in
                                        {2251}out(c, GetEndpointRequest);
                                        {2252}in(c, (=GetEndpointResponse,=pkSess_2666,=SignAndEncrypt,SP_2667: bitstring,UP_2668: bitstring));
                                        {2253}new Nc_2669: bitstring;
                                        {2254}let wNc_2670: bitstring = enc(Nc_2669,pkSess_2666) in
                                        {2255}let m1_2671: bitstring = (OpenSecureChannelRequest,pkCli_2662,wNc_2670) in
                                        {2256}out(c, (pkCli_2662,enc(m1_2671,pkSess_2666),sign(h(m1_2671),skCli_2661)));
                                        {2257}in(c, (em2_2672: bitstring,sigM2_2673: bitstring));
                                        {2258}let m2_2674: bitstring = dec(em2_2672,skCli_2661) in
                                        {2259}if (verify(h(m2_2674),sigM2_2673,pkSess_2666) <> true) then
                                            0
                                        else
                                            {2260}let (=OpenSecureChannelResponse,wNs_2675: bitstring,ST_2676: bitstring,TTL_2677: bitstring) = m2_2674 in
                                            {2261}let Ns_2678: bitstring = dec(wNs_2675,skCli_2661) in
                                            {2262}let Kcli_2679: bitstring = h((Nc_2669,Ns_2678)) in
                                            {2263}out(c, senc(mCli(pkCli_2662,pkSess_2666),Kcli_2679))
                                    )
                                    else
                                        {2264}let v_2680: bool = (Sess = B) in
                                        (
                                            {2265}if v_2680 then
                                            (
                                                {2266}let pkSess_2681: bitstring = pub(skB) in
                                                {2267}out(c, GetEndpointRequest);
                                                {2268}in(c, (=GetEndpointResponse,=pkSess_2681,=SignAndEncrypt,SP_2682: bitstring,UP_2683: bitstring));
                                                {2269}new Nc_2684: bitstring;
                                                {2270}let wNc_2685: bitstring = enc(Nc_2684,pkSess_2681) in
                                                {2271}let m1_2686: bitstring = (OpenSecureChannelRequest,pkCli_2662,wNc_2685) in
                                                {2272}out(c, (pkCli_2662,enc(m1_2686,pkSess_2681),sign(h(m1_2686),skCli_2661)));
                                                {2273}in(c, (em2_2687: bitstring,sigM2_2688: bitstring));
                                                {2274}let m2_2689: bitstring = dec(em2_2687,skCli_2661) in
                                                {2275}if (verify(h(m2_2689),sigM2_2688,pkSess_2681) <> true) then
                                                    0
                                                else
                                                    {2276}let (=OpenSecureChannelResponse,wNs_2690: bitstring,ST_2691: bitstring,TTL_2692: bitstring) = m2_2689 in
                                                    {2277}let Ns_2693: bitstring = dec(wNs_2690,skCli_2661) in
                                                    {2278}let Kcli_2694: bitstring = h((Nc_2684,Ns_2693)) in
                                                    {2279}out(c, senc(mCli(pkCli_2662,pkSess_2681),Kcli_2694))
                                            )
                                            else
                                                {2280}let v_2695: bool = (Sess = C) in
                                                (
                                                    {2281}if v_2695 then
                                                    (
                                                        {2282}let pkSess_2696: bitstring = pub(skC) in
                                                        {2283}out(c, GetEndpointRequest);
                                                        {2284}in(c, (=GetEndpointResponse,=pkSess_2696,=SignAndEncrypt,SP_2697: bitstring,UP_2698: bitstring));
                                                        {2285}new Nc_2699: bitstring;
                                                        {2286}let wNc_2700: bitstring = enc(Nc_2699,pkSess_2696) in
                                                        {2287}let m1_2701: bitstring = (OpenSecureChannelRequest,pkCli_2662,wNc_2700) in
                                                        {2288}out(c, (pkCli_2662,enc(m1_2701,pkSess_2696),sign(h(m1_2701),skCli_2661)));
                                                        {2289}in(c, (em2_2702: bitstring,sigM2_2703: bitstring));
                                                        {2290}let m2_2704: bitstring = dec(em2_2702,skCli_2661) in
                                                        {2291}if (verify(h(m2_2704),sigM2_2703,pkSess_2696) <> true) then
                                                            0
                                                        else
                                                            {2292}let (=OpenSecureChannelResponse,wNs_2705: bitstring,ST_2706: bitstring,TTL_2707: bitstring) = m2_2704 in
                                                            {2293}let Ns_2708: bitstring = dec(wNs_2705,skCli_2661) in
                                                            {2294}let Kcli_2709: bitstring = h((Nc_2699,Ns_2708)) in
                                                            {2295}out(c, senc(mCli(pkCli_2662,pkSess_2696),Kcli_2709))
                                                    )
                                                    else
                                                        {2296}let pkSess_2710: bitstring = pub(sk(Sess)) in
                                                        {2297}out(c, GetEndpointRequest);
                                                        {2298}in(c, (=GetEndpointResponse,=pkSess_2710,=SignAndEncrypt,SP_2711: bitstring,UP_2712: bitstring));
                                                        {2299}new Nc_2713: bitstring;
                                                        {2300}let wNc_2714: bitstring = enc(Nc_2713,pkSess_2710) in
                                                        {2301}let m1_2715: bitstring = (OpenSecureChannelRequest,pkCli_2662,wNc_2714) in
                                                        {2302}out(c, (pkCli_2662,enc(m1_2715,pkSess_2710),sign(h(m1_2715),skCli_2661)));
                                                        {2303}in(c, (em2_2716: bitstring,sigM2_2717: bitstring));
                                                        {2304}let m2_2718: bitstring = dec(em2_2716,skCli_2661) in
                                                        {2305}if (verify(h(m2_2718),sigM2_2717,pkSess_2710) <> true) then
                                                            0
                                                        else
                                                            {2306}let (=OpenSecureChannelResponse,wNs_2719: bitstring,ST_2720: bitstring,TTL_2721: bitstring) = m2_2718 in
                                                            {2307}let Ns_2722: bitstring = dec(wNs_2719,skCli_2661) in
                                                            {2308}let Kcli_2723: bitstring = h((Nc_2713,Ns_2722)) in
                                                            {2309}out(c, senc(mCli(pkCli_2662,pkSess_2710),Kcli_2723))
                                                )
                                                else
                                                    {2310}let pkSess_2724: bitstring = fail-any in
                                                    {2311}out(c, GetEndpointRequest);
                                                    {2312}in(c, (=GetEndpointResponse,=pkSess_2724,=SignAndEncrypt,SP_2725: bitstring,UP_2726: bitstring));
                                                    {2313}new Nc_2727: bitstring;
                                                    {2314}let wNc_2728: bitstring = enc(Nc_2727,pkSess_2724) in
                                                    {2315}let m1_2729: bitstring = (OpenSecureChannelRequest,pkCli_2662,wNc_2728) in
                                                    {2316}out(c, (pkCli_2662,enc(m1_2729,pkSess_2724),sign(h(m1_2729),skCli_2661)));
                                                    {2317}in(c, (em2_2730: bitstring,sigM2_2731: bitstring));
                                                    {2318}let m2_2732: bitstring = dec(em2_2730,skCli_2661) in
                                                    {2319}if (verify(h(m2_2732),sigM2_2731,pkSess_2724) <> true) then
                                                        0
                                                    else
                                                        {2320}let (=OpenSecureChannelResponse,wNs_2733: bitstring,ST_2734: bitstring,TTL_2735: bitstring) = m2_2732 in
                                                        {2321}let Ns_2736: bitstring = dec(wNs_2733,skCli_2661) in
                                                        {2322}let Kcli_2737: bitstring = h((Nc_2727,Ns_2736)) in
                                                        {2323}out(c, senc(mCli(pkCli_2662,pkSess_2724),Kcli_2737))
                                        )
                                        else
                                            {2324}let pkSess_2738: bitstring = fail-any in
                                            {2325}out(c, GetEndpointRequest);
                                            {2326}in(c, (=GetEndpointResponse,=pkSess_2738,=SignAndEncrypt,SP_2739: bitstring,UP_2740: bitstring));
                                            {2327}new Nc_2741: bitstring;
                                            {2328}let wNc_2742: bitstring = enc(Nc_2741,pkSess_2738) in
                                            {2329}let m1_2743: bitstring = (OpenSecureChannelRequest,pkCli_2662,wNc_2742) in
                                            {2330}out(c, (pkCli_2662,enc(m1_2743,pkSess_2738),sign(h(m1_2743),skCli_2661)));
                                            {2331}in(c, (em2_2744: bitstring,sigM2_2745: bitstring));
                                            {2332}let m2_2746: bitstring = dec(em2_2744,skCli_2661) in
                                            {2333}if (verify(h(m2_2746),sigM2_2745,pkSess_2738) <> true) then
                                                0
                                            else
                                                {2334}let (=OpenSecureChannelResponse,wNs_2747: bitstring,ST_2748: bitstring,TTL_2749: bitstring) = m2_2746 in
                                                {2335}let Ns_2750: bitstring = dec(wNs_2747,skCli_2661) in
                                                {2336}let Kcli_2751: bitstring = h((Nc_2741,Ns_2750)) in
                                                {2337}out(c, senc(mCli(pkCli_2662,pkSess_2738),Kcli_2751))
                                )
                                else
                                    {2338}let pkSess_2752: bitstring = fail-any in
                                    {2339}out(c, GetEndpointRequest);
                                    {2340}in(c, (=GetEndpointResponse,=pkSess_2752,=SignAndEncrypt,SP_2753: bitstring,UP_2754: bitstring));
                                    {2341}new Nc_2755: bitstring;
                                    {2342}let wNc_2756: bitstring = enc(Nc_2755,pkSess_2752) in
                                    {2343}let m1_2757: bitstring = (OpenSecureChannelRequest,pkCli_2662,wNc_2756) in
                                    {2344}out(c, (pkCli_2662,enc(m1_2757,pkSess_2752),sign(h(m1_2757),skCli_2661)));
                                    {2345}in(c, (em2_2758: bitstring,sigM2_2759: bitstring));
                                    {2346}let m2_2760: bitstring = dec(em2_2758,skCli_2661) in
                                    {2347}if (verify(h(m2_2760),sigM2_2759,pkSess_2752) <> true) then
                                        0
                                    else
                                        {2348}let (=OpenSecureChannelResponse,wNs_2761: bitstring,ST_2762: bitstring,TTL_2763: bitstring) = m2_2760 in
                                        {2349}let Ns_2764: bitstring = dec(wNs_2761,skCli_2661) in
                                        {2350}let Kcli_2765: bitstring = h((Nc_2755,Ns_2764)) in
                                        {2351}out(c, senc(mCli(pkCli_2662,pkSess_2752),Kcli_2765))
                            )
                            else
                                {2352}let v_2766: bool = (Disco = B) in
                                (
                                    {2353}if v_2766 then
                                    (
                                        {2354}let pkDisco_2767: bitstring = pub(skB) in
                                        {2355}let v_2768: bool = (Sess = A) in
                                        (
                                            {2356}if v_2768 then
                                            (
                                                {2357}let pkSess_2769: bitstring = pub(skA) in
                                                {2358}out(c, GetEndpointRequest);
                                                {2359}in(c, (=GetEndpointResponse,=pkSess_2769,=SignAndEncrypt,SP_2770: bitstring,UP_2771: bitstring));
                                                {2360}new Nc_2772: bitstring;
                                                {2361}let wNc_2773: bitstring = enc(Nc_2772,pkSess_2769) in
                                                {2362}let m1_2774: bitstring = (OpenSecureChannelRequest,pkCli_2662,wNc_2773) in
                                                {2363}out(c, (pkCli_2662,enc(m1_2774,pkSess_2769),sign(h(m1_2774),skCli_2661)));
                                                {2364}in(c, (em2_2775: bitstring,sigM2_2776: bitstring));
                                                {2365}let m2_2777: bitstring = dec(em2_2775,skCli_2661) in
                                                {2366}if (verify(h(m2_2777),sigM2_2776,pkSess_2769) <> true) then
                                                    0
                                                else
                                                    {2367}let (=OpenSecureChannelResponse,wNs_2778: bitstring,ST_2779: bitstring,TTL_2780: bitstring) = m2_2777 in
                                                    {2368}let Ns_2781: bitstring = dec(wNs_2778,skCli_2661) in
                                                    {2369}let Kcli_2782: bitstring = h((Nc_2772,Ns_2781)) in
                                                    {2370}out(c, senc(mCli(pkCli_2662,pkSess_2769),Kcli_2782))
                                            )
                                            else
                                                {2371}let v_2783: bool = (Sess = B) in
                                                (
                                                    {2372}if v_2783 then
                                                    (
                                                        {2373}let pkSess_2784: bitstring = pub(skB) in
                                                        {2374}out(c, GetEndpointRequest);
                                                        {2375}in(c, (=GetEndpointResponse,=pkSess_2784,=SignAndEncrypt,SP_2785: bitstring,UP_2786: bitstring));
                                                        {2376}new Nc_2787: bitstring;
                                                        {2377}let wNc_2788: bitstring = enc(Nc_2787,pkSess_2784) in
                                                        {2378}let m1_2789: bitstring = (OpenSecureChannelRequest,pkCli_2662,wNc_2788) in
                                                        {2379}out(c, (pkCli_2662,enc(m1_2789,pkSess_2784),sign(h(m1_2789),skCli_2661)));
                                                        {2380}in(c, (em2_2790: bitstring,sigM2_2791: bitstring));
                                                        {2381}let m2_2792: bitstring = dec(em2_2790,skCli_2661) in
                                                        {2382}if (verify(h(m2_2792),sigM2_2791,pkSess_2784) <> true) then
                                                            0
                                                        else
                                                            {2383}let (=OpenSecureChannelResponse,wNs_2793: bitstring,ST_2794: bitstring,TTL_2795: bitstring) = m2_2792 in
                                                            {2384}let Ns_2796: bitstring = dec(wNs_2793,skCli_2661) in
                                                            {2385}let Kcli_2797: bitstring = h((Nc_2787,Ns_2796)) in
                                                            {2386}out(c, senc(mCli(pkCli_2662,pkSess_2784),Kcli_2797))
                                                    )
                                                    else
                                                        {2387}let v_2798: bool = (Sess = C) in
                                                        (
                                                            {2388}if v_2798 then
                                                            (
                                                                {2389}let pkSess_2799: bitstring = pub(skC) in
                                                                {2390}out(c, GetEndpointRequest);
                                                                {2391}in(c, (=GetEndpointResponse,=pkSess_2799,=SignAndEncrypt,SP_2800: bitstring,UP_2801: bitstring));
                                                                {2392}new Nc_2802: bitstring;
                                                                {2393}let wNc_2803: bitstring = enc(Nc_2802,pkSess_2799) in
                                                                {2394}let m1_2804: bitstring = (OpenSecureChannelRequest,pkCli_2662,wNc_2803) in
                                                                {2395}out(c, (pkCli_2662,enc(m1_2804,pkSess_2799),sign(h(m1_2804),skCli_2661)));
                                                                {2396}in(c, (em2_2805: bitstring,sigM2_2806: bitstring));
                                                                {2397}let m2_2807: bitstring = dec(em2_2805,skCli_2661) in
                                                                {2398}if (verify(h(m2_2807),sigM2_2806,pkSess_2799) <> true) then
                                                                    0
                                                                else
                                                                    {2399}let (=OpenSecureChannelResponse,wNs_2808: bitstring,ST_2809: bitstring,TTL_2810: bitstring) = m2_2807 in
                                                                    {2400}let Ns_2811: bitstring = dec(wNs_2808,skCli_2661) in
                                                                    {2401}let Kcli_2812: bitstring = h((Nc_2802,Ns_2811)) in
                                                                    {2402}out(c, senc(mCli(pkCli_2662,pkSess_2799),Kcli_2812))
                                                            )
                                                            else
                                                                {2403}let pkSess_2813: bitstring = pub(sk(Sess)) in
                                                                {2404}out(c, GetEndpointRequest);
                                                                {2405}in(c, (=GetEndpointResponse,=pkSess_2813,=SignAndEncrypt,SP_2814: bitstring,UP_2815: bitstring));
                                                                {2406}new Nc_2816: bitstring;
                                                                {2407}let wNc_2817: bitstring = enc(Nc_2816,pkSess_2813) in
                                                                {2408}let m1_2818: bitstring = (OpenSecureChannelRequest,pkCli_2662,wNc_2817) in
                                                                {2409}out(c, (pkCli_2662,enc(m1_2818,pkSess_2813),sign(h(m1_2818),skCli_2661)));
                                                                {2410}in(c, (em2_2819: bitstring,sigM2_2820: bitstring));
                                                                {2411}let m2_2821: bitstring = dec(em2_2819,skCli_2661) in
                                                                {2412}if (verify(h(m2_2821),sigM2_2820,pkSess_2813) <> true) then
                                                                    0
                                                                else
                                                                    {2413}let (=OpenSecureChannelResponse,wNs_2822: bitstring,ST_2823: bitstring,TTL_2824: bitstring) = m2_2821 in
                                                                    {2414}let Ns_2825: bitstring = dec(wNs_2822,skCli_2661) in
                                                                    {2415}let Kcli_2826: bitstring = h((Nc_2816,Ns_2825)) in
                                                                    {2416}out(c, senc(mCli(pkCli_2662,pkSess_2813),Kcli_2826))
                                                        )
                                                        else
                                                            {2417}let pkSess_2827: bitstring = fail-any in
                                                            {2418}out(c, GetEndpointRequest);
                                                            {2419}in(c, (=GetEndpointResponse,=pkSess_2827,=SignAndEncrypt,SP_2828: bitstring,UP_2829: bitstring));
                                                            {2420}new Nc_2830: bitstring;
                                                            {2421}let wNc_2831: bitstring = enc(Nc_2830,pkSess_2827) in
                                                            {2422}let m1_2832: bitstring = (OpenSecureChannelRequest,pkCli_2662,wNc_2831) in
                                                            {2423}out(c, (pkCli_2662,enc(m1_2832,pkSess_2827),sign(h(m1_2832),skCli_2661)));
                                                            {2424}in(c, (em2_2833: bitstring,sigM2_2834: bitstring));
                                                            {2425}let m2_2835: bitstring = dec(em2_2833,skCli_2661) in
                                                            {2426}if (verify(h(m2_2835),sigM2_2834,pkSess_2827) <> true) then
                                                                0
                                                            else
                                                                {2427}let (=OpenSecureChannelResponse,wNs_2836: bitstring,ST_2837: bitstring,TTL_2838: bitstring) = m2_2835 in
                                                                {2428}let Ns_2839: bitstring = dec(wNs_2836,skCli_2661) in
                                                                {2429}let Kcli_2840: bitstring = h((Nc_2830,Ns_2839)) in
                                                                {2430}out(c, senc(mCli(pkCli_2662,pkSess_2827),Kcli_2840))
                                                )
                                                else
                                                    {2431}let pkSess_2841: bitstring = fail-any in
                                                    {2432}out(c, GetEndpointRequest);
                                                    {2433}in(c, (=GetEndpointResponse,=pkSess_2841,=SignAndEncrypt,SP_2842: bitstring,UP_2843: bitstring));
                                                    {2434}new Nc_2844: bitstring;
                                                    {2435}let wNc_2845: bitstring = enc(Nc_2844,pkSess_2841) in
                                                    {2436}let m1_2846: bitstring = (OpenSecureChannelRequest,pkCli_2662,wNc_2845) in
                                                    {2437}out(c, (pkCli_2662,enc(m1_2846,pkSess_2841),sign(h(m1_2846),skCli_2661)));
                                                    {2438}in(c, (em2_2847: bitstring,sigM2_2848: bitstring));
                                                    {2439}let m2_2849: bitstring = dec(em2_2847,skCli_2661) in
                                                    {2440}if (verify(h(m2_2849),sigM2_2848,pkSess_2841) <> true) then
                                                        0
                                                    else
                                                        {2441}let (=OpenSecureChannelResponse,wNs_2850: bitstring,ST_2851: bitstring,TTL_2852: bitstring) = m2_2849 in
                                                        {2442}let Ns_2853: bitstring = dec(wNs_2850,skCli_2661) in
                                                        {2443}let Kcli_2854: bitstring = h((Nc_2844,Ns_2853)) in
                                                        {2444}out(c, senc(mCli(pkCli_2662,pkSess_2841),Kcli_2854))
                                        )
                                        else
                                            {2445}let pkSess_2855: bitstring = fail-any in
                                            {2446}out(c, GetEndpointRequest);
                                            {2447}in(c, (=GetEndpointResponse,=pkSess_2855,=SignAndEncrypt,SP_2856: bitstring,UP_2857: bitstring));
                                            {2448}new Nc_2858: bitstring;
                                            {2449}let wNc_2859: bitstring = enc(Nc_2858,pkSess_2855) in
                                            {2450}let m1_2860: bitstring = (OpenSecureChannelRequest,pkCli_2662,wNc_2859) in
                                            {2451}out(c, (pkCli_2662,enc(m1_2860,pkSess_2855),sign(h(m1_2860),skCli_2661)));
                                            {2452}in(c, (em2_2861: bitstring,sigM2_2862: bitstring));
                                            {2453}let m2_2863: bitstring = dec(em2_2861,skCli_2661) in
                                            {2454}if (verify(h(m2_2863),sigM2_2862,pkSess_2855) <> true) then
                                                0
                                            else
                                                {2455}let (=OpenSecureChannelResponse,wNs_2864: bitstring,ST_2865: bitstring,TTL_2866: bitstring) = m2_2863 in
                                                {2456}let Ns_2867: bitstring = dec(wNs_2864,skCli_2661) in
                                                {2457}let Kcli_2868: bitstring = h((Nc_2858,Ns_2867)) in
                                                {2458}out(c, senc(mCli(pkCli_2662,pkSess_2855),Kcli_2868))
                                    )
                                    else
                                        {2459}let v_2869: bool = (Disco = C) in
                                        (
                                            {2460}if v_2869 then
                                            (
                                                {2461}let pkDisco_2870: bitstring = pub(skC) in
                                                {2462}let v_2871: bool = (Sess = A) in
                                                (
                                                    {2463}if v_2871 then
                                                    (
                                                        {2464}let pkSess_2872: bitstring = pub(skA) in
                                                        {2465}out(c, GetEndpointRequest);
                                                        {2466}in(c, (=GetEndpointResponse,=pkSess_2872,=SignAndEncrypt,SP_2873: bitstring,UP_2874: bitstring));
                                                        {2467}new Nc_2875: bitstring;
                                                        {2468}let wNc_2876: bitstring = enc(Nc_2875,pkSess_2872) in
                                                        {2469}let m1_2877: bitstring = (OpenSecureChannelRequest,pkCli_2662,wNc_2876) in
                                                        {2470}out(c, (pkCli_2662,enc(m1_2877,pkSess_2872),sign(h(m1_2877),skCli_2661)));
                                                        {2471}in(c, (em2_2878: bitstring,sigM2_2879: bitstring));
                                                        {2472}let m2_2880: bitstring = dec(em2_2878,skCli_2661) in
                                                        {2473}if (verify(h(m2_2880),sigM2_2879,pkSess_2872) <> true) then
                                                            0
                                                        else
                                                            {2474}let (=OpenSecureChannelResponse,wNs_2881: bitstring,ST_2882: bitstring,TTL_2883: bitstring) = m2_2880 in
                                                            {2475}let Ns_2884: bitstring = dec(wNs_2881,skCli_2661) in
                                                            {2476}let Kcli_2885: bitstring = h((Nc_2875,Ns_2884)) in
                                                            {2477}out(c, senc(mCli(pkCli_2662,pkSess_2872),Kcli_2885))
                                                    )
                                                    else
                                                        {2478}let v_2886: bool = (Sess = B) in
                                                        (
                                                            {2479}if v_2886 then
                                                            (
                                                                {2480}let pkSess_2887: bitstring = pub(skB) in
                                                                {2481}out(c, GetEndpointRequest);
                                                                {2482}in(c, (=GetEndpointResponse,=pkSess_2887,=SignAndEncrypt,SP_2888: bitstring,UP_2889: bitstring));
                                                                {2483}new Nc_2890: bitstring;
                                                                {2484}let wNc_2891: bitstring = enc(Nc_2890,pkSess_2887) in
                                                                {2485}let m1_2892: bitstring = (OpenSecureChannelRequest,pkCli_2662,wNc_2891) in
                                                                {2486}out(c, (pkCli_2662,enc(m1_2892,pkSess_2887),sign(h(m1_2892),skCli_2661)));
                                                                {2487}in(c, (em2_2893: bitstring,sigM2_2894: bitstring));
                                                                {2488}let m2_2895: bitstring = dec(em2_2893,skCli_2661) in
                                                                {2489}if (verify(h(m2_2895),sigM2_2894,pkSess_2887) <> true) then
                                                                    0
                                                                else
                                                                    {2490}let (=OpenSecureChannelResponse,wNs_2896: bitstring,ST_2897: bitstring,TTL_2898: bitstring) = m2_2895 in
                                                                    {2491}let Ns_2899: bitstring = dec(wNs_2896,skCli_2661) in
                                                                    {2492}let Kcli_2900: bitstring = h((Nc_2890,Ns_2899)) in
                                                                    {2493}out(c, senc(mCli(pkCli_2662,pkSess_2887),Kcli_2900))
                                                            )
                                                            else
                                                                {2494}let v_2901: bool = (Sess = C) in
                                                                (
                                                                    {2495}if v_2901 then
                                                                    (
                                                                        {2496}let pkSess_2902: bitstring = pub(skC) in
                                                                        {2497}out(c, GetEndpointRequest);
                                                                        {2498}in(c, (=GetEndpointResponse,=pkSess_2902,=SignAndEncrypt,SP_2903: bitstring,UP_2904: bitstring));
                                                                        {2499}new Nc_2905: bitstring;
                                                                        {2500}let wNc_2906: bitstring = enc(Nc_2905,pkSess_2902) in
                                                                        {2501}let m1_2907: bitstring = (OpenSecureChannelRequest,pkCli_2662,wNc_2906) in
                                                                        {2502}out(c, (pkCli_2662,enc(m1_2907,pkSess_2902),sign(h(m1_2907),skCli_2661)));
                                                                        {2503}in(c, (em2_2908: bitstring,sigM2_2909: bitstring));
                                                                        {2504}let m2_2910: bitstring = dec(em2_2908,skCli_2661) in
                                                                        {2505}if (verify(h(m2_2910),sigM2_2909,pkSess_2902) <> true) then
                                                                            0
                                                                        else
                                                                            {2506}let (=OpenSecureChannelResponse,wNs_2911: bitstring,ST_2912: bitstring,TTL_2913: bitstring) = m2_2910 in
                                                                            {2507}let Ns_2914: bitstring = dec(wNs_2911,skCli_2661) in
                                                                            {2508}let Kcli_2915: bitstring = h((Nc_2905,Ns_2914)) in
                                                                            {2509}out(c, senc(mCli(pkCli_2662,pkSess_2902),Kcli_2915))
                                                                    )
                                                                    else
                                                                        {2510}let pkSess_2916: bitstring = pub(sk(Sess)) in
                                                                        {2511}out(c, GetEndpointRequest);
                                                                        {2512}in(c, (=GetEndpointResponse,=pkSess_2916,=SignAndEncrypt,SP_2917: bitstring,UP_2918: bitstring));
                                                                        {2513}new Nc_2919: bitstring;
                                                                        {2514}let wNc_2920: bitstring = enc(Nc_2919,pkSess_2916) in
                                                                        {2515}let m1_2921: bitstring = (OpenSecureChannelRequest,pkCli_2662,wNc_2920) in
                                                                        {2516}out(c, (pkCli_2662,enc(m1_2921,pkSess_2916),sign(h(m1_2921),skCli_2661)));
                                                                        {2517}in(c, (em2_2922: bitstring,sigM2_2923: bitstring));
                                                                        {2518}let m2_2924: bitstring = dec(em2_2922,skCli_2661) in
                                                                        {2519}if (verify(h(m2_2924),sigM2_2923,pkSess_2916) <> true) then
                                                                            0
                                                                        else
                                                                            {2520}let (=OpenSecureChannelResponse,wNs_2925: bitstring,ST_2926: bitstring,TTL_2927: bitstring) = m2_2924 in
                                                                            {2521}let Ns_2928: bitstring = dec(wNs_2925,skCli_2661) in
                                                                            {2522}let Kcli_2929: bitstring = h((Nc_2919,Ns_2928)) in
                                                                            {2523}out(c, senc(mCli(pkCli_2662,pkSess_2916),Kcli_2929))
                                                                )
                                                                else
                                                                    {2524}let pkSess_2930: bitstring = fail-any in
                                                                    {2525}out(c, GetEndpointRequest);
                                                                    {2526}in(c, (=GetEndpointResponse,=pkSess_2930,=SignAndEncrypt,SP_2931: bitstring,UP_2932: bitstring));
                                                                    {2527}new Nc_2933: bitstring;
                                                                    {2528}let wNc_2934: bitstring = enc(Nc_2933,pkSess_2930) in
                                                                    {2529}let m1_2935: bitstring = (OpenSecureChannelRequest,pkCli_2662,wNc_2934) in
                                                                    {2530}out(c, (pkCli_2662,enc(m1_2935,pkSess_2930),sign(h(m1_2935),skCli_2661)));
                                                                    {2531}in(c, (em2_2936: bitstring,sigM2_2937: bitstring));
                                                                    {2532}let m2_2938: bitstring = dec(em2_2936,skCli_2661) in
                                                                    {2533}if (verify(h(m2_2938),sigM2_2937,pkSess_2930) <> true) then
                                                                        0
                                                                    else
                                                                        {2534}let (=OpenSecureChannelResponse,wNs_2939: bitstring,ST_2940: bitstring,TTL_2941: bitstring) = m2_2938 in
                                                                        {2535}let Ns_2942: bitstring = dec(wNs_2939,skCli_2661) in
                                                                        {2536}let Kcli_2943: bitstring = h((Nc_2933,Ns_2942)) in
                                                                        {2537}out(c, senc(mCli(pkCli_2662,pkSess_2930),Kcli_2943))
                                                        )
                                                        else
                                                            {2538}let pkSess_2944: bitstring = fail-any in
                                                            {2539}out(c, GetEndpointRequest);
                                                            {2540}in(c, (=GetEndpointResponse,=pkSess_2944,=SignAndEncrypt,SP_2945: bitstring,UP_2946: bitstring));
                                                            {2541}new Nc_2947: bitstring;
                                                            {2542}let wNc_2948: bitstring = enc(Nc_2947,pkSess_2944) in
                                                            {2543}let m1_2949: bitstring = (OpenSecureChannelRequest,pkCli_2662,wNc_2948) in
                                                            {2544}out(c, (pkCli_2662,enc(m1_2949,pkSess_2944),sign(h(m1_2949),skCli_2661)));
                                                            {2545}in(c, (em2_2950: bitstring,sigM2_2951: bitstring));
                                                            {2546}let m2_2952: bitstring = dec(em2_2950,skCli_2661) in
                                                            {2547}if (verify(h(m2_2952),sigM2_2951,pkSess_2944) <> true) then
                                                                0
                                                            else
                                                                {2548}let (=OpenSecureChannelResponse,wNs_2953: bitstring,ST_2954: bitstring,TTL_2955: bitstring) = m2_2952 in
                                                                {2549}let Ns_2956: bitstring = dec(wNs_2953,skCli_2661) in
                                                                {2550}let Kcli_2957: bitstring = h((Nc_2947,Ns_2956)) in
                                                                {2551}out(c, senc(mCli(pkCli_2662,pkSess_2944),Kcli_2957))
                                                )
                                                else
                                                    {2552}let pkSess_2958: bitstring = fail-any in
                                                    {2553}out(c, GetEndpointRequest);
                                                    {2554}in(c, (=GetEndpointResponse,=pkSess_2958,=SignAndEncrypt,SP_2959: bitstring,UP_2960: bitstring));
                                                    {2555}new Nc_2961: bitstring;
                                                    {2556}let wNc_2962: bitstring = enc(Nc_2961,pkSess_2958) in
                                                    {2557}let m1_2963: bitstring = (OpenSecureChannelRequest,pkCli_2662,wNc_2962) in
                                                    {2558}out(c, (pkCli_2662,enc(m1_2963,pkSess_2958),sign(h(m1_2963),skCli_2661)));
                                                    {2559}in(c, (em2_2964: bitstring,sigM2_2965: bitstring));
                                                    {2560}let m2_2966: bitstring = dec(em2_2964,skCli_2661) in
                                                    {2561}if (verify(h(m2_2966),sigM2_2965,pkSess_2958) <> true) then
                                                        0
                                                    else
                                                        {2562}let (=OpenSecureChannelResponse,wNs_2967: bitstring,ST_2968: bitstring,TTL_2969: bitstring) = m2_2966 in
                                                        {2563}let Ns_2970: bitstring = dec(wNs_2967,skCli_2661) in
                                                        {2564}let Kcli_2971: bitstring = h((Nc_2961,Ns_2970)) in
                                                        {2565}out(c, senc(mCli(pkCli_2662,pkSess_2958),Kcli_2971))
                                            )
                                            else
                                                {2566}let pkDisco_2972: bitstring = pub(sk(Disco)) in
                                                {2567}let v_2973: bool = (Sess = A) in
                                                (
                                                    {2568}if v_2973 then
                                                    (
                                                        {2569}let pkSess_2974: bitstring = pub(skA) in
                                                        {2570}out(c, GetEndpointRequest);
                                                        {2571}in(c, (=GetEndpointResponse,=pkSess_2974,=SignAndEncrypt,SP_2975: bitstring,UP_2976: bitstring));
                                                        {2572}new Nc_2977: bitstring;
                                                        {2573}let wNc_2978: bitstring = enc(Nc_2977,pkSess_2974) in
                                                        {2574}let m1_2979: bitstring = (OpenSecureChannelRequest,pkCli_2662,wNc_2978) in
                                                        {2575}out(c, (pkCli_2662,enc(m1_2979,pkSess_2974),sign(h(m1_2979),skCli_2661)));
                                                        {2576}in(c, (em2_2980: bitstring,sigM2_2981: bitstring));
                                                        {2577}let m2_2982: bitstring = dec(em2_2980,skCli_2661) in
                                                        {2578}if (verify(h(m2_2982),sigM2_2981,pkSess_2974) <> true) then
                                                            0
                                                        else
                                                            {2579}let (=OpenSecureChannelResponse,wNs_2983: bitstring,ST_2984: bitstring,TTL_2985: bitstring) = m2_2982 in
                                                            {2580}let Ns_2986: bitstring = dec(wNs_2983,skCli_2661) in
                                                            {2581}let Kcli_2987: bitstring = h((Nc_2977,Ns_2986)) in
                                                            {2582}out(c, senc(mCli(pkCli_2662,pkSess_2974),Kcli_2987))
                                                    )
                                                    else
                                                        {2583}let v_2988: bool = (Sess = B) in
                                                        (
                                                            {2584}if v_2988 then
                                                            (
                                                                {2585}let pkSess_2989: bitstring = pub(skB) in
                                                                {2586}out(c, GetEndpointRequest);
                                                                {2587}in(c, (=GetEndpointResponse,=pkSess_2989,=SignAndEncrypt,SP_2990: bitstring,UP_2991: bitstring));
                                                                {2588}new Nc_2992: bitstring;
                                                                {2589}let wNc_2993: bitstring = enc(Nc_2992,pkSess_2989) in
                                                                {2590}let m1_2994: bitstring = (OpenSecureChannelRequest,pkCli_2662,wNc_2993) in
                                                                {2591}out(c, (pkCli_2662,enc(m1_2994,pkSess_2989),sign(h(m1_2994),skCli_2661)));
                                                                {2592}in(c, (em2_2995: bitstring,sigM2_2996: bitstring));
                                                                {2593}let m2_2997: bitstring = dec(em2_2995,skCli_2661) in
                                                                {2594}if (verify(h(m2_2997),sigM2_2996,pkSess_2989) <> true) then
                                                                    0
                                                                else
                                                                    {2595}let (=OpenSecureChannelResponse,wNs_2998: bitstring,ST_2999: bitstring,TTL_3000: bitstring) = m2_2997 in
                                                                    {2596}let Ns_3001: bitstring = dec(wNs_2998,skCli_2661) in
                                                                    {2597}let Kcli_3002: bitstring = h((Nc_2992,Ns_3001)) in
                                                                    {2598}out(c, senc(mCli(pkCli_2662,pkSess_2989),Kcli_3002))
                                                            )
                                                            else
                                                                {2599}let v_3003: bool = (Sess = C) in
                                                                (
                                                                    {2600}if v_3003 then
                                                                    (
                                                                        {2601}let pkSess_3004: bitstring = pub(skC) in
                                                                        {2602}out(c, GetEndpointRequest);
                                                                        {2603}in(c, (=GetEndpointResponse,=pkSess_3004,=SignAndEncrypt,SP_3005: bitstring,UP_3006: bitstring));
                                                                        {2604}new Nc_3007: bitstring;
                                                                        {2605}let wNc_3008: bitstring = enc(Nc_3007,pkSess_3004) in
                                                                        {2606}let m1_3009: bitstring = (OpenSecureChannelRequest,pkCli_2662,wNc_3008) in
                                                                        {2607}out(c, (pkCli_2662,enc(m1_3009,pkSess_3004),sign(h(m1_3009),skCli_2661)));
                                                                        {2608}in(c, (em2_3010: bitstring,sigM2_3011: bitstring));
                                                                        {2609}let m2_3012: bitstring = dec(em2_3010,skCli_2661) in
                                                                        {2610}if (verify(h(m2_3012),sigM2_3011,pkSess_3004) <> true) then
                                                                            0
                                                                        else
                                                                            {2611}let (=OpenSecureChannelResponse,wNs_3013: bitstring,ST_3014: bitstring,TTL_3015: bitstring) = m2_3012 in
                                                                            {2612}let Ns_3016: bitstring = dec(wNs_3013,skCli_2661) in
                                                                            {2613}let Kcli_3017: bitstring = h((Nc_3007,Ns_3016)) in
                                                                            {2614}out(c, senc(mCli(pkCli_2662,pkSess_3004),Kcli_3017))
                                                                    )
                                                                    else
                                                                        {2615}let pkSess_3018: bitstring = pub(sk(Sess)) in
                                                                        {2616}out(c, GetEndpointRequest);
                                                                        {2617}in(c, (=GetEndpointResponse,=pkSess_3018,=SignAndEncrypt,SP_3019: bitstring,UP_3020: bitstring));
                                                                        {2618}new Nc_3021: bitstring;
                                                                        {2619}let wNc_3022: bitstring = enc(Nc_3021,pkSess_3018) in
                                                                        {2620}let m1_3023: bitstring = (OpenSecureChannelRequest,pkCli_2662,wNc_3022) in
                                                                        {2621}out(c, (pkCli_2662,enc(m1_3023,pkSess_3018),sign(h(m1_3023),skCli_2661)));
                                                                        {2622}in(c, (em2_3024: bitstring,sigM2_3025: bitstring));
                                                                        {2623}let m2_3026: bitstring = dec(em2_3024,skCli_2661) in
                                                                        {2624}if (verify(h(m2_3026),sigM2_3025,pkSess_3018) <> true) then
                                                                            0
                                                                        else
                                                                            {2625}let (=OpenSecureChannelResponse,wNs_3027: bitstring,ST_3028: bitstring,TTL_3029: bitstring) = m2_3026 in
                                                                            {2626}let Ns_3030: bitstring = dec(wNs_3027,skCli_2661) in
                                                                            {2627}let Kcli_3031: bitstring = h((Nc_3021,Ns_3030)) in
                                                                            {2628}out(c, senc(mCli(pkCli_2662,pkSess_3018),Kcli_3031))
                                                                )
                                                                else
                                                                    {2629}let pkSess_3032: bitstring = fail-any in
                                                                    {2630}out(c, GetEndpointRequest);
                                                                    {2631}in(c, (=GetEndpointResponse,=pkSess_3032,=SignAndEncrypt,SP_3033: bitstring,UP_3034: bitstring));
                                                                    {2632}new Nc_3035: bitstring;
                                                                    {2633}let wNc_3036: bitstring = enc(Nc_3035,pkSess_3032) in
                                                                    {2634}let m1_3037: bitstring = (OpenSecureChannelRequest,pkCli_2662,wNc_3036) in
                                                                    {2635}out(c, (pkCli_2662,enc(m1_3037,pkSess_3032),sign(h(m1_3037),skCli_2661)));
                                                                    {2636}in(c, (em2_3038: bitstring,sigM2_3039: bitstring));
                                                                    {2637}let m2_3040: bitstring = dec(em2_3038,skCli_2661) in
                                                                    {2638}if (verify(h(m2_3040),sigM2_3039,pkSess_3032) <> true) then
                                                                        0
                                                                    else
                                                                        {2639}let (=OpenSecureChannelResponse,wNs_3041: bitstring,ST_3042: bitstring,TTL_3043: bitstring) = m2_3040 in
                                                                        {2640}let Ns_3044: bitstring = dec(wNs_3041,skCli_2661) in
                                                                        {2641}let Kcli_3045: bitstring = h((Nc_3035,Ns_3044)) in
                                                                        {2642}out(c, senc(mCli(pkCli_2662,pkSess_3032),Kcli_3045))
                                                        )
                                                        else
                                                            {2643}let pkSess_3046: bitstring = fail-any in
                                                            {2644}out(c, GetEndpointRequest);
                                                            {2645}in(c, (=GetEndpointResponse,=pkSess_3046,=SignAndEncrypt,SP_3047: bitstring,UP_3048: bitstring));
                                                            {2646}new Nc_3049: bitstring;
                                                            {2647}let wNc_3050: bitstring = enc(Nc_3049,pkSess_3046) in
                                                            {2648}let m1_3051: bitstring = (OpenSecureChannelRequest,pkCli_2662,wNc_3050) in
                                                            {2649}out(c, (pkCli_2662,enc(m1_3051,pkSess_3046),sign(h(m1_3051),skCli_2661)));
                                                            {2650}in(c, (em2_3052: bitstring,sigM2_3053: bitstring));
                                                            {2651}let m2_3054: bitstring = dec(em2_3052,skCli_2661) in
                                                            {2652}if (verify(h(m2_3054),sigM2_3053,pkSess_3046) <> true) then
                                                                0
                                                            else
                                                                {2653}let (=OpenSecureChannelResponse,wNs_3055: bitstring,ST_3056: bitstring,TTL_3057: bitstring) = m2_3054 in
                                                                {2654}let Ns_3058: bitstring = dec(wNs_3055,skCli_2661) in
                                                                {2655}let Kcli_3059: bitstring = h((Nc_3049,Ns_3058)) in
                                                                {2656}out(c, senc(mCli(pkCli_2662,pkSess_3046),Kcli_3059))
                                                )
                                                else
                                                    {2657}let pkSess_3060: bitstring = fail-any in
                                                    {2658}out(c, GetEndpointRequest);
                                                    {2659}in(c, (=GetEndpointResponse,=pkSess_3060,=SignAndEncrypt,SP_3061: bitstring,UP_3062: bitstring));
                                                    {2660}new Nc_3063: bitstring;
                                                    {2661}let wNc_3064: bitstring = enc(Nc_3063,pkSess_3060) in
                                                    {2662}let m1_3065: bitstring = (OpenSecureChannelRequest,pkCli_2662,wNc_3064) in
                                                    {2663}out(c, (pkCli_2662,enc(m1_3065,pkSess_3060),sign(h(m1_3065),skCli_2661)));
                                                    {2664}in(c, (em2_3066: bitstring,sigM2_3067: bitstring));
                                                    {2665}let m2_3068: bitstring = dec(em2_3066,skCli_2661) in
                                                    {2666}if (verify(h(m2_3068),sigM2_3067,pkSess_3060) <> true) then
                                                        0
                                                    else
                                                        {2667}let (=OpenSecureChannelResponse,wNs_3069: bitstring,ST_3070: bitstring,TTL_3071: bitstring) = m2_3068 in
                                                        {2668}let Ns_3072: bitstring = dec(wNs_3069,skCli_2661) in
                                                        {2669}let Kcli_3073: bitstring = h((Nc_3063,Ns_3072)) in
                                                        {2670}out(c, senc(mCli(pkCli_2662,pkSess_3060),Kcli_3073))
                                        )
                                        else
                                            {2671}let pkDisco_3074: bitstring = fail-any in
                                            {2672}let v_3075: bool = (Sess = A) in
                                            (
                                                {2673}if v_3075 then
                                                (
                                                    {2674}let pkSess_3076: bitstring = pub(skA) in
                                                    {2675}out(c, GetEndpointRequest);
                                                    {2676}in(c, (=GetEndpointResponse,=pkSess_3076,=SignAndEncrypt,SP_3077: bitstring,UP_3078: bitstring));
                                                    {2677}new Nc_3079: bitstring;
                                                    {2678}let wNc_3080: bitstring = enc(Nc_3079,pkSess_3076) in
                                                    {2679}let m1_3081: bitstring = (OpenSecureChannelRequest,pkCli_2662,wNc_3080) in
                                                    {2680}out(c, (pkCli_2662,enc(m1_3081,pkSess_3076),sign(h(m1_3081),skCli_2661)));
                                                    {2681}in(c, (em2_3082: bitstring,sigM2_3083: bitstring));
                                                    {2682}let m2_3084: bitstring = dec(em2_3082,skCli_2661) in
                                                    {2683}if (verify(h(m2_3084),sigM2_3083,pkSess_3076) <> true) then
                                                        0
                                                    else
                                                        {2684}let (=OpenSecureChannelResponse,wNs_3085: bitstring,ST_3086: bitstring,TTL_3087: bitstring) = m2_3084 in
                                                        {2685}let Ns_3088: bitstring = dec(wNs_3085,skCli_2661) in
                                                        {2686}let Kcli_3089: bitstring = h((Nc_3079,Ns_3088)) in
                                                        {2687}out(c, senc(mCli(pkCli_2662,pkSess_3076),Kcli_3089))
                                                )
                                                else
                                                    {2688}let v_3090: bool = (Sess = B) in
                                                    (
                                                        {2689}if v_3090 then
                                                        (
                                                            {2690}let pkSess_3091: bitstring = pub(skB) in
                                                            {2691}out(c, GetEndpointRequest);
                                                            {2692}in(c, (=GetEndpointResponse,=pkSess_3091,=SignAndEncrypt,SP_3092: bitstring,UP_3093: bitstring));
                                                            {2693}new Nc_3094: bitstring;
                                                            {2694}let wNc_3095: bitstring = enc(Nc_3094,pkSess_3091) in
                                                            {2695}let m1_3096: bitstring = (OpenSecureChannelRequest,pkCli_2662,wNc_3095) in
                                                            {2696}out(c, (pkCli_2662,enc(m1_3096,pkSess_3091),sign(h(m1_3096),skCli_2661)));
                                                            {2697}in(c, (em2_3097: bitstring,sigM2_3098: bitstring));
                                                            {2698}let m2_3099: bitstring = dec(em2_3097,skCli_2661) in
                                                            {2699}if (verify(h(m2_3099),sigM2_3098,pkSess_3091) <> true) then
                                                                0
                                                            else
                                                                {2700}let (=OpenSecureChannelResponse,wNs_3100: bitstring,ST_3101: bitstring,TTL_3102: bitstring) = m2_3099 in
                                                                {2701}let Ns_3103: bitstring = dec(wNs_3100,skCli_2661) in
                                                                {2702}let Kcli_3104: bitstring = h((Nc_3094,Ns_3103)) in
                                                                {2703}out(c, senc(mCli(pkCli_2662,pkSess_3091),Kcli_3104))
                                                        )
                                                        else
                                                            {2704}let v_3105: bool = (Sess = C) in
                                                            (
                                                                {2705}if v_3105 then
                                                                (
                                                                    {2706}let pkSess_3106: bitstring = pub(skC) in
                                                                    {2707}out(c, GetEndpointRequest);
                                                                    {2708}in(c, (=GetEndpointResponse,=pkSess_3106,=SignAndEncrypt,SP_3107: bitstring,UP_3108: bitstring));
                                                                    {2709}new Nc_3109: bitstring;
                                                                    {2710}let wNc_3110: bitstring = enc(Nc_3109,pkSess_3106) in
                                                                    {2711}let m1_3111: bitstring = (OpenSecureChannelRequest,pkCli_2662,wNc_3110) in
                                                                    {2712}out(c, (pkCli_2662,enc(m1_3111,pkSess_3106),sign(h(m1_3111),skCli_2661)));
                                                                    {2713}in(c, (em2_3112: bitstring,sigM2_3113: bitstring));
                                                                    {2714}let m2_3114: bitstring = dec(em2_3112,skCli_2661) in
                                                                    {2715}if (verify(h(m2_3114),sigM2_3113,pkSess_3106) <> true) then
                                                                        0
                                                                    else
                                                                        {2716}let (=OpenSecureChannelResponse,wNs_3115: bitstring,ST_3116: bitstring,TTL_3117: bitstring) = m2_3114 in
                                                                        {2717}let Ns_3118: bitstring = dec(wNs_3115,skCli_2661) in
                                                                        {2718}let Kcli_3119: bitstring = h((Nc_3109,Ns_3118)) in
                                                                        {2719}out(c, senc(mCli(pkCli_2662,pkSess_3106),Kcli_3119))
                                                                )
                                                                else
                                                                    {2720}let pkSess_3120: bitstring = pub(sk(Sess)) in
                                                                    {2721}out(c, GetEndpointRequest);
                                                                    {2722}in(c, (=GetEndpointResponse,=pkSess_3120,=SignAndEncrypt,SP_3121: bitstring,UP_3122: bitstring));
                                                                    {2723}new Nc_3123: bitstring;
                                                                    {2724}let wNc_3124: bitstring = enc(Nc_3123,pkSess_3120) in
                                                                    {2725}let m1_3125: bitstring = (OpenSecureChannelRequest,pkCli_2662,wNc_3124) in
                                                                    {2726}out(c, (pkCli_2662,enc(m1_3125,pkSess_3120),sign(h(m1_3125),skCli_2661)));
                                                                    {2727}in(c, (em2_3126: bitstring,sigM2_3127: bitstring));
                                                                    {2728}let m2_3128: bitstring = dec(em2_3126,skCli_2661) in
                                                                    {2729}if (verify(h(m2_3128),sigM2_3127,pkSess_3120) <> true) then
                                                                        0
                                                                    else
                                                                        {2730}let (=OpenSecureChannelResponse,wNs_3129: bitstring,ST_3130: bitstring,TTL_3131: bitstring) = m2_3128 in
                                                                        {2731}let Ns_3132: bitstring = dec(wNs_3129,skCli_2661) in
                                                                        {2732}let Kcli_3133: bitstring = h((Nc_3123,Ns_3132)) in
                                                                        {2733}out(c, senc(mCli(pkCli_2662,pkSess_3120),Kcli_3133))
                                                            )
                                                            else
                                                                {2734}let pkSess_3134: bitstring = fail-any in
                                                                {2735}out(c, GetEndpointRequest);
                                                                {2736}in(c, (=GetEndpointResponse,=pkSess_3134,=SignAndEncrypt,SP_3135: bitstring,UP_3136: bitstring));
                                                                {2737}new Nc_3137: bitstring;
                                                                {2738}let wNc_3138: bitstring = enc(Nc_3137,pkSess_3134) in
                                                                {2739}let m1_3139: bitstring = (OpenSecureChannelRequest,pkCli_2662,wNc_3138) in
                                                                {2740}out(c, (pkCli_2662,enc(m1_3139,pkSess_3134),sign(h(m1_3139),skCli_2661)));
                                                                {2741}in(c, (em2_3140: bitstring,sigM2_3141: bitstring));
                                                                {2742}let m2_3142: bitstring = dec(em2_3140,skCli_2661) in
                                                                {2743}if (verify(h(m2_3142),sigM2_3141,pkSess_3134) <> true) then
                                                                    0
                                                                else
                                                                    {2744}let (=OpenSecureChannelResponse,wNs_3143: bitstring,ST_3144: bitstring,TTL_3145: bitstring) = m2_3142 in
                                                                    {2745}let Ns_3146: bitstring = dec(wNs_3143,skCli_2661) in
                                                                    {2746}let Kcli_3147: bitstring = h((Nc_3137,Ns_3146)) in
                                                                    {2747}out(c, senc(mCli(pkCli_2662,pkSess_3134),Kcli_3147))
                                                    )
                                                    else
                                                        {2748}let pkSess_3148: bitstring = fail-any in
                                                        {2749}out(c, GetEndpointRequest);
                                                        {2750}in(c, (=GetEndpointResponse,=pkSess_3148,=SignAndEncrypt,SP_3149: bitstring,UP_3150: bitstring));
                                                        {2751}new Nc_3151: bitstring;
                                                        {2752}let wNc_3152: bitstring = enc(Nc_3151,pkSess_3148) in
                                                        {2753}let m1_3153: bitstring = (OpenSecureChannelRequest,pkCli_2662,wNc_3152) in
                                                        {2754}out(c, (pkCli_2662,enc(m1_3153,pkSess_3148),sign(h(m1_3153),skCli_2661)));
                                                        {2755}in(c, (em2_3154: bitstring,sigM2_3155: bitstring));
                                                        {2756}let m2_3156: bitstring = dec(em2_3154,skCli_2661) in
                                                        {2757}if (verify(h(m2_3156),sigM2_3155,pkSess_3148) <> true) then
                                                            0
                                                        else
                                                            {2758}let (=OpenSecureChannelResponse,wNs_3157: bitstring,ST_3158: bitstring,TTL_3159: bitstring) = m2_3156 in
                                                            {2759}let Ns_3160: bitstring = dec(wNs_3157,skCli_2661) in
                                                            {2760}let Kcli_3161: bitstring = h((Nc_3151,Ns_3160)) in
                                                            {2761}out(c, senc(mCli(pkCli_2662,pkSess_3148),Kcli_3161))
                                            )
                                            else
                                                {2762}let pkSess_3162: bitstring = fail-any in
                                                {2763}out(c, GetEndpointRequest);
                                                {2764}in(c, (=GetEndpointResponse,=pkSess_3162,=SignAndEncrypt,SP_3163: bitstring,UP_3164: bitstring));
                                                {2765}new Nc_3165: bitstring;
                                                {2766}let wNc_3166: bitstring = enc(Nc_3165,pkSess_3162) in
                                                {2767}let m1_3167: bitstring = (OpenSecureChannelRequest,pkCli_2662,wNc_3166) in
                                                {2768}out(c, (pkCli_2662,enc(m1_3167,pkSess_3162),sign(h(m1_3167),skCli_2661)));
                                                {2769}in(c, (em2_3168: bitstring,sigM2_3169: bitstring));
                                                {2770}let m2_3170: bitstring = dec(em2_3168,skCli_2661) in
                                                {2771}if (verify(h(m2_3170),sigM2_3169,pkSess_3162) <> true) then
                                                    0
                                                else
                                                    {2772}let (=OpenSecureChannelResponse,wNs_3171: bitstring,ST_3172: bitstring,TTL_3173: bitstring) = m2_3170 in
                                                    {2773}let Ns_3174: bitstring = dec(wNs_3171,skCli_2661) in
                                                    {2774}let Kcli_3175: bitstring = h((Nc_3165,Ns_3174)) in
                                                    {2775}out(c, senc(mCli(pkCli_2662,pkSess_3162),Kcli_3175))
                                )
                                else
                                    {2776}let pkDisco_3176: bitstring = fail-any in
                                    {2777}let v_3177: bool = (Sess = A) in
                                    (
                                        {2778}if v_3177 then
                                        (
                                            {2779}let pkSess_3178: bitstring = pub(skA) in
                                            {2780}out(c, GetEndpointRequest);
                                            {2781}in(c, (=GetEndpointResponse,=pkSess_3178,=SignAndEncrypt,SP_3179: bitstring,UP_3180: bitstring));
                                            {2782}new Nc_3181: bitstring;
                                            {2783}let wNc_3182: bitstring = enc(Nc_3181,pkSess_3178) in
                                            {2784}let m1_3183: bitstring = (OpenSecureChannelRequest,pkCli_2662,wNc_3182) in
                                            {2785}out(c, (pkCli_2662,enc(m1_3183,pkSess_3178),sign(h(m1_3183),skCli_2661)));
                                            {2786}in(c, (em2_3184: bitstring,sigM2_3185: bitstring));
                                            {2787}let m2_3186: bitstring = dec(em2_3184,skCli_2661) in
                                            {2788}if (verify(h(m2_3186),sigM2_3185,pkSess_3178) <> true) then
                                                0
                                            else
                                                {2789}let (=OpenSecureChannelResponse,wNs_3187: bitstring,ST_3188: bitstring,TTL_3189: bitstring) = m2_3186 in
                                                {2790}let Ns_3190: bitstring = dec(wNs_3187,skCli_2661) in
                                                {2791}let Kcli_3191: bitstring = h((Nc_3181,Ns_3190)) in
                                                {2792}out(c, senc(mCli(pkCli_2662,pkSess_3178),Kcli_3191))
                                        )
                                        else
                                            {2793}let v_3192: bool = (Sess = B) in
                                            (
                                                {2794}if v_3192 then
                                                (
                                                    {2795}let pkSess_3193: bitstring = pub(skB) in
                                                    {2796}out(c, GetEndpointRequest);
                                                    {2797}in(c, (=GetEndpointResponse,=pkSess_3193,=SignAndEncrypt,SP_3194: bitstring,UP_3195: bitstring));
                                                    {2798}new Nc_3196: bitstring;
                                                    {2799}let wNc_3197: bitstring = enc(Nc_3196,pkSess_3193) in
                                                    {2800}let m1_3198: bitstring = (OpenSecureChannelRequest,pkCli_2662,wNc_3197) in
                                                    {2801}out(c, (pkCli_2662,enc(m1_3198,pkSess_3193),sign(h(m1_3198),skCli_2661)));
                                                    {2802}in(c, (em2_3199: bitstring,sigM2_3200: bitstring));
                                                    {2803}let m2_3201: bitstring = dec(em2_3199,skCli_2661) in
                                                    {2804}if (verify(h(m2_3201),sigM2_3200,pkSess_3193) <> true) then
                                                        0
                                                    else
                                                        {2805}let (=OpenSecureChannelResponse,wNs_3202: bitstring,ST_3203: bitstring,TTL_3204: bitstring) = m2_3201 in
                                                        {2806}let Ns_3205: bitstring = dec(wNs_3202,skCli_2661) in
                                                        {2807}let Kcli_3206: bitstring = h((Nc_3196,Ns_3205)) in
                                                        {2808}out(c, senc(mCli(pkCli_2662,pkSess_3193),Kcli_3206))
                                                )
                                                else
                                                    {2809}let v_3207: bool = (Sess = C) in
                                                    (
                                                        {2810}if v_3207 then
                                                        (
                                                            {2811}let pkSess_3208: bitstring = pub(skC) in
                                                            {2812}out(c, GetEndpointRequest);
                                                            {2813}in(c, (=GetEndpointResponse,=pkSess_3208,=SignAndEncrypt,SP_3209: bitstring,UP_3210: bitstring));
                                                            {2814}new Nc_3211: bitstring;
                                                            {2815}let wNc_3212: bitstring = enc(Nc_3211,pkSess_3208) in
                                                            {2816}let m1_3213: bitstring = (OpenSecureChannelRequest,pkCli_2662,wNc_3212) in
                                                            {2817}out(c, (pkCli_2662,enc(m1_3213,pkSess_3208),sign(h(m1_3213),skCli_2661)));
                                                            {2818}in(c, (em2_3214: bitstring,sigM2_3215: bitstring));
                                                            {2819}let m2_3216: bitstring = dec(em2_3214,skCli_2661) in
                                                            {2820}if (verify(h(m2_3216),sigM2_3215,pkSess_3208) <> true) then
                                                                0
                                                            else
                                                                {2821}let (=OpenSecureChannelResponse,wNs_3217: bitstring,ST_3218: bitstring,TTL_3219: bitstring) = m2_3216 in
                                                                {2822}let Ns_3220: bitstring = dec(wNs_3217,skCli_2661) in
                                                                {2823}let Kcli_3221: bitstring = h((Nc_3211,Ns_3220)) in
                                                                {2824}out(c, senc(mCli(pkCli_2662,pkSess_3208),Kcli_3221))
                                                        )
                                                        else
                                                            {2825}let pkSess_3222: bitstring = pub(sk(Sess)) in
                                                            {2826}out(c, GetEndpointRequest);
                                                            {2827}in(c, (=GetEndpointResponse,=pkSess_3222,=SignAndEncrypt,SP_3223: bitstring,UP_3224: bitstring));
                                                            {2828}new Nc_3225: bitstring;
                                                            {2829}let wNc_3226: bitstring = enc(Nc_3225,pkSess_3222) in
                                                            {2830}let m1_3227: bitstring = (OpenSecureChannelRequest,pkCli_2662,wNc_3226) in
                                                            {2831}out(c, (pkCli_2662,enc(m1_3227,pkSess_3222),sign(h(m1_3227),skCli_2661)));
                                                            {2832}in(c, (em2_3228: bitstring,sigM2_3229: bitstring));
                                                            {2833}let m2_3230: bitstring = dec(em2_3228,skCli_2661) in
                                                            {2834}if (verify(h(m2_3230),sigM2_3229,pkSess_3222) <> true) then
                                                                0
                                                            else
                                                                {2835}let (=OpenSecureChannelResponse,wNs_3231: bitstring,ST_3232: bitstring,TTL_3233: bitstring) = m2_3230 in
                                                                {2836}let Ns_3234: bitstring = dec(wNs_3231,skCli_2661) in
                                                                {2837}let Kcli_3235: bitstring = h((Nc_3225,Ns_3234)) in
                                                                {2838}out(c, senc(mCli(pkCli_2662,pkSess_3222),Kcli_3235))
                                                    )
                                                    else
                                                        {2839}let pkSess_3236: bitstring = fail-any in
                                                        {2840}out(c, GetEndpointRequest);
                                                        {2841}in(c, (=GetEndpointResponse,=pkSess_3236,=SignAndEncrypt,SP_3237: bitstring,UP_3238: bitstring));
                                                        {2842}new Nc_3239: bitstring;
                                                        {2843}let wNc_3240: bitstring = enc(Nc_3239,pkSess_3236) in
                                                        {2844}let m1_3241: bitstring = (OpenSecureChannelRequest,pkCli_2662,wNc_3240) in
                                                        {2845}out(c, (pkCli_2662,enc(m1_3241,pkSess_3236),sign(h(m1_3241),skCli_2661)));
                                                        {2846}in(c, (em2_3242: bitstring,sigM2_3243: bitstring));
                                                        {2847}let m2_3244: bitstring = dec(em2_3242,skCli_2661) in
                                                        {2848}if (verify(h(m2_3244),sigM2_3243,pkSess_3236) <> true) then
                                                            0
                                                        else
                                                            {2849}let (=OpenSecureChannelResponse,wNs_3245: bitstring,ST_3246: bitstring,TTL_3247: bitstring) = m2_3244 in
                                                            {2850}let Ns_3248: bitstring = dec(wNs_3245,skCli_2661) in
                                                            {2851}let Kcli_3249: bitstring = h((Nc_3239,Ns_3248)) in
                                                            {2852}out(c, senc(mCli(pkCli_2662,pkSess_3236),Kcli_3249))
                                            )
                                            else
                                                {2853}let pkSess_3250: bitstring = fail-any in
                                                {2854}out(c, GetEndpointRequest);
                                                {2855}in(c, (=GetEndpointResponse,=pkSess_3250,=SignAndEncrypt,SP_3251: bitstring,UP_3252: bitstring));
                                                {2856}new Nc_3253: bitstring;
                                                {2857}let wNc_3254: bitstring = enc(Nc_3253,pkSess_3250) in
                                                {2858}let m1_3255: bitstring = (OpenSecureChannelRequest,pkCli_2662,wNc_3254) in
                                                {2859}out(c, (pkCli_2662,enc(m1_3255,pkSess_3250),sign(h(m1_3255),skCli_2661)));
                                                {2860}in(c, (em2_3256: bitstring,sigM2_3257: bitstring));
                                                {2861}let m2_3258: bitstring = dec(em2_3256,skCli_2661) in
                                                {2862}if (verify(h(m2_3258),sigM2_3257,pkSess_3250) <> true) then
                                                    0
                                                else
                                                    {2863}let (=OpenSecureChannelResponse,wNs_3259: bitstring,ST_3260: bitstring,TTL_3261: bitstring) = m2_3258 in
                                                    {2864}let Ns_3262: bitstring = dec(wNs_3259,skCli_2661) in
                                                    {2865}let Kcli_3263: bitstring = h((Nc_3253,Ns_3262)) in
                                                    {2866}out(c, senc(mCli(pkCli_2662,pkSess_3250),Kcli_3263))
                                    )
                                    else
                                        {2867}let pkSess_3264: bitstring = fail-any in
                                        {2868}out(c, GetEndpointRequest);
                                        {2869}in(c, (=GetEndpointResponse,=pkSess_3264,=SignAndEncrypt,SP_3265: bitstring,UP_3266: bitstring));
                                        {2870}new Nc_3267: bitstring;
                                        {2871}let wNc_3268: bitstring = enc(Nc_3267,pkSess_3264) in
                                        {2872}let m1_3269: bitstring = (OpenSecureChannelRequest,pkCli_2662,wNc_3268) in
                                        {2873}out(c, (pkCli_2662,enc(m1_3269,pkSess_3264),sign(h(m1_3269),skCli_2661)));
                                        {2874}in(c, (em2_3270: bitstring,sigM2_3271: bitstring));
                                        {2875}let m2_3272: bitstring = dec(em2_3270,skCli_2661) in
                                        {2876}if (verify(h(m2_3272),sigM2_3271,pkSess_3264) <> true) then
                                            0
                                        else
                                            {2877}let (=OpenSecureChannelResponse,wNs_3273: bitstring,ST_3274: bitstring,TTL_3275: bitstring) = m2_3272 in
                                            {2878}let Ns_3276: bitstring = dec(wNs_3273,skCli_2661) in
                                            {2879}let Kcli_3277: bitstring = h((Nc_3267,Ns_3276)) in
                                            {2880}out(c, senc(mCli(pkCli_2662,pkSess_3264),Kcli_3277))
                        )
                        else
                            {2881}let pkDisco_3278: bitstring = fail-any in
                            {2882}let v_3279: bool = (Sess = A) in
                            (
                                {2883}if v_3279 then
                                (
                                    {2884}let pkSess_3280: bitstring = pub(skA) in
                                    {2885}out(c, GetEndpointRequest);
                                    {2886}in(c, (=GetEndpointResponse,=pkSess_3280,=SignAndEncrypt,SP_3281: bitstring,UP_3282: bitstring));
                                    {2887}new Nc_3283: bitstring;
                                    {2888}let wNc_3284: bitstring = enc(Nc_3283,pkSess_3280) in
                                    {2889}let m1_3285: bitstring = (OpenSecureChannelRequest,pkCli_2662,wNc_3284) in
                                    {2890}out(c, (pkCli_2662,enc(m1_3285,pkSess_3280),sign(h(m1_3285),skCli_2661)));
                                    {2891}in(c, (em2_3286: bitstring,sigM2_3287: bitstring));
                                    {2892}let m2_3288: bitstring = dec(em2_3286,skCli_2661) in
                                    {2893}if (verify(h(m2_3288),sigM2_3287,pkSess_3280) <> true) then
                                        0
                                    else
                                        {2894}let (=OpenSecureChannelResponse,wNs_3289: bitstring,ST_3290: bitstring,TTL_3291: bitstring) = m2_3288 in
                                        {2895}let Ns_3292: bitstring = dec(wNs_3289,skCli_2661) in
                                        {2896}let Kcli_3293: bitstring = h((Nc_3283,Ns_3292)) in
                                        {2897}out(c, senc(mCli(pkCli_2662,pkSess_3280),Kcli_3293))
                                )
                                else
                                    {2898}let v_3294: bool = (Sess = B) in
                                    (
                                        {2899}if v_3294 then
                                        (
                                            {2900}let pkSess_3295: bitstring = pub(skB) in
                                            {2901}out(c, GetEndpointRequest);
                                            {2902}in(c, (=GetEndpointResponse,=pkSess_3295,=SignAndEncrypt,SP_3296: bitstring,UP_3297: bitstring));
                                            {2903}new Nc_3298: bitstring;
                                            {2904}let wNc_3299: bitstring = enc(Nc_3298,pkSess_3295) in
                                            {2905}let m1_3300: bitstring = (OpenSecureChannelRequest,pkCli_2662,wNc_3299) in
                                            {2906}out(c, (pkCli_2662,enc(m1_3300,pkSess_3295),sign(h(m1_3300),skCli_2661)));
                                            {2907}in(c, (em2_3301: bitstring,sigM2_3302: bitstring));
                                            {2908}let m2_3303: bitstring = dec(em2_3301,skCli_2661) in
                                            {2909}if (verify(h(m2_3303),sigM2_3302,pkSess_3295) <> true) then
                                                0
                                            else
                                                {2910}let (=OpenSecureChannelResponse,wNs_3304: bitstring,ST_3305: bitstring,TTL_3306: bitstring) = m2_3303 in
                                                {2911}let Ns_3307: bitstring = dec(wNs_3304,skCli_2661) in
                                                {2912}let Kcli_3308: bitstring = h((Nc_3298,Ns_3307)) in
                                                {2913}out(c, senc(mCli(pkCli_2662,pkSess_3295),Kcli_3308))
                                        )
                                        else
                                            {2914}let v_3309: bool = (Sess = C) in
                                            (
                                                {2915}if v_3309 then
                                                (
                                                    {2916}let pkSess_3310: bitstring = pub(skC) in
                                                    {2917}out(c, GetEndpointRequest);
                                                    {2918}in(c, (=GetEndpointResponse,=pkSess_3310,=SignAndEncrypt,SP_3311: bitstring,UP_3312: bitstring));
                                                    {2919}new Nc_3313: bitstring;
                                                    {2920}let wNc_3314: bitstring = enc(Nc_3313,pkSess_3310) in
                                                    {2921}let m1_3315: bitstring = (OpenSecureChannelRequest,pkCli_2662,wNc_3314) in
                                                    {2922}out(c, (pkCli_2662,enc(m1_3315,pkSess_3310),sign(h(m1_3315),skCli_2661)));
                                                    {2923}in(c, (em2_3316: bitstring,sigM2_3317: bitstring));
                                                    {2924}let m2_3318: bitstring = dec(em2_3316,skCli_2661) in
                                                    {2925}if (verify(h(m2_3318),sigM2_3317,pkSess_3310) <> true) then
                                                        0
                                                    else
                                                        {2926}let (=OpenSecureChannelResponse,wNs_3319: bitstring,ST_3320: bitstring,TTL_3321: bitstring) = m2_3318 in
                                                        {2927}let Ns_3322: bitstring = dec(wNs_3319,skCli_2661) in
                                                        {2928}let Kcli_3323: bitstring = h((Nc_3313,Ns_3322)) in
                                                        {2929}out(c, senc(mCli(pkCli_2662,pkSess_3310),Kcli_3323))
                                                )
                                                else
                                                    {2930}let pkSess_3324: bitstring = pub(sk(Sess)) in
                                                    {2931}out(c, GetEndpointRequest);
                                                    {2932}in(c, (=GetEndpointResponse,=pkSess_3324,=SignAndEncrypt,SP_3325: bitstring,UP_3326: bitstring));
                                                    {2933}new Nc_3327: bitstring;
                                                    {2934}let wNc_3328: bitstring = enc(Nc_3327,pkSess_3324) in
                                                    {2935}let m1_3329: bitstring = (OpenSecureChannelRequest,pkCli_2662,wNc_3328) in
                                                    {2936}out(c, (pkCli_2662,enc(m1_3329,pkSess_3324),sign(h(m1_3329),skCli_2661)));
                                                    {2937}in(c, (em2_3330: bitstring,sigM2_3331: bitstring));
                                                    {2938}let m2_3332: bitstring = dec(em2_3330,skCli_2661) in
                                                    {2939}if (verify(h(m2_3332),sigM2_3331,pkSess_3324) <> true) then
                                                        0
                                                    else
                                                        {2940}let (=OpenSecureChannelResponse,wNs_3333: bitstring,ST_3334: bitstring,TTL_3335: bitstring) = m2_3332 in
                                                        {2941}let Ns_3336: bitstring = dec(wNs_3333,skCli_2661) in
                                                        {2942}let Kcli_3337: bitstring = h((Nc_3327,Ns_3336)) in
                                                        {2943}out(c, senc(mCli(pkCli_2662,pkSess_3324),Kcli_3337))
                                            )
                                            else
                                                {2944}let pkSess_3338: bitstring = fail-any in
                                                {2945}out(c, GetEndpointRequest);
                                                {2946}in(c, (=GetEndpointResponse,=pkSess_3338,=SignAndEncrypt,SP_3339: bitstring,UP_3340: bitstring));
                                                {2947}new Nc_3341: bitstring;
                                                {2948}let wNc_3342: bitstring = enc(Nc_3341,pkSess_3338) in
                                                {2949}let m1_3343: bitstring = (OpenSecureChannelRequest,pkCli_2662,wNc_3342) in
                                                {2950}out(c, (pkCli_2662,enc(m1_3343,pkSess_3338),sign(h(m1_3343),skCli_2661)));
                                                {2951}in(c, (em2_3344: bitstring,sigM2_3345: bitstring));
                                                {2952}let m2_3346: bitstring = dec(em2_3344,skCli_2661) in
                                                {2953}if (verify(h(m2_3346),sigM2_3345,pkSess_3338) <> true) then
                                                    0
                                                else
                                                    {2954}let (=OpenSecureChannelResponse,wNs_3347: bitstring,ST_3348: bitstring,TTL_3349: bitstring) = m2_3346 in
                                                    {2955}let Ns_3350: bitstring = dec(wNs_3347,skCli_2661) in
                                                    {2956}let Kcli_3351: bitstring = h((Nc_3341,Ns_3350)) in
                                                    {2957}out(c, senc(mCli(pkCli_2662,pkSess_3338),Kcli_3351))
                                    )
                                    else
                                        {2958}let pkSess_3352: bitstring = fail-any in
                                        {2959}out(c, GetEndpointRequest);
                                        {2960}in(c, (=GetEndpointResponse,=pkSess_3352,=SignAndEncrypt,SP_3353: bitstring,UP_3354: bitstring));
                                        {2961}new Nc_3355: bitstring;
                                        {2962}let wNc_3356: bitstring = enc(Nc_3355,pkSess_3352) in
                                        {2963}let m1_3357: bitstring = (OpenSecureChannelRequest,pkCli_2662,wNc_3356) in
                                        {2964}out(c, (pkCli_2662,enc(m1_3357,pkSess_3352),sign(h(m1_3357),skCli_2661)));
                                        {2965}in(c, (em2_3358: bitstring,sigM2_3359: bitstring));
                                        {2966}let m2_3360: bitstring = dec(em2_3358,skCli_2661) in
                                        {2967}if (verify(h(m2_3360),sigM2_3359,pkSess_3352) <> true) then
                                            0
                                        else
                                            {2968}let (=OpenSecureChannelResponse,wNs_3361: bitstring,ST_3362: bitstring,TTL_3363: bitstring) = m2_3360 in
                                            {2969}let Ns_3364: bitstring = dec(wNs_3361,skCli_2661) in
                                            {2970}let Kcli_3365: bitstring = h((Nc_3355,Ns_3364)) in
                                            {2971}out(c, senc(mCli(pkCli_2662,pkSess_3352),Kcli_3365))
                            )
                            else
                                {2972}let pkSess_3366: bitstring = fail-any in
                                {2973}out(c, GetEndpointRequest);
                                {2974}in(c, (=GetEndpointResponse,=pkSess_3366,=SignAndEncrypt,SP_3367: bitstring,UP_3368: bitstring));
                                {2975}new Nc_3369: bitstring;
                                {2976}let wNc_3370: bitstring = enc(Nc_3369,pkSess_3366) in
                                {2977}let m1_3371: bitstring = (OpenSecureChannelRequest,pkCli_2662,wNc_3370) in
                                {2978}out(c, (pkCli_2662,enc(m1_3371,pkSess_3366),sign(h(m1_3371),skCli_2661)));
                                {2979}in(c, (em2_3372: bitstring,sigM2_3373: bitstring));
                                {2980}let m2_3374: bitstring = dec(em2_3372,skCli_2661) in
                                {2981}if (verify(h(m2_3374),sigM2_3373,pkSess_3366) <> true) then
                                    0
                                else
                                    {2982}let (=OpenSecureChannelResponse,wNs_3375: bitstring,ST_3376: bitstring,TTL_3377: bitstring) = m2_3374 in
                                    {2983}let Ns_3378: bitstring = dec(wNs_3375,skCli_2661) in
                                    {2984}let Kcli_3379: bitstring = h((Nc_3369,Ns_3378)) in
                                    {2985}out(c, senc(mCli(pkCli_2662,pkSess_3366),Kcli_3379))
            )
            else
                {2986}let skCli_3380: bitstring = fail-any in
                {2987}let pkCli_3381: bitstring = pub(skCli_3380) in
                {2988}let v_3382: bool = (Disco = A) in
                (
                    {2989}if v_3382 then
                    (
                        {2990}let pkDisco_3383: bitstring = pub(skA) in
                        {2991}let v_3384: bool = (Sess = A) in
                        (
                            {2992}if v_3384 then
                            (
                                {2993}let pkSess_3385: bitstring = pub(skA) in
                                {2994}out(c, GetEndpointRequest);
                                {2995}in(c, (=GetEndpointResponse,=pkSess_3385,=SignAndEncrypt,SP_3386: bitstring,UP_3387: bitstring));
                                {2996}new Nc_3388: bitstring;
                                {2997}let wNc_3389: bitstring = enc(Nc_3388,pkSess_3385) in
                                {2998}let m1_3390: bitstring = (OpenSecureChannelRequest,pkCli_3381,wNc_3389) in
                                {2999}out(c, (pkCli_3381,enc(m1_3390,pkSess_3385),sign(h(m1_3390),skCli_3380)));
                                {3000}in(c, (em2_3391: bitstring,sigM2_3392: bitstring));
                                {3001}let m2_3393: bitstring = dec(em2_3391,skCli_3380) in
                                {3002}if (verify(h(m2_3393),sigM2_3392,pkSess_3385) <> true) then
                                    0
                                else
                                    {3003}let (=OpenSecureChannelResponse,wNs_3394: bitstring,ST_3395: bitstring,TTL_3396: bitstring) = m2_3393 in
                                    {3004}let Ns_3397: bitstring = dec(wNs_3394,skCli_3380) in
                                    {3005}let Kcli_3398: bitstring = h((Nc_3388,Ns_3397)) in
                                    {3006}out(c, senc(mCli(pkCli_3381,pkSess_3385),Kcli_3398))
                            )
                            else
                                {3007}let v_3399: bool = (Sess = B) in
                                (
                                    {3008}if v_3399 then
                                    (
                                        {3009}let pkSess_3400: bitstring = pub(skB) in
                                        {3010}out(c, GetEndpointRequest);
                                        {3011}in(c, (=GetEndpointResponse,=pkSess_3400,=SignAndEncrypt,SP_3401: bitstring,UP_3402: bitstring));
                                        {3012}new Nc_3403: bitstring;
                                        {3013}let wNc_3404: bitstring = enc(Nc_3403,pkSess_3400) in
                                        {3014}let m1_3405: bitstring = (OpenSecureChannelRequest,pkCli_3381,wNc_3404) in
                                        {3015}out(c, (pkCli_3381,enc(m1_3405,pkSess_3400),sign(h(m1_3405),skCli_3380)));
                                        {3016}in(c, (em2_3406: bitstring,sigM2_3407: bitstring));
                                        {3017}let m2_3408: bitstring = dec(em2_3406,skCli_3380) in
                                        {3018}if (verify(h(m2_3408),sigM2_3407,pkSess_3400) <> true) then
                                            0
                                        else
                                            {3019}let (=OpenSecureChannelResponse,wNs_3409: bitstring,ST_3410: bitstring,TTL_3411: bitstring) = m2_3408 in
                                            {3020}let Ns_3412: bitstring = dec(wNs_3409,skCli_3380) in
                                            {3021}let Kcli_3413: bitstring = h((Nc_3403,Ns_3412)) in
                                            {3022}out(c, senc(mCli(pkCli_3381,pkSess_3400),Kcli_3413))
                                    )
                                    else
                                        {3023}let v_3414: bool = (Sess = C) in
                                        (
                                            {3024}if v_3414 then
                                            (
                                                {3025}let pkSess_3415: bitstring = pub(skC) in
                                                {3026}out(c, GetEndpointRequest);
                                                {3027}in(c, (=GetEndpointResponse,=pkSess_3415,=SignAndEncrypt,SP_3416: bitstring,UP_3417: bitstring));
                                                {3028}new Nc_3418: bitstring;
                                                {3029}let wNc_3419: bitstring = enc(Nc_3418,pkSess_3415) in
                                                {3030}let m1_3420: bitstring = (OpenSecureChannelRequest,pkCli_3381,wNc_3419) in
                                                {3031}out(c, (pkCli_3381,enc(m1_3420,pkSess_3415),sign(h(m1_3420),skCli_3380)));
                                                {3032}in(c, (em2_3421: bitstring,sigM2_3422: bitstring));
                                                {3033}let m2_3423: bitstring = dec(em2_3421,skCli_3380) in
                                                {3034}if (verify(h(m2_3423),sigM2_3422,pkSess_3415) <> true) then
                                                    0
                                                else
                                                    {3035}let (=OpenSecureChannelResponse,wNs_3424: bitstring,ST_3425: bitstring,TTL_3426: bitstring) = m2_3423 in
                                                    {3036}let Ns_3427: bitstring = dec(wNs_3424,skCli_3380) in
                                                    {3037}let Kcli_3428: bitstring = h((Nc_3418,Ns_3427)) in
                                                    {3038}out(c, senc(mCli(pkCli_3381,pkSess_3415),Kcli_3428))
                                            )
                                            else
                                                {3039}let pkSess_3429: bitstring = pub(sk(Sess)) in
                                                {3040}out(c, GetEndpointRequest);
                                                {3041}in(c, (=GetEndpointResponse,=pkSess_3429,=SignAndEncrypt,SP_3430: bitstring,UP_3431: bitstring));
                                                {3042}new Nc_3432: bitstring;
                                                {3043}let wNc_3433: bitstring = enc(Nc_3432,pkSess_3429) in
                                                {3044}let m1_3434: bitstring = (OpenSecureChannelRequest,pkCli_3381,wNc_3433) in
                                                {3045}out(c, (pkCli_3381,enc(m1_3434,pkSess_3429),sign(h(m1_3434),skCli_3380)));
                                                {3046}in(c, (em2_3435: bitstring,sigM2_3436: bitstring));
                                                {3047}let m2_3437: bitstring = dec(em2_3435,skCli_3380) in
                                                {3048}if (verify(h(m2_3437),sigM2_3436,pkSess_3429) <> true) then
                                                    0
                                                else
                                                    {3049}let (=OpenSecureChannelResponse,wNs_3438: bitstring,ST_3439: bitstring,TTL_3440: bitstring) = m2_3437 in
                                                    {3050}let Ns_3441: bitstring = dec(wNs_3438,skCli_3380) in
                                                    {3051}let Kcli_3442: bitstring = h((Nc_3432,Ns_3441)) in
                                                    {3052}out(c, senc(mCli(pkCli_3381,pkSess_3429),Kcli_3442))
                                        )
                                        else
                                            {3053}let pkSess_3443: bitstring = fail-any in
                                            {3054}out(c, GetEndpointRequest);
                                            {3055}in(c, (=GetEndpointResponse,=pkSess_3443,=SignAndEncrypt,SP_3444: bitstring,UP_3445: bitstring));
                                            {3056}new Nc_3446: bitstring;
                                            {3057}let wNc_3447: bitstring = enc(Nc_3446,pkSess_3443) in
                                            {3058}let m1_3448: bitstring = (OpenSecureChannelRequest,pkCli_3381,wNc_3447) in
                                            {3059}out(c, (pkCli_3381,enc(m1_3448,pkSess_3443),sign(h(m1_3448),skCli_3380)));
                                            {3060}in(c, (em2_3449: bitstring,sigM2_3450: bitstring));
                                            {3061}let m2_3451: bitstring = dec(em2_3449,skCli_3380) in
                                            {3062}if (verify(h(m2_3451),sigM2_3450,pkSess_3443) <> true) then
                                                0
                                            else
                                                {3063}let (=OpenSecureChannelResponse,wNs_3452: bitstring,ST_3453: bitstring,TTL_3454: bitstring) = m2_3451 in
                                                {3064}let Ns_3455: bitstring = dec(wNs_3452,skCli_3380) in
                                                {3065}let Kcli_3456: bitstring = h((Nc_3446,Ns_3455)) in
                                                {3066}out(c, senc(mCli(pkCli_3381,pkSess_3443),Kcli_3456))
                                )
                                else
                                    {3067}let pkSess_3457: bitstring = fail-any in
                                    {3068}out(c, GetEndpointRequest);
                                    {3069}in(c, (=GetEndpointResponse,=pkSess_3457,=SignAndEncrypt,SP_3458: bitstring,UP_3459: bitstring));
                                    {3070}new Nc_3460: bitstring;
                                    {3071}let wNc_3461: bitstring = enc(Nc_3460,pkSess_3457) in
                                    {3072}let m1_3462: bitstring = (OpenSecureChannelRequest,pkCli_3381,wNc_3461) in
                                    {3073}out(c, (pkCli_3381,enc(m1_3462,pkSess_3457),sign(h(m1_3462),skCli_3380)));
                                    {3074}in(c, (em2_3463: bitstring,sigM2_3464: bitstring));
                                    {3075}let m2_3465: bitstring = dec(em2_3463,skCli_3380) in
                                    {3076}if (verify(h(m2_3465),sigM2_3464,pkSess_3457) <> true) then
                                        0
                                    else
                                        {3077}let (=OpenSecureChannelResponse,wNs_3466: bitstring,ST_3467: bitstring,TTL_3468: bitstring) = m2_3465 in
                                        {3078}let Ns_3469: bitstring = dec(wNs_3466,skCli_3380) in
                                        {3079}let Kcli_3470: bitstring = h((Nc_3460,Ns_3469)) in
                                        {3080}out(c, senc(mCli(pkCli_3381,pkSess_3457),Kcli_3470))
                        )
                        else
                            {3081}let pkSess_3471: bitstring = fail-any in
                            {3082}out(c, GetEndpointRequest);
                            {3083}in(c, (=GetEndpointResponse,=pkSess_3471,=SignAndEncrypt,SP_3472: bitstring,UP_3473: bitstring));
                            {3084}new Nc_3474: bitstring;
                            {3085}let wNc_3475: bitstring = enc(Nc_3474,pkSess_3471) in
                            {3086}let m1_3476: bitstring = (OpenSecureChannelRequest,pkCli_3381,wNc_3475) in
                            {3087}out(c, (pkCli_3381,enc(m1_3476,pkSess_3471),sign(h(m1_3476),skCli_3380)));
                            {3088}in(c, (em2_3477: bitstring,sigM2_3478: bitstring));
                            {3089}let m2_3479: bitstring = dec(em2_3477,skCli_3380) in
                            {3090}if (verify(h(m2_3479),sigM2_3478,pkSess_3471) <> true) then
                                0
                            else
                                {3091}let (=OpenSecureChannelResponse,wNs_3480: bitstring,ST_3481: bitstring,TTL_3482: bitstring) = m2_3479 in
                                {3092}let Ns_3483: bitstring = dec(wNs_3480,skCli_3380) in
                                {3093}let Kcli_3484: bitstring = h((Nc_3474,Ns_3483)) in
                                {3094}out(c, senc(mCli(pkCli_3381,pkSess_3471),Kcli_3484))
                    )
                    else
                        {3095}let v_3485: bool = (Disco = B) in
                        (
                            {3096}if v_3485 then
                            (
                                {3097}let pkDisco_3486: bitstring = pub(skB) in
                                {3098}let v_3487: bool = (Sess = A) in
                                (
                                    {3099}if v_3487 then
                                    (
                                        {3100}let pkSess_3488: bitstring = pub(skA) in
                                        {3101}out(c, GetEndpointRequest);
                                        {3102}in(c, (=GetEndpointResponse,=pkSess_3488,=SignAndEncrypt,SP_3489: bitstring,UP_3490: bitstring));
                                        {3103}new Nc_3491: bitstring;
                                        {3104}let wNc_3492: bitstring = enc(Nc_3491,pkSess_3488) in
                                        {3105}let m1_3493: bitstring = (OpenSecureChannelRequest,pkCli_3381,wNc_3492) in
                                        {3106}out(c, (pkCli_3381,enc(m1_3493,pkSess_3488),sign(h(m1_3493),skCli_3380)));
                                        {3107}in(c, (em2_3494: bitstring,sigM2_3495: bitstring));
                                        {3108}let m2_3496: bitstring = dec(em2_3494,skCli_3380) in
                                        {3109}if (verify(h(m2_3496),sigM2_3495,pkSess_3488) <> true) then
                                            0
                                        else
                                            {3110}let (=OpenSecureChannelResponse,wNs_3497: bitstring,ST_3498: bitstring,TTL_3499: bitstring) = m2_3496 in
                                            {3111}let Ns_3500: bitstring = dec(wNs_3497,skCli_3380) in
                                            {3112}let Kcli_3501: bitstring = h((Nc_3491,Ns_3500)) in
                                            {3113}out(c, senc(mCli(pkCli_3381,pkSess_3488),Kcli_3501))
                                    )
                                    else
                                        {3114}let v_3502: bool = (Sess = B) in
                                        (
                                            {3115}if v_3502 then
                                            (
                                                {3116}let pkSess_3503: bitstring = pub(skB) in
                                                {3117}out(c, GetEndpointRequest);
                                                {3118}in(c, (=GetEndpointResponse,=pkSess_3503,=SignAndEncrypt,SP_3504: bitstring,UP_3505: bitstring));
                                                {3119}new Nc_3506: bitstring;
                                                {3120}let wNc_3507: bitstring = enc(Nc_3506,pkSess_3503) in
                                                {3121}let m1_3508: bitstring = (OpenSecureChannelRequest,pkCli_3381,wNc_3507) in
                                                {3122}out(c, (pkCli_3381,enc(m1_3508,pkSess_3503),sign(h(m1_3508),skCli_3380)));
                                                {3123}in(c, (em2_3509: bitstring,sigM2_3510: bitstring));
                                                {3124}let m2_3511: bitstring = dec(em2_3509,skCli_3380) in
                                                {3125}if (verify(h(m2_3511),sigM2_3510,pkSess_3503) <> true) then
                                                    0
                                                else
                                                    {3126}let (=OpenSecureChannelResponse,wNs_3512: bitstring,ST_3513: bitstring,TTL_3514: bitstring) = m2_3511 in
                                                    {3127}let Ns_3515: bitstring = dec(wNs_3512,skCli_3380) in
                                                    {3128}let Kcli_3516: bitstring = h((Nc_3506,Ns_3515)) in
                                                    {3129}out(c, senc(mCli(pkCli_3381,pkSess_3503),Kcli_3516))
                                            )
                                            else
                                                {3130}let v_3517: bool = (Sess = C) in
                                                (
                                                    {3131}if v_3517 then
                                                    (
                                                        {3132}let pkSess_3518: bitstring = pub(skC) in
                                                        {3133}out(c, GetEndpointRequest);
                                                        {3134}in(c, (=GetEndpointResponse,=pkSess_3518,=SignAndEncrypt,SP_3519: bitstring,UP_3520: bitstring));
                                                        {3135}new Nc_3521: bitstring;
                                                        {3136}let wNc_3522: bitstring = enc(Nc_3521,pkSess_3518) in
                                                        {3137}let m1_3523: bitstring = (OpenSecureChannelRequest,pkCli_3381,wNc_3522) in
                                                        {3138}out(c, (pkCli_3381,enc(m1_3523,pkSess_3518),sign(h(m1_3523),skCli_3380)));
                                                        {3139}in(c, (em2_3524: bitstring,sigM2_3525: bitstring));
                                                        {3140}let m2_3526: bitstring = dec(em2_3524,skCli_3380) in
                                                        {3141}if (verify(h(m2_3526),sigM2_3525,pkSess_3518) <> true) then
                                                            0
                                                        else
                                                            {3142}let (=OpenSecureChannelResponse,wNs_3527: bitstring,ST_3528: bitstring,TTL_3529: bitstring) = m2_3526 in
                                                            {3143}let Ns_3530: bitstring = dec(wNs_3527,skCli_3380) in
                                                            {3144}let Kcli_3531: bitstring = h((Nc_3521,Ns_3530)) in
                                                            {3145}out(c, senc(mCli(pkCli_3381,pkSess_3518),Kcli_3531))
                                                    )
                                                    else
                                                        {3146}let pkSess_3532: bitstring = pub(sk(Sess)) in
                                                        {3147}out(c, GetEndpointRequest);
                                                        {3148}in(c, (=GetEndpointResponse,=pkSess_3532,=SignAndEncrypt,SP_3533: bitstring,UP_3534: bitstring));
                                                        {3149}new Nc_3535: bitstring;
                                                        {3150}let wNc_3536: bitstring = enc(Nc_3535,pkSess_3532) in
                                                        {3151}let m1_3537: bitstring = (OpenSecureChannelRequest,pkCli_3381,wNc_3536) in
                                                        {3152}out(c, (pkCli_3381,enc(m1_3537,pkSess_3532),sign(h(m1_3537),skCli_3380)));
                                                        {3153}in(c, (em2_3538: bitstring,sigM2_3539: bitstring));
                                                        {3154}let m2_3540: bitstring = dec(em2_3538,skCli_3380) in
                                                        {3155}if (verify(h(m2_3540),sigM2_3539,pkSess_3532) <> true) then
                                                            0
                                                        else
                                                            {3156}let (=OpenSecureChannelResponse,wNs_3541: bitstring,ST_3542: bitstring,TTL_3543: bitstring) = m2_3540 in
                                                            {3157}let Ns_3544: bitstring = dec(wNs_3541,skCli_3380) in
                                                            {3158}let Kcli_3545: bitstring = h((Nc_3535,Ns_3544)) in
                                                            {3159}out(c, senc(mCli(pkCli_3381,pkSess_3532),Kcli_3545))
                                                )
                                                else
                                                    {3160}let pkSess_3546: bitstring = fail-any in
                                                    {3161}out(c, GetEndpointRequest);
                                                    {3162}in(c, (=GetEndpointResponse,=pkSess_3546,=SignAndEncrypt,SP_3547: bitstring,UP_3548: bitstring));
                                                    {3163}new Nc_3549: bitstring;
                                                    {3164}let wNc_3550: bitstring = enc(Nc_3549,pkSess_3546) in
                                                    {3165}let m1_3551: bitstring = (OpenSecureChannelRequest,pkCli_3381,wNc_3550) in
                                                    {3166}out(c, (pkCli_3381,enc(m1_3551,pkSess_3546),sign(h(m1_3551),skCli_3380)));
                                                    {3167}in(c, (em2_3552: bitstring,sigM2_3553: bitstring));
                                                    {3168}let m2_3554: bitstring = dec(em2_3552,skCli_3380) in
                                                    {3169}if (verify(h(m2_3554),sigM2_3553,pkSess_3546) <> true) then
                                                        0
                                                    else
                                                        {3170}let (=OpenSecureChannelResponse,wNs_3555: bitstring,ST_3556: bitstring,TTL_3557: bitstring) = m2_3554 in
                                                        {3171}let Ns_3558: bitstring = dec(wNs_3555,skCli_3380) in
                                                        {3172}let Kcli_3559: bitstring = h((Nc_3549,Ns_3558)) in
                                                        {3173}out(c, senc(mCli(pkCli_3381,pkSess_3546),Kcli_3559))
                                        )
                                        else
                                            {3174}let pkSess_3560: bitstring = fail-any in
                                            {3175}out(c, GetEndpointRequest);
                                            {3176}in(c, (=GetEndpointResponse,=pkSess_3560,=SignAndEncrypt,SP_3561: bitstring,UP_3562: bitstring));
                                            {3177}new Nc_3563: bitstring;
                                            {3178}let wNc_3564: bitstring = enc(Nc_3563,pkSess_3560) in
                                            {3179}let m1_3565: bitstring = (OpenSecureChannelRequest,pkCli_3381,wNc_3564) in
                                            {3180}out(c, (pkCli_3381,enc(m1_3565,pkSess_3560),sign(h(m1_3565),skCli_3380)));
                                            {3181}in(c, (em2_3566: bitstring,sigM2_3567: bitstring));
                                            {3182}let m2_3568: bitstring = dec(em2_3566,skCli_3380) in
                                            {3183}if (verify(h(m2_3568),sigM2_3567,pkSess_3560) <> true) then
                                                0
                                            else
                                                {3184}let (=OpenSecureChannelResponse,wNs_3569: bitstring,ST_3570: bitstring,TTL_3571: bitstring) = m2_3568 in
                                                {3185}let Ns_3572: bitstring = dec(wNs_3569,skCli_3380) in
                                                {3186}let Kcli_3573: bitstring = h((Nc_3563,Ns_3572)) in
                                                {3187}out(c, senc(mCli(pkCli_3381,pkSess_3560),Kcli_3573))
                                )
                                else
                                    {3188}let pkSess_3574: bitstring = fail-any in
                                    {3189}out(c, GetEndpointRequest);
                                    {3190}in(c, (=GetEndpointResponse,=pkSess_3574,=SignAndEncrypt,SP_3575: bitstring,UP_3576: bitstring));
                                    {3191}new Nc_3577: bitstring;
                                    {3192}let wNc_3578: bitstring = enc(Nc_3577,pkSess_3574) in
                                    {3193}let m1_3579: bitstring = (OpenSecureChannelRequest,pkCli_3381,wNc_3578) in
                                    {3194}out(c, (pkCli_3381,enc(m1_3579,pkSess_3574),sign(h(m1_3579),skCli_3380)));
                                    {3195}in(c, (em2_3580: bitstring,sigM2_3581: bitstring));
                                    {3196}let m2_3582: bitstring = dec(em2_3580,skCli_3380) in
                                    {3197}if (verify(h(m2_3582),sigM2_3581,pkSess_3574) <> true) then
                                        0
                                    else
                                        {3198}let (=OpenSecureChannelResponse,wNs_3583: bitstring,ST_3584: bitstring,TTL_3585: bitstring) = m2_3582 in
                                        {3199}let Ns_3586: bitstring = dec(wNs_3583,skCli_3380) in
                                        {3200}let Kcli_3587: bitstring = h((Nc_3577,Ns_3586)) in
                                        {3201}out(c, senc(mCli(pkCli_3381,pkSess_3574),Kcli_3587))
                            )
                            else
                                {3202}let v_3588: bool = (Disco = C) in
                                (
                                    {3203}if v_3588 then
                                    (
                                        {3204}let pkDisco_3589: bitstring = pub(skC) in
                                        {3205}let v_3590: bool = (Sess = A) in
                                        (
                                            {3206}if v_3590 then
                                            (
                                                {3207}let pkSess_3591: bitstring = pub(skA) in
                                                {3208}out(c, GetEndpointRequest);
                                                {3209}in(c, (=GetEndpointResponse,=pkSess_3591,=SignAndEncrypt,SP_3592: bitstring,UP_3593: bitstring));
                                                {3210}new Nc_3594: bitstring;
                                                {3211}let wNc_3595: bitstring = enc(Nc_3594,pkSess_3591) in
                                                {3212}let m1_3596: bitstring = (OpenSecureChannelRequest,pkCli_3381,wNc_3595) in
                                                {3213}out(c, (pkCli_3381,enc(m1_3596,pkSess_3591),sign(h(m1_3596),skCli_3380)));
                                                {3214}in(c, (em2_3597: bitstring,sigM2_3598: bitstring));
                                                {3215}let m2_3599: bitstring = dec(em2_3597,skCli_3380) in
                                                {3216}if (verify(h(m2_3599),sigM2_3598,pkSess_3591) <> true) then
                                                    0
                                                else
                                                    {3217}let (=OpenSecureChannelResponse,wNs_3600: bitstring,ST_3601: bitstring,TTL_3602: bitstring) = m2_3599 in
                                                    {3218}let Ns_3603: bitstring = dec(wNs_3600,skCli_3380) in
                                                    {3219}let Kcli_3604: bitstring = h((Nc_3594,Ns_3603)) in
                                                    {3220}out(c, senc(mCli(pkCli_3381,pkSess_3591),Kcli_3604))
                                            )
                                            else
                                                {3221}let v_3605: bool = (Sess = B) in
                                                (
                                                    {3222}if v_3605 then
                                                    (
                                                        {3223}let pkSess_3606: bitstring = pub(skB) in
                                                        {3224}out(c, GetEndpointRequest);
                                                        {3225}in(c, (=GetEndpointResponse,=pkSess_3606,=SignAndEncrypt,SP_3607: bitstring,UP_3608: bitstring));
                                                        {3226}new Nc_3609: bitstring;
                                                        {3227}let wNc_3610: bitstring = enc(Nc_3609,pkSess_3606) in
                                                        {3228}let m1_3611: bitstring = (OpenSecureChannelRequest,pkCli_3381,wNc_3610) in
                                                        {3229}out(c, (pkCli_3381,enc(m1_3611,pkSess_3606),sign(h(m1_3611),skCli_3380)));
                                                        {3230}in(c, (em2_3612: bitstring,sigM2_3613: bitstring));
                                                        {3231}let m2_3614: bitstring = dec(em2_3612,skCli_3380) in
                                                        {3232}if (verify(h(m2_3614),sigM2_3613,pkSess_3606) <> true) then
                                                            0
                                                        else
                                                            {3233}let (=OpenSecureChannelResponse,wNs_3615: bitstring,ST_3616: bitstring,TTL_3617: bitstring) = m2_3614 in
                                                            {3234}let Ns_3618: bitstring = dec(wNs_3615,skCli_3380) in
                                                            {3235}let Kcli_3619: bitstring = h((Nc_3609,Ns_3618)) in
                                                            {3236}out(c, senc(mCli(pkCli_3381,pkSess_3606),Kcli_3619))
                                                    )
                                                    else
                                                        {3237}let v_3620: bool = (Sess = C) in
                                                        (
                                                            {3238}if v_3620 then
                                                            (
                                                                {3239}let pkSess_3621: bitstring = pub(skC) in
                                                                {3240}out(c, GetEndpointRequest);
                                                                {3241}in(c, (=GetEndpointResponse,=pkSess_3621,=SignAndEncrypt,SP_3622: bitstring,UP_3623: bitstring));
                                                                {3242}new Nc_3624: bitstring;
                                                                {3243}let wNc_3625: bitstring = enc(Nc_3624,pkSess_3621) in
                                                                {3244}let m1_3626: bitstring = (OpenSecureChannelRequest,pkCli_3381,wNc_3625) in
                                                                {3245}out(c, (pkCli_3381,enc(m1_3626,pkSess_3621),sign(h(m1_3626),skCli_3380)));
                                                                {3246}in(c, (em2_3627: bitstring,sigM2_3628: bitstring));
                                                                {3247}let m2_3629: bitstring = dec(em2_3627,skCli_3380) in
                                                                {3248}if (verify(h(m2_3629),sigM2_3628,pkSess_3621) <> true) then
                                                                    0
                                                                else
                                                                    {3249}let (=OpenSecureChannelResponse,wNs_3630: bitstring,ST_3631: bitstring,TTL_3632: bitstring) = m2_3629 in
                                                                    {3250}let Ns_3633: bitstring = dec(wNs_3630,skCli_3380) in
                                                                    {3251}let Kcli_3634: bitstring = h((Nc_3624,Ns_3633)) in
                                                                    {3252}out(c, senc(mCli(pkCli_3381,pkSess_3621),Kcli_3634))
                                                            )
                                                            else
                                                                {3253}let pkSess_3635: bitstring = pub(sk(Sess)) in
                                                                {3254}out(c, GetEndpointRequest);
                                                                {3255}in(c, (=GetEndpointResponse,=pkSess_3635,=SignAndEncrypt,SP_3636: bitstring,UP_3637: bitstring));
                                                                {3256}new Nc_3638: bitstring;
                                                                {3257}let wNc_3639: bitstring = enc(Nc_3638,pkSess_3635) in
                                                                {3258}let m1_3640: bitstring = (OpenSecureChannelRequest,pkCli_3381,wNc_3639) in
                                                                {3259}out(c, (pkCli_3381,enc(m1_3640,pkSess_3635),sign(h(m1_3640),skCli_3380)));
                                                                {3260}in(c, (em2_3641: bitstring,sigM2_3642: bitstring));
                                                                {3261}let m2_3643: bitstring = dec(em2_3641,skCli_3380) in
                                                                {3262}if (verify(h(m2_3643),sigM2_3642,pkSess_3635) <> true) then
                                                                    0
                                                                else
                                                                    {3263}let (=OpenSecureChannelResponse,wNs_3644: bitstring,ST_3645: bitstring,TTL_3646: bitstring) = m2_3643 in
                                                                    {3264}let Ns_3647: bitstring = dec(wNs_3644,skCli_3380) in
                                                                    {3265}let Kcli_3648: bitstring = h((Nc_3638,Ns_3647)) in
                                                                    {3266}out(c, senc(mCli(pkCli_3381,pkSess_3635),Kcli_3648))
                                                        )
                                                        else
                                                            {3267}let pkSess_3649: bitstring = fail-any in
                                                            {3268}out(c, GetEndpointRequest);
                                                            {3269}in(c, (=GetEndpointResponse,=pkSess_3649,=SignAndEncrypt,SP_3650: bitstring,UP_3651: bitstring));
                                                            {3270}new Nc_3652: bitstring;
                                                            {3271}let wNc_3653: bitstring = enc(Nc_3652,pkSess_3649) in
                                                            {3272}let m1_3654: bitstring = (OpenSecureChannelRequest,pkCli_3381,wNc_3653) in
                                                            {3273}out(c, (pkCli_3381,enc(m1_3654,pkSess_3649),sign(h(m1_3654),skCli_3380)));
                                                            {3274}in(c, (em2_3655: bitstring,sigM2_3656: bitstring));
                                                            {3275}let m2_3657: bitstring = dec(em2_3655,skCli_3380) in
                                                            {3276}if (verify(h(m2_3657),sigM2_3656,pkSess_3649) <> true) then
                                                                0
                                                            else
                                                                {3277}let (=OpenSecureChannelResponse,wNs_3658: bitstring,ST_3659: bitstring,TTL_3660: bitstring) = m2_3657 in
                                                                {3278}let Ns_3661: bitstring = dec(wNs_3658,skCli_3380) in
                                                                {3279}let Kcli_3662: bitstring = h((Nc_3652,Ns_3661)) in
                                                                {3280}out(c, senc(mCli(pkCli_3381,pkSess_3649),Kcli_3662))
                                                )
                                                else
                                                    {3281}let pkSess_3663: bitstring = fail-any in
                                                    {3282}out(c, GetEndpointRequest);
                                                    {3283}in(c, (=GetEndpointResponse,=pkSess_3663,=SignAndEncrypt,SP_3664: bitstring,UP_3665: bitstring));
                                                    {3284}new Nc_3666: bitstring;
                                                    {3285}let wNc_3667: bitstring = enc(Nc_3666,pkSess_3663) in
                                                    {3286}let m1_3668: bitstring = (OpenSecureChannelRequest,pkCli_3381,wNc_3667) in
                                                    {3287}out(c, (pkCli_3381,enc(m1_3668,pkSess_3663),sign(h(m1_3668),skCli_3380)));
                                                    {3288}in(c, (em2_3669: bitstring,sigM2_3670: bitstring));
                                                    {3289}let m2_3671: bitstring = dec(em2_3669,skCli_3380) in
                                                    {3290}if (verify(h(m2_3671),sigM2_3670,pkSess_3663) <> true) then
                                                        0
                                                    else
                                                        {3291}let (=OpenSecureChannelResponse,wNs_3672: bitstring,ST_3673: bitstring,TTL_3674: bitstring) = m2_3671 in
                                                        {3292}let Ns_3675: bitstring = dec(wNs_3672,skCli_3380) in
                                                        {3293}let Kcli_3676: bitstring = h((Nc_3666,Ns_3675)) in
                                                        {3294}out(c, senc(mCli(pkCli_3381,pkSess_3663),Kcli_3676))
                                        )
                                        else
                                            {3295}let pkSess_3677: bitstring = fail-any in
                                            {3296}out(c, GetEndpointRequest);
                                            {3297}in(c, (=GetEndpointResponse,=pkSess_3677,=SignAndEncrypt,SP_3678: bitstring,UP_3679: bitstring));
                                            {3298}new Nc_3680: bitstring;
                                            {3299}let wNc_3681: bitstring = enc(Nc_3680,pkSess_3677) in
                                            {3300}let m1_3682: bitstring = (OpenSecureChannelRequest,pkCli_3381,wNc_3681) in
                                            {3301}out(c, (pkCli_3381,enc(m1_3682,pkSess_3677),sign(h(m1_3682),skCli_3380)));
                                            {3302}in(c, (em2_3683: bitstring,sigM2_3684: bitstring));
                                            {3303}let m2_3685: bitstring = dec(em2_3683,skCli_3380) in
                                            {3304}if (verify(h(m2_3685),sigM2_3684,pkSess_3677) <> true) then
                                                0
                                            else
                                                {3305}let (=OpenSecureChannelResponse,wNs_3686: bitstring,ST_3687: bitstring,TTL_3688: bitstring) = m2_3685 in
                                                {3306}let Ns_3689: bitstring = dec(wNs_3686,skCli_3380) in
                                                {3307}let Kcli_3690: bitstring = h((Nc_3680,Ns_3689)) in
                                                {3308}out(c, senc(mCli(pkCli_3381,pkSess_3677),Kcli_3690))
                                    )
                                    else
                                        {3309}let pkDisco_3691: bitstring = pub(sk(Disco)) in
                                        {3310}let v_3692: bool = (Sess = A) in
                                        (
                                            {3311}if v_3692 then
                                            (
                                                {3312}let pkSess_3693: bitstring = pub(skA) in
                                                {3313}out(c, GetEndpointRequest);
                                                {3314}in(c, (=GetEndpointResponse,=pkSess_3693,=SignAndEncrypt,SP_3694: bitstring,UP_3695: bitstring));
                                                {3315}new Nc_3696: bitstring;
                                                {3316}let wNc_3697: bitstring = enc(Nc_3696,pkSess_3693) in
                                                {3317}let m1_3698: bitstring = (OpenSecureChannelRequest,pkCli_3381,wNc_3697) in
                                                {3318}out(c, (pkCli_3381,enc(m1_3698,pkSess_3693),sign(h(m1_3698),skCli_3380)));
                                                {3319}in(c, (em2_3699: bitstring,sigM2_3700: bitstring));
                                                {3320}let m2_3701: bitstring = dec(em2_3699,skCli_3380) in
                                                {3321}if (verify(h(m2_3701),sigM2_3700,pkSess_3693) <> true) then
                                                    0
                                                else
                                                    {3322}let (=OpenSecureChannelResponse,wNs_3702: bitstring,ST_3703: bitstring,TTL_3704: bitstring) = m2_3701 in
                                                    {3323}let Ns_3705: bitstring = dec(wNs_3702,skCli_3380) in
                                                    {3324}let Kcli_3706: bitstring = h((Nc_3696,Ns_3705)) in
                                                    {3325}out(c, senc(mCli(pkCli_3381,pkSess_3693),Kcli_3706))
                                            )
                                            else
                                                {3326}let v_3707: bool = (Sess = B) in
                                                (
                                                    {3327}if v_3707 then
                                                    (
                                                        {3328}let pkSess_3708: bitstring = pub(skB) in
                                                        {3329}out(c, GetEndpointRequest);
                                                        {3330}in(c, (=GetEndpointResponse,=pkSess_3708,=SignAndEncrypt,SP_3709: bitstring,UP_3710: bitstring));
                                                        {3331}new Nc_3711: bitstring;
                                                        {3332}let wNc_3712: bitstring = enc(Nc_3711,pkSess_3708) in
                                                        {3333}let m1_3713: bitstring = (OpenSecureChannelRequest,pkCli_3381,wNc_3712) in
                                                        {3334}out(c, (pkCli_3381,enc(m1_3713,pkSess_3708),sign(h(m1_3713),skCli_3380)));
                                                        {3335}in(c, (em2_3714: bitstring,sigM2_3715: bitstring));
                                                        {3336}let m2_3716: bitstring = dec(em2_3714,skCli_3380) in
                                                        {3337}if (verify(h(m2_3716),sigM2_3715,pkSess_3708) <> true) then
                                                            0
                                                        else
                                                            {3338}let (=OpenSecureChannelResponse,wNs_3717: bitstring,ST_3718: bitstring,TTL_3719: bitstring) = m2_3716 in
                                                            {3339}let Ns_3720: bitstring = dec(wNs_3717,skCli_3380) in
                                                            {3340}let Kcli_3721: bitstring = h((Nc_3711,Ns_3720)) in
                                                            {3341}out(c, senc(mCli(pkCli_3381,pkSess_3708),Kcli_3721))
                                                    )
                                                    else
                                                        {3342}let v_3722: bool = (Sess = C) in
                                                        (
                                                            {3343}if v_3722 then
                                                            (
                                                                {3344}let pkSess_3723: bitstring = pub(skC) in
                                                                {3345}out(c, GetEndpointRequest);
                                                                {3346}in(c, (=GetEndpointResponse,=pkSess_3723,=SignAndEncrypt,SP_3724: bitstring,UP_3725: bitstring));
                                                                {3347}new Nc_3726: bitstring;
                                                                {3348}let wNc_3727: bitstring = enc(Nc_3726,pkSess_3723) in
                                                                {3349}let m1_3728: bitstring = (OpenSecureChannelRequest,pkCli_3381,wNc_3727) in
                                                                {3350}out(c, (pkCli_3381,enc(m1_3728,pkSess_3723),sign(h(m1_3728),skCli_3380)));
                                                                {3351}in(c, (em2_3729: bitstring,sigM2_3730: bitstring));
                                                                {3352}let m2_3731: bitstring = dec(em2_3729,skCli_3380) in
                                                                {3353}if (verify(h(m2_3731),sigM2_3730,pkSess_3723) <> true) then
                                                                    0
                                                                else
                                                                    {3354}let (=OpenSecureChannelResponse,wNs_3732: bitstring,ST_3733: bitstring,TTL_3734: bitstring) = m2_3731 in
                                                                    {3355}let Ns_3735: bitstring = dec(wNs_3732,skCli_3380) in
                                                                    {3356}let Kcli_3736: bitstring = h((Nc_3726,Ns_3735)) in
                                                                    {3357}out(c, senc(mCli(pkCli_3381,pkSess_3723),Kcli_3736))
                                                            )
                                                            else
                                                                {3358}let pkSess_3737: bitstring = pub(sk(Sess)) in
                                                                {3359}out(c, GetEndpointRequest);
                                                                {3360}in(c, (=GetEndpointResponse,=pkSess_3737,=SignAndEncrypt,SP_3738: bitstring,UP_3739: bitstring));
                                                                {3361}new Nc_3740: bitstring;
                                                                {3362}let wNc_3741: bitstring = enc(Nc_3740,pkSess_3737) in
                                                                {3363}let m1_3742: bitstring = (OpenSecureChannelRequest,pkCli_3381,wNc_3741) in
                                                                {3364}out(c, (pkCli_3381,enc(m1_3742,pkSess_3737),sign(h(m1_3742),skCli_3380)));
                                                                {3365}in(c, (em2_3743: bitstring,sigM2_3744: bitstring));
                                                                {3366}let m2_3745: bitstring = dec(em2_3743,skCli_3380) in
                                                                {3367}if (verify(h(m2_3745),sigM2_3744,pkSess_3737) <> true) then
                                                                    0
                                                                else
                                                                    {3368}let (=OpenSecureChannelResponse,wNs_3746: bitstring,ST_3747: bitstring,TTL_3748: bitstring) = m2_3745 in
                                                                    {3369}let Ns_3749: bitstring = dec(wNs_3746,skCli_3380) in
                                                                    {3370}let Kcli_3750: bitstring = h((Nc_3740,Ns_3749)) in
                                                                    {3371}out(c, senc(mCli(pkCli_3381,pkSess_3737),Kcli_3750))
                                                        )
                                                        else
                                                            {3372}let pkSess_3751: bitstring = fail-any in
                                                            {3373}out(c, GetEndpointRequest);
                                                            {3374}in(c, (=GetEndpointResponse,=pkSess_3751,=SignAndEncrypt,SP_3752: bitstring,UP_3753: bitstring));
                                                            {3375}new Nc_3754: bitstring;
                                                            {3376}let wNc_3755: bitstring = enc(Nc_3754,pkSess_3751) in
                                                            {3377}let m1_3756: bitstring = (OpenSecureChannelRequest,pkCli_3381,wNc_3755) in
                                                            {3378}out(c, (pkCli_3381,enc(m1_3756,pkSess_3751),sign(h(m1_3756),skCli_3380)));
                                                            {3379}in(c, (em2_3757: bitstring,sigM2_3758: bitstring));
                                                            {3380}let m2_3759: bitstring = dec(em2_3757,skCli_3380) in
                                                            {3381}if (verify(h(m2_3759),sigM2_3758,pkSess_3751) <> true) then
                                                                0
                                                            else
                                                                {3382}let (=OpenSecureChannelResponse,wNs_3760: bitstring,ST_3761: bitstring,TTL_3762: bitstring) = m2_3759 in
                                                                {3383}let Ns_3763: bitstring = dec(wNs_3760,skCli_3380) in
                                                                {3384}let Kcli_3764: bitstring = h((Nc_3754,Ns_3763)) in
                                                                {3385}out(c, senc(mCli(pkCli_3381,pkSess_3751),Kcli_3764))
                                                )
                                                else
                                                    {3386}let pkSess_3765: bitstring = fail-any in
                                                    {3387}out(c, GetEndpointRequest);
                                                    {3388}in(c, (=GetEndpointResponse,=pkSess_3765,=SignAndEncrypt,SP_3766: bitstring,UP_3767: bitstring));
                                                    {3389}new Nc_3768: bitstring;
                                                    {3390}let wNc_3769: bitstring = enc(Nc_3768,pkSess_3765) in
                                                    {3391}let m1_3770: bitstring = (OpenSecureChannelRequest,pkCli_3381,wNc_3769) in
                                                    {3392}out(c, (pkCli_3381,enc(m1_3770,pkSess_3765),sign(h(m1_3770),skCli_3380)));
                                                    {3393}in(c, (em2_3771: bitstring,sigM2_3772: bitstring));
                                                    {3394}let m2_3773: bitstring = dec(em2_3771,skCli_3380) in
                                                    {3395}if (verify(h(m2_3773),sigM2_3772,pkSess_3765) <> true) then
                                                        0
                                                    else
                                                        {3396}let (=OpenSecureChannelResponse,wNs_3774: bitstring,ST_3775: bitstring,TTL_3776: bitstring) = m2_3773 in
                                                        {3397}let Ns_3777: bitstring = dec(wNs_3774,skCli_3380) in
                                                        {3398}let Kcli_3778: bitstring = h((Nc_3768,Ns_3777)) in
                                                        {3399}out(c, senc(mCli(pkCli_3381,pkSess_3765),Kcli_3778))
                                        )
                                        else
                                            {3400}let pkSess_3779: bitstring = fail-any in
                                            {3401}out(c, GetEndpointRequest);
                                            {3402}in(c, (=GetEndpointResponse,=pkSess_3779,=SignAndEncrypt,SP_3780: bitstring,UP_3781: bitstring));
                                            {3403}new Nc_3782: bitstring;
                                            {3404}let wNc_3783: bitstring = enc(Nc_3782,pkSess_3779) in
                                            {3405}let m1_3784: bitstring = (OpenSecureChannelRequest,pkCli_3381,wNc_3783) in
                                            {3406}out(c, (pkCli_3381,enc(m1_3784,pkSess_3779),sign(h(m1_3784),skCli_3380)));
                                            {3407}in(c, (em2_3785: bitstring,sigM2_3786: bitstring));
                                            {3408}let m2_3787: bitstring = dec(em2_3785,skCli_3380) in
                                            {3409}if (verify(h(m2_3787),sigM2_3786,pkSess_3779) <> true) then
                                                0
                                            else
                                                {3410}let (=OpenSecureChannelResponse,wNs_3788: bitstring,ST_3789: bitstring,TTL_3790: bitstring) = m2_3787 in
                                                {3411}let Ns_3791: bitstring = dec(wNs_3788,skCli_3380) in
                                                {3412}let Kcli_3792: bitstring = h((Nc_3782,Ns_3791)) in
                                                {3413}out(c, senc(mCli(pkCli_3381,pkSess_3779),Kcli_3792))
                                )
                                else
                                    {3414}let pkDisco_3793: bitstring = fail-any in
                                    {3415}let v_3794: bool = (Sess = A) in
                                    (
                                        {3416}if v_3794 then
                                        (
                                            {3417}let pkSess_3795: bitstring = pub(skA) in
                                            {3418}out(c, GetEndpointRequest);
                                            {3419}in(c, (=GetEndpointResponse,=pkSess_3795,=SignAndEncrypt,SP_3796: bitstring,UP_3797: bitstring));
                                            {3420}new Nc_3798: bitstring;
                                            {3421}let wNc_3799: bitstring = enc(Nc_3798,pkSess_3795) in
                                            {3422}let m1_3800: bitstring = (OpenSecureChannelRequest,pkCli_3381,wNc_3799) in
                                            {3423}out(c, (pkCli_3381,enc(m1_3800,pkSess_3795),sign(h(m1_3800),skCli_3380)));
                                            {3424}in(c, (em2_3801: bitstring,sigM2_3802: bitstring));
                                            {3425}let m2_3803: bitstring = dec(em2_3801,skCli_3380) in
                                            {3426}if (verify(h(m2_3803),sigM2_3802,pkSess_3795) <> true) then
                                                0
                                            else
                                                {3427}let (=OpenSecureChannelResponse,wNs_3804: bitstring,ST_3805: bitstring,TTL_3806: bitstring) = m2_3803 in
                                                {3428}let Ns_3807: bitstring = dec(wNs_3804,skCli_3380) in
                                                {3429}let Kcli_3808: bitstring = h((Nc_3798,Ns_3807)) in
                                                {3430}out(c, senc(mCli(pkCli_3381,pkSess_3795),Kcli_3808))
                                        )
                                        else
                                            {3431}let v_3809: bool = (Sess = B) in
                                            (
                                                {3432}if v_3809 then
                                                (
                                                    {3433}let pkSess_3810: bitstring = pub(skB) in
                                                    {3434}out(c, GetEndpointRequest);
                                                    {3435}in(c, (=GetEndpointResponse,=pkSess_3810,=SignAndEncrypt,SP_3811: bitstring,UP_3812: bitstring));
                                                    {3436}new Nc_3813: bitstring;
                                                    {3437}let wNc_3814: bitstring = enc(Nc_3813,pkSess_3810) in
                                                    {3438}let m1_3815: bitstring = (OpenSecureChannelRequest,pkCli_3381,wNc_3814) in
                                                    {3439}out(c, (pkCli_3381,enc(m1_3815,pkSess_3810),sign(h(m1_3815),skCli_3380)));
                                                    {3440}in(c, (em2_3816: bitstring,sigM2_3817: bitstring));
                                                    {3441}let m2_3818: bitstring = dec(em2_3816,skCli_3380) in
                                                    {3442}if (verify(h(m2_3818),sigM2_3817,pkSess_3810) <> true) then
                                                        0
                                                    else
                                                        {3443}let (=OpenSecureChannelResponse,wNs_3819: bitstring,ST_3820: bitstring,TTL_3821: bitstring) = m2_3818 in
                                                        {3444}let Ns_3822: bitstring = dec(wNs_3819,skCli_3380) in
                                                        {3445}let Kcli_3823: bitstring = h((Nc_3813,Ns_3822)) in
                                                        {3446}out(c, senc(mCli(pkCli_3381,pkSess_3810),Kcli_3823))
                                                )
                                                else
                                                    {3447}let v_3824: bool = (Sess = C) in
                                                    (
                                                        {3448}if v_3824 then
                                                        (
                                                            {3449}let pkSess_3825: bitstring = pub(skC) in
                                                            {3450}out(c, GetEndpointRequest);
                                                            {3451}in(c, (=GetEndpointResponse,=pkSess_3825,=SignAndEncrypt,SP_3826: bitstring,UP_3827: bitstring));
                                                            {3452}new Nc_3828: bitstring;
                                                            {3453}let wNc_3829: bitstring = enc(Nc_3828,pkSess_3825) in
                                                            {3454}let m1_3830: bitstring = (OpenSecureChannelRequest,pkCli_3381,wNc_3829) in
                                                            {3455}out(c, (pkCli_3381,enc(m1_3830,pkSess_3825),sign(h(m1_3830),skCli_3380)));
                                                            {3456}in(c, (em2_3831: bitstring,sigM2_3832: bitstring));
                                                            {3457}let m2_3833: bitstring = dec(em2_3831,skCli_3380) in
                                                            {3458}if (verify(h(m2_3833),sigM2_3832,pkSess_3825) <> true) then
                                                                0
                                                            else
                                                                {3459}let (=OpenSecureChannelResponse,wNs_3834: bitstring,ST_3835: bitstring,TTL_3836: bitstring) = m2_3833 in
                                                                {3460}let Ns_3837: bitstring = dec(wNs_3834,skCli_3380) in
                                                                {3461}let Kcli_3838: bitstring = h((Nc_3828,Ns_3837)) in
                                                                {3462}out(c, senc(mCli(pkCli_3381,pkSess_3825),Kcli_3838))
                                                        )
                                                        else
                                                            {3463}let pkSess_3839: bitstring = pub(sk(Sess)) in
                                                            {3464}out(c, GetEndpointRequest);
                                                            {3465}in(c, (=GetEndpointResponse,=pkSess_3839,=SignAndEncrypt,SP_3840: bitstring,UP_3841: bitstring));
                                                            {3466}new Nc_3842: bitstring;
                                                            {3467}let wNc_3843: bitstring = enc(Nc_3842,pkSess_3839) in
                                                            {3468}let m1_3844: bitstring = (OpenSecureChannelRequest,pkCli_3381,wNc_3843) in
                                                            {3469}out(c, (pkCli_3381,enc(m1_3844,pkSess_3839),sign(h(m1_3844),skCli_3380)));
                                                            {3470}in(c, (em2_3845: bitstring,sigM2_3846: bitstring));
                                                            {3471}let m2_3847: bitstring = dec(em2_3845,skCli_3380) in
                                                            {3472}if (verify(h(m2_3847),sigM2_3846,pkSess_3839) <> true) then
                                                                0
                                                            else
                                                                {3473}let (=OpenSecureChannelResponse,wNs_3848: bitstring,ST_3849: bitstring,TTL_3850: bitstring) = m2_3847 in
                                                                {3474}let Ns_3851: bitstring = dec(wNs_3848,skCli_3380) in
                                                                {3475}let Kcli_3852: bitstring = h((Nc_3842,Ns_3851)) in
                                                                {3476}out(c, senc(mCli(pkCli_3381,pkSess_3839),Kcli_3852))
                                                    )
                                                    else
                                                        {3477}let pkSess_3853: bitstring = fail-any in
                                                        {3478}out(c, GetEndpointRequest);
                                                        {3479}in(c, (=GetEndpointResponse,=pkSess_3853,=SignAndEncrypt,SP_3854: bitstring,UP_3855: bitstring));
                                                        {3480}new Nc_3856: bitstring;
                                                        {3481}let wNc_3857: bitstring = enc(Nc_3856,pkSess_3853) in
                                                        {3482}let m1_3858: bitstring = (OpenSecureChannelRequest,pkCli_3381,wNc_3857) in
                                                        {3483}out(c, (pkCli_3381,enc(m1_3858,pkSess_3853),sign(h(m1_3858),skCli_3380)));
                                                        {3484}in(c, (em2_3859: bitstring,sigM2_3860: bitstring));
                                                        {3485}let m2_3861: bitstring = dec(em2_3859,skCli_3380) in
                                                        {3486}if (verify(h(m2_3861),sigM2_3860,pkSess_3853) <> true) then
                                                            0
                                                        else
                                                            {3487}let (=OpenSecureChannelResponse,wNs_3862: bitstring,ST_3863: bitstring,TTL_3864: bitstring) = m2_3861 in
                                                            {3488}let Ns_3865: bitstring = dec(wNs_3862,skCli_3380) in
                                                            {3489}let Kcli_3866: bitstring = h((Nc_3856,Ns_3865)) in
                                                            {3490}out(c, senc(mCli(pkCli_3381,pkSess_3853),Kcli_3866))
                                            )
                                            else
                                                {3491}let pkSess_3867: bitstring = fail-any in
                                                {3492}out(c, GetEndpointRequest);
                                                {3493}in(c, (=GetEndpointResponse,=pkSess_3867,=SignAndEncrypt,SP_3868: bitstring,UP_3869: bitstring));
                                                {3494}new Nc_3870: bitstring;
                                                {3495}let wNc_3871: bitstring = enc(Nc_3870,pkSess_3867) in
                                                {3496}let m1_3872: bitstring = (OpenSecureChannelRequest,pkCli_3381,wNc_3871) in
                                                {3497}out(c, (pkCli_3381,enc(m1_3872,pkSess_3867),sign(h(m1_3872),skCli_3380)));
                                                {3498}in(c, (em2_3873: bitstring,sigM2_3874: bitstring));
                                                {3499}let m2_3875: bitstring = dec(em2_3873,skCli_3380) in
                                                {3500}if (verify(h(m2_3875),sigM2_3874,pkSess_3867) <> true) then
                                                    0
                                                else
                                                    {3501}let (=OpenSecureChannelResponse,wNs_3876: bitstring,ST_3877: bitstring,TTL_3878: bitstring) = m2_3875 in
                                                    {3502}let Ns_3879: bitstring = dec(wNs_3876,skCli_3380) in
                                                    {3503}let Kcli_3880: bitstring = h((Nc_3870,Ns_3879)) in
                                                    {3504}out(c, senc(mCli(pkCli_3381,pkSess_3867),Kcli_3880))
                                    )
                                    else
                                        {3505}let pkSess_3881: bitstring = fail-any in
                                        {3506}out(c, GetEndpointRequest);
                                        {3507}in(c, (=GetEndpointResponse,=pkSess_3881,=SignAndEncrypt,SP_3882: bitstring,UP_3883: bitstring));
                                        {3508}new Nc_3884: bitstring;
                                        {3509}let wNc_3885: bitstring = enc(Nc_3884,pkSess_3881) in
                                        {3510}let m1_3886: bitstring = (OpenSecureChannelRequest,pkCli_3381,wNc_3885) in
                                        {3511}out(c, (pkCli_3381,enc(m1_3886,pkSess_3881),sign(h(m1_3886),skCli_3380)));
                                        {3512}in(c, (em2_3887: bitstring,sigM2_3888: bitstring));
                                        {3513}let m2_3889: bitstring = dec(em2_3887,skCli_3380) in
                                        {3514}if (verify(h(m2_3889),sigM2_3888,pkSess_3881) <> true) then
                                            0
                                        else
                                            {3515}let (=OpenSecureChannelResponse,wNs_3890: bitstring,ST_3891: bitstring,TTL_3892: bitstring) = m2_3889 in
                                            {3516}let Ns_3893: bitstring = dec(wNs_3890,skCli_3380) in
                                            {3517}let Kcli_3894: bitstring = h((Nc_3884,Ns_3893)) in
                                            {3518}out(c, senc(mCli(pkCli_3381,pkSess_3881),Kcli_3894))
                        )
                        else
                            {3519}let pkDisco_3895: bitstring = fail-any in
                            {3520}let v_3896: bool = (Sess = A) in
                            (
                                {3521}if v_3896 then
                                (
                                    {3522}let pkSess_3897: bitstring = pub(skA) in
                                    {3523}out(c, GetEndpointRequest);
                                    {3524}in(c, (=GetEndpointResponse,=pkSess_3897,=SignAndEncrypt,SP_3898: bitstring,UP_3899: bitstring));
                                    {3525}new Nc_3900: bitstring;
                                    {3526}let wNc_3901: bitstring = enc(Nc_3900,pkSess_3897) in
                                    {3527}let m1_3902: bitstring = (OpenSecureChannelRequest,pkCli_3381,wNc_3901) in
                                    {3528}out(c, (pkCli_3381,enc(m1_3902,pkSess_3897),sign(h(m1_3902),skCli_3380)));
                                    {3529}in(c, (em2_3903: bitstring,sigM2_3904: bitstring));
                                    {3530}let m2_3905: bitstring = dec(em2_3903,skCli_3380) in
                                    {3531}if (verify(h(m2_3905),sigM2_3904,pkSess_3897) <> true) then
                                        0
                                    else
                                        {3532}let (=OpenSecureChannelResponse,wNs_3906: bitstring,ST_3907: bitstring,TTL_3908: bitstring) = m2_3905 in
                                        {3533}let Ns_3909: bitstring = dec(wNs_3906,skCli_3380) in
                                        {3534}let Kcli_3910: bitstring = h((Nc_3900,Ns_3909)) in
                                        {3535}out(c, senc(mCli(pkCli_3381,pkSess_3897),Kcli_3910))
                                )
                                else
                                    {3536}let v_3911: bool = (Sess = B) in
                                    (
                                        {3537}if v_3911 then
                                        (
                                            {3538}let pkSess_3912: bitstring = pub(skB) in
                                            {3539}out(c, GetEndpointRequest);
                                            {3540}in(c, (=GetEndpointResponse,=pkSess_3912,=SignAndEncrypt,SP_3913: bitstring,UP_3914: bitstring));
                                            {3541}new Nc_3915: bitstring;
                                            {3542}let wNc_3916: bitstring = enc(Nc_3915,pkSess_3912) in
                                            {3543}let m1_3917: bitstring = (OpenSecureChannelRequest,pkCli_3381,wNc_3916) in
                                            {3544}out(c, (pkCli_3381,enc(m1_3917,pkSess_3912),sign(h(m1_3917),skCli_3380)));
                                            {3545}in(c, (em2_3918: bitstring,sigM2_3919: bitstring));
                                            {3546}let m2_3920: bitstring = dec(em2_3918,skCli_3380) in
                                            {3547}if (verify(h(m2_3920),sigM2_3919,pkSess_3912) <> true) then
                                                0
                                            else
                                                {3548}let (=OpenSecureChannelResponse,wNs_3921: bitstring,ST_3922: bitstring,TTL_3923: bitstring) = m2_3920 in
                                                {3549}let Ns_3924: bitstring = dec(wNs_3921,skCli_3380) in
                                                {3550}let Kcli_3925: bitstring = h((Nc_3915,Ns_3924)) in
                                                {3551}out(c, senc(mCli(pkCli_3381,pkSess_3912),Kcli_3925))
                                        )
                                        else
                                            {3552}let v_3926: bool = (Sess = C) in
                                            (
                                                {3553}if v_3926 then
                                                (
                                                    {3554}let pkSess_3927: bitstring = pub(skC) in
                                                    {3555}out(c, GetEndpointRequest);
                                                    {3556}in(c, (=GetEndpointResponse,=pkSess_3927,=SignAndEncrypt,SP_3928: bitstring,UP_3929: bitstring));
                                                    {3557}new Nc_3930: bitstring;
                                                    {3558}let wNc_3931: bitstring = enc(Nc_3930,pkSess_3927) in
                                                    {3559}let m1_3932: bitstring = (OpenSecureChannelRequest,pkCli_3381,wNc_3931) in
                                                    {3560}out(c, (pkCli_3381,enc(m1_3932,pkSess_3927),sign(h(m1_3932),skCli_3380)));
                                                    {3561}in(c, (em2_3933: bitstring,sigM2_3934: bitstring));
                                                    {3562}let m2_3935: bitstring = dec(em2_3933,skCli_3380) in
                                                    {3563}if (verify(h(m2_3935),sigM2_3934,pkSess_3927) <> true) then
                                                        0
                                                    else
                                                        {3564}let (=OpenSecureChannelResponse,wNs_3936: bitstring,ST_3937: bitstring,TTL_3938: bitstring) = m2_3935 in
                                                        {3565}let Ns_3939: bitstring = dec(wNs_3936,skCli_3380) in
                                                        {3566}let Kcli_3940: bitstring = h((Nc_3930,Ns_3939)) in
                                                        {3567}out(c, senc(mCli(pkCli_3381,pkSess_3927),Kcli_3940))
                                                )
                                                else
                                                    {3568}let pkSess_3941: bitstring = pub(sk(Sess)) in
                                                    {3569}out(c, GetEndpointRequest);
                                                    {3570}in(c, (=GetEndpointResponse,=pkSess_3941,=SignAndEncrypt,SP_3942: bitstring,UP_3943: bitstring));
                                                    {3571}new Nc_3944: bitstring;
                                                    {3572}let wNc_3945: bitstring = enc(Nc_3944,pkSess_3941) in
                                                    {3573}let m1_3946: bitstring = (OpenSecureChannelRequest,pkCli_3381,wNc_3945) in
                                                    {3574}out(c, (pkCli_3381,enc(m1_3946,pkSess_3941),sign(h(m1_3946),skCli_3380)));
                                                    {3575}in(c, (em2_3947: bitstring,sigM2_3948: bitstring));
                                                    {3576}let m2_3949: bitstring = dec(em2_3947,skCli_3380) in
                                                    {3577}if (verify(h(m2_3949),sigM2_3948,pkSess_3941) <> true) then
                                                        0
                                                    else
                                                        {3578}let (=OpenSecureChannelResponse,wNs_3950: bitstring,ST_3951: bitstring,TTL_3952: bitstring) = m2_3949 in
                                                        {3579}let Ns_3953: bitstring = dec(wNs_3950,skCli_3380) in
                                                        {3580}let Kcli_3954: bitstring = h((Nc_3944,Ns_3953)) in
                                                        {3581}out(c, senc(mCli(pkCli_3381,pkSess_3941),Kcli_3954))
                                            )
                                            else
                                                {3582}let pkSess_3955: bitstring = fail-any in
                                                {3583}out(c, GetEndpointRequest);
                                                {3584}in(c, (=GetEndpointResponse,=pkSess_3955,=SignAndEncrypt,SP_3956: bitstring,UP_3957: bitstring));
                                                {3585}new Nc_3958: bitstring;
                                                {3586}let wNc_3959: bitstring = enc(Nc_3958,pkSess_3955) in
                                                {3587}let m1_3960: bitstring = (OpenSecureChannelRequest,pkCli_3381,wNc_3959) in
                                                {3588}out(c, (pkCli_3381,enc(m1_3960,pkSess_3955),sign(h(m1_3960),skCli_3380)));
                                                {3589}in(c, (em2_3961: bitstring,sigM2_3962: bitstring));
                                                {3590}let m2_3963: bitstring = dec(em2_3961,skCli_3380) in
                                                {3591}if (verify(h(m2_3963),sigM2_3962,pkSess_3955) <> true) then
                                                    0
                                                else
                                                    {3592}let (=OpenSecureChannelResponse,wNs_3964: bitstring,ST_3965: bitstring,TTL_3966: bitstring) = m2_3963 in
                                                    {3593}let Ns_3967: bitstring = dec(wNs_3964,skCli_3380) in
                                                    {3594}let Kcli_3968: bitstring = h((Nc_3958,Ns_3967)) in
                                                    {3595}out(c, senc(mCli(pkCli_3381,pkSess_3955),Kcli_3968))
                                    )
                                    else
                                        {3596}let pkSess_3969: bitstring = fail-any in
                                        {3597}out(c, GetEndpointRequest);
                                        {3598}in(c, (=GetEndpointResponse,=pkSess_3969,=SignAndEncrypt,SP_3970: bitstring,UP_3971: bitstring));
                                        {3599}new Nc_3972: bitstring;
                                        {3600}let wNc_3973: bitstring = enc(Nc_3972,pkSess_3969) in
                                        {3601}let m1_3974: bitstring = (OpenSecureChannelRequest,pkCli_3381,wNc_3973) in
                                        {3602}out(c, (pkCli_3381,enc(m1_3974,pkSess_3969),sign(h(m1_3974),skCli_3380)));
                                        {3603}in(c, (em2_3975: bitstring,sigM2_3976: bitstring));
                                        {3604}let m2_3977: bitstring = dec(em2_3975,skCli_3380) in
                                        {3605}if (verify(h(m2_3977),sigM2_3976,pkSess_3969) <> true) then
                                            0
                                        else
                                            {3606}let (=OpenSecureChannelResponse,wNs_3978: bitstring,ST_3979: bitstring,TTL_3980: bitstring) = m2_3977 in
                                            {3607}let Ns_3981: bitstring = dec(wNs_3978,skCli_3380) in
                                            {3608}let Kcli_3982: bitstring = h((Nc_3972,Ns_3981)) in
                                            {3609}out(c, senc(mCli(pkCli_3381,pkSess_3969),Kcli_3982))
                            )
                            else
                                {3610}let pkSess_3983: bitstring = fail-any in
                                {3611}out(c, GetEndpointRequest);
                                {3612}in(c, (=GetEndpointResponse,=pkSess_3983,=SignAndEncrypt,SP_3984: bitstring,UP_3985: bitstring));
                                {3613}new Nc_3986: bitstring;
                                {3614}let wNc_3987: bitstring = enc(Nc_3986,pkSess_3983) in
                                {3615}let m1_3988: bitstring = (OpenSecureChannelRequest,pkCli_3381,wNc_3987) in
                                {3616}out(c, (pkCli_3381,enc(m1_3988,pkSess_3983),sign(h(m1_3988),skCli_3380)));
                                {3617}in(c, (em2_3989: bitstring,sigM2_3990: bitstring));
                                {3618}let m2_3991: bitstring = dec(em2_3989,skCli_3380) in
                                {3619}if (verify(h(m2_3991),sigM2_3990,pkSess_3983) <> true) then
                                    0
                                else
                                    {3620}let (=OpenSecureChannelResponse,wNs_3992: bitstring,ST_3993: bitstring,TTL_3994: bitstring) = m2_3991 in
                                    {3621}let Ns_3995: bitstring = dec(wNs_3992,skCli_3380) in
                                    {3622}let Kcli_3996: bitstring = h((Nc_3986,Ns_3995)) in
                                    {3623}out(c, senc(mCli(pkCli_3381,pkSess_3983),Kcli_3996))
                )
                else
                    {3624}let pkDisco_3997: bitstring = fail-any in
                    {3625}let v_3998: bool = (Sess = A) in
                    (
                        {3626}if v_3998 then
                        (
                            {3627}let pkSess_3999: bitstring = pub(skA) in
                            {3628}out(c, GetEndpointRequest);
                            {3629}in(c, (=GetEndpointResponse,=pkSess_3999,=SignAndEncrypt,SP_4000: bitstring,UP_4001: bitstring));
                            {3630}new Nc_4002: bitstring;
                            {3631}let wNc_4003: bitstring = enc(Nc_4002,pkSess_3999) in
                            {3632}let m1_4004: bitstring = (OpenSecureChannelRequest,pkCli_3381,wNc_4003) in
                            {3633}out(c, (pkCli_3381,enc(m1_4004,pkSess_3999),sign(h(m1_4004),skCli_3380)));
                            {3634}in(c, (em2_4005: bitstring,sigM2_4006: bitstring));
                            {3635}let m2_4007: bitstring = dec(em2_4005,skCli_3380) in
                            {3636}if (verify(h(m2_4007),sigM2_4006,pkSess_3999) <> true) then
                                0
                            else
                                {3637}let (=OpenSecureChannelResponse,wNs_4008: bitstring,ST_4009: bitstring,TTL_4010: bitstring) = m2_4007 in
                                {3638}let Ns_4011: bitstring = dec(wNs_4008,skCli_3380) in
                                {3639}let Kcli_4012: bitstring = h((Nc_4002,Ns_4011)) in
                                {3640}out(c, senc(mCli(pkCli_3381,pkSess_3999),Kcli_4012))
                        )
                        else
                            {3641}let v_4013: bool = (Sess = B) in
                            (
                                {3642}if v_4013 then
                                (
                                    {3643}let pkSess_4014: bitstring = pub(skB) in
                                    {3644}out(c, GetEndpointRequest);
                                    {3645}in(c, (=GetEndpointResponse,=pkSess_4014,=SignAndEncrypt,SP_4015: bitstring,UP_4016: bitstring));
                                    {3646}new Nc_4017: bitstring;
                                    {3647}let wNc_4018: bitstring = enc(Nc_4017,pkSess_4014) in
                                    {3648}let m1_4019: bitstring = (OpenSecureChannelRequest,pkCli_3381,wNc_4018) in
                                    {3649}out(c, (pkCli_3381,enc(m1_4019,pkSess_4014),sign(h(m1_4019),skCli_3380)));
                                    {3650}in(c, (em2_4020: bitstring,sigM2_4021: bitstring));
                                    {3651}let m2_4022: bitstring = dec(em2_4020,skCli_3380) in
                                    {3652}if (verify(h(m2_4022),sigM2_4021,pkSess_4014) <> true) then
                                        0
                                    else
                                        {3653}let (=OpenSecureChannelResponse,wNs_4023: bitstring,ST_4024: bitstring,TTL_4025: bitstring) = m2_4022 in
                                        {3654}let Ns_4026: bitstring = dec(wNs_4023,skCli_3380) in
                                        {3655}let Kcli_4027: bitstring = h((Nc_4017,Ns_4026)) in
                                        {3656}out(c, senc(mCli(pkCli_3381,pkSess_4014),Kcli_4027))
                                )
                                else
                                    {3657}let v_4028: bool = (Sess = C) in
                                    (
                                        {3658}if v_4028 then
                                        (
                                            {3659}let pkSess_4029: bitstring = pub(skC) in
                                            {3660}out(c, GetEndpointRequest);
                                            {3661}in(c, (=GetEndpointResponse,=pkSess_4029,=SignAndEncrypt,SP_4030: bitstring,UP_4031: bitstring));
                                            {3662}new Nc_4032: bitstring;
                                            {3663}let wNc_4033: bitstring = enc(Nc_4032,pkSess_4029) in
                                            {3664}let m1_4034: bitstring = (OpenSecureChannelRequest,pkCli_3381,wNc_4033) in
                                            {3665}out(c, (pkCli_3381,enc(m1_4034,pkSess_4029),sign(h(m1_4034),skCli_3380)));
                                            {3666}in(c, (em2_4035: bitstring,sigM2_4036: bitstring));
                                            {3667}let m2_4037: bitstring = dec(em2_4035,skCli_3380) in
                                            {3668}if (verify(h(m2_4037),sigM2_4036,pkSess_4029) <> true) then
                                                0
                                            else
                                                {3669}let (=OpenSecureChannelResponse,wNs_4038: bitstring,ST_4039: bitstring,TTL_4040: bitstring) = m2_4037 in
                                                {3670}let Ns_4041: bitstring = dec(wNs_4038,skCli_3380) in
                                                {3671}let Kcli_4042: bitstring = h((Nc_4032,Ns_4041)) in
                                                {3672}out(c, senc(mCli(pkCli_3381,pkSess_4029),Kcli_4042))
                                        )
                                        else
                                            {3673}let pkSess_4043: bitstring = pub(sk(Sess)) in
                                            {3674}out(c, GetEndpointRequest);
                                            {3675}in(c, (=GetEndpointResponse,=pkSess_4043,=SignAndEncrypt,SP_4044: bitstring,UP_4045: bitstring));
                                            {3676}new Nc_4046: bitstring;
                                            {3677}let wNc_4047: bitstring = enc(Nc_4046,pkSess_4043) in
                                            {3678}let m1_4048: bitstring = (OpenSecureChannelRequest,pkCli_3381,wNc_4047) in
                                            {3679}out(c, (pkCli_3381,enc(m1_4048,pkSess_4043),sign(h(m1_4048),skCli_3380)));
                                            {3680}in(c, (em2_4049: bitstring,sigM2_4050: bitstring));
                                            {3681}let m2_4051: bitstring = dec(em2_4049,skCli_3380) in
                                            {3682}if (verify(h(m2_4051),sigM2_4050,pkSess_4043) <> true) then
                                                0
                                            else
                                                {3683}let (=OpenSecureChannelResponse,wNs_4052: bitstring,ST_4053: bitstring,TTL_4054: bitstring) = m2_4051 in
                                                {3684}let Ns_4055: bitstring = dec(wNs_4052,skCli_3380) in
                                                {3685}let Kcli_4056: bitstring = h((Nc_4046,Ns_4055)) in
                                                {3686}out(c, senc(mCli(pkCli_3381,pkSess_4043),Kcli_4056))
                                    )
                                    else
                                        {3687}let pkSess_4057: bitstring = fail-any in
                                        {3688}out(c, GetEndpointRequest);
                                        {3689}in(c, (=GetEndpointResponse,=pkSess_4057,=SignAndEncrypt,SP_4058: bitstring,UP_4059: bitstring));
                                        {3690}new Nc_4060: bitstring;
                                        {3691}let wNc_4061: bitstring = enc(Nc_4060,pkSess_4057) in
                                        {3692}let m1_4062: bitstring = (OpenSecureChannelRequest,pkCli_3381,wNc_4061) in
                                        {3693}out(c, (pkCli_3381,enc(m1_4062,pkSess_4057),sign(h(m1_4062),skCli_3380)));
                                        {3694}in(c, (em2_4063: bitstring,sigM2_4064: bitstring));
                                        {3695}let m2_4065: bitstring = dec(em2_4063,skCli_3380) in
                                        {3696}if (verify(h(m2_4065),sigM2_4064,pkSess_4057) <> true) then
                                            0
                                        else
                                            {3697}let (=OpenSecureChannelResponse,wNs_4066: bitstring,ST_4067: bitstring,TTL_4068: bitstring) = m2_4065 in
                                            {3698}let Ns_4069: bitstring = dec(wNs_4066,skCli_3380) in
                                            {3699}let Kcli_4070: bitstring = h((Nc_4060,Ns_4069)) in
                                            {3700}out(c, senc(mCli(pkCli_3381,pkSess_4057),Kcli_4070))
                            )
                            else
                                {3701}let pkSess_4071: bitstring = fail-any in
                                {3702}out(c, GetEndpointRequest);
                                {3703}in(c, (=GetEndpointResponse,=pkSess_4071,=SignAndEncrypt,SP_4072: bitstring,UP_4073: bitstring));
                                {3704}new Nc_4074: bitstring;
                                {3705}let wNc_4075: bitstring = enc(Nc_4074,pkSess_4071) in
                                {3706}let m1_4076: bitstring = (OpenSecureChannelRequest,pkCli_3381,wNc_4075) in
                                {3707}out(c, (pkCli_3381,enc(m1_4076,pkSess_4071),sign(h(m1_4076),skCli_3380)));
                                {3708}in(c, (em2_4077: bitstring,sigM2_4078: bitstring));
                                {3709}let m2_4079: bitstring = dec(em2_4077,skCli_3380) in
                                {3710}if (verify(h(m2_4079),sigM2_4078,pkSess_4071) <> true) then
                                    0
                                else
                                    {3711}let (=OpenSecureChannelResponse,wNs_4080: bitstring,ST_4081: bitstring,TTL_4082: bitstring) = m2_4079 in
                                    {3712}let Ns_4083: bitstring = dec(wNs_4080,skCli_3380) in
                                    {3713}let Kcli_4084: bitstring = h((Nc_4074,Ns_4083)) in
                                    {3714}out(c, senc(mCli(pkCli_3381,pkSess_4071),Kcli_4084))
                    )
                    else
                        {3715}let pkSess_4085: bitstring = fail-any in
                        {3716}out(c, GetEndpointRequest);
                        {3717}in(c, (=GetEndpointResponse,=pkSess_4085,=SignAndEncrypt,SP_4086: bitstring,UP_4087: bitstring));
                        {3718}new Nc_4088: bitstring;
                        {3719}let wNc_4089: bitstring = enc(Nc_4088,pkSess_4085) in
                        {3720}let m1_4090: bitstring = (OpenSecureChannelRequest,pkCli_3381,wNc_4089) in
                        {3721}out(c, (pkCli_3381,enc(m1_4090,pkSess_4085),sign(h(m1_4090),skCli_3380)));
                        {3722}in(c, (em2_4091: bitstring,sigM2_4092: bitstring));
                        {3723}let m2_4093: bitstring = dec(em2_4091,skCli_3380) in
                        {3724}if (verify(h(m2_4093),sigM2_4092,pkSess_4085) <> true) then
                            0
                        else
                            {3725}let (=OpenSecureChannelResponse,wNs_4094: bitstring,ST_4095: bitstring,TTL_4096: bitstring) = m2_4093 in
                            {3726}let Ns_4097: bitstring = dec(wNs_4094,skCli_3380) in
                            {3727}let Kcli_4098: bitstring = h((Nc_4088,Ns_4097)) in
                            {3728}out(c, senc(mCli(pkCli_3381,pkSess_4085),Kcli_4098))
    )
    else
        {3729}let skCli_4099: bitstring = fail-any in
        {3730}let pkCli_4100: bitstring = pub(skCli_4099) in
        {3731}let v_4101: bool = (Disco = A) in
        (
            {3732}if v_4101 then
            (
                {3733}let pkDisco_4102: bitstring = pub(skA) in
                {3734}let v_4103: bool = (Sess = A) in
                (
                    {3735}if v_4103 then
                    (
                        {3736}let pkSess_4104: bitstring = pub(skA) in
                        {3737}out(c, GetEndpointRequest);
                        {3738}in(c, (=GetEndpointResponse,=pkSess_4104,=SignAndEncrypt,SP_4105: bitstring,UP_4106: bitstring));
                        {3739}new Nc_4107: bitstring;
                        {3740}let wNc_4108: bitstring = enc(Nc_4107,pkSess_4104) in
                        {3741}let m1_4109: bitstring = (OpenSecureChannelRequest,pkCli_4100,wNc_4108) in
                        {3742}out(c, (pkCli_4100,enc(m1_4109,pkSess_4104),sign(h(m1_4109),skCli_4099)));
                        {3743}in(c, (em2_4110: bitstring,sigM2_4111: bitstring));
                        {3744}let m2_4112: bitstring = dec(em2_4110,skCli_4099) in
                        {3745}if (verify(h(m2_4112),sigM2_4111,pkSess_4104) <> true) then
                            0
                        else
                            {3746}let (=OpenSecureChannelResponse,wNs_4113: bitstring,ST_4114: bitstring,TTL_4115: bitstring) = m2_4112 in
                            {3747}let Ns_4116: bitstring = dec(wNs_4113,skCli_4099) in
                            {3748}let Kcli_4117: bitstring = h((Nc_4107,Ns_4116)) in
                            {3749}out(c, senc(mCli(pkCli_4100,pkSess_4104),Kcli_4117))
                    )
                    else
                        {3750}let v_4118: bool = (Sess = B) in
                        (
                            {3751}if v_4118 then
                            (
                                {3752}let pkSess_4119: bitstring = pub(skB) in
                                {3753}out(c, GetEndpointRequest);
                                {3754}in(c, (=GetEndpointResponse,=pkSess_4119,=SignAndEncrypt,SP_4120: bitstring,UP_4121: bitstring));
                                {3755}new Nc_4122: bitstring;
                                {3756}let wNc_4123: bitstring = enc(Nc_4122,pkSess_4119) in
                                {3757}let m1_4124: bitstring = (OpenSecureChannelRequest,pkCli_4100,wNc_4123) in
                                {3758}out(c, (pkCli_4100,enc(m1_4124,pkSess_4119),sign(h(m1_4124),skCli_4099)));
                                {3759}in(c, (em2_4125: bitstring,sigM2_4126: bitstring));
                                {3760}let m2_4127: bitstring = dec(em2_4125,skCli_4099) in
                                {3761}if (verify(h(m2_4127),sigM2_4126,pkSess_4119) <> true) then
                                    0
                                else
                                    {3762}let (=OpenSecureChannelResponse,wNs_4128: bitstring,ST_4129: bitstring,TTL_4130: bitstring) = m2_4127 in
                                    {3763}let Ns_4131: bitstring = dec(wNs_4128,skCli_4099) in
                                    {3764}let Kcli_4132: bitstring = h((Nc_4122,Ns_4131)) in
                                    {3765}out(c, senc(mCli(pkCli_4100,pkSess_4119),Kcli_4132))
                            )
                            else
                                {3766}let v_4133: bool = (Sess = C) in
                                (
                                    {3767}if v_4133 then
                                    (
                                        {3768}let pkSess_4134: bitstring = pub(skC) in
                                        {3769}out(c, GetEndpointRequest);
                                        {3770}in(c, (=GetEndpointResponse,=pkSess_4134,=SignAndEncrypt,SP_4135: bitstring,UP_4136: bitstring));
                                        {3771}new Nc_4137: bitstring;
                                        {3772}let wNc_4138: bitstring = enc(Nc_4137,pkSess_4134) in
                                        {3773}let m1_4139: bitstring = (OpenSecureChannelRequest,pkCli_4100,wNc_4138) in
                                        {3774}out(c, (pkCli_4100,enc(m1_4139,pkSess_4134),sign(h(m1_4139),skCli_4099)));
                                        {3775}in(c, (em2_4140: bitstring,sigM2_4141: bitstring));
                                        {3776}let m2_4142: bitstring = dec(em2_4140,skCli_4099) in
                                        {3777}if (verify(h(m2_4142),sigM2_4141,pkSess_4134) <> true) then
                                            0
                                        else
                                            {3778}let (=OpenSecureChannelResponse,wNs_4143: bitstring,ST_4144: bitstring,TTL_4145: bitstring) = m2_4142 in
                                            {3779}let Ns_4146: bitstring = dec(wNs_4143,skCli_4099) in
                                            {3780}let Kcli_4147: bitstring = h((Nc_4137,Ns_4146)) in
                                            {3781}out(c, senc(mCli(pkCli_4100,pkSess_4134),Kcli_4147))
                                    )
                                    else
                                        {3782}let pkSess_4148: bitstring = pub(sk(Sess)) in
                                        {3783}out(c, GetEndpointRequest);
                                        {3784}in(c, (=GetEndpointResponse,=pkSess_4148,=SignAndEncrypt,SP_4149: bitstring,UP_4150: bitstring));
                                        {3785}new Nc_4151: bitstring;
                                        {3786}let wNc_4152: bitstring = enc(Nc_4151,pkSess_4148) in
                                        {3787}let m1_4153: bitstring = (OpenSecureChannelRequest,pkCli_4100,wNc_4152) in
                                        {3788}out(c, (pkCli_4100,enc(m1_4153,pkSess_4148),sign(h(m1_4153),skCli_4099)));
                                        {3789}in(c, (em2_4154: bitstring,sigM2_4155: bitstring));
                                        {3790}let m2_4156: bitstring = dec(em2_4154,skCli_4099) in
                                        {3791}if (verify(h(m2_4156),sigM2_4155,pkSess_4148) <> true) then
                                            0
                                        else
                                            {3792}let (=OpenSecureChannelResponse,wNs_4157: bitstring,ST_4158: bitstring,TTL_4159: bitstring) = m2_4156 in
                                            {3793}let Ns_4160: bitstring = dec(wNs_4157,skCli_4099) in
                                            {3794}let Kcli_4161: bitstring = h((Nc_4151,Ns_4160)) in
                                            {3795}out(c, senc(mCli(pkCli_4100,pkSess_4148),Kcli_4161))
                                )
                                else
                                    {3796}let pkSess_4162: bitstring = fail-any in
                                    {3797}out(c, GetEndpointRequest);
                                    {3798}in(c, (=GetEndpointResponse,=pkSess_4162,=SignAndEncrypt,SP_4163: bitstring,UP_4164: bitstring));
                                    {3799}new Nc_4165: bitstring;
                                    {3800}let wNc_4166: bitstring = enc(Nc_4165,pkSess_4162) in
                                    {3801}let m1_4167: bitstring = (OpenSecureChannelRequest,pkCli_4100,wNc_4166) in
                                    {3802}out(c, (pkCli_4100,enc(m1_4167,pkSess_4162),sign(h(m1_4167),skCli_4099)));
                                    {3803}in(c, (em2_4168: bitstring,sigM2_4169: bitstring));
                                    {3804}let m2_4170: bitstring = dec(em2_4168,skCli_4099) in
                                    {3805}if (verify(h(m2_4170),sigM2_4169,pkSess_4162) <> true) then
                                        0
                                    else
                                        {3806}let (=OpenSecureChannelResponse,wNs_4171: bitstring,ST_4172: bitstring,TTL_4173: bitstring) = m2_4170 in
                                        {3807}let Ns_4174: bitstring = dec(wNs_4171,skCli_4099) in
                                        {3808}let Kcli_4175: bitstring = h((Nc_4165,Ns_4174)) in
                                        {3809}out(c, senc(mCli(pkCli_4100,pkSess_4162),Kcli_4175))
                        )
                        else
                            {3810}let pkSess_4176: bitstring = fail-any in
                            {3811}out(c, GetEndpointRequest);
                            {3812}in(c, (=GetEndpointResponse,=pkSess_4176,=SignAndEncrypt,SP_4177: bitstring,UP_4178: bitstring));
                            {3813}new Nc_4179: bitstring;
                            {3814}let wNc_4180: bitstring = enc(Nc_4179,pkSess_4176) in
                            {3815}let m1_4181: bitstring = (OpenSecureChannelRequest,pkCli_4100,wNc_4180) in
                            {3816}out(c, (pkCli_4100,enc(m1_4181,pkSess_4176),sign(h(m1_4181),skCli_4099)));
                            {3817}in(c, (em2_4182: bitstring,sigM2_4183: bitstring));
                            {3818}let m2_4184: bitstring = dec(em2_4182,skCli_4099) in
                            {3819}if (verify(h(m2_4184),sigM2_4183,pkSess_4176) <> true) then
                                0
                            else
                                {3820}let (=OpenSecureChannelResponse,wNs_4185: bitstring,ST_4186: bitstring,TTL_4187: bitstring) = m2_4184 in
                                {3821}let Ns_4188: bitstring = dec(wNs_4185,skCli_4099) in
                                {3822}let Kcli_4189: bitstring = h((Nc_4179,Ns_4188)) in
                                {3823}out(c, senc(mCli(pkCli_4100,pkSess_4176),Kcli_4189))
                )
                else
                    {3824}let pkSess_4190: bitstring = fail-any in
                    {3825}out(c, GetEndpointRequest);
                    {3826}in(c, (=GetEndpointResponse,=pkSess_4190,=SignAndEncrypt,SP_4191: bitstring,UP_4192: bitstring));
                    {3827}new Nc_4193: bitstring;
                    {3828}let wNc_4194: bitstring = enc(Nc_4193,pkSess_4190) in
                    {3829}let m1_4195: bitstring = (OpenSecureChannelRequest,pkCli_4100,wNc_4194) in
                    {3830}out(c, (pkCli_4100,enc(m1_4195,pkSess_4190),sign(h(m1_4195),skCli_4099)));
                    {3831}in(c, (em2_4196: bitstring,sigM2_4197: bitstring));
                    {3832}let m2_4198: bitstring = dec(em2_4196,skCli_4099) in
                    {3833}if (verify(h(m2_4198),sigM2_4197,pkSess_4190) <> true) then
                        0
                    else
                        {3834}let (=OpenSecureChannelResponse,wNs_4199: bitstring,ST_4200: bitstring,TTL_4201: bitstring) = m2_4198 in
                        {3835}let Ns_4202: bitstring = dec(wNs_4199,skCli_4099) in
                        {3836}let Kcli_4203: bitstring = h((Nc_4193,Ns_4202)) in
                        {3837}out(c, senc(mCli(pkCli_4100,pkSess_4190),Kcli_4203))
            )
            else
                {3838}let v_4204: bool = (Disco = B) in
                (
                    {3839}if v_4204 then
                    (
                        {3840}let pkDisco_4205: bitstring = pub(skB) in
                        {3841}let v_4206: bool = (Sess = A) in
                        (
                            {3842}if v_4206 then
                            (
                                {3843}let pkSess_4207: bitstring = pub(skA) in
                                {3844}out(c, GetEndpointRequest);
                                {3845}in(c, (=GetEndpointResponse,=pkSess_4207,=SignAndEncrypt,SP_4208: bitstring,UP_4209: bitstring));
                                {3846}new Nc_4210: bitstring;
                                {3847}let wNc_4211: bitstring = enc(Nc_4210,pkSess_4207) in
                                {3848}let m1_4212: bitstring = (OpenSecureChannelRequest,pkCli_4100,wNc_4211) in
                                {3849}out(c, (pkCli_4100,enc(m1_4212,pkSess_4207),sign(h(m1_4212),skCli_4099)));
                                {3850}in(c, (em2_4213: bitstring,sigM2_4214: bitstring));
                                {3851}let m2_4215: bitstring = dec(em2_4213,skCli_4099) in
                                {3852}if (verify(h(m2_4215),sigM2_4214,pkSess_4207) <> true) then
                                    0
                                else
                                    {3853}let (=OpenSecureChannelResponse,wNs_4216: bitstring,ST_4217: bitstring,TTL_4218: bitstring) = m2_4215 in
                                    {3854}let Ns_4219: bitstring = dec(wNs_4216,skCli_4099) in
                                    {3855}let Kcli_4220: bitstring = h((Nc_4210,Ns_4219)) in
                                    {3856}out(c, senc(mCli(pkCli_4100,pkSess_4207),Kcli_4220))
                            )
                            else
                                {3857}let v_4221: bool = (Sess = B) in
                                (
                                    {3858}if v_4221 then
                                    (
                                        {3859}let pkSess_4222: bitstring = pub(skB) in
                                        {3860}out(c, GetEndpointRequest);
                                        {3861}in(c, (=GetEndpointResponse,=pkSess_4222,=SignAndEncrypt,SP_4223: bitstring,UP_4224: bitstring));
                                        {3862}new Nc_4225: bitstring;
                                        {3863}let wNc_4226: bitstring = enc(Nc_4225,pkSess_4222) in
                                        {3864}let m1_4227: bitstring = (OpenSecureChannelRequest,pkCli_4100,wNc_4226) in
                                        {3865}out(c, (pkCli_4100,enc(m1_4227,pkSess_4222),sign(h(m1_4227),skCli_4099)));
                                        {3866}in(c, (em2_4228: bitstring,sigM2_4229: bitstring));
                                        {3867}let m2_4230: bitstring = dec(em2_4228,skCli_4099) in
                                        {3868}if (verify(h(m2_4230),sigM2_4229,pkSess_4222) <> true) then
                                            0
                                        else
                                            {3869}let (=OpenSecureChannelResponse,wNs_4231: bitstring,ST_4232: bitstring,TTL_4233: bitstring) = m2_4230 in
                                            {3870}let Ns_4234: bitstring = dec(wNs_4231,skCli_4099) in
                                            {3871}let Kcli_4235: bitstring = h((Nc_4225,Ns_4234)) in
                                            {3872}out(c, senc(mCli(pkCli_4100,pkSess_4222),Kcli_4235))
                                    )
                                    else
                                        {3873}let v_4236: bool = (Sess = C) in
                                        (
                                            {3874}if v_4236 then
                                            (
                                                {3875}let pkSess_4237: bitstring = pub(skC) in
                                                {3876}out(c, GetEndpointRequest);
                                                {3877}in(c, (=GetEndpointResponse,=pkSess_4237,=SignAndEncrypt,SP_4238: bitstring,UP_4239: bitstring));
                                                {3878}new Nc_4240: bitstring;
                                                {3879}let wNc_4241: bitstring = enc(Nc_4240,pkSess_4237) in
                                                {3880}let m1_4242: bitstring = (OpenSecureChannelRequest,pkCli_4100,wNc_4241) in
                                                {3881}out(c, (pkCli_4100,enc(m1_4242,pkSess_4237),sign(h(m1_4242),skCli_4099)));
                                                {3882}in(c, (em2_4243: bitstring,sigM2_4244: bitstring));
                                                {3883}let m2_4245: bitstring = dec(em2_4243,skCli_4099) in
                                                {3884}if (verify(h(m2_4245),sigM2_4244,pkSess_4237) <> true) then
                                                    0
                                                else
                                                    {3885}let (=OpenSecureChannelResponse,wNs_4246: bitstring,ST_4247: bitstring,TTL_4248: bitstring) = m2_4245 in
                                                    {3886}let Ns_4249: bitstring = dec(wNs_4246,skCli_4099) in
                                                    {3887}let Kcli_4250: bitstring = h((Nc_4240,Ns_4249)) in
                                                    {3888}out(c, senc(mCli(pkCli_4100,pkSess_4237),Kcli_4250))
                                            )
                                            else
                                                {3889}let pkSess_4251: bitstring = pub(sk(Sess)) in
                                                {3890}out(c, GetEndpointRequest);
                                                {3891}in(c, (=GetEndpointResponse,=pkSess_4251,=SignAndEncrypt,SP_4252: bitstring,UP_4253: bitstring));
                                                {3892}new Nc_4254: bitstring;
                                                {3893}let wNc_4255: bitstring = enc(Nc_4254,pkSess_4251) in
                                                {3894}let m1_4256: bitstring = (OpenSecureChannelRequest,pkCli_4100,wNc_4255) in
                                                {3895}out(c, (pkCli_4100,enc(m1_4256,pkSess_4251),sign(h(m1_4256),skCli_4099)));
                                                {3896}in(c, (em2_4257: bitstring,sigM2_4258: bitstring));
                                                {3897}let m2_4259: bitstring = dec(em2_4257,skCli_4099) in
                                                {3898}if (verify(h(m2_4259),sigM2_4258,pkSess_4251) <> true) then
                                                    0
                                                else
                                                    {3899}let (=OpenSecureChannelResponse,wNs_4260: bitstring,ST_4261: bitstring,TTL_4262: bitstring) = m2_4259 in
                                                    {3900}let Ns_4263: bitstring = dec(wNs_4260,skCli_4099) in
                                                    {3901}let Kcli_4264: bitstring = h((Nc_4254,Ns_4263)) in
                                                    {3902}out(c, senc(mCli(pkCli_4100,pkSess_4251),Kcli_4264))
                                        )
                                        else
                                            {3903}let pkSess_4265: bitstring = fail-any in
                                            {3904}out(c, GetEndpointRequest);
                                            {3905}in(c, (=GetEndpointResponse,=pkSess_4265,=SignAndEncrypt,SP_4266: bitstring,UP_4267: bitstring));
                                            {3906}new Nc_4268: bitstring;
                                            {3907}let wNc_4269: bitstring = enc(Nc_4268,pkSess_4265) in
                                            {3908}let m1_4270: bitstring = (OpenSecureChannelRequest,pkCli_4100,wNc_4269) in
                                            {3909}out(c, (pkCli_4100,enc(m1_4270,pkSess_4265),sign(h(m1_4270),skCli_4099)));
                                            {3910}in(c, (em2_4271: bitstring,sigM2_4272: bitstring));
                                            {3911}let m2_4273: bitstring = dec(em2_4271,skCli_4099) in
                                            {3912}if (verify(h(m2_4273),sigM2_4272,pkSess_4265) <> true) then
                                                0
                                            else
                                                {3913}let (=OpenSecureChannelResponse,wNs_4274: bitstring,ST_4275: bitstring,TTL_4276: bitstring) = m2_4273 in
                                                {3914}let Ns_4277: bitstring = dec(wNs_4274,skCli_4099) in
                                                {3915}let Kcli_4278: bitstring = h((Nc_4268,Ns_4277)) in
                                                {3916}out(c, senc(mCli(pkCli_4100,pkSess_4265),Kcli_4278))
                                )
                                else
                                    {3917}let pkSess_4279: bitstring = fail-any in
                                    {3918}out(c, GetEndpointRequest);
                                    {3919}in(c, (=GetEndpointResponse,=pkSess_4279,=SignAndEncrypt,SP_4280: bitstring,UP_4281: bitstring));
                                    {3920}new Nc_4282: bitstring;
                                    {3921}let wNc_4283: bitstring = enc(Nc_4282,pkSess_4279) in
                                    {3922}let m1_4284: bitstring = (OpenSecureChannelRequest,pkCli_4100,wNc_4283) in
                                    {3923}out(c, (pkCli_4100,enc(m1_4284,pkSess_4279),sign(h(m1_4284),skCli_4099)));
                                    {3924}in(c, (em2_4285: bitstring,sigM2_4286: bitstring));
                                    {3925}let m2_4287: bitstring = dec(em2_4285,skCli_4099) in
                                    {3926}if (verify(h(m2_4287),sigM2_4286,pkSess_4279) <> true) then
                                        0
                                    else
                                        {3927}let (=OpenSecureChannelResponse,wNs_4288: bitstring,ST_4289: bitstring,TTL_4290: bitstring) = m2_4287 in
                                        {3928}let Ns_4291: bitstring = dec(wNs_4288,skCli_4099) in
                                        {3929}let Kcli_4292: bitstring = h((Nc_4282,Ns_4291)) in
                                        {3930}out(c, senc(mCli(pkCli_4100,pkSess_4279),Kcli_4292))
                        )
                        else
                            {3931}let pkSess_4293: bitstring = fail-any in
                            {3932}out(c, GetEndpointRequest);
                            {3933}in(c, (=GetEndpointResponse,=pkSess_4293,=SignAndEncrypt,SP_4294: bitstring,UP_4295: bitstring));
                            {3934}new Nc_4296: bitstring;
                            {3935}let wNc_4297: bitstring = enc(Nc_4296,pkSess_4293) in
                            {3936}let m1_4298: bitstring = (OpenSecureChannelRequest,pkCli_4100,wNc_4297) in
                            {3937}out(c, (pkCli_4100,enc(m1_4298,pkSess_4293),sign(h(m1_4298),skCli_4099)));
                            {3938}in(c, (em2_4299: bitstring,sigM2_4300: bitstring));
                            {3939}let m2_4301: bitstring = dec(em2_4299,skCli_4099) in
                            {3940}if (verify(h(m2_4301),sigM2_4300,pkSess_4293) <> true) then
                                0
                            else
                                {3941}let (=OpenSecureChannelResponse,wNs_4302: bitstring,ST_4303: bitstring,TTL_4304: bitstring) = m2_4301 in
                                {3942}let Ns_4305: bitstring = dec(wNs_4302,skCli_4099) in
                                {3943}let Kcli_4306: bitstring = h((Nc_4296,Ns_4305)) in
                                {3944}out(c, senc(mCli(pkCli_4100,pkSess_4293),Kcli_4306))
                    )
                    else
                        {3945}let v_4307: bool = (Disco = C) in
                        (
                            {3946}if v_4307 then
                            (
                                {3947}let pkDisco_4308: bitstring = pub(skC) in
                                {3948}let v_4309: bool = (Sess = A) in
                                (
                                    {3949}if v_4309 then
                                    (
                                        {3950}let pkSess_4310: bitstring = pub(skA) in
                                        {3951}out(c, GetEndpointRequest);
                                        {3952}in(c, (=GetEndpointResponse,=pkSess_4310,=SignAndEncrypt,SP_4311: bitstring,UP_4312: bitstring));
                                        {3953}new Nc_4313: bitstring;
                                        {3954}let wNc_4314: bitstring = enc(Nc_4313,pkSess_4310) in
                                        {3955}let m1_4315: bitstring = (OpenSecureChannelRequest,pkCli_4100,wNc_4314) in
                                        {3956}out(c, (pkCli_4100,enc(m1_4315,pkSess_4310),sign(h(m1_4315),skCli_4099)));
                                        {3957}in(c, (em2_4316: bitstring,sigM2_4317: bitstring));
                                        {3958}let m2_4318: bitstring = dec(em2_4316,skCli_4099) in
                                        {3959}if (verify(h(m2_4318),sigM2_4317,pkSess_4310) <> true) then
                                            0
                                        else
                                            {3960}let (=OpenSecureChannelResponse,wNs_4319: bitstring,ST_4320: bitstring,TTL_4321: bitstring) = m2_4318 in
                                            {3961}let Ns_4322: bitstring = dec(wNs_4319,skCli_4099) in
                                            {3962}let Kcli_4323: bitstring = h((Nc_4313,Ns_4322)) in
                                            {3963}out(c, senc(mCli(pkCli_4100,pkSess_4310),Kcli_4323))
                                    )
                                    else
                                        {3964}let v_4324: bool = (Sess = B) in
                                        (
                                            {3965}if v_4324 then
                                            (
                                                {3966}let pkSess_4325: bitstring = pub(skB) in
                                                {3967}out(c, GetEndpointRequest);
                                                {3968}in(c, (=GetEndpointResponse,=pkSess_4325,=SignAndEncrypt,SP_4326: bitstring,UP_4327: bitstring));
                                                {3969}new Nc_4328: bitstring;
                                                {3970}let wNc_4329: bitstring = enc(Nc_4328,pkSess_4325) in
                                                {3971}let m1_4330: bitstring = (OpenSecureChannelRequest,pkCli_4100,wNc_4329) in
                                                {3972}out(c, (pkCli_4100,enc(m1_4330,pkSess_4325),sign(h(m1_4330),skCli_4099)));
                                                {3973}in(c, (em2_4331: bitstring,sigM2_4332: bitstring));
                                                {3974}let m2_4333: bitstring = dec(em2_4331,skCli_4099) in
                                                {3975}if (verify(h(m2_4333),sigM2_4332,pkSess_4325) <> true) then
                                                    0
                                                else
                                                    {3976}let (=OpenSecureChannelResponse,wNs_4334: bitstring,ST_4335: bitstring,TTL_4336: bitstring) = m2_4333 in
                                                    {3977}let Ns_4337: bitstring = dec(wNs_4334,skCli_4099) in
                                                    {3978}let Kcli_4338: bitstring = h((Nc_4328,Ns_4337)) in
                                                    {3979}out(c, senc(mCli(pkCli_4100,pkSess_4325),Kcli_4338))
                                            )
                                            else
                                                {3980}let v_4339: bool = (Sess = C) in
                                                (
                                                    {3981}if v_4339 then
                                                    (
                                                        {3982}let pkSess_4340: bitstring = pub(skC) in
                                                        {3983}out(c, GetEndpointRequest);
                                                        {3984}in(c, (=GetEndpointResponse,=pkSess_4340,=SignAndEncrypt,SP_4341: bitstring,UP_4342: bitstring));
                                                        {3985}new Nc_4343: bitstring;
                                                        {3986}let wNc_4344: bitstring = enc(Nc_4343,pkSess_4340) in
                                                        {3987}let m1_4345: bitstring = (OpenSecureChannelRequest,pkCli_4100,wNc_4344) in
                                                        {3988}out(c, (pkCli_4100,enc(m1_4345,pkSess_4340),sign(h(m1_4345),skCli_4099)));
                                                        {3989}in(c, (em2_4346: bitstring,sigM2_4347: bitstring));
                                                        {3990}let m2_4348: bitstring = dec(em2_4346,skCli_4099) in
                                                        {3991}if (verify(h(m2_4348),sigM2_4347,pkSess_4340) <> true) then
                                                            0
                                                        else
                                                            {3992}let (=OpenSecureChannelResponse,wNs_4349: bitstring,ST_4350: bitstring,TTL_4351: bitstring) = m2_4348 in
                                                            {3993}let Ns_4352: bitstring = dec(wNs_4349,skCli_4099) in
                                                            {3994}let Kcli_4353: bitstring = h((Nc_4343,Ns_4352)) in
                                                            {3995}out(c, senc(mCli(pkCli_4100,pkSess_4340),Kcli_4353))
                                                    )
                                                    else
                                                        {3996}let pkSess_4354: bitstring = pub(sk(Sess)) in
                                                        {3997}out(c, GetEndpointRequest);
                                                        {3998}in(c, (=GetEndpointResponse,=pkSess_4354,=SignAndEncrypt,SP_4355: bitstring,UP_4356: bitstring));
                                                        {3999}new Nc_4357: bitstring;
                                                        {4000}let wNc_4358: bitstring = enc(Nc_4357,pkSess_4354) in
                                                        {4001}let m1_4359: bitstring = (OpenSecureChannelRequest,pkCli_4100,wNc_4358) in
                                                        {4002}out(c, (pkCli_4100,enc(m1_4359,pkSess_4354),sign(h(m1_4359),skCli_4099)));
                                                        {4003}in(c, (em2_4360: bitstring,sigM2_4361: bitstring));
                                                        {4004}let m2_4362: bitstring = dec(em2_4360,skCli_4099) in
                                                        {4005}if (verify(h(m2_4362),sigM2_4361,pkSess_4354) <> true) then
                                                            0
                                                        else
                                                            {4006}let (=OpenSecureChannelResponse,wNs_4363: bitstring,ST_4364: bitstring,TTL_4365: bitstring) = m2_4362 in
                                                            {4007}let Ns_4366: bitstring = dec(wNs_4363,skCli_4099) in
                                                            {4008}let Kcli_4367: bitstring = h((Nc_4357,Ns_4366)) in
                                                            {4009}out(c, senc(mCli(pkCli_4100,pkSess_4354),Kcli_4367))
                                                )
                                                else
                                                    {4010}let pkSess_4368: bitstring = fail-any in
                                                    {4011}out(c, GetEndpointRequest);
                                                    {4012}in(c, (=GetEndpointResponse,=pkSess_4368,=SignAndEncrypt,SP_4369: bitstring,UP_4370: bitstring));
                                                    {4013}new Nc_4371: bitstring;
                                                    {4014}let wNc_4372: bitstring = enc(Nc_4371,pkSess_4368) in
                                                    {4015}let m1_4373: bitstring = (OpenSecureChannelRequest,pkCli_4100,wNc_4372) in
                                                    {4016}out(c, (pkCli_4100,enc(m1_4373,pkSess_4368),sign(h(m1_4373),skCli_4099)));
                                                    {4017}in(c, (em2_4374: bitstring,sigM2_4375: bitstring));
                                                    {4018}let m2_4376: bitstring = dec(em2_4374,skCli_4099) in
                                                    {4019}if (verify(h(m2_4376),sigM2_4375,pkSess_4368) <> true) then
                                                        0
                                                    else
                                                        {4020}let (=OpenSecureChannelResponse,wNs_4377: bitstring,ST_4378: bitstring,TTL_4379: bitstring) = m2_4376 in
                                                        {4021}let Ns_4380: bitstring = dec(wNs_4377,skCli_4099) in
                                                        {4022}let Kcli_4381: bitstring = h((Nc_4371,Ns_4380)) in
                                                        {4023}out(c, senc(mCli(pkCli_4100,pkSess_4368),Kcli_4381))
                                        )
                                        else
                                            {4024}let pkSess_4382: bitstring = fail-any in
                                            {4025}out(c, GetEndpointRequest);
                                            {4026}in(c, (=GetEndpointResponse,=pkSess_4382,=SignAndEncrypt,SP_4383: bitstring,UP_4384: bitstring));
                                            {4027}new Nc_4385: bitstring;
                                            {4028}let wNc_4386: bitstring = enc(Nc_4385,pkSess_4382) in
                                            {4029}let m1_4387: bitstring = (OpenSecureChannelRequest,pkCli_4100,wNc_4386) in
                                            {4030}out(c, (pkCli_4100,enc(m1_4387,pkSess_4382),sign(h(m1_4387),skCli_4099)));
                                            {4031}in(c, (em2_4388: bitstring,sigM2_4389: bitstring));
                                            {4032}let m2_4390: bitstring = dec(em2_4388,skCli_4099) in
                                            {4033}if (verify(h(m2_4390),sigM2_4389,pkSess_4382) <> true) then
                                                0
                                            else
                                                {4034}let (=OpenSecureChannelResponse,wNs_4391: bitstring,ST_4392: bitstring,TTL_4393: bitstring) = m2_4390 in
                                                {4035}let Ns_4394: bitstring = dec(wNs_4391,skCli_4099) in
                                                {4036}let Kcli_4395: bitstring = h((Nc_4385,Ns_4394)) in
                                                {4037}out(c, senc(mCli(pkCli_4100,pkSess_4382),Kcli_4395))
                                )
                                else
                                    {4038}let pkSess_4396: bitstring = fail-any in
                                    {4039}out(c, GetEndpointRequest);
                                    {4040}in(c, (=GetEndpointResponse,=pkSess_4396,=SignAndEncrypt,SP_4397: bitstring,UP_4398: bitstring));
                                    {4041}new Nc_4399: bitstring;
                                    {4042}let wNc_4400: bitstring = enc(Nc_4399,pkSess_4396) in
                                    {4043}let m1_4401: bitstring = (OpenSecureChannelRequest,pkCli_4100,wNc_4400) in
                                    {4044}out(c, (pkCli_4100,enc(m1_4401,pkSess_4396),sign(h(m1_4401),skCli_4099)));
                                    {4045}in(c, (em2_4402: bitstring,sigM2_4403: bitstring));
                                    {4046}let m2_4404: bitstring = dec(em2_4402,skCli_4099) in
                                    {4047}if (verify(h(m2_4404),sigM2_4403,pkSess_4396) <> true) then
                                        0
                                    else
                                        {4048}let (=OpenSecureChannelResponse,wNs_4405: bitstring,ST_4406: bitstring,TTL_4407: bitstring) = m2_4404 in
                                        {4049}let Ns_4408: bitstring = dec(wNs_4405,skCli_4099) in
                                        {4050}let Kcli_4409: bitstring = h((Nc_4399,Ns_4408)) in
                                        {4051}out(c, senc(mCli(pkCli_4100,pkSess_4396),Kcli_4409))
                            )
                            else
                                {4052}let pkDisco_4410: bitstring = pub(sk(Disco)) in
                                {4053}let v_4411: bool = (Sess = A) in
                                (
                                    {4054}if v_4411 then
                                    (
                                        {4055}let pkSess_4412: bitstring = pub(skA) in
                                        {4056}out(c, GetEndpointRequest);
                                        {4057}in(c, (=GetEndpointResponse,=pkSess_4412,=SignAndEncrypt,SP_4413: bitstring,UP_4414: bitstring));
                                        {4058}new Nc_4415: bitstring;
                                        {4059}let wNc_4416: bitstring = enc(Nc_4415,pkSess_4412) in
                                        {4060}let m1_4417: bitstring = (OpenSecureChannelRequest,pkCli_4100,wNc_4416) in
                                        {4061}out(c, (pkCli_4100,enc(m1_4417,pkSess_4412),sign(h(m1_4417),skCli_4099)));
                                        {4062}in(c, (em2_4418: bitstring,sigM2_4419: bitstring));
                                        {4063}let m2_4420: bitstring = dec(em2_4418,skCli_4099) in
                                        {4064}if (verify(h(m2_4420),sigM2_4419,pkSess_4412) <> true) then
                                            0
                                        else
                                            {4065}let (=OpenSecureChannelResponse,wNs_4421: bitstring,ST_4422: bitstring,TTL_4423: bitstring) = m2_4420 in
                                            {4066}let Ns_4424: bitstring = dec(wNs_4421,skCli_4099) in
                                            {4067}let Kcli_4425: bitstring = h((Nc_4415,Ns_4424)) in
                                            {4068}out(c, senc(mCli(pkCli_4100,pkSess_4412),Kcli_4425))
                                    )
                                    else
                                        {4069}let v_4426: bool = (Sess = B) in
                                        (
                                            {4070}if v_4426 then
                                            (
                                                {4071}let pkSess_4427: bitstring = pub(skB) in
                                                {4072}out(c, GetEndpointRequest);
                                                {4073}in(c, (=GetEndpointResponse,=pkSess_4427,=SignAndEncrypt,SP_4428: bitstring,UP_4429: bitstring));
                                                {4074}new Nc_4430: bitstring;
                                                {4075}let wNc_4431: bitstring = enc(Nc_4430,pkSess_4427) in
                                                {4076}let m1_4432: bitstring = (OpenSecureChannelRequest,pkCli_4100,wNc_4431) in
                                                {4077}out(c, (pkCli_4100,enc(m1_4432,pkSess_4427),sign(h(m1_4432),skCli_4099)));
                                                {4078}in(c, (em2_4433: bitstring,sigM2_4434: bitstring));
                                                {4079}let m2_4435: bitstring = dec(em2_4433,skCli_4099) in
                                                {4080}if (verify(h(m2_4435),sigM2_4434,pkSess_4427) <> true) then
                                                    0
                                                else
                                                    {4081}let (=OpenSecureChannelResponse,wNs_4436: bitstring,ST_4437: bitstring,TTL_4438: bitstring) = m2_4435 in
                                                    {4082}let Ns_4439: bitstring = dec(wNs_4436,skCli_4099) in
                                                    {4083}let Kcli_4440: bitstring = h((Nc_4430,Ns_4439)) in
                                                    {4084}out(c, senc(mCli(pkCli_4100,pkSess_4427),Kcli_4440))
                                            )
                                            else
                                                {4085}let v_4441: bool = (Sess = C) in
                                                (
                                                    {4086}if v_4441 then
                                                    (
                                                        {4087}let pkSess_4442: bitstring = pub(skC) in
                                                        {4088}out(c, GetEndpointRequest);
                                                        {4089}in(c, (=GetEndpointResponse,=pkSess_4442,=SignAndEncrypt,SP_4443: bitstring,UP_4444: bitstring));
                                                        {4090}new Nc_4445: bitstring;
                                                        {4091}let wNc_4446: bitstring = enc(Nc_4445,pkSess_4442) in
                                                        {4092}let m1_4447: bitstring = (OpenSecureChannelRequest,pkCli_4100,wNc_4446) in
                                                        {4093}out(c, (pkCli_4100,enc(m1_4447,pkSess_4442),sign(h(m1_4447),skCli_4099)));
                                                        {4094}in(c, (em2_4448: bitstring,sigM2_4449: bitstring));
                                                        {4095}let m2_4450: bitstring = dec(em2_4448,skCli_4099) in
                                                        {4096}if (verify(h(m2_4450),sigM2_4449,pkSess_4442) <> true) then
                                                            0
                                                        else
                                                            {4097}let (=OpenSecureChannelResponse,wNs_4451: bitstring,ST_4452: bitstring,TTL_4453: bitstring) = m2_4450 in
                                                            {4098}let Ns_4454: bitstring = dec(wNs_4451,skCli_4099) in
                                                            {4099}let Kcli_4455: bitstring = h((Nc_4445,Ns_4454)) in
                                                            {4100}out(c, senc(mCli(pkCli_4100,pkSess_4442),Kcli_4455))
                                                    )
                                                    else
                                                        {4101}let pkSess_4456: bitstring = pub(sk(Sess)) in
                                                        {4102}out(c, GetEndpointRequest);
                                                        {4103}in(c, (=GetEndpointResponse,=pkSess_4456,=SignAndEncrypt,SP_4457: bitstring,UP_4458: bitstring));
                                                        {4104}new Nc_4459: bitstring;
                                                        {4105}let wNc_4460: bitstring = enc(Nc_4459,pkSess_4456) in
                                                        {4106}let m1_4461: bitstring = (OpenSecureChannelRequest,pkCli_4100,wNc_4460) in
                                                        {4107}out(c, (pkCli_4100,enc(m1_4461,pkSess_4456),sign(h(m1_4461),skCli_4099)));
                                                        {4108}in(c, (em2_4462: bitstring,sigM2_4463: bitstring));
                                                        {4109}let m2_4464: bitstring = dec(em2_4462,skCli_4099) in
                                                        {4110}if (verify(h(m2_4464),sigM2_4463,pkSess_4456) <> true) then
                                                            0
                                                        else
                                                            {4111}let (=OpenSecureChannelResponse,wNs_4465: bitstring,ST_4466: bitstring,TTL_4467: bitstring) = m2_4464 in
                                                            {4112}let Ns_4468: bitstring = dec(wNs_4465,skCli_4099) in
                                                            {4113}let Kcli_4469: bitstring = h((Nc_4459,Ns_4468)) in
                                                            {4114}out(c, senc(mCli(pkCli_4100,pkSess_4456),Kcli_4469))
                                                )
                                                else
                                                    {4115}let pkSess_4470: bitstring = fail-any in
                                                    {4116}out(c, GetEndpointRequest);
                                                    {4117}in(c, (=GetEndpointResponse,=pkSess_4470,=SignAndEncrypt,SP_4471: bitstring,UP_4472: bitstring));
                                                    {4118}new Nc_4473: bitstring;
                                                    {4119}let wNc_4474: bitstring = enc(Nc_4473,pkSess_4470) in
                                                    {4120}let m1_4475: bitstring = (OpenSecureChannelRequest,pkCli_4100,wNc_4474) in
                                                    {4121}out(c, (pkCli_4100,enc(m1_4475,pkSess_4470),sign(h(m1_4475),skCli_4099)));
                                                    {4122}in(c, (em2_4476: bitstring,sigM2_4477: bitstring));
                                                    {4123}let m2_4478: bitstring = dec(em2_4476,skCli_4099) in
                                                    {4124}if (verify(h(m2_4478),sigM2_4477,pkSess_4470) <> true) then
                                                        0
                                                    else
                                                        {4125}let (=OpenSecureChannelResponse,wNs_4479: bitstring,ST_4480: bitstring,TTL_4481: bitstring) = m2_4478 in
                                                        {4126}let Ns_4482: bitstring = dec(wNs_4479,skCli_4099) in
                                                        {4127}let Kcli_4483: bitstring = h((Nc_4473,Ns_4482)) in
                                                        {4128}out(c, senc(mCli(pkCli_4100,pkSess_4470),Kcli_4483))
                                        )
                                        else
                                            {4129}let pkSess_4484: bitstring = fail-any in
                                            {4130}out(c, GetEndpointRequest);
                                            {4131}in(c, (=GetEndpointResponse,=pkSess_4484,=SignAndEncrypt,SP_4485: bitstring,UP_4486: bitstring));
                                            {4132}new Nc_4487: bitstring;
                                            {4133}let wNc_4488: bitstring = enc(Nc_4487,pkSess_4484) in
                                            {4134}let m1_4489: bitstring = (OpenSecureChannelRequest,pkCli_4100,wNc_4488) in
                                            {4135}out(c, (pkCli_4100,enc(m1_4489,pkSess_4484),sign(h(m1_4489),skCli_4099)));
                                            {4136}in(c, (em2_4490: bitstring,sigM2_4491: bitstring));
                                            {4137}let m2_4492: bitstring = dec(em2_4490,skCli_4099) in
                                            {4138}if (verify(h(m2_4492),sigM2_4491,pkSess_4484) <> true) then
                                                0
                                            else
                                                {4139}let (=OpenSecureChannelResponse,wNs_4493: bitstring,ST_4494: bitstring,TTL_4495: bitstring) = m2_4492 in
                                                {4140}let Ns_4496: bitstring = dec(wNs_4493,skCli_4099) in
                                                {4141}let Kcli_4497: bitstring = h((Nc_4487,Ns_4496)) in
                                                {4142}out(c, senc(mCli(pkCli_4100,pkSess_4484),Kcli_4497))
                                )
                                else
                                    {4143}let pkSess_4498: bitstring = fail-any in
                                    {4144}out(c, GetEndpointRequest);
                                    {4145}in(c, (=GetEndpointResponse,=pkSess_4498,=SignAndEncrypt,SP_4499: bitstring,UP_4500: bitstring));
                                    {4146}new Nc_4501: bitstring;
                                    {4147}let wNc_4502: bitstring = enc(Nc_4501,pkSess_4498) in
                                    {4148}let m1_4503: bitstring = (OpenSecureChannelRequest,pkCli_4100,wNc_4502) in
                                    {4149}out(c, (pkCli_4100,enc(m1_4503,pkSess_4498),sign(h(m1_4503),skCli_4099)));
                                    {4150}in(c, (em2_4504: bitstring,sigM2_4505: bitstring));
                                    {4151}let m2_4506: bitstring = dec(em2_4504,skCli_4099) in
                                    {4152}if (verify(h(m2_4506),sigM2_4505,pkSess_4498) <> true) then
                                        0
                                    else
                                        {4153}let (=OpenSecureChannelResponse,wNs_4507: bitstring,ST_4508: bitstring,TTL_4509: bitstring) = m2_4506 in
                                        {4154}let Ns_4510: bitstring = dec(wNs_4507,skCli_4099) in
                                        {4155}let Kcli_4511: bitstring = h((Nc_4501,Ns_4510)) in
                                        {4156}out(c, senc(mCli(pkCli_4100,pkSess_4498),Kcli_4511))
                        )
                        else
                            {4157}let pkDisco_4512: bitstring = fail-any in
                            {4158}let v_4513: bool = (Sess = A) in
                            (
                                {4159}if v_4513 then
                                (
                                    {4160}let pkSess_4514: bitstring = pub(skA) in
                                    {4161}out(c, GetEndpointRequest);
                                    {4162}in(c, (=GetEndpointResponse,=pkSess_4514,=SignAndEncrypt,SP_4515: bitstring,UP_4516: bitstring));
                                    {4163}new Nc_4517: bitstring;
                                    {4164}let wNc_4518: bitstring = enc(Nc_4517,pkSess_4514) in
                                    {4165}let m1_4519: bitstring = (OpenSecureChannelRequest,pkCli_4100,wNc_4518) in
                                    {4166}out(c, (pkCli_4100,enc(m1_4519,pkSess_4514),sign(h(m1_4519),skCli_4099)));
                                    {4167}in(c, (em2_4520: bitstring,sigM2_4521: bitstring));
                                    {4168}let m2_4522: bitstring = dec(em2_4520,skCli_4099) in
                                    {4169}if (verify(h(m2_4522),sigM2_4521,pkSess_4514) <> true) then
                                        0
                                    else
                                        {4170}let (=OpenSecureChannelResponse,wNs_4523: bitstring,ST_4524: bitstring,TTL_4525: bitstring) = m2_4522 in
                                        {4171}let Ns_4526: bitstring = dec(wNs_4523,skCli_4099) in
                                        {4172}let Kcli_4527: bitstring = h((Nc_4517,Ns_4526)) in
                                        {4173}out(c, senc(mCli(pkCli_4100,pkSess_4514),Kcli_4527))
                                )
                                else
                                    {4174}let v_4528: bool = (Sess = B) in
                                    (
                                        {4175}if v_4528 then
                                        (
                                            {4176}let pkSess_4529: bitstring = pub(skB) in
                                            {4177}out(c, GetEndpointRequest);
                                            {4178}in(c, (=GetEndpointResponse,=pkSess_4529,=SignAndEncrypt,SP_4530: bitstring,UP_4531: bitstring));
                                            {4179}new Nc_4532: bitstring;
                                            {4180}let wNc_4533: bitstring = enc(Nc_4532,pkSess_4529) in
                                            {4181}let m1_4534: bitstring = (OpenSecureChannelRequest,pkCli_4100,wNc_4533) in
                                            {4182}out(c, (pkCli_4100,enc(m1_4534,pkSess_4529),sign(h(m1_4534),skCli_4099)));
                                            {4183}in(c, (em2_4535: bitstring,sigM2_4536: bitstring));
                                            {4184}let m2_4537: bitstring = dec(em2_4535,skCli_4099) in
                                            {4185}if (verify(h(m2_4537),sigM2_4536,pkSess_4529) <> true) then
                                                0
                                            else
                                                {4186}let (=OpenSecureChannelResponse,wNs_4538: bitstring,ST_4539: bitstring,TTL_4540: bitstring) = m2_4537 in
                                                {4187}let Ns_4541: bitstring = dec(wNs_4538,skCli_4099) in
                                                {4188}let Kcli_4542: bitstring = h((Nc_4532,Ns_4541)) in
                                                {4189}out(c, senc(mCli(pkCli_4100,pkSess_4529),Kcli_4542))
                                        )
                                        else
                                            {4190}let v_4543: bool = (Sess = C) in
                                            (
                                                {4191}if v_4543 then
                                                (
                                                    {4192}let pkSess_4544: bitstring = pub(skC) in
                                                    {4193}out(c, GetEndpointRequest);
                                                    {4194}in(c, (=GetEndpointResponse,=pkSess_4544,=SignAndEncrypt,SP_4545: bitstring,UP_4546: bitstring));
                                                    {4195}new Nc_4547: bitstring;
                                                    {4196}let wNc_4548: bitstring = enc(Nc_4547,pkSess_4544) in
                                                    {4197}let m1_4549: bitstring = (OpenSecureChannelRequest,pkCli_4100,wNc_4548) in
                                                    {4198}out(c, (pkCli_4100,enc(m1_4549,pkSess_4544),sign(h(m1_4549),skCli_4099)));
                                                    {4199}in(c, (em2_4550: bitstring,sigM2_4551: bitstring));
                                                    {4200}let m2_4552: bitstring = dec(em2_4550,skCli_4099) in
                                                    {4201}if (verify(h(m2_4552),sigM2_4551,pkSess_4544) <> true) then
                                                        0
                                                    else
                                                        {4202}let (=OpenSecureChannelResponse,wNs_4553: bitstring,ST_4554: bitstring,TTL_4555: bitstring) = m2_4552 in
                                                        {4203}let Ns_4556: bitstring = dec(wNs_4553,skCli_4099) in
                                                        {4204}let Kcli_4557: bitstring = h((Nc_4547,Ns_4556)) in
                                                        {4205}out(c, senc(mCli(pkCli_4100,pkSess_4544),Kcli_4557))
                                                )
                                                else
                                                    {4206}let pkSess_4558: bitstring = pub(sk(Sess)) in
                                                    {4207}out(c, GetEndpointRequest);
                                                    {4208}in(c, (=GetEndpointResponse,=pkSess_4558,=SignAndEncrypt,SP_4559: bitstring,UP_4560: bitstring));
                                                    {4209}new Nc_4561: bitstring;
                                                    {4210}let wNc_4562: bitstring = enc(Nc_4561,pkSess_4558) in
                                                    {4211}let m1_4563: bitstring = (OpenSecureChannelRequest,pkCli_4100,wNc_4562) in
                                                    {4212}out(c, (pkCli_4100,enc(m1_4563,pkSess_4558),sign(h(m1_4563),skCli_4099)));
                                                    {4213}in(c, (em2_4564: bitstring,sigM2_4565: bitstring));
                                                    {4214}let m2_4566: bitstring = dec(em2_4564,skCli_4099) in
                                                    {4215}if (verify(h(m2_4566),sigM2_4565,pkSess_4558) <> true) then
                                                        0
                                                    else
                                                        {4216}let (=OpenSecureChannelResponse,wNs_4567: bitstring,ST_4568: bitstring,TTL_4569: bitstring) = m2_4566 in
                                                        {4217}let Ns_4570: bitstring = dec(wNs_4567,skCli_4099) in
                                                        {4218}let Kcli_4571: bitstring = h((Nc_4561,Ns_4570)) in
                                                        {4219}out(c, senc(mCli(pkCli_4100,pkSess_4558),Kcli_4571))
                                            )
                                            else
                                                {4220}let pkSess_4572: bitstring = fail-any in
                                                {4221}out(c, GetEndpointRequest);
                                                {4222}in(c, (=GetEndpointResponse,=pkSess_4572,=SignAndEncrypt,SP_4573: bitstring,UP_4574: bitstring));
                                                {4223}new Nc_4575: bitstring;
                                                {4224}let wNc_4576: bitstring = enc(Nc_4575,pkSess_4572) in
                                                {4225}let m1_4577: bitstring = (OpenSecureChannelRequest,pkCli_4100,wNc_4576) in
                                                {4226}out(c, (pkCli_4100,enc(m1_4577,pkSess_4572),sign(h(m1_4577),skCli_4099)));
                                                {4227}in(c, (em2_4578: bitstring,sigM2_4579: bitstring));
                                                {4228}let m2_4580: bitstring = dec(em2_4578,skCli_4099) in
                                                {4229}if (verify(h(m2_4580),sigM2_4579,pkSess_4572) <> true) then
                                                    0
                                                else
                                                    {4230}let (=OpenSecureChannelResponse,wNs_4581: bitstring,ST_4582: bitstring,TTL_4583: bitstring) = m2_4580 in
                                                    {4231}let Ns_4584: bitstring = dec(wNs_4581,skCli_4099) in
                                                    {4232}let Kcli_4585: bitstring = h((Nc_4575,Ns_4584)) in
                                                    {4233}out(c, senc(mCli(pkCli_4100,pkSess_4572),Kcli_4585))
                                    )
                                    else
                                        {4234}let pkSess_4586: bitstring = fail-any in
                                        {4235}out(c, GetEndpointRequest);
                                        {4236}in(c, (=GetEndpointResponse,=pkSess_4586,=SignAndEncrypt,SP_4587: bitstring,UP_4588: bitstring));
                                        {4237}new Nc_4589: bitstring;
                                        {4238}let wNc_4590: bitstring = enc(Nc_4589,pkSess_4586) in
                                        {4239}let m1_4591: bitstring = (OpenSecureChannelRequest,pkCli_4100,wNc_4590) in
                                        {4240}out(c, (pkCli_4100,enc(m1_4591,pkSess_4586),sign(h(m1_4591),skCli_4099)));
                                        {4241}in(c, (em2_4592: bitstring,sigM2_4593: bitstring));
                                        {4242}let m2_4594: bitstring = dec(em2_4592,skCli_4099) in
                                        {4243}if (verify(h(m2_4594),sigM2_4593,pkSess_4586) <> true) then
                                            0
                                        else
                                            {4244}let (=OpenSecureChannelResponse,wNs_4595: bitstring,ST_4596: bitstring,TTL_4597: bitstring) = m2_4594 in
                                            {4245}let Ns_4598: bitstring = dec(wNs_4595,skCli_4099) in
                                            {4246}let Kcli_4599: bitstring = h((Nc_4589,Ns_4598)) in
                                            {4247}out(c, senc(mCli(pkCli_4100,pkSess_4586),Kcli_4599))
                            )
                            else
                                {4248}let pkSess_4600: bitstring = fail-any in
                                {4249}out(c, GetEndpointRequest);
                                {4250}in(c, (=GetEndpointResponse,=pkSess_4600,=SignAndEncrypt,SP_4601: bitstring,UP_4602: bitstring));
                                {4251}new Nc_4603: bitstring;
                                {4252}let wNc_4604: bitstring = enc(Nc_4603,pkSess_4600) in
                                {4253}let m1_4605: bitstring = (OpenSecureChannelRequest,pkCli_4100,wNc_4604) in
                                {4254}out(c, (pkCli_4100,enc(m1_4605,pkSess_4600),sign(h(m1_4605),skCli_4099)));
                                {4255}in(c, (em2_4606: bitstring,sigM2_4607: bitstring));
                                {4256}let m2_4608: bitstring = dec(em2_4606,skCli_4099) in
                                {4257}if (verify(h(m2_4608),sigM2_4607,pkSess_4600) <> true) then
                                    0
                                else
                                    {4258}let (=OpenSecureChannelResponse,wNs_4609: bitstring,ST_4610: bitstring,TTL_4611: bitstring) = m2_4608 in
                                    {4259}let Ns_4612: bitstring = dec(wNs_4609,skCli_4099) in
                                    {4260}let Kcli_4613: bitstring = h((Nc_4603,Ns_4612)) in
                                    {4261}out(c, senc(mCli(pkCli_4100,pkSess_4600),Kcli_4613))
                )
                else
                    {4262}let pkDisco_4614: bitstring = fail-any in
                    {4263}let v_4615: bool = (Sess = A) in
                    (
                        {4264}if v_4615 then
                        (
                            {4265}let pkSess_4616: bitstring = pub(skA) in
                            {4266}out(c, GetEndpointRequest);
                            {4267}in(c, (=GetEndpointResponse,=pkSess_4616,=SignAndEncrypt,SP_4617: bitstring,UP_4618: bitstring));
                            {4268}new Nc_4619: bitstring;
                            {4269}let wNc_4620: bitstring = enc(Nc_4619,pkSess_4616) in
                            {4270}let m1_4621: bitstring = (OpenSecureChannelRequest,pkCli_4100,wNc_4620) in
                            {4271}out(c, (pkCli_4100,enc(m1_4621,pkSess_4616),sign(h(m1_4621),skCli_4099)));
                            {4272}in(c, (em2_4622: bitstring,sigM2_4623: bitstring));
                            {4273}let m2_4624: bitstring = dec(em2_4622,skCli_4099) in
                            {4274}if (verify(h(m2_4624),sigM2_4623,pkSess_4616) <> true) then
                                0
                            else
                                {4275}let (=OpenSecureChannelResponse,wNs_4625: bitstring,ST_4626: bitstring,TTL_4627: bitstring) = m2_4624 in
                                {4276}let Ns_4628: bitstring = dec(wNs_4625,skCli_4099) in
                                {4277}let Kcli_4629: bitstring = h((Nc_4619,Ns_4628)) in
                                {4278}out(c, senc(mCli(pkCli_4100,pkSess_4616),Kcli_4629))
                        )
                        else
                            {4279}let v_4630: bool = (Sess = B) in
                            (
                                {4280}if v_4630 then
                                (
                                    {4281}let pkSess_4631: bitstring = pub(skB) in
                                    {4282}out(c, GetEndpointRequest);
                                    {4283}in(c, (=GetEndpointResponse,=pkSess_4631,=SignAndEncrypt,SP_4632: bitstring,UP_4633: bitstring));
                                    {4284}new Nc_4634: bitstring;
                                    {4285}let wNc_4635: bitstring = enc(Nc_4634,pkSess_4631) in
                                    {4286}let m1_4636: bitstring = (OpenSecureChannelRequest,pkCli_4100,wNc_4635) in
                                    {4287}out(c, (pkCli_4100,enc(m1_4636,pkSess_4631),sign(h(m1_4636),skCli_4099)));
                                    {4288}in(c, (em2_4637: bitstring,sigM2_4638: bitstring));
                                    {4289}let m2_4639: bitstring = dec(em2_4637,skCli_4099) in
                                    {4290}if (verify(h(m2_4639),sigM2_4638,pkSess_4631) <> true) then
                                        0
                                    else
                                        {4291}let (=OpenSecureChannelResponse,wNs_4640: bitstring,ST_4641: bitstring,TTL_4642: bitstring) = m2_4639 in
                                        {4292}let Ns_4643: bitstring = dec(wNs_4640,skCli_4099) in
                                        {4293}let Kcli_4644: bitstring = h((Nc_4634,Ns_4643)) in
                                        {4294}out(c, senc(mCli(pkCli_4100,pkSess_4631),Kcli_4644))
                                )
                                else
                                    {4295}let v_4645: bool = (Sess = C) in
                                    (
                                        {4296}if v_4645 then
                                        (
                                            {4297}let pkSess_4646: bitstring = pub(skC) in
                                            {4298}out(c, GetEndpointRequest);
                                            {4299}in(c, (=GetEndpointResponse,=pkSess_4646,=SignAndEncrypt,SP_4647: bitstring,UP_4648: bitstring));
                                            {4300}new Nc_4649: bitstring;
                                            {4301}let wNc_4650: bitstring = enc(Nc_4649,pkSess_4646) in
                                            {4302}let m1_4651: bitstring = (OpenSecureChannelRequest,pkCli_4100,wNc_4650) in
                                            {4303}out(c, (pkCli_4100,enc(m1_4651,pkSess_4646),sign(h(m1_4651),skCli_4099)));
                                            {4304}in(c, (em2_4652: bitstring,sigM2_4653: bitstring));
                                            {4305}let m2_4654: bitstring = dec(em2_4652,skCli_4099) in
                                            {4306}if (verify(h(m2_4654),sigM2_4653,pkSess_4646) <> true) then
                                                0
                                            else
                                                {4307}let (=OpenSecureChannelResponse,wNs_4655: bitstring,ST_4656: bitstring,TTL_4657: bitstring) = m2_4654 in
                                                {4308}let Ns_4658: bitstring = dec(wNs_4655,skCli_4099) in
                                                {4309}let Kcli_4659: bitstring = h((Nc_4649,Ns_4658)) in
                                                {4310}out(c, senc(mCli(pkCli_4100,pkSess_4646),Kcli_4659))
                                        )
                                        else
                                            {4311}let pkSess_4660: bitstring = pub(sk(Sess)) in
                                            {4312}out(c, GetEndpointRequest);
                                            {4313}in(c, (=GetEndpointResponse,=pkSess_4660,=SignAndEncrypt,SP_4661: bitstring,UP_4662: bitstring));
                                            {4314}new Nc_4663: bitstring;
                                            {4315}let wNc_4664: bitstring = enc(Nc_4663,pkSess_4660) in
                                            {4316}let m1_4665: bitstring = (OpenSecureChannelRequest,pkCli_4100,wNc_4664) in
                                            {4317}out(c, (pkCli_4100,enc(m1_4665,pkSess_4660),sign(h(m1_4665),skCli_4099)));
                                            {4318}in(c, (em2_4666: bitstring,sigM2_4667: bitstring));
                                            {4319}let m2_4668: bitstring = dec(em2_4666,skCli_4099) in
                                            {4320}if (verify(h(m2_4668),sigM2_4667,pkSess_4660) <> true) then
                                                0
                                            else
                                                {4321}let (=OpenSecureChannelResponse,wNs_4669: bitstring,ST_4670: bitstring,TTL_4671: bitstring) = m2_4668 in
                                                {4322}let Ns_4672: bitstring = dec(wNs_4669,skCli_4099) in
                                                {4323}let Kcli_4673: bitstring = h((Nc_4663,Ns_4672)) in
                                                {4324}out(c, senc(mCli(pkCli_4100,pkSess_4660),Kcli_4673))
                                    )
                                    else
                                        {4325}let pkSess_4674: bitstring = fail-any in
                                        {4326}out(c, GetEndpointRequest);
                                        {4327}in(c, (=GetEndpointResponse,=pkSess_4674,=SignAndEncrypt,SP_4675: bitstring,UP_4676: bitstring));
                                        {4328}new Nc_4677: bitstring;
                                        {4329}let wNc_4678: bitstring = enc(Nc_4677,pkSess_4674) in
                                        {4330}let m1_4679: bitstring = (OpenSecureChannelRequest,pkCli_4100,wNc_4678) in
                                        {4331}out(c, (pkCli_4100,enc(m1_4679,pkSess_4674),sign(h(m1_4679),skCli_4099)));
                                        {4332}in(c, (em2_4680: bitstring,sigM2_4681: bitstring));
                                        {4333}let m2_4682: bitstring = dec(em2_4680,skCli_4099) in
                                        {4334}if (verify(h(m2_4682),sigM2_4681,pkSess_4674) <> true) then
                                            0
                                        else
                                            {4335}let (=OpenSecureChannelResponse,wNs_4683: bitstring,ST_4684: bitstring,TTL_4685: bitstring) = m2_4682 in
                                            {4336}let Ns_4686: bitstring = dec(wNs_4683,skCli_4099) in
                                            {4337}let Kcli_4687: bitstring = h((Nc_4677,Ns_4686)) in
                                            {4338}out(c, senc(mCli(pkCli_4100,pkSess_4674),Kcli_4687))
                            )
                            else
                                {4339}let pkSess_4688: bitstring = fail-any in
                                {4340}out(c, GetEndpointRequest);
                                {4341}in(c, (=GetEndpointResponse,=pkSess_4688,=SignAndEncrypt,SP_4689: bitstring,UP_4690: bitstring));
                                {4342}new Nc_4691: bitstring;
                                {4343}let wNc_4692: bitstring = enc(Nc_4691,pkSess_4688) in
                                {4344}let m1_4693: bitstring = (OpenSecureChannelRequest,pkCli_4100,wNc_4692) in
                                {4345}out(c, (pkCli_4100,enc(m1_4693,pkSess_4688),sign(h(m1_4693),skCli_4099)));
                                {4346}in(c, (em2_4694: bitstring,sigM2_4695: bitstring));
                                {4347}let m2_4696: bitstring = dec(em2_4694,skCli_4099) in
                                {4348}if (verify(h(m2_4696),sigM2_4695,pkSess_4688) <> true) then
                                    0
                                else
                                    {4349}let (=OpenSecureChannelResponse,wNs_4697: bitstring,ST_4698: bitstring,TTL_4699: bitstring) = m2_4696 in
                                    {4350}let Ns_4700: bitstring = dec(wNs_4697,skCli_4099) in
                                    {4351}let Kcli_4701: bitstring = h((Nc_4691,Ns_4700)) in
                                    {4352}out(c, senc(mCli(pkCli_4100,pkSess_4688),Kcli_4701))
                    )
                    else
                        {4353}let pkSess_4702: bitstring = fail-any in
                        {4354}out(c, GetEndpointRequest);
                        {4355}in(c, (=GetEndpointResponse,=pkSess_4702,=SignAndEncrypt,SP_4703: bitstring,UP_4704: bitstring));
                        {4356}new Nc_4705: bitstring;
                        {4357}let wNc_4706: bitstring = enc(Nc_4705,pkSess_4702) in
                        {4358}let m1_4707: bitstring = (OpenSecureChannelRequest,pkCli_4100,wNc_4706) in
                        {4359}out(c, (pkCli_4100,enc(m1_4707,pkSess_4702),sign(h(m1_4707),skCli_4099)));
                        {4360}in(c, (em2_4708: bitstring,sigM2_4709: bitstring));
                        {4361}let m2_4710: bitstring = dec(em2_4708,skCli_4099) in
                        {4362}if (verify(h(m2_4710),sigM2_4709,pkSess_4702) <> true) then
                            0
                        else
                            {4363}let (=OpenSecureChannelResponse,wNs_4711: bitstring,ST_4712: bitstring,TTL_4713: bitstring) = m2_4710 in
                            {4364}let Ns_4714: bitstring = dec(wNs_4711,skCli_4099) in
                            {4365}let Kcli_4715: bitstring = h((Nc_4705,Ns_4714)) in
                            {4366}out(c, senc(mCli(pkCli_4100,pkSess_4702),Kcli_4715))
        )
        else
            {4367}let pkDisco_4716: bitstring = fail-any in
            {4368}let v_4717: bool = (Sess = A) in
            (
                {4369}if v_4717 then
                (
                    {4370}let pkSess_4718: bitstring = pub(skA) in
                    {4371}out(c, GetEndpointRequest);
                    {4372}in(c, (=GetEndpointResponse,=pkSess_4718,=SignAndEncrypt,SP_4719: bitstring,UP_4720: bitstring));
                    {4373}new Nc_4721: bitstring;
                    {4374}let wNc_4722: bitstring = enc(Nc_4721,pkSess_4718) in
                    {4375}let m1_4723: bitstring = (OpenSecureChannelRequest,pkCli_4100,wNc_4722) in
                    {4376}out(c, (pkCli_4100,enc(m1_4723,pkSess_4718),sign(h(m1_4723),skCli_4099)));
                    {4377}in(c, (em2_4724: bitstring,sigM2_4725: bitstring));
                    {4378}let m2_4726: bitstring = dec(em2_4724,skCli_4099) in
                    {4379}if (verify(h(m2_4726),sigM2_4725,pkSess_4718) <> true) then
                        0
                    else
                        {4380}let (=OpenSecureChannelResponse,wNs_4727: bitstring,ST_4728: bitstring,TTL_4729: bitstring) = m2_4726 in
                        {4381}let Ns_4730: bitstring = dec(wNs_4727,skCli_4099) in
                        {4382}let Kcli_4731: bitstring = h((Nc_4721,Ns_4730)) in
                        {4383}out(c, senc(mCli(pkCli_4100,pkSess_4718),Kcli_4731))
                )
                else
                    {4384}let v_4732: bool = (Sess = B) in
                    (
                        {4385}if v_4732 then
                        (
                            {4386}let pkSess_4733: bitstring = pub(skB) in
                            {4387}out(c, GetEndpointRequest);
                            {4388}in(c, (=GetEndpointResponse,=pkSess_4733,=SignAndEncrypt,SP_4734: bitstring,UP_4735: bitstring));
                            {4389}new Nc_4736: bitstring;
                            {4390}let wNc_4737: bitstring = enc(Nc_4736,pkSess_4733) in
                            {4391}let m1_4738: bitstring = (OpenSecureChannelRequest,pkCli_4100,wNc_4737) in
                            {4392}out(c, (pkCli_4100,enc(m1_4738,pkSess_4733),sign(h(m1_4738),skCli_4099)));
                            {4393}in(c, (em2_4739: bitstring,sigM2_4740: bitstring));
                            {4394}let m2_4741: bitstring = dec(em2_4739,skCli_4099) in
                            {4395}if (verify(h(m2_4741),sigM2_4740,pkSess_4733) <> true) then
                                0
                            else
                                {4396}let (=OpenSecureChannelResponse,wNs_4742: bitstring,ST_4743: bitstring,TTL_4744: bitstring) = m2_4741 in
                                {4397}let Ns_4745: bitstring = dec(wNs_4742,skCli_4099) in
                                {4398}let Kcli_4746: bitstring = h((Nc_4736,Ns_4745)) in
                                {4399}out(c, senc(mCli(pkCli_4100,pkSess_4733),Kcli_4746))
                        )
                        else
                            {4400}let v_4747: bool = (Sess = C) in
                            (
                                {4401}if v_4747 then
                                (
                                    {4402}let pkSess_4748: bitstring = pub(skC) in
                                    {4403}out(c, GetEndpointRequest);
                                    {4404}in(c, (=GetEndpointResponse,=pkSess_4748,=SignAndEncrypt,SP_4749: bitstring,UP_4750: bitstring));
                                    {4405}new Nc_4751: bitstring;
                                    {4406}let wNc_4752: bitstring = enc(Nc_4751,pkSess_4748) in
                                    {4407}let m1_4753: bitstring = (OpenSecureChannelRequest,pkCli_4100,wNc_4752) in
                                    {4408}out(c, (pkCli_4100,enc(m1_4753,pkSess_4748),sign(h(m1_4753),skCli_4099)));
                                    {4409}in(c, (em2_4754: bitstring,sigM2_4755: bitstring));
                                    {4410}let m2_4756: bitstring = dec(em2_4754,skCli_4099) in
                                    {4411}if (verify(h(m2_4756),sigM2_4755,pkSess_4748) <> true) then
                                        0
                                    else
                                        {4412}let (=OpenSecureChannelResponse,wNs_4757: bitstring,ST_4758: bitstring,TTL_4759: bitstring) = m2_4756 in
                                        {4413}let Ns_4760: bitstring = dec(wNs_4757,skCli_4099) in
                                        {4414}let Kcli_4761: bitstring = h((Nc_4751,Ns_4760)) in
                                        {4415}out(c, senc(mCli(pkCli_4100,pkSess_4748),Kcli_4761))
                                )
                                else
                                    {4416}let pkSess_4762: bitstring = pub(sk(Sess)) in
                                    {4417}out(c, GetEndpointRequest);
                                    {4418}in(c, (=GetEndpointResponse,=pkSess_4762,=SignAndEncrypt,SP_4763: bitstring,UP_4764: bitstring));
                                    {4419}new Nc_4765: bitstring;
                                    {4420}let wNc_4766: bitstring = enc(Nc_4765,pkSess_4762) in
                                    {4421}let m1_4767: bitstring = (OpenSecureChannelRequest,pkCli_4100,wNc_4766) in
                                    {4422}out(c, (pkCli_4100,enc(m1_4767,pkSess_4762),sign(h(m1_4767),skCli_4099)));
                                    {4423}in(c, (em2_4768: bitstring,sigM2_4769: bitstring));
                                    {4424}let m2_4770: bitstring = dec(em2_4768,skCli_4099) in
                                    {4425}if (verify(h(m2_4770),sigM2_4769,pkSess_4762) <> true) then
                                        0
                                    else
                                        {4426}let (=OpenSecureChannelResponse,wNs_4771: bitstring,ST_4772: bitstring,TTL_4773: bitstring) = m2_4770 in
                                        {4427}let Ns_4774: bitstring = dec(wNs_4771,skCli_4099) in
                                        {4428}let Kcli_4775: bitstring = h((Nc_4765,Ns_4774)) in
                                        {4429}out(c, senc(mCli(pkCli_4100,pkSess_4762),Kcli_4775))
                            )
                            else
                                {4430}let pkSess_4776: bitstring = fail-any in
                                {4431}out(c, GetEndpointRequest);
                                {4432}in(c, (=GetEndpointResponse,=pkSess_4776,=SignAndEncrypt,SP_4777: bitstring,UP_4778: bitstring));
                                {4433}new Nc_4779: bitstring;
                                {4434}let wNc_4780: bitstring = enc(Nc_4779,pkSess_4776) in
                                {4435}let m1_4781: bitstring = (OpenSecureChannelRequest,pkCli_4100,wNc_4780) in
                                {4436}out(c, (pkCli_4100,enc(m1_4781,pkSess_4776),sign(h(m1_4781),skCli_4099)));
                                {4437}in(c, (em2_4782: bitstring,sigM2_4783: bitstring));
                                {4438}let m2_4784: bitstring = dec(em2_4782,skCli_4099) in
                                {4439}if (verify(h(m2_4784),sigM2_4783,pkSess_4776) <> true) then
                                    0
                                else
                                    {4440}let (=OpenSecureChannelResponse,wNs_4785: bitstring,ST_4786: bitstring,TTL_4787: bitstring) = m2_4784 in
                                    {4441}let Ns_4788: bitstring = dec(wNs_4785,skCli_4099) in
                                    {4442}let Kcli_4789: bitstring = h((Nc_4779,Ns_4788)) in
                                    {4443}out(c, senc(mCli(pkCli_4100,pkSess_4776),Kcli_4789))
                    )
                    else
                        {4444}let pkSess_4790: bitstring = fail-any in
                        {4445}out(c, GetEndpointRequest);
                        {4446}in(c, (=GetEndpointResponse,=pkSess_4790,=SignAndEncrypt,SP_4791: bitstring,UP_4792: bitstring));
                        {4447}new Nc_4793: bitstring;
                        {4448}let wNc_4794: bitstring = enc(Nc_4793,pkSess_4790) in
                        {4449}let m1_4795: bitstring = (OpenSecureChannelRequest,pkCli_4100,wNc_4794) in
                        {4450}out(c, (pkCli_4100,enc(m1_4795,pkSess_4790),sign(h(m1_4795),skCli_4099)));
                        {4451}in(c, (em2_4796: bitstring,sigM2_4797: bitstring));
                        {4452}let m2_4798: bitstring = dec(em2_4796,skCli_4099) in
                        {4453}if (verify(h(m2_4798),sigM2_4797,pkSess_4790) <> true) then
                            0
                        else
                            {4454}let (=OpenSecureChannelResponse,wNs_4799: bitstring,ST_4800: bitstring,TTL_4801: bitstring) = m2_4798 in
                            {4455}let Ns_4802: bitstring = dec(wNs_4799,skCli_4099) in
                            {4456}let Kcli_4803: bitstring = h((Nc_4793,Ns_4802)) in
                            {4457}out(c, senc(mCli(pkCli_4100,pkSess_4790),Kcli_4803))
            )
            else
                {4458}let pkSess_4804: bitstring = fail-any in
                {4459}out(c, GetEndpointRequest);
                {4460}in(c, (=GetEndpointResponse,=pkSess_4804,=SignAndEncrypt,SP_4805: bitstring,UP_4806: bitstring));
                {4461}new Nc_4807: bitstring;
                {4462}let wNc_4808: bitstring = enc(Nc_4807,pkSess_4804) in
                {4463}let m1_4809: bitstring = (OpenSecureChannelRequest,pkCli_4100,wNc_4808) in
                {4464}out(c, (pkCli_4100,enc(m1_4809,pkSess_4804),sign(h(m1_4809),skCli_4099)));
                {4465}in(c, (em2_4810: bitstring,sigM2_4811: bitstring));
                {4466}let m2_4812: bitstring = dec(em2_4810,skCli_4099) in
                {4467}if (verify(h(m2_4812),sigM2_4811,pkSess_4804) <> true) then
                    0
                else
                    {4468}let (=OpenSecureChannelResponse,wNs_4813: bitstring,ST_4814: bitstring,TTL_4815: bitstring) = m2_4812 in
                    {4469}let Ns_4816: bitstring = dec(wNs_4813,skCli_4099) in
                    {4470}let Kcli_4817: bitstring = h((Nc_4807,Ns_4816)) in
                    {4471}out(c, senc(mCli(pkCli_4100,pkSess_4804),Kcli_4817))
) | (
    {4472}!
    {4473}in(c, (Cli_4818: host,Disco_4819: host,Sess_4820: host));
    {4474}let v_4821: bool = (Disco_4819 = A) in
    (
        {4475}if v_4821 then
        (
            {4476}let skDisco: bitstring = skA in
            {4477}let pkDisco_4822: bitstring = pub(skDisco) in
            {4478}let v_4823: bool = (Cli_4818 = A) in
            (
                {4479}if v_4823 then
                (
                    {4480}let pkCli_4824: bitstring = pub(skA) in
                    {4481}let v_4825: bool = (Sess_4820 = A) in
                    (
                        {4482}if v_4825 then
                        (
                            {4483}let pkSess_4826: bitstring = pub(skA) in
                            {4484}in(c, =GetEndpointRequest);
                            {4485}new SP_4827: bitstring;
                            {4486}new UP_4828: bitstring;
                            {4487}out(c, (GetEndpointResponse,pkSess_4826,SignAndEncrypt,SP_4827,UP_4828))
                        )
                        else
                            {4488}let v_4829: bool = (Sess_4820 = B) in
                            (
                                {4489}if v_4829 then
                                (
                                    {4490}let pkSess_4830: bitstring = pub(skB) in
                                    {4491}in(c, =GetEndpointRequest);
                                    {4492}new SP_4831: bitstring;
                                    {4493}new UP_4832: bitstring;
                                    {4494}out(c, (GetEndpointResponse,pkSess_4830,SignAndEncrypt,SP_4831,UP_4832))
                                )
                                else
                                    {4495}let v_4833: bool = (Sess_4820 = C) in
                                    (
                                        {4496}if v_4833 then
                                        (
                                            {4497}let pkSess_4834: bitstring = pub(skC) in
                                            {4498}in(c, =GetEndpointRequest);
                                            {4499}new SP_4835: bitstring;
                                            {4500}new UP_4836: bitstring;
                                            {4501}out(c, (GetEndpointResponse,pkSess_4834,SignAndEncrypt,SP_4835,UP_4836))
                                        )
                                        else
                                            {4502}let pkSess_4837: bitstring = pub(sk(Sess_4820)) in
                                            {4503}in(c, =GetEndpointRequest);
                                            {4504}new SP_4838: bitstring;
                                            {4505}new UP_4839: bitstring;
                                            {4506}out(c, (GetEndpointResponse,pkSess_4837,SignAndEncrypt,SP_4838,UP_4839))
                                    )
                                    else
                                        {4507}let pkSess_4840: bitstring = fail-any in
                                        {4508}in(c, =GetEndpointRequest);
                                        {4509}new SP_4841: bitstring;
                                        {4510}new UP_4842: bitstring;
                                        {4511}out(c, (GetEndpointResponse,pkSess_4840,SignAndEncrypt,SP_4841,UP_4842))
                            )
                            else
                                {4512}let pkSess_4843: bitstring = fail-any in
                                {4513}in(c, =GetEndpointRequest);
                                {4514}new SP_4844: bitstring;
                                {4515}new UP_4845: bitstring;
                                {4516}out(c, (GetEndpointResponse,pkSess_4843,SignAndEncrypt,SP_4844,UP_4845))
                    )
                    else
                        {4517}let pkSess_4846: bitstring = fail-any in
                        {4518}in(c, =GetEndpointRequest);
                        {4519}new SP_4847: bitstring;
                        {4520}new UP_4848: bitstring;
                        {4521}out(c, (GetEndpointResponse,pkSess_4846,SignAndEncrypt,SP_4847,UP_4848))
                )
                else
                    {4522}let v_4849: bool = (Cli_4818 = B) in
                    (
                        {4523}if v_4849 then
                        (
                            {4524}let pkCli_4850: bitstring = pub(skB) in
                            {4525}let v_4851: bool = (Sess_4820 = A) in
                            (
                                {4526}if v_4851 then
                                (
                                    {4527}let pkSess_4852: bitstring = pub(skA) in
                                    {4528}in(c, =GetEndpointRequest);
                                    {4529}new SP_4853: bitstring;
                                    {4530}new UP_4854: bitstring;
                                    {4531}out(c, (GetEndpointResponse,pkSess_4852,SignAndEncrypt,SP_4853,UP_4854))
                                )
                                else
                                    {4532}let v_4855: bool = (Sess_4820 = B) in
                                    (
                                        {4533}if v_4855 then
                                        (
                                            {4534}let pkSess_4856: bitstring = pub(skB) in
                                            {4535}in(c, =GetEndpointRequest);
                                            {4536}new SP_4857: bitstring;
                                            {4537}new UP_4858: bitstring;
                                            {4538}out(c, (GetEndpointResponse,pkSess_4856,SignAndEncrypt,SP_4857,UP_4858))
                                        )
                                        else
                                            {4539}let v_4859: bool = (Sess_4820 = C) in
                                            (
                                                {4540}if v_4859 then
                                                (
                                                    {4541}let pkSess_4860: bitstring = pub(skC) in
                                                    {4542}in(c, =GetEndpointRequest);
                                                    {4543}new SP_4861: bitstring;
                                                    {4544}new UP_4862: bitstring;
                                                    {4545}out(c, (GetEndpointResponse,pkSess_4860,SignAndEncrypt,SP_4861,UP_4862))
                                                )
                                                else
                                                    {4546}let pkSess_4863: bitstring = pub(sk(Sess_4820)) in
                                                    {4547}in(c, =GetEndpointRequest);
                                                    {4548}new SP_4864: bitstring;
                                                    {4549}new UP_4865: bitstring;
                                                    {4550}out(c, (GetEndpointResponse,pkSess_4863,SignAndEncrypt,SP_4864,UP_4865))
                                            )
                                            else
                                                {4551}let pkSess_4866: bitstring = fail-any in
                                                {4552}in(c, =GetEndpointRequest);
                                                {4553}new SP_4867: bitstring;
                                                {4554}new UP_4868: bitstring;
                                                {4555}out(c, (GetEndpointResponse,pkSess_4866,SignAndEncrypt,SP_4867,UP_4868))
                                    )
                                    else
                                        {4556}let pkSess_4869: bitstring = fail-any in
                                        {4557}in(c, =GetEndpointRequest);
                                        {4558}new SP_4870: bitstring;
                                        {4559}new UP_4871: bitstring;
                                        {4560}out(c, (GetEndpointResponse,pkSess_4869,SignAndEncrypt,SP_4870,UP_4871))
                            )
                            else
                                {4561}let pkSess_4872: bitstring = fail-any in
                                {4562}in(c, =GetEndpointRequest);
                                {4563}new SP_4873: bitstring;
                                {4564}new UP_4874: bitstring;
                                {4565}out(c, (GetEndpointResponse,pkSess_4872,SignAndEncrypt,SP_4873,UP_4874))
                        )
                        else
                            {4566}let v_4875: bool = (Cli_4818 = C) in
                            (
                                {4567}if v_4875 then
                                (
                                    {4568}let pkCli_4876: bitstring = pub(skC) in
                                    {4569}let v_4877: bool = (Sess_4820 = A) in
                                    (
                                        {4570}if v_4877 then
                                        (
                                            {4571}let pkSess_4878: bitstring = pub(skA) in
                                            {4572}in(c, =GetEndpointRequest);
                                            {4573}new SP_4879: bitstring;
                                            {4574}new UP_4880: bitstring;
                                            {4575}out(c, (GetEndpointResponse,pkSess_4878,SignAndEncrypt,SP_4879,UP_4880))
                                        )
                                        else
                                            {4576}let v_4881: bool = (Sess_4820 = B) in
                                            (
                                                {4577}if v_4881 then
                                                (
                                                    {4578}let pkSess_4882: bitstring = pub(skB) in
                                                    {4579}in(c, =GetEndpointRequest);
                                                    {4580}new SP_4883: bitstring;
                                                    {4581}new UP_4884: bitstring;
                                                    {4582}out(c, (GetEndpointResponse,pkSess_4882,SignAndEncrypt,SP_4883,UP_4884))
                                                )
                                                else
                                                    {4583}let v_4885: bool = (Sess_4820 = C) in
                                                    (
                                                        {4584}if v_4885 then
                                                        (
                                                            {4585}let pkSess_4886: bitstring = pub(skC) in
                                                            {4586}in(c, =GetEndpointRequest);
                                                            {4587}new SP_4887: bitstring;
                                                            {4588}new UP_4888: bitstring;
                                                            {4589}out(c, (GetEndpointResponse,pkSess_4886,SignAndEncrypt,SP_4887,UP_4888))
                                                        )
                                                        else
                                                            {4590}let pkSess_4889: bitstring = pub(sk(Sess_4820)) in
                                                            {4591}in(c, =GetEndpointRequest);
                                                            {4592}new SP_4890: bitstring;
                                                            {4593}new UP_4891: bitstring;
                                                            {4594}out(c, (GetEndpointResponse,pkSess_4889,SignAndEncrypt,SP_4890,UP_4891))
                                                    )
                                                    else
                                                        {4595}let pkSess_4892: bitstring = fail-any in
                                                        {4596}in(c, =GetEndpointRequest);
                                                        {4597}new SP_4893: bitstring;
                                                        {4598}new UP_4894: bitstring;
                                                        {4599}out(c, (GetEndpointResponse,pkSess_4892,SignAndEncrypt,SP_4893,UP_4894))
                                            )
                                            else
                                                {4600}let pkSess_4895: bitstring = fail-any in
                                                {4601}in(c, =GetEndpointRequest);
                                                {4602}new SP_4896: bitstring;
                                                {4603}new UP_4897: bitstring;
                                                {4604}out(c, (GetEndpointResponse,pkSess_4895,SignAndEncrypt,SP_4896,UP_4897))
                                    )
                                    else
                                        {4605}let pkSess_4898: bitstring = fail-any in
                                        {4606}in(c, =GetEndpointRequest);
                                        {4607}new SP_4899: bitstring;
                                        {4608}new UP_4900: bitstring;
                                        {4609}out(c, (GetEndpointResponse,pkSess_4898,SignAndEncrypt,SP_4899,UP_4900))
                                )
                                else
                                    {4610}let pkCli_4901: bitstring = pub(sk(Cli_4818)) in
                                    {4611}let v_4902: bool = (Sess_4820 = A) in
                                    (
                                        {4612}if v_4902 then
                                        (
                                            {4613}let pkSess_4903: bitstring = pub(skA) in
                                            {4614}in(c, =GetEndpointRequest);
                                            {4615}new SP_4904: bitstring;
                                            {4616}new UP_4905: bitstring;
                                            {4617}out(c, (GetEndpointResponse,pkSess_4903,SignAndEncrypt,SP_4904,UP_4905))
                                        )
                                        else
                                            {4618}let v_4906: bool = (Sess_4820 = B) in
                                            (
                                                {4619}if v_4906 then
                                                (
                                                    {4620}let pkSess_4907: bitstring = pub(skB) in
                                                    {4621}in(c, =GetEndpointRequest);
                                                    {4622}new SP_4908: bitstring;
                                                    {4623}new UP_4909: bitstring;
                                                    {4624}out(c, (GetEndpointResponse,pkSess_4907,SignAndEncrypt,SP_4908,UP_4909))
                                                )
                                                else
                                                    {4625}let v_4910: bool = (Sess_4820 = C) in
                                                    (
                                                        {4626}if v_4910 then
                                                        (
                                                            {4627}let pkSess_4911: bitstring = pub(skC) in
                                                            {4628}in(c, =GetEndpointRequest);
                                                            {4629}new SP_4912: bitstring;
                                                            {4630}new UP_4913: bitstring;
                                                            {4631}out(c, (GetEndpointResponse,pkSess_4911,SignAndEncrypt,SP_4912,UP_4913))
                                                        )
                                                        else
                                                            {4632}let pkSess_4914: bitstring = pub(sk(Sess_4820)) in
                                                            {4633}in(c, =GetEndpointRequest);
                                                            {4634}new SP_4915: bitstring;
                                                            {4635}new UP_4916: bitstring;
                                                            {4636}out(c, (GetEndpointResponse,pkSess_4914,SignAndEncrypt,SP_4915,UP_4916))
                                                    )
                                                    else
                                                        {4637}let pkSess_4917: bitstring = fail-any in
                                                        {4638}in(c, =GetEndpointRequest);
                                                        {4639}new SP_4918: bitstring;
                                                        {4640}new UP_4919: bitstring;
                                                        {4641}out(c, (GetEndpointResponse,pkSess_4917,SignAndEncrypt,SP_4918,UP_4919))
                                            )
                                            else
                                                {4642}let pkSess_4920: bitstring = fail-any in
                                                {4643}in(c, =GetEndpointRequest);
                                                {4644}new SP_4921: bitstring;
                                                {4645}new UP_4922: bitstring;
                                                {4646}out(c, (GetEndpointResponse,pkSess_4920,SignAndEncrypt,SP_4921,UP_4922))
                                    )
                                    else
                                        {4647}let pkSess_4923: bitstring = fail-any in
                                        {4648}in(c, =GetEndpointRequest);
                                        {4649}new SP_4924: bitstring;
                                        {4650}new UP_4925: bitstring;
                                        {4651}out(c, (GetEndpointResponse,pkSess_4923,SignAndEncrypt,SP_4924,UP_4925))
                            )
                            else
                                {4652}let pkCli_4926: bitstring = fail-any in
                                {4653}let v_4927: bool = (Sess_4820 = A) in
                                (
                                    {4654}if v_4927 then
                                    (
                                        {4655}let pkSess_4928: bitstring = pub(skA) in
                                        {4656}in(c, =GetEndpointRequest);
                                        {4657}new SP_4929: bitstring;
                                        {4658}new UP_4930: bitstring;
                                        {4659}out(c, (GetEndpointResponse,pkSess_4928,SignAndEncrypt,SP_4929,UP_4930))
                                    )
                                    else
                                        {4660}let v_4931: bool = (Sess_4820 = B) in
                                        (
                                            {4661}if v_4931 then
                                            (
                                                {4662}let pkSess_4932: bitstring = pub(skB) in
                                                {4663}in(c, =GetEndpointRequest);
                                                {4664}new SP_4933: bitstring;
                                                {4665}new UP_4934: bitstring;
                                                {4666}out(c, (GetEndpointResponse,pkSess_4932,SignAndEncrypt,SP_4933,UP_4934))
                                            )
                                            else
                                                {4667}let v_4935: bool = (Sess_4820 = C) in
                                                (
                                                    {4668}if v_4935 then
                                                    (
                                                        {4669}let pkSess_4936: bitstring = pub(skC) in
                                                        {4670}in(c, =GetEndpointRequest);
                                                        {4671}new SP_4937: bitstring;
                                                        {4672}new UP_4938: bitstring;
                                                        {4673}out(c, (GetEndpointResponse,pkSess_4936,SignAndEncrypt,SP_4937,UP_4938))
                                                    )
                                                    else
                                                        {4674}let pkSess_4939: bitstring = pub(sk(Sess_4820)) in
                                                        {4675}in(c, =GetEndpointRequest);
                                                        {4676}new SP_4940: bitstring;
                                                        {4677}new UP_4941: bitstring;
                                                        {4678}out(c, (GetEndpointResponse,pkSess_4939,SignAndEncrypt,SP_4940,UP_4941))
                                                )
                                                else
                                                    {4679}let pkSess_4942: bitstring = fail-any in
                                                    {4680}in(c, =GetEndpointRequest);
                                                    {4681}new SP_4943: bitstring;
                                                    {4682}new UP_4944: bitstring;
                                                    {4683}out(c, (GetEndpointResponse,pkSess_4942,SignAndEncrypt,SP_4943,UP_4944))
                                        )
                                        else
                                            {4684}let pkSess_4945: bitstring = fail-any in
                                            {4685}in(c, =GetEndpointRequest);
                                            {4686}new SP_4946: bitstring;
                                            {4687}new UP_4947: bitstring;
                                            {4688}out(c, (GetEndpointResponse,pkSess_4945,SignAndEncrypt,SP_4946,UP_4947))
                                )
                                else
                                    {4689}let pkSess_4948: bitstring = fail-any in
                                    {4690}in(c, =GetEndpointRequest);
                                    {4691}new SP_4949: bitstring;
                                    {4692}new UP_4950: bitstring;
                                    {4693}out(c, (GetEndpointResponse,pkSess_4948,SignAndEncrypt,SP_4949,UP_4950))
                    )
                    else
                        {4694}let pkCli_4951: bitstring = fail-any in
                        {4695}let v_4952: bool = (Sess_4820 = A) in
                        (
                            {4696}if v_4952 then
                            (
                                {4697}let pkSess_4953: bitstring = pub(skA) in
                                {4698}in(c, =GetEndpointRequest);
                                {4699}new SP_4954: bitstring;
                                {4700}new UP_4955: bitstring;
                                {4701}out(c, (GetEndpointResponse,pkSess_4953,SignAndEncrypt,SP_4954,UP_4955))
                            )
                            else
                                {4702}let v_4956: bool = (Sess_4820 = B) in
                                (
                                    {4703}if v_4956 then
                                    (
                                        {4704}let pkSess_4957: bitstring = pub(skB) in
                                        {4705}in(c, =GetEndpointRequest);
                                        {4706}new SP_4958: bitstring;
                                        {4707}new UP_4959: bitstring;
                                        {4708}out(c, (GetEndpointResponse,pkSess_4957,SignAndEncrypt,SP_4958,UP_4959))
                                    )
                                    else
                                        {4709}let v_4960: bool = (Sess_4820 = C) in
                                        (
                                            {4710}if v_4960 then
                                            (
                                                {4711}let pkSess_4961: bitstring = pub(skC) in
                                                {4712}in(c, =GetEndpointRequest);
                                                {4713}new SP_4962: bitstring;
                                                {4714}new UP_4963: bitstring;
                                                {4715}out(c, (GetEndpointResponse,pkSess_4961,SignAndEncrypt,SP_4962,UP_4963))
                                            )
                                            else
                                                {4716}let pkSess_4964: bitstring = pub(sk(Sess_4820)) in
                                                {4717}in(c, =GetEndpointRequest);
                                                {4718}new SP_4965: bitstring;
                                                {4719}new UP_4966: bitstring;
                                                {4720}out(c, (GetEndpointResponse,pkSess_4964,SignAndEncrypt,SP_4965,UP_4966))
                                        )
                                        else
                                            {4721}let pkSess_4967: bitstring = fail-any in
                                            {4722}in(c, =GetEndpointRequest);
                                            {4723}new SP_4968: bitstring;
                                            {4724}new UP_4969: bitstring;
                                            {4725}out(c, (GetEndpointResponse,pkSess_4967,SignAndEncrypt,SP_4968,UP_4969))
                                )
                                else
                                    {4726}let pkSess_4970: bitstring = fail-any in
                                    {4727}in(c, =GetEndpointRequest);
                                    {4728}new SP_4971: bitstring;
                                    {4729}new UP_4972: bitstring;
                                    {4730}out(c, (GetEndpointResponse,pkSess_4970,SignAndEncrypt,SP_4971,UP_4972))
                        )
                        else
                            {4731}let pkSess_4973: bitstring = fail-any in
                            {4732}in(c, =GetEndpointRequest);
                            {4733}new SP_4974: bitstring;
                            {4734}new UP_4975: bitstring;
                            {4735}out(c, (GetEndpointResponse,pkSess_4973,SignAndEncrypt,SP_4974,UP_4975))
            )
            else
                {4736}let pkCli_4976: bitstring = fail-any in
                {4737}let v_4977: bool = (Sess_4820 = A) in
                (
                    {4738}if v_4977 then
                    (
                        {4739}let pkSess_4978: bitstring = pub(skA) in
                        {4740}in(c, =GetEndpointRequest);
                        {4741}new SP_4979: bitstring;
                        {4742}new UP_4980: bitstring;
                        {4743}out(c, (GetEndpointResponse,pkSess_4978,SignAndEncrypt,SP_4979,UP_4980))
                    )
                    else
                        {4744}let v_4981: bool = (Sess_4820 = B) in
                        (
                            {4745}if v_4981 then
                            (
                                {4746}let pkSess_4982: bitstring = pub(skB) in
                                {4747}in(c, =GetEndpointRequest);
                                {4748}new SP_4983: bitstring;
                                {4749}new UP_4984: bitstring;
                                {4750}out(c, (GetEndpointResponse,pkSess_4982,SignAndEncrypt,SP_4983,UP_4984))
                            )
                            else
                                {4751}let v_4985: bool = (Sess_4820 = C) in
                                (
                                    {4752}if v_4985 then
                                    (
                                        {4753}let pkSess_4986: bitstring = pub(skC) in
                                        {4754}in(c, =GetEndpointRequest);
                                        {4755}new SP_4987: bitstring;
                                        {4756}new UP_4988: bitstring;
                                        {4757}out(c, (GetEndpointResponse,pkSess_4986,SignAndEncrypt,SP_4987,UP_4988))
                                    )
                                    else
                                        {4758}let pkSess_4989: bitstring = pub(sk(Sess_4820)) in
                                        {4759}in(c, =GetEndpointRequest);
                                        {4760}new SP_4990: bitstring;
                                        {4761}new UP_4991: bitstring;
                                        {4762}out(c, (GetEndpointResponse,pkSess_4989,SignAndEncrypt,SP_4990,UP_4991))
                                )
                                else
                                    {4763}let pkSess_4992: bitstring = fail-any in
                                    {4764}in(c, =GetEndpointRequest);
                                    {4765}new SP_4993: bitstring;
                                    {4766}new UP_4994: bitstring;
                                    {4767}out(c, (GetEndpointResponse,pkSess_4992,SignAndEncrypt,SP_4993,UP_4994))
                        )
                        else
                            {4768}let pkSess_4995: bitstring = fail-any in
                            {4769}in(c, =GetEndpointRequest);
                            {4770}new SP_4996: bitstring;
                            {4771}new UP_4997: bitstring;
                            {4772}out(c, (GetEndpointResponse,pkSess_4995,SignAndEncrypt,SP_4996,UP_4997))
                )
                else
                    {4773}let pkSess_4998: bitstring = fail-any in
                    {4774}in(c, =GetEndpointRequest);
                    {4775}new SP_4999: bitstring;
                    {4776}new UP_5000: bitstring;
                    {4777}out(c, (GetEndpointResponse,pkSess_4998,SignAndEncrypt,SP_4999,UP_5000))
        )
        else
            {4778}let v_5001: bool = (Disco_4819 = B) in
            (
                {4779}if v_5001 then
                (
                    {4780}let skDisco_5002: bitstring = skB in
                    {4781}let pkDisco_5003: bitstring = pub(skDisco_5002) in
                    {4782}let v_5004: bool = (Cli_4818 = A) in
                    (
                        {4783}if v_5004 then
                        (
                            {4784}let pkCli_5005: bitstring = pub(skA) in
                            {4785}let v_5006: bool = (Sess_4820 = A) in
                            (
                                {4786}if v_5006 then
                                (
                                    {4787}let pkSess_5007: bitstring = pub(skA) in
                                    {4788}in(c, =GetEndpointRequest);
                                    {4789}new SP_5008: bitstring;
                                    {4790}new UP_5009: bitstring;
                                    {4791}out(c, (GetEndpointResponse,pkSess_5007,SignAndEncrypt,SP_5008,UP_5009))
                                )
                                else
                                    {4792}let v_5010: bool = (Sess_4820 = B) in
                                    (
                                        {4793}if v_5010 then
                                        (
                                            {4794}let pkSess_5011: bitstring = pub(skB) in
                                            {4795}in(c, =GetEndpointRequest);
                                            {4796}new SP_5012: bitstring;
                                            {4797}new UP_5013: bitstring;
                                            {4798}out(c, (GetEndpointResponse,pkSess_5011,SignAndEncrypt,SP_5012,UP_5013))
                                        )
                                        else
                                            {4799}let v_5014: bool = (Sess_4820 = C) in
                                            (
                                                {4800}if v_5014 then
                                                (
                                                    {4801}let pkSess_5015: bitstring = pub(skC) in
                                                    {4802}in(c, =GetEndpointRequest);
                                                    {4803}new SP_5016: bitstring;
                                                    {4804}new UP_5017: bitstring;
                                                    {4805}out(c, (GetEndpointResponse,pkSess_5015,SignAndEncrypt,SP_5016,UP_5017))
                                                )
                                                else
                                                    {4806}let pkSess_5018: bitstring = pub(sk(Sess_4820)) in
                                                    {4807}in(c, =GetEndpointRequest);
                                                    {4808}new SP_5019: bitstring;
                                                    {4809}new UP_5020: bitstring;
                                                    {4810}out(c, (GetEndpointResponse,pkSess_5018,SignAndEncrypt,SP_5019,UP_5020))
                                            )
                                            else
                                                {4811}let pkSess_5021: bitstring = fail-any in
                                                {4812}in(c, =GetEndpointRequest);
                                                {4813}new SP_5022: bitstring;
                                                {4814}new UP_5023: bitstring;
                                                {4815}out(c, (GetEndpointResponse,pkSess_5021,SignAndEncrypt,SP_5022,UP_5023))
                                    )
                                    else
                                        {4816}let pkSess_5024: bitstring = fail-any in
                                        {4817}in(c, =GetEndpointRequest);
                                        {4818}new SP_5025: bitstring;
                                        {4819}new UP_5026: bitstring;
                                        {4820}out(c, (GetEndpointResponse,pkSess_5024,SignAndEncrypt,SP_5025,UP_5026))
                            )
                            else
                                {4821}let pkSess_5027: bitstring = fail-any in
                                {4822}in(c, =GetEndpointRequest);
                                {4823}new SP_5028: bitstring;
                                {4824}new UP_5029: bitstring;
                                {4825}out(c, (GetEndpointResponse,pkSess_5027,SignAndEncrypt,SP_5028,UP_5029))
                        )
                        else
                            {4826}let v_5030: bool = (Cli_4818 = B) in
                            (
                                {4827}if v_5030 then
                                (
                                    {4828}let pkCli_5031: bitstring = pub(skB) in
                                    {4829}let v_5032: bool = (Sess_4820 = A) in
                                    (
                                        {4830}if v_5032 then
                                        (
                                            {4831}let pkSess_5033: bitstring = pub(skA) in
                                            {4832}in(c, =GetEndpointRequest);
                                            {4833}new SP_5034: bitstring;
                                            {4834}new UP_5035: bitstring;
                                            {4835}out(c, (GetEndpointResponse,pkSess_5033,SignAndEncrypt,SP_5034,UP_5035))
                                        )
                                        else
                                            {4836}let v_5036: bool = (Sess_4820 = B) in
                                            (
                                                {4837}if v_5036 then
                                                (
                                                    {4838}let pkSess_5037: bitstring = pub(skB) in
                                                    {4839}in(c, =GetEndpointRequest);
                                                    {4840}new SP_5038: bitstring;
                                                    {4841}new UP_5039: bitstring;
                                                    {4842}out(c, (GetEndpointResponse,pkSess_5037,SignAndEncrypt,SP_5038,UP_5039))
                                                )
                                                else
                                                    {4843}let v_5040: bool = (Sess_4820 = C) in
                                                    (
                                                        {4844}if v_5040 then
                                                        (
                                                            {4845}let pkSess_5041: bitstring = pub(skC) in
                                                            {4846}in(c, =GetEndpointRequest);
                                                            {4847}new SP_5042: bitstring;
                                                            {4848}new UP_5043: bitstring;
                                                            {4849}out(c, (GetEndpointResponse,pkSess_5041,SignAndEncrypt,SP_5042,UP_5043))
                                                        )
                                                        else
                                                            {4850}let pkSess_5044: bitstring = pub(sk(Sess_4820)) in
                                                            {4851}in(c, =GetEndpointRequest);
                                                            {4852}new SP_5045: bitstring;
                                                            {4853}new UP_5046: bitstring;
                                                            {4854}out(c, (GetEndpointResponse,pkSess_5044,SignAndEncrypt,SP_5045,UP_5046))
                                                    )
                                                    else
                                                        {4855}let pkSess_5047: bitstring = fail-any in
                                                        {4856}in(c, =GetEndpointRequest);
                                                        {4857}new SP_5048: bitstring;
                                                        {4858}new UP_5049: bitstring;
                                                        {4859}out(c, (GetEndpointResponse,pkSess_5047,SignAndEncrypt,SP_5048,UP_5049))
                                            )
                                            else
                                                {4860}let pkSess_5050: bitstring = fail-any in
                                                {4861}in(c, =GetEndpointRequest);
                                                {4862}new SP_5051: bitstring;
                                                {4863}new UP_5052: bitstring;
                                                {4864}out(c, (GetEndpointResponse,pkSess_5050,SignAndEncrypt,SP_5051,UP_5052))
                                    )
                                    else
                                        {4865}let pkSess_5053: bitstring = fail-any in
                                        {4866}in(c, =GetEndpointRequest);
                                        {4867}new SP_5054: bitstring;
                                        {4868}new UP_5055: bitstring;
                                        {4869}out(c, (GetEndpointResponse,pkSess_5053,SignAndEncrypt,SP_5054,UP_5055))
                                )
                                else
                                    {4870}let v_5056: bool = (Cli_4818 = C) in
                                    (
                                        {4871}if v_5056 then
                                        (
                                            {4872}let pkCli_5057: bitstring = pub(skC) in
                                            {4873}let v_5058: bool = (Sess_4820 = A) in
                                            (
                                                {4874}if v_5058 then
                                                (
                                                    {4875}let pkSess_5059: bitstring = pub(skA) in
                                                    {4876}in(c, =GetEndpointRequest);
                                                    {4877}new SP_5060: bitstring;
                                                    {4878}new UP_5061: bitstring;
                                                    {4879}out(c, (GetEndpointResponse,pkSess_5059,SignAndEncrypt,SP_5060,UP_5061))
                                                )
                                                else
                                                    {4880}let v_5062: bool = (Sess_4820 = B) in
                                                    (
                                                        {4881}if v_5062 then
                                                        (
                                                            {4882}let pkSess_5063: bitstring = pub(skB) in
                                                            {4883}in(c, =GetEndpointRequest);
                                                            {4884}new SP_5064: bitstring;
                                                            {4885}new UP_5065: bitstring;
                                                            {4886}out(c, (GetEndpointResponse,pkSess_5063,SignAndEncrypt,SP_5064,UP_5065))
                                                        )
                                                        else
                                                            {4887}let v_5066: bool = (Sess_4820 = C) in
                                                            (
                                                                {4888}if v_5066 then
                                                                (
                                                                    {4889}let pkSess_5067: bitstring = pub(skC) in
                                                                    {4890}in(c, =GetEndpointRequest);
                                                                    {4891}new SP_5068: bitstring;
                                                                    {4892}new UP_5069: bitstring;
                                                                    {4893}out(c, (GetEndpointResponse,pkSess_5067,SignAndEncrypt,SP_5068,UP_5069))
                                                                )
                                                                else
                                                                    {4894}let pkSess_5070: bitstring = pub(sk(Sess_4820)) in
                                                                    {4895}in(c, =GetEndpointRequest);
                                                                    {4896}new SP_5071: bitstring;
                                                                    {4897}new UP_5072: bitstring;
                                                                    {4898}out(c, (GetEndpointResponse,pkSess_5070,SignAndEncrypt,SP_5071,UP_5072))
                                                            )
                                                            else
                                                                {4899}let pkSess_5073: bitstring = fail-any in
                                                                {4900}in(c, =GetEndpointRequest);
                                                                {4901}new SP_5074: bitstring;
                                                                {4902}new UP_5075: bitstring;
                                                                {4903}out(c, (GetEndpointResponse,pkSess_5073,SignAndEncrypt,SP_5074,UP_5075))
                                                    )
                                                    else
                                                        {4904}let pkSess_5076: bitstring = fail-any in
                                                        {4905}in(c, =GetEndpointRequest);
                                                        {4906}new SP_5077: bitstring;
                                                        {4907}new UP_5078: bitstring;
                                                        {4908}out(c, (GetEndpointResponse,pkSess_5076,SignAndEncrypt,SP_5077,UP_5078))
                                            )
                                            else
                                                {4909}let pkSess_5079: bitstring = fail-any in
                                                {4910}in(c, =GetEndpointRequest);
                                                {4911}new SP_5080: bitstring;
                                                {4912}new UP_5081: bitstring;
                                                {4913}out(c, (GetEndpointResponse,pkSess_5079,SignAndEncrypt,SP_5080,UP_5081))
                                        )
                                        else
                                            {4914}let pkCli_5082: bitstring = pub(sk(Cli_4818)) in
                                            {4915}let v_5083: bool = (Sess_4820 = A) in
                                            (
                                                {4916}if v_5083 then
                                                (
                                                    {4917}let pkSess_5084: bitstring = pub(skA) in
                                                    {4918}in(c, =GetEndpointRequest);
                                                    {4919}new SP_5085: bitstring;
                                                    {4920}new UP_5086: bitstring;
                                                    {4921}out(c, (GetEndpointResponse,pkSess_5084,SignAndEncrypt,SP_5085,UP_5086))
                                                )
                                                else
                                                    {4922}let v_5087: bool = (Sess_4820 = B) in
                                                    (
                                                        {4923}if v_5087 then
                                                        (
                                                            {4924}let pkSess_5088: bitstring = pub(skB) in
                                                            {4925}in(c, =GetEndpointRequest);
                                                            {4926}new SP_5089: bitstring;
                                                            {4927}new UP_5090: bitstring;
                                                            {4928}out(c, (GetEndpointResponse,pkSess_5088,SignAndEncrypt,SP_5089,UP_5090))
                                                        )
                                                        else
                                                            {4929}let v_5091: bool = (Sess_4820 = C) in
                                                            (
                                                                {4930}if v_5091 then
                                                                (
                                                                    {4931}let pkSess_5092: bitstring = pub(skC) in
                                                                    {4932}in(c, =GetEndpointRequest);
                                                                    {4933}new SP_5093: bitstring;
                                                                    {4934}new UP_5094: bitstring;
                                                                    {4935}out(c, (GetEndpointResponse,pkSess_5092,SignAndEncrypt,SP_5093,UP_5094))
                                                                )
                                                                else
                                                                    {4936}let pkSess_5095: bitstring = pub(sk(Sess_4820)) in
                                                                    {4937}in(c, =GetEndpointRequest);
                                                                    {4938}new SP_5096: bitstring;
                                                                    {4939}new UP_5097: bitstring;
                                                                    {4940}out(c, (GetEndpointResponse,pkSess_5095,SignAndEncrypt,SP_5096,UP_5097))
                                                            )
                                                            else
                                                                {4941}let pkSess_5098: bitstring = fail-any in
                                                                {4942}in(c, =GetEndpointRequest);
                                                                {4943}new SP_5099: bitstring;
                                                                {4944}new UP_5100: bitstring;
                                                                {4945}out(c, (GetEndpointResponse,pkSess_5098,SignAndEncrypt,SP_5099,UP_5100))
                                                    )
                                                    else
                                                        {4946}let pkSess_5101: bitstring = fail-any in
                                                        {4947}in(c, =GetEndpointRequest);
                                                        {4948}new SP_5102: bitstring;
                                                        {4949}new UP_5103: bitstring;
                                                        {4950}out(c, (GetEndpointResponse,pkSess_5101,SignAndEncrypt,SP_5102,UP_5103))
                                            )
                                            else
                                                {4951}let pkSess_5104: bitstring = fail-any in
                                                {4952}in(c, =GetEndpointRequest);
                                                {4953}new SP_5105: bitstring;
                                                {4954}new UP_5106: bitstring;
                                                {4955}out(c, (GetEndpointResponse,pkSess_5104,SignAndEncrypt,SP_5105,UP_5106))
                                    )
                                    else
                                        {4956}let pkCli_5107: bitstring = fail-any in
                                        {4957}let v_5108: bool = (Sess_4820 = A) in
                                        (
                                            {4958}if v_5108 then
                                            (
                                                {4959}let pkSess_5109: bitstring = pub(skA) in
                                                {4960}in(c, =GetEndpointRequest);
                                                {4961}new SP_5110: bitstring;
                                                {4962}new UP_5111: bitstring;
                                                {4963}out(c, (GetEndpointResponse,pkSess_5109,SignAndEncrypt,SP_5110,UP_5111))
                                            )
                                            else
                                                {4964}let v_5112: bool = (Sess_4820 = B) in
                                                (
                                                    {4965}if v_5112 then
                                                    (
                                                        {4966}let pkSess_5113: bitstring = pub(skB) in
                                                        {4967}in(c, =GetEndpointRequest);
                                                        {4968}new SP_5114: bitstring;
                                                        {4969}new UP_5115: bitstring;
                                                        {4970}out(c, (GetEndpointResponse,pkSess_5113,SignAndEncrypt,SP_5114,UP_5115))
                                                    )
                                                    else
                                                        {4971}let v_5116: bool = (Sess_4820 = C) in
                                                        (
                                                            {4972}if v_5116 then
                                                            (
                                                                {4973}let pkSess_5117: bitstring = pub(skC) in
                                                                {4974}in(c, =GetEndpointRequest);
                                                                {4975}new SP_5118: bitstring;
                                                                {4976}new UP_5119: bitstring;
                                                                {4977}out(c, (GetEndpointResponse,pkSess_5117,SignAndEncrypt,SP_5118,UP_5119))
                                                            )
                                                            else
                                                                {4978}let pkSess_5120: bitstring = pub(sk(Sess_4820)) in
                                                                {4979}in(c, =GetEndpointRequest);
                                                                {4980}new SP_5121: bitstring;
                                                                {4981}new UP_5122: bitstring;
                                                                {4982}out(c, (GetEndpointResponse,pkSess_5120,SignAndEncrypt,SP_5121,UP_5122))
                                                        )
                                                        else
                                                            {4983}let pkSess_5123: bitstring = fail-any in
                                                            {4984}in(c, =GetEndpointRequest);
                                                            {4985}new SP_5124: bitstring;
                                                            {4986}new UP_5125: bitstring;
                                                            {4987}out(c, (GetEndpointResponse,pkSess_5123,SignAndEncrypt,SP_5124,UP_5125))
                                                )
                                                else
                                                    {4988}let pkSess_5126: bitstring = fail-any in
                                                    {4989}in(c, =GetEndpointRequest);
                                                    {4990}new SP_5127: bitstring;
                                                    {4991}new UP_5128: bitstring;
                                                    {4992}out(c, (GetEndpointResponse,pkSess_5126,SignAndEncrypt,SP_5127,UP_5128))
                                        )
                                        else
                                            {4993}let pkSess_5129: bitstring = fail-any in
                                            {4994}in(c, =GetEndpointRequest);
                                            {4995}new SP_5130: bitstring;
                                            {4996}new UP_5131: bitstring;
                                            {4997}out(c, (GetEndpointResponse,pkSess_5129,SignAndEncrypt,SP_5130,UP_5131))
                            )
                            else
                                {4998}let pkCli_5132: bitstring = fail-any in
                                {4999}let v_5133: bool = (Sess_4820 = A) in
                                (
                                    {5000}if v_5133 then
                                    (
                                        {5001}let pkSess_5134: bitstring = pub(skA) in
                                        {5002}in(c, =GetEndpointRequest);
                                        {5003}new SP_5135: bitstring;
                                        {5004}new UP_5136: bitstring;
                                        {5005}out(c, (GetEndpointResponse,pkSess_5134,SignAndEncrypt,SP_5135,UP_5136))
                                    )
                                    else
                                        {5006}let v_5137: bool = (Sess_4820 = B) in
                                        (
                                            {5007}if v_5137 then
                                            (
                                                {5008}let pkSess_5138: bitstring = pub(skB) in
                                                {5009}in(c, =GetEndpointRequest);
                                                {5010}new SP_5139: bitstring;
                                                {5011}new UP_5140: bitstring;
                                                {5012}out(c, (GetEndpointResponse,pkSess_5138,SignAndEncrypt,SP_5139,UP_5140))
                                            )
                                            else
                                                {5013}let v_5141: bool = (Sess_4820 = C) in
                                                (
                                                    {5014}if v_5141 then
                                                    (
                                                        {5015}let pkSess_5142: bitstring = pub(skC) in
                                                        {5016}in(c, =GetEndpointRequest);
                                                        {5017}new SP_5143: bitstring;
                                                        {5018}new UP_5144: bitstring;
                                                        {5019}out(c, (GetEndpointResponse,pkSess_5142,SignAndEncrypt,SP_5143,UP_5144))
                                                    )
                                                    else
                                                        {5020}let pkSess_5145: bitstring = pub(sk(Sess_4820)) in
                                                        {5021}in(c, =GetEndpointRequest);
                                                        {5022}new SP_5146: bitstring;
                                                        {5023}new UP_5147: bitstring;
                                                        {5024}out(c, (GetEndpointResponse,pkSess_5145,SignAndEncrypt,SP_5146,UP_5147))
                                                )
                                                else
                                                    {5025}let pkSess_5148: bitstring = fail-any in
                                                    {5026}in(c, =GetEndpointRequest);
                                                    {5027}new SP_5149: bitstring;
                                                    {5028}new UP_5150: bitstring;
                                                    {5029}out(c, (GetEndpointResponse,pkSess_5148,SignAndEncrypt,SP_5149,UP_5150))
                                        )
                                        else
                                            {5030}let pkSess_5151: bitstring = fail-any in
                                            {5031}in(c, =GetEndpointRequest);
                                            {5032}new SP_5152: bitstring;
                                            {5033}new UP_5153: bitstring;
                                            {5034}out(c, (GetEndpointResponse,pkSess_5151,SignAndEncrypt,SP_5152,UP_5153))
                                )
                                else
                                    {5035}let pkSess_5154: bitstring = fail-any in
                                    {5036}in(c, =GetEndpointRequest);
                                    {5037}new SP_5155: bitstring;
                                    {5038}new UP_5156: bitstring;
                                    {5039}out(c, (GetEndpointResponse,pkSess_5154,SignAndEncrypt,SP_5155,UP_5156))
                    )
                    else
                        {5040}let pkCli_5157: bitstring = fail-any in
                        {5041}let v_5158: bool = (Sess_4820 = A) in
                        (
                            {5042}if v_5158 then
                            (
                                {5043}let pkSess_5159: bitstring = pub(skA) in
                                {5044}in(c, =GetEndpointRequest);
                                {5045}new SP_5160: bitstring;
                                {5046}new UP_5161: bitstring;
                                {5047}out(c, (GetEndpointResponse,pkSess_5159,SignAndEncrypt,SP_5160,UP_5161))
                            )
                            else
                                {5048}let v_5162: bool = (Sess_4820 = B) in
                                (
                                    {5049}if v_5162 then
                                    (
                                        {5050}let pkSess_5163: bitstring = pub(skB) in
                                        {5051}in(c, =GetEndpointRequest);
                                        {5052}new SP_5164: bitstring;
                                        {5053}new UP_5165: bitstring;
                                        {5054}out(c, (GetEndpointResponse,pkSess_5163,SignAndEncrypt,SP_5164,UP_5165))
                                    )
                                    else
                                        {5055}let v_5166: bool = (Sess_4820 = C) in
                                        (
                                            {5056}if v_5166 then
                                            (
                                                {5057}let pkSess_5167: bitstring = pub(skC) in
                                                {5058}in(c, =GetEndpointRequest);
                                                {5059}new SP_5168: bitstring;
                                                {5060}new UP_5169: bitstring;
                                                {5061}out(c, (GetEndpointResponse,pkSess_5167,SignAndEncrypt,SP_5168,UP_5169))
                                            )
                                            else
                                                {5062}let pkSess_5170: bitstring = pub(sk(Sess_4820)) in
                                                {5063}in(c, =GetEndpointRequest);
                                                {5064}new SP_5171: bitstring;
                                                {5065}new UP_5172: bitstring;
                                                {5066}out(c, (GetEndpointResponse,pkSess_5170,SignAndEncrypt,SP_5171,UP_5172))
                                        )
                                        else
                                            {5067}let pkSess_5173: bitstring = fail-any in
                                            {5068}in(c, =GetEndpointRequest);
                                            {5069}new SP_5174: bitstring;
                                            {5070}new UP_5175: bitstring;
                                            {5071}out(c, (GetEndpointResponse,pkSess_5173,SignAndEncrypt,SP_5174,UP_5175))
                                )
                                else
                                    {5072}let pkSess_5176: bitstring = fail-any in
                                    {5073}in(c, =GetEndpointRequest);
                                    {5074}new SP_5177: bitstring;
                                    {5075}new UP_5178: bitstring;
                                    {5076}out(c, (GetEndpointResponse,pkSess_5176,SignAndEncrypt,SP_5177,UP_5178))
                        )
                        else
                            {5077}let pkSess_5179: bitstring = fail-any in
                            {5078}in(c, =GetEndpointRequest);
                            {5079}new SP_5180: bitstring;
                            {5080}new UP_5181: bitstring;
                            {5081}out(c, (GetEndpointResponse,pkSess_5179,SignAndEncrypt,SP_5180,UP_5181))
                )
                else
                    {5082}let =true = (Disco_4819 = C) in
                    (
                        {5083}let skDisco_5182: bitstring = skC in
                        {5084}let pkDisco_5183: bitstring = pub(skDisco_5182) in
                        {5085}let v_5184: bool = (Cli_4818 = A) in
                        (
                            {5086}if v_5184 then
                            (
                                {5087}let pkCli_5185: bitstring = pub(skA) in
                                {5088}let v_5186: bool = (Sess_4820 = A) in
                                (
                                    {5089}if v_5186 then
                                    (
                                        {5090}let pkSess_5187: bitstring = pub(skA) in
                                        {5091}in(c, =GetEndpointRequest);
                                        {5092}new SP_5188: bitstring;
                                        {5093}new UP_5189: bitstring;
                                        {5094}out(c, (GetEndpointResponse,pkSess_5187,SignAndEncrypt,SP_5188,UP_5189))
                                    )
                                    else
                                        {5095}let v_5190: bool = (Sess_4820 = B) in
                                        (
                                            {5096}if v_5190 then
                                            (
                                                {5097}let pkSess_5191: bitstring = pub(skB) in
                                                {5098}in(c, =GetEndpointRequest);
                                                {5099}new SP_5192: bitstring;
                                                {5100}new UP_5193: bitstring;
                                                {5101}out(c, (GetEndpointResponse,pkSess_5191,SignAndEncrypt,SP_5192,UP_5193))
                                            )
                                            else
                                                {5102}let v_5194: bool = (Sess_4820 = C) in
                                                (
                                                    {5103}if v_5194 then
                                                    (
                                                        {5104}let pkSess_5195: bitstring = pub(skC) in
                                                        {5105}in(c, =GetEndpointRequest);
                                                        {5106}new SP_5196: bitstring;
                                                        {5107}new UP_5197: bitstring;
                                                        {5108}out(c, (GetEndpointResponse,pkSess_5195,SignAndEncrypt,SP_5196,UP_5197))
                                                    )
                                                    else
                                                        {5109}let pkSess_5198: bitstring = pub(sk(Sess_4820)) in
                                                        {5110}in(c, =GetEndpointRequest);
                                                        {5111}new SP_5199: bitstring;
                                                        {5112}new UP_5200: bitstring;
                                                        {5113}out(c, (GetEndpointResponse,pkSess_5198,SignAndEncrypt,SP_5199,UP_5200))
                                                )
                                                else
                                                    {5114}let pkSess_5201: bitstring = fail-any in
                                                    {5115}in(c, =GetEndpointRequest);
                                                    {5116}new SP_5202: bitstring;
                                                    {5117}new UP_5203: bitstring;
                                                    {5118}out(c, (GetEndpointResponse,pkSess_5201,SignAndEncrypt,SP_5202,UP_5203))
                                        )
                                        else
                                            {5119}let pkSess_5204: bitstring = fail-any in
                                            {5120}in(c, =GetEndpointRequest);
                                            {5121}new SP_5205: bitstring;
                                            {5122}new UP_5206: bitstring;
                                            {5123}out(c, (GetEndpointResponse,pkSess_5204,SignAndEncrypt,SP_5205,UP_5206))
                                )
                                else
                                    {5124}let pkSess_5207: bitstring = fail-any in
                                    {5125}in(c, =GetEndpointRequest);
                                    {5126}new SP_5208: bitstring;
                                    {5127}new UP_5209: bitstring;
                                    {5128}out(c, (GetEndpointResponse,pkSess_5207,SignAndEncrypt,SP_5208,UP_5209))
                            )
                            else
                                {5129}let v_5210: bool = (Cli_4818 = B) in
                                (
                                    {5130}if v_5210 then
                                    (
                                        {5131}let pkCli_5211: bitstring = pub(skB) in
                                        {5132}let v_5212: bool = (Sess_4820 = A) in
                                        (
                                            {5133}if v_5212 then
                                            (
                                                {5134}let pkSess_5213: bitstring = pub(skA) in
                                                {5135}in(c, =GetEndpointRequest);
                                                {5136}new SP_5214: bitstring;
                                                {5137}new UP_5215: bitstring;
                                                {5138}out(c, (GetEndpointResponse,pkSess_5213,SignAndEncrypt,SP_5214,UP_5215))
                                            )
                                            else
                                                {5139}let v_5216: bool = (Sess_4820 = B) in
                                                (
                                                    {5140}if v_5216 then
                                                    (
                                                        {5141}let pkSess_5217: bitstring = pub(skB) in
                                                        {5142}in(c, =GetEndpointRequest);
                                                        {5143}new SP_5218: bitstring;
                                                        {5144}new UP_5219: bitstring;
                                                        {5145}out(c, (GetEndpointResponse,pkSess_5217,SignAndEncrypt,SP_5218,UP_5219))
                                                    )
                                                    else
                                                        {5146}let v_5220: bool = (Sess_4820 = C) in
                                                        (
                                                            {5147}if v_5220 then
                                                            (
                                                                {5148}let pkSess_5221: bitstring = pub(skC) in
                                                                {5149}in(c, =GetEndpointRequest);
                                                                {5150}new SP_5222: bitstring;
                                                                {5151}new UP_5223: bitstring;
                                                                {5152}out(c, (GetEndpointResponse,pkSess_5221,SignAndEncrypt,SP_5222,UP_5223))
                                                            )
                                                            else
                                                                {5153}let pkSess_5224: bitstring = pub(sk(Sess_4820)) in
                                                                {5154}in(c, =GetEndpointRequest);
                                                                {5155}new SP_5225: bitstring;
                                                                {5156}new UP_5226: bitstring;
                                                                {5157}out(c, (GetEndpointResponse,pkSess_5224,SignAndEncrypt,SP_5225,UP_5226))
                                                        )
                                                        else
                                                            {5158}let pkSess_5227: bitstring = fail-any in
                                                            {5159}in(c, =GetEndpointRequest);
                                                            {5160}new SP_5228: bitstring;
                                                            {5161}new UP_5229: bitstring;
                                                            {5162}out(c, (GetEndpointResponse,pkSess_5227,SignAndEncrypt,SP_5228,UP_5229))
                                                )
                                                else
                                                    {5163}let pkSess_5230: bitstring = fail-any in
                                                    {5164}in(c, =GetEndpointRequest);
                                                    {5165}new SP_5231: bitstring;
                                                    {5166}new UP_5232: bitstring;
                                                    {5167}out(c, (GetEndpointResponse,pkSess_5230,SignAndEncrypt,SP_5231,UP_5232))
                                        )
                                        else
                                            {5168}let pkSess_5233: bitstring = fail-any in
                                            {5169}in(c, =GetEndpointRequest);
                                            {5170}new SP_5234: bitstring;
                                            {5171}new UP_5235: bitstring;
                                            {5172}out(c, (GetEndpointResponse,pkSess_5233,SignAndEncrypt,SP_5234,UP_5235))
                                    )
                                    else
                                        {5173}let v_5236: bool = (Cli_4818 = C) in
                                        (
                                            {5174}if v_5236 then
                                            (
                                                {5175}let pkCli_5237: bitstring = pub(skC) in
                                                {5176}let v_5238: bool = (Sess_4820 = A) in
                                                (
                                                    {5177}if v_5238 then
                                                    (
                                                        {5178}let pkSess_5239: bitstring = pub(skA) in
                                                        {5179}in(c, =GetEndpointRequest);
                                                        {5180}new SP_5240: bitstring;
                                                        {5181}new UP_5241: bitstring;
                                                        {5182}out(c, (GetEndpointResponse,pkSess_5239,SignAndEncrypt,SP_5240,UP_5241))
                                                    )
                                                    else
                                                        {5183}let v_5242: bool = (Sess_4820 = B) in
                                                        (
                                                            {5184}if v_5242 then
                                                            (
                                                                {5185}let pkSess_5243: bitstring = pub(skB) in
                                                                {5186}in(c, =GetEndpointRequest);
                                                                {5187}new SP_5244: bitstring;
                                                                {5188}new UP_5245: bitstring;
                                                                {5189}out(c, (GetEndpointResponse,pkSess_5243,SignAndEncrypt,SP_5244,UP_5245))
                                                            )
                                                            else
                                                                {5190}let v_5246: bool = (Sess_4820 = C) in
                                                                (
                                                                    {5191}if v_5246 then
                                                                    (
                                                                        {5192}let pkSess_5247: bitstring = pub(skC) in
                                                                        {5193}in(c, =GetEndpointRequest);
                                                                        {5194}new SP_5248: bitstring;
                                                                        {5195}new UP_5249: bitstring;
                                                                        {5196}out(c, (GetEndpointResponse,pkSess_5247,SignAndEncrypt,SP_5248,UP_5249))
                                                                    )
                                                                    else
                                                                        {5197}let pkSess_5250: bitstring = pub(sk(Sess_4820)) in
                                                                        {5198}in(c, =GetEndpointRequest);
                                                                        {5199}new SP_5251: bitstring;
                                                                        {5200}new UP_5252: bitstring;
                                                                        {5201}out(c, (GetEndpointResponse,pkSess_5250,SignAndEncrypt,SP_5251,UP_5252))
                                                                )
                                                                else
                                                                    {5202}let pkSess_5253: bitstring = fail-any in
                                                                    {5203}in(c, =GetEndpointRequest);
                                                                    {5204}new SP_5254: bitstring;
                                                                    {5205}new UP_5255: bitstring;
                                                                    {5206}out(c, (GetEndpointResponse,pkSess_5253,SignAndEncrypt,SP_5254,UP_5255))
                                                        )
                                                        else
                                                            {5207}let pkSess_5256: bitstring = fail-any in
                                                            {5208}in(c, =GetEndpointRequest);
                                                            {5209}new SP_5257: bitstring;
                                                            {5210}new UP_5258: bitstring;
                                                            {5211}out(c, (GetEndpointResponse,pkSess_5256,SignAndEncrypt,SP_5257,UP_5258))
                                                )
                                                else
                                                    {5212}let pkSess_5259: bitstring = fail-any in
                                                    {5213}in(c, =GetEndpointRequest);
                                                    {5214}new SP_5260: bitstring;
                                                    {5215}new UP_5261: bitstring;
                                                    {5216}out(c, (GetEndpointResponse,pkSess_5259,SignAndEncrypt,SP_5260,UP_5261))
                                            )
                                            else
                                                {5217}let pkCli_5262: bitstring = pub(sk(Cli_4818)) in
                                                {5218}let v_5263: bool = (Sess_4820 = A) in
                                                (
                                                    {5219}if v_5263 then
                                                    (
                                                        {5220}let pkSess_5264: bitstring = pub(skA) in
                                                        {5221}in(c, =GetEndpointRequest);
                                                        {5222}new SP_5265: bitstring;
                                                        {5223}new UP_5266: bitstring;
                                                        {5224}out(c, (GetEndpointResponse,pkSess_5264,SignAndEncrypt,SP_5265,UP_5266))
                                                    )
                                                    else
                                                        {5225}let v_5267: bool = (Sess_4820 = B) in
                                                        (
                                                            {5226}if v_5267 then
                                                            (
                                                                {5227}let pkSess_5268: bitstring = pub(skB) in
                                                                {5228}in(c, =GetEndpointRequest);
                                                                {5229}new SP_5269: bitstring;
                                                                {5230}new UP_5270: bitstring;
                                                                {5231}out(c, (GetEndpointResponse,pkSess_5268,SignAndEncrypt,SP_5269,UP_5270))
                                                            )
                                                            else
                                                                {5232}let v_5271: bool = (Sess_4820 = C) in
                                                                (
                                                                    {5233}if v_5271 then
                                                                    (
                                                                        {5234}let pkSess_5272: bitstring = pub(skC) in
                                                                        {5235}in(c, =GetEndpointRequest);
                                                                        {5236}new SP_5273: bitstring;
                                                                        {5237}new UP_5274: bitstring;
                                                                        {5238}out(c, (GetEndpointResponse,pkSess_5272,SignAndEncrypt,SP_5273,UP_5274))
                                                                    )
                                                                    else
                                                                        {5239}let pkSess_5275: bitstring = pub(sk(Sess_4820)) in
                                                                        {5240}in(c, =GetEndpointRequest);
                                                                        {5241}new SP_5276: bitstring;
                                                                        {5242}new UP_5277: bitstring;
                                                                        {5243}out(c, (GetEndpointResponse,pkSess_5275,SignAndEncrypt,SP_5276,UP_5277))
                                                                )
                                                                else
                                                                    {5244}let pkSess_5278: bitstring = fail-any in
                                                                    {5245}in(c, =GetEndpointRequest);
                                                                    {5246}new SP_5279: bitstring;
                                                                    {5247}new UP_5280: bitstring;
                                                                    {5248}out(c, (GetEndpointResponse,pkSess_5278,SignAndEncrypt,SP_5279,UP_5280))
                                                        )
                                                        else
                                                            {5249}let pkSess_5281: bitstring = fail-any in
                                                            {5250}in(c, =GetEndpointRequest);
                                                            {5251}new SP_5282: bitstring;
                                                            {5252}new UP_5283: bitstring;
                                                            {5253}out(c, (GetEndpointResponse,pkSess_5281,SignAndEncrypt,SP_5282,UP_5283))
                                                )
                                                else
                                                    {5254}let pkSess_5284: bitstring = fail-any in
                                                    {5255}in(c, =GetEndpointRequest);
                                                    {5256}new SP_5285: bitstring;
                                                    {5257}new UP_5286: bitstring;
                                                    {5258}out(c, (GetEndpointResponse,pkSess_5284,SignAndEncrypt,SP_5285,UP_5286))
                                        )
                                        else
                                            {5259}let pkCli_5287: bitstring = fail-any in
                                            {5260}let v_5288: bool = (Sess_4820 = A) in
                                            (
                                                {5261}if v_5288 then
                                                (
                                                    {5262}let pkSess_5289: bitstring = pub(skA) in
                                                    {5263}in(c, =GetEndpointRequest);
                                                    {5264}new SP_5290: bitstring;
                                                    {5265}new UP_5291: bitstring;
                                                    {5266}out(c, (GetEndpointResponse,pkSess_5289,SignAndEncrypt,SP_5290,UP_5291))
                                                )
                                                else
                                                    {5267}let v_5292: bool = (Sess_4820 = B) in
                                                    (
                                                        {5268}if v_5292 then
                                                        (
                                                            {5269}let pkSess_5293: bitstring = pub(skB) in
                                                            {5270}in(c, =GetEndpointRequest);
                                                            {5271}new SP_5294: bitstring;
                                                            {5272}new UP_5295: bitstring;
                                                            {5273}out(c, (GetEndpointResponse,pkSess_5293,SignAndEncrypt,SP_5294,UP_5295))
                                                        )
                                                        else
                                                            {5274}let v_5296: bool = (Sess_4820 = C) in
                                                            (
                                                                {5275}if v_5296 then
                                                                (
                                                                    {5276}let pkSess_5297: bitstring = pub(skC) in
                                                                    {5277}in(c, =GetEndpointRequest);
                                                                    {5278}new SP_5298: bitstring;
                                                                    {5279}new UP_5299: bitstring;
                                                                    {5280}out(c, (GetEndpointResponse,pkSess_5297,SignAndEncrypt,SP_5298,UP_5299))
                                                                )
                                                                else
                                                                    {5281}let pkSess_5300: bitstring = pub(sk(Sess_4820)) in
                                                                    {5282}in(c, =GetEndpointRequest);
                                                                    {5283}new SP_5301: bitstring;
                                                                    {5284}new UP_5302: bitstring;
                                                                    {5285}out(c, (GetEndpointResponse,pkSess_5300,SignAndEncrypt,SP_5301,UP_5302))
                                                            )
                                                            else
                                                                {5286}let pkSess_5303: bitstring = fail-any in
                                                                {5287}in(c, =GetEndpointRequest);
                                                                {5288}new SP_5304: bitstring;
                                                                {5289}new UP_5305: bitstring;
                                                                {5290}out(c, (GetEndpointResponse,pkSess_5303,SignAndEncrypt,SP_5304,UP_5305))
                                                    )
                                                    else
                                                        {5291}let pkSess_5306: bitstring = fail-any in
                                                        {5292}in(c, =GetEndpointRequest);
                                                        {5293}new SP_5307: bitstring;
                                                        {5294}new UP_5308: bitstring;
                                                        {5295}out(c, (GetEndpointResponse,pkSess_5306,SignAndEncrypt,SP_5307,UP_5308))
                                            )
                                            else
                                                {5296}let pkSess_5309: bitstring = fail-any in
                                                {5297}in(c, =GetEndpointRequest);
                                                {5298}new SP_5310: bitstring;
                                                {5299}new UP_5311: bitstring;
                                                {5300}out(c, (GetEndpointResponse,pkSess_5309,SignAndEncrypt,SP_5310,UP_5311))
                                )
                                else
                                    {5301}let pkCli_5312: bitstring = fail-any in
                                    {5302}let v_5313: bool = (Sess_4820 = A) in
                                    (
                                        {5303}if v_5313 then
                                        (
                                            {5304}let pkSess_5314: bitstring = pub(skA) in
                                            {5305}in(c, =GetEndpointRequest);
                                            {5306}new SP_5315: bitstring;
                                            {5307}new UP_5316: bitstring;
                                            {5308}out(c, (GetEndpointResponse,pkSess_5314,SignAndEncrypt,SP_5315,UP_5316))
                                        )
                                        else
                                            {5309}let v_5317: bool = (Sess_4820 = B) in
                                            (
                                                {5310}if v_5317 then
                                                (
                                                    {5311}let pkSess_5318: bitstring = pub(skB) in
                                                    {5312}in(c, =GetEndpointRequest);
                                                    {5313}new SP_5319: bitstring;
                                                    {5314}new UP_5320: bitstring;
                                                    {5315}out(c, (GetEndpointResponse,pkSess_5318,SignAndEncrypt,SP_5319,UP_5320))
                                                )
                                                else
                                                    {5316}let v_5321: bool = (Sess_4820 = C) in
                                                    (
                                                        {5317}if v_5321 then
                                                        (
                                                            {5318}let pkSess_5322: bitstring = pub(skC) in
                                                            {5319}in(c, =GetEndpointRequest);
                                                            {5320}new SP_5323: bitstring;
                                                            {5321}new UP_5324: bitstring;
                                                            {5322}out(c, (GetEndpointResponse,pkSess_5322,SignAndEncrypt,SP_5323,UP_5324))
                                                        )
                                                        else
                                                            {5323}let pkSess_5325: bitstring = pub(sk(Sess_4820)) in
                                                            {5324}in(c, =GetEndpointRequest);
                                                            {5325}new SP_5326: bitstring;
                                                            {5326}new UP_5327: bitstring;
                                                            {5327}out(c, (GetEndpointResponse,pkSess_5325,SignAndEncrypt,SP_5326,UP_5327))
                                                    )
                                                    else
                                                        {5328}let pkSess_5328: bitstring = fail-any in
                                                        {5329}in(c, =GetEndpointRequest);
                                                        {5330}new SP_5329: bitstring;
                                                        {5331}new UP_5330: bitstring;
                                                        {5332}out(c, (GetEndpointResponse,pkSess_5328,SignAndEncrypt,SP_5329,UP_5330))
                                            )
                                            else
                                                {5333}let pkSess_5331: bitstring = fail-any in
                                                {5334}in(c, =GetEndpointRequest);
                                                {5335}new SP_5332: bitstring;
                                                {5336}new UP_5333: bitstring;
                                                {5337}out(c, (GetEndpointResponse,pkSess_5331,SignAndEncrypt,SP_5332,UP_5333))
                                    )
                                    else
                                        {5338}let pkSess_5334: bitstring = fail-any in
                                        {5339}in(c, =GetEndpointRequest);
                                        {5340}new SP_5335: bitstring;
                                        {5341}new UP_5336: bitstring;
                                        {5342}out(c, (GetEndpointResponse,pkSess_5334,SignAndEncrypt,SP_5335,UP_5336))
                        )
                        else
                            {5343}let pkCli_5337: bitstring = fail-any in
                            {5344}let v_5338: bool = (Sess_4820 = A) in
                            (
                                {5345}if v_5338 then
                                (
                                    {5346}let pkSess_5339: bitstring = pub(skA) in
                                    {5347}in(c, =GetEndpointRequest);
                                    {5348}new SP_5340: bitstring;
                                    {5349}new UP_5341: bitstring;
                                    {5350}out(c, (GetEndpointResponse,pkSess_5339,SignAndEncrypt,SP_5340,UP_5341))
                                )
                                else
                                    {5351}let v_5342: bool = (Sess_4820 = B) in
                                    (
                                        {5352}if v_5342 then
                                        (
                                            {5353}let pkSess_5343: bitstring = pub(skB) in
                                            {5354}in(c, =GetEndpointRequest);
                                            {5355}new SP_5344: bitstring;
                                            {5356}new UP_5345: bitstring;
                                            {5357}out(c, (GetEndpointResponse,pkSess_5343,SignAndEncrypt,SP_5344,UP_5345))
                                        )
                                        else
                                            {5358}let v_5346: bool = (Sess_4820 = C) in
                                            (
                                                {5359}if v_5346 then
                                                (
                                                    {5360}let pkSess_5347: bitstring = pub(skC) in
                                                    {5361}in(c, =GetEndpointRequest);
                                                    {5362}new SP_5348: bitstring;
                                                    {5363}new UP_5349: bitstring;
                                                    {5364}out(c, (GetEndpointResponse,pkSess_5347,SignAndEncrypt,SP_5348,UP_5349))
                                                )
                                                else
                                                    {5365}let pkSess_5350: bitstring = pub(sk(Sess_4820)) in
                                                    {5366}in(c, =GetEndpointRequest);
                                                    {5367}new SP_5351: bitstring;
                                                    {5368}new UP_5352: bitstring;
                                                    {5369}out(c, (GetEndpointResponse,pkSess_5350,SignAndEncrypt,SP_5351,UP_5352))
                                            )
                                            else
                                                {5370}let pkSess_5353: bitstring = fail-any in
                                                {5371}in(c, =GetEndpointRequest);
                                                {5372}new SP_5354: bitstring;
                                                {5373}new UP_5355: bitstring;
                                                {5374}out(c, (GetEndpointResponse,pkSess_5353,SignAndEncrypt,SP_5354,UP_5355))
                                    )
                                    else
                                        {5375}let pkSess_5356: bitstring = fail-any in
                                        {5376}in(c, =GetEndpointRequest);
                                        {5377}new SP_5357: bitstring;
                                        {5378}new UP_5358: bitstring;
                                        {5379}out(c, (GetEndpointResponse,pkSess_5356,SignAndEncrypt,SP_5357,UP_5358))
                            )
                            else
                                {5380}let pkSess_5359: bitstring = fail-any in
                                {5381}in(c, =GetEndpointRequest);
                                {5382}new SP_5360: bitstring;
                                {5383}new UP_5361: bitstring;
                                {5384}out(c, (GetEndpointResponse,pkSess_5359,SignAndEncrypt,SP_5360,UP_5361))
                    )
                    else
                        {5385}let skDisco_5362: bitstring = fail-any in
                        {5386}let pkDisco_5363: bitstring = pub(skDisco_5362) in
                        {5387}let v_5364: bool = (Cli_4818 = A) in
                        (
                            {5388}if v_5364 then
                            (
                                {5389}let pkCli_5365: bitstring = pub(skA) in
                                {5390}let v_5366: bool = (Sess_4820 = A) in
                                (
                                    {5391}if v_5366 then
                                    (
                                        {5392}let pkSess_5367: bitstring = pub(skA) in
                                        {5393}in(c, =GetEndpointRequest);
                                        {5394}new SP_5368: bitstring;
                                        {5395}new UP_5369: bitstring;
                                        {5396}out(c, (GetEndpointResponse,pkSess_5367,SignAndEncrypt,SP_5368,UP_5369))
                                    )
                                    else
                                        {5397}let v_5370: bool = (Sess_4820 = B) in
                                        (
                                            {5398}if v_5370 then
                                            (
                                                {5399}let pkSess_5371: bitstring = pub(skB) in
                                                {5400}in(c, =GetEndpointRequest);
                                                {5401}new SP_5372: bitstring;
                                                {5402}new UP_5373: bitstring;
                                                {5403}out(c, (GetEndpointResponse,pkSess_5371,SignAndEncrypt,SP_5372,UP_5373))
                                            )
                                            else
                                                {5404}let v_5374: bool = (Sess_4820 = C) in
                                                (
                                                    {5405}if v_5374 then
                                                    (
                                                        {5406}let pkSess_5375: bitstring = pub(skC) in
                                                        {5407}in(c, =GetEndpointRequest);
                                                        {5408}new SP_5376: bitstring;
                                                        {5409}new UP_5377: bitstring;
                                                        {5410}out(c, (GetEndpointResponse,pkSess_5375,SignAndEncrypt,SP_5376,UP_5377))
                                                    )
                                                    else
                                                        {5411}let pkSess_5378: bitstring = pub(sk(Sess_4820)) in
                                                        {5412}in(c, =GetEndpointRequest);
                                                        {5413}new SP_5379: bitstring;
                                                        {5414}new UP_5380: bitstring;
                                                        {5415}out(c, (GetEndpointResponse,pkSess_5378,SignAndEncrypt,SP_5379,UP_5380))
                                                )
                                                else
                                                    {5416}let pkSess_5381: bitstring = fail-any in
                                                    {5417}in(c, =GetEndpointRequest);
                                                    {5418}new SP_5382: bitstring;
                                                    {5419}new UP_5383: bitstring;
                                                    {5420}out(c, (GetEndpointResponse,pkSess_5381,SignAndEncrypt,SP_5382,UP_5383))
                                        )
                                        else
                                            {5421}let pkSess_5384: bitstring = fail-any in
                                            {5422}in(c, =GetEndpointRequest);
                                            {5423}new SP_5385: bitstring;
                                            {5424}new UP_5386: bitstring;
                                            {5425}out(c, (GetEndpointResponse,pkSess_5384,SignAndEncrypt,SP_5385,UP_5386))
                                )
                                else
                                    {5426}let pkSess_5387: bitstring = fail-any in
                                    {5427}in(c, =GetEndpointRequest);
                                    {5428}new SP_5388: bitstring;
                                    {5429}new UP_5389: bitstring;
                                    {5430}out(c, (GetEndpointResponse,pkSess_5387,SignAndEncrypt,SP_5388,UP_5389))
                            )
                            else
                                {5431}let v_5390: bool = (Cli_4818 = B) in
                                (
                                    {5432}if v_5390 then
                                    (
                                        {5433}let pkCli_5391: bitstring = pub(skB) in
                                        {5434}let v_5392: bool = (Sess_4820 = A) in
                                        (
                                            {5435}if v_5392 then
                                            (
                                                {5436}let pkSess_5393: bitstring = pub(skA) in
                                                {5437}in(c, =GetEndpointRequest);
                                                {5438}new SP_5394: bitstring;
                                                {5439}new UP_5395: bitstring;
                                                {5440}out(c, (GetEndpointResponse,pkSess_5393,SignAndEncrypt,SP_5394,UP_5395))
                                            )
                                            else
                                                {5441}let v_5396: bool = (Sess_4820 = B) in
                                                (
                                                    {5442}if v_5396 then
                                                    (
                                                        {5443}let pkSess_5397: bitstring = pub(skB) in
                                                        {5444}in(c, =GetEndpointRequest);
                                                        {5445}new SP_5398: bitstring;
                                                        {5446}new UP_5399: bitstring;
                                                        {5447}out(c, (GetEndpointResponse,pkSess_5397,SignAndEncrypt,SP_5398,UP_5399))
                                                    )
                                                    else
                                                        {5448}let v_5400: bool = (Sess_4820 = C) in
                                                        (
                                                            {5449}if v_5400 then
                                                            (
                                                                {5450}let pkSess_5401: bitstring = pub(skC) in
                                                                {5451}in(c, =GetEndpointRequest);
                                                                {5452}new SP_5402: bitstring;
                                                                {5453}new UP_5403: bitstring;
                                                                {5454}out(c, (GetEndpointResponse,pkSess_5401,SignAndEncrypt,SP_5402,UP_5403))
                                                            )
                                                            else
                                                                {5455}let pkSess_5404: bitstring = pub(sk(Sess_4820)) in
                                                                {5456}in(c, =GetEndpointRequest);
                                                                {5457}new SP_5405: bitstring;
                                                                {5458}new UP_5406: bitstring;
                                                                {5459}out(c, (GetEndpointResponse,pkSess_5404,SignAndEncrypt,SP_5405,UP_5406))
                                                        )
                                                        else
                                                            {5460}let pkSess_5407: bitstring = fail-any in
                                                            {5461}in(c, =GetEndpointRequest);
                                                            {5462}new SP_5408: bitstring;
                                                            {5463}new UP_5409: bitstring;
                                                            {5464}out(c, (GetEndpointResponse,pkSess_5407,SignAndEncrypt,SP_5408,UP_5409))
                                                )
                                                else
                                                    {5465}let pkSess_5410: bitstring = fail-any in
                                                    {5466}in(c, =GetEndpointRequest);
                                                    {5467}new SP_5411: bitstring;
                                                    {5468}new UP_5412: bitstring;
                                                    {5469}out(c, (GetEndpointResponse,pkSess_5410,SignAndEncrypt,SP_5411,UP_5412))
                                        )
                                        else
                                            {5470}let pkSess_5413: bitstring = fail-any in
                                            {5471}in(c, =GetEndpointRequest);
                                            {5472}new SP_5414: bitstring;
                                            {5473}new UP_5415: bitstring;
                                            {5474}out(c, (GetEndpointResponse,pkSess_5413,SignAndEncrypt,SP_5414,UP_5415))
                                    )
                                    else
                                        {5475}let v_5416: bool = (Cli_4818 = C) in
                                        (
                                            {5476}if v_5416 then
                                            (
                                                {5477}let pkCli_5417: bitstring = pub(skC) in
                                                {5478}let v_5418: bool = (Sess_4820 = A) in
                                                (
                                                    {5479}if v_5418 then
                                                    (
                                                        {5480}let pkSess_5419: bitstring = pub(skA) in
                                                        {5481}in(c, =GetEndpointRequest);
                                                        {5482}new SP_5420: bitstring;
                                                        {5483}new UP_5421: bitstring;
                                                        {5484}out(c, (GetEndpointResponse,pkSess_5419,SignAndEncrypt,SP_5420,UP_5421))
                                                    )
                                                    else
                                                        {5485}let v_5422: bool = (Sess_4820 = B) in
                                                        (
                                                            {5486}if v_5422 then
                                                            (
                                                                {5487}let pkSess_5423: bitstring = pub(skB) in
                                                                {5488}in(c, =GetEndpointRequest);
                                                                {5489}new SP_5424: bitstring;
                                                                {5490}new UP_5425: bitstring;
                                                                {5491}out(c, (GetEndpointResponse,pkSess_5423,SignAndEncrypt,SP_5424,UP_5425))
                                                            )
                                                            else
                                                                {5492}let v_5426: bool = (Sess_4820 = C) in
                                                                (
                                                                    {5493}if v_5426 then
                                                                    (
                                                                        {5494}let pkSess_5427: bitstring = pub(skC) in
                                                                        {5495}in(c, =GetEndpointRequest);
                                                                        {5496}new SP_5428: bitstring;
                                                                        {5497}new UP_5429: bitstring;
                                                                        {5498}out(c, (GetEndpointResponse,pkSess_5427,SignAndEncrypt,SP_5428,UP_5429))
                                                                    )
                                                                    else
                                                                        {5499}let pkSess_5430: bitstring = pub(sk(Sess_4820)) in
                                                                        {5500}in(c, =GetEndpointRequest);
                                                                        {5501}new SP_5431: bitstring;
                                                                        {5502}new UP_5432: bitstring;
                                                                        {5503}out(c, (GetEndpointResponse,pkSess_5430,SignAndEncrypt,SP_5431,UP_5432))
                                                                )
                                                                else
                                                                    {5504}let pkSess_5433: bitstring = fail-any in
                                                                    {5505}in(c, =GetEndpointRequest);
                                                                    {5506}new SP_5434: bitstring;
                                                                    {5507}new UP_5435: bitstring;
                                                                    {5508}out(c, (GetEndpointResponse,pkSess_5433,SignAndEncrypt,SP_5434,UP_5435))
                                                        )
                                                        else
                                                            {5509}let pkSess_5436: bitstring = fail-any in
                                                            {5510}in(c, =GetEndpointRequest);
                                                            {5511}new SP_5437: bitstring;
                                                            {5512}new UP_5438: bitstring;
                                                            {5513}out(c, (GetEndpointResponse,pkSess_5436,SignAndEncrypt,SP_5437,UP_5438))
                                                )
                                                else
                                                    {5514}let pkSess_5439: bitstring = fail-any in
                                                    {5515}in(c, =GetEndpointRequest);
                                                    {5516}new SP_5440: bitstring;
                                                    {5517}new UP_5441: bitstring;
                                                    {5518}out(c, (GetEndpointResponse,pkSess_5439,SignAndEncrypt,SP_5440,UP_5441))
                                            )
                                            else
                                                {5519}let pkCli_5442: bitstring = pub(sk(Cli_4818)) in
                                                {5520}let v_5443: bool = (Sess_4820 = A) in
                                                (
                                                    {5521}if v_5443 then
                                                    (
                                                        {5522}let pkSess_5444: bitstring = pub(skA) in
                                                        {5523}in(c, =GetEndpointRequest);
                                                        {5524}new SP_5445: bitstring;
                                                        {5525}new UP_5446: bitstring;
                                                        {5526}out(c, (GetEndpointResponse,pkSess_5444,SignAndEncrypt,SP_5445,UP_5446))
                                                    )
                                                    else
                                                        {5527}let v_5447: bool = (Sess_4820 = B) in
                                                        (
                                                            {5528}if v_5447 then
                                                            (
                                                                {5529}let pkSess_5448: bitstring = pub(skB) in
                                                                {5530}in(c, =GetEndpointRequest);
                                                                {5531}new SP_5449: bitstring;
                                                                {5532}new UP_5450: bitstring;
                                                                {5533}out(c, (GetEndpointResponse,pkSess_5448,SignAndEncrypt,SP_5449,UP_5450))
                                                            )
                                                            else
                                                                {5534}let v_5451: bool = (Sess_4820 = C) in
                                                                (
                                                                    {5535}if v_5451 then
                                                                    (
                                                                        {5536}let pkSess_5452: bitstring = pub(skC) in
                                                                        {5537}in(c, =GetEndpointRequest);
                                                                        {5538}new SP_5453: bitstring;
                                                                        {5539}new UP_5454: bitstring;
                                                                        {5540}out(c, (GetEndpointResponse,pkSess_5452,SignAndEncrypt,SP_5453,UP_5454))
                                                                    )
                                                                    else
                                                                        {5541}let pkSess_5455: bitstring = pub(sk(Sess_4820)) in
                                                                        {5542}in(c, =GetEndpointRequest);
                                                                        {5543}new SP_5456: bitstring;
                                                                        {5544}new UP_5457: bitstring;
                                                                        {5545}out(c, (GetEndpointResponse,pkSess_5455,SignAndEncrypt,SP_5456,UP_5457))
                                                                )
                                                                else
                                                                    {5546}let pkSess_5458: bitstring = fail-any in
                                                                    {5547}in(c, =GetEndpointRequest);
                                                                    {5548}new SP_5459: bitstring;
                                                                    {5549}new UP_5460: bitstring;
                                                                    {5550}out(c, (GetEndpointResponse,pkSess_5458,SignAndEncrypt,SP_5459,UP_5460))
                                                        )
                                                        else
                                                            {5551}let pkSess_5461: bitstring = fail-any in
                                                            {5552}in(c, =GetEndpointRequest);
                                                            {5553}new SP_5462: bitstring;
                                                            {5554}new UP_5463: bitstring;
                                                            {5555}out(c, (GetEndpointResponse,pkSess_5461,SignAndEncrypt,SP_5462,UP_5463))
                                                )
                                                else
                                                    {5556}let pkSess_5464: bitstring = fail-any in
                                                    {5557}in(c, =GetEndpointRequest);
                                                    {5558}new SP_5465: bitstring;
                                                    {5559}new UP_5466: bitstring;
                                                    {5560}out(c, (GetEndpointResponse,pkSess_5464,SignAndEncrypt,SP_5465,UP_5466))
                                        )
                                        else
                                            {5561}let pkCli_5467: bitstring = fail-any in
                                            {5562}let v_5468: bool = (Sess_4820 = A) in
                                            (
                                                {5563}if v_5468 then
                                                (
                                                    {5564}let pkSess_5469: bitstring = pub(skA) in
                                                    {5565}in(c, =GetEndpointRequest);
                                                    {5566}new SP_5470: bitstring;
                                                    {5567}new UP_5471: bitstring;
                                                    {5568}out(c, (GetEndpointResponse,pkSess_5469,SignAndEncrypt,SP_5470,UP_5471))
                                                )
                                                else
                                                    {5569}let v_5472: bool = (Sess_4820 = B) in
                                                    (
                                                        {5570}if v_5472 then
                                                        (
                                                            {5571}let pkSess_5473: bitstring = pub(skB) in
                                                            {5572}in(c, =GetEndpointRequest);
                                                            {5573}new SP_5474: bitstring;
                                                            {5574}new UP_5475: bitstring;
                                                            {5575}out(c, (GetEndpointResponse,pkSess_5473,SignAndEncrypt,SP_5474,UP_5475))
                                                        )
                                                        else
                                                            {5576}let v_5476: bool = (Sess_4820 = C) in
                                                            (
                                                                {5577}if v_5476 then
                                                                (
                                                                    {5578}let pkSess_5477: bitstring = pub(skC) in
                                                                    {5579}in(c, =GetEndpointRequest);
                                                                    {5580}new SP_5478: bitstring;
                                                                    {5581}new UP_5479: bitstring;
                                                                    {5582}out(c, (GetEndpointResponse,pkSess_5477,SignAndEncrypt,SP_5478,UP_5479))
                                                                )
                                                                else
                                                                    {5583}let pkSess_5480: bitstring = pub(sk(Sess_4820)) in
                                                                    {5584}in(c, =GetEndpointRequest);
                                                                    {5585}new SP_5481: bitstring;
                                                                    {5586}new UP_5482: bitstring;
                                                                    {5587}out(c, (GetEndpointResponse,pkSess_5480,SignAndEncrypt,SP_5481,UP_5482))
                                                            )
                                                            else
                                                                {5588}let pkSess_5483: bitstring = fail-any in
                                                                {5589}in(c, =GetEndpointRequest);
                                                                {5590}new SP_5484: bitstring;
                                                                {5591}new UP_5485: bitstring;
                                                                {5592}out(c, (GetEndpointResponse,pkSess_5483,SignAndEncrypt,SP_5484,UP_5485))
                                                    )
                                                    else
                                                        {5593}let pkSess_5486: bitstring = fail-any in
                                                        {5594}in(c, =GetEndpointRequest);
                                                        {5595}new SP_5487: bitstring;
                                                        {5596}new UP_5488: bitstring;
                                                        {5597}out(c, (GetEndpointResponse,pkSess_5486,SignAndEncrypt,SP_5487,UP_5488))
                                            )
                                            else
                                                {5598}let pkSess_5489: bitstring = fail-any in
                                                {5599}in(c, =GetEndpointRequest);
                                                {5600}new SP_5490: bitstring;
                                                {5601}new UP_5491: bitstring;
                                                {5602}out(c, (GetEndpointResponse,pkSess_5489,SignAndEncrypt,SP_5490,UP_5491))
                                )
                                else
                                    {5603}let pkCli_5492: bitstring = fail-any in
                                    {5604}let v_5493: bool = (Sess_4820 = A) in
                                    (
                                        {5605}if v_5493 then
                                        (
                                            {5606}let pkSess_5494: bitstring = pub(skA) in
                                            {5607}in(c, =GetEndpointRequest);
                                            {5608}new SP_5495: bitstring;
                                            {5609}new UP_5496: bitstring;
                                            {5610}out(c, (GetEndpointResponse,pkSess_5494,SignAndEncrypt,SP_5495,UP_5496))
                                        )
                                        else
                                            {5611}let v_5497: bool = (Sess_4820 = B) in
                                            (
                                                {5612}if v_5497 then
                                                (
                                                    {5613}let pkSess_5498: bitstring = pub(skB) in
                                                    {5614}in(c, =GetEndpointRequest);
                                                    {5615}new SP_5499: bitstring;
                                                    {5616}new UP_5500: bitstring;
                                                    {5617}out(c, (GetEndpointResponse,pkSess_5498,SignAndEncrypt,SP_5499,UP_5500))
                                                )
                                                else
                                                    {5618}let v_5501: bool = (Sess_4820 = C) in
                                                    (
                                                        {5619}if v_5501 then
                                                        (
                                                            {5620}let pkSess_5502: bitstring = pub(skC) in
                                                            {5621}in(c, =GetEndpointRequest);
                                                            {5622}new SP_5503: bitstring;
                                                            {5623}new UP_5504: bitstring;
                                                            {5624}out(c, (GetEndpointResponse,pkSess_5502,SignAndEncrypt,SP_5503,UP_5504))
                                                        )
                                                        else
                                                            {5625}let pkSess_5505: bitstring = pub(sk(Sess_4820)) in
                                                            {5626}in(c, =GetEndpointRequest);
                                                            {5627}new SP_5506: bitstring;
                                                            {5628}new UP_5507: bitstring;
                                                            {5629}out(c, (GetEndpointResponse,pkSess_5505,SignAndEncrypt,SP_5506,UP_5507))
                                                    )
                                                    else
                                                        {5630}let pkSess_5508: bitstring = fail-any in
                                                        {5631}in(c, =GetEndpointRequest);
                                                        {5632}new SP_5509: bitstring;
                                                        {5633}new UP_5510: bitstring;
                                                        {5634}out(c, (GetEndpointResponse,pkSess_5508,SignAndEncrypt,SP_5509,UP_5510))
                                            )
                                            else
                                                {5635}let pkSess_5511: bitstring = fail-any in
                                                {5636}in(c, =GetEndpointRequest);
                                                {5637}new SP_5512: bitstring;
                                                {5638}new UP_5513: bitstring;
                                                {5639}out(c, (GetEndpointResponse,pkSess_5511,SignAndEncrypt,SP_5512,UP_5513))
                                    )
                                    else
                                        {5640}let pkSess_5514: bitstring = fail-any in
                                        {5641}in(c, =GetEndpointRequest);
                                        {5642}new SP_5515: bitstring;
                                        {5643}new UP_5516: bitstring;
                                        {5644}out(c, (GetEndpointResponse,pkSess_5514,SignAndEncrypt,SP_5515,UP_5516))
                        )
                        else
                            {5645}let pkCli_5517: bitstring = fail-any in
                            {5646}let v_5518: bool = (Sess_4820 = A) in
                            (
                                {5647}if v_5518 then
                                (
                                    {5648}let pkSess_5519: bitstring = pub(skA) in
                                    {5649}in(c, =GetEndpointRequest);
                                    {5650}new SP_5520: bitstring;
                                    {5651}new UP_5521: bitstring;
                                    {5652}out(c, (GetEndpointResponse,pkSess_5519,SignAndEncrypt,SP_5520,UP_5521))
                                )
                                else
                                    {5653}let v_5522: bool = (Sess_4820 = B) in
                                    (
                                        {5654}if v_5522 then
                                        (
                                            {5655}let pkSess_5523: bitstring = pub(skB) in
                                            {5656}in(c, =GetEndpointRequest);
                                            {5657}new SP_5524: bitstring;
                                            {5658}new UP_5525: bitstring;
                                            {5659}out(c, (GetEndpointResponse,pkSess_5523,SignAndEncrypt,SP_5524,UP_5525))
                                        )
                                        else
                                            {5660}let v_5526: bool = (Sess_4820 = C) in
                                            (
                                                {5661}if v_5526 then
                                                (
                                                    {5662}let pkSess_5527: bitstring = pub(skC) in
                                                    {5663}in(c, =GetEndpointRequest);
                                                    {5664}new SP_5528: bitstring;
                                                    {5665}new UP_5529: bitstring;
                                                    {5666}out(c, (GetEndpointResponse,pkSess_5527,SignAndEncrypt,SP_5528,UP_5529))
                                                )
                                                else
                                                    {5667}let pkSess_5530: bitstring = pub(sk(Sess_4820)) in
                                                    {5668}in(c, =GetEndpointRequest);
                                                    {5669}new SP_5531: bitstring;
                                                    {5670}new UP_5532: bitstring;
                                                    {5671}out(c, (GetEndpointResponse,pkSess_5530,SignAndEncrypt,SP_5531,UP_5532))
                                            )
                                            else
                                                {5672}let pkSess_5533: bitstring = fail-any in
                                                {5673}in(c, =GetEndpointRequest);
                                                {5674}new SP_5534: bitstring;
                                                {5675}new UP_5535: bitstring;
                                                {5676}out(c, (GetEndpointResponse,pkSess_5533,SignAndEncrypt,SP_5534,UP_5535))
                                    )
                                    else
                                        {5677}let pkSess_5536: bitstring = fail-any in
                                        {5678}in(c, =GetEndpointRequest);
                                        {5679}new SP_5537: bitstring;
                                        {5680}new UP_5538: bitstring;
                                        {5681}out(c, (GetEndpointResponse,pkSess_5536,SignAndEncrypt,SP_5537,UP_5538))
                            )
                            else
                                {5682}let pkSess_5539: bitstring = fail-any in
                                {5683}in(c, =GetEndpointRequest);
                                {5684}new SP_5540: bitstring;
                                {5685}new UP_5541: bitstring;
                                {5686}out(c, (GetEndpointResponse,pkSess_5539,SignAndEncrypt,SP_5540,UP_5541))
            )
            else
                {5687}let skDisco_5542: bitstring = fail-any in
                {5688}let pkDisco_5543: bitstring = pub(skDisco_5542) in
                {5689}let v_5544: bool = (Cli_4818 = A) in
                (
                    {5690}if v_5544 then
                    (
                        {5691}let pkCli_5545: bitstring = pub(skA) in
                        {5692}let v_5546: bool = (Sess_4820 = A) in
                        (
                            {5693}if v_5546 then
                            (
                                {5694}let pkSess_5547: bitstring = pub(skA) in
                                {5695}in(c, =GetEndpointRequest);
                                {5696}new SP_5548: bitstring;
                                {5697}new UP_5549: bitstring;
                                {5698}out(c, (GetEndpointResponse,pkSess_5547,SignAndEncrypt,SP_5548,UP_5549))
                            )
                            else
                                {5699}let v_5550: bool = (Sess_4820 = B) in
                                (
                                    {5700}if v_5550 then
                                    (
                                        {5701}let pkSess_5551: bitstring = pub(skB) in
                                        {5702}in(c, =GetEndpointRequest);
                                        {5703}new SP_5552: bitstring;
                                        {5704}new UP_5553: bitstring;
                                        {5705}out(c, (GetEndpointResponse,pkSess_5551,SignAndEncrypt,SP_5552,UP_5553))
                                    )
                                    else
                                        {5706}let v_5554: bool = (Sess_4820 = C) in
                                        (
                                            {5707}if v_5554 then
                                            (
                                                {5708}let pkSess_5555: bitstring = pub(skC) in
                                                {5709}in(c, =GetEndpointRequest);
                                                {5710}new SP_5556: bitstring;
                                                {5711}new UP_5557: bitstring;
                                                {5712}out(c, (GetEndpointResponse,pkSess_5555,SignAndEncrypt,SP_5556,UP_5557))
                                            )
                                            else
                                                {5713}let pkSess_5558: bitstring = pub(sk(Sess_4820)) in
                                                {5714}in(c, =GetEndpointRequest);
                                                {5715}new SP_5559: bitstring;
                                                {5716}new UP_5560: bitstring;
                                                {5717}out(c, (GetEndpointResponse,pkSess_5558,SignAndEncrypt,SP_5559,UP_5560))
                                        )
                                        else
                                            {5718}let pkSess_5561: bitstring = fail-any in
                                            {5719}in(c, =GetEndpointRequest);
                                            {5720}new SP_5562: bitstring;
                                            {5721}new UP_5563: bitstring;
                                            {5722}out(c, (GetEndpointResponse,pkSess_5561,SignAndEncrypt,SP_5562,UP_5563))
                                )
                                else
                                    {5723}let pkSess_5564: bitstring = fail-any in
                                    {5724}in(c, =GetEndpointRequest);
                                    {5725}new SP_5565: bitstring;
                                    {5726}new UP_5566: bitstring;
                                    {5727}out(c, (GetEndpointResponse,pkSess_5564,SignAndEncrypt,SP_5565,UP_5566))
                        )
                        else
                            {5728}let pkSess_5567: bitstring = fail-any in
                            {5729}in(c, =GetEndpointRequest);
                            {5730}new SP_5568: bitstring;
                            {5731}new UP_5569: bitstring;
                            {5732}out(c, (GetEndpointResponse,pkSess_5567,SignAndEncrypt,SP_5568,UP_5569))
                    )
                    else
                        {5733}let v_5570: bool = (Cli_4818 = B) in
                        (
                            {5734}if v_5570 then
                            (
                                {5735}let pkCli_5571: bitstring = pub(skB) in
                                {5736}let v_5572: bool = (Sess_4820 = A) in
                                (
                                    {5737}if v_5572 then
                                    (
                                        {5738}let pkSess_5573: bitstring = pub(skA) in
                                        {5739}in(c, =GetEndpointRequest);
                                        {5740}new SP_5574: bitstring;
                                        {5741}new UP_5575: bitstring;
                                        {5742}out(c, (GetEndpointResponse,pkSess_5573,SignAndEncrypt,SP_5574,UP_5575))
                                    )
                                    else
                                        {5743}let v_5576: bool = (Sess_4820 = B) in
                                        (
                                            {5744}if v_5576 then
                                            (
                                                {5745}let pkSess_5577: bitstring = pub(skB) in
                                                {5746}in(c, =GetEndpointRequest);
                                                {5747}new SP_5578: bitstring;
                                                {5748}new UP_5579: bitstring;
                                                {5749}out(c, (GetEndpointResponse,pkSess_5577,SignAndEncrypt,SP_5578,UP_5579))
                                            )
                                            else
                                                {5750}let v_5580: bool = (Sess_4820 = C) in
                                                (
                                                    {5751}if v_5580 then
                                                    (
                                                        {5752}let pkSess_5581: bitstring = pub(skC) in
                                                        {5753}in(c, =GetEndpointRequest);
                                                        {5754}new SP_5582: bitstring;
                                                        {5755}new UP_5583: bitstring;
                                                        {5756}out(c, (GetEndpointResponse,pkSess_5581,SignAndEncrypt,SP_5582,UP_5583))
                                                    )
                                                    else
                                                        {5757}let pkSess_5584: bitstring = pub(sk(Sess_4820)) in
                                                        {5758}in(c, =GetEndpointRequest);
                                                        {5759}new SP_5585: bitstring;
                                                        {5760}new UP_5586: bitstring;
                                                        {5761}out(c, (GetEndpointResponse,pkSess_5584,SignAndEncrypt,SP_5585,UP_5586))
                                                )
                                                else
                                                    {5762}let pkSess_5587: bitstring = fail-any in
                                                    {5763}in(c, =GetEndpointRequest);
                                                    {5764}new SP_5588: bitstring;
                                                    {5765}new UP_5589: bitstring;
                                                    {5766}out(c, (GetEndpointResponse,pkSess_5587,SignAndEncrypt,SP_5588,UP_5589))
                                        )
                                        else
                                            {5767}let pkSess_5590: bitstring = fail-any in
                                            {5768}in(c, =GetEndpointRequest);
                                            {5769}new SP_5591: bitstring;
                                            {5770}new UP_5592: bitstring;
                                            {5771}out(c, (GetEndpointResponse,pkSess_5590,SignAndEncrypt,SP_5591,UP_5592))
                                )
                                else
                                    {5772}let pkSess_5593: bitstring = fail-any in
                                    {5773}in(c, =GetEndpointRequest);
                                    {5774}new SP_5594: bitstring;
                                    {5775}new UP_5595: bitstring;
                                    {5776}out(c, (GetEndpointResponse,pkSess_5593,SignAndEncrypt,SP_5594,UP_5595))
                            )
                            else
                                {5777}let v_5596: bool = (Cli_4818 = C) in
                                (
                                    {5778}if v_5596 then
                                    (
                                        {5779}let pkCli_5597: bitstring = pub(skC) in
                                        {5780}let v_5598: bool = (Sess_4820 = A) in
                                        (
                                            {5781}if v_5598 then
                                            (
                                                {5782}let pkSess_5599: bitstring = pub(skA) in
                                                {5783}in(c, =GetEndpointRequest);
                                                {5784}new SP_5600: bitstring;
                                                {5785}new UP_5601: bitstring;
                                                {5786}out(c, (GetEndpointResponse,pkSess_5599,SignAndEncrypt,SP_5600,UP_5601))
                                            )
                                            else
                                                {5787}let v_5602: bool = (Sess_4820 = B) in
                                                (
                                                    {5788}if v_5602 then
                                                    (
                                                        {5789}let pkSess_5603: bitstring = pub(skB) in
                                                        {5790}in(c, =GetEndpointRequest);
                                                        {5791}new SP_5604: bitstring;
                                                        {5792}new UP_5605: bitstring;
                                                        {5793}out(c, (GetEndpointResponse,pkSess_5603,SignAndEncrypt,SP_5604,UP_5605))
                                                    )
                                                    else
                                                        {5794}let v_5606: bool = (Sess_4820 = C) in
                                                        (
                                                            {5795}if v_5606 then
                                                            (
                                                                {5796}let pkSess_5607: bitstring = pub(skC) in
                                                                {5797}in(c, =GetEndpointRequest);
                                                                {5798}new SP_5608: bitstring;
                                                                {5799}new UP_5609: bitstring;
                                                                {5800}out(c, (GetEndpointResponse,pkSess_5607,SignAndEncrypt,SP_5608,UP_5609))
                                                            )
                                                            else
                                                                {5801}let pkSess_5610: bitstring = pub(sk(Sess_4820)) in
                                                                {5802}in(c, =GetEndpointRequest);
                                                                {5803}new SP_5611: bitstring;
                                                                {5804}new UP_5612: bitstring;
                                                                {5805}out(c, (GetEndpointResponse,pkSess_5610,SignAndEncrypt,SP_5611,UP_5612))
                                                        )
                                                        else
                                                            {5806}let pkSess_5613: bitstring = fail-any in
                                                            {5807}in(c, =GetEndpointRequest);
                                                            {5808}new SP_5614: bitstring;
                                                            {5809}new UP_5615: bitstring;
                                                            {5810}out(c, (GetEndpointResponse,pkSess_5613,SignAndEncrypt,SP_5614,UP_5615))
                                                )
                                                else
                                                    {5811}let pkSess_5616: bitstring = fail-any in
                                                    {5812}in(c, =GetEndpointRequest);
                                                    {5813}new SP_5617: bitstring;
                                                    {5814}new UP_5618: bitstring;
                                                    {5815}out(c, (GetEndpointResponse,pkSess_5616,SignAndEncrypt,SP_5617,UP_5618))
                                        )
                                        else
                                            {5816}let pkSess_5619: bitstring = fail-any in
                                            {5817}in(c, =GetEndpointRequest);
                                            {5818}new SP_5620: bitstring;
                                            {5819}new UP_5621: bitstring;
                                            {5820}out(c, (GetEndpointResponse,pkSess_5619,SignAndEncrypt,SP_5620,UP_5621))
                                    )
                                    else
                                        {5821}let pkCli_5622: bitstring = pub(sk(Cli_4818)) in
                                        {5822}let v_5623: bool = (Sess_4820 = A) in
                                        (
                                            {5823}if v_5623 then
                                            (
                                                {5824}let pkSess_5624: bitstring = pub(skA) in
                                                {5825}in(c, =GetEndpointRequest);
                                                {5826}new SP_5625: bitstring;
                                                {5827}new UP_5626: bitstring;
                                                {5828}out(c, (GetEndpointResponse,pkSess_5624,SignAndEncrypt,SP_5625,UP_5626))
                                            )
                                            else
                                                {5829}let v_5627: bool = (Sess_4820 = B) in
                                                (
                                                    {5830}if v_5627 then
                                                    (
                                                        {5831}let pkSess_5628: bitstring = pub(skB) in
                                                        {5832}in(c, =GetEndpointRequest);
                                                        {5833}new SP_5629: bitstring;
                                                        {5834}new UP_5630: bitstring;
                                                        {5835}out(c, (GetEndpointResponse,pkSess_5628,SignAndEncrypt,SP_5629,UP_5630))
                                                    )
                                                    else
                                                        {5836}let v_5631: bool = (Sess_4820 = C) in
                                                        (
                                                            {5837}if v_5631 then
                                                            (
                                                                {5838}let pkSess_5632: bitstring = pub(skC) in
                                                                {5839}in(c, =GetEndpointRequest);
                                                                {5840}new SP_5633: bitstring;
                                                                {5841}new UP_5634: bitstring;
                                                                {5842}out(c, (GetEndpointResponse,pkSess_5632,SignAndEncrypt,SP_5633,UP_5634))
                                                            )
                                                            else
                                                                {5843}let pkSess_5635: bitstring = pub(sk(Sess_4820)) in
                                                                {5844}in(c, =GetEndpointRequest);
                                                                {5845}new SP_5636: bitstring;
                                                                {5846}new UP_5637: bitstring;
                                                                {5847}out(c, (GetEndpointResponse,pkSess_5635,SignAndEncrypt,SP_5636,UP_5637))
                                                        )
                                                        else
                                                            {5848}let pkSess_5638: bitstring = fail-any in
                                                            {5849}in(c, =GetEndpointRequest);
                                                            {5850}new SP_5639: bitstring;
                                                            {5851}new UP_5640: bitstring;
                                                            {5852}out(c, (GetEndpointResponse,pkSess_5638,SignAndEncrypt,SP_5639,UP_5640))
                                                )
                                                else
                                                    {5853}let pkSess_5641: bitstring = fail-any in
                                                    {5854}in(c, =GetEndpointRequest);
                                                    {5855}new SP_5642: bitstring;
                                                    {5856}new UP_5643: bitstring;
                                                    {5857}out(c, (GetEndpointResponse,pkSess_5641,SignAndEncrypt,SP_5642,UP_5643))
                                        )
                                        else
                                            {5858}let pkSess_5644: bitstring = fail-any in
                                            {5859}in(c, =GetEndpointRequest);
                                            {5860}new SP_5645: bitstring;
                                            {5861}new UP_5646: bitstring;
                                            {5862}out(c, (GetEndpointResponse,pkSess_5644,SignAndEncrypt,SP_5645,UP_5646))
                                )
                                else
                                    {5863}let pkCli_5647: bitstring = fail-any in
                                    {5864}let v_5648: bool = (Sess_4820 = A) in
                                    (
                                        {5865}if v_5648 then
                                        (
                                            {5866}let pkSess_5649: bitstring = pub(skA) in
                                            {5867}in(c, =GetEndpointRequest);
                                            {5868}new SP_5650: bitstring;
                                            {5869}new UP_5651: bitstring;
                                            {5870}out(c, (GetEndpointResponse,pkSess_5649,SignAndEncrypt,SP_5650,UP_5651))
                                        )
                                        else
                                            {5871}let v_5652: bool = (Sess_4820 = B) in
                                            (
                                                {5872}if v_5652 then
                                                (
                                                    {5873}let pkSess_5653: bitstring = pub(skB) in
                                                    {5874}in(c, =GetEndpointRequest);
                                                    {5875}new SP_5654: bitstring;
                                                    {5876}new UP_5655: bitstring;
                                                    {5877}out(c, (GetEndpointResponse,pkSess_5653,SignAndEncrypt,SP_5654,UP_5655))
                                                )
                                                else
                                                    {5878}let v_5656: bool = (Sess_4820 = C) in
                                                    (
                                                        {5879}if v_5656 then
                                                        (
                                                            {5880}let pkSess_5657: bitstring = pub(skC) in
                                                            {5881}in(c, =GetEndpointRequest);
                                                            {5882}new SP_5658: bitstring;
                                                            {5883}new UP_5659: bitstring;
                                                            {5884}out(c, (GetEndpointResponse,pkSess_5657,SignAndEncrypt,SP_5658,UP_5659))
                                                        )
                                                        else
                                                            {5885}let pkSess_5660: bitstring = pub(sk(Sess_4820)) in
                                                            {5886}in(c, =GetEndpointRequest);
                                                            {5887}new SP_5661: bitstring;
                                                            {5888}new UP_5662: bitstring;
                                                            {5889}out(c, (GetEndpointResponse,pkSess_5660,SignAndEncrypt,SP_5661,UP_5662))
                                                    )
                                                    else
                                                        {5890}let pkSess_5663: bitstring = fail-any in
                                                        {5891}in(c, =GetEndpointRequest);
                                                        {5892}new SP_5664: bitstring;
                                                        {5893}new UP_5665: bitstring;
                                                        {5894}out(c, (GetEndpointResponse,pkSess_5663,SignAndEncrypt,SP_5664,UP_5665))
                                            )
                                            else
                                                {5895}let pkSess_5666: bitstring = fail-any in
                                                {5896}in(c, =GetEndpointRequest);
                                                {5897}new SP_5667: bitstring;
                                                {5898}new UP_5668: bitstring;
                                                {5899}out(c, (GetEndpointResponse,pkSess_5666,SignAndEncrypt,SP_5667,UP_5668))
                                    )
                                    else
                                        {5900}let pkSess_5669: bitstring = fail-any in
                                        {5901}in(c, =GetEndpointRequest);
                                        {5902}new SP_5670: bitstring;
                                        {5903}new UP_5671: bitstring;
                                        {5904}out(c, (GetEndpointResponse,pkSess_5669,SignAndEncrypt,SP_5670,UP_5671))
                        )
                        else
                            {5905}let pkCli_5672: bitstring = fail-any in
                            {5906}let v_5673: bool = (Sess_4820 = A) in
                            (
                                {5907}if v_5673 then
                                (
                                    {5908}let pkSess_5674: bitstring = pub(skA) in
                                    {5909}in(c, =GetEndpointRequest);
                                    {5910}new SP_5675: bitstring;
                                    {5911}new UP_5676: bitstring;
                                    {5912}out(c, (GetEndpointResponse,pkSess_5674,SignAndEncrypt,SP_5675,UP_5676))
                                )
                                else
                                    {5913}let v_5677: bool = (Sess_4820 = B) in
                                    (
                                        {5914}if v_5677 then
                                        (
                                            {5915}let pkSess_5678: bitstring = pub(skB) in
                                            {5916}in(c, =GetEndpointRequest);
                                            {5917}new SP_5679: bitstring;
                                            {5918}new UP_5680: bitstring;
                                            {5919}out(c, (GetEndpointResponse,pkSess_5678,SignAndEncrypt,SP_5679,UP_5680))
                                        )
                                        else
                                            {5920}let v_5681: bool = (Sess_4820 = C) in
                                            (
                                                {5921}if v_5681 then
                                                (
                                                    {5922}let pkSess_5682: bitstring = pub(skC) in
                                                    {5923}in(c, =GetEndpointRequest);
                                                    {5924}new SP_5683: bitstring;
                                                    {5925}new UP_5684: bitstring;
                                                    {5926}out(c, (GetEndpointResponse,pkSess_5682,SignAndEncrypt,SP_5683,UP_5684))
                                                )
                                                else
                                                    {5927}let pkSess_5685: bitstring = pub(sk(Sess_4820)) in
                                                    {5928}in(c, =GetEndpointRequest);
                                                    {5929}new SP_5686: bitstring;
                                                    {5930}new UP_5687: bitstring;
                                                    {5931}out(c, (GetEndpointResponse,pkSess_5685,SignAndEncrypt,SP_5686,UP_5687))
                                            )
                                            else
                                                {5932}let pkSess_5688: bitstring = fail-any in
                                                {5933}in(c, =GetEndpointRequest);
                                                {5934}new SP_5689: bitstring;
                                                {5935}new UP_5690: bitstring;
                                                {5936}out(c, (GetEndpointResponse,pkSess_5688,SignAndEncrypt,SP_5689,UP_5690))
                                    )
                                    else
                                        {5937}let pkSess_5691: bitstring = fail-any in
                                        {5938}in(c, =GetEndpointRequest);
                                        {5939}new SP_5692: bitstring;
                                        {5940}new UP_5693: bitstring;
                                        {5941}out(c, (GetEndpointResponse,pkSess_5691,SignAndEncrypt,SP_5692,UP_5693))
                            )
                            else
                                {5942}let pkSess_5694: bitstring = fail-any in
                                {5943}in(c, =GetEndpointRequest);
                                {5944}new SP_5695: bitstring;
                                {5945}new UP_5696: bitstring;
                                {5946}out(c, (GetEndpointResponse,pkSess_5694,SignAndEncrypt,SP_5695,UP_5696))
                )
                else
                    {5947}let pkCli_5697: bitstring = fail-any in
                    {5948}let v_5698: bool = (Sess_4820 = A) in
                    (
                        {5949}if v_5698 then
                        (
                            {5950}let pkSess_5699: bitstring = pub(skA) in
                            {5951}in(c, =GetEndpointRequest);
                            {5952}new SP_5700: bitstring;
                            {5953}new UP_5701: bitstring;
                            {5954}out(c, (GetEndpointResponse,pkSess_5699,SignAndEncrypt,SP_5700,UP_5701))
                        )
                        else
                            {5955}let v_5702: bool = (Sess_4820 = B) in
                            (
                                {5956}if v_5702 then
                                (
                                    {5957}let pkSess_5703: bitstring = pub(skB) in
                                    {5958}in(c, =GetEndpointRequest);
                                    {5959}new SP_5704: bitstring;
                                    {5960}new UP_5705: bitstring;
                                    {5961}out(c, (GetEndpointResponse,pkSess_5703,SignAndEncrypt,SP_5704,UP_5705))
                                )
                                else
                                    {5962}let v_5706: bool = (Sess_4820 = C) in
                                    (
                                        {5963}if v_5706 then
                                        (
                                            {5964}let pkSess_5707: bitstring = pub(skC) in
                                            {5965}in(c, =GetEndpointRequest);
                                            {5966}new SP_5708: bitstring;
                                            {5967}new UP_5709: bitstring;
                                            {5968}out(c, (GetEndpointResponse,pkSess_5707,SignAndEncrypt,SP_5708,UP_5709))
                                        )
                                        else
                                            {5969}let pkSess_5710: bitstring = pub(sk(Sess_4820)) in
                                            {5970}in(c, =GetEndpointRequest);
                                            {5971}new SP_5711: bitstring;
                                            {5972}new UP_5712: bitstring;
                                            {5973}out(c, (GetEndpointResponse,pkSess_5710,SignAndEncrypt,SP_5711,UP_5712))
                                    )
                                    else
                                        {5974}let pkSess_5713: bitstring = fail-any in
                                        {5975}in(c, =GetEndpointRequest);
                                        {5976}new SP_5714: bitstring;
                                        {5977}new UP_5715: bitstring;
                                        {5978}out(c, (GetEndpointResponse,pkSess_5713,SignAndEncrypt,SP_5714,UP_5715))
                            )
                            else
                                {5979}let pkSess_5716: bitstring = fail-any in
                                {5980}in(c, =GetEndpointRequest);
                                {5981}new SP_5717: bitstring;
                                {5982}new UP_5718: bitstring;
                                {5983}out(c, (GetEndpointResponse,pkSess_5716,SignAndEncrypt,SP_5717,UP_5718))
                    )
                    else
                        {5984}let pkSess_5719: bitstring = fail-any in
                        {5985}in(c, =GetEndpointRequest);
                        {5986}new SP_5720: bitstring;
                        {5987}new UP_5721: bitstring;
                        {5988}out(c, (GetEndpointResponse,pkSess_5719,SignAndEncrypt,SP_5720,UP_5721))
    )
    else
        {5989}let skDisco_5722: bitstring = fail-any in
        {5990}let pkDisco_5723: bitstring = pub(skDisco_5722) in
        {5991}let v_5724: bool = (Cli_4818 = A) in
        (
            {5992}if v_5724 then
            (
                {5993}let pkCli_5725: bitstring = pub(skA) in
                {5994}let v_5726: bool = (Sess_4820 = A) in
                (
                    {5995}if v_5726 then
                    (
                        {5996}let pkSess_5727: bitstring = pub(skA) in
                        {5997}in(c, =GetEndpointRequest);
                        {5998}new SP_5728: bitstring;
                        {5999}new UP_5729: bitstring;
                        {6000}out(c, (GetEndpointResponse,pkSess_5727,SignAndEncrypt,SP_5728,UP_5729))
                    )
                    else
                        {6001}let v_5730: bool = (Sess_4820 = B) in
                        (
                            {6002}if v_5730 then
                            (
                                {6003}let pkSess_5731: bitstring = pub(skB) in
                                {6004}in(c, =GetEndpointRequest);
                                {6005}new SP_5732: bitstring;
                                {6006}new UP_5733: bitstring;
                                {6007}out(c, (GetEndpointResponse,pkSess_5731,SignAndEncrypt,SP_5732,UP_5733))
                            )
                            else
                                {6008}let v_5734: bool = (Sess_4820 = C) in
                                (
                                    {6009}if v_5734 then
                                    (
                                        {6010}let pkSess_5735: bitstring = pub(skC) in
                                        {6011}in(c, =GetEndpointRequest);
                                        {6012}new SP_5736: bitstring;
                                        {6013}new UP_5737: bitstring;
                                        {6014}out(c, (GetEndpointResponse,pkSess_5735,SignAndEncrypt,SP_5736,UP_5737))
                                    )
                                    else
                                        {6015}let pkSess_5738: bitstring = pub(sk(Sess_4820)) in
                                        {6016}in(c, =GetEndpointRequest);
                                        {6017}new SP_5739: bitstring;
                                        {6018}new UP_5740: bitstring;
                                        {6019}out(c, (GetEndpointResponse,pkSess_5738,SignAndEncrypt,SP_5739,UP_5740))
                                )
                                else
                                    {6020}let pkSess_5741: bitstring = fail-any in
                                    {6021}in(c, =GetEndpointRequest);
                                    {6022}new SP_5742: bitstring;
                                    {6023}new UP_5743: bitstring;
                                    {6024}out(c, (GetEndpointResponse,pkSess_5741,SignAndEncrypt,SP_5742,UP_5743))
                        )
                        else
                            {6025}let pkSess_5744: bitstring = fail-any in
                            {6026}in(c, =GetEndpointRequest);
                            {6027}new SP_5745: bitstring;
                            {6028}new UP_5746: bitstring;
                            {6029}out(c, (GetEndpointResponse,pkSess_5744,SignAndEncrypt,SP_5745,UP_5746))
                )
                else
                    {6030}let pkSess_5747: bitstring = fail-any in
                    {6031}in(c, =GetEndpointRequest);
                    {6032}new SP_5748: bitstring;
                    {6033}new UP_5749: bitstring;
                    {6034}out(c, (GetEndpointResponse,pkSess_5747,SignAndEncrypt,SP_5748,UP_5749))
            )
            else
                {6035}let v_5750: bool = (Cli_4818 = B) in
                (
                    {6036}if v_5750 then
                    (
                        {6037}let pkCli_5751: bitstring = pub(skB) in
                        {6038}let v_5752: bool = (Sess_4820 = A) in
                        (
                            {6039}if v_5752 then
                            (
                                {6040}let pkSess_5753: bitstring = pub(skA) in
                                {6041}in(c, =GetEndpointRequest);
                                {6042}new SP_5754: bitstring;
                                {6043}new UP_5755: bitstring;
                                {6044}out(c, (GetEndpointResponse,pkSess_5753,SignAndEncrypt,SP_5754,UP_5755))
                            )
                            else
                                {6045}let v_5756: bool = (Sess_4820 = B) in
                                (
                                    {6046}if v_5756 then
                                    (
                                        {6047}let pkSess_5757: bitstring = pub(skB) in
                                        {6048}in(c, =GetEndpointRequest);
                                        {6049}new SP_5758: bitstring;
                                        {6050}new UP_5759: bitstring;
                                        {6051}out(c, (GetEndpointResponse,pkSess_5757,SignAndEncrypt,SP_5758,UP_5759))
                                    )
                                    else
                                        {6052}let v_5760: bool = (Sess_4820 = C) in
                                        (
                                            {6053}if v_5760 then
                                            (
                                                {6054}let pkSess_5761: bitstring = pub(skC) in
                                                {6055}in(c, =GetEndpointRequest);
                                                {6056}new SP_5762: bitstring;
                                                {6057}new UP_5763: bitstring;
                                                {6058}out(c, (GetEndpointResponse,pkSess_5761,SignAndEncrypt,SP_5762,UP_5763))
                                            )
                                            else
                                                {6059}let pkSess_5764: bitstring = pub(sk(Sess_4820)) in
                                                {6060}in(c, =GetEndpointRequest);
                                                {6061}new SP_5765: bitstring;
                                                {6062}new UP_5766: bitstring;
                                                {6063}out(c, (GetEndpointResponse,pkSess_5764,SignAndEncrypt,SP_5765,UP_5766))
                                        )
                                        else
                                            {6064}let pkSess_5767: bitstring = fail-any in
                                            {6065}in(c, =GetEndpointRequest);
                                            {6066}new SP_5768: bitstring;
                                            {6067}new UP_5769: bitstring;
                                            {6068}out(c, (GetEndpointResponse,pkSess_5767,SignAndEncrypt,SP_5768,UP_5769))
                                )
                                else
                                    {6069}let pkSess_5770: bitstring = fail-any in
                                    {6070}in(c, =GetEndpointRequest);
                                    {6071}new SP_5771: bitstring;
                                    {6072}new UP_5772: bitstring;
                                    {6073}out(c, (GetEndpointResponse,pkSess_5770,SignAndEncrypt,SP_5771,UP_5772))
                        )
                        else
                            {6074}let pkSess_5773: bitstring = fail-any in
                            {6075}in(c, =GetEndpointRequest);
                            {6076}new SP_5774: bitstring;
                            {6077}new UP_5775: bitstring;
                            {6078}out(c, (GetEndpointResponse,pkSess_5773,SignAndEncrypt,SP_5774,UP_5775))
                    )
                    else
                        {6079}let v_5776: bool = (Cli_4818 = C) in
                        (
                            {6080}if v_5776 then
                            (
                                {6081}let pkCli_5777: bitstring = pub(skC) in
                                {6082}let v_5778: bool = (Sess_4820 = A) in
                                (
                                    {6083}if v_5778 then
                                    (
                                        {6084}let pkSess_5779: bitstring = pub(skA) in
                                        {6085}in(c, =GetEndpointRequest);
                                        {6086}new SP_5780: bitstring;
                                        {6087}new UP_5781: bitstring;
                                        {6088}out(c, (GetEndpointResponse,pkSess_5779,SignAndEncrypt,SP_5780,UP_5781))
                                    )
                                    else
                                        {6089}let v_5782: bool = (Sess_4820 = B) in
                                        (
                                            {6090}if v_5782 then
                                            (
                                                {6091}let pkSess_5783: bitstring = pub(skB) in
                                                {6092}in(c, =GetEndpointRequest);
                                                {6093}new SP_5784: bitstring;
                                                {6094}new UP_5785: bitstring;
                                                {6095}out(c, (GetEndpointResponse,pkSess_5783,SignAndEncrypt,SP_5784,UP_5785))
                                            )
                                            else
                                                {6096}let v_5786: bool = (Sess_4820 = C) in
                                                (
                                                    {6097}if v_5786 then
                                                    (
                                                        {6098}let pkSess_5787: bitstring = pub(skC) in
                                                        {6099}in(c, =GetEndpointRequest);
                                                        {6100}new SP_5788: bitstring;
                                                        {6101}new UP_5789: bitstring;
                                                        {6102}out(c, (GetEndpointResponse,pkSess_5787,SignAndEncrypt,SP_5788,UP_5789))
                                                    )
                                                    else
                                                        {6103}let pkSess_5790: bitstring = pub(sk(Sess_4820)) in
                                                        {6104}in(c, =GetEndpointRequest);
                                                        {6105}new SP_5791: bitstring;
                                                        {6106}new UP_5792: bitstring;
                                                        {6107}out(c, (GetEndpointResponse,pkSess_5790,SignAndEncrypt,SP_5791,UP_5792))
                                                )
                                                else
                                                    {6108}let pkSess_5793: bitstring = fail-any in
                                                    {6109}in(c, =GetEndpointRequest);
                                                    {6110}new SP_5794: bitstring;
                                                    {6111}new UP_5795: bitstring;
                                                    {6112}out(c, (GetEndpointResponse,pkSess_5793,SignAndEncrypt,SP_5794,UP_5795))
                                        )
                                        else
                                            {6113}let pkSess_5796: bitstring = fail-any in
                                            {6114}in(c, =GetEndpointRequest);
                                            {6115}new SP_5797: bitstring;
                                            {6116}new UP_5798: bitstring;
                                            {6117}out(c, (GetEndpointResponse,pkSess_5796,SignAndEncrypt,SP_5797,UP_5798))
                                )
                                else
                                    {6118}let pkSess_5799: bitstring = fail-any in
                                    {6119}in(c, =GetEndpointRequest);
                                    {6120}new SP_5800: bitstring;
                                    {6121}new UP_5801: bitstring;
                                    {6122}out(c, (GetEndpointResponse,pkSess_5799,SignAndEncrypt,SP_5800,UP_5801))
                            )
                            else
                                {6123}let pkCli_5802: bitstring = pub(sk(Cli_4818)) in
                                {6124}let v_5803: bool = (Sess_4820 = A) in
                                (
                                    {6125}if v_5803 then
                                    (
                                        {6126}let pkSess_5804: bitstring = pub(skA) in
                                        {6127}in(c, =GetEndpointRequest);
                                        {6128}new SP_5805: bitstring;
                                        {6129}new UP_5806: bitstring;
                                        {6130}out(c, (GetEndpointResponse,pkSess_5804,SignAndEncrypt,SP_5805,UP_5806))
                                    )
                                    else
                                        {6131}let v_5807: bool = (Sess_4820 = B) in
                                        (
                                            {6132}if v_5807 then
                                            (
                                                {6133}let pkSess_5808: bitstring = pub(skB) in
                                                {6134}in(c, =GetEndpointRequest);
                                                {6135}new SP_5809: bitstring;
                                                {6136}new UP_5810: bitstring;
                                                {6137}out(c, (GetEndpointResponse,pkSess_5808,SignAndEncrypt,SP_5809,UP_5810))
                                            )
                                            else
                                                {6138}let v_5811: bool = (Sess_4820 = C) in
                                                (
                                                    {6139}if v_5811 then
                                                    (
                                                        {6140}let pkSess_5812: bitstring = pub(skC) in
                                                        {6141}in(c, =GetEndpointRequest);
                                                        {6142}new SP_5813: bitstring;
                                                        {6143}new UP_5814: bitstring;
                                                        {6144}out(c, (GetEndpointResponse,pkSess_5812,SignAndEncrypt,SP_5813,UP_5814))
                                                    )
                                                    else
                                                        {6145}let pkSess_5815: bitstring = pub(sk(Sess_4820)) in
                                                        {6146}in(c, =GetEndpointRequest);
                                                        {6147}new SP_5816: bitstring;
                                                        {6148}new UP_5817: bitstring;
                                                        {6149}out(c, (GetEndpointResponse,pkSess_5815,SignAndEncrypt,SP_5816,UP_5817))
                                                )
                                                else
                                                    {6150}let pkSess_5818: bitstring = fail-any in
                                                    {6151}in(c, =GetEndpointRequest);
                                                    {6152}new SP_5819: bitstring;
                                                    {6153}new UP_5820: bitstring;
                                                    {6154}out(c, (GetEndpointResponse,pkSess_5818,SignAndEncrypt,SP_5819,UP_5820))
                                        )
                                        else
                                            {6155}let pkSess_5821: bitstring = fail-any in
                                            {6156}in(c, =GetEndpointRequest);
                                            {6157}new SP_5822: bitstring;
                                            {6158}new UP_5823: bitstring;
                                            {6159}out(c, (GetEndpointResponse,pkSess_5821,SignAndEncrypt,SP_5822,UP_5823))
                                )
                                else
                                    {6160}let pkSess_5824: bitstring = fail-any in
                                    {6161}in(c, =GetEndpointRequest);
                                    {6162}new SP_5825: bitstring;
                                    {6163}new UP_5826: bitstring;
                                    {6164}out(c, (GetEndpointResponse,pkSess_5824,SignAndEncrypt,SP_5825,UP_5826))
                        )
                        else
                            {6165}let pkCli_5827: bitstring = fail-any in
                            {6166}let v_5828: bool = (Sess_4820 = A) in
                            (
                                {6167}if v_5828 then
                                (
                                    {6168}let pkSess_5829: bitstring = pub(skA) in
                                    {6169}in(c, =GetEndpointRequest);
                                    {6170}new SP_5830: bitstring;
                                    {6171}new UP_5831: bitstring;
                                    {6172}out(c, (GetEndpointResponse,pkSess_5829,SignAndEncrypt,SP_5830,UP_5831))
                                )
                                else
                                    {6173}let v_5832: bool = (Sess_4820 = B) in
                                    (
                                        {6174}if v_5832 then
                                        (
                                            {6175}let pkSess_5833: bitstring = pub(skB) in
                                            {6176}in(c, =GetEndpointRequest);
                                            {6177}new SP_5834: bitstring;
                                            {6178}new UP_5835: bitstring;
                                            {6179}out(c, (GetEndpointResponse,pkSess_5833,SignAndEncrypt,SP_5834,UP_5835))
                                        )
                                        else
                                            {6180}let v_5836: bool = (Sess_4820 = C) in
                                            (
                                                {6181}if v_5836 then
                                                (
                                                    {6182}let pkSess_5837: bitstring = pub(skC) in
                                                    {6183}in(c, =GetEndpointRequest);
                                                    {6184}new SP_5838: bitstring;
                                                    {6185}new UP_5839: bitstring;
                                                    {6186}out(c, (GetEndpointResponse,pkSess_5837,SignAndEncrypt,SP_5838,UP_5839))
                                                )
                                                else
                                                    {6187}let pkSess_5840: bitstring = pub(sk(Sess_4820)) in
                                                    {6188}in(c, =GetEndpointRequest);
                                                    {6189}new SP_5841: bitstring;
                                                    {6190}new UP_5842: bitstring;
                                                    {6191}out(c, (GetEndpointResponse,pkSess_5840,SignAndEncrypt,SP_5841,UP_5842))
                                            )
                                            else
                                                {6192}let pkSess_5843: bitstring = fail-any in
                                                {6193}in(c, =GetEndpointRequest);
                                                {6194}new SP_5844: bitstring;
                                                {6195}new UP_5845: bitstring;
                                                {6196}out(c, (GetEndpointResponse,pkSess_5843,SignAndEncrypt,SP_5844,UP_5845))
                                    )
                                    else
                                        {6197}let pkSess_5846: bitstring = fail-any in
                                        {6198}in(c, =GetEndpointRequest);
                                        {6199}new SP_5847: bitstring;
                                        {6200}new UP_5848: bitstring;
                                        {6201}out(c, (GetEndpointResponse,pkSess_5846,SignAndEncrypt,SP_5847,UP_5848))
                            )
                            else
                                {6202}let pkSess_5849: bitstring = fail-any in
                                {6203}in(c, =GetEndpointRequest);
                                {6204}new SP_5850: bitstring;
                                {6205}new UP_5851: bitstring;
                                {6206}out(c, (GetEndpointResponse,pkSess_5849,SignAndEncrypt,SP_5850,UP_5851))
                )
                else
                    {6207}let pkCli_5852: bitstring = fail-any in
                    {6208}let v_5853: bool = (Sess_4820 = A) in
                    (
                        {6209}if v_5853 then
                        (
                            {6210}let pkSess_5854: bitstring = pub(skA) in
                            {6211}in(c, =GetEndpointRequest);
                            {6212}new SP_5855: bitstring;
                            {6213}new UP_5856: bitstring;
                            {6214}out(c, (GetEndpointResponse,pkSess_5854,SignAndEncrypt,SP_5855,UP_5856))
                        )
                        else
                            {6215}let v_5857: bool = (Sess_4820 = B) in
                            (
                                {6216}if v_5857 then
                                (
                                    {6217}let pkSess_5858: bitstring = pub(skB) in
                                    {6218}in(c, =GetEndpointRequest);
                                    {6219}new SP_5859: bitstring;
                                    {6220}new UP_5860: bitstring;
                                    {6221}out(c, (GetEndpointResponse,pkSess_5858,SignAndEncrypt,SP_5859,UP_5860))
                                )
                                else
                                    {6222}let v_5861: bool = (Sess_4820 = C) in
                                    (
                                        {6223}if v_5861 then
                                        (
                                            {6224}let pkSess_5862: bitstring = pub(skC) in
                                            {6225}in(c, =GetEndpointRequest);
                                            {6226}new SP_5863: bitstring;
                                            {6227}new UP_5864: bitstring;
                                            {6228}out(c, (GetEndpointResponse,pkSess_5862,SignAndEncrypt,SP_5863,UP_5864))
                                        )
                                        else
                                            {6229}let pkSess_5865: bitstring = pub(sk(Sess_4820)) in
                                            {6230}in(c, =GetEndpointRequest);
                                            {6231}new SP_5866: bitstring;
                                            {6232}new UP_5867: bitstring;
                                            {6233}out(c, (GetEndpointResponse,pkSess_5865,SignAndEncrypt,SP_5866,UP_5867))
                                    )
                                    else
                                        {6234}let pkSess_5868: bitstring = fail-any in
                                        {6235}in(c, =GetEndpointRequest);
                                        {6236}new SP_5869: bitstring;
                                        {6237}new UP_5870: bitstring;
                                        {6238}out(c, (GetEndpointResponse,pkSess_5868,SignAndEncrypt,SP_5869,UP_5870))
                            )
                            else
                                {6239}let pkSess_5871: bitstring = fail-any in
                                {6240}in(c, =GetEndpointRequest);
                                {6241}new SP_5872: bitstring;
                                {6242}new UP_5873: bitstring;
                                {6243}out(c, (GetEndpointResponse,pkSess_5871,SignAndEncrypt,SP_5872,UP_5873))
                    )
                    else
                        {6244}let pkSess_5874: bitstring = fail-any in
                        {6245}in(c, =GetEndpointRequest);
                        {6246}new SP_5875: bitstring;
                        {6247}new UP_5876: bitstring;
                        {6248}out(c, (GetEndpointResponse,pkSess_5874,SignAndEncrypt,SP_5875,UP_5876))
        )
        else
            {6249}let pkCli_5877: bitstring = fail-any in
            {6250}let v_5878: bool = (Sess_4820 = A) in
            (
                {6251}if v_5878 then
                (
                    {6252}let pkSess_5879: bitstring = pub(skA) in
                    {6253}in(c, =GetEndpointRequest);
                    {6254}new SP_5880: bitstring;
                    {6255}new UP_5881: bitstring;
                    {6256}out(c, (GetEndpointResponse,pkSess_5879,SignAndEncrypt,SP_5880,UP_5881))
                )
                else
                    {6257}let v_5882: bool = (Sess_4820 = B) in
                    (
                        {6258}if v_5882 then
                        (
                            {6259}let pkSess_5883: bitstring = pub(skB) in
                            {6260}in(c, =GetEndpointRequest);
                            {6261}new SP_5884: bitstring;
                            {6262}new UP_5885: bitstring;
                            {6263}out(c, (GetEndpointResponse,pkSess_5883,SignAndEncrypt,SP_5884,UP_5885))
                        )
                        else
                            {6264}let v_5886: bool = (Sess_4820 = C) in
                            (
                                {6265}if v_5886 then
                                (
                                    {6266}let pkSess_5887: bitstring = pub(skC) in
                                    {6267}in(c, =GetEndpointRequest);
                                    {6268}new SP_5888: bitstring;
                                    {6269}new UP_5889: bitstring;
                                    {6270}out(c, (GetEndpointResponse,pkSess_5887,SignAndEncrypt,SP_5888,UP_5889))
                                )
                                else
                                    {6271}let pkSess_5890: bitstring = pub(sk(Sess_4820)) in
                                    {6272}in(c, =GetEndpointRequest);
                                    {6273}new SP_5891: bitstring;
                                    {6274}new UP_5892: bitstring;
                                    {6275}out(c, (GetEndpointResponse,pkSess_5890,SignAndEncrypt,SP_5891,UP_5892))
                            )
                            else
                                {6276}let pkSess_5893: bitstring = fail-any in
                                {6277}in(c, =GetEndpointRequest);
                                {6278}new SP_5894: bitstring;
                                {6279}new UP_5895: bitstring;
                                {6280}out(c, (GetEndpointResponse,pkSess_5893,SignAndEncrypt,SP_5894,UP_5895))
                    )
                    else
                        {6281}let pkSess_5896: bitstring = fail-any in
                        {6282}in(c, =GetEndpointRequest);
                        {6283}new SP_5897: bitstring;
                        {6284}new UP_5898: bitstring;
                        {6285}out(c, (GetEndpointResponse,pkSess_5896,SignAndEncrypt,SP_5897,UP_5898))
            )
            else
                {6286}let pkSess_5899: bitstring = fail-any in
                {6287}in(c, =GetEndpointRequest);
                {6288}new SP_5900: bitstring;
                {6289}new UP_5901: bitstring;
                {6290}out(c, (GetEndpointResponse,pkSess_5899,SignAndEncrypt,SP_5900,UP_5901))
) | (
    {6291}!
    {6292}in(c, (Cli_5902: host,Disco_5903: host,Sess_5904: host));
    {6293}let v_5905: bool = (Sess_5904 = A) in
    (
        {6294}if v_5905 then
        (
            {6295}let skSess: bitstring = skA in
            {6296}let pkSess_5906: bitstring = pub(skSess) in
            {6297}let v_5907: bool = (Cli_5902 = A) in
            (
                {6298}if v_5907 then
                (
                    {6299}let pkCli_5908: bitstring = pub(skA) in
                    {6300}let v_5909: bool = (Disco_5903 = A) in
                    (
                        {6301}if v_5909 then
                        (
                            {6302}let pkDisco_5910: bitstring = pub(skA) in
                            {6303}in(c, (=pkCli_5908,em1: bitstring,sigM1: bitstring));
                            {6304}let m1_5911: bitstring = dec(em1,skSess) in
                            {6305}if (verify(h(m1_5911),sigM1,pkCli_5908) <> true) then
                                0
                            else
                                {6306}let (=OpenSecureChannelRequest,=pkCli_5908,wNc_5912: bitstring) = m1_5911 in
                                {6307}let Nc_5913: bitstring = dec(wNc_5912,skSess) in
                                {6308}new Ns_5914: bitstring;
                                {6309}new ST_5915: bitstring;
                                {6310}new TTL_5916: bitstring;
                                {6311}let wNs_5917: bitstring = enc(Ns_5914,pkCli_5908) in
                                {6312}let m2_5918: bitstring = (OpenSecureChannelResponse,wNs_5917,ST_5915,TTL_5916) in
                                {6313}out(c, (enc(m2_5918,pkCli_5908),sign(h(m2_5918),skSess)));
                                {6314}let Ksrv: bitstring = h((Ns_5914,Nc_5913)) in
                                {6315}out(c, senc(mSrv(pkCli_5908,pkSess_5906),Ksrv))
                        )
                        else
                            {6316}let v_5919: bool = (Disco_5903 = B) in
                            (
                                {6317}if v_5919 then
                                (
                                    {6318}let pkDisco_5920: bitstring = pub(skB) in
                                    {6319}in(c, (=pkCli_5908,em1_5921: bitstring,sigM1_5922: bitstring));
                                    {6320}let m1_5923: bitstring = dec(em1_5921,skSess) in
                                    {6321}if (verify(h(m1_5923),sigM1_5922,pkCli_5908) <> true) then
                                        0
                                    else
                                        {6322}let (=OpenSecureChannelRequest,=pkCli_5908,wNc_5924: bitstring) = m1_5923 in
                                        {6323}let Nc_5925: bitstring = dec(wNc_5924,skSess) in
                                        {6324}new Ns_5926: bitstring;
                                        {6325}new ST_5927: bitstring;
                                        {6326}new TTL_5928: bitstring;
                                        {6327}let wNs_5929: bitstring = enc(Ns_5926,pkCli_5908) in
                                        {6328}let m2_5930: bitstring = (OpenSecureChannelResponse,wNs_5929,ST_5927,TTL_5928) in
                                        {6329}out(c, (enc(m2_5930,pkCli_5908),sign(h(m2_5930),skSess)));
                                        {6330}let Ksrv_5931: bitstring = h((Ns_5926,Nc_5925)) in
                                        {6331}out(c, senc(mSrv(pkCli_5908,pkSess_5906),Ksrv_5931))
                                )
                                else
                                    {6332}let v_5932: bool = (Disco_5903 = C) in
                                    (
                                        {6333}if v_5932 then
                                        (
                                            {6334}let pkDisco_5933: bitstring = pub(skC) in
                                            {6335}in(c, (=pkCli_5908,em1_5934: bitstring,sigM1_5935: bitstring));
                                            {6336}let m1_5936: bitstring = dec(em1_5934,skSess) in
                                            {6337}if (verify(h(m1_5936),sigM1_5935,pkCli_5908) <> true) then
                                                0
                                            else
                                                {6338}let (=OpenSecureChannelRequest,=pkCli_5908,wNc_5937: bitstring) = m1_5936 in
                                                {6339}let Nc_5938: bitstring = dec(wNc_5937,skSess) in
                                                {6340}new Ns_5939: bitstring;
                                                {6341}new ST_5940: bitstring;
                                                {6342}new TTL_5941: bitstring;
                                                {6343}let wNs_5942: bitstring = enc(Ns_5939,pkCli_5908) in
                                                {6344}let m2_5943: bitstring = (OpenSecureChannelResponse,wNs_5942,ST_5940,TTL_5941) in
                                                {6345}out(c, (enc(m2_5943,pkCli_5908),sign(h(m2_5943),skSess)));
                                                {6346}let Ksrv_5944: bitstring = h((Ns_5939,Nc_5938)) in
                                                {6347}out(c, senc(mSrv(pkCli_5908,pkSess_5906),Ksrv_5944))
                                        )
                                        else
                                            {6348}let pkDisco_5945: bitstring = pub(sk(Disco_5903)) in
                                            {6349}in(c, (=pkCli_5908,em1_5946: bitstring,sigM1_5947: bitstring));
                                            {6350}let m1_5948: bitstring = dec(em1_5946,skSess) in
                                            {6351}if (verify(h(m1_5948),sigM1_5947,pkCli_5908) <> true) then
                                                0
                                            else
                                                {6352}let (=OpenSecureChannelRequest,=pkCli_5908,wNc_5949: bitstring) = m1_5948 in
                                                {6353}let Nc_5950: bitstring = dec(wNc_5949,skSess) in
                                                {6354}new Ns_5951: bitstring;
                                                {6355}new ST_5952: bitstring;
                                                {6356}new TTL_5953: bitstring;
                                                {6357}let wNs_5954: bitstring = enc(Ns_5951,pkCli_5908) in
                                                {6358}let m2_5955: bitstring = (OpenSecureChannelResponse,wNs_5954,ST_5952,TTL_5953) in
                                                {6359}out(c, (enc(m2_5955,pkCli_5908),sign(h(m2_5955),skSess)));
                                                {6360}let Ksrv_5956: bitstring = h((Ns_5951,Nc_5950)) in
                                                {6361}out(c, senc(mSrv(pkCli_5908,pkSess_5906),Ksrv_5956))
                                    )
                                    else
                                        {6362}let pkDisco_5957: bitstring = fail-any in
                                        {6363}in(c, (=pkCli_5908,em1_5958: bitstring,sigM1_5959: bitstring));
                                        {6364}let m1_5960: bitstring = dec(em1_5958,skSess) in
                                        {6365}if (verify(h(m1_5960),sigM1_5959,pkCli_5908) <> true) then
                                            0
                                        else
                                            {6366}let (=OpenSecureChannelRequest,=pkCli_5908,wNc_5961: bitstring) = m1_5960 in
                                            {6367}let Nc_5962: bitstring = dec(wNc_5961,skSess) in
                                            {6368}new Ns_5963: bitstring;
                                            {6369}new ST_5964: bitstring;
                                            {6370}new TTL_5965: bitstring;
                                            {6371}let wNs_5966: bitstring = enc(Ns_5963,pkCli_5908) in
                                            {6372}let m2_5967: bitstring = (OpenSecureChannelResponse,wNs_5966,ST_5964,TTL_5965) in
                                            {6373}out(c, (enc(m2_5967,pkCli_5908),sign(h(m2_5967),skSess)));
                                            {6374}let Ksrv_5968: bitstring = h((Ns_5963,Nc_5962)) in
                                            {6375}out(c, senc(mSrv(pkCli_5908,pkSess_5906),Ksrv_5968))
                            )
                            else
                                {6376}let pkDisco_5969: bitstring = fail-any in
                                {6377}in(c, (=pkCli_5908,em1_5970: bitstring,sigM1_5971: bitstring));
                                {6378}let m1_5972: bitstring = dec(em1_5970,skSess) in
                                {6379}if (verify(h(m1_5972),sigM1_5971,pkCli_5908) <> true) then
                                    0
                                else
                                    {6380}let (=OpenSecureChannelRequest,=pkCli_5908,wNc_5973: bitstring) = m1_5972 in
                                    {6381}let Nc_5974: bitstring = dec(wNc_5973,skSess) in
                                    {6382}new Ns_5975: bitstring;
                                    {6383}new ST_5976: bitstring;
                                    {6384}new TTL_5977: bitstring;
                                    {6385}let wNs_5978: bitstring = enc(Ns_5975,pkCli_5908) in
                                    {6386}let m2_5979: bitstring = (OpenSecureChannelResponse,wNs_5978,ST_5976,TTL_5977) in
                                    {6387}out(c, (enc(m2_5979,pkCli_5908),sign(h(m2_5979),skSess)));
                                    {6388}let Ksrv_5980: bitstring = h((Ns_5975,Nc_5974)) in
                                    {6389}out(c, senc(mSrv(pkCli_5908,pkSess_5906),Ksrv_5980))
                    )
                    else
                        {6390}let pkDisco_5981: bitstring = fail-any in
                        {6391}in(c, (=pkCli_5908,em1_5982: bitstring,sigM1_5983: bitstring));
                        {6392}let m1_5984: bitstring = dec(em1_5982,skSess) in
                        {6393}if (verify(h(m1_5984),sigM1_5983,pkCli_5908) <> true) then
                            0
                        else
                            {6394}let (=OpenSecureChannelRequest,=pkCli_5908,wNc_5985: bitstring) = m1_5984 in
                            {6395}let Nc_5986: bitstring = dec(wNc_5985,skSess) in
                            {6396}new Ns_5987: bitstring;
                            {6397}new ST_5988: bitstring;
                            {6398}new TTL_5989: bitstring;
                            {6399}let wNs_5990: bitstring = enc(Ns_5987,pkCli_5908) in
                            {6400}let m2_5991: bitstring = (OpenSecureChannelResponse,wNs_5990,ST_5988,TTL_5989) in
                            {6401}out(c, (enc(m2_5991,pkCli_5908),sign(h(m2_5991),skSess)));
                            {6402}let Ksrv_5992: bitstring = h((Ns_5987,Nc_5986)) in
                            {6403}out(c, senc(mSrv(pkCli_5908,pkSess_5906),Ksrv_5992))
                )
                else
                    {6404}let v_5993: bool = (Cli_5902 = B) in
                    (
                        {6405}if v_5993 then
                        (
                            {6406}let pkCli_5994: bitstring = pub(skB) in
                            {6407}let v_5995: bool = (Disco_5903 = A) in
                            (
                                {6408}if v_5995 then
                                (
                                    {6409}let pkDisco_5996: bitstring = pub(skA) in
                                    {6410}in(c, (=pkCli_5994,em1_5997: bitstring,sigM1_5998: bitstring));
                                    {6411}let m1_5999: bitstring = dec(em1_5997,skSess) in
                                    {6412}if (verify(h(m1_5999),sigM1_5998,pkCli_5994) <> true) then
                                        0
                                    else
                                        {6413}let (=OpenSecureChannelRequest,=pkCli_5994,wNc_6000: bitstring) = m1_5999 in
                                        {6414}let Nc_6001: bitstring = dec(wNc_6000,skSess) in
                                        {6415}new Ns_6002: bitstring;
                                        {6416}new ST_6003: bitstring;
                                        {6417}new TTL_6004: bitstring;
                                        {6418}let wNs_6005: bitstring = enc(Ns_6002,pkCli_5994) in
                                        {6419}let m2_6006: bitstring = (OpenSecureChannelResponse,wNs_6005,ST_6003,TTL_6004) in
                                        {6420}out(c, (enc(m2_6006,pkCli_5994),sign(h(m2_6006),skSess)));
                                        {6421}let Ksrv_6007: bitstring = h((Ns_6002,Nc_6001)) in
                                        {6422}out(c, senc(mSrv(pkCli_5994,pkSess_5906),Ksrv_6007))
                                )
                                else
                                    {6423}let v_6008: bool = (Disco_5903 = B) in
                                    (
                                        {6424}if v_6008 then
                                        (
                                            {6425}let pkDisco_6009: bitstring = pub(skB) in
                                            {6426}in(c, (=pkCli_5994,em1_6010: bitstring,sigM1_6011: bitstring));
                                            {6427}let m1_6012: bitstring = dec(em1_6010,skSess) in
                                            {6428}if (verify(h(m1_6012),sigM1_6011,pkCli_5994) <> true) then
                                                0
                                            else
                                                {6429}let (=OpenSecureChannelRequest,=pkCli_5994,wNc_6013: bitstring) = m1_6012 in
                                                {6430}let Nc_6014: bitstring = dec(wNc_6013,skSess) in
                                                {6431}new Ns_6015: bitstring;
                                                {6432}new ST_6016: bitstring;
                                                {6433}new TTL_6017: bitstring;
                                                {6434}let wNs_6018: bitstring = enc(Ns_6015,pkCli_5994) in
                                                {6435}let m2_6019: bitstring = (OpenSecureChannelResponse,wNs_6018,ST_6016,TTL_6017) in
                                                {6436}out(c, (enc(m2_6019,pkCli_5994),sign(h(m2_6019),skSess)));
                                                {6437}let Ksrv_6020: bitstring = h((Ns_6015,Nc_6014)) in
                                                {6438}out(c, senc(mSrv(pkCli_5994,pkSess_5906),Ksrv_6020))
                                        )
                                        else
                                            {6439}let v_6021: bool = (Disco_5903 = C) in
                                            (
                                                {6440}if v_6021 then
                                                (
                                                    {6441}let pkDisco_6022: bitstring = pub(skC) in
                                                    {6442}in(c, (=pkCli_5994,em1_6023: bitstring,sigM1_6024: bitstring));
                                                    {6443}let m1_6025: bitstring = dec(em1_6023,skSess) in
                                                    {6444}if (verify(h(m1_6025),sigM1_6024,pkCli_5994) <> true) then
                                                        0
                                                    else
                                                        {6445}let (=OpenSecureChannelRequest,=pkCli_5994,wNc_6026: bitstring) = m1_6025 in
                                                        {6446}let Nc_6027: bitstring = dec(wNc_6026,skSess) in
                                                        {6447}new Ns_6028: bitstring;
                                                        {6448}new ST_6029: bitstring;
                                                        {6449}new TTL_6030: bitstring;
                                                        {6450}let wNs_6031: bitstring = enc(Ns_6028,pkCli_5994) in
                                                        {6451}let m2_6032: bitstring = (OpenSecureChannelResponse,wNs_6031,ST_6029,TTL_6030) in
                                                        {6452}out(c, (enc(m2_6032,pkCli_5994),sign(h(m2_6032),skSess)));
                                                        {6453}let Ksrv_6033: bitstring = h((Ns_6028,Nc_6027)) in
                                                        {6454}out(c, senc(mSrv(pkCli_5994,pkSess_5906),Ksrv_6033))
                                                )
                                                else
                                                    {6455}let pkDisco_6034: bitstring = pub(sk(Disco_5903)) in
                                                    {6456}in(c, (=pkCli_5994,em1_6035: bitstring,sigM1_6036: bitstring));
                                                    {6457}let m1_6037: bitstring = dec(em1_6035,skSess) in
                                                    {6458}if (verify(h(m1_6037),sigM1_6036,pkCli_5994) <> true) then
                                                        0
                                                    else
                                                        {6459}let (=OpenSecureChannelRequest,=pkCli_5994,wNc_6038: bitstring) = m1_6037 in
                                                        {6460}let Nc_6039: bitstring = dec(wNc_6038,skSess) in
                                                        {6461}new Ns_6040: bitstring;
                                                        {6462}new ST_6041: bitstring;
                                                        {6463}new TTL_6042: bitstring;
                                                        {6464}let wNs_6043: bitstring = enc(Ns_6040,pkCli_5994) in
                                                        {6465}let m2_6044: bitstring = (OpenSecureChannelResponse,wNs_6043,ST_6041,TTL_6042) in
                                                        {6466}out(c, (enc(m2_6044,pkCli_5994),sign(h(m2_6044),skSess)));
                                                        {6467}let Ksrv_6045: bitstring = h((Ns_6040,Nc_6039)) in
                                                        {6468}out(c, senc(mSrv(pkCli_5994,pkSess_5906),Ksrv_6045))
                                            )
                                            else
                                                {6469}let pkDisco_6046: bitstring = fail-any in
                                                {6470}in(c, (=pkCli_5994,em1_6047: bitstring,sigM1_6048: bitstring));
                                                {6471}let m1_6049: bitstring = dec(em1_6047,skSess) in
                                                {6472}if (verify(h(m1_6049),sigM1_6048,pkCli_5994) <> true) then
                                                    0
                                                else
                                                    {6473}let (=OpenSecureChannelRequest,=pkCli_5994,wNc_6050: bitstring) = m1_6049 in
                                                    {6474}let Nc_6051: bitstring = dec(wNc_6050,skSess) in
                                                    {6475}new Ns_6052: bitstring;
                                                    {6476}new ST_6053: bitstring;
                                                    {6477}new TTL_6054: bitstring;
                                                    {6478}let wNs_6055: bitstring = enc(Ns_6052,pkCli_5994) in
                                                    {6479}let m2_6056: bitstring = (OpenSecureChannelResponse,wNs_6055,ST_6053,TTL_6054) in
                                                    {6480}out(c, (enc(m2_6056,pkCli_5994),sign(h(m2_6056),skSess)));
                                                    {6481}let Ksrv_6057: bitstring = h((Ns_6052,Nc_6051)) in
                                                    {6482}out(c, senc(mSrv(pkCli_5994,pkSess_5906),Ksrv_6057))
                                    )
                                    else
                                        {6483}let pkDisco_6058: bitstring = fail-any in
                                        {6484}in(c, (=pkCli_5994,em1_6059: bitstring,sigM1_6060: bitstring));
                                        {6485}let m1_6061: bitstring = dec(em1_6059,skSess) in
                                        {6486}if (verify(h(m1_6061),sigM1_6060,pkCli_5994) <> true) then
                                            0
                                        else
                                            {6487}let (=OpenSecureChannelRequest,=pkCli_5994,wNc_6062: bitstring) = m1_6061 in
                                            {6488}let Nc_6063: bitstring = dec(wNc_6062,skSess) in
                                            {6489}new Ns_6064: bitstring;
                                            {6490}new ST_6065: bitstring;
                                            {6491}new TTL_6066: bitstring;
                                            {6492}let wNs_6067: bitstring = enc(Ns_6064,pkCli_5994) in
                                            {6493}let m2_6068: bitstring = (OpenSecureChannelResponse,wNs_6067,ST_6065,TTL_6066) in
                                            {6494}out(c, (enc(m2_6068,pkCli_5994),sign(h(m2_6068),skSess)));
                                            {6495}let Ksrv_6069: bitstring = h((Ns_6064,Nc_6063)) in
                                            {6496}out(c, senc(mSrv(pkCli_5994,pkSess_5906),Ksrv_6069))
                            )
                            else
                                {6497}let pkDisco_6070: bitstring = fail-any in
                                {6498}in(c, (=pkCli_5994,em1_6071: bitstring,sigM1_6072: bitstring));
                                {6499}let m1_6073: bitstring = dec(em1_6071,skSess) in
                                {6500}if (verify(h(m1_6073),sigM1_6072,pkCli_5994) <> true) then
                                    0
                                else
                                    {6501}let (=OpenSecureChannelRequest,=pkCli_5994,wNc_6074: bitstring) = m1_6073 in
                                    {6502}let Nc_6075: bitstring = dec(wNc_6074,skSess) in
                                    {6503}new Ns_6076: bitstring;
                                    {6504}new ST_6077: bitstring;
                                    {6505}new TTL_6078: bitstring;
                                    {6506}let wNs_6079: bitstring = enc(Ns_6076,pkCli_5994) in
                                    {6507}let m2_6080: bitstring = (OpenSecureChannelResponse,wNs_6079,ST_6077,TTL_6078) in
                                    {6508}out(c, (enc(m2_6080,pkCli_5994),sign(h(m2_6080),skSess)));
                                    {6509}let Ksrv_6081: bitstring = h((Ns_6076,Nc_6075)) in
                                    {6510}out(c, senc(mSrv(pkCli_5994,pkSess_5906),Ksrv_6081))
                        )
                        else
                            {6511}let v_6082: bool = (Cli_5902 = C) in
                            (
                                {6512}if v_6082 then
                                (
                                    {6513}let pkCli_6083: bitstring = pub(skC) in
                                    {6514}let v_6084: bool = (Disco_5903 = A) in
                                    (
                                        {6515}if v_6084 then
                                        (
                                            {6516}let pkDisco_6085: bitstring = pub(skA) in
                                            {6517}in(c, (=pkCli_6083,em1_6086: bitstring,sigM1_6087: bitstring));
                                            {6518}let m1_6088: bitstring = dec(em1_6086,skSess) in
                                            {6519}if (verify(h(m1_6088),sigM1_6087,pkCli_6083) <> true) then
                                                0
                                            else
                                                {6520}let (=OpenSecureChannelRequest,=pkCli_6083,wNc_6089: bitstring) = m1_6088 in
                                                {6521}let Nc_6090: bitstring = dec(wNc_6089,skSess) in
                                                {6522}new Ns_6091: bitstring;
                                                {6523}new ST_6092: bitstring;
                                                {6524}new TTL_6093: bitstring;
                                                {6525}let wNs_6094: bitstring = enc(Ns_6091,pkCli_6083) in
                                                {6526}let m2_6095: bitstring = (OpenSecureChannelResponse,wNs_6094,ST_6092,TTL_6093) in
                                                {6527}out(c, (enc(m2_6095,pkCli_6083),sign(h(m2_6095),skSess)));
                                                {6528}let Ksrv_6096: bitstring = h((Ns_6091,Nc_6090)) in
                                                {6529}out(c, senc(mSrv(pkCli_6083,pkSess_5906),Ksrv_6096))
                                        )
                                        else
                                            {6530}let v_6097: bool = (Disco_5903 = B) in
                                            (
                                                {6531}if v_6097 then
                                                (
                                                    {6532}let pkDisco_6098: bitstring = pub(skB) in
                                                    {6533}in(c, (=pkCli_6083,em1_6099: bitstring,sigM1_6100: bitstring));
                                                    {6534}let m1_6101: bitstring = dec(em1_6099,skSess) in
                                                    {6535}if (verify(h(m1_6101),sigM1_6100,pkCli_6083) <> true) then
                                                        0
                                                    else
                                                        {6536}let (=OpenSecureChannelRequest,=pkCli_6083,wNc_6102: bitstring) = m1_6101 in
                                                        {6537}let Nc_6103: bitstring = dec(wNc_6102,skSess) in
                                                        {6538}new Ns_6104: bitstring;
                                                        {6539}new ST_6105: bitstring;
                                                        {6540}new TTL_6106: bitstring;
                                                        {6541}let wNs_6107: bitstring = enc(Ns_6104,pkCli_6083) in
                                                        {6542}let m2_6108: bitstring = (OpenSecureChannelResponse,wNs_6107,ST_6105,TTL_6106) in
                                                        {6543}out(c, (enc(m2_6108,pkCli_6083),sign(h(m2_6108),skSess)));
                                                        {6544}let Ksrv_6109: bitstring = h((Ns_6104,Nc_6103)) in
                                                        {6545}out(c, senc(mSrv(pkCli_6083,pkSess_5906),Ksrv_6109))
                                                )
                                                else
                                                    {6546}let v_6110: bool = (Disco_5903 = C) in
                                                    (
                                                        {6547}if v_6110 then
                                                        (
                                                            {6548}let pkDisco_6111: bitstring = pub(skC) in
                                                            {6549}in(c, (=pkCli_6083,em1_6112: bitstring,sigM1_6113: bitstring));
                                                            {6550}let m1_6114: bitstring = dec(em1_6112,skSess) in
                                                            {6551}if (verify(h(m1_6114),sigM1_6113,pkCli_6083) <> true) then
                                                                0
                                                            else
                                                                {6552}let (=OpenSecureChannelRequest,=pkCli_6083,wNc_6115: bitstring) = m1_6114 in
                                                                {6553}let Nc_6116: bitstring = dec(wNc_6115,skSess) in
                                                                {6554}new Ns_6117: bitstring;
                                                                {6555}new ST_6118: bitstring;
                                                                {6556}new TTL_6119: bitstring;
                                                                {6557}let wNs_6120: bitstring = enc(Ns_6117,pkCli_6083) in
                                                                {6558}let m2_6121: bitstring = (OpenSecureChannelResponse,wNs_6120,ST_6118,TTL_6119) in
                                                                {6559}out(c, (enc(m2_6121,pkCli_6083),sign(h(m2_6121),skSess)));
                                                                {6560}let Ksrv_6122: bitstring = h((Ns_6117,Nc_6116)) in
                                                                {6561}out(c, senc(mSrv(pkCli_6083,pkSess_5906),Ksrv_6122))
                                                        )
                                                        else
                                                            {6562}let pkDisco_6123: bitstring = pub(sk(Disco_5903)) in
                                                            {6563}in(c, (=pkCli_6083,em1_6124: bitstring,sigM1_6125: bitstring));
                                                            {6564}let m1_6126: bitstring = dec(em1_6124,skSess) in
                                                            {6565}if (verify(h(m1_6126),sigM1_6125,pkCli_6083) <> true) then
                                                                0
                                                            else
                                                                {6566}let (=OpenSecureChannelRequest,=pkCli_6083,wNc_6127: bitstring) = m1_6126 in
                                                                {6567}let Nc_6128: bitstring = dec(wNc_6127,skSess) in
                                                                {6568}new Ns_6129: bitstring;
                                                                {6569}new ST_6130: bitstring;
                                                                {6570}new TTL_6131: bitstring;
                                                                {6571}let wNs_6132: bitstring = enc(Ns_6129,pkCli_6083) in
                                                                {6572}let m2_6133: bitstring = (OpenSecureChannelResponse,wNs_6132,ST_6130,TTL_6131) in
                                                                {6573}out(c, (enc(m2_6133,pkCli_6083),sign(h(m2_6133),skSess)));
                                                                {6574}let Ksrv_6134: bitstring = h((Ns_6129,Nc_6128)) in
                                                                {6575}out(c, senc(mSrv(pkCli_6083,pkSess_5906),Ksrv_6134))
                                                    )
                                                    else
                                                        {6576}let pkDisco_6135: bitstring = fail-any in
                                                        {6577}in(c, (=pkCli_6083,em1_6136: bitstring,sigM1_6137: bitstring));
                                                        {6578}let m1_6138: bitstring = dec(em1_6136,skSess) in
                                                        {6579}if (verify(h(m1_6138),sigM1_6137,pkCli_6083) <> true) then
                                                            0
                                                        else
                                                            {6580}let (=OpenSecureChannelRequest,=pkCli_6083,wNc_6139: bitstring) = m1_6138 in
                                                            {6581}let Nc_6140: bitstring = dec(wNc_6139,skSess) in
                                                            {6582}new Ns_6141: bitstring;
                                                            {6583}new ST_6142: bitstring;
                                                            {6584}new TTL_6143: bitstring;
                                                            {6585}let wNs_6144: bitstring = enc(Ns_6141,pkCli_6083) in
                                                            {6586}let m2_6145: bitstring = (OpenSecureChannelResponse,wNs_6144,ST_6142,TTL_6143) in
                                                            {6587}out(c, (enc(m2_6145,pkCli_6083),sign(h(m2_6145),skSess)));
                                                            {6588}let Ksrv_6146: bitstring = h((Ns_6141,Nc_6140)) in
                                                            {6589}out(c, senc(mSrv(pkCli_6083,pkSess_5906),Ksrv_6146))
                                            )
                                            else
                                                {6590}let pkDisco_6147: bitstring = fail-any in
                                                {6591}in(c, (=pkCli_6083,em1_6148: bitstring,sigM1_6149: bitstring));
                                                {6592}let m1_6150: bitstring = dec(em1_6148,skSess) in
                                                {6593}if (verify(h(m1_6150),sigM1_6149,pkCli_6083) <> true) then
                                                    0
                                                else
                                                    {6594}let (=OpenSecureChannelRequest,=pkCli_6083,wNc_6151: bitstring) = m1_6150 in
                                                    {6595}let Nc_6152: bitstring = dec(wNc_6151,skSess) in
                                                    {6596}new Ns_6153: bitstring;
                                                    {6597}new ST_6154: bitstring;
                                                    {6598}new TTL_6155: bitstring;
                                                    {6599}let wNs_6156: bitstring = enc(Ns_6153,pkCli_6083) in
                                                    {6600}let m2_6157: bitstring = (OpenSecureChannelResponse,wNs_6156,ST_6154,TTL_6155) in
                                                    {6601}out(c, (enc(m2_6157,pkCli_6083),sign(h(m2_6157),skSess)));
                                                    {6602}let Ksrv_6158: bitstring = h((Ns_6153,Nc_6152)) in
                                                    {6603}out(c, senc(mSrv(pkCli_6083,pkSess_5906),Ksrv_6158))
                                    )
                                    else
                                        {6604}let pkDisco_6159: bitstring = fail-any in
                                        {6605}in(c, (=pkCli_6083,em1_6160: bitstring,sigM1_6161: bitstring));
                                        {6606}let m1_6162: bitstring = dec(em1_6160,skSess) in
                                        {6607}if (verify(h(m1_6162),sigM1_6161,pkCli_6083) <> true) then
                                            0
                                        else
                                            {6608}let (=OpenSecureChannelRequest,=pkCli_6083,wNc_6163: bitstring) = m1_6162 in
                                            {6609}let Nc_6164: bitstring = dec(wNc_6163,skSess) in
                                            {6610}new Ns_6165: bitstring;
                                            {6611}new ST_6166: bitstring;
                                            {6612}new TTL_6167: bitstring;
                                            {6613}let wNs_6168: bitstring = enc(Ns_6165,pkCli_6083) in
                                            {6614}let m2_6169: bitstring = (OpenSecureChannelResponse,wNs_6168,ST_6166,TTL_6167) in
                                            {6615}out(c, (enc(m2_6169,pkCli_6083),sign(h(m2_6169),skSess)));
                                            {6616}let Ksrv_6170: bitstring = h((Ns_6165,Nc_6164)) in
                                            {6617}out(c, senc(mSrv(pkCli_6083,pkSess_5906),Ksrv_6170))
                                )
                                else
                                    {6618}let pkCli_6171: bitstring = pub(sk(Cli_5902)) in
                                    {6619}let v_6172: bool = (Disco_5903 = A) in
                                    (
                                        {6620}if v_6172 then
                                        (
                                            {6621}let pkDisco_6173: bitstring = pub(skA) in
                                            {6622}in(c, (=pkCli_6171,em1_6174: bitstring,sigM1_6175: bitstring));
                                            {6623}let m1_6176: bitstring = dec(em1_6174,skSess) in
                                            {6624}if (verify(h(m1_6176),sigM1_6175,pkCli_6171) <> true) then
                                                0
                                            else
                                                {6625}let (=OpenSecureChannelRequest,=pkCli_6171,wNc_6177: bitstring) = m1_6176 in
                                                {6626}let Nc_6178: bitstring = dec(wNc_6177,skSess) in
                                                {6627}new Ns_6179: bitstring;
                                                {6628}new ST_6180: bitstring;
                                                {6629}new TTL_6181: bitstring;
                                                {6630}let wNs_6182: bitstring = enc(Ns_6179,pkCli_6171) in
                                                {6631}let m2_6183: bitstring = (OpenSecureChannelResponse,wNs_6182,ST_6180,TTL_6181) in
                                                {6632}out(c, (enc(m2_6183,pkCli_6171),sign(h(m2_6183),skSess)));
                                                {6633}let Ksrv_6184: bitstring = h((Ns_6179,Nc_6178)) in
                                                {6634}out(c, senc(mSrv(pkCli_6171,pkSess_5906),Ksrv_6184))
                                        )
                                        else
                                            {6635}let v_6185: bool = (Disco_5903 = B) in
                                            (
                                                {6636}if v_6185 then
                                                (
                                                    {6637}let pkDisco_6186: bitstring = pub(skB) in
                                                    {6638}in(c, (=pkCli_6171,em1_6187: bitstring,sigM1_6188: bitstring));
                                                    {6639}let m1_6189: bitstring = dec(em1_6187,skSess) in
                                                    {6640}if (verify(h(m1_6189),sigM1_6188,pkCli_6171) <> true) then
                                                        0
                                                    else
                                                        {6641}let (=OpenSecureChannelRequest,=pkCli_6171,wNc_6190: bitstring) = m1_6189 in
                                                        {6642}let Nc_6191: bitstring = dec(wNc_6190,skSess) in
                                                        {6643}new Ns_6192: bitstring;
                                                        {6644}new ST_6193: bitstring;
                                                        {6645}new TTL_6194: bitstring;
                                                        {6646}let wNs_6195: bitstring = enc(Ns_6192,pkCli_6171) in
                                                        {6647}let m2_6196: bitstring = (OpenSecureChannelResponse,wNs_6195,ST_6193,TTL_6194) in
                                                        {6648}out(c, (enc(m2_6196,pkCli_6171),sign(h(m2_6196),skSess)));
                                                        {6649}let Ksrv_6197: bitstring = h((Ns_6192,Nc_6191)) in
                                                        {6650}out(c, senc(mSrv(pkCli_6171,pkSess_5906),Ksrv_6197))
                                                )
                                                else
                                                    {6651}let v_6198: bool = (Disco_5903 = C) in
                                                    (
                                                        {6652}if v_6198 then
                                                        (
                                                            {6653}let pkDisco_6199: bitstring = pub(skC) in
                                                            {6654}in(c, (=pkCli_6171,em1_6200: bitstring,sigM1_6201: bitstring));
                                                            {6655}let m1_6202: bitstring = dec(em1_6200,skSess) in
                                                            {6656}if (verify(h(m1_6202),sigM1_6201,pkCli_6171) <> true) then
                                                                0
                                                            else
                                                                {6657}let (=OpenSecureChannelRequest,=pkCli_6171,wNc_6203: bitstring) = m1_6202 in
                                                                {6658}let Nc_6204: bitstring = dec(wNc_6203,skSess) in
                                                                {6659}new Ns_6205: bitstring;
                                                                {6660}new ST_6206: bitstring;
                                                                {6661}new TTL_6207: bitstring;
                                                                {6662}let wNs_6208: bitstring = enc(Ns_6205,pkCli_6171) in
                                                                {6663}let m2_6209: bitstring = (OpenSecureChannelResponse,wNs_6208,ST_6206,TTL_6207) in
                                                                {6664}out(c, (enc(m2_6209,pkCli_6171),sign(h(m2_6209),skSess)));
                                                                {6665}let Ksrv_6210: bitstring = h((Ns_6205,Nc_6204)) in
                                                                {6666}out(c, senc(mSrv(pkCli_6171,pkSess_5906),Ksrv_6210))
                                                        )
                                                        else
                                                            {6667}let pkDisco_6211: bitstring = pub(sk(Disco_5903)) in
                                                            {6668}in(c, (=pkCli_6171,em1_6212: bitstring,sigM1_6213: bitstring));
                                                            {6669}let m1_6214: bitstring = dec(em1_6212,skSess) in
                                                            {6670}if (verify(h(m1_6214),sigM1_6213,pkCli_6171) <> true) then
                                                                0
                                                            else
                                                                {6671}let (=OpenSecureChannelRequest,=pkCli_6171,wNc_6215: bitstring) = m1_6214 in
                                                                {6672}let Nc_6216: bitstring = dec(wNc_6215,skSess) in
                                                                {6673}new Ns_6217: bitstring;
                                                                {6674}new ST_6218: bitstring;
                                                                {6675}new TTL_6219: bitstring;
                                                                {6676}let wNs_6220: bitstring = enc(Ns_6217,pkCli_6171) in
                                                                {6677}let m2_6221: bitstring = (OpenSecureChannelResponse,wNs_6220,ST_6218,TTL_6219) in
                                                                {6678}out(c, (enc(m2_6221,pkCli_6171),sign(h(m2_6221),skSess)));
                                                                {6679}let Ksrv_6222: bitstring = h((Ns_6217,Nc_6216)) in
                                                                {6680}out(c, senc(mSrv(pkCli_6171,pkSess_5906),Ksrv_6222))
                                                    )
                                                    else
                                                        {6681}let pkDisco_6223: bitstring = fail-any in
                                                        {6682}in(c, (=pkCli_6171,em1_6224: bitstring,sigM1_6225: bitstring));
                                                        {6683}let m1_6226: bitstring = dec(em1_6224,skSess) in
                                                        {6684}if (verify(h(m1_6226),sigM1_6225,pkCli_6171) <> true) then
                                                            0
                                                        else
                                                            {6685}let (=OpenSecureChannelRequest,=pkCli_6171,wNc_6227: bitstring) = m1_6226 in
                                                            {6686}let Nc_6228: bitstring = dec(wNc_6227,skSess) in
                                                            {6687}new Ns_6229: bitstring;
                                                            {6688}new ST_6230: bitstring;
                                                            {6689}new TTL_6231: bitstring;
                                                            {6690}let wNs_6232: bitstring = enc(Ns_6229,pkCli_6171) in
                                                            {6691}let m2_6233: bitstring = (OpenSecureChannelResponse,wNs_6232,ST_6230,TTL_6231) in
                                                            {6692}out(c, (enc(m2_6233,pkCli_6171),sign(h(m2_6233),skSess)));
                                                            {6693}let Ksrv_6234: bitstring = h((Ns_6229,Nc_6228)) in
                                                            {6694}out(c, senc(mSrv(pkCli_6171,pkSess_5906),Ksrv_6234))
                                            )
                                            else
                                                {6695}let pkDisco_6235: bitstring = fail-any in
                                                {6696}in(c, (=pkCli_6171,em1_6236: bitstring,sigM1_6237: bitstring));
                                                {6697}let m1_6238: bitstring = dec(em1_6236,skSess) in
                                                {6698}if (verify(h(m1_6238),sigM1_6237,pkCli_6171) <> true) then
                                                    0
                                                else
                                                    {6699}let (=OpenSecureChannelRequest,=pkCli_6171,wNc_6239: bitstring) = m1_6238 in
                                                    {6700}let Nc_6240: bitstring = dec(wNc_6239,skSess) in
                                                    {6701}new Ns_6241: bitstring;
                                                    {6702}new ST_6242: bitstring;
                                                    {6703}new TTL_6243: bitstring;
                                                    {6704}let wNs_6244: bitstring = enc(Ns_6241,pkCli_6171) in
                                                    {6705}let m2_6245: bitstring = (OpenSecureChannelResponse,wNs_6244,ST_6242,TTL_6243) in
                                                    {6706}out(c, (enc(m2_6245,pkCli_6171),sign(h(m2_6245),skSess)));
                                                    {6707}let Ksrv_6246: bitstring = h((Ns_6241,Nc_6240)) in
                                                    {6708}out(c, senc(mSrv(pkCli_6171,pkSess_5906),Ksrv_6246))
                                    )
                                    else
                                        {6709}let pkDisco_6247: bitstring = fail-any in
                                        {6710}in(c, (=pkCli_6171,em1_6248: bitstring,sigM1_6249: bitstring));
                                        {6711}let m1_6250: bitstring = dec(em1_6248,skSess) in
                                        {6712}if (verify(h(m1_6250),sigM1_6249,pkCli_6171) <> true) then
                                            0
                                        else
                                            {6713}let (=OpenSecureChannelRequest,=pkCli_6171,wNc_6251: bitstring) = m1_6250 in
                                            {6714}let Nc_6252: bitstring = dec(wNc_6251,skSess) in
                                            {6715}new Ns_6253: bitstring;
                                            {6716}new ST_6254: bitstring;
                                            {6717}new TTL_6255: bitstring;
                                            {6718}let wNs_6256: bitstring = enc(Ns_6253,pkCli_6171) in
                                            {6719}let m2_6257: bitstring = (OpenSecureChannelResponse,wNs_6256,ST_6254,TTL_6255) in
                                            {6720}out(c, (enc(m2_6257,pkCli_6171),sign(h(m2_6257),skSess)));
                                            {6721}let Ksrv_6258: bitstring = h((Ns_6253,Nc_6252)) in
                                            {6722}out(c, senc(mSrv(pkCli_6171,pkSess_5906),Ksrv_6258))
                            )
                            else
                                {6723}let pkCli_6259: bitstring = fail-any in
                                {6724}let v_6260: bool = (Disco_5903 = A) in
                                (
                                    {6725}if v_6260 then
                                    (
                                        {6726}let pkDisco_6261: bitstring = pub(skA) in
                                        {6727}in(c, (=pkCli_6259,em1_6262: bitstring,sigM1_6263: bitstring));
                                        {6728}let m1_6264: bitstring = dec(em1_6262,skSess) in
                                        {6729}if (verify(h(m1_6264),sigM1_6263,pkCli_6259) <> true) then
                                            0
                                        else
                                            {6730}let (=OpenSecureChannelRequest,=pkCli_6259,wNc_6265: bitstring) = m1_6264 in
                                            {6731}let Nc_6266: bitstring = dec(wNc_6265,skSess) in
                                            {6732}new Ns_6267: bitstring;
                                            {6733}new ST_6268: bitstring;
                                            {6734}new TTL_6269: bitstring;
                                            {6735}let wNs_6270: bitstring = enc(Ns_6267,pkCli_6259) in
                                            {6736}let m2_6271: bitstring = (OpenSecureChannelResponse,wNs_6270,ST_6268,TTL_6269) in
                                            {6737}out(c, (enc(m2_6271,pkCli_6259),sign(h(m2_6271),skSess)));
                                            {6738}let Ksrv_6272: bitstring = h((Ns_6267,Nc_6266)) in
                                            {6739}out(c, senc(mSrv(pkCli_6259,pkSess_5906),Ksrv_6272))
                                    )
                                    else
                                        {6740}let v_6273: bool = (Disco_5903 = B) in
                                        (
                                            {6741}if v_6273 then
                                            (
                                                {6742}let pkDisco_6274: bitstring = pub(skB) in
                                                {6743}in(c, (=pkCli_6259,em1_6275: bitstring,sigM1_6276: bitstring));
                                                {6744}let m1_6277: bitstring = dec(em1_6275,skSess) in
                                                {6745}if (verify(h(m1_6277),sigM1_6276,pkCli_6259) <> true) then
                                                    0
                                                else
                                                    {6746}let (=OpenSecureChannelRequest,=pkCli_6259,wNc_6278: bitstring) = m1_6277 in
                                                    {6747}let Nc_6279: bitstring = dec(wNc_6278,skSess) in
                                                    {6748}new Ns_6280: bitstring;
                                                    {6749}new ST_6281: bitstring;
                                                    {6750}new TTL_6282: bitstring;
                                                    {6751}let wNs_6283: bitstring = enc(Ns_6280,pkCli_6259) in
                                                    {6752}let m2_6284: bitstring = (OpenSecureChannelResponse,wNs_6283,ST_6281,TTL_6282) in
                                                    {6753}out(c, (enc(m2_6284,pkCli_6259),sign(h(m2_6284),skSess)));
                                                    {6754}let Ksrv_6285: bitstring = h((Ns_6280,Nc_6279)) in
                                                    {6755}out(c, senc(mSrv(pkCli_6259,pkSess_5906),Ksrv_6285))
                                            )
                                            else
                                                {6756}let v_6286: bool = (Disco_5903 = C) in
                                                (
                                                    {6757}if v_6286 then
                                                    (
                                                        {6758}let pkDisco_6287: bitstring = pub(skC) in
                                                        {6759}in(c, (=pkCli_6259,em1_6288: bitstring,sigM1_6289: bitstring));
                                                        {6760}let m1_6290: bitstring = dec(em1_6288,skSess) in
                                                        {6761}if (verify(h(m1_6290),sigM1_6289,pkCli_6259) <> true) then
                                                            0
                                                        else
                                                            {6762}let (=OpenSecureChannelRequest,=pkCli_6259,wNc_6291: bitstring) = m1_6290 in
                                                            {6763}let Nc_6292: bitstring = dec(wNc_6291,skSess) in
                                                            {6764}new Ns_6293: bitstring;
                                                            {6765}new ST_6294: bitstring;
                                                            {6766}new TTL_6295: bitstring;
                                                            {6767}let wNs_6296: bitstring = enc(Ns_6293,pkCli_6259) in
                                                            {6768}let m2_6297: bitstring = (OpenSecureChannelResponse,wNs_6296,ST_6294,TTL_6295) in
                                                            {6769}out(c, (enc(m2_6297,pkCli_6259),sign(h(m2_6297),skSess)));
                                                            {6770}let Ksrv_6298: bitstring = h((Ns_6293,Nc_6292)) in
                                                            {6771}out(c, senc(mSrv(pkCli_6259,pkSess_5906),Ksrv_6298))
                                                    )
                                                    else
                                                        {6772}let pkDisco_6299: bitstring = pub(sk(Disco_5903)) in
                                                        {6773}in(c, (=pkCli_6259,em1_6300: bitstring,sigM1_6301: bitstring));
                                                        {6774}let m1_6302: bitstring = dec(em1_6300,skSess) in
                                                        {6775}if (verify(h(m1_6302),sigM1_6301,pkCli_6259) <> true) then
                                                            0
                                                        else
                                                            {6776}let (=OpenSecureChannelRequest,=pkCli_6259,wNc_6303: bitstring) = m1_6302 in
                                                            {6777}let Nc_6304: bitstring = dec(wNc_6303,skSess) in
                                                            {6778}new Ns_6305: bitstring;
                                                            {6779}new ST_6306: bitstring;
                                                            {6780}new TTL_6307: bitstring;
                                                            {6781}let wNs_6308: bitstring = enc(Ns_6305,pkCli_6259) in
                                                            {6782}let m2_6309: bitstring = (OpenSecureChannelResponse,wNs_6308,ST_6306,TTL_6307) in
                                                            {6783}out(c, (enc(m2_6309,pkCli_6259),sign(h(m2_6309),skSess)));
                                                            {6784}let Ksrv_6310: bitstring = h((Ns_6305,Nc_6304)) in
                                                            {6785}out(c, senc(mSrv(pkCli_6259,pkSess_5906),Ksrv_6310))
                                                )
                                                else
                                                    {6786}let pkDisco_6311: bitstring = fail-any in
                                                    {6787}in(c, (=pkCli_6259,em1_6312: bitstring,sigM1_6313: bitstring));
                                                    {6788}let m1_6314: bitstring = dec(em1_6312,skSess) in
                                                    {6789}if (verify(h(m1_6314),sigM1_6313,pkCli_6259) <> true) then
                                                        0
                                                    else
                                                        {6790}let (=OpenSecureChannelRequest,=pkCli_6259,wNc_6315: bitstring) = m1_6314 in
                                                        {6791}let Nc_6316: bitstring = dec(wNc_6315,skSess) in
                                                        {6792}new Ns_6317: bitstring;
                                                        {6793}new ST_6318: bitstring;
                                                        {6794}new TTL_6319: bitstring;
                                                        {6795}let wNs_6320: bitstring = enc(Ns_6317,pkCli_6259) in
                                                        {6796}let m2_6321: bitstring = (OpenSecureChannelResponse,wNs_6320,ST_6318,TTL_6319) in
                                                        {6797}out(c, (enc(m2_6321,pkCli_6259),sign(h(m2_6321),skSess)));
                                                        {6798}let Ksrv_6322: bitstring = h((Ns_6317,Nc_6316)) in
                                                        {6799}out(c, senc(mSrv(pkCli_6259,pkSess_5906),Ksrv_6322))
                                        )
                                        else
                                            {6800}let pkDisco_6323: bitstring = fail-any in
                                            {6801}in(c, (=pkCli_6259,em1_6324: bitstring,sigM1_6325: bitstring));
                                            {6802}let m1_6326: bitstring = dec(em1_6324,skSess) in
                                            {6803}if (verify(h(m1_6326),sigM1_6325,pkCli_6259) <> true) then
                                                0
                                            else
                                                {6804}let (=OpenSecureChannelRequest,=pkCli_6259,wNc_6327: bitstring) = m1_6326 in
                                                {6805}let Nc_6328: bitstring = dec(wNc_6327,skSess) in
                                                {6806}new Ns_6329: bitstring;
                                                {6807}new ST_6330: bitstring;
                                                {6808}new TTL_6331: bitstring;
                                                {6809}let wNs_6332: bitstring = enc(Ns_6329,pkCli_6259) in
                                                {6810}let m2_6333: bitstring = (OpenSecureChannelResponse,wNs_6332,ST_6330,TTL_6331) in
                                                {6811}out(c, (enc(m2_6333,pkCli_6259),sign(h(m2_6333),skSess)));
                                                {6812}let Ksrv_6334: bitstring = h((Ns_6329,Nc_6328)) in
                                                {6813}out(c, senc(mSrv(pkCli_6259,pkSess_5906),Ksrv_6334))
                                )
                                else
                                    {6814}let pkDisco_6335: bitstring = fail-any in
                                    {6815}in(c, (=pkCli_6259,em1_6336: bitstring,sigM1_6337: bitstring));
                                    {6816}let m1_6338: bitstring = dec(em1_6336,skSess) in
                                    {6817}if (verify(h(m1_6338),sigM1_6337,pkCli_6259) <> true) then
                                        0
                                    else
                                        {6818}let (=OpenSecureChannelRequest,=pkCli_6259,wNc_6339: bitstring) = m1_6338 in
                                        {6819}let Nc_6340: bitstring = dec(wNc_6339,skSess) in
                                        {6820}new Ns_6341: bitstring;
                                        {6821}new ST_6342: bitstring;
                                        {6822}new TTL_6343: bitstring;
                                        {6823}let wNs_6344: bitstring = enc(Ns_6341,pkCli_6259) in
                                        {6824}let m2_6345: bitstring = (OpenSecureChannelResponse,wNs_6344,ST_6342,TTL_6343) in
                                        {6825}out(c, (enc(m2_6345,pkCli_6259),sign(h(m2_6345),skSess)));
                                        {6826}let Ksrv_6346: bitstring = h((Ns_6341,Nc_6340)) in
                                        {6827}out(c, senc(mSrv(pkCli_6259,pkSess_5906),Ksrv_6346))
                    )
                    else
                        {6828}let pkCli_6347: bitstring = fail-any in
                        {6829}let v_6348: bool = (Disco_5903 = A) in
                        (
                            {6830}if v_6348 then
                            (
                                {6831}let pkDisco_6349: bitstring = pub(skA) in
                                {6832}in(c, (=pkCli_6347,em1_6350: bitstring,sigM1_6351: bitstring));
                                {6833}let m1_6352: bitstring = dec(em1_6350,skSess) in
                                {6834}if (verify(h(m1_6352),sigM1_6351,pkCli_6347) <> true) then
                                    0
                                else
                                    {6835}let (=OpenSecureChannelRequest,=pkCli_6347,wNc_6353: bitstring) = m1_6352 in
                                    {6836}let Nc_6354: bitstring = dec(wNc_6353,skSess) in
                                    {6837}new Ns_6355: bitstring;
                                    {6838}new ST_6356: bitstring;
                                    {6839}new TTL_6357: bitstring;
                                    {6840}let wNs_6358: bitstring = enc(Ns_6355,pkCli_6347) in
                                    {6841}let m2_6359: bitstring = (OpenSecureChannelResponse,wNs_6358,ST_6356,TTL_6357) in
                                    {6842}out(c, (enc(m2_6359,pkCli_6347),sign(h(m2_6359),skSess)));
                                    {6843}let Ksrv_6360: bitstring = h((Ns_6355,Nc_6354)) in
                                    {6844}out(c, senc(mSrv(pkCli_6347,pkSess_5906),Ksrv_6360))
                            )
                            else
                                {6845}let v_6361: bool = (Disco_5903 = B) in
                                (
                                    {6846}if v_6361 then
                                    (
                                        {6847}let pkDisco_6362: bitstring = pub(skB) in
                                        {6848}in(c, (=pkCli_6347,em1_6363: bitstring,sigM1_6364: bitstring));
                                        {6849}let m1_6365: bitstring = dec(em1_6363,skSess) in
                                        {6850}if (verify(h(m1_6365),sigM1_6364,pkCli_6347) <> true) then
                                            0
                                        else
                                            {6851}let (=OpenSecureChannelRequest,=pkCli_6347,wNc_6366: bitstring) = m1_6365 in
                                            {6852}let Nc_6367: bitstring = dec(wNc_6366,skSess) in
                                            {6853}new Ns_6368: bitstring;
                                            {6854}new ST_6369: bitstring;
                                            {6855}new TTL_6370: bitstring;
                                            {6856}let wNs_6371: bitstring = enc(Ns_6368,pkCli_6347) in
                                            {6857}let m2_6372: bitstring = (OpenSecureChannelResponse,wNs_6371,ST_6369,TTL_6370) in
                                            {6858}out(c, (enc(m2_6372,pkCli_6347),sign(h(m2_6372),skSess)));
                                            {6859}let Ksrv_6373: bitstring = h((Ns_6368,Nc_6367)) in
                                            {6860}out(c, senc(mSrv(pkCli_6347,pkSess_5906),Ksrv_6373))
                                    )
                                    else
                                        {6861}let v_6374: bool = (Disco_5903 = C) in
                                        (
                                            {6862}if v_6374 then
                                            (
                                                {6863}let pkDisco_6375: bitstring = pub(skC) in
                                                {6864}in(c, (=pkCli_6347,em1_6376: bitstring,sigM1_6377: bitstring));
                                                {6865}let m1_6378: bitstring = dec(em1_6376,skSess) in
                                                {6866}if (verify(h(m1_6378),sigM1_6377,pkCli_6347) <> true) then
                                                    0
                                                else
                                                    {6867}let (=OpenSecureChannelRequest,=pkCli_6347,wNc_6379: bitstring) = m1_6378 in
                                                    {6868}let Nc_6380: bitstring = dec(wNc_6379,skSess) in
                                                    {6869}new Ns_6381: bitstring;
                                                    {6870}new ST_6382: bitstring;
                                                    {6871}new TTL_6383: bitstring;
                                                    {6872}let wNs_6384: bitstring = enc(Ns_6381,pkCli_6347) in
                                                    {6873}let m2_6385: bitstring = (OpenSecureChannelResponse,wNs_6384,ST_6382,TTL_6383) in
                                                    {6874}out(c, (enc(m2_6385,pkCli_6347),sign(h(m2_6385),skSess)));
                                                    {6875}let Ksrv_6386: bitstring = h((Ns_6381,Nc_6380)) in
                                                    {6876}out(c, senc(mSrv(pkCli_6347,pkSess_5906),Ksrv_6386))
                                            )
                                            else
                                                {6877}let pkDisco_6387: bitstring = pub(sk(Disco_5903)) in
                                                {6878}in(c, (=pkCli_6347,em1_6388: bitstring,sigM1_6389: bitstring));
                                                {6879}let m1_6390: bitstring = dec(em1_6388,skSess) in
                                                {6880}if (verify(h(m1_6390),sigM1_6389,pkCli_6347) <> true) then
                                                    0
                                                else
                                                    {6881}let (=OpenSecureChannelRequest,=pkCli_6347,wNc_6391: bitstring) = m1_6390 in
                                                    {6882}let Nc_6392: bitstring = dec(wNc_6391,skSess) in
                                                    {6883}new Ns_6393: bitstring;
                                                    {6884}new ST_6394: bitstring;
                                                    {6885}new TTL_6395: bitstring;
                                                    {6886}let wNs_6396: bitstring = enc(Ns_6393,pkCli_6347) in
                                                    {6887}let m2_6397: bitstring = (OpenSecureChannelResponse,wNs_6396,ST_6394,TTL_6395) in
                                                    {6888}out(c, (enc(m2_6397,pkCli_6347),sign(h(m2_6397),skSess)));
                                                    {6889}let Ksrv_6398: bitstring = h((Ns_6393,Nc_6392)) in
                                                    {6890}out(c, senc(mSrv(pkCli_6347,pkSess_5906),Ksrv_6398))
                                        )
                                        else
                                            {6891}let pkDisco_6399: bitstring = fail-any in
                                            {6892}in(c, (=pkCli_6347,em1_6400: bitstring,sigM1_6401: bitstring));
                                            {6893}let m1_6402: bitstring = dec(em1_6400,skSess) in
                                            {6894}if (verify(h(m1_6402),sigM1_6401,pkCli_6347) <> true) then
                                                0
                                            else
                                                {6895}let (=OpenSecureChannelRequest,=pkCli_6347,wNc_6403: bitstring) = m1_6402 in
                                                {6896}let Nc_6404: bitstring = dec(wNc_6403,skSess) in
                                                {6897}new Ns_6405: bitstring;
                                                {6898}new ST_6406: bitstring;
                                                {6899}new TTL_6407: bitstring;
                                                {6900}let wNs_6408: bitstring = enc(Ns_6405,pkCli_6347) in
                                                {6901}let m2_6409: bitstring = (OpenSecureChannelResponse,wNs_6408,ST_6406,TTL_6407) in
                                                {6902}out(c, (enc(m2_6409,pkCli_6347),sign(h(m2_6409),skSess)));
                                                {6903}let Ksrv_6410: bitstring = h((Ns_6405,Nc_6404)) in
                                                {6904}out(c, senc(mSrv(pkCli_6347,pkSess_5906),Ksrv_6410))
                                )
                                else
                                    {6905}let pkDisco_6411: bitstring = fail-any in
                                    {6906}in(c, (=pkCli_6347,em1_6412: bitstring,sigM1_6413: bitstring));
                                    {6907}let m1_6414: bitstring = dec(em1_6412,skSess) in
                                    {6908}if (verify(h(m1_6414),sigM1_6413,pkCli_6347) <> true) then
                                        0
                                    else
                                        {6909}let (=OpenSecureChannelRequest,=pkCli_6347,wNc_6415: bitstring) = m1_6414 in
                                        {6910}let Nc_6416: bitstring = dec(wNc_6415,skSess) in
                                        {6911}new Ns_6417: bitstring;
                                        {6912}new ST_6418: bitstring;
                                        {6913}new TTL_6419: bitstring;
                                        {6914}let wNs_6420: bitstring = enc(Ns_6417,pkCli_6347) in
                                        {6915}let m2_6421: bitstring = (OpenSecureChannelResponse,wNs_6420,ST_6418,TTL_6419) in
                                        {6916}out(c, (enc(m2_6421,pkCli_6347),sign(h(m2_6421),skSess)));
                                        {6917}let Ksrv_6422: bitstring = h((Ns_6417,Nc_6416)) in
                                        {6918}out(c, senc(mSrv(pkCli_6347,pkSess_5906),Ksrv_6422))
                        )
                        else
                            {6919}let pkDisco_6423: bitstring = fail-any in
                            {6920}in(c, (=pkCli_6347,em1_6424: bitstring,sigM1_6425: bitstring));
                            {6921}let m1_6426: bitstring = dec(em1_6424,skSess) in
                            {6922}if (verify(h(m1_6426),sigM1_6425,pkCli_6347) <> true) then
                                0
                            else
                                {6923}let (=OpenSecureChannelRequest,=pkCli_6347,wNc_6427: bitstring) = m1_6426 in
                                {6924}let Nc_6428: bitstring = dec(wNc_6427,skSess) in
                                {6925}new Ns_6429: bitstring;
                                {6926}new ST_6430: bitstring;
                                {6927}new TTL_6431: bitstring;
                                {6928}let wNs_6432: bitstring = enc(Ns_6429,pkCli_6347) in
                                {6929}let m2_6433: bitstring = (OpenSecureChannelResponse,wNs_6432,ST_6430,TTL_6431) in
                                {6930}out(c, (enc(m2_6433,pkCli_6347),sign(h(m2_6433),skSess)));
                                {6931}let Ksrv_6434: bitstring = h((Ns_6429,Nc_6428)) in
                                {6932}out(c, senc(mSrv(pkCli_6347,pkSess_5906),Ksrv_6434))
            )
            else
                {6933}let pkCli_6435: bitstring = fail-any in
                {6934}let v_6436: bool = (Disco_5903 = A) in
                (
                    {6935}if v_6436 then
                    (
                        {6936}let pkDisco_6437: bitstring = pub(skA) in
                        {6937}in(c, (=pkCli_6435,em1_6438: bitstring,sigM1_6439: bitstring));
                        {6938}let m1_6440: bitstring = dec(em1_6438,skSess) in
                        {6939}if (verify(h(m1_6440),sigM1_6439,pkCli_6435) <> true) then
                            0
                        else
                            {6940}let (=OpenSecureChannelRequest,=pkCli_6435,wNc_6441: bitstring) = m1_6440 in
                            {6941}let Nc_6442: bitstring = dec(wNc_6441,skSess) in
                            {6942}new Ns_6443: bitstring;
                            {6943}new ST_6444: bitstring;
                            {6944}new TTL_6445: bitstring;
                            {6945}let wNs_6446: bitstring = enc(Ns_6443,pkCli_6435) in
                            {6946}let m2_6447: bitstring = (OpenSecureChannelResponse,wNs_6446,ST_6444,TTL_6445) in
                            {6947}out(c, (enc(m2_6447,pkCli_6435),sign(h(m2_6447),skSess)));
                            {6948}let Ksrv_6448: bitstring = h((Ns_6443,Nc_6442)) in
                            {6949}out(c, senc(mSrv(pkCli_6435,pkSess_5906),Ksrv_6448))
                    )
                    else
                        {6950}let v_6449: bool = (Disco_5903 = B) in
                        (
                            {6951}if v_6449 then
                            (
                                {6952}let pkDisco_6450: bitstring = pub(skB) in
                                {6953}in(c, (=pkCli_6435,em1_6451: bitstring,sigM1_6452: bitstring));
                                {6954}let m1_6453: bitstring = dec(em1_6451,skSess) in
                                {6955}if (verify(h(m1_6453),sigM1_6452,pkCli_6435) <> true) then
                                    0
                                else
                                    {6956}let (=OpenSecureChannelRequest,=pkCli_6435,wNc_6454: bitstring) = m1_6453 in
                                    {6957}let Nc_6455: bitstring = dec(wNc_6454,skSess) in
                                    {6958}new Ns_6456: bitstring;
                                    {6959}new ST_6457: bitstring;
                                    {6960}new TTL_6458: bitstring;
                                    {6961}let wNs_6459: bitstring = enc(Ns_6456,pkCli_6435) in
                                    {6962}let m2_6460: bitstring = (OpenSecureChannelResponse,wNs_6459,ST_6457,TTL_6458) in
                                    {6963}out(c, (enc(m2_6460,pkCli_6435),sign(h(m2_6460),skSess)));
                                    {6964}let Ksrv_6461: bitstring = h((Ns_6456,Nc_6455)) in
                                    {6965}out(c, senc(mSrv(pkCli_6435,pkSess_5906),Ksrv_6461))
                            )
                            else
                                {6966}let v_6462: bool = (Disco_5903 = C) in
                                (
                                    {6967}if v_6462 then
                                    (
                                        {6968}let pkDisco_6463: bitstring = pub(skC) in
                                        {6969}in(c, (=pkCli_6435,em1_6464: bitstring,sigM1_6465: bitstring));
                                        {6970}let m1_6466: bitstring = dec(em1_6464,skSess) in
                                        {6971}if (verify(h(m1_6466),sigM1_6465,pkCli_6435) <> true) then
                                            0
                                        else
                                            {6972}let (=OpenSecureChannelRequest,=pkCli_6435,wNc_6467: bitstring) = m1_6466 in
                                            {6973}let Nc_6468: bitstring = dec(wNc_6467,skSess) in
                                            {6974}new Ns_6469: bitstring;
                                            {6975}new ST_6470: bitstring;
                                            {6976}new TTL_6471: bitstring;
                                            {6977}let wNs_6472: bitstring = enc(Ns_6469,pkCli_6435) in
                                            {6978}let m2_6473: bitstring = (OpenSecureChannelResponse,wNs_6472,ST_6470,TTL_6471) in
                                            {6979}out(c, (enc(m2_6473,pkCli_6435),sign(h(m2_6473),skSess)));
                                            {6980}let Ksrv_6474: bitstring = h((Ns_6469,Nc_6468)) in
                                            {6981}out(c, senc(mSrv(pkCli_6435,pkSess_5906),Ksrv_6474))
                                    )
                                    else
                                        {6982}let pkDisco_6475: bitstring = pub(sk(Disco_5903)) in
                                        {6983}in(c, (=pkCli_6435,em1_6476: bitstring,sigM1_6477: bitstring));
                                        {6984}let m1_6478: bitstring = dec(em1_6476,skSess) in
                                        {6985}if (verify(h(m1_6478),sigM1_6477,pkCli_6435) <> true) then
                                            0
                                        else
                                            {6986}let (=OpenSecureChannelRequest,=pkCli_6435,wNc_6479: bitstring) = m1_6478 in
                                            {6987}let Nc_6480: bitstring = dec(wNc_6479,skSess) in
                                            {6988}new Ns_6481: bitstring;
                                            {6989}new ST_6482: bitstring;
                                            {6990}new TTL_6483: bitstring;
                                            {6991}let wNs_6484: bitstring = enc(Ns_6481,pkCli_6435) in
                                            {6992}let m2_6485: bitstring = (OpenSecureChannelResponse,wNs_6484,ST_6482,TTL_6483) in
                                            {6993}out(c, (enc(m2_6485,pkCli_6435),sign(h(m2_6485),skSess)));
                                            {6994}let Ksrv_6486: bitstring = h((Ns_6481,Nc_6480)) in
                                            {6995}out(c, senc(mSrv(pkCli_6435,pkSess_5906),Ksrv_6486))
                                )
                                else
                                    {6996}let pkDisco_6487: bitstring = fail-any in
                                    {6997}in(c, (=pkCli_6435,em1_6488: bitstring,sigM1_6489: bitstring));
                                    {6998}let m1_6490: bitstring = dec(em1_6488,skSess) in
                                    {6999}if (verify(h(m1_6490),sigM1_6489,pkCli_6435) <> true) then
                                        0
                                    else
                                        {7000}let (=OpenSecureChannelRequest,=pkCli_6435,wNc_6491: bitstring) = m1_6490 in
                                        {7001}let Nc_6492: bitstring = dec(wNc_6491,skSess) in
                                        {7002}new Ns_6493: bitstring;
                                        {7003}new ST_6494: bitstring;
                                        {7004}new TTL_6495: bitstring;
                                        {7005}let wNs_6496: bitstring = enc(Ns_6493,pkCli_6435) in
                                        {7006}let m2_6497: bitstring = (OpenSecureChannelResponse,wNs_6496,ST_6494,TTL_6495) in
                                        {7007}out(c, (enc(m2_6497,pkCli_6435),sign(h(m2_6497),skSess)));
                                        {7008}let Ksrv_6498: bitstring = h((Ns_6493,Nc_6492)) in
                                        {7009}out(c, senc(mSrv(pkCli_6435,pkSess_5906),Ksrv_6498))
                        )
                        else
                            {7010}let pkDisco_6499: bitstring = fail-any in
                            {7011}in(c, (=pkCli_6435,em1_6500: bitstring,sigM1_6501: bitstring));
                            {7012}let m1_6502: bitstring = dec(em1_6500,skSess) in
                            {7013}if (verify(h(m1_6502),sigM1_6501,pkCli_6435) <> true) then
                                0
                            else
                                {7014}let (=OpenSecureChannelRequest,=pkCli_6435,wNc_6503: bitstring) = m1_6502 in
                                {7015}let Nc_6504: bitstring = dec(wNc_6503,skSess) in
                                {7016}new Ns_6505: bitstring;
                                {7017}new ST_6506: bitstring;
                                {7018}new TTL_6507: bitstring;
                                {7019}let wNs_6508: bitstring = enc(Ns_6505,pkCli_6435) in
                                {7020}let m2_6509: bitstring = (OpenSecureChannelResponse,wNs_6508,ST_6506,TTL_6507) in
                                {7021}out(c, (enc(m2_6509,pkCli_6435),sign(h(m2_6509),skSess)));
                                {7022}let Ksrv_6510: bitstring = h((Ns_6505,Nc_6504)) in
                                {7023}out(c, senc(mSrv(pkCli_6435,pkSess_5906),Ksrv_6510))
                )
                else
                    {7024}let pkDisco_6511: bitstring = fail-any in
                    {7025}in(c, (=pkCli_6435,em1_6512: bitstring,sigM1_6513: bitstring));
                    {7026}let m1_6514: bitstring = dec(em1_6512,skSess) in
                    {7027}if (verify(h(m1_6514),sigM1_6513,pkCli_6435) <> true) then
                        0
                    else
                        {7028}let (=OpenSecureChannelRequest,=pkCli_6435,wNc_6515: bitstring) = m1_6514 in
                        {7029}let Nc_6516: bitstring = dec(wNc_6515,skSess) in
                        {7030}new Ns_6517: bitstring;
                        {7031}new ST_6518: bitstring;
                        {7032}new TTL_6519: bitstring;
                        {7033}let wNs_6520: bitstring = enc(Ns_6517,pkCli_6435) in
                        {7034}let m2_6521: bitstring = (OpenSecureChannelResponse,wNs_6520,ST_6518,TTL_6519) in
                        {7035}out(c, (enc(m2_6521,pkCli_6435),sign(h(m2_6521),skSess)));
                        {7036}let Ksrv_6522: bitstring = h((Ns_6517,Nc_6516)) in
                        {7037}out(c, senc(mSrv(pkCli_6435,pkSess_5906),Ksrv_6522))
        )
        else
            {7038}let v_6523: bool = (Sess_5904 = B) in
            (
                {7039}if v_6523 then
                (
                    {7040}let skSess_6524: bitstring = skB in
                    {7041}let pkSess_6525: bitstring = pub(skSess_6524) in
                    {7042}let v_6526: bool = (Cli_5902 = A) in
                    (
                        {7043}if v_6526 then
                        (
                            {7044}let pkCli_6527: bitstring = pub(skA) in
                            {7045}let v_6528: bool = (Disco_5903 = A) in
                            (
                                {7046}if v_6528 then
                                (
                                    {7047}let pkDisco_6529: bitstring = pub(skA) in
                                    {7048}in(c, (=pkCli_6527,em1_6530: bitstring,sigM1_6531: bitstring));
                                    {7049}let m1_6532: bitstring = dec(em1_6530,skSess_6524) in
                                    {7050}if (verify(h(m1_6532),sigM1_6531,pkCli_6527) <> true) then
                                        0
                                    else
                                        {7051}let (=OpenSecureChannelRequest,=pkCli_6527,wNc_6533: bitstring) = m1_6532 in
                                        {7052}let Nc_6534: bitstring = dec(wNc_6533,skSess_6524) in
                                        {7053}new Ns_6535: bitstring;
                                        {7054}new ST_6536: bitstring;
                                        {7055}new TTL_6537: bitstring;
                                        {7056}let wNs_6538: bitstring = enc(Ns_6535,pkCli_6527) in
                                        {7057}let m2_6539: bitstring = (OpenSecureChannelResponse,wNs_6538,ST_6536,TTL_6537) in
                                        {7058}out(c, (enc(m2_6539,pkCli_6527),sign(h(m2_6539),skSess_6524)));
                                        {7059}let Ksrv_6540: bitstring = h((Ns_6535,Nc_6534)) in
                                        {7060}out(c, senc(mSrv(pkCli_6527,pkSess_6525),Ksrv_6540))
                                )
                                else
                                    {7061}let v_6541: bool = (Disco_5903 = B) in
                                    (
                                        {7062}if v_6541 then
                                        (
                                            {7063}let pkDisco_6542: bitstring = pub(skB) in
                                            {7064}in(c, (=pkCli_6527,em1_6543: bitstring,sigM1_6544: bitstring));
                                            {7065}let m1_6545: bitstring = dec(em1_6543,skSess_6524) in
                                            {7066}if (verify(h(m1_6545),sigM1_6544,pkCli_6527) <> true) then
                                                0
                                            else
                                                {7067}let (=OpenSecureChannelRequest,=pkCli_6527,wNc_6546: bitstring) = m1_6545 in
                                                {7068}let Nc_6547: bitstring = dec(wNc_6546,skSess_6524) in
                                                {7069}new Ns_6548: bitstring;
                                                {7070}new ST_6549: bitstring;
                                                {7071}new TTL_6550: bitstring;
                                                {7072}let wNs_6551: bitstring = enc(Ns_6548,pkCli_6527) in
                                                {7073}let m2_6552: bitstring = (OpenSecureChannelResponse,wNs_6551,ST_6549,TTL_6550) in
                                                {7074}out(c, (enc(m2_6552,pkCli_6527),sign(h(m2_6552),skSess_6524)));
                                                {7075}let Ksrv_6553: bitstring = h((Ns_6548,Nc_6547)) in
                                                {7076}out(c, senc(mSrv(pkCli_6527,pkSess_6525),Ksrv_6553))
                                        )
                                        else
                                            {7077}let v_6554: bool = (Disco_5903 = C) in
                                            (
                                                {7078}if v_6554 then
                                                (
                                                    {7079}let pkDisco_6555: bitstring = pub(skC) in
                                                    {7080}in(c, (=pkCli_6527,em1_6556: bitstring,sigM1_6557: bitstring));
                                                    {7081}let m1_6558: bitstring = dec(em1_6556,skSess_6524) in
                                                    {7082}if (verify(h(m1_6558),sigM1_6557,pkCli_6527) <> true) then
                                                        0
                                                    else
                                                        {7083}let (=OpenSecureChannelRequest,=pkCli_6527,wNc_6559: bitstring) = m1_6558 in
                                                        {7084}let Nc_6560: bitstring = dec(wNc_6559,skSess_6524) in
                                                        {7085}new Ns_6561: bitstring;
                                                        {7086}new ST_6562: bitstring;
                                                        {7087}new TTL_6563: bitstring;
                                                        {7088}let wNs_6564: bitstring = enc(Ns_6561,pkCli_6527) in
                                                        {7089}let m2_6565: bitstring = (OpenSecureChannelResponse,wNs_6564,ST_6562,TTL_6563) in
                                                        {7090}out(c, (enc(m2_6565,pkCli_6527),sign(h(m2_6565),skSess_6524)));
                                                        {7091}let Ksrv_6566: bitstring = h((Ns_6561,Nc_6560)) in
                                                        {7092}out(c, senc(mSrv(pkCli_6527,pkSess_6525),Ksrv_6566))
                                                )
                                                else
                                                    {7093}let pkDisco_6567: bitstring = pub(sk(Disco_5903)) in
                                                    {7094}in(c, (=pkCli_6527,em1_6568: bitstring,sigM1_6569: bitstring));
                                                    {7095}let m1_6570: bitstring = dec(em1_6568,skSess_6524) in
                                                    {7096}if (verify(h(m1_6570),sigM1_6569,pkCli_6527) <> true) then
                                                        0
                                                    else
                                                        {7097}let (=OpenSecureChannelRequest,=pkCli_6527,wNc_6571: bitstring) = m1_6570 in
                                                        {7098}let Nc_6572: bitstring = dec(wNc_6571,skSess_6524) in
                                                        {7099}new Ns_6573: bitstring;
                                                        {7100}new ST_6574: bitstring;
                                                        {7101}new TTL_6575: bitstring;
                                                        {7102}let wNs_6576: bitstring = enc(Ns_6573,pkCli_6527) in
                                                        {7103}let m2_6577: bitstring = (OpenSecureChannelResponse,wNs_6576,ST_6574,TTL_6575) in
                                                        {7104}out(c, (enc(m2_6577,pkCli_6527),sign(h(m2_6577),skSess_6524)));
                                                        {7105}let Ksrv_6578: bitstring = h((Ns_6573,Nc_6572)) in
                                                        {7106}out(c, senc(mSrv(pkCli_6527,pkSess_6525),Ksrv_6578))
                                            )
                                            else
                                                {7107}let pkDisco_6579: bitstring = fail-any in
                                                {7108}in(c, (=pkCli_6527,em1_6580: bitstring,sigM1_6581: bitstring));
                                                {7109}let m1_6582: bitstring = dec(em1_6580,skSess_6524) in
                                                {7110}if (verify(h(m1_6582),sigM1_6581,pkCli_6527) <> true) then
                                                    0
                                                else
                                                    {7111}let (=OpenSecureChannelRequest,=pkCli_6527,wNc_6583: bitstring) = m1_6582 in
                                                    {7112}let Nc_6584: bitstring = dec(wNc_6583,skSess_6524) in
                                                    {7113}new Ns_6585: bitstring;
                                                    {7114}new ST_6586: bitstring;
                                                    {7115}new TTL_6587: bitstring;
                                                    {7116}let wNs_6588: bitstring = enc(Ns_6585,pkCli_6527) in
                                                    {7117}let m2_6589: bitstring = (OpenSecureChannelResponse,wNs_6588,ST_6586,TTL_6587) in
                                                    {7118}out(c, (enc(m2_6589,pkCli_6527),sign(h(m2_6589),skSess_6524)));
                                                    {7119}let Ksrv_6590: bitstring = h((Ns_6585,Nc_6584)) in
                                                    {7120}out(c, senc(mSrv(pkCli_6527,pkSess_6525),Ksrv_6590))
                                    )
                                    else
                                        {7121}let pkDisco_6591: bitstring = fail-any in
                                        {7122}in(c, (=pkCli_6527,em1_6592: bitstring,sigM1_6593: bitstring));
                                        {7123}let m1_6594: bitstring = dec(em1_6592,skSess_6524) in
                                        {7124}if (verify(h(m1_6594),sigM1_6593,pkCli_6527) <> true) then
                                            0
                                        else
                                            {7125}let (=OpenSecureChannelRequest,=pkCli_6527,wNc_6595: bitstring) = m1_6594 in
                                            {7126}let Nc_6596: bitstring = dec(wNc_6595,skSess_6524) in
                                            {7127}new Ns_6597: bitstring;
                                            {7128}new ST_6598: bitstring;
                                            {7129}new TTL_6599: bitstring;
                                            {7130}let wNs_6600: bitstring = enc(Ns_6597,pkCli_6527) in
                                            {7131}let m2_6601: bitstring = (OpenSecureChannelResponse,wNs_6600,ST_6598,TTL_6599) in
                                            {7132}out(c, (enc(m2_6601,pkCli_6527),sign(h(m2_6601),skSess_6524)));
                                            {7133}let Ksrv_6602: bitstring = h((Ns_6597,Nc_6596)) in
                                            {7134}out(c, senc(mSrv(pkCli_6527,pkSess_6525),Ksrv_6602))
                            )
                            else
                                {7135}let pkDisco_6603: bitstring = fail-any in
                                {7136}in(c, (=pkCli_6527,em1_6604: bitstring,sigM1_6605: bitstring));
                                {7137}let m1_6606: bitstring = dec(em1_6604,skSess_6524) in
                                {7138}if (verify(h(m1_6606),sigM1_6605,pkCli_6527) <> true) then
                                    0
                                else
                                    {7139}let (=OpenSecureChannelRequest,=pkCli_6527,wNc_6607: bitstring) = m1_6606 in
                                    {7140}let Nc_6608: bitstring = dec(wNc_6607,skSess_6524) in
                                    {7141}new Ns_6609: bitstring;
                                    {7142}new ST_6610: bitstring;
                                    {7143}new TTL_6611: bitstring;
                                    {7144}let wNs_6612: bitstring = enc(Ns_6609,pkCli_6527) in
                                    {7145}let m2_6613: bitstring = (OpenSecureChannelResponse,wNs_6612,ST_6610,TTL_6611) in
                                    {7146}out(c, (enc(m2_6613,pkCli_6527),sign(h(m2_6613),skSess_6524)));
                                    {7147}let Ksrv_6614: bitstring = h((Ns_6609,Nc_6608)) in
                                    {7148}out(c, senc(mSrv(pkCli_6527,pkSess_6525),Ksrv_6614))
                        )
                        else
                            {7149}let v_6615: bool = (Cli_5902 = B) in
                            (
                                {7150}if v_6615 then
                                (
                                    {7151}let pkCli_6616: bitstring = pub(skB) in
                                    {7152}let v_6617: bool = (Disco_5903 = A) in
                                    (
                                        {7153}if v_6617 then
                                        (
                                            {7154}let pkDisco_6618: bitstring = pub(skA) in
                                            {7155}in(c, (=pkCli_6616,em1_6619: bitstring,sigM1_6620: bitstring));
                                            {7156}let m1_6621: bitstring = dec(em1_6619,skSess_6524) in
                                            {7157}if (verify(h(m1_6621),sigM1_6620,pkCli_6616) <> true) then
                                                0
                                            else
                                                {7158}let (=OpenSecureChannelRequest,=pkCli_6616,wNc_6622: bitstring) = m1_6621 in
                                                {7159}let Nc_6623: bitstring = dec(wNc_6622,skSess_6524) in
                                                {7160}new Ns_6624: bitstring;
                                                {7161}new ST_6625: bitstring;
                                                {7162}new TTL_6626: bitstring;
                                                {7163}let wNs_6627: bitstring = enc(Ns_6624,pkCli_6616) in
                                                {7164}let m2_6628: bitstring = (OpenSecureChannelResponse,wNs_6627,ST_6625,TTL_6626) in
                                                {7165}out(c, (enc(m2_6628,pkCli_6616),sign(h(m2_6628),skSess_6524)));
                                                {7166}let Ksrv_6629: bitstring = h((Ns_6624,Nc_6623)) in
                                                {7167}out(c, senc(mSrv(pkCli_6616,pkSess_6525),Ksrv_6629))
                                        )
                                        else
                                            {7168}let v_6630: bool = (Disco_5903 = B) in
                                            (
                                                {7169}if v_6630 then
                                                (
                                                    {7170}let pkDisco_6631: bitstring = pub(skB) in
                                                    {7171}in(c, (=pkCli_6616,em1_6632: bitstring,sigM1_6633: bitstring));
                                                    {7172}let m1_6634: bitstring = dec(em1_6632,skSess_6524) in
                                                    {7173}if (verify(h(m1_6634),sigM1_6633,pkCli_6616) <> true) then
                                                        0
                                                    else
                                                        {7174}let (=OpenSecureChannelRequest,=pkCli_6616,wNc_6635: bitstring) = m1_6634 in
                                                        {7175}let Nc_6636: bitstring = dec(wNc_6635,skSess_6524) in
                                                        {7176}new Ns_6637: bitstring;
                                                        {7177}new ST_6638: bitstring;
                                                        {7178}new TTL_6639: bitstring;
                                                        {7179}let wNs_6640: bitstring = enc(Ns_6637,pkCli_6616) in
                                                        {7180}let m2_6641: bitstring = (OpenSecureChannelResponse,wNs_6640,ST_6638,TTL_6639) in
                                                        {7181}out(c, (enc(m2_6641,pkCli_6616),sign(h(m2_6641),skSess_6524)));
                                                        {7182}let Ksrv_6642: bitstring = h((Ns_6637,Nc_6636)) in
                                                        {7183}out(c, senc(mSrv(pkCli_6616,pkSess_6525),Ksrv_6642))
                                                )
                                                else
                                                    {7184}let v_6643: bool = (Disco_5903 = C) in
                                                    (
                                                        {7185}if v_6643 then
                                                        (
                                                            {7186}let pkDisco_6644: bitstring = pub(skC) in
                                                            {7187}in(c, (=pkCli_6616,em1_6645: bitstring,sigM1_6646: bitstring));
                                                            {7188}let m1_6647: bitstring = dec(em1_6645,skSess_6524) in
                                                            {7189}if (verify(h(m1_6647),sigM1_6646,pkCli_6616) <> true) then
                                                                0
                                                            else
                                                                {7190}let (=OpenSecureChannelRequest,=pkCli_6616,wNc_6648: bitstring) = m1_6647 in
                                                                {7191}let Nc_6649: bitstring = dec(wNc_6648,skSess_6524) in
                                                                {7192}new Ns_6650: bitstring;
                                                                {7193}new ST_6651: bitstring;
                                                                {7194}new TTL_6652: bitstring;
                                                                {7195}let wNs_6653: bitstring = enc(Ns_6650,pkCli_6616) in
                                                                {7196}let m2_6654: bitstring = (OpenSecureChannelResponse,wNs_6653,ST_6651,TTL_6652) in
                                                                {7197}out(c, (enc(m2_6654,pkCli_6616),sign(h(m2_6654),skSess_6524)));
                                                                {7198}let Ksrv_6655: bitstring = h((Ns_6650,Nc_6649)) in
                                                                {7199}out(c, senc(mSrv(pkCli_6616,pkSess_6525),Ksrv_6655))
                                                        )
                                                        else
                                                            {7200}let pkDisco_6656: bitstring = pub(sk(Disco_5903)) in
                                                            {7201}in(c, (=pkCli_6616,em1_6657: bitstring,sigM1_6658: bitstring));
                                                            {7202}let m1_6659: bitstring = dec(em1_6657,skSess_6524) in
                                                            {7203}if (verify(h(m1_6659),sigM1_6658,pkCli_6616) <> true) then
                                                                0
                                                            else
                                                                {7204}let (=OpenSecureChannelRequest,=pkCli_6616,wNc_6660: bitstring) = m1_6659 in
                                                                {7205}let Nc_6661: bitstring = dec(wNc_6660,skSess_6524) in
                                                                {7206}new Ns_6662: bitstring;
                                                                {7207}new ST_6663: bitstring;
                                                                {7208}new TTL_6664: bitstring;
                                                                {7209}let wNs_6665: bitstring = enc(Ns_6662,pkCli_6616) in
                                                                {7210}let m2_6666: bitstring = (OpenSecureChannelResponse,wNs_6665,ST_6663,TTL_6664) in
                                                                {7211}out(c, (enc(m2_6666,pkCli_6616),sign(h(m2_6666),skSess_6524)));
                                                                {7212}let Ksrv_6667: bitstring = h((Ns_6662,Nc_6661)) in
                                                                {7213}out(c, senc(mSrv(pkCli_6616,pkSess_6525),Ksrv_6667))
                                                    )
                                                    else
                                                        {7214}let pkDisco_6668: bitstring = fail-any in
                                                        {7215}in(c, (=pkCli_6616,em1_6669: bitstring,sigM1_6670: bitstring));
                                                        {7216}let m1_6671: bitstring = dec(em1_6669,skSess_6524) in
                                                        {7217}if (verify(h(m1_6671),sigM1_6670,pkCli_6616) <> true) then
                                                            0
                                                        else
                                                            {7218}let (=OpenSecureChannelRequest,=pkCli_6616,wNc_6672: bitstring) = m1_6671 in
                                                            {7219}let Nc_6673: bitstring = dec(wNc_6672,skSess_6524) in
                                                            {7220}new Ns_6674: bitstring;
                                                            {7221}new ST_6675: bitstring;
                                                            {7222}new TTL_6676: bitstring;
                                                            {7223}let wNs_6677: bitstring = enc(Ns_6674,pkCli_6616) in
                                                            {7224}let m2_6678: bitstring = (OpenSecureChannelResponse,wNs_6677,ST_6675,TTL_6676) in
                                                            {7225}out(c, (enc(m2_6678,pkCli_6616),sign(h(m2_6678),skSess_6524)));
                                                            {7226}let Ksrv_6679: bitstring = h((Ns_6674,Nc_6673)) in
                                                            {7227}out(c, senc(mSrv(pkCli_6616,pkSess_6525),Ksrv_6679))
                                            )
                                            else
                                                {7228}let pkDisco_6680: bitstring = fail-any in
                                                {7229}in(c, (=pkCli_6616,em1_6681: bitstring,sigM1_6682: bitstring));
                                                {7230}let m1_6683: bitstring = dec(em1_6681,skSess_6524) in
                                                {7231}if (verify(h(m1_6683),sigM1_6682,pkCli_6616) <> true) then
                                                    0
                                                else
                                                    {7232}let (=OpenSecureChannelRequest,=pkCli_6616,wNc_6684: bitstring) = m1_6683 in
                                                    {7233}let Nc_6685: bitstring = dec(wNc_6684,skSess_6524) in
                                                    {7234}new Ns_6686: bitstring;
                                                    {7235}new ST_6687: bitstring;
                                                    {7236}new TTL_6688: bitstring;
                                                    {7237}let wNs_6689: bitstring = enc(Ns_6686,pkCli_6616) in
                                                    {7238}let m2_6690: bitstring = (OpenSecureChannelResponse,wNs_6689,ST_6687,TTL_6688) in
                                                    {7239}out(c, (enc(m2_6690,pkCli_6616),sign(h(m2_6690),skSess_6524)));
                                                    {7240}let Ksrv_6691: bitstring = h((Ns_6686,Nc_6685)) in
                                                    {7241}out(c, senc(mSrv(pkCli_6616,pkSess_6525),Ksrv_6691))
                                    )
                                    else
                                        {7242}let pkDisco_6692: bitstring = fail-any in
                                        {7243}in(c, (=pkCli_6616,em1_6693: bitstring,sigM1_6694: bitstring));
                                        {7244}let m1_6695: bitstring = dec(em1_6693,skSess_6524) in
                                        {7245}if (verify(h(m1_6695),sigM1_6694,pkCli_6616) <> true) then
                                            0
                                        else
                                            {7246}let (=OpenSecureChannelRequest,=pkCli_6616,wNc_6696: bitstring) = m1_6695 in
                                            {7247}let Nc_6697: bitstring = dec(wNc_6696,skSess_6524) in
                                            {7248}new Ns_6698: bitstring;
                                            {7249}new ST_6699: bitstring;
                                            {7250}new TTL_6700: bitstring;
                                            {7251}let wNs_6701: bitstring = enc(Ns_6698,pkCli_6616) in
                                            {7252}let m2_6702: bitstring = (OpenSecureChannelResponse,wNs_6701,ST_6699,TTL_6700) in
                                            {7253}out(c, (enc(m2_6702,pkCli_6616),sign(h(m2_6702),skSess_6524)));
                                            {7254}let Ksrv_6703: bitstring = h((Ns_6698,Nc_6697)) in
                                            {7255}out(c, senc(mSrv(pkCli_6616,pkSess_6525),Ksrv_6703))
                                )
                                else
                                    {7256}let v_6704: bool = (Cli_5902 = C) in
                                    (
                                        {7257}if v_6704 then
                                        (
                                            {7258}let pkCli_6705: bitstring = pub(skC) in
                                            {7259}let v_6706: bool = (Disco_5903 = A) in
                                            (
                                                {7260}if v_6706 then
                                                (
                                                    {7261}let pkDisco_6707: bitstring = pub(skA) in
                                                    {7262}in(c, (=pkCli_6705,em1_6708: bitstring,sigM1_6709: bitstring));
                                                    {7263}let m1_6710: bitstring = dec(em1_6708,skSess_6524) in
                                                    {7264}if (verify(h(m1_6710),sigM1_6709,pkCli_6705) <> true) then
                                                        0
                                                    else
                                                        {7265}let (=OpenSecureChannelRequest,=pkCli_6705,wNc_6711: bitstring) = m1_6710 in
                                                        {7266}let Nc_6712: bitstring = dec(wNc_6711,skSess_6524) in
                                                        {7267}new Ns_6713: bitstring;
                                                        {7268}new ST_6714: bitstring;
                                                        {7269}new TTL_6715: bitstring;
                                                        {7270}let wNs_6716: bitstring = enc(Ns_6713,pkCli_6705) in
                                                        {7271}let m2_6717: bitstring = (OpenSecureChannelResponse,wNs_6716,ST_6714,TTL_6715) in
                                                        {7272}out(c, (enc(m2_6717,pkCli_6705),sign(h(m2_6717),skSess_6524)));
                                                        {7273}let Ksrv_6718: bitstring = h((Ns_6713,Nc_6712)) in
                                                        {7274}out(c, senc(mSrv(pkCli_6705,pkSess_6525),Ksrv_6718))
                                                )
                                                else
                                                    {7275}let v_6719: bool = (Disco_5903 = B) in
                                                    (
                                                        {7276}if v_6719 then
                                                        (
                                                            {7277}let pkDisco_6720: bitstring = pub(skB) in
                                                            {7278}in(c, (=pkCli_6705,em1_6721: bitstring,sigM1_6722: bitstring));
                                                            {7279}let m1_6723: bitstring = dec(em1_6721,skSess_6524) in
                                                            {7280}if (verify(h(m1_6723),sigM1_6722,pkCli_6705) <> true) then
                                                                0
                                                            else
                                                                {7281}let (=OpenSecureChannelRequest,=pkCli_6705,wNc_6724: bitstring) = m1_6723 in
                                                                {7282}let Nc_6725: bitstring = dec(wNc_6724,skSess_6524) in
                                                                {7283}new Ns_6726: bitstring;
                                                                {7284}new ST_6727: bitstring;
                                                                {7285}new TTL_6728: bitstring;
                                                                {7286}let wNs_6729: bitstring = enc(Ns_6726,pkCli_6705) in
                                                                {7287}let m2_6730: bitstring = (OpenSecureChannelResponse,wNs_6729,ST_6727,TTL_6728) in
                                                                {7288}out(c, (enc(m2_6730,pkCli_6705),sign(h(m2_6730),skSess_6524)));
                                                                {7289}let Ksrv_6731: bitstring = h((Ns_6726,Nc_6725)) in
                                                                {7290}out(c, senc(mSrv(pkCli_6705,pkSess_6525),Ksrv_6731))
                                                        )
                                                        else
                                                            {7291}let v_6732: bool = (Disco_5903 = C) in
                                                            (
                                                                {7292}if v_6732 then
                                                                (
                                                                    {7293}let pkDisco_6733: bitstring = pub(skC) in
                                                                    {7294}in(c, (=pkCli_6705,em1_6734: bitstring,sigM1_6735: bitstring));
                                                                    {7295}let m1_6736: bitstring = dec(em1_6734,skSess_6524) in
                                                                    {7296}if (verify(h(m1_6736),sigM1_6735,pkCli_6705) <> true) then
                                                                        0
                                                                    else
                                                                        {7297}let (=OpenSecureChannelRequest,=pkCli_6705,wNc_6737: bitstring) = m1_6736 in
                                                                        {7298}let Nc_6738: bitstring = dec(wNc_6737,skSess_6524) in
                                                                        {7299}new Ns_6739: bitstring;
                                                                        {7300}new ST_6740: bitstring;
                                                                        {7301}new TTL_6741: bitstring;
                                                                        {7302}let wNs_6742: bitstring = enc(Ns_6739,pkCli_6705) in
                                                                        {7303}let m2_6743: bitstring = (OpenSecureChannelResponse,wNs_6742,ST_6740,TTL_6741) in
                                                                        {7304}out(c, (enc(m2_6743,pkCli_6705),sign(h(m2_6743),skSess_6524)));
                                                                        {7305}let Ksrv_6744: bitstring = h((Ns_6739,Nc_6738)) in
                                                                        {7306}out(c, senc(mSrv(pkCli_6705,pkSess_6525),Ksrv_6744))
                                                                )
                                                                else
                                                                    {7307}let pkDisco_6745: bitstring = pub(sk(Disco_5903)) in
                                                                    {7308}in(c, (=pkCli_6705,em1_6746: bitstring,sigM1_6747: bitstring));
                                                                    {7309}let m1_6748: bitstring = dec(em1_6746,skSess_6524) in
                                                                    {7310}if (verify(h(m1_6748),sigM1_6747,pkCli_6705) <> true) then
                                                                        0
                                                                    else
                                                                        {7311}let (=OpenSecureChannelRequest,=pkCli_6705,wNc_6749: bitstring) = m1_6748 in
                                                                        {7312}let Nc_6750: bitstring = dec(wNc_6749,skSess_6524) in
                                                                        {7313}new Ns_6751: bitstring;
                                                                        {7314}new ST_6752: bitstring;
                                                                        {7315}new TTL_6753: bitstring;
                                                                        {7316}let wNs_6754: bitstring = enc(Ns_6751,pkCli_6705) in
                                                                        {7317}let m2_6755: bitstring = (OpenSecureChannelResponse,wNs_6754,ST_6752,TTL_6753) in
                                                                        {7318}out(c, (enc(m2_6755,pkCli_6705),sign(h(m2_6755),skSess_6524)));
                                                                        {7319}let Ksrv_6756: bitstring = h((Ns_6751,Nc_6750)) in
                                                                        {7320}out(c, senc(mSrv(pkCli_6705,pkSess_6525),Ksrv_6756))
                                                            )
                                                            else
                                                                {7321}let pkDisco_6757: bitstring = fail-any in
                                                                {7322}in(c, (=pkCli_6705,em1_6758: bitstring,sigM1_6759: bitstring));
                                                                {7323}let m1_6760: bitstring = dec(em1_6758,skSess_6524) in
                                                                {7324}if (verify(h(m1_6760),sigM1_6759,pkCli_6705) <> true) then
                                                                    0
                                                                else
                                                                    {7325}let (=OpenSecureChannelRequest,=pkCli_6705,wNc_6761: bitstring) = m1_6760 in
                                                                    {7326}let Nc_6762: bitstring = dec(wNc_6761,skSess_6524) in
                                                                    {7327}new Ns_6763: bitstring;
                                                                    {7328}new ST_6764: bitstring;
                                                                    {7329}new TTL_6765: bitstring;
                                                                    {7330}let wNs_6766: bitstring = enc(Ns_6763,pkCli_6705) in
                                                                    {7331}let m2_6767: bitstring = (OpenSecureChannelResponse,wNs_6766,ST_6764,TTL_6765) in
                                                                    {7332}out(c, (enc(m2_6767,pkCli_6705),sign(h(m2_6767),skSess_6524)));
                                                                    {7333}let Ksrv_6768: bitstring = h((Ns_6763,Nc_6762)) in
                                                                    {7334}out(c, senc(mSrv(pkCli_6705,pkSess_6525),Ksrv_6768))
                                                    )
                                                    else
                                                        {7335}let pkDisco_6769: bitstring = fail-any in
                                                        {7336}in(c, (=pkCli_6705,em1_6770: bitstring,sigM1_6771: bitstring));
                                                        {7337}let m1_6772: bitstring = dec(em1_6770,skSess_6524) in
                                                        {7338}if (verify(h(m1_6772),sigM1_6771,pkCli_6705) <> true) then
                                                            0
                                                        else
                                                            {7339}let (=OpenSecureChannelRequest,=pkCli_6705,wNc_6773: bitstring) = m1_6772 in
                                                            {7340}let Nc_6774: bitstring = dec(wNc_6773,skSess_6524) in
                                                            {7341}new Ns_6775: bitstring;
                                                            {7342}new ST_6776: bitstring;
                                                            {7343}new TTL_6777: bitstring;
                                                            {7344}let wNs_6778: bitstring = enc(Ns_6775,pkCli_6705) in
                                                            {7345}let m2_6779: bitstring = (OpenSecureChannelResponse,wNs_6778,ST_6776,TTL_6777) in
                                                            {7346}out(c, (enc(m2_6779,pkCli_6705),sign(h(m2_6779),skSess_6524)));
                                                            {7347}let Ksrv_6780: bitstring = h((Ns_6775,Nc_6774)) in
                                                            {7348}out(c, senc(mSrv(pkCli_6705,pkSess_6525),Ksrv_6780))
                                            )
                                            else
                                                {7349}let pkDisco_6781: bitstring = fail-any in
                                                {7350}in(c, (=pkCli_6705,em1_6782: bitstring,sigM1_6783: bitstring));
                                                {7351}let m1_6784: bitstring = dec(em1_6782,skSess_6524) in
                                                {7352}if (verify(h(m1_6784),sigM1_6783,pkCli_6705) <> true) then
                                                    0
                                                else
                                                    {7353}let (=OpenSecureChannelRequest,=pkCli_6705,wNc_6785: bitstring) = m1_6784 in
                                                    {7354}let Nc_6786: bitstring = dec(wNc_6785,skSess_6524) in
                                                    {7355}new Ns_6787: bitstring;
                                                    {7356}new ST_6788: bitstring;
                                                    {7357}new TTL_6789: bitstring;
                                                    {7358}let wNs_6790: bitstring = enc(Ns_6787,pkCli_6705) in
                                                    {7359}let m2_6791: bitstring = (OpenSecureChannelResponse,wNs_6790,ST_6788,TTL_6789) in
                                                    {7360}out(c, (enc(m2_6791,pkCli_6705),sign(h(m2_6791),skSess_6524)));
                                                    {7361}let Ksrv_6792: bitstring = h((Ns_6787,Nc_6786)) in
                                                    {7362}out(c, senc(mSrv(pkCli_6705,pkSess_6525),Ksrv_6792))
                                        )
                                        else
                                            {7363}let pkCli_6793: bitstring = pub(sk(Cli_5902)) in
                                            {7364}let v_6794: bool = (Disco_5903 = A) in
                                            (
                                                {7365}if v_6794 then
                                                (
                                                    {7366}let pkDisco_6795: bitstring = pub(skA) in
                                                    {7367}in(c, (=pkCli_6793,em1_6796: bitstring,sigM1_6797: bitstring));
                                                    {7368}let m1_6798: bitstring = dec(em1_6796,skSess_6524) in
                                                    {7369}if (verify(h(m1_6798),sigM1_6797,pkCli_6793) <> true) then
                                                        0
                                                    else
                                                        {7370}let (=OpenSecureChannelRequest,=pkCli_6793,wNc_6799: bitstring) = m1_6798 in
                                                        {7371}let Nc_6800: bitstring = dec(wNc_6799,skSess_6524) in
                                                        {7372}new Ns_6801: bitstring;
                                                        {7373}new ST_6802: bitstring;
                                                        {7374}new TTL_6803: bitstring;
                                                        {7375}let wNs_6804: bitstring = enc(Ns_6801,pkCli_6793) in
                                                        {7376}let m2_6805: bitstring = (OpenSecureChannelResponse,wNs_6804,ST_6802,TTL_6803) in
                                                        {7377}out(c, (enc(m2_6805,pkCli_6793),sign(h(m2_6805),skSess_6524)));
                                                        {7378}let Ksrv_6806: bitstring = h((Ns_6801,Nc_6800)) in
                                                        {7379}out(c, senc(mSrv(pkCli_6793,pkSess_6525),Ksrv_6806))
                                                )
                                                else
                                                    {7380}let v_6807: bool = (Disco_5903 = B) in
                                                    (
                                                        {7381}if v_6807 then
                                                        (
                                                            {7382}let pkDisco_6808: bitstring = pub(skB) in
                                                            {7383}in(c, (=pkCli_6793,em1_6809: bitstring,sigM1_6810: bitstring));
                                                            {7384}let m1_6811: bitstring = dec(em1_6809,skSess_6524) in
                                                            {7385}if (verify(h(m1_6811),sigM1_6810,pkCli_6793) <> true) then
                                                                0
                                                            else
                                                                {7386}let (=OpenSecureChannelRequest,=pkCli_6793,wNc_6812: bitstring) = m1_6811 in
                                                                {7387}let Nc_6813: bitstring = dec(wNc_6812,skSess_6524) in
                                                                {7388}new Ns_6814: bitstring;
                                                                {7389}new ST_6815: bitstring;
                                                                {7390}new TTL_6816: bitstring;
                                                                {7391}let wNs_6817: bitstring = enc(Ns_6814,pkCli_6793) in
                                                                {7392}let m2_6818: bitstring = (OpenSecureChannelResponse,wNs_6817,ST_6815,TTL_6816) in
                                                                {7393}out(c, (enc(m2_6818,pkCli_6793),sign(h(m2_6818),skSess_6524)));
                                                                {7394}let Ksrv_6819: bitstring = h((Ns_6814,Nc_6813)) in
                                                                {7395}out(c, senc(mSrv(pkCli_6793,pkSess_6525),Ksrv_6819))
                                                        )
                                                        else
                                                            {7396}let v_6820: bool = (Disco_5903 = C) in
                                                            (
                                                                {7397}if v_6820 then
                                                                (
                                                                    {7398}let pkDisco_6821: bitstring = pub(skC) in
                                                                    {7399}in(c, (=pkCli_6793,em1_6822: bitstring,sigM1_6823: bitstring));
                                                                    {7400}let m1_6824: bitstring = dec(em1_6822,skSess_6524) in
                                                                    {7401}if (verify(h(m1_6824),sigM1_6823,pkCli_6793) <> true) then
                                                                        0
                                                                    else
                                                                        {7402}let (=OpenSecureChannelRequest,=pkCli_6793,wNc_6825: bitstring) = m1_6824 in
                                                                        {7403}let Nc_6826: bitstring = dec(wNc_6825,skSess_6524) in
                                                                        {7404}new Ns_6827: bitstring;
                                                                        {7405}new ST_6828: bitstring;
                                                                        {7406}new TTL_6829: bitstring;
                                                                        {7407}let wNs_6830: bitstring = enc(Ns_6827,pkCli_6793) in
                                                                        {7408}let m2_6831: bitstring = (OpenSecureChannelResponse,wNs_6830,ST_6828,TTL_6829) in
                                                                        {7409}out(c, (enc(m2_6831,pkCli_6793),sign(h(m2_6831),skSess_6524)));
                                                                        {7410}let Ksrv_6832: bitstring = h((Ns_6827,Nc_6826)) in
                                                                        {7411}out(c, senc(mSrv(pkCli_6793,pkSess_6525),Ksrv_6832))
                                                                )
                                                                else
                                                                    {7412}let pkDisco_6833: bitstring = pub(sk(Disco_5903)) in
                                                                    {7413}in(c, (=pkCli_6793,em1_6834: bitstring,sigM1_6835: bitstring));
                                                                    {7414}let m1_6836: bitstring = dec(em1_6834,skSess_6524) in
                                                                    {7415}if (verify(h(m1_6836),sigM1_6835,pkCli_6793) <> true) then
                                                                        0
                                                                    else
                                                                        {7416}let (=OpenSecureChannelRequest,=pkCli_6793,wNc_6837: bitstring) = m1_6836 in
                                                                        {7417}let Nc_6838: bitstring = dec(wNc_6837,skSess_6524) in
                                                                        {7418}new Ns_6839: bitstring;
                                                                        {7419}new ST_6840: bitstring;
                                                                        {7420}new TTL_6841: bitstring;
                                                                        {7421}let wNs_6842: bitstring = enc(Ns_6839,pkCli_6793) in
                                                                        {7422}let m2_6843: bitstring = (OpenSecureChannelResponse,wNs_6842,ST_6840,TTL_6841) in
                                                                        {7423}out(c, (enc(m2_6843,pkCli_6793),sign(h(m2_6843),skSess_6524)));
                                                                        {7424}let Ksrv_6844: bitstring = h((Ns_6839,Nc_6838)) in
                                                                        {7425}out(c, senc(mSrv(pkCli_6793,pkSess_6525),Ksrv_6844))
                                                            )
                                                            else
                                                                {7426}let pkDisco_6845: bitstring = fail-any in
                                                                {7427}in(c, (=pkCli_6793,em1_6846: bitstring,sigM1_6847: bitstring));
                                                                {7428}let m1_6848: bitstring = dec(em1_6846,skSess_6524) in
                                                                {7429}if (verify(h(m1_6848),sigM1_6847,pkCli_6793) <> true) then
                                                                    0
                                                                else
                                                                    {7430}let (=OpenSecureChannelRequest,=pkCli_6793,wNc_6849: bitstring) = m1_6848 in
                                                                    {7431}let Nc_6850: bitstring = dec(wNc_6849,skSess_6524) in
                                                                    {7432}new Ns_6851: bitstring;
                                                                    {7433}new ST_6852: bitstring;
                                                                    {7434}new TTL_6853: bitstring;
                                                                    {7435}let wNs_6854: bitstring = enc(Ns_6851,pkCli_6793) in
                                                                    {7436}let m2_6855: bitstring = (OpenSecureChannelResponse,wNs_6854,ST_6852,TTL_6853) in
                                                                    {7437}out(c, (enc(m2_6855,pkCli_6793),sign(h(m2_6855),skSess_6524)));
                                                                    {7438}let Ksrv_6856: bitstring = h((Ns_6851,Nc_6850)) in
                                                                    {7439}out(c, senc(mSrv(pkCli_6793,pkSess_6525),Ksrv_6856))
                                                    )
                                                    else
                                                        {7440}let pkDisco_6857: bitstring = fail-any in
                                                        {7441}in(c, (=pkCli_6793,em1_6858: bitstring,sigM1_6859: bitstring));
                                                        {7442}let m1_6860: bitstring = dec(em1_6858,skSess_6524) in
                                                        {7443}if (verify(h(m1_6860),sigM1_6859,pkCli_6793) <> true) then
                                                            0
                                                        else
                                                            {7444}let (=OpenSecureChannelRequest,=pkCli_6793,wNc_6861: bitstring) = m1_6860 in
                                                            {7445}let Nc_6862: bitstring = dec(wNc_6861,skSess_6524) in
                                                            {7446}new Ns_6863: bitstring;
                                                            {7447}new ST_6864: bitstring;
                                                            {7448}new TTL_6865: bitstring;
                                                            {7449}let wNs_6866: bitstring = enc(Ns_6863,pkCli_6793) in
                                                            {7450}let m2_6867: bitstring = (OpenSecureChannelResponse,wNs_6866,ST_6864,TTL_6865) in
                                                            {7451}out(c, (enc(m2_6867,pkCli_6793),sign(h(m2_6867),skSess_6524)));
                                                            {7452}let Ksrv_6868: bitstring = h((Ns_6863,Nc_6862)) in
                                                            {7453}out(c, senc(mSrv(pkCli_6793,pkSess_6525),Ksrv_6868))
                                            )
                                            else
                                                {7454}let pkDisco_6869: bitstring = fail-any in
                                                {7455}in(c, (=pkCli_6793,em1_6870: bitstring,sigM1_6871: bitstring));
                                                {7456}let m1_6872: bitstring = dec(em1_6870,skSess_6524) in
                                                {7457}if (verify(h(m1_6872),sigM1_6871,pkCli_6793) <> true) then
                                                    0
                                                else
                                                    {7458}let (=OpenSecureChannelRequest,=pkCli_6793,wNc_6873: bitstring) = m1_6872 in
                                                    {7459}let Nc_6874: bitstring = dec(wNc_6873,skSess_6524) in
                                                    {7460}new Ns_6875: bitstring;
                                                    {7461}new ST_6876: bitstring;
                                                    {7462}new TTL_6877: bitstring;
                                                    {7463}let wNs_6878: bitstring = enc(Ns_6875,pkCli_6793) in
                                                    {7464}let m2_6879: bitstring = (OpenSecureChannelResponse,wNs_6878,ST_6876,TTL_6877) in
                                                    {7465}out(c, (enc(m2_6879,pkCli_6793),sign(h(m2_6879),skSess_6524)));
                                                    {7466}let Ksrv_6880: bitstring = h((Ns_6875,Nc_6874)) in
                                                    {7467}out(c, senc(mSrv(pkCli_6793,pkSess_6525),Ksrv_6880))
                                    )
                                    else
                                        {7468}let pkCli_6881: bitstring = fail-any in
                                        {7469}let v_6882: bool = (Disco_5903 = A) in
                                        (
                                            {7470}if v_6882 then
                                            (
                                                {7471}let pkDisco_6883: bitstring = pub(skA) in
                                                {7472}in(c, (=pkCli_6881,em1_6884: bitstring,sigM1_6885: bitstring));
                                                {7473}let m1_6886: bitstring = dec(em1_6884,skSess_6524) in
                                                {7474}if (verify(h(m1_6886),sigM1_6885,pkCli_6881) <> true) then
                                                    0
                                                else
                                                    {7475}let (=OpenSecureChannelRequest,=pkCli_6881,wNc_6887: bitstring) = m1_6886 in
                                                    {7476}let Nc_6888: bitstring = dec(wNc_6887,skSess_6524) in
                                                    {7477}new Ns_6889: bitstring;
                                                    {7478}new ST_6890: bitstring;
                                                    {7479}new TTL_6891: bitstring;
                                                    {7480}let wNs_6892: bitstring = enc(Ns_6889,pkCli_6881) in
                                                    {7481}let m2_6893: bitstring = (OpenSecureChannelResponse,wNs_6892,ST_6890,TTL_6891) in
                                                    {7482}out(c, (enc(m2_6893,pkCli_6881),sign(h(m2_6893),skSess_6524)));
                                                    {7483}let Ksrv_6894: bitstring = h((Ns_6889,Nc_6888)) in
                                                    {7484}out(c, senc(mSrv(pkCli_6881,pkSess_6525),Ksrv_6894))
                                            )
                                            else
                                                {7485}let v_6895: bool = (Disco_5903 = B) in
                                                (
                                                    {7486}if v_6895 then
                                                    (
                                                        {7487}let pkDisco_6896: bitstring = pub(skB) in
                                                        {7488}in(c, (=pkCli_6881,em1_6897: bitstring,sigM1_6898: bitstring));
                                                        {7489}let m1_6899: bitstring = dec(em1_6897,skSess_6524) in
                                                        {7490}if (verify(h(m1_6899),sigM1_6898,pkCli_6881) <> true) then
                                                            0
                                                        else
                                                            {7491}let (=OpenSecureChannelRequest,=pkCli_6881,wNc_6900: bitstring) = m1_6899 in
                                                            {7492}let Nc_6901: bitstring = dec(wNc_6900,skSess_6524) in
                                                            {7493}new Ns_6902: bitstring;
                                                            {7494}new ST_6903: bitstring;
                                                            {7495}new TTL_6904: bitstring;
                                                            {7496}let wNs_6905: bitstring = enc(Ns_6902,pkCli_6881) in
                                                            {7497}let m2_6906: bitstring = (OpenSecureChannelResponse,wNs_6905,ST_6903,TTL_6904) in
                                                            {7498}out(c, (enc(m2_6906,pkCli_6881),sign(h(m2_6906),skSess_6524)));
                                                            {7499}let Ksrv_6907: bitstring = h((Ns_6902,Nc_6901)) in
                                                            {7500}out(c, senc(mSrv(pkCli_6881,pkSess_6525),Ksrv_6907))
                                                    )
                                                    else
                                                        {7501}let v_6908: bool = (Disco_5903 = C) in
                                                        (
                                                            {7502}if v_6908 then
                                                            (
                                                                {7503}let pkDisco_6909: bitstring = pub(skC) in
                                                                {7504}in(c, (=pkCli_6881,em1_6910: bitstring,sigM1_6911: bitstring));
                                                                {7505}let m1_6912: bitstring = dec(em1_6910,skSess_6524) in
                                                                {7506}if (verify(h(m1_6912),sigM1_6911,pkCli_6881) <> true) then
                                                                    0
                                                                else
                                                                    {7507}let (=OpenSecureChannelRequest,=pkCli_6881,wNc_6913: bitstring) = m1_6912 in
                                                                    {7508}let Nc_6914: bitstring = dec(wNc_6913,skSess_6524) in
                                                                    {7509}new Ns_6915: bitstring;
                                                                    {7510}new ST_6916: bitstring;
                                                                    {7511}new TTL_6917: bitstring;
                                                                    {7512}let wNs_6918: bitstring = enc(Ns_6915,pkCli_6881) in
                                                                    {7513}let m2_6919: bitstring = (OpenSecureChannelResponse,wNs_6918,ST_6916,TTL_6917) in
                                                                    {7514}out(c, (enc(m2_6919,pkCli_6881),sign(h(m2_6919),skSess_6524)));
                                                                    {7515}let Ksrv_6920: bitstring = h((Ns_6915,Nc_6914)) in
                                                                    {7516}out(c, senc(mSrv(pkCli_6881,pkSess_6525),Ksrv_6920))
                                                            )
                                                            else
                                                                {7517}let pkDisco_6921: bitstring = pub(sk(Disco_5903)) in
                                                                {7518}in(c, (=pkCli_6881,em1_6922: bitstring,sigM1_6923: bitstring));
                                                                {7519}let m1_6924: bitstring = dec(em1_6922,skSess_6524) in
                                                                {7520}if (verify(h(m1_6924),sigM1_6923,pkCli_6881) <> true) then
                                                                    0
                                                                else
                                                                    {7521}let (=OpenSecureChannelRequest,=pkCli_6881,wNc_6925: bitstring) = m1_6924 in
                                                                    {7522}let Nc_6926: bitstring = dec(wNc_6925,skSess_6524) in
                                                                    {7523}new Ns_6927: bitstring;
                                                                    {7524}new ST_6928: bitstring;
                                                                    {7525}new TTL_6929: bitstring;
                                                                    {7526}let wNs_6930: bitstring = enc(Ns_6927,pkCli_6881) in
                                                                    {7527}let m2_6931: bitstring = (OpenSecureChannelResponse,wNs_6930,ST_6928,TTL_6929) in
                                                                    {7528}out(c, (enc(m2_6931,pkCli_6881),sign(h(m2_6931),skSess_6524)));
                                                                    {7529}let Ksrv_6932: bitstring = h((Ns_6927,Nc_6926)) in
                                                                    {7530}out(c, senc(mSrv(pkCli_6881,pkSess_6525),Ksrv_6932))
                                                        )
                                                        else
                                                            {7531}let pkDisco_6933: bitstring = fail-any in
                                                            {7532}in(c, (=pkCli_6881,em1_6934: bitstring,sigM1_6935: bitstring));
                                                            {7533}let m1_6936: bitstring = dec(em1_6934,skSess_6524) in
                                                            {7534}if (verify(h(m1_6936),sigM1_6935,pkCli_6881) <> true) then
                                                                0
                                                            else
                                                                {7535}let (=OpenSecureChannelRequest,=pkCli_6881,wNc_6937: bitstring) = m1_6936 in
                                                                {7536}let Nc_6938: bitstring = dec(wNc_6937,skSess_6524) in
                                                                {7537}new Ns_6939: bitstring;
                                                                {7538}new ST_6940: bitstring;
                                                                {7539}new TTL_6941: bitstring;
                                                                {7540}let wNs_6942: bitstring = enc(Ns_6939,pkCli_6881) in
                                                                {7541}let m2_6943: bitstring = (OpenSecureChannelResponse,wNs_6942,ST_6940,TTL_6941) in
                                                                {7542}out(c, (enc(m2_6943,pkCli_6881),sign(h(m2_6943),skSess_6524)));
                                                                {7543}let Ksrv_6944: bitstring = h((Ns_6939,Nc_6938)) in
                                                                {7544}out(c, senc(mSrv(pkCli_6881,pkSess_6525),Ksrv_6944))
                                                )
                                                else
                                                    {7545}let pkDisco_6945: bitstring = fail-any in
                                                    {7546}in(c, (=pkCli_6881,em1_6946: bitstring,sigM1_6947: bitstring));
                                                    {7547}let m1_6948: bitstring = dec(em1_6946,skSess_6524) in
                                                    {7548}if (verify(h(m1_6948),sigM1_6947,pkCli_6881) <> true) then
                                                        0
                                                    else
                                                        {7549}let (=OpenSecureChannelRequest,=pkCli_6881,wNc_6949: bitstring) = m1_6948 in
                                                        {7550}let Nc_6950: bitstring = dec(wNc_6949,skSess_6524) in
                                                        {7551}new Ns_6951: bitstring;
                                                        {7552}new ST_6952: bitstring;
                                                        {7553}new TTL_6953: bitstring;
                                                        {7554}let wNs_6954: bitstring = enc(Ns_6951,pkCli_6881) in
                                                        {7555}let m2_6955: bitstring = (OpenSecureChannelResponse,wNs_6954,ST_6952,TTL_6953) in
                                                        {7556}out(c, (enc(m2_6955,pkCli_6881),sign(h(m2_6955),skSess_6524)));
                                                        {7557}let Ksrv_6956: bitstring = h((Ns_6951,Nc_6950)) in
                                                        {7558}out(c, senc(mSrv(pkCli_6881,pkSess_6525),Ksrv_6956))
                                        )
                                        else
                                            {7559}let pkDisco_6957: bitstring = fail-any in
                                            {7560}in(c, (=pkCli_6881,em1_6958: bitstring,sigM1_6959: bitstring));
                                            {7561}let m1_6960: bitstring = dec(em1_6958,skSess_6524) in
                                            {7562}if (verify(h(m1_6960),sigM1_6959,pkCli_6881) <> true) then
                                                0
                                            else
                                                {7563}let (=OpenSecureChannelRequest,=pkCli_6881,wNc_6961: bitstring) = m1_6960 in
                                                {7564}let Nc_6962: bitstring = dec(wNc_6961,skSess_6524) in
                                                {7565}new Ns_6963: bitstring;
                                                {7566}new ST_6964: bitstring;
                                                {7567}new TTL_6965: bitstring;
                                                {7568}let wNs_6966: bitstring = enc(Ns_6963,pkCli_6881) in
                                                {7569}let m2_6967: bitstring = (OpenSecureChannelResponse,wNs_6966,ST_6964,TTL_6965) in
                                                {7570}out(c, (enc(m2_6967,pkCli_6881),sign(h(m2_6967),skSess_6524)));
                                                {7571}let Ksrv_6968: bitstring = h((Ns_6963,Nc_6962)) in
                                                {7572}out(c, senc(mSrv(pkCli_6881,pkSess_6525),Ksrv_6968))
                            )
                            else
                                {7573}let pkCli_6969: bitstring = fail-any in
                                {7574}let v_6970: bool = (Disco_5903 = A) in
                                (
                                    {7575}if v_6970 then
                                    (
                                        {7576}let pkDisco_6971: bitstring = pub(skA) in
                                        {7577}in(c, (=pkCli_6969,em1_6972: bitstring,sigM1_6973: bitstring));
                                        {7578}let m1_6974: bitstring = dec(em1_6972,skSess_6524) in
                                        {7579}if (verify(h(m1_6974),sigM1_6973,pkCli_6969) <> true) then
                                            0
                                        else
                                            {7580}let (=OpenSecureChannelRequest,=pkCli_6969,wNc_6975: bitstring) = m1_6974 in
                                            {7581}let Nc_6976: bitstring = dec(wNc_6975,skSess_6524) in
                                            {7582}new Ns_6977: bitstring;
                                            {7583}new ST_6978: bitstring;
                                            {7584}new TTL_6979: bitstring;
                                            {7585}let wNs_6980: bitstring = enc(Ns_6977,pkCli_6969) in
                                            {7586}let m2_6981: bitstring = (OpenSecureChannelResponse,wNs_6980,ST_6978,TTL_6979) in
                                            {7587}out(c, (enc(m2_6981,pkCli_6969),sign(h(m2_6981),skSess_6524)));
                                            {7588}let Ksrv_6982: bitstring = h((Ns_6977,Nc_6976)) in
                                            {7589}out(c, senc(mSrv(pkCli_6969,pkSess_6525),Ksrv_6982))
                                    )
                                    else
                                        {7590}let v_6983: bool = (Disco_5903 = B) in
                                        (
                                            {7591}if v_6983 then
                                            (
                                                {7592}let pkDisco_6984: bitstring = pub(skB) in
                                                {7593}in(c, (=pkCli_6969,em1_6985: bitstring,sigM1_6986: bitstring));
                                                {7594}let m1_6987: bitstring = dec(em1_6985,skSess_6524) in
                                                {7595}if (verify(h(m1_6987),sigM1_6986,pkCli_6969) <> true) then
                                                    0
                                                else
                                                    {7596}let (=OpenSecureChannelRequest,=pkCli_6969,wNc_6988: bitstring) = m1_6987 in
                                                    {7597}let Nc_6989: bitstring = dec(wNc_6988,skSess_6524) in
                                                    {7598}new Ns_6990: bitstring;
                                                    {7599}new ST_6991: bitstring;
                                                    {7600}new TTL_6992: bitstring;
                                                    {7601}let wNs_6993: bitstring = enc(Ns_6990,pkCli_6969) in
                                                    {7602}let m2_6994: bitstring = (OpenSecureChannelResponse,wNs_6993,ST_6991,TTL_6992) in
                                                    {7603}out(c, (enc(m2_6994,pkCli_6969),sign(h(m2_6994),skSess_6524)));
                                                    {7604}let Ksrv_6995: bitstring = h((Ns_6990,Nc_6989)) in
                                                    {7605}out(c, senc(mSrv(pkCli_6969,pkSess_6525),Ksrv_6995))
                                            )
                                            else
                                                {7606}let v_6996: bool = (Disco_5903 = C) in
                                                (
                                                    {7607}if v_6996 then
                                                    (
                                                        {7608}let pkDisco_6997: bitstring = pub(skC) in
                                                        {7609}in(c, (=pkCli_6969,em1_6998: bitstring,sigM1_6999: bitstring));
                                                        {7610}let m1_7000: bitstring = dec(em1_6998,skSess_6524) in
                                                        {7611}if (verify(h(m1_7000),sigM1_6999,pkCli_6969) <> true) then
                                                            0
                                                        else
                                                            {7612}let (=OpenSecureChannelRequest,=pkCli_6969,wNc_7001: bitstring) = m1_7000 in
                                                            {7613}let Nc_7002: bitstring = dec(wNc_7001,skSess_6524) in
                                                            {7614}new Ns_7003: bitstring;
                                                            {7615}new ST_7004: bitstring;
                                                            {7616}new TTL_7005: bitstring;
                                                            {7617}let wNs_7006: bitstring = enc(Ns_7003,pkCli_6969) in
                                                            {7618}let m2_7007: bitstring = (OpenSecureChannelResponse,wNs_7006,ST_7004,TTL_7005) in
                                                            {7619}out(c, (enc(m2_7007,pkCli_6969),sign(h(m2_7007),skSess_6524)));
                                                            {7620}let Ksrv_7008: bitstring = h((Ns_7003,Nc_7002)) in
                                                            {7621}out(c, senc(mSrv(pkCli_6969,pkSess_6525),Ksrv_7008))
                                                    )
                                                    else
                                                        {7622}let pkDisco_7009: bitstring = pub(sk(Disco_5903)) in
                                                        {7623}in(c, (=pkCli_6969,em1_7010: bitstring,sigM1_7011: bitstring));
                                                        {7624}let m1_7012: bitstring = dec(em1_7010,skSess_6524) in
                                                        {7625}if (verify(h(m1_7012),sigM1_7011,pkCli_6969) <> true) then
                                                            0
                                                        else
                                                            {7626}let (=OpenSecureChannelRequest,=pkCli_6969,wNc_7013: bitstring) = m1_7012 in
                                                            {7627}let Nc_7014: bitstring = dec(wNc_7013,skSess_6524) in
                                                            {7628}new Ns_7015: bitstring;
                                                            {7629}new ST_7016: bitstring;
                                                            {7630}new TTL_7017: bitstring;
                                                            {7631}let wNs_7018: bitstring = enc(Ns_7015,pkCli_6969) in
                                                            {7632}let m2_7019: bitstring = (OpenSecureChannelResponse,wNs_7018,ST_7016,TTL_7017) in
                                                            {7633}out(c, (enc(m2_7019,pkCli_6969),sign(h(m2_7019),skSess_6524)));
                                                            {7634}let Ksrv_7020: bitstring = h((Ns_7015,Nc_7014)) in
                                                            {7635}out(c, senc(mSrv(pkCli_6969,pkSess_6525),Ksrv_7020))
                                                )
                                                else
                                                    {7636}let pkDisco_7021: bitstring = fail-any in
                                                    {7637}in(c, (=pkCli_6969,em1_7022: bitstring,sigM1_7023: bitstring));
                                                    {7638}let m1_7024: bitstring = dec(em1_7022,skSess_6524) in
                                                    {7639}if (verify(h(m1_7024),sigM1_7023,pkCli_6969) <> true) then
                                                        0
                                                    else
                                                        {7640}let (=OpenSecureChannelRequest,=pkCli_6969,wNc_7025: bitstring) = m1_7024 in
                                                        {7641}let Nc_7026: bitstring = dec(wNc_7025,skSess_6524) in
                                                        {7642}new Ns_7027: bitstring;
                                                        {7643}new ST_7028: bitstring;
                                                        {7644}new TTL_7029: bitstring;
                                                        {7645}let wNs_7030: bitstring = enc(Ns_7027,pkCli_6969) in
                                                        {7646}let m2_7031: bitstring = (OpenSecureChannelResponse,wNs_7030,ST_7028,TTL_7029) in
                                                        {7647}out(c, (enc(m2_7031,pkCli_6969),sign(h(m2_7031),skSess_6524)));
                                                        {7648}let Ksrv_7032: bitstring = h((Ns_7027,Nc_7026)) in
                                                        {7649}out(c, senc(mSrv(pkCli_6969,pkSess_6525),Ksrv_7032))
                                        )
                                        else
                                            {7650}let pkDisco_7033: bitstring = fail-any in
                                            {7651}in(c, (=pkCli_6969,em1_7034: bitstring,sigM1_7035: bitstring));
                                            {7652}let m1_7036: bitstring = dec(em1_7034,skSess_6524) in
                                            {7653}if (verify(h(m1_7036),sigM1_7035,pkCli_6969) <> true) then
                                                0
                                            else
                                                {7654}let (=OpenSecureChannelRequest,=pkCli_6969,wNc_7037: bitstring) = m1_7036 in
                                                {7655}let Nc_7038: bitstring = dec(wNc_7037,skSess_6524) in
                                                {7656}new Ns_7039: bitstring;
                                                {7657}new ST_7040: bitstring;
                                                {7658}new TTL_7041: bitstring;
                                                {7659}let wNs_7042: bitstring = enc(Ns_7039,pkCli_6969) in
                                                {7660}let m2_7043: bitstring = (OpenSecureChannelResponse,wNs_7042,ST_7040,TTL_7041) in
                                                {7661}out(c, (enc(m2_7043,pkCli_6969),sign(h(m2_7043),skSess_6524)));
                                                {7662}let Ksrv_7044: bitstring = h((Ns_7039,Nc_7038)) in
                                                {7663}out(c, senc(mSrv(pkCli_6969,pkSess_6525),Ksrv_7044))
                                )
                                else
                                    {7664}let pkDisco_7045: bitstring = fail-any in
                                    {7665}in(c, (=pkCli_6969,em1_7046: bitstring,sigM1_7047: bitstring));
                                    {7666}let m1_7048: bitstring = dec(em1_7046,skSess_6524) in
                                    {7667}if (verify(h(m1_7048),sigM1_7047,pkCli_6969) <> true) then
                                        0
                                    else
                                        {7668}let (=OpenSecureChannelRequest,=pkCli_6969,wNc_7049: bitstring) = m1_7048 in
                                        {7669}let Nc_7050: bitstring = dec(wNc_7049,skSess_6524) in
                                        {7670}new Ns_7051: bitstring;
                                        {7671}new ST_7052: bitstring;
                                        {7672}new TTL_7053: bitstring;
                                        {7673}let wNs_7054: bitstring = enc(Ns_7051,pkCli_6969) in
                                        {7674}let m2_7055: bitstring = (OpenSecureChannelResponse,wNs_7054,ST_7052,TTL_7053) in
                                        {7675}out(c, (enc(m2_7055,pkCli_6969),sign(h(m2_7055),skSess_6524)));
                                        {7676}let Ksrv_7056: bitstring = h((Ns_7051,Nc_7050)) in
                                        {7677}out(c, senc(mSrv(pkCli_6969,pkSess_6525),Ksrv_7056))
                    )
                    else
                        {7678}let pkCli_7057: bitstring = fail-any in
                        {7679}let v_7058: bool = (Disco_5903 = A) in
                        (
                            {7680}if v_7058 then
                            (
                                {7681}let pkDisco_7059: bitstring = pub(skA) in
                                {7682}in(c, (=pkCli_7057,em1_7060: bitstring,sigM1_7061: bitstring));
                                {7683}let m1_7062: bitstring = dec(em1_7060,skSess_6524) in
                                {7684}if (verify(h(m1_7062),sigM1_7061,pkCli_7057) <> true) then
                                    0
                                else
                                    {7685}let (=OpenSecureChannelRequest,=pkCli_7057,wNc_7063: bitstring) = m1_7062 in
                                    {7686}let Nc_7064: bitstring = dec(wNc_7063,skSess_6524) in
                                    {7687}new Ns_7065: bitstring;
                                    {7688}new ST_7066: bitstring;
                                    {7689}new TTL_7067: bitstring;
                                    {7690}let wNs_7068: bitstring = enc(Ns_7065,pkCli_7057) in
                                    {7691}let m2_7069: bitstring = (OpenSecureChannelResponse,wNs_7068,ST_7066,TTL_7067) in
                                    {7692}out(c, (enc(m2_7069,pkCli_7057),sign(h(m2_7069),skSess_6524)));
                                    {7693}let Ksrv_7070: bitstring = h((Ns_7065,Nc_7064)) in
                                    {7694}out(c, senc(mSrv(pkCli_7057,pkSess_6525),Ksrv_7070))
                            )
                            else
                                {7695}let v_7071: bool = (Disco_5903 = B) in
                                (
                                    {7696}if v_7071 then
                                    (
                                        {7697}let pkDisco_7072: bitstring = pub(skB) in
                                        {7698}in(c, (=pkCli_7057,em1_7073: bitstring,sigM1_7074: bitstring));
                                        {7699}let m1_7075: bitstring = dec(em1_7073,skSess_6524) in
                                        {7700}if (verify(h(m1_7075),sigM1_7074,pkCli_7057) <> true) then
                                            0
                                        else
                                            {7701}let (=OpenSecureChannelRequest,=pkCli_7057,wNc_7076: bitstring) = m1_7075 in
                                            {7702}let Nc_7077: bitstring = dec(wNc_7076,skSess_6524) in
                                            {7703}new Ns_7078: bitstring;
                                            {7704}new ST_7079: bitstring;
                                            {7705}new TTL_7080: bitstring;
                                            {7706}let wNs_7081: bitstring = enc(Ns_7078,pkCli_7057) in
                                            {7707}let m2_7082: bitstring = (OpenSecureChannelResponse,wNs_7081,ST_7079,TTL_7080) in
                                            {7708}out(c, (enc(m2_7082,pkCli_7057),sign(h(m2_7082),skSess_6524)));
                                            {7709}let Ksrv_7083: bitstring = h((Ns_7078,Nc_7077)) in
                                            {7710}out(c, senc(mSrv(pkCli_7057,pkSess_6525),Ksrv_7083))
                                    )
                                    else
                                        {7711}let v_7084: bool = (Disco_5903 = C) in
                                        (
                                            {7712}if v_7084 then
                                            (
                                                {7713}let pkDisco_7085: bitstring = pub(skC) in
                                                {7714}in(c, (=pkCli_7057,em1_7086: bitstring,sigM1_7087: bitstring));
                                                {7715}let m1_7088: bitstring = dec(em1_7086,skSess_6524) in
                                                {7716}if (verify(h(m1_7088),sigM1_7087,pkCli_7057) <> true) then
                                                    0
                                                else
                                                    {7717}let (=OpenSecureChannelRequest,=pkCli_7057,wNc_7089: bitstring) = m1_7088 in
                                                    {7718}let Nc_7090: bitstring = dec(wNc_7089,skSess_6524) in
                                                    {7719}new Ns_7091: bitstring;
                                                    {7720}new ST_7092: bitstring;
                                                    {7721}new TTL_7093: bitstring;
                                                    {7722}let wNs_7094: bitstring = enc(Ns_7091,pkCli_7057) in
                                                    {7723}let m2_7095: bitstring = (OpenSecureChannelResponse,wNs_7094,ST_7092,TTL_7093) in
                                                    {7724}out(c, (enc(m2_7095,pkCli_7057),sign(h(m2_7095),skSess_6524)));
                                                    {7725}let Ksrv_7096: bitstring = h((Ns_7091,Nc_7090)) in
                                                    {7726}out(c, senc(mSrv(pkCli_7057,pkSess_6525),Ksrv_7096))
                                            )
                                            else
                                                {7727}let pkDisco_7097: bitstring = pub(sk(Disco_5903)) in
                                                {7728}in(c, (=pkCli_7057,em1_7098: bitstring,sigM1_7099: bitstring));
                                                {7729}let m1_7100: bitstring = dec(em1_7098,skSess_6524) in
                                                {7730}if (verify(h(m1_7100),sigM1_7099,pkCli_7057) <> true) then
                                                    0
                                                else
                                                    {7731}let (=OpenSecureChannelRequest,=pkCli_7057,wNc_7101: bitstring) = m1_7100 in
                                                    {7732}let Nc_7102: bitstring = dec(wNc_7101,skSess_6524) in
                                                    {7733}new Ns_7103: bitstring;
                                                    {7734}new ST_7104: bitstring;
                                                    {7735}new TTL_7105: bitstring;
                                                    {7736}let wNs_7106: bitstring = enc(Ns_7103,pkCli_7057) in
                                                    {7737}let m2_7107: bitstring = (OpenSecureChannelResponse,wNs_7106,ST_7104,TTL_7105) in
                                                    {7738}out(c, (enc(m2_7107,pkCli_7057),sign(h(m2_7107),skSess_6524)));
                                                    {7739}let Ksrv_7108: bitstring = h((Ns_7103,Nc_7102)) in
                                                    {7740}out(c, senc(mSrv(pkCli_7057,pkSess_6525),Ksrv_7108))
                                        )
                                        else
                                            {7741}let pkDisco_7109: bitstring = fail-any in
                                            {7742}in(c, (=pkCli_7057,em1_7110: bitstring,sigM1_7111: bitstring));
                                            {7743}let m1_7112: bitstring = dec(em1_7110,skSess_6524) in
                                            {7744}if (verify(h(m1_7112),sigM1_7111,pkCli_7057) <> true) then
                                                0
                                            else
                                                {7745}let (=OpenSecureChannelRequest,=pkCli_7057,wNc_7113: bitstring) = m1_7112 in
                                                {7746}let Nc_7114: bitstring = dec(wNc_7113,skSess_6524) in
                                                {7747}new Ns_7115: bitstring;
                                                {7748}new ST_7116: bitstring;
                                                {7749}new TTL_7117: bitstring;
                                                {7750}let wNs_7118: bitstring = enc(Ns_7115,pkCli_7057) in
                                                {7751}let m2_7119: bitstring = (OpenSecureChannelResponse,wNs_7118,ST_7116,TTL_7117) in
                                                {7752}out(c, (enc(m2_7119,pkCli_7057),sign(h(m2_7119),skSess_6524)));
                                                {7753}let Ksrv_7120: bitstring = h((Ns_7115,Nc_7114)) in
                                                {7754}out(c, senc(mSrv(pkCli_7057,pkSess_6525),Ksrv_7120))
                                )
                                else
                                    {7755}let pkDisco_7121: bitstring = fail-any in
                                    {7756}in(c, (=pkCli_7057,em1_7122: bitstring,sigM1_7123: bitstring));
                                    {7757}let m1_7124: bitstring = dec(em1_7122,skSess_6524) in
                                    {7758}if (verify(h(m1_7124),sigM1_7123,pkCli_7057) <> true) then
                                        0
                                    else
                                        {7759}let (=OpenSecureChannelRequest,=pkCli_7057,wNc_7125: bitstring) = m1_7124 in
                                        {7760}let Nc_7126: bitstring = dec(wNc_7125,skSess_6524) in
                                        {7761}new Ns_7127: bitstring;
                                        {7762}new ST_7128: bitstring;
                                        {7763}new TTL_7129: bitstring;
                                        {7764}let wNs_7130: bitstring = enc(Ns_7127,pkCli_7057) in
                                        {7765}let m2_7131: bitstring = (OpenSecureChannelResponse,wNs_7130,ST_7128,TTL_7129) in
                                        {7766}out(c, (enc(m2_7131,pkCli_7057),sign(h(m2_7131),skSess_6524)));
                                        {7767}let Ksrv_7132: bitstring = h((Ns_7127,Nc_7126)) in
                                        {7768}out(c, senc(mSrv(pkCli_7057,pkSess_6525),Ksrv_7132))
                        )
                        else
                            {7769}let pkDisco_7133: bitstring = fail-any in
                            {7770}in(c, (=pkCli_7057,em1_7134: bitstring,sigM1_7135: bitstring));
                            {7771}let m1_7136: bitstring = dec(em1_7134,skSess_6524) in
                            {7772}if (verify(h(m1_7136),sigM1_7135,pkCli_7057) <> true) then
                                0
                            else
                                {7773}let (=OpenSecureChannelRequest,=pkCli_7057,wNc_7137: bitstring) = m1_7136 in
                                {7774}let Nc_7138: bitstring = dec(wNc_7137,skSess_6524) in
                                {7775}new Ns_7139: bitstring;
                                {7776}new ST_7140: bitstring;
                                {7777}new TTL_7141: bitstring;
                                {7778}let wNs_7142: bitstring = enc(Ns_7139,pkCli_7057) in
                                {7779}let m2_7143: bitstring = (OpenSecureChannelResponse,wNs_7142,ST_7140,TTL_7141) in
                                {7780}out(c, (enc(m2_7143,pkCli_7057),sign(h(m2_7143),skSess_6524)));
                                {7781}let Ksrv_7144: bitstring = h((Ns_7139,Nc_7138)) in
                                {7782}out(c, senc(mSrv(pkCli_7057,pkSess_6525),Ksrv_7144))
                )
                else
                    {7783}let =true = (Sess_5904 = C) in
                    (
                        {7784}let skSess_7145: bitstring = skC in
                        {7785}let pkSess_7146: bitstring = pub(skSess_7145) in
                        {7786}let v_7147: bool = (Cli_5902 = A) in
                        (
                            {7787}if v_7147 then
                            (
                                {7788}let pkCli_7148: bitstring = pub(skA) in
                                {7789}let v_7149: bool = (Disco_5903 = A) in
                                (
                                    {7790}if v_7149 then
                                    (
                                        {7791}let pkDisco_7150: bitstring = pub(skA) in
                                        {7792}in(c, (=pkCli_7148,em1_7151: bitstring,sigM1_7152: bitstring));
                                        {7793}let m1_7153: bitstring = dec(em1_7151,skSess_7145) in
                                        {7794}if (verify(h(m1_7153),sigM1_7152,pkCli_7148) <> true) then
                                            0
                                        else
                                            {7795}let (=OpenSecureChannelRequest,=pkCli_7148,wNc_7154: bitstring) = m1_7153 in
                                            {7796}let Nc_7155: bitstring = dec(wNc_7154,skSess_7145) in
                                            {7797}new Ns_7156: bitstring;
                                            {7798}new ST_7157: bitstring;
                                            {7799}new TTL_7158: bitstring;
                                            {7800}let wNs_7159: bitstring = enc(Ns_7156,pkCli_7148) in
                                            {7801}let m2_7160: bitstring = (OpenSecureChannelResponse,wNs_7159,ST_7157,TTL_7158) in
                                            {7802}out(c, (enc(m2_7160,pkCli_7148),sign(h(m2_7160),skSess_7145)));
                                            {7803}let Ksrv_7161: bitstring = h((Ns_7156,Nc_7155)) in
                                            {7804}out(c, senc(mSrv(pkCli_7148,pkSess_7146),Ksrv_7161))
                                    )
                                    else
                                        {7805}let v_7162: bool = (Disco_5903 = B) in
                                        (
                                            {7806}if v_7162 then
                                            (
                                                {7807}let pkDisco_7163: bitstring = pub(skB) in
                                                {7808}in(c, (=pkCli_7148,em1_7164: bitstring,sigM1_7165: bitstring));
                                                {7809}let m1_7166: bitstring = dec(em1_7164,skSess_7145) in
                                                {7810}if (verify(h(m1_7166),sigM1_7165,pkCli_7148) <> true) then
                                                    0
                                                else
                                                    {7811}let (=OpenSecureChannelRequest,=pkCli_7148,wNc_7167: bitstring) = m1_7166 in
                                                    {7812}let Nc_7168: bitstring = dec(wNc_7167,skSess_7145) in
                                                    {7813}new Ns_7169: bitstring;
                                                    {7814}new ST_7170: bitstring;
                                                    {7815}new TTL_7171: bitstring;
                                                    {7816}let wNs_7172: bitstring = enc(Ns_7169,pkCli_7148) in
                                                    {7817}let m2_7173: bitstring = (OpenSecureChannelResponse,wNs_7172,ST_7170,TTL_7171) in
                                                    {7818}out(c, (enc(m2_7173,pkCli_7148),sign(h(m2_7173),skSess_7145)));
                                                    {7819}let Ksrv_7174: bitstring = h((Ns_7169,Nc_7168)) in
                                                    {7820}out(c, senc(mSrv(pkCli_7148,pkSess_7146),Ksrv_7174))
                                            )
                                            else
                                                {7821}let v_7175: bool = (Disco_5903 = C) in
                                                (
                                                    {7822}if v_7175 then
                                                    (
                                                        {7823}let pkDisco_7176: bitstring = pub(skC) in
                                                        {7824}in(c, (=pkCli_7148,em1_7177: bitstring,sigM1_7178: bitstring));
                                                        {7825}let m1_7179: bitstring = dec(em1_7177,skSess_7145) in
                                                        {7826}if (verify(h(m1_7179),sigM1_7178,pkCli_7148) <> true) then
                                                            0
                                                        else
                                                            {7827}let (=OpenSecureChannelRequest,=pkCli_7148,wNc_7180: bitstring) = m1_7179 in
                                                            {7828}let Nc_7181: bitstring = dec(wNc_7180,skSess_7145) in
                                                            {7829}new Ns_7182: bitstring;
                                                            {7830}new ST_7183: bitstring;
                                                            {7831}new TTL_7184: bitstring;
                                                            {7832}let wNs_7185: bitstring = enc(Ns_7182,pkCli_7148) in
                                                            {7833}let m2_7186: bitstring = (OpenSecureChannelResponse,wNs_7185,ST_7183,TTL_7184) in
                                                            {7834}out(c, (enc(m2_7186,pkCli_7148),sign(h(m2_7186),skSess_7145)));
                                                            {7835}let Ksrv_7187: bitstring = h((Ns_7182,Nc_7181)) in
                                                            {7836}out(c, senc(mSrv(pkCli_7148,pkSess_7146),Ksrv_7187))
                                                    )
                                                    else
                                                        {7837}let pkDisco_7188: bitstring = pub(sk(Disco_5903)) in
                                                        {7838}in(c, (=pkCli_7148,em1_7189: bitstring,sigM1_7190: bitstring));
                                                        {7839}let m1_7191: bitstring = dec(em1_7189,skSess_7145) in
                                                        {7840}if (verify(h(m1_7191),sigM1_7190,pkCli_7148) <> true) then
                                                            0
                                                        else
                                                            {7841}let (=OpenSecureChannelRequest,=pkCli_7148,wNc_7192: bitstring) = m1_7191 in
                                                            {7842}let Nc_7193: bitstring = dec(wNc_7192,skSess_7145) in
                                                            {7843}new Ns_7194: bitstring;
                                                            {7844}new ST_7195: bitstring;
                                                            {7845}new TTL_7196: bitstring;
                                                            {7846}let wNs_7197: bitstring = enc(Ns_7194,pkCli_7148) in
                                                            {7847}let m2_7198: bitstring = (OpenSecureChannelResponse,wNs_7197,ST_7195,TTL_7196) in
                                                            {7848}out(c, (enc(m2_7198,pkCli_7148),sign(h(m2_7198),skSess_7145)));
                                                            {7849}let Ksrv_7199: bitstring = h((Ns_7194,Nc_7193)) in
                                                            {7850}out(c, senc(mSrv(pkCli_7148,pkSess_7146),Ksrv_7199))
                                                )
                                                else
                                                    {7851}let pkDisco_7200: bitstring = fail-any in
                                                    {7852}in(c, (=pkCli_7148,em1_7201: bitstring,sigM1_7202: bitstring));
                                                    {7853}let m1_7203: bitstring = dec(em1_7201,skSess_7145) in
                                                    {7854}if (verify(h(m1_7203),sigM1_7202,pkCli_7148) <> true) then
                                                        0
                                                    else
                                                        {7855}let (=OpenSecureChannelRequest,=pkCli_7148,wNc_7204: bitstring) = m1_7203 in
                                                        {7856}let Nc_7205: bitstring = dec(wNc_7204,skSess_7145) in
                                                        {7857}new Ns_7206: bitstring;
                                                        {7858}new ST_7207: bitstring;
                                                        {7859}new TTL_7208: bitstring;
                                                        {7860}let wNs_7209: bitstring = enc(Ns_7206,pkCli_7148) in
                                                        {7861}let m2_7210: bitstring = (OpenSecureChannelResponse,wNs_7209,ST_7207,TTL_7208) in
                                                        {7862}out(c, (enc(m2_7210,pkCli_7148),sign(h(m2_7210),skSess_7145)));
                                                        {7863}let Ksrv_7211: bitstring = h((Ns_7206,Nc_7205)) in
                                                        {7864}out(c, senc(mSrv(pkCli_7148,pkSess_7146),Ksrv_7211))
                                        )
                                        else
                                            {7865}let pkDisco_7212: bitstring = fail-any in
                                            {7866}in(c, (=pkCli_7148,em1_7213: bitstring,sigM1_7214: bitstring));
                                            {7867}let m1_7215: bitstring = dec(em1_7213,skSess_7145) in
                                            {7868}if (verify(h(m1_7215),sigM1_7214,pkCli_7148) <> true) then
                                                0
                                            else
                                                {7869}let (=OpenSecureChannelRequest,=pkCli_7148,wNc_7216: bitstring) = m1_7215 in
                                                {7870}let Nc_7217: bitstring = dec(wNc_7216,skSess_7145) in
                                                {7871}new Ns_7218: bitstring;
                                                {7872}new ST_7219: bitstring;
                                                {7873}new TTL_7220: bitstring;
                                                {7874}let wNs_7221: bitstring = enc(Ns_7218,pkCli_7148) in
                                                {7875}let m2_7222: bitstring = (OpenSecureChannelResponse,wNs_7221,ST_7219,TTL_7220) in
                                                {7876}out(c, (enc(m2_7222,pkCli_7148),sign(h(m2_7222),skSess_7145)));
                                                {7877}let Ksrv_7223: bitstring = h((Ns_7218,Nc_7217)) in
                                                {7878}out(c, senc(mSrv(pkCli_7148,pkSess_7146),Ksrv_7223))
                                )
                                else
                                    {7879}let pkDisco_7224: bitstring = fail-any in
                                    {7880}in(c, (=pkCli_7148,em1_7225: bitstring,sigM1_7226: bitstring));
                                    {7881}let m1_7227: bitstring = dec(em1_7225,skSess_7145) in
                                    {7882}if (verify(h(m1_7227),sigM1_7226,pkCli_7148) <> true) then
                                        0
                                    else
                                        {7883}let (=OpenSecureChannelRequest,=pkCli_7148,wNc_7228: bitstring) = m1_7227 in
                                        {7884}let Nc_7229: bitstring = dec(wNc_7228,skSess_7145) in
                                        {7885}new Ns_7230: bitstring;
                                        {7886}new ST_7231: bitstring;
                                        {7887}new TTL_7232: bitstring;
                                        {7888}let wNs_7233: bitstring = enc(Ns_7230,pkCli_7148) in
                                        {7889}let m2_7234: bitstring = (OpenSecureChannelResponse,wNs_7233,ST_7231,TTL_7232) in
                                        {7890}out(c, (enc(m2_7234,pkCli_7148),sign(h(m2_7234),skSess_7145)));
                                        {7891}let Ksrv_7235: bitstring = h((Ns_7230,Nc_7229)) in
                                        {7892}out(c, senc(mSrv(pkCli_7148,pkSess_7146),Ksrv_7235))
                            )
                            else
                                {7893}let v_7236: bool = (Cli_5902 = B) in
                                (
                                    {7894}if v_7236 then
                                    (
                                        {7895}let pkCli_7237: bitstring = pub(skB) in
                                        {7896}let v_7238: bool = (Disco_5903 = A) in
                                        (
                                            {7897}if v_7238 then
                                            (
                                                {7898}let pkDisco_7239: bitstring = pub(skA) in
                                                {7899}in(c, (=pkCli_7237,em1_7240: bitstring,sigM1_7241: bitstring));
                                                {7900}let m1_7242: bitstring = dec(em1_7240,skSess_7145) in
                                                {7901}if (verify(h(m1_7242),sigM1_7241,pkCli_7237) <> true) then
                                                    0
                                                else
                                                    {7902}let (=OpenSecureChannelRequest,=pkCli_7237,wNc_7243: bitstring) = m1_7242 in
                                                    {7903}let Nc_7244: bitstring = dec(wNc_7243,skSess_7145) in
                                                    {7904}new Ns_7245: bitstring;
                                                    {7905}new ST_7246: bitstring;
                                                    {7906}new TTL_7247: bitstring;
                                                    {7907}let wNs_7248: bitstring = enc(Ns_7245,pkCli_7237) in
                                                    {7908}let m2_7249: bitstring = (OpenSecureChannelResponse,wNs_7248,ST_7246,TTL_7247) in
                                                    {7909}out(c, (enc(m2_7249,pkCli_7237),sign(h(m2_7249),skSess_7145)));
                                                    {7910}let Ksrv_7250: bitstring = h((Ns_7245,Nc_7244)) in
                                                    {7911}out(c, senc(mSrv(pkCli_7237,pkSess_7146),Ksrv_7250))
                                            )
                                            else
                                                {7912}let v_7251: bool = (Disco_5903 = B) in
                                                (
                                                    {7913}if v_7251 then
                                                    (
                                                        {7914}let pkDisco_7252: bitstring = pub(skB) in
                                                        {7915}in(c, (=pkCli_7237,em1_7253: bitstring,sigM1_7254: bitstring));
                                                        {7916}let m1_7255: bitstring = dec(em1_7253,skSess_7145) in
                                                        {7917}if (verify(h(m1_7255),sigM1_7254,pkCli_7237) <> true) then
                                                            0
                                                        else
                                                            {7918}let (=OpenSecureChannelRequest,=pkCli_7237,wNc_7256: bitstring) = m1_7255 in
                                                            {7919}let Nc_7257: bitstring = dec(wNc_7256,skSess_7145) in
                                                            {7920}new Ns_7258: bitstring;
                                                            {7921}new ST_7259: bitstring;
                                                            {7922}new TTL_7260: bitstring;
                                                            {7923}let wNs_7261: bitstring = enc(Ns_7258,pkCli_7237) in
                                                            {7924}let m2_7262: bitstring = (OpenSecureChannelResponse,wNs_7261,ST_7259,TTL_7260) in
                                                            {7925}out(c, (enc(m2_7262,pkCli_7237),sign(h(m2_7262),skSess_7145)));
                                                            {7926}let Ksrv_7263: bitstring = h((Ns_7258,Nc_7257)) in
                                                            {7927}out(c, senc(mSrv(pkCli_7237,pkSess_7146),Ksrv_7263))
                                                    )
                                                    else
                                                        {7928}let v_7264: bool = (Disco_5903 = C) in
                                                        (
                                                            {7929}if v_7264 then
                                                            (
                                                                {7930}let pkDisco_7265: bitstring = pub(skC) in
                                                                {7931}in(c, (=pkCli_7237,em1_7266: bitstring,sigM1_7267: bitstring));
                                                                {7932}let m1_7268: bitstring = dec(em1_7266,skSess_7145) in
                                                                {7933}if (verify(h(m1_7268),sigM1_7267,pkCli_7237) <> true) then
                                                                    0
                                                                else
                                                                    {7934}let (=OpenSecureChannelRequest,=pkCli_7237,wNc_7269: bitstring) = m1_7268 in
                                                                    {7935}let Nc_7270: bitstring = dec(wNc_7269,skSess_7145) in
                                                                    {7936}new Ns_7271: bitstring;
                                                                    {7937}new ST_7272: bitstring;
                                                                    {7938}new TTL_7273: bitstring;
                                                                    {7939}let wNs_7274: bitstring = enc(Ns_7271,pkCli_7237) in
                                                                    {7940}let m2_7275: bitstring = (OpenSecureChannelResponse,wNs_7274,ST_7272,TTL_7273) in
                                                                    {7941}out(c, (enc(m2_7275,pkCli_7237),sign(h(m2_7275),skSess_7145)));
                                                                    {7942}let Ksrv_7276: bitstring = h((Ns_7271,Nc_7270)) in
                                                                    {7943}out(c, senc(mSrv(pkCli_7237,pkSess_7146),Ksrv_7276))
                                                            )
                                                            else
                                                                {7944}let pkDisco_7277: bitstring = pub(sk(Disco_5903)) in
                                                                {7945}in(c, (=pkCli_7237,em1_7278: bitstring,sigM1_7279: bitstring));
                                                                {7946}let m1_7280: bitstring = dec(em1_7278,skSess_7145) in
                                                                {7947}if (verify(h(m1_7280),sigM1_7279,pkCli_7237) <> true) then
                                                                    0
                                                                else
                                                                    {7948}let (=OpenSecureChannelRequest,=pkCli_7237,wNc_7281: bitstring) = m1_7280 in
                                                                    {7949}let Nc_7282: bitstring = dec(wNc_7281,skSess_7145) in
                                                                    {7950}new Ns_7283: bitstring;
                                                                    {7951}new ST_7284: bitstring;
                                                                    {7952}new TTL_7285: bitstring;
                                                                    {7953}let wNs_7286: bitstring = enc(Ns_7283,pkCli_7237) in
                                                                    {7954}let m2_7287: bitstring = (OpenSecureChannelResponse,wNs_7286,ST_7284,TTL_7285) in
                                                                    {7955}out(c, (enc(m2_7287,pkCli_7237),sign(h(m2_7287),skSess_7145)));
                                                                    {7956}let Ksrv_7288: bitstring = h((Ns_7283,Nc_7282)) in
                                                                    {7957}out(c, senc(mSrv(pkCli_7237,pkSess_7146),Ksrv_7288))
                                                        )
                                                        else
                                                            {7958}let pkDisco_7289: bitstring = fail-any in
                                                            {7959}in(c, (=pkCli_7237,em1_7290: bitstring,sigM1_7291: bitstring));
                                                            {7960}let m1_7292: bitstring = dec(em1_7290,skSess_7145) in
                                                            {7961}if (verify(h(m1_7292),sigM1_7291,pkCli_7237) <> true) then
                                                                0
                                                            else
                                                                {7962}let (=OpenSecureChannelRequest,=pkCli_7237,wNc_7293: bitstring) = m1_7292 in
                                                                {7963}let Nc_7294: bitstring = dec(wNc_7293,skSess_7145) in
                                                                {7964}new Ns_7295: bitstring;
                                                                {7965}new ST_7296: bitstring;
                                                                {7966}new TTL_7297: bitstring;
                                                                {7967}let wNs_7298: bitstring = enc(Ns_7295,pkCli_7237) in
                                                                {7968}let m2_7299: bitstring = (OpenSecureChannelResponse,wNs_7298,ST_7296,TTL_7297) in
                                                                {7969}out(c, (enc(m2_7299,pkCli_7237),sign(h(m2_7299),skSess_7145)));
                                                                {7970}let Ksrv_7300: bitstring = h((Ns_7295,Nc_7294)) in
                                                                {7971}out(c, senc(mSrv(pkCli_7237,pkSess_7146),Ksrv_7300))
                                                )
                                                else
                                                    {7972}let pkDisco_7301: bitstring = fail-any in
                                                    {7973}in(c, (=pkCli_7237,em1_7302: bitstring,sigM1_7303: bitstring));
                                                    {7974}let m1_7304: bitstring = dec(em1_7302,skSess_7145) in
                                                    {7975}if (verify(h(m1_7304),sigM1_7303,pkCli_7237) <> true) then
                                                        0
                                                    else
                                                        {7976}let (=OpenSecureChannelRequest,=pkCli_7237,wNc_7305: bitstring) = m1_7304 in
                                                        {7977}let Nc_7306: bitstring = dec(wNc_7305,skSess_7145) in
                                                        {7978}new Ns_7307: bitstring;
                                                        {7979}new ST_7308: bitstring;
                                                        {7980}new TTL_7309: bitstring;
                                                        {7981}let wNs_7310: bitstring = enc(Ns_7307,pkCli_7237) in
                                                        {7982}let m2_7311: bitstring = (OpenSecureChannelResponse,wNs_7310,ST_7308,TTL_7309) in
                                                        {7983}out(c, (enc(m2_7311,pkCli_7237),sign(h(m2_7311),skSess_7145)));
                                                        {7984}let Ksrv_7312: bitstring = h((Ns_7307,Nc_7306)) in
                                                        {7985}out(c, senc(mSrv(pkCli_7237,pkSess_7146),Ksrv_7312))
                                        )
                                        else
                                            {7986}let pkDisco_7313: bitstring = fail-any in
                                            {7987}in(c, (=pkCli_7237,em1_7314: bitstring,sigM1_7315: bitstring));
                                            {7988}let m1_7316: bitstring = dec(em1_7314,skSess_7145) in
                                            {7989}if (verify(h(m1_7316),sigM1_7315,pkCli_7237) <> true) then
                                                0
                                            else
                                                {7990}let (=OpenSecureChannelRequest,=pkCli_7237,wNc_7317: bitstring) = m1_7316 in
                                                {7991}let Nc_7318: bitstring = dec(wNc_7317,skSess_7145) in
                                                {7992}new Ns_7319: bitstring;
                                                {7993}new ST_7320: bitstring;
                                                {7994}new TTL_7321: bitstring;
                                                {7995}let wNs_7322: bitstring = enc(Ns_7319,pkCli_7237) in
                                                {7996}let m2_7323: bitstring = (OpenSecureChannelResponse,wNs_7322,ST_7320,TTL_7321) in
                                                {7997}out(c, (enc(m2_7323,pkCli_7237),sign(h(m2_7323),skSess_7145)));
                                                {7998}let Ksrv_7324: bitstring = h((Ns_7319,Nc_7318)) in
                                                {7999}out(c, senc(mSrv(pkCli_7237,pkSess_7146),Ksrv_7324))
                                    )
                                    else
                                        {8000}let v_7325: bool = (Cli_5902 = C) in
                                        (
                                            {8001}if v_7325 then
                                            (
                                                {8002}let pkCli_7326: bitstring = pub(skC) in
                                                {8003}let v_7327: bool = (Disco_5903 = A) in
                                                (
                                                    {8004}if v_7327 then
                                                    (
                                                        {8005}let pkDisco_7328: bitstring = pub(skA) in
                                                        {8006}in(c, (=pkCli_7326,em1_7329: bitstring,sigM1_7330: bitstring));
                                                        {8007}let m1_7331: bitstring = dec(em1_7329,skSess_7145) in
                                                        {8008}if (verify(h(m1_7331),sigM1_7330,pkCli_7326) <> true) then
                                                            0
                                                        else
                                                            {8009}let (=OpenSecureChannelRequest,=pkCli_7326,wNc_7332: bitstring) = m1_7331 in
                                                            {8010}let Nc_7333: bitstring = dec(wNc_7332,skSess_7145) in
                                                            {8011}new Ns_7334: bitstring;
                                                            {8012}new ST_7335: bitstring;
                                                            {8013}new TTL_7336: bitstring;
                                                            {8014}let wNs_7337: bitstring = enc(Ns_7334,pkCli_7326) in
                                                            {8015}let m2_7338: bitstring = (OpenSecureChannelResponse,wNs_7337,ST_7335,TTL_7336) in
                                                            {8016}out(c, (enc(m2_7338,pkCli_7326),sign(h(m2_7338),skSess_7145)));
                                                            {8017}let Ksrv_7339: bitstring = h((Ns_7334,Nc_7333)) in
                                                            {8018}out(c, senc(mSrv(pkCli_7326,pkSess_7146),Ksrv_7339))
                                                    )
                                                    else
                                                        {8019}let v_7340: bool = (Disco_5903 = B) in
                                                        (
                                                            {8020}if v_7340 then
                                                            (
                                                                {8021}let pkDisco_7341: bitstring = pub(skB) in
                                                                {8022}in(c, (=pkCli_7326,em1_7342: bitstring,sigM1_7343: bitstring));
                                                                {8023}let m1_7344: bitstring = dec(em1_7342,skSess_7145) in
                                                                {8024}if (verify(h(m1_7344),sigM1_7343,pkCli_7326) <> true) then
                                                                    0
                                                                else
                                                                    {8025}let (=OpenSecureChannelRequest,=pkCli_7326,wNc_7345: bitstring) = m1_7344 in
                                                                    {8026}let Nc_7346: bitstring = dec(wNc_7345,skSess_7145) in
                                                                    {8027}new Ns_7347: bitstring;
                                                                    {8028}new ST_7348: bitstring;
                                                                    {8029}new TTL_7349: bitstring;
                                                                    {8030}let wNs_7350: bitstring = enc(Ns_7347,pkCli_7326) in
                                                                    {8031}let m2_7351: bitstring = (OpenSecureChannelResponse,wNs_7350,ST_7348,TTL_7349) in
                                                                    {8032}out(c, (enc(m2_7351,pkCli_7326),sign(h(m2_7351),skSess_7145)));
                                                                    {8033}let Ksrv_7352: bitstring = h((Ns_7347,Nc_7346)) in
                                                                    {8034}out(c, senc(mSrv(pkCli_7326,pkSess_7146),Ksrv_7352))
                                                            )
                                                            else
                                                                {8035}let v_7353: bool = (Disco_5903 = C) in
                                                                (
                                                                    {8036}if v_7353 then
                                                                    (
                                                                        {8037}let pkDisco_7354: bitstring = pub(skC) in
                                                                        {8038}in(c, (=pkCli_7326,em1_7355: bitstring,sigM1_7356: bitstring));
                                                                        {8039}let m1_7357: bitstring = dec(em1_7355,skSess_7145) in
                                                                        {8040}if (verify(h(m1_7357),sigM1_7356,pkCli_7326) <> true) then
                                                                            0
                                                                        else
                                                                            {8041}let (=OpenSecureChannelRequest,=pkCli_7326,wNc_7358: bitstring) = m1_7357 in
                                                                            {8042}let Nc_7359: bitstring = dec(wNc_7358,skSess_7145) in
                                                                            {8043}new Ns_7360: bitstring;
                                                                            {8044}new ST_7361: bitstring;
                                                                            {8045}new TTL_7362: bitstring;
                                                                            {8046}let wNs_7363: bitstring = enc(Ns_7360,pkCli_7326) in
                                                                            {8047}let m2_7364: bitstring = (OpenSecureChannelResponse,wNs_7363,ST_7361,TTL_7362) in
                                                                            {8048}out(c, (enc(m2_7364,pkCli_7326),sign(h(m2_7364),skSess_7145)));
                                                                            {8049}let Ksrv_7365: bitstring = h((Ns_7360,Nc_7359)) in
                                                                            {8050}out(c, senc(mSrv(pkCli_7326,pkSess_7146),Ksrv_7365))
                                                                    )
                                                                    else
                                                                        {8051}let pkDisco_7366: bitstring = pub(sk(Disco_5903)) in
                                                                        {8052}in(c, (=pkCli_7326,em1_7367: bitstring,sigM1_7368: bitstring));
                                                                        {8053}let m1_7369: bitstring = dec(em1_7367,skSess_7145) in
                                                                        {8054}if (verify(h(m1_7369),sigM1_7368,pkCli_7326) <> true) then
                                                                            0
                                                                        else
                                                                            {8055}let (=OpenSecureChannelRequest,=pkCli_7326,wNc_7370: bitstring) = m1_7369 in
                                                                            {8056}let Nc_7371: bitstring = dec(wNc_7370,skSess_7145) in
                                                                            {8057}new Ns_7372: bitstring;
                                                                            {8058}new ST_7373: bitstring;
                                                                            {8059}new TTL_7374: bitstring;
                                                                            {8060}let wNs_7375: bitstring = enc(Ns_7372,pkCli_7326) in
                                                                            {8061}let m2_7376: bitstring = (OpenSecureChannelResponse,wNs_7375,ST_7373,TTL_7374) in
                                                                            {8062}out(c, (enc(m2_7376,pkCli_7326),sign(h(m2_7376),skSess_7145)));
                                                                            {8063}let Ksrv_7377: bitstring = h((Ns_7372,Nc_7371)) in
                                                                            {8064}out(c, senc(mSrv(pkCli_7326,pkSess_7146),Ksrv_7377))
                                                                )
                                                                else
                                                                    {8065}let pkDisco_7378: bitstring = fail-any in
                                                                    {8066}in(c, (=pkCli_7326,em1_7379: bitstring,sigM1_7380: bitstring));
                                                                    {8067}let m1_7381: bitstring = dec(em1_7379,skSess_7145) in
                                                                    {8068}if (verify(h(m1_7381),sigM1_7380,pkCli_7326) <> true) then
                                                                        0
                                                                    else
                                                                        {8069}let (=OpenSecureChannelRequest,=pkCli_7326,wNc_7382: bitstring) = m1_7381 in
                                                                        {8070}let Nc_7383: bitstring = dec(wNc_7382,skSess_7145) in
                                                                        {8071}new Ns_7384: bitstring;
                                                                        {8072}new ST_7385: bitstring;
                                                                        {8073}new TTL_7386: bitstring;
                                                                        {8074}let wNs_7387: bitstring = enc(Ns_7384,pkCli_7326) in
                                                                        {8075}let m2_7388: bitstring = (OpenSecureChannelResponse,wNs_7387,ST_7385,TTL_7386) in
                                                                        {8076}out(c, (enc(m2_7388,pkCli_7326),sign(h(m2_7388),skSess_7145)));
                                                                        {8077}let Ksrv_7389: bitstring = h((Ns_7384,Nc_7383)) in
                                                                        {8078}out(c, senc(mSrv(pkCli_7326,pkSess_7146),Ksrv_7389))
                                                        )
                                                        else
                                                            {8079}let pkDisco_7390: bitstring = fail-any in
                                                            {8080}in(c, (=pkCli_7326,em1_7391: bitstring,sigM1_7392: bitstring));
                                                            {8081}let m1_7393: bitstring = dec(em1_7391,skSess_7145) in
                                                            {8082}if (verify(h(m1_7393),sigM1_7392,pkCli_7326) <> true) then
                                                                0
                                                            else
                                                                {8083}let (=OpenSecureChannelRequest,=pkCli_7326,wNc_7394: bitstring) = m1_7393 in
                                                                {8084}let Nc_7395: bitstring = dec(wNc_7394,skSess_7145) in
                                                                {8085}new Ns_7396: bitstring;
                                                                {8086}new ST_7397: bitstring;
                                                                {8087}new TTL_7398: bitstring;
                                                                {8088}let wNs_7399: bitstring = enc(Ns_7396,pkCli_7326) in
                                                                {8089}let m2_7400: bitstring = (OpenSecureChannelResponse,wNs_7399,ST_7397,TTL_7398) in
                                                                {8090}out(c, (enc(m2_7400,pkCli_7326),sign(h(m2_7400),skSess_7145)));
                                                                {8091}let Ksrv_7401: bitstring = h((Ns_7396,Nc_7395)) in
                                                                {8092}out(c, senc(mSrv(pkCli_7326,pkSess_7146),Ksrv_7401))
                                                )
                                                else
                                                    {8093}let pkDisco_7402: bitstring = fail-any in
                                                    {8094}in(c, (=pkCli_7326,em1_7403: bitstring,sigM1_7404: bitstring));
                                                    {8095}let m1_7405: bitstring = dec(em1_7403,skSess_7145) in
                                                    {8096}if (verify(h(m1_7405),sigM1_7404,pkCli_7326) <> true) then
                                                        0
                                                    else
                                                        {8097}let (=OpenSecureChannelRequest,=pkCli_7326,wNc_7406: bitstring) = m1_7405 in
                                                        {8098}let Nc_7407: bitstring = dec(wNc_7406,skSess_7145) in
                                                        {8099}new Ns_7408: bitstring;
                                                        {8100}new ST_7409: bitstring;
                                                        {8101}new TTL_7410: bitstring;
                                                        {8102}let wNs_7411: bitstring = enc(Ns_7408,pkCli_7326) in
                                                        {8103}let m2_7412: bitstring = (OpenSecureChannelResponse,wNs_7411,ST_7409,TTL_7410) in
                                                        {8104}out(c, (enc(m2_7412,pkCli_7326),sign(h(m2_7412),skSess_7145)));
                                                        {8105}let Ksrv_7413: bitstring = h((Ns_7408,Nc_7407)) in
                                                        {8106}out(c, senc(mSrv(pkCli_7326,pkSess_7146),Ksrv_7413))
                                            )
                                            else
                                                {8107}let pkCli_7414: bitstring = pub(sk(Cli_5902)) in
                                                {8108}let v_7415: bool = (Disco_5903 = A) in
                                                (
                                                    {8109}if v_7415 then
                                                    (
                                                        {8110}let pkDisco_7416: bitstring = pub(skA) in
                                                        {8111}in(c, (=pkCli_7414,em1_7417: bitstring,sigM1_7418: bitstring));
                                                        {8112}let m1_7419: bitstring = dec(em1_7417,skSess_7145) in
                                                        {8113}if (verify(h(m1_7419),sigM1_7418,pkCli_7414) <> true) then
                                                            0
                                                        else
                                                            {8114}let (=OpenSecureChannelRequest,=pkCli_7414,wNc_7420: bitstring) = m1_7419 in
                                                            {8115}let Nc_7421: bitstring = dec(wNc_7420,skSess_7145) in
                                                            {8116}new Ns_7422: bitstring;
                                                            {8117}new ST_7423: bitstring;
                                                            {8118}new TTL_7424: bitstring;
                                                            {8119}let wNs_7425: bitstring = enc(Ns_7422,pkCli_7414) in
                                                            {8120}let m2_7426: bitstring = (OpenSecureChannelResponse,wNs_7425,ST_7423,TTL_7424) in
                                                            {8121}out(c, (enc(m2_7426,pkCli_7414),sign(h(m2_7426),skSess_7145)));
                                                            {8122}let Ksrv_7427: bitstring = h((Ns_7422,Nc_7421)) in
                                                            {8123}out(c, senc(mSrv(pkCli_7414,pkSess_7146),Ksrv_7427))
                                                    )
                                                    else
                                                        {8124}let v_7428: bool = (Disco_5903 = B) in
                                                        (
                                                            {8125}if v_7428 then
                                                            (
                                                                {8126}let pkDisco_7429: bitstring = pub(skB) in
                                                                {8127}in(c, (=pkCli_7414,em1_7430: bitstring,sigM1_7431: bitstring));
                                                                {8128}let m1_7432: bitstring = dec(em1_7430,skSess_7145) in
                                                                {8129}if (verify(h(m1_7432),sigM1_7431,pkCli_7414) <> true) then
                                                                    0
                                                                else
                                                                    {8130}let (=OpenSecureChannelRequest,=pkCli_7414,wNc_7433: bitstring) = m1_7432 in
                                                                    {8131}let Nc_7434: bitstring = dec(wNc_7433,skSess_7145) in
                                                                    {8132}new Ns_7435: bitstring;
                                                                    {8133}new ST_7436: bitstring;
                                                                    {8134}new TTL_7437: bitstring;
                                                                    {8135}let wNs_7438: bitstring = enc(Ns_7435,pkCli_7414) in
                                                                    {8136}let m2_7439: bitstring = (OpenSecureChannelResponse,wNs_7438,ST_7436,TTL_7437) in
                                                                    {8137}out(c, (enc(m2_7439,pkCli_7414),sign(h(m2_7439),skSess_7145)));
                                                                    {8138}let Ksrv_7440: bitstring = h((Ns_7435,Nc_7434)) in
                                                                    {8139}out(c, senc(mSrv(pkCli_7414,pkSess_7146),Ksrv_7440))
                                                            )
                                                            else
                                                                {8140}let v_7441: bool = (Disco_5903 = C) in
                                                                (
                                                                    {8141}if v_7441 then
                                                                    (
                                                                        {8142}let pkDisco_7442: bitstring = pub(skC) in
                                                                        {8143}in(c, (=pkCli_7414,em1_7443: bitstring,sigM1_7444: bitstring));
                                                                        {8144}let m1_7445: bitstring = dec(em1_7443,skSess_7145) in
                                                                        {8145}if (verify(h(m1_7445),sigM1_7444,pkCli_7414) <> true) then
                                                                            0
                                                                        else
                                                                            {8146}let (=OpenSecureChannelRequest,=pkCli_7414,wNc_7446: bitstring) = m1_7445 in
                                                                            {8147}let Nc_7447: bitstring = dec(wNc_7446,skSess_7145) in
                                                                            {8148}new Ns_7448: bitstring;
                                                                            {8149}new ST_7449: bitstring;
                                                                            {8150}new TTL_7450: bitstring;
                                                                            {8151}let wNs_7451: bitstring = enc(Ns_7448,pkCli_7414) in
                                                                            {8152}let m2_7452: bitstring = (OpenSecureChannelResponse,wNs_7451,ST_7449,TTL_7450) in
                                                                            {8153}out(c, (enc(m2_7452,pkCli_7414),sign(h(m2_7452),skSess_7145)));
                                                                            {8154}let Ksrv_7453: bitstring = h((Ns_7448,Nc_7447)) in
                                                                            {8155}out(c, senc(mSrv(pkCli_7414,pkSess_7146),Ksrv_7453))
                                                                    )
                                                                    else
                                                                        {8156}let pkDisco_7454: bitstring = pub(sk(Disco_5903)) in
                                                                        {8157}in(c, (=pkCli_7414,em1_7455: bitstring,sigM1_7456: bitstring));
                                                                        {8158}let m1_7457: bitstring = dec(em1_7455,skSess_7145) in
                                                                        {8159}if (verify(h(m1_7457),sigM1_7456,pkCli_7414) <> true) then
                                                                            0
                                                                        else
                                                                            {8160}let (=OpenSecureChannelRequest,=pkCli_7414,wNc_7458: bitstring) = m1_7457 in
                                                                            {8161}let Nc_7459: bitstring = dec(wNc_7458,skSess_7145) in
                                                                            {8162}new Ns_7460: bitstring;
                                                                            {8163}new ST_7461: bitstring;
                                                                            {8164}new TTL_7462: bitstring;
                                                                            {8165}let wNs_7463: bitstring = enc(Ns_7460,pkCli_7414) in
                                                                            {8166}let m2_7464: bitstring = (OpenSecureChannelResponse,wNs_7463,ST_7461,TTL_7462) in
                                                                            {8167}out(c, (enc(m2_7464,pkCli_7414),sign(h(m2_7464),skSess_7145)));
                                                                            {8168}let Ksrv_7465: bitstring = h((Ns_7460,Nc_7459)) in
                                                                            {8169}out(c, senc(mSrv(pkCli_7414,pkSess_7146),Ksrv_7465))
                                                                )
                                                                else
                                                                    {8170}let pkDisco_7466: bitstring = fail-any in
                                                                    {8171}in(c, (=pkCli_7414,em1_7467: bitstring,sigM1_7468: bitstring));
                                                                    {8172}let m1_7469: bitstring = dec(em1_7467,skSess_7145) in
                                                                    {8173}if (verify(h(m1_7469),sigM1_7468,pkCli_7414) <> true) then
                                                                        0
                                                                    else
                                                                        {8174}let (=OpenSecureChannelRequest,=pkCli_7414,wNc_7470: bitstring) = m1_7469 in
                                                                        {8175}let Nc_7471: bitstring = dec(wNc_7470,skSess_7145) in
                                                                        {8176}new Ns_7472: bitstring;
                                                                        {8177}new ST_7473: bitstring;
                                                                        {8178}new TTL_7474: bitstring;
                                                                        {8179}let wNs_7475: bitstring = enc(Ns_7472,pkCli_7414) in
                                                                        {8180}let m2_7476: bitstring = (OpenSecureChannelResponse,wNs_7475,ST_7473,TTL_7474) in
                                                                        {8181}out(c, (enc(m2_7476,pkCli_7414),sign(h(m2_7476),skSess_7145)));
                                                                        {8182}let Ksrv_7477: bitstring = h((Ns_7472,Nc_7471)) in
                                                                        {8183}out(c, senc(mSrv(pkCli_7414,pkSess_7146),Ksrv_7477))
                                                        )
                                                        else
                                                            {8184}let pkDisco_7478: bitstring = fail-any in
                                                            {8185}in(c, (=pkCli_7414,em1_7479: bitstring,sigM1_7480: bitstring));
                                                            {8186}let m1_7481: bitstring = dec(em1_7479,skSess_7145) in
                                                            {8187}if (verify(h(m1_7481),sigM1_7480,pkCli_7414) <> true) then
                                                                0
                                                            else
                                                                {8188}let (=OpenSecureChannelRequest,=pkCli_7414,wNc_7482: bitstring) = m1_7481 in
                                                                {8189}let Nc_7483: bitstring = dec(wNc_7482,skSess_7145) in
                                                                {8190}new Ns_7484: bitstring;
                                                                {8191}new ST_7485: bitstring;
                                                                {8192}new TTL_7486: bitstring;
                                                                {8193}let wNs_7487: bitstring = enc(Ns_7484,pkCli_7414) in
                                                                {8194}let m2_7488: bitstring = (OpenSecureChannelResponse,wNs_7487,ST_7485,TTL_7486) in
                                                                {8195}out(c, (enc(m2_7488,pkCli_7414),sign(h(m2_7488),skSess_7145)));
                                                                {8196}let Ksrv_7489: bitstring = h((Ns_7484,Nc_7483)) in
                                                                {8197}out(c, senc(mSrv(pkCli_7414,pkSess_7146),Ksrv_7489))
                                                )
                                                else
                                                    {8198}let pkDisco_7490: bitstring = fail-any in
                                                    {8199}in(c, (=pkCli_7414,em1_7491: bitstring,sigM1_7492: bitstring));
                                                    {8200}let m1_7493: bitstring = dec(em1_7491,skSess_7145) in
                                                    {8201}if (verify(h(m1_7493),sigM1_7492,pkCli_7414) <> true) then
                                                        0
                                                    else
                                                        {8202}let (=OpenSecureChannelRequest,=pkCli_7414,wNc_7494: bitstring) = m1_7493 in
                                                        {8203}let Nc_7495: bitstring = dec(wNc_7494,skSess_7145) in
                                                        {8204}new Ns_7496: bitstring;
                                                        {8205}new ST_7497: bitstring;
                                                        {8206}new TTL_7498: bitstring;
                                                        {8207}let wNs_7499: bitstring = enc(Ns_7496,pkCli_7414) in
                                                        {8208}let m2_7500: bitstring = (OpenSecureChannelResponse,wNs_7499,ST_7497,TTL_7498) in
                                                        {8209}out(c, (enc(m2_7500,pkCli_7414),sign(h(m2_7500),skSess_7145)));
                                                        {8210}let Ksrv_7501: bitstring = h((Ns_7496,Nc_7495)) in
                                                        {8211}out(c, senc(mSrv(pkCli_7414,pkSess_7146),Ksrv_7501))
                                        )
                                        else
                                            {8212}let pkCli_7502: bitstring = fail-any in
                                            {8213}let v_7503: bool = (Disco_5903 = A) in
                                            (
                                                {8214}if v_7503 then
                                                (
                                                    {8215}let pkDisco_7504: bitstring = pub(skA) in
                                                    {8216}in(c, (=pkCli_7502,em1_7505: bitstring,sigM1_7506: bitstring));
                                                    {8217}let m1_7507: bitstring = dec(em1_7505,skSess_7145) in
                                                    {8218}if (verify(h(m1_7507),sigM1_7506,pkCli_7502) <> true) then
                                                        0
                                                    else
                                                        {8219}let (=OpenSecureChannelRequest,=pkCli_7502,wNc_7508: bitstring) = m1_7507 in
                                                        {8220}let Nc_7509: bitstring = dec(wNc_7508,skSess_7145) in
                                                        {8221}new Ns_7510: bitstring;
                                                        {8222}new ST_7511: bitstring;
                                                        {8223}new TTL_7512: bitstring;
                                                        {8224}let wNs_7513: bitstring = enc(Ns_7510,pkCli_7502) in
                                                        {8225}let m2_7514: bitstring = (OpenSecureChannelResponse,wNs_7513,ST_7511,TTL_7512) in
                                                        {8226}out(c, (enc(m2_7514,pkCli_7502),sign(h(m2_7514),skSess_7145)));
                                                        {8227}let Ksrv_7515: bitstring = h((Ns_7510,Nc_7509)) in
                                                        {8228}out(c, senc(mSrv(pkCli_7502,pkSess_7146),Ksrv_7515))
                                                )
                                                else
                                                    {8229}let v_7516: bool = (Disco_5903 = B) in
                                                    (
                                                        {8230}if v_7516 then
                                                        (
                                                            {8231}let pkDisco_7517: bitstring = pub(skB) in
                                                            {8232}in(c, (=pkCli_7502,em1_7518: bitstring,sigM1_7519: bitstring));
                                                            {8233}let m1_7520: bitstring = dec(em1_7518,skSess_7145) in
                                                            {8234}if (verify(h(m1_7520),sigM1_7519,pkCli_7502) <> true) then
                                                                0
                                                            else
                                                                {8235}let (=OpenSecureChannelRequest,=pkCli_7502,wNc_7521: bitstring) = m1_7520 in
                                                                {8236}let Nc_7522: bitstring = dec(wNc_7521,skSess_7145) in
                                                                {8237}new Ns_7523: bitstring;
                                                                {8238}new ST_7524: bitstring;
                                                                {8239}new TTL_7525: bitstring;
                                                                {8240}let wNs_7526: bitstring = enc(Ns_7523,pkCli_7502) in
                                                                {8241}let m2_7527: bitstring = (OpenSecureChannelResponse,wNs_7526,ST_7524,TTL_7525) in
                                                                {8242}out(c, (enc(m2_7527,pkCli_7502),sign(h(m2_7527),skSess_7145)));
                                                                {8243}let Ksrv_7528: bitstring = h((Ns_7523,Nc_7522)) in
                                                                {8244}out(c, senc(mSrv(pkCli_7502,pkSess_7146),Ksrv_7528))
                                                        )
                                                        else
                                                            {8245}let v_7529: bool = (Disco_5903 = C) in
                                                            (
                                                                {8246}if v_7529 then
                                                                (
                                                                    {8247}let pkDisco_7530: bitstring = pub(skC) in
                                                                    {8248}in(c, (=pkCli_7502,em1_7531: bitstring,sigM1_7532: bitstring));
                                                                    {8249}let m1_7533: bitstring = dec(em1_7531,skSess_7145) in
                                                                    {8250}if (verify(h(m1_7533),sigM1_7532,pkCli_7502) <> true) then
                                                                        0
                                                                    else
                                                                        {8251}let (=OpenSecureChannelRequest,=pkCli_7502,wNc_7534: bitstring) = m1_7533 in
                                                                        {8252}let Nc_7535: bitstring = dec(wNc_7534,skSess_7145) in
                                                                        {8253}new Ns_7536: bitstring;
                                                                        {8254}new ST_7537: bitstring;
                                                                        {8255}new TTL_7538: bitstring;
                                                                        {8256}let wNs_7539: bitstring = enc(Ns_7536,pkCli_7502) in
                                                                        {8257}let m2_7540: bitstring = (OpenSecureChannelResponse,wNs_7539,ST_7537,TTL_7538) in
                                                                        {8258}out(c, (enc(m2_7540,pkCli_7502),sign(h(m2_7540),skSess_7145)));
                                                                        {8259}let Ksrv_7541: bitstring = h((Ns_7536,Nc_7535)) in
                                                                        {8260}out(c, senc(mSrv(pkCli_7502,pkSess_7146),Ksrv_7541))
                                                                )
                                                                else
                                                                    {8261}let pkDisco_7542: bitstring = pub(sk(Disco_5903)) in
                                                                    {8262}in(c, (=pkCli_7502,em1_7543: bitstring,sigM1_7544: bitstring));
                                                                    {8263}let m1_7545: bitstring = dec(em1_7543,skSess_7145) in
                                                                    {8264}if (verify(h(m1_7545),sigM1_7544,pkCli_7502) <> true) then
                                                                        0
                                                                    else
                                                                        {8265}let (=OpenSecureChannelRequest,=pkCli_7502,wNc_7546: bitstring) = m1_7545 in
                                                                        {8266}let Nc_7547: bitstring = dec(wNc_7546,skSess_7145) in
                                                                        {8267}new Ns_7548: bitstring;
                                                                        {8268}new ST_7549: bitstring;
                                                                        {8269}new TTL_7550: bitstring;
                                                                        {8270}let wNs_7551: bitstring = enc(Ns_7548,pkCli_7502) in
                                                                        {8271}let m2_7552: bitstring = (OpenSecureChannelResponse,wNs_7551,ST_7549,TTL_7550) in
                                                                        {8272}out(c, (enc(m2_7552,pkCli_7502),sign(h(m2_7552),skSess_7145)));
                                                                        {8273}let Ksrv_7553: bitstring = h((Ns_7548,Nc_7547)) in
                                                                        {8274}out(c, senc(mSrv(pkCli_7502,pkSess_7146),Ksrv_7553))
                                                            )
                                                            else
                                                                {8275}let pkDisco_7554: bitstring = fail-any in
                                                                {8276}in(c, (=pkCli_7502,em1_7555: bitstring,sigM1_7556: bitstring));
                                                                {8277}let m1_7557: bitstring = dec(em1_7555,skSess_7145) in
                                                                {8278}if (verify(h(m1_7557),sigM1_7556,pkCli_7502) <> true) then
                                                                    0
                                                                else
                                                                    {8279}let (=OpenSecureChannelRequest,=pkCli_7502,wNc_7558: bitstring) = m1_7557 in
                                                                    {8280}let Nc_7559: bitstring = dec(wNc_7558,skSess_7145) in
                                                                    {8281}new Ns_7560: bitstring;
                                                                    {8282}new ST_7561: bitstring;
                                                                    {8283}new TTL_7562: bitstring;
                                                                    {8284}let wNs_7563: bitstring = enc(Ns_7560,pkCli_7502) in
                                                                    {8285}let m2_7564: bitstring = (OpenSecureChannelResponse,wNs_7563,ST_7561,TTL_7562) in
                                                                    {8286}out(c, (enc(m2_7564,pkCli_7502),sign(h(m2_7564),skSess_7145)));
                                                                    {8287}let Ksrv_7565: bitstring = h((Ns_7560,Nc_7559)) in
                                                                    {8288}out(c, senc(mSrv(pkCli_7502,pkSess_7146),Ksrv_7565))
                                                    )
                                                    else
                                                        {8289}let pkDisco_7566: bitstring = fail-any in
                                                        {8290}in(c, (=pkCli_7502,em1_7567: bitstring,sigM1_7568: bitstring));
                                                        {8291}let m1_7569: bitstring = dec(em1_7567,skSess_7145) in
                                                        {8292}if (verify(h(m1_7569),sigM1_7568,pkCli_7502) <> true) then
                                                            0
                                                        else
                                                            {8293}let (=OpenSecureChannelRequest,=pkCli_7502,wNc_7570: bitstring) = m1_7569 in
                                                            {8294}let Nc_7571: bitstring = dec(wNc_7570,skSess_7145) in
                                                            {8295}new Ns_7572: bitstring;
                                                            {8296}new ST_7573: bitstring;
                                                            {8297}new TTL_7574: bitstring;
                                                            {8298}let wNs_7575: bitstring = enc(Ns_7572,pkCli_7502) in
                                                            {8299}let m2_7576: bitstring = (OpenSecureChannelResponse,wNs_7575,ST_7573,TTL_7574) in
                                                            {8300}out(c, (enc(m2_7576,pkCli_7502),sign(h(m2_7576),skSess_7145)));
                                                            {8301}let Ksrv_7577: bitstring = h((Ns_7572,Nc_7571)) in
                                                            {8302}out(c, senc(mSrv(pkCli_7502,pkSess_7146),Ksrv_7577))
                                            )
                                            else
                                                {8303}let pkDisco_7578: bitstring = fail-any in
                                                {8304}in(c, (=pkCli_7502,em1_7579: bitstring,sigM1_7580: bitstring));
                                                {8305}let m1_7581: bitstring = dec(em1_7579,skSess_7145) in
                                                {8306}if (verify(h(m1_7581),sigM1_7580,pkCli_7502) <> true) then
                                                    0
                                                else
                                                    {8307}let (=OpenSecureChannelRequest,=pkCli_7502,wNc_7582: bitstring) = m1_7581 in
                                                    {8308}let Nc_7583: bitstring = dec(wNc_7582,skSess_7145) in
                                                    {8309}new Ns_7584: bitstring;
                                                    {8310}new ST_7585: bitstring;
                                                    {8311}new TTL_7586: bitstring;
                                                    {8312}let wNs_7587: bitstring = enc(Ns_7584,pkCli_7502) in
                                                    {8313}let m2_7588: bitstring = (OpenSecureChannelResponse,wNs_7587,ST_7585,TTL_7586) in
                                                    {8314}out(c, (enc(m2_7588,pkCli_7502),sign(h(m2_7588),skSess_7145)));
                                                    {8315}let Ksrv_7589: bitstring = h((Ns_7584,Nc_7583)) in
                                                    {8316}out(c, senc(mSrv(pkCli_7502,pkSess_7146),Ksrv_7589))
                                )
                                else
                                    {8317}let pkCli_7590: bitstring = fail-any in
                                    {8318}let v_7591: bool = (Disco_5903 = A) in
                                    (
                                        {8319}if v_7591 then
                                        (
                                            {8320}let pkDisco_7592: bitstring = pub(skA) in
                                            {8321}in(c, (=pkCli_7590,em1_7593: bitstring,sigM1_7594: bitstring));
                                            {8322}let m1_7595: bitstring = dec(em1_7593,skSess_7145) in
                                            {8323}if (verify(h(m1_7595),sigM1_7594,pkCli_7590) <> true) then
                                                0
                                            else
                                                {8324}let (=OpenSecureChannelRequest,=pkCli_7590,wNc_7596: bitstring) = m1_7595 in
                                                {8325}let Nc_7597: bitstring = dec(wNc_7596,skSess_7145) in
                                                {8326}new Ns_7598: bitstring;
                                                {8327}new ST_7599: bitstring;
                                                {8328}new TTL_7600: bitstring;
                                                {8329}let wNs_7601: bitstring = enc(Ns_7598,pkCli_7590) in
                                                {8330}let m2_7602: bitstring = (OpenSecureChannelResponse,wNs_7601,ST_7599,TTL_7600) in
                                                {8331}out(c, (enc(m2_7602,pkCli_7590),sign(h(m2_7602),skSess_7145)));
                                                {8332}let Ksrv_7603: bitstring = h((Ns_7598,Nc_7597)) in
                                                {8333}out(c, senc(mSrv(pkCli_7590,pkSess_7146),Ksrv_7603))
                                        )
                                        else
                                            {8334}let v_7604: bool = (Disco_5903 = B) in
                                            (
                                                {8335}if v_7604 then
                                                (
                                                    {8336}let pkDisco_7605: bitstring = pub(skB) in
                                                    {8337}in(c, (=pkCli_7590,em1_7606: bitstring,sigM1_7607: bitstring));
                                                    {8338}let m1_7608: bitstring = dec(em1_7606,skSess_7145) in
                                                    {8339}if (verify(h(m1_7608),sigM1_7607,pkCli_7590) <> true) then
                                                        0
                                                    else
                                                        {8340}let (=OpenSecureChannelRequest,=pkCli_7590,wNc_7609: bitstring) = m1_7608 in
                                                        {8341}let Nc_7610: bitstring = dec(wNc_7609,skSess_7145) in
                                                        {8342}new Ns_7611: bitstring;
                                                        {8343}new ST_7612: bitstring;
                                                        {8344}new TTL_7613: bitstring;
                                                        {8345}let wNs_7614: bitstring = enc(Ns_7611,pkCli_7590) in
                                                        {8346}let m2_7615: bitstring = (OpenSecureChannelResponse,wNs_7614,ST_7612,TTL_7613) in
                                                        {8347}out(c, (enc(m2_7615,pkCli_7590),sign(h(m2_7615),skSess_7145)));
                                                        {8348}let Ksrv_7616: bitstring = h((Ns_7611,Nc_7610)) in
                                                        {8349}out(c, senc(mSrv(pkCli_7590,pkSess_7146),Ksrv_7616))
                                                )
                                                else
                                                    {8350}let v_7617: bool = (Disco_5903 = C) in
                                                    (
                                                        {8351}if v_7617 then
                                                        (
                                                            {8352}let pkDisco_7618: bitstring = pub(skC) in
                                                            {8353}in(c, (=pkCli_7590,em1_7619: bitstring,sigM1_7620: bitstring));
                                                            {8354}let m1_7621: bitstring = dec(em1_7619,skSess_7145) in
                                                            {8355}if (verify(h(m1_7621),sigM1_7620,pkCli_7590) <> true) then
                                                                0
                                                            else
                                                                {8356}let (=OpenSecureChannelRequest,=pkCli_7590,wNc_7622: bitstring) = m1_7621 in
                                                                {8357}let Nc_7623: bitstring = dec(wNc_7622,skSess_7145) in
                                                                {8358}new Ns_7624: bitstring;
                                                                {8359}new ST_7625: bitstring;
                                                                {8360}new TTL_7626: bitstring;
                                                                {8361}let wNs_7627: bitstring = enc(Ns_7624,pkCli_7590) in
                                                                {8362}let m2_7628: bitstring = (OpenSecureChannelResponse,wNs_7627,ST_7625,TTL_7626) in
                                                                {8363}out(c, (enc(m2_7628,pkCli_7590),sign(h(m2_7628),skSess_7145)));
                                                                {8364}let Ksrv_7629: bitstring = h((Ns_7624,Nc_7623)) in
                                                                {8365}out(c, senc(mSrv(pkCli_7590,pkSess_7146),Ksrv_7629))
                                                        )
                                                        else
                                                            {8366}let pkDisco_7630: bitstring = pub(sk(Disco_5903)) in
                                                            {8367}in(c, (=pkCli_7590,em1_7631: bitstring,sigM1_7632: bitstring));
                                                            {8368}let m1_7633: bitstring = dec(em1_7631,skSess_7145) in
                                                            {8369}if (verify(h(m1_7633),sigM1_7632,pkCli_7590) <> true) then
                                                                0
                                                            else
                                                                {8370}let (=OpenSecureChannelRequest,=pkCli_7590,wNc_7634: bitstring) = m1_7633 in
                                                                {8371}let Nc_7635: bitstring = dec(wNc_7634,skSess_7145) in
                                                                {8372}new Ns_7636: bitstring;
                                                                {8373}new ST_7637: bitstring;
                                                                {8374}new TTL_7638: bitstring;
                                                                {8375}let wNs_7639: bitstring = enc(Ns_7636,pkCli_7590) in
                                                                {8376}let m2_7640: bitstring = (OpenSecureChannelResponse,wNs_7639,ST_7637,TTL_7638) in
                                                                {8377}out(c, (enc(m2_7640,pkCli_7590),sign(h(m2_7640),skSess_7145)));
                                                                {8378}let Ksrv_7641: bitstring = h((Ns_7636,Nc_7635)) in
                                                                {8379}out(c, senc(mSrv(pkCli_7590,pkSess_7146),Ksrv_7641))
                                                    )
                                                    else
                                                        {8380}let pkDisco_7642: bitstring = fail-any in
                                                        {8381}in(c, (=pkCli_7590,em1_7643: bitstring,sigM1_7644: bitstring));
                                                        {8382}let m1_7645: bitstring = dec(em1_7643,skSess_7145) in
                                                        {8383}if (verify(h(m1_7645),sigM1_7644,pkCli_7590) <> true) then
                                                            0
                                                        else
                                                            {8384}let (=OpenSecureChannelRequest,=pkCli_7590,wNc_7646: bitstring) = m1_7645 in
                                                            {8385}let Nc_7647: bitstring = dec(wNc_7646,skSess_7145) in
                                                            {8386}new Ns_7648: bitstring;
                                                            {8387}new ST_7649: bitstring;
                                                            {8388}new TTL_7650: bitstring;
                                                            {8389}let wNs_7651: bitstring = enc(Ns_7648,pkCli_7590) in
                                                            {8390}let m2_7652: bitstring = (OpenSecureChannelResponse,wNs_7651,ST_7649,TTL_7650) in
                                                            {8391}out(c, (enc(m2_7652,pkCli_7590),sign(h(m2_7652),skSess_7145)));
                                                            {8392}let Ksrv_7653: bitstring = h((Ns_7648,Nc_7647)) in
                                                            {8393}out(c, senc(mSrv(pkCli_7590,pkSess_7146),Ksrv_7653))
                                            )
                                            else
                                                {8394}let pkDisco_7654: bitstring = fail-any in
                                                {8395}in(c, (=pkCli_7590,em1_7655: bitstring,sigM1_7656: bitstring));
                                                {8396}let m1_7657: bitstring = dec(em1_7655,skSess_7145) in
                                                {8397}if (verify(h(m1_7657),sigM1_7656,pkCli_7590) <> true) then
                                                    0
                                                else
                                                    {8398}let (=OpenSecureChannelRequest,=pkCli_7590,wNc_7658: bitstring) = m1_7657 in
                                                    {8399}let Nc_7659: bitstring = dec(wNc_7658,skSess_7145) in
                                                    {8400}new Ns_7660: bitstring;
                                                    {8401}new ST_7661: bitstring;
                                                    {8402}new TTL_7662: bitstring;
                                                    {8403}let wNs_7663: bitstring = enc(Ns_7660,pkCli_7590) in
                                                    {8404}let m2_7664: bitstring = (OpenSecureChannelResponse,wNs_7663,ST_7661,TTL_7662) in
                                                    {8405}out(c, (enc(m2_7664,pkCli_7590),sign(h(m2_7664),skSess_7145)));
                                                    {8406}let Ksrv_7665: bitstring = h((Ns_7660,Nc_7659)) in
                                                    {8407}out(c, senc(mSrv(pkCli_7590,pkSess_7146),Ksrv_7665))
                                    )
                                    else
                                        {8408}let pkDisco_7666: bitstring = fail-any in
                                        {8409}in(c, (=pkCli_7590,em1_7667: bitstring,sigM1_7668: bitstring));
                                        {8410}let m1_7669: bitstring = dec(em1_7667,skSess_7145) in
                                        {8411}if (verify(h(m1_7669),sigM1_7668,pkCli_7590) <> true) then
                                            0
                                        else
                                            {8412}let (=OpenSecureChannelRequest,=pkCli_7590,wNc_7670: bitstring) = m1_7669 in
                                            {8413}let Nc_7671: bitstring = dec(wNc_7670,skSess_7145) in
                                            {8414}new Ns_7672: bitstring;
                                            {8415}new ST_7673: bitstring;
                                            {8416}new TTL_7674: bitstring;
                                            {8417}let wNs_7675: bitstring = enc(Ns_7672,pkCli_7590) in
                                            {8418}let m2_7676: bitstring = (OpenSecureChannelResponse,wNs_7675,ST_7673,TTL_7674) in
                                            {8419}out(c, (enc(m2_7676,pkCli_7590),sign(h(m2_7676),skSess_7145)));
                                            {8420}let Ksrv_7677: bitstring = h((Ns_7672,Nc_7671)) in
                                            {8421}out(c, senc(mSrv(pkCli_7590,pkSess_7146),Ksrv_7677))
                        )
                        else
                            {8422}let pkCli_7678: bitstring = fail-any in
                            {8423}let v_7679: bool = (Disco_5903 = A) in
                            (
                                {8424}if v_7679 then
                                (
                                    {8425}let pkDisco_7680: bitstring = pub(skA) in
                                    {8426}in(c, (=pkCli_7678,em1_7681: bitstring,sigM1_7682: bitstring));
                                    {8427}let m1_7683: bitstring = dec(em1_7681,skSess_7145) in
                                    {8428}if (verify(h(m1_7683),sigM1_7682,pkCli_7678) <> true) then
                                        0
                                    else
                                        {8429}let (=OpenSecureChannelRequest,=pkCli_7678,wNc_7684: bitstring) = m1_7683 in
                                        {8430}let Nc_7685: bitstring = dec(wNc_7684,skSess_7145) in
                                        {8431}new Ns_7686: bitstring;
                                        {8432}new ST_7687: bitstring;
                                        {8433}new TTL_7688: bitstring;
                                        {8434}let wNs_7689: bitstring = enc(Ns_7686,pkCli_7678) in
                                        {8435}let m2_7690: bitstring = (OpenSecureChannelResponse,wNs_7689,ST_7687,TTL_7688) in
                                        {8436}out(c, (enc(m2_7690,pkCli_7678),sign(h(m2_7690),skSess_7145)));
                                        {8437}let Ksrv_7691: bitstring = h((Ns_7686,Nc_7685)) in
                                        {8438}out(c, senc(mSrv(pkCli_7678,pkSess_7146),Ksrv_7691))
                                )
                                else
                                    {8439}let v_7692: bool = (Disco_5903 = B) in
                                    (
                                        {8440}if v_7692 then
                                        (
                                            {8441}let pkDisco_7693: bitstring = pub(skB) in
                                            {8442}in(c, (=pkCli_7678,em1_7694: bitstring,sigM1_7695: bitstring));
                                            {8443}let m1_7696: bitstring = dec(em1_7694,skSess_7145) in
                                            {8444}if (verify(h(m1_7696),sigM1_7695,pkCli_7678) <> true) then
                                                0
                                            else
                                                {8445}let (=OpenSecureChannelRequest,=pkCli_7678,wNc_7697: bitstring) = m1_7696 in
                                                {8446}let Nc_7698: bitstring = dec(wNc_7697,skSess_7145) in
                                                {8447}new Ns_7699: bitstring;
                                                {8448}new ST_7700: bitstring;
                                                {8449}new TTL_7701: bitstring;
                                                {8450}let wNs_7702: bitstring = enc(Ns_7699,pkCli_7678) in
                                                {8451}let m2_7703: bitstring = (OpenSecureChannelResponse,wNs_7702,ST_7700,TTL_7701) in
                                                {8452}out(c, (enc(m2_7703,pkCli_7678),sign(h(m2_7703),skSess_7145)));
                                                {8453}let Ksrv_7704: bitstring = h((Ns_7699,Nc_7698)) in
                                                {8454}out(c, senc(mSrv(pkCli_7678,pkSess_7146),Ksrv_7704))
                                        )
                                        else
                                            {8455}let v_7705: bool = (Disco_5903 = C) in
                                            (
                                                {8456}if v_7705 then
                                                (
                                                    {8457}let pkDisco_7706: bitstring = pub(skC) in
                                                    {8458}in(c, (=pkCli_7678,em1_7707: bitstring,sigM1_7708: bitstring));
                                                    {8459}let m1_7709: bitstring = dec(em1_7707,skSess_7145) in
                                                    {8460}if (verify(h(m1_7709),sigM1_7708,pkCli_7678) <> true) then
                                                        0
                                                    else
                                                        {8461}let (=OpenSecureChannelRequest,=pkCli_7678,wNc_7710: bitstring) = m1_7709 in
                                                        {8462}let Nc_7711: bitstring = dec(wNc_7710,skSess_7145) in
                                                        {8463}new Ns_7712: bitstring;
                                                        {8464}new ST_7713: bitstring;
                                                        {8465}new TTL_7714: bitstring;
                                                        {8466}let wNs_7715: bitstring = enc(Ns_7712,pkCli_7678) in
                                                        {8467}let m2_7716: bitstring = (OpenSecureChannelResponse,wNs_7715,ST_7713,TTL_7714) in
                                                        {8468}out(c, (enc(m2_7716,pkCli_7678),sign(h(m2_7716),skSess_7145)));
                                                        {8469}let Ksrv_7717: bitstring = h((Ns_7712,Nc_7711)) in
                                                        {8470}out(c, senc(mSrv(pkCli_7678,pkSess_7146),Ksrv_7717))
                                                )
                                                else
                                                    {8471}let pkDisco_7718: bitstring = pub(sk(Disco_5903)) in
                                                    {8472}in(c, (=pkCli_7678,em1_7719: bitstring,sigM1_7720: bitstring));
                                                    {8473}let m1_7721: bitstring = dec(em1_7719,skSess_7145) in
                                                    {8474}if (verify(h(m1_7721),sigM1_7720,pkCli_7678) <> true) then
                                                        0
                                                    else
                                                        {8475}let (=OpenSecureChannelRequest,=pkCli_7678,wNc_7722: bitstring) = m1_7721 in
                                                        {8476}let Nc_7723: bitstring = dec(wNc_7722,skSess_7145) in
                                                        {8477}new Ns_7724: bitstring;
                                                        {8478}new ST_7725: bitstring;
                                                        {8479}new TTL_7726: bitstring;
                                                        {8480}let wNs_7727: bitstring = enc(Ns_7724,pkCli_7678) in
                                                        {8481}let m2_7728: bitstring = (OpenSecureChannelResponse,wNs_7727,ST_7725,TTL_7726) in
                                                        {8482}out(c, (enc(m2_7728,pkCli_7678),sign(h(m2_7728),skSess_7145)));
                                                        {8483}let Ksrv_7729: bitstring = h((Ns_7724,Nc_7723)) in
                                                        {8484}out(c, senc(mSrv(pkCli_7678,pkSess_7146),Ksrv_7729))
                                            )
                                            else
                                                {8485}let pkDisco_7730: bitstring = fail-any in
                                                {8486}in(c, (=pkCli_7678,em1_7731: bitstring,sigM1_7732: bitstring));
                                                {8487}let m1_7733: bitstring = dec(em1_7731,skSess_7145) in
                                                {8488}if (verify(h(m1_7733),sigM1_7732,pkCli_7678) <> true) then
                                                    0
                                                else
                                                    {8489}let (=OpenSecureChannelRequest,=pkCli_7678,wNc_7734: bitstring) = m1_7733 in
                                                    {8490}let Nc_7735: bitstring = dec(wNc_7734,skSess_7145) in
                                                    {8491}new Ns_7736: bitstring;
                                                    {8492}new ST_7737: bitstring;
                                                    {8493}new TTL_7738: bitstring;
                                                    {8494}let wNs_7739: bitstring = enc(Ns_7736,pkCli_7678) in
                                                    {8495}let m2_7740: bitstring = (OpenSecureChannelResponse,wNs_7739,ST_7737,TTL_7738) in
                                                    {8496}out(c, (enc(m2_7740,pkCli_7678),sign(h(m2_7740),skSess_7145)));
                                                    {8497}let Ksrv_7741: bitstring = h((Ns_7736,Nc_7735)) in
                                                    {8498}out(c, senc(mSrv(pkCli_7678,pkSess_7146),Ksrv_7741))
                                    )
                                    else
                                        {8499}let pkDisco_7742: bitstring = fail-any in
                                        {8500}in(c, (=pkCli_7678,em1_7743: bitstring,sigM1_7744: bitstring));
                                        {8501}let m1_7745: bitstring = dec(em1_7743,skSess_7145) in
                                        {8502}if (verify(h(m1_7745),sigM1_7744,pkCli_7678) <> true) then
                                            0
                                        else
                                            {8503}let (=OpenSecureChannelRequest,=pkCli_7678,wNc_7746: bitstring) = m1_7745 in
                                            {8504}let Nc_7747: bitstring = dec(wNc_7746,skSess_7145) in
                                            {8505}new Ns_7748: bitstring;
                                            {8506}new ST_7749: bitstring;
                                            {8507}new TTL_7750: bitstring;
                                            {8508}let wNs_7751: bitstring = enc(Ns_7748,pkCli_7678) in
                                            {8509}let m2_7752: bitstring = (OpenSecureChannelResponse,wNs_7751,ST_7749,TTL_7750) in
                                            {8510}out(c, (enc(m2_7752,pkCli_7678),sign(h(m2_7752),skSess_7145)));
                                            {8511}let Ksrv_7753: bitstring = h((Ns_7748,Nc_7747)) in
                                            {8512}out(c, senc(mSrv(pkCli_7678,pkSess_7146),Ksrv_7753))
                            )
                            else
                                {8513}let pkDisco_7754: bitstring = fail-any in
                                {8514}in(c, (=pkCli_7678,em1_7755: bitstring,sigM1_7756: bitstring));
                                {8515}let m1_7757: bitstring = dec(em1_7755,skSess_7145) in
                                {8516}if (verify(h(m1_7757),sigM1_7756,pkCli_7678) <> true) then
                                    0
                                else
                                    {8517}let (=OpenSecureChannelRequest,=pkCli_7678,wNc_7758: bitstring) = m1_7757 in
                                    {8518}let Nc_7759: bitstring = dec(wNc_7758,skSess_7145) in
                                    {8519}new Ns_7760: bitstring;
                                    {8520}new ST_7761: bitstring;
                                    {8521}new TTL_7762: bitstring;
                                    {8522}let wNs_7763: bitstring = enc(Ns_7760,pkCli_7678) in
                                    {8523}let m2_7764: bitstring = (OpenSecureChannelResponse,wNs_7763,ST_7761,TTL_7762) in
                                    {8524}out(c, (enc(m2_7764,pkCli_7678),sign(h(m2_7764),skSess_7145)));
                                    {8525}let Ksrv_7765: bitstring = h((Ns_7760,Nc_7759)) in
                                    {8526}out(c, senc(mSrv(pkCli_7678,pkSess_7146),Ksrv_7765))
                    )
                    else
                        {8527}let skSess_7766: bitstring = fail-any in
                        {8528}let pkSess_7767: bitstring = pub(skSess_7766) in
                        {8529}let v_7768: bool = (Cli_5902 = A) in
                        (
                            {8530}if v_7768 then
                            (
                                {8531}let pkCli_7769: bitstring = pub(skA) in
                                {8532}let v_7770: bool = (Disco_5903 = A) in
                                (
                                    {8533}if v_7770 then
                                    (
                                        {8534}let pkDisco_7771: bitstring = pub(skA) in
                                        {8535}in(c, (=pkCli_7769,em1_7772: bitstring,sigM1_7773: bitstring));
                                        {8536}let m1_7774: bitstring = dec(em1_7772,skSess_7766) in
                                        {8537}if (verify(h(m1_7774),sigM1_7773,pkCli_7769) <> true) then
                                            0
                                        else
                                            {8538}let (=OpenSecureChannelRequest,=pkCli_7769,wNc_7775: bitstring) = m1_7774 in
                                            {8539}let Nc_7776: bitstring = dec(wNc_7775,skSess_7766) in
                                            {8540}new Ns_7777: bitstring;
                                            {8541}new ST_7778: bitstring;
                                            {8542}new TTL_7779: bitstring;
                                            {8543}let wNs_7780: bitstring = enc(Ns_7777,pkCli_7769) in
                                            {8544}let m2_7781: bitstring = (OpenSecureChannelResponse,wNs_7780,ST_7778,TTL_7779) in
                                            {8545}out(c, (enc(m2_7781,pkCli_7769),sign(h(m2_7781),skSess_7766)));
                                            {8546}let Ksrv_7782: bitstring = h((Ns_7777,Nc_7776)) in
                                            {8547}out(c, senc(mSrv(pkCli_7769,pkSess_7767),Ksrv_7782))
                                    )
                                    else
                                        {8548}let v_7783: bool = (Disco_5903 = B) in
                                        (
                                            {8549}if v_7783 then
                                            (
                                                {8550}let pkDisco_7784: bitstring = pub(skB) in
                                                {8551}in(c, (=pkCli_7769,em1_7785: bitstring,sigM1_7786: bitstring));
                                                {8552}let m1_7787: bitstring = dec(em1_7785,skSess_7766) in
                                                {8553}if (verify(h(m1_7787),sigM1_7786,pkCli_7769) <> true) then
                                                    0
                                                else
                                                    {8554}let (=OpenSecureChannelRequest,=pkCli_7769,wNc_7788: bitstring) = m1_7787 in
                                                    {8555}let Nc_7789: bitstring = dec(wNc_7788,skSess_7766) in
                                                    {8556}new Ns_7790: bitstring;
                                                    {8557}new ST_7791: bitstring;
                                                    {8558}new TTL_7792: bitstring;
                                                    {8559}let wNs_7793: bitstring = enc(Ns_7790,pkCli_7769) in
                                                    {8560}let m2_7794: bitstring = (OpenSecureChannelResponse,wNs_7793,ST_7791,TTL_7792) in
                                                    {8561}out(c, (enc(m2_7794,pkCli_7769),sign(h(m2_7794),skSess_7766)));
                                                    {8562}let Ksrv_7795: bitstring = h((Ns_7790,Nc_7789)) in
                                                    {8563}out(c, senc(mSrv(pkCli_7769,pkSess_7767),Ksrv_7795))
                                            )
                                            else
                                                {8564}let v_7796: bool = (Disco_5903 = C) in
                                                (
                                                    {8565}if v_7796 then
                                                    (
                                                        {8566}let pkDisco_7797: bitstring = pub(skC) in
                                                        {8567}in(c, (=pkCli_7769,em1_7798: bitstring,sigM1_7799: bitstring));
                                                        {8568}let m1_7800: bitstring = dec(em1_7798,skSess_7766) in
                                                        {8569}if (verify(h(m1_7800),sigM1_7799,pkCli_7769) <> true) then
                                                            0
                                                        else
                                                            {8570}let (=OpenSecureChannelRequest,=pkCli_7769,wNc_7801: bitstring) = m1_7800 in
                                                            {8571}let Nc_7802: bitstring = dec(wNc_7801,skSess_7766) in
                                                            {8572}new Ns_7803: bitstring;
                                                            {8573}new ST_7804: bitstring;
                                                            {8574}new TTL_7805: bitstring;
                                                            {8575}let wNs_7806: bitstring = enc(Ns_7803,pkCli_7769) in
                                                            {8576}let m2_7807: bitstring = (OpenSecureChannelResponse,wNs_7806,ST_7804,TTL_7805) in
                                                            {8577}out(c, (enc(m2_7807,pkCli_7769),sign(h(m2_7807),skSess_7766)));
                                                            {8578}let Ksrv_7808: bitstring = h((Ns_7803,Nc_7802)) in
                                                            {8579}out(c, senc(mSrv(pkCli_7769,pkSess_7767),Ksrv_7808))
                                                    )
                                                    else
                                                        {8580}let pkDisco_7809: bitstring = pub(sk(Disco_5903)) in
                                                        {8581}in(c, (=pkCli_7769,em1_7810: bitstring,sigM1_7811: bitstring));
                                                        {8582}let m1_7812: bitstring = dec(em1_7810,skSess_7766) in
                                                        {8583}if (verify(h(m1_7812),sigM1_7811,pkCli_7769) <> true) then
                                                            0
                                                        else
                                                            {8584}let (=OpenSecureChannelRequest,=pkCli_7769,wNc_7813: bitstring) = m1_7812 in
                                                            {8585}let Nc_7814: bitstring = dec(wNc_7813,skSess_7766) in
                                                            {8586}new Ns_7815: bitstring;
                                                            {8587}new ST_7816: bitstring;
                                                            {8588}new TTL_7817: bitstring;
                                                            {8589}let wNs_7818: bitstring = enc(Ns_7815,pkCli_7769) in
                                                            {8590}let m2_7819: bitstring = (OpenSecureChannelResponse,wNs_7818,ST_7816,TTL_7817) in
                                                            {8591}out(c, (enc(m2_7819,pkCli_7769),sign(h(m2_7819),skSess_7766)));
                                                            {8592}let Ksrv_7820: bitstring = h((Ns_7815,Nc_7814)) in
                                                            {8593}out(c, senc(mSrv(pkCli_7769,pkSess_7767),Ksrv_7820))
                                                )
                                                else
                                                    {8594}let pkDisco_7821: bitstring = fail-any in
                                                    {8595}in(c, (=pkCli_7769,em1_7822: bitstring,sigM1_7823: bitstring));
                                                    {8596}let m1_7824: bitstring = dec(em1_7822,skSess_7766) in
                                                    {8597}if (verify(h(m1_7824),sigM1_7823,pkCli_7769) <> true) then
                                                        0
                                                    else
                                                        {8598}let (=OpenSecureChannelRequest,=pkCli_7769,wNc_7825: bitstring) = m1_7824 in
                                                        {8599}let Nc_7826: bitstring = dec(wNc_7825,skSess_7766) in
                                                        {8600}new Ns_7827: bitstring;
                                                        {8601}new ST_7828: bitstring;
                                                        {8602}new TTL_7829: bitstring;
                                                        {8603}let wNs_7830: bitstring = enc(Ns_7827,pkCli_7769) in
                                                        {8604}let m2_7831: bitstring = (OpenSecureChannelResponse,wNs_7830,ST_7828,TTL_7829) in
                                                        {8605}out(c, (enc(m2_7831,pkCli_7769),sign(h(m2_7831),skSess_7766)));
                                                        {8606}let Ksrv_7832: bitstring = h((Ns_7827,Nc_7826)) in
                                                        {8607}out(c, senc(mSrv(pkCli_7769,pkSess_7767),Ksrv_7832))
                                        )
                                        else
                                            {8608}let pkDisco_7833: bitstring = fail-any in
                                            {8609}in(c, (=pkCli_7769,em1_7834: bitstring,sigM1_7835: bitstring));
                                            {8610}let m1_7836: bitstring = dec(em1_7834,skSess_7766) in
                                            {8611}if (verify(h(m1_7836),sigM1_7835,pkCli_7769) <> true) then
                                                0
                                            else
                                                {8612}let (=OpenSecureChannelRequest,=pkCli_7769,wNc_7837: bitstring) = m1_7836 in
                                                {8613}let Nc_7838: bitstring = dec(wNc_7837,skSess_7766) in
                                                {8614}new Ns_7839: bitstring;
                                                {8615}new ST_7840: bitstring;
                                                {8616}new TTL_7841: bitstring;
                                                {8617}let wNs_7842: bitstring = enc(Ns_7839,pkCli_7769) in
                                                {8618}let m2_7843: bitstring = (OpenSecureChannelResponse,wNs_7842,ST_7840,TTL_7841) in
                                                {8619}out(c, (enc(m2_7843,pkCli_7769),sign(h(m2_7843),skSess_7766)));
                                                {8620}let Ksrv_7844: bitstring = h((Ns_7839,Nc_7838)) in
                                                {8621}out(c, senc(mSrv(pkCli_7769,pkSess_7767),Ksrv_7844))
                                )
                                else
                                    {8622}let pkDisco_7845: bitstring = fail-any in
                                    {8623}in(c, (=pkCli_7769,em1_7846: bitstring,sigM1_7847: bitstring));
                                    {8624}let m1_7848: bitstring = dec(em1_7846,skSess_7766) in
                                    {8625}if (verify(h(m1_7848),sigM1_7847,pkCli_7769) <> true) then
                                        0
                                    else
                                        {8626}let (=OpenSecureChannelRequest,=pkCli_7769,wNc_7849: bitstring) = m1_7848 in
                                        {8627}let Nc_7850: bitstring = dec(wNc_7849,skSess_7766) in
                                        {8628}new Ns_7851: bitstring;
                                        {8629}new ST_7852: bitstring;
                                        {8630}new TTL_7853: bitstring;
                                        {8631}let wNs_7854: bitstring = enc(Ns_7851,pkCli_7769) in
                                        {8632}let m2_7855: bitstring = (OpenSecureChannelResponse,wNs_7854,ST_7852,TTL_7853) in
                                        {8633}out(c, (enc(m2_7855,pkCli_7769),sign(h(m2_7855),skSess_7766)));
                                        {8634}let Ksrv_7856: bitstring = h((Ns_7851,Nc_7850)) in
                                        {8635}out(c, senc(mSrv(pkCli_7769,pkSess_7767),Ksrv_7856))
                            )
                            else
                                {8636}let v_7857: bool = (Cli_5902 = B) in
                                (
                                    {8637}if v_7857 then
                                    (
                                        {8638}let pkCli_7858: bitstring = pub(skB) in
                                        {8639}let v_7859: bool = (Disco_5903 = A) in
                                        (
                                            {8640}if v_7859 then
                                            (
                                                {8641}let pkDisco_7860: bitstring = pub(skA) in
                                                {8642}in(c, (=pkCli_7858,em1_7861: bitstring,sigM1_7862: bitstring));
                                                {8643}let m1_7863: bitstring = dec(em1_7861,skSess_7766) in
                                                {8644}if (verify(h(m1_7863),sigM1_7862,pkCli_7858) <> true) then
                                                    0
                                                else
                                                    {8645}let (=OpenSecureChannelRequest,=pkCli_7858,wNc_7864: bitstring) = m1_7863 in
                                                    {8646}let Nc_7865: bitstring = dec(wNc_7864,skSess_7766) in
                                                    {8647}new Ns_7866: bitstring;
                                                    {8648}new ST_7867: bitstring;
                                                    {8649}new TTL_7868: bitstring;
                                                    {8650}let wNs_7869: bitstring = enc(Ns_7866,pkCli_7858) in
                                                    {8651}let m2_7870: bitstring = (OpenSecureChannelResponse,wNs_7869,ST_7867,TTL_7868) in
                                                    {8652}out(c, (enc(m2_7870,pkCli_7858),sign(h(m2_7870),skSess_7766)));
                                                    {8653}let Ksrv_7871: bitstring = h((Ns_7866,Nc_7865)) in
                                                    {8654}out(c, senc(mSrv(pkCli_7858,pkSess_7767),Ksrv_7871))
                                            )
                                            else
                                                {8655}let v_7872: bool = (Disco_5903 = B) in
                                                (
                                                    {8656}if v_7872 then
                                                    (
                                                        {8657}let pkDisco_7873: bitstring = pub(skB) in
                                                        {8658}in(c, (=pkCli_7858,em1_7874: bitstring,sigM1_7875: bitstring));
                                                        {8659}let m1_7876: bitstring = dec(em1_7874,skSess_7766) in
                                                        {8660}if (verify(h(m1_7876),sigM1_7875,pkCli_7858) <> true) then
                                                            0
                                                        else
                                                            {8661}let (=OpenSecureChannelRequest,=pkCli_7858,wNc_7877: bitstring) = m1_7876 in
                                                            {8662}let Nc_7878: bitstring = dec(wNc_7877,skSess_7766) in
                                                            {8663}new Ns_7879: bitstring;
                                                            {8664}new ST_7880: bitstring;
                                                            {8665}new TTL_7881: bitstring;
                                                            {8666}let wNs_7882: bitstring = enc(Ns_7879,pkCli_7858) in
                                                            {8667}let m2_7883: bitstring = (OpenSecureChannelResponse,wNs_7882,ST_7880,TTL_7881) in
                                                            {8668}out(c, (enc(m2_7883,pkCli_7858),sign(h(m2_7883),skSess_7766)));
                                                            {8669}let Ksrv_7884: bitstring = h((Ns_7879,Nc_7878)) in
                                                            {8670}out(c, senc(mSrv(pkCli_7858,pkSess_7767),Ksrv_7884))
                                                    )
                                                    else
                                                        {8671}let v_7885: bool = (Disco_5903 = C) in
                                                        (
                                                            {8672}if v_7885 then
                                                            (
                                                                {8673}let pkDisco_7886: bitstring = pub(skC) in
                                                                {8674}in(c, (=pkCli_7858,em1_7887: bitstring,sigM1_7888: bitstring));
                                                                {8675}let m1_7889: bitstring = dec(em1_7887,skSess_7766) in
                                                                {8676}if (verify(h(m1_7889),sigM1_7888,pkCli_7858) <> true) then
                                                                    0
                                                                else
                                                                    {8677}let (=OpenSecureChannelRequest,=pkCli_7858,wNc_7890: bitstring) = m1_7889 in
                                                                    {8678}let Nc_7891: bitstring = dec(wNc_7890,skSess_7766) in
                                                                    {8679}new Ns_7892: bitstring;
                                                                    {8680}new ST_7893: bitstring;
                                                                    {8681}new TTL_7894: bitstring;
                                                                    {8682}let wNs_7895: bitstring = enc(Ns_7892,pkCli_7858) in
                                                                    {8683}let m2_7896: bitstring = (OpenSecureChannelResponse,wNs_7895,ST_7893,TTL_7894) in
                                                                    {8684}out(c, (enc(m2_7896,pkCli_7858),sign(h(m2_7896),skSess_7766)));
                                                                    {8685}let Ksrv_7897: bitstring = h((Ns_7892,Nc_7891)) in
                                                                    {8686}out(c, senc(mSrv(pkCli_7858,pkSess_7767),Ksrv_7897))
                                                            )
                                                            else
                                                                {8687}let pkDisco_7898: bitstring = pub(sk(Disco_5903)) in
                                                                {8688}in(c, (=pkCli_7858,em1_7899: bitstring,sigM1_7900: bitstring));
                                                                {8689}let m1_7901: bitstring = dec(em1_7899,skSess_7766) in
                                                                {8690}if (verify(h(m1_7901),sigM1_7900,pkCli_7858) <> true) then
                                                                    0
                                                                else
                                                                    {8691}let (=OpenSecureChannelRequest,=pkCli_7858,wNc_7902: bitstring) = m1_7901 in
                                                                    {8692}let Nc_7903: bitstring = dec(wNc_7902,skSess_7766) in
                                                                    {8693}new Ns_7904: bitstring;
                                                                    {8694}new ST_7905: bitstring;
                                                                    {8695}new TTL_7906: bitstring;
                                                                    {8696}let wNs_7907: bitstring = enc(Ns_7904,pkCli_7858) in
                                                                    {8697}let m2_7908: bitstring = (OpenSecureChannelResponse,wNs_7907,ST_7905,TTL_7906) in
                                                                    {8698}out(c, (enc(m2_7908,pkCli_7858),sign(h(m2_7908),skSess_7766)));
                                                                    {8699}let Ksrv_7909: bitstring = h((Ns_7904,Nc_7903)) in
                                                                    {8700}out(c, senc(mSrv(pkCli_7858,pkSess_7767),Ksrv_7909))
                                                        )
                                                        else
                                                            {8701}let pkDisco_7910: bitstring = fail-any in
                                                            {8702}in(c, (=pkCli_7858,em1_7911: bitstring,sigM1_7912: bitstring));
                                                            {8703}let m1_7913: bitstring = dec(em1_7911,skSess_7766) in
                                                            {8704}if (verify(h(m1_7913),sigM1_7912,pkCli_7858) <> true) then
                                                                0
                                                            else
                                                                {8705}let (=OpenSecureChannelRequest,=pkCli_7858,wNc_7914: bitstring) = m1_7913 in
                                                                {8706}let Nc_7915: bitstring = dec(wNc_7914,skSess_7766) in
                                                                {8707}new Ns_7916: bitstring;
                                                                {8708}new ST_7917: bitstring;
                                                                {8709}new TTL_7918: bitstring;
                                                                {8710}let wNs_7919: bitstring = enc(Ns_7916,pkCli_7858) in
                                                                {8711}let m2_7920: bitstring = (OpenSecureChannelResponse,wNs_7919,ST_7917,TTL_7918) in
                                                                {8712}out(c, (enc(m2_7920,pkCli_7858),sign(h(m2_7920),skSess_7766)));
                                                                {8713}let Ksrv_7921: bitstring = h((Ns_7916,Nc_7915)) in
                                                                {8714}out(c, senc(mSrv(pkCli_7858,pkSess_7767),Ksrv_7921))
                                                )
                                                else
                                                    {8715}let pkDisco_7922: bitstring = fail-any in
                                                    {8716}in(c, (=pkCli_7858,em1_7923: bitstring,sigM1_7924: bitstring));
                                                    {8717}let m1_7925: bitstring = dec(em1_7923,skSess_7766) in
                                                    {8718}if (verify(h(m1_7925),sigM1_7924,pkCli_7858) <> true) then
                                                        0
                                                    else
                                                        {8719}let (=OpenSecureChannelRequest,=pkCli_7858,wNc_7926: bitstring) = m1_7925 in
                                                        {8720}let Nc_7927: bitstring = dec(wNc_7926,skSess_7766) in
                                                        {8721}new Ns_7928: bitstring;
                                                        {8722}new ST_7929: bitstring;
                                                        {8723}new TTL_7930: bitstring;
                                                        {8724}let wNs_7931: bitstring = enc(Ns_7928,pkCli_7858) in
                                                        {8725}let m2_7932: bitstring = (OpenSecureChannelResponse,wNs_7931,ST_7929,TTL_7930) in
                                                        {8726}out(c, (enc(m2_7932,pkCli_7858),sign(h(m2_7932),skSess_7766)));
                                                        {8727}let Ksrv_7933: bitstring = h((Ns_7928,Nc_7927)) in
                                                        {8728}out(c, senc(mSrv(pkCli_7858,pkSess_7767),Ksrv_7933))
                                        )
                                        else
                                            {8729}let pkDisco_7934: bitstring = fail-any in
                                            {8730}in(c, (=pkCli_7858,em1_7935: bitstring,sigM1_7936: bitstring));
                                            {8731}let m1_7937: bitstring = dec(em1_7935,skSess_7766) in
                                            {8732}if (verify(h(m1_7937),sigM1_7936,pkCli_7858) <> true) then
                                                0
                                            else
                                                {8733}let (=OpenSecureChannelRequest,=pkCli_7858,wNc_7938: bitstring) = m1_7937 in
                                                {8734}let Nc_7939: bitstring = dec(wNc_7938,skSess_7766) in
                                                {8735}new Ns_7940: bitstring;
                                                {8736}new ST_7941: bitstring;
                                                {8737}new TTL_7942: bitstring;
                                                {8738}let wNs_7943: bitstring = enc(Ns_7940,pkCli_7858) in
                                                {8739}let m2_7944: bitstring = (OpenSecureChannelResponse,wNs_7943,ST_7941,TTL_7942) in
                                                {8740}out(c, (enc(m2_7944,pkCli_7858),sign(h(m2_7944),skSess_7766)));
                                                {8741}let Ksrv_7945: bitstring = h((Ns_7940,Nc_7939)) in
                                                {8742}out(c, senc(mSrv(pkCli_7858,pkSess_7767),Ksrv_7945))
                                    )
                                    else
                                        {8743}let v_7946: bool = (Cli_5902 = C) in
                                        (
                                            {8744}if v_7946 then
                                            (
                                                {8745}let pkCli_7947: bitstring = pub(skC) in
                                                {8746}let v_7948: bool = (Disco_5903 = A) in
                                                (
                                                    {8747}if v_7948 then
                                                    (
                                                        {8748}let pkDisco_7949: bitstring = pub(skA) in
                                                        {8749}in(c, (=pkCli_7947,em1_7950: bitstring,sigM1_7951: bitstring));
                                                        {8750}let m1_7952: bitstring = dec(em1_7950,skSess_7766) in
                                                        {8751}if (verify(h(m1_7952),sigM1_7951,pkCli_7947) <> true) then
                                                            0
                                                        else
                                                            {8752}let (=OpenSecureChannelRequest,=pkCli_7947,wNc_7953: bitstring) = m1_7952 in
                                                            {8753}let Nc_7954: bitstring = dec(wNc_7953,skSess_7766) in
                                                            {8754}new Ns_7955: bitstring;
                                                            {8755}new ST_7956: bitstring;
                                                            {8756}new TTL_7957: bitstring;
                                                            {8757}let wNs_7958: bitstring = enc(Ns_7955,pkCli_7947) in
                                                            {8758}let m2_7959: bitstring = (OpenSecureChannelResponse,wNs_7958,ST_7956,TTL_7957) in
                                                            {8759}out(c, (enc(m2_7959,pkCli_7947),sign(h(m2_7959),skSess_7766)));
                                                            {8760}let Ksrv_7960: bitstring = h((Ns_7955,Nc_7954)) in
                                                            {8761}out(c, senc(mSrv(pkCli_7947,pkSess_7767),Ksrv_7960))
                                                    )
                                                    else
                                                        {8762}let v_7961: bool = (Disco_5903 = B) in
                                                        (
                                                            {8763}if v_7961 then
                                                            (
                                                                {8764}let pkDisco_7962: bitstring = pub(skB) in
                                                                {8765}in(c, (=pkCli_7947,em1_7963: bitstring,sigM1_7964: bitstring));
                                                                {8766}let m1_7965: bitstring = dec(em1_7963,skSess_7766) in
                                                                {8767}if (verify(h(m1_7965),sigM1_7964,pkCli_7947) <> true) then
                                                                    0
                                                                else
                                                                    {8768}let (=OpenSecureChannelRequest,=pkCli_7947,wNc_7966: bitstring) = m1_7965 in
                                                                    {8769}let Nc_7967: bitstring = dec(wNc_7966,skSess_7766) in
                                                                    {8770}new Ns_7968: bitstring;
                                                                    {8771}new ST_7969: bitstring;
                                                                    {8772}new TTL_7970: bitstring;
                                                                    {8773}let wNs_7971: bitstring = enc(Ns_7968,pkCli_7947) in
                                                                    {8774}let m2_7972: bitstring = (OpenSecureChannelResponse,wNs_7971,ST_7969,TTL_7970) in
                                                                    {8775}out(c, (enc(m2_7972,pkCli_7947),sign(h(m2_7972),skSess_7766)));
                                                                    {8776}let Ksrv_7973: bitstring = h((Ns_7968,Nc_7967)) in
                                                                    {8777}out(c, senc(mSrv(pkCli_7947,pkSess_7767),Ksrv_7973))
                                                            )
                                                            else
                                                                {8778}let v_7974: bool = (Disco_5903 = C) in
                                                                (
                                                                    {8779}if v_7974 then
                                                                    (
                                                                        {8780}let pkDisco_7975: bitstring = pub(skC) in
                                                                        {8781}in(c, (=pkCli_7947,em1_7976: bitstring,sigM1_7977: bitstring));
                                                                        {8782}let m1_7978: bitstring = dec(em1_7976,skSess_7766) in
                                                                        {8783}if (verify(h(m1_7978),sigM1_7977,pkCli_7947) <> true) then
                                                                            0
                                                                        else
                                                                            {8784}let (=OpenSecureChannelRequest,=pkCli_7947,wNc_7979: bitstring) = m1_7978 in
                                                                            {8785}let Nc_7980: bitstring = dec(wNc_7979,skSess_7766) in
                                                                            {8786}new Ns_7981: bitstring;
                                                                            {8787}new ST_7982: bitstring;
                                                                            {8788}new TTL_7983: bitstring;
                                                                            {8789}let wNs_7984: bitstring = enc(Ns_7981,pkCli_7947) in
                                                                            {8790}let m2_7985: bitstring = (OpenSecureChannelResponse,wNs_7984,ST_7982,TTL_7983) in
                                                                            {8791}out(c, (enc(m2_7985,pkCli_7947),sign(h(m2_7985),skSess_7766)));
                                                                            {8792}let Ksrv_7986: bitstring = h((Ns_7981,Nc_7980)) in
                                                                            {8793}out(c, senc(mSrv(pkCli_7947,pkSess_7767),Ksrv_7986))
                                                                    )
                                                                    else
                                                                        {8794}let pkDisco_7987: bitstring = pub(sk(Disco_5903)) in
                                                                        {8795}in(c, (=pkCli_7947,em1_7988: bitstring,sigM1_7989: bitstring));
                                                                        {8796}let m1_7990: bitstring = dec(em1_7988,skSess_7766) in
                                                                        {8797}if (verify(h(m1_7990),sigM1_7989,pkCli_7947) <> true) then
                                                                            0
                                                                        else
                                                                            {8798}let (=OpenSecureChannelRequest,=pkCli_7947,wNc_7991: bitstring) = m1_7990 in
                                                                            {8799}let Nc_7992: bitstring = dec(wNc_7991,skSess_7766) in
                                                                            {8800}new Ns_7993: bitstring;
                                                                            {8801}new ST_7994: bitstring;
                                                                            {8802}new TTL_7995: bitstring;
                                                                            {8803}let wNs_7996: bitstring = enc(Ns_7993,pkCli_7947) in
                                                                            {8804}let m2_7997: bitstring = (OpenSecureChannelResponse,wNs_7996,ST_7994,TTL_7995) in
                                                                            {8805}out(c, (enc(m2_7997,pkCli_7947),sign(h(m2_7997),skSess_7766)));
                                                                            {8806}let Ksrv_7998: bitstring = h((Ns_7993,Nc_7992)) in
                                                                            {8807}out(c, senc(mSrv(pkCli_7947,pkSess_7767),Ksrv_7998))
                                                                )
                                                                else
                                                                    {8808}let pkDisco_7999: bitstring = fail-any in
                                                                    {8809}in(c, (=pkCli_7947,em1_8000: bitstring,sigM1_8001: bitstring));
                                                                    {8810}let m1_8002: bitstring = dec(em1_8000,skSess_7766) in
                                                                    {8811}if (verify(h(m1_8002),sigM1_8001,pkCli_7947) <> true) then
                                                                        0
                                                                    else
                                                                        {8812}let (=OpenSecureChannelRequest,=pkCli_7947,wNc_8003: bitstring) = m1_8002 in
                                                                        {8813}let Nc_8004: bitstring = dec(wNc_8003,skSess_7766) in
                                                                        {8814}new Ns_8005: bitstring;
                                                                        {8815}new ST_8006: bitstring;
                                                                        {8816}new TTL_8007: bitstring;
                                                                        {8817}let wNs_8008: bitstring = enc(Ns_8005,pkCli_7947) in
                                                                        {8818}let m2_8009: bitstring = (OpenSecureChannelResponse,wNs_8008,ST_8006,TTL_8007) in
                                                                        {8819}out(c, (enc(m2_8009,pkCli_7947),sign(h(m2_8009),skSess_7766)));
                                                                        {8820}let Ksrv_8010: bitstring = h((Ns_8005,Nc_8004)) in
                                                                        {8821}out(c, senc(mSrv(pkCli_7947,pkSess_7767),Ksrv_8010))
                                                        )
                                                        else
                                                            {8822}let pkDisco_8011: bitstring = fail-any in
                                                            {8823}in(c, (=pkCli_7947,em1_8012: bitstring,sigM1_8013: bitstring));
                                                            {8824}let m1_8014: bitstring = dec(em1_8012,skSess_7766) in
                                                            {8825}if (verify(h(m1_8014),sigM1_8013,pkCli_7947) <> true) then
                                                                0
                                                            else
                                                                {8826}let (=OpenSecureChannelRequest,=pkCli_7947,wNc_8015: bitstring) = m1_8014 in
                                                                {8827}let Nc_8016: bitstring = dec(wNc_8015,skSess_7766) in
                                                                {8828}new Ns_8017: bitstring;
                                                                {8829}new ST_8018: bitstring;
                                                                {8830}new TTL_8019: bitstring;
                                                                {8831}let wNs_8020: bitstring = enc(Ns_8017,pkCli_7947) in
                                                                {8832}let m2_8021: bitstring = (OpenSecureChannelResponse,wNs_8020,ST_8018,TTL_8019) in
                                                                {8833}out(c, (enc(m2_8021,pkCli_7947),sign(h(m2_8021),skSess_7766)));
                                                                {8834}let Ksrv_8022: bitstring = h((Ns_8017,Nc_8016)) in
                                                                {8835}out(c, senc(mSrv(pkCli_7947,pkSess_7767),Ksrv_8022))
                                                )
                                                else
                                                    {8836}let pkDisco_8023: bitstring = fail-any in
                                                    {8837}in(c, (=pkCli_7947,em1_8024: bitstring,sigM1_8025: bitstring));
                                                    {8838}let m1_8026: bitstring = dec(em1_8024,skSess_7766) in
                                                    {8839}if (verify(h(m1_8026),sigM1_8025,pkCli_7947) <> true) then
                                                        0
                                                    else
                                                        {8840}let (=OpenSecureChannelRequest,=pkCli_7947,wNc_8027: bitstring) = m1_8026 in
                                                        {8841}let Nc_8028: bitstring = dec(wNc_8027,skSess_7766) in
                                                        {8842}new Ns_8029: bitstring;
                                                        {8843}new ST_8030: bitstring;
                                                        {8844}new TTL_8031: bitstring;
                                                        {8845}let wNs_8032: bitstring = enc(Ns_8029,pkCli_7947) in
                                                        {8846}let m2_8033: bitstring = (OpenSecureChannelResponse,wNs_8032,ST_8030,TTL_8031) in
                                                        {8847}out(c, (enc(m2_8033,pkCli_7947),sign(h(m2_8033),skSess_7766)));
                                                        {8848}let Ksrv_8034: bitstring = h((Ns_8029,Nc_8028)) in
                                                        {8849}out(c, senc(mSrv(pkCli_7947,pkSess_7767),Ksrv_8034))
                                            )
                                            else
                                                {8850}let pkCli_8035: bitstring = pub(sk(Cli_5902)) in
                                                {8851}let v_8036: bool = (Disco_5903 = A) in
                                                (
                                                    {8852}if v_8036 then
                                                    (
                                                        {8853}let pkDisco_8037: bitstring = pub(skA) in
                                                        {8854}in(c, (=pkCli_8035,em1_8038: bitstring,sigM1_8039: bitstring));
                                                        {8855}let m1_8040: bitstring = dec(em1_8038,skSess_7766) in
                                                        {8856}if (verify(h(m1_8040),sigM1_8039,pkCli_8035) <> true) then
                                                            0
                                                        else
                                                            {8857}let (=OpenSecureChannelRequest,=pkCli_8035,wNc_8041: bitstring) = m1_8040 in
                                                            {8858}let Nc_8042: bitstring = dec(wNc_8041,skSess_7766) in
                                                            {8859}new Ns_8043: bitstring;
                                                            {8860}new ST_8044: bitstring;
                                                            {8861}new TTL_8045: bitstring;
                                                            {8862}let wNs_8046: bitstring = enc(Ns_8043,pkCli_8035) in
                                                            {8863}let m2_8047: bitstring = (OpenSecureChannelResponse,wNs_8046,ST_8044,TTL_8045) in
                                                            {8864}out(c, (enc(m2_8047,pkCli_8035),sign(h(m2_8047),skSess_7766)));
                                                            {8865}let Ksrv_8048: bitstring = h((Ns_8043,Nc_8042)) in
                                                            {8866}out(c, senc(mSrv(pkCli_8035,pkSess_7767),Ksrv_8048))
                                                    )
                                                    else
                                                        {8867}let v_8049: bool = (Disco_5903 = B) in
                                                        (
                                                            {8868}if v_8049 then
                                                            (
                                                                {8869}let pkDisco_8050: bitstring = pub(skB) in
                                                                {8870}in(c, (=pkCli_8035,em1_8051: bitstring,sigM1_8052: bitstring));
                                                                {8871}let m1_8053: bitstring = dec(em1_8051,skSess_7766) in
                                                                {8872}if (verify(h(m1_8053),sigM1_8052,pkCli_8035) <> true) then
                                                                    0
                                                                else
                                                                    {8873}let (=OpenSecureChannelRequest,=pkCli_8035,wNc_8054: bitstring) = m1_8053 in
                                                                    {8874}let Nc_8055: bitstring = dec(wNc_8054,skSess_7766) in
                                                                    {8875}new Ns_8056: bitstring;
                                                                    {8876}new ST_8057: bitstring;
                                                                    {8877}new TTL_8058: bitstring;
                                                                    {8878}let wNs_8059: bitstring = enc(Ns_8056,pkCli_8035) in
                                                                    {8879}let m2_8060: bitstring = (OpenSecureChannelResponse,wNs_8059,ST_8057,TTL_8058) in
                                                                    {8880}out(c, (enc(m2_8060,pkCli_8035),sign(h(m2_8060),skSess_7766)));
                                                                    {8881}let Ksrv_8061: bitstring = h((Ns_8056,Nc_8055)) in
                                                                    {8882}out(c, senc(mSrv(pkCli_8035,pkSess_7767),Ksrv_8061))
                                                            )
                                                            else
                                                                {8883}let v_8062: bool = (Disco_5903 = C) in
                                                                (
                                                                    {8884}if v_8062 then
                                                                    (
                                                                        {8885}let pkDisco_8063: bitstring = pub(skC) in
                                                                        {8886}in(c, (=pkCli_8035,em1_8064: bitstring,sigM1_8065: bitstring));
                                                                        {8887}let m1_8066: bitstring = dec(em1_8064,skSess_7766) in
                                                                        {8888}if (verify(h(m1_8066),sigM1_8065,pkCli_8035) <> true) then
                                                                            0
                                                                        else
                                                                            {8889}let (=OpenSecureChannelRequest,=pkCli_8035,wNc_8067: bitstring) = m1_8066 in
                                                                            {8890}let Nc_8068: bitstring = dec(wNc_8067,skSess_7766) in
                                                                            {8891}new Ns_8069: bitstring;
                                                                            {8892}new ST_8070: bitstring;
                                                                            {8893}new TTL_8071: bitstring;
                                                                            {8894}let wNs_8072: bitstring = enc(Ns_8069,pkCli_8035) in
                                                                            {8895}let m2_8073: bitstring = (OpenSecureChannelResponse,wNs_8072,ST_8070,TTL_8071) in
                                                                            {8896}out(c, (enc(m2_8073,pkCli_8035),sign(h(m2_8073),skSess_7766)));
                                                                            {8897}let Ksrv_8074: bitstring = h((Ns_8069,Nc_8068)) in
                                                                            {8898}out(c, senc(mSrv(pkCli_8035,pkSess_7767),Ksrv_8074))
                                                                    )
                                                                    else
                                                                        {8899}let pkDisco_8075: bitstring = pub(sk(Disco_5903)) in
                                                                        {8900}in(c, (=pkCli_8035,em1_8076: bitstring,sigM1_8077: bitstring));
                                                                        {8901}let m1_8078: bitstring = dec(em1_8076,skSess_7766) in
                                                                        {8902}if (verify(h(m1_8078),sigM1_8077,pkCli_8035) <> true) then
                                                                            0
                                                                        else
                                                                            {8903}let (=OpenSecureChannelRequest,=pkCli_8035,wNc_8079: bitstring) = m1_8078 in
                                                                            {8904}let Nc_8080: bitstring = dec(wNc_8079,skSess_7766) in
                                                                            {8905}new Ns_8081: bitstring;
                                                                            {8906}new ST_8082: bitstring;
                                                                            {8907}new TTL_8083: bitstring;
                                                                            {8908}let wNs_8084: bitstring = enc(Ns_8081,pkCli_8035) in
                                                                            {8909}let m2_8085: bitstring = (OpenSecureChannelResponse,wNs_8084,ST_8082,TTL_8083) in
                                                                            {8910}out(c, (enc(m2_8085,pkCli_8035),sign(h(m2_8085),skSess_7766)));
                                                                            {8911}let Ksrv_8086: bitstring = h((Ns_8081,Nc_8080)) in
                                                                            {8912}out(c, senc(mSrv(pkCli_8035,pkSess_7767),Ksrv_8086))
                                                                )
                                                                else
                                                                    {8913}let pkDisco_8087: bitstring = fail-any in
                                                                    {8914}in(c, (=pkCli_8035,em1_8088: bitstring,sigM1_8089: bitstring));
                                                                    {8915}let m1_8090: bitstring = dec(em1_8088,skSess_7766) in
                                                                    {8916}if (verify(h(m1_8090),sigM1_8089,pkCli_8035) <> true) then
                                                                        0
                                                                    else
                                                                        {8917}let (=OpenSecureChannelRequest,=pkCli_8035,wNc_8091: bitstring) = m1_8090 in
                                                                        {8918}let Nc_8092: bitstring = dec(wNc_8091,skSess_7766) in
                                                                        {8919}new Ns_8093: bitstring;
                                                                        {8920}new ST_8094: bitstring;
                                                                        {8921}new TTL_8095: bitstring;
                                                                        {8922}let wNs_8096: bitstring = enc(Ns_8093,pkCli_8035) in
                                                                        {8923}let m2_8097: bitstring = (OpenSecureChannelResponse,wNs_8096,ST_8094,TTL_8095) in
                                                                        {8924}out(c, (enc(m2_8097,pkCli_8035),sign(h(m2_8097),skSess_7766)));
                                                                        {8925}let Ksrv_8098: bitstring = h((Ns_8093,Nc_8092)) in
                                                                        {8926}out(c, senc(mSrv(pkCli_8035,pkSess_7767),Ksrv_8098))
                                                        )
                                                        else
                                                            {8927}let pkDisco_8099: bitstring = fail-any in
                                                            {8928}in(c, (=pkCli_8035,em1_8100: bitstring,sigM1_8101: bitstring));
                                                            {8929}let m1_8102: bitstring = dec(em1_8100,skSess_7766) in
                                                            {8930}if (verify(h(m1_8102),sigM1_8101,pkCli_8035) <> true) then
                                                                0
                                                            else
                                                                {8931}let (=OpenSecureChannelRequest,=pkCli_8035,wNc_8103: bitstring) = m1_8102 in
                                                                {8932}let Nc_8104: bitstring = dec(wNc_8103,skSess_7766) in
                                                                {8933}new Ns_8105: bitstring;
                                                                {8934}new ST_8106: bitstring;
                                                                {8935}new TTL_8107: bitstring;
                                                                {8936}let wNs_8108: bitstring = enc(Ns_8105,pkCli_8035) in
                                                                {8937}let m2_8109: bitstring = (OpenSecureChannelResponse,wNs_8108,ST_8106,TTL_8107) in
                                                                {8938}out(c, (enc(m2_8109,pkCli_8035),sign(h(m2_8109),skSess_7766)));
                                                                {8939}let Ksrv_8110: bitstring = h((Ns_8105,Nc_8104)) in
                                                                {8940}out(c, senc(mSrv(pkCli_8035,pkSess_7767),Ksrv_8110))
                                                )
                                                else
                                                    {8941}let pkDisco_8111: bitstring = fail-any in
                                                    {8942}in(c, (=pkCli_8035,em1_8112: bitstring,sigM1_8113: bitstring));
                                                    {8943}let m1_8114: bitstring = dec(em1_8112,skSess_7766) in
                                                    {8944}if (verify(h(m1_8114),sigM1_8113,pkCli_8035) <> true) then
                                                        0
                                                    else
                                                        {8945}let (=OpenSecureChannelRequest,=pkCli_8035,wNc_8115: bitstring) = m1_8114 in
                                                        {8946}let Nc_8116: bitstring = dec(wNc_8115,skSess_7766) in
                                                        {8947}new Ns_8117: bitstring;
                                                        {8948}new ST_8118: bitstring;
                                                        {8949}new TTL_8119: bitstring;
                                                        {8950}let wNs_8120: bitstring = enc(Ns_8117,pkCli_8035) in
                                                        {8951}let m2_8121: bitstring = (OpenSecureChannelResponse,wNs_8120,ST_8118,TTL_8119) in
                                                        {8952}out(c, (enc(m2_8121,pkCli_8035),sign(h(m2_8121),skSess_7766)));
                                                        {8953}let Ksrv_8122: bitstring = h((Ns_8117,Nc_8116)) in
                                                        {8954}out(c, senc(mSrv(pkCli_8035,pkSess_7767),Ksrv_8122))
                                        )
                                        else
                                            {8955}let pkCli_8123: bitstring = fail-any in
                                            {8956}let v_8124: bool = (Disco_5903 = A) in
                                            (
                                                {8957}if v_8124 then
                                                (
                                                    {8958}let pkDisco_8125: bitstring = pub(skA) in
                                                    {8959}in(c, (=pkCli_8123,em1_8126: bitstring,sigM1_8127: bitstring));
                                                    {8960}let m1_8128: bitstring = dec(em1_8126,skSess_7766) in
                                                    {8961}if (verify(h(m1_8128),sigM1_8127,pkCli_8123) <> true) then
                                                        0
                                                    else
                                                        {8962}let (=OpenSecureChannelRequest,=pkCli_8123,wNc_8129: bitstring) = m1_8128 in
                                                        {8963}let Nc_8130: bitstring = dec(wNc_8129,skSess_7766) in
                                                        {8964}new Ns_8131: bitstring;
                                                        {8965}new ST_8132: bitstring;
                                                        {8966}new TTL_8133: bitstring;
                                                        {8967}let wNs_8134: bitstring = enc(Ns_8131,pkCli_8123) in
                                                        {8968}let m2_8135: bitstring = (OpenSecureChannelResponse,wNs_8134,ST_8132,TTL_8133) in
                                                        {8969}out(c, (enc(m2_8135,pkCli_8123),sign(h(m2_8135),skSess_7766)));
                                                        {8970}let Ksrv_8136: bitstring = h((Ns_8131,Nc_8130)) in
                                                        {8971}out(c, senc(mSrv(pkCli_8123,pkSess_7767),Ksrv_8136))
                                                )
                                                else
                                                    {8972}let v_8137: bool = (Disco_5903 = B) in
                                                    (
                                                        {8973}if v_8137 then
                                                        (
                                                            {8974}let pkDisco_8138: bitstring = pub(skB) in
                                                            {8975}in(c, (=pkCli_8123,em1_8139: bitstring,sigM1_8140: bitstring));
                                                            {8976}let m1_8141: bitstring = dec(em1_8139,skSess_7766) in
                                                            {8977}if (verify(h(m1_8141),sigM1_8140,pkCli_8123) <> true) then
                                                                0
                                                            else
                                                                {8978}let (=OpenSecureChannelRequest,=pkCli_8123,wNc_8142: bitstring) = m1_8141 in
                                                                {8979}let Nc_8143: bitstring = dec(wNc_8142,skSess_7766) in
                                                                {8980}new Ns_8144: bitstring;
                                                                {8981}new ST_8145: bitstring;
                                                                {8982}new TTL_8146: bitstring;
                                                                {8983}let wNs_8147: bitstring = enc(Ns_8144,pkCli_8123) in
                                                                {8984}let m2_8148: bitstring = (OpenSecureChannelResponse,wNs_8147,ST_8145,TTL_8146) in
                                                                {8985}out(c, (enc(m2_8148,pkCli_8123),sign(h(m2_8148),skSess_7766)));
                                                                {8986}let Ksrv_8149: bitstring = h((Ns_8144,Nc_8143)) in
                                                                {8987}out(c, senc(mSrv(pkCli_8123,pkSess_7767),Ksrv_8149))
                                                        )
                                                        else
                                                            {8988}let v_8150: bool = (Disco_5903 = C) in
                                                            (
                                                                {8989}if v_8150 then
                                                                (
                                                                    {8990}let pkDisco_8151: bitstring = pub(skC) in
                                                                    {8991}in(c, (=pkCli_8123,em1_8152: bitstring,sigM1_8153: bitstring));
                                                                    {8992}let m1_8154: bitstring = dec(em1_8152,skSess_7766) in
                                                                    {8993}if (verify(h(m1_8154),sigM1_8153,pkCli_8123) <> true) then
                                                                        0
                                                                    else
                                                                        {8994}let (=OpenSecureChannelRequest,=pkCli_8123,wNc_8155: bitstring) = m1_8154 in
                                                                        {8995}let Nc_8156: bitstring = dec(wNc_8155,skSess_7766) in
                                                                        {8996}new Ns_8157: bitstring;
                                                                        {8997}new ST_8158: bitstring;
                                                                        {8998}new TTL_8159: bitstring;
                                                                        {8999}let wNs_8160: bitstring = enc(Ns_8157,pkCli_8123) in
                                                                        {9000}let m2_8161: bitstring = (OpenSecureChannelResponse,wNs_8160,ST_8158,TTL_8159) in
                                                                        {9001}out(c, (enc(m2_8161,pkCli_8123),sign(h(m2_8161),skSess_7766)));
                                                                        {9002}let Ksrv_8162: bitstring = h((Ns_8157,Nc_8156)) in
                                                                        {9003}out(c, senc(mSrv(pkCli_8123,pkSess_7767),Ksrv_8162))
                                                                )
                                                                else
                                                                    {9004}let pkDisco_8163: bitstring = pub(sk(Disco_5903)) in
                                                                    {9005}in(c, (=pkCli_8123,em1_8164: bitstring,sigM1_8165: bitstring));
                                                                    {9006}let m1_8166: bitstring = dec(em1_8164,skSess_7766) in
                                                                    {9007}if (verify(h(m1_8166),sigM1_8165,pkCli_8123) <> true) then
                                                                        0
                                                                    else
                                                                        {9008}let (=OpenSecureChannelRequest,=pkCli_8123,wNc_8167: bitstring) = m1_8166 in
                                                                        {9009}let Nc_8168: bitstring = dec(wNc_8167,skSess_7766) in
                                                                        {9010}new Ns_8169: bitstring;
                                                                        {9011}new ST_8170: bitstring;
                                                                        {9012}new TTL_8171: bitstring;
                                                                        {9013}let wNs_8172: bitstring = enc(Ns_8169,pkCli_8123) in
                                                                        {9014}let m2_8173: bitstring = (OpenSecureChannelResponse,wNs_8172,ST_8170,TTL_8171) in
                                                                        {9015}out(c, (enc(m2_8173,pkCli_8123),sign(h(m2_8173),skSess_7766)));
                                                                        {9016}let Ksrv_8174: bitstring = h((Ns_8169,Nc_8168)) in
                                                                        {9017}out(c, senc(mSrv(pkCli_8123,pkSess_7767),Ksrv_8174))
                                                            )
                                                            else
                                                                {9018}let pkDisco_8175: bitstring = fail-any in
                                                                {9019}in(c, (=pkCli_8123,em1_8176: bitstring,sigM1_8177: bitstring));
                                                                {9020}let m1_8178: bitstring = dec(em1_8176,skSess_7766) in
                                                                {9021}if (verify(h(m1_8178),sigM1_8177,pkCli_8123) <> true) then
                                                                    0
                                                                else
                                                                    {9022}let (=OpenSecureChannelRequest,=pkCli_8123,wNc_8179: bitstring) = m1_8178 in
                                                                    {9023}let Nc_8180: bitstring = dec(wNc_8179,skSess_7766) in
                                                                    {9024}new Ns_8181: bitstring;
                                                                    {9025}new ST_8182: bitstring;
                                                                    {9026}new TTL_8183: bitstring;
                                                                    {9027}let wNs_8184: bitstring = enc(Ns_8181,pkCli_8123) in
                                                                    {9028}let m2_8185: bitstring = (OpenSecureChannelResponse,wNs_8184,ST_8182,TTL_8183) in
                                                                    {9029}out(c, (enc(m2_8185,pkCli_8123),sign(h(m2_8185),skSess_7766)));
                                                                    {9030}let Ksrv_8186: bitstring = h((Ns_8181,Nc_8180)) in
                                                                    {9031}out(c, senc(mSrv(pkCli_8123,pkSess_7767),Ksrv_8186))
                                                    )
                                                    else
                                                        {9032}let pkDisco_8187: bitstring = fail-any in
                                                        {9033}in(c, (=pkCli_8123,em1_8188: bitstring,sigM1_8189: bitstring));
                                                        {9034}let m1_8190: bitstring = dec(em1_8188,skSess_7766) in
                                                        {9035}if (verify(h(m1_8190),sigM1_8189,pkCli_8123) <> true) then
                                                            0
                                                        else
                                                            {9036}let (=OpenSecureChannelRequest,=pkCli_8123,wNc_8191: bitstring) = m1_8190 in
                                                            {9037}let Nc_8192: bitstring = dec(wNc_8191,skSess_7766) in
                                                            {9038}new Ns_8193: bitstring;
                                                            {9039}new ST_8194: bitstring;
                                                            {9040}new TTL_8195: bitstring;
                                                            {9041}let wNs_8196: bitstring = enc(Ns_8193,pkCli_8123) in
                                                            {9042}let m2_8197: bitstring = (OpenSecureChannelResponse,wNs_8196,ST_8194,TTL_8195) in
                                                            {9043}out(c, (enc(m2_8197,pkCli_8123),sign(h(m2_8197),skSess_7766)));
                                                            {9044}let Ksrv_8198: bitstring = h((Ns_8193,Nc_8192)) in
                                                            {9045}out(c, senc(mSrv(pkCli_8123,pkSess_7767),Ksrv_8198))
                                            )
                                            else
                                                {9046}let pkDisco_8199: bitstring = fail-any in
                                                {9047}in(c, (=pkCli_8123,em1_8200: bitstring,sigM1_8201: bitstring));
                                                {9048}let m1_8202: bitstring = dec(em1_8200,skSess_7766) in
                                                {9049}if (verify(h(m1_8202),sigM1_8201,pkCli_8123) <> true) then
                                                    0
                                                else
                                                    {9050}let (=OpenSecureChannelRequest,=pkCli_8123,wNc_8203: bitstring) = m1_8202 in
                                                    {9051}let Nc_8204: bitstring = dec(wNc_8203,skSess_7766) in
                                                    {9052}new Ns_8205: bitstring;
                                                    {9053}new ST_8206: bitstring;
                                                    {9054}new TTL_8207: bitstring;
                                                    {9055}let wNs_8208: bitstring = enc(Ns_8205,pkCli_8123) in
                                                    {9056}let m2_8209: bitstring = (OpenSecureChannelResponse,wNs_8208,ST_8206,TTL_8207) in
                                                    {9057}out(c, (enc(m2_8209,pkCli_8123),sign(h(m2_8209),skSess_7766)));
                                                    {9058}let Ksrv_8210: bitstring = h((Ns_8205,Nc_8204)) in
                                                    {9059}out(c, senc(mSrv(pkCli_8123,pkSess_7767),Ksrv_8210))
                                )
                                else
                                    {9060}let pkCli_8211: bitstring = fail-any in
                                    {9061}let v_8212: bool = (Disco_5903 = A) in
                                    (
                                        {9062}if v_8212 then
                                        (
                                            {9063}let pkDisco_8213: bitstring = pub(skA) in
                                            {9064}in(c, (=pkCli_8211,em1_8214: bitstring,sigM1_8215: bitstring));
                                            {9065}let m1_8216: bitstring = dec(em1_8214,skSess_7766) in
                                            {9066}if (verify(h(m1_8216),sigM1_8215,pkCli_8211) <> true) then
                                                0
                                            else
                                                {9067}let (=OpenSecureChannelRequest,=pkCli_8211,wNc_8217: bitstring) = m1_8216 in
                                                {9068}let Nc_8218: bitstring = dec(wNc_8217,skSess_7766) in
                                                {9069}new Ns_8219: bitstring;
                                                {9070}new ST_8220: bitstring;
                                                {9071}new TTL_8221: bitstring;
                                                {9072}let wNs_8222: bitstring = enc(Ns_8219,pkCli_8211) in
                                                {9073}let m2_8223: bitstring = (OpenSecureChannelResponse,wNs_8222,ST_8220,TTL_8221) in
                                                {9074}out(c, (enc(m2_8223,pkCli_8211),sign(h(m2_8223),skSess_7766)));
                                                {9075}let Ksrv_8224: bitstring = h((Ns_8219,Nc_8218)) in
                                                {9076}out(c, senc(mSrv(pkCli_8211,pkSess_7767),Ksrv_8224))
                                        )
                                        else
                                            {9077}let v_8225: bool = (Disco_5903 = B) in
                                            (
                                                {9078}if v_8225 then
                                                (
                                                    {9079}let pkDisco_8226: bitstring = pub(skB) in
                                                    {9080}in(c, (=pkCli_8211,em1_8227: bitstring,sigM1_8228: bitstring));
                                                    {9081}let m1_8229: bitstring = dec(em1_8227,skSess_7766) in
                                                    {9082}if (verify(h(m1_8229),sigM1_8228,pkCli_8211) <> true) then
                                                        0
                                                    else
                                                        {9083}let (=OpenSecureChannelRequest,=pkCli_8211,wNc_8230: bitstring) = m1_8229 in
                                                        {9084}let Nc_8231: bitstring = dec(wNc_8230,skSess_7766) in
                                                        {9085}new Ns_8232: bitstring;
                                                        {9086}new ST_8233: bitstring;
                                                        {9087}new TTL_8234: bitstring;
                                                        {9088}let wNs_8235: bitstring = enc(Ns_8232,pkCli_8211) in
                                                        {9089}let m2_8236: bitstring = (OpenSecureChannelResponse,wNs_8235,ST_8233,TTL_8234) in
                                                        {9090}out(c, (enc(m2_8236,pkCli_8211),sign(h(m2_8236),skSess_7766)));
                                                        {9091}let Ksrv_8237: bitstring = h((Ns_8232,Nc_8231)) in
                                                        {9092}out(c, senc(mSrv(pkCli_8211,pkSess_7767),Ksrv_8237))
                                                )
                                                else
                                                    {9093}let v_8238: bool = (Disco_5903 = C) in
                                                    (
                                                        {9094}if v_8238 then
                                                        (
                                                            {9095}let pkDisco_8239: bitstring = pub(skC) in
                                                            {9096}in(c, (=pkCli_8211,em1_8240: bitstring,sigM1_8241: bitstring));
                                                            {9097}let m1_8242: bitstring = dec(em1_8240,skSess_7766) in
                                                            {9098}if (verify(h(m1_8242),sigM1_8241,pkCli_8211) <> true) then
                                                                0
                                                            else
                                                                {9099}let (=OpenSecureChannelRequest,=pkCli_8211,wNc_8243: bitstring) = m1_8242 in
                                                                {9100}let Nc_8244: bitstring = dec(wNc_8243,skSess_7766) in
                                                                {9101}new Ns_8245: bitstring;
                                                                {9102}new ST_8246: bitstring;
                                                                {9103}new TTL_8247: bitstring;
                                                                {9104}let wNs_8248: bitstring = enc(Ns_8245,pkCli_8211) in
                                                                {9105}let m2_8249: bitstring = (OpenSecureChannelResponse,wNs_8248,ST_8246,TTL_8247) in
                                                                {9106}out(c, (enc(m2_8249,pkCli_8211),sign(h(m2_8249),skSess_7766)));
                                                                {9107}let Ksrv_8250: bitstring = h((Ns_8245,Nc_8244)) in
                                                                {9108}out(c, senc(mSrv(pkCli_8211,pkSess_7767),Ksrv_8250))
                                                        )
                                                        else
                                                            {9109}let pkDisco_8251: bitstring = pub(sk(Disco_5903)) in
                                                            {9110}in(c, (=pkCli_8211,em1_8252: bitstring,sigM1_8253: bitstring));
                                                            {9111}let m1_8254: bitstring = dec(em1_8252,skSess_7766) in
                                                            {9112}if (verify(h(m1_8254),sigM1_8253,pkCli_8211) <> true) then
                                                                0
                                                            else
                                                                {9113}let (=OpenSecureChannelRequest,=pkCli_8211,wNc_8255: bitstring) = m1_8254 in
                                                                {9114}let Nc_8256: bitstring = dec(wNc_8255,skSess_7766) in
                                                                {9115}new Ns_8257: bitstring;
                                                                {9116}new ST_8258: bitstring;
                                                                {9117}new TTL_8259: bitstring;
                                                                {9118}let wNs_8260: bitstring = enc(Ns_8257,pkCli_8211) in
                                                                {9119}let m2_8261: bitstring = (OpenSecureChannelResponse,wNs_8260,ST_8258,TTL_8259) in
                                                                {9120}out(c, (enc(m2_8261,pkCli_8211),sign(h(m2_8261),skSess_7766)));
                                                                {9121}let Ksrv_8262: bitstring = h((Ns_8257,Nc_8256)) in
                                                                {9122}out(c, senc(mSrv(pkCli_8211,pkSess_7767),Ksrv_8262))
                                                    )
                                                    else
                                                        {9123}let pkDisco_8263: bitstring = fail-any in
                                                        {9124}in(c, (=pkCli_8211,em1_8264: bitstring,sigM1_8265: bitstring));
                                                        {9125}let m1_8266: bitstring = dec(em1_8264,skSess_7766) in
                                                        {9126}if (verify(h(m1_8266),sigM1_8265,pkCli_8211) <> true) then
                                                            0
                                                        else
                                                            {9127}let (=OpenSecureChannelRequest,=pkCli_8211,wNc_8267: bitstring) = m1_8266 in
                                                            {9128}let Nc_8268: bitstring = dec(wNc_8267,skSess_7766) in
                                                            {9129}new Ns_8269: bitstring;
                                                            {9130}new ST_8270: bitstring;
                                                            {9131}new TTL_8271: bitstring;
                                                            {9132}let wNs_8272: bitstring = enc(Ns_8269,pkCli_8211) in
                                                            {9133}let m2_8273: bitstring = (OpenSecureChannelResponse,wNs_8272,ST_8270,TTL_8271) in
                                                            {9134}out(c, (enc(m2_8273,pkCli_8211),sign(h(m2_8273),skSess_7766)));
                                                            {9135}let Ksrv_8274: bitstring = h((Ns_8269,Nc_8268)) in
                                                            {9136}out(c, senc(mSrv(pkCli_8211,pkSess_7767),Ksrv_8274))
                                            )
                                            else
                                                {9137}let pkDisco_8275: bitstring = fail-any in
                                                {9138}in(c, (=pkCli_8211,em1_8276: bitstring,sigM1_8277: bitstring));
                                                {9139}let m1_8278: bitstring = dec(em1_8276,skSess_7766) in
                                                {9140}if (verify(h(m1_8278),sigM1_8277,pkCli_8211) <> true) then
                                                    0
                                                else
                                                    {9141}let (=OpenSecureChannelRequest,=pkCli_8211,wNc_8279: bitstring) = m1_8278 in
                                                    {9142}let Nc_8280: bitstring = dec(wNc_8279,skSess_7766) in
                                                    {9143}new Ns_8281: bitstring;
                                                    {9144}new ST_8282: bitstring;
                                                    {9145}new TTL_8283: bitstring;
                                                    {9146}let wNs_8284: bitstring = enc(Ns_8281,pkCli_8211) in
                                                    {9147}let m2_8285: bitstring = (OpenSecureChannelResponse,wNs_8284,ST_8282,TTL_8283) in
                                                    {9148}out(c, (enc(m2_8285,pkCli_8211),sign(h(m2_8285),skSess_7766)));
                                                    {9149}let Ksrv_8286: bitstring = h((Ns_8281,Nc_8280)) in
                                                    {9150}out(c, senc(mSrv(pkCli_8211,pkSess_7767),Ksrv_8286))
                                    )
                                    else
                                        {9151}let pkDisco_8287: bitstring = fail-any in
                                        {9152}in(c, (=pkCli_8211,em1_8288: bitstring,sigM1_8289: bitstring));
                                        {9153}let m1_8290: bitstring = dec(em1_8288,skSess_7766) in
                                        {9154}if (verify(h(m1_8290),sigM1_8289,pkCli_8211) <> true) then
                                            0
                                        else
                                            {9155}let (=OpenSecureChannelRequest,=pkCli_8211,wNc_8291: bitstring) = m1_8290 in
                                            {9156}let Nc_8292: bitstring = dec(wNc_8291,skSess_7766) in
                                            {9157}new Ns_8293: bitstring;
                                            {9158}new ST_8294: bitstring;
                                            {9159}new TTL_8295: bitstring;
                                            {9160}let wNs_8296: bitstring = enc(Ns_8293,pkCli_8211) in
                                            {9161}let m2_8297: bitstring = (OpenSecureChannelResponse,wNs_8296,ST_8294,TTL_8295) in
                                            {9162}out(c, (enc(m2_8297,pkCli_8211),sign(h(m2_8297),skSess_7766)));
                                            {9163}let Ksrv_8298: bitstring = h((Ns_8293,Nc_8292)) in
                                            {9164}out(c, senc(mSrv(pkCli_8211,pkSess_7767),Ksrv_8298))
                        )
                        else
                            {9165}let pkCli_8299: bitstring = fail-any in
                            {9166}let v_8300: bool = (Disco_5903 = A) in
                            (
                                {9167}if v_8300 then
                                (
                                    {9168}let pkDisco_8301: bitstring = pub(skA) in
                                    {9169}in(c, (=pkCli_8299,em1_8302: bitstring,sigM1_8303: bitstring));
                                    {9170}let m1_8304: bitstring = dec(em1_8302,skSess_7766) in
                                    {9171}if (verify(h(m1_8304),sigM1_8303,pkCli_8299) <> true) then
                                        0
                                    else
                                        {9172}let (=OpenSecureChannelRequest,=pkCli_8299,wNc_8305: bitstring) = m1_8304 in
                                        {9173}let Nc_8306: bitstring = dec(wNc_8305,skSess_7766) in
                                        {9174}new Ns_8307: bitstring;
                                        {9175}new ST_8308: bitstring;
                                        {9176}new TTL_8309: bitstring;
                                        {9177}let wNs_8310: bitstring = enc(Ns_8307,pkCli_8299) in
                                        {9178}let m2_8311: bitstring = (OpenSecureChannelResponse,wNs_8310,ST_8308,TTL_8309) in
                                        {9179}out(c, (enc(m2_8311,pkCli_8299),sign(h(m2_8311),skSess_7766)));
                                        {9180}let Ksrv_8312: bitstring = h((Ns_8307,Nc_8306)) in
                                        {9181}out(c, senc(mSrv(pkCli_8299,pkSess_7767),Ksrv_8312))
                                )
                                else
                                    {9182}let v_8313: bool = (Disco_5903 = B) in
                                    (
                                        {9183}if v_8313 then
                                        (
                                            {9184}let pkDisco_8314: bitstring = pub(skB) in
                                            {9185}in(c, (=pkCli_8299,em1_8315: bitstring,sigM1_8316: bitstring));
                                            {9186}let m1_8317: bitstring = dec(em1_8315,skSess_7766) in
                                            {9187}if (verify(h(m1_8317),sigM1_8316,pkCli_8299) <> true) then
                                                0
                                            else
                                                {9188}let (=OpenSecureChannelRequest,=pkCli_8299,wNc_8318: bitstring) = m1_8317 in
                                                {9189}let Nc_8319: bitstring = dec(wNc_8318,skSess_7766) in
                                                {9190}new Ns_8320: bitstring;
                                                {9191}new ST_8321: bitstring;
                                                {9192}new TTL_8322: bitstring;
                                                {9193}let wNs_8323: bitstring = enc(Ns_8320,pkCli_8299) in
                                                {9194}let m2_8324: bitstring = (OpenSecureChannelResponse,wNs_8323,ST_8321,TTL_8322) in
                                                {9195}out(c, (enc(m2_8324,pkCli_8299),sign(h(m2_8324),skSess_7766)));
                                                {9196}let Ksrv_8325: bitstring = h((Ns_8320,Nc_8319)) in
                                                {9197}out(c, senc(mSrv(pkCli_8299,pkSess_7767),Ksrv_8325))
                                        )
                                        else
                                            {9198}let v_8326: bool = (Disco_5903 = C) in
                                            (
                                                {9199}if v_8326 then
                                                (
                                                    {9200}let pkDisco_8327: bitstring = pub(skC) in
                                                    {9201}in(c, (=pkCli_8299,em1_8328: bitstring,sigM1_8329: bitstring));
                                                    {9202}let m1_8330: bitstring = dec(em1_8328,skSess_7766) in
                                                    {9203}if (verify(h(m1_8330),sigM1_8329,pkCli_8299) <> true) then
                                                        0
                                                    else
                                                        {9204}let (=OpenSecureChannelRequest,=pkCli_8299,wNc_8331: bitstring) = m1_8330 in
                                                        {9205}let Nc_8332: bitstring = dec(wNc_8331,skSess_7766) in
                                                        {9206}new Ns_8333: bitstring;
                                                        {9207}new ST_8334: bitstring;
                                                        {9208}new TTL_8335: bitstring;
                                                        {9209}let wNs_8336: bitstring = enc(Ns_8333,pkCli_8299) in
                                                        {9210}let m2_8337: bitstring = (OpenSecureChannelResponse,wNs_8336,ST_8334,TTL_8335) in
                                                        {9211}out(c, (enc(m2_8337,pkCli_8299),sign(h(m2_8337),skSess_7766)));
                                                        {9212}let Ksrv_8338: bitstring = h((Ns_8333,Nc_8332)) in
                                                        {9213}out(c, senc(mSrv(pkCli_8299,pkSess_7767),Ksrv_8338))
                                                )
                                                else
                                                    {9214}let pkDisco_8339: bitstring = pub(sk(Disco_5903)) in
                                                    {9215}in(c, (=pkCli_8299,em1_8340: bitstring,sigM1_8341: bitstring));
                                                    {9216}let m1_8342: bitstring = dec(em1_8340,skSess_7766) in
                                                    {9217}if (verify(h(m1_8342),sigM1_8341,pkCli_8299) <> true) then
                                                        0
                                                    else
                                                        {9218}let (=OpenSecureChannelRequest,=pkCli_8299,wNc_8343: bitstring) = m1_8342 in
                                                        {9219}let Nc_8344: bitstring = dec(wNc_8343,skSess_7766) in
                                                        {9220}new Ns_8345: bitstring;
                                                        {9221}new ST_8346: bitstring;
                                                        {9222}new TTL_8347: bitstring;
                                                        {9223}let wNs_8348: bitstring = enc(Ns_8345,pkCli_8299) in
                                                        {9224}let m2_8349: bitstring = (OpenSecureChannelResponse,wNs_8348,ST_8346,TTL_8347) in
                                                        {9225}out(c, (enc(m2_8349,pkCli_8299),sign(h(m2_8349),skSess_7766)));
                                                        {9226}let Ksrv_8350: bitstring = h((Ns_8345,Nc_8344)) in
                                                        {9227}out(c, senc(mSrv(pkCli_8299,pkSess_7767),Ksrv_8350))
                                            )
                                            else
                                                {9228}let pkDisco_8351: bitstring = fail-any in
                                                {9229}in(c, (=pkCli_8299,em1_8352: bitstring,sigM1_8353: bitstring));
                                                {9230}let m1_8354: bitstring = dec(em1_8352,skSess_7766) in
                                                {9231}if (verify(h(m1_8354),sigM1_8353,pkCli_8299) <> true) then
                                                    0
                                                else
                                                    {9232}let (=OpenSecureChannelRequest,=pkCli_8299,wNc_8355: bitstring) = m1_8354 in
                                                    {9233}let Nc_8356: bitstring = dec(wNc_8355,skSess_7766) in
                                                    {9234}new Ns_8357: bitstring;
                                                    {9235}new ST_8358: bitstring;
                                                    {9236}new TTL_8359: bitstring;
                                                    {9237}let wNs_8360: bitstring = enc(Ns_8357,pkCli_8299) in
                                                    {9238}let m2_8361: bitstring = (OpenSecureChannelResponse,wNs_8360,ST_8358,TTL_8359) in
                                                    {9239}out(c, (enc(m2_8361,pkCli_8299),sign(h(m2_8361),skSess_7766)));
                                                    {9240}let Ksrv_8362: bitstring = h((Ns_8357,Nc_8356)) in
                                                    {9241}out(c, senc(mSrv(pkCli_8299,pkSess_7767),Ksrv_8362))
                                    )
                                    else
                                        {9242}let pkDisco_8363: bitstring = fail-any in
                                        {9243}in(c, (=pkCli_8299,em1_8364: bitstring,sigM1_8365: bitstring));
                                        {9244}let m1_8366: bitstring = dec(em1_8364,skSess_7766) in
                                        {9245}if (verify(h(m1_8366),sigM1_8365,pkCli_8299) <> true) then
                                            0
                                        else
                                            {9246}let (=OpenSecureChannelRequest,=pkCli_8299,wNc_8367: bitstring) = m1_8366 in
                                            {9247}let Nc_8368: bitstring = dec(wNc_8367,skSess_7766) in
                                            {9248}new Ns_8369: bitstring;
                                            {9249}new ST_8370: bitstring;
                                            {9250}new TTL_8371: bitstring;
                                            {9251}let wNs_8372: bitstring = enc(Ns_8369,pkCli_8299) in
                                            {9252}let m2_8373: bitstring = (OpenSecureChannelResponse,wNs_8372,ST_8370,TTL_8371) in
                                            {9253}out(c, (enc(m2_8373,pkCli_8299),sign(h(m2_8373),skSess_7766)));
                                            {9254}let Ksrv_8374: bitstring = h((Ns_8369,Nc_8368)) in
                                            {9255}out(c, senc(mSrv(pkCli_8299,pkSess_7767),Ksrv_8374))
                            )
                            else
                                {9256}let pkDisco_8375: bitstring = fail-any in
                                {9257}in(c, (=pkCli_8299,em1_8376: bitstring,sigM1_8377: bitstring));
                                {9258}let m1_8378: bitstring = dec(em1_8376,skSess_7766) in
                                {9259}if (verify(h(m1_8378),sigM1_8377,pkCli_8299) <> true) then
                                    0
                                else
                                    {9260}let (=OpenSecureChannelRequest,=pkCli_8299,wNc_8379: bitstring) = m1_8378 in
                                    {9261}let Nc_8380: bitstring = dec(wNc_8379,skSess_7766) in
                                    {9262}new Ns_8381: bitstring;
                                    {9263}new ST_8382: bitstring;
                                    {9264}new TTL_8383: bitstring;
                                    {9265}let wNs_8384: bitstring = enc(Ns_8381,pkCli_8299) in
                                    {9266}let m2_8385: bitstring = (OpenSecureChannelResponse,wNs_8384,ST_8382,TTL_8383) in
                                    {9267}out(c, (enc(m2_8385,pkCli_8299),sign(h(m2_8385),skSess_7766)));
                                    {9268}let Ksrv_8386: bitstring = h((Ns_8381,Nc_8380)) in
                                    {9269}out(c, senc(mSrv(pkCli_8299,pkSess_7767),Ksrv_8386))
            )
            else
                {9270}let skSess_8387: bitstring = fail-any in
                {9271}let pkSess_8388: bitstring = pub(skSess_8387) in
                {9272}let v_8389: bool = (Cli_5902 = A) in
                (
                    {9273}if v_8389 then
                    (
                        {9274}let pkCli_8390: bitstring = pub(skA) in
                        {9275}let v_8391: bool = (Disco_5903 = A) in
                        (
                            {9276}if v_8391 then
                            (
                                {9277}let pkDisco_8392: bitstring = pub(skA) in
                                {9278}in(c, (=pkCli_8390,em1_8393: bitstring,sigM1_8394: bitstring));
                                {9279}let m1_8395: bitstring = dec(em1_8393,skSess_8387) in
                                {9280}if (verify(h(m1_8395),sigM1_8394,pkCli_8390) <> true) then
                                    0
                                else
                                    {9281}let (=OpenSecureChannelRequest,=pkCli_8390,wNc_8396: bitstring) = m1_8395 in
                                    {9282}let Nc_8397: bitstring = dec(wNc_8396,skSess_8387) in
                                    {9283}new Ns_8398: bitstring;
                                    {9284}new ST_8399: bitstring;
                                    {9285}new TTL_8400: bitstring;
                                    {9286}let wNs_8401: bitstring = enc(Ns_8398,pkCli_8390) in
                                    {9287}let m2_8402: bitstring = (OpenSecureChannelResponse,wNs_8401,ST_8399,TTL_8400) in
                                    {9288}out(c, (enc(m2_8402,pkCli_8390),sign(h(m2_8402),skSess_8387)));
                                    {9289}let Ksrv_8403: bitstring = h((Ns_8398,Nc_8397)) in
                                    {9290}out(c, senc(mSrv(pkCli_8390,pkSess_8388),Ksrv_8403))
                            )
                            else
                                {9291}let v_8404: bool = (Disco_5903 = B) in
                                (
                                    {9292}if v_8404 then
                                    (
                                        {9293}let pkDisco_8405: bitstring = pub(skB) in
                                        {9294}in(c, (=pkCli_8390,em1_8406: bitstring,sigM1_8407: bitstring));
                                        {9295}let m1_8408: bitstring = dec(em1_8406,skSess_8387) in
                                        {9296}if (verify(h(m1_8408),sigM1_8407,pkCli_8390) <> true) then
                                            0
                                        else
                                            {9297}let (=OpenSecureChannelRequest,=pkCli_8390,wNc_8409: bitstring) = m1_8408 in
                                            {9298}let Nc_8410: bitstring = dec(wNc_8409,skSess_8387) in
                                            {9299}new Ns_8411: bitstring;
                                            {9300}new ST_8412: bitstring;
                                            {9301}new TTL_8413: bitstring;
                                            {9302}let wNs_8414: bitstring = enc(Ns_8411,pkCli_8390) in
                                            {9303}let m2_8415: bitstring = (OpenSecureChannelResponse,wNs_8414,ST_8412,TTL_8413) in
                                            {9304}out(c, (enc(m2_8415,pkCli_8390),sign(h(m2_8415),skSess_8387)));
                                            {9305}let Ksrv_8416: bitstring = h((Ns_8411,Nc_8410)) in
                                            {9306}out(c, senc(mSrv(pkCli_8390,pkSess_8388),Ksrv_8416))
                                    )
                                    else
                                        {9307}let v_8417: bool = (Disco_5903 = C) in
                                        (
                                            {9308}if v_8417 then
                                            (
                                                {9309}let pkDisco_8418: bitstring = pub(skC) in
                                                {9310}in(c, (=pkCli_8390,em1_8419: bitstring,sigM1_8420: bitstring));
                                                {9311}let m1_8421: bitstring = dec(em1_8419,skSess_8387) in
                                                {9312}if (verify(h(m1_8421),sigM1_8420,pkCli_8390) <> true) then
                                                    0
                                                else
                                                    {9313}let (=OpenSecureChannelRequest,=pkCli_8390,wNc_8422: bitstring) = m1_8421 in
                                                    {9314}let Nc_8423: bitstring = dec(wNc_8422,skSess_8387) in
                                                    {9315}new Ns_8424: bitstring;
                                                    {9316}new ST_8425: bitstring;
                                                    {9317}new TTL_8426: bitstring;
                                                    {9318}let wNs_8427: bitstring = enc(Ns_8424,pkCli_8390) in
                                                    {9319}let m2_8428: bitstring = (OpenSecureChannelResponse,wNs_8427,ST_8425,TTL_8426) in
                                                    {9320}out(c, (enc(m2_8428,pkCli_8390),sign(h(m2_8428),skSess_8387)));
                                                    {9321}let Ksrv_8429: bitstring = h((Ns_8424,Nc_8423)) in
                                                    {9322}out(c, senc(mSrv(pkCli_8390,pkSess_8388),Ksrv_8429))
                                            )
                                            else
                                                {9323}let pkDisco_8430: bitstring = pub(sk(Disco_5903)) in
                                                {9324}in(c, (=pkCli_8390,em1_8431: bitstring,sigM1_8432: bitstring));
                                                {9325}let m1_8433: bitstring = dec(em1_8431,skSess_8387) in
                                                {9326}if (verify(h(m1_8433),sigM1_8432,pkCli_8390) <> true) then
                                                    0
                                                else
                                                    {9327}let (=OpenSecureChannelRequest,=pkCli_8390,wNc_8434: bitstring) = m1_8433 in
                                                    {9328}let Nc_8435: bitstring = dec(wNc_8434,skSess_8387) in
                                                    {9329}new Ns_8436: bitstring;
                                                    {9330}new ST_8437: bitstring;
                                                    {9331}new TTL_8438: bitstring;
                                                    {9332}let wNs_8439: bitstring = enc(Ns_8436,pkCli_8390) in
                                                    {9333}let m2_8440: bitstring = (OpenSecureChannelResponse,wNs_8439,ST_8437,TTL_8438) in
                                                    {9334}out(c, (enc(m2_8440,pkCli_8390),sign(h(m2_8440),skSess_8387)));
                                                    {9335}let Ksrv_8441: bitstring = h((Ns_8436,Nc_8435)) in
                                                    {9336}out(c, senc(mSrv(pkCli_8390,pkSess_8388),Ksrv_8441))
                                        )
                                        else
                                            {9337}let pkDisco_8442: bitstring = fail-any in
                                            {9338}in(c, (=pkCli_8390,em1_8443: bitstring,sigM1_8444: bitstring));
                                            {9339}let m1_8445: bitstring = dec(em1_8443,skSess_8387) in
                                            {9340}if (verify(h(m1_8445),sigM1_8444,pkCli_8390) <> true) then
                                                0
                                            else
                                                {9341}let (=OpenSecureChannelRequest,=pkCli_8390,wNc_8446: bitstring) = m1_8445 in
                                                {9342}let Nc_8447: bitstring = dec(wNc_8446,skSess_8387) in
                                                {9343}new Ns_8448: bitstring;
                                                {9344}new ST_8449: bitstring;
                                                {9345}new TTL_8450: bitstring;
                                                {9346}let wNs_8451: bitstring = enc(Ns_8448,pkCli_8390) in
                                                {9347}let m2_8452: bitstring = (OpenSecureChannelResponse,wNs_8451,ST_8449,TTL_8450) in
                                                {9348}out(c, (enc(m2_8452,pkCli_8390),sign(h(m2_8452),skSess_8387)));
                                                {9349}let Ksrv_8453: bitstring = h((Ns_8448,Nc_8447)) in
                                                {9350}out(c, senc(mSrv(pkCli_8390,pkSess_8388),Ksrv_8453))
                                )
                                else
                                    {9351}let pkDisco_8454: bitstring = fail-any in
                                    {9352}in(c, (=pkCli_8390,em1_8455: bitstring,sigM1_8456: bitstring));
                                    {9353}let m1_8457: bitstring = dec(em1_8455,skSess_8387) in
                                    {9354}if (verify(h(m1_8457),sigM1_8456,pkCli_8390) <> true) then
                                        0
                                    else
                                        {9355}let (=OpenSecureChannelRequest,=pkCli_8390,wNc_8458: bitstring) = m1_8457 in
                                        {9356}let Nc_8459: bitstring = dec(wNc_8458,skSess_8387) in
                                        {9357}new Ns_8460: bitstring;
                                        {9358}new ST_8461: bitstring;
                                        {9359}new TTL_8462: bitstring;
                                        {9360}let wNs_8463: bitstring = enc(Ns_8460,pkCli_8390) in
                                        {9361}let m2_8464: bitstring = (OpenSecureChannelResponse,wNs_8463,ST_8461,TTL_8462) in
                                        {9362}out(c, (enc(m2_8464,pkCli_8390),sign(h(m2_8464),skSess_8387)));
                                        {9363}let Ksrv_8465: bitstring = h((Ns_8460,Nc_8459)) in
                                        {9364}out(c, senc(mSrv(pkCli_8390,pkSess_8388),Ksrv_8465))
                        )
                        else
                            {9365}let pkDisco_8466: bitstring = fail-any in
                            {9366}in(c, (=pkCli_8390,em1_8467: bitstring,sigM1_8468: bitstring));
                            {9367}let m1_8469: bitstring = dec(em1_8467,skSess_8387) in
                            {9368}if (verify(h(m1_8469),sigM1_8468,pkCli_8390) <> true) then
                                0
                            else
                                {9369}let (=OpenSecureChannelRequest,=pkCli_8390,wNc_8470: bitstring) = m1_8469 in
                                {9370}let Nc_8471: bitstring = dec(wNc_8470,skSess_8387) in
                                {9371}new Ns_8472: bitstring;
                                {9372}new ST_8473: bitstring;
                                {9373}new TTL_8474: bitstring;
                                {9374}let wNs_8475: bitstring = enc(Ns_8472,pkCli_8390) in
                                {9375}let m2_8476: bitstring = (OpenSecureChannelResponse,wNs_8475,ST_8473,TTL_8474) in
                                {9376}out(c, (enc(m2_8476,pkCli_8390),sign(h(m2_8476),skSess_8387)));
                                {9377}let Ksrv_8477: bitstring = h((Ns_8472,Nc_8471)) in
                                {9378}out(c, senc(mSrv(pkCli_8390,pkSess_8388),Ksrv_8477))
                    )
                    else
                        {9379}let v_8478: bool = (Cli_5902 = B) in
                        (
                            {9380}if v_8478 then
                            (
                                {9381}let pkCli_8479: bitstring = pub(skB) in
                                {9382}let v_8480: bool = (Disco_5903 = A) in
                                (
                                    {9383}if v_8480 then
                                    (
                                        {9384}let pkDisco_8481: bitstring = pub(skA) in
                                        {9385}in(c, (=pkCli_8479,em1_8482: bitstring,sigM1_8483: bitstring));
                                        {9386}let m1_8484: bitstring = dec(em1_8482,skSess_8387) in
                                        {9387}if (verify(h(m1_8484),sigM1_8483,pkCli_8479) <> true) then
                                            0
                                        else
                                            {9388}let (=OpenSecureChannelRequest,=pkCli_8479,wNc_8485: bitstring) = m1_8484 in
                                            {9389}let Nc_8486: bitstring = dec(wNc_8485,skSess_8387) in
                                            {9390}new Ns_8487: bitstring;
                                            {9391}new ST_8488: bitstring;
                                            {9392}new TTL_8489: bitstring;
                                            {9393}let wNs_8490: bitstring = enc(Ns_8487,pkCli_8479) in
                                            {9394}let m2_8491: bitstring = (OpenSecureChannelResponse,wNs_8490,ST_8488,TTL_8489) in
                                            {9395}out(c, (enc(m2_8491,pkCli_8479),sign(h(m2_8491),skSess_8387)));
                                            {9396}let Ksrv_8492: bitstring = h((Ns_8487,Nc_8486)) in
                                            {9397}out(c, senc(mSrv(pkCli_8479,pkSess_8388),Ksrv_8492))
                                    )
                                    else
                                        {9398}let v_8493: bool = (Disco_5903 = B) in
                                        (
                                            {9399}if v_8493 then
                                            (
                                                {9400}let pkDisco_8494: bitstring = pub(skB) in
                                                {9401}in(c, (=pkCli_8479,em1_8495: bitstring,sigM1_8496: bitstring));
                                                {9402}let m1_8497: bitstring = dec(em1_8495,skSess_8387) in
                                                {9403}if (verify(h(m1_8497),sigM1_8496,pkCli_8479) <> true) then
                                                    0
                                                else
                                                    {9404}let (=OpenSecureChannelRequest,=pkCli_8479,wNc_8498: bitstring) = m1_8497 in
                                                    {9405}let Nc_8499: bitstring = dec(wNc_8498,skSess_8387) in
                                                    {9406}new Ns_8500: bitstring;
                                                    {9407}new ST_8501: bitstring;
                                                    {9408}new TTL_8502: bitstring;
                                                    {9409}let wNs_8503: bitstring = enc(Ns_8500,pkCli_8479) in
                                                    {9410}let m2_8504: bitstring = (OpenSecureChannelResponse,wNs_8503,ST_8501,TTL_8502) in
                                                    {9411}out(c, (enc(m2_8504,pkCli_8479),sign(h(m2_8504),skSess_8387)));
                                                    {9412}let Ksrv_8505: bitstring = h((Ns_8500,Nc_8499)) in
                                                    {9413}out(c, senc(mSrv(pkCli_8479,pkSess_8388),Ksrv_8505))
                                            )
                                            else
                                                {9414}let v_8506: bool = (Disco_5903 = C) in
                                                (
                                                    {9415}if v_8506 then
                                                    (
                                                        {9416}let pkDisco_8507: bitstring = pub(skC) in
                                                        {9417}in(c, (=pkCli_8479,em1_8508: bitstring,sigM1_8509: bitstring));
                                                        {9418}let m1_8510: bitstring = dec(em1_8508,skSess_8387) in
                                                        {9419}if (verify(h(m1_8510),sigM1_8509,pkCli_8479) <> true) then
                                                            0
                                                        else
                                                            {9420}let (=OpenSecureChannelRequest,=pkCli_8479,wNc_8511: bitstring) = m1_8510 in
                                                            {9421}let Nc_8512: bitstring = dec(wNc_8511,skSess_8387) in
                                                            {9422}new Ns_8513: bitstring;
                                                            {9423}new ST_8514: bitstring;
                                                            {9424}new TTL_8515: bitstring;
                                                            {9425}let wNs_8516: bitstring = enc(Ns_8513,pkCli_8479) in
                                                            {9426}let m2_8517: bitstring = (OpenSecureChannelResponse,wNs_8516,ST_8514,TTL_8515) in
                                                            {9427}out(c, (enc(m2_8517,pkCli_8479),sign(h(m2_8517),skSess_8387)));
                                                            {9428}let Ksrv_8518: bitstring = h((Ns_8513,Nc_8512)) in
                                                            {9429}out(c, senc(mSrv(pkCli_8479,pkSess_8388),Ksrv_8518))
                                                    )
                                                    else
                                                        {9430}let pkDisco_8519: bitstring = pub(sk(Disco_5903)) in
                                                        {9431}in(c, (=pkCli_8479,em1_8520: bitstring,sigM1_8521: bitstring));
                                                        {9432}let m1_8522: bitstring = dec(em1_8520,skSess_8387) in
                                                        {9433}if (verify(h(m1_8522),sigM1_8521,pkCli_8479) <> true) then
                                                            0
                                                        else
                                                            {9434}let (=OpenSecureChannelRequest,=pkCli_8479,wNc_8523: bitstring) = m1_8522 in
                                                            {9435}let Nc_8524: bitstring = dec(wNc_8523,skSess_8387) in
                                                            {9436}new Ns_8525: bitstring;
                                                            {9437}new ST_8526: bitstring;
                                                            {9438}new TTL_8527: bitstring;
                                                            {9439}let wNs_8528: bitstring = enc(Ns_8525,pkCli_8479) in
                                                            {9440}let m2_8529: bitstring = (OpenSecureChannelResponse,wNs_8528,ST_8526,TTL_8527) in
                                                            {9441}out(c, (enc(m2_8529,pkCli_8479),sign(h(m2_8529),skSess_8387)));
                                                            {9442}let Ksrv_8530: bitstring = h((Ns_8525,Nc_8524)) in
                                                            {9443}out(c, senc(mSrv(pkCli_8479,pkSess_8388),Ksrv_8530))
                                                )
                                                else
                                                    {9444}let pkDisco_8531: bitstring = fail-any in
                                                    {9445}in(c, (=pkCli_8479,em1_8532: bitstring,sigM1_8533: bitstring));
                                                    {9446}let m1_8534: bitstring = dec(em1_8532,skSess_8387) in
                                                    {9447}if (verify(h(m1_8534),sigM1_8533,pkCli_8479) <> true) then
                                                        0
                                                    else
                                                        {9448}let (=OpenSecureChannelRequest,=pkCli_8479,wNc_8535: bitstring) = m1_8534 in
                                                        {9449}let Nc_8536: bitstring = dec(wNc_8535,skSess_8387) in
                                                        {9450}new Ns_8537: bitstring;
                                                        {9451}new ST_8538: bitstring;
                                                        {9452}new TTL_8539: bitstring;
                                                        {9453}let wNs_8540: bitstring = enc(Ns_8537,pkCli_8479) in
                                                        {9454}let m2_8541: bitstring = (OpenSecureChannelResponse,wNs_8540,ST_8538,TTL_8539) in
                                                        {9455}out(c, (enc(m2_8541,pkCli_8479),sign(h(m2_8541),skSess_8387)));
                                                        {9456}let Ksrv_8542: bitstring = h((Ns_8537,Nc_8536)) in
                                                        {9457}out(c, senc(mSrv(pkCli_8479,pkSess_8388),Ksrv_8542))
                                        )
                                        else
                                            {9458}let pkDisco_8543: bitstring = fail-any in
                                            {9459}in(c, (=pkCli_8479,em1_8544: bitstring,sigM1_8545: bitstring));
                                            {9460}let m1_8546: bitstring = dec(em1_8544,skSess_8387) in
                                            {9461}if (verify(h(m1_8546),sigM1_8545,pkCli_8479) <> true) then
                                                0
                                            else
                                                {9462}let (=OpenSecureChannelRequest,=pkCli_8479,wNc_8547: bitstring) = m1_8546 in
                                                {9463}let Nc_8548: bitstring = dec(wNc_8547,skSess_8387) in
                                                {9464}new Ns_8549: bitstring;
                                                {9465}new ST_8550: bitstring;
                                                {9466}new TTL_8551: bitstring;
                                                {9467}let wNs_8552: bitstring = enc(Ns_8549,pkCli_8479) in
                                                {9468}let m2_8553: bitstring = (OpenSecureChannelResponse,wNs_8552,ST_8550,TTL_8551) in
                                                {9469}out(c, (enc(m2_8553,pkCli_8479),sign(h(m2_8553),skSess_8387)));
                                                {9470}let Ksrv_8554: bitstring = h((Ns_8549,Nc_8548)) in
                                                {9471}out(c, senc(mSrv(pkCli_8479,pkSess_8388),Ksrv_8554))
                                )
                                else
                                    {9472}let pkDisco_8555: bitstring = fail-any in
                                    {9473}in(c, (=pkCli_8479,em1_8556: bitstring,sigM1_8557: bitstring));
                                    {9474}let m1_8558: bitstring = dec(em1_8556,skSess_8387) in
                                    {9475}if (verify(h(m1_8558),sigM1_8557,pkCli_8479) <> true) then
                                        0
                                    else
                                        {9476}let (=OpenSecureChannelRequest,=pkCli_8479,wNc_8559: bitstring) = m1_8558 in
                                        {9477}let Nc_8560: bitstring = dec(wNc_8559,skSess_8387) in
                                        {9478}new Ns_8561: bitstring;
                                        {9479}new ST_8562: bitstring;
                                        {9480}new TTL_8563: bitstring;
                                        {9481}let wNs_8564: bitstring = enc(Ns_8561,pkCli_8479) in
                                        {9482}let m2_8565: bitstring = (OpenSecureChannelResponse,wNs_8564,ST_8562,TTL_8563) in
                                        {9483}out(c, (enc(m2_8565,pkCli_8479),sign(h(m2_8565),skSess_8387)));
                                        {9484}let Ksrv_8566: bitstring = h((Ns_8561,Nc_8560)) in
                                        {9485}out(c, senc(mSrv(pkCli_8479,pkSess_8388),Ksrv_8566))
                            )
                            else
                                {9486}let v_8567: bool = (Cli_5902 = C) in
                                (
                                    {9487}if v_8567 then
                                    (
                                        {9488}let pkCli_8568: bitstring = pub(skC) in
                                        {9489}let v_8569: bool = (Disco_5903 = A) in
                                        (
                                            {9490}if v_8569 then
                                            (
                                                {9491}let pkDisco_8570: bitstring = pub(skA) in
                                                {9492}in(c, (=pkCli_8568,em1_8571: bitstring,sigM1_8572: bitstring));
                                                {9493}let m1_8573: bitstring = dec(em1_8571,skSess_8387) in
                                                {9494}if (verify(h(m1_8573),sigM1_8572,pkCli_8568) <> true) then
                                                    0
                                                else
                                                    {9495}let (=OpenSecureChannelRequest,=pkCli_8568,wNc_8574: bitstring) = m1_8573 in
                                                    {9496}let Nc_8575: bitstring = dec(wNc_8574,skSess_8387) in
                                                    {9497}new Ns_8576: bitstring;
                                                    {9498}new ST_8577: bitstring;
                                                    {9499}new TTL_8578: bitstring;
                                                    {9500}let wNs_8579: bitstring = enc(Ns_8576,pkCli_8568) in
                                                    {9501}let m2_8580: bitstring = (OpenSecureChannelResponse,wNs_8579,ST_8577,TTL_8578) in
                                                    {9502}out(c, (enc(m2_8580,pkCli_8568),sign(h(m2_8580),skSess_8387)));
                                                    {9503}let Ksrv_8581: bitstring = h((Ns_8576,Nc_8575)) in
                                                    {9504}out(c, senc(mSrv(pkCli_8568,pkSess_8388),Ksrv_8581))
                                            )
                                            else
                                                {9505}let v_8582: bool = (Disco_5903 = B) in
                                                (
                                                    {9506}if v_8582 then
                                                    (
                                                        {9507}let pkDisco_8583: bitstring = pub(skB) in
                                                        {9508}in(c, (=pkCli_8568,em1_8584: bitstring,sigM1_8585: bitstring));
                                                        {9509}let m1_8586: bitstring = dec(em1_8584,skSess_8387) in
                                                        {9510}if (verify(h(m1_8586),sigM1_8585,pkCli_8568) <> true) then
                                                            0
                                                        else
                                                            {9511}let (=OpenSecureChannelRequest,=pkCli_8568,wNc_8587: bitstring) = m1_8586 in
                                                            {9512}let Nc_8588: bitstring = dec(wNc_8587,skSess_8387) in
                                                            {9513}new Ns_8589: bitstring;
                                                            {9514}new ST_8590: bitstring;
                                                            {9515}new TTL_8591: bitstring;
                                                            {9516}let wNs_8592: bitstring = enc(Ns_8589,pkCli_8568) in
                                                            {9517}let m2_8593: bitstring = (OpenSecureChannelResponse,wNs_8592,ST_8590,TTL_8591) in
                                                            {9518}out(c, (enc(m2_8593,pkCli_8568),sign(h(m2_8593),skSess_8387)));
                                                            {9519}let Ksrv_8594: bitstring = h((Ns_8589,Nc_8588)) in
                                                            {9520}out(c, senc(mSrv(pkCli_8568,pkSess_8388),Ksrv_8594))
                                                    )
                                                    else
                                                        {9521}let v_8595: bool = (Disco_5903 = C) in
                                                        (
                                                            {9522}if v_8595 then
                                                            (
                                                                {9523}let pkDisco_8596: bitstring = pub(skC) in
                                                                {9524}in(c, (=pkCli_8568,em1_8597: bitstring,sigM1_8598: bitstring));
                                                                {9525}let m1_8599: bitstring = dec(em1_8597,skSess_8387) in
                                                                {9526}if (verify(h(m1_8599),sigM1_8598,pkCli_8568) <> true) then
                                                                    0
                                                                else
                                                                    {9527}let (=OpenSecureChannelRequest,=pkCli_8568,wNc_8600: bitstring) = m1_8599 in
                                                                    {9528}let Nc_8601: bitstring = dec(wNc_8600,skSess_8387) in
                                                                    {9529}new Ns_8602: bitstring;
                                                                    {9530}new ST_8603: bitstring;
                                                                    {9531}new TTL_8604: bitstring;
                                                                    {9532}let wNs_8605: bitstring = enc(Ns_8602,pkCli_8568) in
                                                                    {9533}let m2_8606: bitstring = (OpenSecureChannelResponse,wNs_8605,ST_8603,TTL_8604) in
                                                                    {9534}out(c, (enc(m2_8606,pkCli_8568),sign(h(m2_8606),skSess_8387)));
                                                                    {9535}let Ksrv_8607: bitstring = h((Ns_8602,Nc_8601)) in
                                                                    {9536}out(c, senc(mSrv(pkCli_8568,pkSess_8388),Ksrv_8607))
                                                            )
                                                            else
                                                                {9537}let pkDisco_8608: bitstring = pub(sk(Disco_5903)) in
                                                                {9538}in(c, (=pkCli_8568,em1_8609: bitstring,sigM1_8610: bitstring));
                                                                {9539}let m1_8611: bitstring = dec(em1_8609,skSess_8387) in
                                                                {9540}if (verify(h(m1_8611),sigM1_8610,pkCli_8568) <> true) then
                                                                    0
                                                                else
                                                                    {9541}let (=OpenSecureChannelRequest,=pkCli_8568,wNc_8612: bitstring) = m1_8611 in
                                                                    {9542}let Nc_8613: bitstring = dec(wNc_8612,skSess_8387) in
                                                                    {9543}new Ns_8614: bitstring;
                                                                    {9544}new ST_8615: bitstring;
                                                                    {9545}new TTL_8616: bitstring;
                                                                    {9546}let wNs_8617: bitstring = enc(Ns_8614,pkCli_8568) in
                                                                    {9547}let m2_8618: bitstring = (OpenSecureChannelResponse,wNs_8617,ST_8615,TTL_8616) in
                                                                    {9548}out(c, (enc(m2_8618,pkCli_8568),sign(h(m2_8618),skSess_8387)));
                                                                    {9549}let Ksrv_8619: bitstring = h((Ns_8614,Nc_8613)) in
                                                                    {9550}out(c, senc(mSrv(pkCli_8568,pkSess_8388),Ksrv_8619))
                                                        )
                                                        else
                                                            {9551}let pkDisco_8620: bitstring = fail-any in
                                                            {9552}in(c, (=pkCli_8568,em1_8621: bitstring,sigM1_8622: bitstring));
                                                            {9553}let m1_8623: bitstring = dec(em1_8621,skSess_8387) in
                                                            {9554}if (verify(h(m1_8623),sigM1_8622,pkCli_8568) <> true) then
                                                                0
                                                            else
                                                                {9555}let (=OpenSecureChannelRequest,=pkCli_8568,wNc_8624: bitstring) = m1_8623 in
                                                                {9556}let Nc_8625: bitstring = dec(wNc_8624,skSess_8387) in
                                                                {9557}new Ns_8626: bitstring;
                                                                {9558}new ST_8627: bitstring;
                                                                {9559}new TTL_8628: bitstring;
                                                                {9560}let wNs_8629: bitstring = enc(Ns_8626,pkCli_8568) in
                                                                {9561}let m2_8630: bitstring = (OpenSecureChannelResponse,wNs_8629,ST_8627,TTL_8628) in
                                                                {9562}out(c, (enc(m2_8630,pkCli_8568),sign(h(m2_8630),skSess_8387)));
                                                                {9563}let Ksrv_8631: bitstring = h((Ns_8626,Nc_8625)) in
                                                                {9564}out(c, senc(mSrv(pkCli_8568,pkSess_8388),Ksrv_8631))
                                                )
                                                else
                                                    {9565}let pkDisco_8632: bitstring = fail-any in
                                                    {9566}in(c, (=pkCli_8568,em1_8633: bitstring,sigM1_8634: bitstring));
                                                    {9567}let m1_8635: bitstring = dec(em1_8633,skSess_8387) in
                                                    {9568}if (verify(h(m1_8635),sigM1_8634,pkCli_8568) <> true) then
                                                        0
                                                    else
                                                        {9569}let (=OpenSecureChannelRequest,=pkCli_8568,wNc_8636: bitstring) = m1_8635 in
                                                        {9570}let Nc_8637: bitstring = dec(wNc_8636,skSess_8387) in
                                                        {9571}new Ns_8638: bitstring;
                                                        {9572}new ST_8639: bitstring;
                                                        {9573}new TTL_8640: bitstring;
                                                        {9574}let wNs_8641: bitstring = enc(Ns_8638,pkCli_8568) in
                                                        {9575}let m2_8642: bitstring = (OpenSecureChannelResponse,wNs_8641,ST_8639,TTL_8640) in
                                                        {9576}out(c, (enc(m2_8642,pkCli_8568),sign(h(m2_8642),skSess_8387)));
                                                        {9577}let Ksrv_8643: bitstring = h((Ns_8638,Nc_8637)) in
                                                        {9578}out(c, senc(mSrv(pkCli_8568,pkSess_8388),Ksrv_8643))
                                        )
                                        else
                                            {9579}let pkDisco_8644: bitstring = fail-any in
                                            {9580}in(c, (=pkCli_8568,em1_8645: bitstring,sigM1_8646: bitstring));
                                            {9581}let m1_8647: bitstring = dec(em1_8645,skSess_8387) in
                                            {9582}if (verify(h(m1_8647),sigM1_8646,pkCli_8568) <> true) then
                                                0
                                            else
                                                {9583}let (=OpenSecureChannelRequest,=pkCli_8568,wNc_8648: bitstring) = m1_8647 in
                                                {9584}let Nc_8649: bitstring = dec(wNc_8648,skSess_8387) in
                                                {9585}new Ns_8650: bitstring;
                                                {9586}new ST_8651: bitstring;
                                                {9587}new TTL_8652: bitstring;
                                                {9588}let wNs_8653: bitstring = enc(Ns_8650,pkCli_8568) in
                                                {9589}let m2_8654: bitstring = (OpenSecureChannelResponse,wNs_8653,ST_8651,TTL_8652) in
                                                {9590}out(c, (enc(m2_8654,pkCli_8568),sign(h(m2_8654),skSess_8387)));
                                                {9591}let Ksrv_8655: bitstring = h((Ns_8650,Nc_8649)) in
                                                {9592}out(c, senc(mSrv(pkCli_8568,pkSess_8388),Ksrv_8655))
                                    )
                                    else
                                        {9593}let pkCli_8656: bitstring = pub(sk(Cli_5902)) in
                                        {9594}let v_8657: bool = (Disco_5903 = A) in
                                        (
                                            {9595}if v_8657 then
                                            (
                                                {9596}let pkDisco_8658: bitstring = pub(skA) in
                                                {9597}in(c, (=pkCli_8656,em1_8659: bitstring,sigM1_8660: bitstring));
                                                {9598}let m1_8661: bitstring = dec(em1_8659,skSess_8387) in
                                                {9599}if (verify(h(m1_8661),sigM1_8660,pkCli_8656) <> true) then
                                                    0
                                                else
                                                    {9600}let (=OpenSecureChannelRequest,=pkCli_8656,wNc_8662: bitstring) = m1_8661 in
                                                    {9601}let Nc_8663: bitstring = dec(wNc_8662,skSess_8387) in
                                                    {9602}new Ns_8664: bitstring;
                                                    {9603}new ST_8665: bitstring;
                                                    {9604}new TTL_8666: bitstring;
                                                    {9605}let wNs_8667: bitstring = enc(Ns_8664,pkCli_8656) in
                                                    {9606}let m2_8668: bitstring = (OpenSecureChannelResponse,wNs_8667,ST_8665,TTL_8666) in
                                                    {9607}out(c, (enc(m2_8668,pkCli_8656),sign(h(m2_8668),skSess_8387)));
                                                    {9608}let Ksrv_8669: bitstring = h((Ns_8664,Nc_8663)) in
                                                    {9609}out(c, senc(mSrv(pkCli_8656,pkSess_8388),Ksrv_8669))
                                            )
                                            else
                                                {9610}let v_8670: bool = (Disco_5903 = B) in
                                                (
                                                    {9611}if v_8670 then
                                                    (
                                                        {9612}let pkDisco_8671: bitstring = pub(skB) in
                                                        {9613}in(c, (=pkCli_8656,em1_8672: bitstring,sigM1_8673: bitstring));
                                                        {9614}let m1_8674: bitstring = dec(em1_8672,skSess_8387) in
                                                        {9615}if (verify(h(m1_8674),sigM1_8673,pkCli_8656) <> true) then
                                                            0
                                                        else
                                                            {9616}let (=OpenSecureChannelRequest,=pkCli_8656,wNc_8675: bitstring) = m1_8674 in
                                                            {9617}let Nc_8676: bitstring = dec(wNc_8675,skSess_8387) in
                                                            {9618}new Ns_8677: bitstring;
                                                            {9619}new ST_8678: bitstring;
                                                            {9620}new TTL_8679: bitstring;
                                                            {9621}let wNs_8680: bitstring = enc(Ns_8677,pkCli_8656) in
                                                            {9622}let m2_8681: bitstring = (OpenSecureChannelResponse,wNs_8680,ST_8678,TTL_8679) in
                                                            {9623}out(c, (enc(m2_8681,pkCli_8656),sign(h(m2_8681),skSess_8387)));
                                                            {9624}let Ksrv_8682: bitstring = h((Ns_8677,Nc_8676)) in
                                                            {9625}out(c, senc(mSrv(pkCli_8656,pkSess_8388),Ksrv_8682))
                                                    )
                                                    else
                                                        {9626}let v_8683: bool = (Disco_5903 = C) in
                                                        (
                                                            {9627}if v_8683 then
                                                            (
                                                                {9628}let pkDisco_8684: bitstring = pub(skC) in
                                                                {9629}in(c, (=pkCli_8656,em1_8685: bitstring,sigM1_8686: bitstring));
                                                                {9630}let m1_8687: bitstring = dec(em1_8685,skSess_8387) in
                                                                {9631}if (verify(h(m1_8687),sigM1_8686,pkCli_8656) <> true) then
                                                                    0
                                                                else
                                                                    {9632}let (=OpenSecureChannelRequest,=pkCli_8656,wNc_8688: bitstring) = m1_8687 in
                                                                    {9633}let Nc_8689: bitstring = dec(wNc_8688,skSess_8387) in
                                                                    {9634}new Ns_8690: bitstring;
                                                                    {9635}new ST_8691: bitstring;
                                                                    {9636}new TTL_8692: bitstring;
                                                                    {9637}let wNs_8693: bitstring = enc(Ns_8690,pkCli_8656) in
                                                                    {9638}let m2_8694: bitstring = (OpenSecureChannelResponse,wNs_8693,ST_8691,TTL_8692) in
                                                                    {9639}out(c, (enc(m2_8694,pkCli_8656),sign(h(m2_8694),skSess_8387)));
                                                                    {9640}let Ksrv_8695: bitstring = h((Ns_8690,Nc_8689)) in
                                                                    {9641}out(c, senc(mSrv(pkCli_8656,pkSess_8388),Ksrv_8695))
                                                            )
                                                            else
                                                                {9642}let pkDisco_8696: bitstring = pub(sk(Disco_5903)) in
                                                                {9643}in(c, (=pkCli_8656,em1_8697: bitstring,sigM1_8698: bitstring));
                                                                {9644}let m1_8699: bitstring = dec(em1_8697,skSess_8387) in
                                                                {9645}if (verify(h(m1_8699),sigM1_8698,pkCli_8656) <> true) then
                                                                    0
                                                                else
                                                                    {9646}let (=OpenSecureChannelRequest,=pkCli_8656,wNc_8700: bitstring) = m1_8699 in
                                                                    {9647}let Nc_8701: bitstring = dec(wNc_8700,skSess_8387) in
                                                                    {9648}new Ns_8702: bitstring;
                                                                    {9649}new ST_8703: bitstring;
                                                                    {9650}new TTL_8704: bitstring;
                                                                    {9651}let wNs_8705: bitstring = enc(Ns_8702,pkCli_8656) in
                                                                    {9652}let m2_8706: bitstring = (OpenSecureChannelResponse,wNs_8705,ST_8703,TTL_8704) in
                                                                    {9653}out(c, (enc(m2_8706,pkCli_8656),sign(h(m2_8706),skSess_8387)));
                                                                    {9654}let Ksrv_8707: bitstring = h((Ns_8702,Nc_8701)) in
                                                                    {9655}out(c, senc(mSrv(pkCli_8656,pkSess_8388),Ksrv_8707))
                                                        )
                                                        else
                                                            {9656}let pkDisco_8708: bitstring = fail-any in
                                                            {9657}in(c, (=pkCli_8656,em1_8709: bitstring,sigM1_8710: bitstring));
                                                            {9658}let m1_8711: bitstring = dec(em1_8709,skSess_8387) in
                                                            {9659}if (verify(h(m1_8711),sigM1_8710,pkCli_8656) <> true) then
                                                                0
                                                            else
                                                                {9660}let (=OpenSecureChannelRequest,=pkCli_8656,wNc_8712: bitstring) = m1_8711 in
                                                                {9661}let Nc_8713: bitstring = dec(wNc_8712,skSess_8387) in
                                                                {9662}new Ns_8714: bitstring;
                                                                {9663}new ST_8715: bitstring;
                                                                {9664}new TTL_8716: bitstring;
                                                                {9665}let wNs_8717: bitstring = enc(Ns_8714,pkCli_8656) in
                                                                {9666}let m2_8718: bitstring = (OpenSecureChannelResponse,wNs_8717,ST_8715,TTL_8716) in
                                                                {9667}out(c, (enc(m2_8718,pkCli_8656),sign(h(m2_8718),skSess_8387)));
                                                                {9668}let Ksrv_8719: bitstring = h((Ns_8714,Nc_8713)) in
                                                                {9669}out(c, senc(mSrv(pkCli_8656,pkSess_8388),Ksrv_8719))
                                                )
                                                else
                                                    {9670}let pkDisco_8720: bitstring = fail-any in
                                                    {9671}in(c, (=pkCli_8656,em1_8721: bitstring,sigM1_8722: bitstring));
                                                    {9672}let m1_8723: bitstring = dec(em1_8721,skSess_8387) in
                                                    {9673}if (verify(h(m1_8723),sigM1_8722,pkCli_8656) <> true) then
                                                        0
                                                    else
                                                        {9674}let (=OpenSecureChannelRequest,=pkCli_8656,wNc_8724: bitstring) = m1_8723 in
                                                        {9675}let Nc_8725: bitstring = dec(wNc_8724,skSess_8387) in
                                                        {9676}new Ns_8726: bitstring;
                                                        {9677}new ST_8727: bitstring;
                                                        {9678}new TTL_8728: bitstring;
                                                        {9679}let wNs_8729: bitstring = enc(Ns_8726,pkCli_8656) in
                                                        {9680}let m2_8730: bitstring = (OpenSecureChannelResponse,wNs_8729,ST_8727,TTL_8728) in
                                                        {9681}out(c, (enc(m2_8730,pkCli_8656),sign(h(m2_8730),skSess_8387)));
                                                        {9682}let Ksrv_8731: bitstring = h((Ns_8726,Nc_8725)) in
                                                        {9683}out(c, senc(mSrv(pkCli_8656,pkSess_8388),Ksrv_8731))
                                        )
                                        else
                                            {9684}let pkDisco_8732: bitstring = fail-any in
                                            {9685}in(c, (=pkCli_8656,em1_8733: bitstring,sigM1_8734: bitstring));
                                            {9686}let m1_8735: bitstring = dec(em1_8733,skSess_8387) in
                                            {9687}if (verify(h(m1_8735),sigM1_8734,pkCli_8656) <> true) then
                                                0
                                            else
                                                {9688}let (=OpenSecureChannelRequest,=pkCli_8656,wNc_8736: bitstring) = m1_8735 in
                                                {9689}let Nc_8737: bitstring = dec(wNc_8736,skSess_8387) in
                                                {9690}new Ns_8738: bitstring;
                                                {9691}new ST_8739: bitstring;
                                                {9692}new TTL_8740: bitstring;
                                                {9693}let wNs_8741: bitstring = enc(Ns_8738,pkCli_8656) in
                                                {9694}let m2_8742: bitstring = (OpenSecureChannelResponse,wNs_8741,ST_8739,TTL_8740) in
                                                {9695}out(c, (enc(m2_8742,pkCli_8656),sign(h(m2_8742),skSess_8387)));
                                                {9696}let Ksrv_8743: bitstring = h((Ns_8738,Nc_8737)) in
                                                {9697}out(c, senc(mSrv(pkCli_8656,pkSess_8388),Ksrv_8743))
                                )
                                else
                                    {9698}let pkCli_8744: bitstring = fail-any in
                                    {9699}let v_8745: bool = (Disco_5903 = A) in
                                    (
                                        {9700}if v_8745 then
                                        (
                                            {9701}let pkDisco_8746: bitstring = pub(skA) in
                                            {9702}in(c, (=pkCli_8744,em1_8747: bitstring,sigM1_8748: bitstring));
                                            {9703}let m1_8749: bitstring = dec(em1_8747,skSess_8387) in
                                            {9704}if (verify(h(m1_8749),sigM1_8748,pkCli_8744) <> true) then
                                                0
                                            else
                                                {9705}let (=OpenSecureChannelRequest,=pkCli_8744,wNc_8750: bitstring) = m1_8749 in
                                                {9706}let Nc_8751: bitstring = dec(wNc_8750,skSess_8387) in
                                                {9707}new Ns_8752: bitstring;
                                                {9708}new ST_8753: bitstring;
                                                {9709}new TTL_8754: bitstring;
                                                {9710}let wNs_8755: bitstring = enc(Ns_8752,pkCli_8744) in
                                                {9711}let m2_8756: bitstring = (OpenSecureChannelResponse,wNs_8755,ST_8753,TTL_8754) in
                                                {9712}out(c, (enc(m2_8756,pkCli_8744),sign(h(m2_8756),skSess_8387)));
                                                {9713}let Ksrv_8757: bitstring = h((Ns_8752,Nc_8751)) in
                                                {9714}out(c, senc(mSrv(pkCli_8744,pkSess_8388),Ksrv_8757))
                                        )
                                        else
                                            {9715}let v_8758: bool = (Disco_5903 = B) in
                                            (
                                                {9716}if v_8758 then
                                                (
                                                    {9717}let pkDisco_8759: bitstring = pub(skB) in
                                                    {9718}in(c, (=pkCli_8744,em1_8760: bitstring,sigM1_8761: bitstring));
                                                    {9719}let m1_8762: bitstring = dec(em1_8760,skSess_8387) in
                                                    {9720}if (verify(h(m1_8762),sigM1_8761,pkCli_8744) <> true) then
                                                        0
                                                    else
                                                        {9721}let (=OpenSecureChannelRequest,=pkCli_8744,wNc_8763: bitstring) = m1_8762 in
                                                        {9722}let Nc_8764: bitstring = dec(wNc_8763,skSess_8387) in
                                                        {9723}new Ns_8765: bitstring;
                                                        {9724}new ST_8766: bitstring;
                                                        {9725}new TTL_8767: bitstring;
                                                        {9726}let wNs_8768: bitstring = enc(Ns_8765,pkCli_8744) in
                                                        {9727}let m2_8769: bitstring = (OpenSecureChannelResponse,wNs_8768,ST_8766,TTL_8767) in
                                                        {9728}out(c, (enc(m2_8769,pkCli_8744),sign(h(m2_8769),skSess_8387)));
                                                        {9729}let Ksrv_8770: bitstring = h((Ns_8765,Nc_8764)) in
                                                        {9730}out(c, senc(mSrv(pkCli_8744,pkSess_8388),Ksrv_8770))
                                                )
                                                else
                                                    {9731}let v_8771: bool = (Disco_5903 = C) in
                                                    (
                                                        {9732}if v_8771 then
                                                        (
                                                            {9733}let pkDisco_8772: bitstring = pub(skC) in
                                                            {9734}in(c, (=pkCli_8744,em1_8773: bitstring,sigM1_8774: bitstring));
                                                            {9735}let m1_8775: bitstring = dec(em1_8773,skSess_8387) in
                                                            {9736}if (verify(h(m1_8775),sigM1_8774,pkCli_8744) <> true) then
                                                                0
                                                            else
                                                                {9737}let (=OpenSecureChannelRequest,=pkCli_8744,wNc_8776: bitstring) = m1_8775 in
                                                                {9738}let Nc_8777: bitstring = dec(wNc_8776,skSess_8387) in
                                                                {9739}new Ns_8778: bitstring;
                                                                {9740}new ST_8779: bitstring;
                                                                {9741}new TTL_8780: bitstring;
                                                                {9742}let wNs_8781: bitstring = enc(Ns_8778,pkCli_8744) in
                                                                {9743}let m2_8782: bitstring = (OpenSecureChannelResponse,wNs_8781,ST_8779,TTL_8780) in
                                                                {9744}out(c, (enc(m2_8782,pkCli_8744),sign(h(m2_8782),skSess_8387)));
                                                                {9745}let Ksrv_8783: bitstring = h((Ns_8778,Nc_8777)) in
                                                                {9746}out(c, senc(mSrv(pkCli_8744,pkSess_8388),Ksrv_8783))
                                                        )
                                                        else
                                                            {9747}let pkDisco_8784: bitstring = pub(sk(Disco_5903)) in
                                                            {9748}in(c, (=pkCli_8744,em1_8785: bitstring,sigM1_8786: bitstring));
                                                            {9749}let m1_8787: bitstring = dec(em1_8785,skSess_8387) in
                                                            {9750}if (verify(h(m1_8787),sigM1_8786,pkCli_8744) <> true) then
                                                                0
                                                            else
                                                                {9751}let (=OpenSecureChannelRequest,=pkCli_8744,wNc_8788: bitstring) = m1_8787 in
                                                                {9752}let Nc_8789: bitstring = dec(wNc_8788,skSess_8387) in
                                                                {9753}new Ns_8790: bitstring;
                                                                {9754}new ST_8791: bitstring;
                                                                {9755}new TTL_8792: bitstring;
                                                                {9756}let wNs_8793: bitstring = enc(Ns_8790,pkCli_8744) in
                                                                {9757}let m2_8794: bitstring = (OpenSecureChannelResponse,wNs_8793,ST_8791,TTL_8792) in
                                                                {9758}out(c, (enc(m2_8794,pkCli_8744),sign(h(m2_8794),skSess_8387)));
                                                                {9759}let Ksrv_8795: bitstring = h((Ns_8790,Nc_8789)) in
                                                                {9760}out(c, senc(mSrv(pkCli_8744,pkSess_8388),Ksrv_8795))
                                                    )
                                                    else
                                                        {9761}let pkDisco_8796: bitstring = fail-any in
                                                        {9762}in(c, (=pkCli_8744,em1_8797: bitstring,sigM1_8798: bitstring));
                                                        {9763}let m1_8799: bitstring = dec(em1_8797,skSess_8387) in
                                                        {9764}if (verify(h(m1_8799),sigM1_8798,pkCli_8744) <> true) then
                                                            0
                                                        else
                                                            {9765}let (=OpenSecureChannelRequest,=pkCli_8744,wNc_8800: bitstring) = m1_8799 in
                                                            {9766}let Nc_8801: bitstring = dec(wNc_8800,skSess_8387) in
                                                            {9767}new Ns_8802: bitstring;
                                                            {9768}new ST_8803: bitstring;
                                                            {9769}new TTL_8804: bitstring;
                                                            {9770}let wNs_8805: bitstring = enc(Ns_8802,pkCli_8744) in
                                                            {9771}let m2_8806: bitstring = (OpenSecureChannelResponse,wNs_8805,ST_8803,TTL_8804) in
                                                            {9772}out(c, (enc(m2_8806,pkCli_8744),sign(h(m2_8806),skSess_8387)));
                                                            {9773}let Ksrv_8807: bitstring = h((Ns_8802,Nc_8801)) in
                                                            {9774}out(c, senc(mSrv(pkCli_8744,pkSess_8388),Ksrv_8807))
                                            )
                                            else
                                                {9775}let pkDisco_8808: bitstring = fail-any in
                                                {9776}in(c, (=pkCli_8744,em1_8809: bitstring,sigM1_8810: bitstring));
                                                {9777}let m1_8811: bitstring = dec(em1_8809,skSess_8387) in
                                                {9778}if (verify(h(m1_8811),sigM1_8810,pkCli_8744) <> true) then
                                                    0
                                                else
                                                    {9779}let (=OpenSecureChannelRequest,=pkCli_8744,wNc_8812: bitstring) = m1_8811 in
                                                    {9780}let Nc_8813: bitstring = dec(wNc_8812,skSess_8387) in
                                                    {9781}new Ns_8814: bitstring;
                                                    {9782}new ST_8815: bitstring;
                                                    {9783}new TTL_8816: bitstring;
                                                    {9784}let wNs_8817: bitstring = enc(Ns_8814,pkCli_8744) in
                                                    {9785}let m2_8818: bitstring = (OpenSecureChannelResponse,wNs_8817,ST_8815,TTL_8816) in
                                                    {9786}out(c, (enc(m2_8818,pkCli_8744),sign(h(m2_8818),skSess_8387)));
                                                    {9787}let Ksrv_8819: bitstring = h((Ns_8814,Nc_8813)) in
                                                    {9788}out(c, senc(mSrv(pkCli_8744,pkSess_8388),Ksrv_8819))
                                    )
                                    else
                                        {9789}let pkDisco_8820: bitstring = fail-any in
                                        {9790}in(c, (=pkCli_8744,em1_8821: bitstring,sigM1_8822: bitstring));
                                        {9791}let m1_8823: bitstring = dec(em1_8821,skSess_8387) in
                                        {9792}if (verify(h(m1_8823),sigM1_8822,pkCli_8744) <> true) then
                                            0
                                        else
                                            {9793}let (=OpenSecureChannelRequest,=pkCli_8744,wNc_8824: bitstring) = m1_8823 in
                                            {9794}let Nc_8825: bitstring = dec(wNc_8824,skSess_8387) in
                                            {9795}new Ns_8826: bitstring;
                                            {9796}new ST_8827: bitstring;
                                            {9797}new TTL_8828: bitstring;
                                            {9798}let wNs_8829: bitstring = enc(Ns_8826,pkCli_8744) in
                                            {9799}let m2_8830: bitstring = (OpenSecureChannelResponse,wNs_8829,ST_8827,TTL_8828) in
                                            {9800}out(c, (enc(m2_8830,pkCli_8744),sign(h(m2_8830),skSess_8387)));
                                            {9801}let Ksrv_8831: bitstring = h((Ns_8826,Nc_8825)) in
                                            {9802}out(c, senc(mSrv(pkCli_8744,pkSess_8388),Ksrv_8831))
                        )
                        else
                            {9803}let pkCli_8832: bitstring = fail-any in
                            {9804}let v_8833: bool = (Disco_5903 = A) in
                            (
                                {9805}if v_8833 then
                                (
                                    {9806}let pkDisco_8834: bitstring = pub(skA) in
                                    {9807}in(c, (=pkCli_8832,em1_8835: bitstring,sigM1_8836: bitstring));
                                    {9808}let m1_8837: bitstring = dec(em1_8835,skSess_8387) in
                                    {9809}if (verify(h(m1_8837),sigM1_8836,pkCli_8832) <> true) then
                                        0
                                    else
                                        {9810}let (=OpenSecureChannelRequest,=pkCli_8832,wNc_8838: bitstring) = m1_8837 in
                                        {9811}let Nc_8839: bitstring = dec(wNc_8838,skSess_8387) in
                                        {9812}new Ns_8840: bitstring;
                                        {9813}new ST_8841: bitstring;
                                        {9814}new TTL_8842: bitstring;
                                        {9815}let wNs_8843: bitstring = enc(Ns_8840,pkCli_8832) in
                                        {9816}let m2_8844: bitstring = (OpenSecureChannelResponse,wNs_8843,ST_8841,TTL_8842) in
                                        {9817}out(c, (enc(m2_8844,pkCli_8832),sign(h(m2_8844),skSess_8387)));
                                        {9818}let Ksrv_8845: bitstring = h((Ns_8840,Nc_8839)) in
                                        {9819}out(c, senc(mSrv(pkCli_8832,pkSess_8388),Ksrv_8845))
                                )
                                else
                                    {9820}let v_8846: bool = (Disco_5903 = B) in
                                    (
                                        {9821}if v_8846 then
                                        (
                                            {9822}let pkDisco_8847: bitstring = pub(skB) in
                                            {9823}in(c, (=pkCli_8832,em1_8848: bitstring,sigM1_8849: bitstring));
                                            {9824}let m1_8850: bitstring = dec(em1_8848,skSess_8387) in
                                            {9825}if (verify(h(m1_8850),sigM1_8849,pkCli_8832) <> true) then
                                                0
                                            else
                                                {9826}let (=OpenSecureChannelRequest,=pkCli_8832,wNc_8851: bitstring) = m1_8850 in
                                                {9827}let Nc_8852: bitstring = dec(wNc_8851,skSess_8387) in
                                                {9828}new Ns_8853: bitstring;
                                                {9829}new ST_8854: bitstring;
                                                {9830}new TTL_8855: bitstring;
                                                {9831}let wNs_8856: bitstring = enc(Ns_8853,pkCli_8832) in
                                                {9832}let m2_8857: bitstring = (OpenSecureChannelResponse,wNs_8856,ST_8854,TTL_8855) in
                                                {9833}out(c, (enc(m2_8857,pkCli_8832),sign(h(m2_8857),skSess_8387)));
                                                {9834}let Ksrv_8858: bitstring = h((Ns_8853,Nc_8852)) in
                                                {9835}out(c, senc(mSrv(pkCli_8832,pkSess_8388),Ksrv_8858))
                                        )
                                        else
                                            {9836}let v_8859: bool = (Disco_5903 = C) in
                                            (
                                                {9837}if v_8859 then
                                                (
                                                    {9838}let pkDisco_8860: bitstring = pub(skC) in
                                                    {9839}in(c, (=pkCli_8832,em1_8861: bitstring,sigM1_8862: bitstring));
                                                    {9840}let m1_8863: bitstring = dec(em1_8861,skSess_8387) in
                                                    {9841}if (verify(h(m1_8863),sigM1_8862,pkCli_8832) <> true) then
                                                        0
                                                    else
                                                        {9842}let (=OpenSecureChannelRequest,=pkCli_8832,wNc_8864: bitstring) = m1_8863 in
                                                        {9843}let Nc_8865: bitstring = dec(wNc_8864,skSess_8387) in
                                                        {9844}new Ns_8866: bitstring;
                                                        {9845}new ST_8867: bitstring;
                                                        {9846}new TTL_8868: bitstring;
                                                        {9847}let wNs_8869: bitstring = enc(Ns_8866,pkCli_8832) in
                                                        {9848}let m2_8870: bitstring = (OpenSecureChannelResponse,wNs_8869,ST_8867,TTL_8868) in
                                                        {9849}out(c, (enc(m2_8870,pkCli_8832),sign(h(m2_8870),skSess_8387)));
                                                        {9850}let Ksrv_8871: bitstring = h((Ns_8866,Nc_8865)) in
                                                        {9851}out(c, senc(mSrv(pkCli_8832,pkSess_8388),Ksrv_8871))
                                                )
                                                else
                                                    {9852}let pkDisco_8872: bitstring = pub(sk(Disco_5903)) in
                                                    {9853}in(c, (=pkCli_8832,em1_8873: bitstring,sigM1_8874: bitstring));
                                                    {9854}let m1_8875: bitstring = dec(em1_8873,skSess_8387) in
                                                    {9855}if (verify(h(m1_8875),sigM1_8874,pkCli_8832) <> true) then
                                                        0
                                                    else
                                                        {9856}let (=OpenSecureChannelRequest,=pkCli_8832,wNc_8876: bitstring) = m1_8875 in
                                                        {9857}let Nc_8877: bitstring = dec(wNc_8876,skSess_8387) in
                                                        {9858}new Ns_8878: bitstring;
                                                        {9859}new ST_8879: bitstring;
                                                        {9860}new TTL_8880: bitstring;
                                                        {9861}let wNs_8881: bitstring = enc(Ns_8878,pkCli_8832) in
                                                        {9862}let m2_8882: bitstring = (OpenSecureChannelResponse,wNs_8881,ST_8879,TTL_8880) in
                                                        {9863}out(c, (enc(m2_8882,pkCli_8832),sign(h(m2_8882),skSess_8387)));
                                                        {9864}let Ksrv_8883: bitstring = h((Ns_8878,Nc_8877)) in
                                                        {9865}out(c, senc(mSrv(pkCli_8832,pkSess_8388),Ksrv_8883))
                                            )
                                            else
                                                {9866}let pkDisco_8884: bitstring = fail-any in
                                                {9867}in(c, (=pkCli_8832,em1_8885: bitstring,sigM1_8886: bitstring));
                                                {9868}let m1_8887: bitstring = dec(em1_8885,skSess_8387) in
                                                {9869}if (verify(h(m1_8887),sigM1_8886,pkCli_8832) <> true) then
                                                    0
                                                else
                                                    {9870}let (=OpenSecureChannelRequest,=pkCli_8832,wNc_8888: bitstring) = m1_8887 in
                                                    {9871}let Nc_8889: bitstring = dec(wNc_8888,skSess_8387) in
                                                    {9872}new Ns_8890: bitstring;
                                                    {9873}new ST_8891: bitstring;
                                                    {9874}new TTL_8892: bitstring;
                                                    {9875}let wNs_8893: bitstring = enc(Ns_8890,pkCli_8832) in
                                                    {9876}let m2_8894: bitstring = (OpenSecureChannelResponse,wNs_8893,ST_8891,TTL_8892) in
                                                    {9877}out(c, (enc(m2_8894,pkCli_8832),sign(h(m2_8894),skSess_8387)));
                                                    {9878}let Ksrv_8895: bitstring = h((Ns_8890,Nc_8889)) in
                                                    {9879}out(c, senc(mSrv(pkCli_8832,pkSess_8388),Ksrv_8895))
                                    )
                                    else
                                        {9880}let pkDisco_8896: bitstring = fail-any in
                                        {9881}in(c, (=pkCli_8832,em1_8897: bitstring,sigM1_8898: bitstring));
                                        {9882}let m1_8899: bitstring = dec(em1_8897,skSess_8387) in
                                        {9883}if (verify(h(m1_8899),sigM1_8898,pkCli_8832) <> true) then
                                            0
                                        else
                                            {9884}let (=OpenSecureChannelRequest,=pkCli_8832,wNc_8900: bitstring) = m1_8899 in
                                            {9885}let Nc_8901: bitstring = dec(wNc_8900,skSess_8387) in
                                            {9886}new Ns_8902: bitstring;
                                            {9887}new ST_8903: bitstring;
                                            {9888}new TTL_8904: bitstring;
                                            {9889}let wNs_8905: bitstring = enc(Ns_8902,pkCli_8832) in
                                            {9890}let m2_8906: bitstring = (OpenSecureChannelResponse,wNs_8905,ST_8903,TTL_8904) in
                                            {9891}out(c, (enc(m2_8906,pkCli_8832),sign(h(m2_8906),skSess_8387)));
                                            {9892}let Ksrv_8907: bitstring = h((Ns_8902,Nc_8901)) in
                                            {9893}out(c, senc(mSrv(pkCli_8832,pkSess_8388),Ksrv_8907))
                            )
                            else
                                {9894}let pkDisco_8908: bitstring = fail-any in
                                {9895}in(c, (=pkCli_8832,em1_8909: bitstring,sigM1_8910: bitstring));
                                {9896}let m1_8911: bitstring = dec(em1_8909,skSess_8387) in
                                {9897}if (verify(h(m1_8911),sigM1_8910,pkCli_8832) <> true) then
                                    0
                                else
                                    {9898}let (=OpenSecureChannelRequest,=pkCli_8832,wNc_8912: bitstring) = m1_8911 in
                                    {9899}let Nc_8913: bitstring = dec(wNc_8912,skSess_8387) in
                                    {9900}new Ns_8914: bitstring;
                                    {9901}new ST_8915: bitstring;
                                    {9902}new TTL_8916: bitstring;
                                    {9903}let wNs_8917: bitstring = enc(Ns_8914,pkCli_8832) in
                                    {9904}let m2_8918: bitstring = (OpenSecureChannelResponse,wNs_8917,ST_8915,TTL_8916) in
                                    {9905}out(c, (enc(m2_8918,pkCli_8832),sign(h(m2_8918),skSess_8387)));
                                    {9906}let Ksrv_8919: bitstring = h((Ns_8914,Nc_8913)) in
                                    {9907}out(c, senc(mSrv(pkCli_8832,pkSess_8388),Ksrv_8919))
                )
                else
                    {9908}let pkCli_8920: bitstring = fail-any in
                    {9909}let v_8921: bool = (Disco_5903 = A) in
                    (
                        {9910}if v_8921 then
                        (
                            {9911}let pkDisco_8922: bitstring = pub(skA) in
                            {9912}in(c, (=pkCli_8920,em1_8923: bitstring,sigM1_8924: bitstring));
                            {9913}let m1_8925: bitstring = dec(em1_8923,skSess_8387) in
                            {9914}if (verify(h(m1_8925),sigM1_8924,pkCli_8920) <> true) then
                                0
                            else
                                {9915}let (=OpenSecureChannelRequest,=pkCli_8920,wNc_8926: bitstring) = m1_8925 in
                                {9916}let Nc_8927: bitstring = dec(wNc_8926,skSess_8387) in
                                {9917}new Ns_8928: bitstring;
                                {9918}new ST_8929: bitstring;
                                {9919}new TTL_8930: bitstring;
                                {9920}let wNs_8931: bitstring = enc(Ns_8928,pkCli_8920) in
                                {9921}let m2_8932: bitstring = (OpenSecureChannelResponse,wNs_8931,ST_8929,TTL_8930) in
                                {9922}out(c, (enc(m2_8932,pkCli_8920),sign(h(m2_8932),skSess_8387)));
                                {9923}let Ksrv_8933: bitstring = h((Ns_8928,Nc_8927)) in
                                {9924}out(c, senc(mSrv(pkCli_8920,pkSess_8388),Ksrv_8933))
                        )
                        else
                            {9925}let v_8934: bool = (Disco_5903 = B) in
                            (
                                {9926}if v_8934 then
                                (
                                    {9927}let pkDisco_8935: bitstring = pub(skB) in
                                    {9928}in(c, (=pkCli_8920,em1_8936: bitstring,sigM1_8937: bitstring));
                                    {9929}let m1_8938: bitstring = dec(em1_8936,skSess_8387) in
                                    {9930}if (verify(h(m1_8938),sigM1_8937,pkCli_8920) <> true) then
                                        0
                                    else
                                        {9931}let (=OpenSecureChannelRequest,=pkCli_8920,wNc_8939: bitstring) = m1_8938 in
                                        {9932}let Nc_8940: bitstring = dec(wNc_8939,skSess_8387) in
                                        {9933}new Ns_8941: bitstring;
                                        {9934}new ST_8942: bitstring;
                                        {9935}new TTL_8943: bitstring;
                                        {9936}let wNs_8944: bitstring = enc(Ns_8941,pkCli_8920) in
                                        {9937}let m2_8945: bitstring = (OpenSecureChannelResponse,wNs_8944,ST_8942,TTL_8943) in
                                        {9938}out(c, (enc(m2_8945,pkCli_8920),sign(h(m2_8945),skSess_8387)));
                                        {9939}let Ksrv_8946: bitstring = h((Ns_8941,Nc_8940)) in
                                        {9940}out(c, senc(mSrv(pkCli_8920,pkSess_8388),Ksrv_8946))
                                )
                                else
                                    {9941}let v_8947: bool = (Disco_5903 = C) in
                                    (
                                        {9942}if v_8947 then
                                        (
                                            {9943}let pkDisco_8948: bitstring = pub(skC) in
                                            {9944}in(c, (=pkCli_8920,em1_8949: bitstring,sigM1_8950: bitstring));
                                            {9945}let m1_8951: bitstring = dec(em1_8949,skSess_8387) in
                                            {9946}if (verify(h(m1_8951),sigM1_8950,pkCli_8920) <> true) then
                                                0
                                            else
                                                {9947}let (=OpenSecureChannelRequest,=pkCli_8920,wNc_8952: bitstring) = m1_8951 in
                                                {9948}let Nc_8953: bitstring = dec(wNc_8952,skSess_8387) in
                                                {9949}new Ns_8954: bitstring;
                                                {9950}new ST_8955: bitstring;
                                                {9951}new TTL_8956: bitstring;
                                                {9952}let wNs_8957: bitstring = enc(Ns_8954,pkCli_8920) in
                                                {9953}let m2_8958: bitstring = (OpenSecureChannelResponse,wNs_8957,ST_8955,TTL_8956) in
                                                {9954}out(c, (enc(m2_8958,pkCli_8920),sign(h(m2_8958),skSess_8387)));
                                                {9955}let Ksrv_8959: bitstring = h((Ns_8954,Nc_8953)) in
                                                {9956}out(c, senc(mSrv(pkCli_8920,pkSess_8388),Ksrv_8959))
                                        )
                                        else
                                            {9957}let pkDisco_8960: bitstring = pub(sk(Disco_5903)) in
                                            {9958}in(c, (=pkCli_8920,em1_8961: bitstring,sigM1_8962: bitstring));
                                            {9959}let m1_8963: bitstring = dec(em1_8961,skSess_8387) in
                                            {9960}if (verify(h(m1_8963),sigM1_8962,pkCli_8920) <> true) then
                                                0
                                            else
                                                {9961}let (=OpenSecureChannelRequest,=pkCli_8920,wNc_8964: bitstring) = m1_8963 in
                                                {9962}let Nc_8965: bitstring = dec(wNc_8964,skSess_8387) in
                                                {9963}new Ns_8966: bitstring;
                                                {9964}new ST_8967: bitstring;
                                                {9965}new TTL_8968: bitstring;
                                                {9966}let wNs_8969: bitstring = enc(Ns_8966,pkCli_8920) in
                                                {9967}let m2_8970: bitstring = (OpenSecureChannelResponse,wNs_8969,ST_8967,TTL_8968) in
                                                {9968}out(c, (enc(m2_8970,pkCli_8920),sign(h(m2_8970),skSess_8387)));
                                                {9969}let Ksrv_8971: bitstring = h((Ns_8966,Nc_8965)) in
                                                {9970}out(c, senc(mSrv(pkCli_8920,pkSess_8388),Ksrv_8971))
                                    )
                                    else
                                        {9971}let pkDisco_8972: bitstring = fail-any in
                                        {9972}in(c, (=pkCli_8920,em1_8973: bitstring,sigM1_8974: bitstring));
                                        {9973}let m1_8975: bitstring = dec(em1_8973,skSess_8387) in
                                        {9974}if (verify(h(m1_8975),sigM1_8974,pkCli_8920) <> true) then
                                            0
                                        else
                                            {9975}let (=OpenSecureChannelRequest,=pkCli_8920,wNc_8976: bitstring) = m1_8975 in
                                            {9976}let Nc_8977: bitstring = dec(wNc_8976,skSess_8387) in
                                            {9977}new Ns_8978: bitstring;
                                            {9978}new ST_8979: bitstring;
                                            {9979}new TTL_8980: bitstring;
                                            {9980}let wNs_8981: bitstring = enc(Ns_8978,pkCli_8920) in
                                            {9981}let m2_8982: bitstring = (OpenSecureChannelResponse,wNs_8981,ST_8979,TTL_8980) in
                                            {9982}out(c, (enc(m2_8982,pkCli_8920),sign(h(m2_8982),skSess_8387)));
                                            {9983}let Ksrv_8983: bitstring = h((Ns_8978,Nc_8977)) in
                                            {9984}out(c, senc(mSrv(pkCli_8920,pkSess_8388),Ksrv_8983))
                            )
                            else
                                {9985}let pkDisco_8984: bitstring = fail-any in
                                {9986}in(c, (=pkCli_8920,em1_8985: bitstring,sigM1_8986: bitstring));
                                {9987}let m1_8987: bitstring = dec(em1_8985,skSess_8387) in
                                {9988}if (verify(h(m1_8987),sigM1_8986,pkCli_8920) <> true) then
                                    0
                                else
                                    {9989}let (=OpenSecureChannelRequest,=pkCli_8920,wNc_8988: bitstring) = m1_8987 in
                                    {9990}let Nc_8989: bitstring = dec(wNc_8988,skSess_8387) in
                                    {9991}new Ns_8990: bitstring;
                                    {9992}new ST_8991: bitstring;
                                    {9993}new TTL_8992: bitstring;
                                    {9994}let wNs_8993: bitstring = enc(Ns_8990,pkCli_8920) in
                                    {9995}let m2_8994: bitstring = (OpenSecureChannelResponse,wNs_8993,ST_8991,TTL_8992) in
                                    {9996}out(c, (enc(m2_8994,pkCli_8920),sign(h(m2_8994),skSess_8387)));
                                    {9997}let Ksrv_8995: bitstring = h((Ns_8990,Nc_8989)) in
                                    {9998}out(c, senc(mSrv(pkCli_8920,pkSess_8388),Ksrv_8995))
                    )
                    else
                        {9999}let pkDisco_8996: bitstring = fail-any in
                        {10000}in(c, (=pkCli_8920,em1_8997: bitstring,sigM1_8998: bitstring));
                        {10001}let m1_8999: bitstring = dec(em1_8997,skSess_8387) in
                        {10002}if (verify(h(m1_8999),sigM1_8998,pkCli_8920) <> true) then
                            0
                        else
                            {10003}let (=OpenSecureChannelRequest,=pkCli_8920,wNc_9000: bitstring) = m1_8999 in
                            {10004}let Nc_9001: bitstring = dec(wNc_9000,skSess_8387) in
                            {10005}new Ns_9002: bitstring;
                            {10006}new ST_9003: bitstring;
                            {10007}new TTL_9004: bitstring;
                            {10008}let wNs_9005: bitstring = enc(Ns_9002,pkCli_8920) in
                            {10009}let m2_9006: bitstring = (OpenSecureChannelResponse,wNs_9005,ST_9003,TTL_9004) in
                            {10010}out(c, (enc(m2_9006,pkCli_8920),sign(h(m2_9006),skSess_8387)));
                            {10011}let Ksrv_9007: bitstring = h((Ns_9002,Nc_9001)) in
                            {10012}out(c, senc(mSrv(pkCli_8920,pkSess_8388),Ksrv_9007))
    )
    else
        {10013}let skSess_9008: bitstring = fail-any in
        {10014}let pkSess_9009: bitstring = pub(skSess_9008) in
        {10015}let v_9010: bool = (Cli_5902 = A) in
        (
            {10016}if v_9010 then
            (
                {10017}let pkCli_9011: bitstring = pub(skA) in
                {10018}let v_9012: bool = (Disco_5903 = A) in
                (
                    {10019}if v_9012 then
                    (
                        {10020}let pkDisco_9013: bitstring = pub(skA) in
                        {10021}in(c, (=pkCli_9011,em1_9014: bitstring,sigM1_9015: bitstring));
                        {10022}let m1_9016: bitstring = dec(em1_9014,skSess_9008) in
                        {10023}if (verify(h(m1_9016),sigM1_9015,pkCli_9011) <> true) then
                            0
                        else
                            {10024}let (=OpenSecureChannelRequest,=pkCli_9011,wNc_9017: bitstring) = m1_9016 in
                            {10025}let Nc_9018: bitstring = dec(wNc_9017,skSess_9008) in
                            {10026}new Ns_9019: bitstring;
                            {10027}new ST_9020: bitstring;
                            {10028}new TTL_9021: bitstring;
                            {10029}let wNs_9022: bitstring = enc(Ns_9019,pkCli_9011) in
                            {10030}let m2_9023: bitstring = (OpenSecureChannelResponse,wNs_9022,ST_9020,TTL_9021) in
                            {10031}out(c, (enc(m2_9023,pkCli_9011),sign(h(m2_9023),skSess_9008)));
                            {10032}let Ksrv_9024: bitstring = h((Ns_9019,Nc_9018)) in
                            {10033}out(c, senc(mSrv(pkCli_9011,pkSess_9009),Ksrv_9024))
                    )
                    else
                        {10034}let v_9025: bool = (Disco_5903 = B) in
                        (
                            {10035}if v_9025 then
                            (
                                {10036}let pkDisco_9026: bitstring = pub(skB) in
                                {10037}in(c, (=pkCli_9011,em1_9027: bitstring,sigM1_9028: bitstring));
                                {10038}let m1_9029: bitstring = dec(em1_9027,skSess_9008) in
                                {10039}if (verify(h(m1_9029),sigM1_9028,pkCli_9011) <> true) then
                                    0
                                else
                                    {10040}let (=OpenSecureChannelRequest,=pkCli_9011,wNc_9030: bitstring) = m1_9029 in
                                    {10041}let Nc_9031: bitstring = dec(wNc_9030,skSess_9008) in
                                    {10042}new Ns_9032: bitstring;
                                    {10043}new ST_9033: bitstring;
                                    {10044}new TTL_9034: bitstring;
                                    {10045}let wNs_9035: bitstring = enc(Ns_9032,pkCli_9011) in
                                    {10046}let m2_9036: bitstring = (OpenSecureChannelResponse,wNs_9035,ST_9033,TTL_9034) in
                                    {10047}out(c, (enc(m2_9036,pkCli_9011),sign(h(m2_9036),skSess_9008)));
                                    {10048}let Ksrv_9037: bitstring = h((Ns_9032,Nc_9031)) in
                                    {10049}out(c, senc(mSrv(pkCli_9011,pkSess_9009),Ksrv_9037))
                            )
                            else
                                {10050}let v_9038: bool = (Disco_5903 = C) in
                                (
                                    {10051}if v_9038 then
                                    (
                                        {10052}let pkDisco_9039: bitstring = pub(skC) in
                                        {10053}in(c, (=pkCli_9011,em1_9040: bitstring,sigM1_9041: bitstring));
                                        {10054}let m1_9042: bitstring = dec(em1_9040,skSess_9008) in
                                        {10055}if (verify(h(m1_9042),sigM1_9041,pkCli_9011) <> true) then
                                            0
                                        else
                                            {10056}let (=OpenSecureChannelRequest,=pkCli_9011,wNc_9043: bitstring) = m1_9042 in
                                            {10057}let Nc_9044: bitstring = dec(wNc_9043,skSess_9008) in
                                            {10058}new Ns_9045: bitstring;
                                            {10059}new ST_9046: bitstring;
                                            {10060}new TTL_9047: bitstring;
                                            {10061}let wNs_9048: bitstring = enc(Ns_9045,pkCli_9011) in
                                            {10062}let m2_9049: bitstring = (OpenSecureChannelResponse,wNs_9048,ST_9046,TTL_9047) in
                                            {10063}out(c, (enc(m2_9049,pkCli_9011),sign(h(m2_9049),skSess_9008)));
                                            {10064}let Ksrv_9050: bitstring = h((Ns_9045,Nc_9044)) in
                                            {10065}out(c, senc(mSrv(pkCli_9011,pkSess_9009),Ksrv_9050))
                                    )
                                    else
                                        {10066}let pkDisco_9051: bitstring = pub(sk(Disco_5903)) in
                                        {10067}in(c, (=pkCli_9011,em1_9052: bitstring,sigM1_9053: bitstring));
                                        {10068}let m1_9054: bitstring = dec(em1_9052,skSess_9008) in
                                        {10069}if (verify(h(m1_9054),sigM1_9053,pkCli_9011) <> true) then
                                            0
                                        else
                                            {10070}let (=OpenSecureChannelRequest,=pkCli_9011,wNc_9055: bitstring) = m1_9054 in
                                            {10071}let Nc_9056: bitstring = dec(wNc_9055,skSess_9008) in
                                            {10072}new Ns_9057: bitstring;
                                            {10073}new ST_9058: bitstring;
                                            {10074}new TTL_9059: bitstring;
                                            {10075}let wNs_9060: bitstring = enc(Ns_9057,pkCli_9011) in
                                            {10076}let m2_9061: bitstring = (OpenSecureChannelResponse,wNs_9060,ST_9058,TTL_9059) in
                                            {10077}out(c, (enc(m2_9061,pkCli_9011),sign(h(m2_9061),skSess_9008)));
                                            {10078}let Ksrv_9062: bitstring = h((Ns_9057,Nc_9056)) in
                                            {10079}out(c, senc(mSrv(pkCli_9011,pkSess_9009),Ksrv_9062))
                                )
                                else
                                    {10080}let pkDisco_9063: bitstring = fail-any in
                                    {10081}in(c, (=pkCli_9011,em1_9064: bitstring,sigM1_9065: bitstring));
                                    {10082}let m1_9066: bitstring = dec(em1_9064,skSess_9008) in
                                    {10083}if (verify(h(m1_9066),sigM1_9065,pkCli_9011) <> true) then
                                        0
                                    else
                                        {10084}let (=OpenSecureChannelRequest,=pkCli_9011,wNc_9067: bitstring) = m1_9066 in
                                        {10085}let Nc_9068: bitstring = dec(wNc_9067,skSess_9008) in
                                        {10086}new Ns_9069: bitstring;
                                        {10087}new ST_9070: bitstring;
                                        {10088}new TTL_9071: bitstring;
                                        {10089}let wNs_9072: bitstring = enc(Ns_9069,pkCli_9011) in
                                        {10090}let m2_9073: bitstring = (OpenSecureChannelResponse,wNs_9072,ST_9070,TTL_9071) in
                                        {10091}out(c, (enc(m2_9073,pkCli_9011),sign(h(m2_9073),skSess_9008)));
                                        {10092}let Ksrv_9074: bitstring = h((Ns_9069,Nc_9068)) in
                                        {10093}out(c, senc(mSrv(pkCli_9011,pkSess_9009),Ksrv_9074))
                        )
                        else
                            {10094}let pkDisco_9075: bitstring = fail-any in
                            {10095}in(c, (=pkCli_9011,em1_9076: bitstring,sigM1_9077: bitstring));
                            {10096}let m1_9078: bitstring = dec(em1_9076,skSess_9008) in
                            {10097}if (verify(h(m1_9078),sigM1_9077,pkCli_9011) <> true) then
                                0
                            else
                                {10098}let (=OpenSecureChannelRequest,=pkCli_9011,wNc_9079: bitstring) = m1_9078 in
                                {10099}let Nc_9080: bitstring = dec(wNc_9079,skSess_9008) in
                                {10100}new Ns_9081: bitstring;
                                {10101}new ST_9082: bitstring;
                                {10102}new TTL_9083: bitstring;
                                {10103}let wNs_9084: bitstring = enc(Ns_9081,pkCli_9011) in
                                {10104}let m2_9085: bitstring = (OpenSecureChannelResponse,wNs_9084,ST_9082,TTL_9083) in
                                {10105}out(c, (enc(m2_9085,pkCli_9011),sign(h(m2_9085),skSess_9008)));
                                {10106}let Ksrv_9086: bitstring = h((Ns_9081,Nc_9080)) in
                                {10107}out(c, senc(mSrv(pkCli_9011,pkSess_9009),Ksrv_9086))
                )
                else
                    {10108}let pkDisco_9087: bitstring = fail-any in
                    {10109}in(c, (=pkCli_9011,em1_9088: bitstring,sigM1_9089: bitstring));
                    {10110}let m1_9090: bitstring = dec(em1_9088,skSess_9008) in
                    {10111}if (verify(h(m1_9090),sigM1_9089,pkCli_9011) <> true) then
                        0
                    else
                        {10112}let (=OpenSecureChannelRequest,=pkCli_9011,wNc_9091: bitstring) = m1_9090 in
                        {10113}let Nc_9092: bitstring = dec(wNc_9091,skSess_9008) in
                        {10114}new Ns_9093: bitstring;
                        {10115}new ST_9094: bitstring;
                        {10116}new TTL_9095: bitstring;
                        {10117}let wNs_9096: bitstring = enc(Ns_9093,pkCli_9011) in
                        {10118}let m2_9097: bitstring = (OpenSecureChannelResponse,wNs_9096,ST_9094,TTL_9095) in
                        {10119}out(c, (enc(m2_9097,pkCli_9011),sign(h(m2_9097),skSess_9008)));
                        {10120}let Ksrv_9098: bitstring = h((Ns_9093,Nc_9092)) in
                        {10121}out(c, senc(mSrv(pkCli_9011,pkSess_9009),Ksrv_9098))
            )
            else
                {10122}let v_9099: bool = (Cli_5902 = B) in
                (
                    {10123}if v_9099 then
                    (
                        {10124}let pkCli_9100: bitstring = pub(skB) in
                        {10125}let v_9101: bool = (Disco_5903 = A) in
                        (
                            {10126}if v_9101 then
                            (
                                {10127}let pkDisco_9102: bitstring = pub(skA) in
                                {10128}in(c, (=pkCli_9100,em1_9103: bitstring,sigM1_9104: bitstring));
                                {10129}let m1_9105: bitstring = dec(em1_9103,skSess_9008) in
                                {10130}if (verify(h(m1_9105),sigM1_9104,pkCli_9100) <> true) then
                                    0
                                else
                                    {10131}let (=OpenSecureChannelRequest,=pkCli_9100,wNc_9106: bitstring) = m1_9105 in
                                    {10132}let Nc_9107: bitstring = dec(wNc_9106,skSess_9008) in
                                    {10133}new Ns_9108: bitstring;
                                    {10134}new ST_9109: bitstring;
                                    {10135}new TTL_9110: bitstring;
                                    {10136}let wNs_9111: bitstring = enc(Ns_9108,pkCli_9100) in
                                    {10137}let m2_9112: bitstring = (OpenSecureChannelResponse,wNs_9111,ST_9109,TTL_9110) in
                                    {10138}out(c, (enc(m2_9112,pkCli_9100),sign(h(m2_9112),skSess_9008)));
                                    {10139}let Ksrv_9113: bitstring = h((Ns_9108,Nc_9107)) in
                                    {10140}out(c, senc(mSrv(pkCli_9100,pkSess_9009),Ksrv_9113))
                            )
                            else
                                {10141}let v_9114: bool = (Disco_5903 = B) in
                                (
                                    {10142}if v_9114 then
                                    (
                                        {10143}let pkDisco_9115: bitstring = pub(skB) in
                                        {10144}in(c, (=pkCli_9100,em1_9116: bitstring,sigM1_9117: bitstring));
                                        {10145}let m1_9118: bitstring = dec(em1_9116,skSess_9008) in
                                        {10146}if (verify(h(m1_9118),sigM1_9117,pkCli_9100) <> true) then
                                            0
                                        else
                                            {10147}let (=OpenSecureChannelRequest,=pkCli_9100,wNc_9119: bitstring) = m1_9118 in
                                            {10148}let Nc_9120: bitstring = dec(wNc_9119,skSess_9008) in
                                            {10149}new Ns_9121: bitstring;
                                            {10150}new ST_9122: bitstring;
                                            {10151}new TTL_9123: bitstring;
                                            {10152}let wNs_9124: bitstring = enc(Ns_9121,pkCli_9100) in
                                            {10153}let m2_9125: bitstring = (OpenSecureChannelResponse,wNs_9124,ST_9122,TTL_9123) in
                                            {10154}out(c, (enc(m2_9125,pkCli_9100),sign(h(m2_9125),skSess_9008)));
                                            {10155}let Ksrv_9126: bitstring = h((Ns_9121,Nc_9120)) in
                                            {10156}out(c, senc(mSrv(pkCli_9100,pkSess_9009),Ksrv_9126))
                                    )
                                    else
                                        {10157}let v_9127: bool = (Disco_5903 = C) in
                                        (
                                            {10158}if v_9127 then
                                            (
                                                {10159}let pkDisco_9128: bitstring = pub(skC) in
                                                {10160}in(c, (=pkCli_9100,em1_9129: bitstring,sigM1_9130: bitstring));
                                                {10161}let m1_9131: bitstring = dec(em1_9129,skSess_9008) in
                                                {10162}if (verify(h(m1_9131),sigM1_9130,pkCli_9100) <> true) then
                                                    0
                                                else
                                                    {10163}let (=OpenSecureChannelRequest,=pkCli_9100,wNc_9132: bitstring) = m1_9131 in
                                                    {10164}let Nc_9133: bitstring = dec(wNc_9132,skSess_9008) in
                                                    {10165}new Ns_9134: bitstring;
                                                    {10166}new ST_9135: bitstring;
                                                    {10167}new TTL_9136: bitstring;
                                                    {10168}let wNs_9137: bitstring = enc(Ns_9134,pkCli_9100) in
                                                    {10169}let m2_9138: bitstring = (OpenSecureChannelResponse,wNs_9137,ST_9135,TTL_9136) in
                                                    {10170}out(c, (enc(m2_9138,pkCli_9100),sign(h(m2_9138),skSess_9008)));
                                                    {10171}let Ksrv_9139: bitstring = h((Ns_9134,Nc_9133)) in
                                                    {10172}out(c, senc(mSrv(pkCli_9100,pkSess_9009),Ksrv_9139))
                                            )
                                            else
                                                {10173}let pkDisco_9140: bitstring = pub(sk(Disco_5903)) in
                                                {10174}in(c, (=pkCli_9100,em1_9141: bitstring,sigM1_9142: bitstring));
                                                {10175}let m1_9143: bitstring = dec(em1_9141,skSess_9008) in
                                                {10176}if (verify(h(m1_9143),sigM1_9142,pkCli_9100) <> true) then
                                                    0
                                                else
                                                    {10177}let (=OpenSecureChannelRequest,=pkCli_9100,wNc_9144: bitstring) = m1_9143 in
                                                    {10178}let Nc_9145: bitstring = dec(wNc_9144,skSess_9008) in
                                                    {10179}new Ns_9146: bitstring;
                                                    {10180}new ST_9147: bitstring;
                                                    {10181}new TTL_9148: bitstring;
                                                    {10182}let wNs_9149: bitstring = enc(Ns_9146,pkCli_9100) in
                                                    {10183}let m2_9150: bitstring = (OpenSecureChannelResponse,wNs_9149,ST_9147,TTL_9148) in
                                                    {10184}out(c, (enc(m2_9150,pkCli_9100),sign(h(m2_9150),skSess_9008)));
                                                    {10185}let Ksrv_9151: bitstring = h((Ns_9146,Nc_9145)) in
                                                    {10186}out(c, senc(mSrv(pkCli_9100,pkSess_9009),Ksrv_9151))
                                        )
                                        else
                                            {10187}let pkDisco_9152: bitstring = fail-any in
                                            {10188}in(c, (=pkCli_9100,em1_9153: bitstring,sigM1_9154: bitstring));
                                            {10189}let m1_9155: bitstring = dec(em1_9153,skSess_9008) in
                                            {10190}if (verify(h(m1_9155),sigM1_9154,pkCli_9100) <> true) then
                                                0
                                            else
                                                {10191}let (=OpenSecureChannelRequest,=pkCli_9100,wNc_9156: bitstring) = m1_9155 in
                                                {10192}let Nc_9157: bitstring = dec(wNc_9156,skSess_9008) in
                                                {10193}new Ns_9158: bitstring;
                                                {10194}new ST_9159: bitstring;
                                                {10195}new TTL_9160: bitstring;
                                                {10196}let wNs_9161: bitstring = enc(Ns_9158,pkCli_9100) in
                                                {10197}let m2_9162: bitstring = (OpenSecureChannelResponse,wNs_9161,ST_9159,TTL_9160) in
                                                {10198}out(c, (enc(m2_9162,pkCli_9100),sign(h(m2_9162),skSess_9008)));
                                                {10199}let Ksrv_9163: bitstring = h((Ns_9158,Nc_9157)) in
                                                {10200}out(c, senc(mSrv(pkCli_9100,pkSess_9009),Ksrv_9163))
                                )
                                else
                                    {10201}let pkDisco_9164: bitstring = fail-any in
                                    {10202}in(c, (=pkCli_9100,em1_9165: bitstring,sigM1_9166: bitstring));
                                    {10203}let m1_9167: bitstring = dec(em1_9165,skSess_9008) in
                                    {10204}if (verify(h(m1_9167),sigM1_9166,pkCli_9100) <> true) then
                                        0
                                    else
                                        {10205}let (=OpenSecureChannelRequest,=pkCli_9100,wNc_9168: bitstring) = m1_9167 in
                                        {10206}let Nc_9169: bitstring = dec(wNc_9168,skSess_9008) in
                                        {10207}new Ns_9170: bitstring;
                                        {10208}new ST_9171: bitstring;
                                        {10209}new TTL_9172: bitstring;
                                        {10210}let wNs_9173: bitstring = enc(Ns_9170,pkCli_9100) in
                                        {10211}let m2_9174: bitstring = (OpenSecureChannelResponse,wNs_9173,ST_9171,TTL_9172) in
                                        {10212}out(c, (enc(m2_9174,pkCli_9100),sign(h(m2_9174),skSess_9008)));
                                        {10213}let Ksrv_9175: bitstring = h((Ns_9170,Nc_9169)) in
                                        {10214}out(c, senc(mSrv(pkCli_9100,pkSess_9009),Ksrv_9175))
                        )
                        else
                            {10215}let pkDisco_9176: bitstring = fail-any in
                            {10216}in(c, (=pkCli_9100,em1_9177: bitstring,sigM1_9178: bitstring));
                            {10217}let m1_9179: bitstring = dec(em1_9177,skSess_9008) in
                            {10218}if (verify(h(m1_9179),sigM1_9178,pkCli_9100) <> true) then
                                0
                            else
                                {10219}let (=OpenSecureChannelRequest,=pkCli_9100,wNc_9180: bitstring) = m1_9179 in
                                {10220}let Nc_9181: bitstring = dec(wNc_9180,skSess_9008) in
                                {10221}new Ns_9182: bitstring;
                                {10222}new ST_9183: bitstring;
                                {10223}new TTL_9184: bitstring;
                                {10224}let wNs_9185: bitstring = enc(Ns_9182,pkCli_9100) in
                                {10225}let m2_9186: bitstring = (OpenSecureChannelResponse,wNs_9185,ST_9183,TTL_9184) in
                                {10226}out(c, (enc(m2_9186,pkCli_9100),sign(h(m2_9186),skSess_9008)));
                                {10227}let Ksrv_9187: bitstring = h((Ns_9182,Nc_9181)) in
                                {10228}out(c, senc(mSrv(pkCli_9100,pkSess_9009),Ksrv_9187))
                    )
                    else
                        {10229}let v_9188: bool = (Cli_5902 = C) in
                        (
                            {10230}if v_9188 then
                            (
                                {10231}let pkCli_9189: bitstring = pub(skC) in
                                {10232}let v_9190: bool = (Disco_5903 = A) in
                                (
                                    {10233}if v_9190 then
                                    (
                                        {10234}let pkDisco_9191: bitstring = pub(skA) in
                                        {10235}in(c, (=pkCli_9189,em1_9192: bitstring,sigM1_9193: bitstring));
                                        {10236}let m1_9194: bitstring = dec(em1_9192,skSess_9008) in
                                        {10237}if (verify(h(m1_9194),sigM1_9193,pkCli_9189) <> true) then
                                            0
                                        else
                                            {10238}let (=OpenSecureChannelRequest,=pkCli_9189,wNc_9195: bitstring) = m1_9194 in
                                            {10239}let Nc_9196: bitstring = dec(wNc_9195,skSess_9008) in
                                            {10240}new Ns_9197: bitstring;
                                            {10241}new ST_9198: bitstring;
                                            {10242}new TTL_9199: bitstring;
                                            {10243}let wNs_9200: bitstring = enc(Ns_9197,pkCli_9189) in
                                            {10244}let m2_9201: bitstring = (OpenSecureChannelResponse,wNs_9200,ST_9198,TTL_9199) in
                                            {10245}out(c, (enc(m2_9201,pkCli_9189),sign(h(m2_9201),skSess_9008)));
                                            {10246}let Ksrv_9202: bitstring = h((Ns_9197,Nc_9196)) in
                                            {10247}out(c, senc(mSrv(pkCli_9189,pkSess_9009),Ksrv_9202))
                                    )
                                    else
                                        {10248}let v_9203: bool = (Disco_5903 = B) in
                                        (
                                            {10249}if v_9203 then
                                            (
                                                {10250}let pkDisco_9204: bitstring = pub(skB) in
                                                {10251}in(c, (=pkCli_9189,em1_9205: bitstring,sigM1_9206: bitstring));
                                                {10252}let m1_9207: bitstring = dec(em1_9205,skSess_9008) in
                                                {10253}if (verify(h(m1_9207),sigM1_9206,pkCli_9189) <> true) then
                                                    0
                                                else
                                                    {10254}let (=OpenSecureChannelRequest,=pkCli_9189,wNc_9208: bitstring) = m1_9207 in
                                                    {10255}let Nc_9209: bitstring = dec(wNc_9208,skSess_9008) in
                                                    {10256}new Ns_9210: bitstring;
                                                    {10257}new ST_9211: bitstring;
                                                    {10258}new TTL_9212: bitstring;
                                                    {10259}let wNs_9213: bitstring = enc(Ns_9210,pkCli_9189) in
                                                    {10260}let m2_9214: bitstring = (OpenSecureChannelResponse,wNs_9213,ST_9211,TTL_9212) in
                                                    {10261}out(c, (enc(m2_9214,pkCli_9189),sign(h(m2_9214),skSess_9008)));
                                                    {10262}let Ksrv_9215: bitstring = h((Ns_9210,Nc_9209)) in
                                                    {10263}out(c, senc(mSrv(pkCli_9189,pkSess_9009),Ksrv_9215))
                                            )
                                            else
                                                {10264}let v_9216: bool = (Disco_5903 = C) in
                                                (
                                                    {10265}if v_9216 then
                                                    (
                                                        {10266}let pkDisco_9217: bitstring = pub(skC) in
                                                        {10267}in(c, (=pkCli_9189,em1_9218: bitstring,sigM1_9219: bitstring));
                                                        {10268}let m1_9220: bitstring = dec(em1_9218,skSess_9008) in
                                                        {10269}if (verify(h(m1_9220),sigM1_9219,pkCli_9189) <> true) then
                                                            0
                                                        else
                                                            {10270}let (=OpenSecureChannelRequest,=pkCli_9189,wNc_9221: bitstring) = m1_9220 in
                                                            {10271}let Nc_9222: bitstring = dec(wNc_9221,skSess_9008) in
                                                            {10272}new Ns_9223: bitstring;
                                                            {10273}new ST_9224: bitstring;
                                                            {10274}new TTL_9225: bitstring;
                                                            {10275}let wNs_9226: bitstring = enc(Ns_9223,pkCli_9189) in
                                                            {10276}let m2_9227: bitstring = (OpenSecureChannelResponse,wNs_9226,ST_9224,TTL_9225) in
                                                            {10277}out(c, (enc(m2_9227,pkCli_9189),sign(h(m2_9227),skSess_9008)));
                                                            {10278}let Ksrv_9228: bitstring = h((Ns_9223,Nc_9222)) in
                                                            {10279}out(c, senc(mSrv(pkCli_9189,pkSess_9009),Ksrv_9228))
                                                    )
                                                    else
                                                        {10280}let pkDisco_9229: bitstring = pub(sk(Disco_5903)) in
                                                        {10281}in(c, (=pkCli_9189,em1_9230: bitstring,sigM1_9231: bitstring));
                                                        {10282}let m1_9232: bitstring = dec(em1_9230,skSess_9008) in
                                                        {10283}if (verify(h(m1_9232),sigM1_9231,pkCli_9189) <> true) then
                                                            0
                                                        else
                                                            {10284}let (=OpenSecureChannelRequest,=pkCli_9189,wNc_9233: bitstring) = m1_9232 in
                                                            {10285}let Nc_9234: bitstring = dec(wNc_9233,skSess_9008) in
                                                            {10286}new Ns_9235: bitstring;
                                                            {10287}new ST_9236: bitstring;
                                                            {10288}new TTL_9237: bitstring;
                                                            {10289}let wNs_9238: bitstring = enc(Ns_9235,pkCli_9189) in
                                                            {10290}let m2_9239: bitstring = (OpenSecureChannelResponse,wNs_9238,ST_9236,TTL_9237) in
                                                            {10291}out(c, (enc(m2_9239,pkCli_9189),sign(h(m2_9239),skSess_9008)));
                                                            {10292}let Ksrv_9240: bitstring = h((Ns_9235,Nc_9234)) in
                                                            {10293}out(c, senc(mSrv(pkCli_9189,pkSess_9009),Ksrv_9240))
                                                )
                                                else
                                                    {10294}let pkDisco_9241: bitstring = fail-any in
                                                    {10295}in(c, (=pkCli_9189,em1_9242: bitstring,sigM1_9243: bitstring));
                                                    {10296}let m1_9244: bitstring = dec(em1_9242,skSess_9008) in
                                                    {10297}if (verify(h(m1_9244),sigM1_9243,pkCli_9189) <> true) then
                                                        0
                                                    else
                                                        {10298}let (=OpenSecureChannelRequest,=pkCli_9189,wNc_9245: bitstring) = m1_9244 in
                                                        {10299}let Nc_9246: bitstring = dec(wNc_9245,skSess_9008) in
                                                        {10300}new Ns_9247: bitstring;
                                                        {10301}new ST_9248: bitstring;
                                                        {10302}new TTL_9249: bitstring;
                                                        {10303}let wNs_9250: bitstring = enc(Ns_9247,pkCli_9189) in
                                                        {10304}let m2_9251: bitstring = (OpenSecureChannelResponse,wNs_9250,ST_9248,TTL_9249) in
                                                        {10305}out(c, (enc(m2_9251,pkCli_9189),sign(h(m2_9251),skSess_9008)));
                                                        {10306}let Ksrv_9252: bitstring = h((Ns_9247,Nc_9246)) in
                                                        {10307}out(c, senc(mSrv(pkCli_9189,pkSess_9009),Ksrv_9252))
                                        )
                                        else
                                            {10308}let pkDisco_9253: bitstring = fail-any in
                                            {10309}in(c, (=pkCli_9189,em1_9254: bitstring,sigM1_9255: bitstring));
                                            {10310}let m1_9256: bitstring = dec(em1_9254,skSess_9008) in
                                            {10311}if (verify(h(m1_9256),sigM1_9255,pkCli_9189) <> true) then
                                                0
                                            else
                                                {10312}let (=OpenSecureChannelRequest,=pkCli_9189,wNc_9257: bitstring) = m1_9256 in
                                                {10313}let Nc_9258: bitstring = dec(wNc_9257,skSess_9008) in
                                                {10314}new Ns_9259: bitstring;
                                                {10315}new ST_9260: bitstring;
                                                {10316}new TTL_9261: bitstring;
                                                {10317}let wNs_9262: bitstring = enc(Ns_9259,pkCli_9189) in
                                                {10318}let m2_9263: bitstring = (OpenSecureChannelResponse,wNs_9262,ST_9260,TTL_9261) in
                                                {10319}out(c, (enc(m2_9263,pkCli_9189),sign(h(m2_9263),skSess_9008)));
                                                {10320}let Ksrv_9264: bitstring = h((Ns_9259,Nc_9258)) in
                                                {10321}out(c, senc(mSrv(pkCli_9189,pkSess_9009),Ksrv_9264))
                                )
                                else
                                    {10322}let pkDisco_9265: bitstring = fail-any in
                                    {10323}in(c, (=pkCli_9189,em1_9266: bitstring,sigM1_9267: bitstring));
                                    {10324}let m1_9268: bitstring = dec(em1_9266,skSess_9008) in
                                    {10325}if (verify(h(m1_9268),sigM1_9267,pkCli_9189) <> true) then
                                        0
                                    else
                                        {10326}let (=OpenSecureChannelRequest,=pkCli_9189,wNc_9269: bitstring) = m1_9268 in
                                        {10327}let Nc_9270: bitstring = dec(wNc_9269,skSess_9008) in
                                        {10328}new Ns_9271: bitstring;
                                        {10329}new ST_9272: bitstring;
                                        {10330}new TTL_9273: bitstring;
                                        {10331}let wNs_9274: bitstring = enc(Ns_9271,pkCli_9189) in
                                        {10332}let m2_9275: bitstring = (OpenSecureChannelResponse,wNs_9274,ST_9272,TTL_9273) in
                                        {10333}out(c, (enc(m2_9275,pkCli_9189),sign(h(m2_9275),skSess_9008)));
                                        {10334}let Ksrv_9276: bitstring = h((Ns_9271,Nc_9270)) in
                                        {10335}out(c, senc(mSrv(pkCli_9189,pkSess_9009),Ksrv_9276))
                            )
                            else
                                {10336}let pkCli_9277: bitstring = pub(sk(Cli_5902)) in
                                {10337}let v_9278: bool = (Disco_5903 = A) in
                                (
                                    {10338}if v_9278 then
                                    (
                                        {10339}let pkDisco_9279: bitstring = pub(skA) in
                                        {10340}in(c, (=pkCli_9277,em1_9280: bitstring,sigM1_9281: bitstring));
                                        {10341}let m1_9282: bitstring = dec(em1_9280,skSess_9008) in
                                        {10342}if (verify(h(m1_9282),sigM1_9281,pkCli_9277) <> true) then
                                            0
                                        else
                                            {10343}let (=OpenSecureChannelRequest,=pkCli_9277,wNc_9283: bitstring) = m1_9282 in
                                            {10344}let Nc_9284: bitstring = dec(wNc_9283,skSess_9008) in
                                            {10345}new Ns_9285: bitstring;
                                            {10346}new ST_9286: bitstring;
                                            {10347}new TTL_9287: bitstring;
                                            {10348}let wNs_9288: bitstring = enc(Ns_9285,pkCli_9277) in
                                            {10349}let m2_9289: bitstring = (OpenSecureChannelResponse,wNs_9288,ST_9286,TTL_9287) in
                                            {10350}out(c, (enc(m2_9289,pkCli_9277),sign(h(m2_9289),skSess_9008)));
                                            {10351}let Ksrv_9290: bitstring = h((Ns_9285,Nc_9284)) in
                                            {10352}out(c, senc(mSrv(pkCli_9277,pkSess_9009),Ksrv_9290))
                                    )
                                    else
                                        {10353}let v_9291: bool = (Disco_5903 = B) in
                                        (
                                            {10354}if v_9291 then
                                            (
                                                {10355}let pkDisco_9292: bitstring = pub(skB) in
                                                {10356}in(c, (=pkCli_9277,em1_9293: bitstring,sigM1_9294: bitstring));
                                                {10357}let m1_9295: bitstring = dec(em1_9293,skSess_9008) in
                                                {10358}if (verify(h(m1_9295),sigM1_9294,pkCli_9277) <> true) then
                                                    0
                                                else
                                                    {10359}let (=OpenSecureChannelRequest,=pkCli_9277,wNc_9296: bitstring) = m1_9295 in
                                                    {10360}let Nc_9297: bitstring = dec(wNc_9296,skSess_9008) in
                                                    {10361}new Ns_9298: bitstring;
                                                    {10362}new ST_9299: bitstring;
                                                    {10363}new TTL_9300: bitstring;
                                                    {10364}let wNs_9301: bitstring = enc(Ns_9298,pkCli_9277) in
                                                    {10365}let m2_9302: bitstring = (OpenSecureChannelResponse,wNs_9301,ST_9299,TTL_9300) in
                                                    {10366}out(c, (enc(m2_9302,pkCli_9277),sign(h(m2_9302),skSess_9008)));
                                                    {10367}let Ksrv_9303: bitstring = h((Ns_9298,Nc_9297)) in
                                                    {10368}out(c, senc(mSrv(pkCli_9277,pkSess_9009),Ksrv_9303))
                                            )
                                            else
                                                {10369}let v_9304: bool = (Disco_5903 = C) in
                                                (
                                                    {10370}if v_9304 then
                                                    (
                                                        {10371}let pkDisco_9305: bitstring = pub(skC) in
                                                        {10372}in(c, (=pkCli_9277,em1_9306: bitstring,sigM1_9307: bitstring));
                                                        {10373}let m1_9308: bitstring = dec(em1_9306,skSess_9008) in
                                                        {10374}if (verify(h(m1_9308),sigM1_9307,pkCli_9277) <> true) then
                                                            0
                                                        else
                                                            {10375}let (=OpenSecureChannelRequest,=pkCli_9277,wNc_9309: bitstring) = m1_9308 in
                                                            {10376}let Nc_9310: bitstring = dec(wNc_9309,skSess_9008) in
                                                            {10377}new Ns_9311: bitstring;
                                                            {10378}new ST_9312: bitstring;
                                                            {10379}new TTL_9313: bitstring;
                                                            {10380}let wNs_9314: bitstring = enc(Ns_9311,pkCli_9277) in
                                                            {10381}let m2_9315: bitstring = (OpenSecureChannelResponse,wNs_9314,ST_9312,TTL_9313) in
                                                            {10382}out(c, (enc(m2_9315,pkCli_9277),sign(h(m2_9315),skSess_9008)));
                                                            {10383}let Ksrv_9316: bitstring = h((Ns_9311,Nc_9310)) in
                                                            {10384}out(c, senc(mSrv(pkCli_9277,pkSess_9009),Ksrv_9316))
                                                    )
                                                    else
                                                        {10385}let pkDisco_9317: bitstring = pub(sk(Disco_5903)) in
                                                        {10386}in(c, (=pkCli_9277,em1_9318: bitstring,sigM1_9319: bitstring));
                                                        {10387}let m1_9320: bitstring = dec(em1_9318,skSess_9008) in
                                                        {10388}if (verify(h(m1_9320),sigM1_9319,pkCli_9277) <> true) then
                                                            0
                                                        else
                                                            {10389}let (=OpenSecureChannelRequest,=pkCli_9277,wNc_9321: bitstring) = m1_9320 in
                                                            {10390}let Nc_9322: bitstring = dec(wNc_9321,skSess_9008) in
                                                            {10391}new Ns_9323: bitstring;
                                                            {10392}new ST_9324: bitstring;
                                                            {10393}new TTL_9325: bitstring;
                                                            {10394}let wNs_9326: bitstring = enc(Ns_9323,pkCli_9277) in
                                                            {10395}let m2_9327: bitstring = (OpenSecureChannelResponse,wNs_9326,ST_9324,TTL_9325) in
                                                            {10396}out(c, (enc(m2_9327,pkCli_9277),sign(h(m2_9327),skSess_9008)));
                                                            {10397}let Ksrv_9328: bitstring = h((Ns_9323,Nc_9322)) in
                                                            {10398}out(c, senc(mSrv(pkCli_9277,pkSess_9009),Ksrv_9328))
                                                )
                                                else
                                                    {10399}let pkDisco_9329: bitstring = fail-any in
                                                    {10400}in(c, (=pkCli_9277,em1_9330: bitstring,sigM1_9331: bitstring));
                                                    {10401}let m1_9332: bitstring = dec(em1_9330,skSess_9008) in
                                                    {10402}if (verify(h(m1_9332),sigM1_9331,pkCli_9277) <> true) then
                                                        0
                                                    else
                                                        {10403}let (=OpenSecureChannelRequest,=pkCli_9277,wNc_9333: bitstring) = m1_9332 in
                                                        {10404}let Nc_9334: bitstring = dec(wNc_9333,skSess_9008) in
                                                        {10405}new Ns_9335: bitstring;
                                                        {10406}new ST_9336: bitstring;
                                                        {10407}new TTL_9337: bitstring;
                                                        {10408}let wNs_9338: bitstring = enc(Ns_9335,pkCli_9277) in
                                                        {10409}let m2_9339: bitstring = (OpenSecureChannelResponse,wNs_9338,ST_9336,TTL_9337) in
                                                        {10410}out(c, (enc(m2_9339,pkCli_9277),sign(h(m2_9339),skSess_9008)));
                                                        {10411}let Ksrv_9340: bitstring = h((Ns_9335,Nc_9334)) in
                                                        {10412}out(c, senc(mSrv(pkCli_9277,pkSess_9009),Ksrv_9340))
                                        )
                                        else
                                            {10413}let pkDisco_9341: bitstring = fail-any in
                                            {10414}in(c, (=pkCli_9277,em1_9342: bitstring,sigM1_9343: bitstring));
                                            {10415}let m1_9344: bitstring = dec(em1_9342,skSess_9008) in
                                            {10416}if (verify(h(m1_9344),sigM1_9343,pkCli_9277) <> true) then
                                                0
                                            else
                                                {10417}let (=OpenSecureChannelRequest,=pkCli_9277,wNc_9345: bitstring) = m1_9344 in
                                                {10418}let Nc_9346: bitstring = dec(wNc_9345,skSess_9008) in
                                                {10419}new Ns_9347: bitstring;
                                                {10420}new ST_9348: bitstring;
                                                {10421}new TTL_9349: bitstring;
                                                {10422}let wNs_9350: bitstring = enc(Ns_9347,pkCli_9277) in
                                                {10423}let m2_9351: bitstring = (OpenSecureChannelResponse,wNs_9350,ST_9348,TTL_9349) in
                                                {10424}out(c, (enc(m2_9351,pkCli_9277),sign(h(m2_9351),skSess_9008)));
                                                {10425}let Ksrv_9352: bitstring = h((Ns_9347,Nc_9346)) in
                                                {10426}out(c, senc(mSrv(pkCli_9277,pkSess_9009),Ksrv_9352))
                                )
                                else
                                    {10427}let pkDisco_9353: bitstring = fail-any in
                                    {10428}in(c, (=pkCli_9277,em1_9354: bitstring,sigM1_9355: bitstring));
                                    {10429}let m1_9356: bitstring = dec(em1_9354,skSess_9008) in
                                    {10430}if (verify(h(m1_9356),sigM1_9355,pkCli_9277) <> true) then
                                        0
                                    else
                                        {10431}let (=OpenSecureChannelRequest,=pkCli_9277,wNc_9357: bitstring) = m1_9356 in
                                        {10432}let Nc_9358: bitstring = dec(wNc_9357,skSess_9008) in
                                        {10433}new Ns_9359: bitstring;
                                        {10434}new ST_9360: bitstring;
                                        {10435}new TTL_9361: bitstring;
                                        {10436}let wNs_9362: bitstring = enc(Ns_9359,pkCli_9277) in
                                        {10437}let m2_9363: bitstring = (OpenSecureChannelResponse,wNs_9362,ST_9360,TTL_9361) in
                                        {10438}out(c, (enc(m2_9363,pkCli_9277),sign(h(m2_9363),skSess_9008)));
                                        {10439}let Ksrv_9364: bitstring = h((Ns_9359,Nc_9358)) in
                                        {10440}out(c, senc(mSrv(pkCli_9277,pkSess_9009),Ksrv_9364))
                        )
                        else
                            {10441}let pkCli_9365: bitstring = fail-any in
                            {10442}let v_9366: bool = (Disco_5903 = A) in
                            (
                                {10443}if v_9366 then
                                (
                                    {10444}let pkDisco_9367: bitstring = pub(skA) in
                                    {10445}in(c, (=pkCli_9365,em1_9368: bitstring,sigM1_9369: bitstring));
                                    {10446}let m1_9370: bitstring = dec(em1_9368,skSess_9008) in
                                    {10447}if (verify(h(m1_9370),sigM1_9369,pkCli_9365) <> true) then
                                        0
                                    else
                                        {10448}let (=OpenSecureChannelRequest,=pkCli_9365,wNc_9371: bitstring) = m1_9370 in
                                        {10449}let Nc_9372: bitstring = dec(wNc_9371,skSess_9008) in
                                        {10450}new Ns_9373: bitstring;
                                        {10451}new ST_9374: bitstring;
                                        {10452}new TTL_9375: bitstring;
                                        {10453}let wNs_9376: bitstring = enc(Ns_9373,pkCli_9365) in
                                        {10454}let m2_9377: bitstring = (OpenSecureChannelResponse,wNs_9376,ST_9374,TTL_9375) in
                                        {10455}out(c, (enc(m2_9377,pkCli_9365),sign(h(m2_9377),skSess_9008)));
                                        {10456}let Ksrv_9378: bitstring = h((Ns_9373,Nc_9372)) in
                                        {10457}out(c, senc(mSrv(pkCli_9365,pkSess_9009),Ksrv_9378))
                                )
                                else
                                    {10458}let v_9379: bool = (Disco_5903 = B) in
                                    (
                                        {10459}if v_9379 then
                                        (
                                            {10460}let pkDisco_9380: bitstring = pub(skB) in
                                            {10461}in(c, (=pkCli_9365,em1_9381: bitstring,sigM1_9382: bitstring));
                                            {10462}let m1_9383: bitstring = dec(em1_9381,skSess_9008) in
                                            {10463}if (verify(h(m1_9383),sigM1_9382,pkCli_9365) <> true) then
                                                0
                                            else
                                                {10464}let (=OpenSecureChannelRequest,=pkCli_9365,wNc_9384: bitstring) = m1_9383 in
                                                {10465}let Nc_9385: bitstring = dec(wNc_9384,skSess_9008) in
                                                {10466}new Ns_9386: bitstring;
                                                {10467}new ST_9387: bitstring;
                                                {10468}new TTL_9388: bitstring;
                                                {10469}let wNs_9389: bitstring = enc(Ns_9386,pkCli_9365) in
                                                {10470}let m2_9390: bitstring = (OpenSecureChannelResponse,wNs_9389,ST_9387,TTL_9388) in
                                                {10471}out(c, (enc(m2_9390,pkCli_9365),sign(h(m2_9390),skSess_9008)));
                                                {10472}let Ksrv_9391: bitstring = h((Ns_9386,Nc_9385)) in
                                                {10473}out(c, senc(mSrv(pkCli_9365,pkSess_9009),Ksrv_9391))
                                        )
                                        else
                                            {10474}let v_9392: bool = (Disco_5903 = C) in
                                            (
                                                {10475}if v_9392 then
                                                (
                                                    {10476}let pkDisco_9393: bitstring = pub(skC) in
                                                    {10477}in(c, (=pkCli_9365,em1_9394: bitstring,sigM1_9395: bitstring));
                                                    {10478}let m1_9396: bitstring = dec(em1_9394,skSess_9008) in
                                                    {10479}if (verify(h(m1_9396),sigM1_9395,pkCli_9365) <> true) then
                                                        0
                                                    else
                                                        {10480}let (=OpenSecureChannelRequest,=pkCli_9365,wNc_9397: bitstring) = m1_9396 in
                                                        {10481}let Nc_9398: bitstring = dec(wNc_9397,skSess_9008) in
                                                        {10482}new Ns_9399: bitstring;
                                                        {10483}new ST_9400: bitstring;
                                                        {10484}new TTL_9401: bitstring;
                                                        {10485}let wNs_9402: bitstring = enc(Ns_9399,pkCli_9365) in
                                                        {10486}let m2_9403: bitstring = (OpenSecureChannelResponse,wNs_9402,ST_9400,TTL_9401) in
                                                        {10487}out(c, (enc(m2_9403,pkCli_9365),sign(h(m2_9403),skSess_9008)));
                                                        {10488}let Ksrv_9404: bitstring = h((Ns_9399,Nc_9398)) in
                                                        {10489}out(c, senc(mSrv(pkCli_9365,pkSess_9009),Ksrv_9404))
                                                )
                                                else
                                                    {10490}let pkDisco_9405: bitstring = pub(sk(Disco_5903)) in
                                                    {10491}in(c, (=pkCli_9365,em1_9406: bitstring,sigM1_9407: bitstring));
                                                    {10492}let m1_9408: bitstring = dec(em1_9406,skSess_9008) in
                                                    {10493}if (verify(h(m1_9408),sigM1_9407,pkCli_9365) <> true) then
                                                        0
                                                    else
                                                        {10494}let (=OpenSecureChannelRequest,=pkCli_9365,wNc_9409: bitstring) = m1_9408 in
                                                        {10495}let Nc_9410: bitstring = dec(wNc_9409,skSess_9008) in
                                                        {10496}new Ns_9411: bitstring;
                                                        {10497}new ST_9412: bitstring;
                                                        {10498}new TTL_9413: bitstring;
                                                        {10499}let wNs_9414: bitstring = enc(Ns_9411,pkCli_9365) in
                                                        {10500}let m2_9415: bitstring = (OpenSecureChannelResponse,wNs_9414,ST_9412,TTL_9413) in
                                                        {10501}out(c, (enc(m2_9415,pkCli_9365),sign(h(m2_9415),skSess_9008)));
                                                        {10502}let Ksrv_9416: bitstring = h((Ns_9411,Nc_9410)) in
                                                        {10503}out(c, senc(mSrv(pkCli_9365,pkSess_9009),Ksrv_9416))
                                            )
                                            else
                                                {10504}let pkDisco_9417: bitstring = fail-any in
                                                {10505}in(c, (=pkCli_9365,em1_9418: bitstring,sigM1_9419: bitstring));
                                                {10506}let m1_9420: bitstring = dec(em1_9418,skSess_9008) in
                                                {10507}if (verify(h(m1_9420),sigM1_9419,pkCli_9365) <> true) then
                                                    0
                                                else
                                                    {10508}let (=OpenSecureChannelRequest,=pkCli_9365,wNc_9421: bitstring) = m1_9420 in
                                                    {10509}let Nc_9422: bitstring = dec(wNc_9421,skSess_9008) in
                                                    {10510}new Ns_9423: bitstring;
                                                    {10511}new ST_9424: bitstring;
                                                    {10512}new TTL_9425: bitstring;
                                                    {10513}let wNs_9426: bitstring = enc(Ns_9423,pkCli_9365) in
                                                    {10514}let m2_9427: bitstring = (OpenSecureChannelResponse,wNs_9426,ST_9424,TTL_9425) in
                                                    {10515}out(c, (enc(m2_9427,pkCli_9365),sign(h(m2_9427),skSess_9008)));
                                                    {10516}let Ksrv_9428: bitstring = h((Ns_9423,Nc_9422)) in
                                                    {10517}out(c, senc(mSrv(pkCli_9365,pkSess_9009),Ksrv_9428))
                                    )
                                    else
                                        {10518}let pkDisco_9429: bitstring = fail-any in
                                        {10519}in(c, (=pkCli_9365,em1_9430: bitstring,sigM1_9431: bitstring));
                                        {10520}let m1_9432: bitstring = dec(em1_9430,skSess_9008) in
                                        {10521}if (verify(h(m1_9432),sigM1_9431,pkCli_9365) <> true) then
                                            0
                                        else
                                            {10522}let (=OpenSecureChannelRequest,=pkCli_9365,wNc_9433: bitstring) = m1_9432 in
                                            {10523}let Nc_9434: bitstring = dec(wNc_9433,skSess_9008) in
                                            {10524}new Ns_9435: bitstring;
                                            {10525}new ST_9436: bitstring;
                                            {10526}new TTL_9437: bitstring;
                                            {10527}let wNs_9438: bitstring = enc(Ns_9435,pkCli_9365) in
                                            {10528}let m2_9439: bitstring = (OpenSecureChannelResponse,wNs_9438,ST_9436,TTL_9437) in
                                            {10529}out(c, (enc(m2_9439,pkCli_9365),sign(h(m2_9439),skSess_9008)));
                                            {10530}let Ksrv_9440: bitstring = h((Ns_9435,Nc_9434)) in
                                            {10531}out(c, senc(mSrv(pkCli_9365,pkSess_9009),Ksrv_9440))
                            )
                            else
                                {10532}let pkDisco_9441: bitstring = fail-any in
                                {10533}in(c, (=pkCli_9365,em1_9442: bitstring,sigM1_9443: bitstring));
                                {10534}let m1_9444: bitstring = dec(em1_9442,skSess_9008) in
                                {10535}if (verify(h(m1_9444),sigM1_9443,pkCli_9365) <> true) then
                                    0
                                else
                                    {10536}let (=OpenSecureChannelRequest,=pkCli_9365,wNc_9445: bitstring) = m1_9444 in
                                    {10537}let Nc_9446: bitstring = dec(wNc_9445,skSess_9008) in
                                    {10538}new Ns_9447: bitstring;
                                    {10539}new ST_9448: bitstring;
                                    {10540}new TTL_9449: bitstring;
                                    {10541}let wNs_9450: bitstring = enc(Ns_9447,pkCli_9365) in
                                    {10542}let m2_9451: bitstring = (OpenSecureChannelResponse,wNs_9450,ST_9448,TTL_9449) in
                                    {10543}out(c, (enc(m2_9451,pkCli_9365),sign(h(m2_9451),skSess_9008)));
                                    {10544}let Ksrv_9452: bitstring = h((Ns_9447,Nc_9446)) in
                                    {10545}out(c, senc(mSrv(pkCli_9365,pkSess_9009),Ksrv_9452))
                )
                else
                    {10546}let pkCli_9453: bitstring = fail-any in
                    {10547}let v_9454: bool = (Disco_5903 = A) in
                    (
                        {10548}if v_9454 then
                        (
                            {10549}let pkDisco_9455: bitstring = pub(skA) in
                            {10550}in(c, (=pkCli_9453,em1_9456: bitstring,sigM1_9457: bitstring));
                            {10551}let m1_9458: bitstring = dec(em1_9456,skSess_9008) in
                            {10552}if (verify(h(m1_9458),sigM1_9457,pkCli_9453) <> true) then
                                0
                            else
                                {10553}let (=OpenSecureChannelRequest,=pkCli_9453,wNc_9459: bitstring) = m1_9458 in
                                {10554}let Nc_9460: bitstring = dec(wNc_9459,skSess_9008) in
                                {10555}new Ns_9461: bitstring;
                                {10556}new ST_9462: bitstring;
                                {10557}new TTL_9463: bitstring;
                                {10558}let wNs_9464: bitstring = enc(Ns_9461,pkCli_9453) in
                                {10559}let m2_9465: bitstring = (OpenSecureChannelResponse,wNs_9464,ST_9462,TTL_9463) in
                                {10560}out(c, (enc(m2_9465,pkCli_9453),sign(h(m2_9465),skSess_9008)));
                                {10561}let Ksrv_9466: bitstring = h((Ns_9461,Nc_9460)) in
                                {10562}out(c, senc(mSrv(pkCli_9453,pkSess_9009),Ksrv_9466))
                        )
                        else
                            {10563}let v_9467: bool = (Disco_5903 = B) in
                            (
                                {10564}if v_9467 then
                                (
                                    {10565}let pkDisco_9468: bitstring = pub(skB) in
                                    {10566}in(c, (=pkCli_9453,em1_9469: bitstring,sigM1_9470: bitstring));
                                    {10567}let m1_9471: bitstring = dec(em1_9469,skSess_9008) in
                                    {10568}if (verify(h(m1_9471),sigM1_9470,pkCli_9453) <> true) then
                                        0
                                    else
                                        {10569}let (=OpenSecureChannelRequest,=pkCli_9453,wNc_9472: bitstring) = m1_9471 in
                                        {10570}let Nc_9473: bitstring = dec(wNc_9472,skSess_9008) in
                                        {10571}new Ns_9474: bitstring;
                                        {10572}new ST_9475: bitstring;
                                        {10573}new TTL_9476: bitstring;
                                        {10574}let wNs_9477: bitstring = enc(Ns_9474,pkCli_9453) in
                                        {10575}let m2_9478: bitstring = (OpenSecureChannelResponse,wNs_9477,ST_9475,TTL_9476) in
                                        {10576}out(c, (enc(m2_9478,pkCli_9453),sign(h(m2_9478),skSess_9008)));
                                        {10577}let Ksrv_9479: bitstring = h((Ns_9474,Nc_9473)) in
                                        {10578}out(c, senc(mSrv(pkCli_9453,pkSess_9009),Ksrv_9479))
                                )
                                else
                                    {10579}let v_9480: bool = (Disco_5903 = C) in
                                    (
                                        {10580}if v_9480 then
                                        (
                                            {10581}let pkDisco_9481: bitstring = pub(skC) in
                                            {10582}in(c, (=pkCli_9453,em1_9482: bitstring,sigM1_9483: bitstring));
                                            {10583}let m1_9484: bitstring = dec(em1_9482,skSess_9008) in
                                            {10584}if (verify(h(m1_9484),sigM1_9483,pkCli_9453) <> true) then
                                                0
                                            else
                                                {10585}let (=OpenSecureChannelRequest,=pkCli_9453,wNc_9485: bitstring) = m1_9484 in
                                                {10586}let Nc_9486: bitstring = dec(wNc_9485,skSess_9008) in
                                                {10587}new Ns_9487: bitstring;
                                                {10588}new ST_9488: bitstring;
                                                {10589}new TTL_9489: bitstring;
                                                {10590}let wNs_9490: bitstring = enc(Ns_9487,pkCli_9453) in
                                                {10591}let m2_9491: bitstring = (OpenSecureChannelResponse,wNs_9490,ST_9488,TTL_9489) in
                                                {10592}out(c, (enc(m2_9491,pkCli_9453),sign(h(m2_9491),skSess_9008)));
                                                {10593}let Ksrv_9492: bitstring = h((Ns_9487,Nc_9486)) in
                                                {10594}out(c, senc(mSrv(pkCli_9453,pkSess_9009),Ksrv_9492))
                                        )
                                        else
                                            {10595}let pkDisco_9493: bitstring = pub(sk(Disco_5903)) in
                                            {10596}in(c, (=pkCli_9453,em1_9494: bitstring,sigM1_9495: bitstring));
                                            {10597}let m1_9496: bitstring = dec(em1_9494,skSess_9008) in
                                            {10598}if (verify(h(m1_9496),sigM1_9495,pkCli_9453) <> true) then
                                                0
                                            else
                                                {10599}let (=OpenSecureChannelRequest,=pkCli_9453,wNc_9497: bitstring) = m1_9496 in
                                                {10600}let Nc_9498: bitstring = dec(wNc_9497,skSess_9008) in
                                                {10601}new Ns_9499: bitstring;
                                                {10602}new ST_9500: bitstring;
                                                {10603}new TTL_9501: bitstring;
                                                {10604}let wNs_9502: bitstring = enc(Ns_9499,pkCli_9453) in
                                                {10605}let m2_9503: bitstring = (OpenSecureChannelResponse,wNs_9502,ST_9500,TTL_9501) in
                                                {10606}out(c, (enc(m2_9503,pkCli_9453),sign(h(m2_9503),skSess_9008)));
                                                {10607}let Ksrv_9504: bitstring = h((Ns_9499,Nc_9498)) in
                                                {10608}out(c, senc(mSrv(pkCli_9453,pkSess_9009),Ksrv_9504))
                                    )
                                    else
                                        {10609}let pkDisco_9505: bitstring = fail-any in
                                        {10610}in(c, (=pkCli_9453,em1_9506: bitstring,sigM1_9507: bitstring));
                                        {10611}let m1_9508: bitstring = dec(em1_9506,skSess_9008) in
                                        {10612}if (verify(h(m1_9508),sigM1_9507,pkCli_9453) <> true) then
                                            0
                                        else
                                            {10613}let (=OpenSecureChannelRequest,=pkCli_9453,wNc_9509: bitstring) = m1_9508 in
                                            {10614}let Nc_9510: bitstring = dec(wNc_9509,skSess_9008) in
                                            {10615}new Ns_9511: bitstring;
                                            {10616}new ST_9512: bitstring;
                                            {10617}new TTL_9513: bitstring;
                                            {10618}let wNs_9514: bitstring = enc(Ns_9511,pkCli_9453) in
                                            {10619}let m2_9515: bitstring = (OpenSecureChannelResponse,wNs_9514,ST_9512,TTL_9513) in
                                            {10620}out(c, (enc(m2_9515,pkCli_9453),sign(h(m2_9515),skSess_9008)));
                                            {10621}let Ksrv_9516: bitstring = h((Ns_9511,Nc_9510)) in
                                            {10622}out(c, senc(mSrv(pkCli_9453,pkSess_9009),Ksrv_9516))
                            )
                            else
                                {10623}let pkDisco_9517: bitstring = fail-any in
                                {10624}in(c, (=pkCli_9453,em1_9518: bitstring,sigM1_9519: bitstring));
                                {10625}let m1_9520: bitstring = dec(em1_9518,skSess_9008) in
                                {10626}if (verify(h(m1_9520),sigM1_9519,pkCli_9453) <> true) then
                                    0
                                else
                                    {10627}let (=OpenSecureChannelRequest,=pkCli_9453,wNc_9521: bitstring) = m1_9520 in
                                    {10628}let Nc_9522: bitstring = dec(wNc_9521,skSess_9008) in
                                    {10629}new Ns_9523: bitstring;
                                    {10630}new ST_9524: bitstring;
                                    {10631}new TTL_9525: bitstring;
                                    {10632}let wNs_9526: bitstring = enc(Ns_9523,pkCli_9453) in
                                    {10633}let m2_9527: bitstring = (OpenSecureChannelResponse,wNs_9526,ST_9524,TTL_9525) in
                                    {10634}out(c, (enc(m2_9527,pkCli_9453),sign(h(m2_9527),skSess_9008)));
                                    {10635}let Ksrv_9528: bitstring = h((Ns_9523,Nc_9522)) in
                                    {10636}out(c, senc(mSrv(pkCli_9453,pkSess_9009),Ksrv_9528))
                    )
                    else
                        {10637}let pkDisco_9529: bitstring = fail-any in
                        {10638}in(c, (=pkCli_9453,em1_9530: bitstring,sigM1_9531: bitstring));
                        {10639}let m1_9532: bitstring = dec(em1_9530,skSess_9008) in
                        {10640}if (verify(h(m1_9532),sigM1_9531,pkCli_9453) <> true) then
                            0
                        else
                            {10641}let (=OpenSecureChannelRequest,=pkCli_9453,wNc_9533: bitstring) = m1_9532 in
                            {10642}let Nc_9534: bitstring = dec(wNc_9533,skSess_9008) in
                            {10643}new Ns_9535: bitstring;
                            {10644}new ST_9536: bitstring;
                            {10645}new TTL_9537: bitstring;
                            {10646}let wNs_9538: bitstring = enc(Ns_9535,pkCli_9453) in
                            {10647}let m2_9539: bitstring = (OpenSecureChannelResponse,wNs_9538,ST_9536,TTL_9537) in
                            {10648}out(c, (enc(m2_9539,pkCli_9453),sign(h(m2_9539),skSess_9008)));
                            {10649}let Ksrv_9540: bitstring = h((Ns_9535,Nc_9534)) in
                            {10650}out(c, senc(mSrv(pkCli_9453,pkSess_9009),Ksrv_9540))
        )
        else
            {10651}let pkCli_9541: bitstring = fail-any in
            {10652}let v_9542: bool = (Disco_5903 = A) in
            (
                {10653}if v_9542 then
                (
                    {10654}let pkDisco_9543: bitstring = pub(skA) in
                    {10655}in(c, (=pkCli_9541,em1_9544: bitstring,sigM1_9545: bitstring));
                    {10656}let m1_9546: bitstring = dec(em1_9544,skSess_9008) in
                    {10657}if (verify(h(m1_9546),sigM1_9545,pkCli_9541) <> true) then
                        0
                    else
                        {10658}let (=OpenSecureChannelRequest,=pkCli_9541,wNc_9547: bitstring) = m1_9546 in
                        {10659}let Nc_9548: bitstring = dec(wNc_9547,skSess_9008) in
                        {10660}new Ns_9549: bitstring;
                        {10661}new ST_9550: bitstring;
                        {10662}new TTL_9551: bitstring;
                        {10663}let wNs_9552: bitstring = enc(Ns_9549,pkCli_9541) in
                        {10664}let m2_9553: bitstring = (OpenSecureChannelResponse,wNs_9552,ST_9550,TTL_9551) in
                        {10665}out(c, (enc(m2_9553,pkCli_9541),sign(h(m2_9553),skSess_9008)));
                        {10666}let Ksrv_9554: bitstring = h((Ns_9549,Nc_9548)) in
                        {10667}out(c, senc(mSrv(pkCli_9541,pkSess_9009),Ksrv_9554))
                )
                else
                    {10668}let v_9555: bool = (Disco_5903 = B) in
                    (
                        {10669}if v_9555 then
                        (
                            {10670}let pkDisco_9556: bitstring = pub(skB) in
                            {10671}in(c, (=pkCli_9541,em1_9557: bitstring,sigM1_9558: bitstring));
                            {10672}let m1_9559: bitstring = dec(em1_9557,skSess_9008) in
                            {10673}if (verify(h(m1_9559),sigM1_9558,pkCli_9541) <> true) then
                                0
                            else
                                {10674}let (=OpenSecureChannelRequest,=pkCli_9541,wNc_9560: bitstring) = m1_9559 in
                                {10675}let Nc_9561: bitstring = dec(wNc_9560,skSess_9008) in
                                {10676}new Ns_9562: bitstring;
                                {10677}new ST_9563: bitstring;
                                {10678}new TTL_9564: bitstring;
                                {10679}let wNs_9565: bitstring = enc(Ns_9562,pkCli_9541) in
                                {10680}let m2_9566: bitstring = (OpenSecureChannelResponse,wNs_9565,ST_9563,TTL_9564) in
                                {10681}out(c, (enc(m2_9566,pkCli_9541),sign(h(m2_9566),skSess_9008)));
                                {10682}let Ksrv_9567: bitstring = h((Ns_9562,Nc_9561)) in
                                {10683}out(c, senc(mSrv(pkCli_9541,pkSess_9009),Ksrv_9567))
                        )
                        else
                            {10684}let v_9568: bool = (Disco_5903 = C) in
                            (
                                {10685}if v_9568 then
                                (
                                    {10686}let pkDisco_9569: bitstring = pub(skC) in
                                    {10687}in(c, (=pkCli_9541,em1_9570: bitstring,sigM1_9571: bitstring));
                                    {10688}let m1_9572: bitstring = dec(em1_9570,skSess_9008) in
                                    {10689}if (verify(h(m1_9572),sigM1_9571,pkCli_9541) <> true) then
                                        0
                                    else
                                        {10690}let (=OpenSecureChannelRequest,=pkCli_9541,wNc_9573: bitstring) = m1_9572 in
                                        {10691}let Nc_9574: bitstring = dec(wNc_9573,skSess_9008) in
                                        {10692}new Ns_9575: bitstring;
                                        {10693}new ST_9576: bitstring;
                                        {10694}new TTL_9577: bitstring;
                                        {10695}let wNs_9578: bitstring = enc(Ns_9575,pkCli_9541) in
                                        {10696}let m2_9579: bitstring = (OpenSecureChannelResponse,wNs_9578,ST_9576,TTL_9577) in
                                        {10697}out(c, (enc(m2_9579,pkCli_9541),sign(h(m2_9579),skSess_9008)));
                                        {10698}let Ksrv_9580: bitstring = h((Ns_9575,Nc_9574)) in
                                        {10699}out(c, senc(mSrv(pkCli_9541,pkSess_9009),Ksrv_9580))
                                )
                                else
                                    {10700}let pkDisco_9581: bitstring = pub(sk(Disco_5903)) in
                                    {10701}in(c, (=pkCli_9541,em1_9582: bitstring,sigM1_9583: bitstring));
                                    {10702}let m1_9584: bitstring = dec(em1_9582,skSess_9008) in
                                    {10703}if (verify(h(m1_9584),sigM1_9583,pkCli_9541) <> true) then
                                        0
                                    else
                                        {10704}let (=OpenSecureChannelRequest,=pkCli_9541,wNc_9585: bitstring) = m1_9584 in
                                        {10705}let Nc_9586: bitstring = dec(wNc_9585,skSess_9008) in
                                        {10706}new Ns_9587: bitstring;
                                        {10707}new ST_9588: bitstring;
                                        {10708}new TTL_9589: bitstring;
                                        {10709}let wNs_9590: bitstring = enc(Ns_9587,pkCli_9541) in
                                        {10710}let m2_9591: bitstring = (OpenSecureChannelResponse,wNs_9590,ST_9588,TTL_9589) in
                                        {10711}out(c, (enc(m2_9591,pkCli_9541),sign(h(m2_9591),skSess_9008)));
                                        {10712}let Ksrv_9592: bitstring = h((Ns_9587,Nc_9586)) in
                                        {10713}out(c, senc(mSrv(pkCli_9541,pkSess_9009),Ksrv_9592))
                            )
                            else
                                {10714}let pkDisco_9593: bitstring = fail-any in
                                {10715}in(c, (=pkCli_9541,em1_9594: bitstring,sigM1_9595: bitstring));
                                {10716}let m1_9596: bitstring = dec(em1_9594,skSess_9008) in
                                {10717}if (verify(h(m1_9596),sigM1_9595,pkCli_9541) <> true) then
                                    0
                                else
                                    {10718}let (=OpenSecureChannelRequest,=pkCli_9541,wNc_9597: bitstring) = m1_9596 in
                                    {10719}let Nc_9598: bitstring = dec(wNc_9597,skSess_9008) in
                                    {10720}new Ns_9599: bitstring;
                                    {10721}new ST_9600: bitstring;
                                    {10722}new TTL_9601: bitstring;
                                    {10723}let wNs_9602: bitstring = enc(Ns_9599,pkCli_9541) in
                                    {10724}let m2_9603: bitstring = (OpenSecureChannelResponse,wNs_9602,ST_9600,TTL_9601) in
                                    {10725}out(c, (enc(m2_9603,pkCli_9541),sign(h(m2_9603),skSess_9008)));
                                    {10726}let Ksrv_9604: bitstring = h((Ns_9599,Nc_9598)) in
                                    {10727}out(c, senc(mSrv(pkCli_9541,pkSess_9009),Ksrv_9604))
                    )
                    else
                        {10728}let pkDisco_9605: bitstring = fail-any in
                        {10729}in(c, (=pkCli_9541,em1_9606: bitstring,sigM1_9607: bitstring));
                        {10730}let m1_9608: bitstring = dec(em1_9606,skSess_9008) in
                        {10731}if (verify(h(m1_9608),sigM1_9607,pkCli_9541) <> true) then
                            0
                        else
                            {10732}let (=OpenSecureChannelRequest,=pkCli_9541,wNc_9609: bitstring) = m1_9608 in
                            {10733}let Nc_9610: bitstring = dec(wNc_9609,skSess_9008) in
                            {10734}new Ns_9611: bitstring;
                            {10735}new ST_9612: bitstring;
                            {10736}new TTL_9613: bitstring;
                            {10737}let wNs_9614: bitstring = enc(Ns_9611,pkCli_9541) in
                            {10738}let m2_9615: bitstring = (OpenSecureChannelResponse,wNs_9614,ST_9612,TTL_9613) in
                            {10739}out(c, (enc(m2_9615,pkCli_9541),sign(h(m2_9615),skSess_9008)));
                            {10740}let Ksrv_9616: bitstring = h((Ns_9611,Nc_9610)) in
                            {10741}out(c, senc(mSrv(pkCli_9541,pkSess_9009),Ksrv_9616))
            )
            else
                {10742}let pkDisco_9617: bitstring = fail-any in
                {10743}in(c, (=pkCli_9541,em1_9618: bitstring,sigM1_9619: bitstring));
                {10744}let m1_9620: bitstring = dec(em1_9618,skSess_9008) in
                {10745}if (verify(h(m1_9620),sigM1_9619,pkCli_9541) <> true) then
                    0
                else
                    {10746}let (=OpenSecureChannelRequest,=pkCli_9541,wNc_9621: bitstring) = m1_9620 in
                    {10747}let Nc_9622: bitstring = dec(wNc_9621,skSess_9008) in
                    {10748}new Ns_9623: bitstring;
                    {10749}new ST_9624: bitstring;
                    {10750}new TTL_9625: bitstring;
                    {10751}let wNs_9626: bitstring = enc(Ns_9623,pkCli_9541) in
                    {10752}let m2_9627: bitstring = (OpenSecureChannelResponse,wNs_9626,ST_9624,TTL_9625) in
                    {10753}out(c, (enc(m2_9627,pkCli_9541),sign(h(m2_9627),skSess_9008)));
                    {10754}let Ksrv_9628: bitstring = h((Ns_9623,Nc_9622)) in
                    {10755}out(c, senc(mSrv(pkCli_9541,pkSess_9009),Ksrv_9628))
)

-- Query not attacker(mSrv(pub(skA[]),pub(skC[])))
Completing...
200 rules inserted. The rule base contains 123 rules. 388 rules in the queue.
400 rules inserted. The rule base contains 229 rules. 388 rules in the queue.
600 rules inserted. The rule base contains 315 rules. 386 rules in the queue.
800 rules inserted. The rule base contains 435 rules. 386 rules in the queue.
1000 rules inserted. The rule base contains 441 rules. 378 rules in the queue.
1200 rules inserted. The rule base contains 459 rules. 360 rules in the queue.
1400 rules inserted. The rule base contains 545 rules. 322 rules in the queue.
1600 rules inserted. The rule base contains 701 rules. 383 rules in the queue.
1800 rules inserted. The rule base contains 723 rules. 786 rules in the queue.
2000 rules inserted. The rule base contains 749 rules. 1270 rules in the queue.
2200 rules inserted. The rule base contains 760 rules. 1906 rules in the queue.
2400 rules inserted. The rule base contains 791 rules. 2556 rules in the queue.
2600 rules inserted. The rule base contains 797 rules. 2686 rules in the queue.
2800 rules inserted. The rule base contains 814 rules. 2681 rules in the queue.
3000 rules inserted. The rule base contains 817 rules. 2641 rules in the queue.
3200 rules inserted. The rule base contains 827 rules. 2779 rules in the queue.
3400 rules inserted. The rule base contains 831 rules. 2764 rules in the queue.
3600 rules inserted. The rule base contains 830 rules. 2725 rules in the queue.
3800 rules inserted. The rule base contains 829 rules. 2780 rules in the queue.
4000 rules inserted. The rule base contains 845 rules. 2849 rules in the queue.
4200 rules inserted. The rule base contains 839 rules. 2808 rules in the queue.
4400 rules inserted. The rule base contains 853 rules. 2794 rules in the queue.
4600 rules inserted. The rule base contains 862 rules. 2932 rules in the queue.
4800 rules inserted. The rule base contains 858 rules. 2891 rules in the queue.
5000 rules inserted. The rule base contains 870 rules. 2877 rules in the queue.
5200 rules inserted. The rule base contains 860 rules. 2851 rules in the queue.
5400 rules inserted. The rule base contains 897 rules. 2814 rules in the queue.
5600 rules inserted. The rule base contains 900 rules. 2812 rules in the queue.
5800 rules inserted. The rule base contains 903 rules. 2797 rules in the queue.
6000 rules inserted. The rule base contains 905 rules. 2783 rules in the queue.
6200 rules inserted. The rule base contains 919 rules. 2769 rules in the queue.
6400 rules inserted. The rule base contains 933 rules. 2767 rules in the queue.
6600 rules inserted. The rule base contains 934 rules. 2743 rules in the queue.
6800 rules inserted. The rule base contains 941 rules. 2725 rules in the queue.
7000 rules inserted. The rule base contains 942 rules. 2724 rules in the queue.
7200 rules inserted. The rule base contains 957 rules. 2710 rules in the queue.
7400 rules inserted. The rule base contains 972 rules. 2695 rules in the queue.
7600 rules inserted. The rule base contains 963 rules. 2680 rules in the queue.
7800 rules inserted. The rule base contains 973 rules. 2670 rules in the queue.
8000 rules inserted. The rule base contains 986 rules. 2658 rules in the queue.
8200 rules inserted. The rule base contains 1089 rules. 2556 rules in the queue.
8400 rules inserted. The rule base contains 1127 rules. 2686 rules in the queue.
8600 rules inserted. The rule base contains 1152 rules. 2662 rules in the queue.
8800 rules inserted. The rule base contains 1176 rules. 2638 rules in the queue.
9000 rules inserted. The rule base contains 1239 rules. 2744 rules in the queue.
9200 rules inserted. The rule base contains 1263 rules. 2720 rules in the queue.
9400 rules inserted. The rule base contains 1322 rules. 2830 rules in the queue.
9600 rules inserted. The rule base contains 1346 rules. 2806 rules in the queue.
9800 rules inserted. The rule base contains 1403 rules. 2918 rules in the queue.
10000 rules inserted. The rule base contains 1425 rules. 2896 rules in the queue.
10200 rules inserted. The rule base contains 1447 rules. 2875 rules in the queue.
10400 rules inserted. The rule base contains 1483 rules. 2840 rules in the queue.
10600 rules inserted. The rule base contains 1539 rules. 2952 rules in the queue.
10800 rules inserted. The rule base contains 1588 rules. 3072 rules in the queue.
11000 rules inserted. The rule base contains 1659 rules. 3186 rules in the queue.
11200 rules inserted. The rule base contains 1768 rules. 3245 rules in the queue.
11400 rules inserted. The rule base contains 1836 rules. 3345 rules in the queue.
11600 rules inserted. The rule base contains 1878 rules. 3482 rules in the queue.
11800 rules inserted. The rule base contains 1989 rules. 3378 rules in the queue.
12000 rules inserted. The rule base contains 2071 rules. 3464 rules in the queue.
12200 rules inserted. The rule base contains 2121 rules. 3600 rules in the queue.
12400 rules inserted. The rule base contains 2210 rules. 3679 rules in the queue.
12600 rules inserted. The rule base contains 2276 rules. 3707 rules in the queue.
12800 rules inserted. The rule base contains 2359 rules. 3716 rules in the queue.
13000 rules inserted. The rule base contains 2421 rules. 3822 rules in the queue.
13200 rules inserted. The rule base contains 2527 rules. 3884 rules in the queue.
13400 rules inserted. The rule base contains 2572 rules. 3849 rules in the queue.
13600 rules inserted. The rule base contains 2659 rules. 3939 rules in the queue.
13800 rules inserted. The rule base contains 2722 rules. 4093 rules in the queue.
14000 rules inserted. The rule base contains 2751 rules. 4086 rules in the queue.
14200 rules inserted. The rule base contains 2798 rules. 4564 rules in the queue.
14400 rules inserted. The rule base contains 2867 rules. 4932 rules in the queue.
14600 rules inserted. The rule base contains 2908 rules. 5075 rules in the queue.
14800 rules inserted. The rule base contains 2977 rules. 5281 rules in the queue.
15000 rules inserted. The rule base contains 3009 rules. 5266 rules in the queue.
15200 rules inserted. The rule base contains 3056 rules. 5993 rules in the queue.
15400 rules inserted. The rule base contains 3134 rules. 6355 rules in the queue.
15600 rules inserted. The rule base contains 3164 rules. 6346 rules in the queue.
15800 rules inserted. The rule base contains 3233 rules. 6550 rules in the queue.
16000 rules inserted. The rule base contains 3271 rules. 6698 rules in the queue.
16200 rules inserted. The rule base contains 3311 rules. 7184 rules in the queue.
16400 rules inserted. The rule base contains 3363 rules. 7412 rules in the queue.
16600 rules inserted. The rule base contains 3421 rules. 7616 rules in the queue.
16800 rules inserted. The rule base contains 3485 rules. 7981 rules in the queue.
17000 rules inserted. The rule base contains 3540 rules. 8611 rules in the queue.
17200 rules inserted. The rule base contains 3574 rules. 8614 rules in the queue.
17400 rules inserted. The rule base contains 3629 rules. 9088 rules in the queue.
17600 rules inserted. The rule base contains 3656 rules. 9086 rules in the queue.
17800 rules inserted. The rule base contains 3719 rules. 9080 rules in the queue.
18000 rules inserted. The rule base contains 3760 rules. 9054 rules in the queue.
18200 rules inserted. The rule base contains 3819 rules. 9106 rules in the queue.
18400 rules inserted. The rule base contains 3857 rules. 9094 rules in the queue.
18600 rules inserted. The rule base contains 3902 rules. 9158 rules in the queue.
18800 rules inserted. The rule base contains 3944 rules. 9148 rules in the queue.
19000 rules inserted. The rule base contains 3979 rules. 9142 rules in the queue.
19200 rules inserted. The rule base contains 4029 rules. 9202 rules in the queue.
19400 rules inserted. The rule base contains 4074 rules. 9439 rules in the queue.
19600 rules inserted. The rule base contains 4118 rules. 9676 rules in the queue.
19800 rules inserted. The rule base contains 4153 rules. 9743 rules in the queue.
20000 rules inserted. The rule base contains 4203 rules. 9713 rules in the queue.
20200 rules inserted. The rule base contains 4257 rules. 9690 rules in the queue.
20400 rules inserted. The rule base contains 4292 rules. 9757 rules in the queue.
20600 rules inserted. The rule base contains 4343 rules. 9740 rules in the queue.
20800 rules inserted. The rule base contains 4391 rules. 9888 rules in the queue.
21000 rules inserted. The rule base contains 4429 rules. 9875 rules in the queue.
21200 rules inserted. The rule base contains 4471 rules. 9867 rules in the queue.
21400 rules inserted. The rule base contains 4517 rules. 10098 rules in the queue.
21600 rules inserted. The rule base contains 4560 rules. 10167 rules in the queue.
21800 rules inserted. The rule base contains 4614 rules. 10125 rules in the queue.
22000 rules inserted. The rule base contains 4657 rules. 10112 rules in the queue.
22200 rules inserted. The rule base contains 4708 rules. 10423 rules in the queue.
22400 rules inserted. The rule base contains 4737 rules. 10415 rules in the queue.
22600 rules inserted. The rule base contains 4786 rules. 10404 rules in the queue.
22800 rules inserted. The rule base contains 4829 rules. 10472 rules in the queue.
23000 rules inserted. The rule base contains 4864 rules. 10539 rules in the queue.
23200 rules inserted. The rule base contains 4924 rules. 10509 rules in the queue.
23400 rules inserted. The rule base contains 4968 rules. 10486 rules in the queue.
23600 rules inserted. The rule base contains 5011 rules. 10468 rules in the queue.
23800 rules inserted. The rule base contains 5061 rules. 10615 rules in the queue.
24000 rules inserted. The rule base contains 5105 rules. 10851 rules in the queue.
24200 rules inserted. The rule base contains 5134 rules. 10844 rules in the queue.
24400 rules inserted. The rule base contains 5181 rules. 11075 rules in the queue.
24600 rules inserted. The rule base contains 5229 rules. 11143 rules in the queue.
24800 rules inserted. The rule base contains 5264 rules. 11135 rules in the queue.
25000 rules inserted. The rule base contains 5302 rules. 11123 rules in the queue.
25200 rules inserted. The rule base contains 5359 rules. 11185 rules in the queue.
25400 rules inserted. The rule base contains 5409 rules. 11246 rules in the queue.
25600 rules inserted. The rule base contains 5455 rules. 11205 rules in the queue.
25800 rules inserted. The rule base contains 5499 rules. 11199 rules in the queue.
26000 rules inserted. The rule base contains 5540 rules. 11268 rules in the queue.
26200 rules inserted. The rule base contains 5585 rules. 11249 rules in the queue.
26400 rules inserted. The rule base contains 5647 rules. 11281 rules in the queue.
26600 rules inserted. The rule base contains 5715 rules. 11256 rules in the queue.
26800 rules inserted. The rule base contains 5794 rules. 11177 rules in the queue.
27000 rules inserted. The rule base contains 5849 rules. 11141 rules in the queue.
27200 rules inserted. The rule base contains 5898 rules. 11126 rules in the queue.
27400 rules inserted. The rule base contains 5925 rules. 11116 rules in the queue.
27600 rules inserted. The rule base contains 5981 rules. 11087 rules in the queue.
27800 rules inserted. The rule base contains 6015 rules. 11077 rules in the queue.
28000 rules inserted. The rule base contains 6063 rules. 11051 rules in the queue.
28200 rules inserted. The rule base contains 6106 rules. 11038 rules in the queue.
28400 rules inserted. The rule base contains 6141 rules. 11105 rules in the queue.
28600 rules inserted. The rule base contains 6203 rules. 11074 rules in the queue.
28800 rules inserted. The rule base contains 6246 rules. 11052 rules in the queue.
29000 rules inserted. The rule base contains 6289 rules. 11117 rules in the queue.
29200 rules inserted. The rule base contains 6331 rules. 11104 rules in the queue.
29400 rules inserted. The rule base contains 6399 rules. 11059 rules in the queue.
29600 rules inserted. The rule base contains 6476 rules. 10982 rules in the queue.
29800 rules inserted. The rule base contains 6522 rules. 10963 rules in the queue.
30000 rules inserted. The rule base contains 6556 rules. 10955 rules in the queue.
30200 rules inserted. The rule base contains 6598 rules. 10938 rules in the queue.
30400 rules inserted. The rule base contains 6633 rules. 10931 rules in the queue.
30600 rules inserted. The rule base contains 6672 rules. 10915 rules in the queue.
30800 rules inserted. The rule base contains 6721 rules. 10889 rules in the queue.
31000 rules inserted. The rule base contains 6763 rules. 10868 rules in the queue.
31200 rules inserted. The rule base contains 6822 rules. 10930 rules in the queue.
31400 rules inserted. The rule base contains 6852 rules. 10917 rules in the queue.
31600 rules inserted. The rule base contains 6921 rules. 10870 rules in the queue.
31800 rules inserted. The rule base contains 7003 rules. 10790 rules in the queue.
32000 rules inserted. The rule base contains 7036 rules. 10781 rules in the queue.
32200 rules inserted. The rule base contains 7073 rules. 10772 rules in the queue.
32400 rules inserted. The rule base contains 7130 rules. 10834 rules in the queue.
32600 rules inserted. The rule base contains 7176 rules. 10800 rules in the queue.
32800 rules inserted. The rule base contains 7225 rules. 10781 rules in the queue.
33000 rules inserted. The rule base contains 7252 rules. 10771 rules in the queue.
33200 rules inserted. The rule base contains 7297 rules. 10759 rules in the queue.
33400 rules inserted. The rule base contains 7347 rules. 10734 rules in the queue.
33600 rules inserted. The rule base contains 7439 rules. 10642 rules in the queue.
33800 rules inserted. The rule base contains 7480 rules. 10621 rules in the queue.
34000 rules inserted. The rule base contains 7528 rules. 10607 rules in the queue.
34200 rules inserted. The rule base contains 7554 rules. 10598 rules in the queue.
34400 rules inserted. The rule base contains 7605 rules. 10581 rules in the queue.
34600 rules inserted. The rule base contains 7655 rules. 10642 rules in the queue.
34800 rules inserted. The rule base contains 7704 rules. 10601 rules in the queue.
35000 rules inserted. The rule base contains 7745 rules. 10595 rules in the queue.
35200 rules inserted. The rule base contains 7788 rules. 10663 rules in the queue.
35400 rules inserted. The rule base contains 7827 rules. 10649 rules in the queue.
35600 rules inserted. The rule base contains 7882 rules. 10612 rules in the queue.
35800 rules inserted. The rule base contains 7926 rules. 10594 rules in the queue.
36000 rules inserted. The rule base contains 7960 rules. 10586 rules in the queue.
36200 rules inserted. The rule base contains 7997 rules. 10575 rules in the queue.
36400 rules inserted. The rule base contains 8036 rules. 10561 rules in the queue.
36600 rules inserted. The rule base contains 8135 rules. 10476 rules in the queue.
36800 rules inserted. The rule base contains 8185 rules. 10437 rules in the queue.
37000 rules inserted. The rule base contains 8227 rules. 10420 rules in the queue.
37200 rules inserted. The rule base contains 8261 rules. 10412 rules in the queue.
37400 rules inserted. The rule base contains 8311 rules. 10390 rules in the queue.
37600 rules inserted. The rule base contains 8402 rules. 10302 rules in the queue.
37800 rules inserted. The rule base contains 8501 rules. 10214 rules in the queue.
38000 rules inserted. The rule base contains 8560 rules. 10161 rules in the queue.
38200 rules inserted. The rule base contains 8624 rules. 10111 rules in the queue.
38400 rules inserted. The rule base contains 8671 rules. 10068 rules in the queue.
38600 rules inserted. The rule base contains 8745 rules. 9991 rules in the queue.
38800 rules inserted. The rule base contains 8829 rules. 9913 rules in the queue.
39000 rules inserted. The rule base contains 8882 rules. 9868 rules in the queue.
39200 rules inserted. The rule base contains 8924 rules. 9844 rules in the queue.
39400 rules inserted. The rule base contains 8966 rules. 9827 rules in the queue.
39600 rules inserted. The rule base contains 9043 rules. 9754 rules in the queue.
39800 rules inserted. The rule base contains 9111 rules. 9705 rules in the queue.
40000 rules inserted. The rule base contains 9149 rules. 9689 rules in the queue.
40200 rules inserted. The rule base contains 9205 rules. 9641 rules in the queue.
40400 rules inserted. The rule base contains 9279 rules. 9577 rules in the queue.
40600 rules inserted. The rule base contains 9344 rules. 9518 rules in the queue.
40800 rules inserted. The rule base contains 9406 rules. 9468 rules in the queue.
41000 rules inserted. The rule base contains 9449 rules. 9427 rules in the queue.
41200 rules inserted. The rule base contains 9514 rules. 9374 rules in the queue.
41400 rules inserted. The rule base contains 9558 rules. 9338 rules in the queue.
41600 rules inserted. The rule base contains 9660 rules. 9242 rules in the queue.
41800 rules inserted. The rule base contains 9712 rules. 9208 rules in the queue.
42000 rules inserted. The rule base contains 9739 rules. 9198 rules in the queue.
42200 rules inserted. The rule base contains 9799 rules. 9159 rules in the queue.
42400 rules inserted. The rule base contains 9874 rules. 9088 rules in the queue.
42600 rules inserted. The rule base contains 9947 rules. 9021 rules in the queue.
42800 rules inserted. The rule base contains 9998 rules. 8977 rules in the queue.
43000 rules inserted. The rule base contains 10033 rules. 8950 rules in the queue.
43200 rules inserted. The rule base contains 10102 rules. 8901 rules in the queue.
43400 rules inserted. The rule base contains 10176 rules. 8827 rules in the queue.
43600 rules inserted. The rule base contains 10238 rules. 8771 rules in the queue.
43800 rules inserted. The rule base contains 10291 rules. 8730 rules in the queue.
44000 rules inserted. The rule base contains 10340 rules. 8689 rules in the queue.
44200 rules inserted. The rule base contains 10435 rules. 8599 rules in the queue.
44400 rules inserted. The rule base contains 10486 rules. 8551 rules in the queue.
44600 rules inserted. The rule base contains 10543 rules. 8506 rules in the queue.
44800 rules inserted. The rule base contains 10587 rules. 8470 rules in the queue.
45000 rules inserted. The rule base contains 10631 rules. 8452 rules in the queue.
45200 rules inserted. The rule base contains 10694 rules. 8412 rules in the queue.
45400 rules inserted. The rule base contains 10770 rules. 8336 rules in the queue.
45600 rules inserted. The rule base contains 10819 rules. 8315 rules in the queue.
45800 rules inserted. The rule base contains 10867 rules. 8287 rules in the queue.
46000 rules inserted. The rule base contains 10920 rules. 8234 rules in the queue.
46200 rules inserted. The rule base contains 11008 rules. 8160 rules in the queue.
46400 rules inserted. The rule base contains 11077 rules. 8096 rules in the queue.
46600 rules inserted. The rule base contains 11128 rules. 8053 rules in the queue.
46800 rules inserted. The rule base contains 11185 rules. 8000 rules in the queue.
47000 rules inserted. The rule base contains 11239 rules. 7958 rules in the queue.
47200 rules inserted. The rule base contains 11320 rules. 7852 rules in the queue.
47400 rules inserted. The rule base contains 11370 rules. 7810 rules in the queue.
47600 rules inserted. The rule base contains 11432 rules. 7752 rules in the queue.
47800 rules inserted. The rule base contains 11477 rules. 7717 rules in the queue.
48000 rules inserted. The rule base contains 11335 rules. 7576 rules in the queue.
48200 rules inserted. The rule base contains 11429 rules. 7486 rules in the queue.
48400 rules inserted. The rule base contains 11541 rules. 7376 rules in the queue.
48600 rules inserted. The rule base contains 11650 rules. 7269 rules in the queue.
48800 rules inserted. The rule base contains 11737 rules. 7184 rules in the queue.
49000 rules inserted. The rule base contains 11813 rules. 7110 rules in the queue.
49200 rules inserted. The rule base contains 11871 rules. 7062 rules in the queue.
49400 rules inserted. The rule base contains 11952 rules. 6983 rules in the queue.
49600 rules inserted. The rule base contains 11996 rules. 6947 rules in the queue.
49800 rules inserted. The rule base contains 12093 rules. 6852 rules in the queue.
50000 rules inserted. The rule base contains 12177 rules. 6786 rules in the queue.
50200 rules inserted. The rule base contains 12281 rules. 6682 rules in the queue.
50400 rules inserted. The rule base contains 12374 rules. 6591 rules in the queue.
50600 rules inserted. The rule base contains 12477 rules. 6490 rules in the queue.
50800 rules inserted. The rule base contains 12575 rules. 6394 rules in the queue.
51000 rules inserted. The rule base contains 12650 rules. 6321 rules in the queue.
51200 rules inserted. The rule base contains 12721 rules. 6260 rules in the queue.
51400 rules inserted. The rule base contains 12815 rules. 6172 rules in the queue.
51600 rules inserted. The rule base contains 12905 rules. 6094 rules in the queue.
51800 rules inserted. The rule base contains 12979 rules. 6022 rules in the queue.
52000 rules inserted. The rule base contains 13022 rules. 5987 rules in the queue.
52200 rules inserted. The rule base contains 13121 rules. 5892 rules in the queue.
52400 rules inserted. The rule base contains 13223 rules. 5790 rules in the queue.
52600 rules inserted. The rule base contains 13319 rules. 5696 rules in the queue.
52800 rules inserted. The rule base contains 13409 rules. 5624 rules in the queue.
53000 rules inserted. The rule base contains 13513 rules. 5522 rules in the queue.
53200 rules inserted. The rule base contains 13617 rules. 5418 rules in the queue.
53400 rules inserted. The rule base contains 13673 rules. 5364 rules in the queue.
53600 rules inserted. The rule base contains 13730 rules. 5317 rules in the queue.
53800 rules inserted. The rule base contains 13806 rules. 5243 rules in the queue.
54000 rules inserted. The rule base contains 13861 rules. 5198 rules in the queue.
54200 rules inserted. The rule base contains 13967 rules. 5092 rules in the queue.
54400 rules inserted. The rule base contains 14065 rules. 4998 rules in the queue.
54600 rules inserted. The rule base contains 14169 rules. 4894 rules in the queue.
54800 rules inserted. The rule base contains 14283 rules. 4782 rules in the queue.
55000 rules inserted. The rule base contains 14354 rules. 4729 rules in the queue.
55200 rules inserted. The rule base contains 14457 rules. 4628 rules in the queue.
55400 rules inserted. The rule base contains 14559 rules. 4526 rules in the queue.
55600 rules inserted. The rule base contains 14629 rules. 4508 rules in the queue.
55800 rules inserted. The rule base contains 14695 rules. 4442 rules in the queue.
56000 rules inserted. The rule base contains 14747 rules. 4406 rules in the queue.
56200 rules inserted. The rule base contains 14839 rules. 4316 rules in the queue.
56400 rules inserted. The rule base contains 14929 rules. 4244 rules in the queue.
56600 rules inserted. The rule base contains 15015 rules. 4158 rules in the queue.
56800 rules inserted. The rule base contains 15087 rules. 4122 rules in the queue.
57000 rules inserted. The rule base contains 15153 rules. 4056 rules in the queue.
57200 rules inserted. The rule base contains 15205 rules. 4020 rules in the queue.
57400 rules inserted. The rule base contains 15317 rules. 3910 rules in the queue.
57600 rules inserted. The rule base contains 15383 rules. 3862 rules in the queue.
57800 rules inserted. The rule base contains 15467 rules. 3798 rules in the queue.
58000 rules inserted. The rule base contains 15564 rules. 3704 rules in the queue.
58200 rules inserted. The rule base contains 15613 rules. 3668 rules in the queue.
58400 rules inserted. The rule base contains 15685 rules. 3632 rules in the queue.
58600 rules inserted. The rule base contains 15751 rules. 3566 rules in the queue.
58800 rules inserted. The rule base contains 15855 rules. 3464 rules in the queue.
59000 rules inserted. The rule base contains 15931 rules. 3406 rules in the queue.
59200 rules inserted. The rule base contains 16019 rules. 3318 rules in the queue.
59400 rules inserted. The rule base contains 16071 rules. 3282 rules in the queue.
59600 rules inserted. The rule base contains 16130 rules. 3223 rules in the queue.
59800 rules inserted. The rule base contains 16209 rules. 3180 rules in the queue.
60000 rules inserted. The rule base contains 16279 rules. 3144 rules in the queue.
60200 rules inserted. The rule base contains 16356 rules. 3124 rules in the queue.
60400 rules inserted. The rule base contains 16419 rules. 3121 rules in the queue.
60600 rules inserted. The rule base contains 16486 rules. 3083 rules in the queue.
60800 rules inserted. The rule base contains 16546 rules. 3048 rules in the queue.
61000 rules inserted. The rule base contains 16623 rules. 3029 rules in the queue.
61200 rules inserted. The rule base contains 16681 rules. 3024 rules in the queue.
61400 rules inserted. The rule base contains 16739 rules. 2988 rules in the queue.
61600 rules inserted. The rule base contains 16811 rules. 2968 rules in the queue.
61800 rules inserted. The rule base contains 16889 rules. 2932 rules in the queue.
62000 rules inserted. The rule base contains 16951 rules. 2916 rules in the queue.
62200 rules inserted. The rule base contains 17007 rules. 2908 rules in the queue.
62400 rules inserted. The rule base contains 17079 rules. 2872 rules in the queue.
62600 rules inserted. The rule base contains 17139 rules. 2836 rules in the queue.
62800 rules inserted. The rule base contains 17209 rules. 2832 rules in the queue.
63000 rules inserted. The rule base contains 17281 rules. 2812 rules in the queue.
63200 rules inserted. The rule base contains 17366 rules. 2775 rules in the queue.
63400 rules inserted. The rule base contains 17459 rules. 2756 rules in the queue.
63600 rules inserted. The rule base contains 17538 rules. 2746 rules in the queue.
63800 rules inserted. The rule base contains 17616 rules. 2728 rules in the queue.
64000 rules inserted. The rule base contains 17715 rules. 2696 rules in the queue.
64200 rules inserted. The rule base contains 17802 rules. 2688 rules in the queue.
64400 rules inserted. The rule base contains 17878 rules. 2678 rules in the queue.
64600 rules inserted. The rule base contains 17969 rules. 2644 rules in the queue.
64800 rules inserted. The rule base contains 18058 rules. 2628 rules in the queue.
65000 rules inserted. The rule base contains 18161 rules. 2597 rules in the queue.
65200 rules inserted. The rule base contains 18230 rules. 2586 rules in the queue.
65400 rules inserted. The rule base contains 18308 rules. 2576 rules in the queue.
65600 rules inserted. The rule base contains 18400 rules. 2560 rules in the queue.
65800 rules inserted. The rule base contains 18499 rules. 2528 rules in the queue.
66000 rules inserted. The rule base contains 18613 rules. 2470 rules in the queue.
66200 rules inserted. The rule base contains 18732 rules. 2412 rules in the queue.
66400 rules inserted. The rule base contains 18839 rules. 2372 rules in the queue.
66600 rules inserted. The rule base contains 18944 rules. 2334 rules in the queue.
66800 rules inserted. The rule base contains 19061 rules. 2278 rules in the queue.
67000 rules inserted. The rule base contains 19173 rules. 2234 rules in the queue.
67200 rules inserted. The rule base contains 19287 rules. 2178 rules in the queue.
67400 rules inserted. The rule base contains 19398 rules. 2128 rules in the queue.
67600 rules inserted. The rule base contains 19517 rules. 2072 rules in the queue.
67800 rules inserted. The rule base contains 19623 rules. 2036 rules in the queue.
68000 rules inserted. The rule base contains 19723 rules. 2004 rules in the queue.
68200 rules inserted. The rule base contains 19846 rules. 1936 rules in the queue.
68400 rules inserted. The rule base contains 19962 rules. 1880 rules in the queue.
68600 rules inserted. The rule base contains 20112 rules. 1775 rules in the queue.
68800 rules inserted. The rule base contains 20246 rules. 1691 rules in the queue.
69000 rules inserted. The rule base contains 20385 rules. 1606 rules in the queue.
69200 rules inserted. The rule base contains 20533 rules. 1505 rules in the queue.
69400 rules inserted. The rule base contains 20671 rules. 1418 rules in the queue.
69600 rules inserted. The rule base contains 20812 rules. 1329 rules in the queue.
69800 rules inserted. The rule base contains 20957 rules. 1231 rules in the queue.
70000 rules inserted. The rule base contains 21087 rules. 1158 rules in the queue.
70200 rules inserted. The rule base contains 21243 rules. 1044 rules in the queue.
70400 rules inserted. The rule base contains 21391 rules. 929 rules in the queue.
70600 rules inserted. The rule base contains 21541 rules. 815 rules in the queue.
70800 rules inserted. The rule base contains 21689 rules. 693 rules in the queue.
71000 rules inserted. The rule base contains 21837 rules. 574 rules in the queue.
71200 rules inserted. The rule base contains 21987 rules. 459 rules in the queue.
71400 rules inserted. The rule base contains 22141 rules. 320 rules in the queue.
71600 rules inserted. The rule base contains 22297 rules. 173 rules in the queue.
71800 rules inserted. The rule base contains 22467 rules. 6 rules in the queue.
Starting query not attacker(mSrv(pub(skA[]),pub(skC[])))
RESULT not attacker(mSrv(pub(skA[]),pub(skC[]))) is true.
-- Query not attacker(mCli(pub(skA[]),pub(skC[])))
Completing...
200 rules inserted. The rule base contains 123 rules. 388 rules in the queue.
400 rules inserted. The rule base contains 229 rules. 388 rules in the queue.
600 rules inserted. The rule base contains 315 rules. 386 rules in the queue.
800 rules inserted. The rule base contains 435 rules. 386 rules in the queue.
1000 rules inserted. The rule base contains 441 rules. 378 rules in the queue.
1200 rules inserted. The rule base contains 459 rules. 360 rules in the queue.
1400 rules inserted. The rule base contains 545 rules. 322 rules in the queue.
1600 rules inserted. The rule base contains 701 rules. 383 rules in the queue.
1800 rules inserted. The rule base contains 723 rules. 786 rules in the queue.
2000 rules inserted. The rule base contains 749 rules. 1270 rules in the queue.
2200 rules inserted. The rule base contains 760 rules. 1906 rules in the queue.
2400 rules inserted. The rule base contains 791 rules. 2556 rules in the queue.
2600 rules inserted. The rule base contains 797 rules. 2686 rules in the queue.
2800 rules inserted. The rule base contains 814 rules. 2681 rules in the queue.
3000 rules inserted. The rule base contains 817 rules. 2641 rules in the queue.
3200 rules inserted. The rule base contains 827 rules. 2779 rules in the queue.
3400 rules inserted. The rule base contains 831 rules. 2764 rules in the queue.
3600 rules inserted. The rule base contains 830 rules. 2725 rules in the queue.
3800 rules inserted. The rule base contains 829 rules. 2780 rules in the queue.
4000 rules inserted. The rule base contains 845 rules. 2849 rules in the queue.
4200 rules inserted. The rule base contains 839 rules. 2808 rules in the queue.
4400 rules inserted. The rule base contains 853 rules. 2794 rules in the queue.
4600 rules inserted. The rule base contains 862 rules. 2932 rules in the queue.
4800 rules inserted. The rule base contains 858 rules. 2891 rules in the queue.
5000 rules inserted. The rule base contains 870 rules. 2877 rules in the queue.
5200 rules inserted. The rule base contains 860 rules. 2851 rules in the queue.
5400 rules inserted. The rule base contains 897 rules. 2814 rules in the queue.
5600 rules inserted. The rule base contains 900 rules. 2812 rules in the queue.
5800 rules inserted. The rule base contains 903 rules. 2797 rules in the queue.
6000 rules inserted. The rule base contains 905 rules. 2783 rules in the queue.
6200 rules inserted. The rule base contains 919 rules. 2769 rules in the queue.
6400 rules inserted. The rule base contains 933 rules. 2767 rules in the queue.
6600 rules inserted. The rule base contains 934 rules. 2743 rules in the queue.
6800 rules inserted. The rule base contains 941 rules. 2725 rules in the queue.
7000 rules inserted. The rule base contains 942 rules. 2724 rules in the queue.
7200 rules inserted. The rule base contains 957 rules. 2710 rules in the queue.
7400 rules inserted. The rule base contains 972 rules. 2695 rules in the queue.
7600 rules inserted. The rule base contains 963 rules. 2680 rules in the queue.
7800 rules inserted. The rule base contains 973 rules. 2670 rules in the queue.
8000 rules inserted. The rule base contains 986 rules. 2658 rules in the queue.
8200 rules inserted. The rule base contains 1089 rules. 2556 rules in the queue.
8400 rules inserted. The rule base contains 1127 rules. 2686 rules in the queue.
8600 rules inserted. The rule base contains 1152 rules. 2662 rules in the queue.
8800 rules inserted. The rule base contains 1176 rules. 2638 rules in the queue.
9000 rules inserted. The rule base contains 1239 rules. 2744 rules in the queue.
9200 rules inserted. The rule base contains 1263 rules. 2720 rules in the queue.
9400 rules inserted. The rule base contains 1322 rules. 2830 rules in the queue.
9600 rules inserted. The rule base contains 1346 rules. 2806 rules in the queue.
9800 rules inserted. The rule base contains 1403 rules. 2918 rules in the queue.
10000 rules inserted. The rule base contains 1425 rules. 2896 rules in the queue.
10200 rules inserted. The rule base contains 1447 rules. 2875 rules in the queue.
10400 rules inserted. The rule base contains 1483 rules. 2840 rules in the queue.
10600 rules inserted. The rule base contains 1539 rules. 2952 rules in the queue.
10800 rules inserted. The rule base contains 1588 rules. 3072 rules in the queue.
11000 rules inserted. The rule base contains 1659 rules. 3186 rules in the queue.
11200 rules inserted. The rule base contains 1768 rules. 3245 rules in the queue.
11400 rules inserted. The rule base contains 1836 rules. 3345 rules in the queue.
11600 rules inserted. The rule base contains 1878 rules. 3482 rules in the queue.
11800 rules inserted. The rule base contains 1989 rules. 3378 rules in the queue.
12000 rules inserted. The rule base contains 2071 rules. 3464 rules in the queue.
12200 rules inserted. The rule base contains 2121 rules. 3600 rules in the queue.
12400 rules inserted. The rule base contains 2210 rules. 3679 rules in the queue.
12600 rules inserted. The rule base contains 2276 rules. 3707 rules in the queue.
12800 rules inserted. The rule base contains 2359 rules. 3716 rules in the queue.
13000 rules inserted. The rule base contains 2421 rules. 3822 rules in the queue.
13200 rules inserted. The rule base contains 2527 rules. 3884 rules in the queue.
13400 rules inserted. The rule base contains 2572 rules. 3849 rules in the queue.
13600 rules inserted. The rule base contains 2659 rules. 3939 rules in the queue.
13800 rules inserted. The rule base contains 2722 rules. 4093 rules in the queue.
14000 rules inserted. The rule base contains 2751 rules. 4086 rules in the queue.
14200 rules inserted. The rule base contains 2798 rules. 4564 rules in the queue.
14400 rules inserted. The rule base contains 2867 rules. 4932 rules in the queue.
14600 rules inserted. The rule base contains 2908 rules. 5075 rules in the queue.
14800 rules inserted. The rule base contains 2977 rules. 5281 rules in the queue.
15000 rules inserted. The rule base contains 3009 rules. 5266 rules in the queue.
15200 rules inserted. The rule base contains 3056 rules. 5993 rules in the queue.
15400 rules inserted. The rule base contains 3134 rules. 6355 rules in the queue.
15600 rules inserted. The rule base contains 3164 rules. 6346 rules in the queue.
15800 rules inserted. The rule base contains 3233 rules. 6550 rules in the queue.
16000 rules inserted. The rule base contains 3271 rules. 6698 rules in the queue.
16200 rules inserted. The rule base contains 3311 rules. 7184 rules in the queue.
16400 rules inserted. The rule base contains 3363 rules. 7412 rules in the queue.
16600 rules inserted. The rule base contains 3421 rules. 7616 rules in the queue.
16800 rules inserted. The rule base contains 3485 rules. 7981 rules in the queue.
17000 rules inserted. The rule base contains 3540 rules. 8611 rules in the queue.
17200 rules inserted. The rule base contains 3574 rules. 8614 rules in the queue.
17400 rules inserted. The rule base contains 3629 rules. 9088 rules in the queue.
17600 rules inserted. The rule base contains 3656 rules. 9086 rules in the queue.
17800 rules inserted. The rule base contains 3719 rules. 9080 rules in the queue.
18000 rules inserted. The rule base contains 3760 rules. 9054 rules in the queue.
18200 rules inserted. The rule base contains 3819 rules. 9106 rules in the queue.
18400 rules inserted. The rule base contains 3857 rules. 9094 rules in the queue.
18600 rules inserted. The rule base contains 3902 rules. 9158 rules in the queue.
18800 rules inserted. The rule base contains 3944 rules. 9148 rules in the queue.
19000 rules inserted. The rule base contains 3979 rules. 9142 rules in the queue.
19200 rules inserted. The rule base contains 4029 rules. 9202 rules in the queue.
19400 rules inserted. The rule base contains 4074 rules. 9439 rules in the queue.
19600 rules inserted. The rule base contains 4118 rules. 9676 rules in the queue.
19800 rules inserted. The rule base contains 4153 rules. 9743 rules in the queue.
20000 rules inserted. The rule base contains 4203 rules. 9713 rules in the queue.
20200 rules inserted. The rule base contains 4257 rules. 9690 rules in the queue.
20400 rules inserted. The rule base contains 4292 rules. 9757 rules in the queue.
20600 rules inserted. The rule base contains 4343 rules. 9740 rules in the queue.
20800 rules inserted. The rule base contains 4391 rules. 9888 rules in the queue.
21000 rules inserted. The rule base contains 4429 rules. 9875 rules in the queue.
21200 rules inserted. The rule base contains 4471 rules. 9867 rules in the queue.
21400 rules inserted. The rule base contains 4517 rules. 10098 rules in the queue.
21600 rules inserted. The rule base contains 4560 rules. 10167 rules in the queue.
21800 rules inserted. The rule base contains 4614 rules. 10125 rules in the queue.
22000 rules inserted. The rule base contains 4657 rules. 10112 rules in the queue.
22200 rules inserted. The rule base contains 4708 rules. 10423 rules in the queue.
22400 rules inserted. The rule base contains 4737 rules. 10415 rules in the queue.
22600 rules inserted. The rule base contains 4786 rules. 10404 rules in the queue.
22800 rules inserted. The rule base contains 4829 rules. 10472 rules in the queue.
23000 rules inserted. The rule base contains 4864 rules. 10539 rules in the queue.
23200 rules inserted. The rule base contains 4924 rules. 10509 rules in the queue.
23400 rules inserted. The rule base contains 4968 rules. 10486 rules in the queue.
23600 rules inserted. The rule base contains 5011 rules. 10468 rules in the queue.
23800 rules inserted. The rule base contains 5061 rules. 10615 rules in the queue.
24000 rules inserted. The rule base contains 5105 rules. 10851 rules in the queue.
24200 rules inserted. The rule base contains 5134 rules. 10844 rules in the queue.
24400 rules inserted. The rule base contains 5181 rules. 11075 rules in the queue.
24600 rules inserted. The rule base contains 5229 rules. 11143 rules in the queue.
24800 rules inserted. The rule base contains 5264 rules. 11135 rules in the queue.
25000 rules inserted. The rule base contains 5302 rules. 11123 rules in the queue.
25200 rules inserted. The rule base contains 5359 rules. 11185 rules in the queue.
25400 rules inserted. The rule base contains 5409 rules. 11246 rules in the queue.
25600 rules inserted. The rule base contains 5455 rules. 11205 rules in the queue.
25800 rules inserted. The rule base contains 5499 rules. 11199 rules in the queue.
26000 rules inserted. The rule base contains 5540 rules. 11268 rules in the queue.
26200 rules inserted. The rule base contains 5585 rules. 11249 rules in the queue.
26400 rules inserted. The rule base contains 5647 rules. 11281 rules in the queue.
26600 rules inserted. The rule base contains 5715 rules. 11256 rules in the queue.
26800 rules inserted. The rule base contains 5794 rules. 11177 rules in the queue.
27000 rules inserted. The rule base contains 5849 rules. 11141 rules in the queue.
27200 rules inserted. The rule base contains 5898 rules. 11126 rules in the queue.
27400 rules inserted. The rule base contains 5925 rules. 11116 rules in the queue.
27600 rules inserted. The rule base contains 5981 rules. 11087 rules in the queue.
27800 rules inserted. The rule base contains 6015 rules. 11077 rules in the queue.
28000 rules inserted. The rule base contains 6063 rules. 11051 rules in the queue.
28200 rules inserted. The rule base contains 6106 rules. 11038 rules in the queue.
28400 rules inserted. The rule base contains 6141 rules. 11105 rules in the queue.
28600 rules inserted. The rule base contains 6203 rules. 11074 rules in the queue.
28800 rules inserted. The rule base contains 6246 rules. 11052 rules in the queue.
29000 rules inserted. The rule base contains 6289 rules. 11117 rules in the queue.
29200 rules inserted. The rule base contains 6331 rules. 11104 rules in the queue.
29400 rules inserted. The rule base contains 6399 rules. 11059 rules in the queue.
29600 rules inserted. The rule base contains 6476 rules. 10982 rules in the queue.
29800 rules inserted. The rule base contains 6522 rules. 10963 rules in the queue.
30000 rules inserted. The rule base contains 6556 rules. 10955 rules in the queue.
30200 rules inserted. The rule base contains 6598 rules. 10938 rules in the queue.
30400 rules inserted. The rule base contains 6633 rules. 10931 rules in the queue.
30600 rules inserted. The rule base contains 6672 rules. 10915 rules in the queue.
30800 rules inserted. The rule base contains 6721 rules. 10889 rules in the queue.
31000 rules inserted. The rule base contains 6763 rules. 10868 rules in the queue.
31200 rules inserted. The rule base contains 6822 rules. 10930 rules in the queue.
31400 rules inserted. The rule base contains 6852 rules. 10917 rules in the queue.
31600 rules inserted. The rule base contains 6921 rules. 10870 rules in the queue.
31800 rules inserted. The rule base contains 7003 rules. 10790 rules in the queue.
32000 rules inserted. The rule base contains 7036 rules. 10781 rules in the queue.
32200 rules inserted. The rule base contains 7073 rules. 10772 rules in the queue.
32400 rules inserted. The rule base contains 7130 rules. 10834 rules in the queue.
32600 rules inserted. The rule base contains 7176 rules. 10800 rules in the queue.
32800 rules inserted. The rule base contains 7225 rules. 10781 rules in the queue.
33000 rules inserted. The rule base contains 7252 rules. 10771 rules in the queue.
33200 rules inserted. The rule base contains 7297 rules. 10759 rules in the queue.
33400 rules inserted. The rule base contains 7347 rules. 10734 rules in the queue.
33600 rules inserted. The rule base contains 7439 rules. 10642 rules in the queue.
33800 rules inserted. The rule base contains 7480 rules. 10621 rules in the queue.
34000 rules inserted. The rule base contains 7528 rules. 10607 rules in the queue.
34200 rules inserted. The rule base contains 7554 rules. 10598 rules in the queue.
34400 rules inserted. The rule base contains 7605 rules. 10581 rules in the queue.
34600 rules inserted. The rule base contains 7655 rules. 10642 rules in the queue.
34800 rules inserted. The rule base contains 7704 rules. 10601 rules in the queue.
35000 rules inserted. The rule base contains 7745 rules. 10595 rules in the queue.
35200 rules inserted. The rule base contains 7788 rules. 10663 rules in the queue.
35400 rules inserted. The rule base contains 7827 rules. 10649 rules in the queue.
35600 rules inserted. The rule base contains 7882 rules. 10612 rules in the queue.
35800 rules inserted. The rule base contains 7926 rules. 10594 rules in the queue.
36000 rules inserted. The rule base contains 7960 rules. 10586 rules in the queue.
36200 rules inserted. The rule base contains 7997 rules. 10575 rules in the queue.
36400 rules inserted. The rule base contains 8036 rules. 10561 rules in the queue.
36600 rules inserted. The rule base contains 8135 rules. 10476 rules in the queue.
36800 rules inserted. The rule base contains 8185 rules. 10437 rules in the queue.
37000 rules inserted. The rule base contains 8227 rules. 10420 rules in the queue.
37200 rules inserted. The rule base contains 8261 rules. 10412 rules in the queue.
37400 rules inserted. The rule base contains 8311 rules. 10390 rules in the queue.
37600 rules inserted. The rule base contains 8402 rules. 10302 rules in the queue.
37800 rules inserted. The rule base contains 8501 rules. 10214 rules in the queue.
38000 rules inserted. The rule base contains 8560 rules. 10161 rules in the queue.
38200 rules inserted. The rule base contains 8624 rules. 10111 rules in the queue.
38400 rules inserted. The rule base contains 8671 rules. 10068 rules in the queue.
38600 rules inserted. The rule base contains 8745 rules. 9991 rules in the queue.
38800 rules inserted. The rule base contains 8829 rules. 9913 rules in the queue.
39000 rules inserted. The rule base contains 8882 rules. 9868 rules in the queue.
39200 rules inserted. The rule base contains 8924 rules. 9844 rules in the queue.
39400 rules inserted. The rule base contains 8966 rules. 9827 rules in the queue.
39600 rules inserted. The rule base contains 9043 rules. 9754 rules in the queue.
39800 rules inserted. The rule base contains 9111 rules. 9705 rules in the queue.
40000 rules inserted. The rule base contains 9149 rules. 9689 rules in the queue.
40200 rules inserted. The rule base contains 9205 rules. 9641 rules in the queue.
40400 rules inserted. The rule base contains 9279 rules. 9577 rules in the queue.
40600 rules inserted. The rule base contains 9344 rules. 9518 rules in the queue.
40800 rules inserted. The rule base contains 9406 rules. 9468 rules in the queue.
41000 rules inserted. The rule base contains 9449 rules. 9427 rules in the queue.
41200 rules inserted. The rule base contains 9514 rules. 9374 rules in the queue.
41400 rules inserted. The rule base contains 9558 rules. 9338 rules in the queue.
41600 rules inserted. The rule base contains 9660 rules. 9242 rules in the queue.
41800 rules inserted. The rule base contains 9712 rules. 9208 rules in the queue.
42000 rules inserted. The rule base contains 9739 rules. 9198 rules in the queue.
42200 rules inserted. The rule base contains 9799 rules. 9159 rules in the queue.
42400 rules inserted. The rule base contains 9874 rules. 9088 rules in the queue.
42600 rules inserted. The rule base contains 9947 rules. 9021 rules in the queue.
42800 rules inserted. The rule base contains 9998 rules. 8977 rules in the queue.
43000 rules inserted. The rule base contains 10033 rules. 8950 rules in the queue.
43200 rules inserted. The rule base contains 10102 rules. 8901 rules in the queue.
43400 rules inserted. The rule base contains 10176 rules. 8827 rules in the queue.
43600 rules inserted. The rule base contains 10238 rules. 8771 rules in the queue.
43800 rules inserted. The rule base contains 10291 rules. 8730 rules in the queue.
44000 rules inserted. The rule base contains 10340 rules. 8689 rules in the queue.
44200 rules inserted. The rule base contains 10435 rules. 8599 rules in the queue.
44400 rules inserted. The rule base contains 10486 rules. 8551 rules in the queue.
44600 rules inserted. The rule base contains 10543 rules. 8506 rules in the queue.
44800 rules inserted. The rule base contains 10587 rules. 8470 rules in the queue.
45000 rules inserted. The rule base contains 10631 rules. 8452 rules in the queue.
45200 rules inserted. The rule base contains 10694 rules. 8412 rules in the queue.
45400 rules inserted. The rule base contains 10770 rules. 8336 rules in the queue.
45600 rules inserted. The rule base contains 10819 rules. 8315 rules in the queue.
45800 rules inserted. The rule base contains 10867 rules. 8287 rules in the queue.
46000 rules inserted. The rule base contains 10920 rules. 8234 rules in the queue.
46200 rules inserted. The rule base contains 11008 rules. 8160 rules in the queue.
46400 rules inserted. The rule base contains 11077 rules. 8096 rules in the queue.
46600 rules inserted. The rule base contains 11128 rules. 8053 rules in the queue.
46800 rules inserted. The rule base contains 11185 rules. 8000 rules in the queue.
47000 rules inserted. The rule base contains 11239 rules. 7958 rules in the queue.
47200 rules inserted. The rule base contains 11320 rules. 7852 rules in the queue.
47400 rules inserted. The rule base contains 11370 rules. 7810 rules in the queue.
47600 rules inserted. The rule base contains 11432 rules. 7752 rules in the queue.
47800 rules inserted. The rule base contains 11477 rules. 7717 rules in the queue.
48000 rules inserted. The rule base contains 11335 rules. 7576 rules in the queue.
48200 rules inserted. The rule base contains 11429 rules. 7486 rules in the queue.
48400 rules inserted. The rule base contains 11541 rules. 7376 rules in the queue.
48600 rules inserted. The rule base contains 11650 rules. 7269 rules in the queue.
48800 rules inserted. The rule base contains 11737 rules. 7184 rules in the queue.
49000 rules inserted. The rule base contains 11813 rules. 7110 rules in the queue.
49200 rules inserted. The rule base contains 11871 rules. 7062 rules in the queue.
49400 rules inserted. The rule base contains 11952 rules. 6983 rules in the queue.
49600 rules inserted. The rule base contains 11996 rules. 6947 rules in the queue.
49800 rules inserted. The rule base contains 12093 rules. 6852 rules in the queue.
50000 rules inserted. The rule base contains 12177 rules. 6786 rules in the queue.
50200 rules inserted. The rule base contains 12281 rules. 6682 rules in the queue.
50400 rules inserted. The rule base contains 12374 rules. 6591 rules in the queue.
50600 rules inserted. The rule base contains 12477 rules. 6490 rules in the queue.
50800 rules inserted. The rule base contains 12575 rules. 6394 rules in the queue.
51000 rules inserted. The rule base contains 12650 rules. 6321 rules in the queue.
51200 rules inserted. The rule base contains 12721 rules. 6260 rules in the queue.
51400 rules inserted. The rule base contains 12815 rules. 6172 rules in the queue.
51600 rules inserted. The rule base contains 12905 rules. 6094 rules in the queue.
51800 rules inserted. The rule base contains 12979 rules. 6022 rules in the queue.
52000 rules inserted. The rule base contains 13022 rules. 5987 rules in the queue.
52200 rules inserted. The rule base contains 13121 rules. 5892 rules in the queue.
52400 rules inserted. The rule base contains 13223 rules. 5790 rules in the queue.
52600 rules inserted. The rule base contains 13319 rules. 5696 rules in the queue.
52800 rules inserted. The rule base contains 13409 rules. 5624 rules in the queue.
53000 rules inserted. The rule base contains 13513 rules. 5522 rules in the queue.
53200 rules inserted. The rule base contains 13617 rules. 5418 rules in the queue.
53400 rules inserted. The rule base contains 13673 rules. 5364 rules in the queue.
53600 rules inserted. The rule base contains 13730 rules. 5317 rules in the queue.
53800 rules inserted. The rule base contains 13806 rules. 5243 rules in the queue.
54000 rules inserted. The rule base contains 13861 rules. 5198 rules in the queue.
54200 rules inserted. The rule base contains 13967 rules. 5092 rules in the queue.
54400 rules inserted. The rule base contains 14065 rules. 4998 rules in the queue.
54600 rules inserted. The rule base contains 14169 rules. 4894 rules in the queue.
54800 rules inserted. The rule base contains 14283 rules. 4782 rules in the queue.
55000 rules inserted. The rule base contains 14354 rules. 4729 rules in the queue.
55200 rules inserted. The rule base contains 14457 rules. 4628 rules in the queue.
55400 rules inserted. The rule base contains 14559 rules. 4526 rules in the queue.
55600 rules inserted. The rule base contains 14629 rules. 4508 rules in the queue.
55800 rules inserted. The rule base contains 14695 rules. 4442 rules in the queue.
56000 rules inserted. The rule base contains 14747 rules. 4406 rules in the queue.
56200 rules inserted. The rule base contains 14839 rules. 4316 rules in the queue.
56400 rules inserted. The rule base contains 14929 rules. 4244 rules in the queue.
56600 rules inserted. The rule base contains 15015 rules. 4158 rules in the queue.
56800 rules inserted. The rule base contains 15087 rules. 4122 rules in the queue.
57000 rules inserted. The rule base contains 15153 rules. 4056 rules in the queue.
57200 rules inserted. The rule base contains 15205 rules. 4020 rules in the queue.
57400 rules inserted. The rule base contains 15317 rules. 3910 rules in the queue.
57600 rules inserted. The rule base contains 15383 rules. 3862 rules in the queue.
57800 rules inserted. The rule base contains 15467 rules. 3798 rules in the queue.
58000 rules inserted. The rule base contains 15564 rules. 3704 rules in the queue.
58200 rules inserted. The rule base contains 15613 rules. 3668 rules in the queue.
58400 rules inserted. The rule base contains 15685 rules. 3632 rules in the queue.
58600 rules inserted. The rule base contains 15751 rules. 3566 rules in the queue.
58800 rules inserted. The rule base contains 15855 rules. 3464 rules in the queue.
59000 rules inserted. The rule base contains 15931 rules. 3406 rules in the queue.
59200 rules inserted. The rule base contains 16019 rules. 3318 rules in the queue.
59400 rules inserted. The rule base contains 16071 rules. 3282 rules in the queue.
59600 rules inserted. The rule base contains 16130 rules. 3223 rules in the queue.
59800 rules inserted. The rule base contains 16209 rules. 3180 rules in the queue.
60000 rules inserted. The rule base contains 16279 rules. 3144 rules in the queue.
60200 rules inserted. The rule base contains 16356 rules. 3124 rules in the queue.
60400 rules inserted. The rule base contains 16419 rules. 3121 rules in the queue.
60600 rules inserted. The rule base contains 16486 rules. 3083 rules in the queue.
60800 rules inserted. The rule base contains 16546 rules. 3048 rules in the queue.
61000 rules inserted. The rule base contains 16623 rules. 3029 rules in the queue.
61200 rules inserted. The rule base contains 16681 rules. 3024 rules in the queue.
61400 rules inserted. The rule base contains 16739 rules. 2988 rules in the queue.
61600 rules inserted. The rule base contains 16811 rules. 2968 rules in the queue.
61800 rules inserted. The rule base contains 16889 rules. 2932 rules in the queue.
62000 rules inserted. The rule base contains 16951 rules. 2916 rules in the queue.
62200 rules inserted. The rule base contains 17007 rules. 2908 rules in the queue.
62400 rules inserted. The rule base contains 17079 rules. 2872 rules in the queue.
62600 rules inserted. The rule base contains 17139 rules. 2836 rules in the queue.
62800 rules inserted. The rule base contains 17209 rules. 2832 rules in the queue.
63000 rules inserted. The rule base contains 17281 rules. 2812 rules in the queue.
63200 rules inserted. The rule base contains 17366 rules. 2775 rules in the queue.
63400 rules inserted. The rule base contains 17459 rules. 2756 rules in the queue.
63600 rules inserted. The rule base contains 17538 rules. 2746 rules in the queue.
63800 rules inserted. The rule base contains 17616 rules. 2728 rules in the queue.
64000 rules inserted. The rule base contains 17715 rules. 2696 rules in the queue.
64200 rules inserted. The rule base contains 17802 rules. 2688 rules in the queue.
64400 rules inserted. The rule base contains 17878 rules. 2678 rules in the queue.
64600 rules inserted. The rule base contains 17969 rules. 2644 rules in the queue.
64800 rules inserted. The rule base contains 18058 rules. 2628 rules in the queue.
65000 rules inserted. The rule base contains 18161 rules. 2597 rules in the queue.
65200 rules inserted. The rule base contains 18230 rules. 2586 rules in the queue.
65400 rules inserted. The rule base contains 18308 rules. 2576 rules in the queue.
65600 rules inserted. The rule base contains 18400 rules. 2560 rules in the queue.
65800 rules inserted. The rule base contains 18499 rules. 2528 rules in the queue.
66000 rules inserted. The rule base contains 18613 rules. 2470 rules in the queue.
66200 rules inserted. The rule base contains 18732 rules. 2412 rules in the queue.
66400 rules inserted. The rule base contains 18839 rules. 2372 rules in the queue.
66600 rules inserted. The rule base contains 18944 rules. 2334 rules in the queue.
66800 rules inserted. The rule base contains 19061 rules. 2278 rules in the queue.
67000 rules inserted. The rule base contains 19173 rules. 2234 rules in the queue.
67200 rules inserted. The rule base contains 19287 rules. 2178 rules in the queue.
67400 rules inserted. The rule base contains 19398 rules. 2128 rules in the queue.
67600 rules inserted. The rule base contains 19517 rules. 2072 rules in the queue.
67800 rules inserted. The rule base contains 19623 rules. 2036 rules in the queue.
68000 rules inserted. The rule base contains 19723 rules. 2004 rules in the queue.
68200 rules inserted. The rule base contains 19846 rules. 1936 rules in the queue.
68400 rules inserted. The rule base contains 19962 rules. 1880 rules in the queue.
68600 rules inserted. The rule base contains 20112 rules. 1775 rules in the queue.
68800 rules inserted. The rule base contains 20246 rules. 1691 rules in the queue.
69000 rules inserted. The rule base contains 20385 rules. 1606 rules in the queue.
69200 rules inserted. The rule base contains 20533 rules. 1505 rules in the queue.
69400 rules inserted. The rule base contains 20671 rules. 1418 rules in the queue.
69600 rules inserted. The rule base contains 20812 rules. 1329 rules in the queue.
69800 rules inserted. The rule base contains 20957 rules. 1231 rules in the queue.
70000 rules inserted. The rule base contains 21087 rules. 1158 rules in the queue.
70200 rules inserted. The rule base contains 21243 rules. 1044 rules in the queue.
70400 rules inserted. The rule base contains 21391 rules. 929 rules in the queue.
70600 rules inserted. The rule base contains 21541 rules. 815 rules in the queue.
70800 rules inserted. The rule base contains 21689 rules. 693 rules in the queue.
71000 rules inserted. The rule base contains 21837 rules. 574 rules in the queue.
71200 rules inserted. The rule base contains 21987 rules. 459 rules in the queue.
71400 rules inserted. The rule base contains 22141 rules. 320 rules in the queue.
71600 rules inserted. The rule base contains 22297 rules. 173 rules in the queue.
71800 rules inserted. The rule base contains 22467 rules. 6 rules in the queue.
Starting query not attacker(mCli(pub(skA[]),pub(skC[])))
RESULT not attacker(mCli(pub(skA[]),pub(skC[]))) is true.
