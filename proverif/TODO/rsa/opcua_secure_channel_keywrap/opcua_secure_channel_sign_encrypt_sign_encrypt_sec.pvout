Linear part:
exp(exp(g,x_32),y) = exp(exp(g,y),x_32)
Completing equations...
Completed equations:
exp(exp(g,x_32),y) = exp(exp(g,y),x_32)
Convergent part:
Completing equations...
Completed equations:
Process:
{1}let pkA: bitstring = pub(skA) in
{2}out(c, pkA);
{3}let pkB: bitstring = pub(skB) in
{4}out(c, pkB);
{5}let pkC: bitstring = pub(skC) in
{6}out(c, pkC);
(
    {7}!
    {8}in(c, (Cli: host,Disco: host,Sess: host));
    {9}let v_519: bool = (Cli = A) in
    (
        {10}if v_519 then
        (
            {11}let skCli: bitstring = skA in
            {12}let pkCli: bitstring = pub(skCli) in
            {13}let v_520: bool = (Disco = A) in
            (
                {14}if v_520 then
                (
                    {15}let pkDisco: bitstring = pub(skA) in
                    {16}let v_521: bool = (Sess = A) in
                    (
                        {17}if v_521 then
                        (
                            {18}let pkSess: bitstring = pub(skA) in
                            {19}out(c, GetEndpointRequest);
                            {20}in(c, (=GetEndpointResponse,=pkSess,=SignAndEncrypt,SP: bitstring,UP: bitstring));
                            {21}new Nc: bitstring;
                            {22}let m1: bitstring = (OpenSecureChannelRequest,pkCli,Nc) in
                            {23}out(c, (pkCli,enc(m1,pkSess),sign(h(m1),skCli)));
                            {24}in(c, (em2: bitstring,sigM2: bitstring));
                            {25}let m2: bitstring = dec(em2,skCli) in
                            {26}if (verify(h(m2),sigM2,pkSess) <> true) then
                                0
                            else
                                {27}let (=OpenSecureChannelResponse,Ns: bitstring,ST: bitstring,TTL: bitstring) = m2 in
                                {28}let Kcli: bitstring = h((Nc,Ns)) in
                                {29}out(c, senc(mCli(pkCli,pkSess),Kcli))
                        )
                        else
                            {30}let v_522: bool = (Sess = B) in
                            (
                                {31}if v_522 then
                                (
                                    {32}let pkSess_523: bitstring = pub(skB) in
                                    {33}out(c, GetEndpointRequest);
                                    {34}in(c, (=GetEndpointResponse,=pkSess_523,=SignAndEncrypt,SP_524: bitstring,UP_525: bitstring));
                                    {35}new Nc_526: bitstring;
                                    {36}let m1_527: bitstring = (OpenSecureChannelRequest,pkCli,Nc_526) in
                                    {37}out(c, (pkCli,enc(m1_527,pkSess_523),sign(h(m1_527),skCli)));
                                    {38}in(c, (em2_528: bitstring,sigM2_529: bitstring));
                                    {39}let m2_530: bitstring = dec(em2_528,skCli) in
                                    {40}if (verify(h(m2_530),sigM2_529,pkSess_523) <> true) then
                                        0
                                    else
                                        {41}let (=OpenSecureChannelResponse,Ns_531: bitstring,ST_532: bitstring,TTL_533: bitstring) = m2_530 in
                                        {42}let Kcli_534: bitstring = h((Nc_526,Ns_531)) in
                                        {43}out(c, senc(mCli(pkCli,pkSess_523),Kcli_534))
                                )
                                else
                                    {44}let v_535: bool = (Sess = C) in
                                    (
                                        {45}if v_535 then
                                        (
                                            {46}let pkSess_536: bitstring = pub(skC) in
                                            {47}out(c, GetEndpointRequest);
                                            {48}in(c, (=GetEndpointResponse,=pkSess_536,=SignAndEncrypt,SP_537: bitstring,UP_538: bitstring));
                                            {49}new Nc_539: bitstring;
                                            {50}let m1_540: bitstring = (OpenSecureChannelRequest,pkCli,Nc_539) in
                                            {51}out(c, (pkCli,enc(m1_540,pkSess_536),sign(h(m1_540),skCli)));
                                            {52}in(c, (em2_541: bitstring,sigM2_542: bitstring));
                                            {53}let m2_543: bitstring = dec(em2_541,skCli) in
                                            {54}if (verify(h(m2_543),sigM2_542,pkSess_536) <> true) then
                                                0
                                            else
                                                {55}let (=OpenSecureChannelResponse,Ns_544: bitstring,ST_545: bitstring,TTL_546: bitstring) = m2_543 in
                                                {56}let Kcli_547: bitstring = h((Nc_539,Ns_544)) in
                                                {57}out(c, senc(mCli(pkCli,pkSess_536),Kcli_547))
                                        )
                                        else
                                            {58}let pkSess_548: bitstring = pub(sk(Sess)) in
                                            {59}out(c, GetEndpointRequest);
                                            {60}in(c, (=GetEndpointResponse,=pkSess_548,=SignAndEncrypt,SP_549: bitstring,UP_550: bitstring));
                                            {61}new Nc_551: bitstring;
                                            {62}let m1_552: bitstring = (OpenSecureChannelRequest,pkCli,Nc_551) in
                                            {63}out(c, (pkCli,enc(m1_552,pkSess_548),sign(h(m1_552),skCli)));
                                            {64}in(c, (em2_553: bitstring,sigM2_554: bitstring));
                                            {65}let m2_555: bitstring = dec(em2_553,skCli) in
                                            {66}if (verify(h(m2_555),sigM2_554,pkSess_548) <> true) then
                                                0
                                            else
                                                {67}let (=OpenSecureChannelResponse,Ns_556: bitstring,ST_557: bitstring,TTL_558: bitstring) = m2_555 in
                                                {68}let Kcli_559: bitstring = h((Nc_551,Ns_556)) in
                                                {69}out(c, senc(mCli(pkCli,pkSess_548),Kcli_559))
                                    )
                                    else
                                        {70}let pkSess_560: bitstring = fail-any in
                                        {71}out(c, GetEndpointRequest);
                                        {72}in(c, (=GetEndpointResponse,=pkSess_560,=SignAndEncrypt,SP_561: bitstring,UP_562: bitstring));
                                        {73}new Nc_563: bitstring;
                                        {74}let m1_564: bitstring = (OpenSecureChannelRequest,pkCli,Nc_563) in
                                        {75}out(c, (pkCli,enc(m1_564,pkSess_560),sign(h(m1_564),skCli)));
                                        {76}in(c, (em2_565: bitstring,sigM2_566: bitstring));
                                        {77}let m2_567: bitstring = dec(em2_565,skCli) in
                                        {78}if (verify(h(m2_567),sigM2_566,pkSess_560) <> true) then
                                            0
                                        else
                                            {79}let (=OpenSecureChannelResponse,Ns_568: bitstring,ST_569: bitstring,TTL_570: bitstring) = m2_567 in
                                            {80}let Kcli_571: bitstring = h((Nc_563,Ns_568)) in
                                            {81}out(c, senc(mCli(pkCli,pkSess_560),Kcli_571))
                            )
                            else
                                {82}let pkSess_572: bitstring = fail-any in
                                {83}out(c, GetEndpointRequest);
                                {84}in(c, (=GetEndpointResponse,=pkSess_572,=SignAndEncrypt,SP_573: bitstring,UP_574: bitstring));
                                {85}new Nc_575: bitstring;
                                {86}let m1_576: bitstring = (OpenSecureChannelRequest,pkCli,Nc_575) in
                                {87}out(c, (pkCli,enc(m1_576,pkSess_572),sign(h(m1_576),skCli)));
                                {88}in(c, (em2_577: bitstring,sigM2_578: bitstring));
                                {89}let m2_579: bitstring = dec(em2_577,skCli) in
                                {90}if (verify(h(m2_579),sigM2_578,pkSess_572) <> true) then
                                    0
                                else
                                    {91}let (=OpenSecureChannelResponse,Ns_580: bitstring,ST_581: bitstring,TTL_582: bitstring) = m2_579 in
                                    {92}let Kcli_583: bitstring = h((Nc_575,Ns_580)) in
                                    {93}out(c, senc(mCli(pkCli,pkSess_572),Kcli_583))
                    )
                    else
                        {94}let pkSess_584: bitstring = fail-any in
                        {95}out(c, GetEndpointRequest);
                        {96}in(c, (=GetEndpointResponse,=pkSess_584,=SignAndEncrypt,SP_585: bitstring,UP_586: bitstring));
                        {97}new Nc_587: bitstring;
                        {98}let m1_588: bitstring = (OpenSecureChannelRequest,pkCli,Nc_587) in
                        {99}out(c, (pkCli,enc(m1_588,pkSess_584),sign(h(m1_588),skCli)));
                        {100}in(c, (em2_589: bitstring,sigM2_590: bitstring));
                        {101}let m2_591: bitstring = dec(em2_589,skCli) in
                        {102}if (verify(h(m2_591),sigM2_590,pkSess_584) <> true) then
                            0
                        else
                            {103}let (=OpenSecureChannelResponse,Ns_592: bitstring,ST_593: bitstring,TTL_594: bitstring) = m2_591 in
                            {104}let Kcli_595: bitstring = h((Nc_587,Ns_592)) in
                            {105}out(c, senc(mCli(pkCli,pkSess_584),Kcli_595))
                )
                else
                    {106}let v_596: bool = (Disco = B) in
                    (
                        {107}if v_596 then
                        (
                            {108}let pkDisco_597: bitstring = pub(skB) in
                            {109}let v_598: bool = (Sess = A) in
                            (
                                {110}if v_598 then
                                (
                                    {111}let pkSess_599: bitstring = pub(skA) in
                                    {112}out(c, GetEndpointRequest);
                                    {113}in(c, (=GetEndpointResponse,=pkSess_599,=SignAndEncrypt,SP_600: bitstring,UP_601: bitstring));
                                    {114}new Nc_602: bitstring;
                                    {115}let m1_603: bitstring = (OpenSecureChannelRequest,pkCli,Nc_602) in
                                    {116}out(c, (pkCli,enc(m1_603,pkSess_599),sign(h(m1_603),skCli)));
                                    {117}in(c, (em2_604: bitstring,sigM2_605: bitstring));
                                    {118}let m2_606: bitstring = dec(em2_604,skCli) in
                                    {119}if (verify(h(m2_606),sigM2_605,pkSess_599) <> true) then
                                        0
                                    else
                                        {120}let (=OpenSecureChannelResponse,Ns_607: bitstring,ST_608: bitstring,TTL_609: bitstring) = m2_606 in
                                        {121}let Kcli_610: bitstring = h((Nc_602,Ns_607)) in
                                        {122}out(c, senc(mCli(pkCli,pkSess_599),Kcli_610))
                                )
                                else
                                    {123}let v_611: bool = (Sess = B) in
                                    (
                                        {124}if v_611 then
                                        (
                                            {125}let pkSess_612: bitstring = pub(skB) in
                                            {126}out(c, GetEndpointRequest);
                                            {127}in(c, (=GetEndpointResponse,=pkSess_612,=SignAndEncrypt,SP_613: bitstring,UP_614: bitstring));
                                            {128}new Nc_615: bitstring;
                                            {129}let m1_616: bitstring = (OpenSecureChannelRequest,pkCli,Nc_615) in
                                            {130}out(c, (pkCli,enc(m1_616,pkSess_612),sign(h(m1_616),skCli)));
                                            {131}in(c, (em2_617: bitstring,sigM2_618: bitstring));
                                            {132}let m2_619: bitstring = dec(em2_617,skCli) in
                                            {133}if (verify(h(m2_619),sigM2_618,pkSess_612) <> true) then
                                                0
                                            else
                                                {134}let (=OpenSecureChannelResponse,Ns_620: bitstring,ST_621: bitstring,TTL_622: bitstring) = m2_619 in
                                                {135}let Kcli_623: bitstring = h((Nc_615,Ns_620)) in
                                                {136}out(c, senc(mCli(pkCli,pkSess_612),Kcli_623))
                                        )
                                        else
                                            {137}let v_624: bool = (Sess = C) in
                                            (
                                                {138}if v_624 then
                                                (
                                                    {139}let pkSess_625: bitstring = pub(skC) in
                                                    {140}out(c, GetEndpointRequest);
                                                    {141}in(c, (=GetEndpointResponse,=pkSess_625,=SignAndEncrypt,SP_626: bitstring,UP_627: bitstring));
                                                    {142}new Nc_628: bitstring;
                                                    {143}let m1_629: bitstring = (OpenSecureChannelRequest,pkCli,Nc_628) in
                                                    {144}out(c, (pkCli,enc(m1_629,pkSess_625),sign(h(m1_629),skCli)));
                                                    {145}in(c, (em2_630: bitstring,sigM2_631: bitstring));
                                                    {146}let m2_632: bitstring = dec(em2_630,skCli) in
                                                    {147}if (verify(h(m2_632),sigM2_631,pkSess_625) <> true) then
                                                        0
                                                    else
                                                        {148}let (=OpenSecureChannelResponse,Ns_633: bitstring,ST_634: bitstring,TTL_635: bitstring) = m2_632 in
                                                        {149}let Kcli_636: bitstring = h((Nc_628,Ns_633)) in
                                                        {150}out(c, senc(mCli(pkCli,pkSess_625),Kcli_636))
                                                )
                                                else
                                                    {151}let pkSess_637: bitstring = pub(sk(Sess)) in
                                                    {152}out(c, GetEndpointRequest);
                                                    {153}in(c, (=GetEndpointResponse,=pkSess_637,=SignAndEncrypt,SP_638: bitstring,UP_639: bitstring));
                                                    {154}new Nc_640: bitstring;
                                                    {155}let m1_641: bitstring = (OpenSecureChannelRequest,pkCli,Nc_640) in
                                                    {156}out(c, (pkCli,enc(m1_641,pkSess_637),sign(h(m1_641),skCli)));
                                                    {157}in(c, (em2_642: bitstring,sigM2_643: bitstring));
                                                    {158}let m2_644: bitstring = dec(em2_642,skCli) in
                                                    {159}if (verify(h(m2_644),sigM2_643,pkSess_637) <> true) then
                                                        0
                                                    else
                                                        {160}let (=OpenSecureChannelResponse,Ns_645: bitstring,ST_646: bitstring,TTL_647: bitstring) = m2_644 in
                                                        {161}let Kcli_648: bitstring = h((Nc_640,Ns_645)) in
                                                        {162}out(c, senc(mCli(pkCli,pkSess_637),Kcli_648))
                                            )
                                            else
                                                {163}let pkSess_649: bitstring = fail-any in
                                                {164}out(c, GetEndpointRequest);
                                                {165}in(c, (=GetEndpointResponse,=pkSess_649,=SignAndEncrypt,SP_650: bitstring,UP_651: bitstring));
                                                {166}new Nc_652: bitstring;
                                                {167}let m1_653: bitstring = (OpenSecureChannelRequest,pkCli,Nc_652) in
                                                {168}out(c, (pkCli,enc(m1_653,pkSess_649),sign(h(m1_653),skCli)));
                                                {169}in(c, (em2_654: bitstring,sigM2_655: bitstring));
                                                {170}let m2_656: bitstring = dec(em2_654,skCli) in
                                                {171}if (verify(h(m2_656),sigM2_655,pkSess_649) <> true) then
                                                    0
                                                else
                                                    {172}let (=OpenSecureChannelResponse,Ns_657: bitstring,ST_658: bitstring,TTL_659: bitstring) = m2_656 in
                                                    {173}let Kcli_660: bitstring = h((Nc_652,Ns_657)) in
                                                    {174}out(c, senc(mCli(pkCli,pkSess_649),Kcli_660))
                                    )
                                    else
                                        {175}let pkSess_661: bitstring = fail-any in
                                        {176}out(c, GetEndpointRequest);
                                        {177}in(c, (=GetEndpointResponse,=pkSess_661,=SignAndEncrypt,SP_662: bitstring,UP_663: bitstring));
                                        {178}new Nc_664: bitstring;
                                        {179}let m1_665: bitstring = (OpenSecureChannelRequest,pkCli,Nc_664) in
                                        {180}out(c, (pkCli,enc(m1_665,pkSess_661),sign(h(m1_665),skCli)));
                                        {181}in(c, (em2_666: bitstring,sigM2_667: bitstring));
                                        {182}let m2_668: bitstring = dec(em2_666,skCli) in
                                        {183}if (verify(h(m2_668),sigM2_667,pkSess_661) <> true) then
                                            0
                                        else
                                            {184}let (=OpenSecureChannelResponse,Ns_669: bitstring,ST_670: bitstring,TTL_671: bitstring) = m2_668 in
                                            {185}let Kcli_672: bitstring = h((Nc_664,Ns_669)) in
                                            {186}out(c, senc(mCli(pkCli,pkSess_661),Kcli_672))
                            )
                            else
                                {187}let pkSess_673: bitstring = fail-any in
                                {188}out(c, GetEndpointRequest);
                                {189}in(c, (=GetEndpointResponse,=pkSess_673,=SignAndEncrypt,SP_674: bitstring,UP_675: bitstring));
                                {190}new Nc_676: bitstring;
                                {191}let m1_677: bitstring = (OpenSecureChannelRequest,pkCli,Nc_676) in
                                {192}out(c, (pkCli,enc(m1_677,pkSess_673),sign(h(m1_677),skCli)));
                                {193}in(c, (em2_678: bitstring,sigM2_679: bitstring));
                                {194}let m2_680: bitstring = dec(em2_678,skCli) in
                                {195}if (verify(h(m2_680),sigM2_679,pkSess_673) <> true) then
                                    0
                                else
                                    {196}let (=OpenSecureChannelResponse,Ns_681: bitstring,ST_682: bitstring,TTL_683: bitstring) = m2_680 in
                                    {197}let Kcli_684: bitstring = h((Nc_676,Ns_681)) in
                                    {198}out(c, senc(mCli(pkCli,pkSess_673),Kcli_684))
                        )
                        else
                            {199}let v_685: bool = (Disco = C) in
                            (
                                {200}if v_685 then
                                (
                                    {201}let pkDisco_686: bitstring = pub(skC) in
                                    {202}let v_687: bool = (Sess = A) in
                                    (
                                        {203}if v_687 then
                                        (
                                            {204}let pkSess_688: bitstring = pub(skA) in
                                            {205}out(c, GetEndpointRequest);
                                            {206}in(c, (=GetEndpointResponse,=pkSess_688,=SignAndEncrypt,SP_689: bitstring,UP_690: bitstring));
                                            {207}new Nc_691: bitstring;
                                            {208}let m1_692: bitstring = (OpenSecureChannelRequest,pkCli,Nc_691) in
                                            {209}out(c, (pkCli,enc(m1_692,pkSess_688),sign(h(m1_692),skCli)));
                                            {210}in(c, (em2_693: bitstring,sigM2_694: bitstring));
                                            {211}let m2_695: bitstring = dec(em2_693,skCli) in
                                            {212}if (verify(h(m2_695),sigM2_694,pkSess_688) <> true) then
                                                0
                                            else
                                                {213}let (=OpenSecureChannelResponse,Ns_696: bitstring,ST_697: bitstring,TTL_698: bitstring) = m2_695 in
                                                {214}let Kcli_699: bitstring = h((Nc_691,Ns_696)) in
                                                {215}out(c, senc(mCli(pkCli,pkSess_688),Kcli_699))
                                        )
                                        else
                                            {216}let v_700: bool = (Sess = B) in
                                            (
                                                {217}if v_700 then
                                                (
                                                    {218}let pkSess_701: bitstring = pub(skB) in
                                                    {219}out(c, GetEndpointRequest);
                                                    {220}in(c, (=GetEndpointResponse,=pkSess_701,=SignAndEncrypt,SP_702: bitstring,UP_703: bitstring));
                                                    {221}new Nc_704: bitstring;
                                                    {222}let m1_705: bitstring = (OpenSecureChannelRequest,pkCli,Nc_704) in
                                                    {223}out(c, (pkCli,enc(m1_705,pkSess_701),sign(h(m1_705),skCli)));
                                                    {224}in(c, (em2_706: bitstring,sigM2_707: bitstring));
                                                    {225}let m2_708: bitstring = dec(em2_706,skCli) in
                                                    {226}if (verify(h(m2_708),sigM2_707,pkSess_701) <> true) then
                                                        0
                                                    else
                                                        {227}let (=OpenSecureChannelResponse,Ns_709: bitstring,ST_710: bitstring,TTL_711: bitstring) = m2_708 in
                                                        {228}let Kcli_712: bitstring = h((Nc_704,Ns_709)) in
                                                        {229}out(c, senc(mCli(pkCli,pkSess_701),Kcli_712))
                                                )
                                                else
                                                    {230}let v_713: bool = (Sess = C) in
                                                    (
                                                        {231}if v_713 then
                                                        (
                                                            {232}let pkSess_714: bitstring = pub(skC) in
                                                            {233}out(c, GetEndpointRequest);
                                                            {234}in(c, (=GetEndpointResponse,=pkSess_714,=SignAndEncrypt,SP_715: bitstring,UP_716: bitstring));
                                                            {235}new Nc_717: bitstring;
                                                            {236}let m1_718: bitstring = (OpenSecureChannelRequest,pkCli,Nc_717) in
                                                            {237}out(c, (pkCli,enc(m1_718,pkSess_714),sign(h(m1_718),skCli)));
                                                            {238}in(c, (em2_719: bitstring,sigM2_720: bitstring));
                                                            {239}let m2_721: bitstring = dec(em2_719,skCli) in
                                                            {240}if (verify(h(m2_721),sigM2_720,pkSess_714) <> true) then
                                                                0
                                                            else
                                                                {241}let (=OpenSecureChannelResponse,Ns_722: bitstring,ST_723: bitstring,TTL_724: bitstring) = m2_721 in
                                                                {242}let Kcli_725: bitstring = h((Nc_717,Ns_722)) in
                                                                {243}out(c, senc(mCli(pkCli,pkSess_714),Kcli_725))
                                                        )
                                                        else
                                                            {244}let pkSess_726: bitstring = pub(sk(Sess)) in
                                                            {245}out(c, GetEndpointRequest);
                                                            {246}in(c, (=GetEndpointResponse,=pkSess_726,=SignAndEncrypt,SP_727: bitstring,UP_728: bitstring));
                                                            {247}new Nc_729: bitstring;
                                                            {248}let m1_730: bitstring = (OpenSecureChannelRequest,pkCli,Nc_729) in
                                                            {249}out(c, (pkCli,enc(m1_730,pkSess_726),sign(h(m1_730),skCli)));
                                                            {250}in(c, (em2_731: bitstring,sigM2_732: bitstring));
                                                            {251}let m2_733: bitstring = dec(em2_731,skCli) in
                                                            {252}if (verify(h(m2_733),sigM2_732,pkSess_726) <> true) then
                                                                0
                                                            else
                                                                {253}let (=OpenSecureChannelResponse,Ns_734: bitstring,ST_735: bitstring,TTL_736: bitstring) = m2_733 in
                                                                {254}let Kcli_737: bitstring = h((Nc_729,Ns_734)) in
                                                                {255}out(c, senc(mCli(pkCli,pkSess_726),Kcli_737))
                                                    )
                                                    else
                                                        {256}let pkSess_738: bitstring = fail-any in
                                                        {257}out(c, GetEndpointRequest);
                                                        {258}in(c, (=GetEndpointResponse,=pkSess_738,=SignAndEncrypt,SP_739: bitstring,UP_740: bitstring));
                                                        {259}new Nc_741: bitstring;
                                                        {260}let m1_742: bitstring = (OpenSecureChannelRequest,pkCli,Nc_741) in
                                                        {261}out(c, (pkCli,enc(m1_742,pkSess_738),sign(h(m1_742),skCli)));
                                                        {262}in(c, (em2_743: bitstring,sigM2_744: bitstring));
                                                        {263}let m2_745: bitstring = dec(em2_743,skCli) in
                                                        {264}if (verify(h(m2_745),sigM2_744,pkSess_738) <> true) then
                                                            0
                                                        else
                                                            {265}let (=OpenSecureChannelResponse,Ns_746: bitstring,ST_747: bitstring,TTL_748: bitstring) = m2_745 in
                                                            {266}let Kcli_749: bitstring = h((Nc_741,Ns_746)) in
                                                            {267}out(c, senc(mCli(pkCli,pkSess_738),Kcli_749))
                                            )
                                            else
                                                {268}let pkSess_750: bitstring = fail-any in
                                                {269}out(c, GetEndpointRequest);
                                                {270}in(c, (=GetEndpointResponse,=pkSess_750,=SignAndEncrypt,SP_751: bitstring,UP_752: bitstring));
                                                {271}new Nc_753: bitstring;
                                                {272}let m1_754: bitstring = (OpenSecureChannelRequest,pkCli,Nc_753) in
                                                {273}out(c, (pkCli,enc(m1_754,pkSess_750),sign(h(m1_754),skCli)));
                                                {274}in(c, (em2_755: bitstring,sigM2_756: bitstring));
                                                {275}let m2_757: bitstring = dec(em2_755,skCli) in
                                                {276}if (verify(h(m2_757),sigM2_756,pkSess_750) <> true) then
                                                    0
                                                else
                                                    {277}let (=OpenSecureChannelResponse,Ns_758: bitstring,ST_759: bitstring,TTL_760: bitstring) = m2_757 in
                                                    {278}let Kcli_761: bitstring = h((Nc_753,Ns_758)) in
                                                    {279}out(c, senc(mCli(pkCli,pkSess_750),Kcli_761))
                                    )
                                    else
                                        {280}let pkSess_762: bitstring = fail-any in
                                        {281}out(c, GetEndpointRequest);
                                        {282}in(c, (=GetEndpointResponse,=pkSess_762,=SignAndEncrypt,SP_763: bitstring,UP_764: bitstring));
                                        {283}new Nc_765: bitstring;
                                        {284}let m1_766: bitstring = (OpenSecureChannelRequest,pkCli,Nc_765) in
                                        {285}out(c, (pkCli,enc(m1_766,pkSess_762),sign(h(m1_766),skCli)));
                                        {286}in(c, (em2_767: bitstring,sigM2_768: bitstring));
                                        {287}let m2_769: bitstring = dec(em2_767,skCli) in
                                        {288}if (verify(h(m2_769),sigM2_768,pkSess_762) <> true) then
                                            0
                                        else
                                            {289}let (=OpenSecureChannelResponse,Ns_770: bitstring,ST_771: bitstring,TTL_772: bitstring) = m2_769 in
                                            {290}let Kcli_773: bitstring = h((Nc_765,Ns_770)) in
                                            {291}out(c, senc(mCli(pkCli,pkSess_762),Kcli_773))
                                )
                                else
                                    {292}let pkDisco_774: bitstring = pub(sk(Disco)) in
                                    {293}let v_775: bool = (Sess = A) in
                                    (
                                        {294}if v_775 then
                                        (
                                            {295}let pkSess_776: bitstring = pub(skA) in
                                            {296}out(c, GetEndpointRequest);
                                            {297}in(c, (=GetEndpointResponse,=pkSess_776,=SignAndEncrypt,SP_777: bitstring,UP_778: bitstring));
                                            {298}new Nc_779: bitstring;
                                            {299}let m1_780: bitstring = (OpenSecureChannelRequest,pkCli,Nc_779) in
                                            {300}out(c, (pkCli,enc(m1_780,pkSess_776),sign(h(m1_780),skCli)));
                                            {301}in(c, (em2_781: bitstring,sigM2_782: bitstring));
                                            {302}let m2_783: bitstring = dec(em2_781,skCli) in
                                            {303}if (verify(h(m2_783),sigM2_782,pkSess_776) <> true) then
                                                0
                                            else
                                                {304}let (=OpenSecureChannelResponse,Ns_784: bitstring,ST_785: bitstring,TTL_786: bitstring) = m2_783 in
                                                {305}let Kcli_787: bitstring = h((Nc_779,Ns_784)) in
                                                {306}out(c, senc(mCli(pkCli,pkSess_776),Kcli_787))
                                        )
                                        else
                                            {307}let v_788: bool = (Sess = B) in
                                            (
                                                {308}if v_788 then
                                                (
                                                    {309}let pkSess_789: bitstring = pub(skB) in
                                                    {310}out(c, GetEndpointRequest);
                                                    {311}in(c, (=GetEndpointResponse,=pkSess_789,=SignAndEncrypt,SP_790: bitstring,UP_791: bitstring));
                                                    {312}new Nc_792: bitstring;
                                                    {313}let m1_793: bitstring = (OpenSecureChannelRequest,pkCli,Nc_792) in
                                                    {314}out(c, (pkCli,enc(m1_793,pkSess_789),sign(h(m1_793),skCli)));
                                                    {315}in(c, (em2_794: bitstring,sigM2_795: bitstring));
                                                    {316}let m2_796: bitstring = dec(em2_794,skCli) in
                                                    {317}if (verify(h(m2_796),sigM2_795,pkSess_789) <> true) then
                                                        0
                                                    else
                                                        {318}let (=OpenSecureChannelResponse,Ns_797: bitstring,ST_798: bitstring,TTL_799: bitstring) = m2_796 in
                                                        {319}let Kcli_800: bitstring = h((Nc_792,Ns_797)) in
                                                        {320}out(c, senc(mCli(pkCli,pkSess_789),Kcli_800))
                                                )
                                                else
                                                    {321}let v_801: bool = (Sess = C) in
                                                    (
                                                        {322}if v_801 then
                                                        (
                                                            {323}let pkSess_802: bitstring = pub(skC) in
                                                            {324}out(c, GetEndpointRequest);
                                                            {325}in(c, (=GetEndpointResponse,=pkSess_802,=SignAndEncrypt,SP_803: bitstring,UP_804: bitstring));
                                                            {326}new Nc_805: bitstring;
                                                            {327}let m1_806: bitstring = (OpenSecureChannelRequest,pkCli,Nc_805) in
                                                            {328}out(c, (pkCli,enc(m1_806,pkSess_802),sign(h(m1_806),skCli)));
                                                            {329}in(c, (em2_807: bitstring,sigM2_808: bitstring));
                                                            {330}let m2_809: bitstring = dec(em2_807,skCli) in
                                                            {331}if (verify(h(m2_809),sigM2_808,pkSess_802) <> true) then
                                                                0
                                                            else
                                                                {332}let (=OpenSecureChannelResponse,Ns_810: bitstring,ST_811: bitstring,TTL_812: bitstring) = m2_809 in
                                                                {333}let Kcli_813: bitstring = h((Nc_805,Ns_810)) in
                                                                {334}out(c, senc(mCli(pkCli,pkSess_802),Kcli_813))
                                                        )
                                                        else
                                                            {335}let pkSess_814: bitstring = pub(sk(Sess)) in
                                                            {336}out(c, GetEndpointRequest);
                                                            {337}in(c, (=GetEndpointResponse,=pkSess_814,=SignAndEncrypt,SP_815: bitstring,UP_816: bitstring));
                                                            {338}new Nc_817: bitstring;
                                                            {339}let m1_818: bitstring = (OpenSecureChannelRequest,pkCli,Nc_817) in
                                                            {340}out(c, (pkCli,enc(m1_818,pkSess_814),sign(h(m1_818),skCli)));
                                                            {341}in(c, (em2_819: bitstring,sigM2_820: bitstring));
                                                            {342}let m2_821: bitstring = dec(em2_819,skCli) in
                                                            {343}if (verify(h(m2_821),sigM2_820,pkSess_814) <> true) then
                                                                0
                                                            else
                                                                {344}let (=OpenSecureChannelResponse,Ns_822: bitstring,ST_823: bitstring,TTL_824: bitstring) = m2_821 in
                                                                {345}let Kcli_825: bitstring = h((Nc_817,Ns_822)) in
                                                                {346}out(c, senc(mCli(pkCli,pkSess_814),Kcli_825))
                                                    )
                                                    else
                                                        {347}let pkSess_826: bitstring = fail-any in
                                                        {348}out(c, GetEndpointRequest);
                                                        {349}in(c, (=GetEndpointResponse,=pkSess_826,=SignAndEncrypt,SP_827: bitstring,UP_828: bitstring));
                                                        {350}new Nc_829: bitstring;
                                                        {351}let m1_830: bitstring = (OpenSecureChannelRequest,pkCli,Nc_829) in
                                                        {352}out(c, (pkCli,enc(m1_830,pkSess_826),sign(h(m1_830),skCli)));
                                                        {353}in(c, (em2_831: bitstring,sigM2_832: bitstring));
                                                        {354}let m2_833: bitstring = dec(em2_831,skCli) in
                                                        {355}if (verify(h(m2_833),sigM2_832,pkSess_826) <> true) then
                                                            0
                                                        else
                                                            {356}let (=OpenSecureChannelResponse,Ns_834: bitstring,ST_835: bitstring,TTL_836: bitstring) = m2_833 in
                                                            {357}let Kcli_837: bitstring = h((Nc_829,Ns_834)) in
                                                            {358}out(c, senc(mCli(pkCli,pkSess_826),Kcli_837))
                                            )
                                            else
                                                {359}let pkSess_838: bitstring = fail-any in
                                                {360}out(c, GetEndpointRequest);
                                                {361}in(c, (=GetEndpointResponse,=pkSess_838,=SignAndEncrypt,SP_839: bitstring,UP_840: bitstring));
                                                {362}new Nc_841: bitstring;
                                                {363}let m1_842: bitstring = (OpenSecureChannelRequest,pkCli,Nc_841) in
                                                {364}out(c, (pkCli,enc(m1_842,pkSess_838),sign(h(m1_842),skCli)));
                                                {365}in(c, (em2_843: bitstring,sigM2_844: bitstring));
                                                {366}let m2_845: bitstring = dec(em2_843,skCli) in
                                                {367}if (verify(h(m2_845),sigM2_844,pkSess_838) <> true) then
                                                    0
                                                else
                                                    {368}let (=OpenSecureChannelResponse,Ns_846: bitstring,ST_847: bitstring,TTL_848: bitstring) = m2_845 in
                                                    {369}let Kcli_849: bitstring = h((Nc_841,Ns_846)) in
                                                    {370}out(c, senc(mCli(pkCli,pkSess_838),Kcli_849))
                                    )
                                    else
                                        {371}let pkSess_850: bitstring = fail-any in
                                        {372}out(c, GetEndpointRequest);
                                        {373}in(c, (=GetEndpointResponse,=pkSess_850,=SignAndEncrypt,SP_851: bitstring,UP_852: bitstring));
                                        {374}new Nc_853: bitstring;
                                        {375}let m1_854: bitstring = (OpenSecureChannelRequest,pkCli,Nc_853) in
                                        {376}out(c, (pkCli,enc(m1_854,pkSess_850),sign(h(m1_854),skCli)));
                                        {377}in(c, (em2_855: bitstring,sigM2_856: bitstring));
                                        {378}let m2_857: bitstring = dec(em2_855,skCli) in
                                        {379}if (verify(h(m2_857),sigM2_856,pkSess_850) <> true) then
                                            0
                                        else
                                            {380}let (=OpenSecureChannelResponse,Ns_858: bitstring,ST_859: bitstring,TTL_860: bitstring) = m2_857 in
                                            {381}let Kcli_861: bitstring = h((Nc_853,Ns_858)) in
                                            {382}out(c, senc(mCli(pkCli,pkSess_850),Kcli_861))
                            )
                            else
                                {383}let pkDisco_862: bitstring = fail-any in
                                {384}let v_863: bool = (Sess = A) in
                                (
                                    {385}if v_863 then
                                    (
                                        {386}let pkSess_864: bitstring = pub(skA) in
                                        {387}out(c, GetEndpointRequest);
                                        {388}in(c, (=GetEndpointResponse,=pkSess_864,=SignAndEncrypt,SP_865: bitstring,UP_866: bitstring));
                                        {389}new Nc_867: bitstring;
                                        {390}let m1_868: bitstring = (OpenSecureChannelRequest,pkCli,Nc_867) in
                                        {391}out(c, (pkCli,enc(m1_868,pkSess_864),sign(h(m1_868),skCli)));
                                        {392}in(c, (em2_869: bitstring,sigM2_870: bitstring));
                                        {393}let m2_871: bitstring = dec(em2_869,skCli) in
                                        {394}if (verify(h(m2_871),sigM2_870,pkSess_864) <> true) then
                                            0
                                        else
                                            {395}let (=OpenSecureChannelResponse,Ns_872: bitstring,ST_873: bitstring,TTL_874: bitstring) = m2_871 in
                                            {396}let Kcli_875: bitstring = h((Nc_867,Ns_872)) in
                                            {397}out(c, senc(mCli(pkCli,pkSess_864),Kcli_875))
                                    )
                                    else
                                        {398}let v_876: bool = (Sess = B) in
                                        (
                                            {399}if v_876 then
                                            (
                                                {400}let pkSess_877: bitstring = pub(skB) in
                                                {401}out(c, GetEndpointRequest);
                                                {402}in(c, (=GetEndpointResponse,=pkSess_877,=SignAndEncrypt,SP_878: bitstring,UP_879: bitstring));
                                                {403}new Nc_880: bitstring;
                                                {404}let m1_881: bitstring = (OpenSecureChannelRequest,pkCli,Nc_880) in
                                                {405}out(c, (pkCli,enc(m1_881,pkSess_877),sign(h(m1_881),skCli)));
                                                {406}in(c, (em2_882: bitstring,sigM2_883: bitstring));
                                                {407}let m2_884: bitstring = dec(em2_882,skCli) in
                                                {408}if (verify(h(m2_884),sigM2_883,pkSess_877) <> true) then
                                                    0
                                                else
                                                    {409}let (=OpenSecureChannelResponse,Ns_885: bitstring,ST_886: bitstring,TTL_887: bitstring) = m2_884 in
                                                    {410}let Kcli_888: bitstring = h((Nc_880,Ns_885)) in
                                                    {411}out(c, senc(mCli(pkCli,pkSess_877),Kcli_888))
                                            )
                                            else
                                                {412}let v_889: bool = (Sess = C) in
                                                (
                                                    {413}if v_889 then
                                                    (
                                                        {414}let pkSess_890: bitstring = pub(skC) in
                                                        {415}out(c, GetEndpointRequest);
                                                        {416}in(c, (=GetEndpointResponse,=pkSess_890,=SignAndEncrypt,SP_891: bitstring,UP_892: bitstring));
                                                        {417}new Nc_893: bitstring;
                                                        {418}let m1_894: bitstring = (OpenSecureChannelRequest,pkCli,Nc_893) in
                                                        {419}out(c, (pkCli,enc(m1_894,pkSess_890),sign(h(m1_894),skCli)));
                                                        {420}in(c, (em2_895: bitstring,sigM2_896: bitstring));
                                                        {421}let m2_897: bitstring = dec(em2_895,skCli) in
                                                        {422}if (verify(h(m2_897),sigM2_896,pkSess_890) <> true) then
                                                            0
                                                        else
                                                            {423}let (=OpenSecureChannelResponse,Ns_898: bitstring,ST_899: bitstring,TTL_900: bitstring) = m2_897 in
                                                            {424}let Kcli_901: bitstring = h((Nc_893,Ns_898)) in
                                                            {425}out(c, senc(mCli(pkCli,pkSess_890),Kcli_901))
                                                    )
                                                    else
                                                        {426}let pkSess_902: bitstring = pub(sk(Sess)) in
                                                        {427}out(c, GetEndpointRequest);
                                                        {428}in(c, (=GetEndpointResponse,=pkSess_902,=SignAndEncrypt,SP_903: bitstring,UP_904: bitstring));
                                                        {429}new Nc_905: bitstring;
                                                        {430}let m1_906: bitstring = (OpenSecureChannelRequest,pkCli,Nc_905) in
                                                        {431}out(c, (pkCli,enc(m1_906,pkSess_902),sign(h(m1_906),skCli)));
                                                        {432}in(c, (em2_907: bitstring,sigM2_908: bitstring));
                                                        {433}let m2_909: bitstring = dec(em2_907,skCli) in
                                                        {434}if (verify(h(m2_909),sigM2_908,pkSess_902) <> true) then
                                                            0
                                                        else
                                                            {435}let (=OpenSecureChannelResponse,Ns_910: bitstring,ST_911: bitstring,TTL_912: bitstring) = m2_909 in
                                                            {436}let Kcli_913: bitstring = h((Nc_905,Ns_910)) in
                                                            {437}out(c, senc(mCli(pkCli,pkSess_902),Kcli_913))
                                                )
                                                else
                                                    {438}let pkSess_914: bitstring = fail-any in
                                                    {439}out(c, GetEndpointRequest);
                                                    {440}in(c, (=GetEndpointResponse,=pkSess_914,=SignAndEncrypt,SP_915: bitstring,UP_916: bitstring));
                                                    {441}new Nc_917: bitstring;
                                                    {442}let m1_918: bitstring = (OpenSecureChannelRequest,pkCli,Nc_917) in
                                                    {443}out(c, (pkCli,enc(m1_918,pkSess_914),sign(h(m1_918),skCli)));
                                                    {444}in(c, (em2_919: bitstring,sigM2_920: bitstring));
                                                    {445}let m2_921: bitstring = dec(em2_919,skCli) in
                                                    {446}if (verify(h(m2_921),sigM2_920,pkSess_914) <> true) then
                                                        0
                                                    else
                                                        {447}let (=OpenSecureChannelResponse,Ns_922: bitstring,ST_923: bitstring,TTL_924: bitstring) = m2_921 in
                                                        {448}let Kcli_925: bitstring = h((Nc_917,Ns_922)) in
                                                        {449}out(c, senc(mCli(pkCli,pkSess_914),Kcli_925))
                                        )
                                        else
                                            {450}let pkSess_926: bitstring = fail-any in
                                            {451}out(c, GetEndpointRequest);
                                            {452}in(c, (=GetEndpointResponse,=pkSess_926,=SignAndEncrypt,SP_927: bitstring,UP_928: bitstring));
                                            {453}new Nc_929: bitstring;
                                            {454}let m1_930: bitstring = (OpenSecureChannelRequest,pkCli,Nc_929) in
                                            {455}out(c, (pkCli,enc(m1_930,pkSess_926),sign(h(m1_930),skCli)));
                                            {456}in(c, (em2_931: bitstring,sigM2_932: bitstring));
                                            {457}let m2_933: bitstring = dec(em2_931,skCli) in
                                            {458}if (verify(h(m2_933),sigM2_932,pkSess_926) <> true) then
                                                0
                                            else
                                                {459}let (=OpenSecureChannelResponse,Ns_934: bitstring,ST_935: bitstring,TTL_936: bitstring) = m2_933 in
                                                {460}let Kcli_937: bitstring = h((Nc_929,Ns_934)) in
                                                {461}out(c, senc(mCli(pkCli,pkSess_926),Kcli_937))
                                )
                                else
                                    {462}let pkSess_938: bitstring = fail-any in
                                    {463}out(c, GetEndpointRequest);
                                    {464}in(c, (=GetEndpointResponse,=pkSess_938,=SignAndEncrypt,SP_939: bitstring,UP_940: bitstring));
                                    {465}new Nc_941: bitstring;
                                    {466}let m1_942: bitstring = (OpenSecureChannelRequest,pkCli,Nc_941) in
                                    {467}out(c, (pkCli,enc(m1_942,pkSess_938),sign(h(m1_942),skCli)));
                                    {468}in(c, (em2_943: bitstring,sigM2_944: bitstring));
                                    {469}let m2_945: bitstring = dec(em2_943,skCli) in
                                    {470}if (verify(h(m2_945),sigM2_944,pkSess_938) <> true) then
                                        0
                                    else
                                        {471}let (=OpenSecureChannelResponse,Ns_946: bitstring,ST_947: bitstring,TTL_948: bitstring) = m2_945 in
                                        {472}let Kcli_949: bitstring = h((Nc_941,Ns_946)) in
                                        {473}out(c, senc(mCli(pkCli,pkSess_938),Kcli_949))
                    )
                    else
                        {474}let pkDisco_950: bitstring = fail-any in
                        {475}let v_951: bool = (Sess = A) in
                        (
                            {476}if v_951 then
                            (
                                {477}let pkSess_952: bitstring = pub(skA) in
                                {478}out(c, GetEndpointRequest);
                                {479}in(c, (=GetEndpointResponse,=pkSess_952,=SignAndEncrypt,SP_953: bitstring,UP_954: bitstring));
                                {480}new Nc_955: bitstring;
                                {481}let m1_956: bitstring = (OpenSecureChannelRequest,pkCli,Nc_955) in
                                {482}out(c, (pkCli,enc(m1_956,pkSess_952),sign(h(m1_956),skCli)));
                                {483}in(c, (em2_957: bitstring,sigM2_958: bitstring));
                                {484}let m2_959: bitstring = dec(em2_957,skCli) in
                                {485}if (verify(h(m2_959),sigM2_958,pkSess_952) <> true) then
                                    0
                                else
                                    {486}let (=OpenSecureChannelResponse,Ns_960: bitstring,ST_961: bitstring,TTL_962: bitstring) = m2_959 in
                                    {487}let Kcli_963: bitstring = h((Nc_955,Ns_960)) in
                                    {488}out(c, senc(mCli(pkCli,pkSess_952),Kcli_963))
                            )
                            else
                                {489}let v_964: bool = (Sess = B) in
                                (
                                    {490}if v_964 then
                                    (
                                        {491}let pkSess_965: bitstring = pub(skB) in
                                        {492}out(c, GetEndpointRequest);
                                        {493}in(c, (=GetEndpointResponse,=pkSess_965,=SignAndEncrypt,SP_966: bitstring,UP_967: bitstring));
                                        {494}new Nc_968: bitstring;
                                        {495}let m1_969: bitstring = (OpenSecureChannelRequest,pkCli,Nc_968) in
                                        {496}out(c, (pkCli,enc(m1_969,pkSess_965),sign(h(m1_969),skCli)));
                                        {497}in(c, (em2_970: bitstring,sigM2_971: bitstring));
                                        {498}let m2_972: bitstring = dec(em2_970,skCli) in
                                        {499}if (verify(h(m2_972),sigM2_971,pkSess_965) <> true) then
                                            0
                                        else
                                            {500}let (=OpenSecureChannelResponse,Ns_973: bitstring,ST_974: bitstring,TTL_975: bitstring) = m2_972 in
                                            {501}let Kcli_976: bitstring = h((Nc_968,Ns_973)) in
                                            {502}out(c, senc(mCli(pkCli,pkSess_965),Kcli_976))
                                    )
                                    else
                                        {503}let v_977: bool = (Sess = C) in
                                        (
                                            {504}if v_977 then
                                            (
                                                {505}let pkSess_978: bitstring = pub(skC) in
                                                {506}out(c, GetEndpointRequest);
                                                {507}in(c, (=GetEndpointResponse,=pkSess_978,=SignAndEncrypt,SP_979: bitstring,UP_980: bitstring));
                                                {508}new Nc_981: bitstring;
                                                {509}let m1_982: bitstring = (OpenSecureChannelRequest,pkCli,Nc_981) in
                                                {510}out(c, (pkCli,enc(m1_982,pkSess_978),sign(h(m1_982),skCli)));
                                                {511}in(c, (em2_983: bitstring,sigM2_984: bitstring));
                                                {512}let m2_985: bitstring = dec(em2_983,skCli) in
                                                {513}if (verify(h(m2_985),sigM2_984,pkSess_978) <> true) then
                                                    0
                                                else
                                                    {514}let (=OpenSecureChannelResponse,Ns_986: bitstring,ST_987: bitstring,TTL_988: bitstring) = m2_985 in
                                                    {515}let Kcli_989: bitstring = h((Nc_981,Ns_986)) in
                                                    {516}out(c, senc(mCli(pkCli,pkSess_978),Kcli_989))
                                            )
                                            else
                                                {517}let pkSess_990: bitstring = pub(sk(Sess)) in
                                                {518}out(c, GetEndpointRequest);
                                                {519}in(c, (=GetEndpointResponse,=pkSess_990,=SignAndEncrypt,SP_991: bitstring,UP_992: bitstring));
                                                {520}new Nc_993: bitstring;
                                                {521}let m1_994: bitstring = (OpenSecureChannelRequest,pkCli,Nc_993) in
                                                {522}out(c, (pkCli,enc(m1_994,pkSess_990),sign(h(m1_994),skCli)));
                                                {523}in(c, (em2_995: bitstring,sigM2_996: bitstring));
                                                {524}let m2_997: bitstring = dec(em2_995,skCli) in
                                                {525}if (verify(h(m2_997),sigM2_996,pkSess_990) <> true) then
                                                    0
                                                else
                                                    {526}let (=OpenSecureChannelResponse,Ns_998: bitstring,ST_999: bitstring,TTL_1000: bitstring) = m2_997 in
                                                    {527}let Kcli_1001: bitstring = h((Nc_993,Ns_998)) in
                                                    {528}out(c, senc(mCli(pkCli,pkSess_990),Kcli_1001))
                                        )
                                        else
                                            {529}let pkSess_1002: bitstring = fail-any in
                                            {530}out(c, GetEndpointRequest);
                                            {531}in(c, (=GetEndpointResponse,=pkSess_1002,=SignAndEncrypt,SP_1003: bitstring,UP_1004: bitstring));
                                            {532}new Nc_1005: bitstring;
                                            {533}let m1_1006: bitstring = (OpenSecureChannelRequest,pkCli,Nc_1005) in
                                            {534}out(c, (pkCli,enc(m1_1006,pkSess_1002),sign(h(m1_1006),skCli)));
                                            {535}in(c, (em2_1007: bitstring,sigM2_1008: bitstring));
                                            {536}let m2_1009: bitstring = dec(em2_1007,skCli) in
                                            {537}if (verify(h(m2_1009),sigM2_1008,pkSess_1002) <> true) then
                                                0
                                            else
                                                {538}let (=OpenSecureChannelResponse,Ns_1010: bitstring,ST_1011: bitstring,TTL_1012: bitstring) = m2_1009 in
                                                {539}let Kcli_1013: bitstring = h((Nc_1005,Ns_1010)) in
                                                {540}out(c, senc(mCli(pkCli,pkSess_1002),Kcli_1013))
                                )
                                else
                                    {541}let pkSess_1014: bitstring = fail-any in
                                    {542}out(c, GetEndpointRequest);
                                    {543}in(c, (=GetEndpointResponse,=pkSess_1014,=SignAndEncrypt,SP_1015: bitstring,UP_1016: bitstring));
                                    {544}new Nc_1017: bitstring;
                                    {545}let m1_1018: bitstring = (OpenSecureChannelRequest,pkCli,Nc_1017) in
                                    {546}out(c, (pkCli,enc(m1_1018,pkSess_1014),sign(h(m1_1018),skCli)));
                                    {547}in(c, (em2_1019: bitstring,sigM2_1020: bitstring));
                                    {548}let m2_1021: bitstring = dec(em2_1019,skCli) in
                                    {549}if (verify(h(m2_1021),sigM2_1020,pkSess_1014) <> true) then
                                        0
                                    else
                                        {550}let (=OpenSecureChannelResponse,Ns_1022: bitstring,ST_1023: bitstring,TTL_1024: bitstring) = m2_1021 in
                                        {551}let Kcli_1025: bitstring = h((Nc_1017,Ns_1022)) in
                                        {552}out(c, senc(mCli(pkCli,pkSess_1014),Kcli_1025))
                        )
                        else
                            {553}let pkSess_1026: bitstring = fail-any in
                            {554}out(c, GetEndpointRequest);
                            {555}in(c, (=GetEndpointResponse,=pkSess_1026,=SignAndEncrypt,SP_1027: bitstring,UP_1028: bitstring));
                            {556}new Nc_1029: bitstring;
                            {557}let m1_1030: bitstring = (OpenSecureChannelRequest,pkCli,Nc_1029) in
                            {558}out(c, (pkCli,enc(m1_1030,pkSess_1026),sign(h(m1_1030),skCli)));
                            {559}in(c, (em2_1031: bitstring,sigM2_1032: bitstring));
                            {560}let m2_1033: bitstring = dec(em2_1031,skCli) in
                            {561}if (verify(h(m2_1033),sigM2_1032,pkSess_1026) <> true) then
                                0
                            else
                                {562}let (=OpenSecureChannelResponse,Ns_1034: bitstring,ST_1035: bitstring,TTL_1036: bitstring) = m2_1033 in
                                {563}let Kcli_1037: bitstring = h((Nc_1029,Ns_1034)) in
                                {564}out(c, senc(mCli(pkCli,pkSess_1026),Kcli_1037))
            )
            else
                {565}let pkDisco_1038: bitstring = fail-any in
                {566}let v_1039: bool = (Sess = A) in
                (
                    {567}if v_1039 then
                    (
                        {568}let pkSess_1040: bitstring = pub(skA) in
                        {569}out(c, GetEndpointRequest);
                        {570}in(c, (=GetEndpointResponse,=pkSess_1040,=SignAndEncrypt,SP_1041: bitstring,UP_1042: bitstring));
                        {571}new Nc_1043: bitstring;
                        {572}let m1_1044: bitstring = (OpenSecureChannelRequest,pkCli,Nc_1043) in
                        {573}out(c, (pkCli,enc(m1_1044,pkSess_1040),sign(h(m1_1044),skCli)));
                        {574}in(c, (em2_1045: bitstring,sigM2_1046: bitstring));
                        {575}let m2_1047: bitstring = dec(em2_1045,skCli) in
                        {576}if (verify(h(m2_1047),sigM2_1046,pkSess_1040) <> true) then
                            0
                        else
                            {577}let (=OpenSecureChannelResponse,Ns_1048: bitstring,ST_1049: bitstring,TTL_1050: bitstring) = m2_1047 in
                            {578}let Kcli_1051: bitstring = h((Nc_1043,Ns_1048)) in
                            {579}out(c, senc(mCli(pkCli,pkSess_1040),Kcli_1051))
                    )
                    else
                        {580}let v_1052: bool = (Sess = B) in
                        (
                            {581}if v_1052 then
                            (
                                {582}let pkSess_1053: bitstring = pub(skB) in
                                {583}out(c, GetEndpointRequest);
                                {584}in(c, (=GetEndpointResponse,=pkSess_1053,=SignAndEncrypt,SP_1054: bitstring,UP_1055: bitstring));
                                {585}new Nc_1056: bitstring;
                                {586}let m1_1057: bitstring = (OpenSecureChannelRequest,pkCli,Nc_1056) in
                                {587}out(c, (pkCli,enc(m1_1057,pkSess_1053),sign(h(m1_1057),skCli)));
                                {588}in(c, (em2_1058: bitstring,sigM2_1059: bitstring));
                                {589}let m2_1060: bitstring = dec(em2_1058,skCli) in
                                {590}if (verify(h(m2_1060),sigM2_1059,pkSess_1053) <> true) then
                                    0
                                else
                                    {591}let (=OpenSecureChannelResponse,Ns_1061: bitstring,ST_1062: bitstring,TTL_1063: bitstring) = m2_1060 in
                                    {592}let Kcli_1064: bitstring = h((Nc_1056,Ns_1061)) in
                                    {593}out(c, senc(mCli(pkCli,pkSess_1053),Kcli_1064))
                            )
                            else
                                {594}let v_1065: bool = (Sess = C) in
                                (
                                    {595}if v_1065 then
                                    (
                                        {596}let pkSess_1066: bitstring = pub(skC) in
                                        {597}out(c, GetEndpointRequest);
                                        {598}in(c, (=GetEndpointResponse,=pkSess_1066,=SignAndEncrypt,SP_1067: bitstring,UP_1068: bitstring));
                                        {599}new Nc_1069: bitstring;
                                        {600}let m1_1070: bitstring = (OpenSecureChannelRequest,pkCli,Nc_1069) in
                                        {601}out(c, (pkCli,enc(m1_1070,pkSess_1066),sign(h(m1_1070),skCli)));
                                        {602}in(c, (em2_1071: bitstring,sigM2_1072: bitstring));
                                        {603}let m2_1073: bitstring = dec(em2_1071,skCli) in
                                        {604}if (verify(h(m2_1073),sigM2_1072,pkSess_1066) <> true) then
                                            0
                                        else
                                            {605}let (=OpenSecureChannelResponse,Ns_1074: bitstring,ST_1075: bitstring,TTL_1076: bitstring) = m2_1073 in
                                            {606}let Kcli_1077: bitstring = h((Nc_1069,Ns_1074)) in
                                            {607}out(c, senc(mCli(pkCli,pkSess_1066),Kcli_1077))
                                    )
                                    else
                                        {608}let pkSess_1078: bitstring = pub(sk(Sess)) in
                                        {609}out(c, GetEndpointRequest);
                                        {610}in(c, (=GetEndpointResponse,=pkSess_1078,=SignAndEncrypt,SP_1079: bitstring,UP_1080: bitstring));
                                        {611}new Nc_1081: bitstring;
                                        {612}let m1_1082: bitstring = (OpenSecureChannelRequest,pkCli,Nc_1081) in
                                        {613}out(c, (pkCli,enc(m1_1082,pkSess_1078),sign(h(m1_1082),skCli)));
                                        {614}in(c, (em2_1083: bitstring,sigM2_1084: bitstring));
                                        {615}let m2_1085: bitstring = dec(em2_1083,skCli) in
                                        {616}if (verify(h(m2_1085),sigM2_1084,pkSess_1078) <> true) then
                                            0
                                        else
                                            {617}let (=OpenSecureChannelResponse,Ns_1086: bitstring,ST_1087: bitstring,TTL_1088: bitstring) = m2_1085 in
                                            {618}let Kcli_1089: bitstring = h((Nc_1081,Ns_1086)) in
                                            {619}out(c, senc(mCli(pkCli,pkSess_1078),Kcli_1089))
                                )
                                else
                                    {620}let pkSess_1090: bitstring = fail-any in
                                    {621}out(c, GetEndpointRequest);
                                    {622}in(c, (=GetEndpointResponse,=pkSess_1090,=SignAndEncrypt,SP_1091: bitstring,UP_1092: bitstring));
                                    {623}new Nc_1093: bitstring;
                                    {624}let m1_1094: bitstring = (OpenSecureChannelRequest,pkCli,Nc_1093) in
                                    {625}out(c, (pkCli,enc(m1_1094,pkSess_1090),sign(h(m1_1094),skCli)));
                                    {626}in(c, (em2_1095: bitstring,sigM2_1096: bitstring));
                                    {627}let m2_1097: bitstring = dec(em2_1095,skCli) in
                                    {628}if (verify(h(m2_1097),sigM2_1096,pkSess_1090) <> true) then
                                        0
                                    else
                                        {629}let (=OpenSecureChannelResponse,Ns_1098: bitstring,ST_1099: bitstring,TTL_1100: bitstring) = m2_1097 in
                                        {630}let Kcli_1101: bitstring = h((Nc_1093,Ns_1098)) in
                                        {631}out(c, senc(mCli(pkCli,pkSess_1090),Kcli_1101))
                        )
                        else
                            {632}let pkSess_1102: bitstring = fail-any in
                            {633}out(c, GetEndpointRequest);
                            {634}in(c, (=GetEndpointResponse,=pkSess_1102,=SignAndEncrypt,SP_1103: bitstring,UP_1104: bitstring));
                            {635}new Nc_1105: bitstring;
                            {636}let m1_1106: bitstring = (OpenSecureChannelRequest,pkCli,Nc_1105) in
                            {637}out(c, (pkCli,enc(m1_1106,pkSess_1102),sign(h(m1_1106),skCli)));
                            {638}in(c, (em2_1107: bitstring,sigM2_1108: bitstring));
                            {639}let m2_1109: bitstring = dec(em2_1107,skCli) in
                            {640}if (verify(h(m2_1109),sigM2_1108,pkSess_1102) <> true) then
                                0
                            else
                                {641}let (=OpenSecureChannelResponse,Ns_1110: bitstring,ST_1111: bitstring,TTL_1112: bitstring) = m2_1109 in
                                {642}let Kcli_1113: bitstring = h((Nc_1105,Ns_1110)) in
                                {643}out(c, senc(mCli(pkCli,pkSess_1102),Kcli_1113))
                )
                else
                    {644}let pkSess_1114: bitstring = fail-any in
                    {645}out(c, GetEndpointRequest);
                    {646}in(c, (=GetEndpointResponse,=pkSess_1114,=SignAndEncrypt,SP_1115: bitstring,UP_1116: bitstring));
                    {647}new Nc_1117: bitstring;
                    {648}let m1_1118: bitstring = (OpenSecureChannelRequest,pkCli,Nc_1117) in
                    {649}out(c, (pkCli,enc(m1_1118,pkSess_1114),sign(h(m1_1118),skCli)));
                    {650}in(c, (em2_1119: bitstring,sigM2_1120: bitstring));
                    {651}let m2_1121: bitstring = dec(em2_1119,skCli) in
                    {652}if (verify(h(m2_1121),sigM2_1120,pkSess_1114) <> true) then
                        0
                    else
                        {653}let (=OpenSecureChannelResponse,Ns_1122: bitstring,ST_1123: bitstring,TTL_1124: bitstring) = m2_1121 in
                        {654}let Kcli_1125: bitstring = h((Nc_1117,Ns_1122)) in
                        {655}out(c, senc(mCli(pkCli,pkSess_1114),Kcli_1125))
        )
        else
            {656}let v_1126: bool = (Cli = B) in
            (
                {657}if v_1126 then
                (
                    {658}let skCli_1127: bitstring = skB in
                    {659}let pkCli_1128: bitstring = pub(skCli_1127) in
                    {660}let v_1129: bool = (Disco = A) in
                    (
                        {661}if v_1129 then
                        (
                            {662}let pkDisco_1130: bitstring = pub(skA) in
                            {663}let v_1131: bool = (Sess = A) in
                            (
                                {664}if v_1131 then
                                (
                                    {665}let pkSess_1132: bitstring = pub(skA) in
                                    {666}out(c, GetEndpointRequest);
                                    {667}in(c, (=GetEndpointResponse,=pkSess_1132,=SignAndEncrypt,SP_1133: bitstring,UP_1134: bitstring));
                                    {668}new Nc_1135: bitstring;
                                    {669}let m1_1136: bitstring = (OpenSecureChannelRequest,pkCli_1128,Nc_1135) in
                                    {670}out(c, (pkCli_1128,enc(m1_1136,pkSess_1132),sign(h(m1_1136),skCli_1127)));
                                    {671}in(c, (em2_1137: bitstring,sigM2_1138: bitstring));
                                    {672}let m2_1139: bitstring = dec(em2_1137,skCli_1127) in
                                    {673}if (verify(h(m2_1139),sigM2_1138,pkSess_1132) <> true) then
                                        0
                                    else
                                        {674}let (=OpenSecureChannelResponse,Ns_1140: bitstring,ST_1141: bitstring,TTL_1142: bitstring) = m2_1139 in
                                        {675}let Kcli_1143: bitstring = h((Nc_1135,Ns_1140)) in
                                        {676}out(c, senc(mCli(pkCli_1128,pkSess_1132),Kcli_1143))
                                )
                                else
                                    {677}let v_1144: bool = (Sess = B) in
                                    (
                                        {678}if v_1144 then
                                        (
                                            {679}let pkSess_1145: bitstring = pub(skB) in
                                            {680}out(c, GetEndpointRequest);
                                            {681}in(c, (=GetEndpointResponse,=pkSess_1145,=SignAndEncrypt,SP_1146: bitstring,UP_1147: bitstring));
                                            {682}new Nc_1148: bitstring;
                                            {683}let m1_1149: bitstring = (OpenSecureChannelRequest,pkCli_1128,Nc_1148) in
                                            {684}out(c, (pkCli_1128,enc(m1_1149,pkSess_1145),sign(h(m1_1149),skCli_1127)));
                                            {685}in(c, (em2_1150: bitstring,sigM2_1151: bitstring));
                                            {686}let m2_1152: bitstring = dec(em2_1150,skCli_1127) in
                                            {687}if (verify(h(m2_1152),sigM2_1151,pkSess_1145) <> true) then
                                                0
                                            else
                                                {688}let (=OpenSecureChannelResponse,Ns_1153: bitstring,ST_1154: bitstring,TTL_1155: bitstring) = m2_1152 in
                                                {689}let Kcli_1156: bitstring = h((Nc_1148,Ns_1153)) in
                                                {690}out(c, senc(mCli(pkCli_1128,pkSess_1145),Kcli_1156))
                                        )
                                        else
                                            {691}let v_1157: bool = (Sess = C) in
                                            (
                                                {692}if v_1157 then
                                                (
                                                    {693}let pkSess_1158: bitstring = pub(skC) in
                                                    {694}out(c, GetEndpointRequest);
                                                    {695}in(c, (=GetEndpointResponse,=pkSess_1158,=SignAndEncrypt,SP_1159: bitstring,UP_1160: bitstring));
                                                    {696}new Nc_1161: bitstring;
                                                    {697}let m1_1162: bitstring = (OpenSecureChannelRequest,pkCli_1128,Nc_1161) in
                                                    {698}out(c, (pkCli_1128,enc(m1_1162,pkSess_1158),sign(h(m1_1162),skCli_1127)));
                                                    {699}in(c, (em2_1163: bitstring,sigM2_1164: bitstring));
                                                    {700}let m2_1165: bitstring = dec(em2_1163,skCli_1127) in
                                                    {701}if (verify(h(m2_1165),sigM2_1164,pkSess_1158) <> true) then
                                                        0
                                                    else
                                                        {702}let (=OpenSecureChannelResponse,Ns_1166: bitstring,ST_1167: bitstring,TTL_1168: bitstring) = m2_1165 in
                                                        {703}let Kcli_1169: bitstring = h((Nc_1161,Ns_1166)) in
                                                        {704}out(c, senc(mCli(pkCli_1128,pkSess_1158),Kcli_1169))
                                                )
                                                else
                                                    {705}let pkSess_1170: bitstring = pub(sk(Sess)) in
                                                    {706}out(c, GetEndpointRequest);
                                                    {707}in(c, (=GetEndpointResponse,=pkSess_1170,=SignAndEncrypt,SP_1171: bitstring,UP_1172: bitstring));
                                                    {708}new Nc_1173: bitstring;
                                                    {709}let m1_1174: bitstring = (OpenSecureChannelRequest,pkCli_1128,Nc_1173) in
                                                    {710}out(c, (pkCli_1128,enc(m1_1174,pkSess_1170),sign(h(m1_1174),skCli_1127)));
                                                    {711}in(c, (em2_1175: bitstring,sigM2_1176: bitstring));
                                                    {712}let m2_1177: bitstring = dec(em2_1175,skCli_1127) in
                                                    {713}if (verify(h(m2_1177),sigM2_1176,pkSess_1170) <> true) then
                                                        0
                                                    else
                                                        {714}let (=OpenSecureChannelResponse,Ns_1178: bitstring,ST_1179: bitstring,TTL_1180: bitstring) = m2_1177 in
                                                        {715}let Kcli_1181: bitstring = h((Nc_1173,Ns_1178)) in
                                                        {716}out(c, senc(mCli(pkCli_1128,pkSess_1170),Kcli_1181))
                                            )
                                            else
                                                {717}let pkSess_1182: bitstring = fail-any in
                                                {718}out(c, GetEndpointRequest);
                                                {719}in(c, (=GetEndpointResponse,=pkSess_1182,=SignAndEncrypt,SP_1183: bitstring,UP_1184: bitstring));
                                                {720}new Nc_1185: bitstring;
                                                {721}let m1_1186: bitstring = (OpenSecureChannelRequest,pkCli_1128,Nc_1185) in
                                                {722}out(c, (pkCli_1128,enc(m1_1186,pkSess_1182),sign(h(m1_1186),skCli_1127)));
                                                {723}in(c, (em2_1187: bitstring,sigM2_1188: bitstring));
                                                {724}let m2_1189: bitstring = dec(em2_1187,skCli_1127) in
                                                {725}if (verify(h(m2_1189),sigM2_1188,pkSess_1182) <> true) then
                                                    0
                                                else
                                                    {726}let (=OpenSecureChannelResponse,Ns_1190: bitstring,ST_1191: bitstring,TTL_1192: bitstring) = m2_1189 in
                                                    {727}let Kcli_1193: bitstring = h((Nc_1185,Ns_1190)) in
                                                    {728}out(c, senc(mCli(pkCli_1128,pkSess_1182),Kcli_1193))
                                    )
                                    else
                                        {729}let pkSess_1194: bitstring = fail-any in
                                        {730}out(c, GetEndpointRequest);
                                        {731}in(c, (=GetEndpointResponse,=pkSess_1194,=SignAndEncrypt,SP_1195: bitstring,UP_1196: bitstring));
                                        {732}new Nc_1197: bitstring;
                                        {733}let m1_1198: bitstring = (OpenSecureChannelRequest,pkCli_1128,Nc_1197) in
                                        {734}out(c, (pkCli_1128,enc(m1_1198,pkSess_1194),sign(h(m1_1198),skCli_1127)));
                                        {735}in(c, (em2_1199: bitstring,sigM2_1200: bitstring));
                                        {736}let m2_1201: bitstring = dec(em2_1199,skCli_1127) in
                                        {737}if (verify(h(m2_1201),sigM2_1200,pkSess_1194) <> true) then
                                            0
                                        else
                                            {738}let (=OpenSecureChannelResponse,Ns_1202: bitstring,ST_1203: bitstring,TTL_1204: bitstring) = m2_1201 in
                                            {739}let Kcli_1205: bitstring = h((Nc_1197,Ns_1202)) in
                                            {740}out(c, senc(mCli(pkCli_1128,pkSess_1194),Kcli_1205))
                            )
                            else
                                {741}let pkSess_1206: bitstring = fail-any in
                                {742}out(c, GetEndpointRequest);
                                {743}in(c, (=GetEndpointResponse,=pkSess_1206,=SignAndEncrypt,SP_1207: bitstring,UP_1208: bitstring));
                                {744}new Nc_1209: bitstring;
                                {745}let m1_1210: bitstring = (OpenSecureChannelRequest,pkCli_1128,Nc_1209) in
                                {746}out(c, (pkCli_1128,enc(m1_1210,pkSess_1206),sign(h(m1_1210),skCli_1127)));
                                {747}in(c, (em2_1211: bitstring,sigM2_1212: bitstring));
                                {748}let m2_1213: bitstring = dec(em2_1211,skCli_1127) in
                                {749}if (verify(h(m2_1213),sigM2_1212,pkSess_1206) <> true) then
                                    0
                                else
                                    {750}let (=OpenSecureChannelResponse,Ns_1214: bitstring,ST_1215: bitstring,TTL_1216: bitstring) = m2_1213 in
                                    {751}let Kcli_1217: bitstring = h((Nc_1209,Ns_1214)) in
                                    {752}out(c, senc(mCli(pkCli_1128,pkSess_1206),Kcli_1217))
                        )
                        else
                            {753}let v_1218: bool = (Disco = B) in
                            (
                                {754}if v_1218 then
                                (
                                    {755}let pkDisco_1219: bitstring = pub(skB) in
                                    {756}let v_1220: bool = (Sess = A) in
                                    (
                                        {757}if v_1220 then
                                        (
                                            {758}let pkSess_1221: bitstring = pub(skA) in
                                            {759}out(c, GetEndpointRequest);
                                            {760}in(c, (=GetEndpointResponse,=pkSess_1221,=SignAndEncrypt,SP_1222: bitstring,UP_1223: bitstring));
                                            {761}new Nc_1224: bitstring;
                                            {762}let m1_1225: bitstring = (OpenSecureChannelRequest,pkCli_1128,Nc_1224) in
                                            {763}out(c, (pkCli_1128,enc(m1_1225,pkSess_1221),sign(h(m1_1225),skCli_1127)));
                                            {764}in(c, (em2_1226: bitstring,sigM2_1227: bitstring));
                                            {765}let m2_1228: bitstring = dec(em2_1226,skCli_1127) in
                                            {766}if (verify(h(m2_1228),sigM2_1227,pkSess_1221) <> true) then
                                                0
                                            else
                                                {767}let (=OpenSecureChannelResponse,Ns_1229: bitstring,ST_1230: bitstring,TTL_1231: bitstring) = m2_1228 in
                                                {768}let Kcli_1232: bitstring = h((Nc_1224,Ns_1229)) in
                                                {769}out(c, senc(mCli(pkCli_1128,pkSess_1221),Kcli_1232))
                                        )
                                        else
                                            {770}let v_1233: bool = (Sess = B) in
                                            (
                                                {771}if v_1233 then
                                                (
                                                    {772}let pkSess_1234: bitstring = pub(skB) in
                                                    {773}out(c, GetEndpointRequest);
                                                    {774}in(c, (=GetEndpointResponse,=pkSess_1234,=SignAndEncrypt,SP_1235: bitstring,UP_1236: bitstring));
                                                    {775}new Nc_1237: bitstring;
                                                    {776}let m1_1238: bitstring = (OpenSecureChannelRequest,pkCli_1128,Nc_1237) in
                                                    {777}out(c, (pkCli_1128,enc(m1_1238,pkSess_1234),sign(h(m1_1238),skCli_1127)));
                                                    {778}in(c, (em2_1239: bitstring,sigM2_1240: bitstring));
                                                    {779}let m2_1241: bitstring = dec(em2_1239,skCli_1127) in
                                                    {780}if (verify(h(m2_1241),sigM2_1240,pkSess_1234) <> true) then
                                                        0
                                                    else
                                                        {781}let (=OpenSecureChannelResponse,Ns_1242: bitstring,ST_1243: bitstring,TTL_1244: bitstring) = m2_1241 in
                                                        {782}let Kcli_1245: bitstring = h((Nc_1237,Ns_1242)) in
                                                        {783}out(c, senc(mCli(pkCli_1128,pkSess_1234),Kcli_1245))
                                                )
                                                else
                                                    {784}let v_1246: bool = (Sess = C) in
                                                    (
                                                        {785}if v_1246 then
                                                        (
                                                            {786}let pkSess_1247: bitstring = pub(skC) in
                                                            {787}out(c, GetEndpointRequest);
                                                            {788}in(c, (=GetEndpointResponse,=pkSess_1247,=SignAndEncrypt,SP_1248: bitstring,UP_1249: bitstring));
                                                            {789}new Nc_1250: bitstring;
                                                            {790}let m1_1251: bitstring = (OpenSecureChannelRequest,pkCli_1128,Nc_1250) in
                                                            {791}out(c, (pkCli_1128,enc(m1_1251,pkSess_1247),sign(h(m1_1251),skCli_1127)));
                                                            {792}in(c, (em2_1252: bitstring,sigM2_1253: bitstring));
                                                            {793}let m2_1254: bitstring = dec(em2_1252,skCli_1127) in
                                                            {794}if (verify(h(m2_1254),sigM2_1253,pkSess_1247) <> true) then
                                                                0
                                                            else
                                                                {795}let (=OpenSecureChannelResponse,Ns_1255: bitstring,ST_1256: bitstring,TTL_1257: bitstring) = m2_1254 in
                                                                {796}let Kcli_1258: bitstring = h((Nc_1250,Ns_1255)) in
                                                                {797}out(c, senc(mCli(pkCli_1128,pkSess_1247),Kcli_1258))
                                                        )
                                                        else
                                                            {798}let pkSess_1259: bitstring = pub(sk(Sess)) in
                                                            {799}out(c, GetEndpointRequest);
                                                            {800}in(c, (=GetEndpointResponse,=pkSess_1259,=SignAndEncrypt,SP_1260: bitstring,UP_1261: bitstring));
                                                            {801}new Nc_1262: bitstring;
                                                            {802}let m1_1263: bitstring = (OpenSecureChannelRequest,pkCli_1128,Nc_1262) in
                                                            {803}out(c, (pkCli_1128,enc(m1_1263,pkSess_1259),sign(h(m1_1263),skCli_1127)));
                                                            {804}in(c, (em2_1264: bitstring,sigM2_1265: bitstring));
                                                            {805}let m2_1266: bitstring = dec(em2_1264,skCli_1127) in
                                                            {806}if (verify(h(m2_1266),sigM2_1265,pkSess_1259) <> true) then
                                                                0
                                                            else
                                                                {807}let (=OpenSecureChannelResponse,Ns_1267: bitstring,ST_1268: bitstring,TTL_1269: bitstring) = m2_1266 in
                                                                {808}let Kcli_1270: bitstring = h((Nc_1262,Ns_1267)) in
                                                                {809}out(c, senc(mCli(pkCli_1128,pkSess_1259),Kcli_1270))
                                                    )
                                                    else
                                                        {810}let pkSess_1271: bitstring = fail-any in
                                                        {811}out(c, GetEndpointRequest);
                                                        {812}in(c, (=GetEndpointResponse,=pkSess_1271,=SignAndEncrypt,SP_1272: bitstring,UP_1273: bitstring));
                                                        {813}new Nc_1274: bitstring;
                                                        {814}let m1_1275: bitstring = (OpenSecureChannelRequest,pkCli_1128,Nc_1274) in
                                                        {815}out(c, (pkCli_1128,enc(m1_1275,pkSess_1271),sign(h(m1_1275),skCli_1127)));
                                                        {816}in(c, (em2_1276: bitstring,sigM2_1277: bitstring));
                                                        {817}let m2_1278: bitstring = dec(em2_1276,skCli_1127) in
                                                        {818}if (verify(h(m2_1278),sigM2_1277,pkSess_1271) <> true) then
                                                            0
                                                        else
                                                            {819}let (=OpenSecureChannelResponse,Ns_1279: bitstring,ST_1280: bitstring,TTL_1281: bitstring) = m2_1278 in
                                                            {820}let Kcli_1282: bitstring = h((Nc_1274,Ns_1279)) in
                                                            {821}out(c, senc(mCli(pkCli_1128,pkSess_1271),Kcli_1282))
                                            )
                                            else
                                                {822}let pkSess_1283: bitstring = fail-any in
                                                {823}out(c, GetEndpointRequest);
                                                {824}in(c, (=GetEndpointResponse,=pkSess_1283,=SignAndEncrypt,SP_1284: bitstring,UP_1285: bitstring));
                                                {825}new Nc_1286: bitstring;
                                                {826}let m1_1287: bitstring = (OpenSecureChannelRequest,pkCli_1128,Nc_1286) in
                                                {827}out(c, (pkCli_1128,enc(m1_1287,pkSess_1283),sign(h(m1_1287),skCli_1127)));
                                                {828}in(c, (em2_1288: bitstring,sigM2_1289: bitstring));
                                                {829}let m2_1290: bitstring = dec(em2_1288,skCli_1127) in
                                                {830}if (verify(h(m2_1290),sigM2_1289,pkSess_1283) <> true) then
                                                    0
                                                else
                                                    {831}let (=OpenSecureChannelResponse,Ns_1291: bitstring,ST_1292: bitstring,TTL_1293: bitstring) = m2_1290 in
                                                    {832}let Kcli_1294: bitstring = h((Nc_1286,Ns_1291)) in
                                                    {833}out(c, senc(mCli(pkCli_1128,pkSess_1283),Kcli_1294))
                                    )
                                    else
                                        {834}let pkSess_1295: bitstring = fail-any in
                                        {835}out(c, GetEndpointRequest);
                                        {836}in(c, (=GetEndpointResponse,=pkSess_1295,=SignAndEncrypt,SP_1296: bitstring,UP_1297: bitstring));
                                        {837}new Nc_1298: bitstring;
                                        {838}let m1_1299: bitstring = (OpenSecureChannelRequest,pkCli_1128,Nc_1298) in
                                        {839}out(c, (pkCli_1128,enc(m1_1299,pkSess_1295),sign(h(m1_1299),skCli_1127)));
                                        {840}in(c, (em2_1300: bitstring,sigM2_1301: bitstring));
                                        {841}let m2_1302: bitstring = dec(em2_1300,skCli_1127) in
                                        {842}if (verify(h(m2_1302),sigM2_1301,pkSess_1295) <> true) then
                                            0
                                        else
                                            {843}let (=OpenSecureChannelResponse,Ns_1303: bitstring,ST_1304: bitstring,TTL_1305: bitstring) = m2_1302 in
                                            {844}let Kcli_1306: bitstring = h((Nc_1298,Ns_1303)) in
                                            {845}out(c, senc(mCli(pkCli_1128,pkSess_1295),Kcli_1306))
                                )
                                else
                                    {846}let v_1307: bool = (Disco = C) in
                                    (
                                        {847}if v_1307 then
                                        (
                                            {848}let pkDisco_1308: bitstring = pub(skC) in
                                            {849}let v_1309: bool = (Sess = A) in
                                            (
                                                {850}if v_1309 then
                                                (
                                                    {851}let pkSess_1310: bitstring = pub(skA) in
                                                    {852}out(c, GetEndpointRequest);
                                                    {853}in(c, (=GetEndpointResponse,=pkSess_1310,=SignAndEncrypt,SP_1311: bitstring,UP_1312: bitstring));
                                                    {854}new Nc_1313: bitstring;
                                                    {855}let m1_1314: bitstring = (OpenSecureChannelRequest,pkCli_1128,Nc_1313) in
                                                    {856}out(c, (pkCli_1128,enc(m1_1314,pkSess_1310),sign(h(m1_1314),skCli_1127)));
                                                    {857}in(c, (em2_1315: bitstring,sigM2_1316: bitstring));
                                                    {858}let m2_1317: bitstring = dec(em2_1315,skCli_1127) in
                                                    {859}if (verify(h(m2_1317),sigM2_1316,pkSess_1310) <> true) then
                                                        0
                                                    else
                                                        {860}let (=OpenSecureChannelResponse,Ns_1318: bitstring,ST_1319: bitstring,TTL_1320: bitstring) = m2_1317 in
                                                        {861}let Kcli_1321: bitstring = h((Nc_1313,Ns_1318)) in
                                                        {862}out(c, senc(mCli(pkCli_1128,pkSess_1310),Kcli_1321))
                                                )
                                                else
                                                    {863}let v_1322: bool = (Sess = B) in
                                                    (
                                                        {864}if v_1322 then
                                                        (
                                                            {865}let pkSess_1323: bitstring = pub(skB) in
                                                            {866}out(c, GetEndpointRequest);
                                                            {867}in(c, (=GetEndpointResponse,=pkSess_1323,=SignAndEncrypt,SP_1324: bitstring,UP_1325: bitstring));
                                                            {868}new Nc_1326: bitstring;
                                                            {869}let m1_1327: bitstring = (OpenSecureChannelRequest,pkCli_1128,Nc_1326) in
                                                            {870}out(c, (pkCli_1128,enc(m1_1327,pkSess_1323),sign(h(m1_1327),skCli_1127)));
                                                            {871}in(c, (em2_1328: bitstring,sigM2_1329: bitstring));
                                                            {872}let m2_1330: bitstring = dec(em2_1328,skCli_1127) in
                                                            {873}if (verify(h(m2_1330),sigM2_1329,pkSess_1323) <> true) then
                                                                0
                                                            else
                                                                {874}let (=OpenSecureChannelResponse,Ns_1331: bitstring,ST_1332: bitstring,TTL_1333: bitstring) = m2_1330 in
                                                                {875}let Kcli_1334: bitstring = h((Nc_1326,Ns_1331)) in
                                                                {876}out(c, senc(mCli(pkCli_1128,pkSess_1323),Kcli_1334))
                                                        )
                                                        else
                                                            {877}let v_1335: bool = (Sess = C) in
                                                            (
                                                                {878}if v_1335 then
                                                                (
                                                                    {879}let pkSess_1336: bitstring = pub(skC) in
                                                                    {880}out(c, GetEndpointRequest);
                                                                    {881}in(c, (=GetEndpointResponse,=pkSess_1336,=SignAndEncrypt,SP_1337: bitstring,UP_1338: bitstring));
                                                                    {882}new Nc_1339: bitstring;
                                                                    {883}let m1_1340: bitstring = (OpenSecureChannelRequest,pkCli_1128,Nc_1339) in
                                                                    {884}out(c, (pkCli_1128,enc(m1_1340,pkSess_1336),sign(h(m1_1340),skCli_1127)));
                                                                    {885}in(c, (em2_1341: bitstring,sigM2_1342: bitstring));
                                                                    {886}let m2_1343: bitstring = dec(em2_1341,skCli_1127) in
                                                                    {887}if (verify(h(m2_1343),sigM2_1342,pkSess_1336) <> true) then
                                                                        0
                                                                    else
                                                                        {888}let (=OpenSecureChannelResponse,Ns_1344: bitstring,ST_1345: bitstring,TTL_1346: bitstring) = m2_1343 in
                                                                        {889}let Kcli_1347: bitstring = h((Nc_1339,Ns_1344)) in
                                                                        {890}out(c, senc(mCli(pkCli_1128,pkSess_1336),Kcli_1347))
                                                                )
                                                                else
                                                                    {891}let pkSess_1348: bitstring = pub(sk(Sess)) in
                                                                    {892}out(c, GetEndpointRequest);
                                                                    {893}in(c, (=GetEndpointResponse,=pkSess_1348,=SignAndEncrypt,SP_1349: bitstring,UP_1350: bitstring));
                                                                    {894}new Nc_1351: bitstring;
                                                                    {895}let m1_1352: bitstring = (OpenSecureChannelRequest,pkCli_1128,Nc_1351) in
                                                                    {896}out(c, (pkCli_1128,enc(m1_1352,pkSess_1348),sign(h(m1_1352),skCli_1127)));
                                                                    {897}in(c, (em2_1353: bitstring,sigM2_1354: bitstring));
                                                                    {898}let m2_1355: bitstring = dec(em2_1353,skCli_1127) in
                                                                    {899}if (verify(h(m2_1355),sigM2_1354,pkSess_1348) <> true) then
                                                                        0
                                                                    else
                                                                        {900}let (=OpenSecureChannelResponse,Ns_1356: bitstring,ST_1357: bitstring,TTL_1358: bitstring) = m2_1355 in
                                                                        {901}let Kcli_1359: bitstring = h((Nc_1351,Ns_1356)) in
                                                                        {902}out(c, senc(mCli(pkCli_1128,pkSess_1348),Kcli_1359))
                                                            )
                                                            else
                                                                {903}let pkSess_1360: bitstring = fail-any in
                                                                {904}out(c, GetEndpointRequest);
                                                                {905}in(c, (=GetEndpointResponse,=pkSess_1360,=SignAndEncrypt,SP_1361: bitstring,UP_1362: bitstring));
                                                                {906}new Nc_1363: bitstring;
                                                                {907}let m1_1364: bitstring = (OpenSecureChannelRequest,pkCli_1128,Nc_1363) in
                                                                {908}out(c, (pkCli_1128,enc(m1_1364,pkSess_1360),sign(h(m1_1364),skCli_1127)));
                                                                {909}in(c, (em2_1365: bitstring,sigM2_1366: bitstring));
                                                                {910}let m2_1367: bitstring = dec(em2_1365,skCli_1127) in
                                                                {911}if (verify(h(m2_1367),sigM2_1366,pkSess_1360) <> true) then
                                                                    0
                                                                else
                                                                    {912}let (=OpenSecureChannelResponse,Ns_1368: bitstring,ST_1369: bitstring,TTL_1370: bitstring) = m2_1367 in
                                                                    {913}let Kcli_1371: bitstring = h((Nc_1363,Ns_1368)) in
                                                                    {914}out(c, senc(mCli(pkCli_1128,pkSess_1360),Kcli_1371))
                                                    )
                                                    else
                                                        {915}let pkSess_1372: bitstring = fail-any in
                                                        {916}out(c, GetEndpointRequest);
                                                        {917}in(c, (=GetEndpointResponse,=pkSess_1372,=SignAndEncrypt,SP_1373: bitstring,UP_1374: bitstring));
                                                        {918}new Nc_1375: bitstring;
                                                        {919}let m1_1376: bitstring = (OpenSecureChannelRequest,pkCli_1128,Nc_1375) in
                                                        {920}out(c, (pkCli_1128,enc(m1_1376,pkSess_1372),sign(h(m1_1376),skCli_1127)));
                                                        {921}in(c, (em2_1377: bitstring,sigM2_1378: bitstring));
                                                        {922}let m2_1379: bitstring = dec(em2_1377,skCli_1127) in
                                                        {923}if (verify(h(m2_1379),sigM2_1378,pkSess_1372) <> true) then
                                                            0
                                                        else
                                                            {924}let (=OpenSecureChannelResponse,Ns_1380: bitstring,ST_1381: bitstring,TTL_1382: bitstring) = m2_1379 in
                                                            {925}let Kcli_1383: bitstring = h((Nc_1375,Ns_1380)) in
                                                            {926}out(c, senc(mCli(pkCli_1128,pkSess_1372),Kcli_1383))
                                            )
                                            else
                                                {927}let pkSess_1384: bitstring = fail-any in
                                                {928}out(c, GetEndpointRequest);
                                                {929}in(c, (=GetEndpointResponse,=pkSess_1384,=SignAndEncrypt,SP_1385: bitstring,UP_1386: bitstring));
                                                {930}new Nc_1387: bitstring;
                                                {931}let m1_1388: bitstring = (OpenSecureChannelRequest,pkCli_1128,Nc_1387) in
                                                {932}out(c, (pkCli_1128,enc(m1_1388,pkSess_1384),sign(h(m1_1388),skCli_1127)));
                                                {933}in(c, (em2_1389: bitstring,sigM2_1390: bitstring));
                                                {934}let m2_1391: bitstring = dec(em2_1389,skCli_1127) in
                                                {935}if (verify(h(m2_1391),sigM2_1390,pkSess_1384) <> true) then
                                                    0
                                                else
                                                    {936}let (=OpenSecureChannelResponse,Ns_1392: bitstring,ST_1393: bitstring,TTL_1394: bitstring) = m2_1391 in
                                                    {937}let Kcli_1395: bitstring = h((Nc_1387,Ns_1392)) in
                                                    {938}out(c, senc(mCli(pkCli_1128,pkSess_1384),Kcli_1395))
                                        )
                                        else
                                            {939}let pkDisco_1396: bitstring = pub(sk(Disco)) in
                                            {940}let v_1397: bool = (Sess = A) in
                                            (
                                                {941}if v_1397 then
                                                (
                                                    {942}let pkSess_1398: bitstring = pub(skA) in
                                                    {943}out(c, GetEndpointRequest);
                                                    {944}in(c, (=GetEndpointResponse,=pkSess_1398,=SignAndEncrypt,SP_1399: bitstring,UP_1400: bitstring));
                                                    {945}new Nc_1401: bitstring;
                                                    {946}let m1_1402: bitstring = (OpenSecureChannelRequest,pkCli_1128,Nc_1401) in
                                                    {947}out(c, (pkCli_1128,enc(m1_1402,pkSess_1398),sign(h(m1_1402),skCli_1127)));
                                                    {948}in(c, (em2_1403: bitstring,sigM2_1404: bitstring));
                                                    {949}let m2_1405: bitstring = dec(em2_1403,skCli_1127) in
                                                    {950}if (verify(h(m2_1405),sigM2_1404,pkSess_1398) <> true) then
                                                        0
                                                    else
                                                        {951}let (=OpenSecureChannelResponse,Ns_1406: bitstring,ST_1407: bitstring,TTL_1408: bitstring) = m2_1405 in
                                                        {952}let Kcli_1409: bitstring = h((Nc_1401,Ns_1406)) in
                                                        {953}out(c, senc(mCli(pkCli_1128,pkSess_1398),Kcli_1409))
                                                )
                                                else
                                                    {954}let v_1410: bool = (Sess = B) in
                                                    (
                                                        {955}if v_1410 then
                                                        (
                                                            {956}let pkSess_1411: bitstring = pub(skB) in
                                                            {957}out(c, GetEndpointRequest);
                                                            {958}in(c, (=GetEndpointResponse,=pkSess_1411,=SignAndEncrypt,SP_1412: bitstring,UP_1413: bitstring));
                                                            {959}new Nc_1414: bitstring;
                                                            {960}let m1_1415: bitstring = (OpenSecureChannelRequest,pkCli_1128,Nc_1414) in
                                                            {961}out(c, (pkCli_1128,enc(m1_1415,pkSess_1411),sign(h(m1_1415),skCli_1127)));
                                                            {962}in(c, (em2_1416: bitstring,sigM2_1417: bitstring));
                                                            {963}let m2_1418: bitstring = dec(em2_1416,skCli_1127) in
                                                            {964}if (verify(h(m2_1418),sigM2_1417,pkSess_1411) <> true) then
                                                                0
                                                            else
                                                                {965}let (=OpenSecureChannelResponse,Ns_1419: bitstring,ST_1420: bitstring,TTL_1421: bitstring) = m2_1418 in
                                                                {966}let Kcli_1422: bitstring = h((Nc_1414,Ns_1419)) in
                                                                {967}out(c, senc(mCli(pkCli_1128,pkSess_1411),Kcli_1422))
                                                        )
                                                        else
                                                            {968}let v_1423: bool = (Sess = C) in
                                                            (
                                                                {969}if v_1423 then
                                                                (
                                                                    {970}let pkSess_1424: bitstring = pub(skC) in
                                                                    {971}out(c, GetEndpointRequest);
                                                                    {972}in(c, (=GetEndpointResponse,=pkSess_1424,=SignAndEncrypt,SP_1425: bitstring,UP_1426: bitstring));
                                                                    {973}new Nc_1427: bitstring;
                                                                    {974}let m1_1428: bitstring = (OpenSecureChannelRequest,pkCli_1128,Nc_1427) in
                                                                    {975}out(c, (pkCli_1128,enc(m1_1428,pkSess_1424),sign(h(m1_1428),skCli_1127)));
                                                                    {976}in(c, (em2_1429: bitstring,sigM2_1430: bitstring));
                                                                    {977}let m2_1431: bitstring = dec(em2_1429,skCli_1127) in
                                                                    {978}if (verify(h(m2_1431),sigM2_1430,pkSess_1424) <> true) then
                                                                        0
                                                                    else
                                                                        {979}let (=OpenSecureChannelResponse,Ns_1432: bitstring,ST_1433: bitstring,TTL_1434: bitstring) = m2_1431 in
                                                                        {980}let Kcli_1435: bitstring = h((Nc_1427,Ns_1432)) in
                                                                        {981}out(c, senc(mCli(pkCli_1128,pkSess_1424),Kcli_1435))
                                                                )
                                                                else
                                                                    {982}let pkSess_1436: bitstring = pub(sk(Sess)) in
                                                                    {983}out(c, GetEndpointRequest);
                                                                    {984}in(c, (=GetEndpointResponse,=pkSess_1436,=SignAndEncrypt,SP_1437: bitstring,UP_1438: bitstring));
                                                                    {985}new Nc_1439: bitstring;
                                                                    {986}let m1_1440: bitstring = (OpenSecureChannelRequest,pkCli_1128,Nc_1439) in
                                                                    {987}out(c, (pkCli_1128,enc(m1_1440,pkSess_1436),sign(h(m1_1440),skCli_1127)));
                                                                    {988}in(c, (em2_1441: bitstring,sigM2_1442: bitstring));
                                                                    {989}let m2_1443: bitstring = dec(em2_1441,skCli_1127) in
                                                                    {990}if (verify(h(m2_1443),sigM2_1442,pkSess_1436) <> true) then
                                                                        0
                                                                    else
                                                                        {991}let (=OpenSecureChannelResponse,Ns_1444: bitstring,ST_1445: bitstring,TTL_1446: bitstring) = m2_1443 in
                                                                        {992}let Kcli_1447: bitstring = h((Nc_1439,Ns_1444)) in
                                                                        {993}out(c, senc(mCli(pkCli_1128,pkSess_1436),Kcli_1447))
                                                            )
                                                            else
                                                                {994}let pkSess_1448: bitstring = fail-any in
                                                                {995}out(c, GetEndpointRequest);
                                                                {996}in(c, (=GetEndpointResponse,=pkSess_1448,=SignAndEncrypt,SP_1449: bitstring,UP_1450: bitstring));
                                                                {997}new Nc_1451: bitstring;
                                                                {998}let m1_1452: bitstring = (OpenSecureChannelRequest,pkCli_1128,Nc_1451) in
                                                                {999}out(c, (pkCli_1128,enc(m1_1452,pkSess_1448),sign(h(m1_1452),skCli_1127)));
                                                                {1000}in(c, (em2_1453: bitstring,sigM2_1454: bitstring));
                                                                {1001}let m2_1455: bitstring = dec(em2_1453,skCli_1127) in
                                                                {1002}if (verify(h(m2_1455),sigM2_1454,pkSess_1448) <> true) then
                                                                    0
                                                                else
                                                                    {1003}let (=OpenSecureChannelResponse,Ns_1456: bitstring,ST_1457: bitstring,TTL_1458: bitstring) = m2_1455 in
                                                                    {1004}let Kcli_1459: bitstring = h((Nc_1451,Ns_1456)) in
                                                                    {1005}out(c, senc(mCli(pkCli_1128,pkSess_1448),Kcli_1459))
                                                    )
                                                    else
                                                        {1006}let pkSess_1460: bitstring = fail-any in
                                                        {1007}out(c, GetEndpointRequest);
                                                        {1008}in(c, (=GetEndpointResponse,=pkSess_1460,=SignAndEncrypt,SP_1461: bitstring,UP_1462: bitstring));
                                                        {1009}new Nc_1463: bitstring;
                                                        {1010}let m1_1464: bitstring = (OpenSecureChannelRequest,pkCli_1128,Nc_1463) in
                                                        {1011}out(c, (pkCli_1128,enc(m1_1464,pkSess_1460),sign(h(m1_1464),skCli_1127)));
                                                        {1012}in(c, (em2_1465: bitstring,sigM2_1466: bitstring));
                                                        {1013}let m2_1467: bitstring = dec(em2_1465,skCli_1127) in
                                                        {1014}if (verify(h(m2_1467),sigM2_1466,pkSess_1460) <> true) then
                                                            0
                                                        else
                                                            {1015}let (=OpenSecureChannelResponse,Ns_1468: bitstring,ST_1469: bitstring,TTL_1470: bitstring) = m2_1467 in
                                                            {1016}let Kcli_1471: bitstring = h((Nc_1463,Ns_1468)) in
                                                            {1017}out(c, senc(mCli(pkCli_1128,pkSess_1460),Kcli_1471))
                                            )
                                            else
                                                {1018}let pkSess_1472: bitstring = fail-any in
                                                {1019}out(c, GetEndpointRequest);
                                                {1020}in(c, (=GetEndpointResponse,=pkSess_1472,=SignAndEncrypt,SP_1473: bitstring,UP_1474: bitstring));
                                                {1021}new Nc_1475: bitstring;
                                                {1022}let m1_1476: bitstring = (OpenSecureChannelRequest,pkCli_1128,Nc_1475) in
                                                {1023}out(c, (pkCli_1128,enc(m1_1476,pkSess_1472),sign(h(m1_1476),skCli_1127)));
                                                {1024}in(c, (em2_1477: bitstring,sigM2_1478: bitstring));
                                                {1025}let m2_1479: bitstring = dec(em2_1477,skCli_1127) in
                                                {1026}if (verify(h(m2_1479),sigM2_1478,pkSess_1472) <> true) then
                                                    0
                                                else
                                                    {1027}let (=OpenSecureChannelResponse,Ns_1480: bitstring,ST_1481: bitstring,TTL_1482: bitstring) = m2_1479 in
                                                    {1028}let Kcli_1483: bitstring = h((Nc_1475,Ns_1480)) in
                                                    {1029}out(c, senc(mCli(pkCli_1128,pkSess_1472),Kcli_1483))
                                    )
                                    else
                                        {1030}let pkDisco_1484: bitstring = fail-any in
                                        {1031}let v_1485: bool = (Sess = A) in
                                        (
                                            {1032}if v_1485 then
                                            (
                                                {1033}let pkSess_1486: bitstring = pub(skA) in
                                                {1034}out(c, GetEndpointRequest);
                                                {1035}in(c, (=GetEndpointResponse,=pkSess_1486,=SignAndEncrypt,SP_1487: bitstring,UP_1488: bitstring));
                                                {1036}new Nc_1489: bitstring;
                                                {1037}let m1_1490: bitstring = (OpenSecureChannelRequest,pkCli_1128,Nc_1489) in
                                                {1038}out(c, (pkCli_1128,enc(m1_1490,pkSess_1486),sign(h(m1_1490),skCli_1127)));
                                                {1039}in(c, (em2_1491: bitstring,sigM2_1492: bitstring));
                                                {1040}let m2_1493: bitstring = dec(em2_1491,skCli_1127) in
                                                {1041}if (verify(h(m2_1493),sigM2_1492,pkSess_1486) <> true) then
                                                    0
                                                else
                                                    {1042}let (=OpenSecureChannelResponse,Ns_1494: bitstring,ST_1495: bitstring,TTL_1496: bitstring) = m2_1493 in
                                                    {1043}let Kcli_1497: bitstring = h((Nc_1489,Ns_1494)) in
                                                    {1044}out(c, senc(mCli(pkCli_1128,pkSess_1486),Kcli_1497))
                                            )
                                            else
                                                {1045}let v_1498: bool = (Sess = B) in
                                                (
                                                    {1046}if v_1498 then
                                                    (
                                                        {1047}let pkSess_1499: bitstring = pub(skB) in
                                                        {1048}out(c, GetEndpointRequest);
                                                        {1049}in(c, (=GetEndpointResponse,=pkSess_1499,=SignAndEncrypt,SP_1500: bitstring,UP_1501: bitstring));
                                                        {1050}new Nc_1502: bitstring;
                                                        {1051}let m1_1503: bitstring = (OpenSecureChannelRequest,pkCli_1128,Nc_1502) in
                                                        {1052}out(c, (pkCli_1128,enc(m1_1503,pkSess_1499),sign(h(m1_1503),skCli_1127)));
                                                        {1053}in(c, (em2_1504: bitstring,sigM2_1505: bitstring));
                                                        {1054}let m2_1506: bitstring = dec(em2_1504,skCli_1127) in
                                                        {1055}if (verify(h(m2_1506),sigM2_1505,pkSess_1499) <> true) then
                                                            0
                                                        else
                                                            {1056}let (=OpenSecureChannelResponse,Ns_1507: bitstring,ST_1508: bitstring,TTL_1509: bitstring) = m2_1506 in
                                                            {1057}let Kcli_1510: bitstring = h((Nc_1502,Ns_1507)) in
                                                            {1058}out(c, senc(mCli(pkCli_1128,pkSess_1499),Kcli_1510))
                                                    )
                                                    else
                                                        {1059}let v_1511: bool = (Sess = C) in
                                                        (
                                                            {1060}if v_1511 then
                                                            (
                                                                {1061}let pkSess_1512: bitstring = pub(skC) in
                                                                {1062}out(c, GetEndpointRequest);
                                                                {1063}in(c, (=GetEndpointResponse,=pkSess_1512,=SignAndEncrypt,SP_1513: bitstring,UP_1514: bitstring));
                                                                {1064}new Nc_1515: bitstring;
                                                                {1065}let m1_1516: bitstring = (OpenSecureChannelRequest,pkCli_1128,Nc_1515) in
                                                                {1066}out(c, (pkCli_1128,enc(m1_1516,pkSess_1512),sign(h(m1_1516),skCli_1127)));
                                                                {1067}in(c, (em2_1517: bitstring,sigM2_1518: bitstring));
                                                                {1068}let m2_1519: bitstring = dec(em2_1517,skCli_1127) in
                                                                {1069}if (verify(h(m2_1519),sigM2_1518,pkSess_1512) <> true) then
                                                                    0
                                                                else
                                                                    {1070}let (=OpenSecureChannelResponse,Ns_1520: bitstring,ST_1521: bitstring,TTL_1522: bitstring) = m2_1519 in
                                                                    {1071}let Kcli_1523: bitstring = h((Nc_1515,Ns_1520)) in
                                                                    {1072}out(c, senc(mCli(pkCli_1128,pkSess_1512),Kcli_1523))
                                                            )
                                                            else
                                                                {1073}let pkSess_1524: bitstring = pub(sk(Sess)) in
                                                                {1074}out(c, GetEndpointRequest);
                                                                {1075}in(c, (=GetEndpointResponse,=pkSess_1524,=SignAndEncrypt,SP_1525: bitstring,UP_1526: bitstring));
                                                                {1076}new Nc_1527: bitstring;
                                                                {1077}let m1_1528: bitstring = (OpenSecureChannelRequest,pkCli_1128,Nc_1527) in
                                                                {1078}out(c, (pkCli_1128,enc(m1_1528,pkSess_1524),sign(h(m1_1528),skCli_1127)));
                                                                {1079}in(c, (em2_1529: bitstring,sigM2_1530: bitstring));
                                                                {1080}let m2_1531: bitstring = dec(em2_1529,skCli_1127) in
                                                                {1081}if (verify(h(m2_1531),sigM2_1530,pkSess_1524) <> true) then
                                                                    0
                                                                else
                                                                    {1082}let (=OpenSecureChannelResponse,Ns_1532: bitstring,ST_1533: bitstring,TTL_1534: bitstring) = m2_1531 in
                                                                    {1083}let Kcli_1535: bitstring = h((Nc_1527,Ns_1532)) in
                                                                    {1084}out(c, senc(mCli(pkCli_1128,pkSess_1524),Kcli_1535))
                                                        )
                                                        else
                                                            {1085}let pkSess_1536: bitstring = fail-any in
                                                            {1086}out(c, GetEndpointRequest);
                                                            {1087}in(c, (=GetEndpointResponse,=pkSess_1536,=SignAndEncrypt,SP_1537: bitstring,UP_1538: bitstring));
                                                            {1088}new Nc_1539: bitstring;
                                                            {1089}let m1_1540: bitstring = (OpenSecureChannelRequest,pkCli_1128,Nc_1539) in
                                                            {1090}out(c, (pkCli_1128,enc(m1_1540,pkSess_1536),sign(h(m1_1540),skCli_1127)));
                                                            {1091}in(c, (em2_1541: bitstring,sigM2_1542: bitstring));
                                                            {1092}let m2_1543: bitstring = dec(em2_1541,skCli_1127) in
                                                            {1093}if (verify(h(m2_1543),sigM2_1542,pkSess_1536) <> true) then
                                                                0
                                                            else
                                                                {1094}let (=OpenSecureChannelResponse,Ns_1544: bitstring,ST_1545: bitstring,TTL_1546: bitstring) = m2_1543 in
                                                                {1095}let Kcli_1547: bitstring = h((Nc_1539,Ns_1544)) in
                                                                {1096}out(c, senc(mCli(pkCli_1128,pkSess_1536),Kcli_1547))
                                                )
                                                else
                                                    {1097}let pkSess_1548: bitstring = fail-any in
                                                    {1098}out(c, GetEndpointRequest);
                                                    {1099}in(c, (=GetEndpointResponse,=pkSess_1548,=SignAndEncrypt,SP_1549: bitstring,UP_1550: bitstring));
                                                    {1100}new Nc_1551: bitstring;
                                                    {1101}let m1_1552: bitstring = (OpenSecureChannelRequest,pkCli_1128,Nc_1551) in
                                                    {1102}out(c, (pkCli_1128,enc(m1_1552,pkSess_1548),sign(h(m1_1552),skCli_1127)));
                                                    {1103}in(c, (em2_1553: bitstring,sigM2_1554: bitstring));
                                                    {1104}let m2_1555: bitstring = dec(em2_1553,skCli_1127) in
                                                    {1105}if (verify(h(m2_1555),sigM2_1554,pkSess_1548) <> true) then
                                                        0
                                                    else
                                                        {1106}let (=OpenSecureChannelResponse,Ns_1556: bitstring,ST_1557: bitstring,TTL_1558: bitstring) = m2_1555 in
                                                        {1107}let Kcli_1559: bitstring = h((Nc_1551,Ns_1556)) in
                                                        {1108}out(c, senc(mCli(pkCli_1128,pkSess_1548),Kcli_1559))
                                        )
                                        else
                                            {1109}let pkSess_1560: bitstring = fail-any in
                                            {1110}out(c, GetEndpointRequest);
                                            {1111}in(c, (=GetEndpointResponse,=pkSess_1560,=SignAndEncrypt,SP_1561: bitstring,UP_1562: bitstring));
                                            {1112}new Nc_1563: bitstring;
                                            {1113}let m1_1564: bitstring = (OpenSecureChannelRequest,pkCli_1128,Nc_1563) in
                                            {1114}out(c, (pkCli_1128,enc(m1_1564,pkSess_1560),sign(h(m1_1564),skCli_1127)));
                                            {1115}in(c, (em2_1565: bitstring,sigM2_1566: bitstring));
                                            {1116}let m2_1567: bitstring = dec(em2_1565,skCli_1127) in
                                            {1117}if (verify(h(m2_1567),sigM2_1566,pkSess_1560) <> true) then
                                                0
                                            else
                                                {1118}let (=OpenSecureChannelResponse,Ns_1568: bitstring,ST_1569: bitstring,TTL_1570: bitstring) = m2_1567 in
                                                {1119}let Kcli_1571: bitstring = h((Nc_1563,Ns_1568)) in
                                                {1120}out(c, senc(mCli(pkCli_1128,pkSess_1560),Kcli_1571))
                            )
                            else
                                {1121}let pkDisco_1572: bitstring = fail-any in
                                {1122}let v_1573: bool = (Sess = A) in
                                (
                                    {1123}if v_1573 then
                                    (
                                        {1124}let pkSess_1574: bitstring = pub(skA) in
                                        {1125}out(c, GetEndpointRequest);
                                        {1126}in(c, (=GetEndpointResponse,=pkSess_1574,=SignAndEncrypt,SP_1575: bitstring,UP_1576: bitstring));
                                        {1127}new Nc_1577: bitstring;
                                        {1128}let m1_1578: bitstring = (OpenSecureChannelRequest,pkCli_1128,Nc_1577) in
                                        {1129}out(c, (pkCli_1128,enc(m1_1578,pkSess_1574),sign(h(m1_1578),skCli_1127)));
                                        {1130}in(c, (em2_1579: bitstring,sigM2_1580: bitstring));
                                        {1131}let m2_1581: bitstring = dec(em2_1579,skCli_1127) in
                                        {1132}if (verify(h(m2_1581),sigM2_1580,pkSess_1574) <> true) then
                                            0
                                        else
                                            {1133}let (=OpenSecureChannelResponse,Ns_1582: bitstring,ST_1583: bitstring,TTL_1584: bitstring) = m2_1581 in
                                            {1134}let Kcli_1585: bitstring = h((Nc_1577,Ns_1582)) in
                                            {1135}out(c, senc(mCli(pkCli_1128,pkSess_1574),Kcli_1585))
                                    )
                                    else
                                        {1136}let v_1586: bool = (Sess = B) in
                                        (
                                            {1137}if v_1586 then
                                            (
                                                {1138}let pkSess_1587: bitstring = pub(skB) in
                                                {1139}out(c, GetEndpointRequest);
                                                {1140}in(c, (=GetEndpointResponse,=pkSess_1587,=SignAndEncrypt,SP_1588: bitstring,UP_1589: bitstring));
                                                {1141}new Nc_1590: bitstring;
                                                {1142}let m1_1591: bitstring = (OpenSecureChannelRequest,pkCli_1128,Nc_1590) in
                                                {1143}out(c, (pkCli_1128,enc(m1_1591,pkSess_1587),sign(h(m1_1591),skCli_1127)));
                                                {1144}in(c, (em2_1592: bitstring,sigM2_1593: bitstring));
                                                {1145}let m2_1594: bitstring = dec(em2_1592,skCli_1127) in
                                                {1146}if (verify(h(m2_1594),sigM2_1593,pkSess_1587) <> true) then
                                                    0
                                                else
                                                    {1147}let (=OpenSecureChannelResponse,Ns_1595: bitstring,ST_1596: bitstring,TTL_1597: bitstring) = m2_1594 in
                                                    {1148}let Kcli_1598: bitstring = h((Nc_1590,Ns_1595)) in
                                                    {1149}out(c, senc(mCli(pkCli_1128,pkSess_1587),Kcli_1598))
                                            )
                                            else
                                                {1150}let v_1599: bool = (Sess = C) in
                                                (
                                                    {1151}if v_1599 then
                                                    (
                                                        {1152}let pkSess_1600: bitstring = pub(skC) in
                                                        {1153}out(c, GetEndpointRequest);
                                                        {1154}in(c, (=GetEndpointResponse,=pkSess_1600,=SignAndEncrypt,SP_1601: bitstring,UP_1602: bitstring));
                                                        {1155}new Nc_1603: bitstring;
                                                        {1156}let m1_1604: bitstring = (OpenSecureChannelRequest,pkCli_1128,Nc_1603) in
                                                        {1157}out(c, (pkCli_1128,enc(m1_1604,pkSess_1600),sign(h(m1_1604),skCli_1127)));
                                                        {1158}in(c, (em2_1605: bitstring,sigM2_1606: bitstring));
                                                        {1159}let m2_1607: bitstring = dec(em2_1605,skCli_1127) in
                                                        {1160}if (verify(h(m2_1607),sigM2_1606,pkSess_1600) <> true) then
                                                            0
                                                        else
                                                            {1161}let (=OpenSecureChannelResponse,Ns_1608: bitstring,ST_1609: bitstring,TTL_1610: bitstring) = m2_1607 in
                                                            {1162}let Kcli_1611: bitstring = h((Nc_1603,Ns_1608)) in
                                                            {1163}out(c, senc(mCli(pkCli_1128,pkSess_1600),Kcli_1611))
                                                    )
                                                    else
                                                        {1164}let pkSess_1612: bitstring = pub(sk(Sess)) in
                                                        {1165}out(c, GetEndpointRequest);
                                                        {1166}in(c, (=GetEndpointResponse,=pkSess_1612,=SignAndEncrypt,SP_1613: bitstring,UP_1614: bitstring));
                                                        {1167}new Nc_1615: bitstring;
                                                        {1168}let m1_1616: bitstring = (OpenSecureChannelRequest,pkCli_1128,Nc_1615) in
                                                        {1169}out(c, (pkCli_1128,enc(m1_1616,pkSess_1612),sign(h(m1_1616),skCli_1127)));
                                                        {1170}in(c, (em2_1617: bitstring,sigM2_1618: bitstring));
                                                        {1171}let m2_1619: bitstring = dec(em2_1617,skCli_1127) in
                                                        {1172}if (verify(h(m2_1619),sigM2_1618,pkSess_1612) <> true) then
                                                            0
                                                        else
                                                            {1173}let (=OpenSecureChannelResponse,Ns_1620: bitstring,ST_1621: bitstring,TTL_1622: bitstring) = m2_1619 in
                                                            {1174}let Kcli_1623: bitstring = h((Nc_1615,Ns_1620)) in
                                                            {1175}out(c, senc(mCli(pkCli_1128,pkSess_1612),Kcli_1623))
                                                )
                                                else
                                                    {1176}let pkSess_1624: bitstring = fail-any in
                                                    {1177}out(c, GetEndpointRequest);
                                                    {1178}in(c, (=GetEndpointResponse,=pkSess_1624,=SignAndEncrypt,SP_1625: bitstring,UP_1626: bitstring));
                                                    {1179}new Nc_1627: bitstring;
                                                    {1180}let m1_1628: bitstring = (OpenSecureChannelRequest,pkCli_1128,Nc_1627) in
                                                    {1181}out(c, (pkCli_1128,enc(m1_1628,pkSess_1624),sign(h(m1_1628),skCli_1127)));
                                                    {1182}in(c, (em2_1629: bitstring,sigM2_1630: bitstring));
                                                    {1183}let m2_1631: bitstring = dec(em2_1629,skCli_1127) in
                                                    {1184}if (verify(h(m2_1631),sigM2_1630,pkSess_1624) <> true) then
                                                        0
                                                    else
                                                        {1185}let (=OpenSecureChannelResponse,Ns_1632: bitstring,ST_1633: bitstring,TTL_1634: bitstring) = m2_1631 in
                                                        {1186}let Kcli_1635: bitstring = h((Nc_1627,Ns_1632)) in
                                                        {1187}out(c, senc(mCli(pkCli_1128,pkSess_1624),Kcli_1635))
                                        )
                                        else
                                            {1188}let pkSess_1636: bitstring = fail-any in
                                            {1189}out(c, GetEndpointRequest);
                                            {1190}in(c, (=GetEndpointResponse,=pkSess_1636,=SignAndEncrypt,SP_1637: bitstring,UP_1638: bitstring));
                                            {1191}new Nc_1639: bitstring;
                                            {1192}let m1_1640: bitstring = (OpenSecureChannelRequest,pkCli_1128,Nc_1639) in
                                            {1193}out(c, (pkCli_1128,enc(m1_1640,pkSess_1636),sign(h(m1_1640),skCli_1127)));
                                            {1194}in(c, (em2_1641: bitstring,sigM2_1642: bitstring));
                                            {1195}let m2_1643: bitstring = dec(em2_1641,skCli_1127) in
                                            {1196}if (verify(h(m2_1643),sigM2_1642,pkSess_1636) <> true) then
                                                0
                                            else
                                                {1197}let (=OpenSecureChannelResponse,Ns_1644: bitstring,ST_1645: bitstring,TTL_1646: bitstring) = m2_1643 in
                                                {1198}let Kcli_1647: bitstring = h((Nc_1639,Ns_1644)) in
                                                {1199}out(c, senc(mCli(pkCli_1128,pkSess_1636),Kcli_1647))
                                )
                                else
                                    {1200}let pkSess_1648: bitstring = fail-any in
                                    {1201}out(c, GetEndpointRequest);
                                    {1202}in(c, (=GetEndpointResponse,=pkSess_1648,=SignAndEncrypt,SP_1649: bitstring,UP_1650: bitstring));
                                    {1203}new Nc_1651: bitstring;
                                    {1204}let m1_1652: bitstring = (OpenSecureChannelRequest,pkCli_1128,Nc_1651) in
                                    {1205}out(c, (pkCli_1128,enc(m1_1652,pkSess_1648),sign(h(m1_1652),skCli_1127)));
                                    {1206}in(c, (em2_1653: bitstring,sigM2_1654: bitstring));
                                    {1207}let m2_1655: bitstring = dec(em2_1653,skCli_1127) in
                                    {1208}if (verify(h(m2_1655),sigM2_1654,pkSess_1648) <> true) then
                                        0
                                    else
                                        {1209}let (=OpenSecureChannelResponse,Ns_1656: bitstring,ST_1657: bitstring,TTL_1658: bitstring) = m2_1655 in
                                        {1210}let Kcli_1659: bitstring = h((Nc_1651,Ns_1656)) in
                                        {1211}out(c, senc(mCli(pkCli_1128,pkSess_1648),Kcli_1659))
                    )
                    else
                        {1212}let pkDisco_1660: bitstring = fail-any in
                        {1213}let v_1661: bool = (Sess = A) in
                        (
                            {1214}if v_1661 then
                            (
                                {1215}let pkSess_1662: bitstring = pub(skA) in
                                {1216}out(c, GetEndpointRequest);
                                {1217}in(c, (=GetEndpointResponse,=pkSess_1662,=SignAndEncrypt,SP_1663: bitstring,UP_1664: bitstring));
                                {1218}new Nc_1665: bitstring;
                                {1219}let m1_1666: bitstring = (OpenSecureChannelRequest,pkCli_1128,Nc_1665) in
                                {1220}out(c, (pkCli_1128,enc(m1_1666,pkSess_1662),sign(h(m1_1666),skCli_1127)));
                                {1221}in(c, (em2_1667: bitstring,sigM2_1668: bitstring));
                                {1222}let m2_1669: bitstring = dec(em2_1667,skCli_1127) in
                                {1223}if (verify(h(m2_1669),sigM2_1668,pkSess_1662) <> true) then
                                    0
                                else
                                    {1224}let (=OpenSecureChannelResponse,Ns_1670: bitstring,ST_1671: bitstring,TTL_1672: bitstring) = m2_1669 in
                                    {1225}let Kcli_1673: bitstring = h((Nc_1665,Ns_1670)) in
                                    {1226}out(c, senc(mCli(pkCli_1128,pkSess_1662),Kcli_1673))
                            )
                            else
                                {1227}let v_1674: bool = (Sess = B) in
                                (
                                    {1228}if v_1674 then
                                    (
                                        {1229}let pkSess_1675: bitstring = pub(skB) in
                                        {1230}out(c, GetEndpointRequest);
                                        {1231}in(c, (=GetEndpointResponse,=pkSess_1675,=SignAndEncrypt,SP_1676: bitstring,UP_1677: bitstring));
                                        {1232}new Nc_1678: bitstring;
                                        {1233}let m1_1679: bitstring = (OpenSecureChannelRequest,pkCli_1128,Nc_1678) in
                                        {1234}out(c, (pkCli_1128,enc(m1_1679,pkSess_1675),sign(h(m1_1679),skCli_1127)));
                                        {1235}in(c, (em2_1680: bitstring,sigM2_1681: bitstring));
                                        {1236}let m2_1682: bitstring = dec(em2_1680,skCli_1127) in
                                        {1237}if (verify(h(m2_1682),sigM2_1681,pkSess_1675) <> true) then
                                            0
                                        else
                                            {1238}let (=OpenSecureChannelResponse,Ns_1683: bitstring,ST_1684: bitstring,TTL_1685: bitstring) = m2_1682 in
                                            {1239}let Kcli_1686: bitstring = h((Nc_1678,Ns_1683)) in
                                            {1240}out(c, senc(mCli(pkCli_1128,pkSess_1675),Kcli_1686))
                                    )
                                    else
                                        {1241}let v_1687: bool = (Sess = C) in
                                        (
                                            {1242}if v_1687 then
                                            (
                                                {1243}let pkSess_1688: bitstring = pub(skC) in
                                                {1244}out(c, GetEndpointRequest);
                                                {1245}in(c, (=GetEndpointResponse,=pkSess_1688,=SignAndEncrypt,SP_1689: bitstring,UP_1690: bitstring));
                                                {1246}new Nc_1691: bitstring;
                                                {1247}let m1_1692: bitstring = (OpenSecureChannelRequest,pkCli_1128,Nc_1691) in
                                                {1248}out(c, (pkCli_1128,enc(m1_1692,pkSess_1688),sign(h(m1_1692),skCli_1127)));
                                                {1249}in(c, (em2_1693: bitstring,sigM2_1694: bitstring));
                                                {1250}let m2_1695: bitstring = dec(em2_1693,skCli_1127) in
                                                {1251}if (verify(h(m2_1695),sigM2_1694,pkSess_1688) <> true) then
                                                    0
                                                else
                                                    {1252}let (=OpenSecureChannelResponse,Ns_1696: bitstring,ST_1697: bitstring,TTL_1698: bitstring) = m2_1695 in
                                                    {1253}let Kcli_1699: bitstring = h((Nc_1691,Ns_1696)) in
                                                    {1254}out(c, senc(mCli(pkCli_1128,pkSess_1688),Kcli_1699))
                                            )
                                            else
                                                {1255}let pkSess_1700: bitstring = pub(sk(Sess)) in
                                                {1256}out(c, GetEndpointRequest);
                                                {1257}in(c, (=GetEndpointResponse,=pkSess_1700,=SignAndEncrypt,SP_1701: bitstring,UP_1702: bitstring));
                                                {1258}new Nc_1703: bitstring;
                                                {1259}let m1_1704: bitstring = (OpenSecureChannelRequest,pkCli_1128,Nc_1703) in
                                                {1260}out(c, (pkCli_1128,enc(m1_1704,pkSess_1700),sign(h(m1_1704),skCli_1127)));
                                                {1261}in(c, (em2_1705: bitstring,sigM2_1706: bitstring));
                                                {1262}let m2_1707: bitstring = dec(em2_1705,skCli_1127) in
                                                {1263}if (verify(h(m2_1707),sigM2_1706,pkSess_1700) <> true) then
                                                    0
                                                else
                                                    {1264}let (=OpenSecureChannelResponse,Ns_1708: bitstring,ST_1709: bitstring,TTL_1710: bitstring) = m2_1707 in
                                                    {1265}let Kcli_1711: bitstring = h((Nc_1703,Ns_1708)) in
                                                    {1266}out(c, senc(mCli(pkCli_1128,pkSess_1700),Kcli_1711))
                                        )
                                        else
                                            {1267}let pkSess_1712: bitstring = fail-any in
                                            {1268}out(c, GetEndpointRequest);
                                            {1269}in(c, (=GetEndpointResponse,=pkSess_1712,=SignAndEncrypt,SP_1713: bitstring,UP_1714: bitstring));
                                            {1270}new Nc_1715: bitstring;
                                            {1271}let m1_1716: bitstring = (OpenSecureChannelRequest,pkCli_1128,Nc_1715) in
                                            {1272}out(c, (pkCli_1128,enc(m1_1716,pkSess_1712),sign(h(m1_1716),skCli_1127)));
                                            {1273}in(c, (em2_1717: bitstring,sigM2_1718: bitstring));
                                            {1274}let m2_1719: bitstring = dec(em2_1717,skCli_1127) in
                                            {1275}if (verify(h(m2_1719),sigM2_1718,pkSess_1712) <> true) then
                                                0
                                            else
                                                {1276}let (=OpenSecureChannelResponse,Ns_1720: bitstring,ST_1721: bitstring,TTL_1722: bitstring) = m2_1719 in
                                                {1277}let Kcli_1723: bitstring = h((Nc_1715,Ns_1720)) in
                                                {1278}out(c, senc(mCli(pkCli_1128,pkSess_1712),Kcli_1723))
                                )
                                else
                                    {1279}let pkSess_1724: bitstring = fail-any in
                                    {1280}out(c, GetEndpointRequest);
                                    {1281}in(c, (=GetEndpointResponse,=pkSess_1724,=SignAndEncrypt,SP_1725: bitstring,UP_1726: bitstring));
                                    {1282}new Nc_1727: bitstring;
                                    {1283}let m1_1728: bitstring = (OpenSecureChannelRequest,pkCli_1128,Nc_1727) in
                                    {1284}out(c, (pkCli_1128,enc(m1_1728,pkSess_1724),sign(h(m1_1728),skCli_1127)));
                                    {1285}in(c, (em2_1729: bitstring,sigM2_1730: bitstring));
                                    {1286}let m2_1731: bitstring = dec(em2_1729,skCli_1127) in
                                    {1287}if (verify(h(m2_1731),sigM2_1730,pkSess_1724) <> true) then
                                        0
                                    else
                                        {1288}let (=OpenSecureChannelResponse,Ns_1732: bitstring,ST_1733: bitstring,TTL_1734: bitstring) = m2_1731 in
                                        {1289}let Kcli_1735: bitstring = h((Nc_1727,Ns_1732)) in
                                        {1290}out(c, senc(mCli(pkCli_1128,pkSess_1724),Kcli_1735))
                        )
                        else
                            {1291}let pkSess_1736: bitstring = fail-any in
                            {1292}out(c, GetEndpointRequest);
                            {1293}in(c, (=GetEndpointResponse,=pkSess_1736,=SignAndEncrypt,SP_1737: bitstring,UP_1738: bitstring));
                            {1294}new Nc_1739: bitstring;
                            {1295}let m1_1740: bitstring = (OpenSecureChannelRequest,pkCli_1128,Nc_1739) in
                            {1296}out(c, (pkCli_1128,enc(m1_1740,pkSess_1736),sign(h(m1_1740),skCli_1127)));
                            {1297}in(c, (em2_1741: bitstring,sigM2_1742: bitstring));
                            {1298}let m2_1743: bitstring = dec(em2_1741,skCli_1127) in
                            {1299}if (verify(h(m2_1743),sigM2_1742,pkSess_1736) <> true) then
                                0
                            else
                                {1300}let (=OpenSecureChannelResponse,Ns_1744: bitstring,ST_1745: bitstring,TTL_1746: bitstring) = m2_1743 in
                                {1301}let Kcli_1747: bitstring = h((Nc_1739,Ns_1744)) in
                                {1302}out(c, senc(mCli(pkCli_1128,pkSess_1736),Kcli_1747))
                )
                else
                    {1303}let =true = (Cli = C) in
                    (
                        {1304}let skCli_1748: bitstring = skC in
                        {1305}let pkCli_1749: bitstring = pub(skCli_1748) in
                        {1306}let v_1750: bool = (Disco = A) in
                        (
                            {1307}if v_1750 then
                            (
                                {1308}let pkDisco_1751: bitstring = pub(skA) in
                                {1309}let v_1752: bool = (Sess = A) in
                                (
                                    {1310}if v_1752 then
                                    (
                                        {1311}let pkSess_1753: bitstring = pub(skA) in
                                        {1312}out(c, GetEndpointRequest);
                                        {1313}in(c, (=GetEndpointResponse,=pkSess_1753,=SignAndEncrypt,SP_1754: bitstring,UP_1755: bitstring));
                                        {1314}new Nc_1756: bitstring;
                                        {1315}let m1_1757: bitstring = (OpenSecureChannelRequest,pkCli_1749,Nc_1756) in
                                        {1316}out(c, (pkCli_1749,enc(m1_1757,pkSess_1753),sign(h(m1_1757),skCli_1748)));
                                        {1317}in(c, (em2_1758: bitstring,sigM2_1759: bitstring));
                                        {1318}let m2_1760: bitstring = dec(em2_1758,skCli_1748) in
                                        {1319}if (verify(h(m2_1760),sigM2_1759,pkSess_1753) <> true) then
                                            0
                                        else
                                            {1320}let (=OpenSecureChannelResponse,Ns_1761: bitstring,ST_1762: bitstring,TTL_1763: bitstring) = m2_1760 in
                                            {1321}let Kcli_1764: bitstring = h((Nc_1756,Ns_1761)) in
                                            {1322}out(c, senc(mCli(pkCli_1749,pkSess_1753),Kcli_1764))
                                    )
                                    else
                                        {1323}let v_1765: bool = (Sess = B) in
                                        (
                                            {1324}if v_1765 then
                                            (
                                                {1325}let pkSess_1766: bitstring = pub(skB) in
                                                {1326}out(c, GetEndpointRequest);
                                                {1327}in(c, (=GetEndpointResponse,=pkSess_1766,=SignAndEncrypt,SP_1767: bitstring,UP_1768: bitstring));
                                                {1328}new Nc_1769: bitstring;
                                                {1329}let m1_1770: bitstring = (OpenSecureChannelRequest,pkCli_1749,Nc_1769) in
                                                {1330}out(c, (pkCli_1749,enc(m1_1770,pkSess_1766),sign(h(m1_1770),skCli_1748)));
                                                {1331}in(c, (em2_1771: bitstring,sigM2_1772: bitstring));
                                                {1332}let m2_1773: bitstring = dec(em2_1771,skCli_1748) in
                                                {1333}if (verify(h(m2_1773),sigM2_1772,pkSess_1766) <> true) then
                                                    0
                                                else
                                                    {1334}let (=OpenSecureChannelResponse,Ns_1774: bitstring,ST_1775: bitstring,TTL_1776: bitstring) = m2_1773 in
                                                    {1335}let Kcli_1777: bitstring = h((Nc_1769,Ns_1774)) in
                                                    {1336}out(c, senc(mCli(pkCli_1749,pkSess_1766),Kcli_1777))
                                            )
                                            else
                                                {1337}let v_1778: bool = (Sess = C) in
                                                (
                                                    {1338}if v_1778 then
                                                    (
                                                        {1339}let pkSess_1779: bitstring = pub(skC) in
                                                        {1340}out(c, GetEndpointRequest);
                                                        {1341}in(c, (=GetEndpointResponse,=pkSess_1779,=SignAndEncrypt,SP_1780: bitstring,UP_1781: bitstring));
                                                        {1342}new Nc_1782: bitstring;
                                                        {1343}let m1_1783: bitstring = (OpenSecureChannelRequest,pkCli_1749,Nc_1782) in
                                                        {1344}out(c, (pkCli_1749,enc(m1_1783,pkSess_1779),sign(h(m1_1783),skCli_1748)));
                                                        {1345}in(c, (em2_1784: bitstring,sigM2_1785: bitstring));
                                                        {1346}let m2_1786: bitstring = dec(em2_1784,skCli_1748) in
                                                        {1347}if (verify(h(m2_1786),sigM2_1785,pkSess_1779) <> true) then
                                                            0
                                                        else
                                                            {1348}let (=OpenSecureChannelResponse,Ns_1787: bitstring,ST_1788: bitstring,TTL_1789: bitstring) = m2_1786 in
                                                            {1349}let Kcli_1790: bitstring = h((Nc_1782,Ns_1787)) in
                                                            {1350}out(c, senc(mCli(pkCli_1749,pkSess_1779),Kcli_1790))
                                                    )
                                                    else
                                                        {1351}let pkSess_1791: bitstring = pub(sk(Sess)) in
                                                        {1352}out(c, GetEndpointRequest);
                                                        {1353}in(c, (=GetEndpointResponse,=pkSess_1791,=SignAndEncrypt,SP_1792: bitstring,UP_1793: bitstring));
                                                        {1354}new Nc_1794: bitstring;
                                                        {1355}let m1_1795: bitstring = (OpenSecureChannelRequest,pkCli_1749,Nc_1794) in
                                                        {1356}out(c, (pkCli_1749,enc(m1_1795,pkSess_1791),sign(h(m1_1795),skCli_1748)));
                                                        {1357}in(c, (em2_1796: bitstring,sigM2_1797: bitstring));
                                                        {1358}let m2_1798: bitstring = dec(em2_1796,skCli_1748) in
                                                        {1359}if (verify(h(m2_1798),sigM2_1797,pkSess_1791) <> true) then
                                                            0
                                                        else
                                                            {1360}let (=OpenSecureChannelResponse,Ns_1799: bitstring,ST_1800: bitstring,TTL_1801: bitstring) = m2_1798 in
                                                            {1361}let Kcli_1802: bitstring = h((Nc_1794,Ns_1799)) in
                                                            {1362}out(c, senc(mCli(pkCli_1749,pkSess_1791),Kcli_1802))
                                                )
                                                else
                                                    {1363}let pkSess_1803: bitstring = fail-any in
                                                    {1364}out(c, GetEndpointRequest);
                                                    {1365}in(c, (=GetEndpointResponse,=pkSess_1803,=SignAndEncrypt,SP_1804: bitstring,UP_1805: bitstring));
                                                    {1366}new Nc_1806: bitstring;
                                                    {1367}let m1_1807: bitstring = (OpenSecureChannelRequest,pkCli_1749,Nc_1806) in
                                                    {1368}out(c, (pkCli_1749,enc(m1_1807,pkSess_1803),sign(h(m1_1807),skCli_1748)));
                                                    {1369}in(c, (em2_1808: bitstring,sigM2_1809: bitstring));
                                                    {1370}let m2_1810: bitstring = dec(em2_1808,skCli_1748) in
                                                    {1371}if (verify(h(m2_1810),sigM2_1809,pkSess_1803) <> true) then
                                                        0
                                                    else
                                                        {1372}let (=OpenSecureChannelResponse,Ns_1811: bitstring,ST_1812: bitstring,TTL_1813: bitstring) = m2_1810 in
                                                        {1373}let Kcli_1814: bitstring = h((Nc_1806,Ns_1811)) in
                                                        {1374}out(c, senc(mCli(pkCli_1749,pkSess_1803),Kcli_1814))
                                        )
                                        else
                                            {1375}let pkSess_1815: bitstring = fail-any in
                                            {1376}out(c, GetEndpointRequest);
                                            {1377}in(c, (=GetEndpointResponse,=pkSess_1815,=SignAndEncrypt,SP_1816: bitstring,UP_1817: bitstring));
                                            {1378}new Nc_1818: bitstring;
                                            {1379}let m1_1819: bitstring = (OpenSecureChannelRequest,pkCli_1749,Nc_1818) in
                                            {1380}out(c, (pkCli_1749,enc(m1_1819,pkSess_1815),sign(h(m1_1819),skCli_1748)));
                                            {1381}in(c, (em2_1820: bitstring,sigM2_1821: bitstring));
                                            {1382}let m2_1822: bitstring = dec(em2_1820,skCli_1748) in
                                            {1383}if (verify(h(m2_1822),sigM2_1821,pkSess_1815) <> true) then
                                                0
                                            else
                                                {1384}let (=OpenSecureChannelResponse,Ns_1823: bitstring,ST_1824: bitstring,TTL_1825: bitstring) = m2_1822 in
                                                {1385}let Kcli_1826: bitstring = h((Nc_1818,Ns_1823)) in
                                                {1386}out(c, senc(mCli(pkCli_1749,pkSess_1815),Kcli_1826))
                                )
                                else
                                    {1387}let pkSess_1827: bitstring = fail-any in
                                    {1388}out(c, GetEndpointRequest);
                                    {1389}in(c, (=GetEndpointResponse,=pkSess_1827,=SignAndEncrypt,SP_1828: bitstring,UP_1829: bitstring));
                                    {1390}new Nc_1830: bitstring;
                                    {1391}let m1_1831: bitstring = (OpenSecureChannelRequest,pkCli_1749,Nc_1830) in
                                    {1392}out(c, (pkCli_1749,enc(m1_1831,pkSess_1827),sign(h(m1_1831),skCli_1748)));
                                    {1393}in(c, (em2_1832: bitstring,sigM2_1833: bitstring));
                                    {1394}let m2_1834: bitstring = dec(em2_1832,skCli_1748) in
                                    {1395}if (verify(h(m2_1834),sigM2_1833,pkSess_1827) <> true) then
                                        0
                                    else
                                        {1396}let (=OpenSecureChannelResponse,Ns_1835: bitstring,ST_1836: bitstring,TTL_1837: bitstring) = m2_1834 in
                                        {1397}let Kcli_1838: bitstring = h((Nc_1830,Ns_1835)) in
                                        {1398}out(c, senc(mCli(pkCli_1749,pkSess_1827),Kcli_1838))
                            )
                            else
                                {1399}let v_1839: bool = (Disco = B) in
                                (
                                    {1400}if v_1839 then
                                    (
                                        {1401}let pkDisco_1840: bitstring = pub(skB) in
                                        {1402}let v_1841: bool = (Sess = A) in
                                        (
                                            {1403}if v_1841 then
                                            (
                                                {1404}let pkSess_1842: bitstring = pub(skA) in
                                                {1405}out(c, GetEndpointRequest);
                                                {1406}in(c, (=GetEndpointResponse,=pkSess_1842,=SignAndEncrypt,SP_1843: bitstring,UP_1844: bitstring));
                                                {1407}new Nc_1845: bitstring;
                                                {1408}let m1_1846: bitstring = (OpenSecureChannelRequest,pkCli_1749,Nc_1845) in
                                                {1409}out(c, (pkCli_1749,enc(m1_1846,pkSess_1842),sign(h(m1_1846),skCli_1748)));
                                                {1410}in(c, (em2_1847: bitstring,sigM2_1848: bitstring));
                                                {1411}let m2_1849: bitstring = dec(em2_1847,skCli_1748) in
                                                {1412}if (verify(h(m2_1849),sigM2_1848,pkSess_1842) <> true) then
                                                    0
                                                else
                                                    {1413}let (=OpenSecureChannelResponse,Ns_1850: bitstring,ST_1851: bitstring,TTL_1852: bitstring) = m2_1849 in
                                                    {1414}let Kcli_1853: bitstring = h((Nc_1845,Ns_1850)) in
                                                    {1415}out(c, senc(mCli(pkCli_1749,pkSess_1842),Kcli_1853))
                                            )
                                            else
                                                {1416}let v_1854: bool = (Sess = B) in
                                                (
                                                    {1417}if v_1854 then
                                                    (
                                                        {1418}let pkSess_1855: bitstring = pub(skB) in
                                                        {1419}out(c, GetEndpointRequest);
                                                        {1420}in(c, (=GetEndpointResponse,=pkSess_1855,=SignAndEncrypt,SP_1856: bitstring,UP_1857: bitstring));
                                                        {1421}new Nc_1858: bitstring;
                                                        {1422}let m1_1859: bitstring = (OpenSecureChannelRequest,pkCli_1749,Nc_1858) in
                                                        {1423}out(c, (pkCli_1749,enc(m1_1859,pkSess_1855),sign(h(m1_1859),skCli_1748)));
                                                        {1424}in(c, (em2_1860: bitstring,sigM2_1861: bitstring));
                                                        {1425}let m2_1862: bitstring = dec(em2_1860,skCli_1748) in
                                                        {1426}if (verify(h(m2_1862),sigM2_1861,pkSess_1855) <> true) then
                                                            0
                                                        else
                                                            {1427}let (=OpenSecureChannelResponse,Ns_1863: bitstring,ST_1864: bitstring,TTL_1865: bitstring) = m2_1862 in
                                                            {1428}let Kcli_1866: bitstring = h((Nc_1858,Ns_1863)) in
                                                            {1429}out(c, senc(mCli(pkCli_1749,pkSess_1855),Kcli_1866))
                                                    )
                                                    else
                                                        {1430}let v_1867: bool = (Sess = C) in
                                                        (
                                                            {1431}if v_1867 then
                                                            (
                                                                {1432}let pkSess_1868: bitstring = pub(skC) in
                                                                {1433}out(c, GetEndpointRequest);
                                                                {1434}in(c, (=GetEndpointResponse,=pkSess_1868,=SignAndEncrypt,SP_1869: bitstring,UP_1870: bitstring));
                                                                {1435}new Nc_1871: bitstring;
                                                                {1436}let m1_1872: bitstring = (OpenSecureChannelRequest,pkCli_1749,Nc_1871) in
                                                                {1437}out(c, (pkCli_1749,enc(m1_1872,pkSess_1868),sign(h(m1_1872),skCli_1748)));
                                                                {1438}in(c, (em2_1873: bitstring,sigM2_1874: bitstring));
                                                                {1439}let m2_1875: bitstring = dec(em2_1873,skCli_1748) in
                                                                {1440}if (verify(h(m2_1875),sigM2_1874,pkSess_1868) <> true) then
                                                                    0
                                                                else
                                                                    {1441}let (=OpenSecureChannelResponse,Ns_1876: bitstring,ST_1877: bitstring,TTL_1878: bitstring) = m2_1875 in
                                                                    {1442}let Kcli_1879: bitstring = h((Nc_1871,Ns_1876)) in
                                                                    {1443}out(c, senc(mCli(pkCli_1749,pkSess_1868),Kcli_1879))
                                                            )
                                                            else
                                                                {1444}let pkSess_1880: bitstring = pub(sk(Sess)) in
                                                                {1445}out(c, GetEndpointRequest);
                                                                {1446}in(c, (=GetEndpointResponse,=pkSess_1880,=SignAndEncrypt,SP_1881: bitstring,UP_1882: bitstring));
                                                                {1447}new Nc_1883: bitstring;
                                                                {1448}let m1_1884: bitstring = (OpenSecureChannelRequest,pkCli_1749,Nc_1883) in
                                                                {1449}out(c, (pkCli_1749,enc(m1_1884,pkSess_1880),sign(h(m1_1884),skCli_1748)));
                                                                {1450}in(c, (em2_1885: bitstring,sigM2_1886: bitstring));
                                                                {1451}let m2_1887: bitstring = dec(em2_1885,skCli_1748) in
                                                                {1452}if (verify(h(m2_1887),sigM2_1886,pkSess_1880) <> true) then
                                                                    0
                                                                else
                                                                    {1453}let (=OpenSecureChannelResponse,Ns_1888: bitstring,ST_1889: bitstring,TTL_1890: bitstring) = m2_1887 in
                                                                    {1454}let Kcli_1891: bitstring = h((Nc_1883,Ns_1888)) in
                                                                    {1455}out(c, senc(mCli(pkCli_1749,pkSess_1880),Kcli_1891))
                                                        )
                                                        else
                                                            {1456}let pkSess_1892: bitstring = fail-any in
                                                            {1457}out(c, GetEndpointRequest);
                                                            {1458}in(c, (=GetEndpointResponse,=pkSess_1892,=SignAndEncrypt,SP_1893: bitstring,UP_1894: bitstring));
                                                            {1459}new Nc_1895: bitstring;
                                                            {1460}let m1_1896: bitstring = (OpenSecureChannelRequest,pkCli_1749,Nc_1895) in
                                                            {1461}out(c, (pkCli_1749,enc(m1_1896,pkSess_1892),sign(h(m1_1896),skCli_1748)));
                                                            {1462}in(c, (em2_1897: bitstring,sigM2_1898: bitstring));
                                                            {1463}let m2_1899: bitstring = dec(em2_1897,skCli_1748) in
                                                            {1464}if (verify(h(m2_1899),sigM2_1898,pkSess_1892) <> true) then
                                                                0
                                                            else
                                                                {1465}let (=OpenSecureChannelResponse,Ns_1900: bitstring,ST_1901: bitstring,TTL_1902: bitstring) = m2_1899 in
                                                                {1466}let Kcli_1903: bitstring = h((Nc_1895,Ns_1900)) in
                                                                {1467}out(c, senc(mCli(pkCli_1749,pkSess_1892),Kcli_1903))
                                                )
                                                else
                                                    {1468}let pkSess_1904: bitstring = fail-any in
                                                    {1469}out(c, GetEndpointRequest);
                                                    {1470}in(c, (=GetEndpointResponse,=pkSess_1904,=SignAndEncrypt,SP_1905: bitstring,UP_1906: bitstring));
                                                    {1471}new Nc_1907: bitstring;
                                                    {1472}let m1_1908: bitstring = (OpenSecureChannelRequest,pkCli_1749,Nc_1907) in
                                                    {1473}out(c, (pkCli_1749,enc(m1_1908,pkSess_1904),sign(h(m1_1908),skCli_1748)));
                                                    {1474}in(c, (em2_1909: bitstring,sigM2_1910: bitstring));
                                                    {1475}let m2_1911: bitstring = dec(em2_1909,skCli_1748) in
                                                    {1476}if (verify(h(m2_1911),sigM2_1910,pkSess_1904) <> true) then
                                                        0
                                                    else
                                                        {1477}let (=OpenSecureChannelResponse,Ns_1912: bitstring,ST_1913: bitstring,TTL_1914: bitstring) = m2_1911 in
                                                        {1478}let Kcli_1915: bitstring = h((Nc_1907,Ns_1912)) in
                                                        {1479}out(c, senc(mCli(pkCli_1749,pkSess_1904),Kcli_1915))
                                        )
                                        else
                                            {1480}let pkSess_1916: bitstring = fail-any in
                                            {1481}out(c, GetEndpointRequest);
                                            {1482}in(c, (=GetEndpointResponse,=pkSess_1916,=SignAndEncrypt,SP_1917: bitstring,UP_1918: bitstring));
                                            {1483}new Nc_1919: bitstring;
                                            {1484}let m1_1920: bitstring = (OpenSecureChannelRequest,pkCli_1749,Nc_1919) in
                                            {1485}out(c, (pkCli_1749,enc(m1_1920,pkSess_1916),sign(h(m1_1920),skCli_1748)));
                                            {1486}in(c, (em2_1921: bitstring,sigM2_1922: bitstring));
                                            {1487}let m2_1923: bitstring = dec(em2_1921,skCli_1748) in
                                            {1488}if (verify(h(m2_1923),sigM2_1922,pkSess_1916) <> true) then
                                                0
                                            else
                                                {1489}let (=OpenSecureChannelResponse,Ns_1924: bitstring,ST_1925: bitstring,TTL_1926: bitstring) = m2_1923 in
                                                {1490}let Kcli_1927: bitstring = h((Nc_1919,Ns_1924)) in
                                                {1491}out(c, senc(mCli(pkCli_1749,pkSess_1916),Kcli_1927))
                                    )
                                    else
                                        {1492}let v_1928: bool = (Disco = C) in
                                        (
                                            {1493}if v_1928 then
                                            (
                                                {1494}let pkDisco_1929: bitstring = pub(skC) in
                                                {1495}let v_1930: bool = (Sess = A) in
                                                (
                                                    {1496}if v_1930 then
                                                    (
                                                        {1497}let pkSess_1931: bitstring = pub(skA) in
                                                        {1498}out(c, GetEndpointRequest);
                                                        {1499}in(c, (=GetEndpointResponse,=pkSess_1931,=SignAndEncrypt,SP_1932: bitstring,UP_1933: bitstring));
                                                        {1500}new Nc_1934: bitstring;
                                                        {1501}let m1_1935: bitstring = (OpenSecureChannelRequest,pkCli_1749,Nc_1934) in
                                                        {1502}out(c, (pkCli_1749,enc(m1_1935,pkSess_1931),sign(h(m1_1935),skCli_1748)));
                                                        {1503}in(c, (em2_1936: bitstring,sigM2_1937: bitstring));
                                                        {1504}let m2_1938: bitstring = dec(em2_1936,skCli_1748) in
                                                        {1505}if (verify(h(m2_1938),sigM2_1937,pkSess_1931) <> true) then
                                                            0
                                                        else
                                                            {1506}let (=OpenSecureChannelResponse,Ns_1939: bitstring,ST_1940: bitstring,TTL_1941: bitstring) = m2_1938 in
                                                            {1507}let Kcli_1942: bitstring = h((Nc_1934,Ns_1939)) in
                                                            {1508}out(c, senc(mCli(pkCli_1749,pkSess_1931),Kcli_1942))
                                                    )
                                                    else
                                                        {1509}let v_1943: bool = (Sess = B) in
                                                        (
                                                            {1510}if v_1943 then
                                                            (
                                                                {1511}let pkSess_1944: bitstring = pub(skB) in
                                                                {1512}out(c, GetEndpointRequest);
                                                                {1513}in(c, (=GetEndpointResponse,=pkSess_1944,=SignAndEncrypt,SP_1945: bitstring,UP_1946: bitstring));
                                                                {1514}new Nc_1947: bitstring;
                                                                {1515}let m1_1948: bitstring = (OpenSecureChannelRequest,pkCli_1749,Nc_1947) in
                                                                {1516}out(c, (pkCli_1749,enc(m1_1948,pkSess_1944),sign(h(m1_1948),skCli_1748)));
                                                                {1517}in(c, (em2_1949: bitstring,sigM2_1950: bitstring));
                                                                {1518}let m2_1951: bitstring = dec(em2_1949,skCli_1748) in
                                                                {1519}if (verify(h(m2_1951),sigM2_1950,pkSess_1944) <> true) then
                                                                    0
                                                                else
                                                                    {1520}let (=OpenSecureChannelResponse,Ns_1952: bitstring,ST_1953: bitstring,TTL_1954: bitstring) = m2_1951 in
                                                                    {1521}let Kcli_1955: bitstring = h((Nc_1947,Ns_1952)) in
                                                                    {1522}out(c, senc(mCli(pkCli_1749,pkSess_1944),Kcli_1955))
                                                            )
                                                            else
                                                                {1523}let v_1956: bool = (Sess = C) in
                                                                (
                                                                    {1524}if v_1956 then
                                                                    (
                                                                        {1525}let pkSess_1957: bitstring = pub(skC) in
                                                                        {1526}out(c, GetEndpointRequest);
                                                                        {1527}in(c, (=GetEndpointResponse,=pkSess_1957,=SignAndEncrypt,SP_1958: bitstring,UP_1959: bitstring));
                                                                        {1528}new Nc_1960: bitstring;
                                                                        {1529}let m1_1961: bitstring = (OpenSecureChannelRequest,pkCli_1749,Nc_1960) in
                                                                        {1530}out(c, (pkCli_1749,enc(m1_1961,pkSess_1957),sign(h(m1_1961),skCli_1748)));
                                                                        {1531}in(c, (em2_1962: bitstring,sigM2_1963: bitstring));
                                                                        {1532}let m2_1964: bitstring = dec(em2_1962,skCli_1748) in
                                                                        {1533}if (verify(h(m2_1964),sigM2_1963,pkSess_1957) <> true) then
                                                                            0
                                                                        else
                                                                            {1534}let (=OpenSecureChannelResponse,Ns_1965: bitstring,ST_1966: bitstring,TTL_1967: bitstring) = m2_1964 in
                                                                            {1535}let Kcli_1968: bitstring = h((Nc_1960,Ns_1965)) in
                                                                            {1536}out(c, senc(mCli(pkCli_1749,pkSess_1957),Kcli_1968))
                                                                    )
                                                                    else
                                                                        {1537}let pkSess_1969: bitstring = pub(sk(Sess)) in
                                                                        {1538}out(c, GetEndpointRequest);
                                                                        {1539}in(c, (=GetEndpointResponse,=pkSess_1969,=SignAndEncrypt,SP_1970: bitstring,UP_1971: bitstring));
                                                                        {1540}new Nc_1972: bitstring;
                                                                        {1541}let m1_1973: bitstring = (OpenSecureChannelRequest,pkCli_1749,Nc_1972) in
                                                                        {1542}out(c, (pkCli_1749,enc(m1_1973,pkSess_1969),sign(h(m1_1973),skCli_1748)));
                                                                        {1543}in(c, (em2_1974: bitstring,sigM2_1975: bitstring));
                                                                        {1544}let m2_1976: bitstring = dec(em2_1974,skCli_1748) in
                                                                        {1545}if (verify(h(m2_1976),sigM2_1975,pkSess_1969) <> true) then
                                                                            0
                                                                        else
                                                                            {1546}let (=OpenSecureChannelResponse,Ns_1977: bitstring,ST_1978: bitstring,TTL_1979: bitstring) = m2_1976 in
                                                                            {1547}let Kcli_1980: bitstring = h((Nc_1972,Ns_1977)) in
                                                                            {1548}out(c, senc(mCli(pkCli_1749,pkSess_1969),Kcli_1980))
                                                                )
                                                                else
                                                                    {1549}let pkSess_1981: bitstring = fail-any in
                                                                    {1550}out(c, GetEndpointRequest);
                                                                    {1551}in(c, (=GetEndpointResponse,=pkSess_1981,=SignAndEncrypt,SP_1982: bitstring,UP_1983: bitstring));
                                                                    {1552}new Nc_1984: bitstring;
                                                                    {1553}let m1_1985: bitstring = (OpenSecureChannelRequest,pkCli_1749,Nc_1984) in
                                                                    {1554}out(c, (pkCli_1749,enc(m1_1985,pkSess_1981),sign(h(m1_1985),skCli_1748)));
                                                                    {1555}in(c, (em2_1986: bitstring,sigM2_1987: bitstring));
                                                                    {1556}let m2_1988: bitstring = dec(em2_1986,skCli_1748) in
                                                                    {1557}if (verify(h(m2_1988),sigM2_1987,pkSess_1981) <> true) then
                                                                        0
                                                                    else
                                                                        {1558}let (=OpenSecureChannelResponse,Ns_1989: bitstring,ST_1990: bitstring,TTL_1991: bitstring) = m2_1988 in
                                                                        {1559}let Kcli_1992: bitstring = h((Nc_1984,Ns_1989)) in
                                                                        {1560}out(c, senc(mCli(pkCli_1749,pkSess_1981),Kcli_1992))
                                                        )
                                                        else
                                                            {1561}let pkSess_1993: bitstring = fail-any in
                                                            {1562}out(c, GetEndpointRequest);
                                                            {1563}in(c, (=GetEndpointResponse,=pkSess_1993,=SignAndEncrypt,SP_1994: bitstring,UP_1995: bitstring));
                                                            {1564}new Nc_1996: bitstring;
                                                            {1565}let m1_1997: bitstring = (OpenSecureChannelRequest,pkCli_1749,Nc_1996) in
                                                            {1566}out(c, (pkCli_1749,enc(m1_1997,pkSess_1993),sign(h(m1_1997),skCli_1748)));
                                                            {1567}in(c, (em2_1998: bitstring,sigM2_1999: bitstring));
                                                            {1568}let m2_2000: bitstring = dec(em2_1998,skCli_1748) in
                                                            {1569}if (verify(h(m2_2000),sigM2_1999,pkSess_1993) <> true) then
                                                                0
                                                            else
                                                                {1570}let (=OpenSecureChannelResponse,Ns_2001: bitstring,ST_2002: bitstring,TTL_2003: bitstring) = m2_2000 in
                                                                {1571}let Kcli_2004: bitstring = h((Nc_1996,Ns_2001)) in
                                                                {1572}out(c, senc(mCli(pkCli_1749,pkSess_1993),Kcli_2004))
                                                )
                                                else
                                                    {1573}let pkSess_2005: bitstring = fail-any in
                                                    {1574}out(c, GetEndpointRequest);
                                                    {1575}in(c, (=GetEndpointResponse,=pkSess_2005,=SignAndEncrypt,SP_2006: bitstring,UP_2007: bitstring));
                                                    {1576}new Nc_2008: bitstring;
                                                    {1577}let m1_2009: bitstring = (OpenSecureChannelRequest,pkCli_1749,Nc_2008) in
                                                    {1578}out(c, (pkCli_1749,enc(m1_2009,pkSess_2005),sign(h(m1_2009),skCli_1748)));
                                                    {1579}in(c, (em2_2010: bitstring,sigM2_2011: bitstring));
                                                    {1580}let m2_2012: bitstring = dec(em2_2010,skCli_1748) in
                                                    {1581}if (verify(h(m2_2012),sigM2_2011,pkSess_2005) <> true) then
                                                        0
                                                    else
                                                        {1582}let (=OpenSecureChannelResponse,Ns_2013: bitstring,ST_2014: bitstring,TTL_2015: bitstring) = m2_2012 in
                                                        {1583}let Kcli_2016: bitstring = h((Nc_2008,Ns_2013)) in
                                                        {1584}out(c, senc(mCli(pkCli_1749,pkSess_2005),Kcli_2016))
                                            )
                                            else
                                                {1585}let pkDisco_2017: bitstring = pub(sk(Disco)) in
                                                {1586}let v_2018: bool = (Sess = A) in
                                                (
                                                    {1587}if v_2018 then
                                                    (
                                                        {1588}let pkSess_2019: bitstring = pub(skA) in
                                                        {1589}out(c, GetEndpointRequest);
                                                        {1590}in(c, (=GetEndpointResponse,=pkSess_2019,=SignAndEncrypt,SP_2020: bitstring,UP_2021: bitstring));
                                                        {1591}new Nc_2022: bitstring;
                                                        {1592}let m1_2023: bitstring = (OpenSecureChannelRequest,pkCli_1749,Nc_2022) in
                                                        {1593}out(c, (pkCli_1749,enc(m1_2023,pkSess_2019),sign(h(m1_2023),skCli_1748)));
                                                        {1594}in(c, (em2_2024: bitstring,sigM2_2025: bitstring));
                                                        {1595}let m2_2026: bitstring = dec(em2_2024,skCli_1748) in
                                                        {1596}if (verify(h(m2_2026),sigM2_2025,pkSess_2019) <> true) then
                                                            0
                                                        else
                                                            {1597}let (=OpenSecureChannelResponse,Ns_2027: bitstring,ST_2028: bitstring,TTL_2029: bitstring) = m2_2026 in
                                                            {1598}let Kcli_2030: bitstring = h((Nc_2022,Ns_2027)) in
                                                            {1599}out(c, senc(mCli(pkCli_1749,pkSess_2019),Kcli_2030))
                                                    )
                                                    else
                                                        {1600}let v_2031: bool = (Sess = B) in
                                                        (
                                                            {1601}if v_2031 then
                                                            (
                                                                {1602}let pkSess_2032: bitstring = pub(skB) in
                                                                {1603}out(c, GetEndpointRequest);
                                                                {1604}in(c, (=GetEndpointResponse,=pkSess_2032,=SignAndEncrypt,SP_2033: bitstring,UP_2034: bitstring));
                                                                {1605}new Nc_2035: bitstring;
                                                                {1606}let m1_2036: bitstring = (OpenSecureChannelRequest,pkCli_1749,Nc_2035) in
                                                                {1607}out(c, (pkCli_1749,enc(m1_2036,pkSess_2032),sign(h(m1_2036),skCli_1748)));
                                                                {1608}in(c, (em2_2037: bitstring,sigM2_2038: bitstring));
                                                                {1609}let m2_2039: bitstring = dec(em2_2037,skCli_1748) in
                                                                {1610}if (verify(h(m2_2039),sigM2_2038,pkSess_2032) <> true) then
                                                                    0
                                                                else
                                                                    {1611}let (=OpenSecureChannelResponse,Ns_2040: bitstring,ST_2041: bitstring,TTL_2042: bitstring) = m2_2039 in
                                                                    {1612}let Kcli_2043: bitstring = h((Nc_2035,Ns_2040)) in
                                                                    {1613}out(c, senc(mCli(pkCli_1749,pkSess_2032),Kcli_2043))
                                                            )
                                                            else
                                                                {1614}let v_2044: bool = (Sess = C) in
                                                                (
                                                                    {1615}if v_2044 then
                                                                    (
                                                                        {1616}let pkSess_2045: bitstring = pub(skC) in
                                                                        {1617}out(c, GetEndpointRequest);
                                                                        {1618}in(c, (=GetEndpointResponse,=pkSess_2045,=SignAndEncrypt,SP_2046: bitstring,UP_2047: bitstring));
                                                                        {1619}new Nc_2048: bitstring;
                                                                        {1620}let m1_2049: bitstring = (OpenSecureChannelRequest,pkCli_1749,Nc_2048) in
                                                                        {1621}out(c, (pkCli_1749,enc(m1_2049,pkSess_2045),sign(h(m1_2049),skCli_1748)));
                                                                        {1622}in(c, (em2_2050: bitstring,sigM2_2051: bitstring));
                                                                        {1623}let m2_2052: bitstring = dec(em2_2050,skCli_1748) in
                                                                        {1624}if (verify(h(m2_2052),sigM2_2051,pkSess_2045) <> true) then
                                                                            0
                                                                        else
                                                                            {1625}let (=OpenSecureChannelResponse,Ns_2053: bitstring,ST_2054: bitstring,TTL_2055: bitstring) = m2_2052 in
                                                                            {1626}let Kcli_2056: bitstring = h((Nc_2048,Ns_2053)) in
                                                                            {1627}out(c, senc(mCli(pkCli_1749,pkSess_2045),Kcli_2056))
                                                                    )
                                                                    else
                                                                        {1628}let pkSess_2057: bitstring = pub(sk(Sess)) in
                                                                        {1629}out(c, GetEndpointRequest);
                                                                        {1630}in(c, (=GetEndpointResponse,=pkSess_2057,=SignAndEncrypt,SP_2058: bitstring,UP_2059: bitstring));
                                                                        {1631}new Nc_2060: bitstring;
                                                                        {1632}let m1_2061: bitstring = (OpenSecureChannelRequest,pkCli_1749,Nc_2060) in
                                                                        {1633}out(c, (pkCli_1749,enc(m1_2061,pkSess_2057),sign(h(m1_2061),skCli_1748)));
                                                                        {1634}in(c, (em2_2062: bitstring,sigM2_2063: bitstring));
                                                                        {1635}let m2_2064: bitstring = dec(em2_2062,skCli_1748) in
                                                                        {1636}if (verify(h(m2_2064),sigM2_2063,pkSess_2057) <> true) then
                                                                            0
                                                                        else
                                                                            {1637}let (=OpenSecureChannelResponse,Ns_2065: bitstring,ST_2066: bitstring,TTL_2067: bitstring) = m2_2064 in
                                                                            {1638}let Kcli_2068: bitstring = h((Nc_2060,Ns_2065)) in
                                                                            {1639}out(c, senc(mCli(pkCli_1749,pkSess_2057),Kcli_2068))
                                                                )
                                                                else
                                                                    {1640}let pkSess_2069: bitstring = fail-any in
                                                                    {1641}out(c, GetEndpointRequest);
                                                                    {1642}in(c, (=GetEndpointResponse,=pkSess_2069,=SignAndEncrypt,SP_2070: bitstring,UP_2071: bitstring));
                                                                    {1643}new Nc_2072: bitstring;
                                                                    {1644}let m1_2073: bitstring = (OpenSecureChannelRequest,pkCli_1749,Nc_2072) in
                                                                    {1645}out(c, (pkCli_1749,enc(m1_2073,pkSess_2069),sign(h(m1_2073),skCli_1748)));
                                                                    {1646}in(c, (em2_2074: bitstring,sigM2_2075: bitstring));
                                                                    {1647}let m2_2076: bitstring = dec(em2_2074,skCli_1748) in
                                                                    {1648}if (verify(h(m2_2076),sigM2_2075,pkSess_2069) <> true) then
                                                                        0
                                                                    else
                                                                        {1649}let (=OpenSecureChannelResponse,Ns_2077: bitstring,ST_2078: bitstring,TTL_2079: bitstring) = m2_2076 in
                                                                        {1650}let Kcli_2080: bitstring = h((Nc_2072,Ns_2077)) in
                                                                        {1651}out(c, senc(mCli(pkCli_1749,pkSess_2069),Kcli_2080))
                                                        )
                                                        else
                                                            {1652}let pkSess_2081: bitstring = fail-any in
                                                            {1653}out(c, GetEndpointRequest);
                                                            {1654}in(c, (=GetEndpointResponse,=pkSess_2081,=SignAndEncrypt,SP_2082: bitstring,UP_2083: bitstring));
                                                            {1655}new Nc_2084: bitstring;
                                                            {1656}let m1_2085: bitstring = (OpenSecureChannelRequest,pkCli_1749,Nc_2084) in
                                                            {1657}out(c, (pkCli_1749,enc(m1_2085,pkSess_2081),sign(h(m1_2085),skCli_1748)));
                                                            {1658}in(c, (em2_2086: bitstring,sigM2_2087: bitstring));
                                                            {1659}let m2_2088: bitstring = dec(em2_2086,skCli_1748) in
                                                            {1660}if (verify(h(m2_2088),sigM2_2087,pkSess_2081) <> true) then
                                                                0
                                                            else
                                                                {1661}let (=OpenSecureChannelResponse,Ns_2089: bitstring,ST_2090: bitstring,TTL_2091: bitstring) = m2_2088 in
                                                                {1662}let Kcli_2092: bitstring = h((Nc_2084,Ns_2089)) in
                                                                {1663}out(c, senc(mCli(pkCli_1749,pkSess_2081),Kcli_2092))
                                                )
                                                else
                                                    {1664}let pkSess_2093: bitstring = fail-any in
                                                    {1665}out(c, GetEndpointRequest);
                                                    {1666}in(c, (=GetEndpointResponse,=pkSess_2093,=SignAndEncrypt,SP_2094: bitstring,UP_2095: bitstring));
                                                    {1667}new Nc_2096: bitstring;
                                                    {1668}let m1_2097: bitstring = (OpenSecureChannelRequest,pkCli_1749,Nc_2096) in
                                                    {1669}out(c, (pkCli_1749,enc(m1_2097,pkSess_2093),sign(h(m1_2097),skCli_1748)));
                                                    {1670}in(c, (em2_2098: bitstring,sigM2_2099: bitstring));
                                                    {1671}let m2_2100: bitstring = dec(em2_2098,skCli_1748) in
                                                    {1672}if (verify(h(m2_2100),sigM2_2099,pkSess_2093) <> true) then
                                                        0
                                                    else
                                                        {1673}let (=OpenSecureChannelResponse,Ns_2101: bitstring,ST_2102: bitstring,TTL_2103: bitstring) = m2_2100 in
                                                        {1674}let Kcli_2104: bitstring = h((Nc_2096,Ns_2101)) in
                                                        {1675}out(c, senc(mCli(pkCli_1749,pkSess_2093),Kcli_2104))
                                        )
                                        else
                                            {1676}let pkDisco_2105: bitstring = fail-any in
                                            {1677}let v_2106: bool = (Sess = A) in
                                            (
                                                {1678}if v_2106 then
                                                (
                                                    {1679}let pkSess_2107: bitstring = pub(skA) in
                                                    {1680}out(c, GetEndpointRequest);
                                                    {1681}in(c, (=GetEndpointResponse,=pkSess_2107,=SignAndEncrypt,SP_2108: bitstring,UP_2109: bitstring));
                                                    {1682}new Nc_2110: bitstring;
                                                    {1683}let m1_2111: bitstring = (OpenSecureChannelRequest,pkCli_1749,Nc_2110) in
                                                    {1684}out(c, (pkCli_1749,enc(m1_2111,pkSess_2107),sign(h(m1_2111),skCli_1748)));
                                                    {1685}in(c, (em2_2112: bitstring,sigM2_2113: bitstring));
                                                    {1686}let m2_2114: bitstring = dec(em2_2112,skCli_1748) in
                                                    {1687}if (verify(h(m2_2114),sigM2_2113,pkSess_2107) <> true) then
                                                        0
                                                    else
                                                        {1688}let (=OpenSecureChannelResponse,Ns_2115: bitstring,ST_2116: bitstring,TTL_2117: bitstring) = m2_2114 in
                                                        {1689}let Kcli_2118: bitstring = h((Nc_2110,Ns_2115)) in
                                                        {1690}out(c, senc(mCli(pkCli_1749,pkSess_2107),Kcli_2118))
                                                )
                                                else
                                                    {1691}let v_2119: bool = (Sess = B) in
                                                    (
                                                        {1692}if v_2119 then
                                                        (
                                                            {1693}let pkSess_2120: bitstring = pub(skB) in
                                                            {1694}out(c, GetEndpointRequest);
                                                            {1695}in(c, (=GetEndpointResponse,=pkSess_2120,=SignAndEncrypt,SP_2121: bitstring,UP_2122: bitstring));
                                                            {1696}new Nc_2123: bitstring;
                                                            {1697}let m1_2124: bitstring = (OpenSecureChannelRequest,pkCli_1749,Nc_2123) in
                                                            {1698}out(c, (pkCli_1749,enc(m1_2124,pkSess_2120),sign(h(m1_2124),skCli_1748)));
                                                            {1699}in(c, (em2_2125: bitstring,sigM2_2126: bitstring));
                                                            {1700}let m2_2127: bitstring = dec(em2_2125,skCli_1748) in
                                                            {1701}if (verify(h(m2_2127),sigM2_2126,pkSess_2120) <> true) then
                                                                0
                                                            else
                                                                {1702}let (=OpenSecureChannelResponse,Ns_2128: bitstring,ST_2129: bitstring,TTL_2130: bitstring) = m2_2127 in
                                                                {1703}let Kcli_2131: bitstring = h((Nc_2123,Ns_2128)) in
                                                                {1704}out(c, senc(mCli(pkCli_1749,pkSess_2120),Kcli_2131))
                                                        )
                                                        else
                                                            {1705}let v_2132: bool = (Sess = C) in
                                                            (
                                                                {1706}if v_2132 then
                                                                (
                                                                    {1707}let pkSess_2133: bitstring = pub(skC) in
                                                                    {1708}out(c, GetEndpointRequest);
                                                                    {1709}in(c, (=GetEndpointResponse,=pkSess_2133,=SignAndEncrypt,SP_2134: bitstring,UP_2135: bitstring));
                                                                    {1710}new Nc_2136: bitstring;
                                                                    {1711}let m1_2137: bitstring = (OpenSecureChannelRequest,pkCli_1749,Nc_2136) in
                                                                    {1712}out(c, (pkCli_1749,enc(m1_2137,pkSess_2133),sign(h(m1_2137),skCli_1748)));
                                                                    {1713}in(c, (em2_2138: bitstring,sigM2_2139: bitstring));
                                                                    {1714}let m2_2140: bitstring = dec(em2_2138,skCli_1748) in
                                                                    {1715}if (verify(h(m2_2140),sigM2_2139,pkSess_2133) <> true) then
                                                                        0
                                                                    else
                                                                        {1716}let (=OpenSecureChannelResponse,Ns_2141: bitstring,ST_2142: bitstring,TTL_2143: bitstring) = m2_2140 in
                                                                        {1717}let Kcli_2144: bitstring = h((Nc_2136,Ns_2141)) in
                                                                        {1718}out(c, senc(mCli(pkCli_1749,pkSess_2133),Kcli_2144))
                                                                )
                                                                else
                                                                    {1719}let pkSess_2145: bitstring = pub(sk(Sess)) in
                                                                    {1720}out(c, GetEndpointRequest);
                                                                    {1721}in(c, (=GetEndpointResponse,=pkSess_2145,=SignAndEncrypt,SP_2146: bitstring,UP_2147: bitstring));
                                                                    {1722}new Nc_2148: bitstring;
                                                                    {1723}let m1_2149: bitstring = (OpenSecureChannelRequest,pkCli_1749,Nc_2148) in
                                                                    {1724}out(c, (pkCli_1749,enc(m1_2149,pkSess_2145),sign(h(m1_2149),skCli_1748)));
                                                                    {1725}in(c, (em2_2150: bitstring,sigM2_2151: bitstring));
                                                                    {1726}let m2_2152: bitstring = dec(em2_2150,skCli_1748) in
                                                                    {1727}if (verify(h(m2_2152),sigM2_2151,pkSess_2145) <> true) then
                                                                        0
                                                                    else
                                                                        {1728}let (=OpenSecureChannelResponse,Ns_2153: bitstring,ST_2154: bitstring,TTL_2155: bitstring) = m2_2152 in
                                                                        {1729}let Kcli_2156: bitstring = h((Nc_2148,Ns_2153)) in
                                                                        {1730}out(c, senc(mCli(pkCli_1749,pkSess_2145),Kcli_2156))
                                                            )
                                                            else
                                                                {1731}let pkSess_2157: bitstring = fail-any in
                                                                {1732}out(c, GetEndpointRequest);
                                                                {1733}in(c, (=GetEndpointResponse,=pkSess_2157,=SignAndEncrypt,SP_2158: bitstring,UP_2159: bitstring));
                                                                {1734}new Nc_2160: bitstring;
                                                                {1735}let m1_2161: bitstring = (OpenSecureChannelRequest,pkCli_1749,Nc_2160) in
                                                                {1736}out(c, (pkCli_1749,enc(m1_2161,pkSess_2157),sign(h(m1_2161),skCli_1748)));
                                                                {1737}in(c, (em2_2162: bitstring,sigM2_2163: bitstring));
                                                                {1738}let m2_2164: bitstring = dec(em2_2162,skCli_1748) in
                                                                {1739}if (verify(h(m2_2164),sigM2_2163,pkSess_2157) <> true) then
                                                                    0
                                                                else
                                                                    {1740}let (=OpenSecureChannelResponse,Ns_2165: bitstring,ST_2166: bitstring,TTL_2167: bitstring) = m2_2164 in
                                                                    {1741}let Kcli_2168: bitstring = h((Nc_2160,Ns_2165)) in
                                                                    {1742}out(c, senc(mCli(pkCli_1749,pkSess_2157),Kcli_2168))
                                                    )
                                                    else
                                                        {1743}let pkSess_2169: bitstring = fail-any in
                                                        {1744}out(c, GetEndpointRequest);
                                                        {1745}in(c, (=GetEndpointResponse,=pkSess_2169,=SignAndEncrypt,SP_2170: bitstring,UP_2171: bitstring));
                                                        {1746}new Nc_2172: bitstring;
                                                        {1747}let m1_2173: bitstring = (OpenSecureChannelRequest,pkCli_1749,Nc_2172) in
                                                        {1748}out(c, (pkCli_1749,enc(m1_2173,pkSess_2169),sign(h(m1_2173),skCli_1748)));
                                                        {1749}in(c, (em2_2174: bitstring,sigM2_2175: bitstring));
                                                        {1750}let m2_2176: bitstring = dec(em2_2174,skCli_1748) in
                                                        {1751}if (verify(h(m2_2176),sigM2_2175,pkSess_2169) <> true) then
                                                            0
                                                        else
                                                            {1752}let (=OpenSecureChannelResponse,Ns_2177: bitstring,ST_2178: bitstring,TTL_2179: bitstring) = m2_2176 in
                                                            {1753}let Kcli_2180: bitstring = h((Nc_2172,Ns_2177)) in
                                                            {1754}out(c, senc(mCli(pkCli_1749,pkSess_2169),Kcli_2180))
                                            )
                                            else
                                                {1755}let pkSess_2181: bitstring = fail-any in
                                                {1756}out(c, GetEndpointRequest);
                                                {1757}in(c, (=GetEndpointResponse,=pkSess_2181,=SignAndEncrypt,SP_2182: bitstring,UP_2183: bitstring));
                                                {1758}new Nc_2184: bitstring;
                                                {1759}let m1_2185: bitstring = (OpenSecureChannelRequest,pkCli_1749,Nc_2184) in
                                                {1760}out(c, (pkCli_1749,enc(m1_2185,pkSess_2181),sign(h(m1_2185),skCli_1748)));
                                                {1761}in(c, (em2_2186: bitstring,sigM2_2187: bitstring));
                                                {1762}let m2_2188: bitstring = dec(em2_2186,skCli_1748) in
                                                {1763}if (verify(h(m2_2188),sigM2_2187,pkSess_2181) <> true) then
                                                    0
                                                else
                                                    {1764}let (=OpenSecureChannelResponse,Ns_2189: bitstring,ST_2190: bitstring,TTL_2191: bitstring) = m2_2188 in
                                                    {1765}let Kcli_2192: bitstring = h((Nc_2184,Ns_2189)) in
                                                    {1766}out(c, senc(mCli(pkCli_1749,pkSess_2181),Kcli_2192))
                                )
                                else
                                    {1767}let pkDisco_2193: bitstring = fail-any in
                                    {1768}let v_2194: bool = (Sess = A) in
                                    (
                                        {1769}if v_2194 then
                                        (
                                            {1770}let pkSess_2195: bitstring = pub(skA) in
                                            {1771}out(c, GetEndpointRequest);
                                            {1772}in(c, (=GetEndpointResponse,=pkSess_2195,=SignAndEncrypt,SP_2196: bitstring,UP_2197: bitstring));
                                            {1773}new Nc_2198: bitstring;
                                            {1774}let m1_2199: bitstring = (OpenSecureChannelRequest,pkCli_1749,Nc_2198) in
                                            {1775}out(c, (pkCli_1749,enc(m1_2199,pkSess_2195),sign(h(m1_2199),skCli_1748)));
                                            {1776}in(c, (em2_2200: bitstring,sigM2_2201: bitstring));
                                            {1777}let m2_2202: bitstring = dec(em2_2200,skCli_1748) in
                                            {1778}if (verify(h(m2_2202),sigM2_2201,pkSess_2195) <> true) then
                                                0
                                            else
                                                {1779}let (=OpenSecureChannelResponse,Ns_2203: bitstring,ST_2204: bitstring,TTL_2205: bitstring) = m2_2202 in
                                                {1780}let Kcli_2206: bitstring = h((Nc_2198,Ns_2203)) in
                                                {1781}out(c, senc(mCli(pkCli_1749,pkSess_2195),Kcli_2206))
                                        )
                                        else
                                            {1782}let v_2207: bool = (Sess = B) in
                                            (
                                                {1783}if v_2207 then
                                                (
                                                    {1784}let pkSess_2208: bitstring = pub(skB) in
                                                    {1785}out(c, GetEndpointRequest);
                                                    {1786}in(c, (=GetEndpointResponse,=pkSess_2208,=SignAndEncrypt,SP_2209: bitstring,UP_2210: bitstring));
                                                    {1787}new Nc_2211: bitstring;
                                                    {1788}let m1_2212: bitstring = (OpenSecureChannelRequest,pkCli_1749,Nc_2211) in
                                                    {1789}out(c, (pkCli_1749,enc(m1_2212,pkSess_2208),sign(h(m1_2212),skCli_1748)));
                                                    {1790}in(c, (em2_2213: bitstring,sigM2_2214: bitstring));
                                                    {1791}let m2_2215: bitstring = dec(em2_2213,skCli_1748) in
                                                    {1792}if (verify(h(m2_2215),sigM2_2214,pkSess_2208) <> true) then
                                                        0
                                                    else
                                                        {1793}let (=OpenSecureChannelResponse,Ns_2216: bitstring,ST_2217: bitstring,TTL_2218: bitstring) = m2_2215 in
                                                        {1794}let Kcli_2219: bitstring = h((Nc_2211,Ns_2216)) in
                                                        {1795}out(c, senc(mCli(pkCli_1749,pkSess_2208),Kcli_2219))
                                                )
                                                else
                                                    {1796}let v_2220: bool = (Sess = C) in
                                                    (
                                                        {1797}if v_2220 then
                                                        (
                                                            {1798}let pkSess_2221: bitstring = pub(skC) in
                                                            {1799}out(c, GetEndpointRequest);
                                                            {1800}in(c, (=GetEndpointResponse,=pkSess_2221,=SignAndEncrypt,SP_2222: bitstring,UP_2223: bitstring));
                                                            {1801}new Nc_2224: bitstring;
                                                            {1802}let m1_2225: bitstring = (OpenSecureChannelRequest,pkCli_1749,Nc_2224) in
                                                            {1803}out(c, (pkCli_1749,enc(m1_2225,pkSess_2221),sign(h(m1_2225),skCli_1748)));
                                                            {1804}in(c, (em2_2226: bitstring,sigM2_2227: bitstring));
                                                            {1805}let m2_2228: bitstring = dec(em2_2226,skCli_1748) in
                                                            {1806}if (verify(h(m2_2228),sigM2_2227,pkSess_2221) <> true) then
                                                                0
                                                            else
                                                                {1807}let (=OpenSecureChannelResponse,Ns_2229: bitstring,ST_2230: bitstring,TTL_2231: bitstring) = m2_2228 in
                                                                {1808}let Kcli_2232: bitstring = h((Nc_2224,Ns_2229)) in
                                                                {1809}out(c, senc(mCli(pkCli_1749,pkSess_2221),Kcli_2232))
                                                        )
                                                        else
                                                            {1810}let pkSess_2233: bitstring = pub(sk(Sess)) in
                                                            {1811}out(c, GetEndpointRequest);
                                                            {1812}in(c, (=GetEndpointResponse,=pkSess_2233,=SignAndEncrypt,SP_2234: bitstring,UP_2235: bitstring));
                                                            {1813}new Nc_2236: bitstring;
                                                            {1814}let m1_2237: bitstring = (OpenSecureChannelRequest,pkCli_1749,Nc_2236) in
                                                            {1815}out(c, (pkCli_1749,enc(m1_2237,pkSess_2233),sign(h(m1_2237),skCli_1748)));
                                                            {1816}in(c, (em2_2238: bitstring,sigM2_2239: bitstring));
                                                            {1817}let m2_2240: bitstring = dec(em2_2238,skCli_1748) in
                                                            {1818}if (verify(h(m2_2240),sigM2_2239,pkSess_2233) <> true) then
                                                                0
                                                            else
                                                                {1819}let (=OpenSecureChannelResponse,Ns_2241: bitstring,ST_2242: bitstring,TTL_2243: bitstring) = m2_2240 in
                                                                {1820}let Kcli_2244: bitstring = h((Nc_2236,Ns_2241)) in
                                                                {1821}out(c, senc(mCli(pkCli_1749,pkSess_2233),Kcli_2244))
                                                    )
                                                    else
                                                        {1822}let pkSess_2245: bitstring = fail-any in
                                                        {1823}out(c, GetEndpointRequest);
                                                        {1824}in(c, (=GetEndpointResponse,=pkSess_2245,=SignAndEncrypt,SP_2246: bitstring,UP_2247: bitstring));
                                                        {1825}new Nc_2248: bitstring;
                                                        {1826}let m1_2249: bitstring = (OpenSecureChannelRequest,pkCli_1749,Nc_2248) in
                                                        {1827}out(c, (pkCli_1749,enc(m1_2249,pkSess_2245),sign(h(m1_2249),skCli_1748)));
                                                        {1828}in(c, (em2_2250: bitstring,sigM2_2251: bitstring));
                                                        {1829}let m2_2252: bitstring = dec(em2_2250,skCli_1748) in
                                                        {1830}if (verify(h(m2_2252),sigM2_2251,pkSess_2245) <> true) then
                                                            0
                                                        else
                                                            {1831}let (=OpenSecureChannelResponse,Ns_2253: bitstring,ST_2254: bitstring,TTL_2255: bitstring) = m2_2252 in
                                                            {1832}let Kcli_2256: bitstring = h((Nc_2248,Ns_2253)) in
                                                            {1833}out(c, senc(mCli(pkCli_1749,pkSess_2245),Kcli_2256))
                                            )
                                            else
                                                {1834}let pkSess_2257: bitstring = fail-any in
                                                {1835}out(c, GetEndpointRequest);
                                                {1836}in(c, (=GetEndpointResponse,=pkSess_2257,=SignAndEncrypt,SP_2258: bitstring,UP_2259: bitstring));
                                                {1837}new Nc_2260: bitstring;
                                                {1838}let m1_2261: bitstring = (OpenSecureChannelRequest,pkCli_1749,Nc_2260) in
                                                {1839}out(c, (pkCli_1749,enc(m1_2261,pkSess_2257),sign(h(m1_2261),skCli_1748)));
                                                {1840}in(c, (em2_2262: bitstring,sigM2_2263: bitstring));
                                                {1841}let m2_2264: bitstring = dec(em2_2262,skCli_1748) in
                                                {1842}if (verify(h(m2_2264),sigM2_2263,pkSess_2257) <> true) then
                                                    0
                                                else
                                                    {1843}let (=OpenSecureChannelResponse,Ns_2265: bitstring,ST_2266: bitstring,TTL_2267: bitstring) = m2_2264 in
                                                    {1844}let Kcli_2268: bitstring = h((Nc_2260,Ns_2265)) in
                                                    {1845}out(c, senc(mCli(pkCli_1749,pkSess_2257),Kcli_2268))
                                    )
                                    else
                                        {1846}let pkSess_2269: bitstring = fail-any in
                                        {1847}out(c, GetEndpointRequest);
                                        {1848}in(c, (=GetEndpointResponse,=pkSess_2269,=SignAndEncrypt,SP_2270: bitstring,UP_2271: bitstring));
                                        {1849}new Nc_2272: bitstring;
                                        {1850}let m1_2273: bitstring = (OpenSecureChannelRequest,pkCli_1749,Nc_2272) in
                                        {1851}out(c, (pkCli_1749,enc(m1_2273,pkSess_2269),sign(h(m1_2273),skCli_1748)));
                                        {1852}in(c, (em2_2274: bitstring,sigM2_2275: bitstring));
                                        {1853}let m2_2276: bitstring = dec(em2_2274,skCli_1748) in
                                        {1854}if (verify(h(m2_2276),sigM2_2275,pkSess_2269) <> true) then
                                            0
                                        else
                                            {1855}let (=OpenSecureChannelResponse,Ns_2277: bitstring,ST_2278: bitstring,TTL_2279: bitstring) = m2_2276 in
                                            {1856}let Kcli_2280: bitstring = h((Nc_2272,Ns_2277)) in
                                            {1857}out(c, senc(mCli(pkCli_1749,pkSess_2269),Kcli_2280))
                        )
                        else
                            {1858}let pkDisco_2281: bitstring = fail-any in
                            {1859}let v_2282: bool = (Sess = A) in
                            (
                                {1860}if v_2282 then
                                (
                                    {1861}let pkSess_2283: bitstring = pub(skA) in
                                    {1862}out(c, GetEndpointRequest);
                                    {1863}in(c, (=GetEndpointResponse,=pkSess_2283,=SignAndEncrypt,SP_2284: bitstring,UP_2285: bitstring));
                                    {1864}new Nc_2286: bitstring;
                                    {1865}let m1_2287: bitstring = (OpenSecureChannelRequest,pkCli_1749,Nc_2286) in
                                    {1866}out(c, (pkCli_1749,enc(m1_2287,pkSess_2283),sign(h(m1_2287),skCli_1748)));
                                    {1867}in(c, (em2_2288: bitstring,sigM2_2289: bitstring));
                                    {1868}let m2_2290: bitstring = dec(em2_2288,skCli_1748) in
                                    {1869}if (verify(h(m2_2290),sigM2_2289,pkSess_2283) <> true) then
                                        0
                                    else
                                        {1870}let (=OpenSecureChannelResponse,Ns_2291: bitstring,ST_2292: bitstring,TTL_2293: bitstring) = m2_2290 in
                                        {1871}let Kcli_2294: bitstring = h((Nc_2286,Ns_2291)) in
                                        {1872}out(c, senc(mCli(pkCli_1749,pkSess_2283),Kcli_2294))
                                )
                                else
                                    {1873}let v_2295: bool = (Sess = B) in
                                    (
                                        {1874}if v_2295 then
                                        (
                                            {1875}let pkSess_2296: bitstring = pub(skB) in
                                            {1876}out(c, GetEndpointRequest);
                                            {1877}in(c, (=GetEndpointResponse,=pkSess_2296,=SignAndEncrypt,SP_2297: bitstring,UP_2298: bitstring));
                                            {1878}new Nc_2299: bitstring;
                                            {1879}let m1_2300: bitstring = (OpenSecureChannelRequest,pkCli_1749,Nc_2299) in
                                            {1880}out(c, (pkCli_1749,enc(m1_2300,pkSess_2296),sign(h(m1_2300),skCli_1748)));
                                            {1881}in(c, (em2_2301: bitstring,sigM2_2302: bitstring));
                                            {1882}let m2_2303: bitstring = dec(em2_2301,skCli_1748) in
                                            {1883}if (verify(h(m2_2303),sigM2_2302,pkSess_2296) <> true) then
                                                0
                                            else
                                                {1884}let (=OpenSecureChannelResponse,Ns_2304: bitstring,ST_2305: bitstring,TTL_2306: bitstring) = m2_2303 in
                                                {1885}let Kcli_2307: bitstring = h((Nc_2299,Ns_2304)) in
                                                {1886}out(c, senc(mCli(pkCli_1749,pkSess_2296),Kcli_2307))
                                        )
                                        else
                                            {1887}let v_2308: bool = (Sess = C) in
                                            (
                                                {1888}if v_2308 then
                                                (
                                                    {1889}let pkSess_2309: bitstring = pub(skC) in
                                                    {1890}out(c, GetEndpointRequest);
                                                    {1891}in(c, (=GetEndpointResponse,=pkSess_2309,=SignAndEncrypt,SP_2310: bitstring,UP_2311: bitstring));
                                                    {1892}new Nc_2312: bitstring;
                                                    {1893}let m1_2313: bitstring = (OpenSecureChannelRequest,pkCli_1749,Nc_2312) in
                                                    {1894}out(c, (pkCli_1749,enc(m1_2313,pkSess_2309),sign(h(m1_2313),skCli_1748)));
                                                    {1895}in(c, (em2_2314: bitstring,sigM2_2315: bitstring));
                                                    {1896}let m2_2316: bitstring = dec(em2_2314,skCli_1748) in
                                                    {1897}if (verify(h(m2_2316),sigM2_2315,pkSess_2309) <> true) then
                                                        0
                                                    else
                                                        {1898}let (=OpenSecureChannelResponse,Ns_2317: bitstring,ST_2318: bitstring,TTL_2319: bitstring) = m2_2316 in
                                                        {1899}let Kcli_2320: bitstring = h((Nc_2312,Ns_2317)) in
                                                        {1900}out(c, senc(mCli(pkCli_1749,pkSess_2309),Kcli_2320))
                                                )
                                                else
                                                    {1901}let pkSess_2321: bitstring = pub(sk(Sess)) in
                                                    {1902}out(c, GetEndpointRequest);
                                                    {1903}in(c, (=GetEndpointResponse,=pkSess_2321,=SignAndEncrypt,SP_2322: bitstring,UP_2323: bitstring));
                                                    {1904}new Nc_2324: bitstring;
                                                    {1905}let m1_2325: bitstring = (OpenSecureChannelRequest,pkCli_1749,Nc_2324) in
                                                    {1906}out(c, (pkCli_1749,enc(m1_2325,pkSess_2321),sign(h(m1_2325),skCli_1748)));
                                                    {1907}in(c, (em2_2326: bitstring,sigM2_2327: bitstring));
                                                    {1908}let m2_2328: bitstring = dec(em2_2326,skCli_1748) in
                                                    {1909}if (verify(h(m2_2328),sigM2_2327,pkSess_2321) <> true) then
                                                        0
                                                    else
                                                        {1910}let (=OpenSecureChannelResponse,Ns_2329: bitstring,ST_2330: bitstring,TTL_2331: bitstring) = m2_2328 in
                                                        {1911}let Kcli_2332: bitstring = h((Nc_2324,Ns_2329)) in
                                                        {1912}out(c, senc(mCli(pkCli_1749,pkSess_2321),Kcli_2332))
                                            )
                                            else
                                                {1913}let pkSess_2333: bitstring = fail-any in
                                                {1914}out(c, GetEndpointRequest);
                                                {1915}in(c, (=GetEndpointResponse,=pkSess_2333,=SignAndEncrypt,SP_2334: bitstring,UP_2335: bitstring));
                                                {1916}new Nc_2336: bitstring;
                                                {1917}let m1_2337: bitstring = (OpenSecureChannelRequest,pkCli_1749,Nc_2336) in
                                                {1918}out(c, (pkCli_1749,enc(m1_2337,pkSess_2333),sign(h(m1_2337),skCli_1748)));
                                                {1919}in(c, (em2_2338: bitstring,sigM2_2339: bitstring));
                                                {1920}let m2_2340: bitstring = dec(em2_2338,skCli_1748) in
                                                {1921}if (verify(h(m2_2340),sigM2_2339,pkSess_2333) <> true) then
                                                    0
                                                else
                                                    {1922}let (=OpenSecureChannelResponse,Ns_2341: bitstring,ST_2342: bitstring,TTL_2343: bitstring) = m2_2340 in
                                                    {1923}let Kcli_2344: bitstring = h((Nc_2336,Ns_2341)) in
                                                    {1924}out(c, senc(mCli(pkCli_1749,pkSess_2333),Kcli_2344))
                                    )
                                    else
                                        {1925}let pkSess_2345: bitstring = fail-any in
                                        {1926}out(c, GetEndpointRequest);
                                        {1927}in(c, (=GetEndpointResponse,=pkSess_2345,=SignAndEncrypt,SP_2346: bitstring,UP_2347: bitstring));
                                        {1928}new Nc_2348: bitstring;
                                        {1929}let m1_2349: bitstring = (OpenSecureChannelRequest,pkCli_1749,Nc_2348) in
                                        {1930}out(c, (pkCli_1749,enc(m1_2349,pkSess_2345),sign(h(m1_2349),skCli_1748)));
                                        {1931}in(c, (em2_2350: bitstring,sigM2_2351: bitstring));
                                        {1932}let m2_2352: bitstring = dec(em2_2350,skCli_1748) in
                                        {1933}if (verify(h(m2_2352),sigM2_2351,pkSess_2345) <> true) then
                                            0
                                        else
                                            {1934}let (=OpenSecureChannelResponse,Ns_2353: bitstring,ST_2354: bitstring,TTL_2355: bitstring) = m2_2352 in
                                            {1935}let Kcli_2356: bitstring = h((Nc_2348,Ns_2353)) in
                                            {1936}out(c, senc(mCli(pkCli_1749,pkSess_2345),Kcli_2356))
                            )
                            else
                                {1937}let pkSess_2357: bitstring = fail-any in
                                {1938}out(c, GetEndpointRequest);
                                {1939}in(c, (=GetEndpointResponse,=pkSess_2357,=SignAndEncrypt,SP_2358: bitstring,UP_2359: bitstring));
                                {1940}new Nc_2360: bitstring;
                                {1941}let m1_2361: bitstring = (OpenSecureChannelRequest,pkCli_1749,Nc_2360) in
                                {1942}out(c, (pkCli_1749,enc(m1_2361,pkSess_2357),sign(h(m1_2361),skCli_1748)));
                                {1943}in(c, (em2_2362: bitstring,sigM2_2363: bitstring));
                                {1944}let m2_2364: bitstring = dec(em2_2362,skCli_1748) in
                                {1945}if (verify(h(m2_2364),sigM2_2363,pkSess_2357) <> true) then
                                    0
                                else
                                    {1946}let (=OpenSecureChannelResponse,Ns_2365: bitstring,ST_2366: bitstring,TTL_2367: bitstring) = m2_2364 in
                                    {1947}let Kcli_2368: bitstring = h((Nc_2360,Ns_2365)) in
                                    {1948}out(c, senc(mCli(pkCli_1749,pkSess_2357),Kcli_2368))
                    )
                    else
                        {1949}let skCli_2369: bitstring = fail-any in
                        {1950}let pkCli_2370: bitstring = pub(skCli_2369) in
                        {1951}let v_2371: bool = (Disco = A) in
                        (
                            {1952}if v_2371 then
                            (
                                {1953}let pkDisco_2372: bitstring = pub(skA) in
                                {1954}let v_2373: bool = (Sess = A) in
                                (
                                    {1955}if v_2373 then
                                    (
                                        {1956}let pkSess_2374: bitstring = pub(skA) in
                                        {1957}out(c, GetEndpointRequest);
                                        {1958}in(c, (=GetEndpointResponse,=pkSess_2374,=SignAndEncrypt,SP_2375: bitstring,UP_2376: bitstring));
                                        {1959}new Nc_2377: bitstring;
                                        {1960}let m1_2378: bitstring = (OpenSecureChannelRequest,pkCli_2370,Nc_2377) in
                                        {1961}out(c, (pkCli_2370,enc(m1_2378,pkSess_2374),sign(h(m1_2378),skCli_2369)));
                                        {1962}in(c, (em2_2379: bitstring,sigM2_2380: bitstring));
                                        {1963}let m2_2381: bitstring = dec(em2_2379,skCli_2369) in
                                        {1964}if (verify(h(m2_2381),sigM2_2380,pkSess_2374) <> true) then
                                            0
                                        else
                                            {1965}let (=OpenSecureChannelResponse,Ns_2382: bitstring,ST_2383: bitstring,TTL_2384: bitstring) = m2_2381 in
                                            {1966}let Kcli_2385: bitstring = h((Nc_2377,Ns_2382)) in
                                            {1967}out(c, senc(mCli(pkCli_2370,pkSess_2374),Kcli_2385))
                                    )
                                    else
                                        {1968}let v_2386: bool = (Sess = B) in
                                        (
                                            {1969}if v_2386 then
                                            (
                                                {1970}let pkSess_2387: bitstring = pub(skB) in
                                                {1971}out(c, GetEndpointRequest);
                                                {1972}in(c, (=GetEndpointResponse,=pkSess_2387,=SignAndEncrypt,SP_2388: bitstring,UP_2389: bitstring));
                                                {1973}new Nc_2390: bitstring;
                                                {1974}let m1_2391: bitstring = (OpenSecureChannelRequest,pkCli_2370,Nc_2390) in
                                                {1975}out(c, (pkCli_2370,enc(m1_2391,pkSess_2387),sign(h(m1_2391),skCli_2369)));
                                                {1976}in(c, (em2_2392: bitstring,sigM2_2393: bitstring));
                                                {1977}let m2_2394: bitstring = dec(em2_2392,skCli_2369) in
                                                {1978}if (verify(h(m2_2394),sigM2_2393,pkSess_2387) <> true) then
                                                    0
                                                else
                                                    {1979}let (=OpenSecureChannelResponse,Ns_2395: bitstring,ST_2396: bitstring,TTL_2397: bitstring) = m2_2394 in
                                                    {1980}let Kcli_2398: bitstring = h((Nc_2390,Ns_2395)) in
                                                    {1981}out(c, senc(mCli(pkCli_2370,pkSess_2387),Kcli_2398))
                                            )
                                            else
                                                {1982}let v_2399: bool = (Sess = C) in
                                                (
                                                    {1983}if v_2399 then
                                                    (
                                                        {1984}let pkSess_2400: bitstring = pub(skC) in
                                                        {1985}out(c, GetEndpointRequest);
                                                        {1986}in(c, (=GetEndpointResponse,=pkSess_2400,=SignAndEncrypt,SP_2401: bitstring,UP_2402: bitstring));
                                                        {1987}new Nc_2403: bitstring;
                                                        {1988}let m1_2404: bitstring = (OpenSecureChannelRequest,pkCli_2370,Nc_2403) in
                                                        {1989}out(c, (pkCli_2370,enc(m1_2404,pkSess_2400),sign(h(m1_2404),skCli_2369)));
                                                        {1990}in(c, (em2_2405: bitstring,sigM2_2406: bitstring));
                                                        {1991}let m2_2407: bitstring = dec(em2_2405,skCli_2369) in
                                                        {1992}if (verify(h(m2_2407),sigM2_2406,pkSess_2400) <> true) then
                                                            0
                                                        else
                                                            {1993}let (=OpenSecureChannelResponse,Ns_2408: bitstring,ST_2409: bitstring,TTL_2410: bitstring) = m2_2407 in
                                                            {1994}let Kcli_2411: bitstring = h((Nc_2403,Ns_2408)) in
                                                            {1995}out(c, senc(mCli(pkCli_2370,pkSess_2400),Kcli_2411))
                                                    )
                                                    else
                                                        {1996}let pkSess_2412: bitstring = pub(sk(Sess)) in
                                                        {1997}out(c, GetEndpointRequest);
                                                        {1998}in(c, (=GetEndpointResponse,=pkSess_2412,=SignAndEncrypt,SP_2413: bitstring,UP_2414: bitstring));
                                                        {1999}new Nc_2415: bitstring;
                                                        {2000}let m1_2416: bitstring = (OpenSecureChannelRequest,pkCli_2370,Nc_2415) in
                                                        {2001}out(c, (pkCli_2370,enc(m1_2416,pkSess_2412),sign(h(m1_2416),skCli_2369)));
                                                        {2002}in(c, (em2_2417: bitstring,sigM2_2418: bitstring));
                                                        {2003}let m2_2419: bitstring = dec(em2_2417,skCli_2369) in
                                                        {2004}if (verify(h(m2_2419),sigM2_2418,pkSess_2412) <> true) then
                                                            0
                                                        else
                                                            {2005}let (=OpenSecureChannelResponse,Ns_2420: bitstring,ST_2421: bitstring,TTL_2422: bitstring) = m2_2419 in
                                                            {2006}let Kcli_2423: bitstring = h((Nc_2415,Ns_2420)) in
                                                            {2007}out(c, senc(mCli(pkCli_2370,pkSess_2412),Kcli_2423))
                                                )
                                                else
                                                    {2008}let pkSess_2424: bitstring = fail-any in
                                                    {2009}out(c, GetEndpointRequest);
                                                    {2010}in(c, (=GetEndpointResponse,=pkSess_2424,=SignAndEncrypt,SP_2425: bitstring,UP_2426: bitstring));
                                                    {2011}new Nc_2427: bitstring;
                                                    {2012}let m1_2428: bitstring = (OpenSecureChannelRequest,pkCli_2370,Nc_2427) in
                                                    {2013}out(c, (pkCli_2370,enc(m1_2428,pkSess_2424),sign(h(m1_2428),skCli_2369)));
                                                    {2014}in(c, (em2_2429: bitstring,sigM2_2430: bitstring));
                                                    {2015}let m2_2431: bitstring = dec(em2_2429,skCli_2369) in
                                                    {2016}if (verify(h(m2_2431),sigM2_2430,pkSess_2424) <> true) then
                                                        0
                                                    else
                                                        {2017}let (=OpenSecureChannelResponse,Ns_2432: bitstring,ST_2433: bitstring,TTL_2434: bitstring) = m2_2431 in
                                                        {2018}let Kcli_2435: bitstring = h((Nc_2427,Ns_2432)) in
                                                        {2019}out(c, senc(mCli(pkCli_2370,pkSess_2424),Kcli_2435))
                                        )
                                        else
                                            {2020}let pkSess_2436: bitstring = fail-any in
                                            {2021}out(c, GetEndpointRequest);
                                            {2022}in(c, (=GetEndpointResponse,=pkSess_2436,=SignAndEncrypt,SP_2437: bitstring,UP_2438: bitstring));
                                            {2023}new Nc_2439: bitstring;
                                            {2024}let m1_2440: bitstring = (OpenSecureChannelRequest,pkCli_2370,Nc_2439) in
                                            {2025}out(c, (pkCli_2370,enc(m1_2440,pkSess_2436),sign(h(m1_2440),skCli_2369)));
                                            {2026}in(c, (em2_2441: bitstring,sigM2_2442: bitstring));
                                            {2027}let m2_2443: bitstring = dec(em2_2441,skCli_2369) in
                                            {2028}if (verify(h(m2_2443),sigM2_2442,pkSess_2436) <> true) then
                                                0
                                            else
                                                {2029}let (=OpenSecureChannelResponse,Ns_2444: bitstring,ST_2445: bitstring,TTL_2446: bitstring) = m2_2443 in
                                                {2030}let Kcli_2447: bitstring = h((Nc_2439,Ns_2444)) in
                                                {2031}out(c, senc(mCli(pkCli_2370,pkSess_2436),Kcli_2447))
                                )
                                else
                                    {2032}let pkSess_2448: bitstring = fail-any in
                                    {2033}out(c, GetEndpointRequest);
                                    {2034}in(c, (=GetEndpointResponse,=pkSess_2448,=SignAndEncrypt,SP_2449: bitstring,UP_2450: bitstring));
                                    {2035}new Nc_2451: bitstring;
                                    {2036}let m1_2452: bitstring = (OpenSecureChannelRequest,pkCli_2370,Nc_2451) in
                                    {2037}out(c, (pkCli_2370,enc(m1_2452,pkSess_2448),sign(h(m1_2452),skCli_2369)));
                                    {2038}in(c, (em2_2453: bitstring,sigM2_2454: bitstring));
                                    {2039}let m2_2455: bitstring = dec(em2_2453,skCli_2369) in
                                    {2040}if (verify(h(m2_2455),sigM2_2454,pkSess_2448) <> true) then
                                        0
                                    else
                                        {2041}let (=OpenSecureChannelResponse,Ns_2456: bitstring,ST_2457: bitstring,TTL_2458: bitstring) = m2_2455 in
                                        {2042}let Kcli_2459: bitstring = h((Nc_2451,Ns_2456)) in
                                        {2043}out(c, senc(mCli(pkCli_2370,pkSess_2448),Kcli_2459))
                            )
                            else
                                {2044}let v_2460: bool = (Disco = B) in
                                (
                                    {2045}if v_2460 then
                                    (
                                        {2046}let pkDisco_2461: bitstring = pub(skB) in
                                        {2047}let v_2462: bool = (Sess = A) in
                                        (
                                            {2048}if v_2462 then
                                            (
                                                {2049}let pkSess_2463: bitstring = pub(skA) in
                                                {2050}out(c, GetEndpointRequest);
                                                {2051}in(c, (=GetEndpointResponse,=pkSess_2463,=SignAndEncrypt,SP_2464: bitstring,UP_2465: bitstring));
                                                {2052}new Nc_2466: bitstring;
                                                {2053}let m1_2467: bitstring = (OpenSecureChannelRequest,pkCli_2370,Nc_2466) in
                                                {2054}out(c, (pkCli_2370,enc(m1_2467,pkSess_2463),sign(h(m1_2467),skCli_2369)));
                                                {2055}in(c, (em2_2468: bitstring,sigM2_2469: bitstring));
                                                {2056}let m2_2470: bitstring = dec(em2_2468,skCli_2369) in
                                                {2057}if (verify(h(m2_2470),sigM2_2469,pkSess_2463) <> true) then
                                                    0
                                                else
                                                    {2058}let (=OpenSecureChannelResponse,Ns_2471: bitstring,ST_2472: bitstring,TTL_2473: bitstring) = m2_2470 in
                                                    {2059}let Kcli_2474: bitstring = h((Nc_2466,Ns_2471)) in
                                                    {2060}out(c, senc(mCli(pkCli_2370,pkSess_2463),Kcli_2474))
                                            )
                                            else
                                                {2061}let v_2475: bool = (Sess = B) in
                                                (
                                                    {2062}if v_2475 then
                                                    (
                                                        {2063}let pkSess_2476: bitstring = pub(skB) in
                                                        {2064}out(c, GetEndpointRequest);
                                                        {2065}in(c, (=GetEndpointResponse,=pkSess_2476,=SignAndEncrypt,SP_2477: bitstring,UP_2478: bitstring));
                                                        {2066}new Nc_2479: bitstring;
                                                        {2067}let m1_2480: bitstring = (OpenSecureChannelRequest,pkCli_2370,Nc_2479) in
                                                        {2068}out(c, (pkCli_2370,enc(m1_2480,pkSess_2476),sign(h(m1_2480),skCli_2369)));
                                                        {2069}in(c, (em2_2481: bitstring,sigM2_2482: bitstring));
                                                        {2070}let m2_2483: bitstring = dec(em2_2481,skCli_2369) in
                                                        {2071}if (verify(h(m2_2483),sigM2_2482,pkSess_2476) <> true) then
                                                            0
                                                        else
                                                            {2072}let (=OpenSecureChannelResponse,Ns_2484: bitstring,ST_2485: bitstring,TTL_2486: bitstring) = m2_2483 in
                                                            {2073}let Kcli_2487: bitstring = h((Nc_2479,Ns_2484)) in
                                                            {2074}out(c, senc(mCli(pkCli_2370,pkSess_2476),Kcli_2487))
                                                    )
                                                    else
                                                        {2075}let v_2488: bool = (Sess = C) in
                                                        (
                                                            {2076}if v_2488 then
                                                            (
                                                                {2077}let pkSess_2489: bitstring = pub(skC) in
                                                                {2078}out(c, GetEndpointRequest);
                                                                {2079}in(c, (=GetEndpointResponse,=pkSess_2489,=SignAndEncrypt,SP_2490: bitstring,UP_2491: bitstring));
                                                                {2080}new Nc_2492: bitstring;
                                                                {2081}let m1_2493: bitstring = (OpenSecureChannelRequest,pkCli_2370,Nc_2492) in
                                                                {2082}out(c, (pkCli_2370,enc(m1_2493,pkSess_2489),sign(h(m1_2493),skCli_2369)));
                                                                {2083}in(c, (em2_2494: bitstring,sigM2_2495: bitstring));
                                                                {2084}let m2_2496: bitstring = dec(em2_2494,skCli_2369) in
                                                                {2085}if (verify(h(m2_2496),sigM2_2495,pkSess_2489) <> true) then
                                                                    0
                                                                else
                                                                    {2086}let (=OpenSecureChannelResponse,Ns_2497: bitstring,ST_2498: bitstring,TTL_2499: bitstring) = m2_2496 in
                                                                    {2087}let Kcli_2500: bitstring = h((Nc_2492,Ns_2497)) in
                                                                    {2088}out(c, senc(mCli(pkCli_2370,pkSess_2489),Kcli_2500))
                                                            )
                                                            else
                                                                {2089}let pkSess_2501: bitstring = pub(sk(Sess)) in
                                                                {2090}out(c, GetEndpointRequest);
                                                                {2091}in(c, (=GetEndpointResponse,=pkSess_2501,=SignAndEncrypt,SP_2502: bitstring,UP_2503: bitstring));
                                                                {2092}new Nc_2504: bitstring;
                                                                {2093}let m1_2505: bitstring = (OpenSecureChannelRequest,pkCli_2370,Nc_2504) in
                                                                {2094}out(c, (pkCli_2370,enc(m1_2505,pkSess_2501),sign(h(m1_2505),skCli_2369)));
                                                                {2095}in(c, (em2_2506: bitstring,sigM2_2507: bitstring));
                                                                {2096}let m2_2508: bitstring = dec(em2_2506,skCli_2369) in
                                                                {2097}if (verify(h(m2_2508),sigM2_2507,pkSess_2501) <> true) then
                                                                    0
                                                                else
                                                                    {2098}let (=OpenSecureChannelResponse,Ns_2509: bitstring,ST_2510: bitstring,TTL_2511: bitstring) = m2_2508 in
                                                                    {2099}let Kcli_2512: bitstring = h((Nc_2504,Ns_2509)) in
                                                                    {2100}out(c, senc(mCli(pkCli_2370,pkSess_2501),Kcli_2512))
                                                        )
                                                        else
                                                            {2101}let pkSess_2513: bitstring = fail-any in
                                                            {2102}out(c, GetEndpointRequest);
                                                            {2103}in(c, (=GetEndpointResponse,=pkSess_2513,=SignAndEncrypt,SP_2514: bitstring,UP_2515: bitstring));
                                                            {2104}new Nc_2516: bitstring;
                                                            {2105}let m1_2517: bitstring = (OpenSecureChannelRequest,pkCli_2370,Nc_2516) in
                                                            {2106}out(c, (pkCli_2370,enc(m1_2517,pkSess_2513),sign(h(m1_2517),skCli_2369)));
                                                            {2107}in(c, (em2_2518: bitstring,sigM2_2519: bitstring));
                                                            {2108}let m2_2520: bitstring = dec(em2_2518,skCli_2369) in
                                                            {2109}if (verify(h(m2_2520),sigM2_2519,pkSess_2513) <> true) then
                                                                0
                                                            else
                                                                {2110}let (=OpenSecureChannelResponse,Ns_2521: bitstring,ST_2522: bitstring,TTL_2523: bitstring) = m2_2520 in
                                                                {2111}let Kcli_2524: bitstring = h((Nc_2516,Ns_2521)) in
                                                                {2112}out(c, senc(mCli(pkCli_2370,pkSess_2513),Kcli_2524))
                                                )
                                                else
                                                    {2113}let pkSess_2525: bitstring = fail-any in
                                                    {2114}out(c, GetEndpointRequest);
                                                    {2115}in(c, (=GetEndpointResponse,=pkSess_2525,=SignAndEncrypt,SP_2526: bitstring,UP_2527: bitstring));
                                                    {2116}new Nc_2528: bitstring;
                                                    {2117}let m1_2529: bitstring = (OpenSecureChannelRequest,pkCli_2370,Nc_2528) in
                                                    {2118}out(c, (pkCli_2370,enc(m1_2529,pkSess_2525),sign(h(m1_2529),skCli_2369)));
                                                    {2119}in(c, (em2_2530: bitstring,sigM2_2531: bitstring));
                                                    {2120}let m2_2532: bitstring = dec(em2_2530,skCli_2369) in
                                                    {2121}if (verify(h(m2_2532),sigM2_2531,pkSess_2525) <> true) then
                                                        0
                                                    else
                                                        {2122}let (=OpenSecureChannelResponse,Ns_2533: bitstring,ST_2534: bitstring,TTL_2535: bitstring) = m2_2532 in
                                                        {2123}let Kcli_2536: bitstring = h((Nc_2528,Ns_2533)) in
                                                        {2124}out(c, senc(mCli(pkCli_2370,pkSess_2525),Kcli_2536))
                                        )
                                        else
                                            {2125}let pkSess_2537: bitstring = fail-any in
                                            {2126}out(c, GetEndpointRequest);
                                            {2127}in(c, (=GetEndpointResponse,=pkSess_2537,=SignAndEncrypt,SP_2538: bitstring,UP_2539: bitstring));
                                            {2128}new Nc_2540: bitstring;
                                            {2129}let m1_2541: bitstring = (OpenSecureChannelRequest,pkCli_2370,Nc_2540) in
                                            {2130}out(c, (pkCli_2370,enc(m1_2541,pkSess_2537),sign(h(m1_2541),skCli_2369)));
                                            {2131}in(c, (em2_2542: bitstring,sigM2_2543: bitstring));
                                            {2132}let m2_2544: bitstring = dec(em2_2542,skCli_2369) in
                                            {2133}if (verify(h(m2_2544),sigM2_2543,pkSess_2537) <> true) then
                                                0
                                            else
                                                {2134}let (=OpenSecureChannelResponse,Ns_2545: bitstring,ST_2546: bitstring,TTL_2547: bitstring) = m2_2544 in
                                                {2135}let Kcli_2548: bitstring = h((Nc_2540,Ns_2545)) in
                                                {2136}out(c, senc(mCli(pkCli_2370,pkSess_2537),Kcli_2548))
                                    )
                                    else
                                        {2137}let v_2549: bool = (Disco = C) in
                                        (
                                            {2138}if v_2549 then
                                            (
                                                {2139}let pkDisco_2550: bitstring = pub(skC) in
                                                {2140}let v_2551: bool = (Sess = A) in
                                                (
                                                    {2141}if v_2551 then
                                                    (
                                                        {2142}let pkSess_2552: bitstring = pub(skA) in
                                                        {2143}out(c, GetEndpointRequest);
                                                        {2144}in(c, (=GetEndpointResponse,=pkSess_2552,=SignAndEncrypt,SP_2553: bitstring,UP_2554: bitstring));
                                                        {2145}new Nc_2555: bitstring;
                                                        {2146}let m1_2556: bitstring = (OpenSecureChannelRequest,pkCli_2370,Nc_2555) in
                                                        {2147}out(c, (pkCli_2370,enc(m1_2556,pkSess_2552),sign(h(m1_2556),skCli_2369)));
                                                        {2148}in(c, (em2_2557: bitstring,sigM2_2558: bitstring));
                                                        {2149}let m2_2559: bitstring = dec(em2_2557,skCli_2369) in
                                                        {2150}if (verify(h(m2_2559),sigM2_2558,pkSess_2552) <> true) then
                                                            0
                                                        else
                                                            {2151}let (=OpenSecureChannelResponse,Ns_2560: bitstring,ST_2561: bitstring,TTL_2562: bitstring) = m2_2559 in
                                                            {2152}let Kcli_2563: bitstring = h((Nc_2555,Ns_2560)) in
                                                            {2153}out(c, senc(mCli(pkCli_2370,pkSess_2552),Kcli_2563))
                                                    )
                                                    else
                                                        {2154}let v_2564: bool = (Sess = B) in
                                                        (
                                                            {2155}if v_2564 then
                                                            (
                                                                {2156}let pkSess_2565: bitstring = pub(skB) in
                                                                {2157}out(c, GetEndpointRequest);
                                                                {2158}in(c, (=GetEndpointResponse,=pkSess_2565,=SignAndEncrypt,SP_2566: bitstring,UP_2567: bitstring));
                                                                {2159}new Nc_2568: bitstring;
                                                                {2160}let m1_2569: bitstring = (OpenSecureChannelRequest,pkCli_2370,Nc_2568) in
                                                                {2161}out(c, (pkCli_2370,enc(m1_2569,pkSess_2565),sign(h(m1_2569),skCli_2369)));
                                                                {2162}in(c, (em2_2570: bitstring,sigM2_2571: bitstring));
                                                                {2163}let m2_2572: bitstring = dec(em2_2570,skCli_2369) in
                                                                {2164}if (verify(h(m2_2572),sigM2_2571,pkSess_2565) <> true) then
                                                                    0
                                                                else
                                                                    {2165}let (=OpenSecureChannelResponse,Ns_2573: bitstring,ST_2574: bitstring,TTL_2575: bitstring) = m2_2572 in
                                                                    {2166}let Kcli_2576: bitstring = h((Nc_2568,Ns_2573)) in
                                                                    {2167}out(c, senc(mCli(pkCli_2370,pkSess_2565),Kcli_2576))
                                                            )
                                                            else
                                                                {2168}let v_2577: bool = (Sess = C) in
                                                                (
                                                                    {2169}if v_2577 then
                                                                    (
                                                                        {2170}let pkSess_2578: bitstring = pub(skC) in
                                                                        {2171}out(c, GetEndpointRequest);
                                                                        {2172}in(c, (=GetEndpointResponse,=pkSess_2578,=SignAndEncrypt,SP_2579: bitstring,UP_2580: bitstring));
                                                                        {2173}new Nc_2581: bitstring;
                                                                        {2174}let m1_2582: bitstring = (OpenSecureChannelRequest,pkCli_2370,Nc_2581) in
                                                                        {2175}out(c, (pkCli_2370,enc(m1_2582,pkSess_2578),sign(h(m1_2582),skCli_2369)));
                                                                        {2176}in(c, (em2_2583: bitstring,sigM2_2584: bitstring));
                                                                        {2177}let m2_2585: bitstring = dec(em2_2583,skCli_2369) in
                                                                        {2178}if (verify(h(m2_2585),sigM2_2584,pkSess_2578) <> true) then
                                                                            0
                                                                        else
                                                                            {2179}let (=OpenSecureChannelResponse,Ns_2586: bitstring,ST_2587: bitstring,TTL_2588: bitstring) = m2_2585 in
                                                                            {2180}let Kcli_2589: bitstring = h((Nc_2581,Ns_2586)) in
                                                                            {2181}out(c, senc(mCli(pkCli_2370,pkSess_2578),Kcli_2589))
                                                                    )
                                                                    else
                                                                        {2182}let pkSess_2590: bitstring = pub(sk(Sess)) in
                                                                        {2183}out(c, GetEndpointRequest);
                                                                        {2184}in(c, (=GetEndpointResponse,=pkSess_2590,=SignAndEncrypt,SP_2591: bitstring,UP_2592: bitstring));
                                                                        {2185}new Nc_2593: bitstring;
                                                                        {2186}let m1_2594: bitstring = (OpenSecureChannelRequest,pkCli_2370,Nc_2593) in
                                                                        {2187}out(c, (pkCli_2370,enc(m1_2594,pkSess_2590),sign(h(m1_2594),skCli_2369)));
                                                                        {2188}in(c, (em2_2595: bitstring,sigM2_2596: bitstring));
                                                                        {2189}let m2_2597: bitstring = dec(em2_2595,skCli_2369) in
                                                                        {2190}if (verify(h(m2_2597),sigM2_2596,pkSess_2590) <> true) then
                                                                            0
                                                                        else
                                                                            {2191}let (=OpenSecureChannelResponse,Ns_2598: bitstring,ST_2599: bitstring,TTL_2600: bitstring) = m2_2597 in
                                                                            {2192}let Kcli_2601: bitstring = h((Nc_2593,Ns_2598)) in
                                                                            {2193}out(c, senc(mCli(pkCli_2370,pkSess_2590),Kcli_2601))
                                                                )
                                                                else
                                                                    {2194}let pkSess_2602: bitstring = fail-any in
                                                                    {2195}out(c, GetEndpointRequest);
                                                                    {2196}in(c, (=GetEndpointResponse,=pkSess_2602,=SignAndEncrypt,SP_2603: bitstring,UP_2604: bitstring));
                                                                    {2197}new Nc_2605: bitstring;
                                                                    {2198}let m1_2606: bitstring = (OpenSecureChannelRequest,pkCli_2370,Nc_2605) in
                                                                    {2199}out(c, (pkCli_2370,enc(m1_2606,pkSess_2602),sign(h(m1_2606),skCli_2369)));
                                                                    {2200}in(c, (em2_2607: bitstring,sigM2_2608: bitstring));
                                                                    {2201}let m2_2609: bitstring = dec(em2_2607,skCli_2369) in
                                                                    {2202}if (verify(h(m2_2609),sigM2_2608,pkSess_2602) <> true) then
                                                                        0
                                                                    else
                                                                        {2203}let (=OpenSecureChannelResponse,Ns_2610: bitstring,ST_2611: bitstring,TTL_2612: bitstring) = m2_2609 in
                                                                        {2204}let Kcli_2613: bitstring = h((Nc_2605,Ns_2610)) in
                                                                        {2205}out(c, senc(mCli(pkCli_2370,pkSess_2602),Kcli_2613))
                                                        )
                                                        else
                                                            {2206}let pkSess_2614: bitstring = fail-any in
                                                            {2207}out(c, GetEndpointRequest);
                                                            {2208}in(c, (=GetEndpointResponse,=pkSess_2614,=SignAndEncrypt,SP_2615: bitstring,UP_2616: bitstring));
                                                            {2209}new Nc_2617: bitstring;
                                                            {2210}let m1_2618: bitstring = (OpenSecureChannelRequest,pkCli_2370,Nc_2617) in
                                                            {2211}out(c, (pkCli_2370,enc(m1_2618,pkSess_2614),sign(h(m1_2618),skCli_2369)));
                                                            {2212}in(c, (em2_2619: bitstring,sigM2_2620: bitstring));
                                                            {2213}let m2_2621: bitstring = dec(em2_2619,skCli_2369) in
                                                            {2214}if (verify(h(m2_2621),sigM2_2620,pkSess_2614) <> true) then
                                                                0
                                                            else
                                                                {2215}let (=OpenSecureChannelResponse,Ns_2622: bitstring,ST_2623: bitstring,TTL_2624: bitstring) = m2_2621 in
                                                                {2216}let Kcli_2625: bitstring = h((Nc_2617,Ns_2622)) in
                                                                {2217}out(c, senc(mCli(pkCli_2370,pkSess_2614),Kcli_2625))
                                                )
                                                else
                                                    {2218}let pkSess_2626: bitstring = fail-any in
                                                    {2219}out(c, GetEndpointRequest);
                                                    {2220}in(c, (=GetEndpointResponse,=pkSess_2626,=SignAndEncrypt,SP_2627: bitstring,UP_2628: bitstring));
                                                    {2221}new Nc_2629: bitstring;
                                                    {2222}let m1_2630: bitstring = (OpenSecureChannelRequest,pkCli_2370,Nc_2629) in
                                                    {2223}out(c, (pkCli_2370,enc(m1_2630,pkSess_2626),sign(h(m1_2630),skCli_2369)));
                                                    {2224}in(c, (em2_2631: bitstring,sigM2_2632: bitstring));
                                                    {2225}let m2_2633: bitstring = dec(em2_2631,skCli_2369) in
                                                    {2226}if (verify(h(m2_2633),sigM2_2632,pkSess_2626) <> true) then
                                                        0
                                                    else
                                                        {2227}let (=OpenSecureChannelResponse,Ns_2634: bitstring,ST_2635: bitstring,TTL_2636: bitstring) = m2_2633 in
                                                        {2228}let Kcli_2637: bitstring = h((Nc_2629,Ns_2634)) in
                                                        {2229}out(c, senc(mCli(pkCli_2370,pkSess_2626),Kcli_2637))
                                            )
                                            else
                                                {2230}let pkDisco_2638: bitstring = pub(sk(Disco)) in
                                                {2231}let v_2639: bool = (Sess = A) in
                                                (
                                                    {2232}if v_2639 then
                                                    (
                                                        {2233}let pkSess_2640: bitstring = pub(skA) in
                                                        {2234}out(c, GetEndpointRequest);
                                                        {2235}in(c, (=GetEndpointResponse,=pkSess_2640,=SignAndEncrypt,SP_2641: bitstring,UP_2642: bitstring));
                                                        {2236}new Nc_2643: bitstring;
                                                        {2237}let m1_2644: bitstring = (OpenSecureChannelRequest,pkCli_2370,Nc_2643) in
                                                        {2238}out(c, (pkCli_2370,enc(m1_2644,pkSess_2640),sign(h(m1_2644),skCli_2369)));
                                                        {2239}in(c, (em2_2645: bitstring,sigM2_2646: bitstring));
                                                        {2240}let m2_2647: bitstring = dec(em2_2645,skCli_2369) in
                                                        {2241}if (verify(h(m2_2647),sigM2_2646,pkSess_2640) <> true) then
                                                            0
                                                        else
                                                            {2242}let (=OpenSecureChannelResponse,Ns_2648: bitstring,ST_2649: bitstring,TTL_2650: bitstring) = m2_2647 in
                                                            {2243}let Kcli_2651: bitstring = h((Nc_2643,Ns_2648)) in
                                                            {2244}out(c, senc(mCli(pkCli_2370,pkSess_2640),Kcli_2651))
                                                    )
                                                    else
                                                        {2245}let v_2652: bool = (Sess = B) in
                                                        (
                                                            {2246}if v_2652 then
                                                            (
                                                                {2247}let pkSess_2653: bitstring = pub(skB) in
                                                                {2248}out(c, GetEndpointRequest);
                                                                {2249}in(c, (=GetEndpointResponse,=pkSess_2653,=SignAndEncrypt,SP_2654: bitstring,UP_2655: bitstring));
                                                                {2250}new Nc_2656: bitstring;
                                                                {2251}let m1_2657: bitstring = (OpenSecureChannelRequest,pkCli_2370,Nc_2656) in
                                                                {2252}out(c, (pkCli_2370,enc(m1_2657,pkSess_2653),sign(h(m1_2657),skCli_2369)));
                                                                {2253}in(c, (em2_2658: bitstring,sigM2_2659: bitstring));
                                                                {2254}let m2_2660: bitstring = dec(em2_2658,skCli_2369) in
                                                                {2255}if (verify(h(m2_2660),sigM2_2659,pkSess_2653) <> true) then
                                                                    0
                                                                else
                                                                    {2256}let (=OpenSecureChannelResponse,Ns_2661: bitstring,ST_2662: bitstring,TTL_2663: bitstring) = m2_2660 in
                                                                    {2257}let Kcli_2664: bitstring = h((Nc_2656,Ns_2661)) in
                                                                    {2258}out(c, senc(mCli(pkCli_2370,pkSess_2653),Kcli_2664))
                                                            )
                                                            else
                                                                {2259}let v_2665: bool = (Sess = C) in
                                                                (
                                                                    {2260}if v_2665 then
                                                                    (
                                                                        {2261}let pkSess_2666: bitstring = pub(skC) in
                                                                        {2262}out(c, GetEndpointRequest);
                                                                        {2263}in(c, (=GetEndpointResponse,=pkSess_2666,=SignAndEncrypt,SP_2667: bitstring,UP_2668: bitstring));
                                                                        {2264}new Nc_2669: bitstring;
                                                                        {2265}let m1_2670: bitstring = (OpenSecureChannelRequest,pkCli_2370,Nc_2669) in
                                                                        {2266}out(c, (pkCli_2370,enc(m1_2670,pkSess_2666),sign(h(m1_2670),skCli_2369)));
                                                                        {2267}in(c, (em2_2671: bitstring,sigM2_2672: bitstring));
                                                                        {2268}let m2_2673: bitstring = dec(em2_2671,skCli_2369) in
                                                                        {2269}if (verify(h(m2_2673),sigM2_2672,pkSess_2666) <> true) then
                                                                            0
                                                                        else
                                                                            {2270}let (=OpenSecureChannelResponse,Ns_2674: bitstring,ST_2675: bitstring,TTL_2676: bitstring) = m2_2673 in
                                                                            {2271}let Kcli_2677: bitstring = h((Nc_2669,Ns_2674)) in
                                                                            {2272}out(c, senc(mCli(pkCli_2370,pkSess_2666),Kcli_2677))
                                                                    )
                                                                    else
                                                                        {2273}let pkSess_2678: bitstring = pub(sk(Sess)) in
                                                                        {2274}out(c, GetEndpointRequest);
                                                                        {2275}in(c, (=GetEndpointResponse,=pkSess_2678,=SignAndEncrypt,SP_2679: bitstring,UP_2680: bitstring));
                                                                        {2276}new Nc_2681: bitstring;
                                                                        {2277}let m1_2682: bitstring = (OpenSecureChannelRequest,pkCli_2370,Nc_2681) in
                                                                        {2278}out(c, (pkCli_2370,enc(m1_2682,pkSess_2678),sign(h(m1_2682),skCli_2369)));
                                                                        {2279}in(c, (em2_2683: bitstring,sigM2_2684: bitstring));
                                                                        {2280}let m2_2685: bitstring = dec(em2_2683,skCli_2369) in
                                                                        {2281}if (verify(h(m2_2685),sigM2_2684,pkSess_2678) <> true) then
                                                                            0
                                                                        else
                                                                            {2282}let (=OpenSecureChannelResponse,Ns_2686: bitstring,ST_2687: bitstring,TTL_2688: bitstring) = m2_2685 in
                                                                            {2283}let Kcli_2689: bitstring = h((Nc_2681,Ns_2686)) in
                                                                            {2284}out(c, senc(mCli(pkCli_2370,pkSess_2678),Kcli_2689))
                                                                )
                                                                else
                                                                    {2285}let pkSess_2690: bitstring = fail-any in
                                                                    {2286}out(c, GetEndpointRequest);
                                                                    {2287}in(c, (=GetEndpointResponse,=pkSess_2690,=SignAndEncrypt,SP_2691: bitstring,UP_2692: bitstring));
                                                                    {2288}new Nc_2693: bitstring;
                                                                    {2289}let m1_2694: bitstring = (OpenSecureChannelRequest,pkCli_2370,Nc_2693) in
                                                                    {2290}out(c, (pkCli_2370,enc(m1_2694,pkSess_2690),sign(h(m1_2694),skCli_2369)));
                                                                    {2291}in(c, (em2_2695: bitstring,sigM2_2696: bitstring));
                                                                    {2292}let m2_2697: bitstring = dec(em2_2695,skCli_2369) in
                                                                    {2293}if (verify(h(m2_2697),sigM2_2696,pkSess_2690) <> true) then
                                                                        0
                                                                    else
                                                                        {2294}let (=OpenSecureChannelResponse,Ns_2698: bitstring,ST_2699: bitstring,TTL_2700: bitstring) = m2_2697 in
                                                                        {2295}let Kcli_2701: bitstring = h((Nc_2693,Ns_2698)) in
                                                                        {2296}out(c, senc(mCli(pkCli_2370,pkSess_2690),Kcli_2701))
                                                        )
                                                        else
                                                            {2297}let pkSess_2702: bitstring = fail-any in
                                                            {2298}out(c, GetEndpointRequest);
                                                            {2299}in(c, (=GetEndpointResponse,=pkSess_2702,=SignAndEncrypt,SP_2703: bitstring,UP_2704: bitstring));
                                                            {2300}new Nc_2705: bitstring;
                                                            {2301}let m1_2706: bitstring = (OpenSecureChannelRequest,pkCli_2370,Nc_2705) in
                                                            {2302}out(c, (pkCli_2370,enc(m1_2706,pkSess_2702),sign(h(m1_2706),skCli_2369)));
                                                            {2303}in(c, (em2_2707: bitstring,sigM2_2708: bitstring));
                                                            {2304}let m2_2709: bitstring = dec(em2_2707,skCli_2369) in
                                                            {2305}if (verify(h(m2_2709),sigM2_2708,pkSess_2702) <> true) then
                                                                0
                                                            else
                                                                {2306}let (=OpenSecureChannelResponse,Ns_2710: bitstring,ST_2711: bitstring,TTL_2712: bitstring) = m2_2709 in
                                                                {2307}let Kcli_2713: bitstring = h((Nc_2705,Ns_2710)) in
                                                                {2308}out(c, senc(mCli(pkCli_2370,pkSess_2702),Kcli_2713))
                                                )
                                                else
                                                    {2309}let pkSess_2714: bitstring = fail-any in
                                                    {2310}out(c, GetEndpointRequest);
                                                    {2311}in(c, (=GetEndpointResponse,=pkSess_2714,=SignAndEncrypt,SP_2715: bitstring,UP_2716: bitstring));
                                                    {2312}new Nc_2717: bitstring;
                                                    {2313}let m1_2718: bitstring = (OpenSecureChannelRequest,pkCli_2370,Nc_2717) in
                                                    {2314}out(c, (pkCli_2370,enc(m1_2718,pkSess_2714),sign(h(m1_2718),skCli_2369)));
                                                    {2315}in(c, (em2_2719: bitstring,sigM2_2720: bitstring));
                                                    {2316}let m2_2721: bitstring = dec(em2_2719,skCli_2369) in
                                                    {2317}if (verify(h(m2_2721),sigM2_2720,pkSess_2714) <> true) then
                                                        0
                                                    else
                                                        {2318}let (=OpenSecureChannelResponse,Ns_2722: bitstring,ST_2723: bitstring,TTL_2724: bitstring) = m2_2721 in
                                                        {2319}let Kcli_2725: bitstring = h((Nc_2717,Ns_2722)) in
                                                        {2320}out(c, senc(mCli(pkCli_2370,pkSess_2714),Kcli_2725))
                                        )
                                        else
                                            {2321}let pkDisco_2726: bitstring = fail-any in
                                            {2322}let v_2727: bool = (Sess = A) in
                                            (
                                                {2323}if v_2727 then
                                                (
                                                    {2324}let pkSess_2728: bitstring = pub(skA) in
                                                    {2325}out(c, GetEndpointRequest);
                                                    {2326}in(c, (=GetEndpointResponse,=pkSess_2728,=SignAndEncrypt,SP_2729: bitstring,UP_2730: bitstring));
                                                    {2327}new Nc_2731: bitstring;
                                                    {2328}let m1_2732: bitstring = (OpenSecureChannelRequest,pkCli_2370,Nc_2731) in
                                                    {2329}out(c, (pkCli_2370,enc(m1_2732,pkSess_2728),sign(h(m1_2732),skCli_2369)));
                                                    {2330}in(c, (em2_2733: bitstring,sigM2_2734: bitstring));
                                                    {2331}let m2_2735: bitstring = dec(em2_2733,skCli_2369) in
                                                    {2332}if (verify(h(m2_2735),sigM2_2734,pkSess_2728) <> true) then
                                                        0
                                                    else
                                                        {2333}let (=OpenSecureChannelResponse,Ns_2736: bitstring,ST_2737: bitstring,TTL_2738: bitstring) = m2_2735 in
                                                        {2334}let Kcli_2739: bitstring = h((Nc_2731,Ns_2736)) in
                                                        {2335}out(c, senc(mCli(pkCli_2370,pkSess_2728),Kcli_2739))
                                                )
                                                else
                                                    {2336}let v_2740: bool = (Sess = B) in
                                                    (
                                                        {2337}if v_2740 then
                                                        (
                                                            {2338}let pkSess_2741: bitstring = pub(skB) in
                                                            {2339}out(c, GetEndpointRequest);
                                                            {2340}in(c, (=GetEndpointResponse,=pkSess_2741,=SignAndEncrypt,SP_2742: bitstring,UP_2743: bitstring));
                                                            {2341}new Nc_2744: bitstring;
                                                            {2342}let m1_2745: bitstring = (OpenSecureChannelRequest,pkCli_2370,Nc_2744) in
                                                            {2343}out(c, (pkCli_2370,enc(m1_2745,pkSess_2741),sign(h(m1_2745),skCli_2369)));
                                                            {2344}in(c, (em2_2746: bitstring,sigM2_2747: bitstring));
                                                            {2345}let m2_2748: bitstring = dec(em2_2746,skCli_2369) in
                                                            {2346}if (verify(h(m2_2748),sigM2_2747,pkSess_2741) <> true) then
                                                                0
                                                            else
                                                                {2347}let (=OpenSecureChannelResponse,Ns_2749: bitstring,ST_2750: bitstring,TTL_2751: bitstring) = m2_2748 in
                                                                {2348}let Kcli_2752: bitstring = h((Nc_2744,Ns_2749)) in
                                                                {2349}out(c, senc(mCli(pkCli_2370,pkSess_2741),Kcli_2752))
                                                        )
                                                        else
                                                            {2350}let v_2753: bool = (Sess = C) in
                                                            (
                                                                {2351}if v_2753 then
                                                                (
                                                                    {2352}let pkSess_2754: bitstring = pub(skC) in
                                                                    {2353}out(c, GetEndpointRequest);
                                                                    {2354}in(c, (=GetEndpointResponse,=pkSess_2754,=SignAndEncrypt,SP_2755: bitstring,UP_2756: bitstring));
                                                                    {2355}new Nc_2757: bitstring;
                                                                    {2356}let m1_2758: bitstring = (OpenSecureChannelRequest,pkCli_2370,Nc_2757) in
                                                                    {2357}out(c, (pkCli_2370,enc(m1_2758,pkSess_2754),sign(h(m1_2758),skCli_2369)));
                                                                    {2358}in(c, (em2_2759: bitstring,sigM2_2760: bitstring));
                                                                    {2359}let m2_2761: bitstring = dec(em2_2759,skCli_2369) in
                                                                    {2360}if (verify(h(m2_2761),sigM2_2760,pkSess_2754) <> true) then
                                                                        0
                                                                    else
                                                                        {2361}let (=OpenSecureChannelResponse,Ns_2762: bitstring,ST_2763: bitstring,TTL_2764: bitstring) = m2_2761 in
                                                                        {2362}let Kcli_2765: bitstring = h((Nc_2757,Ns_2762)) in
                                                                        {2363}out(c, senc(mCli(pkCli_2370,pkSess_2754),Kcli_2765))
                                                                )
                                                                else
                                                                    {2364}let pkSess_2766: bitstring = pub(sk(Sess)) in
                                                                    {2365}out(c, GetEndpointRequest);
                                                                    {2366}in(c, (=GetEndpointResponse,=pkSess_2766,=SignAndEncrypt,SP_2767: bitstring,UP_2768: bitstring));
                                                                    {2367}new Nc_2769: bitstring;
                                                                    {2368}let m1_2770: bitstring = (OpenSecureChannelRequest,pkCli_2370,Nc_2769) in
                                                                    {2369}out(c, (pkCli_2370,enc(m1_2770,pkSess_2766),sign(h(m1_2770),skCli_2369)));
                                                                    {2370}in(c, (em2_2771: bitstring,sigM2_2772: bitstring));
                                                                    {2371}let m2_2773: bitstring = dec(em2_2771,skCli_2369) in
                                                                    {2372}if (verify(h(m2_2773),sigM2_2772,pkSess_2766) <> true) then
                                                                        0
                                                                    else
                                                                        {2373}let (=OpenSecureChannelResponse,Ns_2774: bitstring,ST_2775: bitstring,TTL_2776: bitstring) = m2_2773 in
                                                                        {2374}let Kcli_2777: bitstring = h((Nc_2769,Ns_2774)) in
                                                                        {2375}out(c, senc(mCli(pkCli_2370,pkSess_2766),Kcli_2777))
                                                            )
                                                            else
                                                                {2376}let pkSess_2778: bitstring = fail-any in
                                                                {2377}out(c, GetEndpointRequest);
                                                                {2378}in(c, (=GetEndpointResponse,=pkSess_2778,=SignAndEncrypt,SP_2779: bitstring,UP_2780: bitstring));
                                                                {2379}new Nc_2781: bitstring;
                                                                {2380}let m1_2782: bitstring = (OpenSecureChannelRequest,pkCli_2370,Nc_2781) in
                                                                {2381}out(c, (pkCli_2370,enc(m1_2782,pkSess_2778),sign(h(m1_2782),skCli_2369)));
                                                                {2382}in(c, (em2_2783: bitstring,sigM2_2784: bitstring));
                                                                {2383}let m2_2785: bitstring = dec(em2_2783,skCli_2369) in
                                                                {2384}if (verify(h(m2_2785),sigM2_2784,pkSess_2778) <> true) then
                                                                    0
                                                                else
                                                                    {2385}let (=OpenSecureChannelResponse,Ns_2786: bitstring,ST_2787: bitstring,TTL_2788: bitstring) = m2_2785 in
                                                                    {2386}let Kcli_2789: bitstring = h((Nc_2781,Ns_2786)) in
                                                                    {2387}out(c, senc(mCli(pkCli_2370,pkSess_2778),Kcli_2789))
                                                    )
                                                    else
                                                        {2388}let pkSess_2790: bitstring = fail-any in
                                                        {2389}out(c, GetEndpointRequest);
                                                        {2390}in(c, (=GetEndpointResponse,=pkSess_2790,=SignAndEncrypt,SP_2791: bitstring,UP_2792: bitstring));
                                                        {2391}new Nc_2793: bitstring;
                                                        {2392}let m1_2794: bitstring = (OpenSecureChannelRequest,pkCli_2370,Nc_2793) in
                                                        {2393}out(c, (pkCli_2370,enc(m1_2794,pkSess_2790),sign(h(m1_2794),skCli_2369)));
                                                        {2394}in(c, (em2_2795: bitstring,sigM2_2796: bitstring));
                                                        {2395}let m2_2797: bitstring = dec(em2_2795,skCli_2369) in
                                                        {2396}if (verify(h(m2_2797),sigM2_2796,pkSess_2790) <> true) then
                                                            0
                                                        else
                                                            {2397}let (=OpenSecureChannelResponse,Ns_2798: bitstring,ST_2799: bitstring,TTL_2800: bitstring) = m2_2797 in
                                                            {2398}let Kcli_2801: bitstring = h((Nc_2793,Ns_2798)) in
                                                            {2399}out(c, senc(mCli(pkCli_2370,pkSess_2790),Kcli_2801))
                                            )
                                            else
                                                {2400}let pkSess_2802: bitstring = fail-any in
                                                {2401}out(c, GetEndpointRequest);
                                                {2402}in(c, (=GetEndpointResponse,=pkSess_2802,=SignAndEncrypt,SP_2803: bitstring,UP_2804: bitstring));
                                                {2403}new Nc_2805: bitstring;
                                                {2404}let m1_2806: bitstring = (OpenSecureChannelRequest,pkCli_2370,Nc_2805) in
                                                {2405}out(c, (pkCli_2370,enc(m1_2806,pkSess_2802),sign(h(m1_2806),skCli_2369)));
                                                {2406}in(c, (em2_2807: bitstring,sigM2_2808: bitstring));
                                                {2407}let m2_2809: bitstring = dec(em2_2807,skCli_2369) in
                                                {2408}if (verify(h(m2_2809),sigM2_2808,pkSess_2802) <> true) then
                                                    0
                                                else
                                                    {2409}let (=OpenSecureChannelResponse,Ns_2810: bitstring,ST_2811: bitstring,TTL_2812: bitstring) = m2_2809 in
                                                    {2410}let Kcli_2813: bitstring = h((Nc_2805,Ns_2810)) in
                                                    {2411}out(c, senc(mCli(pkCli_2370,pkSess_2802),Kcli_2813))
                                )
                                else
                                    {2412}let pkDisco_2814: bitstring = fail-any in
                                    {2413}let v_2815: bool = (Sess = A) in
                                    (
                                        {2414}if v_2815 then
                                        (
                                            {2415}let pkSess_2816: bitstring = pub(skA) in
                                            {2416}out(c, GetEndpointRequest);
                                            {2417}in(c, (=GetEndpointResponse,=pkSess_2816,=SignAndEncrypt,SP_2817: bitstring,UP_2818: bitstring));
                                            {2418}new Nc_2819: bitstring;
                                            {2419}let m1_2820: bitstring = (OpenSecureChannelRequest,pkCli_2370,Nc_2819) in
                                            {2420}out(c, (pkCli_2370,enc(m1_2820,pkSess_2816),sign(h(m1_2820),skCli_2369)));
                                            {2421}in(c, (em2_2821: bitstring,sigM2_2822: bitstring));
                                            {2422}let m2_2823: bitstring = dec(em2_2821,skCli_2369) in
                                            {2423}if (verify(h(m2_2823),sigM2_2822,pkSess_2816) <> true) then
                                                0
                                            else
                                                {2424}let (=OpenSecureChannelResponse,Ns_2824: bitstring,ST_2825: bitstring,TTL_2826: bitstring) = m2_2823 in
                                                {2425}let Kcli_2827: bitstring = h((Nc_2819,Ns_2824)) in
                                                {2426}out(c, senc(mCli(pkCli_2370,pkSess_2816),Kcli_2827))
                                        )
                                        else
                                            {2427}let v_2828: bool = (Sess = B) in
                                            (
                                                {2428}if v_2828 then
                                                (
                                                    {2429}let pkSess_2829: bitstring = pub(skB) in
                                                    {2430}out(c, GetEndpointRequest);
                                                    {2431}in(c, (=GetEndpointResponse,=pkSess_2829,=SignAndEncrypt,SP_2830: bitstring,UP_2831: bitstring));
                                                    {2432}new Nc_2832: bitstring;
                                                    {2433}let m1_2833: bitstring = (OpenSecureChannelRequest,pkCli_2370,Nc_2832) in
                                                    {2434}out(c, (pkCli_2370,enc(m1_2833,pkSess_2829),sign(h(m1_2833),skCli_2369)));
                                                    {2435}in(c, (em2_2834: bitstring,sigM2_2835: bitstring));
                                                    {2436}let m2_2836: bitstring = dec(em2_2834,skCli_2369) in
                                                    {2437}if (verify(h(m2_2836),sigM2_2835,pkSess_2829) <> true) then
                                                        0
                                                    else
                                                        {2438}let (=OpenSecureChannelResponse,Ns_2837: bitstring,ST_2838: bitstring,TTL_2839: bitstring) = m2_2836 in
                                                        {2439}let Kcli_2840: bitstring = h((Nc_2832,Ns_2837)) in
                                                        {2440}out(c, senc(mCli(pkCli_2370,pkSess_2829),Kcli_2840))
                                                )
                                                else
                                                    {2441}let v_2841: bool = (Sess = C) in
                                                    (
                                                        {2442}if v_2841 then
                                                        (
                                                            {2443}let pkSess_2842: bitstring = pub(skC) in
                                                            {2444}out(c, GetEndpointRequest);
                                                            {2445}in(c, (=GetEndpointResponse,=pkSess_2842,=SignAndEncrypt,SP_2843: bitstring,UP_2844: bitstring));
                                                            {2446}new Nc_2845: bitstring;
                                                            {2447}let m1_2846: bitstring = (OpenSecureChannelRequest,pkCli_2370,Nc_2845) in
                                                            {2448}out(c, (pkCli_2370,enc(m1_2846,pkSess_2842),sign(h(m1_2846),skCli_2369)));
                                                            {2449}in(c, (em2_2847: bitstring,sigM2_2848: bitstring));
                                                            {2450}let m2_2849: bitstring = dec(em2_2847,skCli_2369) in
                                                            {2451}if (verify(h(m2_2849),sigM2_2848,pkSess_2842) <> true) then
                                                                0
                                                            else
                                                                {2452}let (=OpenSecureChannelResponse,Ns_2850: bitstring,ST_2851: bitstring,TTL_2852: bitstring) = m2_2849 in
                                                                {2453}let Kcli_2853: bitstring = h((Nc_2845,Ns_2850)) in
                                                                {2454}out(c, senc(mCli(pkCli_2370,pkSess_2842),Kcli_2853))
                                                        )
                                                        else
                                                            {2455}let pkSess_2854: bitstring = pub(sk(Sess)) in
                                                            {2456}out(c, GetEndpointRequest);
                                                            {2457}in(c, (=GetEndpointResponse,=pkSess_2854,=SignAndEncrypt,SP_2855: bitstring,UP_2856: bitstring));
                                                            {2458}new Nc_2857: bitstring;
                                                            {2459}let m1_2858: bitstring = (OpenSecureChannelRequest,pkCli_2370,Nc_2857) in
                                                            {2460}out(c, (pkCli_2370,enc(m1_2858,pkSess_2854),sign(h(m1_2858),skCli_2369)));
                                                            {2461}in(c, (em2_2859: bitstring,sigM2_2860: bitstring));
                                                            {2462}let m2_2861: bitstring = dec(em2_2859,skCli_2369) in
                                                            {2463}if (verify(h(m2_2861),sigM2_2860,pkSess_2854) <> true) then
                                                                0
                                                            else
                                                                {2464}let (=OpenSecureChannelResponse,Ns_2862: bitstring,ST_2863: bitstring,TTL_2864: bitstring) = m2_2861 in
                                                                {2465}let Kcli_2865: bitstring = h((Nc_2857,Ns_2862)) in
                                                                {2466}out(c, senc(mCli(pkCli_2370,pkSess_2854),Kcli_2865))
                                                    )
                                                    else
                                                        {2467}let pkSess_2866: bitstring = fail-any in
                                                        {2468}out(c, GetEndpointRequest);
                                                        {2469}in(c, (=GetEndpointResponse,=pkSess_2866,=SignAndEncrypt,SP_2867: bitstring,UP_2868: bitstring));
                                                        {2470}new Nc_2869: bitstring;
                                                        {2471}let m1_2870: bitstring = (OpenSecureChannelRequest,pkCli_2370,Nc_2869) in
                                                        {2472}out(c, (pkCli_2370,enc(m1_2870,pkSess_2866),sign(h(m1_2870),skCli_2369)));
                                                        {2473}in(c, (em2_2871: bitstring,sigM2_2872: bitstring));
                                                        {2474}let m2_2873: bitstring = dec(em2_2871,skCli_2369) in
                                                        {2475}if (verify(h(m2_2873),sigM2_2872,pkSess_2866) <> true) then
                                                            0
                                                        else
                                                            {2476}let (=OpenSecureChannelResponse,Ns_2874: bitstring,ST_2875: bitstring,TTL_2876: bitstring) = m2_2873 in
                                                            {2477}let Kcli_2877: bitstring = h((Nc_2869,Ns_2874)) in
                                                            {2478}out(c, senc(mCli(pkCli_2370,pkSess_2866),Kcli_2877))
                                            )
                                            else
                                                {2479}let pkSess_2878: bitstring = fail-any in
                                                {2480}out(c, GetEndpointRequest);
                                                {2481}in(c, (=GetEndpointResponse,=pkSess_2878,=SignAndEncrypt,SP_2879: bitstring,UP_2880: bitstring));
                                                {2482}new Nc_2881: bitstring;
                                                {2483}let m1_2882: bitstring = (OpenSecureChannelRequest,pkCli_2370,Nc_2881) in
                                                {2484}out(c, (pkCli_2370,enc(m1_2882,pkSess_2878),sign(h(m1_2882),skCli_2369)));
                                                {2485}in(c, (em2_2883: bitstring,sigM2_2884: bitstring));
                                                {2486}let m2_2885: bitstring = dec(em2_2883,skCli_2369) in
                                                {2487}if (verify(h(m2_2885),sigM2_2884,pkSess_2878) <> true) then
                                                    0
                                                else
                                                    {2488}let (=OpenSecureChannelResponse,Ns_2886: bitstring,ST_2887: bitstring,TTL_2888: bitstring) = m2_2885 in
                                                    {2489}let Kcli_2889: bitstring = h((Nc_2881,Ns_2886)) in
                                                    {2490}out(c, senc(mCli(pkCli_2370,pkSess_2878),Kcli_2889))
                                    )
                                    else
                                        {2491}let pkSess_2890: bitstring = fail-any in
                                        {2492}out(c, GetEndpointRequest);
                                        {2493}in(c, (=GetEndpointResponse,=pkSess_2890,=SignAndEncrypt,SP_2891: bitstring,UP_2892: bitstring));
                                        {2494}new Nc_2893: bitstring;
                                        {2495}let m1_2894: bitstring = (OpenSecureChannelRequest,pkCli_2370,Nc_2893) in
                                        {2496}out(c, (pkCli_2370,enc(m1_2894,pkSess_2890),sign(h(m1_2894),skCli_2369)));
                                        {2497}in(c, (em2_2895: bitstring,sigM2_2896: bitstring));
                                        {2498}let m2_2897: bitstring = dec(em2_2895,skCli_2369) in
                                        {2499}if (verify(h(m2_2897),sigM2_2896,pkSess_2890) <> true) then
                                            0
                                        else
                                            {2500}let (=OpenSecureChannelResponse,Ns_2898: bitstring,ST_2899: bitstring,TTL_2900: bitstring) = m2_2897 in
                                            {2501}let Kcli_2901: bitstring = h((Nc_2893,Ns_2898)) in
                                            {2502}out(c, senc(mCli(pkCli_2370,pkSess_2890),Kcli_2901))
                        )
                        else
                            {2503}let pkDisco_2902: bitstring = fail-any in
                            {2504}let v_2903: bool = (Sess = A) in
                            (
                                {2505}if v_2903 then
                                (
                                    {2506}let pkSess_2904: bitstring = pub(skA) in
                                    {2507}out(c, GetEndpointRequest);
                                    {2508}in(c, (=GetEndpointResponse,=pkSess_2904,=SignAndEncrypt,SP_2905: bitstring,UP_2906: bitstring));
                                    {2509}new Nc_2907: bitstring;
                                    {2510}let m1_2908: bitstring = (OpenSecureChannelRequest,pkCli_2370,Nc_2907) in
                                    {2511}out(c, (pkCli_2370,enc(m1_2908,pkSess_2904),sign(h(m1_2908),skCli_2369)));
                                    {2512}in(c, (em2_2909: bitstring,sigM2_2910: bitstring));
                                    {2513}let m2_2911: bitstring = dec(em2_2909,skCli_2369) in
                                    {2514}if (verify(h(m2_2911),sigM2_2910,pkSess_2904) <> true) then
                                        0
                                    else
                                        {2515}let (=OpenSecureChannelResponse,Ns_2912: bitstring,ST_2913: bitstring,TTL_2914: bitstring) = m2_2911 in
                                        {2516}let Kcli_2915: bitstring = h((Nc_2907,Ns_2912)) in
                                        {2517}out(c, senc(mCli(pkCli_2370,pkSess_2904),Kcli_2915))
                                )
                                else
                                    {2518}let v_2916: bool = (Sess = B) in
                                    (
                                        {2519}if v_2916 then
                                        (
                                            {2520}let pkSess_2917: bitstring = pub(skB) in
                                            {2521}out(c, GetEndpointRequest);
                                            {2522}in(c, (=GetEndpointResponse,=pkSess_2917,=SignAndEncrypt,SP_2918: bitstring,UP_2919: bitstring));
                                            {2523}new Nc_2920: bitstring;
                                            {2524}let m1_2921: bitstring = (OpenSecureChannelRequest,pkCli_2370,Nc_2920) in
                                            {2525}out(c, (pkCli_2370,enc(m1_2921,pkSess_2917),sign(h(m1_2921),skCli_2369)));
                                            {2526}in(c, (em2_2922: bitstring,sigM2_2923: bitstring));
                                            {2527}let m2_2924: bitstring = dec(em2_2922,skCli_2369) in
                                            {2528}if (verify(h(m2_2924),sigM2_2923,pkSess_2917) <> true) then
                                                0
                                            else
                                                {2529}let (=OpenSecureChannelResponse,Ns_2925: bitstring,ST_2926: bitstring,TTL_2927: bitstring) = m2_2924 in
                                                {2530}let Kcli_2928: bitstring = h((Nc_2920,Ns_2925)) in
                                                {2531}out(c, senc(mCli(pkCli_2370,pkSess_2917),Kcli_2928))
                                        )
                                        else
                                            {2532}let v_2929: bool = (Sess = C) in
                                            (
                                                {2533}if v_2929 then
                                                (
                                                    {2534}let pkSess_2930: bitstring = pub(skC) in
                                                    {2535}out(c, GetEndpointRequest);
                                                    {2536}in(c, (=GetEndpointResponse,=pkSess_2930,=SignAndEncrypt,SP_2931: bitstring,UP_2932: bitstring));
                                                    {2537}new Nc_2933: bitstring;
                                                    {2538}let m1_2934: bitstring = (OpenSecureChannelRequest,pkCli_2370,Nc_2933) in
                                                    {2539}out(c, (pkCli_2370,enc(m1_2934,pkSess_2930),sign(h(m1_2934),skCli_2369)));
                                                    {2540}in(c, (em2_2935: bitstring,sigM2_2936: bitstring));
                                                    {2541}let m2_2937: bitstring = dec(em2_2935,skCli_2369) in
                                                    {2542}if (verify(h(m2_2937),sigM2_2936,pkSess_2930) <> true) then
                                                        0
                                                    else
                                                        {2543}let (=OpenSecureChannelResponse,Ns_2938: bitstring,ST_2939: bitstring,TTL_2940: bitstring) = m2_2937 in
                                                        {2544}let Kcli_2941: bitstring = h((Nc_2933,Ns_2938)) in
                                                        {2545}out(c, senc(mCli(pkCli_2370,pkSess_2930),Kcli_2941))
                                                )
                                                else
                                                    {2546}let pkSess_2942: bitstring = pub(sk(Sess)) in
                                                    {2547}out(c, GetEndpointRequest);
                                                    {2548}in(c, (=GetEndpointResponse,=pkSess_2942,=SignAndEncrypt,SP_2943: bitstring,UP_2944: bitstring));
                                                    {2549}new Nc_2945: bitstring;
                                                    {2550}let m1_2946: bitstring = (OpenSecureChannelRequest,pkCli_2370,Nc_2945) in
                                                    {2551}out(c, (pkCli_2370,enc(m1_2946,pkSess_2942),sign(h(m1_2946),skCli_2369)));
                                                    {2552}in(c, (em2_2947: bitstring,sigM2_2948: bitstring));
                                                    {2553}let m2_2949: bitstring = dec(em2_2947,skCli_2369) in
                                                    {2554}if (verify(h(m2_2949),sigM2_2948,pkSess_2942) <> true) then
                                                        0
                                                    else
                                                        {2555}let (=OpenSecureChannelResponse,Ns_2950: bitstring,ST_2951: bitstring,TTL_2952: bitstring) = m2_2949 in
                                                        {2556}let Kcli_2953: bitstring = h((Nc_2945,Ns_2950)) in
                                                        {2557}out(c, senc(mCli(pkCli_2370,pkSess_2942),Kcli_2953))
                                            )
                                            else
                                                {2558}let pkSess_2954: bitstring = fail-any in
                                                {2559}out(c, GetEndpointRequest);
                                                {2560}in(c, (=GetEndpointResponse,=pkSess_2954,=SignAndEncrypt,SP_2955: bitstring,UP_2956: bitstring));
                                                {2561}new Nc_2957: bitstring;
                                                {2562}let m1_2958: bitstring = (OpenSecureChannelRequest,pkCli_2370,Nc_2957) in
                                                {2563}out(c, (pkCli_2370,enc(m1_2958,pkSess_2954),sign(h(m1_2958),skCli_2369)));
                                                {2564}in(c, (em2_2959: bitstring,sigM2_2960: bitstring));
                                                {2565}let m2_2961: bitstring = dec(em2_2959,skCli_2369) in
                                                {2566}if (verify(h(m2_2961),sigM2_2960,pkSess_2954) <> true) then
                                                    0
                                                else
                                                    {2567}let (=OpenSecureChannelResponse,Ns_2962: bitstring,ST_2963: bitstring,TTL_2964: bitstring) = m2_2961 in
                                                    {2568}let Kcli_2965: bitstring = h((Nc_2957,Ns_2962)) in
                                                    {2569}out(c, senc(mCli(pkCli_2370,pkSess_2954),Kcli_2965))
                                    )
                                    else
                                        {2570}let pkSess_2966: bitstring = fail-any in
                                        {2571}out(c, GetEndpointRequest);
                                        {2572}in(c, (=GetEndpointResponse,=pkSess_2966,=SignAndEncrypt,SP_2967: bitstring,UP_2968: bitstring));
                                        {2573}new Nc_2969: bitstring;
                                        {2574}let m1_2970: bitstring = (OpenSecureChannelRequest,pkCli_2370,Nc_2969) in
                                        {2575}out(c, (pkCli_2370,enc(m1_2970,pkSess_2966),sign(h(m1_2970),skCli_2369)));
                                        {2576}in(c, (em2_2971: bitstring,sigM2_2972: bitstring));
                                        {2577}let m2_2973: bitstring = dec(em2_2971,skCli_2369) in
                                        {2578}if (verify(h(m2_2973),sigM2_2972,pkSess_2966) <> true) then
                                            0
                                        else
                                            {2579}let (=OpenSecureChannelResponse,Ns_2974: bitstring,ST_2975: bitstring,TTL_2976: bitstring) = m2_2973 in
                                            {2580}let Kcli_2977: bitstring = h((Nc_2969,Ns_2974)) in
                                            {2581}out(c, senc(mCli(pkCli_2370,pkSess_2966),Kcli_2977))
                            )
                            else
                                {2582}let pkSess_2978: bitstring = fail-any in
                                {2583}out(c, GetEndpointRequest);
                                {2584}in(c, (=GetEndpointResponse,=pkSess_2978,=SignAndEncrypt,SP_2979: bitstring,UP_2980: bitstring));
                                {2585}new Nc_2981: bitstring;
                                {2586}let m1_2982: bitstring = (OpenSecureChannelRequest,pkCli_2370,Nc_2981) in
                                {2587}out(c, (pkCli_2370,enc(m1_2982,pkSess_2978),sign(h(m1_2982),skCli_2369)));
                                {2588}in(c, (em2_2983: bitstring,sigM2_2984: bitstring));
                                {2589}let m2_2985: bitstring = dec(em2_2983,skCli_2369) in
                                {2590}if (verify(h(m2_2985),sigM2_2984,pkSess_2978) <> true) then
                                    0
                                else
                                    {2591}let (=OpenSecureChannelResponse,Ns_2986: bitstring,ST_2987: bitstring,TTL_2988: bitstring) = m2_2985 in
                                    {2592}let Kcli_2989: bitstring = h((Nc_2981,Ns_2986)) in
                                    {2593}out(c, senc(mCli(pkCli_2370,pkSess_2978),Kcli_2989))
            )
            else
                {2594}let skCli_2990: bitstring = fail-any in
                {2595}let pkCli_2991: bitstring = pub(skCli_2990) in
                {2596}let v_2992: bool = (Disco = A) in
                (
                    {2597}if v_2992 then
                    (
                        {2598}let pkDisco_2993: bitstring = pub(skA) in
                        {2599}let v_2994: bool = (Sess = A) in
                        (
                            {2600}if v_2994 then
                            (
                                {2601}let pkSess_2995: bitstring = pub(skA) in
                                {2602}out(c, GetEndpointRequest);
                                {2603}in(c, (=GetEndpointResponse,=pkSess_2995,=SignAndEncrypt,SP_2996: bitstring,UP_2997: bitstring));
                                {2604}new Nc_2998: bitstring;
                                {2605}let m1_2999: bitstring = (OpenSecureChannelRequest,pkCli_2991,Nc_2998) in
                                {2606}out(c, (pkCli_2991,enc(m1_2999,pkSess_2995),sign(h(m1_2999),skCli_2990)));
                                {2607}in(c, (em2_3000: bitstring,sigM2_3001: bitstring));
                                {2608}let m2_3002: bitstring = dec(em2_3000,skCli_2990) in
                                {2609}if (verify(h(m2_3002),sigM2_3001,pkSess_2995) <> true) then
                                    0
                                else
                                    {2610}let (=OpenSecureChannelResponse,Ns_3003: bitstring,ST_3004: bitstring,TTL_3005: bitstring) = m2_3002 in
                                    {2611}let Kcli_3006: bitstring = h((Nc_2998,Ns_3003)) in
                                    {2612}out(c, senc(mCli(pkCli_2991,pkSess_2995),Kcli_3006))
                            )
                            else
                                {2613}let v_3007: bool = (Sess = B) in
                                (
                                    {2614}if v_3007 then
                                    (
                                        {2615}let pkSess_3008: bitstring = pub(skB) in
                                        {2616}out(c, GetEndpointRequest);
                                        {2617}in(c, (=GetEndpointResponse,=pkSess_3008,=SignAndEncrypt,SP_3009: bitstring,UP_3010: bitstring));
                                        {2618}new Nc_3011: bitstring;
                                        {2619}let m1_3012: bitstring = (OpenSecureChannelRequest,pkCli_2991,Nc_3011) in
                                        {2620}out(c, (pkCli_2991,enc(m1_3012,pkSess_3008),sign(h(m1_3012),skCli_2990)));
                                        {2621}in(c, (em2_3013: bitstring,sigM2_3014: bitstring));
                                        {2622}let m2_3015: bitstring = dec(em2_3013,skCli_2990) in
                                        {2623}if (verify(h(m2_3015),sigM2_3014,pkSess_3008) <> true) then
                                            0
                                        else
                                            {2624}let (=OpenSecureChannelResponse,Ns_3016: bitstring,ST_3017: bitstring,TTL_3018: bitstring) = m2_3015 in
                                            {2625}let Kcli_3019: bitstring = h((Nc_3011,Ns_3016)) in
                                            {2626}out(c, senc(mCli(pkCli_2991,pkSess_3008),Kcli_3019))
                                    )
                                    else
                                        {2627}let v_3020: bool = (Sess = C) in
                                        (
                                            {2628}if v_3020 then
                                            (
                                                {2629}let pkSess_3021: bitstring = pub(skC) in
                                                {2630}out(c, GetEndpointRequest);
                                                {2631}in(c, (=GetEndpointResponse,=pkSess_3021,=SignAndEncrypt,SP_3022: bitstring,UP_3023: bitstring));
                                                {2632}new Nc_3024: bitstring;
                                                {2633}let m1_3025: bitstring = (OpenSecureChannelRequest,pkCli_2991,Nc_3024) in
                                                {2634}out(c, (pkCli_2991,enc(m1_3025,pkSess_3021),sign(h(m1_3025),skCli_2990)));
                                                {2635}in(c, (em2_3026: bitstring,sigM2_3027: bitstring));
                                                {2636}let m2_3028: bitstring = dec(em2_3026,skCli_2990) in
                                                {2637}if (verify(h(m2_3028),sigM2_3027,pkSess_3021) <> true) then
                                                    0
                                                else
                                                    {2638}let (=OpenSecureChannelResponse,Ns_3029: bitstring,ST_3030: bitstring,TTL_3031: bitstring) = m2_3028 in
                                                    {2639}let Kcli_3032: bitstring = h((Nc_3024,Ns_3029)) in
                                                    {2640}out(c, senc(mCli(pkCli_2991,pkSess_3021),Kcli_3032))
                                            )
                                            else
                                                {2641}let pkSess_3033: bitstring = pub(sk(Sess)) in
                                                {2642}out(c, GetEndpointRequest);
                                                {2643}in(c, (=GetEndpointResponse,=pkSess_3033,=SignAndEncrypt,SP_3034: bitstring,UP_3035: bitstring));
                                                {2644}new Nc_3036: bitstring;
                                                {2645}let m1_3037: bitstring = (OpenSecureChannelRequest,pkCli_2991,Nc_3036) in
                                                {2646}out(c, (pkCli_2991,enc(m1_3037,pkSess_3033),sign(h(m1_3037),skCli_2990)));
                                                {2647}in(c, (em2_3038: bitstring,sigM2_3039: bitstring));
                                                {2648}let m2_3040: bitstring = dec(em2_3038,skCli_2990) in
                                                {2649}if (verify(h(m2_3040),sigM2_3039,pkSess_3033) <> true) then
                                                    0
                                                else
                                                    {2650}let (=OpenSecureChannelResponse,Ns_3041: bitstring,ST_3042: bitstring,TTL_3043: bitstring) = m2_3040 in
                                                    {2651}let Kcli_3044: bitstring = h((Nc_3036,Ns_3041)) in
                                                    {2652}out(c, senc(mCli(pkCli_2991,pkSess_3033),Kcli_3044))
                                        )
                                        else
                                            {2653}let pkSess_3045: bitstring = fail-any in
                                            {2654}out(c, GetEndpointRequest);
                                            {2655}in(c, (=GetEndpointResponse,=pkSess_3045,=SignAndEncrypt,SP_3046: bitstring,UP_3047: bitstring));
                                            {2656}new Nc_3048: bitstring;
                                            {2657}let m1_3049: bitstring = (OpenSecureChannelRequest,pkCli_2991,Nc_3048) in
                                            {2658}out(c, (pkCli_2991,enc(m1_3049,pkSess_3045),sign(h(m1_3049),skCli_2990)));
                                            {2659}in(c, (em2_3050: bitstring,sigM2_3051: bitstring));
                                            {2660}let m2_3052: bitstring = dec(em2_3050,skCli_2990) in
                                            {2661}if (verify(h(m2_3052),sigM2_3051,pkSess_3045) <> true) then
                                                0
                                            else
                                                {2662}let (=OpenSecureChannelResponse,Ns_3053: bitstring,ST_3054: bitstring,TTL_3055: bitstring) = m2_3052 in
                                                {2663}let Kcli_3056: bitstring = h((Nc_3048,Ns_3053)) in
                                                {2664}out(c, senc(mCli(pkCli_2991,pkSess_3045),Kcli_3056))
                                )
                                else
                                    {2665}let pkSess_3057: bitstring = fail-any in
                                    {2666}out(c, GetEndpointRequest);
                                    {2667}in(c, (=GetEndpointResponse,=pkSess_3057,=SignAndEncrypt,SP_3058: bitstring,UP_3059: bitstring));
                                    {2668}new Nc_3060: bitstring;
                                    {2669}let m1_3061: bitstring = (OpenSecureChannelRequest,pkCli_2991,Nc_3060) in
                                    {2670}out(c, (pkCli_2991,enc(m1_3061,pkSess_3057),sign(h(m1_3061),skCli_2990)));
                                    {2671}in(c, (em2_3062: bitstring,sigM2_3063: bitstring));
                                    {2672}let m2_3064: bitstring = dec(em2_3062,skCli_2990) in
                                    {2673}if (verify(h(m2_3064),sigM2_3063,pkSess_3057) <> true) then
                                        0
                                    else
                                        {2674}let (=OpenSecureChannelResponse,Ns_3065: bitstring,ST_3066: bitstring,TTL_3067: bitstring) = m2_3064 in
                                        {2675}let Kcli_3068: bitstring = h((Nc_3060,Ns_3065)) in
                                        {2676}out(c, senc(mCli(pkCli_2991,pkSess_3057),Kcli_3068))
                        )
                        else
                            {2677}let pkSess_3069: bitstring = fail-any in
                            {2678}out(c, GetEndpointRequest);
                            {2679}in(c, (=GetEndpointResponse,=pkSess_3069,=SignAndEncrypt,SP_3070: bitstring,UP_3071: bitstring));
                            {2680}new Nc_3072: bitstring;
                            {2681}let m1_3073: bitstring = (OpenSecureChannelRequest,pkCli_2991,Nc_3072) in
                            {2682}out(c, (pkCli_2991,enc(m1_3073,pkSess_3069),sign(h(m1_3073),skCli_2990)));
                            {2683}in(c, (em2_3074: bitstring,sigM2_3075: bitstring));
                            {2684}let m2_3076: bitstring = dec(em2_3074,skCli_2990) in
                            {2685}if (verify(h(m2_3076),sigM2_3075,pkSess_3069) <> true) then
                                0
                            else
                                {2686}let (=OpenSecureChannelResponse,Ns_3077: bitstring,ST_3078: bitstring,TTL_3079: bitstring) = m2_3076 in
                                {2687}let Kcli_3080: bitstring = h((Nc_3072,Ns_3077)) in
                                {2688}out(c, senc(mCli(pkCli_2991,pkSess_3069),Kcli_3080))
                    )
                    else
                        {2689}let v_3081: bool = (Disco = B) in
                        (
                            {2690}if v_3081 then
                            (
                                {2691}let pkDisco_3082: bitstring = pub(skB) in
                                {2692}let v_3083: bool = (Sess = A) in
                                (
                                    {2693}if v_3083 then
                                    (
                                        {2694}let pkSess_3084: bitstring = pub(skA) in
                                        {2695}out(c, GetEndpointRequest);
                                        {2696}in(c, (=GetEndpointResponse,=pkSess_3084,=SignAndEncrypt,SP_3085: bitstring,UP_3086: bitstring));
                                        {2697}new Nc_3087: bitstring;
                                        {2698}let m1_3088: bitstring = (OpenSecureChannelRequest,pkCli_2991,Nc_3087) in
                                        {2699}out(c, (pkCli_2991,enc(m1_3088,pkSess_3084),sign(h(m1_3088),skCli_2990)));
                                        {2700}in(c, (em2_3089: bitstring,sigM2_3090: bitstring));
                                        {2701}let m2_3091: bitstring = dec(em2_3089,skCli_2990) in
                                        {2702}if (verify(h(m2_3091),sigM2_3090,pkSess_3084) <> true) then
                                            0
                                        else
                                            {2703}let (=OpenSecureChannelResponse,Ns_3092: bitstring,ST_3093: bitstring,TTL_3094: bitstring) = m2_3091 in
                                            {2704}let Kcli_3095: bitstring = h((Nc_3087,Ns_3092)) in
                                            {2705}out(c, senc(mCli(pkCli_2991,pkSess_3084),Kcli_3095))
                                    )
                                    else
                                        {2706}let v_3096: bool = (Sess = B) in
                                        (
                                            {2707}if v_3096 then
                                            (
                                                {2708}let pkSess_3097: bitstring = pub(skB) in
                                                {2709}out(c, GetEndpointRequest);
                                                {2710}in(c, (=GetEndpointResponse,=pkSess_3097,=SignAndEncrypt,SP_3098: bitstring,UP_3099: bitstring));
                                                {2711}new Nc_3100: bitstring;
                                                {2712}let m1_3101: bitstring = (OpenSecureChannelRequest,pkCli_2991,Nc_3100) in
                                                {2713}out(c, (pkCli_2991,enc(m1_3101,pkSess_3097),sign(h(m1_3101),skCli_2990)));
                                                {2714}in(c, (em2_3102: bitstring,sigM2_3103: bitstring));
                                                {2715}let m2_3104: bitstring = dec(em2_3102,skCli_2990) in
                                                {2716}if (verify(h(m2_3104),sigM2_3103,pkSess_3097) <> true) then
                                                    0
                                                else
                                                    {2717}let (=OpenSecureChannelResponse,Ns_3105: bitstring,ST_3106: bitstring,TTL_3107: bitstring) = m2_3104 in
                                                    {2718}let Kcli_3108: bitstring = h((Nc_3100,Ns_3105)) in
                                                    {2719}out(c, senc(mCli(pkCli_2991,pkSess_3097),Kcli_3108))
                                            )
                                            else
                                                {2720}let v_3109: bool = (Sess = C) in
                                                (
                                                    {2721}if v_3109 then
                                                    (
                                                        {2722}let pkSess_3110: bitstring = pub(skC) in
                                                        {2723}out(c, GetEndpointRequest);
                                                        {2724}in(c, (=GetEndpointResponse,=pkSess_3110,=SignAndEncrypt,SP_3111: bitstring,UP_3112: bitstring));
                                                        {2725}new Nc_3113: bitstring;
                                                        {2726}let m1_3114: bitstring = (OpenSecureChannelRequest,pkCli_2991,Nc_3113) in
                                                        {2727}out(c, (pkCli_2991,enc(m1_3114,pkSess_3110),sign(h(m1_3114),skCli_2990)));
                                                        {2728}in(c, (em2_3115: bitstring,sigM2_3116: bitstring));
                                                        {2729}let m2_3117: bitstring = dec(em2_3115,skCli_2990) in
                                                        {2730}if (verify(h(m2_3117),sigM2_3116,pkSess_3110) <> true) then
                                                            0
                                                        else
                                                            {2731}let (=OpenSecureChannelResponse,Ns_3118: bitstring,ST_3119: bitstring,TTL_3120: bitstring) = m2_3117 in
                                                            {2732}let Kcli_3121: bitstring = h((Nc_3113,Ns_3118)) in
                                                            {2733}out(c, senc(mCli(pkCli_2991,pkSess_3110),Kcli_3121))
                                                    )
                                                    else
                                                        {2734}let pkSess_3122: bitstring = pub(sk(Sess)) in
                                                        {2735}out(c, GetEndpointRequest);
                                                        {2736}in(c, (=GetEndpointResponse,=pkSess_3122,=SignAndEncrypt,SP_3123: bitstring,UP_3124: bitstring));
                                                        {2737}new Nc_3125: bitstring;
                                                        {2738}let m1_3126: bitstring = (OpenSecureChannelRequest,pkCli_2991,Nc_3125) in
                                                        {2739}out(c, (pkCli_2991,enc(m1_3126,pkSess_3122),sign(h(m1_3126),skCli_2990)));
                                                        {2740}in(c, (em2_3127: bitstring,sigM2_3128: bitstring));
                                                        {2741}let m2_3129: bitstring = dec(em2_3127,skCli_2990) in
                                                        {2742}if (verify(h(m2_3129),sigM2_3128,pkSess_3122) <> true) then
                                                            0
                                                        else
                                                            {2743}let (=OpenSecureChannelResponse,Ns_3130: bitstring,ST_3131: bitstring,TTL_3132: bitstring) = m2_3129 in
                                                            {2744}let Kcli_3133: bitstring = h((Nc_3125,Ns_3130)) in
                                                            {2745}out(c, senc(mCli(pkCli_2991,pkSess_3122),Kcli_3133))
                                                )
                                                else
                                                    {2746}let pkSess_3134: bitstring = fail-any in
                                                    {2747}out(c, GetEndpointRequest);
                                                    {2748}in(c, (=GetEndpointResponse,=pkSess_3134,=SignAndEncrypt,SP_3135: bitstring,UP_3136: bitstring));
                                                    {2749}new Nc_3137: bitstring;
                                                    {2750}let m1_3138: bitstring = (OpenSecureChannelRequest,pkCli_2991,Nc_3137) in
                                                    {2751}out(c, (pkCli_2991,enc(m1_3138,pkSess_3134),sign(h(m1_3138),skCli_2990)));
                                                    {2752}in(c, (em2_3139: bitstring,sigM2_3140: bitstring));
                                                    {2753}let m2_3141: bitstring = dec(em2_3139,skCli_2990) in
                                                    {2754}if (verify(h(m2_3141),sigM2_3140,pkSess_3134) <> true) then
                                                        0
                                                    else
                                                        {2755}let (=OpenSecureChannelResponse,Ns_3142: bitstring,ST_3143: bitstring,TTL_3144: bitstring) = m2_3141 in
                                                        {2756}let Kcli_3145: bitstring = h((Nc_3137,Ns_3142)) in
                                                        {2757}out(c, senc(mCli(pkCli_2991,pkSess_3134),Kcli_3145))
                                        )
                                        else
                                            {2758}let pkSess_3146: bitstring = fail-any in
                                            {2759}out(c, GetEndpointRequest);
                                            {2760}in(c, (=GetEndpointResponse,=pkSess_3146,=SignAndEncrypt,SP_3147: bitstring,UP_3148: bitstring));
                                            {2761}new Nc_3149: bitstring;
                                            {2762}let m1_3150: bitstring = (OpenSecureChannelRequest,pkCli_2991,Nc_3149) in
                                            {2763}out(c, (pkCli_2991,enc(m1_3150,pkSess_3146),sign(h(m1_3150),skCli_2990)));
                                            {2764}in(c, (em2_3151: bitstring,sigM2_3152: bitstring));
                                            {2765}let m2_3153: bitstring = dec(em2_3151,skCli_2990) in
                                            {2766}if (verify(h(m2_3153),sigM2_3152,pkSess_3146) <> true) then
                                                0
                                            else
                                                {2767}let (=OpenSecureChannelResponse,Ns_3154: bitstring,ST_3155: bitstring,TTL_3156: bitstring) = m2_3153 in
                                                {2768}let Kcli_3157: bitstring = h((Nc_3149,Ns_3154)) in
                                                {2769}out(c, senc(mCli(pkCli_2991,pkSess_3146),Kcli_3157))
                                )
                                else
                                    {2770}let pkSess_3158: bitstring = fail-any in
                                    {2771}out(c, GetEndpointRequest);
                                    {2772}in(c, (=GetEndpointResponse,=pkSess_3158,=SignAndEncrypt,SP_3159: bitstring,UP_3160: bitstring));
                                    {2773}new Nc_3161: bitstring;
                                    {2774}let m1_3162: bitstring = (OpenSecureChannelRequest,pkCli_2991,Nc_3161) in
                                    {2775}out(c, (pkCli_2991,enc(m1_3162,pkSess_3158),sign(h(m1_3162),skCli_2990)));
                                    {2776}in(c, (em2_3163: bitstring,sigM2_3164: bitstring));
                                    {2777}let m2_3165: bitstring = dec(em2_3163,skCli_2990) in
                                    {2778}if (verify(h(m2_3165),sigM2_3164,pkSess_3158) <> true) then
                                        0
                                    else
                                        {2779}let (=OpenSecureChannelResponse,Ns_3166: bitstring,ST_3167: bitstring,TTL_3168: bitstring) = m2_3165 in
                                        {2780}let Kcli_3169: bitstring = h((Nc_3161,Ns_3166)) in
                                        {2781}out(c, senc(mCli(pkCli_2991,pkSess_3158),Kcli_3169))
                            )
                            else
                                {2782}let v_3170: bool = (Disco = C) in
                                (
                                    {2783}if v_3170 then
                                    (
                                        {2784}let pkDisco_3171: bitstring = pub(skC) in
                                        {2785}let v_3172: bool = (Sess = A) in
                                        (
                                            {2786}if v_3172 then
                                            (
                                                {2787}let pkSess_3173: bitstring = pub(skA) in
                                                {2788}out(c, GetEndpointRequest);
                                                {2789}in(c, (=GetEndpointResponse,=pkSess_3173,=SignAndEncrypt,SP_3174: bitstring,UP_3175: bitstring));
                                                {2790}new Nc_3176: bitstring;
                                                {2791}let m1_3177: bitstring = (OpenSecureChannelRequest,pkCli_2991,Nc_3176) in
                                                {2792}out(c, (pkCli_2991,enc(m1_3177,pkSess_3173),sign(h(m1_3177),skCli_2990)));
                                                {2793}in(c, (em2_3178: bitstring,sigM2_3179: bitstring));
                                                {2794}let m2_3180: bitstring = dec(em2_3178,skCli_2990) in
                                                {2795}if (verify(h(m2_3180),sigM2_3179,pkSess_3173) <> true) then
                                                    0
                                                else
                                                    {2796}let (=OpenSecureChannelResponse,Ns_3181: bitstring,ST_3182: bitstring,TTL_3183: bitstring) = m2_3180 in
                                                    {2797}let Kcli_3184: bitstring = h((Nc_3176,Ns_3181)) in
                                                    {2798}out(c, senc(mCli(pkCli_2991,pkSess_3173),Kcli_3184))
                                            )
                                            else
                                                {2799}let v_3185: bool = (Sess = B) in
                                                (
                                                    {2800}if v_3185 then
                                                    (
                                                        {2801}let pkSess_3186: bitstring = pub(skB) in
                                                        {2802}out(c, GetEndpointRequest);
                                                        {2803}in(c, (=GetEndpointResponse,=pkSess_3186,=SignAndEncrypt,SP_3187: bitstring,UP_3188: bitstring));
                                                        {2804}new Nc_3189: bitstring;
                                                        {2805}let m1_3190: bitstring = (OpenSecureChannelRequest,pkCli_2991,Nc_3189) in
                                                        {2806}out(c, (pkCli_2991,enc(m1_3190,pkSess_3186),sign(h(m1_3190),skCli_2990)));
                                                        {2807}in(c, (em2_3191: bitstring,sigM2_3192: bitstring));
                                                        {2808}let m2_3193: bitstring = dec(em2_3191,skCli_2990) in
                                                        {2809}if (verify(h(m2_3193),sigM2_3192,pkSess_3186) <> true) then
                                                            0
                                                        else
                                                            {2810}let (=OpenSecureChannelResponse,Ns_3194: bitstring,ST_3195: bitstring,TTL_3196: bitstring) = m2_3193 in
                                                            {2811}let Kcli_3197: bitstring = h((Nc_3189,Ns_3194)) in
                                                            {2812}out(c, senc(mCli(pkCli_2991,pkSess_3186),Kcli_3197))
                                                    )
                                                    else
                                                        {2813}let v_3198: bool = (Sess = C) in
                                                        (
                                                            {2814}if v_3198 then
                                                            (
                                                                {2815}let pkSess_3199: bitstring = pub(skC) in
                                                                {2816}out(c, GetEndpointRequest);
                                                                {2817}in(c, (=GetEndpointResponse,=pkSess_3199,=SignAndEncrypt,SP_3200: bitstring,UP_3201: bitstring));
                                                                {2818}new Nc_3202: bitstring;
                                                                {2819}let m1_3203: bitstring = (OpenSecureChannelRequest,pkCli_2991,Nc_3202) in
                                                                {2820}out(c, (pkCli_2991,enc(m1_3203,pkSess_3199),sign(h(m1_3203),skCli_2990)));
                                                                {2821}in(c, (em2_3204: bitstring,sigM2_3205: bitstring));
                                                                {2822}let m2_3206: bitstring = dec(em2_3204,skCli_2990) in
                                                                {2823}if (verify(h(m2_3206),sigM2_3205,pkSess_3199) <> true) then
                                                                    0
                                                                else
                                                                    {2824}let (=OpenSecureChannelResponse,Ns_3207: bitstring,ST_3208: bitstring,TTL_3209: bitstring) = m2_3206 in
                                                                    {2825}let Kcli_3210: bitstring = h((Nc_3202,Ns_3207)) in
                                                                    {2826}out(c, senc(mCli(pkCli_2991,pkSess_3199),Kcli_3210))
                                                            )
                                                            else
                                                                {2827}let pkSess_3211: bitstring = pub(sk(Sess)) in
                                                                {2828}out(c, GetEndpointRequest);
                                                                {2829}in(c, (=GetEndpointResponse,=pkSess_3211,=SignAndEncrypt,SP_3212: bitstring,UP_3213: bitstring));
                                                                {2830}new Nc_3214: bitstring;
                                                                {2831}let m1_3215: bitstring = (OpenSecureChannelRequest,pkCli_2991,Nc_3214) in
                                                                {2832}out(c, (pkCli_2991,enc(m1_3215,pkSess_3211),sign(h(m1_3215),skCli_2990)));
                                                                {2833}in(c, (em2_3216: bitstring,sigM2_3217: bitstring));
                                                                {2834}let m2_3218: bitstring = dec(em2_3216,skCli_2990) in
                                                                {2835}if (verify(h(m2_3218),sigM2_3217,pkSess_3211) <> true) then
                                                                    0
                                                                else
                                                                    {2836}let (=OpenSecureChannelResponse,Ns_3219: bitstring,ST_3220: bitstring,TTL_3221: bitstring) = m2_3218 in
                                                                    {2837}let Kcli_3222: bitstring = h((Nc_3214,Ns_3219)) in
                                                                    {2838}out(c, senc(mCli(pkCli_2991,pkSess_3211),Kcli_3222))
                                                        )
                                                        else
                                                            {2839}let pkSess_3223: bitstring = fail-any in
                                                            {2840}out(c, GetEndpointRequest);
                                                            {2841}in(c, (=GetEndpointResponse,=pkSess_3223,=SignAndEncrypt,SP_3224: bitstring,UP_3225: bitstring));
                                                            {2842}new Nc_3226: bitstring;
                                                            {2843}let m1_3227: bitstring = (OpenSecureChannelRequest,pkCli_2991,Nc_3226) in
                                                            {2844}out(c, (pkCli_2991,enc(m1_3227,pkSess_3223),sign(h(m1_3227),skCli_2990)));
                                                            {2845}in(c, (em2_3228: bitstring,sigM2_3229: bitstring));
                                                            {2846}let m2_3230: bitstring = dec(em2_3228,skCli_2990) in
                                                            {2847}if (verify(h(m2_3230),sigM2_3229,pkSess_3223) <> true) then
                                                                0
                                                            else
                                                                {2848}let (=OpenSecureChannelResponse,Ns_3231: bitstring,ST_3232: bitstring,TTL_3233: bitstring) = m2_3230 in
                                                                {2849}let Kcli_3234: bitstring = h((Nc_3226,Ns_3231)) in
                                                                {2850}out(c, senc(mCli(pkCli_2991,pkSess_3223),Kcli_3234))
                                                )
                                                else
                                                    {2851}let pkSess_3235: bitstring = fail-any in
                                                    {2852}out(c, GetEndpointRequest);
                                                    {2853}in(c, (=GetEndpointResponse,=pkSess_3235,=SignAndEncrypt,SP_3236: bitstring,UP_3237: bitstring));
                                                    {2854}new Nc_3238: bitstring;
                                                    {2855}let m1_3239: bitstring = (OpenSecureChannelRequest,pkCli_2991,Nc_3238) in
                                                    {2856}out(c, (pkCli_2991,enc(m1_3239,pkSess_3235),sign(h(m1_3239),skCli_2990)));
                                                    {2857}in(c, (em2_3240: bitstring,sigM2_3241: bitstring));
                                                    {2858}let m2_3242: bitstring = dec(em2_3240,skCli_2990) in
                                                    {2859}if (verify(h(m2_3242),sigM2_3241,pkSess_3235) <> true) then
                                                        0
                                                    else
                                                        {2860}let (=OpenSecureChannelResponse,Ns_3243: bitstring,ST_3244: bitstring,TTL_3245: bitstring) = m2_3242 in
                                                        {2861}let Kcli_3246: bitstring = h((Nc_3238,Ns_3243)) in
                                                        {2862}out(c, senc(mCli(pkCli_2991,pkSess_3235),Kcli_3246))
                                        )
                                        else
                                            {2863}let pkSess_3247: bitstring = fail-any in
                                            {2864}out(c, GetEndpointRequest);
                                            {2865}in(c, (=GetEndpointResponse,=pkSess_3247,=SignAndEncrypt,SP_3248: bitstring,UP_3249: bitstring));
                                            {2866}new Nc_3250: bitstring;
                                            {2867}let m1_3251: bitstring = (OpenSecureChannelRequest,pkCli_2991,Nc_3250) in
                                            {2868}out(c, (pkCli_2991,enc(m1_3251,pkSess_3247),sign(h(m1_3251),skCli_2990)));
                                            {2869}in(c, (em2_3252: bitstring,sigM2_3253: bitstring));
                                            {2870}let m2_3254: bitstring = dec(em2_3252,skCli_2990) in
                                            {2871}if (verify(h(m2_3254),sigM2_3253,pkSess_3247) <> true) then
                                                0
                                            else
                                                {2872}let (=OpenSecureChannelResponse,Ns_3255: bitstring,ST_3256: bitstring,TTL_3257: bitstring) = m2_3254 in
                                                {2873}let Kcli_3258: bitstring = h((Nc_3250,Ns_3255)) in
                                                {2874}out(c, senc(mCli(pkCli_2991,pkSess_3247),Kcli_3258))
                                    )
                                    else
                                        {2875}let pkDisco_3259: bitstring = pub(sk(Disco)) in
                                        {2876}let v_3260: bool = (Sess = A) in
                                        (
                                            {2877}if v_3260 then
                                            (
                                                {2878}let pkSess_3261: bitstring = pub(skA) in
                                                {2879}out(c, GetEndpointRequest);
                                                {2880}in(c, (=GetEndpointResponse,=pkSess_3261,=SignAndEncrypt,SP_3262: bitstring,UP_3263: bitstring));
                                                {2881}new Nc_3264: bitstring;
                                                {2882}let m1_3265: bitstring = (OpenSecureChannelRequest,pkCli_2991,Nc_3264) in
                                                {2883}out(c, (pkCli_2991,enc(m1_3265,pkSess_3261),sign(h(m1_3265),skCli_2990)));
                                                {2884}in(c, (em2_3266: bitstring,sigM2_3267: bitstring));
                                                {2885}let m2_3268: bitstring = dec(em2_3266,skCli_2990) in
                                                {2886}if (verify(h(m2_3268),sigM2_3267,pkSess_3261) <> true) then
                                                    0
                                                else
                                                    {2887}let (=OpenSecureChannelResponse,Ns_3269: bitstring,ST_3270: bitstring,TTL_3271: bitstring) = m2_3268 in
                                                    {2888}let Kcli_3272: bitstring = h((Nc_3264,Ns_3269)) in
                                                    {2889}out(c, senc(mCli(pkCli_2991,pkSess_3261),Kcli_3272))
                                            )
                                            else
                                                {2890}let v_3273: bool = (Sess = B) in
                                                (
                                                    {2891}if v_3273 then
                                                    (
                                                        {2892}let pkSess_3274: bitstring = pub(skB) in
                                                        {2893}out(c, GetEndpointRequest);
                                                        {2894}in(c, (=GetEndpointResponse,=pkSess_3274,=SignAndEncrypt,SP_3275: bitstring,UP_3276: bitstring));
                                                        {2895}new Nc_3277: bitstring;
                                                        {2896}let m1_3278: bitstring = (OpenSecureChannelRequest,pkCli_2991,Nc_3277) in
                                                        {2897}out(c, (pkCli_2991,enc(m1_3278,pkSess_3274),sign(h(m1_3278),skCli_2990)));
                                                        {2898}in(c, (em2_3279: bitstring,sigM2_3280: bitstring));
                                                        {2899}let m2_3281: bitstring = dec(em2_3279,skCli_2990) in
                                                        {2900}if (verify(h(m2_3281),sigM2_3280,pkSess_3274) <> true) then
                                                            0
                                                        else
                                                            {2901}let (=OpenSecureChannelResponse,Ns_3282: bitstring,ST_3283: bitstring,TTL_3284: bitstring) = m2_3281 in
                                                            {2902}let Kcli_3285: bitstring = h((Nc_3277,Ns_3282)) in
                                                            {2903}out(c, senc(mCli(pkCli_2991,pkSess_3274),Kcli_3285))
                                                    )
                                                    else
                                                        {2904}let v_3286: bool = (Sess = C) in
                                                        (
                                                            {2905}if v_3286 then
                                                            (
                                                                {2906}let pkSess_3287: bitstring = pub(skC) in
                                                                {2907}out(c, GetEndpointRequest);
                                                                {2908}in(c, (=GetEndpointResponse,=pkSess_3287,=SignAndEncrypt,SP_3288: bitstring,UP_3289: bitstring));
                                                                {2909}new Nc_3290: bitstring;
                                                                {2910}let m1_3291: bitstring = (OpenSecureChannelRequest,pkCli_2991,Nc_3290) in
                                                                {2911}out(c, (pkCli_2991,enc(m1_3291,pkSess_3287),sign(h(m1_3291),skCli_2990)));
                                                                {2912}in(c, (em2_3292: bitstring,sigM2_3293: bitstring));
                                                                {2913}let m2_3294: bitstring = dec(em2_3292,skCli_2990) in
                                                                {2914}if (verify(h(m2_3294),sigM2_3293,pkSess_3287) <> true) then
                                                                    0
                                                                else
                                                                    {2915}let (=OpenSecureChannelResponse,Ns_3295: bitstring,ST_3296: bitstring,TTL_3297: bitstring) = m2_3294 in
                                                                    {2916}let Kcli_3298: bitstring = h((Nc_3290,Ns_3295)) in
                                                                    {2917}out(c, senc(mCli(pkCli_2991,pkSess_3287),Kcli_3298))
                                                            )
                                                            else
                                                                {2918}let pkSess_3299: bitstring = pub(sk(Sess)) in
                                                                {2919}out(c, GetEndpointRequest);
                                                                {2920}in(c, (=GetEndpointResponse,=pkSess_3299,=SignAndEncrypt,SP_3300: bitstring,UP_3301: bitstring));
                                                                {2921}new Nc_3302: bitstring;
                                                                {2922}let m1_3303: bitstring = (OpenSecureChannelRequest,pkCli_2991,Nc_3302) in
                                                                {2923}out(c, (pkCli_2991,enc(m1_3303,pkSess_3299),sign(h(m1_3303),skCli_2990)));
                                                                {2924}in(c, (em2_3304: bitstring,sigM2_3305: bitstring));
                                                                {2925}let m2_3306: bitstring = dec(em2_3304,skCli_2990) in
                                                                {2926}if (verify(h(m2_3306),sigM2_3305,pkSess_3299) <> true) then
                                                                    0
                                                                else
                                                                    {2927}let (=OpenSecureChannelResponse,Ns_3307: bitstring,ST_3308: bitstring,TTL_3309: bitstring) = m2_3306 in
                                                                    {2928}let Kcli_3310: bitstring = h((Nc_3302,Ns_3307)) in
                                                                    {2929}out(c, senc(mCli(pkCli_2991,pkSess_3299),Kcli_3310))
                                                        )
                                                        else
                                                            {2930}let pkSess_3311: bitstring = fail-any in
                                                            {2931}out(c, GetEndpointRequest);
                                                            {2932}in(c, (=GetEndpointResponse,=pkSess_3311,=SignAndEncrypt,SP_3312: bitstring,UP_3313: bitstring));
                                                            {2933}new Nc_3314: bitstring;
                                                            {2934}let m1_3315: bitstring = (OpenSecureChannelRequest,pkCli_2991,Nc_3314) in
                                                            {2935}out(c, (pkCli_2991,enc(m1_3315,pkSess_3311),sign(h(m1_3315),skCli_2990)));
                                                            {2936}in(c, (em2_3316: bitstring,sigM2_3317: bitstring));
                                                            {2937}let m2_3318: bitstring = dec(em2_3316,skCli_2990) in
                                                            {2938}if (verify(h(m2_3318),sigM2_3317,pkSess_3311) <> true) then
                                                                0
                                                            else
                                                                {2939}let (=OpenSecureChannelResponse,Ns_3319: bitstring,ST_3320: bitstring,TTL_3321: bitstring) = m2_3318 in
                                                                {2940}let Kcli_3322: bitstring = h((Nc_3314,Ns_3319)) in
                                                                {2941}out(c, senc(mCli(pkCli_2991,pkSess_3311),Kcli_3322))
                                                )
                                                else
                                                    {2942}let pkSess_3323: bitstring = fail-any in
                                                    {2943}out(c, GetEndpointRequest);
                                                    {2944}in(c, (=GetEndpointResponse,=pkSess_3323,=SignAndEncrypt,SP_3324: bitstring,UP_3325: bitstring));
                                                    {2945}new Nc_3326: bitstring;
                                                    {2946}let m1_3327: bitstring = (OpenSecureChannelRequest,pkCli_2991,Nc_3326) in
                                                    {2947}out(c, (pkCli_2991,enc(m1_3327,pkSess_3323),sign(h(m1_3327),skCli_2990)));
                                                    {2948}in(c, (em2_3328: bitstring,sigM2_3329: bitstring));
                                                    {2949}let m2_3330: bitstring = dec(em2_3328,skCli_2990) in
                                                    {2950}if (verify(h(m2_3330),sigM2_3329,pkSess_3323) <> true) then
                                                        0
                                                    else
                                                        {2951}let (=OpenSecureChannelResponse,Ns_3331: bitstring,ST_3332: bitstring,TTL_3333: bitstring) = m2_3330 in
                                                        {2952}let Kcli_3334: bitstring = h((Nc_3326,Ns_3331)) in
                                                        {2953}out(c, senc(mCli(pkCli_2991,pkSess_3323),Kcli_3334))
                                        )
                                        else
                                            {2954}let pkSess_3335: bitstring = fail-any in
                                            {2955}out(c, GetEndpointRequest);
                                            {2956}in(c, (=GetEndpointResponse,=pkSess_3335,=SignAndEncrypt,SP_3336: bitstring,UP_3337: bitstring));
                                            {2957}new Nc_3338: bitstring;
                                            {2958}let m1_3339: bitstring = (OpenSecureChannelRequest,pkCli_2991,Nc_3338) in
                                            {2959}out(c, (pkCli_2991,enc(m1_3339,pkSess_3335),sign(h(m1_3339),skCli_2990)));
                                            {2960}in(c, (em2_3340: bitstring,sigM2_3341: bitstring));
                                            {2961}let m2_3342: bitstring = dec(em2_3340,skCli_2990) in
                                            {2962}if (verify(h(m2_3342),sigM2_3341,pkSess_3335) <> true) then
                                                0
                                            else
                                                {2963}let (=OpenSecureChannelResponse,Ns_3343: bitstring,ST_3344: bitstring,TTL_3345: bitstring) = m2_3342 in
                                                {2964}let Kcli_3346: bitstring = h((Nc_3338,Ns_3343)) in
                                                {2965}out(c, senc(mCli(pkCli_2991,pkSess_3335),Kcli_3346))
                                )
                                else
                                    {2966}let pkDisco_3347: bitstring = fail-any in
                                    {2967}let v_3348: bool = (Sess = A) in
                                    (
                                        {2968}if v_3348 then
                                        (
                                            {2969}let pkSess_3349: bitstring = pub(skA) in
                                            {2970}out(c, GetEndpointRequest);
                                            {2971}in(c, (=GetEndpointResponse,=pkSess_3349,=SignAndEncrypt,SP_3350: bitstring,UP_3351: bitstring));
                                            {2972}new Nc_3352: bitstring;
                                            {2973}let m1_3353: bitstring = (OpenSecureChannelRequest,pkCli_2991,Nc_3352) in
                                            {2974}out(c, (pkCli_2991,enc(m1_3353,pkSess_3349),sign(h(m1_3353),skCli_2990)));
                                            {2975}in(c, (em2_3354: bitstring,sigM2_3355: bitstring));
                                            {2976}let m2_3356: bitstring = dec(em2_3354,skCli_2990) in
                                            {2977}if (verify(h(m2_3356),sigM2_3355,pkSess_3349) <> true) then
                                                0
                                            else
                                                {2978}let (=OpenSecureChannelResponse,Ns_3357: bitstring,ST_3358: bitstring,TTL_3359: bitstring) = m2_3356 in
                                                {2979}let Kcli_3360: bitstring = h((Nc_3352,Ns_3357)) in
                                                {2980}out(c, senc(mCli(pkCli_2991,pkSess_3349),Kcli_3360))
                                        )
                                        else
                                            {2981}let v_3361: bool = (Sess = B) in
                                            (
                                                {2982}if v_3361 then
                                                (
                                                    {2983}let pkSess_3362: bitstring = pub(skB) in
                                                    {2984}out(c, GetEndpointRequest);
                                                    {2985}in(c, (=GetEndpointResponse,=pkSess_3362,=SignAndEncrypt,SP_3363: bitstring,UP_3364: bitstring));
                                                    {2986}new Nc_3365: bitstring;
                                                    {2987}let m1_3366: bitstring = (OpenSecureChannelRequest,pkCli_2991,Nc_3365) in
                                                    {2988}out(c, (pkCli_2991,enc(m1_3366,pkSess_3362),sign(h(m1_3366),skCli_2990)));
                                                    {2989}in(c, (em2_3367: bitstring,sigM2_3368: bitstring));
                                                    {2990}let m2_3369: bitstring = dec(em2_3367,skCli_2990) in
                                                    {2991}if (verify(h(m2_3369),sigM2_3368,pkSess_3362) <> true) then
                                                        0
                                                    else
                                                        {2992}let (=OpenSecureChannelResponse,Ns_3370: bitstring,ST_3371: bitstring,TTL_3372: bitstring) = m2_3369 in
                                                        {2993}let Kcli_3373: bitstring = h((Nc_3365,Ns_3370)) in
                                                        {2994}out(c, senc(mCli(pkCli_2991,pkSess_3362),Kcli_3373))
                                                )
                                                else
                                                    {2995}let v_3374: bool = (Sess = C) in
                                                    (
                                                        {2996}if v_3374 then
                                                        (
                                                            {2997}let pkSess_3375: bitstring = pub(skC) in
                                                            {2998}out(c, GetEndpointRequest);
                                                            {2999}in(c, (=GetEndpointResponse,=pkSess_3375,=SignAndEncrypt,SP_3376: bitstring,UP_3377: bitstring));
                                                            {3000}new Nc_3378: bitstring;
                                                            {3001}let m1_3379: bitstring = (OpenSecureChannelRequest,pkCli_2991,Nc_3378) in
                                                            {3002}out(c, (pkCli_2991,enc(m1_3379,pkSess_3375),sign(h(m1_3379),skCli_2990)));
                                                            {3003}in(c, (em2_3380: bitstring,sigM2_3381: bitstring));
                                                            {3004}let m2_3382: bitstring = dec(em2_3380,skCli_2990) in
                                                            {3005}if (verify(h(m2_3382),sigM2_3381,pkSess_3375) <> true) then
                                                                0
                                                            else
                                                                {3006}let (=OpenSecureChannelResponse,Ns_3383: bitstring,ST_3384: bitstring,TTL_3385: bitstring) = m2_3382 in
                                                                {3007}let Kcli_3386: bitstring = h((Nc_3378,Ns_3383)) in
                                                                {3008}out(c, senc(mCli(pkCli_2991,pkSess_3375),Kcli_3386))
                                                        )
                                                        else
                                                            {3009}let pkSess_3387: bitstring = pub(sk(Sess)) in
                                                            {3010}out(c, GetEndpointRequest);
                                                            {3011}in(c, (=GetEndpointResponse,=pkSess_3387,=SignAndEncrypt,SP_3388: bitstring,UP_3389: bitstring));
                                                            {3012}new Nc_3390: bitstring;
                                                            {3013}let m1_3391: bitstring = (OpenSecureChannelRequest,pkCli_2991,Nc_3390) in
                                                            {3014}out(c, (pkCli_2991,enc(m1_3391,pkSess_3387),sign(h(m1_3391),skCli_2990)));
                                                            {3015}in(c, (em2_3392: bitstring,sigM2_3393: bitstring));
                                                            {3016}let m2_3394: bitstring = dec(em2_3392,skCli_2990) in
                                                            {3017}if (verify(h(m2_3394),sigM2_3393,pkSess_3387) <> true) then
                                                                0
                                                            else
                                                                {3018}let (=OpenSecureChannelResponse,Ns_3395: bitstring,ST_3396: bitstring,TTL_3397: bitstring) = m2_3394 in
                                                                {3019}let Kcli_3398: bitstring = h((Nc_3390,Ns_3395)) in
                                                                {3020}out(c, senc(mCli(pkCli_2991,pkSess_3387),Kcli_3398))
                                                    )
                                                    else
                                                        {3021}let pkSess_3399: bitstring = fail-any in
                                                        {3022}out(c, GetEndpointRequest);
                                                        {3023}in(c, (=GetEndpointResponse,=pkSess_3399,=SignAndEncrypt,SP_3400: bitstring,UP_3401: bitstring));
                                                        {3024}new Nc_3402: bitstring;
                                                        {3025}let m1_3403: bitstring = (OpenSecureChannelRequest,pkCli_2991,Nc_3402) in
                                                        {3026}out(c, (pkCli_2991,enc(m1_3403,pkSess_3399),sign(h(m1_3403),skCli_2990)));
                                                        {3027}in(c, (em2_3404: bitstring,sigM2_3405: bitstring));
                                                        {3028}let m2_3406: bitstring = dec(em2_3404,skCli_2990) in
                                                        {3029}if (verify(h(m2_3406),sigM2_3405,pkSess_3399) <> true) then
                                                            0
                                                        else
                                                            {3030}let (=OpenSecureChannelResponse,Ns_3407: bitstring,ST_3408: bitstring,TTL_3409: bitstring) = m2_3406 in
                                                            {3031}let Kcli_3410: bitstring = h((Nc_3402,Ns_3407)) in
                                                            {3032}out(c, senc(mCli(pkCli_2991,pkSess_3399),Kcli_3410))
                                            )
                                            else
                                                {3033}let pkSess_3411: bitstring = fail-any in
                                                {3034}out(c, GetEndpointRequest);
                                                {3035}in(c, (=GetEndpointResponse,=pkSess_3411,=SignAndEncrypt,SP_3412: bitstring,UP_3413: bitstring));
                                                {3036}new Nc_3414: bitstring;
                                                {3037}let m1_3415: bitstring = (OpenSecureChannelRequest,pkCli_2991,Nc_3414) in
                                                {3038}out(c, (pkCli_2991,enc(m1_3415,pkSess_3411),sign(h(m1_3415),skCli_2990)));
                                                {3039}in(c, (em2_3416: bitstring,sigM2_3417: bitstring));
                                                {3040}let m2_3418: bitstring = dec(em2_3416,skCli_2990) in
                                                {3041}if (verify(h(m2_3418),sigM2_3417,pkSess_3411) <> true) then
                                                    0
                                                else
                                                    {3042}let (=OpenSecureChannelResponse,Ns_3419: bitstring,ST_3420: bitstring,TTL_3421: bitstring) = m2_3418 in
                                                    {3043}let Kcli_3422: bitstring = h((Nc_3414,Ns_3419)) in
                                                    {3044}out(c, senc(mCli(pkCli_2991,pkSess_3411),Kcli_3422))
                                    )
                                    else
                                        {3045}let pkSess_3423: bitstring = fail-any in
                                        {3046}out(c, GetEndpointRequest);
                                        {3047}in(c, (=GetEndpointResponse,=pkSess_3423,=SignAndEncrypt,SP_3424: bitstring,UP_3425: bitstring));
                                        {3048}new Nc_3426: bitstring;
                                        {3049}let m1_3427: bitstring = (OpenSecureChannelRequest,pkCli_2991,Nc_3426) in
                                        {3050}out(c, (pkCli_2991,enc(m1_3427,pkSess_3423),sign(h(m1_3427),skCli_2990)));
                                        {3051}in(c, (em2_3428: bitstring,sigM2_3429: bitstring));
                                        {3052}let m2_3430: bitstring = dec(em2_3428,skCli_2990) in
                                        {3053}if (verify(h(m2_3430),sigM2_3429,pkSess_3423) <> true) then
                                            0
                                        else
                                            {3054}let (=OpenSecureChannelResponse,Ns_3431: bitstring,ST_3432: bitstring,TTL_3433: bitstring) = m2_3430 in
                                            {3055}let Kcli_3434: bitstring = h((Nc_3426,Ns_3431)) in
                                            {3056}out(c, senc(mCli(pkCli_2991,pkSess_3423),Kcli_3434))
                        )
                        else
                            {3057}let pkDisco_3435: bitstring = fail-any in
                            {3058}let v_3436: bool = (Sess = A) in
                            (
                                {3059}if v_3436 then
                                (
                                    {3060}let pkSess_3437: bitstring = pub(skA) in
                                    {3061}out(c, GetEndpointRequest);
                                    {3062}in(c, (=GetEndpointResponse,=pkSess_3437,=SignAndEncrypt,SP_3438: bitstring,UP_3439: bitstring));
                                    {3063}new Nc_3440: bitstring;
                                    {3064}let m1_3441: bitstring = (OpenSecureChannelRequest,pkCli_2991,Nc_3440) in
                                    {3065}out(c, (pkCli_2991,enc(m1_3441,pkSess_3437),sign(h(m1_3441),skCli_2990)));
                                    {3066}in(c, (em2_3442: bitstring,sigM2_3443: bitstring));
                                    {3067}let m2_3444: bitstring = dec(em2_3442,skCli_2990) in
                                    {3068}if (verify(h(m2_3444),sigM2_3443,pkSess_3437) <> true) then
                                        0
                                    else
                                        {3069}let (=OpenSecureChannelResponse,Ns_3445: bitstring,ST_3446: bitstring,TTL_3447: bitstring) = m2_3444 in
                                        {3070}let Kcli_3448: bitstring = h((Nc_3440,Ns_3445)) in
                                        {3071}out(c, senc(mCli(pkCli_2991,pkSess_3437),Kcli_3448))
                                )
                                else
                                    {3072}let v_3449: bool = (Sess = B) in
                                    (
                                        {3073}if v_3449 then
                                        (
                                            {3074}let pkSess_3450: bitstring = pub(skB) in
                                            {3075}out(c, GetEndpointRequest);
                                            {3076}in(c, (=GetEndpointResponse,=pkSess_3450,=SignAndEncrypt,SP_3451: bitstring,UP_3452: bitstring));
                                            {3077}new Nc_3453: bitstring;
                                            {3078}let m1_3454: bitstring = (OpenSecureChannelRequest,pkCli_2991,Nc_3453) in
                                            {3079}out(c, (pkCli_2991,enc(m1_3454,pkSess_3450),sign(h(m1_3454),skCli_2990)));
                                            {3080}in(c, (em2_3455: bitstring,sigM2_3456: bitstring));
                                            {3081}let m2_3457: bitstring = dec(em2_3455,skCli_2990) in
                                            {3082}if (verify(h(m2_3457),sigM2_3456,pkSess_3450) <> true) then
                                                0
                                            else
                                                {3083}let (=OpenSecureChannelResponse,Ns_3458: bitstring,ST_3459: bitstring,TTL_3460: bitstring) = m2_3457 in
                                                {3084}let Kcli_3461: bitstring = h((Nc_3453,Ns_3458)) in
                                                {3085}out(c, senc(mCli(pkCli_2991,pkSess_3450),Kcli_3461))
                                        )
                                        else
                                            {3086}let v_3462: bool = (Sess = C) in
                                            (
                                                {3087}if v_3462 then
                                                (
                                                    {3088}let pkSess_3463: bitstring = pub(skC) in
                                                    {3089}out(c, GetEndpointRequest);
                                                    {3090}in(c, (=GetEndpointResponse,=pkSess_3463,=SignAndEncrypt,SP_3464: bitstring,UP_3465: bitstring));
                                                    {3091}new Nc_3466: bitstring;
                                                    {3092}let m1_3467: bitstring = (OpenSecureChannelRequest,pkCli_2991,Nc_3466) in
                                                    {3093}out(c, (pkCli_2991,enc(m1_3467,pkSess_3463),sign(h(m1_3467),skCli_2990)));
                                                    {3094}in(c, (em2_3468: bitstring,sigM2_3469: bitstring));
                                                    {3095}let m2_3470: bitstring = dec(em2_3468,skCli_2990) in
                                                    {3096}if (verify(h(m2_3470),sigM2_3469,pkSess_3463) <> true) then
                                                        0
                                                    else
                                                        {3097}let (=OpenSecureChannelResponse,Ns_3471: bitstring,ST_3472: bitstring,TTL_3473: bitstring) = m2_3470 in
                                                        {3098}let Kcli_3474: bitstring = h((Nc_3466,Ns_3471)) in
                                                        {3099}out(c, senc(mCli(pkCli_2991,pkSess_3463),Kcli_3474))
                                                )
                                                else
                                                    {3100}let pkSess_3475: bitstring = pub(sk(Sess)) in
                                                    {3101}out(c, GetEndpointRequest);
                                                    {3102}in(c, (=GetEndpointResponse,=pkSess_3475,=SignAndEncrypt,SP_3476: bitstring,UP_3477: bitstring));
                                                    {3103}new Nc_3478: bitstring;
                                                    {3104}let m1_3479: bitstring = (OpenSecureChannelRequest,pkCli_2991,Nc_3478) in
                                                    {3105}out(c, (pkCli_2991,enc(m1_3479,pkSess_3475),sign(h(m1_3479),skCli_2990)));
                                                    {3106}in(c, (em2_3480: bitstring,sigM2_3481: bitstring));
                                                    {3107}let m2_3482: bitstring = dec(em2_3480,skCli_2990) in
                                                    {3108}if (verify(h(m2_3482),sigM2_3481,pkSess_3475) <> true) then
                                                        0
                                                    else
                                                        {3109}let (=OpenSecureChannelResponse,Ns_3483: bitstring,ST_3484: bitstring,TTL_3485: bitstring) = m2_3482 in
                                                        {3110}let Kcli_3486: bitstring = h((Nc_3478,Ns_3483)) in
                                                        {3111}out(c, senc(mCli(pkCli_2991,pkSess_3475),Kcli_3486))
                                            )
                                            else
                                                {3112}let pkSess_3487: bitstring = fail-any in
                                                {3113}out(c, GetEndpointRequest);
                                                {3114}in(c, (=GetEndpointResponse,=pkSess_3487,=SignAndEncrypt,SP_3488: bitstring,UP_3489: bitstring));
                                                {3115}new Nc_3490: bitstring;
                                                {3116}let m1_3491: bitstring = (OpenSecureChannelRequest,pkCli_2991,Nc_3490) in
                                                {3117}out(c, (pkCli_2991,enc(m1_3491,pkSess_3487),sign(h(m1_3491),skCli_2990)));
                                                {3118}in(c, (em2_3492: bitstring,sigM2_3493: bitstring));
                                                {3119}let m2_3494: bitstring = dec(em2_3492,skCli_2990) in
                                                {3120}if (verify(h(m2_3494),sigM2_3493,pkSess_3487) <> true) then
                                                    0
                                                else
                                                    {3121}let (=OpenSecureChannelResponse,Ns_3495: bitstring,ST_3496: bitstring,TTL_3497: bitstring) = m2_3494 in
                                                    {3122}let Kcli_3498: bitstring = h((Nc_3490,Ns_3495)) in
                                                    {3123}out(c, senc(mCli(pkCli_2991,pkSess_3487),Kcli_3498))
                                    )
                                    else
                                        {3124}let pkSess_3499: bitstring = fail-any in
                                        {3125}out(c, GetEndpointRequest);
                                        {3126}in(c, (=GetEndpointResponse,=pkSess_3499,=SignAndEncrypt,SP_3500: bitstring,UP_3501: bitstring));
                                        {3127}new Nc_3502: bitstring;
                                        {3128}let m1_3503: bitstring = (OpenSecureChannelRequest,pkCli_2991,Nc_3502) in
                                        {3129}out(c, (pkCli_2991,enc(m1_3503,pkSess_3499),sign(h(m1_3503),skCli_2990)));
                                        {3130}in(c, (em2_3504: bitstring,sigM2_3505: bitstring));
                                        {3131}let m2_3506: bitstring = dec(em2_3504,skCli_2990) in
                                        {3132}if (verify(h(m2_3506),sigM2_3505,pkSess_3499) <> true) then
                                            0
                                        else
                                            {3133}let (=OpenSecureChannelResponse,Ns_3507: bitstring,ST_3508: bitstring,TTL_3509: bitstring) = m2_3506 in
                                            {3134}let Kcli_3510: bitstring = h((Nc_3502,Ns_3507)) in
                                            {3135}out(c, senc(mCli(pkCli_2991,pkSess_3499),Kcli_3510))
                            )
                            else
                                {3136}let pkSess_3511: bitstring = fail-any in
                                {3137}out(c, GetEndpointRequest);
                                {3138}in(c, (=GetEndpointResponse,=pkSess_3511,=SignAndEncrypt,SP_3512: bitstring,UP_3513: bitstring));
                                {3139}new Nc_3514: bitstring;
                                {3140}let m1_3515: bitstring = (OpenSecureChannelRequest,pkCli_2991,Nc_3514) in
                                {3141}out(c, (pkCli_2991,enc(m1_3515,pkSess_3511),sign(h(m1_3515),skCli_2990)));
                                {3142}in(c, (em2_3516: bitstring,sigM2_3517: bitstring));
                                {3143}let m2_3518: bitstring = dec(em2_3516,skCli_2990) in
                                {3144}if (verify(h(m2_3518),sigM2_3517,pkSess_3511) <> true) then
                                    0
                                else
                                    {3145}let (=OpenSecureChannelResponse,Ns_3519: bitstring,ST_3520: bitstring,TTL_3521: bitstring) = m2_3518 in
                                    {3146}let Kcli_3522: bitstring = h((Nc_3514,Ns_3519)) in
                                    {3147}out(c, senc(mCli(pkCli_2991,pkSess_3511),Kcli_3522))
                )
                else
                    {3148}let pkDisco_3523: bitstring = fail-any in
                    {3149}let v_3524: bool = (Sess = A) in
                    (
                        {3150}if v_3524 then
                        (
                            {3151}let pkSess_3525: bitstring = pub(skA) in
                            {3152}out(c, GetEndpointRequest);
                            {3153}in(c, (=GetEndpointResponse,=pkSess_3525,=SignAndEncrypt,SP_3526: bitstring,UP_3527: bitstring));
                            {3154}new Nc_3528: bitstring;
                            {3155}let m1_3529: bitstring = (OpenSecureChannelRequest,pkCli_2991,Nc_3528) in
                            {3156}out(c, (pkCli_2991,enc(m1_3529,pkSess_3525),sign(h(m1_3529),skCli_2990)));
                            {3157}in(c, (em2_3530: bitstring,sigM2_3531: bitstring));
                            {3158}let m2_3532: bitstring = dec(em2_3530,skCli_2990) in
                            {3159}if (verify(h(m2_3532),sigM2_3531,pkSess_3525) <> true) then
                                0
                            else
                                {3160}let (=OpenSecureChannelResponse,Ns_3533: bitstring,ST_3534: bitstring,TTL_3535: bitstring) = m2_3532 in
                                {3161}let Kcli_3536: bitstring = h((Nc_3528,Ns_3533)) in
                                {3162}out(c, senc(mCli(pkCli_2991,pkSess_3525),Kcli_3536))
                        )
                        else
                            {3163}let v_3537: bool = (Sess = B) in
                            (
                                {3164}if v_3537 then
                                (
                                    {3165}let pkSess_3538: bitstring = pub(skB) in
                                    {3166}out(c, GetEndpointRequest);
                                    {3167}in(c, (=GetEndpointResponse,=pkSess_3538,=SignAndEncrypt,SP_3539: bitstring,UP_3540: bitstring));
                                    {3168}new Nc_3541: bitstring;
                                    {3169}let m1_3542: bitstring = (OpenSecureChannelRequest,pkCli_2991,Nc_3541) in
                                    {3170}out(c, (pkCli_2991,enc(m1_3542,pkSess_3538),sign(h(m1_3542),skCli_2990)));
                                    {3171}in(c, (em2_3543: bitstring,sigM2_3544: bitstring));
                                    {3172}let m2_3545: bitstring = dec(em2_3543,skCli_2990) in
                                    {3173}if (verify(h(m2_3545),sigM2_3544,pkSess_3538) <> true) then
                                        0
                                    else
                                        {3174}let (=OpenSecureChannelResponse,Ns_3546: bitstring,ST_3547: bitstring,TTL_3548: bitstring) = m2_3545 in
                                        {3175}let Kcli_3549: bitstring = h((Nc_3541,Ns_3546)) in
                                        {3176}out(c, senc(mCli(pkCli_2991,pkSess_3538),Kcli_3549))
                                )
                                else
                                    {3177}let v_3550: bool = (Sess = C) in
                                    (
                                        {3178}if v_3550 then
                                        (
                                            {3179}let pkSess_3551: bitstring = pub(skC) in
                                            {3180}out(c, GetEndpointRequest);
                                            {3181}in(c, (=GetEndpointResponse,=pkSess_3551,=SignAndEncrypt,SP_3552: bitstring,UP_3553: bitstring));
                                            {3182}new Nc_3554: bitstring;
                                            {3183}let m1_3555: bitstring = (OpenSecureChannelRequest,pkCli_2991,Nc_3554) in
                                            {3184}out(c, (pkCli_2991,enc(m1_3555,pkSess_3551),sign(h(m1_3555),skCli_2990)));
                                            {3185}in(c, (em2_3556: bitstring,sigM2_3557: bitstring));
                                            {3186}let m2_3558: bitstring = dec(em2_3556,skCli_2990) in
                                            {3187}if (verify(h(m2_3558),sigM2_3557,pkSess_3551) <> true) then
                                                0
                                            else
                                                {3188}let (=OpenSecureChannelResponse,Ns_3559: bitstring,ST_3560: bitstring,TTL_3561: bitstring) = m2_3558 in
                                                {3189}let Kcli_3562: bitstring = h((Nc_3554,Ns_3559)) in
                                                {3190}out(c, senc(mCli(pkCli_2991,pkSess_3551),Kcli_3562))
                                        )
                                        else
                                            {3191}let pkSess_3563: bitstring = pub(sk(Sess)) in
                                            {3192}out(c, GetEndpointRequest);
                                            {3193}in(c, (=GetEndpointResponse,=pkSess_3563,=SignAndEncrypt,SP_3564: bitstring,UP_3565: bitstring));
                                            {3194}new Nc_3566: bitstring;
                                            {3195}let m1_3567: bitstring = (OpenSecureChannelRequest,pkCli_2991,Nc_3566) in
                                            {3196}out(c, (pkCli_2991,enc(m1_3567,pkSess_3563),sign(h(m1_3567),skCli_2990)));
                                            {3197}in(c, (em2_3568: bitstring,sigM2_3569: bitstring));
                                            {3198}let m2_3570: bitstring = dec(em2_3568,skCli_2990) in
                                            {3199}if (verify(h(m2_3570),sigM2_3569,pkSess_3563) <> true) then
                                                0
                                            else
                                                {3200}let (=OpenSecureChannelResponse,Ns_3571: bitstring,ST_3572: bitstring,TTL_3573: bitstring) = m2_3570 in
                                                {3201}let Kcli_3574: bitstring = h((Nc_3566,Ns_3571)) in
                                                {3202}out(c, senc(mCli(pkCli_2991,pkSess_3563),Kcli_3574))
                                    )
                                    else
                                        {3203}let pkSess_3575: bitstring = fail-any in
                                        {3204}out(c, GetEndpointRequest);
                                        {3205}in(c, (=GetEndpointResponse,=pkSess_3575,=SignAndEncrypt,SP_3576: bitstring,UP_3577: bitstring));
                                        {3206}new Nc_3578: bitstring;
                                        {3207}let m1_3579: bitstring = (OpenSecureChannelRequest,pkCli_2991,Nc_3578) in
                                        {3208}out(c, (pkCli_2991,enc(m1_3579,pkSess_3575),sign(h(m1_3579),skCli_2990)));
                                        {3209}in(c, (em2_3580: bitstring,sigM2_3581: bitstring));
                                        {3210}let m2_3582: bitstring = dec(em2_3580,skCli_2990) in
                                        {3211}if (verify(h(m2_3582),sigM2_3581,pkSess_3575) <> true) then
                                            0
                                        else
                                            {3212}let (=OpenSecureChannelResponse,Ns_3583: bitstring,ST_3584: bitstring,TTL_3585: bitstring) = m2_3582 in
                                            {3213}let Kcli_3586: bitstring = h((Nc_3578,Ns_3583)) in
                                            {3214}out(c, senc(mCli(pkCli_2991,pkSess_3575),Kcli_3586))
                            )
                            else
                                {3215}let pkSess_3587: bitstring = fail-any in
                                {3216}out(c, GetEndpointRequest);
                                {3217}in(c, (=GetEndpointResponse,=pkSess_3587,=SignAndEncrypt,SP_3588: bitstring,UP_3589: bitstring));
                                {3218}new Nc_3590: bitstring;
                                {3219}let m1_3591: bitstring = (OpenSecureChannelRequest,pkCli_2991,Nc_3590) in
                                {3220}out(c, (pkCli_2991,enc(m1_3591,pkSess_3587),sign(h(m1_3591),skCli_2990)));
                                {3221}in(c, (em2_3592: bitstring,sigM2_3593: bitstring));
                                {3222}let m2_3594: bitstring = dec(em2_3592,skCli_2990) in
                                {3223}if (verify(h(m2_3594),sigM2_3593,pkSess_3587) <> true) then
                                    0
                                else
                                    {3224}let (=OpenSecureChannelResponse,Ns_3595: bitstring,ST_3596: bitstring,TTL_3597: bitstring) = m2_3594 in
                                    {3225}let Kcli_3598: bitstring = h((Nc_3590,Ns_3595)) in
                                    {3226}out(c, senc(mCli(pkCli_2991,pkSess_3587),Kcli_3598))
                    )
                    else
                        {3227}let pkSess_3599: bitstring = fail-any in
                        {3228}out(c, GetEndpointRequest);
                        {3229}in(c, (=GetEndpointResponse,=pkSess_3599,=SignAndEncrypt,SP_3600: bitstring,UP_3601: bitstring));
                        {3230}new Nc_3602: bitstring;
                        {3231}let m1_3603: bitstring = (OpenSecureChannelRequest,pkCli_2991,Nc_3602) in
                        {3232}out(c, (pkCli_2991,enc(m1_3603,pkSess_3599),sign(h(m1_3603),skCli_2990)));
                        {3233}in(c, (em2_3604: bitstring,sigM2_3605: bitstring));
                        {3234}let m2_3606: bitstring = dec(em2_3604,skCli_2990) in
                        {3235}if (verify(h(m2_3606),sigM2_3605,pkSess_3599) <> true) then
                            0
                        else
                            {3236}let (=OpenSecureChannelResponse,Ns_3607: bitstring,ST_3608: bitstring,TTL_3609: bitstring) = m2_3606 in
                            {3237}let Kcli_3610: bitstring = h((Nc_3602,Ns_3607)) in
                            {3238}out(c, senc(mCli(pkCli_2991,pkSess_3599),Kcli_3610))
    )
    else
        {3239}let skCli_3611: bitstring = fail-any in
        {3240}let pkCli_3612: bitstring = pub(skCli_3611) in
        {3241}let v_3613: bool = (Disco = A) in
        (
            {3242}if v_3613 then
            (
                {3243}let pkDisco_3614: bitstring = pub(skA) in
                {3244}let v_3615: bool = (Sess = A) in
                (
                    {3245}if v_3615 then
                    (
                        {3246}let pkSess_3616: bitstring = pub(skA) in
                        {3247}out(c, GetEndpointRequest);
                        {3248}in(c, (=GetEndpointResponse,=pkSess_3616,=SignAndEncrypt,SP_3617: bitstring,UP_3618: bitstring));
                        {3249}new Nc_3619: bitstring;
                        {3250}let m1_3620: bitstring = (OpenSecureChannelRequest,pkCli_3612,Nc_3619) in
                        {3251}out(c, (pkCli_3612,enc(m1_3620,pkSess_3616),sign(h(m1_3620),skCli_3611)));
                        {3252}in(c, (em2_3621: bitstring,sigM2_3622: bitstring));
                        {3253}let m2_3623: bitstring = dec(em2_3621,skCli_3611) in
                        {3254}if (verify(h(m2_3623),sigM2_3622,pkSess_3616) <> true) then
                            0
                        else
                            {3255}let (=OpenSecureChannelResponse,Ns_3624: bitstring,ST_3625: bitstring,TTL_3626: bitstring) = m2_3623 in
                            {3256}let Kcli_3627: bitstring = h((Nc_3619,Ns_3624)) in
                            {3257}out(c, senc(mCli(pkCli_3612,pkSess_3616),Kcli_3627))
                    )
                    else
                        {3258}let v_3628: bool = (Sess = B) in
                        (
                            {3259}if v_3628 then
                            (
                                {3260}let pkSess_3629: bitstring = pub(skB) in
                                {3261}out(c, GetEndpointRequest);
                                {3262}in(c, (=GetEndpointResponse,=pkSess_3629,=SignAndEncrypt,SP_3630: bitstring,UP_3631: bitstring));
                                {3263}new Nc_3632: bitstring;
                                {3264}let m1_3633: bitstring = (OpenSecureChannelRequest,pkCli_3612,Nc_3632) in
                                {3265}out(c, (pkCli_3612,enc(m1_3633,pkSess_3629),sign(h(m1_3633),skCli_3611)));
                                {3266}in(c, (em2_3634: bitstring,sigM2_3635: bitstring));
                                {3267}let m2_3636: bitstring = dec(em2_3634,skCli_3611) in
                                {3268}if (verify(h(m2_3636),sigM2_3635,pkSess_3629) <> true) then
                                    0
                                else
                                    {3269}let (=OpenSecureChannelResponse,Ns_3637: bitstring,ST_3638: bitstring,TTL_3639: bitstring) = m2_3636 in
                                    {3270}let Kcli_3640: bitstring = h((Nc_3632,Ns_3637)) in
                                    {3271}out(c, senc(mCli(pkCli_3612,pkSess_3629),Kcli_3640))
                            )
                            else
                                {3272}let v_3641: bool = (Sess = C) in
                                (
                                    {3273}if v_3641 then
                                    (
                                        {3274}let pkSess_3642: bitstring = pub(skC) in
                                        {3275}out(c, GetEndpointRequest);
                                        {3276}in(c, (=GetEndpointResponse,=pkSess_3642,=SignAndEncrypt,SP_3643: bitstring,UP_3644: bitstring));
                                        {3277}new Nc_3645: bitstring;
                                        {3278}let m1_3646: bitstring = (OpenSecureChannelRequest,pkCli_3612,Nc_3645) in
                                        {3279}out(c, (pkCli_3612,enc(m1_3646,pkSess_3642),sign(h(m1_3646),skCli_3611)));
                                        {3280}in(c, (em2_3647: bitstring,sigM2_3648: bitstring));
                                        {3281}let m2_3649: bitstring = dec(em2_3647,skCli_3611) in
                                        {3282}if (verify(h(m2_3649),sigM2_3648,pkSess_3642) <> true) then
                                            0
                                        else
                                            {3283}let (=OpenSecureChannelResponse,Ns_3650: bitstring,ST_3651: bitstring,TTL_3652: bitstring) = m2_3649 in
                                            {3284}let Kcli_3653: bitstring = h((Nc_3645,Ns_3650)) in
                                            {3285}out(c, senc(mCli(pkCli_3612,pkSess_3642),Kcli_3653))
                                    )
                                    else
                                        {3286}let pkSess_3654: bitstring = pub(sk(Sess)) in
                                        {3287}out(c, GetEndpointRequest);
                                        {3288}in(c, (=GetEndpointResponse,=pkSess_3654,=SignAndEncrypt,SP_3655: bitstring,UP_3656: bitstring));
                                        {3289}new Nc_3657: bitstring;
                                        {3290}let m1_3658: bitstring = (OpenSecureChannelRequest,pkCli_3612,Nc_3657) in
                                        {3291}out(c, (pkCli_3612,enc(m1_3658,pkSess_3654),sign(h(m1_3658),skCli_3611)));
                                        {3292}in(c, (em2_3659: bitstring,sigM2_3660: bitstring));
                                        {3293}let m2_3661: bitstring = dec(em2_3659,skCli_3611) in
                                        {3294}if (verify(h(m2_3661),sigM2_3660,pkSess_3654) <> true) then
                                            0
                                        else
                                            {3295}let (=OpenSecureChannelResponse,Ns_3662: bitstring,ST_3663: bitstring,TTL_3664: bitstring) = m2_3661 in
                                            {3296}let Kcli_3665: bitstring = h((Nc_3657,Ns_3662)) in
                                            {3297}out(c, senc(mCli(pkCli_3612,pkSess_3654),Kcli_3665))
                                )
                                else
                                    {3298}let pkSess_3666: bitstring = fail-any in
                                    {3299}out(c, GetEndpointRequest);
                                    {3300}in(c, (=GetEndpointResponse,=pkSess_3666,=SignAndEncrypt,SP_3667: bitstring,UP_3668: bitstring));
                                    {3301}new Nc_3669: bitstring;
                                    {3302}let m1_3670: bitstring = (OpenSecureChannelRequest,pkCli_3612,Nc_3669) in
                                    {3303}out(c, (pkCli_3612,enc(m1_3670,pkSess_3666),sign(h(m1_3670),skCli_3611)));
                                    {3304}in(c, (em2_3671: bitstring,sigM2_3672: bitstring));
                                    {3305}let m2_3673: bitstring = dec(em2_3671,skCli_3611) in
                                    {3306}if (verify(h(m2_3673),sigM2_3672,pkSess_3666) <> true) then
                                        0
                                    else
                                        {3307}let (=OpenSecureChannelResponse,Ns_3674: bitstring,ST_3675: bitstring,TTL_3676: bitstring) = m2_3673 in
                                        {3308}let Kcli_3677: bitstring = h((Nc_3669,Ns_3674)) in
                                        {3309}out(c, senc(mCli(pkCli_3612,pkSess_3666),Kcli_3677))
                        )
                        else
                            {3310}let pkSess_3678: bitstring = fail-any in
                            {3311}out(c, GetEndpointRequest);
                            {3312}in(c, (=GetEndpointResponse,=pkSess_3678,=SignAndEncrypt,SP_3679: bitstring,UP_3680: bitstring));
                            {3313}new Nc_3681: bitstring;
                            {3314}let m1_3682: bitstring = (OpenSecureChannelRequest,pkCli_3612,Nc_3681) in
                            {3315}out(c, (pkCli_3612,enc(m1_3682,pkSess_3678),sign(h(m1_3682),skCli_3611)));
                            {3316}in(c, (em2_3683: bitstring,sigM2_3684: bitstring));
                            {3317}let m2_3685: bitstring = dec(em2_3683,skCli_3611) in
                            {3318}if (verify(h(m2_3685),sigM2_3684,pkSess_3678) <> true) then
                                0
                            else
                                {3319}let (=OpenSecureChannelResponse,Ns_3686: bitstring,ST_3687: bitstring,TTL_3688: bitstring) = m2_3685 in
                                {3320}let Kcli_3689: bitstring = h((Nc_3681,Ns_3686)) in
                                {3321}out(c, senc(mCli(pkCli_3612,pkSess_3678),Kcli_3689))
                )
                else
                    {3322}let pkSess_3690: bitstring = fail-any in
                    {3323}out(c, GetEndpointRequest);
                    {3324}in(c, (=GetEndpointResponse,=pkSess_3690,=SignAndEncrypt,SP_3691: bitstring,UP_3692: bitstring));
                    {3325}new Nc_3693: bitstring;
                    {3326}let m1_3694: bitstring = (OpenSecureChannelRequest,pkCli_3612,Nc_3693) in
                    {3327}out(c, (pkCli_3612,enc(m1_3694,pkSess_3690),sign(h(m1_3694),skCli_3611)));
                    {3328}in(c, (em2_3695: bitstring,sigM2_3696: bitstring));
                    {3329}let m2_3697: bitstring = dec(em2_3695,skCli_3611) in
                    {3330}if (verify(h(m2_3697),sigM2_3696,pkSess_3690) <> true) then
                        0
                    else
                        {3331}let (=OpenSecureChannelResponse,Ns_3698: bitstring,ST_3699: bitstring,TTL_3700: bitstring) = m2_3697 in
                        {3332}let Kcli_3701: bitstring = h((Nc_3693,Ns_3698)) in
                        {3333}out(c, senc(mCli(pkCli_3612,pkSess_3690),Kcli_3701))
            )
            else
                {3334}let v_3702: bool = (Disco = B) in
                (
                    {3335}if v_3702 then
                    (
                        {3336}let pkDisco_3703: bitstring = pub(skB) in
                        {3337}let v_3704: bool = (Sess = A) in
                        (
                            {3338}if v_3704 then
                            (
                                {3339}let pkSess_3705: bitstring = pub(skA) in
                                {3340}out(c, GetEndpointRequest);
                                {3341}in(c, (=GetEndpointResponse,=pkSess_3705,=SignAndEncrypt,SP_3706: bitstring,UP_3707: bitstring));
                                {3342}new Nc_3708: bitstring;
                                {3343}let m1_3709: bitstring = (OpenSecureChannelRequest,pkCli_3612,Nc_3708) in
                                {3344}out(c, (pkCli_3612,enc(m1_3709,pkSess_3705),sign(h(m1_3709),skCli_3611)));
                                {3345}in(c, (em2_3710: bitstring,sigM2_3711: bitstring));
                                {3346}let m2_3712: bitstring = dec(em2_3710,skCli_3611) in
                                {3347}if (verify(h(m2_3712),sigM2_3711,pkSess_3705) <> true) then
                                    0
                                else
                                    {3348}let (=OpenSecureChannelResponse,Ns_3713: bitstring,ST_3714: bitstring,TTL_3715: bitstring) = m2_3712 in
                                    {3349}let Kcli_3716: bitstring = h((Nc_3708,Ns_3713)) in
                                    {3350}out(c, senc(mCli(pkCli_3612,pkSess_3705),Kcli_3716))
                            )
                            else
                                {3351}let v_3717: bool = (Sess = B) in
                                (
                                    {3352}if v_3717 then
                                    (
                                        {3353}let pkSess_3718: bitstring = pub(skB) in
                                        {3354}out(c, GetEndpointRequest);
                                        {3355}in(c, (=GetEndpointResponse,=pkSess_3718,=SignAndEncrypt,SP_3719: bitstring,UP_3720: bitstring));
                                        {3356}new Nc_3721: bitstring;
                                        {3357}let m1_3722: bitstring = (OpenSecureChannelRequest,pkCli_3612,Nc_3721) in
                                        {3358}out(c, (pkCli_3612,enc(m1_3722,pkSess_3718),sign(h(m1_3722),skCli_3611)));
                                        {3359}in(c, (em2_3723: bitstring,sigM2_3724: bitstring));
                                        {3360}let m2_3725: bitstring = dec(em2_3723,skCli_3611) in
                                        {3361}if (verify(h(m2_3725),sigM2_3724,pkSess_3718) <> true) then
                                            0
                                        else
                                            {3362}let (=OpenSecureChannelResponse,Ns_3726: bitstring,ST_3727: bitstring,TTL_3728: bitstring) = m2_3725 in
                                            {3363}let Kcli_3729: bitstring = h((Nc_3721,Ns_3726)) in
                                            {3364}out(c, senc(mCli(pkCli_3612,pkSess_3718),Kcli_3729))
                                    )
                                    else
                                        {3365}let v_3730: bool = (Sess = C) in
                                        (
                                            {3366}if v_3730 then
                                            (
                                                {3367}let pkSess_3731: bitstring = pub(skC) in
                                                {3368}out(c, GetEndpointRequest);
                                                {3369}in(c, (=GetEndpointResponse,=pkSess_3731,=SignAndEncrypt,SP_3732: bitstring,UP_3733: bitstring));
                                                {3370}new Nc_3734: bitstring;
                                                {3371}let m1_3735: bitstring = (OpenSecureChannelRequest,pkCli_3612,Nc_3734) in
                                                {3372}out(c, (pkCli_3612,enc(m1_3735,pkSess_3731),sign(h(m1_3735),skCli_3611)));
                                                {3373}in(c, (em2_3736: bitstring,sigM2_3737: bitstring));
                                                {3374}let m2_3738: bitstring = dec(em2_3736,skCli_3611) in
                                                {3375}if (verify(h(m2_3738),sigM2_3737,pkSess_3731) <> true) then
                                                    0
                                                else
                                                    {3376}let (=OpenSecureChannelResponse,Ns_3739: bitstring,ST_3740: bitstring,TTL_3741: bitstring) = m2_3738 in
                                                    {3377}let Kcli_3742: bitstring = h((Nc_3734,Ns_3739)) in
                                                    {3378}out(c, senc(mCli(pkCli_3612,pkSess_3731),Kcli_3742))
                                            )
                                            else
                                                {3379}let pkSess_3743: bitstring = pub(sk(Sess)) in
                                                {3380}out(c, GetEndpointRequest);
                                                {3381}in(c, (=GetEndpointResponse,=pkSess_3743,=SignAndEncrypt,SP_3744: bitstring,UP_3745: bitstring));
                                                {3382}new Nc_3746: bitstring;
                                                {3383}let m1_3747: bitstring = (OpenSecureChannelRequest,pkCli_3612,Nc_3746) in
                                                {3384}out(c, (pkCli_3612,enc(m1_3747,pkSess_3743),sign(h(m1_3747),skCli_3611)));
                                                {3385}in(c, (em2_3748: bitstring,sigM2_3749: bitstring));
                                                {3386}let m2_3750: bitstring = dec(em2_3748,skCli_3611) in
                                                {3387}if (verify(h(m2_3750),sigM2_3749,pkSess_3743) <> true) then
                                                    0
                                                else
                                                    {3388}let (=OpenSecureChannelResponse,Ns_3751: bitstring,ST_3752: bitstring,TTL_3753: bitstring) = m2_3750 in
                                                    {3389}let Kcli_3754: bitstring = h((Nc_3746,Ns_3751)) in
                                                    {3390}out(c, senc(mCli(pkCli_3612,pkSess_3743),Kcli_3754))
                                        )
                                        else
                                            {3391}let pkSess_3755: bitstring = fail-any in
                                            {3392}out(c, GetEndpointRequest);
                                            {3393}in(c, (=GetEndpointResponse,=pkSess_3755,=SignAndEncrypt,SP_3756: bitstring,UP_3757: bitstring));
                                            {3394}new Nc_3758: bitstring;
                                            {3395}let m1_3759: bitstring = (OpenSecureChannelRequest,pkCli_3612,Nc_3758) in
                                            {3396}out(c, (pkCli_3612,enc(m1_3759,pkSess_3755),sign(h(m1_3759),skCli_3611)));
                                            {3397}in(c, (em2_3760: bitstring,sigM2_3761: bitstring));
                                            {3398}let m2_3762: bitstring = dec(em2_3760,skCli_3611) in
                                            {3399}if (verify(h(m2_3762),sigM2_3761,pkSess_3755) <> true) then
                                                0
                                            else
                                                {3400}let (=OpenSecureChannelResponse,Ns_3763: bitstring,ST_3764: bitstring,TTL_3765: bitstring) = m2_3762 in
                                                {3401}let Kcli_3766: bitstring = h((Nc_3758,Ns_3763)) in
                                                {3402}out(c, senc(mCli(pkCli_3612,pkSess_3755),Kcli_3766))
                                )
                                else
                                    {3403}let pkSess_3767: bitstring = fail-any in
                                    {3404}out(c, GetEndpointRequest);
                                    {3405}in(c, (=GetEndpointResponse,=pkSess_3767,=SignAndEncrypt,SP_3768: bitstring,UP_3769: bitstring));
                                    {3406}new Nc_3770: bitstring;
                                    {3407}let m1_3771: bitstring = (OpenSecureChannelRequest,pkCli_3612,Nc_3770) in
                                    {3408}out(c, (pkCli_3612,enc(m1_3771,pkSess_3767),sign(h(m1_3771),skCli_3611)));
                                    {3409}in(c, (em2_3772: bitstring,sigM2_3773: bitstring));
                                    {3410}let m2_3774: bitstring = dec(em2_3772,skCli_3611) in
                                    {3411}if (verify(h(m2_3774),sigM2_3773,pkSess_3767) <> true) then
                                        0
                                    else
                                        {3412}let (=OpenSecureChannelResponse,Ns_3775: bitstring,ST_3776: bitstring,TTL_3777: bitstring) = m2_3774 in
                                        {3413}let Kcli_3778: bitstring = h((Nc_3770,Ns_3775)) in
                                        {3414}out(c, senc(mCli(pkCli_3612,pkSess_3767),Kcli_3778))
                        )
                        else
                            {3415}let pkSess_3779: bitstring = fail-any in
                            {3416}out(c, GetEndpointRequest);
                            {3417}in(c, (=GetEndpointResponse,=pkSess_3779,=SignAndEncrypt,SP_3780: bitstring,UP_3781: bitstring));
                            {3418}new Nc_3782: bitstring;
                            {3419}let m1_3783: bitstring = (OpenSecureChannelRequest,pkCli_3612,Nc_3782) in
                            {3420}out(c, (pkCli_3612,enc(m1_3783,pkSess_3779),sign(h(m1_3783),skCli_3611)));
                            {3421}in(c, (em2_3784: bitstring,sigM2_3785: bitstring));
                            {3422}let m2_3786: bitstring = dec(em2_3784,skCli_3611) in
                            {3423}if (verify(h(m2_3786),sigM2_3785,pkSess_3779) <> true) then
                                0
                            else
                                {3424}let (=OpenSecureChannelResponse,Ns_3787: bitstring,ST_3788: bitstring,TTL_3789: bitstring) = m2_3786 in
                                {3425}let Kcli_3790: bitstring = h((Nc_3782,Ns_3787)) in
                                {3426}out(c, senc(mCli(pkCli_3612,pkSess_3779),Kcli_3790))
                    )
                    else
                        {3427}let v_3791: bool = (Disco = C) in
                        (
                            {3428}if v_3791 then
                            (
                                {3429}let pkDisco_3792: bitstring = pub(skC) in
                                {3430}let v_3793: bool = (Sess = A) in
                                (
                                    {3431}if v_3793 then
                                    (
                                        {3432}let pkSess_3794: bitstring = pub(skA) in
                                        {3433}out(c, GetEndpointRequest);
                                        {3434}in(c, (=GetEndpointResponse,=pkSess_3794,=SignAndEncrypt,SP_3795: bitstring,UP_3796: bitstring));
                                        {3435}new Nc_3797: bitstring;
                                        {3436}let m1_3798: bitstring = (OpenSecureChannelRequest,pkCli_3612,Nc_3797) in
                                        {3437}out(c, (pkCli_3612,enc(m1_3798,pkSess_3794),sign(h(m1_3798),skCli_3611)));
                                        {3438}in(c, (em2_3799: bitstring,sigM2_3800: bitstring));
                                        {3439}let m2_3801: bitstring = dec(em2_3799,skCli_3611) in
                                        {3440}if (verify(h(m2_3801),sigM2_3800,pkSess_3794) <> true) then
                                            0
                                        else
                                            {3441}let (=OpenSecureChannelResponse,Ns_3802: bitstring,ST_3803: bitstring,TTL_3804: bitstring) = m2_3801 in
                                            {3442}let Kcli_3805: bitstring = h((Nc_3797,Ns_3802)) in
                                            {3443}out(c, senc(mCli(pkCli_3612,pkSess_3794),Kcli_3805))
                                    )
                                    else
                                        {3444}let v_3806: bool = (Sess = B) in
                                        (
                                            {3445}if v_3806 then
                                            (
                                                {3446}let pkSess_3807: bitstring = pub(skB) in
                                                {3447}out(c, GetEndpointRequest);
                                                {3448}in(c, (=GetEndpointResponse,=pkSess_3807,=SignAndEncrypt,SP_3808: bitstring,UP_3809: bitstring));
                                                {3449}new Nc_3810: bitstring;
                                                {3450}let m1_3811: bitstring = (OpenSecureChannelRequest,pkCli_3612,Nc_3810) in
                                                {3451}out(c, (pkCli_3612,enc(m1_3811,pkSess_3807),sign(h(m1_3811),skCli_3611)));
                                                {3452}in(c, (em2_3812: bitstring,sigM2_3813: bitstring));
                                                {3453}let m2_3814: bitstring = dec(em2_3812,skCli_3611) in
                                                {3454}if (verify(h(m2_3814),sigM2_3813,pkSess_3807) <> true) then
                                                    0
                                                else
                                                    {3455}let (=OpenSecureChannelResponse,Ns_3815: bitstring,ST_3816: bitstring,TTL_3817: bitstring) = m2_3814 in
                                                    {3456}let Kcli_3818: bitstring = h((Nc_3810,Ns_3815)) in
                                                    {3457}out(c, senc(mCli(pkCli_3612,pkSess_3807),Kcli_3818))
                                            )
                                            else
                                                {3458}let v_3819: bool = (Sess = C) in
                                                (
                                                    {3459}if v_3819 then
                                                    (
                                                        {3460}let pkSess_3820: bitstring = pub(skC) in
                                                        {3461}out(c, GetEndpointRequest);
                                                        {3462}in(c, (=GetEndpointResponse,=pkSess_3820,=SignAndEncrypt,SP_3821: bitstring,UP_3822: bitstring));
                                                        {3463}new Nc_3823: bitstring;
                                                        {3464}let m1_3824: bitstring = (OpenSecureChannelRequest,pkCli_3612,Nc_3823) in
                                                        {3465}out(c, (pkCli_3612,enc(m1_3824,pkSess_3820),sign(h(m1_3824),skCli_3611)));
                                                        {3466}in(c, (em2_3825: bitstring,sigM2_3826: bitstring));
                                                        {3467}let m2_3827: bitstring = dec(em2_3825,skCli_3611) in
                                                        {3468}if (verify(h(m2_3827),sigM2_3826,pkSess_3820) <> true) then
                                                            0
                                                        else
                                                            {3469}let (=OpenSecureChannelResponse,Ns_3828: bitstring,ST_3829: bitstring,TTL_3830: bitstring) = m2_3827 in
                                                            {3470}let Kcli_3831: bitstring = h((Nc_3823,Ns_3828)) in
                                                            {3471}out(c, senc(mCli(pkCli_3612,pkSess_3820),Kcli_3831))
                                                    )
                                                    else
                                                        {3472}let pkSess_3832: bitstring = pub(sk(Sess)) in
                                                        {3473}out(c, GetEndpointRequest);
                                                        {3474}in(c, (=GetEndpointResponse,=pkSess_3832,=SignAndEncrypt,SP_3833: bitstring,UP_3834: bitstring));
                                                        {3475}new Nc_3835: bitstring;
                                                        {3476}let m1_3836: bitstring = (OpenSecureChannelRequest,pkCli_3612,Nc_3835) in
                                                        {3477}out(c, (pkCli_3612,enc(m1_3836,pkSess_3832),sign(h(m1_3836),skCli_3611)));
                                                        {3478}in(c, (em2_3837: bitstring,sigM2_3838: bitstring));
                                                        {3479}let m2_3839: bitstring = dec(em2_3837,skCli_3611) in
                                                        {3480}if (verify(h(m2_3839),sigM2_3838,pkSess_3832) <> true) then
                                                            0
                                                        else
                                                            {3481}let (=OpenSecureChannelResponse,Ns_3840: bitstring,ST_3841: bitstring,TTL_3842: bitstring) = m2_3839 in
                                                            {3482}let Kcli_3843: bitstring = h((Nc_3835,Ns_3840)) in
                                                            {3483}out(c, senc(mCli(pkCli_3612,pkSess_3832),Kcli_3843))
                                                )
                                                else
                                                    {3484}let pkSess_3844: bitstring = fail-any in
                                                    {3485}out(c, GetEndpointRequest);
                                                    {3486}in(c, (=GetEndpointResponse,=pkSess_3844,=SignAndEncrypt,SP_3845: bitstring,UP_3846: bitstring));
                                                    {3487}new Nc_3847: bitstring;
                                                    {3488}let m1_3848: bitstring = (OpenSecureChannelRequest,pkCli_3612,Nc_3847) in
                                                    {3489}out(c, (pkCli_3612,enc(m1_3848,pkSess_3844),sign(h(m1_3848),skCli_3611)));
                                                    {3490}in(c, (em2_3849: bitstring,sigM2_3850: bitstring));
                                                    {3491}let m2_3851: bitstring = dec(em2_3849,skCli_3611) in
                                                    {3492}if (verify(h(m2_3851),sigM2_3850,pkSess_3844) <> true) then
                                                        0
                                                    else
                                                        {3493}let (=OpenSecureChannelResponse,Ns_3852: bitstring,ST_3853: bitstring,TTL_3854: bitstring) = m2_3851 in
                                                        {3494}let Kcli_3855: bitstring = h((Nc_3847,Ns_3852)) in
                                                        {3495}out(c, senc(mCli(pkCli_3612,pkSess_3844),Kcli_3855))
                                        )
                                        else
                                            {3496}let pkSess_3856: bitstring = fail-any in
                                            {3497}out(c, GetEndpointRequest);
                                            {3498}in(c, (=GetEndpointResponse,=pkSess_3856,=SignAndEncrypt,SP_3857: bitstring,UP_3858: bitstring));
                                            {3499}new Nc_3859: bitstring;
                                            {3500}let m1_3860: bitstring = (OpenSecureChannelRequest,pkCli_3612,Nc_3859) in
                                            {3501}out(c, (pkCli_3612,enc(m1_3860,pkSess_3856),sign(h(m1_3860),skCli_3611)));
                                            {3502}in(c, (em2_3861: bitstring,sigM2_3862: bitstring));
                                            {3503}let m2_3863: bitstring = dec(em2_3861,skCli_3611) in
                                            {3504}if (verify(h(m2_3863),sigM2_3862,pkSess_3856) <> true) then
                                                0
                                            else
                                                {3505}let (=OpenSecureChannelResponse,Ns_3864: bitstring,ST_3865: bitstring,TTL_3866: bitstring) = m2_3863 in
                                                {3506}let Kcli_3867: bitstring = h((Nc_3859,Ns_3864)) in
                                                {3507}out(c, senc(mCli(pkCli_3612,pkSess_3856),Kcli_3867))
                                )
                                else
                                    {3508}let pkSess_3868: bitstring = fail-any in
                                    {3509}out(c, GetEndpointRequest);
                                    {3510}in(c, (=GetEndpointResponse,=pkSess_3868,=SignAndEncrypt,SP_3869: bitstring,UP_3870: bitstring));
                                    {3511}new Nc_3871: bitstring;
                                    {3512}let m1_3872: bitstring = (OpenSecureChannelRequest,pkCli_3612,Nc_3871) in
                                    {3513}out(c, (pkCli_3612,enc(m1_3872,pkSess_3868),sign(h(m1_3872),skCli_3611)));
                                    {3514}in(c, (em2_3873: bitstring,sigM2_3874: bitstring));
                                    {3515}let m2_3875: bitstring = dec(em2_3873,skCli_3611) in
                                    {3516}if (verify(h(m2_3875),sigM2_3874,pkSess_3868) <> true) then
                                        0
                                    else
                                        {3517}let (=OpenSecureChannelResponse,Ns_3876: bitstring,ST_3877: bitstring,TTL_3878: bitstring) = m2_3875 in
                                        {3518}let Kcli_3879: bitstring = h((Nc_3871,Ns_3876)) in
                                        {3519}out(c, senc(mCli(pkCli_3612,pkSess_3868),Kcli_3879))
                            )
                            else
                                {3520}let pkDisco_3880: bitstring = pub(sk(Disco)) in
                                {3521}let v_3881: bool = (Sess = A) in
                                (
                                    {3522}if v_3881 then
                                    (
                                        {3523}let pkSess_3882: bitstring = pub(skA) in
                                        {3524}out(c, GetEndpointRequest);
                                        {3525}in(c, (=GetEndpointResponse,=pkSess_3882,=SignAndEncrypt,SP_3883: bitstring,UP_3884: bitstring));
                                        {3526}new Nc_3885: bitstring;
                                        {3527}let m1_3886: bitstring = (OpenSecureChannelRequest,pkCli_3612,Nc_3885) in
                                        {3528}out(c, (pkCli_3612,enc(m1_3886,pkSess_3882),sign(h(m1_3886),skCli_3611)));
                                        {3529}in(c, (em2_3887: bitstring,sigM2_3888: bitstring));
                                        {3530}let m2_3889: bitstring = dec(em2_3887,skCli_3611) in
                                        {3531}if (verify(h(m2_3889),sigM2_3888,pkSess_3882) <> true) then
                                            0
                                        else
                                            {3532}let (=OpenSecureChannelResponse,Ns_3890: bitstring,ST_3891: bitstring,TTL_3892: bitstring) = m2_3889 in
                                            {3533}let Kcli_3893: bitstring = h((Nc_3885,Ns_3890)) in
                                            {3534}out(c, senc(mCli(pkCli_3612,pkSess_3882),Kcli_3893))
                                    )
                                    else
                                        {3535}let v_3894: bool = (Sess = B) in
                                        (
                                            {3536}if v_3894 then
                                            (
                                                {3537}let pkSess_3895: bitstring = pub(skB) in
                                                {3538}out(c, GetEndpointRequest);
                                                {3539}in(c, (=GetEndpointResponse,=pkSess_3895,=SignAndEncrypt,SP_3896: bitstring,UP_3897: bitstring));
                                                {3540}new Nc_3898: bitstring;
                                                {3541}let m1_3899: bitstring = (OpenSecureChannelRequest,pkCli_3612,Nc_3898) in
                                                {3542}out(c, (pkCli_3612,enc(m1_3899,pkSess_3895),sign(h(m1_3899),skCli_3611)));
                                                {3543}in(c, (em2_3900: bitstring,sigM2_3901: bitstring));
                                                {3544}let m2_3902: bitstring = dec(em2_3900,skCli_3611) in
                                                {3545}if (verify(h(m2_3902),sigM2_3901,pkSess_3895) <> true) then
                                                    0
                                                else
                                                    {3546}let (=OpenSecureChannelResponse,Ns_3903: bitstring,ST_3904: bitstring,TTL_3905: bitstring) = m2_3902 in
                                                    {3547}let Kcli_3906: bitstring = h((Nc_3898,Ns_3903)) in
                                                    {3548}out(c, senc(mCli(pkCli_3612,pkSess_3895),Kcli_3906))
                                            )
                                            else
                                                {3549}let v_3907: bool = (Sess = C) in
                                                (
                                                    {3550}if v_3907 then
                                                    (
                                                        {3551}let pkSess_3908: bitstring = pub(skC) in
                                                        {3552}out(c, GetEndpointRequest);
                                                        {3553}in(c, (=GetEndpointResponse,=pkSess_3908,=SignAndEncrypt,SP_3909: bitstring,UP_3910: bitstring));
                                                        {3554}new Nc_3911: bitstring;
                                                        {3555}let m1_3912: bitstring = (OpenSecureChannelRequest,pkCli_3612,Nc_3911) in
                                                        {3556}out(c, (pkCli_3612,enc(m1_3912,pkSess_3908),sign(h(m1_3912),skCli_3611)));
                                                        {3557}in(c, (em2_3913: bitstring,sigM2_3914: bitstring));
                                                        {3558}let m2_3915: bitstring = dec(em2_3913,skCli_3611) in
                                                        {3559}if (verify(h(m2_3915),sigM2_3914,pkSess_3908) <> true) then
                                                            0
                                                        else
                                                            {3560}let (=OpenSecureChannelResponse,Ns_3916: bitstring,ST_3917: bitstring,TTL_3918: bitstring) = m2_3915 in
                                                            {3561}let Kcli_3919: bitstring = h((Nc_3911,Ns_3916)) in
                                                            {3562}out(c, senc(mCli(pkCli_3612,pkSess_3908),Kcli_3919))
                                                    )
                                                    else
                                                        {3563}let pkSess_3920: bitstring = pub(sk(Sess)) in
                                                        {3564}out(c, GetEndpointRequest);
                                                        {3565}in(c, (=GetEndpointResponse,=pkSess_3920,=SignAndEncrypt,SP_3921: bitstring,UP_3922: bitstring));
                                                        {3566}new Nc_3923: bitstring;
                                                        {3567}let m1_3924: bitstring = (OpenSecureChannelRequest,pkCli_3612,Nc_3923) in
                                                        {3568}out(c, (pkCli_3612,enc(m1_3924,pkSess_3920),sign(h(m1_3924),skCli_3611)));
                                                        {3569}in(c, (em2_3925: bitstring,sigM2_3926: bitstring));
                                                        {3570}let m2_3927: bitstring = dec(em2_3925,skCli_3611) in
                                                        {3571}if (verify(h(m2_3927),sigM2_3926,pkSess_3920) <> true) then
                                                            0
                                                        else
                                                            {3572}let (=OpenSecureChannelResponse,Ns_3928: bitstring,ST_3929: bitstring,TTL_3930: bitstring) = m2_3927 in
                                                            {3573}let Kcli_3931: bitstring = h((Nc_3923,Ns_3928)) in
                                                            {3574}out(c, senc(mCli(pkCli_3612,pkSess_3920),Kcli_3931))
                                                )
                                                else
                                                    {3575}let pkSess_3932: bitstring = fail-any in
                                                    {3576}out(c, GetEndpointRequest);
                                                    {3577}in(c, (=GetEndpointResponse,=pkSess_3932,=SignAndEncrypt,SP_3933: bitstring,UP_3934: bitstring));
                                                    {3578}new Nc_3935: bitstring;
                                                    {3579}let m1_3936: bitstring = (OpenSecureChannelRequest,pkCli_3612,Nc_3935) in
                                                    {3580}out(c, (pkCli_3612,enc(m1_3936,pkSess_3932),sign(h(m1_3936),skCli_3611)));
                                                    {3581}in(c, (em2_3937: bitstring,sigM2_3938: bitstring));
                                                    {3582}let m2_3939: bitstring = dec(em2_3937,skCli_3611) in
                                                    {3583}if (verify(h(m2_3939),sigM2_3938,pkSess_3932) <> true) then
                                                        0
                                                    else
                                                        {3584}let (=OpenSecureChannelResponse,Ns_3940: bitstring,ST_3941: bitstring,TTL_3942: bitstring) = m2_3939 in
                                                        {3585}let Kcli_3943: bitstring = h((Nc_3935,Ns_3940)) in
                                                        {3586}out(c, senc(mCli(pkCli_3612,pkSess_3932),Kcli_3943))
                                        )
                                        else
                                            {3587}let pkSess_3944: bitstring = fail-any in
                                            {3588}out(c, GetEndpointRequest);
                                            {3589}in(c, (=GetEndpointResponse,=pkSess_3944,=SignAndEncrypt,SP_3945: bitstring,UP_3946: bitstring));
                                            {3590}new Nc_3947: bitstring;
                                            {3591}let m1_3948: bitstring = (OpenSecureChannelRequest,pkCli_3612,Nc_3947) in
                                            {3592}out(c, (pkCli_3612,enc(m1_3948,pkSess_3944),sign(h(m1_3948),skCli_3611)));
                                            {3593}in(c, (em2_3949: bitstring,sigM2_3950: bitstring));
                                            {3594}let m2_3951: bitstring = dec(em2_3949,skCli_3611) in
                                            {3595}if (verify(h(m2_3951),sigM2_3950,pkSess_3944) <> true) then
                                                0
                                            else
                                                {3596}let (=OpenSecureChannelResponse,Ns_3952: bitstring,ST_3953: bitstring,TTL_3954: bitstring) = m2_3951 in
                                                {3597}let Kcli_3955: bitstring = h((Nc_3947,Ns_3952)) in
                                                {3598}out(c, senc(mCli(pkCli_3612,pkSess_3944),Kcli_3955))
                                )
                                else
                                    {3599}let pkSess_3956: bitstring = fail-any in
                                    {3600}out(c, GetEndpointRequest);
                                    {3601}in(c, (=GetEndpointResponse,=pkSess_3956,=SignAndEncrypt,SP_3957: bitstring,UP_3958: bitstring));
                                    {3602}new Nc_3959: bitstring;
                                    {3603}let m1_3960: bitstring = (OpenSecureChannelRequest,pkCli_3612,Nc_3959) in
                                    {3604}out(c, (pkCli_3612,enc(m1_3960,pkSess_3956),sign(h(m1_3960),skCli_3611)));
                                    {3605}in(c, (em2_3961: bitstring,sigM2_3962: bitstring));
                                    {3606}let m2_3963: bitstring = dec(em2_3961,skCli_3611) in
                                    {3607}if (verify(h(m2_3963),sigM2_3962,pkSess_3956) <> true) then
                                        0
                                    else
                                        {3608}let (=OpenSecureChannelResponse,Ns_3964: bitstring,ST_3965: bitstring,TTL_3966: bitstring) = m2_3963 in
                                        {3609}let Kcli_3967: bitstring = h((Nc_3959,Ns_3964)) in
                                        {3610}out(c, senc(mCli(pkCli_3612,pkSess_3956),Kcli_3967))
                        )
                        else
                            {3611}let pkDisco_3968: bitstring = fail-any in
                            {3612}let v_3969: bool = (Sess = A) in
                            (
                                {3613}if v_3969 then
                                (
                                    {3614}let pkSess_3970: bitstring = pub(skA) in
                                    {3615}out(c, GetEndpointRequest);
                                    {3616}in(c, (=GetEndpointResponse,=pkSess_3970,=SignAndEncrypt,SP_3971: bitstring,UP_3972: bitstring));
                                    {3617}new Nc_3973: bitstring;
                                    {3618}let m1_3974: bitstring = (OpenSecureChannelRequest,pkCli_3612,Nc_3973) in
                                    {3619}out(c, (pkCli_3612,enc(m1_3974,pkSess_3970),sign(h(m1_3974),skCli_3611)));
                                    {3620}in(c, (em2_3975: bitstring,sigM2_3976: bitstring));
                                    {3621}let m2_3977: bitstring = dec(em2_3975,skCli_3611) in
                                    {3622}if (verify(h(m2_3977),sigM2_3976,pkSess_3970) <> true) then
                                        0
                                    else
                                        {3623}let (=OpenSecureChannelResponse,Ns_3978: bitstring,ST_3979: bitstring,TTL_3980: bitstring) = m2_3977 in
                                        {3624}let Kcli_3981: bitstring = h((Nc_3973,Ns_3978)) in
                                        {3625}out(c, senc(mCli(pkCli_3612,pkSess_3970),Kcli_3981))
                                )
                                else
                                    {3626}let v_3982: bool = (Sess = B) in
                                    (
                                        {3627}if v_3982 then
                                        (
                                            {3628}let pkSess_3983: bitstring = pub(skB) in
                                            {3629}out(c, GetEndpointRequest);
                                            {3630}in(c, (=GetEndpointResponse,=pkSess_3983,=SignAndEncrypt,SP_3984: bitstring,UP_3985: bitstring));
                                            {3631}new Nc_3986: bitstring;
                                            {3632}let m1_3987: bitstring = (OpenSecureChannelRequest,pkCli_3612,Nc_3986) in
                                            {3633}out(c, (pkCli_3612,enc(m1_3987,pkSess_3983),sign(h(m1_3987),skCli_3611)));
                                            {3634}in(c, (em2_3988: bitstring,sigM2_3989: bitstring));
                                            {3635}let m2_3990: bitstring = dec(em2_3988,skCli_3611) in
                                            {3636}if (verify(h(m2_3990),sigM2_3989,pkSess_3983) <> true) then
                                                0
                                            else
                                                {3637}let (=OpenSecureChannelResponse,Ns_3991: bitstring,ST_3992: bitstring,TTL_3993: bitstring) = m2_3990 in
                                                {3638}let Kcli_3994: bitstring = h((Nc_3986,Ns_3991)) in
                                                {3639}out(c, senc(mCli(pkCli_3612,pkSess_3983),Kcli_3994))
                                        )
                                        else
                                            {3640}let v_3995: bool = (Sess = C) in
                                            (
                                                {3641}if v_3995 then
                                                (
                                                    {3642}let pkSess_3996: bitstring = pub(skC) in
                                                    {3643}out(c, GetEndpointRequest);
                                                    {3644}in(c, (=GetEndpointResponse,=pkSess_3996,=SignAndEncrypt,SP_3997: bitstring,UP_3998: bitstring));
                                                    {3645}new Nc_3999: bitstring;
                                                    {3646}let m1_4000: bitstring = (OpenSecureChannelRequest,pkCli_3612,Nc_3999) in
                                                    {3647}out(c, (pkCli_3612,enc(m1_4000,pkSess_3996),sign(h(m1_4000),skCli_3611)));
                                                    {3648}in(c, (em2_4001: bitstring,sigM2_4002: bitstring));
                                                    {3649}let m2_4003: bitstring = dec(em2_4001,skCli_3611) in
                                                    {3650}if (verify(h(m2_4003),sigM2_4002,pkSess_3996) <> true) then
                                                        0
                                                    else
                                                        {3651}let (=OpenSecureChannelResponse,Ns_4004: bitstring,ST_4005: bitstring,TTL_4006: bitstring) = m2_4003 in
                                                        {3652}let Kcli_4007: bitstring = h((Nc_3999,Ns_4004)) in
                                                        {3653}out(c, senc(mCli(pkCli_3612,pkSess_3996),Kcli_4007))
                                                )
                                                else
                                                    {3654}let pkSess_4008: bitstring = pub(sk(Sess)) in
                                                    {3655}out(c, GetEndpointRequest);
                                                    {3656}in(c, (=GetEndpointResponse,=pkSess_4008,=SignAndEncrypt,SP_4009: bitstring,UP_4010: bitstring));
                                                    {3657}new Nc_4011: bitstring;
                                                    {3658}let m1_4012: bitstring = (OpenSecureChannelRequest,pkCli_3612,Nc_4011) in
                                                    {3659}out(c, (pkCli_3612,enc(m1_4012,pkSess_4008),sign(h(m1_4012),skCli_3611)));
                                                    {3660}in(c, (em2_4013: bitstring,sigM2_4014: bitstring));
                                                    {3661}let m2_4015: bitstring = dec(em2_4013,skCli_3611) in
                                                    {3662}if (verify(h(m2_4015),sigM2_4014,pkSess_4008) <> true) then
                                                        0
                                                    else
                                                        {3663}let (=OpenSecureChannelResponse,Ns_4016: bitstring,ST_4017: bitstring,TTL_4018: bitstring) = m2_4015 in
                                                        {3664}let Kcli_4019: bitstring = h((Nc_4011,Ns_4016)) in
                                                        {3665}out(c, senc(mCli(pkCli_3612,pkSess_4008),Kcli_4019))
                                            )
                                            else
                                                {3666}let pkSess_4020: bitstring = fail-any in
                                                {3667}out(c, GetEndpointRequest);
                                                {3668}in(c, (=GetEndpointResponse,=pkSess_4020,=SignAndEncrypt,SP_4021: bitstring,UP_4022: bitstring));
                                                {3669}new Nc_4023: bitstring;
                                                {3670}let m1_4024: bitstring = (OpenSecureChannelRequest,pkCli_3612,Nc_4023) in
                                                {3671}out(c, (pkCli_3612,enc(m1_4024,pkSess_4020),sign(h(m1_4024),skCli_3611)));
                                                {3672}in(c, (em2_4025: bitstring,sigM2_4026: bitstring));
                                                {3673}let m2_4027: bitstring = dec(em2_4025,skCli_3611) in
                                                {3674}if (verify(h(m2_4027),sigM2_4026,pkSess_4020) <> true) then
                                                    0
                                                else
                                                    {3675}let (=OpenSecureChannelResponse,Ns_4028: bitstring,ST_4029: bitstring,TTL_4030: bitstring) = m2_4027 in
                                                    {3676}let Kcli_4031: bitstring = h((Nc_4023,Ns_4028)) in
                                                    {3677}out(c, senc(mCli(pkCli_3612,pkSess_4020),Kcli_4031))
                                    )
                                    else
                                        {3678}let pkSess_4032: bitstring = fail-any in
                                        {3679}out(c, GetEndpointRequest);
                                        {3680}in(c, (=GetEndpointResponse,=pkSess_4032,=SignAndEncrypt,SP_4033: bitstring,UP_4034: bitstring));
                                        {3681}new Nc_4035: bitstring;
                                        {3682}let m1_4036: bitstring = (OpenSecureChannelRequest,pkCli_3612,Nc_4035) in
                                        {3683}out(c, (pkCli_3612,enc(m1_4036,pkSess_4032),sign(h(m1_4036),skCli_3611)));
                                        {3684}in(c, (em2_4037: bitstring,sigM2_4038: bitstring));
                                        {3685}let m2_4039: bitstring = dec(em2_4037,skCli_3611) in
                                        {3686}if (verify(h(m2_4039),sigM2_4038,pkSess_4032) <> true) then
                                            0
                                        else
                                            {3687}let (=OpenSecureChannelResponse,Ns_4040: bitstring,ST_4041: bitstring,TTL_4042: bitstring) = m2_4039 in
                                            {3688}let Kcli_4043: bitstring = h((Nc_4035,Ns_4040)) in
                                            {3689}out(c, senc(mCli(pkCli_3612,pkSess_4032),Kcli_4043))
                            )
                            else
                                {3690}let pkSess_4044: bitstring = fail-any in
                                {3691}out(c, GetEndpointRequest);
                                {3692}in(c, (=GetEndpointResponse,=pkSess_4044,=SignAndEncrypt,SP_4045: bitstring,UP_4046: bitstring));
                                {3693}new Nc_4047: bitstring;
                                {3694}let m1_4048: bitstring = (OpenSecureChannelRequest,pkCli_3612,Nc_4047) in
                                {3695}out(c, (pkCli_3612,enc(m1_4048,pkSess_4044),sign(h(m1_4048),skCli_3611)));
                                {3696}in(c, (em2_4049: bitstring,sigM2_4050: bitstring));
                                {3697}let m2_4051: bitstring = dec(em2_4049,skCli_3611) in
                                {3698}if (verify(h(m2_4051),sigM2_4050,pkSess_4044) <> true) then
                                    0
                                else
                                    {3699}let (=OpenSecureChannelResponse,Ns_4052: bitstring,ST_4053: bitstring,TTL_4054: bitstring) = m2_4051 in
                                    {3700}let Kcli_4055: bitstring = h((Nc_4047,Ns_4052)) in
                                    {3701}out(c, senc(mCli(pkCli_3612,pkSess_4044),Kcli_4055))
                )
                else
                    {3702}let pkDisco_4056: bitstring = fail-any in
                    {3703}let v_4057: bool = (Sess = A) in
                    (
                        {3704}if v_4057 then
                        (
                            {3705}let pkSess_4058: bitstring = pub(skA) in
                            {3706}out(c, GetEndpointRequest);
                            {3707}in(c, (=GetEndpointResponse,=pkSess_4058,=SignAndEncrypt,SP_4059: bitstring,UP_4060: bitstring));
                            {3708}new Nc_4061: bitstring;
                            {3709}let m1_4062: bitstring = (OpenSecureChannelRequest,pkCli_3612,Nc_4061) in
                            {3710}out(c, (pkCli_3612,enc(m1_4062,pkSess_4058),sign(h(m1_4062),skCli_3611)));
                            {3711}in(c, (em2_4063: bitstring,sigM2_4064: bitstring));
                            {3712}let m2_4065: bitstring = dec(em2_4063,skCli_3611) in
                            {3713}if (verify(h(m2_4065),sigM2_4064,pkSess_4058) <> true) then
                                0
                            else
                                {3714}let (=OpenSecureChannelResponse,Ns_4066: bitstring,ST_4067: bitstring,TTL_4068: bitstring) = m2_4065 in
                                {3715}let Kcli_4069: bitstring = h((Nc_4061,Ns_4066)) in
                                {3716}out(c, senc(mCli(pkCli_3612,pkSess_4058),Kcli_4069))
                        )
                        else
                            {3717}let v_4070: bool = (Sess = B) in
                            (
                                {3718}if v_4070 then
                                (
                                    {3719}let pkSess_4071: bitstring = pub(skB) in
                                    {3720}out(c, GetEndpointRequest);
                                    {3721}in(c, (=GetEndpointResponse,=pkSess_4071,=SignAndEncrypt,SP_4072: bitstring,UP_4073: bitstring));
                                    {3722}new Nc_4074: bitstring;
                                    {3723}let m1_4075: bitstring = (OpenSecureChannelRequest,pkCli_3612,Nc_4074) in
                                    {3724}out(c, (pkCli_3612,enc(m1_4075,pkSess_4071),sign(h(m1_4075),skCli_3611)));
                                    {3725}in(c, (em2_4076: bitstring,sigM2_4077: bitstring));
                                    {3726}let m2_4078: bitstring = dec(em2_4076,skCli_3611) in
                                    {3727}if (verify(h(m2_4078),sigM2_4077,pkSess_4071) <> true) then
                                        0
                                    else
                                        {3728}let (=OpenSecureChannelResponse,Ns_4079: bitstring,ST_4080: bitstring,TTL_4081: bitstring) = m2_4078 in
                                        {3729}let Kcli_4082: bitstring = h((Nc_4074,Ns_4079)) in
                                        {3730}out(c, senc(mCli(pkCli_3612,pkSess_4071),Kcli_4082))
                                )
                                else
                                    {3731}let v_4083: bool = (Sess = C) in
                                    (
                                        {3732}if v_4083 then
                                        (
                                            {3733}let pkSess_4084: bitstring = pub(skC) in
                                            {3734}out(c, GetEndpointRequest);
                                            {3735}in(c, (=GetEndpointResponse,=pkSess_4084,=SignAndEncrypt,SP_4085: bitstring,UP_4086: bitstring));
                                            {3736}new Nc_4087: bitstring;
                                            {3737}let m1_4088: bitstring = (OpenSecureChannelRequest,pkCli_3612,Nc_4087) in
                                            {3738}out(c, (pkCli_3612,enc(m1_4088,pkSess_4084),sign(h(m1_4088),skCli_3611)));
                                            {3739}in(c, (em2_4089: bitstring,sigM2_4090: bitstring));
                                            {3740}let m2_4091: bitstring = dec(em2_4089,skCli_3611) in
                                            {3741}if (verify(h(m2_4091),sigM2_4090,pkSess_4084) <> true) then
                                                0
                                            else
                                                {3742}let (=OpenSecureChannelResponse,Ns_4092: bitstring,ST_4093: bitstring,TTL_4094: bitstring) = m2_4091 in
                                                {3743}let Kcli_4095: bitstring = h((Nc_4087,Ns_4092)) in
                                                {3744}out(c, senc(mCli(pkCli_3612,pkSess_4084),Kcli_4095))
                                        )
                                        else
                                            {3745}let pkSess_4096: bitstring = pub(sk(Sess)) in
                                            {3746}out(c, GetEndpointRequest);
                                            {3747}in(c, (=GetEndpointResponse,=pkSess_4096,=SignAndEncrypt,SP_4097: bitstring,UP_4098: bitstring));
                                            {3748}new Nc_4099: bitstring;
                                            {3749}let m1_4100: bitstring = (OpenSecureChannelRequest,pkCli_3612,Nc_4099) in
                                            {3750}out(c, (pkCli_3612,enc(m1_4100,pkSess_4096),sign(h(m1_4100),skCli_3611)));
                                            {3751}in(c, (em2_4101: bitstring,sigM2_4102: bitstring));
                                            {3752}let m2_4103: bitstring = dec(em2_4101,skCli_3611) in
                                            {3753}if (verify(h(m2_4103),sigM2_4102,pkSess_4096) <> true) then
                                                0
                                            else
                                                {3754}let (=OpenSecureChannelResponse,Ns_4104: bitstring,ST_4105: bitstring,TTL_4106: bitstring) = m2_4103 in
                                                {3755}let Kcli_4107: bitstring = h((Nc_4099,Ns_4104)) in
                                                {3756}out(c, senc(mCli(pkCli_3612,pkSess_4096),Kcli_4107))
                                    )
                                    else
                                        {3757}let pkSess_4108: bitstring = fail-any in
                                        {3758}out(c, GetEndpointRequest);
                                        {3759}in(c, (=GetEndpointResponse,=pkSess_4108,=SignAndEncrypt,SP_4109: bitstring,UP_4110: bitstring));
                                        {3760}new Nc_4111: bitstring;
                                        {3761}let m1_4112: bitstring = (OpenSecureChannelRequest,pkCli_3612,Nc_4111) in
                                        {3762}out(c, (pkCli_3612,enc(m1_4112,pkSess_4108),sign(h(m1_4112),skCli_3611)));
                                        {3763}in(c, (em2_4113: bitstring,sigM2_4114: bitstring));
                                        {3764}let m2_4115: bitstring = dec(em2_4113,skCli_3611) in
                                        {3765}if (verify(h(m2_4115),sigM2_4114,pkSess_4108) <> true) then
                                            0
                                        else
                                            {3766}let (=OpenSecureChannelResponse,Ns_4116: bitstring,ST_4117: bitstring,TTL_4118: bitstring) = m2_4115 in
                                            {3767}let Kcli_4119: bitstring = h((Nc_4111,Ns_4116)) in
                                            {3768}out(c, senc(mCli(pkCli_3612,pkSess_4108),Kcli_4119))
                            )
                            else
                                {3769}let pkSess_4120: bitstring = fail-any in
                                {3770}out(c, GetEndpointRequest);
                                {3771}in(c, (=GetEndpointResponse,=pkSess_4120,=SignAndEncrypt,SP_4121: bitstring,UP_4122: bitstring));
                                {3772}new Nc_4123: bitstring;
                                {3773}let m1_4124: bitstring = (OpenSecureChannelRequest,pkCli_3612,Nc_4123) in
                                {3774}out(c, (pkCli_3612,enc(m1_4124,pkSess_4120),sign(h(m1_4124),skCli_3611)));
                                {3775}in(c, (em2_4125: bitstring,sigM2_4126: bitstring));
                                {3776}let m2_4127: bitstring = dec(em2_4125,skCli_3611) in
                                {3777}if (verify(h(m2_4127),sigM2_4126,pkSess_4120) <> true) then
                                    0
                                else
                                    {3778}let (=OpenSecureChannelResponse,Ns_4128: bitstring,ST_4129: bitstring,TTL_4130: bitstring) = m2_4127 in
                                    {3779}let Kcli_4131: bitstring = h((Nc_4123,Ns_4128)) in
                                    {3780}out(c, senc(mCli(pkCli_3612,pkSess_4120),Kcli_4131))
                    )
                    else
                        {3781}let pkSess_4132: bitstring = fail-any in
                        {3782}out(c, GetEndpointRequest);
                        {3783}in(c, (=GetEndpointResponse,=pkSess_4132,=SignAndEncrypt,SP_4133: bitstring,UP_4134: bitstring));
                        {3784}new Nc_4135: bitstring;
                        {3785}let m1_4136: bitstring = (OpenSecureChannelRequest,pkCli_3612,Nc_4135) in
                        {3786}out(c, (pkCli_3612,enc(m1_4136,pkSess_4132),sign(h(m1_4136),skCli_3611)));
                        {3787}in(c, (em2_4137: bitstring,sigM2_4138: bitstring));
                        {3788}let m2_4139: bitstring = dec(em2_4137,skCli_3611) in
                        {3789}if (verify(h(m2_4139),sigM2_4138,pkSess_4132) <> true) then
                            0
                        else
                            {3790}let (=OpenSecureChannelResponse,Ns_4140: bitstring,ST_4141: bitstring,TTL_4142: bitstring) = m2_4139 in
                            {3791}let Kcli_4143: bitstring = h((Nc_4135,Ns_4140)) in
                            {3792}out(c, senc(mCli(pkCli_3612,pkSess_4132),Kcli_4143))
        )
        else
            {3793}let pkDisco_4144: bitstring = fail-any in
            {3794}let v_4145: bool = (Sess = A) in
            (
                {3795}if v_4145 then
                (
                    {3796}let pkSess_4146: bitstring = pub(skA) in
                    {3797}out(c, GetEndpointRequest);
                    {3798}in(c, (=GetEndpointResponse,=pkSess_4146,=SignAndEncrypt,SP_4147: bitstring,UP_4148: bitstring));
                    {3799}new Nc_4149: bitstring;
                    {3800}let m1_4150: bitstring = (OpenSecureChannelRequest,pkCli_3612,Nc_4149) in
                    {3801}out(c, (pkCli_3612,enc(m1_4150,pkSess_4146),sign(h(m1_4150),skCli_3611)));
                    {3802}in(c, (em2_4151: bitstring,sigM2_4152: bitstring));
                    {3803}let m2_4153: bitstring = dec(em2_4151,skCli_3611) in
                    {3804}if (verify(h(m2_4153),sigM2_4152,pkSess_4146) <> true) then
                        0
                    else
                        {3805}let (=OpenSecureChannelResponse,Ns_4154: bitstring,ST_4155: bitstring,TTL_4156: bitstring) = m2_4153 in
                        {3806}let Kcli_4157: bitstring = h((Nc_4149,Ns_4154)) in
                        {3807}out(c, senc(mCli(pkCli_3612,pkSess_4146),Kcli_4157))
                )
                else
                    {3808}let v_4158: bool = (Sess = B) in
                    (
                        {3809}if v_4158 then
                        (
                            {3810}let pkSess_4159: bitstring = pub(skB) in
                            {3811}out(c, GetEndpointRequest);
                            {3812}in(c, (=GetEndpointResponse,=pkSess_4159,=SignAndEncrypt,SP_4160: bitstring,UP_4161: bitstring));
                            {3813}new Nc_4162: bitstring;
                            {3814}let m1_4163: bitstring = (OpenSecureChannelRequest,pkCli_3612,Nc_4162) in
                            {3815}out(c, (pkCli_3612,enc(m1_4163,pkSess_4159),sign(h(m1_4163),skCli_3611)));
                            {3816}in(c, (em2_4164: bitstring,sigM2_4165: bitstring));
                            {3817}let m2_4166: bitstring = dec(em2_4164,skCli_3611) in
                            {3818}if (verify(h(m2_4166),sigM2_4165,pkSess_4159) <> true) then
                                0
                            else
                                {3819}let (=OpenSecureChannelResponse,Ns_4167: bitstring,ST_4168: bitstring,TTL_4169: bitstring) = m2_4166 in
                                {3820}let Kcli_4170: bitstring = h((Nc_4162,Ns_4167)) in
                                {3821}out(c, senc(mCli(pkCli_3612,pkSess_4159),Kcli_4170))
                        )
                        else
                            {3822}let v_4171: bool = (Sess = C) in
                            (
                                {3823}if v_4171 then
                                (
                                    {3824}let pkSess_4172: bitstring = pub(skC) in
                                    {3825}out(c, GetEndpointRequest);
                                    {3826}in(c, (=GetEndpointResponse,=pkSess_4172,=SignAndEncrypt,SP_4173: bitstring,UP_4174: bitstring));
                                    {3827}new Nc_4175: bitstring;
                                    {3828}let m1_4176: bitstring = (OpenSecureChannelRequest,pkCli_3612,Nc_4175) in
                                    {3829}out(c, (pkCli_3612,enc(m1_4176,pkSess_4172),sign(h(m1_4176),skCli_3611)));
                                    {3830}in(c, (em2_4177: bitstring,sigM2_4178: bitstring));
                                    {3831}let m2_4179: bitstring = dec(em2_4177,skCli_3611) in
                                    {3832}if (verify(h(m2_4179),sigM2_4178,pkSess_4172) <> true) then
                                        0
                                    else
                                        {3833}let (=OpenSecureChannelResponse,Ns_4180: bitstring,ST_4181: bitstring,TTL_4182: bitstring) = m2_4179 in
                                        {3834}let Kcli_4183: bitstring = h((Nc_4175,Ns_4180)) in
                                        {3835}out(c, senc(mCli(pkCli_3612,pkSess_4172),Kcli_4183))
                                )
                                else
                                    {3836}let pkSess_4184: bitstring = pub(sk(Sess)) in
                                    {3837}out(c, GetEndpointRequest);
                                    {3838}in(c, (=GetEndpointResponse,=pkSess_4184,=SignAndEncrypt,SP_4185: bitstring,UP_4186: bitstring));
                                    {3839}new Nc_4187: bitstring;
                                    {3840}let m1_4188: bitstring = (OpenSecureChannelRequest,pkCli_3612,Nc_4187) in
                                    {3841}out(c, (pkCli_3612,enc(m1_4188,pkSess_4184),sign(h(m1_4188),skCli_3611)));
                                    {3842}in(c, (em2_4189: bitstring,sigM2_4190: bitstring));
                                    {3843}let m2_4191: bitstring = dec(em2_4189,skCli_3611) in
                                    {3844}if (verify(h(m2_4191),sigM2_4190,pkSess_4184) <> true) then
                                        0
                                    else
                                        {3845}let (=OpenSecureChannelResponse,Ns_4192: bitstring,ST_4193: bitstring,TTL_4194: bitstring) = m2_4191 in
                                        {3846}let Kcli_4195: bitstring = h((Nc_4187,Ns_4192)) in
                                        {3847}out(c, senc(mCli(pkCli_3612,pkSess_4184),Kcli_4195))
                            )
                            else
                                {3848}let pkSess_4196: bitstring = fail-any in
                                {3849}out(c, GetEndpointRequest);
                                {3850}in(c, (=GetEndpointResponse,=pkSess_4196,=SignAndEncrypt,SP_4197: bitstring,UP_4198: bitstring));
                                {3851}new Nc_4199: bitstring;
                                {3852}let m1_4200: bitstring = (OpenSecureChannelRequest,pkCli_3612,Nc_4199) in
                                {3853}out(c, (pkCli_3612,enc(m1_4200,pkSess_4196),sign(h(m1_4200),skCli_3611)));
                                {3854}in(c, (em2_4201: bitstring,sigM2_4202: bitstring));
                                {3855}let m2_4203: bitstring = dec(em2_4201,skCli_3611) in
                                {3856}if (verify(h(m2_4203),sigM2_4202,pkSess_4196) <> true) then
                                    0
                                else
                                    {3857}let (=OpenSecureChannelResponse,Ns_4204: bitstring,ST_4205: bitstring,TTL_4206: bitstring) = m2_4203 in
                                    {3858}let Kcli_4207: bitstring = h((Nc_4199,Ns_4204)) in
                                    {3859}out(c, senc(mCli(pkCli_3612,pkSess_4196),Kcli_4207))
                    )
                    else
                        {3860}let pkSess_4208: bitstring = fail-any in
                        {3861}out(c, GetEndpointRequest);
                        {3862}in(c, (=GetEndpointResponse,=pkSess_4208,=SignAndEncrypt,SP_4209: bitstring,UP_4210: bitstring));
                        {3863}new Nc_4211: bitstring;
                        {3864}let m1_4212: bitstring = (OpenSecureChannelRequest,pkCli_3612,Nc_4211) in
                        {3865}out(c, (pkCli_3612,enc(m1_4212,pkSess_4208),sign(h(m1_4212),skCli_3611)));
                        {3866}in(c, (em2_4213: bitstring,sigM2_4214: bitstring));
                        {3867}let m2_4215: bitstring = dec(em2_4213,skCli_3611) in
                        {3868}if (verify(h(m2_4215),sigM2_4214,pkSess_4208) <> true) then
                            0
                        else
                            {3869}let (=OpenSecureChannelResponse,Ns_4216: bitstring,ST_4217: bitstring,TTL_4218: bitstring) = m2_4215 in
                            {3870}let Kcli_4219: bitstring = h((Nc_4211,Ns_4216)) in
                            {3871}out(c, senc(mCli(pkCli_3612,pkSess_4208),Kcli_4219))
            )
            else
                {3872}let pkSess_4220: bitstring = fail-any in
                {3873}out(c, GetEndpointRequest);
                {3874}in(c, (=GetEndpointResponse,=pkSess_4220,=SignAndEncrypt,SP_4221: bitstring,UP_4222: bitstring));
                {3875}new Nc_4223: bitstring;
                {3876}let m1_4224: bitstring = (OpenSecureChannelRequest,pkCli_3612,Nc_4223) in
                {3877}out(c, (pkCli_3612,enc(m1_4224,pkSess_4220),sign(h(m1_4224),skCli_3611)));
                {3878}in(c, (em2_4225: bitstring,sigM2_4226: bitstring));
                {3879}let m2_4227: bitstring = dec(em2_4225,skCli_3611) in
                {3880}if (verify(h(m2_4227),sigM2_4226,pkSess_4220) <> true) then
                    0
                else
                    {3881}let (=OpenSecureChannelResponse,Ns_4228: bitstring,ST_4229: bitstring,TTL_4230: bitstring) = m2_4227 in
                    {3882}let Kcli_4231: bitstring = h((Nc_4223,Ns_4228)) in
                    {3883}out(c, senc(mCli(pkCli_3612,pkSess_4220),Kcli_4231))
) | (
    {3884}!
    {3885}in(c, (Cli_4232: host,Disco_4233: host,Sess_4234: host));
    {3886}let v_4235: bool = (Disco_4233 = A) in
    (
        {3887}if v_4235 then
        (
            {3888}let skDisco: bitstring = skA in
            {3889}let pkDisco_4236: bitstring = pub(skDisco) in
            {3890}let v_4237: bool = (Cli_4232 = A) in
            (
                {3891}if v_4237 then
                (
                    {3892}let pkCli_4238: bitstring = pub(skA) in
                    {3893}let v_4239: bool = (Sess_4234 = A) in
                    (
                        {3894}if v_4239 then
                        (
                            {3895}let pkSess_4240: bitstring = pub(skA) in
                            {3896}in(c, =GetEndpointRequest);
                            {3897}new SP_4241: bitstring;
                            {3898}new UP_4242: bitstring;
                            {3899}out(c, (GetEndpointResponse,pkSess_4240,SignAndEncrypt,SP_4241,UP_4242))
                        )
                        else
                            {3900}let v_4243: bool = (Sess_4234 = B) in
                            (
                                {3901}if v_4243 then
                                (
                                    {3902}let pkSess_4244: bitstring = pub(skB) in
                                    {3903}in(c, =GetEndpointRequest);
                                    {3904}new SP_4245: bitstring;
                                    {3905}new UP_4246: bitstring;
                                    {3906}out(c, (GetEndpointResponse,pkSess_4244,SignAndEncrypt,SP_4245,UP_4246))
                                )
                                else
                                    {3907}let v_4247: bool = (Sess_4234 = C) in
                                    (
                                        {3908}if v_4247 then
                                        (
                                            {3909}let pkSess_4248: bitstring = pub(skC) in
                                            {3910}in(c, =GetEndpointRequest);
                                            {3911}new SP_4249: bitstring;
                                            {3912}new UP_4250: bitstring;
                                            {3913}out(c, (GetEndpointResponse,pkSess_4248,SignAndEncrypt,SP_4249,UP_4250))
                                        )
                                        else
                                            {3914}let pkSess_4251: bitstring = pub(sk(Sess_4234)) in
                                            {3915}in(c, =GetEndpointRequest);
                                            {3916}new SP_4252: bitstring;
                                            {3917}new UP_4253: bitstring;
                                            {3918}out(c, (GetEndpointResponse,pkSess_4251,SignAndEncrypt,SP_4252,UP_4253))
                                    )
                                    else
                                        {3919}let pkSess_4254: bitstring = fail-any in
                                        {3920}in(c, =GetEndpointRequest);
                                        {3921}new SP_4255: bitstring;
                                        {3922}new UP_4256: bitstring;
                                        {3923}out(c, (GetEndpointResponse,pkSess_4254,SignAndEncrypt,SP_4255,UP_4256))
                            )
                            else
                                {3924}let pkSess_4257: bitstring = fail-any in
                                {3925}in(c, =GetEndpointRequest);
                                {3926}new SP_4258: bitstring;
                                {3927}new UP_4259: bitstring;
                                {3928}out(c, (GetEndpointResponse,pkSess_4257,SignAndEncrypt,SP_4258,UP_4259))
                    )
                    else
                        {3929}let pkSess_4260: bitstring = fail-any in
                        {3930}in(c, =GetEndpointRequest);
                        {3931}new SP_4261: bitstring;
                        {3932}new UP_4262: bitstring;
                        {3933}out(c, (GetEndpointResponse,pkSess_4260,SignAndEncrypt,SP_4261,UP_4262))
                )
                else
                    {3934}let v_4263: bool = (Cli_4232 = B) in
                    (
                        {3935}if v_4263 then
                        (
                            {3936}let pkCli_4264: bitstring = pub(skB) in
                            {3937}let v_4265: bool = (Sess_4234 = A) in
                            (
                                {3938}if v_4265 then
                                (
                                    {3939}let pkSess_4266: bitstring = pub(skA) in
                                    {3940}in(c, =GetEndpointRequest);
                                    {3941}new SP_4267: bitstring;
                                    {3942}new UP_4268: bitstring;
                                    {3943}out(c, (GetEndpointResponse,pkSess_4266,SignAndEncrypt,SP_4267,UP_4268))
                                )
                                else
                                    {3944}let v_4269: bool = (Sess_4234 = B) in
                                    (
                                        {3945}if v_4269 then
                                        (
                                            {3946}let pkSess_4270: bitstring = pub(skB) in
                                            {3947}in(c, =GetEndpointRequest);
                                            {3948}new SP_4271: bitstring;
                                            {3949}new UP_4272: bitstring;
                                            {3950}out(c, (GetEndpointResponse,pkSess_4270,SignAndEncrypt,SP_4271,UP_4272))
                                        )
                                        else
                                            {3951}let v_4273: bool = (Sess_4234 = C) in
                                            (
                                                {3952}if v_4273 then
                                                (
                                                    {3953}let pkSess_4274: bitstring = pub(skC) in
                                                    {3954}in(c, =GetEndpointRequest);
                                                    {3955}new SP_4275: bitstring;
                                                    {3956}new UP_4276: bitstring;
                                                    {3957}out(c, (GetEndpointResponse,pkSess_4274,SignAndEncrypt,SP_4275,UP_4276))
                                                )
                                                else
                                                    {3958}let pkSess_4277: bitstring = pub(sk(Sess_4234)) in
                                                    {3959}in(c, =GetEndpointRequest);
                                                    {3960}new SP_4278: bitstring;
                                                    {3961}new UP_4279: bitstring;
                                                    {3962}out(c, (GetEndpointResponse,pkSess_4277,SignAndEncrypt,SP_4278,UP_4279))
                                            )
                                            else
                                                {3963}let pkSess_4280: bitstring = fail-any in
                                                {3964}in(c, =GetEndpointRequest);
                                                {3965}new SP_4281: bitstring;
                                                {3966}new UP_4282: bitstring;
                                                {3967}out(c, (GetEndpointResponse,pkSess_4280,SignAndEncrypt,SP_4281,UP_4282))
                                    )
                                    else
                                        {3968}let pkSess_4283: bitstring = fail-any in
                                        {3969}in(c, =GetEndpointRequest);
                                        {3970}new SP_4284: bitstring;
                                        {3971}new UP_4285: bitstring;
                                        {3972}out(c, (GetEndpointResponse,pkSess_4283,SignAndEncrypt,SP_4284,UP_4285))
                            )
                            else
                                {3973}let pkSess_4286: bitstring = fail-any in
                                {3974}in(c, =GetEndpointRequest);
                                {3975}new SP_4287: bitstring;
                                {3976}new UP_4288: bitstring;
                                {3977}out(c, (GetEndpointResponse,pkSess_4286,SignAndEncrypt,SP_4287,UP_4288))
                        )
                        else
                            {3978}let v_4289: bool = (Cli_4232 = C) in
                            (
                                {3979}if v_4289 then
                                (
                                    {3980}let pkCli_4290: bitstring = pub(skC) in
                                    {3981}let v_4291: bool = (Sess_4234 = A) in
                                    (
                                        {3982}if v_4291 then
                                        (
                                            {3983}let pkSess_4292: bitstring = pub(skA) in
                                            {3984}in(c, =GetEndpointRequest);
                                            {3985}new SP_4293: bitstring;
                                            {3986}new UP_4294: bitstring;
                                            {3987}out(c, (GetEndpointResponse,pkSess_4292,SignAndEncrypt,SP_4293,UP_4294))
                                        )
                                        else
                                            {3988}let v_4295: bool = (Sess_4234 = B) in
                                            (
                                                {3989}if v_4295 then
                                                (
                                                    {3990}let pkSess_4296: bitstring = pub(skB) in
                                                    {3991}in(c, =GetEndpointRequest);
                                                    {3992}new SP_4297: bitstring;
                                                    {3993}new UP_4298: bitstring;
                                                    {3994}out(c, (GetEndpointResponse,pkSess_4296,SignAndEncrypt,SP_4297,UP_4298))
                                                )
                                                else
                                                    {3995}let v_4299: bool = (Sess_4234 = C) in
                                                    (
                                                        {3996}if v_4299 then
                                                        (
                                                            {3997}let pkSess_4300: bitstring = pub(skC) in
                                                            {3998}in(c, =GetEndpointRequest);
                                                            {3999}new SP_4301: bitstring;
                                                            {4000}new UP_4302: bitstring;
                                                            {4001}out(c, (GetEndpointResponse,pkSess_4300,SignAndEncrypt,SP_4301,UP_4302))
                                                        )
                                                        else
                                                            {4002}let pkSess_4303: bitstring = pub(sk(Sess_4234)) in
                                                            {4003}in(c, =GetEndpointRequest);
                                                            {4004}new SP_4304: bitstring;
                                                            {4005}new UP_4305: bitstring;
                                                            {4006}out(c, (GetEndpointResponse,pkSess_4303,SignAndEncrypt,SP_4304,UP_4305))
                                                    )
                                                    else
                                                        {4007}let pkSess_4306: bitstring = fail-any in
                                                        {4008}in(c, =GetEndpointRequest);
                                                        {4009}new SP_4307: bitstring;
                                                        {4010}new UP_4308: bitstring;
                                                        {4011}out(c, (GetEndpointResponse,pkSess_4306,SignAndEncrypt,SP_4307,UP_4308))
                                            )
                                            else
                                                {4012}let pkSess_4309: bitstring = fail-any in
                                                {4013}in(c, =GetEndpointRequest);
                                                {4014}new SP_4310: bitstring;
                                                {4015}new UP_4311: bitstring;
                                                {4016}out(c, (GetEndpointResponse,pkSess_4309,SignAndEncrypt,SP_4310,UP_4311))
                                    )
                                    else
                                        {4017}let pkSess_4312: bitstring = fail-any in
                                        {4018}in(c, =GetEndpointRequest);
                                        {4019}new SP_4313: bitstring;
                                        {4020}new UP_4314: bitstring;
                                        {4021}out(c, (GetEndpointResponse,pkSess_4312,SignAndEncrypt,SP_4313,UP_4314))
                                )
                                else
                                    {4022}let pkCli_4315: bitstring = pub(sk(Cli_4232)) in
                                    {4023}let v_4316: bool = (Sess_4234 = A) in
                                    (
                                        {4024}if v_4316 then
                                        (
                                            {4025}let pkSess_4317: bitstring = pub(skA) in
                                            {4026}in(c, =GetEndpointRequest);
                                            {4027}new SP_4318: bitstring;
                                            {4028}new UP_4319: bitstring;
                                            {4029}out(c, (GetEndpointResponse,pkSess_4317,SignAndEncrypt,SP_4318,UP_4319))
                                        )
                                        else
                                            {4030}let v_4320: bool = (Sess_4234 = B) in
                                            (
                                                {4031}if v_4320 then
                                                (
                                                    {4032}let pkSess_4321: bitstring = pub(skB) in
                                                    {4033}in(c, =GetEndpointRequest);
                                                    {4034}new SP_4322: bitstring;
                                                    {4035}new UP_4323: bitstring;
                                                    {4036}out(c, (GetEndpointResponse,pkSess_4321,SignAndEncrypt,SP_4322,UP_4323))
                                                )
                                                else
                                                    {4037}let v_4324: bool = (Sess_4234 = C) in
                                                    (
                                                        {4038}if v_4324 then
                                                        (
                                                            {4039}let pkSess_4325: bitstring = pub(skC) in
                                                            {4040}in(c, =GetEndpointRequest);
                                                            {4041}new SP_4326: bitstring;
                                                            {4042}new UP_4327: bitstring;
                                                            {4043}out(c, (GetEndpointResponse,pkSess_4325,SignAndEncrypt,SP_4326,UP_4327))
                                                        )
                                                        else
                                                            {4044}let pkSess_4328: bitstring = pub(sk(Sess_4234)) in
                                                            {4045}in(c, =GetEndpointRequest);
                                                            {4046}new SP_4329: bitstring;
                                                            {4047}new UP_4330: bitstring;
                                                            {4048}out(c, (GetEndpointResponse,pkSess_4328,SignAndEncrypt,SP_4329,UP_4330))
                                                    )
                                                    else
                                                        {4049}let pkSess_4331: bitstring = fail-any in
                                                        {4050}in(c, =GetEndpointRequest);
                                                        {4051}new SP_4332: bitstring;
                                                        {4052}new UP_4333: bitstring;
                                                        {4053}out(c, (GetEndpointResponse,pkSess_4331,SignAndEncrypt,SP_4332,UP_4333))
                                            )
                                            else
                                                {4054}let pkSess_4334: bitstring = fail-any in
                                                {4055}in(c, =GetEndpointRequest);
                                                {4056}new SP_4335: bitstring;
                                                {4057}new UP_4336: bitstring;
                                                {4058}out(c, (GetEndpointResponse,pkSess_4334,SignAndEncrypt,SP_4335,UP_4336))
                                    )
                                    else
                                        {4059}let pkSess_4337: bitstring = fail-any in
                                        {4060}in(c, =GetEndpointRequest);
                                        {4061}new SP_4338: bitstring;
                                        {4062}new UP_4339: bitstring;
                                        {4063}out(c, (GetEndpointResponse,pkSess_4337,SignAndEncrypt,SP_4338,UP_4339))
                            )
                            else
                                {4064}let pkCli_4340: bitstring = fail-any in
                                {4065}let v_4341: bool = (Sess_4234 = A) in
                                (
                                    {4066}if v_4341 then
                                    (
                                        {4067}let pkSess_4342: bitstring = pub(skA) in
                                        {4068}in(c, =GetEndpointRequest);
                                        {4069}new SP_4343: bitstring;
                                        {4070}new UP_4344: bitstring;
                                        {4071}out(c, (GetEndpointResponse,pkSess_4342,SignAndEncrypt,SP_4343,UP_4344))
                                    )
                                    else
                                        {4072}let v_4345: bool = (Sess_4234 = B) in
                                        (
                                            {4073}if v_4345 then
                                            (
                                                {4074}let pkSess_4346: bitstring = pub(skB) in
                                                {4075}in(c, =GetEndpointRequest);
                                                {4076}new SP_4347: bitstring;
                                                {4077}new UP_4348: bitstring;
                                                {4078}out(c, (GetEndpointResponse,pkSess_4346,SignAndEncrypt,SP_4347,UP_4348))
                                            )
                                            else
                                                {4079}let v_4349: bool = (Sess_4234 = C) in
                                                (
                                                    {4080}if v_4349 then
                                                    (
                                                        {4081}let pkSess_4350: bitstring = pub(skC) in
                                                        {4082}in(c, =GetEndpointRequest);
                                                        {4083}new SP_4351: bitstring;
                                                        {4084}new UP_4352: bitstring;
                                                        {4085}out(c, (GetEndpointResponse,pkSess_4350,SignAndEncrypt,SP_4351,UP_4352))
                                                    )
                                                    else
                                                        {4086}let pkSess_4353: bitstring = pub(sk(Sess_4234)) in
                                                        {4087}in(c, =GetEndpointRequest);
                                                        {4088}new SP_4354: bitstring;
                                                        {4089}new UP_4355: bitstring;
                                                        {4090}out(c, (GetEndpointResponse,pkSess_4353,SignAndEncrypt,SP_4354,UP_4355))
                                                )
                                                else
                                                    {4091}let pkSess_4356: bitstring = fail-any in
                                                    {4092}in(c, =GetEndpointRequest);
                                                    {4093}new SP_4357: bitstring;
                                                    {4094}new UP_4358: bitstring;
                                                    {4095}out(c, (GetEndpointResponse,pkSess_4356,SignAndEncrypt,SP_4357,UP_4358))
                                        )
                                        else
                                            {4096}let pkSess_4359: bitstring = fail-any in
                                            {4097}in(c, =GetEndpointRequest);
                                            {4098}new SP_4360: bitstring;
                                            {4099}new UP_4361: bitstring;
                                            {4100}out(c, (GetEndpointResponse,pkSess_4359,SignAndEncrypt,SP_4360,UP_4361))
                                )
                                else
                                    {4101}let pkSess_4362: bitstring = fail-any in
                                    {4102}in(c, =GetEndpointRequest);
                                    {4103}new SP_4363: bitstring;
                                    {4104}new UP_4364: bitstring;
                                    {4105}out(c, (GetEndpointResponse,pkSess_4362,SignAndEncrypt,SP_4363,UP_4364))
                    )
                    else
                        {4106}let pkCli_4365: bitstring = fail-any in
                        {4107}let v_4366: bool = (Sess_4234 = A) in
                        (
                            {4108}if v_4366 then
                            (
                                {4109}let pkSess_4367: bitstring = pub(skA) in
                                {4110}in(c, =GetEndpointRequest);
                                {4111}new SP_4368: bitstring;
                                {4112}new UP_4369: bitstring;
                                {4113}out(c, (GetEndpointResponse,pkSess_4367,SignAndEncrypt,SP_4368,UP_4369))
                            )
                            else
                                {4114}let v_4370: bool = (Sess_4234 = B) in
                                (
                                    {4115}if v_4370 then
                                    (
                                        {4116}let pkSess_4371: bitstring = pub(skB) in
                                        {4117}in(c, =GetEndpointRequest);
                                        {4118}new SP_4372: bitstring;
                                        {4119}new UP_4373: bitstring;
                                        {4120}out(c, (GetEndpointResponse,pkSess_4371,SignAndEncrypt,SP_4372,UP_4373))
                                    )
                                    else
                                        {4121}let v_4374: bool = (Sess_4234 = C) in
                                        (
                                            {4122}if v_4374 then
                                            (
                                                {4123}let pkSess_4375: bitstring = pub(skC) in
                                                {4124}in(c, =GetEndpointRequest);
                                                {4125}new SP_4376: bitstring;
                                                {4126}new UP_4377: bitstring;
                                                {4127}out(c, (GetEndpointResponse,pkSess_4375,SignAndEncrypt,SP_4376,UP_4377))
                                            )
                                            else
                                                {4128}let pkSess_4378: bitstring = pub(sk(Sess_4234)) in
                                                {4129}in(c, =GetEndpointRequest);
                                                {4130}new SP_4379: bitstring;
                                                {4131}new UP_4380: bitstring;
                                                {4132}out(c, (GetEndpointResponse,pkSess_4378,SignAndEncrypt,SP_4379,UP_4380))
                                        )
                                        else
                                            {4133}let pkSess_4381: bitstring = fail-any in
                                            {4134}in(c, =GetEndpointRequest);
                                            {4135}new SP_4382: bitstring;
                                            {4136}new UP_4383: bitstring;
                                            {4137}out(c, (GetEndpointResponse,pkSess_4381,SignAndEncrypt,SP_4382,UP_4383))
                                )
                                else
                                    {4138}let pkSess_4384: bitstring = fail-any in
                                    {4139}in(c, =GetEndpointRequest);
                                    {4140}new SP_4385: bitstring;
                                    {4141}new UP_4386: bitstring;
                                    {4142}out(c, (GetEndpointResponse,pkSess_4384,SignAndEncrypt,SP_4385,UP_4386))
                        )
                        else
                            {4143}let pkSess_4387: bitstring = fail-any in
                            {4144}in(c, =GetEndpointRequest);
                            {4145}new SP_4388: bitstring;
                            {4146}new UP_4389: bitstring;
                            {4147}out(c, (GetEndpointResponse,pkSess_4387,SignAndEncrypt,SP_4388,UP_4389))
            )
            else
                {4148}let pkCli_4390: bitstring = fail-any in
                {4149}let v_4391: bool = (Sess_4234 = A) in
                (
                    {4150}if v_4391 then
                    (
                        {4151}let pkSess_4392: bitstring = pub(skA) in
                        {4152}in(c, =GetEndpointRequest);
                        {4153}new SP_4393: bitstring;
                        {4154}new UP_4394: bitstring;
                        {4155}out(c, (GetEndpointResponse,pkSess_4392,SignAndEncrypt,SP_4393,UP_4394))
                    )
                    else
                        {4156}let v_4395: bool = (Sess_4234 = B) in
                        (
                            {4157}if v_4395 then
                            (
                                {4158}let pkSess_4396: bitstring = pub(skB) in
                                {4159}in(c, =GetEndpointRequest);
                                {4160}new SP_4397: bitstring;
                                {4161}new UP_4398: bitstring;
                                {4162}out(c, (GetEndpointResponse,pkSess_4396,SignAndEncrypt,SP_4397,UP_4398))
                            )
                            else
                                {4163}let v_4399: bool = (Sess_4234 = C) in
                                (
                                    {4164}if v_4399 then
                                    (
                                        {4165}let pkSess_4400: bitstring = pub(skC) in
                                        {4166}in(c, =GetEndpointRequest);
                                        {4167}new SP_4401: bitstring;
                                        {4168}new UP_4402: bitstring;
                                        {4169}out(c, (GetEndpointResponse,pkSess_4400,SignAndEncrypt,SP_4401,UP_4402))
                                    )
                                    else
                                        {4170}let pkSess_4403: bitstring = pub(sk(Sess_4234)) in
                                        {4171}in(c, =GetEndpointRequest);
                                        {4172}new SP_4404: bitstring;
                                        {4173}new UP_4405: bitstring;
                                        {4174}out(c, (GetEndpointResponse,pkSess_4403,SignAndEncrypt,SP_4404,UP_4405))
                                )
                                else
                                    {4175}let pkSess_4406: bitstring = fail-any in
                                    {4176}in(c, =GetEndpointRequest);
                                    {4177}new SP_4407: bitstring;
                                    {4178}new UP_4408: bitstring;
                                    {4179}out(c, (GetEndpointResponse,pkSess_4406,SignAndEncrypt,SP_4407,UP_4408))
                        )
                        else
                            {4180}let pkSess_4409: bitstring = fail-any in
                            {4181}in(c, =GetEndpointRequest);
                            {4182}new SP_4410: bitstring;
                            {4183}new UP_4411: bitstring;
                            {4184}out(c, (GetEndpointResponse,pkSess_4409,SignAndEncrypt,SP_4410,UP_4411))
                )
                else
                    {4185}let pkSess_4412: bitstring = fail-any in
                    {4186}in(c, =GetEndpointRequest);
                    {4187}new SP_4413: bitstring;
                    {4188}new UP_4414: bitstring;
                    {4189}out(c, (GetEndpointResponse,pkSess_4412,SignAndEncrypt,SP_4413,UP_4414))
        )
        else
            {4190}let v_4415: bool = (Disco_4233 = B) in
            (
                {4191}if v_4415 then
                (
                    {4192}let skDisco_4416: bitstring = skB in
                    {4193}let pkDisco_4417: bitstring = pub(skDisco_4416) in
                    {4194}let v_4418: bool = (Cli_4232 = A) in
                    (
                        {4195}if v_4418 then
                        (
                            {4196}let pkCli_4419: bitstring = pub(skA) in
                            {4197}let v_4420: bool = (Sess_4234 = A) in
                            (
                                {4198}if v_4420 then
                                (
                                    {4199}let pkSess_4421: bitstring = pub(skA) in
                                    {4200}in(c, =GetEndpointRequest);
                                    {4201}new SP_4422: bitstring;
                                    {4202}new UP_4423: bitstring;
                                    {4203}out(c, (GetEndpointResponse,pkSess_4421,SignAndEncrypt,SP_4422,UP_4423))
                                )
                                else
                                    {4204}let v_4424: bool = (Sess_4234 = B) in
                                    (
                                        {4205}if v_4424 then
                                        (
                                            {4206}let pkSess_4425: bitstring = pub(skB) in
                                            {4207}in(c, =GetEndpointRequest);
                                            {4208}new SP_4426: bitstring;
                                            {4209}new UP_4427: bitstring;
                                            {4210}out(c, (GetEndpointResponse,pkSess_4425,SignAndEncrypt,SP_4426,UP_4427))
                                        )
                                        else
                                            {4211}let v_4428: bool = (Sess_4234 = C) in
                                            (
                                                {4212}if v_4428 then
                                                (
                                                    {4213}let pkSess_4429: bitstring = pub(skC) in
                                                    {4214}in(c, =GetEndpointRequest);
                                                    {4215}new SP_4430: bitstring;
                                                    {4216}new UP_4431: bitstring;
                                                    {4217}out(c, (GetEndpointResponse,pkSess_4429,SignAndEncrypt,SP_4430,UP_4431))
                                                )
                                                else
                                                    {4218}let pkSess_4432: bitstring = pub(sk(Sess_4234)) in
                                                    {4219}in(c, =GetEndpointRequest);
                                                    {4220}new SP_4433: bitstring;
                                                    {4221}new UP_4434: bitstring;
                                                    {4222}out(c, (GetEndpointResponse,pkSess_4432,SignAndEncrypt,SP_4433,UP_4434))
                                            )
                                            else
                                                {4223}let pkSess_4435: bitstring = fail-any in
                                                {4224}in(c, =GetEndpointRequest);
                                                {4225}new SP_4436: bitstring;
                                                {4226}new UP_4437: bitstring;
                                                {4227}out(c, (GetEndpointResponse,pkSess_4435,SignAndEncrypt,SP_4436,UP_4437))
                                    )
                                    else
                                        {4228}let pkSess_4438: bitstring = fail-any in
                                        {4229}in(c, =GetEndpointRequest);
                                        {4230}new SP_4439: bitstring;
                                        {4231}new UP_4440: bitstring;
                                        {4232}out(c, (GetEndpointResponse,pkSess_4438,SignAndEncrypt,SP_4439,UP_4440))
                            )
                            else
                                {4233}let pkSess_4441: bitstring = fail-any in
                                {4234}in(c, =GetEndpointRequest);
                                {4235}new SP_4442: bitstring;
                                {4236}new UP_4443: bitstring;
                                {4237}out(c, (GetEndpointResponse,pkSess_4441,SignAndEncrypt,SP_4442,UP_4443))
                        )
                        else
                            {4238}let v_4444: bool = (Cli_4232 = B) in
                            (
                                {4239}if v_4444 then
                                (
                                    {4240}let pkCli_4445: bitstring = pub(skB) in
                                    {4241}let v_4446: bool = (Sess_4234 = A) in
                                    (
                                        {4242}if v_4446 then
                                        (
                                            {4243}let pkSess_4447: bitstring = pub(skA) in
                                            {4244}in(c, =GetEndpointRequest);
                                            {4245}new SP_4448: bitstring;
                                            {4246}new UP_4449: bitstring;
                                            {4247}out(c, (GetEndpointResponse,pkSess_4447,SignAndEncrypt,SP_4448,UP_4449))
                                        )
                                        else
                                            {4248}let v_4450: bool = (Sess_4234 = B) in
                                            (
                                                {4249}if v_4450 then
                                                (
                                                    {4250}let pkSess_4451: bitstring = pub(skB) in
                                                    {4251}in(c, =GetEndpointRequest);
                                                    {4252}new SP_4452: bitstring;
                                                    {4253}new UP_4453: bitstring;
                                                    {4254}out(c, (GetEndpointResponse,pkSess_4451,SignAndEncrypt,SP_4452,UP_4453))
                                                )
                                                else
                                                    {4255}let v_4454: bool = (Sess_4234 = C) in
                                                    (
                                                        {4256}if v_4454 then
                                                        (
                                                            {4257}let pkSess_4455: bitstring = pub(skC) in
                                                            {4258}in(c, =GetEndpointRequest);
                                                            {4259}new SP_4456: bitstring;
                                                            {4260}new UP_4457: bitstring;
                                                            {4261}out(c, (GetEndpointResponse,pkSess_4455,SignAndEncrypt,SP_4456,UP_4457))
                                                        )
                                                        else
                                                            {4262}let pkSess_4458: bitstring = pub(sk(Sess_4234)) in
                                                            {4263}in(c, =GetEndpointRequest);
                                                            {4264}new SP_4459: bitstring;
                                                            {4265}new UP_4460: bitstring;
                                                            {4266}out(c, (GetEndpointResponse,pkSess_4458,SignAndEncrypt,SP_4459,UP_4460))
                                                    )
                                                    else
                                                        {4267}let pkSess_4461: bitstring = fail-any in
                                                        {4268}in(c, =GetEndpointRequest);
                                                        {4269}new SP_4462: bitstring;
                                                        {4270}new UP_4463: bitstring;
                                                        {4271}out(c, (GetEndpointResponse,pkSess_4461,SignAndEncrypt,SP_4462,UP_4463))
                                            )
                                            else
                                                {4272}let pkSess_4464: bitstring = fail-any in
                                                {4273}in(c, =GetEndpointRequest);
                                                {4274}new SP_4465: bitstring;
                                                {4275}new UP_4466: bitstring;
                                                {4276}out(c, (GetEndpointResponse,pkSess_4464,SignAndEncrypt,SP_4465,UP_4466))
                                    )
                                    else
                                        {4277}let pkSess_4467: bitstring = fail-any in
                                        {4278}in(c, =GetEndpointRequest);
                                        {4279}new SP_4468: bitstring;
                                        {4280}new UP_4469: bitstring;
                                        {4281}out(c, (GetEndpointResponse,pkSess_4467,SignAndEncrypt,SP_4468,UP_4469))
                                )
                                else
                                    {4282}let v_4470: bool = (Cli_4232 = C) in
                                    (
                                        {4283}if v_4470 then
                                        (
                                            {4284}let pkCli_4471: bitstring = pub(skC) in
                                            {4285}let v_4472: bool = (Sess_4234 = A) in
                                            (
                                                {4286}if v_4472 then
                                                (
                                                    {4287}let pkSess_4473: bitstring = pub(skA) in
                                                    {4288}in(c, =GetEndpointRequest);
                                                    {4289}new SP_4474: bitstring;
                                                    {4290}new UP_4475: bitstring;
                                                    {4291}out(c, (GetEndpointResponse,pkSess_4473,SignAndEncrypt,SP_4474,UP_4475))
                                                )
                                                else
                                                    {4292}let v_4476: bool = (Sess_4234 = B) in
                                                    (
                                                        {4293}if v_4476 then
                                                        (
                                                            {4294}let pkSess_4477: bitstring = pub(skB) in
                                                            {4295}in(c, =GetEndpointRequest);
                                                            {4296}new SP_4478: bitstring;
                                                            {4297}new UP_4479: bitstring;
                                                            {4298}out(c, (GetEndpointResponse,pkSess_4477,SignAndEncrypt,SP_4478,UP_4479))
                                                        )
                                                        else
                                                            {4299}let v_4480: bool = (Sess_4234 = C) in
                                                            (
                                                                {4300}if v_4480 then
                                                                (
                                                                    {4301}let pkSess_4481: bitstring = pub(skC) in
                                                                    {4302}in(c, =GetEndpointRequest);
                                                                    {4303}new SP_4482: bitstring;
                                                                    {4304}new UP_4483: bitstring;
                                                                    {4305}out(c, (GetEndpointResponse,pkSess_4481,SignAndEncrypt,SP_4482,UP_4483))
                                                                )
                                                                else
                                                                    {4306}let pkSess_4484: bitstring = pub(sk(Sess_4234)) in
                                                                    {4307}in(c, =GetEndpointRequest);
                                                                    {4308}new SP_4485: bitstring;
                                                                    {4309}new UP_4486: bitstring;
                                                                    {4310}out(c, (GetEndpointResponse,pkSess_4484,SignAndEncrypt,SP_4485,UP_4486))
                                                            )
                                                            else
                                                                {4311}let pkSess_4487: bitstring = fail-any in
                                                                {4312}in(c, =GetEndpointRequest);
                                                                {4313}new SP_4488: bitstring;
                                                                {4314}new UP_4489: bitstring;
                                                                {4315}out(c, (GetEndpointResponse,pkSess_4487,SignAndEncrypt,SP_4488,UP_4489))
                                                    )
                                                    else
                                                        {4316}let pkSess_4490: bitstring = fail-any in
                                                        {4317}in(c, =GetEndpointRequest);
                                                        {4318}new SP_4491: bitstring;
                                                        {4319}new UP_4492: bitstring;
                                                        {4320}out(c, (GetEndpointResponse,pkSess_4490,SignAndEncrypt,SP_4491,UP_4492))
                                            )
                                            else
                                                {4321}let pkSess_4493: bitstring = fail-any in
                                                {4322}in(c, =GetEndpointRequest);
                                                {4323}new SP_4494: bitstring;
                                                {4324}new UP_4495: bitstring;
                                                {4325}out(c, (GetEndpointResponse,pkSess_4493,SignAndEncrypt,SP_4494,UP_4495))
                                        )
                                        else
                                            {4326}let pkCli_4496: bitstring = pub(sk(Cli_4232)) in
                                            {4327}let v_4497: bool = (Sess_4234 = A) in
                                            (
                                                {4328}if v_4497 then
                                                (
                                                    {4329}let pkSess_4498: bitstring = pub(skA) in
                                                    {4330}in(c, =GetEndpointRequest);
                                                    {4331}new SP_4499: bitstring;
                                                    {4332}new UP_4500: bitstring;
                                                    {4333}out(c, (GetEndpointResponse,pkSess_4498,SignAndEncrypt,SP_4499,UP_4500))
                                                )
                                                else
                                                    {4334}let v_4501: bool = (Sess_4234 = B) in
                                                    (
                                                        {4335}if v_4501 then
                                                        (
                                                            {4336}let pkSess_4502: bitstring = pub(skB) in
                                                            {4337}in(c, =GetEndpointRequest);
                                                            {4338}new SP_4503: bitstring;
                                                            {4339}new UP_4504: bitstring;
                                                            {4340}out(c, (GetEndpointResponse,pkSess_4502,SignAndEncrypt,SP_4503,UP_4504))
                                                        )
                                                        else
                                                            {4341}let v_4505: bool = (Sess_4234 = C) in
                                                            (
                                                                {4342}if v_4505 then
                                                                (
                                                                    {4343}let pkSess_4506: bitstring = pub(skC) in
                                                                    {4344}in(c, =GetEndpointRequest);
                                                                    {4345}new SP_4507: bitstring;
                                                                    {4346}new UP_4508: bitstring;
                                                                    {4347}out(c, (GetEndpointResponse,pkSess_4506,SignAndEncrypt,SP_4507,UP_4508))
                                                                )
                                                                else
                                                                    {4348}let pkSess_4509: bitstring = pub(sk(Sess_4234)) in
                                                                    {4349}in(c, =GetEndpointRequest);
                                                                    {4350}new SP_4510: bitstring;
                                                                    {4351}new UP_4511: bitstring;
                                                                    {4352}out(c, (GetEndpointResponse,pkSess_4509,SignAndEncrypt,SP_4510,UP_4511))
                                                            )
                                                            else
                                                                {4353}let pkSess_4512: bitstring = fail-any in
                                                                {4354}in(c, =GetEndpointRequest);
                                                                {4355}new SP_4513: bitstring;
                                                                {4356}new UP_4514: bitstring;
                                                                {4357}out(c, (GetEndpointResponse,pkSess_4512,SignAndEncrypt,SP_4513,UP_4514))
                                                    )
                                                    else
                                                        {4358}let pkSess_4515: bitstring = fail-any in
                                                        {4359}in(c, =GetEndpointRequest);
                                                        {4360}new SP_4516: bitstring;
                                                        {4361}new UP_4517: bitstring;
                                                        {4362}out(c, (GetEndpointResponse,pkSess_4515,SignAndEncrypt,SP_4516,UP_4517))
                                            )
                                            else
                                                {4363}let pkSess_4518: bitstring = fail-any in
                                                {4364}in(c, =GetEndpointRequest);
                                                {4365}new SP_4519: bitstring;
                                                {4366}new UP_4520: bitstring;
                                                {4367}out(c, (GetEndpointResponse,pkSess_4518,SignAndEncrypt,SP_4519,UP_4520))
                                    )
                                    else
                                        {4368}let pkCli_4521: bitstring = fail-any in
                                        {4369}let v_4522: bool = (Sess_4234 = A) in
                                        (
                                            {4370}if v_4522 then
                                            (
                                                {4371}let pkSess_4523: bitstring = pub(skA) in
                                                {4372}in(c, =GetEndpointRequest);
                                                {4373}new SP_4524: bitstring;
                                                {4374}new UP_4525: bitstring;
                                                {4375}out(c, (GetEndpointResponse,pkSess_4523,SignAndEncrypt,SP_4524,UP_4525))
                                            )
                                            else
                                                {4376}let v_4526: bool = (Sess_4234 = B) in
                                                (
                                                    {4377}if v_4526 then
                                                    (
                                                        {4378}let pkSess_4527: bitstring = pub(skB) in
                                                        {4379}in(c, =GetEndpointRequest);
                                                        {4380}new SP_4528: bitstring;
                                                        {4381}new UP_4529: bitstring;
                                                        {4382}out(c, (GetEndpointResponse,pkSess_4527,SignAndEncrypt,SP_4528,UP_4529))
                                                    )
                                                    else
                                                        {4383}let v_4530: bool = (Sess_4234 = C) in
                                                        (
                                                            {4384}if v_4530 then
                                                            (
                                                                {4385}let pkSess_4531: bitstring = pub(skC) in
                                                                {4386}in(c, =GetEndpointRequest);
                                                                {4387}new SP_4532: bitstring;
                                                                {4388}new UP_4533: bitstring;
                                                                {4389}out(c, (GetEndpointResponse,pkSess_4531,SignAndEncrypt,SP_4532,UP_4533))
                                                            )
                                                            else
                                                                {4390}let pkSess_4534: bitstring = pub(sk(Sess_4234)) in
                                                                {4391}in(c, =GetEndpointRequest);
                                                                {4392}new SP_4535: bitstring;
                                                                {4393}new UP_4536: bitstring;
                                                                {4394}out(c, (GetEndpointResponse,pkSess_4534,SignAndEncrypt,SP_4535,UP_4536))
                                                        )
                                                        else
                                                            {4395}let pkSess_4537: bitstring = fail-any in
                                                            {4396}in(c, =GetEndpointRequest);
                                                            {4397}new SP_4538: bitstring;
                                                            {4398}new UP_4539: bitstring;
                                                            {4399}out(c, (GetEndpointResponse,pkSess_4537,SignAndEncrypt,SP_4538,UP_4539))
                                                )
                                                else
                                                    {4400}let pkSess_4540: bitstring = fail-any in
                                                    {4401}in(c, =GetEndpointRequest);
                                                    {4402}new SP_4541: bitstring;
                                                    {4403}new UP_4542: bitstring;
                                                    {4404}out(c, (GetEndpointResponse,pkSess_4540,SignAndEncrypt,SP_4541,UP_4542))
                                        )
                                        else
                                            {4405}let pkSess_4543: bitstring = fail-any in
                                            {4406}in(c, =GetEndpointRequest);
                                            {4407}new SP_4544: bitstring;
                                            {4408}new UP_4545: bitstring;
                                            {4409}out(c, (GetEndpointResponse,pkSess_4543,SignAndEncrypt,SP_4544,UP_4545))
                            )
                            else
                                {4410}let pkCli_4546: bitstring = fail-any in
                                {4411}let v_4547: bool = (Sess_4234 = A) in
                                (
                                    {4412}if v_4547 then
                                    (
                                        {4413}let pkSess_4548: bitstring = pub(skA) in
                                        {4414}in(c, =GetEndpointRequest);
                                        {4415}new SP_4549: bitstring;
                                        {4416}new UP_4550: bitstring;
                                        {4417}out(c, (GetEndpointResponse,pkSess_4548,SignAndEncrypt,SP_4549,UP_4550))
                                    )
                                    else
                                        {4418}let v_4551: bool = (Sess_4234 = B) in
                                        (
                                            {4419}if v_4551 then
                                            (
                                                {4420}let pkSess_4552: bitstring = pub(skB) in
                                                {4421}in(c, =GetEndpointRequest);
                                                {4422}new SP_4553: bitstring;
                                                {4423}new UP_4554: bitstring;
                                                {4424}out(c, (GetEndpointResponse,pkSess_4552,SignAndEncrypt,SP_4553,UP_4554))
                                            )
                                            else
                                                {4425}let v_4555: bool = (Sess_4234 = C) in
                                                (
                                                    {4426}if v_4555 then
                                                    (
                                                        {4427}let pkSess_4556: bitstring = pub(skC) in
                                                        {4428}in(c, =GetEndpointRequest);
                                                        {4429}new SP_4557: bitstring;
                                                        {4430}new UP_4558: bitstring;
                                                        {4431}out(c, (GetEndpointResponse,pkSess_4556,SignAndEncrypt,SP_4557,UP_4558))
                                                    )
                                                    else
                                                        {4432}let pkSess_4559: bitstring = pub(sk(Sess_4234)) in
                                                        {4433}in(c, =GetEndpointRequest);
                                                        {4434}new SP_4560: bitstring;
                                                        {4435}new UP_4561: bitstring;
                                                        {4436}out(c, (GetEndpointResponse,pkSess_4559,SignAndEncrypt,SP_4560,UP_4561))
                                                )
                                                else
                                                    {4437}let pkSess_4562: bitstring = fail-any in
                                                    {4438}in(c, =GetEndpointRequest);
                                                    {4439}new SP_4563: bitstring;
                                                    {4440}new UP_4564: bitstring;
                                                    {4441}out(c, (GetEndpointResponse,pkSess_4562,SignAndEncrypt,SP_4563,UP_4564))
                                        )
                                        else
                                            {4442}let pkSess_4565: bitstring = fail-any in
                                            {4443}in(c, =GetEndpointRequest);
                                            {4444}new SP_4566: bitstring;
                                            {4445}new UP_4567: bitstring;
                                            {4446}out(c, (GetEndpointResponse,pkSess_4565,SignAndEncrypt,SP_4566,UP_4567))
                                )
                                else
                                    {4447}let pkSess_4568: bitstring = fail-any in
                                    {4448}in(c, =GetEndpointRequest);
                                    {4449}new SP_4569: bitstring;
                                    {4450}new UP_4570: bitstring;
                                    {4451}out(c, (GetEndpointResponse,pkSess_4568,SignAndEncrypt,SP_4569,UP_4570))
                    )
                    else
                        {4452}let pkCli_4571: bitstring = fail-any in
                        {4453}let v_4572: bool = (Sess_4234 = A) in
                        (
                            {4454}if v_4572 then
                            (
                                {4455}let pkSess_4573: bitstring = pub(skA) in
                                {4456}in(c, =GetEndpointRequest);
                                {4457}new SP_4574: bitstring;
                                {4458}new UP_4575: bitstring;
                                {4459}out(c, (GetEndpointResponse,pkSess_4573,SignAndEncrypt,SP_4574,UP_4575))
                            )
                            else
                                {4460}let v_4576: bool = (Sess_4234 = B) in
                                (
                                    {4461}if v_4576 then
                                    (
                                        {4462}let pkSess_4577: bitstring = pub(skB) in
                                        {4463}in(c, =GetEndpointRequest);
                                        {4464}new SP_4578: bitstring;
                                        {4465}new UP_4579: bitstring;
                                        {4466}out(c, (GetEndpointResponse,pkSess_4577,SignAndEncrypt,SP_4578,UP_4579))
                                    )
                                    else
                                        {4467}let v_4580: bool = (Sess_4234 = C) in
                                        (
                                            {4468}if v_4580 then
                                            (
                                                {4469}let pkSess_4581: bitstring = pub(skC) in
                                                {4470}in(c, =GetEndpointRequest);
                                                {4471}new SP_4582: bitstring;
                                                {4472}new UP_4583: bitstring;
                                                {4473}out(c, (GetEndpointResponse,pkSess_4581,SignAndEncrypt,SP_4582,UP_4583))
                                            )
                                            else
                                                {4474}let pkSess_4584: bitstring = pub(sk(Sess_4234)) in
                                                {4475}in(c, =GetEndpointRequest);
                                                {4476}new SP_4585: bitstring;
                                                {4477}new UP_4586: bitstring;
                                                {4478}out(c, (GetEndpointResponse,pkSess_4584,SignAndEncrypt,SP_4585,UP_4586))
                                        )
                                        else
                                            {4479}let pkSess_4587: bitstring = fail-any in
                                            {4480}in(c, =GetEndpointRequest);
                                            {4481}new SP_4588: bitstring;
                                            {4482}new UP_4589: bitstring;
                                            {4483}out(c, (GetEndpointResponse,pkSess_4587,SignAndEncrypt,SP_4588,UP_4589))
                                )
                                else
                                    {4484}let pkSess_4590: bitstring = fail-any in
                                    {4485}in(c, =GetEndpointRequest);
                                    {4486}new SP_4591: bitstring;
                                    {4487}new UP_4592: bitstring;
                                    {4488}out(c, (GetEndpointResponse,pkSess_4590,SignAndEncrypt,SP_4591,UP_4592))
                        )
                        else
                            {4489}let pkSess_4593: bitstring = fail-any in
                            {4490}in(c, =GetEndpointRequest);
                            {4491}new SP_4594: bitstring;
                            {4492}new UP_4595: bitstring;
                            {4493}out(c, (GetEndpointResponse,pkSess_4593,SignAndEncrypt,SP_4594,UP_4595))
                )
                else
                    {4494}let =true = (Disco_4233 = C) in
                    (
                        {4495}let skDisco_4596: bitstring = skC in
                        {4496}let pkDisco_4597: bitstring = pub(skDisco_4596) in
                        {4497}let v_4598: bool = (Cli_4232 = A) in
                        (
                            {4498}if v_4598 then
                            (
                                {4499}let pkCli_4599: bitstring = pub(skA) in
                                {4500}let v_4600: bool = (Sess_4234 = A) in
                                (
                                    {4501}if v_4600 then
                                    (
                                        {4502}let pkSess_4601: bitstring = pub(skA) in
                                        {4503}in(c, =GetEndpointRequest);
                                        {4504}new SP_4602: bitstring;
                                        {4505}new UP_4603: bitstring;
                                        {4506}out(c, (GetEndpointResponse,pkSess_4601,SignAndEncrypt,SP_4602,UP_4603))
                                    )
                                    else
                                        {4507}let v_4604: bool = (Sess_4234 = B) in
                                        (
                                            {4508}if v_4604 then
                                            (
                                                {4509}let pkSess_4605: bitstring = pub(skB) in
                                                {4510}in(c, =GetEndpointRequest);
                                                {4511}new SP_4606: bitstring;
                                                {4512}new UP_4607: bitstring;
                                                {4513}out(c, (GetEndpointResponse,pkSess_4605,SignAndEncrypt,SP_4606,UP_4607))
                                            )
                                            else
                                                {4514}let v_4608: bool = (Sess_4234 = C) in
                                                (
                                                    {4515}if v_4608 then
                                                    (
                                                        {4516}let pkSess_4609: bitstring = pub(skC) in
                                                        {4517}in(c, =GetEndpointRequest);
                                                        {4518}new SP_4610: bitstring;
                                                        {4519}new UP_4611: bitstring;
                                                        {4520}out(c, (GetEndpointResponse,pkSess_4609,SignAndEncrypt,SP_4610,UP_4611))
                                                    )
                                                    else
                                                        {4521}let pkSess_4612: bitstring = pub(sk(Sess_4234)) in
                                                        {4522}in(c, =GetEndpointRequest);
                                                        {4523}new SP_4613: bitstring;
                                                        {4524}new UP_4614: bitstring;
                                                        {4525}out(c, (GetEndpointResponse,pkSess_4612,SignAndEncrypt,SP_4613,UP_4614))
                                                )
                                                else
                                                    {4526}let pkSess_4615: bitstring = fail-any in
                                                    {4527}in(c, =GetEndpointRequest);
                                                    {4528}new SP_4616: bitstring;
                                                    {4529}new UP_4617: bitstring;
                                                    {4530}out(c, (GetEndpointResponse,pkSess_4615,SignAndEncrypt,SP_4616,UP_4617))
                                        )
                                        else
                                            {4531}let pkSess_4618: bitstring = fail-any in
                                            {4532}in(c, =GetEndpointRequest);
                                            {4533}new SP_4619: bitstring;
                                            {4534}new UP_4620: bitstring;
                                            {4535}out(c, (GetEndpointResponse,pkSess_4618,SignAndEncrypt,SP_4619,UP_4620))
                                )
                                else
                                    {4536}let pkSess_4621: bitstring = fail-any in
                                    {4537}in(c, =GetEndpointRequest);
                                    {4538}new SP_4622: bitstring;
                                    {4539}new UP_4623: bitstring;
                                    {4540}out(c, (GetEndpointResponse,pkSess_4621,SignAndEncrypt,SP_4622,UP_4623))
                            )
                            else
                                {4541}let v_4624: bool = (Cli_4232 = B) in
                                (
                                    {4542}if v_4624 then
                                    (
                                        {4543}let pkCli_4625: bitstring = pub(skB) in
                                        {4544}let v_4626: bool = (Sess_4234 = A) in
                                        (
                                            {4545}if v_4626 then
                                            (
                                                {4546}let pkSess_4627: bitstring = pub(skA) in
                                                {4547}in(c, =GetEndpointRequest);
                                                {4548}new SP_4628: bitstring;
                                                {4549}new UP_4629: bitstring;
                                                {4550}out(c, (GetEndpointResponse,pkSess_4627,SignAndEncrypt,SP_4628,UP_4629))
                                            )
                                            else
                                                {4551}let v_4630: bool = (Sess_4234 = B) in
                                                (
                                                    {4552}if v_4630 then
                                                    (
                                                        {4553}let pkSess_4631: bitstring = pub(skB) in
                                                        {4554}in(c, =GetEndpointRequest);
                                                        {4555}new SP_4632: bitstring;
                                                        {4556}new UP_4633: bitstring;
                                                        {4557}out(c, (GetEndpointResponse,pkSess_4631,SignAndEncrypt,SP_4632,UP_4633))
                                                    )
                                                    else
                                                        {4558}let v_4634: bool = (Sess_4234 = C) in
                                                        (
                                                            {4559}if v_4634 then
                                                            (
                                                                {4560}let pkSess_4635: bitstring = pub(skC) in
                                                                {4561}in(c, =GetEndpointRequest);
                                                                {4562}new SP_4636: bitstring;
                                                                {4563}new UP_4637: bitstring;
                                                                {4564}out(c, (GetEndpointResponse,pkSess_4635,SignAndEncrypt,SP_4636,UP_4637))
                                                            )
                                                            else
                                                                {4565}let pkSess_4638: bitstring = pub(sk(Sess_4234)) in
                                                                {4566}in(c, =GetEndpointRequest);
                                                                {4567}new SP_4639: bitstring;
                                                                {4568}new UP_4640: bitstring;
                                                                {4569}out(c, (GetEndpointResponse,pkSess_4638,SignAndEncrypt,SP_4639,UP_4640))
                                                        )
                                                        else
                                                            {4570}let pkSess_4641: bitstring = fail-any in
                                                            {4571}in(c, =GetEndpointRequest);
                                                            {4572}new SP_4642: bitstring;
                                                            {4573}new UP_4643: bitstring;
                                                            {4574}out(c, (GetEndpointResponse,pkSess_4641,SignAndEncrypt,SP_4642,UP_4643))
                                                )
                                                else
                                                    {4575}let pkSess_4644: bitstring = fail-any in
                                                    {4576}in(c, =GetEndpointRequest);
                                                    {4577}new SP_4645: bitstring;
                                                    {4578}new UP_4646: bitstring;
                                                    {4579}out(c, (GetEndpointResponse,pkSess_4644,SignAndEncrypt,SP_4645,UP_4646))
                                        )
                                        else
                                            {4580}let pkSess_4647: bitstring = fail-any in
                                            {4581}in(c, =GetEndpointRequest);
                                            {4582}new SP_4648: bitstring;
                                            {4583}new UP_4649: bitstring;
                                            {4584}out(c, (GetEndpointResponse,pkSess_4647,SignAndEncrypt,SP_4648,UP_4649))
                                    )
                                    else
                                        {4585}let v_4650: bool = (Cli_4232 = C) in
                                        (
                                            {4586}if v_4650 then
                                            (
                                                {4587}let pkCli_4651: bitstring = pub(skC) in
                                                {4588}let v_4652: bool = (Sess_4234 = A) in
                                                (
                                                    {4589}if v_4652 then
                                                    (
                                                        {4590}let pkSess_4653: bitstring = pub(skA) in
                                                        {4591}in(c, =GetEndpointRequest);
                                                        {4592}new SP_4654: bitstring;
                                                        {4593}new UP_4655: bitstring;
                                                        {4594}out(c, (GetEndpointResponse,pkSess_4653,SignAndEncrypt,SP_4654,UP_4655))
                                                    )
                                                    else
                                                        {4595}let v_4656: bool = (Sess_4234 = B) in
                                                        (
                                                            {4596}if v_4656 then
                                                            (
                                                                {4597}let pkSess_4657: bitstring = pub(skB) in
                                                                {4598}in(c, =GetEndpointRequest);
                                                                {4599}new SP_4658: bitstring;
                                                                {4600}new UP_4659: bitstring;
                                                                {4601}out(c, (GetEndpointResponse,pkSess_4657,SignAndEncrypt,SP_4658,UP_4659))
                                                            )
                                                            else
                                                                {4602}let v_4660: bool = (Sess_4234 = C) in
                                                                (
                                                                    {4603}if v_4660 then
                                                                    (
                                                                        {4604}let pkSess_4661: bitstring = pub(skC) in
                                                                        {4605}in(c, =GetEndpointRequest);
                                                                        {4606}new SP_4662: bitstring;
                                                                        {4607}new UP_4663: bitstring;
                                                                        {4608}out(c, (GetEndpointResponse,pkSess_4661,SignAndEncrypt,SP_4662,UP_4663))
                                                                    )
                                                                    else
                                                                        {4609}let pkSess_4664: bitstring = pub(sk(Sess_4234)) in
                                                                        {4610}in(c, =GetEndpointRequest);
                                                                        {4611}new SP_4665: bitstring;
                                                                        {4612}new UP_4666: bitstring;
                                                                        {4613}out(c, (GetEndpointResponse,pkSess_4664,SignAndEncrypt,SP_4665,UP_4666))
                                                                )
                                                                else
                                                                    {4614}let pkSess_4667: bitstring = fail-any in
                                                                    {4615}in(c, =GetEndpointRequest);
                                                                    {4616}new SP_4668: bitstring;
                                                                    {4617}new UP_4669: bitstring;
                                                                    {4618}out(c, (GetEndpointResponse,pkSess_4667,SignAndEncrypt,SP_4668,UP_4669))
                                                        )
                                                        else
                                                            {4619}let pkSess_4670: bitstring = fail-any in
                                                            {4620}in(c, =GetEndpointRequest);
                                                            {4621}new SP_4671: bitstring;
                                                            {4622}new UP_4672: bitstring;
                                                            {4623}out(c, (GetEndpointResponse,pkSess_4670,SignAndEncrypt,SP_4671,UP_4672))
                                                )
                                                else
                                                    {4624}let pkSess_4673: bitstring = fail-any in
                                                    {4625}in(c, =GetEndpointRequest);
                                                    {4626}new SP_4674: bitstring;
                                                    {4627}new UP_4675: bitstring;
                                                    {4628}out(c, (GetEndpointResponse,pkSess_4673,SignAndEncrypt,SP_4674,UP_4675))
                                            )
                                            else
                                                {4629}let pkCli_4676: bitstring = pub(sk(Cli_4232)) in
                                                {4630}let v_4677: bool = (Sess_4234 = A) in
                                                (
                                                    {4631}if v_4677 then
                                                    (
                                                        {4632}let pkSess_4678: bitstring = pub(skA) in
                                                        {4633}in(c, =GetEndpointRequest);
                                                        {4634}new SP_4679: bitstring;
                                                        {4635}new UP_4680: bitstring;
                                                        {4636}out(c, (GetEndpointResponse,pkSess_4678,SignAndEncrypt,SP_4679,UP_4680))
                                                    )
                                                    else
                                                        {4637}let v_4681: bool = (Sess_4234 = B) in
                                                        (
                                                            {4638}if v_4681 then
                                                            (
                                                                {4639}let pkSess_4682: bitstring = pub(skB) in
                                                                {4640}in(c, =GetEndpointRequest);
                                                                {4641}new SP_4683: bitstring;
                                                                {4642}new UP_4684: bitstring;
                                                                {4643}out(c, (GetEndpointResponse,pkSess_4682,SignAndEncrypt,SP_4683,UP_4684))
                                                            )
                                                            else
                                                                {4644}let v_4685: bool = (Sess_4234 = C) in
                                                                (
                                                                    {4645}if v_4685 then
                                                                    (
                                                                        {4646}let pkSess_4686: bitstring = pub(skC) in
                                                                        {4647}in(c, =GetEndpointRequest);
                                                                        {4648}new SP_4687: bitstring;
                                                                        {4649}new UP_4688: bitstring;
                                                                        {4650}out(c, (GetEndpointResponse,pkSess_4686,SignAndEncrypt,SP_4687,UP_4688))
                                                                    )
                                                                    else
                                                                        {4651}let pkSess_4689: bitstring = pub(sk(Sess_4234)) in
                                                                        {4652}in(c, =GetEndpointRequest);
                                                                        {4653}new SP_4690: bitstring;
                                                                        {4654}new UP_4691: bitstring;
                                                                        {4655}out(c, (GetEndpointResponse,pkSess_4689,SignAndEncrypt,SP_4690,UP_4691))
                                                                )
                                                                else
                                                                    {4656}let pkSess_4692: bitstring = fail-any in
                                                                    {4657}in(c, =GetEndpointRequest);
                                                                    {4658}new SP_4693: bitstring;
                                                                    {4659}new UP_4694: bitstring;
                                                                    {4660}out(c, (GetEndpointResponse,pkSess_4692,SignAndEncrypt,SP_4693,UP_4694))
                                                        )
                                                        else
                                                            {4661}let pkSess_4695: bitstring = fail-any in
                                                            {4662}in(c, =GetEndpointRequest);
                                                            {4663}new SP_4696: bitstring;
                                                            {4664}new UP_4697: bitstring;
                                                            {4665}out(c, (GetEndpointResponse,pkSess_4695,SignAndEncrypt,SP_4696,UP_4697))
                                                )
                                                else
                                                    {4666}let pkSess_4698: bitstring = fail-any in
                                                    {4667}in(c, =GetEndpointRequest);
                                                    {4668}new SP_4699: bitstring;
                                                    {4669}new UP_4700: bitstring;
                                                    {4670}out(c, (GetEndpointResponse,pkSess_4698,SignAndEncrypt,SP_4699,UP_4700))
                                        )
                                        else
                                            {4671}let pkCli_4701: bitstring = fail-any in
                                            {4672}let v_4702: bool = (Sess_4234 = A) in
                                            (
                                                {4673}if v_4702 then
                                                (
                                                    {4674}let pkSess_4703: bitstring = pub(skA) in
                                                    {4675}in(c, =GetEndpointRequest);
                                                    {4676}new SP_4704: bitstring;
                                                    {4677}new UP_4705: bitstring;
                                                    {4678}out(c, (GetEndpointResponse,pkSess_4703,SignAndEncrypt,SP_4704,UP_4705))
                                                )
                                                else
                                                    {4679}let v_4706: bool = (Sess_4234 = B) in
                                                    (
                                                        {4680}if v_4706 then
                                                        (
                                                            {4681}let pkSess_4707: bitstring = pub(skB) in
                                                            {4682}in(c, =GetEndpointRequest);
                                                            {4683}new SP_4708: bitstring;
                                                            {4684}new UP_4709: bitstring;
                                                            {4685}out(c, (GetEndpointResponse,pkSess_4707,SignAndEncrypt,SP_4708,UP_4709))
                                                        )
                                                        else
                                                            {4686}let v_4710: bool = (Sess_4234 = C) in
                                                            (
                                                                {4687}if v_4710 then
                                                                (
                                                                    {4688}let pkSess_4711: bitstring = pub(skC) in
                                                                    {4689}in(c, =GetEndpointRequest);
                                                                    {4690}new SP_4712: bitstring;
                                                                    {4691}new UP_4713: bitstring;
                                                                    {4692}out(c, (GetEndpointResponse,pkSess_4711,SignAndEncrypt,SP_4712,UP_4713))
                                                                )
                                                                else
                                                                    {4693}let pkSess_4714: bitstring = pub(sk(Sess_4234)) in
                                                                    {4694}in(c, =GetEndpointRequest);
                                                                    {4695}new SP_4715: bitstring;
                                                                    {4696}new UP_4716: bitstring;
                                                                    {4697}out(c, (GetEndpointResponse,pkSess_4714,SignAndEncrypt,SP_4715,UP_4716))
                                                            )
                                                            else
                                                                {4698}let pkSess_4717: bitstring = fail-any in
                                                                {4699}in(c, =GetEndpointRequest);
                                                                {4700}new SP_4718: bitstring;
                                                                {4701}new UP_4719: bitstring;
                                                                {4702}out(c, (GetEndpointResponse,pkSess_4717,SignAndEncrypt,SP_4718,UP_4719))
                                                    )
                                                    else
                                                        {4703}let pkSess_4720: bitstring = fail-any in
                                                        {4704}in(c, =GetEndpointRequest);
                                                        {4705}new SP_4721: bitstring;
                                                        {4706}new UP_4722: bitstring;
                                                        {4707}out(c, (GetEndpointResponse,pkSess_4720,SignAndEncrypt,SP_4721,UP_4722))
                                            )
                                            else
                                                {4708}let pkSess_4723: bitstring = fail-any in
                                                {4709}in(c, =GetEndpointRequest);
                                                {4710}new SP_4724: bitstring;
                                                {4711}new UP_4725: bitstring;
                                                {4712}out(c, (GetEndpointResponse,pkSess_4723,SignAndEncrypt,SP_4724,UP_4725))
                                )
                                else
                                    {4713}let pkCli_4726: bitstring = fail-any in
                                    {4714}let v_4727: bool = (Sess_4234 = A) in
                                    (
                                        {4715}if v_4727 then
                                        (
                                            {4716}let pkSess_4728: bitstring = pub(skA) in
                                            {4717}in(c, =GetEndpointRequest);
                                            {4718}new SP_4729: bitstring;
                                            {4719}new UP_4730: bitstring;
                                            {4720}out(c, (GetEndpointResponse,pkSess_4728,SignAndEncrypt,SP_4729,UP_4730))
                                        )
                                        else
                                            {4721}let v_4731: bool = (Sess_4234 = B) in
                                            (
                                                {4722}if v_4731 then
                                                (
                                                    {4723}let pkSess_4732: bitstring = pub(skB) in
                                                    {4724}in(c, =GetEndpointRequest);
                                                    {4725}new SP_4733: bitstring;
                                                    {4726}new UP_4734: bitstring;
                                                    {4727}out(c, (GetEndpointResponse,pkSess_4732,SignAndEncrypt,SP_4733,UP_4734))
                                                )
                                                else
                                                    {4728}let v_4735: bool = (Sess_4234 = C) in
                                                    (
                                                        {4729}if v_4735 then
                                                        (
                                                            {4730}let pkSess_4736: bitstring = pub(skC) in
                                                            {4731}in(c, =GetEndpointRequest);
                                                            {4732}new SP_4737: bitstring;
                                                            {4733}new UP_4738: bitstring;
                                                            {4734}out(c, (GetEndpointResponse,pkSess_4736,SignAndEncrypt,SP_4737,UP_4738))
                                                        )
                                                        else
                                                            {4735}let pkSess_4739: bitstring = pub(sk(Sess_4234)) in
                                                            {4736}in(c, =GetEndpointRequest);
                                                            {4737}new SP_4740: bitstring;
                                                            {4738}new UP_4741: bitstring;
                                                            {4739}out(c, (GetEndpointResponse,pkSess_4739,SignAndEncrypt,SP_4740,UP_4741))
                                                    )
                                                    else
                                                        {4740}let pkSess_4742: bitstring = fail-any in
                                                        {4741}in(c, =GetEndpointRequest);
                                                        {4742}new SP_4743: bitstring;
                                                        {4743}new UP_4744: bitstring;
                                                        {4744}out(c, (GetEndpointResponse,pkSess_4742,SignAndEncrypt,SP_4743,UP_4744))
                                            )
                                            else
                                                {4745}let pkSess_4745: bitstring = fail-any in
                                                {4746}in(c, =GetEndpointRequest);
                                                {4747}new SP_4746: bitstring;
                                                {4748}new UP_4747: bitstring;
                                                {4749}out(c, (GetEndpointResponse,pkSess_4745,SignAndEncrypt,SP_4746,UP_4747))
                                    )
                                    else
                                        {4750}let pkSess_4748: bitstring = fail-any in
                                        {4751}in(c, =GetEndpointRequest);
                                        {4752}new SP_4749: bitstring;
                                        {4753}new UP_4750: bitstring;
                                        {4754}out(c, (GetEndpointResponse,pkSess_4748,SignAndEncrypt,SP_4749,UP_4750))
                        )
                        else
                            {4755}let pkCli_4751: bitstring = fail-any in
                            {4756}let v_4752: bool = (Sess_4234 = A) in
                            (
                                {4757}if v_4752 then
                                (
                                    {4758}let pkSess_4753: bitstring = pub(skA) in
                                    {4759}in(c, =GetEndpointRequest);
                                    {4760}new SP_4754: bitstring;
                                    {4761}new UP_4755: bitstring;
                                    {4762}out(c, (GetEndpointResponse,pkSess_4753,SignAndEncrypt,SP_4754,UP_4755))
                                )
                                else
                                    {4763}let v_4756: bool = (Sess_4234 = B) in
                                    (
                                        {4764}if v_4756 then
                                        (
                                            {4765}let pkSess_4757: bitstring = pub(skB) in
                                            {4766}in(c, =GetEndpointRequest);
                                            {4767}new SP_4758: bitstring;
                                            {4768}new UP_4759: bitstring;
                                            {4769}out(c, (GetEndpointResponse,pkSess_4757,SignAndEncrypt,SP_4758,UP_4759))
                                        )
                                        else
                                            {4770}let v_4760: bool = (Sess_4234 = C) in
                                            (
                                                {4771}if v_4760 then
                                                (
                                                    {4772}let pkSess_4761: bitstring = pub(skC) in
                                                    {4773}in(c, =GetEndpointRequest);
                                                    {4774}new SP_4762: bitstring;
                                                    {4775}new UP_4763: bitstring;
                                                    {4776}out(c, (GetEndpointResponse,pkSess_4761,SignAndEncrypt,SP_4762,UP_4763))
                                                )
                                                else
                                                    {4777}let pkSess_4764: bitstring = pub(sk(Sess_4234)) in
                                                    {4778}in(c, =GetEndpointRequest);
                                                    {4779}new SP_4765: bitstring;
                                                    {4780}new UP_4766: bitstring;
                                                    {4781}out(c, (GetEndpointResponse,pkSess_4764,SignAndEncrypt,SP_4765,UP_4766))
                                            )
                                            else
                                                {4782}let pkSess_4767: bitstring = fail-any in
                                                {4783}in(c, =GetEndpointRequest);
                                                {4784}new SP_4768: bitstring;
                                                {4785}new UP_4769: bitstring;
                                                {4786}out(c, (GetEndpointResponse,pkSess_4767,SignAndEncrypt,SP_4768,UP_4769))
                                    )
                                    else
                                        {4787}let pkSess_4770: bitstring = fail-any in
                                        {4788}in(c, =GetEndpointRequest);
                                        {4789}new SP_4771: bitstring;
                                        {4790}new UP_4772: bitstring;
                                        {4791}out(c, (GetEndpointResponse,pkSess_4770,SignAndEncrypt,SP_4771,UP_4772))
                            )
                            else
                                {4792}let pkSess_4773: bitstring = fail-any in
                                {4793}in(c, =GetEndpointRequest);
                                {4794}new SP_4774: bitstring;
                                {4795}new UP_4775: bitstring;
                                {4796}out(c, (GetEndpointResponse,pkSess_4773,SignAndEncrypt,SP_4774,UP_4775))
                    )
                    else
                        {4797}let skDisco_4776: bitstring = fail-any in
                        {4798}let pkDisco_4777: bitstring = pub(skDisco_4776) in
                        {4799}let v_4778: bool = (Cli_4232 = A) in
                        (
                            {4800}if v_4778 then
                            (
                                {4801}let pkCli_4779: bitstring = pub(skA) in
                                {4802}let v_4780: bool = (Sess_4234 = A) in
                                (
                                    {4803}if v_4780 then
                                    (
                                        {4804}let pkSess_4781: bitstring = pub(skA) in
                                        {4805}in(c, =GetEndpointRequest);
                                        {4806}new SP_4782: bitstring;
                                        {4807}new UP_4783: bitstring;
                                        {4808}out(c, (GetEndpointResponse,pkSess_4781,SignAndEncrypt,SP_4782,UP_4783))
                                    )
                                    else
                                        {4809}let v_4784: bool = (Sess_4234 = B) in
                                        (
                                            {4810}if v_4784 then
                                            (
                                                {4811}let pkSess_4785: bitstring = pub(skB) in
                                                {4812}in(c, =GetEndpointRequest);
                                                {4813}new SP_4786: bitstring;
                                                {4814}new UP_4787: bitstring;
                                                {4815}out(c, (GetEndpointResponse,pkSess_4785,SignAndEncrypt,SP_4786,UP_4787))
                                            )
                                            else
                                                {4816}let v_4788: bool = (Sess_4234 = C) in
                                                (
                                                    {4817}if v_4788 then
                                                    (
                                                        {4818}let pkSess_4789: bitstring = pub(skC) in
                                                        {4819}in(c, =GetEndpointRequest);
                                                        {4820}new SP_4790: bitstring;
                                                        {4821}new UP_4791: bitstring;
                                                        {4822}out(c, (GetEndpointResponse,pkSess_4789,SignAndEncrypt,SP_4790,UP_4791))
                                                    )
                                                    else
                                                        {4823}let pkSess_4792: bitstring = pub(sk(Sess_4234)) in
                                                        {4824}in(c, =GetEndpointRequest);
                                                        {4825}new SP_4793: bitstring;
                                                        {4826}new UP_4794: bitstring;
                                                        {4827}out(c, (GetEndpointResponse,pkSess_4792,SignAndEncrypt,SP_4793,UP_4794))
                                                )
                                                else
                                                    {4828}let pkSess_4795: bitstring = fail-any in
                                                    {4829}in(c, =GetEndpointRequest);
                                                    {4830}new SP_4796: bitstring;
                                                    {4831}new UP_4797: bitstring;
                                                    {4832}out(c, (GetEndpointResponse,pkSess_4795,SignAndEncrypt,SP_4796,UP_4797))
                                        )
                                        else
                                            {4833}let pkSess_4798: bitstring = fail-any in
                                            {4834}in(c, =GetEndpointRequest);
                                            {4835}new SP_4799: bitstring;
                                            {4836}new UP_4800: bitstring;
                                            {4837}out(c, (GetEndpointResponse,pkSess_4798,SignAndEncrypt,SP_4799,UP_4800))
                                )
                                else
                                    {4838}let pkSess_4801: bitstring = fail-any in
                                    {4839}in(c, =GetEndpointRequest);
                                    {4840}new SP_4802: bitstring;
                                    {4841}new UP_4803: bitstring;
                                    {4842}out(c, (GetEndpointResponse,pkSess_4801,SignAndEncrypt,SP_4802,UP_4803))
                            )
                            else
                                {4843}let v_4804: bool = (Cli_4232 = B) in
                                (
                                    {4844}if v_4804 then
                                    (
                                        {4845}let pkCli_4805: bitstring = pub(skB) in
                                        {4846}let v_4806: bool = (Sess_4234 = A) in
                                        (
                                            {4847}if v_4806 then
                                            (
                                                {4848}let pkSess_4807: bitstring = pub(skA) in
                                                {4849}in(c, =GetEndpointRequest);
                                                {4850}new SP_4808: bitstring;
                                                {4851}new UP_4809: bitstring;
                                                {4852}out(c, (GetEndpointResponse,pkSess_4807,SignAndEncrypt,SP_4808,UP_4809))
                                            )
                                            else
                                                {4853}let v_4810: bool = (Sess_4234 = B) in
                                                (
                                                    {4854}if v_4810 then
                                                    (
                                                        {4855}let pkSess_4811: bitstring = pub(skB) in
                                                        {4856}in(c, =GetEndpointRequest);
                                                        {4857}new SP_4812: bitstring;
                                                        {4858}new UP_4813: bitstring;
                                                        {4859}out(c, (GetEndpointResponse,pkSess_4811,SignAndEncrypt,SP_4812,UP_4813))
                                                    )
                                                    else
                                                        {4860}let v_4814: bool = (Sess_4234 = C) in
                                                        (
                                                            {4861}if v_4814 then
                                                            (
                                                                {4862}let pkSess_4815: bitstring = pub(skC) in
                                                                {4863}in(c, =GetEndpointRequest);
                                                                {4864}new SP_4816: bitstring;
                                                                {4865}new UP_4817: bitstring;
                                                                {4866}out(c, (GetEndpointResponse,pkSess_4815,SignAndEncrypt,SP_4816,UP_4817))
                                                            )
                                                            else
                                                                {4867}let pkSess_4818: bitstring = pub(sk(Sess_4234)) in
                                                                {4868}in(c, =GetEndpointRequest);
                                                                {4869}new SP_4819: bitstring;
                                                                {4870}new UP_4820: bitstring;
                                                                {4871}out(c, (GetEndpointResponse,pkSess_4818,SignAndEncrypt,SP_4819,UP_4820))
                                                        )
                                                        else
                                                            {4872}let pkSess_4821: bitstring = fail-any in
                                                            {4873}in(c, =GetEndpointRequest);
                                                            {4874}new SP_4822: bitstring;
                                                            {4875}new UP_4823: bitstring;
                                                            {4876}out(c, (GetEndpointResponse,pkSess_4821,SignAndEncrypt,SP_4822,UP_4823))
                                                )
                                                else
                                                    {4877}let pkSess_4824: bitstring = fail-any in
                                                    {4878}in(c, =GetEndpointRequest);
                                                    {4879}new SP_4825: bitstring;
                                                    {4880}new UP_4826: bitstring;
                                                    {4881}out(c, (GetEndpointResponse,pkSess_4824,SignAndEncrypt,SP_4825,UP_4826))
                                        )
                                        else
                                            {4882}let pkSess_4827: bitstring = fail-any in
                                            {4883}in(c, =GetEndpointRequest);
                                            {4884}new SP_4828: bitstring;
                                            {4885}new UP_4829: bitstring;
                                            {4886}out(c, (GetEndpointResponse,pkSess_4827,SignAndEncrypt,SP_4828,UP_4829))
                                    )
                                    else
                                        {4887}let v_4830: bool = (Cli_4232 = C) in
                                        (
                                            {4888}if v_4830 then
                                            (
                                                {4889}let pkCli_4831: bitstring = pub(skC) in
                                                {4890}let v_4832: bool = (Sess_4234 = A) in
                                                (
                                                    {4891}if v_4832 then
                                                    (
                                                        {4892}let pkSess_4833: bitstring = pub(skA) in
                                                        {4893}in(c, =GetEndpointRequest);
                                                        {4894}new SP_4834: bitstring;
                                                        {4895}new UP_4835: bitstring;
                                                        {4896}out(c, (GetEndpointResponse,pkSess_4833,SignAndEncrypt,SP_4834,UP_4835))
                                                    )
                                                    else
                                                        {4897}let v_4836: bool = (Sess_4234 = B) in
                                                        (
                                                            {4898}if v_4836 then
                                                            (
                                                                {4899}let pkSess_4837: bitstring = pub(skB) in
                                                                {4900}in(c, =GetEndpointRequest);
                                                                {4901}new SP_4838: bitstring;
                                                                {4902}new UP_4839: bitstring;
                                                                {4903}out(c, (GetEndpointResponse,pkSess_4837,SignAndEncrypt,SP_4838,UP_4839))
                                                            )
                                                            else
                                                                {4904}let v_4840: bool = (Sess_4234 = C) in
                                                                (
                                                                    {4905}if v_4840 then
                                                                    (
                                                                        {4906}let pkSess_4841: bitstring = pub(skC) in
                                                                        {4907}in(c, =GetEndpointRequest);
                                                                        {4908}new SP_4842: bitstring;
                                                                        {4909}new UP_4843: bitstring;
                                                                        {4910}out(c, (GetEndpointResponse,pkSess_4841,SignAndEncrypt,SP_4842,UP_4843))
                                                                    )
                                                                    else
                                                                        {4911}let pkSess_4844: bitstring = pub(sk(Sess_4234)) in
                                                                        {4912}in(c, =GetEndpointRequest);
                                                                        {4913}new SP_4845: bitstring;
                                                                        {4914}new UP_4846: bitstring;
                                                                        {4915}out(c, (GetEndpointResponse,pkSess_4844,SignAndEncrypt,SP_4845,UP_4846))
                                                                )
                                                                else
                                                                    {4916}let pkSess_4847: bitstring = fail-any in
                                                                    {4917}in(c, =GetEndpointRequest);
                                                                    {4918}new SP_4848: bitstring;
                                                                    {4919}new UP_4849: bitstring;
                                                                    {4920}out(c, (GetEndpointResponse,pkSess_4847,SignAndEncrypt,SP_4848,UP_4849))
                                                        )
                                                        else
                                                            {4921}let pkSess_4850: bitstring = fail-any in
                                                            {4922}in(c, =GetEndpointRequest);
                                                            {4923}new SP_4851: bitstring;
                                                            {4924}new UP_4852: bitstring;
                                                            {4925}out(c, (GetEndpointResponse,pkSess_4850,SignAndEncrypt,SP_4851,UP_4852))
                                                )
                                                else
                                                    {4926}let pkSess_4853: bitstring = fail-any in
                                                    {4927}in(c, =GetEndpointRequest);
                                                    {4928}new SP_4854: bitstring;
                                                    {4929}new UP_4855: bitstring;
                                                    {4930}out(c, (GetEndpointResponse,pkSess_4853,SignAndEncrypt,SP_4854,UP_4855))
                                            )
                                            else
                                                {4931}let pkCli_4856: bitstring = pub(sk(Cli_4232)) in
                                                {4932}let v_4857: bool = (Sess_4234 = A) in
                                                (
                                                    {4933}if v_4857 then
                                                    (
                                                        {4934}let pkSess_4858: bitstring = pub(skA) in
                                                        {4935}in(c, =GetEndpointRequest);
                                                        {4936}new SP_4859: bitstring;
                                                        {4937}new UP_4860: bitstring;
                                                        {4938}out(c, (GetEndpointResponse,pkSess_4858,SignAndEncrypt,SP_4859,UP_4860))
                                                    )
                                                    else
                                                        {4939}let v_4861: bool = (Sess_4234 = B) in
                                                        (
                                                            {4940}if v_4861 then
                                                            (
                                                                {4941}let pkSess_4862: bitstring = pub(skB) in
                                                                {4942}in(c, =GetEndpointRequest);
                                                                {4943}new SP_4863: bitstring;
                                                                {4944}new UP_4864: bitstring;
                                                                {4945}out(c, (GetEndpointResponse,pkSess_4862,SignAndEncrypt,SP_4863,UP_4864))
                                                            )
                                                            else
                                                                {4946}let v_4865: bool = (Sess_4234 = C) in
                                                                (
                                                                    {4947}if v_4865 then
                                                                    (
                                                                        {4948}let pkSess_4866: bitstring = pub(skC) in
                                                                        {4949}in(c, =GetEndpointRequest);
                                                                        {4950}new SP_4867: bitstring;
                                                                        {4951}new UP_4868: bitstring;
                                                                        {4952}out(c, (GetEndpointResponse,pkSess_4866,SignAndEncrypt,SP_4867,UP_4868))
                                                                    )
                                                                    else
                                                                        {4953}let pkSess_4869: bitstring = pub(sk(Sess_4234)) in
                                                                        {4954}in(c, =GetEndpointRequest);
                                                                        {4955}new SP_4870: bitstring;
                                                                        {4956}new UP_4871: bitstring;
                                                                        {4957}out(c, (GetEndpointResponse,pkSess_4869,SignAndEncrypt,SP_4870,UP_4871))
                                                                )
                                                                else
                                                                    {4958}let pkSess_4872: bitstring = fail-any in
                                                                    {4959}in(c, =GetEndpointRequest);
                                                                    {4960}new SP_4873: bitstring;
                                                                    {4961}new UP_4874: bitstring;
                                                                    {4962}out(c, (GetEndpointResponse,pkSess_4872,SignAndEncrypt,SP_4873,UP_4874))
                                                        )
                                                        else
                                                            {4963}let pkSess_4875: bitstring = fail-any in
                                                            {4964}in(c, =GetEndpointRequest);
                                                            {4965}new SP_4876: bitstring;
                                                            {4966}new UP_4877: bitstring;
                                                            {4967}out(c, (GetEndpointResponse,pkSess_4875,SignAndEncrypt,SP_4876,UP_4877))
                                                )
                                                else
                                                    {4968}let pkSess_4878: bitstring = fail-any in
                                                    {4969}in(c, =GetEndpointRequest);
                                                    {4970}new SP_4879: bitstring;
                                                    {4971}new UP_4880: bitstring;
                                                    {4972}out(c, (GetEndpointResponse,pkSess_4878,SignAndEncrypt,SP_4879,UP_4880))
                                        )
                                        else
                                            {4973}let pkCli_4881: bitstring = fail-any in
                                            {4974}let v_4882: bool = (Sess_4234 = A) in
                                            (
                                                {4975}if v_4882 then
                                                (
                                                    {4976}let pkSess_4883: bitstring = pub(skA) in
                                                    {4977}in(c, =GetEndpointRequest);
                                                    {4978}new SP_4884: bitstring;
                                                    {4979}new UP_4885: bitstring;
                                                    {4980}out(c, (GetEndpointResponse,pkSess_4883,SignAndEncrypt,SP_4884,UP_4885))
                                                )
                                                else
                                                    {4981}let v_4886: bool = (Sess_4234 = B) in
                                                    (
                                                        {4982}if v_4886 then
                                                        (
                                                            {4983}let pkSess_4887: bitstring = pub(skB) in
                                                            {4984}in(c, =GetEndpointRequest);
                                                            {4985}new SP_4888: bitstring;
                                                            {4986}new UP_4889: bitstring;
                                                            {4987}out(c, (GetEndpointResponse,pkSess_4887,SignAndEncrypt,SP_4888,UP_4889))
                                                        )
                                                        else
                                                            {4988}let v_4890: bool = (Sess_4234 = C) in
                                                            (
                                                                {4989}if v_4890 then
                                                                (
                                                                    {4990}let pkSess_4891: bitstring = pub(skC) in
                                                                    {4991}in(c, =GetEndpointRequest);
                                                                    {4992}new SP_4892: bitstring;
                                                                    {4993}new UP_4893: bitstring;
                                                                    {4994}out(c, (GetEndpointResponse,pkSess_4891,SignAndEncrypt,SP_4892,UP_4893))
                                                                )
                                                                else
                                                                    {4995}let pkSess_4894: bitstring = pub(sk(Sess_4234)) in
                                                                    {4996}in(c, =GetEndpointRequest);
                                                                    {4997}new SP_4895: bitstring;
                                                                    {4998}new UP_4896: bitstring;
                                                                    {4999}out(c, (GetEndpointResponse,pkSess_4894,SignAndEncrypt,SP_4895,UP_4896))
                                                            )
                                                            else
                                                                {5000}let pkSess_4897: bitstring = fail-any in
                                                                {5001}in(c, =GetEndpointRequest);
                                                                {5002}new SP_4898: bitstring;
                                                                {5003}new UP_4899: bitstring;
                                                                {5004}out(c, (GetEndpointResponse,pkSess_4897,SignAndEncrypt,SP_4898,UP_4899))
                                                    )
                                                    else
                                                        {5005}let pkSess_4900: bitstring = fail-any in
                                                        {5006}in(c, =GetEndpointRequest);
                                                        {5007}new SP_4901: bitstring;
                                                        {5008}new UP_4902: bitstring;
                                                        {5009}out(c, (GetEndpointResponse,pkSess_4900,SignAndEncrypt,SP_4901,UP_4902))
                                            )
                                            else
                                                {5010}let pkSess_4903: bitstring = fail-any in
                                                {5011}in(c, =GetEndpointRequest);
                                                {5012}new SP_4904: bitstring;
                                                {5013}new UP_4905: bitstring;
                                                {5014}out(c, (GetEndpointResponse,pkSess_4903,SignAndEncrypt,SP_4904,UP_4905))
                                )
                                else
                                    {5015}let pkCli_4906: bitstring = fail-any in
                                    {5016}let v_4907: bool = (Sess_4234 = A) in
                                    (
                                        {5017}if v_4907 then
                                        (
                                            {5018}let pkSess_4908: bitstring = pub(skA) in
                                            {5019}in(c, =GetEndpointRequest);
                                            {5020}new SP_4909: bitstring;
                                            {5021}new UP_4910: bitstring;
                                            {5022}out(c, (GetEndpointResponse,pkSess_4908,SignAndEncrypt,SP_4909,UP_4910))
                                        )
                                        else
                                            {5023}let v_4911: bool = (Sess_4234 = B) in
                                            (
                                                {5024}if v_4911 then
                                                (
                                                    {5025}let pkSess_4912: bitstring = pub(skB) in
                                                    {5026}in(c, =GetEndpointRequest);
                                                    {5027}new SP_4913: bitstring;
                                                    {5028}new UP_4914: bitstring;
                                                    {5029}out(c, (GetEndpointResponse,pkSess_4912,SignAndEncrypt,SP_4913,UP_4914))
                                                )
                                                else
                                                    {5030}let v_4915: bool = (Sess_4234 = C) in
                                                    (
                                                        {5031}if v_4915 then
                                                        (
                                                            {5032}let pkSess_4916: bitstring = pub(skC) in
                                                            {5033}in(c, =GetEndpointRequest);
                                                            {5034}new SP_4917: bitstring;
                                                            {5035}new UP_4918: bitstring;
                                                            {5036}out(c, (GetEndpointResponse,pkSess_4916,SignAndEncrypt,SP_4917,UP_4918))
                                                        )
                                                        else
                                                            {5037}let pkSess_4919: bitstring = pub(sk(Sess_4234)) in
                                                            {5038}in(c, =GetEndpointRequest);
                                                            {5039}new SP_4920: bitstring;
                                                            {5040}new UP_4921: bitstring;
                                                            {5041}out(c, (GetEndpointResponse,pkSess_4919,SignAndEncrypt,SP_4920,UP_4921))
                                                    )
                                                    else
                                                        {5042}let pkSess_4922: bitstring = fail-any in
                                                        {5043}in(c, =GetEndpointRequest);
                                                        {5044}new SP_4923: bitstring;
                                                        {5045}new UP_4924: bitstring;
                                                        {5046}out(c, (GetEndpointResponse,pkSess_4922,SignAndEncrypt,SP_4923,UP_4924))
                                            )
                                            else
                                                {5047}let pkSess_4925: bitstring = fail-any in
                                                {5048}in(c, =GetEndpointRequest);
                                                {5049}new SP_4926: bitstring;
                                                {5050}new UP_4927: bitstring;
                                                {5051}out(c, (GetEndpointResponse,pkSess_4925,SignAndEncrypt,SP_4926,UP_4927))
                                    )
                                    else
                                        {5052}let pkSess_4928: bitstring = fail-any in
                                        {5053}in(c, =GetEndpointRequest);
                                        {5054}new SP_4929: bitstring;
                                        {5055}new UP_4930: bitstring;
                                        {5056}out(c, (GetEndpointResponse,pkSess_4928,SignAndEncrypt,SP_4929,UP_4930))
                        )
                        else
                            {5057}let pkCli_4931: bitstring = fail-any in
                            {5058}let v_4932: bool = (Sess_4234 = A) in
                            (
                                {5059}if v_4932 then
                                (
                                    {5060}let pkSess_4933: bitstring = pub(skA) in
                                    {5061}in(c, =GetEndpointRequest);
                                    {5062}new SP_4934: bitstring;
                                    {5063}new UP_4935: bitstring;
                                    {5064}out(c, (GetEndpointResponse,pkSess_4933,SignAndEncrypt,SP_4934,UP_4935))
                                )
                                else
                                    {5065}let v_4936: bool = (Sess_4234 = B) in
                                    (
                                        {5066}if v_4936 then
                                        (
                                            {5067}let pkSess_4937: bitstring = pub(skB) in
                                            {5068}in(c, =GetEndpointRequest);
                                            {5069}new SP_4938: bitstring;
                                            {5070}new UP_4939: bitstring;
                                            {5071}out(c, (GetEndpointResponse,pkSess_4937,SignAndEncrypt,SP_4938,UP_4939))
                                        )
                                        else
                                            {5072}let v_4940: bool = (Sess_4234 = C) in
                                            (
                                                {5073}if v_4940 then
                                                (
                                                    {5074}let pkSess_4941: bitstring = pub(skC) in
                                                    {5075}in(c, =GetEndpointRequest);
                                                    {5076}new SP_4942: bitstring;
                                                    {5077}new UP_4943: bitstring;
                                                    {5078}out(c, (GetEndpointResponse,pkSess_4941,SignAndEncrypt,SP_4942,UP_4943))
                                                )
                                                else
                                                    {5079}let pkSess_4944: bitstring = pub(sk(Sess_4234)) in
                                                    {5080}in(c, =GetEndpointRequest);
                                                    {5081}new SP_4945: bitstring;
                                                    {5082}new UP_4946: bitstring;
                                                    {5083}out(c, (GetEndpointResponse,pkSess_4944,SignAndEncrypt,SP_4945,UP_4946))
                                            )
                                            else
                                                {5084}let pkSess_4947: bitstring = fail-any in
                                                {5085}in(c, =GetEndpointRequest);
                                                {5086}new SP_4948: bitstring;
                                                {5087}new UP_4949: bitstring;
                                                {5088}out(c, (GetEndpointResponse,pkSess_4947,SignAndEncrypt,SP_4948,UP_4949))
                                    )
                                    else
                                        {5089}let pkSess_4950: bitstring = fail-any in
                                        {5090}in(c, =GetEndpointRequest);
                                        {5091}new SP_4951: bitstring;
                                        {5092}new UP_4952: bitstring;
                                        {5093}out(c, (GetEndpointResponse,pkSess_4950,SignAndEncrypt,SP_4951,UP_4952))
                            )
                            else
                                {5094}let pkSess_4953: bitstring = fail-any in
                                {5095}in(c, =GetEndpointRequest);
                                {5096}new SP_4954: bitstring;
                                {5097}new UP_4955: bitstring;
                                {5098}out(c, (GetEndpointResponse,pkSess_4953,SignAndEncrypt,SP_4954,UP_4955))
            )
            else
                {5099}let skDisco_4956: bitstring = fail-any in
                {5100}let pkDisco_4957: bitstring = pub(skDisco_4956) in
                {5101}let v_4958: bool = (Cli_4232 = A) in
                (
                    {5102}if v_4958 then
                    (
                        {5103}let pkCli_4959: bitstring = pub(skA) in
                        {5104}let v_4960: bool = (Sess_4234 = A) in
                        (
                            {5105}if v_4960 then
                            (
                                {5106}let pkSess_4961: bitstring = pub(skA) in
                                {5107}in(c, =GetEndpointRequest);
                                {5108}new SP_4962: bitstring;
                                {5109}new UP_4963: bitstring;
                                {5110}out(c, (GetEndpointResponse,pkSess_4961,SignAndEncrypt,SP_4962,UP_4963))
                            )
                            else
                                {5111}let v_4964: bool = (Sess_4234 = B) in
                                (
                                    {5112}if v_4964 then
                                    (
                                        {5113}let pkSess_4965: bitstring = pub(skB) in
                                        {5114}in(c, =GetEndpointRequest);
                                        {5115}new SP_4966: bitstring;
                                        {5116}new UP_4967: bitstring;
                                        {5117}out(c, (GetEndpointResponse,pkSess_4965,SignAndEncrypt,SP_4966,UP_4967))
                                    )
                                    else
                                        {5118}let v_4968: bool = (Sess_4234 = C) in
                                        (
                                            {5119}if v_4968 then
                                            (
                                                {5120}let pkSess_4969: bitstring = pub(skC) in
                                                {5121}in(c, =GetEndpointRequest);
                                                {5122}new SP_4970: bitstring;
                                                {5123}new UP_4971: bitstring;
                                                {5124}out(c, (GetEndpointResponse,pkSess_4969,SignAndEncrypt,SP_4970,UP_4971))
                                            )
                                            else
                                                {5125}let pkSess_4972: bitstring = pub(sk(Sess_4234)) in
                                                {5126}in(c, =GetEndpointRequest);
                                                {5127}new SP_4973: bitstring;
                                                {5128}new UP_4974: bitstring;
                                                {5129}out(c, (GetEndpointResponse,pkSess_4972,SignAndEncrypt,SP_4973,UP_4974))
                                        )
                                        else
                                            {5130}let pkSess_4975: bitstring = fail-any in
                                            {5131}in(c, =GetEndpointRequest);
                                            {5132}new SP_4976: bitstring;
                                            {5133}new UP_4977: bitstring;
                                            {5134}out(c, (GetEndpointResponse,pkSess_4975,SignAndEncrypt,SP_4976,UP_4977))
                                )
                                else
                                    {5135}let pkSess_4978: bitstring = fail-any in
                                    {5136}in(c, =GetEndpointRequest);
                                    {5137}new SP_4979: bitstring;
                                    {5138}new UP_4980: bitstring;
                                    {5139}out(c, (GetEndpointResponse,pkSess_4978,SignAndEncrypt,SP_4979,UP_4980))
                        )
                        else
                            {5140}let pkSess_4981: bitstring = fail-any in
                            {5141}in(c, =GetEndpointRequest);
                            {5142}new SP_4982: bitstring;
                            {5143}new UP_4983: bitstring;
                            {5144}out(c, (GetEndpointResponse,pkSess_4981,SignAndEncrypt,SP_4982,UP_4983))
                    )
                    else
                        {5145}let v_4984: bool = (Cli_4232 = B) in
                        (
                            {5146}if v_4984 then
                            (
                                {5147}let pkCli_4985: bitstring = pub(skB) in
                                {5148}let v_4986: bool = (Sess_4234 = A) in
                                (
                                    {5149}if v_4986 then
                                    (
                                        {5150}let pkSess_4987: bitstring = pub(skA) in
                                        {5151}in(c, =GetEndpointRequest);
                                        {5152}new SP_4988: bitstring;
                                        {5153}new UP_4989: bitstring;
                                        {5154}out(c, (GetEndpointResponse,pkSess_4987,SignAndEncrypt,SP_4988,UP_4989))
                                    )
                                    else
                                        {5155}let v_4990: bool = (Sess_4234 = B) in
                                        (
                                            {5156}if v_4990 then
                                            (
                                                {5157}let pkSess_4991: bitstring = pub(skB) in
                                                {5158}in(c, =GetEndpointRequest);
                                                {5159}new SP_4992: bitstring;
                                                {5160}new UP_4993: bitstring;
                                                {5161}out(c, (GetEndpointResponse,pkSess_4991,SignAndEncrypt,SP_4992,UP_4993))
                                            )
                                            else
                                                {5162}let v_4994: bool = (Sess_4234 = C) in
                                                (
                                                    {5163}if v_4994 then
                                                    (
                                                        {5164}let pkSess_4995: bitstring = pub(skC) in
                                                        {5165}in(c, =GetEndpointRequest);
                                                        {5166}new SP_4996: bitstring;
                                                        {5167}new UP_4997: bitstring;
                                                        {5168}out(c, (GetEndpointResponse,pkSess_4995,SignAndEncrypt,SP_4996,UP_4997))
                                                    )
                                                    else
                                                        {5169}let pkSess_4998: bitstring = pub(sk(Sess_4234)) in
                                                        {5170}in(c, =GetEndpointRequest);
                                                        {5171}new SP_4999: bitstring;
                                                        {5172}new UP_5000: bitstring;
                                                        {5173}out(c, (GetEndpointResponse,pkSess_4998,SignAndEncrypt,SP_4999,UP_5000))
                                                )
                                                else
                                                    {5174}let pkSess_5001: bitstring = fail-any in
                                                    {5175}in(c, =GetEndpointRequest);
                                                    {5176}new SP_5002: bitstring;
                                                    {5177}new UP_5003: bitstring;
                                                    {5178}out(c, (GetEndpointResponse,pkSess_5001,SignAndEncrypt,SP_5002,UP_5003))
                                        )
                                        else
                                            {5179}let pkSess_5004: bitstring = fail-any in
                                            {5180}in(c, =GetEndpointRequest);
                                            {5181}new SP_5005: bitstring;
                                            {5182}new UP_5006: bitstring;
                                            {5183}out(c, (GetEndpointResponse,pkSess_5004,SignAndEncrypt,SP_5005,UP_5006))
                                )
                                else
                                    {5184}let pkSess_5007: bitstring = fail-any in
                                    {5185}in(c, =GetEndpointRequest);
                                    {5186}new SP_5008: bitstring;
                                    {5187}new UP_5009: bitstring;
                                    {5188}out(c, (GetEndpointResponse,pkSess_5007,SignAndEncrypt,SP_5008,UP_5009))
                            )
                            else
                                {5189}let v_5010: bool = (Cli_4232 = C) in
                                (
                                    {5190}if v_5010 then
                                    (
                                        {5191}let pkCli_5011: bitstring = pub(skC) in
                                        {5192}let v_5012: bool = (Sess_4234 = A) in
                                        (
                                            {5193}if v_5012 then
                                            (
                                                {5194}let pkSess_5013: bitstring = pub(skA) in
                                                {5195}in(c, =GetEndpointRequest);
                                                {5196}new SP_5014: bitstring;
                                                {5197}new UP_5015: bitstring;
                                                {5198}out(c, (GetEndpointResponse,pkSess_5013,SignAndEncrypt,SP_5014,UP_5015))
                                            )
                                            else
                                                {5199}let v_5016: bool = (Sess_4234 = B) in
                                                (
                                                    {5200}if v_5016 then
                                                    (
                                                        {5201}let pkSess_5017: bitstring = pub(skB) in
                                                        {5202}in(c, =GetEndpointRequest);
                                                        {5203}new SP_5018: bitstring;
                                                        {5204}new UP_5019: bitstring;
                                                        {5205}out(c, (GetEndpointResponse,pkSess_5017,SignAndEncrypt,SP_5018,UP_5019))
                                                    )
                                                    else
                                                        {5206}let v_5020: bool = (Sess_4234 = C) in
                                                        (
                                                            {5207}if v_5020 then
                                                            (
                                                                {5208}let pkSess_5021: bitstring = pub(skC) in
                                                                {5209}in(c, =GetEndpointRequest);
                                                                {5210}new SP_5022: bitstring;
                                                                {5211}new UP_5023: bitstring;
                                                                {5212}out(c, (GetEndpointResponse,pkSess_5021,SignAndEncrypt,SP_5022,UP_5023))
                                                            )
                                                            else
                                                                {5213}let pkSess_5024: bitstring = pub(sk(Sess_4234)) in
                                                                {5214}in(c, =GetEndpointRequest);
                                                                {5215}new SP_5025: bitstring;
                                                                {5216}new UP_5026: bitstring;
                                                                {5217}out(c, (GetEndpointResponse,pkSess_5024,SignAndEncrypt,SP_5025,UP_5026))
                                                        )
                                                        else
                                                            {5218}let pkSess_5027: bitstring = fail-any in
                                                            {5219}in(c, =GetEndpointRequest);
                                                            {5220}new SP_5028: bitstring;
                                                            {5221}new UP_5029: bitstring;
                                                            {5222}out(c, (GetEndpointResponse,pkSess_5027,SignAndEncrypt,SP_5028,UP_5029))
                                                )
                                                else
                                                    {5223}let pkSess_5030: bitstring = fail-any in
                                                    {5224}in(c, =GetEndpointRequest);
                                                    {5225}new SP_5031: bitstring;
                                                    {5226}new UP_5032: bitstring;
                                                    {5227}out(c, (GetEndpointResponse,pkSess_5030,SignAndEncrypt,SP_5031,UP_5032))
                                        )
                                        else
                                            {5228}let pkSess_5033: bitstring = fail-any in
                                            {5229}in(c, =GetEndpointRequest);
                                            {5230}new SP_5034: bitstring;
                                            {5231}new UP_5035: bitstring;
                                            {5232}out(c, (GetEndpointResponse,pkSess_5033,SignAndEncrypt,SP_5034,UP_5035))
                                    )
                                    else
                                        {5233}let pkCli_5036: bitstring = pub(sk(Cli_4232)) in
                                        {5234}let v_5037: bool = (Sess_4234 = A) in
                                        (
                                            {5235}if v_5037 then
                                            (
                                                {5236}let pkSess_5038: bitstring = pub(skA) in
                                                {5237}in(c, =GetEndpointRequest);
                                                {5238}new SP_5039: bitstring;
                                                {5239}new UP_5040: bitstring;
                                                {5240}out(c, (GetEndpointResponse,pkSess_5038,SignAndEncrypt,SP_5039,UP_5040))
                                            )
                                            else
                                                {5241}let v_5041: bool = (Sess_4234 = B) in
                                                (
                                                    {5242}if v_5041 then
                                                    (
                                                        {5243}let pkSess_5042: bitstring = pub(skB) in
                                                        {5244}in(c, =GetEndpointRequest);
                                                        {5245}new SP_5043: bitstring;
                                                        {5246}new UP_5044: bitstring;
                                                        {5247}out(c, (GetEndpointResponse,pkSess_5042,SignAndEncrypt,SP_5043,UP_5044))
                                                    )
                                                    else
                                                        {5248}let v_5045: bool = (Sess_4234 = C) in
                                                        (
                                                            {5249}if v_5045 then
                                                            (
                                                                {5250}let pkSess_5046: bitstring = pub(skC) in
                                                                {5251}in(c, =GetEndpointRequest);
                                                                {5252}new SP_5047: bitstring;
                                                                {5253}new UP_5048: bitstring;
                                                                {5254}out(c, (GetEndpointResponse,pkSess_5046,SignAndEncrypt,SP_5047,UP_5048))
                                                            )
                                                            else
                                                                {5255}let pkSess_5049: bitstring = pub(sk(Sess_4234)) in
                                                                {5256}in(c, =GetEndpointRequest);
                                                                {5257}new SP_5050: bitstring;
                                                                {5258}new UP_5051: bitstring;
                                                                {5259}out(c, (GetEndpointResponse,pkSess_5049,SignAndEncrypt,SP_5050,UP_5051))
                                                        )
                                                        else
                                                            {5260}let pkSess_5052: bitstring = fail-any in
                                                            {5261}in(c, =GetEndpointRequest);
                                                            {5262}new SP_5053: bitstring;
                                                            {5263}new UP_5054: bitstring;
                                                            {5264}out(c, (GetEndpointResponse,pkSess_5052,SignAndEncrypt,SP_5053,UP_5054))
                                                )
                                                else
                                                    {5265}let pkSess_5055: bitstring = fail-any in
                                                    {5266}in(c, =GetEndpointRequest);
                                                    {5267}new SP_5056: bitstring;
                                                    {5268}new UP_5057: bitstring;
                                                    {5269}out(c, (GetEndpointResponse,pkSess_5055,SignAndEncrypt,SP_5056,UP_5057))
                                        )
                                        else
                                            {5270}let pkSess_5058: bitstring = fail-any in
                                            {5271}in(c, =GetEndpointRequest);
                                            {5272}new SP_5059: bitstring;
                                            {5273}new UP_5060: bitstring;
                                            {5274}out(c, (GetEndpointResponse,pkSess_5058,SignAndEncrypt,SP_5059,UP_5060))
                                )
                                else
                                    {5275}let pkCli_5061: bitstring = fail-any in
                                    {5276}let v_5062: bool = (Sess_4234 = A) in
                                    (
                                        {5277}if v_5062 then
                                        (
                                            {5278}let pkSess_5063: bitstring = pub(skA) in
                                            {5279}in(c, =GetEndpointRequest);
                                            {5280}new SP_5064: bitstring;
                                            {5281}new UP_5065: bitstring;
                                            {5282}out(c, (GetEndpointResponse,pkSess_5063,SignAndEncrypt,SP_5064,UP_5065))
                                        )
                                        else
                                            {5283}let v_5066: bool = (Sess_4234 = B) in
                                            (
                                                {5284}if v_5066 then
                                                (
                                                    {5285}let pkSess_5067: bitstring = pub(skB) in
                                                    {5286}in(c, =GetEndpointRequest);
                                                    {5287}new SP_5068: bitstring;
                                                    {5288}new UP_5069: bitstring;
                                                    {5289}out(c, (GetEndpointResponse,pkSess_5067,SignAndEncrypt,SP_5068,UP_5069))
                                                )
                                                else
                                                    {5290}let v_5070: bool = (Sess_4234 = C) in
                                                    (
                                                        {5291}if v_5070 then
                                                        (
                                                            {5292}let pkSess_5071: bitstring = pub(skC) in
                                                            {5293}in(c, =GetEndpointRequest);
                                                            {5294}new SP_5072: bitstring;
                                                            {5295}new UP_5073: bitstring;
                                                            {5296}out(c, (GetEndpointResponse,pkSess_5071,SignAndEncrypt,SP_5072,UP_5073))
                                                        )
                                                        else
                                                            {5297}let pkSess_5074: bitstring = pub(sk(Sess_4234)) in
                                                            {5298}in(c, =GetEndpointRequest);
                                                            {5299}new SP_5075: bitstring;
                                                            {5300}new UP_5076: bitstring;
                                                            {5301}out(c, (GetEndpointResponse,pkSess_5074,SignAndEncrypt,SP_5075,UP_5076))
                                                    )
                                                    else
                                                        {5302}let pkSess_5077: bitstring = fail-any in
                                                        {5303}in(c, =GetEndpointRequest);
                                                        {5304}new SP_5078: bitstring;
                                                        {5305}new UP_5079: bitstring;
                                                        {5306}out(c, (GetEndpointResponse,pkSess_5077,SignAndEncrypt,SP_5078,UP_5079))
                                            )
                                            else
                                                {5307}let pkSess_5080: bitstring = fail-any in
                                                {5308}in(c, =GetEndpointRequest);
                                                {5309}new SP_5081: bitstring;
                                                {5310}new UP_5082: bitstring;
                                                {5311}out(c, (GetEndpointResponse,pkSess_5080,SignAndEncrypt,SP_5081,UP_5082))
                                    )
                                    else
                                        {5312}let pkSess_5083: bitstring = fail-any in
                                        {5313}in(c, =GetEndpointRequest);
                                        {5314}new SP_5084: bitstring;
                                        {5315}new UP_5085: bitstring;
                                        {5316}out(c, (GetEndpointResponse,pkSess_5083,SignAndEncrypt,SP_5084,UP_5085))
                        )
                        else
                            {5317}let pkCli_5086: bitstring = fail-any in
                            {5318}let v_5087: bool = (Sess_4234 = A) in
                            (
                                {5319}if v_5087 then
                                (
                                    {5320}let pkSess_5088: bitstring = pub(skA) in
                                    {5321}in(c, =GetEndpointRequest);
                                    {5322}new SP_5089: bitstring;
                                    {5323}new UP_5090: bitstring;
                                    {5324}out(c, (GetEndpointResponse,pkSess_5088,SignAndEncrypt,SP_5089,UP_5090))
                                )
                                else
                                    {5325}let v_5091: bool = (Sess_4234 = B) in
                                    (
                                        {5326}if v_5091 then
                                        (
                                            {5327}let pkSess_5092: bitstring = pub(skB) in
                                            {5328}in(c, =GetEndpointRequest);
                                            {5329}new SP_5093: bitstring;
                                            {5330}new UP_5094: bitstring;
                                            {5331}out(c, (GetEndpointResponse,pkSess_5092,SignAndEncrypt,SP_5093,UP_5094))
                                        )
                                        else
                                            {5332}let v_5095: bool = (Sess_4234 = C) in
                                            (
                                                {5333}if v_5095 then
                                                (
                                                    {5334}let pkSess_5096: bitstring = pub(skC) in
                                                    {5335}in(c, =GetEndpointRequest);
                                                    {5336}new SP_5097: bitstring;
                                                    {5337}new UP_5098: bitstring;
                                                    {5338}out(c, (GetEndpointResponse,pkSess_5096,SignAndEncrypt,SP_5097,UP_5098))
                                                )
                                                else
                                                    {5339}let pkSess_5099: bitstring = pub(sk(Sess_4234)) in
                                                    {5340}in(c, =GetEndpointRequest);
                                                    {5341}new SP_5100: bitstring;
                                                    {5342}new UP_5101: bitstring;
                                                    {5343}out(c, (GetEndpointResponse,pkSess_5099,SignAndEncrypt,SP_5100,UP_5101))
                                            )
                                            else
                                                {5344}let pkSess_5102: bitstring = fail-any in
                                                {5345}in(c, =GetEndpointRequest);
                                                {5346}new SP_5103: bitstring;
                                                {5347}new UP_5104: bitstring;
                                                {5348}out(c, (GetEndpointResponse,pkSess_5102,SignAndEncrypt,SP_5103,UP_5104))
                                    )
                                    else
                                        {5349}let pkSess_5105: bitstring = fail-any in
                                        {5350}in(c, =GetEndpointRequest);
                                        {5351}new SP_5106: bitstring;
                                        {5352}new UP_5107: bitstring;
                                        {5353}out(c, (GetEndpointResponse,pkSess_5105,SignAndEncrypt,SP_5106,UP_5107))
                            )
                            else
                                {5354}let pkSess_5108: bitstring = fail-any in
                                {5355}in(c, =GetEndpointRequest);
                                {5356}new SP_5109: bitstring;
                                {5357}new UP_5110: bitstring;
                                {5358}out(c, (GetEndpointResponse,pkSess_5108,SignAndEncrypt,SP_5109,UP_5110))
                )
                else
                    {5359}let pkCli_5111: bitstring = fail-any in
                    {5360}let v_5112: bool = (Sess_4234 = A) in
                    (
                        {5361}if v_5112 then
                        (
                            {5362}let pkSess_5113: bitstring = pub(skA) in
                            {5363}in(c, =GetEndpointRequest);
                            {5364}new SP_5114: bitstring;
                            {5365}new UP_5115: bitstring;
                            {5366}out(c, (GetEndpointResponse,pkSess_5113,SignAndEncrypt,SP_5114,UP_5115))
                        )
                        else
                            {5367}let v_5116: bool = (Sess_4234 = B) in
                            (
                                {5368}if v_5116 then
                                (
                                    {5369}let pkSess_5117: bitstring = pub(skB) in
                                    {5370}in(c, =GetEndpointRequest);
                                    {5371}new SP_5118: bitstring;
                                    {5372}new UP_5119: bitstring;
                                    {5373}out(c, (GetEndpointResponse,pkSess_5117,SignAndEncrypt,SP_5118,UP_5119))
                                )
                                else
                                    {5374}let v_5120: bool = (Sess_4234 = C) in
                                    (
                                        {5375}if v_5120 then
                                        (
                                            {5376}let pkSess_5121: bitstring = pub(skC) in
                                            {5377}in(c, =GetEndpointRequest);
                                            {5378}new SP_5122: bitstring;
                                            {5379}new UP_5123: bitstring;
                                            {5380}out(c, (GetEndpointResponse,pkSess_5121,SignAndEncrypt,SP_5122,UP_5123))
                                        )
                                        else
                                            {5381}let pkSess_5124: bitstring = pub(sk(Sess_4234)) in
                                            {5382}in(c, =GetEndpointRequest);
                                            {5383}new SP_5125: bitstring;
                                            {5384}new UP_5126: bitstring;
                                            {5385}out(c, (GetEndpointResponse,pkSess_5124,SignAndEncrypt,SP_5125,UP_5126))
                                    )
                                    else
                                        {5386}let pkSess_5127: bitstring = fail-any in
                                        {5387}in(c, =GetEndpointRequest);
                                        {5388}new SP_5128: bitstring;
                                        {5389}new UP_5129: bitstring;
                                        {5390}out(c, (GetEndpointResponse,pkSess_5127,SignAndEncrypt,SP_5128,UP_5129))
                            )
                            else
                                {5391}let pkSess_5130: bitstring = fail-any in
                                {5392}in(c, =GetEndpointRequest);
                                {5393}new SP_5131: bitstring;
                                {5394}new UP_5132: bitstring;
                                {5395}out(c, (GetEndpointResponse,pkSess_5130,SignAndEncrypt,SP_5131,UP_5132))
                    )
                    else
                        {5396}let pkSess_5133: bitstring = fail-any in
                        {5397}in(c, =GetEndpointRequest);
                        {5398}new SP_5134: bitstring;
                        {5399}new UP_5135: bitstring;
                        {5400}out(c, (GetEndpointResponse,pkSess_5133,SignAndEncrypt,SP_5134,UP_5135))
    )
    else
        {5401}let skDisco_5136: bitstring = fail-any in
        {5402}let pkDisco_5137: bitstring = pub(skDisco_5136) in
        {5403}let v_5138: bool = (Cli_4232 = A) in
        (
            {5404}if v_5138 then
            (
                {5405}let pkCli_5139: bitstring = pub(skA) in
                {5406}let v_5140: bool = (Sess_4234 = A) in
                (
                    {5407}if v_5140 then
                    (
                        {5408}let pkSess_5141: bitstring = pub(skA) in
                        {5409}in(c, =GetEndpointRequest);
                        {5410}new SP_5142: bitstring;
                        {5411}new UP_5143: bitstring;
                        {5412}out(c, (GetEndpointResponse,pkSess_5141,SignAndEncrypt,SP_5142,UP_5143))
                    )
                    else
                        {5413}let v_5144: bool = (Sess_4234 = B) in
                        (
                            {5414}if v_5144 then
                            (
                                {5415}let pkSess_5145: bitstring = pub(skB) in
                                {5416}in(c, =GetEndpointRequest);
                                {5417}new SP_5146: bitstring;
                                {5418}new UP_5147: bitstring;
                                {5419}out(c, (GetEndpointResponse,pkSess_5145,SignAndEncrypt,SP_5146,UP_5147))
                            )
                            else
                                {5420}let v_5148: bool = (Sess_4234 = C) in
                                (
                                    {5421}if v_5148 then
                                    (
                                        {5422}let pkSess_5149: bitstring = pub(skC) in
                                        {5423}in(c, =GetEndpointRequest);
                                        {5424}new SP_5150: bitstring;
                                        {5425}new UP_5151: bitstring;
                                        {5426}out(c, (GetEndpointResponse,pkSess_5149,SignAndEncrypt,SP_5150,UP_5151))
                                    )
                                    else
                                        {5427}let pkSess_5152: bitstring = pub(sk(Sess_4234)) in
                                        {5428}in(c, =GetEndpointRequest);
                                        {5429}new SP_5153: bitstring;
                                        {5430}new UP_5154: bitstring;
                                        {5431}out(c, (GetEndpointResponse,pkSess_5152,SignAndEncrypt,SP_5153,UP_5154))
                                )
                                else
                                    {5432}let pkSess_5155: bitstring = fail-any in
                                    {5433}in(c, =GetEndpointRequest);
                                    {5434}new SP_5156: bitstring;
                                    {5435}new UP_5157: bitstring;
                                    {5436}out(c, (GetEndpointResponse,pkSess_5155,SignAndEncrypt,SP_5156,UP_5157))
                        )
                        else
                            {5437}let pkSess_5158: bitstring = fail-any in
                            {5438}in(c, =GetEndpointRequest);
                            {5439}new SP_5159: bitstring;
                            {5440}new UP_5160: bitstring;
                            {5441}out(c, (GetEndpointResponse,pkSess_5158,SignAndEncrypt,SP_5159,UP_5160))
                )
                else
                    {5442}let pkSess_5161: bitstring = fail-any in
                    {5443}in(c, =GetEndpointRequest);
                    {5444}new SP_5162: bitstring;
                    {5445}new UP_5163: bitstring;
                    {5446}out(c, (GetEndpointResponse,pkSess_5161,SignAndEncrypt,SP_5162,UP_5163))
            )
            else
                {5447}let v_5164: bool = (Cli_4232 = B) in
                (
                    {5448}if v_5164 then
                    (
                        {5449}let pkCli_5165: bitstring = pub(skB) in
                        {5450}let v_5166: bool = (Sess_4234 = A) in
                        (
                            {5451}if v_5166 then
                            (
                                {5452}let pkSess_5167: bitstring = pub(skA) in
                                {5453}in(c, =GetEndpointRequest);
                                {5454}new SP_5168: bitstring;
                                {5455}new UP_5169: bitstring;
                                {5456}out(c, (GetEndpointResponse,pkSess_5167,SignAndEncrypt,SP_5168,UP_5169))
                            )
                            else
                                {5457}let v_5170: bool = (Sess_4234 = B) in
                                (
                                    {5458}if v_5170 then
                                    (
                                        {5459}let pkSess_5171: bitstring = pub(skB) in
                                        {5460}in(c, =GetEndpointRequest);
                                        {5461}new SP_5172: bitstring;
                                        {5462}new UP_5173: bitstring;
                                        {5463}out(c, (GetEndpointResponse,pkSess_5171,SignAndEncrypt,SP_5172,UP_5173))
                                    )
                                    else
                                        {5464}let v_5174: bool = (Sess_4234 = C) in
                                        (
                                            {5465}if v_5174 then
                                            (
                                                {5466}let pkSess_5175: bitstring = pub(skC) in
                                                {5467}in(c, =GetEndpointRequest);
                                                {5468}new SP_5176: bitstring;
                                                {5469}new UP_5177: bitstring;
                                                {5470}out(c, (GetEndpointResponse,pkSess_5175,SignAndEncrypt,SP_5176,UP_5177))
                                            )
                                            else
                                                {5471}let pkSess_5178: bitstring = pub(sk(Sess_4234)) in
                                                {5472}in(c, =GetEndpointRequest);
                                                {5473}new SP_5179: bitstring;
                                                {5474}new UP_5180: bitstring;
                                                {5475}out(c, (GetEndpointResponse,pkSess_5178,SignAndEncrypt,SP_5179,UP_5180))
                                        )
                                        else
                                            {5476}let pkSess_5181: bitstring = fail-any in
                                            {5477}in(c, =GetEndpointRequest);
                                            {5478}new SP_5182: bitstring;
                                            {5479}new UP_5183: bitstring;
                                            {5480}out(c, (GetEndpointResponse,pkSess_5181,SignAndEncrypt,SP_5182,UP_5183))
                                )
                                else
                                    {5481}let pkSess_5184: bitstring = fail-any in
                                    {5482}in(c, =GetEndpointRequest);
                                    {5483}new SP_5185: bitstring;
                                    {5484}new UP_5186: bitstring;
                                    {5485}out(c, (GetEndpointResponse,pkSess_5184,SignAndEncrypt,SP_5185,UP_5186))
                        )
                        else
                            {5486}let pkSess_5187: bitstring = fail-any in
                            {5487}in(c, =GetEndpointRequest);
                            {5488}new SP_5188: bitstring;
                            {5489}new UP_5189: bitstring;
                            {5490}out(c, (GetEndpointResponse,pkSess_5187,SignAndEncrypt,SP_5188,UP_5189))
                    )
                    else
                        {5491}let v_5190: bool = (Cli_4232 = C) in
                        (
                            {5492}if v_5190 then
                            (
                                {5493}let pkCli_5191: bitstring = pub(skC) in
                                {5494}let v_5192: bool = (Sess_4234 = A) in
                                (
                                    {5495}if v_5192 then
                                    (
                                        {5496}let pkSess_5193: bitstring = pub(skA) in
                                        {5497}in(c, =GetEndpointRequest);
                                        {5498}new SP_5194: bitstring;
                                        {5499}new UP_5195: bitstring;
                                        {5500}out(c, (GetEndpointResponse,pkSess_5193,SignAndEncrypt,SP_5194,UP_5195))
                                    )
                                    else
                                        {5501}let v_5196: bool = (Sess_4234 = B) in
                                        (
                                            {5502}if v_5196 then
                                            (
                                                {5503}let pkSess_5197: bitstring = pub(skB) in
                                                {5504}in(c, =GetEndpointRequest);
                                                {5505}new SP_5198: bitstring;
                                                {5506}new UP_5199: bitstring;
                                                {5507}out(c, (GetEndpointResponse,pkSess_5197,SignAndEncrypt,SP_5198,UP_5199))
                                            )
                                            else
                                                {5508}let v_5200: bool = (Sess_4234 = C) in
                                                (
                                                    {5509}if v_5200 then
                                                    (
                                                        {5510}let pkSess_5201: bitstring = pub(skC) in
                                                        {5511}in(c, =GetEndpointRequest);
                                                        {5512}new SP_5202: bitstring;
                                                        {5513}new UP_5203: bitstring;
                                                        {5514}out(c, (GetEndpointResponse,pkSess_5201,SignAndEncrypt,SP_5202,UP_5203))
                                                    )
                                                    else
                                                        {5515}let pkSess_5204: bitstring = pub(sk(Sess_4234)) in
                                                        {5516}in(c, =GetEndpointRequest);
                                                        {5517}new SP_5205: bitstring;
                                                        {5518}new UP_5206: bitstring;
                                                        {5519}out(c, (GetEndpointResponse,pkSess_5204,SignAndEncrypt,SP_5205,UP_5206))
                                                )
                                                else
                                                    {5520}let pkSess_5207: bitstring = fail-any in
                                                    {5521}in(c, =GetEndpointRequest);
                                                    {5522}new SP_5208: bitstring;
                                                    {5523}new UP_5209: bitstring;
                                                    {5524}out(c, (GetEndpointResponse,pkSess_5207,SignAndEncrypt,SP_5208,UP_5209))
                                        )
                                        else
                                            {5525}let pkSess_5210: bitstring = fail-any in
                                            {5526}in(c, =GetEndpointRequest);
                                            {5527}new SP_5211: bitstring;
                                            {5528}new UP_5212: bitstring;
                                            {5529}out(c, (GetEndpointResponse,pkSess_5210,SignAndEncrypt,SP_5211,UP_5212))
                                )
                                else
                                    {5530}let pkSess_5213: bitstring = fail-any in
                                    {5531}in(c, =GetEndpointRequest);
                                    {5532}new SP_5214: bitstring;
                                    {5533}new UP_5215: bitstring;
                                    {5534}out(c, (GetEndpointResponse,pkSess_5213,SignAndEncrypt,SP_5214,UP_5215))
                            )
                            else
                                {5535}let pkCli_5216: bitstring = pub(sk(Cli_4232)) in
                                {5536}let v_5217: bool = (Sess_4234 = A) in
                                (
                                    {5537}if v_5217 then
                                    (
                                        {5538}let pkSess_5218: bitstring = pub(skA) in
                                        {5539}in(c, =GetEndpointRequest);
                                        {5540}new SP_5219: bitstring;
                                        {5541}new UP_5220: bitstring;
                                        {5542}out(c, (GetEndpointResponse,pkSess_5218,SignAndEncrypt,SP_5219,UP_5220))
                                    )
                                    else
                                        {5543}let v_5221: bool = (Sess_4234 = B) in
                                        (
                                            {5544}if v_5221 then
                                            (
                                                {5545}let pkSess_5222: bitstring = pub(skB) in
                                                {5546}in(c, =GetEndpointRequest);
                                                {5547}new SP_5223: bitstring;
                                                {5548}new UP_5224: bitstring;
                                                {5549}out(c, (GetEndpointResponse,pkSess_5222,SignAndEncrypt,SP_5223,UP_5224))
                                            )
                                            else
                                                {5550}let v_5225: bool = (Sess_4234 = C) in
                                                (
                                                    {5551}if v_5225 then
                                                    (
                                                        {5552}let pkSess_5226: bitstring = pub(skC) in
                                                        {5553}in(c, =GetEndpointRequest);
                                                        {5554}new SP_5227: bitstring;
                                                        {5555}new UP_5228: bitstring;
                                                        {5556}out(c, (GetEndpointResponse,pkSess_5226,SignAndEncrypt,SP_5227,UP_5228))
                                                    )
                                                    else
                                                        {5557}let pkSess_5229: bitstring = pub(sk(Sess_4234)) in
                                                        {5558}in(c, =GetEndpointRequest);
                                                        {5559}new SP_5230: bitstring;
                                                        {5560}new UP_5231: bitstring;
                                                        {5561}out(c, (GetEndpointResponse,pkSess_5229,SignAndEncrypt,SP_5230,UP_5231))
                                                )
                                                else
                                                    {5562}let pkSess_5232: bitstring = fail-any in
                                                    {5563}in(c, =GetEndpointRequest);
                                                    {5564}new SP_5233: bitstring;
                                                    {5565}new UP_5234: bitstring;
                                                    {5566}out(c, (GetEndpointResponse,pkSess_5232,SignAndEncrypt,SP_5233,UP_5234))
                                        )
                                        else
                                            {5567}let pkSess_5235: bitstring = fail-any in
                                            {5568}in(c, =GetEndpointRequest);
                                            {5569}new SP_5236: bitstring;
                                            {5570}new UP_5237: bitstring;
                                            {5571}out(c, (GetEndpointResponse,pkSess_5235,SignAndEncrypt,SP_5236,UP_5237))
                                )
                                else
                                    {5572}let pkSess_5238: bitstring = fail-any in
                                    {5573}in(c, =GetEndpointRequest);
                                    {5574}new SP_5239: bitstring;
                                    {5575}new UP_5240: bitstring;
                                    {5576}out(c, (GetEndpointResponse,pkSess_5238,SignAndEncrypt,SP_5239,UP_5240))
                        )
                        else
                            {5577}let pkCli_5241: bitstring = fail-any in
                            {5578}let v_5242: bool = (Sess_4234 = A) in
                            (
                                {5579}if v_5242 then
                                (
                                    {5580}let pkSess_5243: bitstring = pub(skA) in
                                    {5581}in(c, =GetEndpointRequest);
                                    {5582}new SP_5244: bitstring;
                                    {5583}new UP_5245: bitstring;
                                    {5584}out(c, (GetEndpointResponse,pkSess_5243,SignAndEncrypt,SP_5244,UP_5245))
                                )
                                else
                                    {5585}let v_5246: bool = (Sess_4234 = B) in
                                    (
                                        {5586}if v_5246 then
                                        (
                                            {5587}let pkSess_5247: bitstring = pub(skB) in
                                            {5588}in(c, =GetEndpointRequest);
                                            {5589}new SP_5248: bitstring;
                                            {5590}new UP_5249: bitstring;
                                            {5591}out(c, (GetEndpointResponse,pkSess_5247,SignAndEncrypt,SP_5248,UP_5249))
                                        )
                                        else
                                            {5592}let v_5250: bool = (Sess_4234 = C) in
                                            (
                                                {5593}if v_5250 then
                                                (
                                                    {5594}let pkSess_5251: bitstring = pub(skC) in
                                                    {5595}in(c, =GetEndpointRequest);
                                                    {5596}new SP_5252: bitstring;
                                                    {5597}new UP_5253: bitstring;
                                                    {5598}out(c, (GetEndpointResponse,pkSess_5251,SignAndEncrypt,SP_5252,UP_5253))
                                                )
                                                else
                                                    {5599}let pkSess_5254: bitstring = pub(sk(Sess_4234)) in
                                                    {5600}in(c, =GetEndpointRequest);
                                                    {5601}new SP_5255: bitstring;
                                                    {5602}new UP_5256: bitstring;
                                                    {5603}out(c, (GetEndpointResponse,pkSess_5254,SignAndEncrypt,SP_5255,UP_5256))
                                            )
                                            else
                                                {5604}let pkSess_5257: bitstring = fail-any in
                                                {5605}in(c, =GetEndpointRequest);
                                                {5606}new SP_5258: bitstring;
                                                {5607}new UP_5259: bitstring;
                                                {5608}out(c, (GetEndpointResponse,pkSess_5257,SignAndEncrypt,SP_5258,UP_5259))
                                    )
                                    else
                                        {5609}let pkSess_5260: bitstring = fail-any in
                                        {5610}in(c, =GetEndpointRequest);
                                        {5611}new SP_5261: bitstring;
                                        {5612}new UP_5262: bitstring;
                                        {5613}out(c, (GetEndpointResponse,pkSess_5260,SignAndEncrypt,SP_5261,UP_5262))
                            )
                            else
                                {5614}let pkSess_5263: bitstring = fail-any in
                                {5615}in(c, =GetEndpointRequest);
                                {5616}new SP_5264: bitstring;
                                {5617}new UP_5265: bitstring;
                                {5618}out(c, (GetEndpointResponse,pkSess_5263,SignAndEncrypt,SP_5264,UP_5265))
                )
                else
                    {5619}let pkCli_5266: bitstring = fail-any in
                    {5620}let v_5267: bool = (Sess_4234 = A) in
                    (
                        {5621}if v_5267 then
                        (
                            {5622}let pkSess_5268: bitstring = pub(skA) in
                            {5623}in(c, =GetEndpointRequest);
                            {5624}new SP_5269: bitstring;
                            {5625}new UP_5270: bitstring;
                            {5626}out(c, (GetEndpointResponse,pkSess_5268,SignAndEncrypt,SP_5269,UP_5270))
                        )
                        else
                            {5627}let v_5271: bool = (Sess_4234 = B) in
                            (
                                {5628}if v_5271 then
                                (
                                    {5629}let pkSess_5272: bitstring = pub(skB) in
                                    {5630}in(c, =GetEndpointRequest);
                                    {5631}new SP_5273: bitstring;
                                    {5632}new UP_5274: bitstring;
                                    {5633}out(c, (GetEndpointResponse,pkSess_5272,SignAndEncrypt,SP_5273,UP_5274))
                                )
                                else
                                    {5634}let v_5275: bool = (Sess_4234 = C) in
                                    (
                                        {5635}if v_5275 then
                                        (
                                            {5636}let pkSess_5276: bitstring = pub(skC) in
                                            {5637}in(c, =GetEndpointRequest);
                                            {5638}new SP_5277: bitstring;
                                            {5639}new UP_5278: bitstring;
                                            {5640}out(c, (GetEndpointResponse,pkSess_5276,SignAndEncrypt,SP_5277,UP_5278))
                                        )
                                        else
                                            {5641}let pkSess_5279: bitstring = pub(sk(Sess_4234)) in
                                            {5642}in(c, =GetEndpointRequest);
                                            {5643}new SP_5280: bitstring;
                                            {5644}new UP_5281: bitstring;
                                            {5645}out(c, (GetEndpointResponse,pkSess_5279,SignAndEncrypt,SP_5280,UP_5281))
                                    )
                                    else
                                        {5646}let pkSess_5282: bitstring = fail-any in
                                        {5647}in(c, =GetEndpointRequest);
                                        {5648}new SP_5283: bitstring;
                                        {5649}new UP_5284: bitstring;
                                        {5650}out(c, (GetEndpointResponse,pkSess_5282,SignAndEncrypt,SP_5283,UP_5284))
                            )
                            else
                                {5651}let pkSess_5285: bitstring = fail-any in
                                {5652}in(c, =GetEndpointRequest);
                                {5653}new SP_5286: bitstring;
                                {5654}new UP_5287: bitstring;
                                {5655}out(c, (GetEndpointResponse,pkSess_5285,SignAndEncrypt,SP_5286,UP_5287))
                    )
                    else
                        {5656}let pkSess_5288: bitstring = fail-any in
                        {5657}in(c, =GetEndpointRequest);
                        {5658}new SP_5289: bitstring;
                        {5659}new UP_5290: bitstring;
                        {5660}out(c, (GetEndpointResponse,pkSess_5288,SignAndEncrypt,SP_5289,UP_5290))
        )
        else
            {5661}let pkCli_5291: bitstring = fail-any in
            {5662}let v_5292: bool = (Sess_4234 = A) in
            (
                {5663}if v_5292 then
                (
                    {5664}let pkSess_5293: bitstring = pub(skA) in
                    {5665}in(c, =GetEndpointRequest);
                    {5666}new SP_5294: bitstring;
                    {5667}new UP_5295: bitstring;
                    {5668}out(c, (GetEndpointResponse,pkSess_5293,SignAndEncrypt,SP_5294,UP_5295))
                )
                else
                    {5669}let v_5296: bool = (Sess_4234 = B) in
                    (
                        {5670}if v_5296 then
                        (
                            {5671}let pkSess_5297: bitstring = pub(skB) in
                            {5672}in(c, =GetEndpointRequest);
                            {5673}new SP_5298: bitstring;
                            {5674}new UP_5299: bitstring;
                            {5675}out(c, (GetEndpointResponse,pkSess_5297,SignAndEncrypt,SP_5298,UP_5299))
                        )
                        else
                            {5676}let v_5300: bool = (Sess_4234 = C) in
                            (
                                {5677}if v_5300 then
                                (
                                    {5678}let pkSess_5301: bitstring = pub(skC) in
                                    {5679}in(c, =GetEndpointRequest);
                                    {5680}new SP_5302: bitstring;
                                    {5681}new UP_5303: bitstring;
                                    {5682}out(c, (GetEndpointResponse,pkSess_5301,SignAndEncrypt,SP_5302,UP_5303))
                                )
                                else
                                    {5683}let pkSess_5304: bitstring = pub(sk(Sess_4234)) in
                                    {5684}in(c, =GetEndpointRequest);
                                    {5685}new SP_5305: bitstring;
                                    {5686}new UP_5306: bitstring;
                                    {5687}out(c, (GetEndpointResponse,pkSess_5304,SignAndEncrypt,SP_5305,UP_5306))
                            )
                            else
                                {5688}let pkSess_5307: bitstring = fail-any in
                                {5689}in(c, =GetEndpointRequest);
                                {5690}new SP_5308: bitstring;
                                {5691}new UP_5309: bitstring;
                                {5692}out(c, (GetEndpointResponse,pkSess_5307,SignAndEncrypt,SP_5308,UP_5309))
                    )
                    else
                        {5693}let pkSess_5310: bitstring = fail-any in
                        {5694}in(c, =GetEndpointRequest);
                        {5695}new SP_5311: bitstring;
                        {5696}new UP_5312: bitstring;
                        {5697}out(c, (GetEndpointResponse,pkSess_5310,SignAndEncrypt,SP_5311,UP_5312))
            )
            else
                {5698}let pkSess_5313: bitstring = fail-any in
                {5699}in(c, =GetEndpointRequest);
                {5700}new SP_5314: bitstring;
                {5701}new UP_5315: bitstring;
                {5702}out(c, (GetEndpointResponse,pkSess_5313,SignAndEncrypt,SP_5314,UP_5315))
) | (
    {5703}!
    {5704}in(c, (Cli_5316: host,Disco_5317: host,Sess_5318: host));
    {5705}let v_5319: bool = (Sess_5318 = A) in
    (
        {5706}if v_5319 then
        (
            {5707}let skSess: bitstring = skA in
            {5708}let pkSess_5320: bitstring = pub(skSess) in
            {5709}let v_5321: bool = (Cli_5316 = A) in
            (
                {5710}if v_5321 then
                (
                    {5711}let pkCli_5322: bitstring = pub(skA) in
                    {5712}let v_5323: bool = (Disco_5317 = A) in
                    (
                        {5713}if v_5323 then
                        (
                            {5714}let pkDisco_5324: bitstring = pub(skA) in
                            {5715}in(c, (=pkCli_5322,em1: bitstring,sigM1: bitstring));
                            {5716}let m1_5325: bitstring = dec(em1,skSess) in
                            {5717}if (verify(h(m1_5325),sigM1,pkCli_5322) <> true) then
                                0
                            else
                                {5718}let (=OpenSecureChannelRequest,=pkCli_5322,Nc_5326: bitstring) = m1_5325 in
                                {5719}new Ns_5327: bitstring;
                                {5720}new ST_5328: bitstring;
                                {5721}new TTL_5329: bitstring;
                                {5722}let m2_5330: bitstring = (OpenSecureChannelResponse,Ns_5327,ST_5328,TTL_5329) in
                                {5723}out(c, (enc(m2_5330,pkCli_5322),sign(h(m2_5330),skSess)));
                                {5724}let Ksrv: bitstring = h((Ns_5327,Nc_5326)) in
                                {5725}out(c, senc(mSrv(pkCli_5322,pkSess_5320),Ksrv))
                        )
                        else
                            {5726}let v_5331: bool = (Disco_5317 = B) in
                            (
                                {5727}if v_5331 then
                                (
                                    {5728}let pkDisco_5332: bitstring = pub(skB) in
                                    {5729}in(c, (=pkCli_5322,em1_5333: bitstring,sigM1_5334: bitstring));
                                    {5730}let m1_5335: bitstring = dec(em1_5333,skSess) in
                                    {5731}if (verify(h(m1_5335),sigM1_5334,pkCli_5322) <> true) then
                                        0
                                    else
                                        {5732}let (=OpenSecureChannelRequest,=pkCli_5322,Nc_5336: bitstring) = m1_5335 in
                                        {5733}new Ns_5337: bitstring;
                                        {5734}new ST_5338: bitstring;
                                        {5735}new TTL_5339: bitstring;
                                        {5736}let m2_5340: bitstring = (OpenSecureChannelResponse,Ns_5337,ST_5338,TTL_5339) in
                                        {5737}out(c, (enc(m2_5340,pkCli_5322),sign(h(m2_5340),skSess)));
                                        {5738}let Ksrv_5341: bitstring = h((Ns_5337,Nc_5336)) in
                                        {5739}out(c, senc(mSrv(pkCli_5322,pkSess_5320),Ksrv_5341))
                                )
                                else
                                    {5740}let v_5342: bool = (Disco_5317 = C) in
                                    (
                                        {5741}if v_5342 then
                                        (
                                            {5742}let pkDisco_5343: bitstring = pub(skC) in
                                            {5743}in(c, (=pkCli_5322,em1_5344: bitstring,sigM1_5345: bitstring));
                                            {5744}let m1_5346: bitstring = dec(em1_5344,skSess) in
                                            {5745}if (verify(h(m1_5346),sigM1_5345,pkCli_5322) <> true) then
                                                0
                                            else
                                                {5746}let (=OpenSecureChannelRequest,=pkCli_5322,Nc_5347: bitstring) = m1_5346 in
                                                {5747}new Ns_5348: bitstring;
                                                {5748}new ST_5349: bitstring;
                                                {5749}new TTL_5350: bitstring;
                                                {5750}let m2_5351: bitstring = (OpenSecureChannelResponse,Ns_5348,ST_5349,TTL_5350) in
                                                {5751}out(c, (enc(m2_5351,pkCli_5322),sign(h(m2_5351),skSess)));
                                                {5752}let Ksrv_5352: bitstring = h((Ns_5348,Nc_5347)) in
                                                {5753}out(c, senc(mSrv(pkCli_5322,pkSess_5320),Ksrv_5352))
                                        )
                                        else
                                            {5754}let pkDisco_5353: bitstring = pub(sk(Disco_5317)) in
                                            {5755}in(c, (=pkCli_5322,em1_5354: bitstring,sigM1_5355: bitstring));
                                            {5756}let m1_5356: bitstring = dec(em1_5354,skSess) in
                                            {5757}if (verify(h(m1_5356),sigM1_5355,pkCli_5322) <> true) then
                                                0
                                            else
                                                {5758}let (=OpenSecureChannelRequest,=pkCli_5322,Nc_5357: bitstring) = m1_5356 in
                                                {5759}new Ns_5358: bitstring;
                                                {5760}new ST_5359: bitstring;
                                                {5761}new TTL_5360: bitstring;
                                                {5762}let m2_5361: bitstring = (OpenSecureChannelResponse,Ns_5358,ST_5359,TTL_5360) in
                                                {5763}out(c, (enc(m2_5361,pkCli_5322),sign(h(m2_5361),skSess)));
                                                {5764}let Ksrv_5362: bitstring = h((Ns_5358,Nc_5357)) in
                                                {5765}out(c, senc(mSrv(pkCli_5322,pkSess_5320),Ksrv_5362))
                                    )
                                    else
                                        {5766}let pkDisco_5363: bitstring = fail-any in
                                        {5767}in(c, (=pkCli_5322,em1_5364: bitstring,sigM1_5365: bitstring));
                                        {5768}let m1_5366: bitstring = dec(em1_5364,skSess) in
                                        {5769}if (verify(h(m1_5366),sigM1_5365,pkCli_5322) <> true) then
                                            0
                                        else
                                            {5770}let (=OpenSecureChannelRequest,=pkCli_5322,Nc_5367: bitstring) = m1_5366 in
                                            {5771}new Ns_5368: bitstring;
                                            {5772}new ST_5369: bitstring;
                                            {5773}new TTL_5370: bitstring;
                                            {5774}let m2_5371: bitstring = (OpenSecureChannelResponse,Ns_5368,ST_5369,TTL_5370) in
                                            {5775}out(c, (enc(m2_5371,pkCli_5322),sign(h(m2_5371),skSess)));
                                            {5776}let Ksrv_5372: bitstring = h((Ns_5368,Nc_5367)) in
                                            {5777}out(c, senc(mSrv(pkCli_5322,pkSess_5320),Ksrv_5372))
                            )
                            else
                                {5778}let pkDisco_5373: bitstring = fail-any in
                                {5779}in(c, (=pkCli_5322,em1_5374: bitstring,sigM1_5375: bitstring));
                                {5780}let m1_5376: bitstring = dec(em1_5374,skSess) in
                                {5781}if (verify(h(m1_5376),sigM1_5375,pkCli_5322) <> true) then
                                    0
                                else
                                    {5782}let (=OpenSecureChannelRequest,=pkCli_5322,Nc_5377: bitstring) = m1_5376 in
                                    {5783}new Ns_5378: bitstring;
                                    {5784}new ST_5379: bitstring;
                                    {5785}new TTL_5380: bitstring;
                                    {5786}let m2_5381: bitstring = (OpenSecureChannelResponse,Ns_5378,ST_5379,TTL_5380) in
                                    {5787}out(c, (enc(m2_5381,pkCli_5322),sign(h(m2_5381),skSess)));
                                    {5788}let Ksrv_5382: bitstring = h((Ns_5378,Nc_5377)) in
                                    {5789}out(c, senc(mSrv(pkCli_5322,pkSess_5320),Ksrv_5382))
                    )
                    else
                        {5790}let pkDisco_5383: bitstring = fail-any in
                        {5791}in(c, (=pkCli_5322,em1_5384: bitstring,sigM1_5385: bitstring));
                        {5792}let m1_5386: bitstring = dec(em1_5384,skSess) in
                        {5793}if (verify(h(m1_5386),sigM1_5385,pkCli_5322) <> true) then
                            0
                        else
                            {5794}let (=OpenSecureChannelRequest,=pkCli_5322,Nc_5387: bitstring) = m1_5386 in
                            {5795}new Ns_5388: bitstring;
                            {5796}new ST_5389: bitstring;
                            {5797}new TTL_5390: bitstring;
                            {5798}let m2_5391: bitstring = (OpenSecureChannelResponse,Ns_5388,ST_5389,TTL_5390) in
                            {5799}out(c, (enc(m2_5391,pkCli_5322),sign(h(m2_5391),skSess)));
                            {5800}let Ksrv_5392: bitstring = h((Ns_5388,Nc_5387)) in
                            {5801}out(c, senc(mSrv(pkCli_5322,pkSess_5320),Ksrv_5392))
                )
                else
                    {5802}let v_5393: bool = (Cli_5316 = B) in
                    (
                        {5803}if v_5393 then
                        (
                            {5804}let pkCli_5394: bitstring = pub(skB) in
                            {5805}let v_5395: bool = (Disco_5317 = A) in
                            (
                                {5806}if v_5395 then
                                (
                                    {5807}let pkDisco_5396: bitstring = pub(skA) in
                                    {5808}in(c, (=pkCli_5394,em1_5397: bitstring,sigM1_5398: bitstring));
                                    {5809}let m1_5399: bitstring = dec(em1_5397,skSess) in
                                    {5810}if (verify(h(m1_5399),sigM1_5398,pkCli_5394) <> true) then
                                        0
                                    else
                                        {5811}let (=OpenSecureChannelRequest,=pkCli_5394,Nc_5400: bitstring) = m1_5399 in
                                        {5812}new Ns_5401: bitstring;
                                        {5813}new ST_5402: bitstring;
                                        {5814}new TTL_5403: bitstring;
                                        {5815}let m2_5404: bitstring = (OpenSecureChannelResponse,Ns_5401,ST_5402,TTL_5403) in
                                        {5816}out(c, (enc(m2_5404,pkCli_5394),sign(h(m2_5404),skSess)));
                                        {5817}let Ksrv_5405: bitstring = h((Ns_5401,Nc_5400)) in
                                        {5818}out(c, senc(mSrv(pkCli_5394,pkSess_5320),Ksrv_5405))
                                )
                                else
                                    {5819}let v_5406: bool = (Disco_5317 = B) in
                                    (
                                        {5820}if v_5406 then
                                        (
                                            {5821}let pkDisco_5407: bitstring = pub(skB) in
                                            {5822}in(c, (=pkCli_5394,em1_5408: bitstring,sigM1_5409: bitstring));
                                            {5823}let m1_5410: bitstring = dec(em1_5408,skSess) in
                                            {5824}if (verify(h(m1_5410),sigM1_5409,pkCli_5394) <> true) then
                                                0
                                            else
                                                {5825}let (=OpenSecureChannelRequest,=pkCli_5394,Nc_5411: bitstring) = m1_5410 in
                                                {5826}new Ns_5412: bitstring;
                                                {5827}new ST_5413: bitstring;
                                                {5828}new TTL_5414: bitstring;
                                                {5829}let m2_5415: bitstring = (OpenSecureChannelResponse,Ns_5412,ST_5413,TTL_5414) in
                                                {5830}out(c, (enc(m2_5415,pkCli_5394),sign(h(m2_5415),skSess)));
                                                {5831}let Ksrv_5416: bitstring = h((Ns_5412,Nc_5411)) in
                                                {5832}out(c, senc(mSrv(pkCli_5394,pkSess_5320),Ksrv_5416))
                                        )
                                        else
                                            {5833}let v_5417: bool = (Disco_5317 = C) in
                                            (
                                                {5834}if v_5417 then
                                                (
                                                    {5835}let pkDisco_5418: bitstring = pub(skC) in
                                                    {5836}in(c, (=pkCli_5394,em1_5419: bitstring,sigM1_5420: bitstring));
                                                    {5837}let m1_5421: bitstring = dec(em1_5419,skSess) in
                                                    {5838}if (verify(h(m1_5421),sigM1_5420,pkCli_5394) <> true) then
                                                        0
                                                    else
                                                        {5839}let (=OpenSecureChannelRequest,=pkCli_5394,Nc_5422: bitstring) = m1_5421 in
                                                        {5840}new Ns_5423: bitstring;
                                                        {5841}new ST_5424: bitstring;
                                                        {5842}new TTL_5425: bitstring;
                                                        {5843}let m2_5426: bitstring = (OpenSecureChannelResponse,Ns_5423,ST_5424,TTL_5425) in
                                                        {5844}out(c, (enc(m2_5426,pkCli_5394),sign(h(m2_5426),skSess)));
                                                        {5845}let Ksrv_5427: bitstring = h((Ns_5423,Nc_5422)) in
                                                        {5846}out(c, senc(mSrv(pkCli_5394,pkSess_5320),Ksrv_5427))
                                                )
                                                else
                                                    {5847}let pkDisco_5428: bitstring = pub(sk(Disco_5317)) in
                                                    {5848}in(c, (=pkCli_5394,em1_5429: bitstring,sigM1_5430: bitstring));
                                                    {5849}let m1_5431: bitstring = dec(em1_5429,skSess) in
                                                    {5850}if (verify(h(m1_5431),sigM1_5430,pkCli_5394) <> true) then
                                                        0
                                                    else
                                                        {5851}let (=OpenSecureChannelRequest,=pkCli_5394,Nc_5432: bitstring) = m1_5431 in
                                                        {5852}new Ns_5433: bitstring;
                                                        {5853}new ST_5434: bitstring;
                                                        {5854}new TTL_5435: bitstring;
                                                        {5855}let m2_5436: bitstring = (OpenSecureChannelResponse,Ns_5433,ST_5434,TTL_5435) in
                                                        {5856}out(c, (enc(m2_5436,pkCli_5394),sign(h(m2_5436),skSess)));
                                                        {5857}let Ksrv_5437: bitstring = h((Ns_5433,Nc_5432)) in
                                                        {5858}out(c, senc(mSrv(pkCli_5394,pkSess_5320),Ksrv_5437))
                                            )
                                            else
                                                {5859}let pkDisco_5438: bitstring = fail-any in
                                                {5860}in(c, (=pkCli_5394,em1_5439: bitstring,sigM1_5440: bitstring));
                                                {5861}let m1_5441: bitstring = dec(em1_5439,skSess) in
                                                {5862}if (verify(h(m1_5441),sigM1_5440,pkCli_5394) <> true) then
                                                    0
                                                else
                                                    {5863}let (=OpenSecureChannelRequest,=pkCli_5394,Nc_5442: bitstring) = m1_5441 in
                                                    {5864}new Ns_5443: bitstring;
                                                    {5865}new ST_5444: bitstring;
                                                    {5866}new TTL_5445: bitstring;
                                                    {5867}let m2_5446: bitstring = (OpenSecureChannelResponse,Ns_5443,ST_5444,TTL_5445) in
                                                    {5868}out(c, (enc(m2_5446,pkCli_5394),sign(h(m2_5446),skSess)));
                                                    {5869}let Ksrv_5447: bitstring = h((Ns_5443,Nc_5442)) in
                                                    {5870}out(c, senc(mSrv(pkCli_5394,pkSess_5320),Ksrv_5447))
                                    )
                                    else
                                        {5871}let pkDisco_5448: bitstring = fail-any in
                                        {5872}in(c, (=pkCli_5394,em1_5449: bitstring,sigM1_5450: bitstring));
                                        {5873}let m1_5451: bitstring = dec(em1_5449,skSess) in
                                        {5874}if (verify(h(m1_5451),sigM1_5450,pkCli_5394) <> true) then
                                            0
                                        else
                                            {5875}let (=OpenSecureChannelRequest,=pkCli_5394,Nc_5452: bitstring) = m1_5451 in
                                            {5876}new Ns_5453: bitstring;
                                            {5877}new ST_5454: bitstring;
                                            {5878}new TTL_5455: bitstring;
                                            {5879}let m2_5456: bitstring = (OpenSecureChannelResponse,Ns_5453,ST_5454,TTL_5455) in
                                            {5880}out(c, (enc(m2_5456,pkCli_5394),sign(h(m2_5456),skSess)));
                                            {5881}let Ksrv_5457: bitstring = h((Ns_5453,Nc_5452)) in
                                            {5882}out(c, senc(mSrv(pkCli_5394,pkSess_5320),Ksrv_5457))
                            )
                            else
                                {5883}let pkDisco_5458: bitstring = fail-any in
                                {5884}in(c, (=pkCli_5394,em1_5459: bitstring,sigM1_5460: bitstring));
                                {5885}let m1_5461: bitstring = dec(em1_5459,skSess) in
                                {5886}if (verify(h(m1_5461),sigM1_5460,pkCli_5394) <> true) then
                                    0
                                else
                                    {5887}let (=OpenSecureChannelRequest,=pkCli_5394,Nc_5462: bitstring) = m1_5461 in
                                    {5888}new Ns_5463: bitstring;
                                    {5889}new ST_5464: bitstring;
                                    {5890}new TTL_5465: bitstring;
                                    {5891}let m2_5466: bitstring = (OpenSecureChannelResponse,Ns_5463,ST_5464,TTL_5465) in
                                    {5892}out(c, (enc(m2_5466,pkCli_5394),sign(h(m2_5466),skSess)));
                                    {5893}let Ksrv_5467: bitstring = h((Ns_5463,Nc_5462)) in
                                    {5894}out(c, senc(mSrv(pkCli_5394,pkSess_5320),Ksrv_5467))
                        )
                        else
                            {5895}let v_5468: bool = (Cli_5316 = C) in
                            (
                                {5896}if v_5468 then
                                (
                                    {5897}let pkCli_5469: bitstring = pub(skC) in
                                    {5898}let v_5470: bool = (Disco_5317 = A) in
                                    (
                                        {5899}if v_5470 then
                                        (
                                            {5900}let pkDisco_5471: bitstring = pub(skA) in
                                            {5901}in(c, (=pkCli_5469,em1_5472: bitstring,sigM1_5473: bitstring));
                                            {5902}let m1_5474: bitstring = dec(em1_5472,skSess) in
                                            {5903}if (verify(h(m1_5474),sigM1_5473,pkCli_5469) <> true) then
                                                0
                                            else
                                                {5904}let (=OpenSecureChannelRequest,=pkCli_5469,Nc_5475: bitstring) = m1_5474 in
                                                {5905}new Ns_5476: bitstring;
                                                {5906}new ST_5477: bitstring;
                                                {5907}new TTL_5478: bitstring;
                                                {5908}let m2_5479: bitstring = (OpenSecureChannelResponse,Ns_5476,ST_5477,TTL_5478) in
                                                {5909}out(c, (enc(m2_5479,pkCli_5469),sign(h(m2_5479),skSess)));
                                                {5910}let Ksrv_5480: bitstring = h((Ns_5476,Nc_5475)) in
                                                {5911}out(c, senc(mSrv(pkCli_5469,pkSess_5320),Ksrv_5480))
                                        )
                                        else
                                            {5912}let v_5481: bool = (Disco_5317 = B) in
                                            (
                                                {5913}if v_5481 then
                                                (
                                                    {5914}let pkDisco_5482: bitstring = pub(skB) in
                                                    {5915}in(c, (=pkCli_5469,em1_5483: bitstring,sigM1_5484: bitstring));
                                                    {5916}let m1_5485: bitstring = dec(em1_5483,skSess) in
                                                    {5917}if (verify(h(m1_5485),sigM1_5484,pkCli_5469) <> true) then
                                                        0
                                                    else
                                                        {5918}let (=OpenSecureChannelRequest,=pkCli_5469,Nc_5486: bitstring) = m1_5485 in
                                                        {5919}new Ns_5487: bitstring;
                                                        {5920}new ST_5488: bitstring;
                                                        {5921}new TTL_5489: bitstring;
                                                        {5922}let m2_5490: bitstring = (OpenSecureChannelResponse,Ns_5487,ST_5488,TTL_5489) in
                                                        {5923}out(c, (enc(m2_5490,pkCli_5469),sign(h(m2_5490),skSess)));
                                                        {5924}let Ksrv_5491: bitstring = h((Ns_5487,Nc_5486)) in
                                                        {5925}out(c, senc(mSrv(pkCli_5469,pkSess_5320),Ksrv_5491))
                                                )
                                                else
                                                    {5926}let v_5492: bool = (Disco_5317 = C) in
                                                    (
                                                        {5927}if v_5492 then
                                                        (
                                                            {5928}let pkDisco_5493: bitstring = pub(skC) in
                                                            {5929}in(c, (=pkCli_5469,em1_5494: bitstring,sigM1_5495: bitstring));
                                                            {5930}let m1_5496: bitstring = dec(em1_5494,skSess) in
                                                            {5931}if (verify(h(m1_5496),sigM1_5495,pkCli_5469) <> true) then
                                                                0
                                                            else
                                                                {5932}let (=OpenSecureChannelRequest,=pkCli_5469,Nc_5497: bitstring) = m1_5496 in
                                                                {5933}new Ns_5498: bitstring;
                                                                {5934}new ST_5499: bitstring;
                                                                {5935}new TTL_5500: bitstring;
                                                                {5936}let m2_5501: bitstring = (OpenSecureChannelResponse,Ns_5498,ST_5499,TTL_5500) in
                                                                {5937}out(c, (enc(m2_5501,pkCli_5469),sign(h(m2_5501),skSess)));
                                                                {5938}let Ksrv_5502: bitstring = h((Ns_5498,Nc_5497)) in
                                                                {5939}out(c, senc(mSrv(pkCli_5469,pkSess_5320),Ksrv_5502))
                                                        )
                                                        else
                                                            {5940}let pkDisco_5503: bitstring = pub(sk(Disco_5317)) in
                                                            {5941}in(c, (=pkCli_5469,em1_5504: bitstring,sigM1_5505: bitstring));
                                                            {5942}let m1_5506: bitstring = dec(em1_5504,skSess) in
                                                            {5943}if (verify(h(m1_5506),sigM1_5505,pkCli_5469) <> true) then
                                                                0
                                                            else
                                                                {5944}let (=OpenSecureChannelRequest,=pkCli_5469,Nc_5507: bitstring) = m1_5506 in
                                                                {5945}new Ns_5508: bitstring;
                                                                {5946}new ST_5509: bitstring;
                                                                {5947}new TTL_5510: bitstring;
                                                                {5948}let m2_5511: bitstring = (OpenSecureChannelResponse,Ns_5508,ST_5509,TTL_5510) in
                                                                {5949}out(c, (enc(m2_5511,pkCli_5469),sign(h(m2_5511),skSess)));
                                                                {5950}let Ksrv_5512: bitstring = h((Ns_5508,Nc_5507)) in
                                                                {5951}out(c, senc(mSrv(pkCli_5469,pkSess_5320),Ksrv_5512))
                                                    )
                                                    else
                                                        {5952}let pkDisco_5513: bitstring = fail-any in
                                                        {5953}in(c, (=pkCli_5469,em1_5514: bitstring,sigM1_5515: bitstring));
                                                        {5954}let m1_5516: bitstring = dec(em1_5514,skSess) in
                                                        {5955}if (verify(h(m1_5516),sigM1_5515,pkCli_5469) <> true) then
                                                            0
                                                        else
                                                            {5956}let (=OpenSecureChannelRequest,=pkCli_5469,Nc_5517: bitstring) = m1_5516 in
                                                            {5957}new Ns_5518: bitstring;
                                                            {5958}new ST_5519: bitstring;
                                                            {5959}new TTL_5520: bitstring;
                                                            {5960}let m2_5521: bitstring = (OpenSecureChannelResponse,Ns_5518,ST_5519,TTL_5520) in
                                                            {5961}out(c, (enc(m2_5521,pkCli_5469),sign(h(m2_5521),skSess)));
                                                            {5962}let Ksrv_5522: bitstring = h((Ns_5518,Nc_5517)) in
                                                            {5963}out(c, senc(mSrv(pkCli_5469,pkSess_5320),Ksrv_5522))
                                            )
                                            else
                                                {5964}let pkDisco_5523: bitstring = fail-any in
                                                {5965}in(c, (=pkCli_5469,em1_5524: bitstring,sigM1_5525: bitstring));
                                                {5966}let m1_5526: bitstring = dec(em1_5524,skSess) in
                                                {5967}if (verify(h(m1_5526),sigM1_5525,pkCli_5469) <> true) then
                                                    0
                                                else
                                                    {5968}let (=OpenSecureChannelRequest,=pkCli_5469,Nc_5527: bitstring) = m1_5526 in
                                                    {5969}new Ns_5528: bitstring;
                                                    {5970}new ST_5529: bitstring;
                                                    {5971}new TTL_5530: bitstring;
                                                    {5972}let m2_5531: bitstring = (OpenSecureChannelResponse,Ns_5528,ST_5529,TTL_5530) in
                                                    {5973}out(c, (enc(m2_5531,pkCli_5469),sign(h(m2_5531),skSess)));
                                                    {5974}let Ksrv_5532: bitstring = h((Ns_5528,Nc_5527)) in
                                                    {5975}out(c, senc(mSrv(pkCli_5469,pkSess_5320),Ksrv_5532))
                                    )
                                    else
                                        {5976}let pkDisco_5533: bitstring = fail-any in
                                        {5977}in(c, (=pkCli_5469,em1_5534: bitstring,sigM1_5535: bitstring));
                                        {5978}let m1_5536: bitstring = dec(em1_5534,skSess) in
                                        {5979}if (verify(h(m1_5536),sigM1_5535,pkCli_5469) <> true) then
                                            0
                                        else
                                            {5980}let (=OpenSecureChannelRequest,=pkCli_5469,Nc_5537: bitstring) = m1_5536 in
                                            {5981}new Ns_5538: bitstring;
                                            {5982}new ST_5539: bitstring;
                                            {5983}new TTL_5540: bitstring;
                                            {5984}let m2_5541: bitstring = (OpenSecureChannelResponse,Ns_5538,ST_5539,TTL_5540) in
                                            {5985}out(c, (enc(m2_5541,pkCli_5469),sign(h(m2_5541),skSess)));
                                            {5986}let Ksrv_5542: bitstring = h((Ns_5538,Nc_5537)) in
                                            {5987}out(c, senc(mSrv(pkCli_5469,pkSess_5320),Ksrv_5542))
                                )
                                else
                                    {5988}let pkCli_5543: bitstring = pub(sk(Cli_5316)) in
                                    {5989}let v_5544: bool = (Disco_5317 = A) in
                                    (
                                        {5990}if v_5544 then
                                        (
                                            {5991}let pkDisco_5545: bitstring = pub(skA) in
                                            {5992}in(c, (=pkCli_5543,em1_5546: bitstring,sigM1_5547: bitstring));
                                            {5993}let m1_5548: bitstring = dec(em1_5546,skSess) in
                                            {5994}if (verify(h(m1_5548),sigM1_5547,pkCli_5543) <> true) then
                                                0
                                            else
                                                {5995}let (=OpenSecureChannelRequest,=pkCli_5543,Nc_5549: bitstring) = m1_5548 in
                                                {5996}new Ns_5550: bitstring;
                                                {5997}new ST_5551: bitstring;
                                                {5998}new TTL_5552: bitstring;
                                                {5999}let m2_5553: bitstring = (OpenSecureChannelResponse,Ns_5550,ST_5551,TTL_5552) in
                                                {6000}out(c, (enc(m2_5553,pkCli_5543),sign(h(m2_5553),skSess)));
                                                {6001}let Ksrv_5554: bitstring = h((Ns_5550,Nc_5549)) in
                                                {6002}out(c, senc(mSrv(pkCli_5543,pkSess_5320),Ksrv_5554))
                                        )
                                        else
                                            {6003}let v_5555: bool = (Disco_5317 = B) in
                                            (
                                                {6004}if v_5555 then
                                                (
                                                    {6005}let pkDisco_5556: bitstring = pub(skB) in
                                                    {6006}in(c, (=pkCli_5543,em1_5557: bitstring,sigM1_5558: bitstring));
                                                    {6007}let m1_5559: bitstring = dec(em1_5557,skSess) in
                                                    {6008}if (verify(h(m1_5559),sigM1_5558,pkCli_5543) <> true) then
                                                        0
                                                    else
                                                        {6009}let (=OpenSecureChannelRequest,=pkCli_5543,Nc_5560: bitstring) = m1_5559 in
                                                        {6010}new Ns_5561: bitstring;
                                                        {6011}new ST_5562: bitstring;
                                                        {6012}new TTL_5563: bitstring;
                                                        {6013}let m2_5564: bitstring = (OpenSecureChannelResponse,Ns_5561,ST_5562,TTL_5563) in
                                                        {6014}out(c, (enc(m2_5564,pkCli_5543),sign(h(m2_5564),skSess)));
                                                        {6015}let Ksrv_5565: bitstring = h((Ns_5561,Nc_5560)) in
                                                        {6016}out(c, senc(mSrv(pkCli_5543,pkSess_5320),Ksrv_5565))
                                                )
                                                else
                                                    {6017}let v_5566: bool = (Disco_5317 = C) in
                                                    (
                                                        {6018}if v_5566 then
                                                        (
                                                            {6019}let pkDisco_5567: bitstring = pub(skC) in
                                                            {6020}in(c, (=pkCli_5543,em1_5568: bitstring,sigM1_5569: bitstring));
                                                            {6021}let m1_5570: bitstring = dec(em1_5568,skSess) in
                                                            {6022}if (verify(h(m1_5570),sigM1_5569,pkCli_5543) <> true) then
                                                                0
                                                            else
                                                                {6023}let (=OpenSecureChannelRequest,=pkCli_5543,Nc_5571: bitstring) = m1_5570 in
                                                                {6024}new Ns_5572: bitstring;
                                                                {6025}new ST_5573: bitstring;
                                                                {6026}new TTL_5574: bitstring;
                                                                {6027}let m2_5575: bitstring = (OpenSecureChannelResponse,Ns_5572,ST_5573,TTL_5574) in
                                                                {6028}out(c, (enc(m2_5575,pkCli_5543),sign(h(m2_5575),skSess)));
                                                                {6029}let Ksrv_5576: bitstring = h((Ns_5572,Nc_5571)) in
                                                                {6030}out(c, senc(mSrv(pkCli_5543,pkSess_5320),Ksrv_5576))
                                                        )
                                                        else
                                                            {6031}let pkDisco_5577: bitstring = pub(sk(Disco_5317)) in
                                                            {6032}in(c, (=pkCli_5543,em1_5578: bitstring,sigM1_5579: bitstring));
                                                            {6033}let m1_5580: bitstring = dec(em1_5578,skSess) in
                                                            {6034}if (verify(h(m1_5580),sigM1_5579,pkCli_5543) <> true) then
                                                                0
                                                            else
                                                                {6035}let (=OpenSecureChannelRequest,=pkCli_5543,Nc_5581: bitstring) = m1_5580 in
                                                                {6036}new Ns_5582: bitstring;
                                                                {6037}new ST_5583: bitstring;
                                                                {6038}new TTL_5584: bitstring;
                                                                {6039}let m2_5585: bitstring = (OpenSecureChannelResponse,Ns_5582,ST_5583,TTL_5584) in
                                                                {6040}out(c, (enc(m2_5585,pkCli_5543),sign(h(m2_5585),skSess)));
                                                                {6041}let Ksrv_5586: bitstring = h((Ns_5582,Nc_5581)) in
                                                                {6042}out(c, senc(mSrv(pkCli_5543,pkSess_5320),Ksrv_5586))
                                                    )
                                                    else
                                                        {6043}let pkDisco_5587: bitstring = fail-any in
                                                        {6044}in(c, (=pkCli_5543,em1_5588: bitstring,sigM1_5589: bitstring));
                                                        {6045}let m1_5590: bitstring = dec(em1_5588,skSess) in
                                                        {6046}if (verify(h(m1_5590),sigM1_5589,pkCli_5543) <> true) then
                                                            0
                                                        else
                                                            {6047}let (=OpenSecureChannelRequest,=pkCli_5543,Nc_5591: bitstring) = m1_5590 in
                                                            {6048}new Ns_5592: bitstring;
                                                            {6049}new ST_5593: bitstring;
                                                            {6050}new TTL_5594: bitstring;
                                                            {6051}let m2_5595: bitstring = (OpenSecureChannelResponse,Ns_5592,ST_5593,TTL_5594) in
                                                            {6052}out(c, (enc(m2_5595,pkCli_5543),sign(h(m2_5595),skSess)));
                                                            {6053}let Ksrv_5596: bitstring = h((Ns_5592,Nc_5591)) in
                                                            {6054}out(c, senc(mSrv(pkCli_5543,pkSess_5320),Ksrv_5596))
                                            )
                                            else
                                                {6055}let pkDisco_5597: bitstring = fail-any in
                                                {6056}in(c, (=pkCli_5543,em1_5598: bitstring,sigM1_5599: bitstring));
                                                {6057}let m1_5600: bitstring = dec(em1_5598,skSess) in
                                                {6058}if (verify(h(m1_5600),sigM1_5599,pkCli_5543) <> true) then
                                                    0
                                                else
                                                    {6059}let (=OpenSecureChannelRequest,=pkCli_5543,Nc_5601: bitstring) = m1_5600 in
                                                    {6060}new Ns_5602: bitstring;
                                                    {6061}new ST_5603: bitstring;
                                                    {6062}new TTL_5604: bitstring;
                                                    {6063}let m2_5605: bitstring = (OpenSecureChannelResponse,Ns_5602,ST_5603,TTL_5604) in
                                                    {6064}out(c, (enc(m2_5605,pkCli_5543),sign(h(m2_5605),skSess)));
                                                    {6065}let Ksrv_5606: bitstring = h((Ns_5602,Nc_5601)) in
                                                    {6066}out(c, senc(mSrv(pkCli_5543,pkSess_5320),Ksrv_5606))
                                    )
                                    else
                                        {6067}let pkDisco_5607: bitstring = fail-any in
                                        {6068}in(c, (=pkCli_5543,em1_5608: bitstring,sigM1_5609: bitstring));
                                        {6069}let m1_5610: bitstring = dec(em1_5608,skSess) in
                                        {6070}if (verify(h(m1_5610),sigM1_5609,pkCli_5543) <> true) then
                                            0
                                        else
                                            {6071}let (=OpenSecureChannelRequest,=pkCli_5543,Nc_5611: bitstring) = m1_5610 in
                                            {6072}new Ns_5612: bitstring;
                                            {6073}new ST_5613: bitstring;
                                            {6074}new TTL_5614: bitstring;
                                            {6075}let m2_5615: bitstring = (OpenSecureChannelResponse,Ns_5612,ST_5613,TTL_5614) in
                                            {6076}out(c, (enc(m2_5615,pkCli_5543),sign(h(m2_5615),skSess)));
                                            {6077}let Ksrv_5616: bitstring = h((Ns_5612,Nc_5611)) in
                                            {6078}out(c, senc(mSrv(pkCli_5543,pkSess_5320),Ksrv_5616))
                            )
                            else
                                {6079}let pkCli_5617: bitstring = fail-any in
                                {6080}let v_5618: bool = (Disco_5317 = A) in
                                (
                                    {6081}if v_5618 then
                                    (
                                        {6082}let pkDisco_5619: bitstring = pub(skA) in
                                        {6083}in(c, (=pkCli_5617,em1_5620: bitstring,sigM1_5621: bitstring));
                                        {6084}let m1_5622: bitstring = dec(em1_5620,skSess) in
                                        {6085}if (verify(h(m1_5622),sigM1_5621,pkCli_5617) <> true) then
                                            0
                                        else
                                            {6086}let (=OpenSecureChannelRequest,=pkCli_5617,Nc_5623: bitstring) = m1_5622 in
                                            {6087}new Ns_5624: bitstring;
                                            {6088}new ST_5625: bitstring;
                                            {6089}new TTL_5626: bitstring;
                                            {6090}let m2_5627: bitstring = (OpenSecureChannelResponse,Ns_5624,ST_5625,TTL_5626) in
                                            {6091}out(c, (enc(m2_5627,pkCli_5617),sign(h(m2_5627),skSess)));
                                            {6092}let Ksrv_5628: bitstring = h((Ns_5624,Nc_5623)) in
                                            {6093}out(c, senc(mSrv(pkCli_5617,pkSess_5320),Ksrv_5628))
                                    )
                                    else
                                        {6094}let v_5629: bool = (Disco_5317 = B) in
                                        (
                                            {6095}if v_5629 then
                                            (
                                                {6096}let pkDisco_5630: bitstring = pub(skB) in
                                                {6097}in(c, (=pkCli_5617,em1_5631: bitstring,sigM1_5632: bitstring));
                                                {6098}let m1_5633: bitstring = dec(em1_5631,skSess) in
                                                {6099}if (verify(h(m1_5633),sigM1_5632,pkCli_5617) <> true) then
                                                    0
                                                else
                                                    {6100}let (=OpenSecureChannelRequest,=pkCli_5617,Nc_5634: bitstring) = m1_5633 in
                                                    {6101}new Ns_5635: bitstring;
                                                    {6102}new ST_5636: bitstring;
                                                    {6103}new TTL_5637: bitstring;
                                                    {6104}let m2_5638: bitstring = (OpenSecureChannelResponse,Ns_5635,ST_5636,TTL_5637) in
                                                    {6105}out(c, (enc(m2_5638,pkCli_5617),sign(h(m2_5638),skSess)));
                                                    {6106}let Ksrv_5639: bitstring = h((Ns_5635,Nc_5634)) in
                                                    {6107}out(c, senc(mSrv(pkCli_5617,pkSess_5320),Ksrv_5639))
                                            )
                                            else
                                                {6108}let v_5640: bool = (Disco_5317 = C) in
                                                (
                                                    {6109}if v_5640 then
                                                    (
                                                        {6110}let pkDisco_5641: bitstring = pub(skC) in
                                                        {6111}in(c, (=pkCli_5617,em1_5642: bitstring,sigM1_5643: bitstring));
                                                        {6112}let m1_5644: bitstring = dec(em1_5642,skSess) in
                                                        {6113}if (verify(h(m1_5644),sigM1_5643,pkCli_5617) <> true) then
                                                            0
                                                        else
                                                            {6114}let (=OpenSecureChannelRequest,=pkCli_5617,Nc_5645: bitstring) = m1_5644 in
                                                            {6115}new Ns_5646: bitstring;
                                                            {6116}new ST_5647: bitstring;
                                                            {6117}new TTL_5648: bitstring;
                                                            {6118}let m2_5649: bitstring = (OpenSecureChannelResponse,Ns_5646,ST_5647,TTL_5648) in
                                                            {6119}out(c, (enc(m2_5649,pkCli_5617),sign(h(m2_5649),skSess)));
                                                            {6120}let Ksrv_5650: bitstring = h((Ns_5646,Nc_5645)) in
                                                            {6121}out(c, senc(mSrv(pkCli_5617,pkSess_5320),Ksrv_5650))
                                                    )
                                                    else
                                                        {6122}let pkDisco_5651: bitstring = pub(sk(Disco_5317)) in
                                                        {6123}in(c, (=pkCli_5617,em1_5652: bitstring,sigM1_5653: bitstring));
                                                        {6124}let m1_5654: bitstring = dec(em1_5652,skSess) in
                                                        {6125}if (verify(h(m1_5654),sigM1_5653,pkCli_5617) <> true) then
                                                            0
                                                        else
                                                            {6126}let (=OpenSecureChannelRequest,=pkCli_5617,Nc_5655: bitstring) = m1_5654 in
                                                            {6127}new Ns_5656: bitstring;
                                                            {6128}new ST_5657: bitstring;
                                                            {6129}new TTL_5658: bitstring;
                                                            {6130}let m2_5659: bitstring = (OpenSecureChannelResponse,Ns_5656,ST_5657,TTL_5658) in
                                                            {6131}out(c, (enc(m2_5659,pkCli_5617),sign(h(m2_5659),skSess)));
                                                            {6132}let Ksrv_5660: bitstring = h((Ns_5656,Nc_5655)) in
                                                            {6133}out(c, senc(mSrv(pkCli_5617,pkSess_5320),Ksrv_5660))
                                                )
                                                else
                                                    {6134}let pkDisco_5661: bitstring = fail-any in
                                                    {6135}in(c, (=pkCli_5617,em1_5662: bitstring,sigM1_5663: bitstring));
                                                    {6136}let m1_5664: bitstring = dec(em1_5662,skSess) in
                                                    {6137}if (verify(h(m1_5664),sigM1_5663,pkCli_5617) <> true) then
                                                        0
                                                    else
                                                        {6138}let (=OpenSecureChannelRequest,=pkCli_5617,Nc_5665: bitstring) = m1_5664 in
                                                        {6139}new Ns_5666: bitstring;
                                                        {6140}new ST_5667: bitstring;
                                                        {6141}new TTL_5668: bitstring;
                                                        {6142}let m2_5669: bitstring = (OpenSecureChannelResponse,Ns_5666,ST_5667,TTL_5668) in
                                                        {6143}out(c, (enc(m2_5669,pkCli_5617),sign(h(m2_5669),skSess)));
                                                        {6144}let Ksrv_5670: bitstring = h((Ns_5666,Nc_5665)) in
                                                        {6145}out(c, senc(mSrv(pkCli_5617,pkSess_5320),Ksrv_5670))
                                        )
                                        else
                                            {6146}let pkDisco_5671: bitstring = fail-any in
                                            {6147}in(c, (=pkCli_5617,em1_5672: bitstring,sigM1_5673: bitstring));
                                            {6148}let m1_5674: bitstring = dec(em1_5672,skSess) in
                                            {6149}if (verify(h(m1_5674),sigM1_5673,pkCli_5617) <> true) then
                                                0
                                            else
                                                {6150}let (=OpenSecureChannelRequest,=pkCli_5617,Nc_5675: bitstring) = m1_5674 in
                                                {6151}new Ns_5676: bitstring;
                                                {6152}new ST_5677: bitstring;
                                                {6153}new TTL_5678: bitstring;
                                                {6154}let m2_5679: bitstring = (OpenSecureChannelResponse,Ns_5676,ST_5677,TTL_5678) in
                                                {6155}out(c, (enc(m2_5679,pkCli_5617),sign(h(m2_5679),skSess)));
                                                {6156}let Ksrv_5680: bitstring = h((Ns_5676,Nc_5675)) in
                                                {6157}out(c, senc(mSrv(pkCli_5617,pkSess_5320),Ksrv_5680))
                                )
                                else
                                    {6158}let pkDisco_5681: bitstring = fail-any in
                                    {6159}in(c, (=pkCli_5617,em1_5682: bitstring,sigM1_5683: bitstring));
                                    {6160}let m1_5684: bitstring = dec(em1_5682,skSess) in
                                    {6161}if (verify(h(m1_5684),sigM1_5683,pkCli_5617) <> true) then
                                        0
                                    else
                                        {6162}let (=OpenSecureChannelRequest,=pkCli_5617,Nc_5685: bitstring) = m1_5684 in
                                        {6163}new Ns_5686: bitstring;
                                        {6164}new ST_5687: bitstring;
                                        {6165}new TTL_5688: bitstring;
                                        {6166}let m2_5689: bitstring = (OpenSecureChannelResponse,Ns_5686,ST_5687,TTL_5688) in
                                        {6167}out(c, (enc(m2_5689,pkCli_5617),sign(h(m2_5689),skSess)));
                                        {6168}let Ksrv_5690: bitstring = h((Ns_5686,Nc_5685)) in
                                        {6169}out(c, senc(mSrv(pkCli_5617,pkSess_5320),Ksrv_5690))
                    )
                    else
                        {6170}let pkCli_5691: bitstring = fail-any in
                        {6171}let v_5692: bool = (Disco_5317 = A) in
                        (
                            {6172}if v_5692 then
                            (
                                {6173}let pkDisco_5693: bitstring = pub(skA) in
                                {6174}in(c, (=pkCli_5691,em1_5694: bitstring,sigM1_5695: bitstring));
                                {6175}let m1_5696: bitstring = dec(em1_5694,skSess) in
                                {6176}if (verify(h(m1_5696),sigM1_5695,pkCli_5691) <> true) then
                                    0
                                else
                                    {6177}let (=OpenSecureChannelRequest,=pkCli_5691,Nc_5697: bitstring) = m1_5696 in
                                    {6178}new Ns_5698: bitstring;
                                    {6179}new ST_5699: bitstring;
                                    {6180}new TTL_5700: bitstring;
                                    {6181}let m2_5701: bitstring = (OpenSecureChannelResponse,Ns_5698,ST_5699,TTL_5700) in
                                    {6182}out(c, (enc(m2_5701,pkCli_5691),sign(h(m2_5701),skSess)));
                                    {6183}let Ksrv_5702: bitstring = h((Ns_5698,Nc_5697)) in
                                    {6184}out(c, senc(mSrv(pkCli_5691,pkSess_5320),Ksrv_5702))
                            )
                            else
                                {6185}let v_5703: bool = (Disco_5317 = B) in
                                (
                                    {6186}if v_5703 then
                                    (
                                        {6187}let pkDisco_5704: bitstring = pub(skB) in
                                        {6188}in(c, (=pkCli_5691,em1_5705: bitstring,sigM1_5706: bitstring));
                                        {6189}let m1_5707: bitstring = dec(em1_5705,skSess) in
                                        {6190}if (verify(h(m1_5707),sigM1_5706,pkCli_5691) <> true) then
                                            0
                                        else
                                            {6191}let (=OpenSecureChannelRequest,=pkCli_5691,Nc_5708: bitstring) = m1_5707 in
                                            {6192}new Ns_5709: bitstring;
                                            {6193}new ST_5710: bitstring;
                                            {6194}new TTL_5711: bitstring;
                                            {6195}let m2_5712: bitstring = (OpenSecureChannelResponse,Ns_5709,ST_5710,TTL_5711) in
                                            {6196}out(c, (enc(m2_5712,pkCli_5691),sign(h(m2_5712),skSess)));
                                            {6197}let Ksrv_5713: bitstring = h((Ns_5709,Nc_5708)) in
                                            {6198}out(c, senc(mSrv(pkCli_5691,pkSess_5320),Ksrv_5713))
                                    )
                                    else
                                        {6199}let v_5714: bool = (Disco_5317 = C) in
                                        (
                                            {6200}if v_5714 then
                                            (
                                                {6201}let pkDisco_5715: bitstring = pub(skC) in
                                                {6202}in(c, (=pkCli_5691,em1_5716: bitstring,sigM1_5717: bitstring));
                                                {6203}let m1_5718: bitstring = dec(em1_5716,skSess) in
                                                {6204}if (verify(h(m1_5718),sigM1_5717,pkCli_5691) <> true) then
                                                    0
                                                else
                                                    {6205}let (=OpenSecureChannelRequest,=pkCli_5691,Nc_5719: bitstring) = m1_5718 in
                                                    {6206}new Ns_5720: bitstring;
                                                    {6207}new ST_5721: bitstring;
                                                    {6208}new TTL_5722: bitstring;
                                                    {6209}let m2_5723: bitstring = (OpenSecureChannelResponse,Ns_5720,ST_5721,TTL_5722) in
                                                    {6210}out(c, (enc(m2_5723,pkCli_5691),sign(h(m2_5723),skSess)));
                                                    {6211}let Ksrv_5724: bitstring = h((Ns_5720,Nc_5719)) in
                                                    {6212}out(c, senc(mSrv(pkCli_5691,pkSess_5320),Ksrv_5724))
                                            )
                                            else
                                                {6213}let pkDisco_5725: bitstring = pub(sk(Disco_5317)) in
                                                {6214}in(c, (=pkCli_5691,em1_5726: bitstring,sigM1_5727: bitstring));
                                                {6215}let m1_5728: bitstring = dec(em1_5726,skSess) in
                                                {6216}if (verify(h(m1_5728),sigM1_5727,pkCli_5691) <> true) then
                                                    0
                                                else
                                                    {6217}let (=OpenSecureChannelRequest,=pkCli_5691,Nc_5729: bitstring) = m1_5728 in
                                                    {6218}new Ns_5730: bitstring;
                                                    {6219}new ST_5731: bitstring;
                                                    {6220}new TTL_5732: bitstring;
                                                    {6221}let m2_5733: bitstring = (OpenSecureChannelResponse,Ns_5730,ST_5731,TTL_5732) in
                                                    {6222}out(c, (enc(m2_5733,pkCli_5691),sign(h(m2_5733),skSess)));
                                                    {6223}let Ksrv_5734: bitstring = h((Ns_5730,Nc_5729)) in
                                                    {6224}out(c, senc(mSrv(pkCli_5691,pkSess_5320),Ksrv_5734))
                                        )
                                        else
                                            {6225}let pkDisco_5735: bitstring = fail-any in
                                            {6226}in(c, (=pkCli_5691,em1_5736: bitstring,sigM1_5737: bitstring));
                                            {6227}let m1_5738: bitstring = dec(em1_5736,skSess) in
                                            {6228}if (verify(h(m1_5738),sigM1_5737,pkCli_5691) <> true) then
                                                0
                                            else
                                                {6229}let (=OpenSecureChannelRequest,=pkCli_5691,Nc_5739: bitstring) = m1_5738 in
                                                {6230}new Ns_5740: bitstring;
                                                {6231}new ST_5741: bitstring;
                                                {6232}new TTL_5742: bitstring;
                                                {6233}let m2_5743: bitstring = (OpenSecureChannelResponse,Ns_5740,ST_5741,TTL_5742) in
                                                {6234}out(c, (enc(m2_5743,pkCli_5691),sign(h(m2_5743),skSess)));
                                                {6235}let Ksrv_5744: bitstring = h((Ns_5740,Nc_5739)) in
                                                {6236}out(c, senc(mSrv(pkCli_5691,pkSess_5320),Ksrv_5744))
                                )
                                else
                                    {6237}let pkDisco_5745: bitstring = fail-any in
                                    {6238}in(c, (=pkCli_5691,em1_5746: bitstring,sigM1_5747: bitstring));
                                    {6239}let m1_5748: bitstring = dec(em1_5746,skSess) in
                                    {6240}if (verify(h(m1_5748),sigM1_5747,pkCli_5691) <> true) then
                                        0
                                    else
                                        {6241}let (=OpenSecureChannelRequest,=pkCli_5691,Nc_5749: bitstring) = m1_5748 in
                                        {6242}new Ns_5750: bitstring;
                                        {6243}new ST_5751: bitstring;
                                        {6244}new TTL_5752: bitstring;
                                        {6245}let m2_5753: bitstring = (OpenSecureChannelResponse,Ns_5750,ST_5751,TTL_5752) in
                                        {6246}out(c, (enc(m2_5753,pkCli_5691),sign(h(m2_5753),skSess)));
                                        {6247}let Ksrv_5754: bitstring = h((Ns_5750,Nc_5749)) in
                                        {6248}out(c, senc(mSrv(pkCli_5691,pkSess_5320),Ksrv_5754))
                        )
                        else
                            {6249}let pkDisco_5755: bitstring = fail-any in
                            {6250}in(c, (=pkCli_5691,em1_5756: bitstring,sigM1_5757: bitstring));
                            {6251}let m1_5758: bitstring = dec(em1_5756,skSess) in
                            {6252}if (verify(h(m1_5758),sigM1_5757,pkCli_5691) <> true) then
                                0
                            else
                                {6253}let (=OpenSecureChannelRequest,=pkCli_5691,Nc_5759: bitstring) = m1_5758 in
                                {6254}new Ns_5760: bitstring;
                                {6255}new ST_5761: bitstring;
                                {6256}new TTL_5762: bitstring;
                                {6257}let m2_5763: bitstring = (OpenSecureChannelResponse,Ns_5760,ST_5761,TTL_5762) in
                                {6258}out(c, (enc(m2_5763,pkCli_5691),sign(h(m2_5763),skSess)));
                                {6259}let Ksrv_5764: bitstring = h((Ns_5760,Nc_5759)) in
                                {6260}out(c, senc(mSrv(pkCli_5691,pkSess_5320),Ksrv_5764))
            )
            else
                {6261}let pkCli_5765: bitstring = fail-any in
                {6262}let v_5766: bool = (Disco_5317 = A) in
                (
                    {6263}if v_5766 then
                    (
                        {6264}let pkDisco_5767: bitstring = pub(skA) in
                        {6265}in(c, (=pkCli_5765,em1_5768: bitstring,sigM1_5769: bitstring));
                        {6266}let m1_5770: bitstring = dec(em1_5768,skSess) in
                        {6267}if (verify(h(m1_5770),sigM1_5769,pkCli_5765) <> true) then
                            0
                        else
                            {6268}let (=OpenSecureChannelRequest,=pkCli_5765,Nc_5771: bitstring) = m1_5770 in
                            {6269}new Ns_5772: bitstring;
                            {6270}new ST_5773: bitstring;
                            {6271}new TTL_5774: bitstring;
                            {6272}let m2_5775: bitstring = (OpenSecureChannelResponse,Ns_5772,ST_5773,TTL_5774) in
                            {6273}out(c, (enc(m2_5775,pkCli_5765),sign(h(m2_5775),skSess)));
                            {6274}let Ksrv_5776: bitstring = h((Ns_5772,Nc_5771)) in
                            {6275}out(c, senc(mSrv(pkCli_5765,pkSess_5320),Ksrv_5776))
                    )
                    else
                        {6276}let v_5777: bool = (Disco_5317 = B) in
                        (
                            {6277}if v_5777 then
                            (
                                {6278}let pkDisco_5778: bitstring = pub(skB) in
                                {6279}in(c, (=pkCli_5765,em1_5779: bitstring,sigM1_5780: bitstring));
                                {6280}let m1_5781: bitstring = dec(em1_5779,skSess) in
                                {6281}if (verify(h(m1_5781),sigM1_5780,pkCli_5765) <> true) then
                                    0
                                else
                                    {6282}let (=OpenSecureChannelRequest,=pkCli_5765,Nc_5782: bitstring) = m1_5781 in
                                    {6283}new Ns_5783: bitstring;
                                    {6284}new ST_5784: bitstring;
                                    {6285}new TTL_5785: bitstring;
                                    {6286}let m2_5786: bitstring = (OpenSecureChannelResponse,Ns_5783,ST_5784,TTL_5785) in
                                    {6287}out(c, (enc(m2_5786,pkCli_5765),sign(h(m2_5786),skSess)));
                                    {6288}let Ksrv_5787: bitstring = h((Ns_5783,Nc_5782)) in
                                    {6289}out(c, senc(mSrv(pkCli_5765,pkSess_5320),Ksrv_5787))
                            )
                            else
                                {6290}let v_5788: bool = (Disco_5317 = C) in
                                (
                                    {6291}if v_5788 then
                                    (
                                        {6292}let pkDisco_5789: bitstring = pub(skC) in
                                        {6293}in(c, (=pkCli_5765,em1_5790: bitstring,sigM1_5791: bitstring));
                                        {6294}let m1_5792: bitstring = dec(em1_5790,skSess) in
                                        {6295}if (verify(h(m1_5792),sigM1_5791,pkCli_5765) <> true) then
                                            0
                                        else
                                            {6296}let (=OpenSecureChannelRequest,=pkCli_5765,Nc_5793: bitstring) = m1_5792 in
                                            {6297}new Ns_5794: bitstring;
                                            {6298}new ST_5795: bitstring;
                                            {6299}new TTL_5796: bitstring;
                                            {6300}let m2_5797: bitstring = (OpenSecureChannelResponse,Ns_5794,ST_5795,TTL_5796) in
                                            {6301}out(c, (enc(m2_5797,pkCli_5765),sign(h(m2_5797),skSess)));
                                            {6302}let Ksrv_5798: bitstring = h((Ns_5794,Nc_5793)) in
                                            {6303}out(c, senc(mSrv(pkCli_5765,pkSess_5320),Ksrv_5798))
                                    )
                                    else
                                        {6304}let pkDisco_5799: bitstring = pub(sk(Disco_5317)) in
                                        {6305}in(c, (=pkCli_5765,em1_5800: bitstring,sigM1_5801: bitstring));
                                        {6306}let m1_5802: bitstring = dec(em1_5800,skSess) in
                                        {6307}if (verify(h(m1_5802),sigM1_5801,pkCli_5765) <> true) then
                                            0
                                        else
                                            {6308}let (=OpenSecureChannelRequest,=pkCli_5765,Nc_5803: bitstring) = m1_5802 in
                                            {6309}new Ns_5804: bitstring;
                                            {6310}new ST_5805: bitstring;
                                            {6311}new TTL_5806: bitstring;
                                            {6312}let m2_5807: bitstring = (OpenSecureChannelResponse,Ns_5804,ST_5805,TTL_5806) in
                                            {6313}out(c, (enc(m2_5807,pkCli_5765),sign(h(m2_5807),skSess)));
                                            {6314}let Ksrv_5808: bitstring = h((Ns_5804,Nc_5803)) in
                                            {6315}out(c, senc(mSrv(pkCli_5765,pkSess_5320),Ksrv_5808))
                                )
                                else
                                    {6316}let pkDisco_5809: bitstring = fail-any in
                                    {6317}in(c, (=pkCli_5765,em1_5810: bitstring,sigM1_5811: bitstring));
                                    {6318}let m1_5812: bitstring = dec(em1_5810,skSess) in
                                    {6319}if (verify(h(m1_5812),sigM1_5811,pkCli_5765) <> true) then
                                        0
                                    else
                                        {6320}let (=OpenSecureChannelRequest,=pkCli_5765,Nc_5813: bitstring) = m1_5812 in
                                        {6321}new Ns_5814: bitstring;
                                        {6322}new ST_5815: bitstring;
                                        {6323}new TTL_5816: bitstring;
                                        {6324}let m2_5817: bitstring = (OpenSecureChannelResponse,Ns_5814,ST_5815,TTL_5816) in
                                        {6325}out(c, (enc(m2_5817,pkCli_5765),sign(h(m2_5817),skSess)));
                                        {6326}let Ksrv_5818: bitstring = h((Ns_5814,Nc_5813)) in
                                        {6327}out(c, senc(mSrv(pkCli_5765,pkSess_5320),Ksrv_5818))
                        )
                        else
                            {6328}let pkDisco_5819: bitstring = fail-any in
                            {6329}in(c, (=pkCli_5765,em1_5820: bitstring,sigM1_5821: bitstring));
                            {6330}let m1_5822: bitstring = dec(em1_5820,skSess) in
                            {6331}if (verify(h(m1_5822),sigM1_5821,pkCli_5765) <> true) then
                                0
                            else
                                {6332}let (=OpenSecureChannelRequest,=pkCli_5765,Nc_5823: bitstring) = m1_5822 in
                                {6333}new Ns_5824: bitstring;
                                {6334}new ST_5825: bitstring;
                                {6335}new TTL_5826: bitstring;
                                {6336}let m2_5827: bitstring = (OpenSecureChannelResponse,Ns_5824,ST_5825,TTL_5826) in
                                {6337}out(c, (enc(m2_5827,pkCli_5765),sign(h(m2_5827),skSess)));
                                {6338}let Ksrv_5828: bitstring = h((Ns_5824,Nc_5823)) in
                                {6339}out(c, senc(mSrv(pkCli_5765,pkSess_5320),Ksrv_5828))
                )
                else
                    {6340}let pkDisco_5829: bitstring = fail-any in
                    {6341}in(c, (=pkCli_5765,em1_5830: bitstring,sigM1_5831: bitstring));
                    {6342}let m1_5832: bitstring = dec(em1_5830,skSess) in
                    {6343}if (verify(h(m1_5832),sigM1_5831,pkCli_5765) <> true) then
                        0
                    else
                        {6344}let (=OpenSecureChannelRequest,=pkCli_5765,Nc_5833: bitstring) = m1_5832 in
                        {6345}new Ns_5834: bitstring;
                        {6346}new ST_5835: bitstring;
                        {6347}new TTL_5836: bitstring;
                        {6348}let m2_5837: bitstring = (OpenSecureChannelResponse,Ns_5834,ST_5835,TTL_5836) in
                        {6349}out(c, (enc(m2_5837,pkCli_5765),sign(h(m2_5837),skSess)));
                        {6350}let Ksrv_5838: bitstring = h((Ns_5834,Nc_5833)) in
                        {6351}out(c, senc(mSrv(pkCli_5765,pkSess_5320),Ksrv_5838))
        )
        else
            {6352}let v_5839: bool = (Sess_5318 = B) in
            (
                {6353}if v_5839 then
                (
                    {6354}let skSess_5840: bitstring = skB in
                    {6355}let pkSess_5841: bitstring = pub(skSess_5840) in
                    {6356}let v_5842: bool = (Cli_5316 = A) in
                    (
                        {6357}if v_5842 then
                        (
                            {6358}let pkCli_5843: bitstring = pub(skA) in
                            {6359}let v_5844: bool = (Disco_5317 = A) in
                            (
                                {6360}if v_5844 then
                                (
                                    {6361}let pkDisco_5845: bitstring = pub(skA) in
                                    {6362}in(c, (=pkCli_5843,em1_5846: bitstring,sigM1_5847: bitstring));
                                    {6363}let m1_5848: bitstring = dec(em1_5846,skSess_5840) in
                                    {6364}if (verify(h(m1_5848),sigM1_5847,pkCli_5843) <> true) then
                                        0
                                    else
                                        {6365}let (=OpenSecureChannelRequest,=pkCli_5843,Nc_5849: bitstring) = m1_5848 in
                                        {6366}new Ns_5850: bitstring;
                                        {6367}new ST_5851: bitstring;
                                        {6368}new TTL_5852: bitstring;
                                        {6369}let m2_5853: bitstring = (OpenSecureChannelResponse,Ns_5850,ST_5851,TTL_5852) in
                                        {6370}out(c, (enc(m2_5853,pkCli_5843),sign(h(m2_5853),skSess_5840)));
                                        {6371}let Ksrv_5854: bitstring = h((Ns_5850,Nc_5849)) in
                                        {6372}out(c, senc(mSrv(pkCli_5843,pkSess_5841),Ksrv_5854))
                                )
                                else
                                    {6373}let v_5855: bool = (Disco_5317 = B) in
                                    (
                                        {6374}if v_5855 then
                                        (
                                            {6375}let pkDisco_5856: bitstring = pub(skB) in
                                            {6376}in(c, (=pkCli_5843,em1_5857: bitstring,sigM1_5858: bitstring));
                                            {6377}let m1_5859: bitstring = dec(em1_5857,skSess_5840) in
                                            {6378}if (verify(h(m1_5859),sigM1_5858,pkCli_5843) <> true) then
                                                0
                                            else
                                                {6379}let (=OpenSecureChannelRequest,=pkCli_5843,Nc_5860: bitstring) = m1_5859 in
                                                {6380}new Ns_5861: bitstring;
                                                {6381}new ST_5862: bitstring;
                                                {6382}new TTL_5863: bitstring;
                                                {6383}let m2_5864: bitstring = (OpenSecureChannelResponse,Ns_5861,ST_5862,TTL_5863) in
                                                {6384}out(c, (enc(m2_5864,pkCli_5843),sign(h(m2_5864),skSess_5840)));
                                                {6385}let Ksrv_5865: bitstring = h((Ns_5861,Nc_5860)) in
                                                {6386}out(c, senc(mSrv(pkCli_5843,pkSess_5841),Ksrv_5865))
                                        )
                                        else
                                            {6387}let v_5866: bool = (Disco_5317 = C) in
                                            (
                                                {6388}if v_5866 then
                                                (
                                                    {6389}let pkDisco_5867: bitstring = pub(skC) in
                                                    {6390}in(c, (=pkCli_5843,em1_5868: bitstring,sigM1_5869: bitstring));
                                                    {6391}let m1_5870: bitstring = dec(em1_5868,skSess_5840) in
                                                    {6392}if (verify(h(m1_5870),sigM1_5869,pkCli_5843) <> true) then
                                                        0
                                                    else
                                                        {6393}let (=OpenSecureChannelRequest,=pkCli_5843,Nc_5871: bitstring) = m1_5870 in
                                                        {6394}new Ns_5872: bitstring;
                                                        {6395}new ST_5873: bitstring;
                                                        {6396}new TTL_5874: bitstring;
                                                        {6397}let m2_5875: bitstring = (OpenSecureChannelResponse,Ns_5872,ST_5873,TTL_5874) in
                                                        {6398}out(c, (enc(m2_5875,pkCli_5843),sign(h(m2_5875),skSess_5840)));
                                                        {6399}let Ksrv_5876: bitstring = h((Ns_5872,Nc_5871)) in
                                                        {6400}out(c, senc(mSrv(pkCli_5843,pkSess_5841),Ksrv_5876))
                                                )
                                                else
                                                    {6401}let pkDisco_5877: bitstring = pub(sk(Disco_5317)) in
                                                    {6402}in(c, (=pkCli_5843,em1_5878: bitstring,sigM1_5879: bitstring));
                                                    {6403}let m1_5880: bitstring = dec(em1_5878,skSess_5840) in
                                                    {6404}if (verify(h(m1_5880),sigM1_5879,pkCli_5843) <> true) then
                                                        0
                                                    else
                                                        {6405}let (=OpenSecureChannelRequest,=pkCli_5843,Nc_5881: bitstring) = m1_5880 in
                                                        {6406}new Ns_5882: bitstring;
                                                        {6407}new ST_5883: bitstring;
                                                        {6408}new TTL_5884: bitstring;
                                                        {6409}let m2_5885: bitstring = (OpenSecureChannelResponse,Ns_5882,ST_5883,TTL_5884) in
                                                        {6410}out(c, (enc(m2_5885,pkCli_5843),sign(h(m2_5885),skSess_5840)));
                                                        {6411}let Ksrv_5886: bitstring = h((Ns_5882,Nc_5881)) in
                                                        {6412}out(c, senc(mSrv(pkCli_5843,pkSess_5841),Ksrv_5886))
                                            )
                                            else
                                                {6413}let pkDisco_5887: bitstring = fail-any in
                                                {6414}in(c, (=pkCli_5843,em1_5888: bitstring,sigM1_5889: bitstring));
                                                {6415}let m1_5890: bitstring = dec(em1_5888,skSess_5840) in
                                                {6416}if (verify(h(m1_5890),sigM1_5889,pkCli_5843) <> true) then
                                                    0
                                                else
                                                    {6417}let (=OpenSecureChannelRequest,=pkCli_5843,Nc_5891: bitstring) = m1_5890 in
                                                    {6418}new Ns_5892: bitstring;
                                                    {6419}new ST_5893: bitstring;
                                                    {6420}new TTL_5894: bitstring;
                                                    {6421}let m2_5895: bitstring = (OpenSecureChannelResponse,Ns_5892,ST_5893,TTL_5894) in
                                                    {6422}out(c, (enc(m2_5895,pkCli_5843),sign(h(m2_5895),skSess_5840)));
                                                    {6423}let Ksrv_5896: bitstring = h((Ns_5892,Nc_5891)) in
                                                    {6424}out(c, senc(mSrv(pkCli_5843,pkSess_5841),Ksrv_5896))
                                    )
                                    else
                                        {6425}let pkDisco_5897: bitstring = fail-any in
                                        {6426}in(c, (=pkCli_5843,em1_5898: bitstring,sigM1_5899: bitstring));
                                        {6427}let m1_5900: bitstring = dec(em1_5898,skSess_5840) in
                                        {6428}if (verify(h(m1_5900),sigM1_5899,pkCli_5843) <> true) then
                                            0
                                        else
                                            {6429}let (=OpenSecureChannelRequest,=pkCli_5843,Nc_5901: bitstring) = m1_5900 in
                                            {6430}new Ns_5902: bitstring;
                                            {6431}new ST_5903: bitstring;
                                            {6432}new TTL_5904: bitstring;
                                            {6433}let m2_5905: bitstring = (OpenSecureChannelResponse,Ns_5902,ST_5903,TTL_5904) in
                                            {6434}out(c, (enc(m2_5905,pkCli_5843),sign(h(m2_5905),skSess_5840)));
                                            {6435}let Ksrv_5906: bitstring = h((Ns_5902,Nc_5901)) in
                                            {6436}out(c, senc(mSrv(pkCli_5843,pkSess_5841),Ksrv_5906))
                            )
                            else
                                {6437}let pkDisco_5907: bitstring = fail-any in
                                {6438}in(c, (=pkCli_5843,em1_5908: bitstring,sigM1_5909: bitstring));
                                {6439}let m1_5910: bitstring = dec(em1_5908,skSess_5840) in
                                {6440}if (verify(h(m1_5910),sigM1_5909,pkCli_5843) <> true) then
                                    0
                                else
                                    {6441}let (=OpenSecureChannelRequest,=pkCli_5843,Nc_5911: bitstring) = m1_5910 in
                                    {6442}new Ns_5912: bitstring;
                                    {6443}new ST_5913: bitstring;
                                    {6444}new TTL_5914: bitstring;
                                    {6445}let m2_5915: bitstring = (OpenSecureChannelResponse,Ns_5912,ST_5913,TTL_5914) in
                                    {6446}out(c, (enc(m2_5915,pkCli_5843),sign(h(m2_5915),skSess_5840)));
                                    {6447}let Ksrv_5916: bitstring = h((Ns_5912,Nc_5911)) in
                                    {6448}out(c, senc(mSrv(pkCli_5843,pkSess_5841),Ksrv_5916))
                        )
                        else
                            {6449}let v_5917: bool = (Cli_5316 = B) in
                            (
                                {6450}if v_5917 then
                                (
                                    {6451}let pkCli_5918: bitstring = pub(skB) in
                                    {6452}let v_5919: bool = (Disco_5317 = A) in
                                    (
                                        {6453}if v_5919 then
                                        (
                                            {6454}let pkDisco_5920: bitstring = pub(skA) in
                                            {6455}in(c, (=pkCli_5918,em1_5921: bitstring,sigM1_5922: bitstring));
                                            {6456}let m1_5923: bitstring = dec(em1_5921,skSess_5840) in
                                            {6457}if (verify(h(m1_5923),sigM1_5922,pkCli_5918) <> true) then
                                                0
                                            else
                                                {6458}let (=OpenSecureChannelRequest,=pkCli_5918,Nc_5924: bitstring) = m1_5923 in
                                                {6459}new Ns_5925: bitstring;
                                                {6460}new ST_5926: bitstring;
                                                {6461}new TTL_5927: bitstring;
                                                {6462}let m2_5928: bitstring = (OpenSecureChannelResponse,Ns_5925,ST_5926,TTL_5927) in
                                                {6463}out(c, (enc(m2_5928,pkCli_5918),sign(h(m2_5928),skSess_5840)));
                                                {6464}let Ksrv_5929: bitstring = h((Ns_5925,Nc_5924)) in
                                                {6465}out(c, senc(mSrv(pkCli_5918,pkSess_5841),Ksrv_5929))
                                        )
                                        else
                                            {6466}let v_5930: bool = (Disco_5317 = B) in
                                            (
                                                {6467}if v_5930 then
                                                (
                                                    {6468}let pkDisco_5931: bitstring = pub(skB) in
                                                    {6469}in(c, (=pkCli_5918,em1_5932: bitstring,sigM1_5933: bitstring));
                                                    {6470}let m1_5934: bitstring = dec(em1_5932,skSess_5840) in
                                                    {6471}if (verify(h(m1_5934),sigM1_5933,pkCli_5918) <> true) then
                                                        0
                                                    else
                                                        {6472}let (=OpenSecureChannelRequest,=pkCli_5918,Nc_5935: bitstring) = m1_5934 in
                                                        {6473}new Ns_5936: bitstring;
                                                        {6474}new ST_5937: bitstring;
                                                        {6475}new TTL_5938: bitstring;
                                                        {6476}let m2_5939: bitstring = (OpenSecureChannelResponse,Ns_5936,ST_5937,TTL_5938) in
                                                        {6477}out(c, (enc(m2_5939,pkCli_5918),sign(h(m2_5939),skSess_5840)));
                                                        {6478}let Ksrv_5940: bitstring = h((Ns_5936,Nc_5935)) in
                                                        {6479}out(c, senc(mSrv(pkCli_5918,pkSess_5841),Ksrv_5940))
                                                )
                                                else
                                                    {6480}let v_5941: bool = (Disco_5317 = C) in
                                                    (
                                                        {6481}if v_5941 then
                                                        (
                                                            {6482}let pkDisco_5942: bitstring = pub(skC) in
                                                            {6483}in(c, (=pkCli_5918,em1_5943: bitstring,sigM1_5944: bitstring));
                                                            {6484}let m1_5945: bitstring = dec(em1_5943,skSess_5840) in
                                                            {6485}if (verify(h(m1_5945),sigM1_5944,pkCli_5918) <> true) then
                                                                0
                                                            else
                                                                {6486}let (=OpenSecureChannelRequest,=pkCli_5918,Nc_5946: bitstring) = m1_5945 in
                                                                {6487}new Ns_5947: bitstring;
                                                                {6488}new ST_5948: bitstring;
                                                                {6489}new TTL_5949: bitstring;
                                                                {6490}let m2_5950: bitstring = (OpenSecureChannelResponse,Ns_5947,ST_5948,TTL_5949) in
                                                                {6491}out(c, (enc(m2_5950,pkCli_5918),sign(h(m2_5950),skSess_5840)));
                                                                {6492}let Ksrv_5951: bitstring = h((Ns_5947,Nc_5946)) in
                                                                {6493}out(c, senc(mSrv(pkCli_5918,pkSess_5841),Ksrv_5951))
                                                        )
                                                        else
                                                            {6494}let pkDisco_5952: bitstring = pub(sk(Disco_5317)) in
                                                            {6495}in(c, (=pkCli_5918,em1_5953: bitstring,sigM1_5954: bitstring));
                                                            {6496}let m1_5955: bitstring = dec(em1_5953,skSess_5840) in
                                                            {6497}if (verify(h(m1_5955),sigM1_5954,pkCli_5918) <> true) then
                                                                0
                                                            else
                                                                {6498}let (=OpenSecureChannelRequest,=pkCli_5918,Nc_5956: bitstring) = m1_5955 in
                                                                {6499}new Ns_5957: bitstring;
                                                                {6500}new ST_5958: bitstring;
                                                                {6501}new TTL_5959: bitstring;
                                                                {6502}let m2_5960: bitstring = (OpenSecureChannelResponse,Ns_5957,ST_5958,TTL_5959) in
                                                                {6503}out(c, (enc(m2_5960,pkCli_5918),sign(h(m2_5960),skSess_5840)));
                                                                {6504}let Ksrv_5961: bitstring = h((Ns_5957,Nc_5956)) in
                                                                {6505}out(c, senc(mSrv(pkCli_5918,pkSess_5841),Ksrv_5961))
                                                    )
                                                    else
                                                        {6506}let pkDisco_5962: bitstring = fail-any in
                                                        {6507}in(c, (=pkCli_5918,em1_5963: bitstring,sigM1_5964: bitstring));
                                                        {6508}let m1_5965: bitstring = dec(em1_5963,skSess_5840) in
                                                        {6509}if (verify(h(m1_5965),sigM1_5964,pkCli_5918) <> true) then
                                                            0
                                                        else
                                                            {6510}let (=OpenSecureChannelRequest,=pkCli_5918,Nc_5966: bitstring) = m1_5965 in
                                                            {6511}new Ns_5967: bitstring;
                                                            {6512}new ST_5968: bitstring;
                                                            {6513}new TTL_5969: bitstring;
                                                            {6514}let m2_5970: bitstring = (OpenSecureChannelResponse,Ns_5967,ST_5968,TTL_5969) in
                                                            {6515}out(c, (enc(m2_5970,pkCli_5918),sign(h(m2_5970),skSess_5840)));
                                                            {6516}let Ksrv_5971: bitstring = h((Ns_5967,Nc_5966)) in
                                                            {6517}out(c, senc(mSrv(pkCli_5918,pkSess_5841),Ksrv_5971))
                                            )
                                            else
                                                {6518}let pkDisco_5972: bitstring = fail-any in
                                                {6519}in(c, (=pkCli_5918,em1_5973: bitstring,sigM1_5974: bitstring));
                                                {6520}let m1_5975: bitstring = dec(em1_5973,skSess_5840) in
                                                {6521}if (verify(h(m1_5975),sigM1_5974,pkCli_5918) <> true) then
                                                    0
                                                else
                                                    {6522}let (=OpenSecureChannelRequest,=pkCli_5918,Nc_5976: bitstring) = m1_5975 in
                                                    {6523}new Ns_5977: bitstring;
                                                    {6524}new ST_5978: bitstring;
                                                    {6525}new TTL_5979: bitstring;
                                                    {6526}let m2_5980: bitstring = (OpenSecureChannelResponse,Ns_5977,ST_5978,TTL_5979) in
                                                    {6527}out(c, (enc(m2_5980,pkCli_5918),sign(h(m2_5980),skSess_5840)));
                                                    {6528}let Ksrv_5981: bitstring = h((Ns_5977,Nc_5976)) in
                                                    {6529}out(c, senc(mSrv(pkCli_5918,pkSess_5841),Ksrv_5981))
                                    )
                                    else
                                        {6530}let pkDisco_5982: bitstring = fail-any in
                                        {6531}in(c, (=pkCli_5918,em1_5983: bitstring,sigM1_5984: bitstring));
                                        {6532}let m1_5985: bitstring = dec(em1_5983,skSess_5840) in
                                        {6533}if (verify(h(m1_5985),sigM1_5984,pkCli_5918) <> true) then
                                            0
                                        else
                                            {6534}let (=OpenSecureChannelRequest,=pkCli_5918,Nc_5986: bitstring) = m1_5985 in
                                            {6535}new Ns_5987: bitstring;
                                            {6536}new ST_5988: bitstring;
                                            {6537}new TTL_5989: bitstring;
                                            {6538}let m2_5990: bitstring = (OpenSecureChannelResponse,Ns_5987,ST_5988,TTL_5989) in
                                            {6539}out(c, (enc(m2_5990,pkCli_5918),sign(h(m2_5990),skSess_5840)));
                                            {6540}let Ksrv_5991: bitstring = h((Ns_5987,Nc_5986)) in
                                            {6541}out(c, senc(mSrv(pkCli_5918,pkSess_5841),Ksrv_5991))
                                )
                                else
                                    {6542}let v_5992: bool = (Cli_5316 = C) in
                                    (
                                        {6543}if v_5992 then
                                        (
                                            {6544}let pkCli_5993: bitstring = pub(skC) in
                                            {6545}let v_5994: bool = (Disco_5317 = A) in
                                            (
                                                {6546}if v_5994 then
                                                (
                                                    {6547}let pkDisco_5995: bitstring = pub(skA) in
                                                    {6548}in(c, (=pkCli_5993,em1_5996: bitstring,sigM1_5997: bitstring));
                                                    {6549}let m1_5998: bitstring = dec(em1_5996,skSess_5840) in
                                                    {6550}if (verify(h(m1_5998),sigM1_5997,pkCli_5993) <> true) then
                                                        0
                                                    else
                                                        {6551}let (=OpenSecureChannelRequest,=pkCli_5993,Nc_5999: bitstring) = m1_5998 in
                                                        {6552}new Ns_6000: bitstring;
                                                        {6553}new ST_6001: bitstring;
                                                        {6554}new TTL_6002: bitstring;
                                                        {6555}let m2_6003: bitstring = (OpenSecureChannelResponse,Ns_6000,ST_6001,TTL_6002) in
                                                        {6556}out(c, (enc(m2_6003,pkCli_5993),sign(h(m2_6003),skSess_5840)));
                                                        {6557}let Ksrv_6004: bitstring = h((Ns_6000,Nc_5999)) in
                                                        {6558}out(c, senc(mSrv(pkCli_5993,pkSess_5841),Ksrv_6004))
                                                )
                                                else
                                                    {6559}let v_6005: bool = (Disco_5317 = B) in
                                                    (
                                                        {6560}if v_6005 then
                                                        (
                                                            {6561}let pkDisco_6006: bitstring = pub(skB) in
                                                            {6562}in(c, (=pkCli_5993,em1_6007: bitstring,sigM1_6008: bitstring));
                                                            {6563}let m1_6009: bitstring = dec(em1_6007,skSess_5840) in
                                                            {6564}if (verify(h(m1_6009),sigM1_6008,pkCli_5993) <> true) then
                                                                0
                                                            else
                                                                {6565}let (=OpenSecureChannelRequest,=pkCli_5993,Nc_6010: bitstring) = m1_6009 in
                                                                {6566}new Ns_6011: bitstring;
                                                                {6567}new ST_6012: bitstring;
                                                                {6568}new TTL_6013: bitstring;
                                                                {6569}let m2_6014: bitstring = (OpenSecureChannelResponse,Ns_6011,ST_6012,TTL_6013) in
                                                                {6570}out(c, (enc(m2_6014,pkCli_5993),sign(h(m2_6014),skSess_5840)));
                                                                {6571}let Ksrv_6015: bitstring = h((Ns_6011,Nc_6010)) in
                                                                {6572}out(c, senc(mSrv(pkCli_5993,pkSess_5841),Ksrv_6015))
                                                        )
                                                        else
                                                            {6573}let v_6016: bool = (Disco_5317 = C) in
                                                            (
                                                                {6574}if v_6016 then
                                                                (
                                                                    {6575}let pkDisco_6017: bitstring = pub(skC) in
                                                                    {6576}in(c, (=pkCli_5993,em1_6018: bitstring,sigM1_6019: bitstring));
                                                                    {6577}let m1_6020: bitstring = dec(em1_6018,skSess_5840) in
                                                                    {6578}if (verify(h(m1_6020),sigM1_6019,pkCli_5993) <> true) then
                                                                        0
                                                                    else
                                                                        {6579}let (=OpenSecureChannelRequest,=pkCli_5993,Nc_6021: bitstring) = m1_6020 in
                                                                        {6580}new Ns_6022: bitstring;
                                                                        {6581}new ST_6023: bitstring;
                                                                        {6582}new TTL_6024: bitstring;
                                                                        {6583}let m2_6025: bitstring = (OpenSecureChannelResponse,Ns_6022,ST_6023,TTL_6024) in
                                                                        {6584}out(c, (enc(m2_6025,pkCli_5993),sign(h(m2_6025),skSess_5840)));
                                                                        {6585}let Ksrv_6026: bitstring = h((Ns_6022,Nc_6021)) in
                                                                        {6586}out(c, senc(mSrv(pkCli_5993,pkSess_5841),Ksrv_6026))
                                                                )
                                                                else
                                                                    {6587}let pkDisco_6027: bitstring = pub(sk(Disco_5317)) in
                                                                    {6588}in(c, (=pkCli_5993,em1_6028: bitstring,sigM1_6029: bitstring));
                                                                    {6589}let m1_6030: bitstring = dec(em1_6028,skSess_5840) in
                                                                    {6590}if (verify(h(m1_6030),sigM1_6029,pkCli_5993) <> true) then
                                                                        0
                                                                    else
                                                                        {6591}let (=OpenSecureChannelRequest,=pkCli_5993,Nc_6031: bitstring) = m1_6030 in
                                                                        {6592}new Ns_6032: bitstring;
                                                                        {6593}new ST_6033: bitstring;
                                                                        {6594}new TTL_6034: bitstring;
                                                                        {6595}let m2_6035: bitstring = (OpenSecureChannelResponse,Ns_6032,ST_6033,TTL_6034) in
                                                                        {6596}out(c, (enc(m2_6035,pkCli_5993),sign(h(m2_6035),skSess_5840)));
                                                                        {6597}let Ksrv_6036: bitstring = h((Ns_6032,Nc_6031)) in
                                                                        {6598}out(c, senc(mSrv(pkCli_5993,pkSess_5841),Ksrv_6036))
                                                            )
                                                            else
                                                                {6599}let pkDisco_6037: bitstring = fail-any in
                                                                {6600}in(c, (=pkCli_5993,em1_6038: bitstring,sigM1_6039: bitstring));
                                                                {6601}let m1_6040: bitstring = dec(em1_6038,skSess_5840) in
                                                                {6602}if (verify(h(m1_6040),sigM1_6039,pkCli_5993) <> true) then
                                                                    0
                                                                else
                                                                    {6603}let (=OpenSecureChannelRequest,=pkCli_5993,Nc_6041: bitstring) = m1_6040 in
                                                                    {6604}new Ns_6042: bitstring;
                                                                    {6605}new ST_6043: bitstring;
                                                                    {6606}new TTL_6044: bitstring;
                                                                    {6607}let m2_6045: bitstring = (OpenSecureChannelResponse,Ns_6042,ST_6043,TTL_6044) in
                                                                    {6608}out(c, (enc(m2_6045,pkCli_5993),sign(h(m2_6045),skSess_5840)));
                                                                    {6609}let Ksrv_6046: bitstring = h((Ns_6042,Nc_6041)) in
                                                                    {6610}out(c, senc(mSrv(pkCli_5993,pkSess_5841),Ksrv_6046))
                                                    )
                                                    else
                                                        {6611}let pkDisco_6047: bitstring = fail-any in
                                                        {6612}in(c, (=pkCli_5993,em1_6048: bitstring,sigM1_6049: bitstring));
                                                        {6613}let m1_6050: bitstring = dec(em1_6048,skSess_5840) in
                                                        {6614}if (verify(h(m1_6050),sigM1_6049,pkCli_5993) <> true) then
                                                            0
                                                        else
                                                            {6615}let (=OpenSecureChannelRequest,=pkCli_5993,Nc_6051: bitstring) = m1_6050 in
                                                            {6616}new Ns_6052: bitstring;
                                                            {6617}new ST_6053: bitstring;
                                                            {6618}new TTL_6054: bitstring;
                                                            {6619}let m2_6055: bitstring = (OpenSecureChannelResponse,Ns_6052,ST_6053,TTL_6054) in
                                                            {6620}out(c, (enc(m2_6055,pkCli_5993),sign(h(m2_6055),skSess_5840)));
                                                            {6621}let Ksrv_6056: bitstring = h((Ns_6052,Nc_6051)) in
                                                            {6622}out(c, senc(mSrv(pkCli_5993,pkSess_5841),Ksrv_6056))
                                            )
                                            else
                                                {6623}let pkDisco_6057: bitstring = fail-any in
                                                {6624}in(c, (=pkCli_5993,em1_6058: bitstring,sigM1_6059: bitstring));
                                                {6625}let m1_6060: bitstring = dec(em1_6058,skSess_5840) in
                                                {6626}if (verify(h(m1_6060),sigM1_6059,pkCli_5993) <> true) then
                                                    0
                                                else
                                                    {6627}let (=OpenSecureChannelRequest,=pkCli_5993,Nc_6061: bitstring) = m1_6060 in
                                                    {6628}new Ns_6062: bitstring;
                                                    {6629}new ST_6063: bitstring;
                                                    {6630}new TTL_6064: bitstring;
                                                    {6631}let m2_6065: bitstring = (OpenSecureChannelResponse,Ns_6062,ST_6063,TTL_6064) in
                                                    {6632}out(c, (enc(m2_6065,pkCli_5993),sign(h(m2_6065),skSess_5840)));
                                                    {6633}let Ksrv_6066: bitstring = h((Ns_6062,Nc_6061)) in
                                                    {6634}out(c, senc(mSrv(pkCli_5993,pkSess_5841),Ksrv_6066))
                                        )
                                        else
                                            {6635}let pkCli_6067: bitstring = pub(sk(Cli_5316)) in
                                            {6636}let v_6068: bool = (Disco_5317 = A) in
                                            (
                                                {6637}if v_6068 then
                                                (
                                                    {6638}let pkDisco_6069: bitstring = pub(skA) in
                                                    {6639}in(c, (=pkCli_6067,em1_6070: bitstring,sigM1_6071: bitstring));
                                                    {6640}let m1_6072: bitstring = dec(em1_6070,skSess_5840) in
                                                    {6641}if (verify(h(m1_6072),sigM1_6071,pkCli_6067) <> true) then
                                                        0
                                                    else
                                                        {6642}let (=OpenSecureChannelRequest,=pkCli_6067,Nc_6073: bitstring) = m1_6072 in
                                                        {6643}new Ns_6074: bitstring;
                                                        {6644}new ST_6075: bitstring;
                                                        {6645}new TTL_6076: bitstring;
                                                        {6646}let m2_6077: bitstring = (OpenSecureChannelResponse,Ns_6074,ST_6075,TTL_6076) in
                                                        {6647}out(c, (enc(m2_6077,pkCli_6067),sign(h(m2_6077),skSess_5840)));
                                                        {6648}let Ksrv_6078: bitstring = h((Ns_6074,Nc_6073)) in
                                                        {6649}out(c, senc(mSrv(pkCli_6067,pkSess_5841),Ksrv_6078))
                                                )
                                                else
                                                    {6650}let v_6079: bool = (Disco_5317 = B) in
                                                    (
                                                        {6651}if v_6079 then
                                                        (
                                                            {6652}let pkDisco_6080: bitstring = pub(skB) in
                                                            {6653}in(c, (=pkCli_6067,em1_6081: bitstring,sigM1_6082: bitstring));
                                                            {6654}let m1_6083: bitstring = dec(em1_6081,skSess_5840) in
                                                            {6655}if (verify(h(m1_6083),sigM1_6082,pkCli_6067) <> true) then
                                                                0
                                                            else
                                                                {6656}let (=OpenSecureChannelRequest,=pkCli_6067,Nc_6084: bitstring) = m1_6083 in
                                                                {6657}new Ns_6085: bitstring;
                                                                {6658}new ST_6086: bitstring;
                                                                {6659}new TTL_6087: bitstring;
                                                                {6660}let m2_6088: bitstring = (OpenSecureChannelResponse,Ns_6085,ST_6086,TTL_6087) in
                                                                {6661}out(c, (enc(m2_6088,pkCli_6067),sign(h(m2_6088),skSess_5840)));
                                                                {6662}let Ksrv_6089: bitstring = h((Ns_6085,Nc_6084)) in
                                                                {6663}out(c, senc(mSrv(pkCli_6067,pkSess_5841),Ksrv_6089))
                                                        )
                                                        else
                                                            {6664}let v_6090: bool = (Disco_5317 = C) in
                                                            (
                                                                {6665}if v_6090 then
                                                                (
                                                                    {6666}let pkDisco_6091: bitstring = pub(skC) in
                                                                    {6667}in(c, (=pkCli_6067,em1_6092: bitstring,sigM1_6093: bitstring));
                                                                    {6668}let m1_6094: bitstring = dec(em1_6092,skSess_5840) in
                                                                    {6669}if (verify(h(m1_6094),sigM1_6093,pkCli_6067) <> true) then
                                                                        0
                                                                    else
                                                                        {6670}let (=OpenSecureChannelRequest,=pkCli_6067,Nc_6095: bitstring) = m1_6094 in
                                                                        {6671}new Ns_6096: bitstring;
                                                                        {6672}new ST_6097: bitstring;
                                                                        {6673}new TTL_6098: bitstring;
                                                                        {6674}let m2_6099: bitstring = (OpenSecureChannelResponse,Ns_6096,ST_6097,TTL_6098) in
                                                                        {6675}out(c, (enc(m2_6099,pkCli_6067),sign(h(m2_6099),skSess_5840)));
                                                                        {6676}let Ksrv_6100: bitstring = h((Ns_6096,Nc_6095)) in
                                                                        {6677}out(c, senc(mSrv(pkCli_6067,pkSess_5841),Ksrv_6100))
                                                                )
                                                                else
                                                                    {6678}let pkDisco_6101: bitstring = pub(sk(Disco_5317)) in
                                                                    {6679}in(c, (=pkCli_6067,em1_6102: bitstring,sigM1_6103: bitstring));
                                                                    {6680}let m1_6104: bitstring = dec(em1_6102,skSess_5840) in
                                                                    {6681}if (verify(h(m1_6104),sigM1_6103,pkCli_6067) <> true) then
                                                                        0
                                                                    else
                                                                        {6682}let (=OpenSecureChannelRequest,=pkCli_6067,Nc_6105: bitstring) = m1_6104 in
                                                                        {6683}new Ns_6106: bitstring;
                                                                        {6684}new ST_6107: bitstring;
                                                                        {6685}new TTL_6108: bitstring;
                                                                        {6686}let m2_6109: bitstring = (OpenSecureChannelResponse,Ns_6106,ST_6107,TTL_6108) in
                                                                        {6687}out(c, (enc(m2_6109,pkCli_6067),sign(h(m2_6109),skSess_5840)));
                                                                        {6688}let Ksrv_6110: bitstring = h((Ns_6106,Nc_6105)) in
                                                                        {6689}out(c, senc(mSrv(pkCli_6067,pkSess_5841),Ksrv_6110))
                                                            )
                                                            else
                                                                {6690}let pkDisco_6111: bitstring = fail-any in
                                                                {6691}in(c, (=pkCli_6067,em1_6112: bitstring,sigM1_6113: bitstring));
                                                                {6692}let m1_6114: bitstring = dec(em1_6112,skSess_5840) in
                                                                {6693}if (verify(h(m1_6114),sigM1_6113,pkCli_6067) <> true) then
                                                                    0
                                                                else
                                                                    {6694}let (=OpenSecureChannelRequest,=pkCli_6067,Nc_6115: bitstring) = m1_6114 in
                                                                    {6695}new Ns_6116: bitstring;
                                                                    {6696}new ST_6117: bitstring;
                                                                    {6697}new TTL_6118: bitstring;
                                                                    {6698}let m2_6119: bitstring = (OpenSecureChannelResponse,Ns_6116,ST_6117,TTL_6118) in
                                                                    {6699}out(c, (enc(m2_6119,pkCli_6067),sign(h(m2_6119),skSess_5840)));
                                                                    {6700}let Ksrv_6120: bitstring = h((Ns_6116,Nc_6115)) in
                                                                    {6701}out(c, senc(mSrv(pkCli_6067,pkSess_5841),Ksrv_6120))
                                                    )
                                                    else
                                                        {6702}let pkDisco_6121: bitstring = fail-any in
                                                        {6703}in(c, (=pkCli_6067,em1_6122: bitstring,sigM1_6123: bitstring));
                                                        {6704}let m1_6124: bitstring = dec(em1_6122,skSess_5840) in
                                                        {6705}if (verify(h(m1_6124),sigM1_6123,pkCli_6067) <> true) then
                                                            0
                                                        else
                                                            {6706}let (=OpenSecureChannelRequest,=pkCli_6067,Nc_6125: bitstring) = m1_6124 in
                                                            {6707}new Ns_6126: bitstring;
                                                            {6708}new ST_6127: bitstring;
                                                            {6709}new TTL_6128: bitstring;
                                                            {6710}let m2_6129: bitstring = (OpenSecureChannelResponse,Ns_6126,ST_6127,TTL_6128) in
                                                            {6711}out(c, (enc(m2_6129,pkCli_6067),sign(h(m2_6129),skSess_5840)));
                                                            {6712}let Ksrv_6130: bitstring = h((Ns_6126,Nc_6125)) in
                                                            {6713}out(c, senc(mSrv(pkCli_6067,pkSess_5841),Ksrv_6130))
                                            )
                                            else
                                                {6714}let pkDisco_6131: bitstring = fail-any in
                                                {6715}in(c, (=pkCli_6067,em1_6132: bitstring,sigM1_6133: bitstring));
                                                {6716}let m1_6134: bitstring = dec(em1_6132,skSess_5840) in
                                                {6717}if (verify(h(m1_6134),sigM1_6133,pkCli_6067) <> true) then
                                                    0
                                                else
                                                    {6718}let (=OpenSecureChannelRequest,=pkCli_6067,Nc_6135: bitstring) = m1_6134 in
                                                    {6719}new Ns_6136: bitstring;
                                                    {6720}new ST_6137: bitstring;
                                                    {6721}new TTL_6138: bitstring;
                                                    {6722}let m2_6139: bitstring = (OpenSecureChannelResponse,Ns_6136,ST_6137,TTL_6138) in
                                                    {6723}out(c, (enc(m2_6139,pkCli_6067),sign(h(m2_6139),skSess_5840)));
                                                    {6724}let Ksrv_6140: bitstring = h((Ns_6136,Nc_6135)) in
                                                    {6725}out(c, senc(mSrv(pkCli_6067,pkSess_5841),Ksrv_6140))
                                    )
                                    else
                                        {6726}let pkCli_6141: bitstring = fail-any in
                                        {6727}let v_6142: bool = (Disco_5317 = A) in
                                        (
                                            {6728}if v_6142 then
                                            (
                                                {6729}let pkDisco_6143: bitstring = pub(skA) in
                                                {6730}in(c, (=pkCli_6141,em1_6144: bitstring,sigM1_6145: bitstring));
                                                {6731}let m1_6146: bitstring = dec(em1_6144,skSess_5840) in
                                                {6732}if (verify(h(m1_6146),sigM1_6145,pkCli_6141) <> true) then
                                                    0
                                                else
                                                    {6733}let (=OpenSecureChannelRequest,=pkCli_6141,Nc_6147: bitstring) = m1_6146 in
                                                    {6734}new Ns_6148: bitstring;
                                                    {6735}new ST_6149: bitstring;
                                                    {6736}new TTL_6150: bitstring;
                                                    {6737}let m2_6151: bitstring = (OpenSecureChannelResponse,Ns_6148,ST_6149,TTL_6150) in
                                                    {6738}out(c, (enc(m2_6151,pkCli_6141),sign(h(m2_6151),skSess_5840)));
                                                    {6739}let Ksrv_6152: bitstring = h((Ns_6148,Nc_6147)) in
                                                    {6740}out(c, senc(mSrv(pkCli_6141,pkSess_5841),Ksrv_6152))
                                            )
                                            else
                                                {6741}let v_6153: bool = (Disco_5317 = B) in
                                                (
                                                    {6742}if v_6153 then
                                                    (
                                                        {6743}let pkDisco_6154: bitstring = pub(skB) in
                                                        {6744}in(c, (=pkCli_6141,em1_6155: bitstring,sigM1_6156: bitstring));
                                                        {6745}let m1_6157: bitstring = dec(em1_6155,skSess_5840) in
                                                        {6746}if (verify(h(m1_6157),sigM1_6156,pkCli_6141) <> true) then
                                                            0
                                                        else
                                                            {6747}let (=OpenSecureChannelRequest,=pkCli_6141,Nc_6158: bitstring) = m1_6157 in
                                                            {6748}new Ns_6159: bitstring;
                                                            {6749}new ST_6160: bitstring;
                                                            {6750}new TTL_6161: bitstring;
                                                            {6751}let m2_6162: bitstring = (OpenSecureChannelResponse,Ns_6159,ST_6160,TTL_6161) in
                                                            {6752}out(c, (enc(m2_6162,pkCli_6141),sign(h(m2_6162),skSess_5840)));
                                                            {6753}let Ksrv_6163: bitstring = h((Ns_6159,Nc_6158)) in
                                                            {6754}out(c, senc(mSrv(pkCli_6141,pkSess_5841),Ksrv_6163))
                                                    )
                                                    else
                                                        {6755}let v_6164: bool = (Disco_5317 = C) in
                                                        (
                                                            {6756}if v_6164 then
                                                            (
                                                                {6757}let pkDisco_6165: bitstring = pub(skC) in
                                                                {6758}in(c, (=pkCli_6141,em1_6166: bitstring,sigM1_6167: bitstring));
                                                                {6759}let m1_6168: bitstring = dec(em1_6166,skSess_5840) in
                                                                {6760}if (verify(h(m1_6168),sigM1_6167,pkCli_6141) <> true) then
                                                                    0
                                                                else
                                                                    {6761}let (=OpenSecureChannelRequest,=pkCli_6141,Nc_6169: bitstring) = m1_6168 in
                                                                    {6762}new Ns_6170: bitstring;
                                                                    {6763}new ST_6171: bitstring;
                                                                    {6764}new TTL_6172: bitstring;
                                                                    {6765}let m2_6173: bitstring = (OpenSecureChannelResponse,Ns_6170,ST_6171,TTL_6172) in
                                                                    {6766}out(c, (enc(m2_6173,pkCli_6141),sign(h(m2_6173),skSess_5840)));
                                                                    {6767}let Ksrv_6174: bitstring = h((Ns_6170,Nc_6169)) in
                                                                    {6768}out(c, senc(mSrv(pkCli_6141,pkSess_5841),Ksrv_6174))
                                                            )
                                                            else
                                                                {6769}let pkDisco_6175: bitstring = pub(sk(Disco_5317)) in
                                                                {6770}in(c, (=pkCli_6141,em1_6176: bitstring,sigM1_6177: bitstring));
                                                                {6771}let m1_6178: bitstring = dec(em1_6176,skSess_5840) in
                                                                {6772}if (verify(h(m1_6178),sigM1_6177,pkCli_6141) <> true) then
                                                                    0
                                                                else
                                                                    {6773}let (=OpenSecureChannelRequest,=pkCli_6141,Nc_6179: bitstring) = m1_6178 in
                                                                    {6774}new Ns_6180: bitstring;
                                                                    {6775}new ST_6181: bitstring;
                                                                    {6776}new TTL_6182: bitstring;
                                                                    {6777}let m2_6183: bitstring = (OpenSecureChannelResponse,Ns_6180,ST_6181,TTL_6182) in
                                                                    {6778}out(c, (enc(m2_6183,pkCli_6141),sign(h(m2_6183),skSess_5840)));
                                                                    {6779}let Ksrv_6184: bitstring = h((Ns_6180,Nc_6179)) in
                                                                    {6780}out(c, senc(mSrv(pkCli_6141,pkSess_5841),Ksrv_6184))
                                                        )
                                                        else
                                                            {6781}let pkDisco_6185: bitstring = fail-any in
                                                            {6782}in(c, (=pkCli_6141,em1_6186: bitstring,sigM1_6187: bitstring));
                                                            {6783}let m1_6188: bitstring = dec(em1_6186,skSess_5840) in
                                                            {6784}if (verify(h(m1_6188),sigM1_6187,pkCli_6141) <> true) then
                                                                0
                                                            else
                                                                {6785}let (=OpenSecureChannelRequest,=pkCli_6141,Nc_6189: bitstring) = m1_6188 in
                                                                {6786}new Ns_6190: bitstring;
                                                                {6787}new ST_6191: bitstring;
                                                                {6788}new TTL_6192: bitstring;
                                                                {6789}let m2_6193: bitstring = (OpenSecureChannelResponse,Ns_6190,ST_6191,TTL_6192) in
                                                                {6790}out(c, (enc(m2_6193,pkCli_6141),sign(h(m2_6193),skSess_5840)));
                                                                {6791}let Ksrv_6194: bitstring = h((Ns_6190,Nc_6189)) in
                                                                {6792}out(c, senc(mSrv(pkCli_6141,pkSess_5841),Ksrv_6194))
                                                )
                                                else
                                                    {6793}let pkDisco_6195: bitstring = fail-any in
                                                    {6794}in(c, (=pkCli_6141,em1_6196: bitstring,sigM1_6197: bitstring));
                                                    {6795}let m1_6198: bitstring = dec(em1_6196,skSess_5840) in
                                                    {6796}if (verify(h(m1_6198),sigM1_6197,pkCli_6141) <> true) then
                                                        0
                                                    else
                                                        {6797}let (=OpenSecureChannelRequest,=pkCli_6141,Nc_6199: bitstring) = m1_6198 in
                                                        {6798}new Ns_6200: bitstring;
                                                        {6799}new ST_6201: bitstring;
                                                        {6800}new TTL_6202: bitstring;
                                                        {6801}let m2_6203: bitstring = (OpenSecureChannelResponse,Ns_6200,ST_6201,TTL_6202) in
                                                        {6802}out(c, (enc(m2_6203,pkCli_6141),sign(h(m2_6203),skSess_5840)));
                                                        {6803}let Ksrv_6204: bitstring = h((Ns_6200,Nc_6199)) in
                                                        {6804}out(c, senc(mSrv(pkCli_6141,pkSess_5841),Ksrv_6204))
                                        )
                                        else
                                            {6805}let pkDisco_6205: bitstring = fail-any in
                                            {6806}in(c, (=pkCli_6141,em1_6206: bitstring,sigM1_6207: bitstring));
                                            {6807}let m1_6208: bitstring = dec(em1_6206,skSess_5840) in
                                            {6808}if (verify(h(m1_6208),sigM1_6207,pkCli_6141) <> true) then
                                                0
                                            else
                                                {6809}let (=OpenSecureChannelRequest,=pkCli_6141,Nc_6209: bitstring) = m1_6208 in
                                                {6810}new Ns_6210: bitstring;
                                                {6811}new ST_6211: bitstring;
                                                {6812}new TTL_6212: bitstring;
                                                {6813}let m2_6213: bitstring = (OpenSecureChannelResponse,Ns_6210,ST_6211,TTL_6212) in
                                                {6814}out(c, (enc(m2_6213,pkCli_6141),sign(h(m2_6213),skSess_5840)));
                                                {6815}let Ksrv_6214: bitstring = h((Ns_6210,Nc_6209)) in
                                                {6816}out(c, senc(mSrv(pkCli_6141,pkSess_5841),Ksrv_6214))
                            )
                            else
                                {6817}let pkCli_6215: bitstring = fail-any in
                                {6818}let v_6216: bool = (Disco_5317 = A) in
                                (
                                    {6819}if v_6216 then
                                    (
                                        {6820}let pkDisco_6217: bitstring = pub(skA) in
                                        {6821}in(c, (=pkCli_6215,em1_6218: bitstring,sigM1_6219: bitstring));
                                        {6822}let m1_6220: bitstring = dec(em1_6218,skSess_5840) in
                                        {6823}if (verify(h(m1_6220),sigM1_6219,pkCli_6215) <> true) then
                                            0
                                        else
                                            {6824}let (=OpenSecureChannelRequest,=pkCli_6215,Nc_6221: bitstring) = m1_6220 in
                                            {6825}new Ns_6222: bitstring;
                                            {6826}new ST_6223: bitstring;
                                            {6827}new TTL_6224: bitstring;
                                            {6828}let m2_6225: bitstring = (OpenSecureChannelResponse,Ns_6222,ST_6223,TTL_6224) in
                                            {6829}out(c, (enc(m2_6225,pkCli_6215),sign(h(m2_6225),skSess_5840)));
                                            {6830}let Ksrv_6226: bitstring = h((Ns_6222,Nc_6221)) in
                                            {6831}out(c, senc(mSrv(pkCli_6215,pkSess_5841),Ksrv_6226))
                                    )
                                    else
                                        {6832}let v_6227: bool = (Disco_5317 = B) in
                                        (
                                            {6833}if v_6227 then
                                            (
                                                {6834}let pkDisco_6228: bitstring = pub(skB) in
                                                {6835}in(c, (=pkCli_6215,em1_6229: bitstring,sigM1_6230: bitstring));
                                                {6836}let m1_6231: bitstring = dec(em1_6229,skSess_5840) in
                                                {6837}if (verify(h(m1_6231),sigM1_6230,pkCli_6215) <> true) then
                                                    0
                                                else
                                                    {6838}let (=OpenSecureChannelRequest,=pkCli_6215,Nc_6232: bitstring) = m1_6231 in
                                                    {6839}new Ns_6233: bitstring;
                                                    {6840}new ST_6234: bitstring;
                                                    {6841}new TTL_6235: bitstring;
                                                    {6842}let m2_6236: bitstring = (OpenSecureChannelResponse,Ns_6233,ST_6234,TTL_6235) in
                                                    {6843}out(c, (enc(m2_6236,pkCli_6215),sign(h(m2_6236),skSess_5840)));
                                                    {6844}let Ksrv_6237: bitstring = h((Ns_6233,Nc_6232)) in
                                                    {6845}out(c, senc(mSrv(pkCli_6215,pkSess_5841),Ksrv_6237))
                                            )
                                            else
                                                {6846}let v_6238: bool = (Disco_5317 = C) in
                                                (
                                                    {6847}if v_6238 then
                                                    (
                                                        {6848}let pkDisco_6239: bitstring = pub(skC) in
                                                        {6849}in(c, (=pkCli_6215,em1_6240: bitstring,sigM1_6241: bitstring));
                                                        {6850}let m1_6242: bitstring = dec(em1_6240,skSess_5840) in
                                                        {6851}if (verify(h(m1_6242),sigM1_6241,pkCli_6215) <> true) then
                                                            0
                                                        else
                                                            {6852}let (=OpenSecureChannelRequest,=pkCli_6215,Nc_6243: bitstring) = m1_6242 in
                                                            {6853}new Ns_6244: bitstring;
                                                            {6854}new ST_6245: bitstring;
                                                            {6855}new TTL_6246: bitstring;
                                                            {6856}let m2_6247: bitstring = (OpenSecureChannelResponse,Ns_6244,ST_6245,TTL_6246) in
                                                            {6857}out(c, (enc(m2_6247,pkCli_6215),sign(h(m2_6247),skSess_5840)));
                                                            {6858}let Ksrv_6248: bitstring = h((Ns_6244,Nc_6243)) in
                                                            {6859}out(c, senc(mSrv(pkCli_6215,pkSess_5841),Ksrv_6248))
                                                    )
                                                    else
                                                        {6860}let pkDisco_6249: bitstring = pub(sk(Disco_5317)) in
                                                        {6861}in(c, (=pkCli_6215,em1_6250: bitstring,sigM1_6251: bitstring));
                                                        {6862}let m1_6252: bitstring = dec(em1_6250,skSess_5840) in
                                                        {6863}if (verify(h(m1_6252),sigM1_6251,pkCli_6215) <> true) then
                                                            0
                                                        else
                                                            {6864}let (=OpenSecureChannelRequest,=pkCli_6215,Nc_6253: bitstring) = m1_6252 in
                                                            {6865}new Ns_6254: bitstring;
                                                            {6866}new ST_6255: bitstring;
                                                            {6867}new TTL_6256: bitstring;
                                                            {6868}let m2_6257: bitstring = (OpenSecureChannelResponse,Ns_6254,ST_6255,TTL_6256) in
                                                            {6869}out(c, (enc(m2_6257,pkCli_6215),sign(h(m2_6257),skSess_5840)));
                                                            {6870}let Ksrv_6258: bitstring = h((Ns_6254,Nc_6253)) in
                                                            {6871}out(c, senc(mSrv(pkCli_6215,pkSess_5841),Ksrv_6258))
                                                )
                                                else
                                                    {6872}let pkDisco_6259: bitstring = fail-any in
                                                    {6873}in(c, (=pkCli_6215,em1_6260: bitstring,sigM1_6261: bitstring));
                                                    {6874}let m1_6262: bitstring = dec(em1_6260,skSess_5840) in
                                                    {6875}if (verify(h(m1_6262),sigM1_6261,pkCli_6215) <> true) then
                                                        0
                                                    else
                                                        {6876}let (=OpenSecureChannelRequest,=pkCli_6215,Nc_6263: bitstring) = m1_6262 in
                                                        {6877}new Ns_6264: bitstring;
                                                        {6878}new ST_6265: bitstring;
                                                        {6879}new TTL_6266: bitstring;
                                                        {6880}let m2_6267: bitstring = (OpenSecureChannelResponse,Ns_6264,ST_6265,TTL_6266) in
                                                        {6881}out(c, (enc(m2_6267,pkCli_6215),sign(h(m2_6267),skSess_5840)));
                                                        {6882}let Ksrv_6268: bitstring = h((Ns_6264,Nc_6263)) in
                                                        {6883}out(c, senc(mSrv(pkCli_6215,pkSess_5841),Ksrv_6268))
                                        )
                                        else
                                            {6884}let pkDisco_6269: bitstring = fail-any in
                                            {6885}in(c, (=pkCli_6215,em1_6270: bitstring,sigM1_6271: bitstring));
                                            {6886}let m1_6272: bitstring = dec(em1_6270,skSess_5840) in
                                            {6887}if (verify(h(m1_6272),sigM1_6271,pkCli_6215) <> true) then
                                                0
                                            else
                                                {6888}let (=OpenSecureChannelRequest,=pkCli_6215,Nc_6273: bitstring) = m1_6272 in
                                                {6889}new Ns_6274: bitstring;
                                                {6890}new ST_6275: bitstring;
                                                {6891}new TTL_6276: bitstring;
                                                {6892}let m2_6277: bitstring = (OpenSecureChannelResponse,Ns_6274,ST_6275,TTL_6276) in
                                                {6893}out(c, (enc(m2_6277,pkCli_6215),sign(h(m2_6277),skSess_5840)));
                                                {6894}let Ksrv_6278: bitstring = h((Ns_6274,Nc_6273)) in
                                                {6895}out(c, senc(mSrv(pkCli_6215,pkSess_5841),Ksrv_6278))
                                )
                                else
                                    {6896}let pkDisco_6279: bitstring = fail-any in
                                    {6897}in(c, (=pkCli_6215,em1_6280: bitstring,sigM1_6281: bitstring));
                                    {6898}let m1_6282: bitstring = dec(em1_6280,skSess_5840) in
                                    {6899}if (verify(h(m1_6282),sigM1_6281,pkCli_6215) <> true) then
                                        0
                                    else
                                        {6900}let (=OpenSecureChannelRequest,=pkCli_6215,Nc_6283: bitstring) = m1_6282 in
                                        {6901}new Ns_6284: bitstring;
                                        {6902}new ST_6285: bitstring;
                                        {6903}new TTL_6286: bitstring;
                                        {6904}let m2_6287: bitstring = (OpenSecureChannelResponse,Ns_6284,ST_6285,TTL_6286) in
                                        {6905}out(c, (enc(m2_6287,pkCli_6215),sign(h(m2_6287),skSess_5840)));
                                        {6906}let Ksrv_6288: bitstring = h((Ns_6284,Nc_6283)) in
                                        {6907}out(c, senc(mSrv(pkCli_6215,pkSess_5841),Ksrv_6288))
                    )
                    else
                        {6908}let pkCli_6289: bitstring = fail-any in
                        {6909}let v_6290: bool = (Disco_5317 = A) in
                        (
                            {6910}if v_6290 then
                            (
                                {6911}let pkDisco_6291: bitstring = pub(skA) in
                                {6912}in(c, (=pkCli_6289,em1_6292: bitstring,sigM1_6293: bitstring));
                                {6913}let m1_6294: bitstring = dec(em1_6292,skSess_5840) in
                                {6914}if (verify(h(m1_6294),sigM1_6293,pkCli_6289) <> true) then
                                    0
                                else
                                    {6915}let (=OpenSecureChannelRequest,=pkCli_6289,Nc_6295: bitstring) = m1_6294 in
                                    {6916}new Ns_6296: bitstring;
                                    {6917}new ST_6297: bitstring;
                                    {6918}new TTL_6298: bitstring;
                                    {6919}let m2_6299: bitstring = (OpenSecureChannelResponse,Ns_6296,ST_6297,TTL_6298) in
                                    {6920}out(c, (enc(m2_6299,pkCli_6289),sign(h(m2_6299),skSess_5840)));
                                    {6921}let Ksrv_6300: bitstring = h((Ns_6296,Nc_6295)) in
                                    {6922}out(c, senc(mSrv(pkCli_6289,pkSess_5841),Ksrv_6300))
                            )
                            else
                                {6923}let v_6301: bool = (Disco_5317 = B) in
                                (
                                    {6924}if v_6301 then
                                    (
                                        {6925}let pkDisco_6302: bitstring = pub(skB) in
                                        {6926}in(c, (=pkCli_6289,em1_6303: bitstring,sigM1_6304: bitstring));
                                        {6927}let m1_6305: bitstring = dec(em1_6303,skSess_5840) in
                                        {6928}if (verify(h(m1_6305),sigM1_6304,pkCli_6289) <> true) then
                                            0
                                        else
                                            {6929}let (=OpenSecureChannelRequest,=pkCli_6289,Nc_6306: bitstring) = m1_6305 in
                                            {6930}new Ns_6307: bitstring;
                                            {6931}new ST_6308: bitstring;
                                            {6932}new TTL_6309: bitstring;
                                            {6933}let m2_6310: bitstring = (OpenSecureChannelResponse,Ns_6307,ST_6308,TTL_6309) in
                                            {6934}out(c, (enc(m2_6310,pkCli_6289),sign(h(m2_6310),skSess_5840)));
                                            {6935}let Ksrv_6311: bitstring = h((Ns_6307,Nc_6306)) in
                                            {6936}out(c, senc(mSrv(pkCli_6289,pkSess_5841),Ksrv_6311))
                                    )
                                    else
                                        {6937}let v_6312: bool = (Disco_5317 = C) in
                                        (
                                            {6938}if v_6312 then
                                            (
                                                {6939}let pkDisco_6313: bitstring = pub(skC) in
                                                {6940}in(c, (=pkCli_6289,em1_6314: bitstring,sigM1_6315: bitstring));
                                                {6941}let m1_6316: bitstring = dec(em1_6314,skSess_5840) in
                                                {6942}if (verify(h(m1_6316),sigM1_6315,pkCli_6289) <> true) then
                                                    0
                                                else
                                                    {6943}let (=OpenSecureChannelRequest,=pkCli_6289,Nc_6317: bitstring) = m1_6316 in
                                                    {6944}new Ns_6318: bitstring;
                                                    {6945}new ST_6319: bitstring;
                                                    {6946}new TTL_6320: bitstring;
                                                    {6947}let m2_6321: bitstring = (OpenSecureChannelResponse,Ns_6318,ST_6319,TTL_6320) in
                                                    {6948}out(c, (enc(m2_6321,pkCli_6289),sign(h(m2_6321),skSess_5840)));
                                                    {6949}let Ksrv_6322: bitstring = h((Ns_6318,Nc_6317)) in
                                                    {6950}out(c, senc(mSrv(pkCli_6289,pkSess_5841),Ksrv_6322))
                                            )
                                            else
                                                {6951}let pkDisco_6323: bitstring = pub(sk(Disco_5317)) in
                                                {6952}in(c, (=pkCli_6289,em1_6324: bitstring,sigM1_6325: bitstring));
                                                {6953}let m1_6326: bitstring = dec(em1_6324,skSess_5840) in
                                                {6954}if (verify(h(m1_6326),sigM1_6325,pkCli_6289) <> true) then
                                                    0
                                                else
                                                    {6955}let (=OpenSecureChannelRequest,=pkCli_6289,Nc_6327: bitstring) = m1_6326 in
                                                    {6956}new Ns_6328: bitstring;
                                                    {6957}new ST_6329: bitstring;
                                                    {6958}new TTL_6330: bitstring;
                                                    {6959}let m2_6331: bitstring = (OpenSecureChannelResponse,Ns_6328,ST_6329,TTL_6330) in
                                                    {6960}out(c, (enc(m2_6331,pkCli_6289),sign(h(m2_6331),skSess_5840)));
                                                    {6961}let Ksrv_6332: bitstring = h((Ns_6328,Nc_6327)) in
                                                    {6962}out(c, senc(mSrv(pkCli_6289,pkSess_5841),Ksrv_6332))
                                        )
                                        else
                                            {6963}let pkDisco_6333: bitstring = fail-any in
                                            {6964}in(c, (=pkCli_6289,em1_6334: bitstring,sigM1_6335: bitstring));
                                            {6965}let m1_6336: bitstring = dec(em1_6334,skSess_5840) in
                                            {6966}if (verify(h(m1_6336),sigM1_6335,pkCli_6289) <> true) then
                                                0
                                            else
                                                {6967}let (=OpenSecureChannelRequest,=pkCli_6289,Nc_6337: bitstring) = m1_6336 in
                                                {6968}new Ns_6338: bitstring;
                                                {6969}new ST_6339: bitstring;
                                                {6970}new TTL_6340: bitstring;
                                                {6971}let m2_6341: bitstring = (OpenSecureChannelResponse,Ns_6338,ST_6339,TTL_6340) in
                                                {6972}out(c, (enc(m2_6341,pkCli_6289),sign(h(m2_6341),skSess_5840)));
                                                {6973}let Ksrv_6342: bitstring = h((Ns_6338,Nc_6337)) in
                                                {6974}out(c, senc(mSrv(pkCli_6289,pkSess_5841),Ksrv_6342))
                                )
                                else
                                    {6975}let pkDisco_6343: bitstring = fail-any in
                                    {6976}in(c, (=pkCli_6289,em1_6344: bitstring,sigM1_6345: bitstring));
                                    {6977}let m1_6346: bitstring = dec(em1_6344,skSess_5840) in
                                    {6978}if (verify(h(m1_6346),sigM1_6345,pkCli_6289) <> true) then
                                        0
                                    else
                                        {6979}let (=OpenSecureChannelRequest,=pkCli_6289,Nc_6347: bitstring) = m1_6346 in
                                        {6980}new Ns_6348: bitstring;
                                        {6981}new ST_6349: bitstring;
                                        {6982}new TTL_6350: bitstring;
                                        {6983}let m2_6351: bitstring = (OpenSecureChannelResponse,Ns_6348,ST_6349,TTL_6350) in
                                        {6984}out(c, (enc(m2_6351,pkCli_6289),sign(h(m2_6351),skSess_5840)));
                                        {6985}let Ksrv_6352: bitstring = h((Ns_6348,Nc_6347)) in
                                        {6986}out(c, senc(mSrv(pkCli_6289,pkSess_5841),Ksrv_6352))
                        )
                        else
                            {6987}let pkDisco_6353: bitstring = fail-any in
                            {6988}in(c, (=pkCli_6289,em1_6354: bitstring,sigM1_6355: bitstring));
                            {6989}let m1_6356: bitstring = dec(em1_6354,skSess_5840) in
                            {6990}if (verify(h(m1_6356),sigM1_6355,pkCli_6289) <> true) then
                                0
                            else
                                {6991}let (=OpenSecureChannelRequest,=pkCli_6289,Nc_6357: bitstring) = m1_6356 in
                                {6992}new Ns_6358: bitstring;
                                {6993}new ST_6359: bitstring;
                                {6994}new TTL_6360: bitstring;
                                {6995}let m2_6361: bitstring = (OpenSecureChannelResponse,Ns_6358,ST_6359,TTL_6360) in
                                {6996}out(c, (enc(m2_6361,pkCli_6289),sign(h(m2_6361),skSess_5840)));
                                {6997}let Ksrv_6362: bitstring = h((Ns_6358,Nc_6357)) in
                                {6998}out(c, senc(mSrv(pkCli_6289,pkSess_5841),Ksrv_6362))
                )
                else
                    {6999}let =true = (Sess_5318 = C) in
                    (
                        {7000}let skSess_6363: bitstring = skC in
                        {7001}let pkSess_6364: bitstring = pub(skSess_6363) in
                        {7002}let v_6365: bool = (Cli_5316 = A) in
                        (
                            {7003}if v_6365 then
                            (
                                {7004}let pkCli_6366: bitstring = pub(skA) in
                                {7005}let v_6367: bool = (Disco_5317 = A) in
                                (
                                    {7006}if v_6367 then
                                    (
                                        {7007}let pkDisco_6368: bitstring = pub(skA) in
                                        {7008}in(c, (=pkCli_6366,em1_6369: bitstring,sigM1_6370: bitstring));
                                        {7009}let m1_6371: bitstring = dec(em1_6369,skSess_6363) in
                                        {7010}if (verify(h(m1_6371),sigM1_6370,pkCli_6366) <> true) then
                                            0
                                        else
                                            {7011}let (=OpenSecureChannelRequest,=pkCli_6366,Nc_6372: bitstring) = m1_6371 in
                                            {7012}new Ns_6373: bitstring;
                                            {7013}new ST_6374: bitstring;
                                            {7014}new TTL_6375: bitstring;
                                            {7015}let m2_6376: bitstring = (OpenSecureChannelResponse,Ns_6373,ST_6374,TTL_6375) in
                                            {7016}out(c, (enc(m2_6376,pkCli_6366),sign(h(m2_6376),skSess_6363)));
                                            {7017}let Ksrv_6377: bitstring = h((Ns_6373,Nc_6372)) in
                                            {7018}out(c, senc(mSrv(pkCli_6366,pkSess_6364),Ksrv_6377))
                                    )
                                    else
                                        {7019}let v_6378: bool = (Disco_5317 = B) in
                                        (
                                            {7020}if v_6378 then
                                            (
                                                {7021}let pkDisco_6379: bitstring = pub(skB) in
                                                {7022}in(c, (=pkCli_6366,em1_6380: bitstring,sigM1_6381: bitstring));
                                                {7023}let m1_6382: bitstring = dec(em1_6380,skSess_6363) in
                                                {7024}if (verify(h(m1_6382),sigM1_6381,pkCli_6366) <> true) then
                                                    0
                                                else
                                                    {7025}let (=OpenSecureChannelRequest,=pkCli_6366,Nc_6383: bitstring) = m1_6382 in
                                                    {7026}new Ns_6384: bitstring;
                                                    {7027}new ST_6385: bitstring;
                                                    {7028}new TTL_6386: bitstring;
                                                    {7029}let m2_6387: bitstring = (OpenSecureChannelResponse,Ns_6384,ST_6385,TTL_6386) in
                                                    {7030}out(c, (enc(m2_6387,pkCli_6366),sign(h(m2_6387),skSess_6363)));
                                                    {7031}let Ksrv_6388: bitstring = h((Ns_6384,Nc_6383)) in
                                                    {7032}out(c, senc(mSrv(pkCli_6366,pkSess_6364),Ksrv_6388))
                                            )
                                            else
                                                {7033}let v_6389: bool = (Disco_5317 = C) in
                                                (
                                                    {7034}if v_6389 then
                                                    (
                                                        {7035}let pkDisco_6390: bitstring = pub(skC) in
                                                        {7036}in(c, (=pkCli_6366,em1_6391: bitstring,sigM1_6392: bitstring));
                                                        {7037}let m1_6393: bitstring = dec(em1_6391,skSess_6363) in
                                                        {7038}if (verify(h(m1_6393),sigM1_6392,pkCli_6366) <> true) then
                                                            0
                                                        else
                                                            {7039}let (=OpenSecureChannelRequest,=pkCli_6366,Nc_6394: bitstring) = m1_6393 in
                                                            {7040}new Ns_6395: bitstring;
                                                            {7041}new ST_6396: bitstring;
                                                            {7042}new TTL_6397: bitstring;
                                                            {7043}let m2_6398: bitstring = (OpenSecureChannelResponse,Ns_6395,ST_6396,TTL_6397) in
                                                            {7044}out(c, (enc(m2_6398,pkCli_6366),sign(h(m2_6398),skSess_6363)));
                                                            {7045}let Ksrv_6399: bitstring = h((Ns_6395,Nc_6394)) in
                                                            {7046}out(c, senc(mSrv(pkCli_6366,pkSess_6364),Ksrv_6399))
                                                    )
                                                    else
                                                        {7047}let pkDisco_6400: bitstring = pub(sk(Disco_5317)) in
                                                        {7048}in(c, (=pkCli_6366,em1_6401: bitstring,sigM1_6402: bitstring));
                                                        {7049}let m1_6403: bitstring = dec(em1_6401,skSess_6363) in
                                                        {7050}if (verify(h(m1_6403),sigM1_6402,pkCli_6366) <> true) then
                                                            0
                                                        else
                                                            {7051}let (=OpenSecureChannelRequest,=pkCli_6366,Nc_6404: bitstring) = m1_6403 in
                                                            {7052}new Ns_6405: bitstring;
                                                            {7053}new ST_6406: bitstring;
                                                            {7054}new TTL_6407: bitstring;
                                                            {7055}let m2_6408: bitstring = (OpenSecureChannelResponse,Ns_6405,ST_6406,TTL_6407) in
                                                            {7056}out(c, (enc(m2_6408,pkCli_6366),sign(h(m2_6408),skSess_6363)));
                                                            {7057}let Ksrv_6409: bitstring = h((Ns_6405,Nc_6404)) in
                                                            {7058}out(c, senc(mSrv(pkCli_6366,pkSess_6364),Ksrv_6409))
                                                )
                                                else
                                                    {7059}let pkDisco_6410: bitstring = fail-any in
                                                    {7060}in(c, (=pkCli_6366,em1_6411: bitstring,sigM1_6412: bitstring));
                                                    {7061}let m1_6413: bitstring = dec(em1_6411,skSess_6363) in
                                                    {7062}if (verify(h(m1_6413),sigM1_6412,pkCli_6366) <> true) then
                                                        0
                                                    else
                                                        {7063}let (=OpenSecureChannelRequest,=pkCli_6366,Nc_6414: bitstring) = m1_6413 in
                                                        {7064}new Ns_6415: bitstring;
                                                        {7065}new ST_6416: bitstring;
                                                        {7066}new TTL_6417: bitstring;
                                                        {7067}let m2_6418: bitstring = (OpenSecureChannelResponse,Ns_6415,ST_6416,TTL_6417) in
                                                        {7068}out(c, (enc(m2_6418,pkCli_6366),sign(h(m2_6418),skSess_6363)));
                                                        {7069}let Ksrv_6419: bitstring = h((Ns_6415,Nc_6414)) in
                                                        {7070}out(c, senc(mSrv(pkCli_6366,pkSess_6364),Ksrv_6419))
                                        )
                                        else
                                            {7071}let pkDisco_6420: bitstring = fail-any in
                                            {7072}in(c, (=pkCli_6366,em1_6421: bitstring,sigM1_6422: bitstring));
                                            {7073}let m1_6423: bitstring = dec(em1_6421,skSess_6363) in
                                            {7074}if (verify(h(m1_6423),sigM1_6422,pkCli_6366) <> true) then
                                                0
                                            else
                                                {7075}let (=OpenSecureChannelRequest,=pkCli_6366,Nc_6424: bitstring) = m1_6423 in
                                                {7076}new Ns_6425: bitstring;
                                                {7077}new ST_6426: bitstring;
                                                {7078}new TTL_6427: bitstring;
                                                {7079}let m2_6428: bitstring = (OpenSecureChannelResponse,Ns_6425,ST_6426,TTL_6427) in
                                                {7080}out(c, (enc(m2_6428,pkCli_6366),sign(h(m2_6428),skSess_6363)));
                                                {7081}let Ksrv_6429: bitstring = h((Ns_6425,Nc_6424)) in
                                                {7082}out(c, senc(mSrv(pkCli_6366,pkSess_6364),Ksrv_6429))
                                )
                                else
                                    {7083}let pkDisco_6430: bitstring = fail-any in
                                    {7084}in(c, (=pkCli_6366,em1_6431: bitstring,sigM1_6432: bitstring));
                                    {7085}let m1_6433: bitstring = dec(em1_6431,skSess_6363) in
                                    {7086}if (verify(h(m1_6433),sigM1_6432,pkCli_6366) <> true) then
                                        0
                                    else
                                        {7087}let (=OpenSecureChannelRequest,=pkCli_6366,Nc_6434: bitstring) = m1_6433 in
                                        {7088}new Ns_6435: bitstring;
                                        {7089}new ST_6436: bitstring;
                                        {7090}new TTL_6437: bitstring;
                                        {7091}let m2_6438: bitstring = (OpenSecureChannelResponse,Ns_6435,ST_6436,TTL_6437) in
                                        {7092}out(c, (enc(m2_6438,pkCli_6366),sign(h(m2_6438),skSess_6363)));
                                        {7093}let Ksrv_6439: bitstring = h((Ns_6435,Nc_6434)) in
                                        {7094}out(c, senc(mSrv(pkCli_6366,pkSess_6364),Ksrv_6439))
                            )
                            else
                                {7095}let v_6440: bool = (Cli_5316 = B) in
                                (
                                    {7096}if v_6440 then
                                    (
                                        {7097}let pkCli_6441: bitstring = pub(skB) in
                                        {7098}let v_6442: bool = (Disco_5317 = A) in
                                        (
                                            {7099}if v_6442 then
                                            (
                                                {7100}let pkDisco_6443: bitstring = pub(skA) in
                                                {7101}in(c, (=pkCli_6441,em1_6444: bitstring,sigM1_6445: bitstring));
                                                {7102}let m1_6446: bitstring = dec(em1_6444,skSess_6363) in
                                                {7103}if (verify(h(m1_6446),sigM1_6445,pkCli_6441) <> true) then
                                                    0
                                                else
                                                    {7104}let (=OpenSecureChannelRequest,=pkCli_6441,Nc_6447: bitstring) = m1_6446 in
                                                    {7105}new Ns_6448: bitstring;
                                                    {7106}new ST_6449: bitstring;
                                                    {7107}new TTL_6450: bitstring;
                                                    {7108}let m2_6451: bitstring = (OpenSecureChannelResponse,Ns_6448,ST_6449,TTL_6450) in
                                                    {7109}out(c, (enc(m2_6451,pkCli_6441),sign(h(m2_6451),skSess_6363)));
                                                    {7110}let Ksrv_6452: bitstring = h((Ns_6448,Nc_6447)) in
                                                    {7111}out(c, senc(mSrv(pkCli_6441,pkSess_6364),Ksrv_6452))
                                            )
                                            else
                                                {7112}let v_6453: bool = (Disco_5317 = B) in
                                                (
                                                    {7113}if v_6453 then
                                                    (
                                                        {7114}let pkDisco_6454: bitstring = pub(skB) in
                                                        {7115}in(c, (=pkCli_6441,em1_6455: bitstring,sigM1_6456: bitstring));
                                                        {7116}let m1_6457: bitstring = dec(em1_6455,skSess_6363) in
                                                        {7117}if (verify(h(m1_6457),sigM1_6456,pkCli_6441) <> true) then
                                                            0
                                                        else
                                                            {7118}let (=OpenSecureChannelRequest,=pkCli_6441,Nc_6458: bitstring) = m1_6457 in
                                                            {7119}new Ns_6459: bitstring;
                                                            {7120}new ST_6460: bitstring;
                                                            {7121}new TTL_6461: bitstring;
                                                            {7122}let m2_6462: bitstring = (OpenSecureChannelResponse,Ns_6459,ST_6460,TTL_6461) in
                                                            {7123}out(c, (enc(m2_6462,pkCli_6441),sign(h(m2_6462),skSess_6363)));
                                                            {7124}let Ksrv_6463: bitstring = h((Ns_6459,Nc_6458)) in
                                                            {7125}out(c, senc(mSrv(pkCli_6441,pkSess_6364),Ksrv_6463))
                                                    )
                                                    else
                                                        {7126}let v_6464: bool = (Disco_5317 = C) in
                                                        (
                                                            {7127}if v_6464 then
                                                            (
                                                                {7128}let pkDisco_6465: bitstring = pub(skC) in
                                                                {7129}in(c, (=pkCli_6441,em1_6466: bitstring,sigM1_6467: bitstring));
                                                                {7130}let m1_6468: bitstring = dec(em1_6466,skSess_6363) in
                                                                {7131}if (verify(h(m1_6468),sigM1_6467,pkCli_6441) <> true) then
                                                                    0
                                                                else
                                                                    {7132}let (=OpenSecureChannelRequest,=pkCli_6441,Nc_6469: bitstring) = m1_6468 in
                                                                    {7133}new Ns_6470: bitstring;
                                                                    {7134}new ST_6471: bitstring;
                                                                    {7135}new TTL_6472: bitstring;
                                                                    {7136}let m2_6473: bitstring = (OpenSecureChannelResponse,Ns_6470,ST_6471,TTL_6472) in
                                                                    {7137}out(c, (enc(m2_6473,pkCli_6441),sign(h(m2_6473),skSess_6363)));
                                                                    {7138}let Ksrv_6474: bitstring = h((Ns_6470,Nc_6469)) in
                                                                    {7139}out(c, senc(mSrv(pkCli_6441,pkSess_6364),Ksrv_6474))
                                                            )
                                                            else
                                                                {7140}let pkDisco_6475: bitstring = pub(sk(Disco_5317)) in
                                                                {7141}in(c, (=pkCli_6441,em1_6476: bitstring,sigM1_6477: bitstring));
                                                                {7142}let m1_6478: bitstring = dec(em1_6476,skSess_6363) in
                                                                {7143}if (verify(h(m1_6478),sigM1_6477,pkCli_6441) <> true) then
                                                                    0
                                                                else
                                                                    {7144}let (=OpenSecureChannelRequest,=pkCli_6441,Nc_6479: bitstring) = m1_6478 in
                                                                    {7145}new Ns_6480: bitstring;
                                                                    {7146}new ST_6481: bitstring;
                                                                    {7147}new TTL_6482: bitstring;
                                                                    {7148}let m2_6483: bitstring = (OpenSecureChannelResponse,Ns_6480,ST_6481,TTL_6482) in
                                                                    {7149}out(c, (enc(m2_6483,pkCli_6441),sign(h(m2_6483),skSess_6363)));
                                                                    {7150}let Ksrv_6484: bitstring = h((Ns_6480,Nc_6479)) in
                                                                    {7151}out(c, senc(mSrv(pkCli_6441,pkSess_6364),Ksrv_6484))
                                                        )
                                                        else
                                                            {7152}let pkDisco_6485: bitstring = fail-any in
                                                            {7153}in(c, (=pkCli_6441,em1_6486: bitstring,sigM1_6487: bitstring));
                                                            {7154}let m1_6488: bitstring = dec(em1_6486,skSess_6363) in
                                                            {7155}if (verify(h(m1_6488),sigM1_6487,pkCli_6441) <> true) then
                                                                0
                                                            else
                                                                {7156}let (=OpenSecureChannelRequest,=pkCli_6441,Nc_6489: bitstring) = m1_6488 in
                                                                {7157}new Ns_6490: bitstring;
                                                                {7158}new ST_6491: bitstring;
                                                                {7159}new TTL_6492: bitstring;
                                                                {7160}let m2_6493: bitstring = (OpenSecureChannelResponse,Ns_6490,ST_6491,TTL_6492) in
                                                                {7161}out(c, (enc(m2_6493,pkCli_6441),sign(h(m2_6493),skSess_6363)));
                                                                {7162}let Ksrv_6494: bitstring = h((Ns_6490,Nc_6489)) in
                                                                {7163}out(c, senc(mSrv(pkCli_6441,pkSess_6364),Ksrv_6494))
                                                )
                                                else
                                                    {7164}let pkDisco_6495: bitstring = fail-any in
                                                    {7165}in(c, (=pkCli_6441,em1_6496: bitstring,sigM1_6497: bitstring));
                                                    {7166}let m1_6498: bitstring = dec(em1_6496,skSess_6363) in
                                                    {7167}if (verify(h(m1_6498),sigM1_6497,pkCli_6441) <> true) then
                                                        0
                                                    else
                                                        {7168}let (=OpenSecureChannelRequest,=pkCli_6441,Nc_6499: bitstring) = m1_6498 in
                                                        {7169}new Ns_6500: bitstring;
                                                        {7170}new ST_6501: bitstring;
                                                        {7171}new TTL_6502: bitstring;
                                                        {7172}let m2_6503: bitstring = (OpenSecureChannelResponse,Ns_6500,ST_6501,TTL_6502) in
                                                        {7173}out(c, (enc(m2_6503,pkCli_6441),sign(h(m2_6503),skSess_6363)));
                                                        {7174}let Ksrv_6504: bitstring = h((Ns_6500,Nc_6499)) in
                                                        {7175}out(c, senc(mSrv(pkCli_6441,pkSess_6364),Ksrv_6504))
                                        )
                                        else
                                            {7176}let pkDisco_6505: bitstring = fail-any in
                                            {7177}in(c, (=pkCli_6441,em1_6506: bitstring,sigM1_6507: bitstring));
                                            {7178}let m1_6508: bitstring = dec(em1_6506,skSess_6363) in
                                            {7179}if (verify(h(m1_6508),sigM1_6507,pkCli_6441) <> true) then
                                                0
                                            else
                                                {7180}let (=OpenSecureChannelRequest,=pkCli_6441,Nc_6509: bitstring) = m1_6508 in
                                                {7181}new Ns_6510: bitstring;
                                                {7182}new ST_6511: bitstring;
                                                {7183}new TTL_6512: bitstring;
                                                {7184}let m2_6513: bitstring = (OpenSecureChannelResponse,Ns_6510,ST_6511,TTL_6512) in
                                                {7185}out(c, (enc(m2_6513,pkCli_6441),sign(h(m2_6513),skSess_6363)));
                                                {7186}let Ksrv_6514: bitstring = h((Ns_6510,Nc_6509)) in
                                                {7187}out(c, senc(mSrv(pkCli_6441,pkSess_6364),Ksrv_6514))
                                    )
                                    else
                                        {7188}let v_6515: bool = (Cli_5316 = C) in
                                        (
                                            {7189}if v_6515 then
                                            (
                                                {7190}let pkCli_6516: bitstring = pub(skC) in
                                                {7191}let v_6517: bool = (Disco_5317 = A) in
                                                (
                                                    {7192}if v_6517 then
                                                    (
                                                        {7193}let pkDisco_6518: bitstring = pub(skA) in
                                                        {7194}in(c, (=pkCli_6516,em1_6519: bitstring,sigM1_6520: bitstring));
                                                        {7195}let m1_6521: bitstring = dec(em1_6519,skSess_6363) in
                                                        {7196}if (verify(h(m1_6521),sigM1_6520,pkCli_6516) <> true) then
                                                            0
                                                        else
                                                            {7197}let (=OpenSecureChannelRequest,=pkCli_6516,Nc_6522: bitstring) = m1_6521 in
                                                            {7198}new Ns_6523: bitstring;
                                                            {7199}new ST_6524: bitstring;
                                                            {7200}new TTL_6525: bitstring;
                                                            {7201}let m2_6526: bitstring = (OpenSecureChannelResponse,Ns_6523,ST_6524,TTL_6525) in
                                                            {7202}out(c, (enc(m2_6526,pkCli_6516),sign(h(m2_6526),skSess_6363)));
                                                            {7203}let Ksrv_6527: bitstring = h((Ns_6523,Nc_6522)) in
                                                            {7204}out(c, senc(mSrv(pkCli_6516,pkSess_6364),Ksrv_6527))
                                                    )
                                                    else
                                                        {7205}let v_6528: bool = (Disco_5317 = B) in
                                                        (
                                                            {7206}if v_6528 then
                                                            (
                                                                {7207}let pkDisco_6529: bitstring = pub(skB) in
                                                                {7208}in(c, (=pkCli_6516,em1_6530: bitstring,sigM1_6531: bitstring));
                                                                {7209}let m1_6532: bitstring = dec(em1_6530,skSess_6363) in
                                                                {7210}if (verify(h(m1_6532),sigM1_6531,pkCli_6516) <> true) then
                                                                    0
                                                                else
                                                                    {7211}let (=OpenSecureChannelRequest,=pkCli_6516,Nc_6533: bitstring) = m1_6532 in
                                                                    {7212}new Ns_6534: bitstring;
                                                                    {7213}new ST_6535: bitstring;
                                                                    {7214}new TTL_6536: bitstring;
                                                                    {7215}let m2_6537: bitstring = (OpenSecureChannelResponse,Ns_6534,ST_6535,TTL_6536) in
                                                                    {7216}out(c, (enc(m2_6537,pkCli_6516),sign(h(m2_6537),skSess_6363)));
                                                                    {7217}let Ksrv_6538: bitstring = h((Ns_6534,Nc_6533)) in
                                                                    {7218}out(c, senc(mSrv(pkCli_6516,pkSess_6364),Ksrv_6538))
                                                            )
                                                            else
                                                                {7219}let v_6539: bool = (Disco_5317 = C) in
                                                                (
                                                                    {7220}if v_6539 then
                                                                    (
                                                                        {7221}let pkDisco_6540: bitstring = pub(skC) in
                                                                        {7222}in(c, (=pkCli_6516,em1_6541: bitstring,sigM1_6542: bitstring));
                                                                        {7223}let m1_6543: bitstring = dec(em1_6541,skSess_6363) in
                                                                        {7224}if (verify(h(m1_6543),sigM1_6542,pkCli_6516) <> true) then
                                                                            0
                                                                        else
                                                                            {7225}let (=OpenSecureChannelRequest,=pkCli_6516,Nc_6544: bitstring) = m1_6543 in
                                                                            {7226}new Ns_6545: bitstring;
                                                                            {7227}new ST_6546: bitstring;
                                                                            {7228}new TTL_6547: bitstring;
                                                                            {7229}let m2_6548: bitstring = (OpenSecureChannelResponse,Ns_6545,ST_6546,TTL_6547) in
                                                                            {7230}out(c, (enc(m2_6548,pkCli_6516),sign(h(m2_6548),skSess_6363)));
                                                                            {7231}let Ksrv_6549: bitstring = h((Ns_6545,Nc_6544)) in
                                                                            {7232}out(c, senc(mSrv(pkCli_6516,pkSess_6364),Ksrv_6549))
                                                                    )
                                                                    else
                                                                        {7233}let pkDisco_6550: bitstring = pub(sk(Disco_5317)) in
                                                                        {7234}in(c, (=pkCli_6516,em1_6551: bitstring,sigM1_6552: bitstring));
                                                                        {7235}let m1_6553: bitstring = dec(em1_6551,skSess_6363) in
                                                                        {7236}if (verify(h(m1_6553),sigM1_6552,pkCli_6516) <> true) then
                                                                            0
                                                                        else
                                                                            {7237}let (=OpenSecureChannelRequest,=pkCli_6516,Nc_6554: bitstring) = m1_6553 in
                                                                            {7238}new Ns_6555: bitstring;
                                                                            {7239}new ST_6556: bitstring;
                                                                            {7240}new TTL_6557: bitstring;
                                                                            {7241}let m2_6558: bitstring = (OpenSecureChannelResponse,Ns_6555,ST_6556,TTL_6557) in
                                                                            {7242}out(c, (enc(m2_6558,pkCli_6516),sign(h(m2_6558),skSess_6363)));
                                                                            {7243}let Ksrv_6559: bitstring = h((Ns_6555,Nc_6554)) in
                                                                            {7244}out(c, senc(mSrv(pkCli_6516,pkSess_6364),Ksrv_6559))
                                                                )
                                                                else
                                                                    {7245}let pkDisco_6560: bitstring = fail-any in
                                                                    {7246}in(c, (=pkCli_6516,em1_6561: bitstring,sigM1_6562: bitstring));
                                                                    {7247}let m1_6563: bitstring = dec(em1_6561,skSess_6363) in
                                                                    {7248}if (verify(h(m1_6563),sigM1_6562,pkCli_6516) <> true) then
                                                                        0
                                                                    else
                                                                        {7249}let (=OpenSecureChannelRequest,=pkCli_6516,Nc_6564: bitstring) = m1_6563 in
                                                                        {7250}new Ns_6565: bitstring;
                                                                        {7251}new ST_6566: bitstring;
                                                                        {7252}new TTL_6567: bitstring;
                                                                        {7253}let m2_6568: bitstring = (OpenSecureChannelResponse,Ns_6565,ST_6566,TTL_6567) in
                                                                        {7254}out(c, (enc(m2_6568,pkCli_6516),sign(h(m2_6568),skSess_6363)));
                                                                        {7255}let Ksrv_6569: bitstring = h((Ns_6565,Nc_6564)) in
                                                                        {7256}out(c, senc(mSrv(pkCli_6516,pkSess_6364),Ksrv_6569))
                                                        )
                                                        else
                                                            {7257}let pkDisco_6570: bitstring = fail-any in
                                                            {7258}in(c, (=pkCli_6516,em1_6571: bitstring,sigM1_6572: bitstring));
                                                            {7259}let m1_6573: bitstring = dec(em1_6571,skSess_6363) in
                                                            {7260}if (verify(h(m1_6573),sigM1_6572,pkCli_6516) <> true) then
                                                                0
                                                            else
                                                                {7261}let (=OpenSecureChannelRequest,=pkCli_6516,Nc_6574: bitstring) = m1_6573 in
                                                                {7262}new Ns_6575: bitstring;
                                                                {7263}new ST_6576: bitstring;
                                                                {7264}new TTL_6577: bitstring;
                                                                {7265}let m2_6578: bitstring = (OpenSecureChannelResponse,Ns_6575,ST_6576,TTL_6577) in
                                                                {7266}out(c, (enc(m2_6578,pkCli_6516),sign(h(m2_6578),skSess_6363)));
                                                                {7267}let Ksrv_6579: bitstring = h((Ns_6575,Nc_6574)) in
                                                                {7268}out(c, senc(mSrv(pkCli_6516,pkSess_6364),Ksrv_6579))
                                                )
                                                else
                                                    {7269}let pkDisco_6580: bitstring = fail-any in
                                                    {7270}in(c, (=pkCli_6516,em1_6581: bitstring,sigM1_6582: bitstring));
                                                    {7271}let m1_6583: bitstring = dec(em1_6581,skSess_6363) in
                                                    {7272}if (verify(h(m1_6583),sigM1_6582,pkCli_6516) <> true) then
                                                        0
                                                    else
                                                        {7273}let (=OpenSecureChannelRequest,=pkCli_6516,Nc_6584: bitstring) = m1_6583 in
                                                        {7274}new Ns_6585: bitstring;
                                                        {7275}new ST_6586: bitstring;
                                                        {7276}new TTL_6587: bitstring;
                                                        {7277}let m2_6588: bitstring = (OpenSecureChannelResponse,Ns_6585,ST_6586,TTL_6587) in
                                                        {7278}out(c, (enc(m2_6588,pkCli_6516),sign(h(m2_6588),skSess_6363)));
                                                        {7279}let Ksrv_6589: bitstring = h((Ns_6585,Nc_6584)) in
                                                        {7280}out(c, senc(mSrv(pkCli_6516,pkSess_6364),Ksrv_6589))
                                            )
                                            else
                                                {7281}let pkCli_6590: bitstring = pub(sk(Cli_5316)) in
                                                {7282}let v_6591: bool = (Disco_5317 = A) in
                                                (
                                                    {7283}if v_6591 then
                                                    (
                                                        {7284}let pkDisco_6592: bitstring = pub(skA) in
                                                        {7285}in(c, (=pkCli_6590,em1_6593: bitstring,sigM1_6594: bitstring));
                                                        {7286}let m1_6595: bitstring = dec(em1_6593,skSess_6363) in
                                                        {7287}if (verify(h(m1_6595),sigM1_6594,pkCli_6590) <> true) then
                                                            0
                                                        else
                                                            {7288}let (=OpenSecureChannelRequest,=pkCli_6590,Nc_6596: bitstring) = m1_6595 in
                                                            {7289}new Ns_6597: bitstring;
                                                            {7290}new ST_6598: bitstring;
                                                            {7291}new TTL_6599: bitstring;
                                                            {7292}let m2_6600: bitstring = (OpenSecureChannelResponse,Ns_6597,ST_6598,TTL_6599) in
                                                            {7293}out(c, (enc(m2_6600,pkCli_6590),sign(h(m2_6600),skSess_6363)));
                                                            {7294}let Ksrv_6601: bitstring = h((Ns_6597,Nc_6596)) in
                                                            {7295}out(c, senc(mSrv(pkCli_6590,pkSess_6364),Ksrv_6601))
                                                    )
                                                    else
                                                        {7296}let v_6602: bool = (Disco_5317 = B) in
                                                        (
                                                            {7297}if v_6602 then
                                                            (
                                                                {7298}let pkDisco_6603: bitstring = pub(skB) in
                                                                {7299}in(c, (=pkCli_6590,em1_6604: bitstring,sigM1_6605: bitstring));
                                                                {7300}let m1_6606: bitstring = dec(em1_6604,skSess_6363) in
                                                                {7301}if (verify(h(m1_6606),sigM1_6605,pkCli_6590) <> true) then
                                                                    0
                                                                else
                                                                    {7302}let (=OpenSecureChannelRequest,=pkCli_6590,Nc_6607: bitstring) = m1_6606 in
                                                                    {7303}new Ns_6608: bitstring;
                                                                    {7304}new ST_6609: bitstring;
                                                                    {7305}new TTL_6610: bitstring;
                                                                    {7306}let m2_6611: bitstring = (OpenSecureChannelResponse,Ns_6608,ST_6609,TTL_6610) in
                                                                    {7307}out(c, (enc(m2_6611,pkCli_6590),sign(h(m2_6611),skSess_6363)));
                                                                    {7308}let Ksrv_6612: bitstring = h((Ns_6608,Nc_6607)) in
                                                                    {7309}out(c, senc(mSrv(pkCli_6590,pkSess_6364),Ksrv_6612))
                                                            )
                                                            else
                                                                {7310}let v_6613: bool = (Disco_5317 = C) in
                                                                (
                                                                    {7311}if v_6613 then
                                                                    (
                                                                        {7312}let pkDisco_6614: bitstring = pub(skC) in
                                                                        {7313}in(c, (=pkCli_6590,em1_6615: bitstring,sigM1_6616: bitstring));
                                                                        {7314}let m1_6617: bitstring = dec(em1_6615,skSess_6363) in
                                                                        {7315}if (verify(h(m1_6617),sigM1_6616,pkCli_6590) <> true) then
                                                                            0
                                                                        else
                                                                            {7316}let (=OpenSecureChannelRequest,=pkCli_6590,Nc_6618: bitstring) = m1_6617 in
                                                                            {7317}new Ns_6619: bitstring;
                                                                            {7318}new ST_6620: bitstring;
                                                                            {7319}new TTL_6621: bitstring;
                                                                            {7320}let m2_6622: bitstring = (OpenSecureChannelResponse,Ns_6619,ST_6620,TTL_6621) in
                                                                            {7321}out(c, (enc(m2_6622,pkCli_6590),sign(h(m2_6622),skSess_6363)));
                                                                            {7322}let Ksrv_6623: bitstring = h((Ns_6619,Nc_6618)) in
                                                                            {7323}out(c, senc(mSrv(pkCli_6590,pkSess_6364),Ksrv_6623))
                                                                    )
                                                                    else
                                                                        {7324}let pkDisco_6624: bitstring = pub(sk(Disco_5317)) in
                                                                        {7325}in(c, (=pkCli_6590,em1_6625: bitstring,sigM1_6626: bitstring));
                                                                        {7326}let m1_6627: bitstring = dec(em1_6625,skSess_6363) in
                                                                        {7327}if (verify(h(m1_6627),sigM1_6626,pkCli_6590) <> true) then
                                                                            0
                                                                        else
                                                                            {7328}let (=OpenSecureChannelRequest,=pkCli_6590,Nc_6628: bitstring) = m1_6627 in
                                                                            {7329}new Ns_6629: bitstring;
                                                                            {7330}new ST_6630: bitstring;
                                                                            {7331}new TTL_6631: bitstring;
                                                                            {7332}let m2_6632: bitstring = (OpenSecureChannelResponse,Ns_6629,ST_6630,TTL_6631) in
                                                                            {7333}out(c, (enc(m2_6632,pkCli_6590),sign(h(m2_6632),skSess_6363)));
                                                                            {7334}let Ksrv_6633: bitstring = h((Ns_6629,Nc_6628)) in
                                                                            {7335}out(c, senc(mSrv(pkCli_6590,pkSess_6364),Ksrv_6633))
                                                                )
                                                                else
                                                                    {7336}let pkDisco_6634: bitstring = fail-any in
                                                                    {7337}in(c, (=pkCli_6590,em1_6635: bitstring,sigM1_6636: bitstring));
                                                                    {7338}let m1_6637: bitstring = dec(em1_6635,skSess_6363) in
                                                                    {7339}if (verify(h(m1_6637),sigM1_6636,pkCli_6590) <> true) then
                                                                        0
                                                                    else
                                                                        {7340}let (=OpenSecureChannelRequest,=pkCli_6590,Nc_6638: bitstring) = m1_6637 in
                                                                        {7341}new Ns_6639: bitstring;
                                                                        {7342}new ST_6640: bitstring;
                                                                        {7343}new TTL_6641: bitstring;
                                                                        {7344}let m2_6642: bitstring = (OpenSecureChannelResponse,Ns_6639,ST_6640,TTL_6641) in
                                                                        {7345}out(c, (enc(m2_6642,pkCli_6590),sign(h(m2_6642),skSess_6363)));
                                                                        {7346}let Ksrv_6643: bitstring = h((Ns_6639,Nc_6638)) in
                                                                        {7347}out(c, senc(mSrv(pkCli_6590,pkSess_6364),Ksrv_6643))
                                                        )
                                                        else
                                                            {7348}let pkDisco_6644: bitstring = fail-any in
                                                            {7349}in(c, (=pkCli_6590,em1_6645: bitstring,sigM1_6646: bitstring));
                                                            {7350}let m1_6647: bitstring = dec(em1_6645,skSess_6363) in
                                                            {7351}if (verify(h(m1_6647),sigM1_6646,pkCli_6590) <> true) then
                                                                0
                                                            else
                                                                {7352}let (=OpenSecureChannelRequest,=pkCli_6590,Nc_6648: bitstring) = m1_6647 in
                                                                {7353}new Ns_6649: bitstring;
                                                                {7354}new ST_6650: bitstring;
                                                                {7355}new TTL_6651: bitstring;
                                                                {7356}let m2_6652: bitstring = (OpenSecureChannelResponse,Ns_6649,ST_6650,TTL_6651) in
                                                                {7357}out(c, (enc(m2_6652,pkCli_6590),sign(h(m2_6652),skSess_6363)));
                                                                {7358}let Ksrv_6653: bitstring = h((Ns_6649,Nc_6648)) in
                                                                {7359}out(c, senc(mSrv(pkCli_6590,pkSess_6364),Ksrv_6653))
                                                )
                                                else
                                                    {7360}let pkDisco_6654: bitstring = fail-any in
                                                    {7361}in(c, (=pkCli_6590,em1_6655: bitstring,sigM1_6656: bitstring));
                                                    {7362}let m1_6657: bitstring = dec(em1_6655,skSess_6363) in
                                                    {7363}if (verify(h(m1_6657),sigM1_6656,pkCli_6590) <> true) then
                                                        0
                                                    else
                                                        {7364}let (=OpenSecureChannelRequest,=pkCli_6590,Nc_6658: bitstring) = m1_6657 in
                                                        {7365}new Ns_6659: bitstring;
                                                        {7366}new ST_6660: bitstring;
                                                        {7367}new TTL_6661: bitstring;
                                                        {7368}let m2_6662: bitstring = (OpenSecureChannelResponse,Ns_6659,ST_6660,TTL_6661) in
                                                        {7369}out(c, (enc(m2_6662,pkCli_6590),sign(h(m2_6662),skSess_6363)));
                                                        {7370}let Ksrv_6663: bitstring = h((Ns_6659,Nc_6658)) in
                                                        {7371}out(c, senc(mSrv(pkCli_6590,pkSess_6364),Ksrv_6663))
                                        )
                                        else
                                            {7372}let pkCli_6664: bitstring = fail-any in
                                            {7373}let v_6665: bool = (Disco_5317 = A) in
                                            (
                                                {7374}if v_6665 then
                                                (
                                                    {7375}let pkDisco_6666: bitstring = pub(skA) in
                                                    {7376}in(c, (=pkCli_6664,em1_6667: bitstring,sigM1_6668: bitstring));
                                                    {7377}let m1_6669: bitstring = dec(em1_6667,skSess_6363) in
                                                    {7378}if (verify(h(m1_6669),sigM1_6668,pkCli_6664) <> true) then
                                                        0
                                                    else
                                                        {7379}let (=OpenSecureChannelRequest,=pkCli_6664,Nc_6670: bitstring) = m1_6669 in
                                                        {7380}new Ns_6671: bitstring;
                                                        {7381}new ST_6672: bitstring;
                                                        {7382}new TTL_6673: bitstring;
                                                        {7383}let m2_6674: bitstring = (OpenSecureChannelResponse,Ns_6671,ST_6672,TTL_6673) in
                                                        {7384}out(c, (enc(m2_6674,pkCli_6664),sign(h(m2_6674),skSess_6363)));
                                                        {7385}let Ksrv_6675: bitstring = h((Ns_6671,Nc_6670)) in
                                                        {7386}out(c, senc(mSrv(pkCli_6664,pkSess_6364),Ksrv_6675))
                                                )
                                                else
                                                    {7387}let v_6676: bool = (Disco_5317 = B) in
                                                    (
                                                        {7388}if v_6676 then
                                                        (
                                                            {7389}let pkDisco_6677: bitstring = pub(skB) in
                                                            {7390}in(c, (=pkCli_6664,em1_6678: bitstring,sigM1_6679: bitstring));
                                                            {7391}let m1_6680: bitstring = dec(em1_6678,skSess_6363) in
                                                            {7392}if (verify(h(m1_6680),sigM1_6679,pkCli_6664) <> true) then
                                                                0
                                                            else
                                                                {7393}let (=OpenSecureChannelRequest,=pkCli_6664,Nc_6681: bitstring) = m1_6680 in
                                                                {7394}new Ns_6682: bitstring;
                                                                {7395}new ST_6683: bitstring;
                                                                {7396}new TTL_6684: bitstring;
                                                                {7397}let m2_6685: bitstring = (OpenSecureChannelResponse,Ns_6682,ST_6683,TTL_6684) in
                                                                {7398}out(c, (enc(m2_6685,pkCli_6664),sign(h(m2_6685),skSess_6363)));
                                                                {7399}let Ksrv_6686: bitstring = h((Ns_6682,Nc_6681)) in
                                                                {7400}out(c, senc(mSrv(pkCli_6664,pkSess_6364),Ksrv_6686))
                                                        )
                                                        else
                                                            {7401}let v_6687: bool = (Disco_5317 = C) in
                                                            (
                                                                {7402}if v_6687 then
                                                                (
                                                                    {7403}let pkDisco_6688: bitstring = pub(skC) in
                                                                    {7404}in(c, (=pkCli_6664,em1_6689: bitstring,sigM1_6690: bitstring));
                                                                    {7405}let m1_6691: bitstring = dec(em1_6689,skSess_6363) in
                                                                    {7406}if (verify(h(m1_6691),sigM1_6690,pkCli_6664) <> true) then
                                                                        0
                                                                    else
                                                                        {7407}let (=OpenSecureChannelRequest,=pkCli_6664,Nc_6692: bitstring) = m1_6691 in
                                                                        {7408}new Ns_6693: bitstring;
                                                                        {7409}new ST_6694: bitstring;
                                                                        {7410}new TTL_6695: bitstring;
                                                                        {7411}let m2_6696: bitstring = (OpenSecureChannelResponse,Ns_6693,ST_6694,TTL_6695) in
                                                                        {7412}out(c, (enc(m2_6696,pkCli_6664),sign(h(m2_6696),skSess_6363)));
                                                                        {7413}let Ksrv_6697: bitstring = h((Ns_6693,Nc_6692)) in
                                                                        {7414}out(c, senc(mSrv(pkCli_6664,pkSess_6364),Ksrv_6697))
                                                                )
                                                                else
                                                                    {7415}let pkDisco_6698: bitstring = pub(sk(Disco_5317)) in
                                                                    {7416}in(c, (=pkCli_6664,em1_6699: bitstring,sigM1_6700: bitstring));
                                                                    {7417}let m1_6701: bitstring = dec(em1_6699,skSess_6363) in
                                                                    {7418}if (verify(h(m1_6701),sigM1_6700,pkCli_6664) <> true) then
                                                                        0
                                                                    else
                                                                        {7419}let (=OpenSecureChannelRequest,=pkCli_6664,Nc_6702: bitstring) = m1_6701 in
                                                                        {7420}new Ns_6703: bitstring;
                                                                        {7421}new ST_6704: bitstring;
                                                                        {7422}new TTL_6705: bitstring;
                                                                        {7423}let m2_6706: bitstring = (OpenSecureChannelResponse,Ns_6703,ST_6704,TTL_6705) in
                                                                        {7424}out(c, (enc(m2_6706,pkCli_6664),sign(h(m2_6706),skSess_6363)));
                                                                        {7425}let Ksrv_6707: bitstring = h((Ns_6703,Nc_6702)) in
                                                                        {7426}out(c, senc(mSrv(pkCli_6664,pkSess_6364),Ksrv_6707))
                                                            )
                                                            else
                                                                {7427}let pkDisco_6708: bitstring = fail-any in
                                                                {7428}in(c, (=pkCli_6664,em1_6709: bitstring,sigM1_6710: bitstring));
                                                                {7429}let m1_6711: bitstring = dec(em1_6709,skSess_6363) in
                                                                {7430}if (verify(h(m1_6711),sigM1_6710,pkCli_6664) <> true) then
                                                                    0
                                                                else
                                                                    {7431}let (=OpenSecureChannelRequest,=pkCli_6664,Nc_6712: bitstring) = m1_6711 in
                                                                    {7432}new Ns_6713: bitstring;
                                                                    {7433}new ST_6714: bitstring;
                                                                    {7434}new TTL_6715: bitstring;
                                                                    {7435}let m2_6716: bitstring = (OpenSecureChannelResponse,Ns_6713,ST_6714,TTL_6715) in
                                                                    {7436}out(c, (enc(m2_6716,pkCli_6664),sign(h(m2_6716),skSess_6363)));
                                                                    {7437}let Ksrv_6717: bitstring = h((Ns_6713,Nc_6712)) in
                                                                    {7438}out(c, senc(mSrv(pkCli_6664,pkSess_6364),Ksrv_6717))
                                                    )
                                                    else
                                                        {7439}let pkDisco_6718: bitstring = fail-any in
                                                        {7440}in(c, (=pkCli_6664,em1_6719: bitstring,sigM1_6720: bitstring));
                                                        {7441}let m1_6721: bitstring = dec(em1_6719,skSess_6363) in
                                                        {7442}if (verify(h(m1_6721),sigM1_6720,pkCli_6664) <> true) then
                                                            0
                                                        else
                                                            {7443}let (=OpenSecureChannelRequest,=pkCli_6664,Nc_6722: bitstring) = m1_6721 in
                                                            {7444}new Ns_6723: bitstring;
                                                            {7445}new ST_6724: bitstring;
                                                            {7446}new TTL_6725: bitstring;
                                                            {7447}let m2_6726: bitstring = (OpenSecureChannelResponse,Ns_6723,ST_6724,TTL_6725) in
                                                            {7448}out(c, (enc(m2_6726,pkCli_6664),sign(h(m2_6726),skSess_6363)));
                                                            {7449}let Ksrv_6727: bitstring = h((Ns_6723,Nc_6722)) in
                                                            {7450}out(c, senc(mSrv(pkCli_6664,pkSess_6364),Ksrv_6727))
                                            )
                                            else
                                                {7451}let pkDisco_6728: bitstring = fail-any in
                                                {7452}in(c, (=pkCli_6664,em1_6729: bitstring,sigM1_6730: bitstring));
                                                {7453}let m1_6731: bitstring = dec(em1_6729,skSess_6363) in
                                                {7454}if (verify(h(m1_6731),sigM1_6730,pkCli_6664) <> true) then
                                                    0
                                                else
                                                    {7455}let (=OpenSecureChannelRequest,=pkCli_6664,Nc_6732: bitstring) = m1_6731 in
                                                    {7456}new Ns_6733: bitstring;
                                                    {7457}new ST_6734: bitstring;
                                                    {7458}new TTL_6735: bitstring;
                                                    {7459}let m2_6736: bitstring = (OpenSecureChannelResponse,Ns_6733,ST_6734,TTL_6735) in
                                                    {7460}out(c, (enc(m2_6736,pkCli_6664),sign(h(m2_6736),skSess_6363)));
                                                    {7461}let Ksrv_6737: bitstring = h((Ns_6733,Nc_6732)) in
                                                    {7462}out(c, senc(mSrv(pkCli_6664,pkSess_6364),Ksrv_6737))
                                )
                                else
                                    {7463}let pkCli_6738: bitstring = fail-any in
                                    {7464}let v_6739: bool = (Disco_5317 = A) in
                                    (
                                        {7465}if v_6739 then
                                        (
                                            {7466}let pkDisco_6740: bitstring = pub(skA) in
                                            {7467}in(c, (=pkCli_6738,em1_6741: bitstring,sigM1_6742: bitstring));
                                            {7468}let m1_6743: bitstring = dec(em1_6741,skSess_6363) in
                                            {7469}if (verify(h(m1_6743),sigM1_6742,pkCli_6738) <> true) then
                                                0
                                            else
                                                {7470}let (=OpenSecureChannelRequest,=pkCli_6738,Nc_6744: bitstring) = m1_6743 in
                                                {7471}new Ns_6745: bitstring;
                                                {7472}new ST_6746: bitstring;
                                                {7473}new TTL_6747: bitstring;
                                                {7474}let m2_6748: bitstring = (OpenSecureChannelResponse,Ns_6745,ST_6746,TTL_6747) in
                                                {7475}out(c, (enc(m2_6748,pkCli_6738),sign(h(m2_6748),skSess_6363)));
                                                {7476}let Ksrv_6749: bitstring = h((Ns_6745,Nc_6744)) in
                                                {7477}out(c, senc(mSrv(pkCli_6738,pkSess_6364),Ksrv_6749))
                                        )
                                        else
                                            {7478}let v_6750: bool = (Disco_5317 = B) in
                                            (
                                                {7479}if v_6750 then
                                                (
                                                    {7480}let pkDisco_6751: bitstring = pub(skB) in
                                                    {7481}in(c, (=pkCli_6738,em1_6752: bitstring,sigM1_6753: bitstring));
                                                    {7482}let m1_6754: bitstring = dec(em1_6752,skSess_6363) in
                                                    {7483}if (verify(h(m1_6754),sigM1_6753,pkCli_6738) <> true) then
                                                        0
                                                    else
                                                        {7484}let (=OpenSecureChannelRequest,=pkCli_6738,Nc_6755: bitstring) = m1_6754 in
                                                        {7485}new Ns_6756: bitstring;
                                                        {7486}new ST_6757: bitstring;
                                                        {7487}new TTL_6758: bitstring;
                                                        {7488}let m2_6759: bitstring = (OpenSecureChannelResponse,Ns_6756,ST_6757,TTL_6758) in
                                                        {7489}out(c, (enc(m2_6759,pkCli_6738),sign(h(m2_6759),skSess_6363)));
                                                        {7490}let Ksrv_6760: bitstring = h((Ns_6756,Nc_6755)) in
                                                        {7491}out(c, senc(mSrv(pkCli_6738,pkSess_6364),Ksrv_6760))
                                                )
                                                else
                                                    {7492}let v_6761: bool = (Disco_5317 = C) in
                                                    (
                                                        {7493}if v_6761 then
                                                        (
                                                            {7494}let pkDisco_6762: bitstring = pub(skC) in
                                                            {7495}in(c, (=pkCli_6738,em1_6763: bitstring,sigM1_6764: bitstring));
                                                            {7496}let m1_6765: bitstring = dec(em1_6763,skSess_6363) in
                                                            {7497}if (verify(h(m1_6765),sigM1_6764,pkCli_6738) <> true) then
                                                                0
                                                            else
                                                                {7498}let (=OpenSecureChannelRequest,=pkCli_6738,Nc_6766: bitstring) = m1_6765 in
                                                                {7499}new Ns_6767: bitstring;
                                                                {7500}new ST_6768: bitstring;
                                                                {7501}new TTL_6769: bitstring;
                                                                {7502}let m2_6770: bitstring = (OpenSecureChannelResponse,Ns_6767,ST_6768,TTL_6769) in
                                                                {7503}out(c, (enc(m2_6770,pkCli_6738),sign(h(m2_6770),skSess_6363)));
                                                                {7504}let Ksrv_6771: bitstring = h((Ns_6767,Nc_6766)) in
                                                                {7505}out(c, senc(mSrv(pkCli_6738,pkSess_6364),Ksrv_6771))
                                                        )
                                                        else
                                                            {7506}let pkDisco_6772: bitstring = pub(sk(Disco_5317)) in
                                                            {7507}in(c, (=pkCli_6738,em1_6773: bitstring,sigM1_6774: bitstring));
                                                            {7508}let m1_6775: bitstring = dec(em1_6773,skSess_6363) in
                                                            {7509}if (verify(h(m1_6775),sigM1_6774,pkCli_6738) <> true) then
                                                                0
                                                            else
                                                                {7510}let (=OpenSecureChannelRequest,=pkCli_6738,Nc_6776: bitstring) = m1_6775 in
                                                                {7511}new Ns_6777: bitstring;
                                                                {7512}new ST_6778: bitstring;
                                                                {7513}new TTL_6779: bitstring;
                                                                {7514}let m2_6780: bitstring = (OpenSecureChannelResponse,Ns_6777,ST_6778,TTL_6779) in
                                                                {7515}out(c, (enc(m2_6780,pkCli_6738),sign(h(m2_6780),skSess_6363)));
                                                                {7516}let Ksrv_6781: bitstring = h((Ns_6777,Nc_6776)) in
                                                                {7517}out(c, senc(mSrv(pkCli_6738,pkSess_6364),Ksrv_6781))
                                                    )
                                                    else
                                                        {7518}let pkDisco_6782: bitstring = fail-any in
                                                        {7519}in(c, (=pkCli_6738,em1_6783: bitstring,sigM1_6784: bitstring));
                                                        {7520}let m1_6785: bitstring = dec(em1_6783,skSess_6363) in
                                                        {7521}if (verify(h(m1_6785),sigM1_6784,pkCli_6738) <> true) then
                                                            0
                                                        else
                                                            {7522}let (=OpenSecureChannelRequest,=pkCli_6738,Nc_6786: bitstring) = m1_6785 in
                                                            {7523}new Ns_6787: bitstring;
                                                            {7524}new ST_6788: bitstring;
                                                            {7525}new TTL_6789: bitstring;
                                                            {7526}let m2_6790: bitstring = (OpenSecureChannelResponse,Ns_6787,ST_6788,TTL_6789) in
                                                            {7527}out(c, (enc(m2_6790,pkCli_6738),sign(h(m2_6790),skSess_6363)));
                                                            {7528}let Ksrv_6791: bitstring = h((Ns_6787,Nc_6786)) in
                                                            {7529}out(c, senc(mSrv(pkCli_6738,pkSess_6364),Ksrv_6791))
                                            )
                                            else
                                                {7530}let pkDisco_6792: bitstring = fail-any in
                                                {7531}in(c, (=pkCli_6738,em1_6793: bitstring,sigM1_6794: bitstring));
                                                {7532}let m1_6795: bitstring = dec(em1_6793,skSess_6363) in
                                                {7533}if (verify(h(m1_6795),sigM1_6794,pkCli_6738) <> true) then
                                                    0
                                                else
                                                    {7534}let (=OpenSecureChannelRequest,=pkCli_6738,Nc_6796: bitstring) = m1_6795 in
                                                    {7535}new Ns_6797: bitstring;
                                                    {7536}new ST_6798: bitstring;
                                                    {7537}new TTL_6799: bitstring;
                                                    {7538}let m2_6800: bitstring = (OpenSecureChannelResponse,Ns_6797,ST_6798,TTL_6799) in
                                                    {7539}out(c, (enc(m2_6800,pkCli_6738),sign(h(m2_6800),skSess_6363)));
                                                    {7540}let Ksrv_6801: bitstring = h((Ns_6797,Nc_6796)) in
                                                    {7541}out(c, senc(mSrv(pkCli_6738,pkSess_6364),Ksrv_6801))
                                    )
                                    else
                                        {7542}let pkDisco_6802: bitstring = fail-any in
                                        {7543}in(c, (=pkCli_6738,em1_6803: bitstring,sigM1_6804: bitstring));
                                        {7544}let m1_6805: bitstring = dec(em1_6803,skSess_6363) in
                                        {7545}if (verify(h(m1_6805),sigM1_6804,pkCli_6738) <> true) then
                                            0
                                        else
                                            {7546}let (=OpenSecureChannelRequest,=pkCli_6738,Nc_6806: bitstring) = m1_6805 in
                                            {7547}new Ns_6807: bitstring;
                                            {7548}new ST_6808: bitstring;
                                            {7549}new TTL_6809: bitstring;
                                            {7550}let m2_6810: bitstring = (OpenSecureChannelResponse,Ns_6807,ST_6808,TTL_6809) in
                                            {7551}out(c, (enc(m2_6810,pkCli_6738),sign(h(m2_6810),skSess_6363)));
                                            {7552}let Ksrv_6811: bitstring = h((Ns_6807,Nc_6806)) in
                                            {7553}out(c, senc(mSrv(pkCli_6738,pkSess_6364),Ksrv_6811))
                        )
                        else
                            {7554}let pkCli_6812: bitstring = fail-any in
                            {7555}let v_6813: bool = (Disco_5317 = A) in
                            (
                                {7556}if v_6813 then
                                (
                                    {7557}let pkDisco_6814: bitstring = pub(skA) in
                                    {7558}in(c, (=pkCli_6812,em1_6815: bitstring,sigM1_6816: bitstring));
                                    {7559}let m1_6817: bitstring = dec(em1_6815,skSess_6363) in
                                    {7560}if (verify(h(m1_6817),sigM1_6816,pkCli_6812) <> true) then
                                        0
                                    else
                                        {7561}let (=OpenSecureChannelRequest,=pkCli_6812,Nc_6818: bitstring) = m1_6817 in
                                        {7562}new Ns_6819: bitstring;
                                        {7563}new ST_6820: bitstring;
                                        {7564}new TTL_6821: bitstring;
                                        {7565}let m2_6822: bitstring = (OpenSecureChannelResponse,Ns_6819,ST_6820,TTL_6821) in
                                        {7566}out(c, (enc(m2_6822,pkCli_6812),sign(h(m2_6822),skSess_6363)));
                                        {7567}let Ksrv_6823: bitstring = h((Ns_6819,Nc_6818)) in
                                        {7568}out(c, senc(mSrv(pkCli_6812,pkSess_6364),Ksrv_6823))
                                )
                                else
                                    {7569}let v_6824: bool = (Disco_5317 = B) in
                                    (
                                        {7570}if v_6824 then
                                        (
                                            {7571}let pkDisco_6825: bitstring = pub(skB) in
                                            {7572}in(c, (=pkCli_6812,em1_6826: bitstring,sigM1_6827: bitstring));
                                            {7573}let m1_6828: bitstring = dec(em1_6826,skSess_6363) in
                                            {7574}if (verify(h(m1_6828),sigM1_6827,pkCli_6812) <> true) then
                                                0
                                            else
                                                {7575}let (=OpenSecureChannelRequest,=pkCli_6812,Nc_6829: bitstring) = m1_6828 in
                                                {7576}new Ns_6830: bitstring;
                                                {7577}new ST_6831: bitstring;
                                                {7578}new TTL_6832: bitstring;
                                                {7579}let m2_6833: bitstring = (OpenSecureChannelResponse,Ns_6830,ST_6831,TTL_6832) in
                                                {7580}out(c, (enc(m2_6833,pkCli_6812),sign(h(m2_6833),skSess_6363)));
                                                {7581}let Ksrv_6834: bitstring = h((Ns_6830,Nc_6829)) in
                                                {7582}out(c, senc(mSrv(pkCli_6812,pkSess_6364),Ksrv_6834))
                                        )
                                        else
                                            {7583}let v_6835: bool = (Disco_5317 = C) in
                                            (
                                                {7584}if v_6835 then
                                                (
                                                    {7585}let pkDisco_6836: bitstring = pub(skC) in
                                                    {7586}in(c, (=pkCli_6812,em1_6837: bitstring,sigM1_6838: bitstring));
                                                    {7587}let m1_6839: bitstring = dec(em1_6837,skSess_6363) in
                                                    {7588}if (verify(h(m1_6839),sigM1_6838,pkCli_6812) <> true) then
                                                        0
                                                    else
                                                        {7589}let (=OpenSecureChannelRequest,=pkCli_6812,Nc_6840: bitstring) = m1_6839 in
                                                        {7590}new Ns_6841: bitstring;
                                                        {7591}new ST_6842: bitstring;
                                                        {7592}new TTL_6843: bitstring;
                                                        {7593}let m2_6844: bitstring = (OpenSecureChannelResponse,Ns_6841,ST_6842,TTL_6843) in
                                                        {7594}out(c, (enc(m2_6844,pkCli_6812),sign(h(m2_6844),skSess_6363)));
                                                        {7595}let Ksrv_6845: bitstring = h((Ns_6841,Nc_6840)) in
                                                        {7596}out(c, senc(mSrv(pkCli_6812,pkSess_6364),Ksrv_6845))
                                                )
                                                else
                                                    {7597}let pkDisco_6846: bitstring = pub(sk(Disco_5317)) in
                                                    {7598}in(c, (=pkCli_6812,em1_6847: bitstring,sigM1_6848: bitstring));
                                                    {7599}let m1_6849: bitstring = dec(em1_6847,skSess_6363) in
                                                    {7600}if (verify(h(m1_6849),sigM1_6848,pkCli_6812) <> true) then
                                                        0
                                                    else
                                                        {7601}let (=OpenSecureChannelRequest,=pkCli_6812,Nc_6850: bitstring) = m1_6849 in
                                                        {7602}new Ns_6851: bitstring;
                                                        {7603}new ST_6852: bitstring;
                                                        {7604}new TTL_6853: bitstring;
                                                        {7605}let m2_6854: bitstring = (OpenSecureChannelResponse,Ns_6851,ST_6852,TTL_6853) in
                                                        {7606}out(c, (enc(m2_6854,pkCli_6812),sign(h(m2_6854),skSess_6363)));
                                                        {7607}let Ksrv_6855: bitstring = h((Ns_6851,Nc_6850)) in
                                                        {7608}out(c, senc(mSrv(pkCli_6812,pkSess_6364),Ksrv_6855))
                                            )
                                            else
                                                {7609}let pkDisco_6856: bitstring = fail-any in
                                                {7610}in(c, (=pkCli_6812,em1_6857: bitstring,sigM1_6858: bitstring));
                                                {7611}let m1_6859: bitstring = dec(em1_6857,skSess_6363) in
                                                {7612}if (verify(h(m1_6859),sigM1_6858,pkCli_6812) <> true) then
                                                    0
                                                else
                                                    {7613}let (=OpenSecureChannelRequest,=pkCli_6812,Nc_6860: bitstring) = m1_6859 in
                                                    {7614}new Ns_6861: bitstring;
                                                    {7615}new ST_6862: bitstring;
                                                    {7616}new TTL_6863: bitstring;
                                                    {7617}let m2_6864: bitstring = (OpenSecureChannelResponse,Ns_6861,ST_6862,TTL_6863) in
                                                    {7618}out(c, (enc(m2_6864,pkCli_6812),sign(h(m2_6864),skSess_6363)));
                                                    {7619}let Ksrv_6865: bitstring = h((Ns_6861,Nc_6860)) in
                                                    {7620}out(c, senc(mSrv(pkCli_6812,pkSess_6364),Ksrv_6865))
                                    )
                                    else
                                        {7621}let pkDisco_6866: bitstring = fail-any in
                                        {7622}in(c, (=pkCli_6812,em1_6867: bitstring,sigM1_6868: bitstring));
                                        {7623}let m1_6869: bitstring = dec(em1_6867,skSess_6363) in
                                        {7624}if (verify(h(m1_6869),sigM1_6868,pkCli_6812) <> true) then
                                            0
                                        else
                                            {7625}let (=OpenSecureChannelRequest,=pkCli_6812,Nc_6870: bitstring) = m1_6869 in
                                            {7626}new Ns_6871: bitstring;
                                            {7627}new ST_6872: bitstring;
                                            {7628}new TTL_6873: bitstring;
                                            {7629}let m2_6874: bitstring = (OpenSecureChannelResponse,Ns_6871,ST_6872,TTL_6873) in
                                            {7630}out(c, (enc(m2_6874,pkCli_6812),sign(h(m2_6874),skSess_6363)));
                                            {7631}let Ksrv_6875: bitstring = h((Ns_6871,Nc_6870)) in
                                            {7632}out(c, senc(mSrv(pkCli_6812,pkSess_6364),Ksrv_6875))
                            )
                            else
                                {7633}let pkDisco_6876: bitstring = fail-any in
                                {7634}in(c, (=pkCli_6812,em1_6877: bitstring,sigM1_6878: bitstring));
                                {7635}let m1_6879: bitstring = dec(em1_6877,skSess_6363) in
                                {7636}if (verify(h(m1_6879),sigM1_6878,pkCli_6812) <> true) then
                                    0
                                else
                                    {7637}let (=OpenSecureChannelRequest,=pkCli_6812,Nc_6880: bitstring) = m1_6879 in
                                    {7638}new Ns_6881: bitstring;
                                    {7639}new ST_6882: bitstring;
                                    {7640}new TTL_6883: bitstring;
                                    {7641}let m2_6884: bitstring = (OpenSecureChannelResponse,Ns_6881,ST_6882,TTL_6883) in
                                    {7642}out(c, (enc(m2_6884,pkCli_6812),sign(h(m2_6884),skSess_6363)));
                                    {7643}let Ksrv_6885: bitstring = h((Ns_6881,Nc_6880)) in
                                    {7644}out(c, senc(mSrv(pkCli_6812,pkSess_6364),Ksrv_6885))
                    )
                    else
                        {7645}let skSess_6886: bitstring = fail-any in
                        {7646}let pkSess_6887: bitstring = pub(skSess_6886) in
                        {7647}let v_6888: bool = (Cli_5316 = A) in
                        (
                            {7648}if v_6888 then
                            (
                                {7649}let pkCli_6889: bitstring = pub(skA) in
                                {7650}let v_6890: bool = (Disco_5317 = A) in
                                (
                                    {7651}if v_6890 then
                                    (
                                        {7652}let pkDisco_6891: bitstring = pub(skA) in
                                        {7653}in(c, (=pkCli_6889,em1_6892: bitstring,sigM1_6893: bitstring));
                                        {7654}let m1_6894: bitstring = dec(em1_6892,skSess_6886) in
                                        {7655}if (verify(h(m1_6894),sigM1_6893,pkCli_6889) <> true) then
                                            0
                                        else
                                            {7656}let (=OpenSecureChannelRequest,=pkCli_6889,Nc_6895: bitstring) = m1_6894 in
                                            {7657}new Ns_6896: bitstring;
                                            {7658}new ST_6897: bitstring;
                                            {7659}new TTL_6898: bitstring;
                                            {7660}let m2_6899: bitstring = (OpenSecureChannelResponse,Ns_6896,ST_6897,TTL_6898) in
                                            {7661}out(c, (enc(m2_6899,pkCli_6889),sign(h(m2_6899),skSess_6886)));
                                            {7662}let Ksrv_6900: bitstring = h((Ns_6896,Nc_6895)) in
                                            {7663}out(c, senc(mSrv(pkCli_6889,pkSess_6887),Ksrv_6900))
                                    )
                                    else
                                        {7664}let v_6901: bool = (Disco_5317 = B) in
                                        (
                                            {7665}if v_6901 then
                                            (
                                                {7666}let pkDisco_6902: bitstring = pub(skB) in
                                                {7667}in(c, (=pkCli_6889,em1_6903: bitstring,sigM1_6904: bitstring));
                                                {7668}let m1_6905: bitstring = dec(em1_6903,skSess_6886) in
                                                {7669}if (verify(h(m1_6905),sigM1_6904,pkCli_6889) <> true) then
                                                    0
                                                else
                                                    {7670}let (=OpenSecureChannelRequest,=pkCli_6889,Nc_6906: bitstring) = m1_6905 in
                                                    {7671}new Ns_6907: bitstring;
                                                    {7672}new ST_6908: bitstring;
                                                    {7673}new TTL_6909: bitstring;
                                                    {7674}let m2_6910: bitstring = (OpenSecureChannelResponse,Ns_6907,ST_6908,TTL_6909) in
                                                    {7675}out(c, (enc(m2_6910,pkCli_6889),sign(h(m2_6910),skSess_6886)));
                                                    {7676}let Ksrv_6911: bitstring = h((Ns_6907,Nc_6906)) in
                                                    {7677}out(c, senc(mSrv(pkCli_6889,pkSess_6887),Ksrv_6911))
                                            )
                                            else
                                                {7678}let v_6912: bool = (Disco_5317 = C) in
                                                (
                                                    {7679}if v_6912 then
                                                    (
                                                        {7680}let pkDisco_6913: bitstring = pub(skC) in
                                                        {7681}in(c, (=pkCli_6889,em1_6914: bitstring,sigM1_6915: bitstring));
                                                        {7682}let m1_6916: bitstring = dec(em1_6914,skSess_6886) in
                                                        {7683}if (verify(h(m1_6916),sigM1_6915,pkCli_6889) <> true) then
                                                            0
                                                        else
                                                            {7684}let (=OpenSecureChannelRequest,=pkCli_6889,Nc_6917: bitstring) = m1_6916 in
                                                            {7685}new Ns_6918: bitstring;
                                                            {7686}new ST_6919: bitstring;
                                                            {7687}new TTL_6920: bitstring;
                                                            {7688}let m2_6921: bitstring = (OpenSecureChannelResponse,Ns_6918,ST_6919,TTL_6920) in
                                                            {7689}out(c, (enc(m2_6921,pkCli_6889),sign(h(m2_6921),skSess_6886)));
                                                            {7690}let Ksrv_6922: bitstring = h((Ns_6918,Nc_6917)) in
                                                            {7691}out(c, senc(mSrv(pkCli_6889,pkSess_6887),Ksrv_6922))
                                                    )
                                                    else
                                                        {7692}let pkDisco_6923: bitstring = pub(sk(Disco_5317)) in
                                                        {7693}in(c, (=pkCli_6889,em1_6924: bitstring,sigM1_6925: bitstring));
                                                        {7694}let m1_6926: bitstring = dec(em1_6924,skSess_6886) in
                                                        {7695}if (verify(h(m1_6926),sigM1_6925,pkCli_6889) <> true) then
                                                            0
                                                        else
                                                            {7696}let (=OpenSecureChannelRequest,=pkCli_6889,Nc_6927: bitstring) = m1_6926 in
                                                            {7697}new Ns_6928: bitstring;
                                                            {7698}new ST_6929: bitstring;
                                                            {7699}new TTL_6930: bitstring;
                                                            {7700}let m2_6931: bitstring = (OpenSecureChannelResponse,Ns_6928,ST_6929,TTL_6930) in
                                                            {7701}out(c, (enc(m2_6931,pkCli_6889),sign(h(m2_6931),skSess_6886)));
                                                            {7702}let Ksrv_6932: bitstring = h((Ns_6928,Nc_6927)) in
                                                            {7703}out(c, senc(mSrv(pkCli_6889,pkSess_6887),Ksrv_6932))
                                                )
                                                else
                                                    {7704}let pkDisco_6933: bitstring = fail-any in
                                                    {7705}in(c, (=pkCli_6889,em1_6934: bitstring,sigM1_6935: bitstring));
                                                    {7706}let m1_6936: bitstring = dec(em1_6934,skSess_6886) in
                                                    {7707}if (verify(h(m1_6936),sigM1_6935,pkCli_6889) <> true) then
                                                        0
                                                    else
                                                        {7708}let (=OpenSecureChannelRequest,=pkCli_6889,Nc_6937: bitstring) = m1_6936 in
                                                        {7709}new Ns_6938: bitstring;
                                                        {7710}new ST_6939: bitstring;
                                                        {7711}new TTL_6940: bitstring;
                                                        {7712}let m2_6941: bitstring = (OpenSecureChannelResponse,Ns_6938,ST_6939,TTL_6940) in
                                                        {7713}out(c, (enc(m2_6941,pkCli_6889),sign(h(m2_6941),skSess_6886)));
                                                        {7714}let Ksrv_6942: bitstring = h((Ns_6938,Nc_6937)) in
                                                        {7715}out(c, senc(mSrv(pkCli_6889,pkSess_6887),Ksrv_6942))
                                        )
                                        else
                                            {7716}let pkDisco_6943: bitstring = fail-any in
                                            {7717}in(c, (=pkCli_6889,em1_6944: bitstring,sigM1_6945: bitstring));
                                            {7718}let m1_6946: bitstring = dec(em1_6944,skSess_6886) in
                                            {7719}if (verify(h(m1_6946),sigM1_6945,pkCli_6889) <> true) then
                                                0
                                            else
                                                {7720}let (=OpenSecureChannelRequest,=pkCli_6889,Nc_6947: bitstring) = m1_6946 in
                                                {7721}new Ns_6948: bitstring;
                                                {7722}new ST_6949: bitstring;
                                                {7723}new TTL_6950: bitstring;
                                                {7724}let m2_6951: bitstring = (OpenSecureChannelResponse,Ns_6948,ST_6949,TTL_6950) in
                                                {7725}out(c, (enc(m2_6951,pkCli_6889),sign(h(m2_6951),skSess_6886)));
                                                {7726}let Ksrv_6952: bitstring = h((Ns_6948,Nc_6947)) in
                                                {7727}out(c, senc(mSrv(pkCli_6889,pkSess_6887),Ksrv_6952))
                                )
                                else
                                    {7728}let pkDisco_6953: bitstring = fail-any in
                                    {7729}in(c, (=pkCli_6889,em1_6954: bitstring,sigM1_6955: bitstring));
                                    {7730}let m1_6956: bitstring = dec(em1_6954,skSess_6886) in
                                    {7731}if (verify(h(m1_6956),sigM1_6955,pkCli_6889) <> true) then
                                        0
                                    else
                                        {7732}let (=OpenSecureChannelRequest,=pkCli_6889,Nc_6957: bitstring) = m1_6956 in
                                        {7733}new Ns_6958: bitstring;
                                        {7734}new ST_6959: bitstring;
                                        {7735}new TTL_6960: bitstring;
                                        {7736}let m2_6961: bitstring = (OpenSecureChannelResponse,Ns_6958,ST_6959,TTL_6960) in
                                        {7737}out(c, (enc(m2_6961,pkCli_6889),sign(h(m2_6961),skSess_6886)));
                                        {7738}let Ksrv_6962: bitstring = h((Ns_6958,Nc_6957)) in
                                        {7739}out(c, senc(mSrv(pkCli_6889,pkSess_6887),Ksrv_6962))
                            )
                            else
                                {7740}let v_6963: bool = (Cli_5316 = B) in
                                (
                                    {7741}if v_6963 then
                                    (
                                        {7742}let pkCli_6964: bitstring = pub(skB) in
                                        {7743}let v_6965: bool = (Disco_5317 = A) in
                                        (
                                            {7744}if v_6965 then
                                            (
                                                {7745}let pkDisco_6966: bitstring = pub(skA) in
                                                {7746}in(c, (=pkCli_6964,em1_6967: bitstring,sigM1_6968: bitstring));
                                                {7747}let m1_6969: bitstring = dec(em1_6967,skSess_6886) in
                                                {7748}if (verify(h(m1_6969),sigM1_6968,pkCli_6964) <> true) then
                                                    0
                                                else
                                                    {7749}let (=OpenSecureChannelRequest,=pkCli_6964,Nc_6970: bitstring) = m1_6969 in
                                                    {7750}new Ns_6971: bitstring;
                                                    {7751}new ST_6972: bitstring;
                                                    {7752}new TTL_6973: bitstring;
                                                    {7753}let m2_6974: bitstring = (OpenSecureChannelResponse,Ns_6971,ST_6972,TTL_6973) in
                                                    {7754}out(c, (enc(m2_6974,pkCli_6964),sign(h(m2_6974),skSess_6886)));
                                                    {7755}let Ksrv_6975: bitstring = h((Ns_6971,Nc_6970)) in
                                                    {7756}out(c, senc(mSrv(pkCli_6964,pkSess_6887),Ksrv_6975))
                                            )
                                            else
                                                {7757}let v_6976: bool = (Disco_5317 = B) in
                                                (
                                                    {7758}if v_6976 then
                                                    (
                                                        {7759}let pkDisco_6977: bitstring = pub(skB) in
                                                        {7760}in(c, (=pkCli_6964,em1_6978: bitstring,sigM1_6979: bitstring));
                                                        {7761}let m1_6980: bitstring = dec(em1_6978,skSess_6886) in
                                                        {7762}if (verify(h(m1_6980),sigM1_6979,pkCli_6964) <> true) then
                                                            0
                                                        else
                                                            {7763}let (=OpenSecureChannelRequest,=pkCli_6964,Nc_6981: bitstring) = m1_6980 in
                                                            {7764}new Ns_6982: bitstring;
                                                            {7765}new ST_6983: bitstring;
                                                            {7766}new TTL_6984: bitstring;
                                                            {7767}let m2_6985: bitstring = (OpenSecureChannelResponse,Ns_6982,ST_6983,TTL_6984) in
                                                            {7768}out(c, (enc(m2_6985,pkCli_6964),sign(h(m2_6985),skSess_6886)));
                                                            {7769}let Ksrv_6986: bitstring = h((Ns_6982,Nc_6981)) in
                                                            {7770}out(c, senc(mSrv(pkCli_6964,pkSess_6887),Ksrv_6986))
                                                    )
                                                    else
                                                        {7771}let v_6987: bool = (Disco_5317 = C) in
                                                        (
                                                            {7772}if v_6987 then
                                                            (
                                                                {7773}let pkDisco_6988: bitstring = pub(skC) in
                                                                {7774}in(c, (=pkCli_6964,em1_6989: bitstring,sigM1_6990: bitstring));
                                                                {7775}let m1_6991: bitstring = dec(em1_6989,skSess_6886) in
                                                                {7776}if (verify(h(m1_6991),sigM1_6990,pkCli_6964) <> true) then
                                                                    0
                                                                else
                                                                    {7777}let (=OpenSecureChannelRequest,=pkCli_6964,Nc_6992: bitstring) = m1_6991 in
                                                                    {7778}new Ns_6993: bitstring;
                                                                    {7779}new ST_6994: bitstring;
                                                                    {7780}new TTL_6995: bitstring;
                                                                    {7781}let m2_6996: bitstring = (OpenSecureChannelResponse,Ns_6993,ST_6994,TTL_6995) in
                                                                    {7782}out(c, (enc(m2_6996,pkCli_6964),sign(h(m2_6996),skSess_6886)));
                                                                    {7783}let Ksrv_6997: bitstring = h((Ns_6993,Nc_6992)) in
                                                                    {7784}out(c, senc(mSrv(pkCli_6964,pkSess_6887),Ksrv_6997))
                                                            )
                                                            else
                                                                {7785}let pkDisco_6998: bitstring = pub(sk(Disco_5317)) in
                                                                {7786}in(c, (=pkCli_6964,em1_6999: bitstring,sigM1_7000: bitstring));
                                                                {7787}let m1_7001: bitstring = dec(em1_6999,skSess_6886) in
                                                                {7788}if (verify(h(m1_7001),sigM1_7000,pkCli_6964) <> true) then
                                                                    0
                                                                else
                                                                    {7789}let (=OpenSecureChannelRequest,=pkCli_6964,Nc_7002: bitstring) = m1_7001 in
                                                                    {7790}new Ns_7003: bitstring;
                                                                    {7791}new ST_7004: bitstring;
                                                                    {7792}new TTL_7005: bitstring;
                                                                    {7793}let m2_7006: bitstring = (OpenSecureChannelResponse,Ns_7003,ST_7004,TTL_7005) in
                                                                    {7794}out(c, (enc(m2_7006,pkCli_6964),sign(h(m2_7006),skSess_6886)));
                                                                    {7795}let Ksrv_7007: bitstring = h((Ns_7003,Nc_7002)) in
                                                                    {7796}out(c, senc(mSrv(pkCli_6964,pkSess_6887),Ksrv_7007))
                                                        )
                                                        else
                                                            {7797}let pkDisco_7008: bitstring = fail-any in
                                                            {7798}in(c, (=pkCli_6964,em1_7009: bitstring,sigM1_7010: bitstring));
                                                            {7799}let m1_7011: bitstring = dec(em1_7009,skSess_6886) in
                                                            {7800}if (verify(h(m1_7011),sigM1_7010,pkCli_6964) <> true) then
                                                                0
                                                            else
                                                                {7801}let (=OpenSecureChannelRequest,=pkCli_6964,Nc_7012: bitstring) = m1_7011 in
                                                                {7802}new Ns_7013: bitstring;
                                                                {7803}new ST_7014: bitstring;
                                                                {7804}new TTL_7015: bitstring;
                                                                {7805}let m2_7016: bitstring = (OpenSecureChannelResponse,Ns_7013,ST_7014,TTL_7015) in
                                                                {7806}out(c, (enc(m2_7016,pkCli_6964),sign(h(m2_7016),skSess_6886)));
                                                                {7807}let Ksrv_7017: bitstring = h((Ns_7013,Nc_7012)) in
                                                                {7808}out(c, senc(mSrv(pkCli_6964,pkSess_6887),Ksrv_7017))
                                                )
                                                else
                                                    {7809}let pkDisco_7018: bitstring = fail-any in
                                                    {7810}in(c, (=pkCli_6964,em1_7019: bitstring,sigM1_7020: bitstring));
                                                    {7811}let m1_7021: bitstring = dec(em1_7019,skSess_6886) in
                                                    {7812}if (verify(h(m1_7021),sigM1_7020,pkCli_6964) <> true) then
                                                        0
                                                    else
                                                        {7813}let (=OpenSecureChannelRequest,=pkCli_6964,Nc_7022: bitstring) = m1_7021 in
                                                        {7814}new Ns_7023: bitstring;
                                                        {7815}new ST_7024: bitstring;
                                                        {7816}new TTL_7025: bitstring;
                                                        {7817}let m2_7026: bitstring = (OpenSecureChannelResponse,Ns_7023,ST_7024,TTL_7025) in
                                                        {7818}out(c, (enc(m2_7026,pkCli_6964),sign(h(m2_7026),skSess_6886)));
                                                        {7819}let Ksrv_7027: bitstring = h((Ns_7023,Nc_7022)) in
                                                        {7820}out(c, senc(mSrv(pkCli_6964,pkSess_6887),Ksrv_7027))
                                        )
                                        else
                                            {7821}let pkDisco_7028: bitstring = fail-any in
                                            {7822}in(c, (=pkCli_6964,em1_7029: bitstring,sigM1_7030: bitstring));
                                            {7823}let m1_7031: bitstring = dec(em1_7029,skSess_6886) in
                                            {7824}if (verify(h(m1_7031),sigM1_7030,pkCli_6964) <> true) then
                                                0
                                            else
                                                {7825}let (=OpenSecureChannelRequest,=pkCli_6964,Nc_7032: bitstring) = m1_7031 in
                                                {7826}new Ns_7033: bitstring;
                                                {7827}new ST_7034: bitstring;
                                                {7828}new TTL_7035: bitstring;
                                                {7829}let m2_7036: bitstring = (OpenSecureChannelResponse,Ns_7033,ST_7034,TTL_7035) in
                                                {7830}out(c, (enc(m2_7036,pkCli_6964),sign(h(m2_7036),skSess_6886)));
                                                {7831}let Ksrv_7037: bitstring = h((Ns_7033,Nc_7032)) in
                                                {7832}out(c, senc(mSrv(pkCli_6964,pkSess_6887),Ksrv_7037))
                                    )
                                    else
                                        {7833}let v_7038: bool = (Cli_5316 = C) in
                                        (
                                            {7834}if v_7038 then
                                            (
                                                {7835}let pkCli_7039: bitstring = pub(skC) in
                                                {7836}let v_7040: bool = (Disco_5317 = A) in
                                                (
                                                    {7837}if v_7040 then
                                                    (
                                                        {7838}let pkDisco_7041: bitstring = pub(skA) in
                                                        {7839}in(c, (=pkCli_7039,em1_7042: bitstring,sigM1_7043: bitstring));
                                                        {7840}let m1_7044: bitstring = dec(em1_7042,skSess_6886) in
                                                        {7841}if (verify(h(m1_7044),sigM1_7043,pkCli_7039) <> true) then
                                                            0
                                                        else
                                                            {7842}let (=OpenSecureChannelRequest,=pkCli_7039,Nc_7045: bitstring) = m1_7044 in
                                                            {7843}new Ns_7046: bitstring;
                                                            {7844}new ST_7047: bitstring;
                                                            {7845}new TTL_7048: bitstring;
                                                            {7846}let m2_7049: bitstring = (OpenSecureChannelResponse,Ns_7046,ST_7047,TTL_7048) in
                                                            {7847}out(c, (enc(m2_7049,pkCli_7039),sign(h(m2_7049),skSess_6886)));
                                                            {7848}let Ksrv_7050: bitstring = h((Ns_7046,Nc_7045)) in
                                                            {7849}out(c, senc(mSrv(pkCli_7039,pkSess_6887),Ksrv_7050))
                                                    )
                                                    else
                                                        {7850}let v_7051: bool = (Disco_5317 = B) in
                                                        (
                                                            {7851}if v_7051 then
                                                            (
                                                                {7852}let pkDisco_7052: bitstring = pub(skB) in
                                                                {7853}in(c, (=pkCli_7039,em1_7053: bitstring,sigM1_7054: bitstring));
                                                                {7854}let m1_7055: bitstring = dec(em1_7053,skSess_6886) in
                                                                {7855}if (verify(h(m1_7055),sigM1_7054,pkCli_7039) <> true) then
                                                                    0
                                                                else
                                                                    {7856}let (=OpenSecureChannelRequest,=pkCli_7039,Nc_7056: bitstring) = m1_7055 in
                                                                    {7857}new Ns_7057: bitstring;
                                                                    {7858}new ST_7058: bitstring;
                                                                    {7859}new TTL_7059: bitstring;
                                                                    {7860}let m2_7060: bitstring = (OpenSecureChannelResponse,Ns_7057,ST_7058,TTL_7059) in
                                                                    {7861}out(c, (enc(m2_7060,pkCli_7039),sign(h(m2_7060),skSess_6886)));
                                                                    {7862}let Ksrv_7061: bitstring = h((Ns_7057,Nc_7056)) in
                                                                    {7863}out(c, senc(mSrv(pkCli_7039,pkSess_6887),Ksrv_7061))
                                                            )
                                                            else
                                                                {7864}let v_7062: bool = (Disco_5317 = C) in
                                                                (
                                                                    {7865}if v_7062 then
                                                                    (
                                                                        {7866}let pkDisco_7063: bitstring = pub(skC) in
                                                                        {7867}in(c, (=pkCli_7039,em1_7064: bitstring,sigM1_7065: bitstring));
                                                                        {7868}let m1_7066: bitstring = dec(em1_7064,skSess_6886) in
                                                                        {7869}if (verify(h(m1_7066),sigM1_7065,pkCli_7039) <> true) then
                                                                            0
                                                                        else
                                                                            {7870}let (=OpenSecureChannelRequest,=pkCli_7039,Nc_7067: bitstring) = m1_7066 in
                                                                            {7871}new Ns_7068: bitstring;
                                                                            {7872}new ST_7069: bitstring;
                                                                            {7873}new TTL_7070: bitstring;
                                                                            {7874}let m2_7071: bitstring = (OpenSecureChannelResponse,Ns_7068,ST_7069,TTL_7070) in
                                                                            {7875}out(c, (enc(m2_7071,pkCli_7039),sign(h(m2_7071),skSess_6886)));
                                                                            {7876}let Ksrv_7072: bitstring = h((Ns_7068,Nc_7067)) in
                                                                            {7877}out(c, senc(mSrv(pkCli_7039,pkSess_6887),Ksrv_7072))
                                                                    )
                                                                    else
                                                                        {7878}let pkDisco_7073: bitstring = pub(sk(Disco_5317)) in
                                                                        {7879}in(c, (=pkCli_7039,em1_7074: bitstring,sigM1_7075: bitstring));
                                                                        {7880}let m1_7076: bitstring = dec(em1_7074,skSess_6886) in
                                                                        {7881}if (verify(h(m1_7076),sigM1_7075,pkCli_7039) <> true) then
                                                                            0
                                                                        else
                                                                            {7882}let (=OpenSecureChannelRequest,=pkCli_7039,Nc_7077: bitstring) = m1_7076 in
                                                                            {7883}new Ns_7078: bitstring;
                                                                            {7884}new ST_7079: bitstring;
                                                                            {7885}new TTL_7080: bitstring;
                                                                            {7886}let m2_7081: bitstring = (OpenSecureChannelResponse,Ns_7078,ST_7079,TTL_7080) in
                                                                            {7887}out(c, (enc(m2_7081,pkCli_7039),sign(h(m2_7081),skSess_6886)));
                                                                            {7888}let Ksrv_7082: bitstring = h((Ns_7078,Nc_7077)) in
                                                                            {7889}out(c, senc(mSrv(pkCli_7039,pkSess_6887),Ksrv_7082))
                                                                )
                                                                else
                                                                    {7890}let pkDisco_7083: bitstring = fail-any in
                                                                    {7891}in(c, (=pkCli_7039,em1_7084: bitstring,sigM1_7085: bitstring));
                                                                    {7892}let m1_7086: bitstring = dec(em1_7084,skSess_6886) in
                                                                    {7893}if (verify(h(m1_7086),sigM1_7085,pkCli_7039) <> true) then
                                                                        0
                                                                    else
                                                                        {7894}let (=OpenSecureChannelRequest,=pkCli_7039,Nc_7087: bitstring) = m1_7086 in
                                                                        {7895}new Ns_7088: bitstring;
                                                                        {7896}new ST_7089: bitstring;
                                                                        {7897}new TTL_7090: bitstring;
                                                                        {7898}let m2_7091: bitstring = (OpenSecureChannelResponse,Ns_7088,ST_7089,TTL_7090) in
                                                                        {7899}out(c, (enc(m2_7091,pkCli_7039),sign(h(m2_7091),skSess_6886)));
                                                                        {7900}let Ksrv_7092: bitstring = h((Ns_7088,Nc_7087)) in
                                                                        {7901}out(c, senc(mSrv(pkCli_7039,pkSess_6887),Ksrv_7092))
                                                        )
                                                        else
                                                            {7902}let pkDisco_7093: bitstring = fail-any in
                                                            {7903}in(c, (=pkCli_7039,em1_7094: bitstring,sigM1_7095: bitstring));
                                                            {7904}let m1_7096: bitstring = dec(em1_7094,skSess_6886) in
                                                            {7905}if (verify(h(m1_7096),sigM1_7095,pkCli_7039) <> true) then
                                                                0
                                                            else
                                                                {7906}let (=OpenSecureChannelRequest,=pkCli_7039,Nc_7097: bitstring) = m1_7096 in
                                                                {7907}new Ns_7098: bitstring;
                                                                {7908}new ST_7099: bitstring;
                                                                {7909}new TTL_7100: bitstring;
                                                                {7910}let m2_7101: bitstring = (OpenSecureChannelResponse,Ns_7098,ST_7099,TTL_7100) in
                                                                {7911}out(c, (enc(m2_7101,pkCli_7039),sign(h(m2_7101),skSess_6886)));
                                                                {7912}let Ksrv_7102: bitstring = h((Ns_7098,Nc_7097)) in
                                                                {7913}out(c, senc(mSrv(pkCli_7039,pkSess_6887),Ksrv_7102))
                                                )
                                                else
                                                    {7914}let pkDisco_7103: bitstring = fail-any in
                                                    {7915}in(c, (=pkCli_7039,em1_7104: bitstring,sigM1_7105: bitstring));
                                                    {7916}let m1_7106: bitstring = dec(em1_7104,skSess_6886) in
                                                    {7917}if (verify(h(m1_7106),sigM1_7105,pkCli_7039) <> true) then
                                                        0
                                                    else
                                                        {7918}let (=OpenSecureChannelRequest,=pkCli_7039,Nc_7107: bitstring) = m1_7106 in
                                                        {7919}new Ns_7108: bitstring;
                                                        {7920}new ST_7109: bitstring;
                                                        {7921}new TTL_7110: bitstring;
                                                        {7922}let m2_7111: bitstring = (OpenSecureChannelResponse,Ns_7108,ST_7109,TTL_7110) in
                                                        {7923}out(c, (enc(m2_7111,pkCli_7039),sign(h(m2_7111),skSess_6886)));
                                                        {7924}let Ksrv_7112: bitstring = h((Ns_7108,Nc_7107)) in
                                                        {7925}out(c, senc(mSrv(pkCli_7039,pkSess_6887),Ksrv_7112))
                                            )
                                            else
                                                {7926}let pkCli_7113: bitstring = pub(sk(Cli_5316)) in
                                                {7927}let v_7114: bool = (Disco_5317 = A) in
                                                (
                                                    {7928}if v_7114 then
                                                    (
                                                        {7929}let pkDisco_7115: bitstring = pub(skA) in
                                                        {7930}in(c, (=pkCli_7113,em1_7116: bitstring,sigM1_7117: bitstring));
                                                        {7931}let m1_7118: bitstring = dec(em1_7116,skSess_6886) in
                                                        {7932}if (verify(h(m1_7118),sigM1_7117,pkCli_7113) <> true) then
                                                            0
                                                        else
                                                            {7933}let (=OpenSecureChannelRequest,=pkCli_7113,Nc_7119: bitstring) = m1_7118 in
                                                            {7934}new Ns_7120: bitstring;
                                                            {7935}new ST_7121: bitstring;
                                                            {7936}new TTL_7122: bitstring;
                                                            {7937}let m2_7123: bitstring = (OpenSecureChannelResponse,Ns_7120,ST_7121,TTL_7122) in
                                                            {7938}out(c, (enc(m2_7123,pkCli_7113),sign(h(m2_7123),skSess_6886)));
                                                            {7939}let Ksrv_7124: bitstring = h((Ns_7120,Nc_7119)) in
                                                            {7940}out(c, senc(mSrv(pkCli_7113,pkSess_6887),Ksrv_7124))
                                                    )
                                                    else
                                                        {7941}let v_7125: bool = (Disco_5317 = B) in
                                                        (
                                                            {7942}if v_7125 then
                                                            (
                                                                {7943}let pkDisco_7126: bitstring = pub(skB) in
                                                                {7944}in(c, (=pkCli_7113,em1_7127: bitstring,sigM1_7128: bitstring));
                                                                {7945}let m1_7129: bitstring = dec(em1_7127,skSess_6886) in
                                                                {7946}if (verify(h(m1_7129),sigM1_7128,pkCli_7113) <> true) then
                                                                    0
                                                                else
                                                                    {7947}let (=OpenSecureChannelRequest,=pkCli_7113,Nc_7130: bitstring) = m1_7129 in
                                                                    {7948}new Ns_7131: bitstring;
                                                                    {7949}new ST_7132: bitstring;
                                                                    {7950}new TTL_7133: bitstring;
                                                                    {7951}let m2_7134: bitstring = (OpenSecureChannelResponse,Ns_7131,ST_7132,TTL_7133) in
                                                                    {7952}out(c, (enc(m2_7134,pkCli_7113),sign(h(m2_7134),skSess_6886)));
                                                                    {7953}let Ksrv_7135: bitstring = h((Ns_7131,Nc_7130)) in
                                                                    {7954}out(c, senc(mSrv(pkCli_7113,pkSess_6887),Ksrv_7135))
                                                            )
                                                            else
                                                                {7955}let v_7136: bool = (Disco_5317 = C) in
                                                                (
                                                                    {7956}if v_7136 then
                                                                    (
                                                                        {7957}let pkDisco_7137: bitstring = pub(skC) in
                                                                        {7958}in(c, (=pkCli_7113,em1_7138: bitstring,sigM1_7139: bitstring));
                                                                        {7959}let m1_7140: bitstring = dec(em1_7138,skSess_6886) in
                                                                        {7960}if (verify(h(m1_7140),sigM1_7139,pkCli_7113) <> true) then
                                                                            0
                                                                        else
                                                                            {7961}let (=OpenSecureChannelRequest,=pkCli_7113,Nc_7141: bitstring) = m1_7140 in
                                                                            {7962}new Ns_7142: bitstring;
                                                                            {7963}new ST_7143: bitstring;
                                                                            {7964}new TTL_7144: bitstring;
                                                                            {7965}let m2_7145: bitstring = (OpenSecureChannelResponse,Ns_7142,ST_7143,TTL_7144) in
                                                                            {7966}out(c, (enc(m2_7145,pkCli_7113),sign(h(m2_7145),skSess_6886)));
                                                                            {7967}let Ksrv_7146: bitstring = h((Ns_7142,Nc_7141)) in
                                                                            {7968}out(c, senc(mSrv(pkCli_7113,pkSess_6887),Ksrv_7146))
                                                                    )
                                                                    else
                                                                        {7969}let pkDisco_7147: bitstring = pub(sk(Disco_5317)) in
                                                                        {7970}in(c, (=pkCli_7113,em1_7148: bitstring,sigM1_7149: bitstring));
                                                                        {7971}let m1_7150: bitstring = dec(em1_7148,skSess_6886) in
                                                                        {7972}if (verify(h(m1_7150),sigM1_7149,pkCli_7113) <> true) then
                                                                            0
                                                                        else
                                                                            {7973}let (=OpenSecureChannelRequest,=pkCli_7113,Nc_7151: bitstring) = m1_7150 in
                                                                            {7974}new Ns_7152: bitstring;
                                                                            {7975}new ST_7153: bitstring;
                                                                            {7976}new TTL_7154: bitstring;
                                                                            {7977}let m2_7155: bitstring = (OpenSecureChannelResponse,Ns_7152,ST_7153,TTL_7154) in
                                                                            {7978}out(c, (enc(m2_7155,pkCli_7113),sign(h(m2_7155),skSess_6886)));
                                                                            {7979}let Ksrv_7156: bitstring = h((Ns_7152,Nc_7151)) in
                                                                            {7980}out(c, senc(mSrv(pkCli_7113,pkSess_6887),Ksrv_7156))
                                                                )
                                                                else
                                                                    {7981}let pkDisco_7157: bitstring = fail-any in
                                                                    {7982}in(c, (=pkCli_7113,em1_7158: bitstring,sigM1_7159: bitstring));
                                                                    {7983}let m1_7160: bitstring = dec(em1_7158,skSess_6886) in
                                                                    {7984}if (verify(h(m1_7160),sigM1_7159,pkCli_7113) <> true) then
                                                                        0
                                                                    else
                                                                        {7985}let (=OpenSecureChannelRequest,=pkCli_7113,Nc_7161: bitstring) = m1_7160 in
                                                                        {7986}new Ns_7162: bitstring;
                                                                        {7987}new ST_7163: bitstring;
                                                                        {7988}new TTL_7164: bitstring;
                                                                        {7989}let m2_7165: bitstring = (OpenSecureChannelResponse,Ns_7162,ST_7163,TTL_7164) in
                                                                        {7990}out(c, (enc(m2_7165,pkCli_7113),sign(h(m2_7165),skSess_6886)));
                                                                        {7991}let Ksrv_7166: bitstring = h((Ns_7162,Nc_7161)) in
                                                                        {7992}out(c, senc(mSrv(pkCli_7113,pkSess_6887),Ksrv_7166))
                                                        )
                                                        else
                                                            {7993}let pkDisco_7167: bitstring = fail-any in
                                                            {7994}in(c, (=pkCli_7113,em1_7168: bitstring,sigM1_7169: bitstring));
                                                            {7995}let m1_7170: bitstring = dec(em1_7168,skSess_6886) in
                                                            {7996}if (verify(h(m1_7170),sigM1_7169,pkCli_7113) <> true) then
                                                                0
                                                            else
                                                                {7997}let (=OpenSecureChannelRequest,=pkCli_7113,Nc_7171: bitstring) = m1_7170 in
                                                                {7998}new Ns_7172: bitstring;
                                                                {7999}new ST_7173: bitstring;
                                                                {8000}new TTL_7174: bitstring;
                                                                {8001}let m2_7175: bitstring = (OpenSecureChannelResponse,Ns_7172,ST_7173,TTL_7174) in
                                                                {8002}out(c, (enc(m2_7175,pkCli_7113),sign(h(m2_7175),skSess_6886)));
                                                                {8003}let Ksrv_7176: bitstring = h((Ns_7172,Nc_7171)) in
                                                                {8004}out(c, senc(mSrv(pkCli_7113,pkSess_6887),Ksrv_7176))
                                                )
                                                else
                                                    {8005}let pkDisco_7177: bitstring = fail-any in
                                                    {8006}in(c, (=pkCli_7113,em1_7178: bitstring,sigM1_7179: bitstring));
                                                    {8007}let m1_7180: bitstring = dec(em1_7178,skSess_6886) in
                                                    {8008}if (verify(h(m1_7180),sigM1_7179,pkCli_7113) <> true) then
                                                        0
                                                    else
                                                        {8009}let (=OpenSecureChannelRequest,=pkCli_7113,Nc_7181: bitstring) = m1_7180 in
                                                        {8010}new Ns_7182: bitstring;
                                                        {8011}new ST_7183: bitstring;
                                                        {8012}new TTL_7184: bitstring;
                                                        {8013}let m2_7185: bitstring = (OpenSecureChannelResponse,Ns_7182,ST_7183,TTL_7184) in
                                                        {8014}out(c, (enc(m2_7185,pkCli_7113),sign(h(m2_7185),skSess_6886)));
                                                        {8015}let Ksrv_7186: bitstring = h((Ns_7182,Nc_7181)) in
                                                        {8016}out(c, senc(mSrv(pkCli_7113,pkSess_6887),Ksrv_7186))
                                        )
                                        else
                                            {8017}let pkCli_7187: bitstring = fail-any in
                                            {8018}let v_7188: bool = (Disco_5317 = A) in
                                            (
                                                {8019}if v_7188 then
                                                (
                                                    {8020}let pkDisco_7189: bitstring = pub(skA) in
                                                    {8021}in(c, (=pkCli_7187,em1_7190: bitstring,sigM1_7191: bitstring));
                                                    {8022}let m1_7192: bitstring = dec(em1_7190,skSess_6886) in
                                                    {8023}if (verify(h(m1_7192),sigM1_7191,pkCli_7187) <> true) then
                                                        0
                                                    else
                                                        {8024}let (=OpenSecureChannelRequest,=pkCli_7187,Nc_7193: bitstring) = m1_7192 in
                                                        {8025}new Ns_7194: bitstring;
                                                        {8026}new ST_7195: bitstring;
                                                        {8027}new TTL_7196: bitstring;
                                                        {8028}let m2_7197: bitstring = (OpenSecureChannelResponse,Ns_7194,ST_7195,TTL_7196) in
                                                        {8029}out(c, (enc(m2_7197,pkCli_7187),sign(h(m2_7197),skSess_6886)));
                                                        {8030}let Ksrv_7198: bitstring = h((Ns_7194,Nc_7193)) in
                                                        {8031}out(c, senc(mSrv(pkCli_7187,pkSess_6887),Ksrv_7198))
                                                )
                                                else
                                                    {8032}let v_7199: bool = (Disco_5317 = B) in
                                                    (
                                                        {8033}if v_7199 then
                                                        (
                                                            {8034}let pkDisco_7200: bitstring = pub(skB) in
                                                            {8035}in(c, (=pkCli_7187,em1_7201: bitstring,sigM1_7202: bitstring));
                                                            {8036}let m1_7203: bitstring = dec(em1_7201,skSess_6886) in
                                                            {8037}if (verify(h(m1_7203),sigM1_7202,pkCli_7187) <> true) then
                                                                0
                                                            else
                                                                {8038}let (=OpenSecureChannelRequest,=pkCli_7187,Nc_7204: bitstring) = m1_7203 in
                                                                {8039}new Ns_7205: bitstring;
                                                                {8040}new ST_7206: bitstring;
                                                                {8041}new TTL_7207: bitstring;
                                                                {8042}let m2_7208: bitstring = (OpenSecureChannelResponse,Ns_7205,ST_7206,TTL_7207) in
                                                                {8043}out(c, (enc(m2_7208,pkCli_7187),sign(h(m2_7208),skSess_6886)));
                                                                {8044}let Ksrv_7209: bitstring = h((Ns_7205,Nc_7204)) in
                                                                {8045}out(c, senc(mSrv(pkCli_7187,pkSess_6887),Ksrv_7209))
                                                        )
                                                        else
                                                            {8046}let v_7210: bool = (Disco_5317 = C) in
                                                            (
                                                                {8047}if v_7210 then
                                                                (
                                                                    {8048}let pkDisco_7211: bitstring = pub(skC) in
                                                                    {8049}in(c, (=pkCli_7187,em1_7212: bitstring,sigM1_7213: bitstring));
                                                                    {8050}let m1_7214: bitstring = dec(em1_7212,skSess_6886) in
                                                                    {8051}if (verify(h(m1_7214),sigM1_7213,pkCli_7187) <> true) then
                                                                        0
                                                                    else
                                                                        {8052}let (=OpenSecureChannelRequest,=pkCli_7187,Nc_7215: bitstring) = m1_7214 in
                                                                        {8053}new Ns_7216: bitstring;
                                                                        {8054}new ST_7217: bitstring;
                                                                        {8055}new TTL_7218: bitstring;
                                                                        {8056}let m2_7219: bitstring = (OpenSecureChannelResponse,Ns_7216,ST_7217,TTL_7218) in
                                                                        {8057}out(c, (enc(m2_7219,pkCli_7187),sign(h(m2_7219),skSess_6886)));
                                                                        {8058}let Ksrv_7220: bitstring = h((Ns_7216,Nc_7215)) in
                                                                        {8059}out(c, senc(mSrv(pkCli_7187,pkSess_6887),Ksrv_7220))
                                                                )
                                                                else
                                                                    {8060}let pkDisco_7221: bitstring = pub(sk(Disco_5317)) in
                                                                    {8061}in(c, (=pkCli_7187,em1_7222: bitstring,sigM1_7223: bitstring));
                                                                    {8062}let m1_7224: bitstring = dec(em1_7222,skSess_6886) in
                                                                    {8063}if (verify(h(m1_7224),sigM1_7223,pkCli_7187) <> true) then
                                                                        0
                                                                    else
                                                                        {8064}let (=OpenSecureChannelRequest,=pkCli_7187,Nc_7225: bitstring) = m1_7224 in
                                                                        {8065}new Ns_7226: bitstring;
                                                                        {8066}new ST_7227: bitstring;
                                                                        {8067}new TTL_7228: bitstring;
                                                                        {8068}let m2_7229: bitstring = (OpenSecureChannelResponse,Ns_7226,ST_7227,TTL_7228) in
                                                                        {8069}out(c, (enc(m2_7229,pkCli_7187),sign(h(m2_7229),skSess_6886)));
                                                                        {8070}let Ksrv_7230: bitstring = h((Ns_7226,Nc_7225)) in
                                                                        {8071}out(c, senc(mSrv(pkCli_7187,pkSess_6887),Ksrv_7230))
                                                            )
                                                            else
                                                                {8072}let pkDisco_7231: bitstring = fail-any in
                                                                {8073}in(c, (=pkCli_7187,em1_7232: bitstring,sigM1_7233: bitstring));
                                                                {8074}let m1_7234: bitstring = dec(em1_7232,skSess_6886) in
                                                                {8075}if (verify(h(m1_7234),sigM1_7233,pkCli_7187) <> true) then
                                                                    0
                                                                else
                                                                    {8076}let (=OpenSecureChannelRequest,=pkCli_7187,Nc_7235: bitstring) = m1_7234 in
                                                                    {8077}new Ns_7236: bitstring;
                                                                    {8078}new ST_7237: bitstring;
                                                                    {8079}new TTL_7238: bitstring;
                                                                    {8080}let m2_7239: bitstring = (OpenSecureChannelResponse,Ns_7236,ST_7237,TTL_7238) in
                                                                    {8081}out(c, (enc(m2_7239,pkCli_7187),sign(h(m2_7239),skSess_6886)));
                                                                    {8082}let Ksrv_7240: bitstring = h((Ns_7236,Nc_7235)) in
                                                                    {8083}out(c, senc(mSrv(pkCli_7187,pkSess_6887),Ksrv_7240))
                                                    )
                                                    else
                                                        {8084}let pkDisco_7241: bitstring = fail-any in
                                                        {8085}in(c, (=pkCli_7187,em1_7242: bitstring,sigM1_7243: bitstring));
                                                        {8086}let m1_7244: bitstring = dec(em1_7242,skSess_6886) in
                                                        {8087}if (verify(h(m1_7244),sigM1_7243,pkCli_7187) <> true) then
                                                            0
                                                        else
                                                            {8088}let (=OpenSecureChannelRequest,=pkCli_7187,Nc_7245: bitstring) = m1_7244 in
                                                            {8089}new Ns_7246: bitstring;
                                                            {8090}new ST_7247: bitstring;
                                                            {8091}new TTL_7248: bitstring;
                                                            {8092}let m2_7249: bitstring = (OpenSecureChannelResponse,Ns_7246,ST_7247,TTL_7248) in
                                                            {8093}out(c, (enc(m2_7249,pkCli_7187),sign(h(m2_7249),skSess_6886)));
                                                            {8094}let Ksrv_7250: bitstring = h((Ns_7246,Nc_7245)) in
                                                            {8095}out(c, senc(mSrv(pkCli_7187,pkSess_6887),Ksrv_7250))
                                            )
                                            else
                                                {8096}let pkDisco_7251: bitstring = fail-any in
                                                {8097}in(c, (=pkCli_7187,em1_7252: bitstring,sigM1_7253: bitstring));
                                                {8098}let m1_7254: bitstring = dec(em1_7252,skSess_6886) in
                                                {8099}if (verify(h(m1_7254),sigM1_7253,pkCli_7187) <> true) then
                                                    0
                                                else
                                                    {8100}let (=OpenSecureChannelRequest,=pkCli_7187,Nc_7255: bitstring) = m1_7254 in
                                                    {8101}new Ns_7256: bitstring;
                                                    {8102}new ST_7257: bitstring;
                                                    {8103}new TTL_7258: bitstring;
                                                    {8104}let m2_7259: bitstring = (OpenSecureChannelResponse,Ns_7256,ST_7257,TTL_7258) in
                                                    {8105}out(c, (enc(m2_7259,pkCli_7187),sign(h(m2_7259),skSess_6886)));
                                                    {8106}let Ksrv_7260: bitstring = h((Ns_7256,Nc_7255)) in
                                                    {8107}out(c, senc(mSrv(pkCli_7187,pkSess_6887),Ksrv_7260))
                                )
                                else
                                    {8108}let pkCli_7261: bitstring = fail-any in
                                    {8109}let v_7262: bool = (Disco_5317 = A) in
                                    (
                                        {8110}if v_7262 then
                                        (
                                            {8111}let pkDisco_7263: bitstring = pub(skA) in
                                            {8112}in(c, (=pkCli_7261,em1_7264: bitstring,sigM1_7265: bitstring));
                                            {8113}let m1_7266: bitstring = dec(em1_7264,skSess_6886) in
                                            {8114}if (verify(h(m1_7266),sigM1_7265,pkCli_7261) <> true) then
                                                0
                                            else
                                                {8115}let (=OpenSecureChannelRequest,=pkCli_7261,Nc_7267: bitstring) = m1_7266 in
                                                {8116}new Ns_7268: bitstring;
                                                {8117}new ST_7269: bitstring;
                                                {8118}new TTL_7270: bitstring;
                                                {8119}let m2_7271: bitstring = (OpenSecureChannelResponse,Ns_7268,ST_7269,TTL_7270) in
                                                {8120}out(c, (enc(m2_7271,pkCli_7261),sign(h(m2_7271),skSess_6886)));
                                                {8121}let Ksrv_7272: bitstring = h((Ns_7268,Nc_7267)) in
                                                {8122}out(c, senc(mSrv(pkCli_7261,pkSess_6887),Ksrv_7272))
                                        )
                                        else
                                            {8123}let v_7273: bool = (Disco_5317 = B) in
                                            (
                                                {8124}if v_7273 then
                                                (
                                                    {8125}let pkDisco_7274: bitstring = pub(skB) in
                                                    {8126}in(c, (=pkCli_7261,em1_7275: bitstring,sigM1_7276: bitstring));
                                                    {8127}let m1_7277: bitstring = dec(em1_7275,skSess_6886) in
                                                    {8128}if (verify(h(m1_7277),sigM1_7276,pkCli_7261) <> true) then
                                                        0
                                                    else
                                                        {8129}let (=OpenSecureChannelRequest,=pkCli_7261,Nc_7278: bitstring) = m1_7277 in
                                                        {8130}new Ns_7279: bitstring;
                                                        {8131}new ST_7280: bitstring;
                                                        {8132}new TTL_7281: bitstring;
                                                        {8133}let m2_7282: bitstring = (OpenSecureChannelResponse,Ns_7279,ST_7280,TTL_7281) in
                                                        {8134}out(c, (enc(m2_7282,pkCli_7261),sign(h(m2_7282),skSess_6886)));
                                                        {8135}let Ksrv_7283: bitstring = h((Ns_7279,Nc_7278)) in
                                                        {8136}out(c, senc(mSrv(pkCli_7261,pkSess_6887),Ksrv_7283))
                                                )
                                                else
                                                    {8137}let v_7284: bool = (Disco_5317 = C) in
                                                    (
                                                        {8138}if v_7284 then
                                                        (
                                                            {8139}let pkDisco_7285: bitstring = pub(skC) in
                                                            {8140}in(c, (=pkCli_7261,em1_7286: bitstring,sigM1_7287: bitstring));
                                                            {8141}let m1_7288: bitstring = dec(em1_7286,skSess_6886) in
                                                            {8142}if (verify(h(m1_7288),sigM1_7287,pkCli_7261) <> true) then
                                                                0
                                                            else
                                                                {8143}let (=OpenSecureChannelRequest,=pkCli_7261,Nc_7289: bitstring) = m1_7288 in
                                                                {8144}new Ns_7290: bitstring;
                                                                {8145}new ST_7291: bitstring;
                                                                {8146}new TTL_7292: bitstring;
                                                                {8147}let m2_7293: bitstring = (OpenSecureChannelResponse,Ns_7290,ST_7291,TTL_7292) in
                                                                {8148}out(c, (enc(m2_7293,pkCli_7261),sign(h(m2_7293),skSess_6886)));
                                                                {8149}let Ksrv_7294: bitstring = h((Ns_7290,Nc_7289)) in
                                                                {8150}out(c, senc(mSrv(pkCli_7261,pkSess_6887),Ksrv_7294))
                                                        )
                                                        else
                                                            {8151}let pkDisco_7295: bitstring = pub(sk(Disco_5317)) in
                                                            {8152}in(c, (=pkCli_7261,em1_7296: bitstring,sigM1_7297: bitstring));
                                                            {8153}let m1_7298: bitstring = dec(em1_7296,skSess_6886) in
                                                            {8154}if (verify(h(m1_7298),sigM1_7297,pkCli_7261) <> true) then
                                                                0
                                                            else
                                                                {8155}let (=OpenSecureChannelRequest,=pkCli_7261,Nc_7299: bitstring) = m1_7298 in
                                                                {8156}new Ns_7300: bitstring;
                                                                {8157}new ST_7301: bitstring;
                                                                {8158}new TTL_7302: bitstring;
                                                                {8159}let m2_7303: bitstring = (OpenSecureChannelResponse,Ns_7300,ST_7301,TTL_7302) in
                                                                {8160}out(c, (enc(m2_7303,pkCli_7261),sign(h(m2_7303),skSess_6886)));
                                                                {8161}let Ksrv_7304: bitstring = h((Ns_7300,Nc_7299)) in
                                                                {8162}out(c, senc(mSrv(pkCli_7261,pkSess_6887),Ksrv_7304))
                                                    )
                                                    else
                                                        {8163}let pkDisco_7305: bitstring = fail-any in
                                                        {8164}in(c, (=pkCli_7261,em1_7306: bitstring,sigM1_7307: bitstring));
                                                        {8165}let m1_7308: bitstring = dec(em1_7306,skSess_6886) in
                                                        {8166}if (verify(h(m1_7308),sigM1_7307,pkCli_7261) <> true) then
                                                            0
                                                        else
                                                            {8167}let (=OpenSecureChannelRequest,=pkCli_7261,Nc_7309: bitstring) = m1_7308 in
                                                            {8168}new Ns_7310: bitstring;
                                                            {8169}new ST_7311: bitstring;
                                                            {8170}new TTL_7312: bitstring;
                                                            {8171}let m2_7313: bitstring = (OpenSecureChannelResponse,Ns_7310,ST_7311,TTL_7312) in
                                                            {8172}out(c, (enc(m2_7313,pkCli_7261),sign(h(m2_7313),skSess_6886)));
                                                            {8173}let Ksrv_7314: bitstring = h((Ns_7310,Nc_7309)) in
                                                            {8174}out(c, senc(mSrv(pkCli_7261,pkSess_6887),Ksrv_7314))
                                            )
                                            else
                                                {8175}let pkDisco_7315: bitstring = fail-any in
                                                {8176}in(c, (=pkCli_7261,em1_7316: bitstring,sigM1_7317: bitstring));
                                                {8177}let m1_7318: bitstring = dec(em1_7316,skSess_6886) in
                                                {8178}if (verify(h(m1_7318),sigM1_7317,pkCli_7261) <> true) then
                                                    0
                                                else
                                                    {8179}let (=OpenSecureChannelRequest,=pkCli_7261,Nc_7319: bitstring) = m1_7318 in
                                                    {8180}new Ns_7320: bitstring;
                                                    {8181}new ST_7321: bitstring;
                                                    {8182}new TTL_7322: bitstring;
                                                    {8183}let m2_7323: bitstring = (OpenSecureChannelResponse,Ns_7320,ST_7321,TTL_7322) in
                                                    {8184}out(c, (enc(m2_7323,pkCli_7261),sign(h(m2_7323),skSess_6886)));
                                                    {8185}let Ksrv_7324: bitstring = h((Ns_7320,Nc_7319)) in
                                                    {8186}out(c, senc(mSrv(pkCli_7261,pkSess_6887),Ksrv_7324))
                                    )
                                    else
                                        {8187}let pkDisco_7325: bitstring = fail-any in
                                        {8188}in(c, (=pkCli_7261,em1_7326: bitstring,sigM1_7327: bitstring));
                                        {8189}let m1_7328: bitstring = dec(em1_7326,skSess_6886) in
                                        {8190}if (verify(h(m1_7328),sigM1_7327,pkCli_7261) <> true) then
                                            0
                                        else
                                            {8191}let (=OpenSecureChannelRequest,=pkCli_7261,Nc_7329: bitstring) = m1_7328 in
                                            {8192}new Ns_7330: bitstring;
                                            {8193}new ST_7331: bitstring;
                                            {8194}new TTL_7332: bitstring;
                                            {8195}let m2_7333: bitstring = (OpenSecureChannelResponse,Ns_7330,ST_7331,TTL_7332) in
                                            {8196}out(c, (enc(m2_7333,pkCli_7261),sign(h(m2_7333),skSess_6886)));
                                            {8197}let Ksrv_7334: bitstring = h((Ns_7330,Nc_7329)) in
                                            {8198}out(c, senc(mSrv(pkCli_7261,pkSess_6887),Ksrv_7334))
                        )
                        else
                            {8199}let pkCli_7335: bitstring = fail-any in
                            {8200}let v_7336: bool = (Disco_5317 = A) in
                            (
                                {8201}if v_7336 then
                                (
                                    {8202}let pkDisco_7337: bitstring = pub(skA) in
                                    {8203}in(c, (=pkCli_7335,em1_7338: bitstring,sigM1_7339: bitstring));
                                    {8204}let m1_7340: bitstring = dec(em1_7338,skSess_6886) in
                                    {8205}if (verify(h(m1_7340),sigM1_7339,pkCli_7335) <> true) then
                                        0
                                    else
                                        {8206}let (=OpenSecureChannelRequest,=pkCli_7335,Nc_7341: bitstring) = m1_7340 in
                                        {8207}new Ns_7342: bitstring;
                                        {8208}new ST_7343: bitstring;
                                        {8209}new TTL_7344: bitstring;
                                        {8210}let m2_7345: bitstring = (OpenSecureChannelResponse,Ns_7342,ST_7343,TTL_7344) in
                                        {8211}out(c, (enc(m2_7345,pkCli_7335),sign(h(m2_7345),skSess_6886)));
                                        {8212}let Ksrv_7346: bitstring = h((Ns_7342,Nc_7341)) in
                                        {8213}out(c, senc(mSrv(pkCli_7335,pkSess_6887),Ksrv_7346))
                                )
                                else
                                    {8214}let v_7347: bool = (Disco_5317 = B) in
                                    (
                                        {8215}if v_7347 then
                                        (
                                            {8216}let pkDisco_7348: bitstring = pub(skB) in
                                            {8217}in(c, (=pkCli_7335,em1_7349: bitstring,sigM1_7350: bitstring));
                                            {8218}let m1_7351: bitstring = dec(em1_7349,skSess_6886) in
                                            {8219}if (verify(h(m1_7351),sigM1_7350,pkCli_7335) <> true) then
                                                0
                                            else
                                                {8220}let (=OpenSecureChannelRequest,=pkCli_7335,Nc_7352: bitstring) = m1_7351 in
                                                {8221}new Ns_7353: bitstring;
                                                {8222}new ST_7354: bitstring;
                                                {8223}new TTL_7355: bitstring;
                                                {8224}let m2_7356: bitstring = (OpenSecureChannelResponse,Ns_7353,ST_7354,TTL_7355) in
                                                {8225}out(c, (enc(m2_7356,pkCli_7335),sign(h(m2_7356),skSess_6886)));
                                                {8226}let Ksrv_7357: bitstring = h((Ns_7353,Nc_7352)) in
                                                {8227}out(c, senc(mSrv(pkCli_7335,pkSess_6887),Ksrv_7357))
                                        )
                                        else
                                            {8228}let v_7358: bool = (Disco_5317 = C) in
                                            (
                                                {8229}if v_7358 then
                                                (
                                                    {8230}let pkDisco_7359: bitstring = pub(skC) in
                                                    {8231}in(c, (=pkCli_7335,em1_7360: bitstring,sigM1_7361: bitstring));
                                                    {8232}let m1_7362: bitstring = dec(em1_7360,skSess_6886) in
                                                    {8233}if (verify(h(m1_7362),sigM1_7361,pkCli_7335) <> true) then
                                                        0
                                                    else
                                                        {8234}let (=OpenSecureChannelRequest,=pkCli_7335,Nc_7363: bitstring) = m1_7362 in
                                                        {8235}new Ns_7364: bitstring;
                                                        {8236}new ST_7365: bitstring;
                                                        {8237}new TTL_7366: bitstring;
                                                        {8238}let m2_7367: bitstring = (OpenSecureChannelResponse,Ns_7364,ST_7365,TTL_7366) in
                                                        {8239}out(c, (enc(m2_7367,pkCli_7335),sign(h(m2_7367),skSess_6886)));
                                                        {8240}let Ksrv_7368: bitstring = h((Ns_7364,Nc_7363)) in
                                                        {8241}out(c, senc(mSrv(pkCli_7335,pkSess_6887),Ksrv_7368))
                                                )
                                                else
                                                    {8242}let pkDisco_7369: bitstring = pub(sk(Disco_5317)) in
                                                    {8243}in(c, (=pkCli_7335,em1_7370: bitstring,sigM1_7371: bitstring));
                                                    {8244}let m1_7372: bitstring = dec(em1_7370,skSess_6886) in
                                                    {8245}if (verify(h(m1_7372),sigM1_7371,pkCli_7335) <> true) then
                                                        0
                                                    else
                                                        {8246}let (=OpenSecureChannelRequest,=pkCli_7335,Nc_7373: bitstring) = m1_7372 in
                                                        {8247}new Ns_7374: bitstring;
                                                        {8248}new ST_7375: bitstring;
                                                        {8249}new TTL_7376: bitstring;
                                                        {8250}let m2_7377: bitstring = (OpenSecureChannelResponse,Ns_7374,ST_7375,TTL_7376) in
                                                        {8251}out(c, (enc(m2_7377,pkCli_7335),sign(h(m2_7377),skSess_6886)));
                                                        {8252}let Ksrv_7378: bitstring = h((Ns_7374,Nc_7373)) in
                                                        {8253}out(c, senc(mSrv(pkCli_7335,pkSess_6887),Ksrv_7378))
                                            )
                                            else
                                                {8254}let pkDisco_7379: bitstring = fail-any in
                                                {8255}in(c, (=pkCli_7335,em1_7380: bitstring,sigM1_7381: bitstring));
                                                {8256}let m1_7382: bitstring = dec(em1_7380,skSess_6886) in
                                                {8257}if (verify(h(m1_7382),sigM1_7381,pkCli_7335) <> true) then
                                                    0
                                                else
                                                    {8258}let (=OpenSecureChannelRequest,=pkCli_7335,Nc_7383: bitstring) = m1_7382 in
                                                    {8259}new Ns_7384: bitstring;
                                                    {8260}new ST_7385: bitstring;
                                                    {8261}new TTL_7386: bitstring;
                                                    {8262}let m2_7387: bitstring = (OpenSecureChannelResponse,Ns_7384,ST_7385,TTL_7386) in
                                                    {8263}out(c, (enc(m2_7387,pkCli_7335),sign(h(m2_7387),skSess_6886)));
                                                    {8264}let Ksrv_7388: bitstring = h((Ns_7384,Nc_7383)) in
                                                    {8265}out(c, senc(mSrv(pkCli_7335,pkSess_6887),Ksrv_7388))
                                    )
                                    else
                                        {8266}let pkDisco_7389: bitstring = fail-any in
                                        {8267}in(c, (=pkCli_7335,em1_7390: bitstring,sigM1_7391: bitstring));
                                        {8268}let m1_7392: bitstring = dec(em1_7390,skSess_6886) in
                                        {8269}if (verify(h(m1_7392),sigM1_7391,pkCli_7335) <> true) then
                                            0
                                        else
                                            {8270}let (=OpenSecureChannelRequest,=pkCli_7335,Nc_7393: bitstring) = m1_7392 in
                                            {8271}new Ns_7394: bitstring;
                                            {8272}new ST_7395: bitstring;
                                            {8273}new TTL_7396: bitstring;
                                            {8274}let m2_7397: bitstring = (OpenSecureChannelResponse,Ns_7394,ST_7395,TTL_7396) in
                                            {8275}out(c, (enc(m2_7397,pkCli_7335),sign(h(m2_7397),skSess_6886)));
                                            {8276}let Ksrv_7398: bitstring = h((Ns_7394,Nc_7393)) in
                                            {8277}out(c, senc(mSrv(pkCli_7335,pkSess_6887),Ksrv_7398))
                            )
                            else
                                {8278}let pkDisco_7399: bitstring = fail-any in
                                {8279}in(c, (=pkCli_7335,em1_7400: bitstring,sigM1_7401: bitstring));
                                {8280}let m1_7402: bitstring = dec(em1_7400,skSess_6886) in
                                {8281}if (verify(h(m1_7402),sigM1_7401,pkCli_7335) <> true) then
                                    0
                                else
                                    {8282}let (=OpenSecureChannelRequest,=pkCli_7335,Nc_7403: bitstring) = m1_7402 in
                                    {8283}new Ns_7404: bitstring;
                                    {8284}new ST_7405: bitstring;
                                    {8285}new TTL_7406: bitstring;
                                    {8286}let m2_7407: bitstring = (OpenSecureChannelResponse,Ns_7404,ST_7405,TTL_7406) in
                                    {8287}out(c, (enc(m2_7407,pkCli_7335),sign(h(m2_7407),skSess_6886)));
                                    {8288}let Ksrv_7408: bitstring = h((Ns_7404,Nc_7403)) in
                                    {8289}out(c, senc(mSrv(pkCli_7335,pkSess_6887),Ksrv_7408))
            )
            else
                {8290}let skSess_7409: bitstring = fail-any in
                {8291}let pkSess_7410: bitstring = pub(skSess_7409) in
                {8292}let v_7411: bool = (Cli_5316 = A) in
                (
                    {8293}if v_7411 then
                    (
                        {8294}let pkCli_7412: bitstring = pub(skA) in
                        {8295}let v_7413: bool = (Disco_5317 = A) in
                        (
                            {8296}if v_7413 then
                            (
                                {8297}let pkDisco_7414: bitstring = pub(skA) in
                                {8298}in(c, (=pkCli_7412,em1_7415: bitstring,sigM1_7416: bitstring));
                                {8299}let m1_7417: bitstring = dec(em1_7415,skSess_7409) in
                                {8300}if (verify(h(m1_7417),sigM1_7416,pkCli_7412) <> true) then
                                    0
                                else
                                    {8301}let (=OpenSecureChannelRequest,=pkCli_7412,Nc_7418: bitstring) = m1_7417 in
                                    {8302}new Ns_7419: bitstring;
                                    {8303}new ST_7420: bitstring;
                                    {8304}new TTL_7421: bitstring;
                                    {8305}let m2_7422: bitstring = (OpenSecureChannelResponse,Ns_7419,ST_7420,TTL_7421) in
                                    {8306}out(c, (enc(m2_7422,pkCli_7412),sign(h(m2_7422),skSess_7409)));
                                    {8307}let Ksrv_7423: bitstring = h((Ns_7419,Nc_7418)) in
                                    {8308}out(c, senc(mSrv(pkCli_7412,pkSess_7410),Ksrv_7423))
                            )
                            else
                                {8309}let v_7424: bool = (Disco_5317 = B) in
                                (
                                    {8310}if v_7424 then
                                    (
                                        {8311}let pkDisco_7425: bitstring = pub(skB) in
                                        {8312}in(c, (=pkCli_7412,em1_7426: bitstring,sigM1_7427: bitstring));
                                        {8313}let m1_7428: bitstring = dec(em1_7426,skSess_7409) in
                                        {8314}if (verify(h(m1_7428),sigM1_7427,pkCli_7412) <> true) then
                                            0
                                        else
                                            {8315}let (=OpenSecureChannelRequest,=pkCli_7412,Nc_7429: bitstring) = m1_7428 in
                                            {8316}new Ns_7430: bitstring;
                                            {8317}new ST_7431: bitstring;
                                            {8318}new TTL_7432: bitstring;
                                            {8319}let m2_7433: bitstring = (OpenSecureChannelResponse,Ns_7430,ST_7431,TTL_7432) in
                                            {8320}out(c, (enc(m2_7433,pkCli_7412),sign(h(m2_7433),skSess_7409)));
                                            {8321}let Ksrv_7434: bitstring = h((Ns_7430,Nc_7429)) in
                                            {8322}out(c, senc(mSrv(pkCli_7412,pkSess_7410),Ksrv_7434))
                                    )
                                    else
                                        {8323}let v_7435: bool = (Disco_5317 = C) in
                                        (
                                            {8324}if v_7435 then
                                            (
                                                {8325}let pkDisco_7436: bitstring = pub(skC) in
                                                {8326}in(c, (=pkCli_7412,em1_7437: bitstring,sigM1_7438: bitstring));
                                                {8327}let m1_7439: bitstring = dec(em1_7437,skSess_7409) in
                                                {8328}if (verify(h(m1_7439),sigM1_7438,pkCli_7412) <> true) then
                                                    0
                                                else
                                                    {8329}let (=OpenSecureChannelRequest,=pkCli_7412,Nc_7440: bitstring) = m1_7439 in
                                                    {8330}new Ns_7441: bitstring;
                                                    {8331}new ST_7442: bitstring;
                                                    {8332}new TTL_7443: bitstring;
                                                    {8333}let m2_7444: bitstring = (OpenSecureChannelResponse,Ns_7441,ST_7442,TTL_7443) in
                                                    {8334}out(c, (enc(m2_7444,pkCli_7412),sign(h(m2_7444),skSess_7409)));
                                                    {8335}let Ksrv_7445: bitstring = h((Ns_7441,Nc_7440)) in
                                                    {8336}out(c, senc(mSrv(pkCli_7412,pkSess_7410),Ksrv_7445))
                                            )
                                            else
                                                {8337}let pkDisco_7446: bitstring = pub(sk(Disco_5317)) in
                                                {8338}in(c, (=pkCli_7412,em1_7447: bitstring,sigM1_7448: bitstring));
                                                {8339}let m1_7449: bitstring = dec(em1_7447,skSess_7409) in
                                                {8340}if (verify(h(m1_7449),sigM1_7448,pkCli_7412) <> true) then
                                                    0
                                                else
                                                    {8341}let (=OpenSecureChannelRequest,=pkCli_7412,Nc_7450: bitstring) = m1_7449 in
                                                    {8342}new Ns_7451: bitstring;
                                                    {8343}new ST_7452: bitstring;
                                                    {8344}new TTL_7453: bitstring;
                                                    {8345}let m2_7454: bitstring = (OpenSecureChannelResponse,Ns_7451,ST_7452,TTL_7453) in
                                                    {8346}out(c, (enc(m2_7454,pkCli_7412),sign(h(m2_7454),skSess_7409)));
                                                    {8347}let Ksrv_7455: bitstring = h((Ns_7451,Nc_7450)) in
                                                    {8348}out(c, senc(mSrv(pkCli_7412,pkSess_7410),Ksrv_7455))
                                        )
                                        else
                                            {8349}let pkDisco_7456: bitstring = fail-any in
                                            {8350}in(c, (=pkCli_7412,em1_7457: bitstring,sigM1_7458: bitstring));
                                            {8351}let m1_7459: bitstring = dec(em1_7457,skSess_7409) in
                                            {8352}if (verify(h(m1_7459),sigM1_7458,pkCli_7412) <> true) then
                                                0
                                            else
                                                {8353}let (=OpenSecureChannelRequest,=pkCli_7412,Nc_7460: bitstring) = m1_7459 in
                                                {8354}new Ns_7461: bitstring;
                                                {8355}new ST_7462: bitstring;
                                                {8356}new TTL_7463: bitstring;
                                                {8357}let m2_7464: bitstring = (OpenSecureChannelResponse,Ns_7461,ST_7462,TTL_7463) in
                                                {8358}out(c, (enc(m2_7464,pkCli_7412),sign(h(m2_7464),skSess_7409)));
                                                {8359}let Ksrv_7465: bitstring = h((Ns_7461,Nc_7460)) in
                                                {8360}out(c, senc(mSrv(pkCli_7412,pkSess_7410),Ksrv_7465))
                                )
                                else
                                    {8361}let pkDisco_7466: bitstring = fail-any in
                                    {8362}in(c, (=pkCli_7412,em1_7467: bitstring,sigM1_7468: bitstring));
                                    {8363}let m1_7469: bitstring = dec(em1_7467,skSess_7409) in
                                    {8364}if (verify(h(m1_7469),sigM1_7468,pkCli_7412) <> true) then
                                        0
                                    else
                                        {8365}let (=OpenSecureChannelRequest,=pkCli_7412,Nc_7470: bitstring) = m1_7469 in
                                        {8366}new Ns_7471: bitstring;
                                        {8367}new ST_7472: bitstring;
                                        {8368}new TTL_7473: bitstring;
                                        {8369}let m2_7474: bitstring = (OpenSecureChannelResponse,Ns_7471,ST_7472,TTL_7473) in
                                        {8370}out(c, (enc(m2_7474,pkCli_7412),sign(h(m2_7474),skSess_7409)));
                                        {8371}let Ksrv_7475: bitstring = h((Ns_7471,Nc_7470)) in
                                        {8372}out(c, senc(mSrv(pkCli_7412,pkSess_7410),Ksrv_7475))
                        )
                        else
                            {8373}let pkDisco_7476: bitstring = fail-any in
                            {8374}in(c, (=pkCli_7412,em1_7477: bitstring,sigM1_7478: bitstring));
                            {8375}let m1_7479: bitstring = dec(em1_7477,skSess_7409) in
                            {8376}if (verify(h(m1_7479),sigM1_7478,pkCli_7412) <> true) then
                                0
                            else
                                {8377}let (=OpenSecureChannelRequest,=pkCli_7412,Nc_7480: bitstring) = m1_7479 in
                                {8378}new Ns_7481: bitstring;
                                {8379}new ST_7482: bitstring;
                                {8380}new TTL_7483: bitstring;
                                {8381}let m2_7484: bitstring = (OpenSecureChannelResponse,Ns_7481,ST_7482,TTL_7483) in
                                {8382}out(c, (enc(m2_7484,pkCli_7412),sign(h(m2_7484),skSess_7409)));
                                {8383}let Ksrv_7485: bitstring = h((Ns_7481,Nc_7480)) in
                                {8384}out(c, senc(mSrv(pkCli_7412,pkSess_7410),Ksrv_7485))
                    )
                    else
                        {8385}let v_7486: bool = (Cli_5316 = B) in
                        (
                            {8386}if v_7486 then
                            (
                                {8387}let pkCli_7487: bitstring = pub(skB) in
                                {8388}let v_7488: bool = (Disco_5317 = A) in
                                (
                                    {8389}if v_7488 then
                                    (
                                        {8390}let pkDisco_7489: bitstring = pub(skA) in
                                        {8391}in(c, (=pkCli_7487,em1_7490: bitstring,sigM1_7491: bitstring));
                                        {8392}let m1_7492: bitstring = dec(em1_7490,skSess_7409) in
                                        {8393}if (verify(h(m1_7492),sigM1_7491,pkCli_7487) <> true) then
                                            0
                                        else
                                            {8394}let (=OpenSecureChannelRequest,=pkCli_7487,Nc_7493: bitstring) = m1_7492 in
                                            {8395}new Ns_7494: bitstring;
                                            {8396}new ST_7495: bitstring;
                                            {8397}new TTL_7496: bitstring;
                                            {8398}let m2_7497: bitstring = (OpenSecureChannelResponse,Ns_7494,ST_7495,TTL_7496) in
                                            {8399}out(c, (enc(m2_7497,pkCli_7487),sign(h(m2_7497),skSess_7409)));
                                            {8400}let Ksrv_7498: bitstring = h((Ns_7494,Nc_7493)) in
                                            {8401}out(c, senc(mSrv(pkCli_7487,pkSess_7410),Ksrv_7498))
                                    )
                                    else
                                        {8402}let v_7499: bool = (Disco_5317 = B) in
                                        (
                                            {8403}if v_7499 then
                                            (
                                                {8404}let pkDisco_7500: bitstring = pub(skB) in
                                                {8405}in(c, (=pkCli_7487,em1_7501: bitstring,sigM1_7502: bitstring));
                                                {8406}let m1_7503: bitstring = dec(em1_7501,skSess_7409) in
                                                {8407}if (verify(h(m1_7503),sigM1_7502,pkCli_7487) <> true) then
                                                    0
                                                else
                                                    {8408}let (=OpenSecureChannelRequest,=pkCli_7487,Nc_7504: bitstring) = m1_7503 in
                                                    {8409}new Ns_7505: bitstring;
                                                    {8410}new ST_7506: bitstring;
                                                    {8411}new TTL_7507: bitstring;
                                                    {8412}let m2_7508: bitstring = (OpenSecureChannelResponse,Ns_7505,ST_7506,TTL_7507) in
                                                    {8413}out(c, (enc(m2_7508,pkCli_7487),sign(h(m2_7508),skSess_7409)));
                                                    {8414}let Ksrv_7509: bitstring = h((Ns_7505,Nc_7504)) in
                                                    {8415}out(c, senc(mSrv(pkCli_7487,pkSess_7410),Ksrv_7509))
                                            )
                                            else
                                                {8416}let v_7510: bool = (Disco_5317 = C) in
                                                (
                                                    {8417}if v_7510 then
                                                    (
                                                        {8418}let pkDisco_7511: bitstring = pub(skC) in
                                                        {8419}in(c, (=pkCli_7487,em1_7512: bitstring,sigM1_7513: bitstring));
                                                        {8420}let m1_7514: bitstring = dec(em1_7512,skSess_7409) in
                                                        {8421}if (verify(h(m1_7514),sigM1_7513,pkCli_7487) <> true) then
                                                            0
                                                        else
                                                            {8422}let (=OpenSecureChannelRequest,=pkCli_7487,Nc_7515: bitstring) = m1_7514 in
                                                            {8423}new Ns_7516: bitstring;
                                                            {8424}new ST_7517: bitstring;
                                                            {8425}new TTL_7518: bitstring;
                                                            {8426}let m2_7519: bitstring = (OpenSecureChannelResponse,Ns_7516,ST_7517,TTL_7518) in
                                                            {8427}out(c, (enc(m2_7519,pkCli_7487),sign(h(m2_7519),skSess_7409)));
                                                            {8428}let Ksrv_7520: bitstring = h((Ns_7516,Nc_7515)) in
                                                            {8429}out(c, senc(mSrv(pkCli_7487,pkSess_7410),Ksrv_7520))
                                                    )
                                                    else
                                                        {8430}let pkDisco_7521: bitstring = pub(sk(Disco_5317)) in
                                                        {8431}in(c, (=pkCli_7487,em1_7522: bitstring,sigM1_7523: bitstring));
                                                        {8432}let m1_7524: bitstring = dec(em1_7522,skSess_7409) in
                                                        {8433}if (verify(h(m1_7524),sigM1_7523,pkCli_7487) <> true) then
                                                            0
                                                        else
                                                            {8434}let (=OpenSecureChannelRequest,=pkCli_7487,Nc_7525: bitstring) = m1_7524 in
                                                            {8435}new Ns_7526: bitstring;
                                                            {8436}new ST_7527: bitstring;
                                                            {8437}new TTL_7528: bitstring;
                                                            {8438}let m2_7529: bitstring = (OpenSecureChannelResponse,Ns_7526,ST_7527,TTL_7528) in
                                                            {8439}out(c, (enc(m2_7529,pkCli_7487),sign(h(m2_7529),skSess_7409)));
                                                            {8440}let Ksrv_7530: bitstring = h((Ns_7526,Nc_7525)) in
                                                            {8441}out(c, senc(mSrv(pkCli_7487,pkSess_7410),Ksrv_7530))
                                                )
                                                else
                                                    {8442}let pkDisco_7531: bitstring = fail-any in
                                                    {8443}in(c, (=pkCli_7487,em1_7532: bitstring,sigM1_7533: bitstring));
                                                    {8444}let m1_7534: bitstring = dec(em1_7532,skSess_7409) in
                                                    {8445}if (verify(h(m1_7534),sigM1_7533,pkCli_7487) <> true) then
                                                        0
                                                    else
                                                        {8446}let (=OpenSecureChannelRequest,=pkCli_7487,Nc_7535: bitstring) = m1_7534 in
                                                        {8447}new Ns_7536: bitstring;
                                                        {8448}new ST_7537: bitstring;
                                                        {8449}new TTL_7538: bitstring;
                                                        {8450}let m2_7539: bitstring = (OpenSecureChannelResponse,Ns_7536,ST_7537,TTL_7538) in
                                                        {8451}out(c, (enc(m2_7539,pkCli_7487),sign(h(m2_7539),skSess_7409)));
                                                        {8452}let Ksrv_7540: bitstring = h((Ns_7536,Nc_7535)) in
                                                        {8453}out(c, senc(mSrv(pkCli_7487,pkSess_7410),Ksrv_7540))
                                        )
                                        else
                                            {8454}let pkDisco_7541: bitstring = fail-any in
                                            {8455}in(c, (=pkCli_7487,em1_7542: bitstring,sigM1_7543: bitstring));
                                            {8456}let m1_7544: bitstring = dec(em1_7542,skSess_7409) in
                                            {8457}if (verify(h(m1_7544),sigM1_7543,pkCli_7487) <> true) then
                                                0
                                            else
                                                {8458}let (=OpenSecureChannelRequest,=pkCli_7487,Nc_7545: bitstring) = m1_7544 in
                                                {8459}new Ns_7546: bitstring;
                                                {8460}new ST_7547: bitstring;
                                                {8461}new TTL_7548: bitstring;
                                                {8462}let m2_7549: bitstring = (OpenSecureChannelResponse,Ns_7546,ST_7547,TTL_7548) in
                                                {8463}out(c, (enc(m2_7549,pkCli_7487),sign(h(m2_7549),skSess_7409)));
                                                {8464}let Ksrv_7550: bitstring = h((Ns_7546,Nc_7545)) in
                                                {8465}out(c, senc(mSrv(pkCli_7487,pkSess_7410),Ksrv_7550))
                                )
                                else
                                    {8466}let pkDisco_7551: bitstring = fail-any in
                                    {8467}in(c, (=pkCli_7487,em1_7552: bitstring,sigM1_7553: bitstring));
                                    {8468}let m1_7554: bitstring = dec(em1_7552,skSess_7409) in
                                    {8469}if (verify(h(m1_7554),sigM1_7553,pkCli_7487) <> true) then
                                        0
                                    else
                                        {8470}let (=OpenSecureChannelRequest,=pkCli_7487,Nc_7555: bitstring) = m1_7554 in
                                        {8471}new Ns_7556: bitstring;
                                        {8472}new ST_7557: bitstring;
                                        {8473}new TTL_7558: bitstring;
                                        {8474}let m2_7559: bitstring = (OpenSecureChannelResponse,Ns_7556,ST_7557,TTL_7558) in
                                        {8475}out(c, (enc(m2_7559,pkCli_7487),sign(h(m2_7559),skSess_7409)));
                                        {8476}let Ksrv_7560: bitstring = h((Ns_7556,Nc_7555)) in
                                        {8477}out(c, senc(mSrv(pkCli_7487,pkSess_7410),Ksrv_7560))
                            )
                            else
                                {8478}let v_7561: bool = (Cli_5316 = C) in
                                (
                                    {8479}if v_7561 then
                                    (
                                        {8480}let pkCli_7562: bitstring = pub(skC) in
                                        {8481}let v_7563: bool = (Disco_5317 = A) in
                                        (
                                            {8482}if v_7563 then
                                            (
                                                {8483}let pkDisco_7564: bitstring = pub(skA) in
                                                {8484}in(c, (=pkCli_7562,em1_7565: bitstring,sigM1_7566: bitstring));
                                                {8485}let m1_7567: bitstring = dec(em1_7565,skSess_7409) in
                                                {8486}if (verify(h(m1_7567),sigM1_7566,pkCli_7562) <> true) then
                                                    0
                                                else
                                                    {8487}let (=OpenSecureChannelRequest,=pkCli_7562,Nc_7568: bitstring) = m1_7567 in
                                                    {8488}new Ns_7569: bitstring;
                                                    {8489}new ST_7570: bitstring;
                                                    {8490}new TTL_7571: bitstring;
                                                    {8491}let m2_7572: bitstring = (OpenSecureChannelResponse,Ns_7569,ST_7570,TTL_7571) in
                                                    {8492}out(c, (enc(m2_7572,pkCli_7562),sign(h(m2_7572),skSess_7409)));
                                                    {8493}let Ksrv_7573: bitstring = h((Ns_7569,Nc_7568)) in
                                                    {8494}out(c, senc(mSrv(pkCli_7562,pkSess_7410),Ksrv_7573))
                                            )
                                            else
                                                {8495}let v_7574: bool = (Disco_5317 = B) in
                                                (
                                                    {8496}if v_7574 then
                                                    (
                                                        {8497}let pkDisco_7575: bitstring = pub(skB) in
                                                        {8498}in(c, (=pkCli_7562,em1_7576: bitstring,sigM1_7577: bitstring));
                                                        {8499}let m1_7578: bitstring = dec(em1_7576,skSess_7409) in
                                                        {8500}if (verify(h(m1_7578),sigM1_7577,pkCli_7562) <> true) then
                                                            0
                                                        else
                                                            {8501}let (=OpenSecureChannelRequest,=pkCli_7562,Nc_7579: bitstring) = m1_7578 in
                                                            {8502}new Ns_7580: bitstring;
                                                            {8503}new ST_7581: bitstring;
                                                            {8504}new TTL_7582: bitstring;
                                                            {8505}let m2_7583: bitstring = (OpenSecureChannelResponse,Ns_7580,ST_7581,TTL_7582) in
                                                            {8506}out(c, (enc(m2_7583,pkCli_7562),sign(h(m2_7583),skSess_7409)));
                                                            {8507}let Ksrv_7584: bitstring = h((Ns_7580,Nc_7579)) in
                                                            {8508}out(c, senc(mSrv(pkCli_7562,pkSess_7410),Ksrv_7584))
                                                    )
                                                    else
                                                        {8509}let v_7585: bool = (Disco_5317 = C) in
                                                        (
                                                            {8510}if v_7585 then
                                                            (
                                                                {8511}let pkDisco_7586: bitstring = pub(skC) in
                                                                {8512}in(c, (=pkCli_7562,em1_7587: bitstring,sigM1_7588: bitstring));
                                                                {8513}let m1_7589: bitstring = dec(em1_7587,skSess_7409) in
                                                                {8514}if (verify(h(m1_7589),sigM1_7588,pkCli_7562) <> true) then
                                                                    0
                                                                else
                                                                    {8515}let (=OpenSecureChannelRequest,=pkCli_7562,Nc_7590: bitstring) = m1_7589 in
                                                                    {8516}new Ns_7591: bitstring;
                                                                    {8517}new ST_7592: bitstring;
                                                                    {8518}new TTL_7593: bitstring;
                                                                    {8519}let m2_7594: bitstring = (OpenSecureChannelResponse,Ns_7591,ST_7592,TTL_7593) in
                                                                    {8520}out(c, (enc(m2_7594,pkCli_7562),sign(h(m2_7594),skSess_7409)));
                                                                    {8521}let Ksrv_7595: bitstring = h((Ns_7591,Nc_7590)) in
                                                                    {8522}out(c, senc(mSrv(pkCli_7562,pkSess_7410),Ksrv_7595))
                                                            )
                                                            else
                                                                {8523}let pkDisco_7596: bitstring = pub(sk(Disco_5317)) in
                                                                {8524}in(c, (=pkCli_7562,em1_7597: bitstring,sigM1_7598: bitstring));
                                                                {8525}let m1_7599: bitstring = dec(em1_7597,skSess_7409) in
                                                                {8526}if (verify(h(m1_7599),sigM1_7598,pkCli_7562) <> true) then
                                                                    0
                                                                else
                                                                    {8527}let (=OpenSecureChannelRequest,=pkCli_7562,Nc_7600: bitstring) = m1_7599 in
                                                                    {8528}new Ns_7601: bitstring;
                                                                    {8529}new ST_7602: bitstring;
                                                                    {8530}new TTL_7603: bitstring;
                                                                    {8531}let m2_7604: bitstring = (OpenSecureChannelResponse,Ns_7601,ST_7602,TTL_7603) in
                                                                    {8532}out(c, (enc(m2_7604,pkCli_7562),sign(h(m2_7604),skSess_7409)));
                                                                    {8533}let Ksrv_7605: bitstring = h((Ns_7601,Nc_7600)) in
                                                                    {8534}out(c, senc(mSrv(pkCli_7562,pkSess_7410),Ksrv_7605))
                                                        )
                                                        else
                                                            {8535}let pkDisco_7606: bitstring = fail-any in
                                                            {8536}in(c, (=pkCli_7562,em1_7607: bitstring,sigM1_7608: bitstring));
                                                            {8537}let m1_7609: bitstring = dec(em1_7607,skSess_7409) in
                                                            {8538}if (verify(h(m1_7609),sigM1_7608,pkCli_7562) <> true) then
                                                                0
                                                            else
                                                                {8539}let (=OpenSecureChannelRequest,=pkCli_7562,Nc_7610: bitstring) = m1_7609 in
                                                                {8540}new Ns_7611: bitstring;
                                                                {8541}new ST_7612: bitstring;
                                                                {8542}new TTL_7613: bitstring;
                                                                {8543}let m2_7614: bitstring = (OpenSecureChannelResponse,Ns_7611,ST_7612,TTL_7613) in
                                                                {8544}out(c, (enc(m2_7614,pkCli_7562),sign(h(m2_7614),skSess_7409)));
                                                                {8545}let Ksrv_7615: bitstring = h((Ns_7611,Nc_7610)) in
                                                                {8546}out(c, senc(mSrv(pkCli_7562,pkSess_7410),Ksrv_7615))
                                                )
                                                else
                                                    {8547}let pkDisco_7616: bitstring = fail-any in
                                                    {8548}in(c, (=pkCli_7562,em1_7617: bitstring,sigM1_7618: bitstring));
                                                    {8549}let m1_7619: bitstring = dec(em1_7617,skSess_7409) in
                                                    {8550}if (verify(h(m1_7619),sigM1_7618,pkCli_7562) <> true) then
                                                        0
                                                    else
                                                        {8551}let (=OpenSecureChannelRequest,=pkCli_7562,Nc_7620: bitstring) = m1_7619 in
                                                        {8552}new Ns_7621: bitstring;
                                                        {8553}new ST_7622: bitstring;
                                                        {8554}new TTL_7623: bitstring;
                                                        {8555}let m2_7624: bitstring = (OpenSecureChannelResponse,Ns_7621,ST_7622,TTL_7623) in
                                                        {8556}out(c, (enc(m2_7624,pkCli_7562),sign(h(m2_7624),skSess_7409)));
                                                        {8557}let Ksrv_7625: bitstring = h((Ns_7621,Nc_7620)) in
                                                        {8558}out(c, senc(mSrv(pkCli_7562,pkSess_7410),Ksrv_7625))
                                        )
                                        else
                                            {8559}let pkDisco_7626: bitstring = fail-any in
                                            {8560}in(c, (=pkCli_7562,em1_7627: bitstring,sigM1_7628: bitstring));
                                            {8561}let m1_7629: bitstring = dec(em1_7627,skSess_7409) in
                                            {8562}if (verify(h(m1_7629),sigM1_7628,pkCli_7562) <> true) then
                                                0
                                            else
                                                {8563}let (=OpenSecureChannelRequest,=pkCli_7562,Nc_7630: bitstring) = m1_7629 in
                                                {8564}new Ns_7631: bitstring;
                                                {8565}new ST_7632: bitstring;
                                                {8566}new TTL_7633: bitstring;
                                                {8567}let m2_7634: bitstring = (OpenSecureChannelResponse,Ns_7631,ST_7632,TTL_7633) in
                                                {8568}out(c, (enc(m2_7634,pkCli_7562),sign(h(m2_7634),skSess_7409)));
                                                {8569}let Ksrv_7635: bitstring = h((Ns_7631,Nc_7630)) in
                                                {8570}out(c, senc(mSrv(pkCli_7562,pkSess_7410),Ksrv_7635))
                                    )
                                    else
                                        {8571}let pkCli_7636: bitstring = pub(sk(Cli_5316)) in
                                        {8572}let v_7637: bool = (Disco_5317 = A) in
                                        (
                                            {8573}if v_7637 then
                                            (
                                                {8574}let pkDisco_7638: bitstring = pub(skA) in
                                                {8575}in(c, (=pkCli_7636,em1_7639: bitstring,sigM1_7640: bitstring));
                                                {8576}let m1_7641: bitstring = dec(em1_7639,skSess_7409) in
                                                {8577}if (verify(h(m1_7641),sigM1_7640,pkCli_7636) <> true) then
                                                    0
                                                else
                                                    {8578}let (=OpenSecureChannelRequest,=pkCli_7636,Nc_7642: bitstring) = m1_7641 in
                                                    {8579}new Ns_7643: bitstring;
                                                    {8580}new ST_7644: bitstring;
                                                    {8581}new TTL_7645: bitstring;
                                                    {8582}let m2_7646: bitstring = (OpenSecureChannelResponse,Ns_7643,ST_7644,TTL_7645) in
                                                    {8583}out(c, (enc(m2_7646,pkCli_7636),sign(h(m2_7646),skSess_7409)));
                                                    {8584}let Ksrv_7647: bitstring = h((Ns_7643,Nc_7642)) in
                                                    {8585}out(c, senc(mSrv(pkCli_7636,pkSess_7410),Ksrv_7647))
                                            )
                                            else
                                                {8586}let v_7648: bool = (Disco_5317 = B) in
                                                (
                                                    {8587}if v_7648 then
                                                    (
                                                        {8588}let pkDisco_7649: bitstring = pub(skB) in
                                                        {8589}in(c, (=pkCli_7636,em1_7650: bitstring,sigM1_7651: bitstring));
                                                        {8590}let m1_7652: bitstring = dec(em1_7650,skSess_7409) in
                                                        {8591}if (verify(h(m1_7652),sigM1_7651,pkCli_7636) <> true) then
                                                            0
                                                        else
                                                            {8592}let (=OpenSecureChannelRequest,=pkCli_7636,Nc_7653: bitstring) = m1_7652 in
                                                            {8593}new Ns_7654: bitstring;
                                                            {8594}new ST_7655: bitstring;
                                                            {8595}new TTL_7656: bitstring;
                                                            {8596}let m2_7657: bitstring = (OpenSecureChannelResponse,Ns_7654,ST_7655,TTL_7656) in
                                                            {8597}out(c, (enc(m2_7657,pkCli_7636),sign(h(m2_7657),skSess_7409)));
                                                            {8598}let Ksrv_7658: bitstring = h((Ns_7654,Nc_7653)) in
                                                            {8599}out(c, senc(mSrv(pkCli_7636,pkSess_7410),Ksrv_7658))
                                                    )
                                                    else
                                                        {8600}let v_7659: bool = (Disco_5317 = C) in
                                                        (
                                                            {8601}if v_7659 then
                                                            (
                                                                {8602}let pkDisco_7660: bitstring = pub(skC) in
                                                                {8603}in(c, (=pkCli_7636,em1_7661: bitstring,sigM1_7662: bitstring));
                                                                {8604}let m1_7663: bitstring = dec(em1_7661,skSess_7409) in
                                                                {8605}if (verify(h(m1_7663),sigM1_7662,pkCli_7636) <> true) then
                                                                    0
                                                                else
                                                                    {8606}let (=OpenSecureChannelRequest,=pkCli_7636,Nc_7664: bitstring) = m1_7663 in
                                                                    {8607}new Ns_7665: bitstring;
                                                                    {8608}new ST_7666: bitstring;
                                                                    {8609}new TTL_7667: bitstring;
                                                                    {8610}let m2_7668: bitstring = (OpenSecureChannelResponse,Ns_7665,ST_7666,TTL_7667) in
                                                                    {8611}out(c, (enc(m2_7668,pkCli_7636),sign(h(m2_7668),skSess_7409)));
                                                                    {8612}let Ksrv_7669: bitstring = h((Ns_7665,Nc_7664)) in
                                                                    {8613}out(c, senc(mSrv(pkCli_7636,pkSess_7410),Ksrv_7669))
                                                            )
                                                            else
                                                                {8614}let pkDisco_7670: bitstring = pub(sk(Disco_5317)) in
                                                                {8615}in(c, (=pkCli_7636,em1_7671: bitstring,sigM1_7672: bitstring));
                                                                {8616}let m1_7673: bitstring = dec(em1_7671,skSess_7409) in
                                                                {8617}if (verify(h(m1_7673),sigM1_7672,pkCli_7636) <> true) then
                                                                    0
                                                                else
                                                                    {8618}let (=OpenSecureChannelRequest,=pkCli_7636,Nc_7674: bitstring) = m1_7673 in
                                                                    {8619}new Ns_7675: bitstring;
                                                                    {8620}new ST_7676: bitstring;
                                                                    {8621}new TTL_7677: bitstring;
                                                                    {8622}let m2_7678: bitstring = (OpenSecureChannelResponse,Ns_7675,ST_7676,TTL_7677) in
                                                                    {8623}out(c, (enc(m2_7678,pkCli_7636),sign(h(m2_7678),skSess_7409)));
                                                                    {8624}let Ksrv_7679: bitstring = h((Ns_7675,Nc_7674)) in
                                                                    {8625}out(c, senc(mSrv(pkCli_7636,pkSess_7410),Ksrv_7679))
                                                        )
                                                        else
                                                            {8626}let pkDisco_7680: bitstring = fail-any in
                                                            {8627}in(c, (=pkCli_7636,em1_7681: bitstring,sigM1_7682: bitstring));
                                                            {8628}let m1_7683: bitstring = dec(em1_7681,skSess_7409) in
                                                            {8629}if (verify(h(m1_7683),sigM1_7682,pkCli_7636) <> true) then
                                                                0
                                                            else
                                                                {8630}let (=OpenSecureChannelRequest,=pkCli_7636,Nc_7684: bitstring) = m1_7683 in
                                                                {8631}new Ns_7685: bitstring;
                                                                {8632}new ST_7686: bitstring;
                                                                {8633}new TTL_7687: bitstring;
                                                                {8634}let m2_7688: bitstring = (OpenSecureChannelResponse,Ns_7685,ST_7686,TTL_7687) in
                                                                {8635}out(c, (enc(m2_7688,pkCli_7636),sign(h(m2_7688),skSess_7409)));
                                                                {8636}let Ksrv_7689: bitstring = h((Ns_7685,Nc_7684)) in
                                                                {8637}out(c, senc(mSrv(pkCli_7636,pkSess_7410),Ksrv_7689))
                                                )
                                                else
                                                    {8638}let pkDisco_7690: bitstring = fail-any in
                                                    {8639}in(c, (=pkCli_7636,em1_7691: bitstring,sigM1_7692: bitstring));
                                                    {8640}let m1_7693: bitstring = dec(em1_7691,skSess_7409) in
                                                    {8641}if (verify(h(m1_7693),sigM1_7692,pkCli_7636) <> true) then
                                                        0
                                                    else
                                                        {8642}let (=OpenSecureChannelRequest,=pkCli_7636,Nc_7694: bitstring) = m1_7693 in
                                                        {8643}new Ns_7695: bitstring;
                                                        {8644}new ST_7696: bitstring;
                                                        {8645}new TTL_7697: bitstring;
                                                        {8646}let m2_7698: bitstring = (OpenSecureChannelResponse,Ns_7695,ST_7696,TTL_7697) in
                                                        {8647}out(c, (enc(m2_7698,pkCli_7636),sign(h(m2_7698),skSess_7409)));
                                                        {8648}let Ksrv_7699: bitstring = h((Ns_7695,Nc_7694)) in
                                                        {8649}out(c, senc(mSrv(pkCli_7636,pkSess_7410),Ksrv_7699))
                                        )
                                        else
                                            {8650}let pkDisco_7700: bitstring = fail-any in
                                            {8651}in(c, (=pkCli_7636,em1_7701: bitstring,sigM1_7702: bitstring));
                                            {8652}let m1_7703: bitstring = dec(em1_7701,skSess_7409) in
                                            {8653}if (verify(h(m1_7703),sigM1_7702,pkCli_7636) <> true) then
                                                0
                                            else
                                                {8654}let (=OpenSecureChannelRequest,=pkCli_7636,Nc_7704: bitstring) = m1_7703 in
                                                {8655}new Ns_7705: bitstring;
                                                {8656}new ST_7706: bitstring;
                                                {8657}new TTL_7707: bitstring;
                                                {8658}let m2_7708: bitstring = (OpenSecureChannelResponse,Ns_7705,ST_7706,TTL_7707) in
                                                {8659}out(c, (enc(m2_7708,pkCli_7636),sign(h(m2_7708),skSess_7409)));
                                                {8660}let Ksrv_7709: bitstring = h((Ns_7705,Nc_7704)) in
                                                {8661}out(c, senc(mSrv(pkCli_7636,pkSess_7410),Ksrv_7709))
                                )
                                else
                                    {8662}let pkCli_7710: bitstring = fail-any in
                                    {8663}let v_7711: bool = (Disco_5317 = A) in
                                    (
                                        {8664}if v_7711 then
                                        (
                                            {8665}let pkDisco_7712: bitstring = pub(skA) in
                                            {8666}in(c, (=pkCli_7710,em1_7713: bitstring,sigM1_7714: bitstring));
                                            {8667}let m1_7715: bitstring = dec(em1_7713,skSess_7409) in
                                            {8668}if (verify(h(m1_7715),sigM1_7714,pkCli_7710) <> true) then
                                                0
                                            else
                                                {8669}let (=OpenSecureChannelRequest,=pkCli_7710,Nc_7716: bitstring) = m1_7715 in
                                                {8670}new Ns_7717: bitstring;
                                                {8671}new ST_7718: bitstring;
                                                {8672}new TTL_7719: bitstring;
                                                {8673}let m2_7720: bitstring = (OpenSecureChannelResponse,Ns_7717,ST_7718,TTL_7719) in
                                                {8674}out(c, (enc(m2_7720,pkCli_7710),sign(h(m2_7720),skSess_7409)));
                                                {8675}let Ksrv_7721: bitstring = h((Ns_7717,Nc_7716)) in
                                                {8676}out(c, senc(mSrv(pkCli_7710,pkSess_7410),Ksrv_7721))
                                        )
                                        else
                                            {8677}let v_7722: bool = (Disco_5317 = B) in
                                            (
                                                {8678}if v_7722 then
                                                (
                                                    {8679}let pkDisco_7723: bitstring = pub(skB) in
                                                    {8680}in(c, (=pkCli_7710,em1_7724: bitstring,sigM1_7725: bitstring));
                                                    {8681}let m1_7726: bitstring = dec(em1_7724,skSess_7409) in
                                                    {8682}if (verify(h(m1_7726),sigM1_7725,pkCli_7710) <> true) then
                                                        0
                                                    else
                                                        {8683}let (=OpenSecureChannelRequest,=pkCli_7710,Nc_7727: bitstring) = m1_7726 in
                                                        {8684}new Ns_7728: bitstring;
                                                        {8685}new ST_7729: bitstring;
                                                        {8686}new TTL_7730: bitstring;
                                                        {8687}let m2_7731: bitstring = (OpenSecureChannelResponse,Ns_7728,ST_7729,TTL_7730) in
                                                        {8688}out(c, (enc(m2_7731,pkCli_7710),sign(h(m2_7731),skSess_7409)));
                                                        {8689}let Ksrv_7732: bitstring = h((Ns_7728,Nc_7727)) in
                                                        {8690}out(c, senc(mSrv(pkCli_7710,pkSess_7410),Ksrv_7732))
                                                )
                                                else
                                                    {8691}let v_7733: bool = (Disco_5317 = C) in
                                                    (
                                                        {8692}if v_7733 then
                                                        (
                                                            {8693}let pkDisco_7734: bitstring = pub(skC) in
                                                            {8694}in(c, (=pkCli_7710,em1_7735: bitstring,sigM1_7736: bitstring));
                                                            {8695}let m1_7737: bitstring = dec(em1_7735,skSess_7409) in
                                                            {8696}if (verify(h(m1_7737),sigM1_7736,pkCli_7710) <> true) then
                                                                0
                                                            else
                                                                {8697}let (=OpenSecureChannelRequest,=pkCli_7710,Nc_7738: bitstring) = m1_7737 in
                                                                {8698}new Ns_7739: bitstring;
                                                                {8699}new ST_7740: bitstring;
                                                                {8700}new TTL_7741: bitstring;
                                                                {8701}let m2_7742: bitstring = (OpenSecureChannelResponse,Ns_7739,ST_7740,TTL_7741) in
                                                                {8702}out(c, (enc(m2_7742,pkCli_7710),sign(h(m2_7742),skSess_7409)));
                                                                {8703}let Ksrv_7743: bitstring = h((Ns_7739,Nc_7738)) in
                                                                {8704}out(c, senc(mSrv(pkCli_7710,pkSess_7410),Ksrv_7743))
                                                        )
                                                        else
                                                            {8705}let pkDisco_7744: bitstring = pub(sk(Disco_5317)) in
                                                            {8706}in(c, (=pkCli_7710,em1_7745: bitstring,sigM1_7746: bitstring));
                                                            {8707}let m1_7747: bitstring = dec(em1_7745,skSess_7409) in
                                                            {8708}if (verify(h(m1_7747),sigM1_7746,pkCli_7710) <> true) then
                                                                0
                                                            else
                                                                {8709}let (=OpenSecureChannelRequest,=pkCli_7710,Nc_7748: bitstring) = m1_7747 in
                                                                {8710}new Ns_7749: bitstring;
                                                                {8711}new ST_7750: bitstring;
                                                                {8712}new TTL_7751: bitstring;
                                                                {8713}let m2_7752: bitstring = (OpenSecureChannelResponse,Ns_7749,ST_7750,TTL_7751) in
                                                                {8714}out(c, (enc(m2_7752,pkCli_7710),sign(h(m2_7752),skSess_7409)));
                                                                {8715}let Ksrv_7753: bitstring = h((Ns_7749,Nc_7748)) in
                                                                {8716}out(c, senc(mSrv(pkCli_7710,pkSess_7410),Ksrv_7753))
                                                    )
                                                    else
                                                        {8717}let pkDisco_7754: bitstring = fail-any in
                                                        {8718}in(c, (=pkCli_7710,em1_7755: bitstring,sigM1_7756: bitstring));
                                                        {8719}let m1_7757: bitstring = dec(em1_7755,skSess_7409) in
                                                        {8720}if (verify(h(m1_7757),sigM1_7756,pkCli_7710) <> true) then
                                                            0
                                                        else
                                                            {8721}let (=OpenSecureChannelRequest,=pkCli_7710,Nc_7758: bitstring) = m1_7757 in
                                                            {8722}new Ns_7759: bitstring;
                                                            {8723}new ST_7760: bitstring;
                                                            {8724}new TTL_7761: bitstring;
                                                            {8725}let m2_7762: bitstring = (OpenSecureChannelResponse,Ns_7759,ST_7760,TTL_7761) in
                                                            {8726}out(c, (enc(m2_7762,pkCli_7710),sign(h(m2_7762),skSess_7409)));
                                                            {8727}let Ksrv_7763: bitstring = h((Ns_7759,Nc_7758)) in
                                                            {8728}out(c, senc(mSrv(pkCli_7710,pkSess_7410),Ksrv_7763))
                                            )
                                            else
                                                {8729}let pkDisco_7764: bitstring = fail-any in
                                                {8730}in(c, (=pkCli_7710,em1_7765: bitstring,sigM1_7766: bitstring));
                                                {8731}let m1_7767: bitstring = dec(em1_7765,skSess_7409) in
                                                {8732}if (verify(h(m1_7767),sigM1_7766,pkCli_7710) <> true) then
                                                    0
                                                else
                                                    {8733}let (=OpenSecureChannelRequest,=pkCli_7710,Nc_7768: bitstring) = m1_7767 in
                                                    {8734}new Ns_7769: bitstring;
                                                    {8735}new ST_7770: bitstring;
                                                    {8736}new TTL_7771: bitstring;
                                                    {8737}let m2_7772: bitstring = (OpenSecureChannelResponse,Ns_7769,ST_7770,TTL_7771) in
                                                    {8738}out(c, (enc(m2_7772,pkCli_7710),sign(h(m2_7772),skSess_7409)));
                                                    {8739}let Ksrv_7773: bitstring = h((Ns_7769,Nc_7768)) in
                                                    {8740}out(c, senc(mSrv(pkCli_7710,pkSess_7410),Ksrv_7773))
                                    )
                                    else
                                        {8741}let pkDisco_7774: bitstring = fail-any in
                                        {8742}in(c, (=pkCli_7710,em1_7775: bitstring,sigM1_7776: bitstring));
                                        {8743}let m1_7777: bitstring = dec(em1_7775,skSess_7409) in
                                        {8744}if (verify(h(m1_7777),sigM1_7776,pkCli_7710) <> true) then
                                            0
                                        else
                                            {8745}let (=OpenSecureChannelRequest,=pkCli_7710,Nc_7778: bitstring) = m1_7777 in
                                            {8746}new Ns_7779: bitstring;
                                            {8747}new ST_7780: bitstring;
                                            {8748}new TTL_7781: bitstring;
                                            {8749}let m2_7782: bitstring = (OpenSecureChannelResponse,Ns_7779,ST_7780,TTL_7781) in
                                            {8750}out(c, (enc(m2_7782,pkCli_7710),sign(h(m2_7782),skSess_7409)));
                                            {8751}let Ksrv_7783: bitstring = h((Ns_7779,Nc_7778)) in
                                            {8752}out(c, senc(mSrv(pkCli_7710,pkSess_7410),Ksrv_7783))
                        )
                        else
                            {8753}let pkCli_7784: bitstring = fail-any in
                            {8754}let v_7785: bool = (Disco_5317 = A) in
                            (
                                {8755}if v_7785 then
                                (
                                    {8756}let pkDisco_7786: bitstring = pub(skA) in
                                    {8757}in(c, (=pkCli_7784,em1_7787: bitstring,sigM1_7788: bitstring));
                                    {8758}let m1_7789: bitstring = dec(em1_7787,skSess_7409) in
                                    {8759}if (verify(h(m1_7789),sigM1_7788,pkCli_7784) <> true) then
                                        0
                                    else
                                        {8760}let (=OpenSecureChannelRequest,=pkCli_7784,Nc_7790: bitstring) = m1_7789 in
                                        {8761}new Ns_7791: bitstring;
                                        {8762}new ST_7792: bitstring;
                                        {8763}new TTL_7793: bitstring;
                                        {8764}let m2_7794: bitstring = (OpenSecureChannelResponse,Ns_7791,ST_7792,TTL_7793) in
                                        {8765}out(c, (enc(m2_7794,pkCli_7784),sign(h(m2_7794),skSess_7409)));
                                        {8766}let Ksrv_7795: bitstring = h((Ns_7791,Nc_7790)) in
                                        {8767}out(c, senc(mSrv(pkCli_7784,pkSess_7410),Ksrv_7795))
                                )
                                else
                                    {8768}let v_7796: bool = (Disco_5317 = B) in
                                    (
                                        {8769}if v_7796 then
                                        (
                                            {8770}let pkDisco_7797: bitstring = pub(skB) in
                                            {8771}in(c, (=pkCli_7784,em1_7798: bitstring,sigM1_7799: bitstring));
                                            {8772}let m1_7800: bitstring = dec(em1_7798,skSess_7409) in
                                            {8773}if (verify(h(m1_7800),sigM1_7799,pkCli_7784) <> true) then
                                                0
                                            else
                                                {8774}let (=OpenSecureChannelRequest,=pkCli_7784,Nc_7801: bitstring) = m1_7800 in
                                                {8775}new Ns_7802: bitstring;
                                                {8776}new ST_7803: bitstring;
                                                {8777}new TTL_7804: bitstring;
                                                {8778}let m2_7805: bitstring = (OpenSecureChannelResponse,Ns_7802,ST_7803,TTL_7804) in
                                                {8779}out(c, (enc(m2_7805,pkCli_7784),sign(h(m2_7805),skSess_7409)));
                                                {8780}let Ksrv_7806: bitstring = h((Ns_7802,Nc_7801)) in
                                                {8781}out(c, senc(mSrv(pkCli_7784,pkSess_7410),Ksrv_7806))
                                        )
                                        else
                                            {8782}let v_7807: bool = (Disco_5317 = C) in
                                            (
                                                {8783}if v_7807 then
                                                (
                                                    {8784}let pkDisco_7808: bitstring = pub(skC) in
                                                    {8785}in(c, (=pkCli_7784,em1_7809: bitstring,sigM1_7810: bitstring));
                                                    {8786}let m1_7811: bitstring = dec(em1_7809,skSess_7409) in
                                                    {8787}if (verify(h(m1_7811),sigM1_7810,pkCli_7784) <> true) then
                                                        0
                                                    else
                                                        {8788}let (=OpenSecureChannelRequest,=pkCli_7784,Nc_7812: bitstring) = m1_7811 in
                                                        {8789}new Ns_7813: bitstring;
                                                        {8790}new ST_7814: bitstring;
                                                        {8791}new TTL_7815: bitstring;
                                                        {8792}let m2_7816: bitstring = (OpenSecureChannelResponse,Ns_7813,ST_7814,TTL_7815) in
                                                        {8793}out(c, (enc(m2_7816,pkCli_7784),sign(h(m2_7816),skSess_7409)));
                                                        {8794}let Ksrv_7817: bitstring = h((Ns_7813,Nc_7812)) in
                                                        {8795}out(c, senc(mSrv(pkCli_7784,pkSess_7410),Ksrv_7817))
                                                )
                                                else
                                                    {8796}let pkDisco_7818: bitstring = pub(sk(Disco_5317)) in
                                                    {8797}in(c, (=pkCli_7784,em1_7819: bitstring,sigM1_7820: bitstring));
                                                    {8798}let m1_7821: bitstring = dec(em1_7819,skSess_7409) in
                                                    {8799}if (verify(h(m1_7821),sigM1_7820,pkCli_7784) <> true) then
                                                        0
                                                    else
                                                        {8800}let (=OpenSecureChannelRequest,=pkCli_7784,Nc_7822: bitstring) = m1_7821 in
                                                        {8801}new Ns_7823: bitstring;
                                                        {8802}new ST_7824: bitstring;
                                                        {8803}new TTL_7825: bitstring;
                                                        {8804}let m2_7826: bitstring = (OpenSecureChannelResponse,Ns_7823,ST_7824,TTL_7825) in
                                                        {8805}out(c, (enc(m2_7826,pkCli_7784),sign(h(m2_7826),skSess_7409)));
                                                        {8806}let Ksrv_7827: bitstring = h((Ns_7823,Nc_7822)) in
                                                        {8807}out(c, senc(mSrv(pkCli_7784,pkSess_7410),Ksrv_7827))
                                            )
                                            else
                                                {8808}let pkDisco_7828: bitstring = fail-any in
                                                {8809}in(c, (=pkCli_7784,em1_7829: bitstring,sigM1_7830: bitstring));
                                                {8810}let m1_7831: bitstring = dec(em1_7829,skSess_7409) in
                                                {8811}if (verify(h(m1_7831),sigM1_7830,pkCli_7784) <> true) then
                                                    0
                                                else
                                                    {8812}let (=OpenSecureChannelRequest,=pkCli_7784,Nc_7832: bitstring) = m1_7831 in
                                                    {8813}new Ns_7833: bitstring;
                                                    {8814}new ST_7834: bitstring;
                                                    {8815}new TTL_7835: bitstring;
                                                    {8816}let m2_7836: bitstring = (OpenSecureChannelResponse,Ns_7833,ST_7834,TTL_7835) in
                                                    {8817}out(c, (enc(m2_7836,pkCli_7784),sign(h(m2_7836),skSess_7409)));
                                                    {8818}let Ksrv_7837: bitstring = h((Ns_7833,Nc_7832)) in
                                                    {8819}out(c, senc(mSrv(pkCli_7784,pkSess_7410),Ksrv_7837))
                                    )
                                    else
                                        {8820}let pkDisco_7838: bitstring = fail-any in
                                        {8821}in(c, (=pkCli_7784,em1_7839: bitstring,sigM1_7840: bitstring));
                                        {8822}let m1_7841: bitstring = dec(em1_7839,skSess_7409) in
                                        {8823}if (verify(h(m1_7841),sigM1_7840,pkCli_7784) <> true) then
                                            0
                                        else
                                            {8824}let (=OpenSecureChannelRequest,=pkCli_7784,Nc_7842: bitstring) = m1_7841 in
                                            {8825}new Ns_7843: bitstring;
                                            {8826}new ST_7844: bitstring;
                                            {8827}new TTL_7845: bitstring;
                                            {8828}let m2_7846: bitstring = (OpenSecureChannelResponse,Ns_7843,ST_7844,TTL_7845) in
                                            {8829}out(c, (enc(m2_7846,pkCli_7784),sign(h(m2_7846),skSess_7409)));
                                            {8830}let Ksrv_7847: bitstring = h((Ns_7843,Nc_7842)) in
                                            {8831}out(c, senc(mSrv(pkCli_7784,pkSess_7410),Ksrv_7847))
                            )
                            else
                                {8832}let pkDisco_7848: bitstring = fail-any in
                                {8833}in(c, (=pkCli_7784,em1_7849: bitstring,sigM1_7850: bitstring));
                                {8834}let m1_7851: bitstring = dec(em1_7849,skSess_7409) in
                                {8835}if (verify(h(m1_7851),sigM1_7850,pkCli_7784) <> true) then
                                    0
                                else
                                    {8836}let (=OpenSecureChannelRequest,=pkCli_7784,Nc_7852: bitstring) = m1_7851 in
                                    {8837}new Ns_7853: bitstring;
                                    {8838}new ST_7854: bitstring;
                                    {8839}new TTL_7855: bitstring;
                                    {8840}let m2_7856: bitstring = (OpenSecureChannelResponse,Ns_7853,ST_7854,TTL_7855) in
                                    {8841}out(c, (enc(m2_7856,pkCli_7784),sign(h(m2_7856),skSess_7409)));
                                    {8842}let Ksrv_7857: bitstring = h((Ns_7853,Nc_7852)) in
                                    {8843}out(c, senc(mSrv(pkCli_7784,pkSess_7410),Ksrv_7857))
                )
                else
                    {8844}let pkCli_7858: bitstring = fail-any in
                    {8845}let v_7859: bool = (Disco_5317 = A) in
                    (
                        {8846}if v_7859 then
                        (
                            {8847}let pkDisco_7860: bitstring = pub(skA) in
                            {8848}in(c, (=pkCli_7858,em1_7861: bitstring,sigM1_7862: bitstring));
                            {8849}let m1_7863: bitstring = dec(em1_7861,skSess_7409) in
                            {8850}if (verify(h(m1_7863),sigM1_7862,pkCli_7858) <> true) then
                                0
                            else
                                {8851}let (=OpenSecureChannelRequest,=pkCli_7858,Nc_7864: bitstring) = m1_7863 in
                                {8852}new Ns_7865: bitstring;
                                {8853}new ST_7866: bitstring;
                                {8854}new TTL_7867: bitstring;
                                {8855}let m2_7868: bitstring = (OpenSecureChannelResponse,Ns_7865,ST_7866,TTL_7867) in
                                {8856}out(c, (enc(m2_7868,pkCli_7858),sign(h(m2_7868),skSess_7409)));
                                {8857}let Ksrv_7869: bitstring = h((Ns_7865,Nc_7864)) in
                                {8858}out(c, senc(mSrv(pkCli_7858,pkSess_7410),Ksrv_7869))
                        )
                        else
                            {8859}let v_7870: bool = (Disco_5317 = B) in
                            (
                                {8860}if v_7870 then
                                (
                                    {8861}let pkDisco_7871: bitstring = pub(skB) in
                                    {8862}in(c, (=pkCli_7858,em1_7872: bitstring,sigM1_7873: bitstring));
                                    {8863}let m1_7874: bitstring = dec(em1_7872,skSess_7409) in
                                    {8864}if (verify(h(m1_7874),sigM1_7873,pkCli_7858) <> true) then
                                        0
                                    else
                                        {8865}let (=OpenSecureChannelRequest,=pkCli_7858,Nc_7875: bitstring) = m1_7874 in
                                        {8866}new Ns_7876: bitstring;
                                        {8867}new ST_7877: bitstring;
                                        {8868}new TTL_7878: bitstring;
                                        {8869}let m2_7879: bitstring = (OpenSecureChannelResponse,Ns_7876,ST_7877,TTL_7878) in
                                        {8870}out(c, (enc(m2_7879,pkCli_7858),sign(h(m2_7879),skSess_7409)));
                                        {8871}let Ksrv_7880: bitstring = h((Ns_7876,Nc_7875)) in
                                        {8872}out(c, senc(mSrv(pkCli_7858,pkSess_7410),Ksrv_7880))
                                )
                                else
                                    {8873}let v_7881: bool = (Disco_5317 = C) in
                                    (
                                        {8874}if v_7881 then
                                        (
                                            {8875}let pkDisco_7882: bitstring = pub(skC) in
                                            {8876}in(c, (=pkCli_7858,em1_7883: bitstring,sigM1_7884: bitstring));
                                            {8877}let m1_7885: bitstring = dec(em1_7883,skSess_7409) in
                                            {8878}if (verify(h(m1_7885),sigM1_7884,pkCli_7858) <> true) then
                                                0
                                            else
                                                {8879}let (=OpenSecureChannelRequest,=pkCli_7858,Nc_7886: bitstring) = m1_7885 in
                                                {8880}new Ns_7887: bitstring;
                                                {8881}new ST_7888: bitstring;
                                                {8882}new TTL_7889: bitstring;
                                                {8883}let m2_7890: bitstring = (OpenSecureChannelResponse,Ns_7887,ST_7888,TTL_7889) in
                                                {8884}out(c, (enc(m2_7890,pkCli_7858),sign(h(m2_7890),skSess_7409)));
                                                {8885}let Ksrv_7891: bitstring = h((Ns_7887,Nc_7886)) in
                                                {8886}out(c, senc(mSrv(pkCli_7858,pkSess_7410),Ksrv_7891))
                                        )
                                        else
                                            {8887}let pkDisco_7892: bitstring = pub(sk(Disco_5317)) in
                                            {8888}in(c, (=pkCli_7858,em1_7893: bitstring,sigM1_7894: bitstring));
                                            {8889}let m1_7895: bitstring = dec(em1_7893,skSess_7409) in
                                            {8890}if (verify(h(m1_7895),sigM1_7894,pkCli_7858) <> true) then
                                                0
                                            else
                                                {8891}let (=OpenSecureChannelRequest,=pkCli_7858,Nc_7896: bitstring) = m1_7895 in
                                                {8892}new Ns_7897: bitstring;
                                                {8893}new ST_7898: bitstring;
                                                {8894}new TTL_7899: bitstring;
                                                {8895}let m2_7900: bitstring = (OpenSecureChannelResponse,Ns_7897,ST_7898,TTL_7899) in
                                                {8896}out(c, (enc(m2_7900,pkCli_7858),sign(h(m2_7900),skSess_7409)));
                                                {8897}let Ksrv_7901: bitstring = h((Ns_7897,Nc_7896)) in
                                                {8898}out(c, senc(mSrv(pkCli_7858,pkSess_7410),Ksrv_7901))
                                    )
                                    else
                                        {8899}let pkDisco_7902: bitstring = fail-any in
                                        {8900}in(c, (=pkCli_7858,em1_7903: bitstring,sigM1_7904: bitstring));
                                        {8901}let m1_7905: bitstring = dec(em1_7903,skSess_7409) in
                                        {8902}if (verify(h(m1_7905),sigM1_7904,pkCli_7858) <> true) then
                                            0
                                        else
                                            {8903}let (=OpenSecureChannelRequest,=pkCli_7858,Nc_7906: bitstring) = m1_7905 in
                                            {8904}new Ns_7907: bitstring;
                                            {8905}new ST_7908: bitstring;
                                            {8906}new TTL_7909: bitstring;
                                            {8907}let m2_7910: bitstring = (OpenSecureChannelResponse,Ns_7907,ST_7908,TTL_7909) in
                                            {8908}out(c, (enc(m2_7910,pkCli_7858),sign(h(m2_7910),skSess_7409)));
                                            {8909}let Ksrv_7911: bitstring = h((Ns_7907,Nc_7906)) in
                                            {8910}out(c, senc(mSrv(pkCli_7858,pkSess_7410),Ksrv_7911))
                            )
                            else
                                {8911}let pkDisco_7912: bitstring = fail-any in
                                {8912}in(c, (=pkCli_7858,em1_7913: bitstring,sigM1_7914: bitstring));
                                {8913}let m1_7915: bitstring = dec(em1_7913,skSess_7409) in
                                {8914}if (verify(h(m1_7915),sigM1_7914,pkCli_7858) <> true) then
                                    0
                                else
                                    {8915}let (=OpenSecureChannelRequest,=pkCli_7858,Nc_7916: bitstring) = m1_7915 in
                                    {8916}new Ns_7917: bitstring;
                                    {8917}new ST_7918: bitstring;
                                    {8918}new TTL_7919: bitstring;
                                    {8919}let m2_7920: bitstring = (OpenSecureChannelResponse,Ns_7917,ST_7918,TTL_7919) in
                                    {8920}out(c, (enc(m2_7920,pkCli_7858),sign(h(m2_7920),skSess_7409)));
                                    {8921}let Ksrv_7921: bitstring = h((Ns_7917,Nc_7916)) in
                                    {8922}out(c, senc(mSrv(pkCli_7858,pkSess_7410),Ksrv_7921))
                    )
                    else
                        {8923}let pkDisco_7922: bitstring = fail-any in
                        {8924}in(c, (=pkCli_7858,em1_7923: bitstring,sigM1_7924: bitstring));
                        {8925}let m1_7925: bitstring = dec(em1_7923,skSess_7409) in
                        {8926}if (verify(h(m1_7925),sigM1_7924,pkCli_7858) <> true) then
                            0
                        else
                            {8927}let (=OpenSecureChannelRequest,=pkCli_7858,Nc_7926: bitstring) = m1_7925 in
                            {8928}new Ns_7927: bitstring;
                            {8929}new ST_7928: bitstring;
                            {8930}new TTL_7929: bitstring;
                            {8931}let m2_7930: bitstring = (OpenSecureChannelResponse,Ns_7927,ST_7928,TTL_7929) in
                            {8932}out(c, (enc(m2_7930,pkCli_7858),sign(h(m2_7930),skSess_7409)));
                            {8933}let Ksrv_7931: bitstring = h((Ns_7927,Nc_7926)) in
                            {8934}out(c, senc(mSrv(pkCli_7858,pkSess_7410),Ksrv_7931))
    )
    else
        {8935}let skSess_7932: bitstring = fail-any in
        {8936}let pkSess_7933: bitstring = pub(skSess_7932) in
        {8937}let v_7934: bool = (Cli_5316 = A) in
        (
            {8938}if v_7934 then
            (
                {8939}let pkCli_7935: bitstring = pub(skA) in
                {8940}let v_7936: bool = (Disco_5317 = A) in
                (
                    {8941}if v_7936 then
                    (
                        {8942}let pkDisco_7937: bitstring = pub(skA) in
                        {8943}in(c, (=pkCli_7935,em1_7938: bitstring,sigM1_7939: bitstring));
                        {8944}let m1_7940: bitstring = dec(em1_7938,skSess_7932) in
                        {8945}if (verify(h(m1_7940),sigM1_7939,pkCli_7935) <> true) then
                            0
                        else
                            {8946}let (=OpenSecureChannelRequest,=pkCli_7935,Nc_7941: bitstring) = m1_7940 in
                            {8947}new Ns_7942: bitstring;
                            {8948}new ST_7943: bitstring;
                            {8949}new TTL_7944: bitstring;
                            {8950}let m2_7945: bitstring = (OpenSecureChannelResponse,Ns_7942,ST_7943,TTL_7944) in
                            {8951}out(c, (enc(m2_7945,pkCli_7935),sign(h(m2_7945),skSess_7932)));
                            {8952}let Ksrv_7946: bitstring = h((Ns_7942,Nc_7941)) in
                            {8953}out(c, senc(mSrv(pkCli_7935,pkSess_7933),Ksrv_7946))
                    )
                    else
                        {8954}let v_7947: bool = (Disco_5317 = B) in
                        (
                            {8955}if v_7947 then
                            (
                                {8956}let pkDisco_7948: bitstring = pub(skB) in
                                {8957}in(c, (=pkCli_7935,em1_7949: bitstring,sigM1_7950: bitstring));
                                {8958}let m1_7951: bitstring = dec(em1_7949,skSess_7932) in
                                {8959}if (verify(h(m1_7951),sigM1_7950,pkCli_7935) <> true) then
                                    0
                                else
                                    {8960}let (=OpenSecureChannelRequest,=pkCli_7935,Nc_7952: bitstring) = m1_7951 in
                                    {8961}new Ns_7953: bitstring;
                                    {8962}new ST_7954: bitstring;
                                    {8963}new TTL_7955: bitstring;
                                    {8964}let m2_7956: bitstring = (OpenSecureChannelResponse,Ns_7953,ST_7954,TTL_7955) in
                                    {8965}out(c, (enc(m2_7956,pkCli_7935),sign(h(m2_7956),skSess_7932)));
                                    {8966}let Ksrv_7957: bitstring = h((Ns_7953,Nc_7952)) in
                                    {8967}out(c, senc(mSrv(pkCli_7935,pkSess_7933),Ksrv_7957))
                            )
                            else
                                {8968}let v_7958: bool = (Disco_5317 = C) in
                                (
                                    {8969}if v_7958 then
                                    (
                                        {8970}let pkDisco_7959: bitstring = pub(skC) in
                                        {8971}in(c, (=pkCli_7935,em1_7960: bitstring,sigM1_7961: bitstring));
                                        {8972}let m1_7962: bitstring = dec(em1_7960,skSess_7932) in
                                        {8973}if (verify(h(m1_7962),sigM1_7961,pkCli_7935) <> true) then
                                            0
                                        else
                                            {8974}let (=OpenSecureChannelRequest,=pkCli_7935,Nc_7963: bitstring) = m1_7962 in
                                            {8975}new Ns_7964: bitstring;
                                            {8976}new ST_7965: bitstring;
                                            {8977}new TTL_7966: bitstring;
                                            {8978}let m2_7967: bitstring = (OpenSecureChannelResponse,Ns_7964,ST_7965,TTL_7966) in
                                            {8979}out(c, (enc(m2_7967,pkCli_7935),sign(h(m2_7967),skSess_7932)));
                                            {8980}let Ksrv_7968: bitstring = h((Ns_7964,Nc_7963)) in
                                            {8981}out(c, senc(mSrv(pkCli_7935,pkSess_7933),Ksrv_7968))
                                    )
                                    else
                                        {8982}let pkDisco_7969: bitstring = pub(sk(Disco_5317)) in
                                        {8983}in(c, (=pkCli_7935,em1_7970: bitstring,sigM1_7971: bitstring));
                                        {8984}let m1_7972: bitstring = dec(em1_7970,skSess_7932) in
                                        {8985}if (verify(h(m1_7972),sigM1_7971,pkCli_7935) <> true) then
                                            0
                                        else
                                            {8986}let (=OpenSecureChannelRequest,=pkCli_7935,Nc_7973: bitstring) = m1_7972 in
                                            {8987}new Ns_7974: bitstring;
                                            {8988}new ST_7975: bitstring;
                                            {8989}new TTL_7976: bitstring;
                                            {8990}let m2_7977: bitstring = (OpenSecureChannelResponse,Ns_7974,ST_7975,TTL_7976) in
                                            {8991}out(c, (enc(m2_7977,pkCli_7935),sign(h(m2_7977),skSess_7932)));
                                            {8992}let Ksrv_7978: bitstring = h((Ns_7974,Nc_7973)) in
                                            {8993}out(c, senc(mSrv(pkCli_7935,pkSess_7933),Ksrv_7978))
                                )
                                else
                                    {8994}let pkDisco_7979: bitstring = fail-any in
                                    {8995}in(c, (=pkCli_7935,em1_7980: bitstring,sigM1_7981: bitstring));
                                    {8996}let m1_7982: bitstring = dec(em1_7980,skSess_7932) in
                                    {8997}if (verify(h(m1_7982),sigM1_7981,pkCli_7935) <> true) then
                                        0
                                    else
                                        {8998}let (=OpenSecureChannelRequest,=pkCli_7935,Nc_7983: bitstring) = m1_7982 in
                                        {8999}new Ns_7984: bitstring;
                                        {9000}new ST_7985: bitstring;
                                        {9001}new TTL_7986: bitstring;
                                        {9002}let m2_7987: bitstring = (OpenSecureChannelResponse,Ns_7984,ST_7985,TTL_7986) in
                                        {9003}out(c, (enc(m2_7987,pkCli_7935),sign(h(m2_7987),skSess_7932)));
                                        {9004}let Ksrv_7988: bitstring = h((Ns_7984,Nc_7983)) in
                                        {9005}out(c, senc(mSrv(pkCli_7935,pkSess_7933),Ksrv_7988))
                        )
                        else
                            {9006}let pkDisco_7989: bitstring = fail-any in
                            {9007}in(c, (=pkCli_7935,em1_7990: bitstring,sigM1_7991: bitstring));
                            {9008}let m1_7992: bitstring = dec(em1_7990,skSess_7932) in
                            {9009}if (verify(h(m1_7992),sigM1_7991,pkCli_7935) <> true) then
                                0
                            else
                                {9010}let (=OpenSecureChannelRequest,=pkCli_7935,Nc_7993: bitstring) = m1_7992 in
                                {9011}new Ns_7994: bitstring;
                                {9012}new ST_7995: bitstring;
                                {9013}new TTL_7996: bitstring;
                                {9014}let m2_7997: bitstring = (OpenSecureChannelResponse,Ns_7994,ST_7995,TTL_7996) in
                                {9015}out(c, (enc(m2_7997,pkCli_7935),sign(h(m2_7997),skSess_7932)));
                                {9016}let Ksrv_7998: bitstring = h((Ns_7994,Nc_7993)) in
                                {9017}out(c, senc(mSrv(pkCli_7935,pkSess_7933),Ksrv_7998))
                )
                else
                    {9018}let pkDisco_7999: bitstring = fail-any in
                    {9019}in(c, (=pkCli_7935,em1_8000: bitstring,sigM1_8001: bitstring));
                    {9020}let m1_8002: bitstring = dec(em1_8000,skSess_7932) in
                    {9021}if (verify(h(m1_8002),sigM1_8001,pkCli_7935) <> true) then
                        0
                    else
                        {9022}let (=OpenSecureChannelRequest,=pkCli_7935,Nc_8003: bitstring) = m1_8002 in
                        {9023}new Ns_8004: bitstring;
                        {9024}new ST_8005: bitstring;
                        {9025}new TTL_8006: bitstring;
                        {9026}let m2_8007: bitstring = (OpenSecureChannelResponse,Ns_8004,ST_8005,TTL_8006) in
                        {9027}out(c, (enc(m2_8007,pkCli_7935),sign(h(m2_8007),skSess_7932)));
                        {9028}let Ksrv_8008: bitstring = h((Ns_8004,Nc_8003)) in
                        {9029}out(c, senc(mSrv(pkCli_7935,pkSess_7933),Ksrv_8008))
            )
            else
                {9030}let v_8009: bool = (Cli_5316 = B) in
                (
                    {9031}if v_8009 then
                    (
                        {9032}let pkCli_8010: bitstring = pub(skB) in
                        {9033}let v_8011: bool = (Disco_5317 = A) in
                        (
                            {9034}if v_8011 then
                            (
                                {9035}let pkDisco_8012: bitstring = pub(skA) in
                                {9036}in(c, (=pkCli_8010,em1_8013: bitstring,sigM1_8014: bitstring));
                                {9037}let m1_8015: bitstring = dec(em1_8013,skSess_7932) in
                                {9038}if (verify(h(m1_8015),sigM1_8014,pkCli_8010) <> true) then
                                    0
                                else
                                    {9039}let (=OpenSecureChannelRequest,=pkCli_8010,Nc_8016: bitstring) = m1_8015 in
                                    {9040}new Ns_8017: bitstring;
                                    {9041}new ST_8018: bitstring;
                                    {9042}new TTL_8019: bitstring;
                                    {9043}let m2_8020: bitstring = (OpenSecureChannelResponse,Ns_8017,ST_8018,TTL_8019) in
                                    {9044}out(c, (enc(m2_8020,pkCli_8010),sign(h(m2_8020),skSess_7932)));
                                    {9045}let Ksrv_8021: bitstring = h((Ns_8017,Nc_8016)) in
                                    {9046}out(c, senc(mSrv(pkCli_8010,pkSess_7933),Ksrv_8021))
                            )
                            else
                                {9047}let v_8022: bool = (Disco_5317 = B) in
                                (
                                    {9048}if v_8022 then
                                    (
                                        {9049}let pkDisco_8023: bitstring = pub(skB) in
                                        {9050}in(c, (=pkCli_8010,em1_8024: bitstring,sigM1_8025: bitstring));
                                        {9051}let m1_8026: bitstring = dec(em1_8024,skSess_7932) in
                                        {9052}if (verify(h(m1_8026),sigM1_8025,pkCli_8010) <> true) then
                                            0
                                        else
                                            {9053}let (=OpenSecureChannelRequest,=pkCli_8010,Nc_8027: bitstring) = m1_8026 in
                                            {9054}new Ns_8028: bitstring;
                                            {9055}new ST_8029: bitstring;
                                            {9056}new TTL_8030: bitstring;
                                            {9057}let m2_8031: bitstring = (OpenSecureChannelResponse,Ns_8028,ST_8029,TTL_8030) in
                                            {9058}out(c, (enc(m2_8031,pkCli_8010),sign(h(m2_8031),skSess_7932)));
                                            {9059}let Ksrv_8032: bitstring = h((Ns_8028,Nc_8027)) in
                                            {9060}out(c, senc(mSrv(pkCli_8010,pkSess_7933),Ksrv_8032))
                                    )
                                    else
                                        {9061}let v_8033: bool = (Disco_5317 = C) in
                                        (
                                            {9062}if v_8033 then
                                            (
                                                {9063}let pkDisco_8034: bitstring = pub(skC) in
                                                {9064}in(c, (=pkCli_8010,em1_8035: bitstring,sigM1_8036: bitstring));
                                                {9065}let m1_8037: bitstring = dec(em1_8035,skSess_7932) in
                                                {9066}if (verify(h(m1_8037),sigM1_8036,pkCli_8010) <> true) then
                                                    0
                                                else
                                                    {9067}let (=OpenSecureChannelRequest,=pkCli_8010,Nc_8038: bitstring) = m1_8037 in
                                                    {9068}new Ns_8039: bitstring;
                                                    {9069}new ST_8040: bitstring;
                                                    {9070}new TTL_8041: bitstring;
                                                    {9071}let m2_8042: bitstring = (OpenSecureChannelResponse,Ns_8039,ST_8040,TTL_8041) in
                                                    {9072}out(c, (enc(m2_8042,pkCli_8010),sign(h(m2_8042),skSess_7932)));
                                                    {9073}let Ksrv_8043: bitstring = h((Ns_8039,Nc_8038)) in
                                                    {9074}out(c, senc(mSrv(pkCli_8010,pkSess_7933),Ksrv_8043))
                                            )
                                            else
                                                {9075}let pkDisco_8044: bitstring = pub(sk(Disco_5317)) in
                                                {9076}in(c, (=pkCli_8010,em1_8045: bitstring,sigM1_8046: bitstring));
                                                {9077}let m1_8047: bitstring = dec(em1_8045,skSess_7932) in
                                                {9078}if (verify(h(m1_8047),sigM1_8046,pkCli_8010) <> true) then
                                                    0
                                                else
                                                    {9079}let (=OpenSecureChannelRequest,=pkCli_8010,Nc_8048: bitstring) = m1_8047 in
                                                    {9080}new Ns_8049: bitstring;
                                                    {9081}new ST_8050: bitstring;
                                                    {9082}new TTL_8051: bitstring;
                                                    {9083}let m2_8052: bitstring = (OpenSecureChannelResponse,Ns_8049,ST_8050,TTL_8051) in
                                                    {9084}out(c, (enc(m2_8052,pkCli_8010),sign(h(m2_8052),skSess_7932)));
                                                    {9085}let Ksrv_8053: bitstring = h((Ns_8049,Nc_8048)) in
                                                    {9086}out(c, senc(mSrv(pkCli_8010,pkSess_7933),Ksrv_8053))
                                        )
                                        else
                                            {9087}let pkDisco_8054: bitstring = fail-any in
                                            {9088}in(c, (=pkCli_8010,em1_8055: bitstring,sigM1_8056: bitstring));
                                            {9089}let m1_8057: bitstring = dec(em1_8055,skSess_7932) in
                                            {9090}if (verify(h(m1_8057),sigM1_8056,pkCli_8010) <> true) then
                                                0
                                            else
                                                {9091}let (=OpenSecureChannelRequest,=pkCli_8010,Nc_8058: bitstring) = m1_8057 in
                                                {9092}new Ns_8059: bitstring;
                                                {9093}new ST_8060: bitstring;
                                                {9094}new TTL_8061: bitstring;
                                                {9095}let m2_8062: bitstring = (OpenSecureChannelResponse,Ns_8059,ST_8060,TTL_8061) in
                                                {9096}out(c, (enc(m2_8062,pkCli_8010),sign(h(m2_8062),skSess_7932)));
                                                {9097}let Ksrv_8063: bitstring = h((Ns_8059,Nc_8058)) in
                                                {9098}out(c, senc(mSrv(pkCli_8010,pkSess_7933),Ksrv_8063))
                                )
                                else
                                    {9099}let pkDisco_8064: bitstring = fail-any in
                                    {9100}in(c, (=pkCli_8010,em1_8065: bitstring,sigM1_8066: bitstring));
                                    {9101}let m1_8067: bitstring = dec(em1_8065,skSess_7932) in
                                    {9102}if (verify(h(m1_8067),sigM1_8066,pkCli_8010) <> true) then
                                        0
                                    else
                                        {9103}let (=OpenSecureChannelRequest,=pkCli_8010,Nc_8068: bitstring) = m1_8067 in
                                        {9104}new Ns_8069: bitstring;
                                        {9105}new ST_8070: bitstring;
                                        {9106}new TTL_8071: bitstring;
                                        {9107}let m2_8072: bitstring = (OpenSecureChannelResponse,Ns_8069,ST_8070,TTL_8071) in
                                        {9108}out(c, (enc(m2_8072,pkCli_8010),sign(h(m2_8072),skSess_7932)));
                                        {9109}let Ksrv_8073: bitstring = h((Ns_8069,Nc_8068)) in
                                        {9110}out(c, senc(mSrv(pkCli_8010,pkSess_7933),Ksrv_8073))
                        )
                        else
                            {9111}let pkDisco_8074: bitstring = fail-any in
                            {9112}in(c, (=pkCli_8010,em1_8075: bitstring,sigM1_8076: bitstring));
                            {9113}let m1_8077: bitstring = dec(em1_8075,skSess_7932) in
                            {9114}if (verify(h(m1_8077),sigM1_8076,pkCli_8010) <> true) then
                                0
                            else
                                {9115}let (=OpenSecureChannelRequest,=pkCli_8010,Nc_8078: bitstring) = m1_8077 in
                                {9116}new Ns_8079: bitstring;
                                {9117}new ST_8080: bitstring;
                                {9118}new TTL_8081: bitstring;
                                {9119}let m2_8082: bitstring = (OpenSecureChannelResponse,Ns_8079,ST_8080,TTL_8081) in
                                {9120}out(c, (enc(m2_8082,pkCli_8010),sign(h(m2_8082),skSess_7932)));
                                {9121}let Ksrv_8083: bitstring = h((Ns_8079,Nc_8078)) in
                                {9122}out(c, senc(mSrv(pkCli_8010,pkSess_7933),Ksrv_8083))
                    )
                    else
                        {9123}let v_8084: bool = (Cli_5316 = C) in
                        (
                            {9124}if v_8084 then
                            (
                                {9125}let pkCli_8085: bitstring = pub(skC) in
                                {9126}let v_8086: bool = (Disco_5317 = A) in
                                (
                                    {9127}if v_8086 then
                                    (
                                        {9128}let pkDisco_8087: bitstring = pub(skA) in
                                        {9129}in(c, (=pkCli_8085,em1_8088: bitstring,sigM1_8089: bitstring));
                                        {9130}let m1_8090: bitstring = dec(em1_8088,skSess_7932) in
                                        {9131}if (verify(h(m1_8090),sigM1_8089,pkCli_8085) <> true) then
                                            0
                                        else
                                            {9132}let (=OpenSecureChannelRequest,=pkCli_8085,Nc_8091: bitstring) = m1_8090 in
                                            {9133}new Ns_8092: bitstring;
                                            {9134}new ST_8093: bitstring;
                                            {9135}new TTL_8094: bitstring;
                                            {9136}let m2_8095: bitstring = (OpenSecureChannelResponse,Ns_8092,ST_8093,TTL_8094) in
                                            {9137}out(c, (enc(m2_8095,pkCli_8085),sign(h(m2_8095),skSess_7932)));
                                            {9138}let Ksrv_8096: bitstring = h((Ns_8092,Nc_8091)) in
                                            {9139}out(c, senc(mSrv(pkCli_8085,pkSess_7933),Ksrv_8096))
                                    )
                                    else
                                        {9140}let v_8097: bool = (Disco_5317 = B) in
                                        (
                                            {9141}if v_8097 then
                                            (
                                                {9142}let pkDisco_8098: bitstring = pub(skB) in
                                                {9143}in(c, (=pkCli_8085,em1_8099: bitstring,sigM1_8100: bitstring));
                                                {9144}let m1_8101: bitstring = dec(em1_8099,skSess_7932) in
                                                {9145}if (verify(h(m1_8101),sigM1_8100,pkCli_8085) <> true) then
                                                    0
                                                else
                                                    {9146}let (=OpenSecureChannelRequest,=pkCli_8085,Nc_8102: bitstring) = m1_8101 in
                                                    {9147}new Ns_8103: bitstring;
                                                    {9148}new ST_8104: bitstring;
                                                    {9149}new TTL_8105: bitstring;
                                                    {9150}let m2_8106: bitstring = (OpenSecureChannelResponse,Ns_8103,ST_8104,TTL_8105) in
                                                    {9151}out(c, (enc(m2_8106,pkCli_8085),sign(h(m2_8106),skSess_7932)));
                                                    {9152}let Ksrv_8107: bitstring = h((Ns_8103,Nc_8102)) in
                                                    {9153}out(c, senc(mSrv(pkCli_8085,pkSess_7933),Ksrv_8107))
                                            )
                                            else
                                                {9154}let v_8108: bool = (Disco_5317 = C) in
                                                (
                                                    {9155}if v_8108 then
                                                    (
                                                        {9156}let pkDisco_8109: bitstring = pub(skC) in
                                                        {9157}in(c, (=pkCli_8085,em1_8110: bitstring,sigM1_8111: bitstring));
                                                        {9158}let m1_8112: bitstring = dec(em1_8110,skSess_7932) in
                                                        {9159}if (verify(h(m1_8112),sigM1_8111,pkCli_8085) <> true) then
                                                            0
                                                        else
                                                            {9160}let (=OpenSecureChannelRequest,=pkCli_8085,Nc_8113: bitstring) = m1_8112 in
                                                            {9161}new Ns_8114: bitstring;
                                                            {9162}new ST_8115: bitstring;
                                                            {9163}new TTL_8116: bitstring;
                                                            {9164}let m2_8117: bitstring = (OpenSecureChannelResponse,Ns_8114,ST_8115,TTL_8116) in
                                                            {9165}out(c, (enc(m2_8117,pkCli_8085),sign(h(m2_8117),skSess_7932)));
                                                            {9166}let Ksrv_8118: bitstring = h((Ns_8114,Nc_8113)) in
                                                            {9167}out(c, senc(mSrv(pkCli_8085,pkSess_7933),Ksrv_8118))
                                                    )
                                                    else
                                                        {9168}let pkDisco_8119: bitstring = pub(sk(Disco_5317)) in
                                                        {9169}in(c, (=pkCli_8085,em1_8120: bitstring,sigM1_8121: bitstring));
                                                        {9170}let m1_8122: bitstring = dec(em1_8120,skSess_7932) in
                                                        {9171}if (verify(h(m1_8122),sigM1_8121,pkCli_8085) <> true) then
                                                            0
                                                        else
                                                            {9172}let (=OpenSecureChannelRequest,=pkCli_8085,Nc_8123: bitstring) = m1_8122 in
                                                            {9173}new Ns_8124: bitstring;
                                                            {9174}new ST_8125: bitstring;
                                                            {9175}new TTL_8126: bitstring;
                                                            {9176}let m2_8127: bitstring = (OpenSecureChannelResponse,Ns_8124,ST_8125,TTL_8126) in
                                                            {9177}out(c, (enc(m2_8127,pkCli_8085),sign(h(m2_8127),skSess_7932)));
                                                            {9178}let Ksrv_8128: bitstring = h((Ns_8124,Nc_8123)) in
                                                            {9179}out(c, senc(mSrv(pkCli_8085,pkSess_7933),Ksrv_8128))
                                                )
                                                else
                                                    {9180}let pkDisco_8129: bitstring = fail-any in
                                                    {9181}in(c, (=pkCli_8085,em1_8130: bitstring,sigM1_8131: bitstring));
                                                    {9182}let m1_8132: bitstring = dec(em1_8130,skSess_7932) in
                                                    {9183}if (verify(h(m1_8132),sigM1_8131,pkCli_8085) <> true) then
                                                        0
                                                    else
                                                        {9184}let (=OpenSecureChannelRequest,=pkCli_8085,Nc_8133: bitstring) = m1_8132 in
                                                        {9185}new Ns_8134: bitstring;
                                                        {9186}new ST_8135: bitstring;
                                                        {9187}new TTL_8136: bitstring;
                                                        {9188}let m2_8137: bitstring = (OpenSecureChannelResponse,Ns_8134,ST_8135,TTL_8136) in
                                                        {9189}out(c, (enc(m2_8137,pkCli_8085),sign(h(m2_8137),skSess_7932)));
                                                        {9190}let Ksrv_8138: bitstring = h((Ns_8134,Nc_8133)) in
                                                        {9191}out(c, senc(mSrv(pkCli_8085,pkSess_7933),Ksrv_8138))
                                        )
                                        else
                                            {9192}let pkDisco_8139: bitstring = fail-any in
                                            {9193}in(c, (=pkCli_8085,em1_8140: bitstring,sigM1_8141: bitstring));
                                            {9194}let m1_8142: bitstring = dec(em1_8140,skSess_7932) in
                                            {9195}if (verify(h(m1_8142),sigM1_8141,pkCli_8085) <> true) then
                                                0
                                            else
                                                {9196}let (=OpenSecureChannelRequest,=pkCli_8085,Nc_8143: bitstring) = m1_8142 in
                                                {9197}new Ns_8144: bitstring;
                                                {9198}new ST_8145: bitstring;
                                                {9199}new TTL_8146: bitstring;
                                                {9200}let m2_8147: bitstring = (OpenSecureChannelResponse,Ns_8144,ST_8145,TTL_8146) in
                                                {9201}out(c, (enc(m2_8147,pkCli_8085),sign(h(m2_8147),skSess_7932)));
                                                {9202}let Ksrv_8148: bitstring = h((Ns_8144,Nc_8143)) in
                                                {9203}out(c, senc(mSrv(pkCli_8085,pkSess_7933),Ksrv_8148))
                                )
                                else
                                    {9204}let pkDisco_8149: bitstring = fail-any in
                                    {9205}in(c, (=pkCli_8085,em1_8150: bitstring,sigM1_8151: bitstring));
                                    {9206}let m1_8152: bitstring = dec(em1_8150,skSess_7932) in
                                    {9207}if (verify(h(m1_8152),sigM1_8151,pkCli_8085) <> true) then
                                        0
                                    else
                                        {9208}let (=OpenSecureChannelRequest,=pkCli_8085,Nc_8153: bitstring) = m1_8152 in
                                        {9209}new Ns_8154: bitstring;
                                        {9210}new ST_8155: bitstring;
                                        {9211}new TTL_8156: bitstring;
                                        {9212}let m2_8157: bitstring = (OpenSecureChannelResponse,Ns_8154,ST_8155,TTL_8156) in
                                        {9213}out(c, (enc(m2_8157,pkCli_8085),sign(h(m2_8157),skSess_7932)));
                                        {9214}let Ksrv_8158: bitstring = h((Ns_8154,Nc_8153)) in
                                        {9215}out(c, senc(mSrv(pkCli_8085,pkSess_7933),Ksrv_8158))
                            )
                            else
                                {9216}let pkCli_8159: bitstring = pub(sk(Cli_5316)) in
                                {9217}let v_8160: bool = (Disco_5317 = A) in
                                (
                                    {9218}if v_8160 then
                                    (
                                        {9219}let pkDisco_8161: bitstring = pub(skA) in
                                        {9220}in(c, (=pkCli_8159,em1_8162: bitstring,sigM1_8163: bitstring));
                                        {9221}let m1_8164: bitstring = dec(em1_8162,skSess_7932) in
                                        {9222}if (verify(h(m1_8164),sigM1_8163,pkCli_8159) <> true) then
                                            0
                                        else
                                            {9223}let (=OpenSecureChannelRequest,=pkCli_8159,Nc_8165: bitstring) = m1_8164 in
                                            {9224}new Ns_8166: bitstring;
                                            {9225}new ST_8167: bitstring;
                                            {9226}new TTL_8168: bitstring;
                                            {9227}let m2_8169: bitstring = (OpenSecureChannelResponse,Ns_8166,ST_8167,TTL_8168) in
                                            {9228}out(c, (enc(m2_8169,pkCli_8159),sign(h(m2_8169),skSess_7932)));
                                            {9229}let Ksrv_8170: bitstring = h((Ns_8166,Nc_8165)) in
                                            {9230}out(c, senc(mSrv(pkCli_8159,pkSess_7933),Ksrv_8170))
                                    )
                                    else
                                        {9231}let v_8171: bool = (Disco_5317 = B) in
                                        (
                                            {9232}if v_8171 then
                                            (
                                                {9233}let pkDisco_8172: bitstring = pub(skB) in
                                                {9234}in(c, (=pkCli_8159,em1_8173: bitstring,sigM1_8174: bitstring));
                                                {9235}let m1_8175: bitstring = dec(em1_8173,skSess_7932) in
                                                {9236}if (verify(h(m1_8175),sigM1_8174,pkCli_8159) <> true) then
                                                    0
                                                else
                                                    {9237}let (=OpenSecureChannelRequest,=pkCli_8159,Nc_8176: bitstring) = m1_8175 in
                                                    {9238}new Ns_8177: bitstring;
                                                    {9239}new ST_8178: bitstring;
                                                    {9240}new TTL_8179: bitstring;
                                                    {9241}let m2_8180: bitstring = (OpenSecureChannelResponse,Ns_8177,ST_8178,TTL_8179) in
                                                    {9242}out(c, (enc(m2_8180,pkCli_8159),sign(h(m2_8180),skSess_7932)));
                                                    {9243}let Ksrv_8181: bitstring = h((Ns_8177,Nc_8176)) in
                                                    {9244}out(c, senc(mSrv(pkCli_8159,pkSess_7933),Ksrv_8181))
                                            )
                                            else
                                                {9245}let v_8182: bool = (Disco_5317 = C) in
                                                (
                                                    {9246}if v_8182 then
                                                    (
                                                        {9247}let pkDisco_8183: bitstring = pub(skC) in
                                                        {9248}in(c, (=pkCli_8159,em1_8184: bitstring,sigM1_8185: bitstring));
                                                        {9249}let m1_8186: bitstring = dec(em1_8184,skSess_7932) in
                                                        {9250}if (verify(h(m1_8186),sigM1_8185,pkCli_8159) <> true) then
                                                            0
                                                        else
                                                            {9251}let (=OpenSecureChannelRequest,=pkCli_8159,Nc_8187: bitstring) = m1_8186 in
                                                            {9252}new Ns_8188: bitstring;
                                                            {9253}new ST_8189: bitstring;
                                                            {9254}new TTL_8190: bitstring;
                                                            {9255}let m2_8191: bitstring = (OpenSecureChannelResponse,Ns_8188,ST_8189,TTL_8190) in
                                                            {9256}out(c, (enc(m2_8191,pkCli_8159),sign(h(m2_8191),skSess_7932)));
                                                            {9257}let Ksrv_8192: bitstring = h((Ns_8188,Nc_8187)) in
                                                            {9258}out(c, senc(mSrv(pkCli_8159,pkSess_7933),Ksrv_8192))
                                                    )
                                                    else
                                                        {9259}let pkDisco_8193: bitstring = pub(sk(Disco_5317)) in
                                                        {9260}in(c, (=pkCli_8159,em1_8194: bitstring,sigM1_8195: bitstring));
                                                        {9261}let m1_8196: bitstring = dec(em1_8194,skSess_7932) in
                                                        {9262}if (verify(h(m1_8196),sigM1_8195,pkCli_8159) <> true) then
                                                            0
                                                        else
                                                            {9263}let (=OpenSecureChannelRequest,=pkCli_8159,Nc_8197: bitstring) = m1_8196 in
                                                            {9264}new Ns_8198: bitstring;
                                                            {9265}new ST_8199: bitstring;
                                                            {9266}new TTL_8200: bitstring;
                                                            {9267}let m2_8201: bitstring = (OpenSecureChannelResponse,Ns_8198,ST_8199,TTL_8200) in
                                                            {9268}out(c, (enc(m2_8201,pkCli_8159),sign(h(m2_8201),skSess_7932)));
                                                            {9269}let Ksrv_8202: bitstring = h((Ns_8198,Nc_8197)) in
                                                            {9270}out(c, senc(mSrv(pkCli_8159,pkSess_7933),Ksrv_8202))
                                                )
                                                else
                                                    {9271}let pkDisco_8203: bitstring = fail-any in
                                                    {9272}in(c, (=pkCli_8159,em1_8204: bitstring,sigM1_8205: bitstring));
                                                    {9273}let m1_8206: bitstring = dec(em1_8204,skSess_7932) in
                                                    {9274}if (verify(h(m1_8206),sigM1_8205,pkCli_8159) <> true) then
                                                        0
                                                    else
                                                        {9275}let (=OpenSecureChannelRequest,=pkCli_8159,Nc_8207: bitstring) = m1_8206 in
                                                        {9276}new Ns_8208: bitstring;
                                                        {9277}new ST_8209: bitstring;
                                                        {9278}new TTL_8210: bitstring;
                                                        {9279}let m2_8211: bitstring = (OpenSecureChannelResponse,Ns_8208,ST_8209,TTL_8210) in
                                                        {9280}out(c, (enc(m2_8211,pkCli_8159),sign(h(m2_8211),skSess_7932)));
                                                        {9281}let Ksrv_8212: bitstring = h((Ns_8208,Nc_8207)) in
                                                        {9282}out(c, senc(mSrv(pkCli_8159,pkSess_7933),Ksrv_8212))
                                        )
                                        else
                                            {9283}let pkDisco_8213: bitstring = fail-any in
                                            {9284}in(c, (=pkCli_8159,em1_8214: bitstring,sigM1_8215: bitstring));
                                            {9285}let m1_8216: bitstring = dec(em1_8214,skSess_7932) in
                                            {9286}if (verify(h(m1_8216),sigM1_8215,pkCli_8159) <> true) then
                                                0
                                            else
                                                {9287}let (=OpenSecureChannelRequest,=pkCli_8159,Nc_8217: bitstring) = m1_8216 in
                                                {9288}new Ns_8218: bitstring;
                                                {9289}new ST_8219: bitstring;
                                                {9290}new TTL_8220: bitstring;
                                                {9291}let m2_8221: bitstring = (OpenSecureChannelResponse,Ns_8218,ST_8219,TTL_8220) in
                                                {9292}out(c, (enc(m2_8221,pkCli_8159),sign(h(m2_8221),skSess_7932)));
                                                {9293}let Ksrv_8222: bitstring = h((Ns_8218,Nc_8217)) in
                                                {9294}out(c, senc(mSrv(pkCli_8159,pkSess_7933),Ksrv_8222))
                                )
                                else
                                    {9295}let pkDisco_8223: bitstring = fail-any in
                                    {9296}in(c, (=pkCli_8159,em1_8224: bitstring,sigM1_8225: bitstring));
                                    {9297}let m1_8226: bitstring = dec(em1_8224,skSess_7932) in
                                    {9298}if (verify(h(m1_8226),sigM1_8225,pkCli_8159) <> true) then
                                        0
                                    else
                                        {9299}let (=OpenSecureChannelRequest,=pkCli_8159,Nc_8227: bitstring) = m1_8226 in
                                        {9300}new Ns_8228: bitstring;
                                        {9301}new ST_8229: bitstring;
                                        {9302}new TTL_8230: bitstring;
                                        {9303}let m2_8231: bitstring = (OpenSecureChannelResponse,Ns_8228,ST_8229,TTL_8230) in
                                        {9304}out(c, (enc(m2_8231,pkCli_8159),sign(h(m2_8231),skSess_7932)));
                                        {9305}let Ksrv_8232: bitstring = h((Ns_8228,Nc_8227)) in
                                        {9306}out(c, senc(mSrv(pkCli_8159,pkSess_7933),Ksrv_8232))
                        )
                        else
                            {9307}let pkCli_8233: bitstring = fail-any in
                            {9308}let v_8234: bool = (Disco_5317 = A) in
                            (
                                {9309}if v_8234 then
                                (
                                    {9310}let pkDisco_8235: bitstring = pub(skA) in
                                    {9311}in(c, (=pkCli_8233,em1_8236: bitstring,sigM1_8237: bitstring));
                                    {9312}let m1_8238: bitstring = dec(em1_8236,skSess_7932) in
                                    {9313}if (verify(h(m1_8238),sigM1_8237,pkCli_8233) <> true) then
                                        0
                                    else
                                        {9314}let (=OpenSecureChannelRequest,=pkCli_8233,Nc_8239: bitstring) = m1_8238 in
                                        {9315}new Ns_8240: bitstring;
                                        {9316}new ST_8241: bitstring;
                                        {9317}new TTL_8242: bitstring;
                                        {9318}let m2_8243: bitstring = (OpenSecureChannelResponse,Ns_8240,ST_8241,TTL_8242) in
                                        {9319}out(c, (enc(m2_8243,pkCli_8233),sign(h(m2_8243),skSess_7932)));
                                        {9320}let Ksrv_8244: bitstring = h((Ns_8240,Nc_8239)) in
                                        {9321}out(c, senc(mSrv(pkCli_8233,pkSess_7933),Ksrv_8244))
                                )
                                else
                                    {9322}let v_8245: bool = (Disco_5317 = B) in
                                    (
                                        {9323}if v_8245 then
                                        (
                                            {9324}let pkDisco_8246: bitstring = pub(skB) in
                                            {9325}in(c, (=pkCli_8233,em1_8247: bitstring,sigM1_8248: bitstring));
                                            {9326}let m1_8249: bitstring = dec(em1_8247,skSess_7932) in
                                            {9327}if (verify(h(m1_8249),sigM1_8248,pkCli_8233) <> true) then
                                                0
                                            else
                                                {9328}let (=OpenSecureChannelRequest,=pkCli_8233,Nc_8250: bitstring) = m1_8249 in
                                                {9329}new Ns_8251: bitstring;
                                                {9330}new ST_8252: bitstring;
                                                {9331}new TTL_8253: bitstring;
                                                {9332}let m2_8254: bitstring = (OpenSecureChannelResponse,Ns_8251,ST_8252,TTL_8253) in
                                                {9333}out(c, (enc(m2_8254,pkCli_8233),sign(h(m2_8254),skSess_7932)));
                                                {9334}let Ksrv_8255: bitstring = h((Ns_8251,Nc_8250)) in
                                                {9335}out(c, senc(mSrv(pkCli_8233,pkSess_7933),Ksrv_8255))
                                        )
                                        else
                                            {9336}let v_8256: bool = (Disco_5317 = C) in
                                            (
                                                {9337}if v_8256 then
                                                (
                                                    {9338}let pkDisco_8257: bitstring = pub(skC) in
                                                    {9339}in(c, (=pkCli_8233,em1_8258: bitstring,sigM1_8259: bitstring));
                                                    {9340}let m1_8260: bitstring = dec(em1_8258,skSess_7932) in
                                                    {9341}if (verify(h(m1_8260),sigM1_8259,pkCli_8233) <> true) then
                                                        0
                                                    else
                                                        {9342}let (=OpenSecureChannelRequest,=pkCli_8233,Nc_8261: bitstring) = m1_8260 in
                                                        {9343}new Ns_8262: bitstring;
                                                        {9344}new ST_8263: bitstring;
                                                        {9345}new TTL_8264: bitstring;
                                                        {9346}let m2_8265: bitstring = (OpenSecureChannelResponse,Ns_8262,ST_8263,TTL_8264) in
                                                        {9347}out(c, (enc(m2_8265,pkCli_8233),sign(h(m2_8265),skSess_7932)));
                                                        {9348}let Ksrv_8266: bitstring = h((Ns_8262,Nc_8261)) in
                                                        {9349}out(c, senc(mSrv(pkCli_8233,pkSess_7933),Ksrv_8266))
                                                )
                                                else
                                                    {9350}let pkDisco_8267: bitstring = pub(sk(Disco_5317)) in
                                                    {9351}in(c, (=pkCli_8233,em1_8268: bitstring,sigM1_8269: bitstring));
                                                    {9352}let m1_8270: bitstring = dec(em1_8268,skSess_7932) in
                                                    {9353}if (verify(h(m1_8270),sigM1_8269,pkCli_8233) <> true) then
                                                        0
                                                    else
                                                        {9354}let (=OpenSecureChannelRequest,=pkCli_8233,Nc_8271: bitstring) = m1_8270 in
                                                        {9355}new Ns_8272: bitstring;
                                                        {9356}new ST_8273: bitstring;
                                                        {9357}new TTL_8274: bitstring;
                                                        {9358}let m2_8275: bitstring = (OpenSecureChannelResponse,Ns_8272,ST_8273,TTL_8274) in
                                                        {9359}out(c, (enc(m2_8275,pkCli_8233),sign(h(m2_8275),skSess_7932)));
                                                        {9360}let Ksrv_8276: bitstring = h((Ns_8272,Nc_8271)) in
                                                        {9361}out(c, senc(mSrv(pkCli_8233,pkSess_7933),Ksrv_8276))
                                            )
                                            else
                                                {9362}let pkDisco_8277: bitstring = fail-any in
                                                {9363}in(c, (=pkCli_8233,em1_8278: bitstring,sigM1_8279: bitstring));
                                                {9364}let m1_8280: bitstring = dec(em1_8278,skSess_7932) in
                                                {9365}if (verify(h(m1_8280),sigM1_8279,pkCli_8233) <> true) then
                                                    0
                                                else
                                                    {9366}let (=OpenSecureChannelRequest,=pkCli_8233,Nc_8281: bitstring) = m1_8280 in
                                                    {9367}new Ns_8282: bitstring;
                                                    {9368}new ST_8283: bitstring;
                                                    {9369}new TTL_8284: bitstring;
                                                    {9370}let m2_8285: bitstring = (OpenSecureChannelResponse,Ns_8282,ST_8283,TTL_8284) in
                                                    {9371}out(c, (enc(m2_8285,pkCli_8233),sign(h(m2_8285),skSess_7932)));
                                                    {9372}let Ksrv_8286: bitstring = h((Ns_8282,Nc_8281)) in
                                                    {9373}out(c, senc(mSrv(pkCli_8233,pkSess_7933),Ksrv_8286))
                                    )
                                    else
                                        {9374}let pkDisco_8287: bitstring = fail-any in
                                        {9375}in(c, (=pkCli_8233,em1_8288: bitstring,sigM1_8289: bitstring));
                                        {9376}let m1_8290: bitstring = dec(em1_8288,skSess_7932) in
                                        {9377}if (verify(h(m1_8290),sigM1_8289,pkCli_8233) <> true) then
                                            0
                                        else
                                            {9378}let (=OpenSecureChannelRequest,=pkCli_8233,Nc_8291: bitstring) = m1_8290 in
                                            {9379}new Ns_8292: bitstring;
                                            {9380}new ST_8293: bitstring;
                                            {9381}new TTL_8294: bitstring;
                                            {9382}let m2_8295: bitstring = (OpenSecureChannelResponse,Ns_8292,ST_8293,TTL_8294) in
                                            {9383}out(c, (enc(m2_8295,pkCli_8233),sign(h(m2_8295),skSess_7932)));
                                            {9384}let Ksrv_8296: bitstring = h((Ns_8292,Nc_8291)) in
                                            {9385}out(c, senc(mSrv(pkCli_8233,pkSess_7933),Ksrv_8296))
                            )
                            else
                                {9386}let pkDisco_8297: bitstring = fail-any in
                                {9387}in(c, (=pkCli_8233,em1_8298: bitstring,sigM1_8299: bitstring));
                                {9388}let m1_8300: bitstring = dec(em1_8298,skSess_7932) in
                                {9389}if (verify(h(m1_8300),sigM1_8299,pkCli_8233) <> true) then
                                    0
                                else
                                    {9390}let (=OpenSecureChannelRequest,=pkCli_8233,Nc_8301: bitstring) = m1_8300 in
                                    {9391}new Ns_8302: bitstring;
                                    {9392}new ST_8303: bitstring;
                                    {9393}new TTL_8304: bitstring;
                                    {9394}let m2_8305: bitstring = (OpenSecureChannelResponse,Ns_8302,ST_8303,TTL_8304) in
                                    {9395}out(c, (enc(m2_8305,pkCli_8233),sign(h(m2_8305),skSess_7932)));
                                    {9396}let Ksrv_8306: bitstring = h((Ns_8302,Nc_8301)) in
                                    {9397}out(c, senc(mSrv(pkCli_8233,pkSess_7933),Ksrv_8306))
                )
                else
                    {9398}let pkCli_8307: bitstring = fail-any in
                    {9399}let v_8308: bool = (Disco_5317 = A) in
                    (
                        {9400}if v_8308 then
                        (
                            {9401}let pkDisco_8309: bitstring = pub(skA) in
                            {9402}in(c, (=pkCli_8307,em1_8310: bitstring,sigM1_8311: bitstring));
                            {9403}let m1_8312: bitstring = dec(em1_8310,skSess_7932) in
                            {9404}if (verify(h(m1_8312),sigM1_8311,pkCli_8307) <> true) then
                                0
                            else
                                {9405}let (=OpenSecureChannelRequest,=pkCli_8307,Nc_8313: bitstring) = m1_8312 in
                                {9406}new Ns_8314: bitstring;
                                {9407}new ST_8315: bitstring;
                                {9408}new TTL_8316: bitstring;
                                {9409}let m2_8317: bitstring = (OpenSecureChannelResponse,Ns_8314,ST_8315,TTL_8316) in
                                {9410}out(c, (enc(m2_8317,pkCli_8307),sign(h(m2_8317),skSess_7932)));
                                {9411}let Ksrv_8318: bitstring = h((Ns_8314,Nc_8313)) in
                                {9412}out(c, senc(mSrv(pkCli_8307,pkSess_7933),Ksrv_8318))
                        )
                        else
                            {9413}let v_8319: bool = (Disco_5317 = B) in
                            (
                                {9414}if v_8319 then
                                (
                                    {9415}let pkDisco_8320: bitstring = pub(skB) in
                                    {9416}in(c, (=pkCli_8307,em1_8321: bitstring,sigM1_8322: bitstring));
                                    {9417}let m1_8323: bitstring = dec(em1_8321,skSess_7932) in
                                    {9418}if (verify(h(m1_8323),sigM1_8322,pkCli_8307) <> true) then
                                        0
                                    else
                                        {9419}let (=OpenSecureChannelRequest,=pkCli_8307,Nc_8324: bitstring) = m1_8323 in
                                        {9420}new Ns_8325: bitstring;
                                        {9421}new ST_8326: bitstring;
                                        {9422}new TTL_8327: bitstring;
                                        {9423}let m2_8328: bitstring = (OpenSecureChannelResponse,Ns_8325,ST_8326,TTL_8327) in
                                        {9424}out(c, (enc(m2_8328,pkCli_8307),sign(h(m2_8328),skSess_7932)));
                                        {9425}let Ksrv_8329: bitstring = h((Ns_8325,Nc_8324)) in
                                        {9426}out(c, senc(mSrv(pkCli_8307,pkSess_7933),Ksrv_8329))
                                )
                                else
                                    {9427}let v_8330: bool = (Disco_5317 = C) in
                                    (
                                        {9428}if v_8330 then
                                        (
                                            {9429}let pkDisco_8331: bitstring = pub(skC) in
                                            {9430}in(c, (=pkCli_8307,em1_8332: bitstring,sigM1_8333: bitstring));
                                            {9431}let m1_8334: bitstring = dec(em1_8332,skSess_7932) in
                                            {9432}if (verify(h(m1_8334),sigM1_8333,pkCli_8307) <> true) then
                                                0
                                            else
                                                {9433}let (=OpenSecureChannelRequest,=pkCli_8307,Nc_8335: bitstring) = m1_8334 in
                                                {9434}new Ns_8336: bitstring;
                                                {9435}new ST_8337: bitstring;
                                                {9436}new TTL_8338: bitstring;
                                                {9437}let m2_8339: bitstring = (OpenSecureChannelResponse,Ns_8336,ST_8337,TTL_8338) in
                                                {9438}out(c, (enc(m2_8339,pkCli_8307),sign(h(m2_8339),skSess_7932)));
                                                {9439}let Ksrv_8340: bitstring = h((Ns_8336,Nc_8335)) in
                                                {9440}out(c, senc(mSrv(pkCli_8307,pkSess_7933),Ksrv_8340))
                                        )
                                        else
                                            {9441}let pkDisco_8341: bitstring = pub(sk(Disco_5317)) in
                                            {9442}in(c, (=pkCli_8307,em1_8342: bitstring,sigM1_8343: bitstring));
                                            {9443}let m1_8344: bitstring = dec(em1_8342,skSess_7932) in
                                            {9444}if (verify(h(m1_8344),sigM1_8343,pkCli_8307) <> true) then
                                                0
                                            else
                                                {9445}let (=OpenSecureChannelRequest,=pkCli_8307,Nc_8345: bitstring) = m1_8344 in
                                                {9446}new Ns_8346: bitstring;
                                                {9447}new ST_8347: bitstring;
                                                {9448}new TTL_8348: bitstring;
                                                {9449}let m2_8349: bitstring = (OpenSecureChannelResponse,Ns_8346,ST_8347,TTL_8348) in
                                                {9450}out(c, (enc(m2_8349,pkCli_8307),sign(h(m2_8349),skSess_7932)));
                                                {9451}let Ksrv_8350: bitstring = h((Ns_8346,Nc_8345)) in
                                                {9452}out(c, senc(mSrv(pkCli_8307,pkSess_7933),Ksrv_8350))
                                    )
                                    else
                                        {9453}let pkDisco_8351: bitstring = fail-any in
                                        {9454}in(c, (=pkCli_8307,em1_8352: bitstring,sigM1_8353: bitstring));
                                        {9455}let m1_8354: bitstring = dec(em1_8352,skSess_7932) in
                                        {9456}if (verify(h(m1_8354),sigM1_8353,pkCli_8307) <> true) then
                                            0
                                        else
                                            {9457}let (=OpenSecureChannelRequest,=pkCli_8307,Nc_8355: bitstring) = m1_8354 in
                                            {9458}new Ns_8356: bitstring;
                                            {9459}new ST_8357: bitstring;
                                            {9460}new TTL_8358: bitstring;
                                            {9461}let m2_8359: bitstring = (OpenSecureChannelResponse,Ns_8356,ST_8357,TTL_8358) in
                                            {9462}out(c, (enc(m2_8359,pkCli_8307),sign(h(m2_8359),skSess_7932)));
                                            {9463}let Ksrv_8360: bitstring = h((Ns_8356,Nc_8355)) in
                                            {9464}out(c, senc(mSrv(pkCli_8307,pkSess_7933),Ksrv_8360))
                            )
                            else
                                {9465}let pkDisco_8361: bitstring = fail-any in
                                {9466}in(c, (=pkCli_8307,em1_8362: bitstring,sigM1_8363: bitstring));
                                {9467}let m1_8364: bitstring = dec(em1_8362,skSess_7932) in
                                {9468}if (verify(h(m1_8364),sigM1_8363,pkCli_8307) <> true) then
                                    0
                                else
                                    {9469}let (=OpenSecureChannelRequest,=pkCli_8307,Nc_8365: bitstring) = m1_8364 in
                                    {9470}new Ns_8366: bitstring;
                                    {9471}new ST_8367: bitstring;
                                    {9472}new TTL_8368: bitstring;
                                    {9473}let m2_8369: bitstring = (OpenSecureChannelResponse,Ns_8366,ST_8367,TTL_8368) in
                                    {9474}out(c, (enc(m2_8369,pkCli_8307),sign(h(m2_8369),skSess_7932)));
                                    {9475}let Ksrv_8370: bitstring = h((Ns_8366,Nc_8365)) in
                                    {9476}out(c, senc(mSrv(pkCli_8307,pkSess_7933),Ksrv_8370))
                    )
                    else
                        {9477}let pkDisco_8371: bitstring = fail-any in
                        {9478}in(c, (=pkCli_8307,em1_8372: bitstring,sigM1_8373: bitstring));
                        {9479}let m1_8374: bitstring = dec(em1_8372,skSess_7932) in
                        {9480}if (verify(h(m1_8374),sigM1_8373,pkCli_8307) <> true) then
                            0
                        else
                            {9481}let (=OpenSecureChannelRequest,=pkCli_8307,Nc_8375: bitstring) = m1_8374 in
                            {9482}new Ns_8376: bitstring;
                            {9483}new ST_8377: bitstring;
                            {9484}new TTL_8378: bitstring;
                            {9485}let m2_8379: bitstring = (OpenSecureChannelResponse,Ns_8376,ST_8377,TTL_8378) in
                            {9486}out(c, (enc(m2_8379,pkCli_8307),sign(h(m2_8379),skSess_7932)));
                            {9487}let Ksrv_8380: bitstring = h((Ns_8376,Nc_8375)) in
                            {9488}out(c, senc(mSrv(pkCli_8307,pkSess_7933),Ksrv_8380))
        )
        else
            {9489}let pkCli_8381: bitstring = fail-any in
            {9490}let v_8382: bool = (Disco_5317 = A) in
            (
                {9491}if v_8382 then
                (
                    {9492}let pkDisco_8383: bitstring = pub(skA) in
                    {9493}in(c, (=pkCli_8381,em1_8384: bitstring,sigM1_8385: bitstring));
                    {9494}let m1_8386: bitstring = dec(em1_8384,skSess_7932) in
                    {9495}if (verify(h(m1_8386),sigM1_8385,pkCli_8381) <> true) then
                        0
                    else
                        {9496}let (=OpenSecureChannelRequest,=pkCli_8381,Nc_8387: bitstring) = m1_8386 in
                        {9497}new Ns_8388: bitstring;
                        {9498}new ST_8389: bitstring;
                        {9499}new TTL_8390: bitstring;
                        {9500}let m2_8391: bitstring = (OpenSecureChannelResponse,Ns_8388,ST_8389,TTL_8390) in
                        {9501}out(c, (enc(m2_8391,pkCli_8381),sign(h(m2_8391),skSess_7932)));
                        {9502}let Ksrv_8392: bitstring = h((Ns_8388,Nc_8387)) in
                        {9503}out(c, senc(mSrv(pkCli_8381,pkSess_7933),Ksrv_8392))
                )
                else
                    {9504}let v_8393: bool = (Disco_5317 = B) in
                    (
                        {9505}if v_8393 then
                        (
                            {9506}let pkDisco_8394: bitstring = pub(skB) in
                            {9507}in(c, (=pkCli_8381,em1_8395: bitstring,sigM1_8396: bitstring));
                            {9508}let m1_8397: bitstring = dec(em1_8395,skSess_7932) in
                            {9509}if (verify(h(m1_8397),sigM1_8396,pkCli_8381) <> true) then
                                0
                            else
                                {9510}let (=OpenSecureChannelRequest,=pkCli_8381,Nc_8398: bitstring) = m1_8397 in
                                {9511}new Ns_8399: bitstring;
                                {9512}new ST_8400: bitstring;
                                {9513}new TTL_8401: bitstring;
                                {9514}let m2_8402: bitstring = (OpenSecureChannelResponse,Ns_8399,ST_8400,TTL_8401) in
                                {9515}out(c, (enc(m2_8402,pkCli_8381),sign(h(m2_8402),skSess_7932)));
                                {9516}let Ksrv_8403: bitstring = h((Ns_8399,Nc_8398)) in
                                {9517}out(c, senc(mSrv(pkCli_8381,pkSess_7933),Ksrv_8403))
                        )
                        else
                            {9518}let v_8404: bool = (Disco_5317 = C) in
                            (
                                {9519}if v_8404 then
                                (
                                    {9520}let pkDisco_8405: bitstring = pub(skC) in
                                    {9521}in(c, (=pkCli_8381,em1_8406: bitstring,sigM1_8407: bitstring));
                                    {9522}let m1_8408: bitstring = dec(em1_8406,skSess_7932) in
                                    {9523}if (verify(h(m1_8408),sigM1_8407,pkCli_8381) <> true) then
                                        0
                                    else
                                        {9524}let (=OpenSecureChannelRequest,=pkCli_8381,Nc_8409: bitstring) = m1_8408 in
                                        {9525}new Ns_8410: bitstring;
                                        {9526}new ST_8411: bitstring;
                                        {9527}new TTL_8412: bitstring;
                                        {9528}let m2_8413: bitstring = (OpenSecureChannelResponse,Ns_8410,ST_8411,TTL_8412) in
                                        {9529}out(c, (enc(m2_8413,pkCli_8381),sign(h(m2_8413),skSess_7932)));
                                        {9530}let Ksrv_8414: bitstring = h((Ns_8410,Nc_8409)) in
                                        {9531}out(c, senc(mSrv(pkCli_8381,pkSess_7933),Ksrv_8414))
                                )
                                else
                                    {9532}let pkDisco_8415: bitstring = pub(sk(Disco_5317)) in
                                    {9533}in(c, (=pkCli_8381,em1_8416: bitstring,sigM1_8417: bitstring));
                                    {9534}let m1_8418: bitstring = dec(em1_8416,skSess_7932) in
                                    {9535}if (verify(h(m1_8418),sigM1_8417,pkCli_8381) <> true) then
                                        0
                                    else
                                        {9536}let (=OpenSecureChannelRequest,=pkCli_8381,Nc_8419: bitstring) = m1_8418 in
                                        {9537}new Ns_8420: bitstring;
                                        {9538}new ST_8421: bitstring;
                                        {9539}new TTL_8422: bitstring;
                                        {9540}let m2_8423: bitstring = (OpenSecureChannelResponse,Ns_8420,ST_8421,TTL_8422) in
                                        {9541}out(c, (enc(m2_8423,pkCli_8381),sign(h(m2_8423),skSess_7932)));
                                        {9542}let Ksrv_8424: bitstring = h((Ns_8420,Nc_8419)) in
                                        {9543}out(c, senc(mSrv(pkCli_8381,pkSess_7933),Ksrv_8424))
                            )
                            else
                                {9544}let pkDisco_8425: bitstring = fail-any in
                                {9545}in(c, (=pkCli_8381,em1_8426: bitstring,sigM1_8427: bitstring));
                                {9546}let m1_8428: bitstring = dec(em1_8426,skSess_7932) in
                                {9547}if (verify(h(m1_8428),sigM1_8427,pkCli_8381) <> true) then
                                    0
                                else
                                    {9548}let (=OpenSecureChannelRequest,=pkCli_8381,Nc_8429: bitstring) = m1_8428 in
                                    {9549}new Ns_8430: bitstring;
                                    {9550}new ST_8431: bitstring;
                                    {9551}new TTL_8432: bitstring;
                                    {9552}let m2_8433: bitstring = (OpenSecureChannelResponse,Ns_8430,ST_8431,TTL_8432) in
                                    {9553}out(c, (enc(m2_8433,pkCli_8381),sign(h(m2_8433),skSess_7932)));
                                    {9554}let Ksrv_8434: bitstring = h((Ns_8430,Nc_8429)) in
                                    {9555}out(c, senc(mSrv(pkCli_8381,pkSess_7933),Ksrv_8434))
                    )
                    else
                        {9556}let pkDisco_8435: bitstring = fail-any in
                        {9557}in(c, (=pkCli_8381,em1_8436: bitstring,sigM1_8437: bitstring));
                        {9558}let m1_8438: bitstring = dec(em1_8436,skSess_7932) in
                        {9559}if (verify(h(m1_8438),sigM1_8437,pkCli_8381) <> true) then
                            0
                        else
                            {9560}let (=OpenSecureChannelRequest,=pkCli_8381,Nc_8439: bitstring) = m1_8438 in
                            {9561}new Ns_8440: bitstring;
                            {9562}new ST_8441: bitstring;
                            {9563}new TTL_8442: bitstring;
                            {9564}let m2_8443: bitstring = (OpenSecureChannelResponse,Ns_8440,ST_8441,TTL_8442) in
                            {9565}out(c, (enc(m2_8443,pkCli_8381),sign(h(m2_8443),skSess_7932)));
                            {9566}let Ksrv_8444: bitstring = h((Ns_8440,Nc_8439)) in
                            {9567}out(c, senc(mSrv(pkCli_8381,pkSess_7933),Ksrv_8444))
            )
            else
                {9568}let pkDisco_8445: bitstring = fail-any in
                {9569}in(c, (=pkCli_8381,em1_8446: bitstring,sigM1_8447: bitstring));
                {9570}let m1_8448: bitstring = dec(em1_8446,skSess_7932) in
                {9571}if (verify(h(m1_8448),sigM1_8447,pkCli_8381) <> true) then
                    0
                else
                    {9572}let (=OpenSecureChannelRequest,=pkCli_8381,Nc_8449: bitstring) = m1_8448 in
                    {9573}new Ns_8450: bitstring;
                    {9574}new ST_8451: bitstring;
                    {9575}new TTL_8452: bitstring;
                    {9576}let m2_8453: bitstring = (OpenSecureChannelResponse,Ns_8450,ST_8451,TTL_8452) in
                    {9577}out(c, (enc(m2_8453,pkCli_8381),sign(h(m2_8453),skSess_7932)));
                    {9578}let Ksrv_8454: bitstring = h((Ns_8450,Nc_8449)) in
                    {9579}out(c, senc(mSrv(pkCli_8381,pkSess_7933),Ksrv_8454))
)

-- Query not attacker(mSrv(pub(skA[]),pub(skC[])))
Completing...
200 rules inserted. The rule base contains 123 rules. 388 rules in the queue.
400 rules inserted. The rule base contains 229 rules. 388 rules in the queue.
600 rules inserted. The rule base contains 315 rules. 386 rules in the queue.
800 rules inserted. The rule base contains 435 rules. 386 rules in the queue.
1000 rules inserted. The rule base contains 441 rules. 378 rules in the queue.
1200 rules inserted. The rule base contains 459 rules. 360 rules in the queue.
1400 rules inserted. The rule base contains 497 rules. 322 rules in the queue.
1600 rules inserted. The rule base contains 521 rules. 347 rules in the queue.
1800 rules inserted. The rule base contains 543 rules. 570 rules in the queue.
2000 rules inserted. The rule base contains 610 rules. 811 rules in the queue.
2200 rules inserted. The rule base contains 721 rules. 1570 rules in the queue.
2400 rules inserted. The rule base contains 789 rules. 1650 rules in the queue.
2600 rules inserted. The rule base contains 899 rules. 1516 rules in the queue.
2800 rules inserted. The rule base contains 1001 rules. 1538 rules in the queue.
3000 rules inserted. The rule base contains 1091 rules. 1412 rules in the queue.
3200 rules inserted. The rule base contains 1206 rules. 1347 rules in the queue.
3400 rules inserted. The rule base contains 1319 rules. 1284 rules in the queue.
3600 rules inserted. The rule base contains 1420 rules. 1282 rules in the queue.
3800 rules inserted. The rule base contains 1511 rules. 1180 rules in the queue.
4000 rules inserted. The rule base contains 1611 rules. 1050 rules in the queue.
4200 rules inserted. The rule base contains 1629 rules. 989 rules in the queue.
4400 rules inserted. The rule base contains 1701 rules. 902 rules in the queue.
4600 rules inserted. The rule base contains 1750 rules. 827 rules in the queue.
4800 rules inserted. The rule base contains 1803 rules. 760 rules in the queue.
5000 rules inserted. The rule base contains 1857 rules. 691 rules in the queue.
5200 rules inserted. The rule base contains 1816 rules. 795 rules in the queue.
5400 rules inserted. The rule base contains 1758 rules. 981 rules in the queue.
5600 rules inserted. The rule base contains 1659 rules. 1144 rules in the queue.
5800 rules inserted. The rule base contains 1703 rules. 1333 rules in the queue.
6000 rules inserted. The rule base contains 1755 rules. 1482 rules in the queue.
6200 rules inserted. The rule base contains 1815 rules. 1568 rules in the queue.
6400 rules inserted. The rule base contains 1875 rules. 1654 rules in the queue.
6600 rules inserted. The rule base contains 1935 rules. 1740 rules in the queue.
6800 rules inserted. The rule base contains 1995 rules. 1826 rules in the queue.
7000 rules inserted. The rule base contains 2085 rules. 1868 rules in the queue.
7200 rules inserted. The rule base contains 2237 rules. 1978 rules in the queue.
7400 rules inserted. The rule base contains 2347 rules. 2129 rules in the queue.
7600 rules inserted. The rule base contains 2456 rules. 2326 rules in the queue.
7800 rules inserted. The rule base contains 2566 rules. 2500 rules in the queue.
8000 rules inserted. The rule base contains 2676 rules. 2674 rules in the queue.
8200 rules inserted. The rule base contains 2784 rules. 2877 rules in the queue.
8400 rules inserted. The rule base contains 2895 rules. 3022 rules in the queue.
8600 rules inserted. The rule base contains 3014 rules. 3306 rules in the queue.
8800 rules inserted. The rule base contains 3098 rules. 3231 rules in the queue.
9000 rules inserted. The rule base contains 3228 rules. 3171 rules in the queue.
9200 rules inserted. The rule base contains 3373 rules. 3161 rules in the queue.
9400 rules inserted. The rule base contains 3510 rules. 3190 rules in the queue.
9600 rules inserted. The rule base contains 3639 rules. 3225 rules in the queue.
9800 rules inserted. The rule base contains 3787 rules. 3259 rules in the queue.
10000 rules inserted. The rule base contains 3935 rules. 3276 rules in the queue.
10200 rules inserted. The rule base contains 4086 rules. 3204 rules in the queue.
10400 rules inserted. The rule base contains 4228 rules. 3291 rules in the queue.
10600 rules inserted. The rule base contains 4365 rules. 3263 rules in the queue.
10800 rules inserted. The rule base contains 4507 rules. 3263 rules in the queue.
11000 rules inserted. The rule base contains 4641 rules. 3389 rules in the queue.
11200 rules inserted. The rule base contains 4781 rules. 3321 rules in the queue.
11400 rules inserted. The rule base contains 4944 rules. 3274 rules in the queue.
11600 rules inserted. The rule base contains 5090 rules. 3274 rules in the queue.
11800 rules inserted. The rule base contains 5094 rules. 3372 rules in the queue.
12000 rules inserted. The rule base contains 5241 rules. 3251 rules in the queue.
12200 rules inserted. The rule base contains 5371 rules. 3206 rules in the queue.
12400 rules inserted. The rule base contains 5508 rules. 3235 rules in the queue.
12600 rules inserted. The rule base contains 5635 rules. 3197 rules in the queue.
12800 rules inserted. The rule base contains 5796 rules. 3312 rules in the queue.
13000 rules inserted. The rule base contains 5948 rules. 3197 rules in the queue.
13200 rules inserted. The rule base contains 6073 rules. 3186 rules in the queue.
13400 rules inserted. The rule base contains 6213 rules. 3184 rules in the queue.
13600 rules inserted. The rule base contains 6344 rules. 3135 rules in the queue.
13800 rules inserted. The rule base contains 6490 rules. 3231 rules in the queue.
14000 rules inserted. The rule base contains 6650 rules. 3154 rules in the queue.
14200 rules inserted. The rule base contains 6788 rules. 3172 rules in the queue.
14400 rules inserted. The rule base contains 6918 rules. 3125 rules in the queue.
14600 rules inserted. The rule base contains 7042 rules. 3089 rules in the queue.
14800 rules inserted. The rule base contains 7183 rules. 3102 rules in the queue.
15000 rules inserted. The rule base contains 7242 rules. 3177 rules in the queue.
15200 rules inserted. The rule base contains 7348 rules. 3153 rules in the queue.
15400 rules inserted. The rule base contains 7485 rules. 3232 rules in the queue.
15600 rules inserted. The rule base contains 7601 rules. 3201 rules in the queue.
15800 rules inserted. The rule base contains 7705 rules. 3156 rules in the queue.
16000 rules inserted. The rule base contains 7855 rules. 3092 rules in the queue.
16200 rules inserted. The rule base contains 7981 rules. 3048 rules in the queue.
16400 rules inserted. The rule base contains 8092 rules. 3058 rules in the queue.
16600 rules inserted. The rule base contains 8217 rules. 3078 rules in the queue.
16800 rules inserted. The rule base contains 8331 rules. 3058 rules in the queue.
17000 rules inserted. The rule base contains 8481 rules. 2991 rules in the queue.
17200 rules inserted. The rule base contains 8599 rules. 2954 rules in the queue.
17400 rules inserted. The rule base contains 8715 rules. 2924 rules in the queue.
17600 rules inserted. The rule base contains 8837 rules. 3021 rules in the queue.
17800 rules inserted. The rule base contains 8957 rules. 2960 rules in the queue.
18000 rules inserted. The rule base contains 9107 rules. 2896 rules in the queue.
18200 rules inserted. The rule base contains 9133 rules. 2874 rules in the queue.
18400 rules inserted. The rule base contains 9265 rules. 2842 rules in the queue.
18600 rules inserted. The rule base contains 9381 rules. 2761 rules in the queue.
18800 rules inserted. The rule base contains 9500 rules. 2853 rules in the queue.
19000 rules inserted. The rule base contains 9617 rules. 2947 rules in the queue.
19200 rules inserted. The rule base contains 9731 rules. 2941 rules in the queue.
19400 rules inserted. The rule base contains 9851 rules. 2984 rules in the queue.
19600 rules inserted. The rule base contains 9973 rules. 2926 rules in the queue.
19800 rules inserted. The rule base contains 10081 rules. 3032 rules in the queue.
20000 rules inserted. The rule base contains 10221 rules. 2910 rules in the queue.
20200 rules inserted. The rule base contains 10339 rules. 3002 rules in the queue.
20400 rules inserted. The rule base contains 10435 rules. 3120 rules in the queue.
20600 rules inserted. The rule base contains 10581 rules. 3091 rules in the queue.
20800 rules inserted. The rule base contains 10695 rules. 2996 rules in the queue.
21000 rules inserted. The rule base contains 10767 rules. 2928 rules in the queue.
21200 rules inserted. The rule base contains 10847 rules. 2869 rules in the queue.
21400 rules inserted. The rule base contains 10961 rules. 2777 rules in the queue.
21600 rules inserted. The rule base contains 11089 rules. 2762 rules in the queue.
21800 rules inserted. The rule base contains 11229 rules. 2722 rules in the queue.
22000 rules inserted. The rule base contains 11306 rules. 2678 rules in the queue.
22200 rules inserted. The rule base contains 11437 rules. 2648 rules in the queue.
22400 rules inserted. The rule base contains 11558 rules. 2566 rules in the queue.
22600 rules inserted. The rule base contains 11669 rules. 2485 rules in the queue.
22800 rules inserted. The rule base contains 11805 rules. 2454 rules in the queue.
23000 rules inserted. The rule base contains 11885 rules. 2430 rules in the queue.
23200 rules inserted. The rule base contains 12019 rules. 2370 rules in the queue.
23400 rules inserted. The rule base contains 12145 rules. 2356 rules in the queue.
23600 rules inserted. The rule base contains 12267 rules. 2265 rules in the queue.
23800 rules inserted. The rule base contains 12373 rules. 2180 rules in the queue.
24000 rules inserted. The rule base contains 12391 rules. 2174 rules in the queue.
24200 rules inserted. The rule base contains 12461 rules. 2116 rules in the queue.
24400 rules inserted. The rule base contains 12575 rules. 2032 rules in the queue.
24600 rules inserted. The rule base contains 12709 rules. 1928 rules in the queue.
24800 rules inserted. The rule base contains 12785 rules. 1873 rules in the queue.
25000 rules inserted. The rule base contains 12889 rules. 1790 rules in the queue.
25200 rules inserted. The rule base contains 13001 rules. 1708 rules in the queue.
25400 rules inserted. The rule base contains 13073 rules. 1660 rules in the queue.
25600 rules inserted. The rule base contains 13189 rules. 1570 rules in the queue.
25800 rules inserted. The rule base contains 13319 rules. 1462 rules in the queue.
26000 rules inserted. The rule base contains 13377 rules. 1428 rules in the queue.
26200 rules inserted. The rule base contains 13409 rules. 1420 rules in the queue.
26400 rules inserted. The rule base contains 13480 rules. 1386 rules in the queue.
26600 rules inserted. The rule base contains 13560 rules. 1350 rules in the queue.
26800 rules inserted. The rule base contains 13632 rules. 1314 rules in the queue.
27000 rules inserted. The rule base contains 13715 rules. 1276 rules in the queue.
27200 rules inserted. The rule base contains 13806 rules. 1229 rules in the queue.
27400 rules inserted. The rule base contains 13883 rules. 1200 rules in the queue.
27600 rules inserted. The rule base contains 13906 rules. 1196 rules in the queue.
27800 rules inserted. The rule base contains 14009 rules. 1180 rules in the queue.
28000 rules inserted. The rule base contains 14097 rules. 1168 rules in the queue.
28200 rules inserted. The rule base contains 14185 rules. 1156 rules in the queue.
28400 rules inserted. The rule base contains 14288 rules. 1144 rules in the queue.
28600 rules inserted. The rule base contains 14391 rules. 1128 rules in the queue.
28800 rules inserted. The rule base contains 14435 rules. 1116 rules in the queue.
29000 rules inserted. The rule base contains 14557 rules. 1080 rules in the queue.
29200 rules inserted. The rule base contains 14678 rules. 1042 rules in the queue.
29400 rules inserted. The rule base contains 14803 rules. 992 rules in the queue.
29600 rules inserted. The rule base contains 14921 rules. 962 rules in the queue.
29800 rules inserted. The rule base contains 15047 rules. 918 rules in the queue.
30000 rules inserted. The rule base contains 15153 rules. 881 rules in the queue.
30200 rules inserted. The rule base contains 15276 rules. 825 rules in the queue.
30400 rules inserted. The rule base contains 15407 rules. 770 rules in the queue.
30600 rules inserted. The rule base contains 15532 rules. 712 rules in the queue.
30800 rules inserted. The rule base contains 15554 rules. 656 rules in the queue.
31000 rules inserted. The rule base contains 15663 rules. 583 rules in the queue.
31200 rules inserted. The rule base contains 15820 rules. 531 rules in the queue.
31400 rules inserted. The rule base contains 15881 rules. 456 rules in the queue.
31600 rules inserted. The rule base contains 16011 rules. 405 rules in the queue.
31800 rules inserted. The rule base contains 16109 rules. 308 rules in the queue.
32000 rules inserted. The rule base contains 15925 rules. 72 rules in the queue.
Starting query not attacker(mSrv(pub(skA[]),pub(skC[])))
RESULT not attacker(mSrv(pub(skA[]),pub(skC[]))) is true.
-- Query not attacker(mCli(pub(skA[]),pub(skC[])))
Completing...
200 rules inserted. The rule base contains 123 rules. 388 rules in the queue.
400 rules inserted. The rule base contains 229 rules. 388 rules in the queue.
600 rules inserted. The rule base contains 315 rules. 386 rules in the queue.
800 rules inserted. The rule base contains 435 rules. 386 rules in the queue.
1000 rules inserted. The rule base contains 441 rules. 378 rules in the queue.
1200 rules inserted. The rule base contains 459 rules. 360 rules in the queue.
1400 rules inserted. The rule base contains 497 rules. 322 rules in the queue.
1600 rules inserted. The rule base contains 521 rules. 347 rules in the queue.
1800 rules inserted. The rule base contains 543 rules. 570 rules in the queue.
2000 rules inserted. The rule base contains 610 rules. 811 rules in the queue.
2200 rules inserted. The rule base contains 721 rules. 1570 rules in the queue.
2400 rules inserted. The rule base contains 789 rules. 1650 rules in the queue.
2600 rules inserted. The rule base contains 899 rules. 1516 rules in the queue.
2800 rules inserted. The rule base contains 1001 rules. 1538 rules in the queue.
3000 rules inserted. The rule base contains 1091 rules. 1412 rules in the queue.
3200 rules inserted. The rule base contains 1206 rules. 1347 rules in the queue.
3400 rules inserted. The rule base contains 1319 rules. 1284 rules in the queue.
3600 rules inserted. The rule base contains 1420 rules. 1282 rules in the queue.
3800 rules inserted. The rule base contains 1511 rules. 1180 rules in the queue.
4000 rules inserted. The rule base contains 1611 rules. 1050 rules in the queue.
4200 rules inserted. The rule base contains 1629 rules. 989 rules in the queue.
4400 rules inserted. The rule base contains 1701 rules. 902 rules in the queue.
4600 rules inserted. The rule base contains 1750 rules. 827 rules in the queue.
4800 rules inserted. The rule base contains 1803 rules. 760 rules in the queue.
5000 rules inserted. The rule base contains 1857 rules. 691 rules in the queue.
5200 rules inserted. The rule base contains 1816 rules. 795 rules in the queue.
5400 rules inserted. The rule base contains 1758 rules. 981 rules in the queue.
5600 rules inserted. The rule base contains 1659 rules. 1144 rules in the queue.
5800 rules inserted. The rule base contains 1703 rules. 1333 rules in the queue.
6000 rules inserted. The rule base contains 1755 rules. 1482 rules in the queue.
6200 rules inserted. The rule base contains 1815 rules. 1568 rules in the queue.
6400 rules inserted. The rule base contains 1875 rules. 1654 rules in the queue.
6600 rules inserted. The rule base contains 1935 rules. 1740 rules in the queue.
6800 rules inserted. The rule base contains 1995 rules. 1826 rules in the queue.
7000 rules inserted. The rule base contains 2085 rules. 1868 rules in the queue.
7200 rules inserted. The rule base contains 2237 rules. 1978 rules in the queue.
7400 rules inserted. The rule base contains 2347 rules. 2129 rules in the queue.
7600 rules inserted. The rule base contains 2456 rules. 2326 rules in the queue.
7800 rules inserted. The rule base contains 2566 rules. 2500 rules in the queue.
8000 rules inserted. The rule base contains 2676 rules. 2674 rules in the queue.
8200 rules inserted. The rule base contains 2784 rules. 2877 rules in the queue.
8400 rules inserted. The rule base contains 2895 rules. 3022 rules in the queue.
8600 rules inserted. The rule base contains 3014 rules. 3306 rules in the queue.
8800 rules inserted. The rule base contains 3098 rules. 3231 rules in the queue.
9000 rules inserted. The rule base contains 3228 rules. 3171 rules in the queue.
9200 rules inserted. The rule base contains 3373 rules. 3161 rules in the queue.
9400 rules inserted. The rule base contains 3510 rules. 3190 rules in the queue.
9600 rules inserted. The rule base contains 3639 rules. 3225 rules in the queue.
9800 rules inserted. The rule base contains 3787 rules. 3259 rules in the queue.
10000 rules inserted. The rule base contains 3935 rules. 3276 rules in the queue.
10200 rules inserted. The rule base contains 4086 rules. 3204 rules in the queue.
10400 rules inserted. The rule base contains 4228 rules. 3291 rules in the queue.
10600 rules inserted. The rule base contains 4365 rules. 3263 rules in the queue.
10800 rules inserted. The rule base contains 4507 rules. 3263 rules in the queue.
11000 rules inserted. The rule base contains 4641 rules. 3389 rules in the queue.
11200 rules inserted. The rule base contains 4781 rules. 3321 rules in the queue.
11400 rules inserted. The rule base contains 4944 rules. 3274 rules in the queue.
11600 rules inserted. The rule base contains 5090 rules. 3274 rules in the queue.
11800 rules inserted. The rule base contains 5094 rules. 3372 rules in the queue.
12000 rules inserted. The rule base contains 5241 rules. 3251 rules in the queue.
12200 rules inserted. The rule base contains 5371 rules. 3206 rules in the queue.
12400 rules inserted. The rule base contains 5508 rules. 3235 rules in the queue.
12600 rules inserted. The rule base contains 5635 rules. 3197 rules in the queue.
12800 rules inserted. The rule base contains 5796 rules. 3312 rules in the queue.
13000 rules inserted. The rule base contains 5948 rules. 3197 rules in the queue.
13200 rules inserted. The rule base contains 6073 rules. 3186 rules in the queue.
13400 rules inserted. The rule base contains 6213 rules. 3184 rules in the queue.
13600 rules inserted. The rule base contains 6344 rules. 3135 rules in the queue.
13800 rules inserted. The rule base contains 6490 rules. 3231 rules in the queue.
14000 rules inserted. The rule base contains 6650 rules. 3154 rules in the queue.
14200 rules inserted. The rule base contains 6788 rules. 3172 rules in the queue.
14400 rules inserted. The rule base contains 6918 rules. 3125 rules in the queue.
14600 rules inserted. The rule base contains 7042 rules. 3089 rules in the queue.
14800 rules inserted. The rule base contains 7183 rules. 3102 rules in the queue.
15000 rules inserted. The rule base contains 7242 rules. 3177 rules in the queue.
15200 rules inserted. The rule base contains 7348 rules. 3153 rules in the queue.
15400 rules inserted. The rule base contains 7485 rules. 3232 rules in the queue.
15600 rules inserted. The rule base contains 7601 rules. 3201 rules in the queue.
15800 rules inserted. The rule base contains 7705 rules. 3156 rules in the queue.
16000 rules inserted. The rule base contains 7855 rules. 3092 rules in the queue.
16200 rules inserted. The rule base contains 7981 rules. 3048 rules in the queue.
16400 rules inserted. The rule base contains 8092 rules. 3058 rules in the queue.
16600 rules inserted. The rule base contains 8217 rules. 3078 rules in the queue.
16800 rules inserted. The rule base contains 8331 rules. 3058 rules in the queue.
17000 rules inserted. The rule base contains 8481 rules. 2991 rules in the queue.
17200 rules inserted. The rule base contains 8599 rules. 2954 rules in the queue.
17400 rules inserted. The rule base contains 8715 rules. 2924 rules in the queue.
17600 rules inserted. The rule base contains 8837 rules. 3021 rules in the queue.
17800 rules inserted. The rule base contains 8957 rules. 2960 rules in the queue.
18000 rules inserted. The rule base contains 9107 rules. 2896 rules in the queue.
18200 rules inserted. The rule base contains 9133 rules. 2874 rules in the queue.
18400 rules inserted. The rule base contains 9265 rules. 2842 rules in the queue.
18600 rules inserted. The rule base contains 9381 rules. 2761 rules in the queue.
18800 rules inserted. The rule base contains 9500 rules. 2853 rules in the queue.
19000 rules inserted. The rule base contains 9617 rules. 2947 rules in the queue.
19200 rules inserted. The rule base contains 9731 rules. 2941 rules in the queue.
19400 rules inserted. The rule base contains 9851 rules. 2984 rules in the queue.
19600 rules inserted. The rule base contains 9973 rules. 2926 rules in the queue.
19800 rules inserted. The rule base contains 10081 rules. 3032 rules in the queue.
20000 rules inserted. The rule base contains 10221 rules. 2910 rules in the queue.
20200 rules inserted. The rule base contains 10339 rules. 3002 rules in the queue.
20400 rules inserted. The rule base contains 10435 rules. 3120 rules in the queue.
20600 rules inserted. The rule base contains 10581 rules. 3091 rules in the queue.
20800 rules inserted. The rule base contains 10695 rules. 2996 rules in the queue.
21000 rules inserted. The rule base contains 10767 rules. 2928 rules in the queue.
21200 rules inserted. The rule base contains 10847 rules. 2869 rules in the queue.
21400 rules inserted. The rule base contains 10961 rules. 2777 rules in the queue.
21600 rules inserted. The rule base contains 11089 rules. 2762 rules in the queue.
21800 rules inserted. The rule base contains 11229 rules. 2722 rules in the queue.
22000 rules inserted. The rule base contains 11306 rules. 2678 rules in the queue.
22200 rules inserted. The rule base contains 11437 rules. 2648 rules in the queue.
22400 rules inserted. The rule base contains 11558 rules. 2566 rules in the queue.
22600 rules inserted. The rule base contains 11669 rules. 2485 rules in the queue.
22800 rules inserted. The rule base contains 11805 rules. 2454 rules in the queue.
23000 rules inserted. The rule base contains 11885 rules. 2430 rules in the queue.
23200 rules inserted. The rule base contains 12019 rules. 2370 rules in the queue.
23400 rules inserted. The rule base contains 12145 rules. 2356 rules in the queue.
23600 rules inserted. The rule base contains 12267 rules. 2265 rules in the queue.
23800 rules inserted. The rule base contains 12373 rules. 2180 rules in the queue.
24000 rules inserted. The rule base contains 12391 rules. 2174 rules in the queue.
24200 rules inserted. The rule base contains 12461 rules. 2116 rules in the queue.
24400 rules inserted. The rule base contains 12575 rules. 2032 rules in the queue.
24600 rules inserted. The rule base contains 12709 rules. 1928 rules in the queue.
24800 rules inserted. The rule base contains 12785 rules. 1873 rules in the queue.
25000 rules inserted. The rule base contains 12889 rules. 1790 rules in the queue.
25200 rules inserted. The rule base contains 13001 rules. 1708 rules in the queue.
25400 rules inserted. The rule base contains 13073 rules. 1660 rules in the queue.
25600 rules inserted. The rule base contains 13189 rules. 1570 rules in the queue.
25800 rules inserted. The rule base contains 13319 rules. 1462 rules in the queue.
26000 rules inserted. The rule base contains 13377 rules. 1428 rules in the queue.
26200 rules inserted. The rule base contains 13409 rules. 1420 rules in the queue.
26400 rules inserted. The rule base contains 13480 rules. 1386 rules in the queue.
26600 rules inserted. The rule base contains 13560 rules. 1350 rules in the queue.
26800 rules inserted. The rule base contains 13632 rules. 1314 rules in the queue.
27000 rules inserted. The rule base contains 13715 rules. 1276 rules in the queue.
27200 rules inserted. The rule base contains 13806 rules. 1229 rules in the queue.
27400 rules inserted. The rule base contains 13883 rules. 1200 rules in the queue.
27600 rules inserted. The rule base contains 13906 rules. 1196 rules in the queue.
27800 rules inserted. The rule base contains 14009 rules. 1180 rules in the queue.
28000 rules inserted. The rule base contains 14097 rules. 1168 rules in the queue.
28200 rules inserted. The rule base contains 14185 rules. 1156 rules in the queue.
28400 rules inserted. The rule base contains 14288 rules. 1144 rules in the queue.
28600 rules inserted. The rule base contains 14391 rules. 1128 rules in the queue.
28800 rules inserted. The rule base contains 14435 rules. 1116 rules in the queue.
29000 rules inserted. The rule base contains 14557 rules. 1080 rules in the queue.
29200 rules inserted. The rule base contains 14678 rules. 1042 rules in the queue.
29400 rules inserted. The rule base contains 14803 rules. 992 rules in the queue.
29600 rules inserted. The rule base contains 14921 rules. 962 rules in the queue.
29800 rules inserted. The rule base contains 15047 rules. 918 rules in the queue.
30000 rules inserted. The rule base contains 15153 rules. 881 rules in the queue.
30200 rules inserted. The rule base contains 15276 rules. 825 rules in the queue.
30400 rules inserted. The rule base contains 15407 rules. 770 rules in the queue.
30600 rules inserted. The rule base contains 15532 rules. 712 rules in the queue.
30800 rules inserted. The rule base contains 15554 rules. 656 rules in the queue.
31000 rules inserted. The rule base contains 15663 rules. 583 rules in the queue.
31200 rules inserted. The rule base contains 15820 rules. 531 rules in the queue.
31400 rules inserted. The rule base contains 15881 rules. 456 rules in the queue.
31600 rules inserted. The rule base contains 16011 rules. 405 rules in the queue.
31800 rules inserted. The rule base contains 16109 rules. 308 rules in the queue.
32000 rules inserted. The rule base contains 15925 rules. 72 rules in the queue.
Starting query not attacker(mCli(pub(skA[]),pub(skC[])))
RESULT not attacker(mCli(pub(skA[]),pub(skC[]))) is true.
