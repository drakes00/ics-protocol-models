Linear part:
exp(exp(g,x_26),y) = exp(exp(g,y),x_26)
Completing equations...
Completed equations:
exp(exp(g,x_26),y) = exp(exp(g,y),x_26)
Convergent part:
dec(enc(x_13,pub(k_14)),k_14) = x_13
Completing equations...
Completed equations:
dec(enc(x_13,pub(k_14)),k_14) = x_13
Process:
{1}let pkA: bitstring = pub(skA) in
{2}out(c, pkA);
{3}let pkB: bitstring = pub(skB) in
{4}out(c, pkB);
{5}let pkC: bitstring = pub(skC) in
{6}out(c, pkC);
(
    {7}!
    {8}in(c, (Cli: host,Disco: host,Sess: host));
    {9}let v_509: bool = (Cli = A) in
    (
        {10}if v_509 then
        (
            {11}let skCli: bitstring = skA in
            {12}let pkCli: bitstring = pub(skCli) in
            {13}let v_510: bool = (Disco = A) in
            (
                {14}if v_510 then
                (
                    {15}let pkDisco: bitstring = pub(skA) in
                    {16}let v_511: bool = (Sess = A) in
                    (
                        {17}if v_511 then
                        (
                            {18}let pkSess: bitstring = pub(skA) in
                            {19}out(c, GetEndpointRequest);
                            {20}in(c, (=GetEndpointResponse,=pkSess,=None,SP: bitstring,UP: bitstring));
                            {21}new Nc: bitstring;
                            {22}let m1: bitstring = (OpenSecureChannelRequest,Sess,pkCli,Nc) in
                            {23}event beginCli(Cli,Sess,Nc);
                            {24}out(c, (pkCli,m1));
                            {25}in(c, em2: bitstring);
                            {26}let m2: bitstring = em2 in
                            {27}let (=OpenSecureChannelResponse,=Cli,Ns: bitstring,ST: bitstring,TTL: bitstring) = m2 in
                            {28}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                            {29}event endCli(Sess,Cli,Ns)
                        )
                        else
                            {30}let v_512: bool = (Sess = B) in
                            (
                                {31}if v_512 then
                                (
                                    {32}let pkSess_513: bitstring = pub(skB) in
                                    {33}out(c, GetEndpointRequest);
                                    {34}in(c, (=GetEndpointResponse,=pkSess_513,=None,SP_514: bitstring,UP_515: bitstring));
                                    {35}new Nc_516: bitstring;
                                    {36}let m1_517: bitstring = (OpenSecureChannelRequest,Sess,pkCli,Nc_516) in
                                    {37}event beginCli(Cli,Sess,Nc_516);
                                    {38}out(c, (pkCli,m1_517));
                                    {39}in(c, em2_518: bitstring);
                                    {40}let m2_519: bitstring = em2_518 in
                                    {41}let (=OpenSecureChannelResponse,=Cli,Ns_520: bitstring,ST_521: bitstring,TTL_522: bitstring) = m2_519 in
                                    {42}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                    {43}event endCli(Sess,Cli,Ns_520)
                                )
                                else
                                    {44}let v_523: bool = (Sess = C) in
                                    (
                                        {45}if v_523 then
                                        (
                                            {46}let pkSess_524: bitstring = pub(skC) in
                                            {47}out(c, GetEndpointRequest);
                                            {48}in(c, (=GetEndpointResponse,=pkSess_524,=None,SP_525: bitstring,UP_526: bitstring));
                                            {49}new Nc_527: bitstring;
                                            {50}let m1_528: bitstring = (OpenSecureChannelRequest,Sess,pkCli,Nc_527) in
                                            {51}event beginCli(Cli,Sess,Nc_527);
                                            {52}out(c, (pkCli,m1_528));
                                            {53}in(c, em2_529: bitstring);
                                            {54}let m2_530: bitstring = em2_529 in
                                            {55}let (=OpenSecureChannelResponse,=Cli,Ns_531: bitstring,ST_532: bitstring,TTL_533: bitstring) = m2_530 in
                                            {56}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {57}event endCli(Sess,Cli,Ns_531)
                                        )
                                        else
                                            {58}let pkSess_534: bitstring = pub(sk(Sess)) in
                                            {59}out(c, GetEndpointRequest);
                                            {60}in(c, (=GetEndpointResponse,=pkSess_534,=None,SP_535: bitstring,UP_536: bitstring));
                                            {61}new Nc_537: bitstring;
                                            {62}let m1_538: bitstring = (OpenSecureChannelRequest,Sess,pkCli,Nc_537) in
                                            {63}event beginCli(Cli,Sess,Nc_537);
                                            {64}out(c, (pkCli,m1_538));
                                            {65}in(c, em2_539: bitstring);
                                            {66}let m2_540: bitstring = em2_539 in
                                            {67}let (=OpenSecureChannelResponse,=Cli,Ns_541: bitstring,ST_542: bitstring,TTL_543: bitstring) = m2_540 in
                                            {68}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {69}event endCli(Sess,Cli,Ns_541)
                                    )
                                    else
                                        {70}let pkSess_544: bitstring = fail-any in
                                        {71}out(c, GetEndpointRequest);
                                        {72}in(c, (=GetEndpointResponse,=pkSess_544,=None,SP_545: bitstring,UP_546: bitstring));
                                        {73}new Nc_547: bitstring;
                                        {74}let m1_548: bitstring = (OpenSecureChannelRequest,Sess,pkCli,Nc_547) in
                                        {75}event beginCli(Cli,Sess,Nc_547);
                                        {76}out(c, (pkCli,m1_548));
                                        {77}in(c, em2_549: bitstring);
                                        {78}let m2_550: bitstring = em2_549 in
                                        {79}let (=OpenSecureChannelResponse,=Cli,Ns_551: bitstring,ST_552: bitstring,TTL_553: bitstring) = m2_550 in
                                        {80}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                        {81}event endCli(Sess,Cli,Ns_551)
                            )
                            else
                                {82}let pkSess_554: bitstring = fail-any in
                                {83}out(c, GetEndpointRequest);
                                {84}in(c, (=GetEndpointResponse,=pkSess_554,=None,SP_555: bitstring,UP_556: bitstring));
                                {85}new Nc_557: bitstring;
                                {86}let m1_558: bitstring = (OpenSecureChannelRequest,Sess,pkCli,Nc_557) in
                                {87}event beginCli(Cli,Sess,Nc_557);
                                {88}out(c, (pkCli,m1_558));
                                {89}in(c, em2_559: bitstring);
                                {90}let m2_560: bitstring = em2_559 in
                                {91}let (=OpenSecureChannelResponse,=Cli,Ns_561: bitstring,ST_562: bitstring,TTL_563: bitstring) = m2_560 in
                                {92}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                {93}event endCli(Sess,Cli,Ns_561)
                    )
                    else
                        {94}let pkSess_564: bitstring = fail-any in
                        {95}out(c, GetEndpointRequest);
                        {96}in(c, (=GetEndpointResponse,=pkSess_564,=None,SP_565: bitstring,UP_566: bitstring));
                        {97}new Nc_567: bitstring;
                        {98}let m1_568: bitstring = (OpenSecureChannelRequest,Sess,pkCli,Nc_567) in
                        {99}event beginCli(Cli,Sess,Nc_567);
                        {100}out(c, (pkCli,m1_568));
                        {101}in(c, em2_569: bitstring);
                        {102}let m2_570: bitstring = em2_569 in
                        {103}let (=OpenSecureChannelResponse,=Cli,Ns_571: bitstring,ST_572: bitstring,TTL_573: bitstring) = m2_570 in
                        {104}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                        {105}event endCli(Sess,Cli,Ns_571)
                )
                else
                    {106}let v_574: bool = (Disco = B) in
                    (
                        {107}if v_574 then
                        (
                            {108}let pkDisco_575: bitstring = pub(skB) in
                            {109}let v_576: bool = (Sess = A) in
                            (
                                {110}if v_576 then
                                (
                                    {111}let pkSess_577: bitstring = pub(skA) in
                                    {112}out(c, GetEndpointRequest);
                                    {113}in(c, (=GetEndpointResponse,=pkSess_577,=None,SP_578: bitstring,UP_579: bitstring));
                                    {114}new Nc_580: bitstring;
                                    {115}let m1_581: bitstring = (OpenSecureChannelRequest,Sess,pkCli,Nc_580) in
                                    {116}event beginCli(Cli,Sess,Nc_580);
                                    {117}out(c, (pkCli,m1_581));
                                    {118}in(c, em2_582: bitstring);
                                    {119}let m2_583: bitstring = em2_582 in
                                    {120}let (=OpenSecureChannelResponse,=Cli,Ns_584: bitstring,ST_585: bitstring,TTL_586: bitstring) = m2_583 in
                                    {121}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                    {122}event endCli(Sess,Cli,Ns_584)
                                )
                                else
                                    {123}let v_587: bool = (Sess = B) in
                                    (
                                        {124}if v_587 then
                                        (
                                            {125}let pkSess_588: bitstring = pub(skB) in
                                            {126}out(c, GetEndpointRequest);
                                            {127}in(c, (=GetEndpointResponse,=pkSess_588,=None,SP_589: bitstring,UP_590: bitstring));
                                            {128}new Nc_591: bitstring;
                                            {129}let m1_592: bitstring = (OpenSecureChannelRequest,Sess,pkCli,Nc_591) in
                                            {130}event beginCli(Cli,Sess,Nc_591);
                                            {131}out(c, (pkCli,m1_592));
                                            {132}in(c, em2_593: bitstring);
                                            {133}let m2_594: bitstring = em2_593 in
                                            {134}let (=OpenSecureChannelResponse,=Cli,Ns_595: bitstring,ST_596: bitstring,TTL_597: bitstring) = m2_594 in
                                            {135}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {136}event endCli(Sess,Cli,Ns_595)
                                        )
                                        else
                                            {137}let v_598: bool = (Sess = C) in
                                            (
                                                {138}if v_598 then
                                                (
                                                    {139}let pkSess_599: bitstring = pub(skC) in
                                                    {140}out(c, GetEndpointRequest);
                                                    {141}in(c, (=GetEndpointResponse,=pkSess_599,=None,SP_600: bitstring,UP_601: bitstring));
                                                    {142}new Nc_602: bitstring;
                                                    {143}let m1_603: bitstring = (OpenSecureChannelRequest,Sess,pkCli,Nc_602) in
                                                    {144}event beginCli(Cli,Sess,Nc_602);
                                                    {145}out(c, (pkCli,m1_603));
                                                    {146}in(c, em2_604: bitstring);
                                                    {147}let m2_605: bitstring = em2_604 in
                                                    {148}let (=OpenSecureChannelResponse,=Cli,Ns_606: bitstring,ST_607: bitstring,TTL_608: bitstring) = m2_605 in
                                                    {149}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {150}event endCli(Sess,Cli,Ns_606)
                                                )
                                                else
                                                    {151}let pkSess_609: bitstring = pub(sk(Sess)) in
                                                    {152}out(c, GetEndpointRequest);
                                                    {153}in(c, (=GetEndpointResponse,=pkSess_609,=None,SP_610: bitstring,UP_611: bitstring));
                                                    {154}new Nc_612: bitstring;
                                                    {155}let m1_613: bitstring = (OpenSecureChannelRequest,Sess,pkCli,Nc_612) in
                                                    {156}event beginCli(Cli,Sess,Nc_612);
                                                    {157}out(c, (pkCli,m1_613));
                                                    {158}in(c, em2_614: bitstring);
                                                    {159}let m2_615: bitstring = em2_614 in
                                                    {160}let (=OpenSecureChannelResponse,=Cli,Ns_616: bitstring,ST_617: bitstring,TTL_618: bitstring) = m2_615 in
                                                    {161}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {162}event endCli(Sess,Cli,Ns_616)
                                            )
                                            else
                                                {163}let pkSess_619: bitstring = fail-any in
                                                {164}out(c, GetEndpointRequest);
                                                {165}in(c, (=GetEndpointResponse,=pkSess_619,=None,SP_620: bitstring,UP_621: bitstring));
                                                {166}new Nc_622: bitstring;
                                                {167}let m1_623: bitstring = (OpenSecureChannelRequest,Sess,pkCli,Nc_622) in
                                                {168}event beginCli(Cli,Sess,Nc_622);
                                                {169}out(c, (pkCli,m1_623));
                                                {170}in(c, em2_624: bitstring);
                                                {171}let m2_625: bitstring = em2_624 in
                                                {172}let (=OpenSecureChannelResponse,=Cli,Ns_626: bitstring,ST_627: bitstring,TTL_628: bitstring) = m2_625 in
                                                {173}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {174}event endCli(Sess,Cli,Ns_626)
                                    )
                                    else
                                        {175}let pkSess_629: bitstring = fail-any in
                                        {176}out(c, GetEndpointRequest);
                                        {177}in(c, (=GetEndpointResponse,=pkSess_629,=None,SP_630: bitstring,UP_631: bitstring));
                                        {178}new Nc_632: bitstring;
                                        {179}let m1_633: bitstring = (OpenSecureChannelRequest,Sess,pkCli,Nc_632) in
                                        {180}event beginCli(Cli,Sess,Nc_632);
                                        {181}out(c, (pkCli,m1_633));
                                        {182}in(c, em2_634: bitstring);
                                        {183}let m2_635: bitstring = em2_634 in
                                        {184}let (=OpenSecureChannelResponse,=Cli,Ns_636: bitstring,ST_637: bitstring,TTL_638: bitstring) = m2_635 in
                                        {185}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                        {186}event endCli(Sess,Cli,Ns_636)
                            )
                            else
                                {187}let pkSess_639: bitstring = fail-any in
                                {188}out(c, GetEndpointRequest);
                                {189}in(c, (=GetEndpointResponse,=pkSess_639,=None,SP_640: bitstring,UP_641: bitstring));
                                {190}new Nc_642: bitstring;
                                {191}let m1_643: bitstring = (OpenSecureChannelRequest,Sess,pkCli,Nc_642) in
                                {192}event beginCli(Cli,Sess,Nc_642);
                                {193}out(c, (pkCli,m1_643));
                                {194}in(c, em2_644: bitstring);
                                {195}let m2_645: bitstring = em2_644 in
                                {196}let (=OpenSecureChannelResponse,=Cli,Ns_646: bitstring,ST_647: bitstring,TTL_648: bitstring) = m2_645 in
                                {197}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                {198}event endCli(Sess,Cli,Ns_646)
                        )
                        else
                            {199}let v_649: bool = (Disco = C) in
                            (
                                {200}if v_649 then
                                (
                                    {201}let pkDisco_650: bitstring = pub(skC) in
                                    {202}let v_651: bool = (Sess = A) in
                                    (
                                        {203}if v_651 then
                                        (
                                            {204}let pkSess_652: bitstring = pub(skA) in
                                            {205}out(c, GetEndpointRequest);
                                            {206}in(c, (=GetEndpointResponse,=pkSess_652,=None,SP_653: bitstring,UP_654: bitstring));
                                            {207}new Nc_655: bitstring;
                                            {208}let m1_656: bitstring = (OpenSecureChannelRequest,Sess,pkCli,Nc_655) in
                                            {209}event beginCli(Cli,Sess,Nc_655);
                                            {210}out(c, (pkCli,m1_656));
                                            {211}in(c, em2_657: bitstring);
                                            {212}let m2_658: bitstring = em2_657 in
                                            {213}let (=OpenSecureChannelResponse,=Cli,Ns_659: bitstring,ST_660: bitstring,TTL_661: bitstring) = m2_658 in
                                            {214}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {215}event endCli(Sess,Cli,Ns_659)
                                        )
                                        else
                                            {216}let v_662: bool = (Sess = B) in
                                            (
                                                {217}if v_662 then
                                                (
                                                    {218}let pkSess_663: bitstring = pub(skB) in
                                                    {219}out(c, GetEndpointRequest);
                                                    {220}in(c, (=GetEndpointResponse,=pkSess_663,=None,SP_664: bitstring,UP_665: bitstring));
                                                    {221}new Nc_666: bitstring;
                                                    {222}let m1_667: bitstring = (OpenSecureChannelRequest,Sess,pkCli,Nc_666) in
                                                    {223}event beginCli(Cli,Sess,Nc_666);
                                                    {224}out(c, (pkCli,m1_667));
                                                    {225}in(c, em2_668: bitstring);
                                                    {226}let m2_669: bitstring = em2_668 in
                                                    {227}let (=OpenSecureChannelResponse,=Cli,Ns_670: bitstring,ST_671: bitstring,TTL_672: bitstring) = m2_669 in
                                                    {228}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {229}event endCli(Sess,Cli,Ns_670)
                                                )
                                                else
                                                    {230}let v_673: bool = (Sess = C) in
                                                    (
                                                        {231}if v_673 then
                                                        (
                                                            {232}let pkSess_674: bitstring = pub(skC) in
                                                            {233}out(c, GetEndpointRequest);
                                                            {234}in(c, (=GetEndpointResponse,=pkSess_674,=None,SP_675: bitstring,UP_676: bitstring));
                                                            {235}new Nc_677: bitstring;
                                                            {236}let m1_678: bitstring = (OpenSecureChannelRequest,Sess,pkCli,Nc_677) in
                                                            {237}event beginCli(Cli,Sess,Nc_677);
                                                            {238}out(c, (pkCli,m1_678));
                                                            {239}in(c, em2_679: bitstring);
                                                            {240}let m2_680: bitstring = em2_679 in
                                                            {241}let (=OpenSecureChannelResponse,=Cli,Ns_681: bitstring,ST_682: bitstring,TTL_683: bitstring) = m2_680 in
                                                            {242}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                            {243}event endCli(Sess,Cli,Ns_681)
                                                        )
                                                        else
                                                            {244}let pkSess_684: bitstring = pub(sk(Sess)) in
                                                            {245}out(c, GetEndpointRequest);
                                                            {246}in(c, (=GetEndpointResponse,=pkSess_684,=None,SP_685: bitstring,UP_686: bitstring));
                                                            {247}new Nc_687: bitstring;
                                                            {248}let m1_688: bitstring = (OpenSecureChannelRequest,Sess,pkCli,Nc_687) in
                                                            {249}event beginCli(Cli,Sess,Nc_687);
                                                            {250}out(c, (pkCli,m1_688));
                                                            {251}in(c, em2_689: bitstring);
                                                            {252}let m2_690: bitstring = em2_689 in
                                                            {253}let (=OpenSecureChannelResponse,=Cli,Ns_691: bitstring,ST_692: bitstring,TTL_693: bitstring) = m2_690 in
                                                            {254}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                            {255}event endCli(Sess,Cli,Ns_691)
                                                    )
                                                    else
                                                        {256}let pkSess_694: bitstring = fail-any in
                                                        {257}out(c, GetEndpointRequest);
                                                        {258}in(c, (=GetEndpointResponse,=pkSess_694,=None,SP_695: bitstring,UP_696: bitstring));
                                                        {259}new Nc_697: bitstring;
                                                        {260}let m1_698: bitstring = (OpenSecureChannelRequest,Sess,pkCli,Nc_697) in
                                                        {261}event beginCli(Cli,Sess,Nc_697);
                                                        {262}out(c, (pkCli,m1_698));
                                                        {263}in(c, em2_699: bitstring);
                                                        {264}let m2_700: bitstring = em2_699 in
                                                        {265}let (=OpenSecureChannelResponse,=Cli,Ns_701: bitstring,ST_702: bitstring,TTL_703: bitstring) = m2_700 in
                                                        {266}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {267}event endCli(Sess,Cli,Ns_701)
                                            )
                                            else
                                                {268}let pkSess_704: bitstring = fail-any in
                                                {269}out(c, GetEndpointRequest);
                                                {270}in(c, (=GetEndpointResponse,=pkSess_704,=None,SP_705: bitstring,UP_706: bitstring));
                                                {271}new Nc_707: bitstring;
                                                {272}let m1_708: bitstring = (OpenSecureChannelRequest,Sess,pkCli,Nc_707) in
                                                {273}event beginCli(Cli,Sess,Nc_707);
                                                {274}out(c, (pkCli,m1_708));
                                                {275}in(c, em2_709: bitstring);
                                                {276}let m2_710: bitstring = em2_709 in
                                                {277}let (=OpenSecureChannelResponse,=Cli,Ns_711: bitstring,ST_712: bitstring,TTL_713: bitstring) = m2_710 in
                                                {278}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {279}event endCli(Sess,Cli,Ns_711)
                                    )
                                    else
                                        {280}let pkSess_714: bitstring = fail-any in
                                        {281}out(c, GetEndpointRequest);
                                        {282}in(c, (=GetEndpointResponse,=pkSess_714,=None,SP_715: bitstring,UP_716: bitstring));
                                        {283}new Nc_717: bitstring;
                                        {284}let m1_718: bitstring = (OpenSecureChannelRequest,Sess,pkCli,Nc_717) in
                                        {285}event beginCli(Cli,Sess,Nc_717);
                                        {286}out(c, (pkCli,m1_718));
                                        {287}in(c, em2_719: bitstring);
                                        {288}let m2_720: bitstring = em2_719 in
                                        {289}let (=OpenSecureChannelResponse,=Cli,Ns_721: bitstring,ST_722: bitstring,TTL_723: bitstring) = m2_720 in
                                        {290}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                        {291}event endCli(Sess,Cli,Ns_721)
                                )
                                else
                                    {292}let pkDisco_724: bitstring = pub(sk(Disco)) in
                                    {293}let v_725: bool = (Sess = A) in
                                    (
                                        {294}if v_725 then
                                        (
                                            {295}let pkSess_726: bitstring = pub(skA) in
                                            {296}out(c, GetEndpointRequest);
                                            {297}in(c, (=GetEndpointResponse,=pkSess_726,=None,SP_727: bitstring,UP_728: bitstring));
                                            {298}new Nc_729: bitstring;
                                            {299}let m1_730: bitstring = (OpenSecureChannelRequest,Sess,pkCli,Nc_729) in
                                            {300}event beginCli(Cli,Sess,Nc_729);
                                            {301}out(c, (pkCli,m1_730));
                                            {302}in(c, em2_731: bitstring);
                                            {303}let m2_732: bitstring = em2_731 in
                                            {304}let (=OpenSecureChannelResponse,=Cli,Ns_733: bitstring,ST_734: bitstring,TTL_735: bitstring) = m2_732 in
                                            {305}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {306}event endCli(Sess,Cli,Ns_733)
                                        )
                                        else
                                            {307}let v_736: bool = (Sess = B) in
                                            (
                                                {308}if v_736 then
                                                (
                                                    {309}let pkSess_737: bitstring = pub(skB) in
                                                    {310}out(c, GetEndpointRequest);
                                                    {311}in(c, (=GetEndpointResponse,=pkSess_737,=None,SP_738: bitstring,UP_739: bitstring));
                                                    {312}new Nc_740: bitstring;
                                                    {313}let m1_741: bitstring = (OpenSecureChannelRequest,Sess,pkCli,Nc_740) in
                                                    {314}event beginCli(Cli,Sess,Nc_740);
                                                    {315}out(c, (pkCli,m1_741));
                                                    {316}in(c, em2_742: bitstring);
                                                    {317}let m2_743: bitstring = em2_742 in
                                                    {318}let (=OpenSecureChannelResponse,=Cli,Ns_744: bitstring,ST_745: bitstring,TTL_746: bitstring) = m2_743 in
                                                    {319}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {320}event endCli(Sess,Cli,Ns_744)
                                                )
                                                else
                                                    {321}let v_747: bool = (Sess = C) in
                                                    (
                                                        {322}if v_747 then
                                                        (
                                                            {323}let pkSess_748: bitstring = pub(skC) in
                                                            {324}out(c, GetEndpointRequest);
                                                            {325}in(c, (=GetEndpointResponse,=pkSess_748,=None,SP_749: bitstring,UP_750: bitstring));
                                                            {326}new Nc_751: bitstring;
                                                            {327}let m1_752: bitstring = (OpenSecureChannelRequest,Sess,pkCli,Nc_751) in
                                                            {328}event beginCli(Cli,Sess,Nc_751);
                                                            {329}out(c, (pkCli,m1_752));
                                                            {330}in(c, em2_753: bitstring);
                                                            {331}let m2_754: bitstring = em2_753 in
                                                            {332}let (=OpenSecureChannelResponse,=Cli,Ns_755: bitstring,ST_756: bitstring,TTL_757: bitstring) = m2_754 in
                                                            {333}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                            {334}event endCli(Sess,Cli,Ns_755)
                                                        )
                                                        else
                                                            {335}let pkSess_758: bitstring = pub(sk(Sess)) in
                                                            {336}out(c, GetEndpointRequest);
                                                            {337}in(c, (=GetEndpointResponse,=pkSess_758,=None,SP_759: bitstring,UP_760: bitstring));
                                                            {338}new Nc_761: bitstring;
                                                            {339}let m1_762: bitstring = (OpenSecureChannelRequest,Sess,pkCli,Nc_761) in
                                                            {340}event beginCli(Cli,Sess,Nc_761);
                                                            {341}out(c, (pkCli,m1_762));
                                                            {342}in(c, em2_763: bitstring);
                                                            {343}let m2_764: bitstring = em2_763 in
                                                            {344}let (=OpenSecureChannelResponse,=Cli,Ns_765: bitstring,ST_766: bitstring,TTL_767: bitstring) = m2_764 in
                                                            {345}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                            {346}event endCli(Sess,Cli,Ns_765)
                                                    )
                                                    else
                                                        {347}let pkSess_768: bitstring = fail-any in
                                                        {348}out(c, GetEndpointRequest);
                                                        {349}in(c, (=GetEndpointResponse,=pkSess_768,=None,SP_769: bitstring,UP_770: bitstring));
                                                        {350}new Nc_771: bitstring;
                                                        {351}let m1_772: bitstring = (OpenSecureChannelRequest,Sess,pkCli,Nc_771) in
                                                        {352}event beginCli(Cli,Sess,Nc_771);
                                                        {353}out(c, (pkCli,m1_772));
                                                        {354}in(c, em2_773: bitstring);
                                                        {355}let m2_774: bitstring = em2_773 in
                                                        {356}let (=OpenSecureChannelResponse,=Cli,Ns_775: bitstring,ST_776: bitstring,TTL_777: bitstring) = m2_774 in
                                                        {357}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {358}event endCli(Sess,Cli,Ns_775)
                                            )
                                            else
                                                {359}let pkSess_778: bitstring = fail-any in
                                                {360}out(c, GetEndpointRequest);
                                                {361}in(c, (=GetEndpointResponse,=pkSess_778,=None,SP_779: bitstring,UP_780: bitstring));
                                                {362}new Nc_781: bitstring;
                                                {363}let m1_782: bitstring = (OpenSecureChannelRequest,Sess,pkCli,Nc_781) in
                                                {364}event beginCli(Cli,Sess,Nc_781);
                                                {365}out(c, (pkCli,m1_782));
                                                {366}in(c, em2_783: bitstring);
                                                {367}let m2_784: bitstring = em2_783 in
                                                {368}let (=OpenSecureChannelResponse,=Cli,Ns_785: bitstring,ST_786: bitstring,TTL_787: bitstring) = m2_784 in
                                                {369}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {370}event endCli(Sess,Cli,Ns_785)
                                    )
                                    else
                                        {371}let pkSess_788: bitstring = fail-any in
                                        {372}out(c, GetEndpointRequest);
                                        {373}in(c, (=GetEndpointResponse,=pkSess_788,=None,SP_789: bitstring,UP_790: bitstring));
                                        {374}new Nc_791: bitstring;
                                        {375}let m1_792: bitstring = (OpenSecureChannelRequest,Sess,pkCli,Nc_791) in
                                        {376}event beginCli(Cli,Sess,Nc_791);
                                        {377}out(c, (pkCli,m1_792));
                                        {378}in(c, em2_793: bitstring);
                                        {379}let m2_794: bitstring = em2_793 in
                                        {380}let (=OpenSecureChannelResponse,=Cli,Ns_795: bitstring,ST_796: bitstring,TTL_797: bitstring) = m2_794 in
                                        {381}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                        {382}event endCli(Sess,Cli,Ns_795)
                            )
                            else
                                {383}let pkDisco_798: bitstring = fail-any in
                                {384}let v_799: bool = (Sess = A) in
                                (
                                    {385}if v_799 then
                                    (
                                        {386}let pkSess_800: bitstring = pub(skA) in
                                        {387}out(c, GetEndpointRequest);
                                        {388}in(c, (=GetEndpointResponse,=pkSess_800,=None,SP_801: bitstring,UP_802: bitstring));
                                        {389}new Nc_803: bitstring;
                                        {390}let m1_804: bitstring = (OpenSecureChannelRequest,Sess,pkCli,Nc_803) in
                                        {391}event beginCli(Cli,Sess,Nc_803);
                                        {392}out(c, (pkCli,m1_804));
                                        {393}in(c, em2_805: bitstring);
                                        {394}let m2_806: bitstring = em2_805 in
                                        {395}let (=OpenSecureChannelResponse,=Cli,Ns_807: bitstring,ST_808: bitstring,TTL_809: bitstring) = m2_806 in
                                        {396}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                        {397}event endCli(Sess,Cli,Ns_807)
                                    )
                                    else
                                        {398}let v_810: bool = (Sess = B) in
                                        (
                                            {399}if v_810 then
                                            (
                                                {400}let pkSess_811: bitstring = pub(skB) in
                                                {401}out(c, GetEndpointRequest);
                                                {402}in(c, (=GetEndpointResponse,=pkSess_811,=None,SP_812: bitstring,UP_813: bitstring));
                                                {403}new Nc_814: bitstring;
                                                {404}let m1_815: bitstring = (OpenSecureChannelRequest,Sess,pkCli,Nc_814) in
                                                {405}event beginCli(Cli,Sess,Nc_814);
                                                {406}out(c, (pkCli,m1_815));
                                                {407}in(c, em2_816: bitstring);
                                                {408}let m2_817: bitstring = em2_816 in
                                                {409}let (=OpenSecureChannelResponse,=Cli,Ns_818: bitstring,ST_819: bitstring,TTL_820: bitstring) = m2_817 in
                                                {410}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {411}event endCli(Sess,Cli,Ns_818)
                                            )
                                            else
                                                {412}let v_821: bool = (Sess = C) in
                                                (
                                                    {413}if v_821 then
                                                    (
                                                        {414}let pkSess_822: bitstring = pub(skC) in
                                                        {415}out(c, GetEndpointRequest);
                                                        {416}in(c, (=GetEndpointResponse,=pkSess_822,=None,SP_823: bitstring,UP_824: bitstring));
                                                        {417}new Nc_825: bitstring;
                                                        {418}let m1_826: bitstring = (OpenSecureChannelRequest,Sess,pkCli,Nc_825) in
                                                        {419}event beginCli(Cli,Sess,Nc_825);
                                                        {420}out(c, (pkCli,m1_826));
                                                        {421}in(c, em2_827: bitstring);
                                                        {422}let m2_828: bitstring = em2_827 in
                                                        {423}let (=OpenSecureChannelResponse,=Cli,Ns_829: bitstring,ST_830: bitstring,TTL_831: bitstring) = m2_828 in
                                                        {424}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {425}event endCli(Sess,Cli,Ns_829)
                                                    )
                                                    else
                                                        {426}let pkSess_832: bitstring = pub(sk(Sess)) in
                                                        {427}out(c, GetEndpointRequest);
                                                        {428}in(c, (=GetEndpointResponse,=pkSess_832,=None,SP_833: bitstring,UP_834: bitstring));
                                                        {429}new Nc_835: bitstring;
                                                        {430}let m1_836: bitstring = (OpenSecureChannelRequest,Sess,pkCli,Nc_835) in
                                                        {431}event beginCli(Cli,Sess,Nc_835);
                                                        {432}out(c, (pkCli,m1_836));
                                                        {433}in(c, em2_837: bitstring);
                                                        {434}let m2_838: bitstring = em2_837 in
                                                        {435}let (=OpenSecureChannelResponse,=Cli,Ns_839: bitstring,ST_840: bitstring,TTL_841: bitstring) = m2_838 in
                                                        {436}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {437}event endCli(Sess,Cli,Ns_839)
                                                )
                                                else
                                                    {438}let pkSess_842: bitstring = fail-any in
                                                    {439}out(c, GetEndpointRequest);
                                                    {440}in(c, (=GetEndpointResponse,=pkSess_842,=None,SP_843: bitstring,UP_844: bitstring));
                                                    {441}new Nc_845: bitstring;
                                                    {442}let m1_846: bitstring = (OpenSecureChannelRequest,Sess,pkCli,Nc_845) in
                                                    {443}event beginCli(Cli,Sess,Nc_845);
                                                    {444}out(c, (pkCli,m1_846));
                                                    {445}in(c, em2_847: bitstring);
                                                    {446}let m2_848: bitstring = em2_847 in
                                                    {447}let (=OpenSecureChannelResponse,=Cli,Ns_849: bitstring,ST_850: bitstring,TTL_851: bitstring) = m2_848 in
                                                    {448}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {449}event endCli(Sess,Cli,Ns_849)
                                        )
                                        else
                                            {450}let pkSess_852: bitstring = fail-any in
                                            {451}out(c, GetEndpointRequest);
                                            {452}in(c, (=GetEndpointResponse,=pkSess_852,=None,SP_853: bitstring,UP_854: bitstring));
                                            {453}new Nc_855: bitstring;
                                            {454}let m1_856: bitstring = (OpenSecureChannelRequest,Sess,pkCli,Nc_855) in
                                            {455}event beginCli(Cli,Sess,Nc_855);
                                            {456}out(c, (pkCli,m1_856));
                                            {457}in(c, em2_857: bitstring);
                                            {458}let m2_858: bitstring = em2_857 in
                                            {459}let (=OpenSecureChannelResponse,=Cli,Ns_859: bitstring,ST_860: bitstring,TTL_861: bitstring) = m2_858 in
                                            {460}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {461}event endCli(Sess,Cli,Ns_859)
                                )
                                else
                                    {462}let pkSess_862: bitstring = fail-any in
                                    {463}out(c, GetEndpointRequest);
                                    {464}in(c, (=GetEndpointResponse,=pkSess_862,=None,SP_863: bitstring,UP_864: bitstring));
                                    {465}new Nc_865: bitstring;
                                    {466}let m1_866: bitstring = (OpenSecureChannelRequest,Sess,pkCli,Nc_865) in
                                    {467}event beginCli(Cli,Sess,Nc_865);
                                    {468}out(c, (pkCli,m1_866));
                                    {469}in(c, em2_867: bitstring);
                                    {470}let m2_868: bitstring = em2_867 in
                                    {471}let (=OpenSecureChannelResponse,=Cli,Ns_869: bitstring,ST_870: bitstring,TTL_871: bitstring) = m2_868 in
                                    {472}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                    {473}event endCli(Sess,Cli,Ns_869)
                    )
                    else
                        {474}let pkDisco_872: bitstring = fail-any in
                        {475}let v_873: bool = (Sess = A) in
                        (
                            {476}if v_873 then
                            (
                                {477}let pkSess_874: bitstring = pub(skA) in
                                {478}out(c, GetEndpointRequest);
                                {479}in(c, (=GetEndpointResponse,=pkSess_874,=None,SP_875: bitstring,UP_876: bitstring));
                                {480}new Nc_877: bitstring;
                                {481}let m1_878: bitstring = (OpenSecureChannelRequest,Sess,pkCli,Nc_877) in
                                {482}event beginCli(Cli,Sess,Nc_877);
                                {483}out(c, (pkCli,m1_878));
                                {484}in(c, em2_879: bitstring);
                                {485}let m2_880: bitstring = em2_879 in
                                {486}let (=OpenSecureChannelResponse,=Cli,Ns_881: bitstring,ST_882: bitstring,TTL_883: bitstring) = m2_880 in
                                {487}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                {488}event endCli(Sess,Cli,Ns_881)
                            )
                            else
                                {489}let v_884: bool = (Sess = B) in
                                (
                                    {490}if v_884 then
                                    (
                                        {491}let pkSess_885: bitstring = pub(skB) in
                                        {492}out(c, GetEndpointRequest);
                                        {493}in(c, (=GetEndpointResponse,=pkSess_885,=None,SP_886: bitstring,UP_887: bitstring));
                                        {494}new Nc_888: bitstring;
                                        {495}let m1_889: bitstring = (OpenSecureChannelRequest,Sess,pkCli,Nc_888) in
                                        {496}event beginCli(Cli,Sess,Nc_888);
                                        {497}out(c, (pkCli,m1_889));
                                        {498}in(c, em2_890: bitstring);
                                        {499}let m2_891: bitstring = em2_890 in
                                        {500}let (=OpenSecureChannelResponse,=Cli,Ns_892: bitstring,ST_893: bitstring,TTL_894: bitstring) = m2_891 in
                                        {501}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                        {502}event endCli(Sess,Cli,Ns_892)
                                    )
                                    else
                                        {503}let v_895: bool = (Sess = C) in
                                        (
                                            {504}if v_895 then
                                            (
                                                {505}let pkSess_896: bitstring = pub(skC) in
                                                {506}out(c, GetEndpointRequest);
                                                {507}in(c, (=GetEndpointResponse,=pkSess_896,=None,SP_897: bitstring,UP_898: bitstring));
                                                {508}new Nc_899: bitstring;
                                                {509}let m1_900: bitstring = (OpenSecureChannelRequest,Sess,pkCli,Nc_899) in
                                                {510}event beginCli(Cli,Sess,Nc_899);
                                                {511}out(c, (pkCli,m1_900));
                                                {512}in(c, em2_901: bitstring);
                                                {513}let m2_902: bitstring = em2_901 in
                                                {514}let (=OpenSecureChannelResponse,=Cli,Ns_903: bitstring,ST_904: bitstring,TTL_905: bitstring) = m2_902 in
                                                {515}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {516}event endCli(Sess,Cli,Ns_903)
                                            )
                                            else
                                                {517}let pkSess_906: bitstring = pub(sk(Sess)) in
                                                {518}out(c, GetEndpointRequest);
                                                {519}in(c, (=GetEndpointResponse,=pkSess_906,=None,SP_907: bitstring,UP_908: bitstring));
                                                {520}new Nc_909: bitstring;
                                                {521}let m1_910: bitstring = (OpenSecureChannelRequest,Sess,pkCli,Nc_909) in
                                                {522}event beginCli(Cli,Sess,Nc_909);
                                                {523}out(c, (pkCli,m1_910));
                                                {524}in(c, em2_911: bitstring);
                                                {525}let m2_912: bitstring = em2_911 in
                                                {526}let (=OpenSecureChannelResponse,=Cli,Ns_913: bitstring,ST_914: bitstring,TTL_915: bitstring) = m2_912 in
                                                {527}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {528}event endCli(Sess,Cli,Ns_913)
                                        )
                                        else
                                            {529}let pkSess_916: bitstring = fail-any in
                                            {530}out(c, GetEndpointRequest);
                                            {531}in(c, (=GetEndpointResponse,=pkSess_916,=None,SP_917: bitstring,UP_918: bitstring));
                                            {532}new Nc_919: bitstring;
                                            {533}let m1_920: bitstring = (OpenSecureChannelRequest,Sess,pkCli,Nc_919) in
                                            {534}event beginCli(Cli,Sess,Nc_919);
                                            {535}out(c, (pkCli,m1_920));
                                            {536}in(c, em2_921: bitstring);
                                            {537}let m2_922: bitstring = em2_921 in
                                            {538}let (=OpenSecureChannelResponse,=Cli,Ns_923: bitstring,ST_924: bitstring,TTL_925: bitstring) = m2_922 in
                                            {539}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {540}event endCli(Sess,Cli,Ns_923)
                                )
                                else
                                    {541}let pkSess_926: bitstring = fail-any in
                                    {542}out(c, GetEndpointRequest);
                                    {543}in(c, (=GetEndpointResponse,=pkSess_926,=None,SP_927: bitstring,UP_928: bitstring));
                                    {544}new Nc_929: bitstring;
                                    {545}let m1_930: bitstring = (OpenSecureChannelRequest,Sess,pkCli,Nc_929) in
                                    {546}event beginCli(Cli,Sess,Nc_929);
                                    {547}out(c, (pkCli,m1_930));
                                    {548}in(c, em2_931: bitstring);
                                    {549}let m2_932: bitstring = em2_931 in
                                    {550}let (=OpenSecureChannelResponse,=Cli,Ns_933: bitstring,ST_934: bitstring,TTL_935: bitstring) = m2_932 in
                                    {551}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                    {552}event endCli(Sess,Cli,Ns_933)
                        )
                        else
                            {553}let pkSess_936: bitstring = fail-any in
                            {554}out(c, GetEndpointRequest);
                            {555}in(c, (=GetEndpointResponse,=pkSess_936,=None,SP_937: bitstring,UP_938: bitstring));
                            {556}new Nc_939: bitstring;
                            {557}let m1_940: bitstring = (OpenSecureChannelRequest,Sess,pkCli,Nc_939) in
                            {558}event beginCli(Cli,Sess,Nc_939);
                            {559}out(c, (pkCli,m1_940));
                            {560}in(c, em2_941: bitstring);
                            {561}let m2_942: bitstring = em2_941 in
                            {562}let (=OpenSecureChannelResponse,=Cli,Ns_943: bitstring,ST_944: bitstring,TTL_945: bitstring) = m2_942 in
                            {563}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                            {564}event endCli(Sess,Cli,Ns_943)
            )
            else
                {565}let pkDisco_946: bitstring = fail-any in
                {566}let v_947: bool = (Sess = A) in
                (
                    {567}if v_947 then
                    (
                        {568}let pkSess_948: bitstring = pub(skA) in
                        {569}out(c, GetEndpointRequest);
                        {570}in(c, (=GetEndpointResponse,=pkSess_948,=None,SP_949: bitstring,UP_950: bitstring));
                        {571}new Nc_951: bitstring;
                        {572}let m1_952: bitstring = (OpenSecureChannelRequest,Sess,pkCli,Nc_951) in
                        {573}event beginCli(Cli,Sess,Nc_951);
                        {574}out(c, (pkCli,m1_952));
                        {575}in(c, em2_953: bitstring);
                        {576}let m2_954: bitstring = em2_953 in
                        {577}let (=OpenSecureChannelResponse,=Cli,Ns_955: bitstring,ST_956: bitstring,TTL_957: bitstring) = m2_954 in
                        {578}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                        {579}event endCli(Sess,Cli,Ns_955)
                    )
                    else
                        {580}let v_958: bool = (Sess = B) in
                        (
                            {581}if v_958 then
                            (
                                {582}let pkSess_959: bitstring = pub(skB) in
                                {583}out(c, GetEndpointRequest);
                                {584}in(c, (=GetEndpointResponse,=pkSess_959,=None,SP_960: bitstring,UP_961: bitstring));
                                {585}new Nc_962: bitstring;
                                {586}let m1_963: bitstring = (OpenSecureChannelRequest,Sess,pkCli,Nc_962) in
                                {587}event beginCli(Cli,Sess,Nc_962);
                                {588}out(c, (pkCli,m1_963));
                                {589}in(c, em2_964: bitstring);
                                {590}let m2_965: bitstring = em2_964 in
                                {591}let (=OpenSecureChannelResponse,=Cli,Ns_966: bitstring,ST_967: bitstring,TTL_968: bitstring) = m2_965 in
                                {592}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                {593}event endCli(Sess,Cli,Ns_966)
                            )
                            else
                                {594}let v_969: bool = (Sess = C) in
                                (
                                    {595}if v_969 then
                                    (
                                        {596}let pkSess_970: bitstring = pub(skC) in
                                        {597}out(c, GetEndpointRequest);
                                        {598}in(c, (=GetEndpointResponse,=pkSess_970,=None,SP_971: bitstring,UP_972: bitstring));
                                        {599}new Nc_973: bitstring;
                                        {600}let m1_974: bitstring = (OpenSecureChannelRequest,Sess,pkCli,Nc_973) in
                                        {601}event beginCli(Cli,Sess,Nc_973);
                                        {602}out(c, (pkCli,m1_974));
                                        {603}in(c, em2_975: bitstring);
                                        {604}let m2_976: bitstring = em2_975 in
                                        {605}let (=OpenSecureChannelResponse,=Cli,Ns_977: bitstring,ST_978: bitstring,TTL_979: bitstring) = m2_976 in
                                        {606}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                        {607}event endCli(Sess,Cli,Ns_977)
                                    )
                                    else
                                        {608}let pkSess_980: bitstring = pub(sk(Sess)) in
                                        {609}out(c, GetEndpointRequest);
                                        {610}in(c, (=GetEndpointResponse,=pkSess_980,=None,SP_981: bitstring,UP_982: bitstring));
                                        {611}new Nc_983: bitstring;
                                        {612}let m1_984: bitstring = (OpenSecureChannelRequest,Sess,pkCli,Nc_983) in
                                        {613}event beginCli(Cli,Sess,Nc_983);
                                        {614}out(c, (pkCli,m1_984));
                                        {615}in(c, em2_985: bitstring);
                                        {616}let m2_986: bitstring = em2_985 in
                                        {617}let (=OpenSecureChannelResponse,=Cli,Ns_987: bitstring,ST_988: bitstring,TTL_989: bitstring) = m2_986 in
                                        {618}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                        {619}event endCli(Sess,Cli,Ns_987)
                                )
                                else
                                    {620}let pkSess_990: bitstring = fail-any in
                                    {621}out(c, GetEndpointRequest);
                                    {622}in(c, (=GetEndpointResponse,=pkSess_990,=None,SP_991: bitstring,UP_992: bitstring));
                                    {623}new Nc_993: bitstring;
                                    {624}let m1_994: bitstring = (OpenSecureChannelRequest,Sess,pkCli,Nc_993) in
                                    {625}event beginCli(Cli,Sess,Nc_993);
                                    {626}out(c, (pkCli,m1_994));
                                    {627}in(c, em2_995: bitstring);
                                    {628}let m2_996: bitstring = em2_995 in
                                    {629}let (=OpenSecureChannelResponse,=Cli,Ns_997: bitstring,ST_998: bitstring,TTL_999: bitstring) = m2_996 in
                                    {630}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                    {631}event endCli(Sess,Cli,Ns_997)
                        )
                        else
                            {632}let pkSess_1000: bitstring = fail-any in
                            {633}out(c, GetEndpointRequest);
                            {634}in(c, (=GetEndpointResponse,=pkSess_1000,=None,SP_1001: bitstring,UP_1002: bitstring));
                            {635}new Nc_1003: bitstring;
                            {636}let m1_1004: bitstring = (OpenSecureChannelRequest,Sess,pkCli,Nc_1003) in
                            {637}event beginCli(Cli,Sess,Nc_1003);
                            {638}out(c, (pkCli,m1_1004));
                            {639}in(c, em2_1005: bitstring);
                            {640}let m2_1006: bitstring = em2_1005 in
                            {641}let (=OpenSecureChannelResponse,=Cli,Ns_1007: bitstring,ST_1008: bitstring,TTL_1009: bitstring) = m2_1006 in
                            {642}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                            {643}event endCli(Sess,Cli,Ns_1007)
                )
                else
                    {644}let pkSess_1010: bitstring = fail-any in
                    {645}out(c, GetEndpointRequest);
                    {646}in(c, (=GetEndpointResponse,=pkSess_1010,=None,SP_1011: bitstring,UP_1012: bitstring));
                    {647}new Nc_1013: bitstring;
                    {648}let m1_1014: bitstring = (OpenSecureChannelRequest,Sess,pkCli,Nc_1013) in
                    {649}event beginCli(Cli,Sess,Nc_1013);
                    {650}out(c, (pkCli,m1_1014));
                    {651}in(c, em2_1015: bitstring);
                    {652}let m2_1016: bitstring = em2_1015 in
                    {653}let (=OpenSecureChannelResponse,=Cli,Ns_1017: bitstring,ST_1018: bitstring,TTL_1019: bitstring) = m2_1016 in
                    {654}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                    {655}event endCli(Sess,Cli,Ns_1017)
        )
        else
            {656}let v_1020: bool = (Cli = B) in
            (
                {657}if v_1020 then
                (
                    {658}let skCli_1021: bitstring = skB in
                    {659}let pkCli_1022: bitstring = pub(skCli_1021) in
                    {660}let v_1023: bool = (Disco = A) in
                    (
                        {661}if v_1023 then
                        (
                            {662}let pkDisco_1024: bitstring = pub(skA) in
                            {663}let v_1025: bool = (Sess = A) in
                            (
                                {664}if v_1025 then
                                (
                                    {665}let pkSess_1026: bitstring = pub(skA) in
                                    {666}out(c, GetEndpointRequest);
                                    {667}in(c, (=GetEndpointResponse,=pkSess_1026,=None,SP_1027: bitstring,UP_1028: bitstring));
                                    {668}new Nc_1029: bitstring;
                                    {669}let m1_1030: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1022,Nc_1029) in
                                    {670}event beginCli(Cli,Sess,Nc_1029);
                                    {671}out(c, (pkCli_1022,m1_1030));
                                    {672}in(c, em2_1031: bitstring);
                                    {673}let m2_1032: bitstring = em2_1031 in
                                    {674}let (=OpenSecureChannelResponse,=Cli,Ns_1033: bitstring,ST_1034: bitstring,TTL_1035: bitstring) = m2_1032 in
                                    {675}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                    {676}event endCli(Sess,Cli,Ns_1033)
                                )
                                else
                                    {677}let v_1036: bool = (Sess = B) in
                                    (
                                        {678}if v_1036 then
                                        (
                                            {679}let pkSess_1037: bitstring = pub(skB) in
                                            {680}out(c, GetEndpointRequest);
                                            {681}in(c, (=GetEndpointResponse,=pkSess_1037,=None,SP_1038: bitstring,UP_1039: bitstring));
                                            {682}new Nc_1040: bitstring;
                                            {683}let m1_1041: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1022,Nc_1040) in
                                            {684}event beginCli(Cli,Sess,Nc_1040);
                                            {685}out(c, (pkCli_1022,m1_1041));
                                            {686}in(c, em2_1042: bitstring);
                                            {687}let m2_1043: bitstring = em2_1042 in
                                            {688}let (=OpenSecureChannelResponse,=Cli,Ns_1044: bitstring,ST_1045: bitstring,TTL_1046: bitstring) = m2_1043 in
                                            {689}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {690}event endCli(Sess,Cli,Ns_1044)
                                        )
                                        else
                                            {691}let v_1047: bool = (Sess = C) in
                                            (
                                                {692}if v_1047 then
                                                (
                                                    {693}let pkSess_1048: bitstring = pub(skC) in
                                                    {694}out(c, GetEndpointRequest);
                                                    {695}in(c, (=GetEndpointResponse,=pkSess_1048,=None,SP_1049: bitstring,UP_1050: bitstring));
                                                    {696}new Nc_1051: bitstring;
                                                    {697}let m1_1052: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1022,Nc_1051) in
                                                    {698}event beginCli(Cli,Sess,Nc_1051);
                                                    {699}out(c, (pkCli_1022,m1_1052));
                                                    {700}in(c, em2_1053: bitstring);
                                                    {701}let m2_1054: bitstring = em2_1053 in
                                                    {702}let (=OpenSecureChannelResponse,=Cli,Ns_1055: bitstring,ST_1056: bitstring,TTL_1057: bitstring) = m2_1054 in
                                                    {703}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {704}event endCli(Sess,Cli,Ns_1055)
                                                )
                                                else
                                                    {705}let pkSess_1058: bitstring = pub(sk(Sess)) in
                                                    {706}out(c, GetEndpointRequest);
                                                    {707}in(c, (=GetEndpointResponse,=pkSess_1058,=None,SP_1059: bitstring,UP_1060: bitstring));
                                                    {708}new Nc_1061: bitstring;
                                                    {709}let m1_1062: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1022,Nc_1061) in
                                                    {710}event beginCli(Cli,Sess,Nc_1061);
                                                    {711}out(c, (pkCli_1022,m1_1062));
                                                    {712}in(c, em2_1063: bitstring);
                                                    {713}let m2_1064: bitstring = em2_1063 in
                                                    {714}let (=OpenSecureChannelResponse,=Cli,Ns_1065: bitstring,ST_1066: bitstring,TTL_1067: bitstring) = m2_1064 in
                                                    {715}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {716}event endCli(Sess,Cli,Ns_1065)
                                            )
                                            else
                                                {717}let pkSess_1068: bitstring = fail-any in
                                                {718}out(c, GetEndpointRequest);
                                                {719}in(c, (=GetEndpointResponse,=pkSess_1068,=None,SP_1069: bitstring,UP_1070: bitstring));
                                                {720}new Nc_1071: bitstring;
                                                {721}let m1_1072: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1022,Nc_1071) in
                                                {722}event beginCli(Cli,Sess,Nc_1071);
                                                {723}out(c, (pkCli_1022,m1_1072));
                                                {724}in(c, em2_1073: bitstring);
                                                {725}let m2_1074: bitstring = em2_1073 in
                                                {726}let (=OpenSecureChannelResponse,=Cli,Ns_1075: bitstring,ST_1076: bitstring,TTL_1077: bitstring) = m2_1074 in
                                                {727}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {728}event endCli(Sess,Cli,Ns_1075)
                                    )
                                    else
                                        {729}let pkSess_1078: bitstring = fail-any in
                                        {730}out(c, GetEndpointRequest);
                                        {731}in(c, (=GetEndpointResponse,=pkSess_1078,=None,SP_1079: bitstring,UP_1080: bitstring));
                                        {732}new Nc_1081: bitstring;
                                        {733}let m1_1082: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1022,Nc_1081) in
                                        {734}event beginCli(Cli,Sess,Nc_1081);
                                        {735}out(c, (pkCli_1022,m1_1082));
                                        {736}in(c, em2_1083: bitstring);
                                        {737}let m2_1084: bitstring = em2_1083 in
                                        {738}let (=OpenSecureChannelResponse,=Cli,Ns_1085: bitstring,ST_1086: bitstring,TTL_1087: bitstring) = m2_1084 in
                                        {739}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                        {740}event endCli(Sess,Cli,Ns_1085)
                            )
                            else
                                {741}let pkSess_1088: bitstring = fail-any in
                                {742}out(c, GetEndpointRequest);
                                {743}in(c, (=GetEndpointResponse,=pkSess_1088,=None,SP_1089: bitstring,UP_1090: bitstring));
                                {744}new Nc_1091: bitstring;
                                {745}let m1_1092: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1022,Nc_1091) in
                                {746}event beginCli(Cli,Sess,Nc_1091);
                                {747}out(c, (pkCli_1022,m1_1092));
                                {748}in(c, em2_1093: bitstring);
                                {749}let m2_1094: bitstring = em2_1093 in
                                {750}let (=OpenSecureChannelResponse,=Cli,Ns_1095: bitstring,ST_1096: bitstring,TTL_1097: bitstring) = m2_1094 in
                                {751}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                {752}event endCli(Sess,Cli,Ns_1095)
                        )
                        else
                            {753}let v_1098: bool = (Disco = B) in
                            (
                                {754}if v_1098 then
                                (
                                    {755}let pkDisco_1099: bitstring = pub(skB) in
                                    {756}let v_1100: bool = (Sess = A) in
                                    (
                                        {757}if v_1100 then
                                        (
                                            {758}let pkSess_1101: bitstring = pub(skA) in
                                            {759}out(c, GetEndpointRequest);
                                            {760}in(c, (=GetEndpointResponse,=pkSess_1101,=None,SP_1102: bitstring,UP_1103: bitstring));
                                            {761}new Nc_1104: bitstring;
                                            {762}let m1_1105: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1022,Nc_1104) in
                                            {763}event beginCli(Cli,Sess,Nc_1104);
                                            {764}out(c, (pkCli_1022,m1_1105));
                                            {765}in(c, em2_1106: bitstring);
                                            {766}let m2_1107: bitstring = em2_1106 in
                                            {767}let (=OpenSecureChannelResponse,=Cli,Ns_1108: bitstring,ST_1109: bitstring,TTL_1110: bitstring) = m2_1107 in
                                            {768}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {769}event endCli(Sess,Cli,Ns_1108)
                                        )
                                        else
                                            {770}let v_1111: bool = (Sess = B) in
                                            (
                                                {771}if v_1111 then
                                                (
                                                    {772}let pkSess_1112: bitstring = pub(skB) in
                                                    {773}out(c, GetEndpointRequest);
                                                    {774}in(c, (=GetEndpointResponse,=pkSess_1112,=None,SP_1113: bitstring,UP_1114: bitstring));
                                                    {775}new Nc_1115: bitstring;
                                                    {776}let m1_1116: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1022,Nc_1115) in
                                                    {777}event beginCli(Cli,Sess,Nc_1115);
                                                    {778}out(c, (pkCli_1022,m1_1116));
                                                    {779}in(c, em2_1117: bitstring);
                                                    {780}let m2_1118: bitstring = em2_1117 in
                                                    {781}let (=OpenSecureChannelResponse,=Cli,Ns_1119: bitstring,ST_1120: bitstring,TTL_1121: bitstring) = m2_1118 in
                                                    {782}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {783}event endCli(Sess,Cli,Ns_1119)
                                                )
                                                else
                                                    {784}let v_1122: bool = (Sess = C) in
                                                    (
                                                        {785}if v_1122 then
                                                        (
                                                            {786}let pkSess_1123: bitstring = pub(skC) in
                                                            {787}out(c, GetEndpointRequest);
                                                            {788}in(c, (=GetEndpointResponse,=pkSess_1123,=None,SP_1124: bitstring,UP_1125: bitstring));
                                                            {789}new Nc_1126: bitstring;
                                                            {790}let m1_1127: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1022,Nc_1126) in
                                                            {791}event beginCli(Cli,Sess,Nc_1126);
                                                            {792}out(c, (pkCli_1022,m1_1127));
                                                            {793}in(c, em2_1128: bitstring);
                                                            {794}let m2_1129: bitstring = em2_1128 in
                                                            {795}let (=OpenSecureChannelResponse,=Cli,Ns_1130: bitstring,ST_1131: bitstring,TTL_1132: bitstring) = m2_1129 in
                                                            {796}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                            {797}event endCli(Sess,Cli,Ns_1130)
                                                        )
                                                        else
                                                            {798}let pkSess_1133: bitstring = pub(sk(Sess)) in
                                                            {799}out(c, GetEndpointRequest);
                                                            {800}in(c, (=GetEndpointResponse,=pkSess_1133,=None,SP_1134: bitstring,UP_1135: bitstring));
                                                            {801}new Nc_1136: bitstring;
                                                            {802}let m1_1137: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1022,Nc_1136) in
                                                            {803}event beginCli(Cli,Sess,Nc_1136);
                                                            {804}out(c, (pkCli_1022,m1_1137));
                                                            {805}in(c, em2_1138: bitstring);
                                                            {806}let m2_1139: bitstring = em2_1138 in
                                                            {807}let (=OpenSecureChannelResponse,=Cli,Ns_1140: bitstring,ST_1141: bitstring,TTL_1142: bitstring) = m2_1139 in
                                                            {808}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                            {809}event endCli(Sess,Cli,Ns_1140)
                                                    )
                                                    else
                                                        {810}let pkSess_1143: bitstring = fail-any in
                                                        {811}out(c, GetEndpointRequest);
                                                        {812}in(c, (=GetEndpointResponse,=pkSess_1143,=None,SP_1144: bitstring,UP_1145: bitstring));
                                                        {813}new Nc_1146: bitstring;
                                                        {814}let m1_1147: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1022,Nc_1146) in
                                                        {815}event beginCli(Cli,Sess,Nc_1146);
                                                        {816}out(c, (pkCli_1022,m1_1147));
                                                        {817}in(c, em2_1148: bitstring);
                                                        {818}let m2_1149: bitstring = em2_1148 in
                                                        {819}let (=OpenSecureChannelResponse,=Cli,Ns_1150: bitstring,ST_1151: bitstring,TTL_1152: bitstring) = m2_1149 in
                                                        {820}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {821}event endCli(Sess,Cli,Ns_1150)
                                            )
                                            else
                                                {822}let pkSess_1153: bitstring = fail-any in
                                                {823}out(c, GetEndpointRequest);
                                                {824}in(c, (=GetEndpointResponse,=pkSess_1153,=None,SP_1154: bitstring,UP_1155: bitstring));
                                                {825}new Nc_1156: bitstring;
                                                {826}let m1_1157: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1022,Nc_1156) in
                                                {827}event beginCli(Cli,Sess,Nc_1156);
                                                {828}out(c, (pkCli_1022,m1_1157));
                                                {829}in(c, em2_1158: bitstring);
                                                {830}let m2_1159: bitstring = em2_1158 in
                                                {831}let (=OpenSecureChannelResponse,=Cli,Ns_1160: bitstring,ST_1161: bitstring,TTL_1162: bitstring) = m2_1159 in
                                                {832}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {833}event endCli(Sess,Cli,Ns_1160)
                                    )
                                    else
                                        {834}let pkSess_1163: bitstring = fail-any in
                                        {835}out(c, GetEndpointRequest);
                                        {836}in(c, (=GetEndpointResponse,=pkSess_1163,=None,SP_1164: bitstring,UP_1165: bitstring));
                                        {837}new Nc_1166: bitstring;
                                        {838}let m1_1167: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1022,Nc_1166) in
                                        {839}event beginCli(Cli,Sess,Nc_1166);
                                        {840}out(c, (pkCli_1022,m1_1167));
                                        {841}in(c, em2_1168: bitstring);
                                        {842}let m2_1169: bitstring = em2_1168 in
                                        {843}let (=OpenSecureChannelResponse,=Cli,Ns_1170: bitstring,ST_1171: bitstring,TTL_1172: bitstring) = m2_1169 in
                                        {844}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                        {845}event endCli(Sess,Cli,Ns_1170)
                                )
                                else
                                    {846}let v_1173: bool = (Disco = C) in
                                    (
                                        {847}if v_1173 then
                                        (
                                            {848}let pkDisco_1174: bitstring = pub(skC) in
                                            {849}let v_1175: bool = (Sess = A) in
                                            (
                                                {850}if v_1175 then
                                                (
                                                    {851}let pkSess_1176: bitstring = pub(skA) in
                                                    {852}out(c, GetEndpointRequest);
                                                    {853}in(c, (=GetEndpointResponse,=pkSess_1176,=None,SP_1177: bitstring,UP_1178: bitstring));
                                                    {854}new Nc_1179: bitstring;
                                                    {855}let m1_1180: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1022,Nc_1179) in
                                                    {856}event beginCli(Cli,Sess,Nc_1179);
                                                    {857}out(c, (pkCli_1022,m1_1180));
                                                    {858}in(c, em2_1181: bitstring);
                                                    {859}let m2_1182: bitstring = em2_1181 in
                                                    {860}let (=OpenSecureChannelResponse,=Cli,Ns_1183: bitstring,ST_1184: bitstring,TTL_1185: bitstring) = m2_1182 in
                                                    {861}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {862}event endCli(Sess,Cli,Ns_1183)
                                                )
                                                else
                                                    {863}let v_1186: bool = (Sess = B) in
                                                    (
                                                        {864}if v_1186 then
                                                        (
                                                            {865}let pkSess_1187: bitstring = pub(skB) in
                                                            {866}out(c, GetEndpointRequest);
                                                            {867}in(c, (=GetEndpointResponse,=pkSess_1187,=None,SP_1188: bitstring,UP_1189: bitstring));
                                                            {868}new Nc_1190: bitstring;
                                                            {869}let m1_1191: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1022,Nc_1190) in
                                                            {870}event beginCli(Cli,Sess,Nc_1190);
                                                            {871}out(c, (pkCli_1022,m1_1191));
                                                            {872}in(c, em2_1192: bitstring);
                                                            {873}let m2_1193: bitstring = em2_1192 in
                                                            {874}let (=OpenSecureChannelResponse,=Cli,Ns_1194: bitstring,ST_1195: bitstring,TTL_1196: bitstring) = m2_1193 in
                                                            {875}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                            {876}event endCli(Sess,Cli,Ns_1194)
                                                        )
                                                        else
                                                            {877}let v_1197: bool = (Sess = C) in
                                                            (
                                                                {878}if v_1197 then
                                                                (
                                                                    {879}let pkSess_1198: bitstring = pub(skC) in
                                                                    {880}out(c, GetEndpointRequest);
                                                                    {881}in(c, (=GetEndpointResponse,=pkSess_1198,=None,SP_1199: bitstring,UP_1200: bitstring));
                                                                    {882}new Nc_1201: bitstring;
                                                                    {883}let m1_1202: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1022,Nc_1201) in
                                                                    {884}event beginCli(Cli,Sess,Nc_1201);
                                                                    {885}out(c, (pkCli_1022,m1_1202));
                                                                    {886}in(c, em2_1203: bitstring);
                                                                    {887}let m2_1204: bitstring = em2_1203 in
                                                                    {888}let (=OpenSecureChannelResponse,=Cli,Ns_1205: bitstring,ST_1206: bitstring,TTL_1207: bitstring) = m2_1204 in
                                                                    {889}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                    {890}event endCli(Sess,Cli,Ns_1205)
                                                                )
                                                                else
                                                                    {891}let pkSess_1208: bitstring = pub(sk(Sess)) in
                                                                    {892}out(c, GetEndpointRequest);
                                                                    {893}in(c, (=GetEndpointResponse,=pkSess_1208,=None,SP_1209: bitstring,UP_1210: bitstring));
                                                                    {894}new Nc_1211: bitstring;
                                                                    {895}let m1_1212: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1022,Nc_1211) in
                                                                    {896}event beginCli(Cli,Sess,Nc_1211);
                                                                    {897}out(c, (pkCli_1022,m1_1212));
                                                                    {898}in(c, em2_1213: bitstring);
                                                                    {899}let m2_1214: bitstring = em2_1213 in
                                                                    {900}let (=OpenSecureChannelResponse,=Cli,Ns_1215: bitstring,ST_1216: bitstring,TTL_1217: bitstring) = m2_1214 in
                                                                    {901}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                    {902}event endCli(Sess,Cli,Ns_1215)
                                                            )
                                                            else
                                                                {903}let pkSess_1218: bitstring = fail-any in
                                                                {904}out(c, GetEndpointRequest);
                                                                {905}in(c, (=GetEndpointResponse,=pkSess_1218,=None,SP_1219: bitstring,UP_1220: bitstring));
                                                                {906}new Nc_1221: bitstring;
                                                                {907}let m1_1222: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1022,Nc_1221) in
                                                                {908}event beginCli(Cli,Sess,Nc_1221);
                                                                {909}out(c, (pkCli_1022,m1_1222));
                                                                {910}in(c, em2_1223: bitstring);
                                                                {911}let m2_1224: bitstring = em2_1223 in
                                                                {912}let (=OpenSecureChannelResponse,=Cli,Ns_1225: bitstring,ST_1226: bitstring,TTL_1227: bitstring) = m2_1224 in
                                                                {913}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                {914}event endCli(Sess,Cli,Ns_1225)
                                                    )
                                                    else
                                                        {915}let pkSess_1228: bitstring = fail-any in
                                                        {916}out(c, GetEndpointRequest);
                                                        {917}in(c, (=GetEndpointResponse,=pkSess_1228,=None,SP_1229: bitstring,UP_1230: bitstring));
                                                        {918}new Nc_1231: bitstring;
                                                        {919}let m1_1232: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1022,Nc_1231) in
                                                        {920}event beginCli(Cli,Sess,Nc_1231);
                                                        {921}out(c, (pkCli_1022,m1_1232));
                                                        {922}in(c, em2_1233: bitstring);
                                                        {923}let m2_1234: bitstring = em2_1233 in
                                                        {924}let (=OpenSecureChannelResponse,=Cli,Ns_1235: bitstring,ST_1236: bitstring,TTL_1237: bitstring) = m2_1234 in
                                                        {925}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {926}event endCli(Sess,Cli,Ns_1235)
                                            )
                                            else
                                                {927}let pkSess_1238: bitstring = fail-any in
                                                {928}out(c, GetEndpointRequest);
                                                {929}in(c, (=GetEndpointResponse,=pkSess_1238,=None,SP_1239: bitstring,UP_1240: bitstring));
                                                {930}new Nc_1241: bitstring;
                                                {931}let m1_1242: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1022,Nc_1241) in
                                                {932}event beginCli(Cli,Sess,Nc_1241);
                                                {933}out(c, (pkCli_1022,m1_1242));
                                                {934}in(c, em2_1243: bitstring);
                                                {935}let m2_1244: bitstring = em2_1243 in
                                                {936}let (=OpenSecureChannelResponse,=Cli,Ns_1245: bitstring,ST_1246: bitstring,TTL_1247: bitstring) = m2_1244 in
                                                {937}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {938}event endCli(Sess,Cli,Ns_1245)
                                        )
                                        else
                                            {939}let pkDisco_1248: bitstring = pub(sk(Disco)) in
                                            {940}let v_1249: bool = (Sess = A) in
                                            (
                                                {941}if v_1249 then
                                                (
                                                    {942}let pkSess_1250: bitstring = pub(skA) in
                                                    {943}out(c, GetEndpointRequest);
                                                    {944}in(c, (=GetEndpointResponse,=pkSess_1250,=None,SP_1251: bitstring,UP_1252: bitstring));
                                                    {945}new Nc_1253: bitstring;
                                                    {946}let m1_1254: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1022,Nc_1253) in
                                                    {947}event beginCli(Cli,Sess,Nc_1253);
                                                    {948}out(c, (pkCli_1022,m1_1254));
                                                    {949}in(c, em2_1255: bitstring);
                                                    {950}let m2_1256: bitstring = em2_1255 in
                                                    {951}let (=OpenSecureChannelResponse,=Cli,Ns_1257: bitstring,ST_1258: bitstring,TTL_1259: bitstring) = m2_1256 in
                                                    {952}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {953}event endCli(Sess,Cli,Ns_1257)
                                                )
                                                else
                                                    {954}let v_1260: bool = (Sess = B) in
                                                    (
                                                        {955}if v_1260 then
                                                        (
                                                            {956}let pkSess_1261: bitstring = pub(skB) in
                                                            {957}out(c, GetEndpointRequest);
                                                            {958}in(c, (=GetEndpointResponse,=pkSess_1261,=None,SP_1262: bitstring,UP_1263: bitstring));
                                                            {959}new Nc_1264: bitstring;
                                                            {960}let m1_1265: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1022,Nc_1264) in
                                                            {961}event beginCli(Cli,Sess,Nc_1264);
                                                            {962}out(c, (pkCli_1022,m1_1265));
                                                            {963}in(c, em2_1266: bitstring);
                                                            {964}let m2_1267: bitstring = em2_1266 in
                                                            {965}let (=OpenSecureChannelResponse,=Cli,Ns_1268: bitstring,ST_1269: bitstring,TTL_1270: bitstring) = m2_1267 in
                                                            {966}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                            {967}event endCli(Sess,Cli,Ns_1268)
                                                        )
                                                        else
                                                            {968}let v_1271: bool = (Sess = C) in
                                                            (
                                                                {969}if v_1271 then
                                                                (
                                                                    {970}let pkSess_1272: bitstring = pub(skC) in
                                                                    {971}out(c, GetEndpointRequest);
                                                                    {972}in(c, (=GetEndpointResponse,=pkSess_1272,=None,SP_1273: bitstring,UP_1274: bitstring));
                                                                    {973}new Nc_1275: bitstring;
                                                                    {974}let m1_1276: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1022,Nc_1275) in
                                                                    {975}event beginCli(Cli,Sess,Nc_1275);
                                                                    {976}out(c, (pkCli_1022,m1_1276));
                                                                    {977}in(c, em2_1277: bitstring);
                                                                    {978}let m2_1278: bitstring = em2_1277 in
                                                                    {979}let (=OpenSecureChannelResponse,=Cli,Ns_1279: bitstring,ST_1280: bitstring,TTL_1281: bitstring) = m2_1278 in
                                                                    {980}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                    {981}event endCli(Sess,Cli,Ns_1279)
                                                                )
                                                                else
                                                                    {982}let pkSess_1282: bitstring = pub(sk(Sess)) in
                                                                    {983}out(c, GetEndpointRequest);
                                                                    {984}in(c, (=GetEndpointResponse,=pkSess_1282,=None,SP_1283: bitstring,UP_1284: bitstring));
                                                                    {985}new Nc_1285: bitstring;
                                                                    {986}let m1_1286: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1022,Nc_1285) in
                                                                    {987}event beginCli(Cli,Sess,Nc_1285);
                                                                    {988}out(c, (pkCli_1022,m1_1286));
                                                                    {989}in(c, em2_1287: bitstring);
                                                                    {990}let m2_1288: bitstring = em2_1287 in
                                                                    {991}let (=OpenSecureChannelResponse,=Cli,Ns_1289: bitstring,ST_1290: bitstring,TTL_1291: bitstring) = m2_1288 in
                                                                    {992}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                    {993}event endCli(Sess,Cli,Ns_1289)
                                                            )
                                                            else
                                                                {994}let pkSess_1292: bitstring = fail-any in
                                                                {995}out(c, GetEndpointRequest);
                                                                {996}in(c, (=GetEndpointResponse,=pkSess_1292,=None,SP_1293: bitstring,UP_1294: bitstring));
                                                                {997}new Nc_1295: bitstring;
                                                                {998}let m1_1296: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1022,Nc_1295) in
                                                                {999}event beginCli(Cli,Sess,Nc_1295);
                                                                {1000}out(c, (pkCli_1022,m1_1296));
                                                                {1001}in(c, em2_1297: bitstring);
                                                                {1002}let m2_1298: bitstring = em2_1297 in
                                                                {1003}let (=OpenSecureChannelResponse,=Cli,Ns_1299: bitstring,ST_1300: bitstring,TTL_1301: bitstring) = m2_1298 in
                                                                {1004}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                {1005}event endCli(Sess,Cli,Ns_1299)
                                                    )
                                                    else
                                                        {1006}let pkSess_1302: bitstring = fail-any in
                                                        {1007}out(c, GetEndpointRequest);
                                                        {1008}in(c, (=GetEndpointResponse,=pkSess_1302,=None,SP_1303: bitstring,UP_1304: bitstring));
                                                        {1009}new Nc_1305: bitstring;
                                                        {1010}let m1_1306: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1022,Nc_1305) in
                                                        {1011}event beginCli(Cli,Sess,Nc_1305);
                                                        {1012}out(c, (pkCli_1022,m1_1306));
                                                        {1013}in(c, em2_1307: bitstring);
                                                        {1014}let m2_1308: bitstring = em2_1307 in
                                                        {1015}let (=OpenSecureChannelResponse,=Cli,Ns_1309: bitstring,ST_1310: bitstring,TTL_1311: bitstring) = m2_1308 in
                                                        {1016}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {1017}event endCli(Sess,Cli,Ns_1309)
                                            )
                                            else
                                                {1018}let pkSess_1312: bitstring = fail-any in
                                                {1019}out(c, GetEndpointRequest);
                                                {1020}in(c, (=GetEndpointResponse,=pkSess_1312,=None,SP_1313: bitstring,UP_1314: bitstring));
                                                {1021}new Nc_1315: bitstring;
                                                {1022}let m1_1316: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1022,Nc_1315) in
                                                {1023}event beginCli(Cli,Sess,Nc_1315);
                                                {1024}out(c, (pkCli_1022,m1_1316));
                                                {1025}in(c, em2_1317: bitstring);
                                                {1026}let m2_1318: bitstring = em2_1317 in
                                                {1027}let (=OpenSecureChannelResponse,=Cli,Ns_1319: bitstring,ST_1320: bitstring,TTL_1321: bitstring) = m2_1318 in
                                                {1028}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {1029}event endCli(Sess,Cli,Ns_1319)
                                    )
                                    else
                                        {1030}let pkDisco_1322: bitstring = fail-any in
                                        {1031}let v_1323: bool = (Sess = A) in
                                        (
                                            {1032}if v_1323 then
                                            (
                                                {1033}let pkSess_1324: bitstring = pub(skA) in
                                                {1034}out(c, GetEndpointRequest);
                                                {1035}in(c, (=GetEndpointResponse,=pkSess_1324,=None,SP_1325: bitstring,UP_1326: bitstring));
                                                {1036}new Nc_1327: bitstring;
                                                {1037}let m1_1328: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1022,Nc_1327) in
                                                {1038}event beginCli(Cli,Sess,Nc_1327);
                                                {1039}out(c, (pkCli_1022,m1_1328));
                                                {1040}in(c, em2_1329: bitstring);
                                                {1041}let m2_1330: bitstring = em2_1329 in
                                                {1042}let (=OpenSecureChannelResponse,=Cli,Ns_1331: bitstring,ST_1332: bitstring,TTL_1333: bitstring) = m2_1330 in
                                                {1043}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {1044}event endCli(Sess,Cli,Ns_1331)
                                            )
                                            else
                                                {1045}let v_1334: bool = (Sess = B) in
                                                (
                                                    {1046}if v_1334 then
                                                    (
                                                        {1047}let pkSess_1335: bitstring = pub(skB) in
                                                        {1048}out(c, GetEndpointRequest);
                                                        {1049}in(c, (=GetEndpointResponse,=pkSess_1335,=None,SP_1336: bitstring,UP_1337: bitstring));
                                                        {1050}new Nc_1338: bitstring;
                                                        {1051}let m1_1339: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1022,Nc_1338) in
                                                        {1052}event beginCli(Cli,Sess,Nc_1338);
                                                        {1053}out(c, (pkCli_1022,m1_1339));
                                                        {1054}in(c, em2_1340: bitstring);
                                                        {1055}let m2_1341: bitstring = em2_1340 in
                                                        {1056}let (=OpenSecureChannelResponse,=Cli,Ns_1342: bitstring,ST_1343: bitstring,TTL_1344: bitstring) = m2_1341 in
                                                        {1057}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {1058}event endCli(Sess,Cli,Ns_1342)
                                                    )
                                                    else
                                                        {1059}let v_1345: bool = (Sess = C) in
                                                        (
                                                            {1060}if v_1345 then
                                                            (
                                                                {1061}let pkSess_1346: bitstring = pub(skC) in
                                                                {1062}out(c, GetEndpointRequest);
                                                                {1063}in(c, (=GetEndpointResponse,=pkSess_1346,=None,SP_1347: bitstring,UP_1348: bitstring));
                                                                {1064}new Nc_1349: bitstring;
                                                                {1065}let m1_1350: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1022,Nc_1349) in
                                                                {1066}event beginCli(Cli,Sess,Nc_1349);
                                                                {1067}out(c, (pkCli_1022,m1_1350));
                                                                {1068}in(c, em2_1351: bitstring);
                                                                {1069}let m2_1352: bitstring = em2_1351 in
                                                                {1070}let (=OpenSecureChannelResponse,=Cli,Ns_1353: bitstring,ST_1354: bitstring,TTL_1355: bitstring) = m2_1352 in
                                                                {1071}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                {1072}event endCli(Sess,Cli,Ns_1353)
                                                            )
                                                            else
                                                                {1073}let pkSess_1356: bitstring = pub(sk(Sess)) in
                                                                {1074}out(c, GetEndpointRequest);
                                                                {1075}in(c, (=GetEndpointResponse,=pkSess_1356,=None,SP_1357: bitstring,UP_1358: bitstring));
                                                                {1076}new Nc_1359: bitstring;
                                                                {1077}let m1_1360: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1022,Nc_1359) in
                                                                {1078}event beginCli(Cli,Sess,Nc_1359);
                                                                {1079}out(c, (pkCli_1022,m1_1360));
                                                                {1080}in(c, em2_1361: bitstring);
                                                                {1081}let m2_1362: bitstring = em2_1361 in
                                                                {1082}let (=OpenSecureChannelResponse,=Cli,Ns_1363: bitstring,ST_1364: bitstring,TTL_1365: bitstring) = m2_1362 in
                                                                {1083}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                {1084}event endCli(Sess,Cli,Ns_1363)
                                                        )
                                                        else
                                                            {1085}let pkSess_1366: bitstring = fail-any in
                                                            {1086}out(c, GetEndpointRequest);
                                                            {1087}in(c, (=GetEndpointResponse,=pkSess_1366,=None,SP_1367: bitstring,UP_1368: bitstring));
                                                            {1088}new Nc_1369: bitstring;
                                                            {1089}let m1_1370: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1022,Nc_1369) in
                                                            {1090}event beginCli(Cli,Sess,Nc_1369);
                                                            {1091}out(c, (pkCli_1022,m1_1370));
                                                            {1092}in(c, em2_1371: bitstring);
                                                            {1093}let m2_1372: bitstring = em2_1371 in
                                                            {1094}let (=OpenSecureChannelResponse,=Cli,Ns_1373: bitstring,ST_1374: bitstring,TTL_1375: bitstring) = m2_1372 in
                                                            {1095}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                            {1096}event endCli(Sess,Cli,Ns_1373)
                                                )
                                                else
                                                    {1097}let pkSess_1376: bitstring = fail-any in
                                                    {1098}out(c, GetEndpointRequest);
                                                    {1099}in(c, (=GetEndpointResponse,=pkSess_1376,=None,SP_1377: bitstring,UP_1378: bitstring));
                                                    {1100}new Nc_1379: bitstring;
                                                    {1101}let m1_1380: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1022,Nc_1379) in
                                                    {1102}event beginCli(Cli,Sess,Nc_1379);
                                                    {1103}out(c, (pkCli_1022,m1_1380));
                                                    {1104}in(c, em2_1381: bitstring);
                                                    {1105}let m2_1382: bitstring = em2_1381 in
                                                    {1106}let (=OpenSecureChannelResponse,=Cli,Ns_1383: bitstring,ST_1384: bitstring,TTL_1385: bitstring) = m2_1382 in
                                                    {1107}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {1108}event endCli(Sess,Cli,Ns_1383)
                                        )
                                        else
                                            {1109}let pkSess_1386: bitstring = fail-any in
                                            {1110}out(c, GetEndpointRequest);
                                            {1111}in(c, (=GetEndpointResponse,=pkSess_1386,=None,SP_1387: bitstring,UP_1388: bitstring));
                                            {1112}new Nc_1389: bitstring;
                                            {1113}let m1_1390: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1022,Nc_1389) in
                                            {1114}event beginCli(Cli,Sess,Nc_1389);
                                            {1115}out(c, (pkCli_1022,m1_1390));
                                            {1116}in(c, em2_1391: bitstring);
                                            {1117}let m2_1392: bitstring = em2_1391 in
                                            {1118}let (=OpenSecureChannelResponse,=Cli,Ns_1393: bitstring,ST_1394: bitstring,TTL_1395: bitstring) = m2_1392 in
                                            {1119}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {1120}event endCli(Sess,Cli,Ns_1393)
                            )
                            else
                                {1121}let pkDisco_1396: bitstring = fail-any in
                                {1122}let v_1397: bool = (Sess = A) in
                                (
                                    {1123}if v_1397 then
                                    (
                                        {1124}let pkSess_1398: bitstring = pub(skA) in
                                        {1125}out(c, GetEndpointRequest);
                                        {1126}in(c, (=GetEndpointResponse,=pkSess_1398,=None,SP_1399: bitstring,UP_1400: bitstring));
                                        {1127}new Nc_1401: bitstring;
                                        {1128}let m1_1402: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1022,Nc_1401) in
                                        {1129}event beginCli(Cli,Sess,Nc_1401);
                                        {1130}out(c, (pkCli_1022,m1_1402));
                                        {1131}in(c, em2_1403: bitstring);
                                        {1132}let m2_1404: bitstring = em2_1403 in
                                        {1133}let (=OpenSecureChannelResponse,=Cli,Ns_1405: bitstring,ST_1406: bitstring,TTL_1407: bitstring) = m2_1404 in
                                        {1134}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                        {1135}event endCli(Sess,Cli,Ns_1405)
                                    )
                                    else
                                        {1136}let v_1408: bool = (Sess = B) in
                                        (
                                            {1137}if v_1408 then
                                            (
                                                {1138}let pkSess_1409: bitstring = pub(skB) in
                                                {1139}out(c, GetEndpointRequest);
                                                {1140}in(c, (=GetEndpointResponse,=pkSess_1409,=None,SP_1410: bitstring,UP_1411: bitstring));
                                                {1141}new Nc_1412: bitstring;
                                                {1142}let m1_1413: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1022,Nc_1412) in
                                                {1143}event beginCli(Cli,Sess,Nc_1412);
                                                {1144}out(c, (pkCli_1022,m1_1413));
                                                {1145}in(c, em2_1414: bitstring);
                                                {1146}let m2_1415: bitstring = em2_1414 in
                                                {1147}let (=OpenSecureChannelResponse,=Cli,Ns_1416: bitstring,ST_1417: bitstring,TTL_1418: bitstring) = m2_1415 in
                                                {1148}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {1149}event endCli(Sess,Cli,Ns_1416)
                                            )
                                            else
                                                {1150}let v_1419: bool = (Sess = C) in
                                                (
                                                    {1151}if v_1419 then
                                                    (
                                                        {1152}let pkSess_1420: bitstring = pub(skC) in
                                                        {1153}out(c, GetEndpointRequest);
                                                        {1154}in(c, (=GetEndpointResponse,=pkSess_1420,=None,SP_1421: bitstring,UP_1422: bitstring));
                                                        {1155}new Nc_1423: bitstring;
                                                        {1156}let m1_1424: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1022,Nc_1423) in
                                                        {1157}event beginCli(Cli,Sess,Nc_1423);
                                                        {1158}out(c, (pkCli_1022,m1_1424));
                                                        {1159}in(c, em2_1425: bitstring);
                                                        {1160}let m2_1426: bitstring = em2_1425 in
                                                        {1161}let (=OpenSecureChannelResponse,=Cli,Ns_1427: bitstring,ST_1428: bitstring,TTL_1429: bitstring) = m2_1426 in
                                                        {1162}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {1163}event endCli(Sess,Cli,Ns_1427)
                                                    )
                                                    else
                                                        {1164}let pkSess_1430: bitstring = pub(sk(Sess)) in
                                                        {1165}out(c, GetEndpointRequest);
                                                        {1166}in(c, (=GetEndpointResponse,=pkSess_1430,=None,SP_1431: bitstring,UP_1432: bitstring));
                                                        {1167}new Nc_1433: bitstring;
                                                        {1168}let m1_1434: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1022,Nc_1433) in
                                                        {1169}event beginCli(Cli,Sess,Nc_1433);
                                                        {1170}out(c, (pkCli_1022,m1_1434));
                                                        {1171}in(c, em2_1435: bitstring);
                                                        {1172}let m2_1436: bitstring = em2_1435 in
                                                        {1173}let (=OpenSecureChannelResponse,=Cli,Ns_1437: bitstring,ST_1438: bitstring,TTL_1439: bitstring) = m2_1436 in
                                                        {1174}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {1175}event endCli(Sess,Cli,Ns_1437)
                                                )
                                                else
                                                    {1176}let pkSess_1440: bitstring = fail-any in
                                                    {1177}out(c, GetEndpointRequest);
                                                    {1178}in(c, (=GetEndpointResponse,=pkSess_1440,=None,SP_1441: bitstring,UP_1442: bitstring));
                                                    {1179}new Nc_1443: bitstring;
                                                    {1180}let m1_1444: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1022,Nc_1443) in
                                                    {1181}event beginCli(Cli,Sess,Nc_1443);
                                                    {1182}out(c, (pkCli_1022,m1_1444));
                                                    {1183}in(c, em2_1445: bitstring);
                                                    {1184}let m2_1446: bitstring = em2_1445 in
                                                    {1185}let (=OpenSecureChannelResponse,=Cli,Ns_1447: bitstring,ST_1448: bitstring,TTL_1449: bitstring) = m2_1446 in
                                                    {1186}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {1187}event endCli(Sess,Cli,Ns_1447)
                                        )
                                        else
                                            {1188}let pkSess_1450: bitstring = fail-any in
                                            {1189}out(c, GetEndpointRequest);
                                            {1190}in(c, (=GetEndpointResponse,=pkSess_1450,=None,SP_1451: bitstring,UP_1452: bitstring));
                                            {1191}new Nc_1453: bitstring;
                                            {1192}let m1_1454: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1022,Nc_1453) in
                                            {1193}event beginCli(Cli,Sess,Nc_1453);
                                            {1194}out(c, (pkCli_1022,m1_1454));
                                            {1195}in(c, em2_1455: bitstring);
                                            {1196}let m2_1456: bitstring = em2_1455 in
                                            {1197}let (=OpenSecureChannelResponse,=Cli,Ns_1457: bitstring,ST_1458: bitstring,TTL_1459: bitstring) = m2_1456 in
                                            {1198}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {1199}event endCli(Sess,Cli,Ns_1457)
                                )
                                else
                                    {1200}let pkSess_1460: bitstring = fail-any in
                                    {1201}out(c, GetEndpointRequest);
                                    {1202}in(c, (=GetEndpointResponse,=pkSess_1460,=None,SP_1461: bitstring,UP_1462: bitstring));
                                    {1203}new Nc_1463: bitstring;
                                    {1204}let m1_1464: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1022,Nc_1463) in
                                    {1205}event beginCli(Cli,Sess,Nc_1463);
                                    {1206}out(c, (pkCli_1022,m1_1464));
                                    {1207}in(c, em2_1465: bitstring);
                                    {1208}let m2_1466: bitstring = em2_1465 in
                                    {1209}let (=OpenSecureChannelResponse,=Cli,Ns_1467: bitstring,ST_1468: bitstring,TTL_1469: bitstring) = m2_1466 in
                                    {1210}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                    {1211}event endCli(Sess,Cli,Ns_1467)
                    )
                    else
                        {1212}let pkDisco_1470: bitstring = fail-any in
                        {1213}let v_1471: bool = (Sess = A) in
                        (
                            {1214}if v_1471 then
                            (
                                {1215}let pkSess_1472: bitstring = pub(skA) in
                                {1216}out(c, GetEndpointRequest);
                                {1217}in(c, (=GetEndpointResponse,=pkSess_1472,=None,SP_1473: bitstring,UP_1474: bitstring));
                                {1218}new Nc_1475: bitstring;
                                {1219}let m1_1476: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1022,Nc_1475) in
                                {1220}event beginCli(Cli,Sess,Nc_1475);
                                {1221}out(c, (pkCli_1022,m1_1476));
                                {1222}in(c, em2_1477: bitstring);
                                {1223}let m2_1478: bitstring = em2_1477 in
                                {1224}let (=OpenSecureChannelResponse,=Cli,Ns_1479: bitstring,ST_1480: bitstring,TTL_1481: bitstring) = m2_1478 in
                                {1225}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                {1226}event endCli(Sess,Cli,Ns_1479)
                            )
                            else
                                {1227}let v_1482: bool = (Sess = B) in
                                (
                                    {1228}if v_1482 then
                                    (
                                        {1229}let pkSess_1483: bitstring = pub(skB) in
                                        {1230}out(c, GetEndpointRequest);
                                        {1231}in(c, (=GetEndpointResponse,=pkSess_1483,=None,SP_1484: bitstring,UP_1485: bitstring));
                                        {1232}new Nc_1486: bitstring;
                                        {1233}let m1_1487: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1022,Nc_1486) in
                                        {1234}event beginCli(Cli,Sess,Nc_1486);
                                        {1235}out(c, (pkCli_1022,m1_1487));
                                        {1236}in(c, em2_1488: bitstring);
                                        {1237}let m2_1489: bitstring = em2_1488 in
                                        {1238}let (=OpenSecureChannelResponse,=Cli,Ns_1490: bitstring,ST_1491: bitstring,TTL_1492: bitstring) = m2_1489 in
                                        {1239}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                        {1240}event endCli(Sess,Cli,Ns_1490)
                                    )
                                    else
                                        {1241}let v_1493: bool = (Sess = C) in
                                        (
                                            {1242}if v_1493 then
                                            (
                                                {1243}let pkSess_1494: bitstring = pub(skC) in
                                                {1244}out(c, GetEndpointRequest);
                                                {1245}in(c, (=GetEndpointResponse,=pkSess_1494,=None,SP_1495: bitstring,UP_1496: bitstring));
                                                {1246}new Nc_1497: bitstring;
                                                {1247}let m1_1498: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1022,Nc_1497) in
                                                {1248}event beginCli(Cli,Sess,Nc_1497);
                                                {1249}out(c, (pkCli_1022,m1_1498));
                                                {1250}in(c, em2_1499: bitstring);
                                                {1251}let m2_1500: bitstring = em2_1499 in
                                                {1252}let (=OpenSecureChannelResponse,=Cli,Ns_1501: bitstring,ST_1502: bitstring,TTL_1503: bitstring) = m2_1500 in
                                                {1253}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {1254}event endCli(Sess,Cli,Ns_1501)
                                            )
                                            else
                                                {1255}let pkSess_1504: bitstring = pub(sk(Sess)) in
                                                {1256}out(c, GetEndpointRequest);
                                                {1257}in(c, (=GetEndpointResponse,=pkSess_1504,=None,SP_1505: bitstring,UP_1506: bitstring));
                                                {1258}new Nc_1507: bitstring;
                                                {1259}let m1_1508: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1022,Nc_1507) in
                                                {1260}event beginCli(Cli,Sess,Nc_1507);
                                                {1261}out(c, (pkCli_1022,m1_1508));
                                                {1262}in(c, em2_1509: bitstring);
                                                {1263}let m2_1510: bitstring = em2_1509 in
                                                {1264}let (=OpenSecureChannelResponse,=Cli,Ns_1511: bitstring,ST_1512: bitstring,TTL_1513: bitstring) = m2_1510 in
                                                {1265}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {1266}event endCli(Sess,Cli,Ns_1511)
                                        )
                                        else
                                            {1267}let pkSess_1514: bitstring = fail-any in
                                            {1268}out(c, GetEndpointRequest);
                                            {1269}in(c, (=GetEndpointResponse,=pkSess_1514,=None,SP_1515: bitstring,UP_1516: bitstring));
                                            {1270}new Nc_1517: bitstring;
                                            {1271}let m1_1518: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1022,Nc_1517) in
                                            {1272}event beginCli(Cli,Sess,Nc_1517);
                                            {1273}out(c, (pkCli_1022,m1_1518));
                                            {1274}in(c, em2_1519: bitstring);
                                            {1275}let m2_1520: bitstring = em2_1519 in
                                            {1276}let (=OpenSecureChannelResponse,=Cli,Ns_1521: bitstring,ST_1522: bitstring,TTL_1523: bitstring) = m2_1520 in
                                            {1277}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {1278}event endCli(Sess,Cli,Ns_1521)
                                )
                                else
                                    {1279}let pkSess_1524: bitstring = fail-any in
                                    {1280}out(c, GetEndpointRequest);
                                    {1281}in(c, (=GetEndpointResponse,=pkSess_1524,=None,SP_1525: bitstring,UP_1526: bitstring));
                                    {1282}new Nc_1527: bitstring;
                                    {1283}let m1_1528: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1022,Nc_1527) in
                                    {1284}event beginCli(Cli,Sess,Nc_1527);
                                    {1285}out(c, (pkCli_1022,m1_1528));
                                    {1286}in(c, em2_1529: bitstring);
                                    {1287}let m2_1530: bitstring = em2_1529 in
                                    {1288}let (=OpenSecureChannelResponse,=Cli,Ns_1531: bitstring,ST_1532: bitstring,TTL_1533: bitstring) = m2_1530 in
                                    {1289}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                    {1290}event endCli(Sess,Cli,Ns_1531)
                        )
                        else
                            {1291}let pkSess_1534: bitstring = fail-any in
                            {1292}out(c, GetEndpointRequest);
                            {1293}in(c, (=GetEndpointResponse,=pkSess_1534,=None,SP_1535: bitstring,UP_1536: bitstring));
                            {1294}new Nc_1537: bitstring;
                            {1295}let m1_1538: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1022,Nc_1537) in
                            {1296}event beginCli(Cli,Sess,Nc_1537);
                            {1297}out(c, (pkCli_1022,m1_1538));
                            {1298}in(c, em2_1539: bitstring);
                            {1299}let m2_1540: bitstring = em2_1539 in
                            {1300}let (=OpenSecureChannelResponse,=Cli,Ns_1541: bitstring,ST_1542: bitstring,TTL_1543: bitstring) = m2_1540 in
                            {1301}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                            {1302}event endCli(Sess,Cli,Ns_1541)
                )
                else
                    {1303}let =true = (Cli = C) in
                    (
                        {1304}let skCli_1544: bitstring = skC in
                        {1305}let pkCli_1545: bitstring = pub(skCli_1544) in
                        {1306}let v_1546: bool = (Disco = A) in
                        (
                            {1307}if v_1546 then
                            (
                                {1308}let pkDisco_1547: bitstring = pub(skA) in
                                {1309}let v_1548: bool = (Sess = A) in
                                (
                                    {1310}if v_1548 then
                                    (
                                        {1311}let pkSess_1549: bitstring = pub(skA) in
                                        {1312}out(c, GetEndpointRequest);
                                        {1313}in(c, (=GetEndpointResponse,=pkSess_1549,=None,SP_1550: bitstring,UP_1551: bitstring));
                                        {1314}new Nc_1552: bitstring;
                                        {1315}let m1_1553: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1545,Nc_1552) in
                                        {1316}event beginCli(Cli,Sess,Nc_1552);
                                        {1317}out(c, (pkCli_1545,m1_1553));
                                        {1318}in(c, em2_1554: bitstring);
                                        {1319}let m2_1555: bitstring = em2_1554 in
                                        {1320}let (=OpenSecureChannelResponse,=Cli,Ns_1556: bitstring,ST_1557: bitstring,TTL_1558: bitstring) = m2_1555 in
                                        {1321}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                        {1322}event endCli(Sess,Cli,Ns_1556)
                                    )
                                    else
                                        {1323}let v_1559: bool = (Sess = B) in
                                        (
                                            {1324}if v_1559 then
                                            (
                                                {1325}let pkSess_1560: bitstring = pub(skB) in
                                                {1326}out(c, GetEndpointRequest);
                                                {1327}in(c, (=GetEndpointResponse,=pkSess_1560,=None,SP_1561: bitstring,UP_1562: bitstring));
                                                {1328}new Nc_1563: bitstring;
                                                {1329}let m1_1564: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1545,Nc_1563) in
                                                {1330}event beginCli(Cli,Sess,Nc_1563);
                                                {1331}out(c, (pkCli_1545,m1_1564));
                                                {1332}in(c, em2_1565: bitstring);
                                                {1333}let m2_1566: bitstring = em2_1565 in
                                                {1334}let (=OpenSecureChannelResponse,=Cli,Ns_1567: bitstring,ST_1568: bitstring,TTL_1569: bitstring) = m2_1566 in
                                                {1335}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {1336}event endCli(Sess,Cli,Ns_1567)
                                            )
                                            else
                                                {1337}let v_1570: bool = (Sess = C) in
                                                (
                                                    {1338}if v_1570 then
                                                    (
                                                        {1339}let pkSess_1571: bitstring = pub(skC) in
                                                        {1340}out(c, GetEndpointRequest);
                                                        {1341}in(c, (=GetEndpointResponse,=pkSess_1571,=None,SP_1572: bitstring,UP_1573: bitstring));
                                                        {1342}new Nc_1574: bitstring;
                                                        {1343}let m1_1575: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1545,Nc_1574) in
                                                        {1344}event beginCli(Cli,Sess,Nc_1574);
                                                        {1345}out(c, (pkCli_1545,m1_1575));
                                                        {1346}in(c, em2_1576: bitstring);
                                                        {1347}let m2_1577: bitstring = em2_1576 in
                                                        {1348}let (=OpenSecureChannelResponse,=Cli,Ns_1578: bitstring,ST_1579: bitstring,TTL_1580: bitstring) = m2_1577 in
                                                        {1349}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {1350}event endCli(Sess,Cli,Ns_1578)
                                                    )
                                                    else
                                                        {1351}let pkSess_1581: bitstring = pub(sk(Sess)) in
                                                        {1352}out(c, GetEndpointRequest);
                                                        {1353}in(c, (=GetEndpointResponse,=pkSess_1581,=None,SP_1582: bitstring,UP_1583: bitstring));
                                                        {1354}new Nc_1584: bitstring;
                                                        {1355}let m1_1585: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1545,Nc_1584) in
                                                        {1356}event beginCli(Cli,Sess,Nc_1584);
                                                        {1357}out(c, (pkCli_1545,m1_1585));
                                                        {1358}in(c, em2_1586: bitstring);
                                                        {1359}let m2_1587: bitstring = em2_1586 in
                                                        {1360}let (=OpenSecureChannelResponse,=Cli,Ns_1588: bitstring,ST_1589: bitstring,TTL_1590: bitstring) = m2_1587 in
                                                        {1361}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {1362}event endCli(Sess,Cli,Ns_1588)
                                                )
                                                else
                                                    {1363}let pkSess_1591: bitstring = fail-any in
                                                    {1364}out(c, GetEndpointRequest);
                                                    {1365}in(c, (=GetEndpointResponse,=pkSess_1591,=None,SP_1592: bitstring,UP_1593: bitstring));
                                                    {1366}new Nc_1594: bitstring;
                                                    {1367}let m1_1595: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1545,Nc_1594) in
                                                    {1368}event beginCli(Cli,Sess,Nc_1594);
                                                    {1369}out(c, (pkCli_1545,m1_1595));
                                                    {1370}in(c, em2_1596: bitstring);
                                                    {1371}let m2_1597: bitstring = em2_1596 in
                                                    {1372}let (=OpenSecureChannelResponse,=Cli,Ns_1598: bitstring,ST_1599: bitstring,TTL_1600: bitstring) = m2_1597 in
                                                    {1373}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {1374}event endCli(Sess,Cli,Ns_1598)
                                        )
                                        else
                                            {1375}let pkSess_1601: bitstring = fail-any in
                                            {1376}out(c, GetEndpointRequest);
                                            {1377}in(c, (=GetEndpointResponse,=pkSess_1601,=None,SP_1602: bitstring,UP_1603: bitstring));
                                            {1378}new Nc_1604: bitstring;
                                            {1379}let m1_1605: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1545,Nc_1604) in
                                            {1380}event beginCli(Cli,Sess,Nc_1604);
                                            {1381}out(c, (pkCli_1545,m1_1605));
                                            {1382}in(c, em2_1606: bitstring);
                                            {1383}let m2_1607: bitstring = em2_1606 in
                                            {1384}let (=OpenSecureChannelResponse,=Cli,Ns_1608: bitstring,ST_1609: bitstring,TTL_1610: bitstring) = m2_1607 in
                                            {1385}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {1386}event endCli(Sess,Cli,Ns_1608)
                                )
                                else
                                    {1387}let pkSess_1611: bitstring = fail-any in
                                    {1388}out(c, GetEndpointRequest);
                                    {1389}in(c, (=GetEndpointResponse,=pkSess_1611,=None,SP_1612: bitstring,UP_1613: bitstring));
                                    {1390}new Nc_1614: bitstring;
                                    {1391}let m1_1615: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1545,Nc_1614) in
                                    {1392}event beginCli(Cli,Sess,Nc_1614);
                                    {1393}out(c, (pkCli_1545,m1_1615));
                                    {1394}in(c, em2_1616: bitstring);
                                    {1395}let m2_1617: bitstring = em2_1616 in
                                    {1396}let (=OpenSecureChannelResponse,=Cli,Ns_1618: bitstring,ST_1619: bitstring,TTL_1620: bitstring) = m2_1617 in
                                    {1397}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                    {1398}event endCli(Sess,Cli,Ns_1618)
                            )
                            else
                                {1399}let v_1621: bool = (Disco = B) in
                                (
                                    {1400}if v_1621 then
                                    (
                                        {1401}let pkDisco_1622: bitstring = pub(skB) in
                                        {1402}let v_1623: bool = (Sess = A) in
                                        (
                                            {1403}if v_1623 then
                                            (
                                                {1404}let pkSess_1624: bitstring = pub(skA) in
                                                {1405}out(c, GetEndpointRequest);
                                                {1406}in(c, (=GetEndpointResponse,=pkSess_1624,=None,SP_1625: bitstring,UP_1626: bitstring));
                                                {1407}new Nc_1627: bitstring;
                                                {1408}let m1_1628: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1545,Nc_1627) in
                                                {1409}event beginCli(Cli,Sess,Nc_1627);
                                                {1410}out(c, (pkCli_1545,m1_1628));
                                                {1411}in(c, em2_1629: bitstring);
                                                {1412}let m2_1630: bitstring = em2_1629 in
                                                {1413}let (=OpenSecureChannelResponse,=Cli,Ns_1631: bitstring,ST_1632: bitstring,TTL_1633: bitstring) = m2_1630 in
                                                {1414}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {1415}event endCli(Sess,Cli,Ns_1631)
                                            )
                                            else
                                                {1416}let v_1634: bool = (Sess = B) in
                                                (
                                                    {1417}if v_1634 then
                                                    (
                                                        {1418}let pkSess_1635: bitstring = pub(skB) in
                                                        {1419}out(c, GetEndpointRequest);
                                                        {1420}in(c, (=GetEndpointResponse,=pkSess_1635,=None,SP_1636: bitstring,UP_1637: bitstring));
                                                        {1421}new Nc_1638: bitstring;
                                                        {1422}let m1_1639: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1545,Nc_1638) in
                                                        {1423}event beginCli(Cli,Sess,Nc_1638);
                                                        {1424}out(c, (pkCli_1545,m1_1639));
                                                        {1425}in(c, em2_1640: bitstring);
                                                        {1426}let m2_1641: bitstring = em2_1640 in
                                                        {1427}let (=OpenSecureChannelResponse,=Cli,Ns_1642: bitstring,ST_1643: bitstring,TTL_1644: bitstring) = m2_1641 in
                                                        {1428}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {1429}event endCli(Sess,Cli,Ns_1642)
                                                    )
                                                    else
                                                        {1430}let v_1645: bool = (Sess = C) in
                                                        (
                                                            {1431}if v_1645 then
                                                            (
                                                                {1432}let pkSess_1646: bitstring = pub(skC) in
                                                                {1433}out(c, GetEndpointRequest);
                                                                {1434}in(c, (=GetEndpointResponse,=pkSess_1646,=None,SP_1647: bitstring,UP_1648: bitstring));
                                                                {1435}new Nc_1649: bitstring;
                                                                {1436}let m1_1650: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1545,Nc_1649) in
                                                                {1437}event beginCli(Cli,Sess,Nc_1649);
                                                                {1438}out(c, (pkCli_1545,m1_1650));
                                                                {1439}in(c, em2_1651: bitstring);
                                                                {1440}let m2_1652: bitstring = em2_1651 in
                                                                {1441}let (=OpenSecureChannelResponse,=Cli,Ns_1653: bitstring,ST_1654: bitstring,TTL_1655: bitstring) = m2_1652 in
                                                                {1442}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                {1443}event endCli(Sess,Cli,Ns_1653)
                                                            )
                                                            else
                                                                {1444}let pkSess_1656: bitstring = pub(sk(Sess)) in
                                                                {1445}out(c, GetEndpointRequest);
                                                                {1446}in(c, (=GetEndpointResponse,=pkSess_1656,=None,SP_1657: bitstring,UP_1658: bitstring));
                                                                {1447}new Nc_1659: bitstring;
                                                                {1448}let m1_1660: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1545,Nc_1659) in
                                                                {1449}event beginCli(Cli,Sess,Nc_1659);
                                                                {1450}out(c, (pkCli_1545,m1_1660));
                                                                {1451}in(c, em2_1661: bitstring);
                                                                {1452}let m2_1662: bitstring = em2_1661 in
                                                                {1453}let (=OpenSecureChannelResponse,=Cli,Ns_1663: bitstring,ST_1664: bitstring,TTL_1665: bitstring) = m2_1662 in
                                                                {1454}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                {1455}event endCli(Sess,Cli,Ns_1663)
                                                        )
                                                        else
                                                            {1456}let pkSess_1666: bitstring = fail-any in
                                                            {1457}out(c, GetEndpointRequest);
                                                            {1458}in(c, (=GetEndpointResponse,=pkSess_1666,=None,SP_1667: bitstring,UP_1668: bitstring));
                                                            {1459}new Nc_1669: bitstring;
                                                            {1460}let m1_1670: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1545,Nc_1669) in
                                                            {1461}event beginCli(Cli,Sess,Nc_1669);
                                                            {1462}out(c, (pkCli_1545,m1_1670));
                                                            {1463}in(c, em2_1671: bitstring);
                                                            {1464}let m2_1672: bitstring = em2_1671 in
                                                            {1465}let (=OpenSecureChannelResponse,=Cli,Ns_1673: bitstring,ST_1674: bitstring,TTL_1675: bitstring) = m2_1672 in
                                                            {1466}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                            {1467}event endCli(Sess,Cli,Ns_1673)
                                                )
                                                else
                                                    {1468}let pkSess_1676: bitstring = fail-any in
                                                    {1469}out(c, GetEndpointRequest);
                                                    {1470}in(c, (=GetEndpointResponse,=pkSess_1676,=None,SP_1677: bitstring,UP_1678: bitstring));
                                                    {1471}new Nc_1679: bitstring;
                                                    {1472}let m1_1680: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1545,Nc_1679) in
                                                    {1473}event beginCli(Cli,Sess,Nc_1679);
                                                    {1474}out(c, (pkCli_1545,m1_1680));
                                                    {1475}in(c, em2_1681: bitstring);
                                                    {1476}let m2_1682: bitstring = em2_1681 in
                                                    {1477}let (=OpenSecureChannelResponse,=Cli,Ns_1683: bitstring,ST_1684: bitstring,TTL_1685: bitstring) = m2_1682 in
                                                    {1478}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {1479}event endCli(Sess,Cli,Ns_1683)
                                        )
                                        else
                                            {1480}let pkSess_1686: bitstring = fail-any in
                                            {1481}out(c, GetEndpointRequest);
                                            {1482}in(c, (=GetEndpointResponse,=pkSess_1686,=None,SP_1687: bitstring,UP_1688: bitstring));
                                            {1483}new Nc_1689: bitstring;
                                            {1484}let m1_1690: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1545,Nc_1689) in
                                            {1485}event beginCli(Cli,Sess,Nc_1689);
                                            {1486}out(c, (pkCli_1545,m1_1690));
                                            {1487}in(c, em2_1691: bitstring);
                                            {1488}let m2_1692: bitstring = em2_1691 in
                                            {1489}let (=OpenSecureChannelResponse,=Cli,Ns_1693: bitstring,ST_1694: bitstring,TTL_1695: bitstring) = m2_1692 in
                                            {1490}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {1491}event endCli(Sess,Cli,Ns_1693)
                                    )
                                    else
                                        {1492}let v_1696: bool = (Disco = C) in
                                        (
                                            {1493}if v_1696 then
                                            (
                                                {1494}let pkDisco_1697: bitstring = pub(skC) in
                                                {1495}let v_1698: bool = (Sess = A) in
                                                (
                                                    {1496}if v_1698 then
                                                    (
                                                        {1497}let pkSess_1699: bitstring = pub(skA) in
                                                        {1498}out(c, GetEndpointRequest);
                                                        {1499}in(c, (=GetEndpointResponse,=pkSess_1699,=None,SP_1700: bitstring,UP_1701: bitstring));
                                                        {1500}new Nc_1702: bitstring;
                                                        {1501}let m1_1703: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1545,Nc_1702) in
                                                        {1502}event beginCli(Cli,Sess,Nc_1702);
                                                        {1503}out(c, (pkCli_1545,m1_1703));
                                                        {1504}in(c, em2_1704: bitstring);
                                                        {1505}let m2_1705: bitstring = em2_1704 in
                                                        {1506}let (=OpenSecureChannelResponse,=Cli,Ns_1706: bitstring,ST_1707: bitstring,TTL_1708: bitstring) = m2_1705 in
                                                        {1507}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {1508}event endCli(Sess,Cli,Ns_1706)
                                                    )
                                                    else
                                                        {1509}let v_1709: bool = (Sess = B) in
                                                        (
                                                            {1510}if v_1709 then
                                                            (
                                                                {1511}let pkSess_1710: bitstring = pub(skB) in
                                                                {1512}out(c, GetEndpointRequest);
                                                                {1513}in(c, (=GetEndpointResponse,=pkSess_1710,=None,SP_1711: bitstring,UP_1712: bitstring));
                                                                {1514}new Nc_1713: bitstring;
                                                                {1515}let m1_1714: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1545,Nc_1713) in
                                                                {1516}event beginCli(Cli,Sess,Nc_1713);
                                                                {1517}out(c, (pkCli_1545,m1_1714));
                                                                {1518}in(c, em2_1715: bitstring);
                                                                {1519}let m2_1716: bitstring = em2_1715 in
                                                                {1520}let (=OpenSecureChannelResponse,=Cli,Ns_1717: bitstring,ST_1718: bitstring,TTL_1719: bitstring) = m2_1716 in
                                                                {1521}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                {1522}event endCli(Sess,Cli,Ns_1717)
                                                            )
                                                            else
                                                                {1523}let v_1720: bool = (Sess = C) in
                                                                (
                                                                    {1524}if v_1720 then
                                                                    (
                                                                        {1525}let pkSess_1721: bitstring = pub(skC) in
                                                                        {1526}out(c, GetEndpointRequest);
                                                                        {1527}in(c, (=GetEndpointResponse,=pkSess_1721,=None,SP_1722: bitstring,UP_1723: bitstring));
                                                                        {1528}new Nc_1724: bitstring;
                                                                        {1529}let m1_1725: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1545,Nc_1724) in
                                                                        {1530}event beginCli(Cli,Sess,Nc_1724);
                                                                        {1531}out(c, (pkCli_1545,m1_1725));
                                                                        {1532}in(c, em2_1726: bitstring);
                                                                        {1533}let m2_1727: bitstring = em2_1726 in
                                                                        {1534}let (=OpenSecureChannelResponse,=Cli,Ns_1728: bitstring,ST_1729: bitstring,TTL_1730: bitstring) = m2_1727 in
                                                                        {1535}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                        {1536}event endCli(Sess,Cli,Ns_1728)
                                                                    )
                                                                    else
                                                                        {1537}let pkSess_1731: bitstring = pub(sk(Sess)) in
                                                                        {1538}out(c, GetEndpointRequest);
                                                                        {1539}in(c, (=GetEndpointResponse,=pkSess_1731,=None,SP_1732: bitstring,UP_1733: bitstring));
                                                                        {1540}new Nc_1734: bitstring;
                                                                        {1541}let m1_1735: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1545,Nc_1734) in
                                                                        {1542}event beginCli(Cli,Sess,Nc_1734);
                                                                        {1543}out(c, (pkCli_1545,m1_1735));
                                                                        {1544}in(c, em2_1736: bitstring);
                                                                        {1545}let m2_1737: bitstring = em2_1736 in
                                                                        {1546}let (=OpenSecureChannelResponse,=Cli,Ns_1738: bitstring,ST_1739: bitstring,TTL_1740: bitstring) = m2_1737 in
                                                                        {1547}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                        {1548}event endCli(Sess,Cli,Ns_1738)
                                                                )
                                                                else
                                                                    {1549}let pkSess_1741: bitstring = fail-any in
                                                                    {1550}out(c, GetEndpointRequest);
                                                                    {1551}in(c, (=GetEndpointResponse,=pkSess_1741,=None,SP_1742: bitstring,UP_1743: bitstring));
                                                                    {1552}new Nc_1744: bitstring;
                                                                    {1553}let m1_1745: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1545,Nc_1744) in
                                                                    {1554}event beginCli(Cli,Sess,Nc_1744);
                                                                    {1555}out(c, (pkCli_1545,m1_1745));
                                                                    {1556}in(c, em2_1746: bitstring);
                                                                    {1557}let m2_1747: bitstring = em2_1746 in
                                                                    {1558}let (=OpenSecureChannelResponse,=Cli,Ns_1748: bitstring,ST_1749: bitstring,TTL_1750: bitstring) = m2_1747 in
                                                                    {1559}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                    {1560}event endCli(Sess,Cli,Ns_1748)
                                                        )
                                                        else
                                                            {1561}let pkSess_1751: bitstring = fail-any in
                                                            {1562}out(c, GetEndpointRequest);
                                                            {1563}in(c, (=GetEndpointResponse,=pkSess_1751,=None,SP_1752: bitstring,UP_1753: bitstring));
                                                            {1564}new Nc_1754: bitstring;
                                                            {1565}let m1_1755: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1545,Nc_1754) in
                                                            {1566}event beginCli(Cli,Sess,Nc_1754);
                                                            {1567}out(c, (pkCli_1545,m1_1755));
                                                            {1568}in(c, em2_1756: bitstring);
                                                            {1569}let m2_1757: bitstring = em2_1756 in
                                                            {1570}let (=OpenSecureChannelResponse,=Cli,Ns_1758: bitstring,ST_1759: bitstring,TTL_1760: bitstring) = m2_1757 in
                                                            {1571}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                            {1572}event endCli(Sess,Cli,Ns_1758)
                                                )
                                                else
                                                    {1573}let pkSess_1761: bitstring = fail-any in
                                                    {1574}out(c, GetEndpointRequest);
                                                    {1575}in(c, (=GetEndpointResponse,=pkSess_1761,=None,SP_1762: bitstring,UP_1763: bitstring));
                                                    {1576}new Nc_1764: bitstring;
                                                    {1577}let m1_1765: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1545,Nc_1764) in
                                                    {1578}event beginCli(Cli,Sess,Nc_1764);
                                                    {1579}out(c, (pkCli_1545,m1_1765));
                                                    {1580}in(c, em2_1766: bitstring);
                                                    {1581}let m2_1767: bitstring = em2_1766 in
                                                    {1582}let (=OpenSecureChannelResponse,=Cli,Ns_1768: bitstring,ST_1769: bitstring,TTL_1770: bitstring) = m2_1767 in
                                                    {1583}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {1584}event endCli(Sess,Cli,Ns_1768)
                                            )
                                            else
                                                {1585}let pkDisco_1771: bitstring = pub(sk(Disco)) in
                                                {1586}let v_1772: bool = (Sess = A) in
                                                (
                                                    {1587}if v_1772 then
                                                    (
                                                        {1588}let pkSess_1773: bitstring = pub(skA) in
                                                        {1589}out(c, GetEndpointRequest);
                                                        {1590}in(c, (=GetEndpointResponse,=pkSess_1773,=None,SP_1774: bitstring,UP_1775: bitstring));
                                                        {1591}new Nc_1776: bitstring;
                                                        {1592}let m1_1777: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1545,Nc_1776) in
                                                        {1593}event beginCli(Cli,Sess,Nc_1776);
                                                        {1594}out(c, (pkCli_1545,m1_1777));
                                                        {1595}in(c, em2_1778: bitstring);
                                                        {1596}let m2_1779: bitstring = em2_1778 in
                                                        {1597}let (=OpenSecureChannelResponse,=Cli,Ns_1780: bitstring,ST_1781: bitstring,TTL_1782: bitstring) = m2_1779 in
                                                        {1598}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {1599}event endCli(Sess,Cli,Ns_1780)
                                                    )
                                                    else
                                                        {1600}let v_1783: bool = (Sess = B) in
                                                        (
                                                            {1601}if v_1783 then
                                                            (
                                                                {1602}let pkSess_1784: bitstring = pub(skB) in
                                                                {1603}out(c, GetEndpointRequest);
                                                                {1604}in(c, (=GetEndpointResponse,=pkSess_1784,=None,SP_1785: bitstring,UP_1786: bitstring));
                                                                {1605}new Nc_1787: bitstring;
                                                                {1606}let m1_1788: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1545,Nc_1787) in
                                                                {1607}event beginCli(Cli,Sess,Nc_1787);
                                                                {1608}out(c, (pkCli_1545,m1_1788));
                                                                {1609}in(c, em2_1789: bitstring);
                                                                {1610}let m2_1790: bitstring = em2_1789 in
                                                                {1611}let (=OpenSecureChannelResponse,=Cli,Ns_1791: bitstring,ST_1792: bitstring,TTL_1793: bitstring) = m2_1790 in
                                                                {1612}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                {1613}event endCli(Sess,Cli,Ns_1791)
                                                            )
                                                            else
                                                                {1614}let v_1794: bool = (Sess = C) in
                                                                (
                                                                    {1615}if v_1794 then
                                                                    (
                                                                        {1616}let pkSess_1795: bitstring = pub(skC) in
                                                                        {1617}out(c, GetEndpointRequest);
                                                                        {1618}in(c, (=GetEndpointResponse,=pkSess_1795,=None,SP_1796: bitstring,UP_1797: bitstring));
                                                                        {1619}new Nc_1798: bitstring;
                                                                        {1620}let m1_1799: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1545,Nc_1798) in
                                                                        {1621}event beginCli(Cli,Sess,Nc_1798);
                                                                        {1622}out(c, (pkCli_1545,m1_1799));
                                                                        {1623}in(c, em2_1800: bitstring);
                                                                        {1624}let m2_1801: bitstring = em2_1800 in
                                                                        {1625}let (=OpenSecureChannelResponse,=Cli,Ns_1802: bitstring,ST_1803: bitstring,TTL_1804: bitstring) = m2_1801 in
                                                                        {1626}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                        {1627}event endCli(Sess,Cli,Ns_1802)
                                                                    )
                                                                    else
                                                                        {1628}let pkSess_1805: bitstring = pub(sk(Sess)) in
                                                                        {1629}out(c, GetEndpointRequest);
                                                                        {1630}in(c, (=GetEndpointResponse,=pkSess_1805,=None,SP_1806: bitstring,UP_1807: bitstring));
                                                                        {1631}new Nc_1808: bitstring;
                                                                        {1632}let m1_1809: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1545,Nc_1808) in
                                                                        {1633}event beginCli(Cli,Sess,Nc_1808);
                                                                        {1634}out(c, (pkCli_1545,m1_1809));
                                                                        {1635}in(c, em2_1810: bitstring);
                                                                        {1636}let m2_1811: bitstring = em2_1810 in
                                                                        {1637}let (=OpenSecureChannelResponse,=Cli,Ns_1812: bitstring,ST_1813: bitstring,TTL_1814: bitstring) = m2_1811 in
                                                                        {1638}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                        {1639}event endCli(Sess,Cli,Ns_1812)
                                                                )
                                                                else
                                                                    {1640}let pkSess_1815: bitstring = fail-any in
                                                                    {1641}out(c, GetEndpointRequest);
                                                                    {1642}in(c, (=GetEndpointResponse,=pkSess_1815,=None,SP_1816: bitstring,UP_1817: bitstring));
                                                                    {1643}new Nc_1818: bitstring;
                                                                    {1644}let m1_1819: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1545,Nc_1818) in
                                                                    {1645}event beginCli(Cli,Sess,Nc_1818);
                                                                    {1646}out(c, (pkCli_1545,m1_1819));
                                                                    {1647}in(c, em2_1820: bitstring);
                                                                    {1648}let m2_1821: bitstring = em2_1820 in
                                                                    {1649}let (=OpenSecureChannelResponse,=Cli,Ns_1822: bitstring,ST_1823: bitstring,TTL_1824: bitstring) = m2_1821 in
                                                                    {1650}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                    {1651}event endCli(Sess,Cli,Ns_1822)
                                                        )
                                                        else
                                                            {1652}let pkSess_1825: bitstring = fail-any in
                                                            {1653}out(c, GetEndpointRequest);
                                                            {1654}in(c, (=GetEndpointResponse,=pkSess_1825,=None,SP_1826: bitstring,UP_1827: bitstring));
                                                            {1655}new Nc_1828: bitstring;
                                                            {1656}let m1_1829: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1545,Nc_1828) in
                                                            {1657}event beginCli(Cli,Sess,Nc_1828);
                                                            {1658}out(c, (pkCli_1545,m1_1829));
                                                            {1659}in(c, em2_1830: bitstring);
                                                            {1660}let m2_1831: bitstring = em2_1830 in
                                                            {1661}let (=OpenSecureChannelResponse,=Cli,Ns_1832: bitstring,ST_1833: bitstring,TTL_1834: bitstring) = m2_1831 in
                                                            {1662}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                            {1663}event endCli(Sess,Cli,Ns_1832)
                                                )
                                                else
                                                    {1664}let pkSess_1835: bitstring = fail-any in
                                                    {1665}out(c, GetEndpointRequest);
                                                    {1666}in(c, (=GetEndpointResponse,=pkSess_1835,=None,SP_1836: bitstring,UP_1837: bitstring));
                                                    {1667}new Nc_1838: bitstring;
                                                    {1668}let m1_1839: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1545,Nc_1838) in
                                                    {1669}event beginCli(Cli,Sess,Nc_1838);
                                                    {1670}out(c, (pkCli_1545,m1_1839));
                                                    {1671}in(c, em2_1840: bitstring);
                                                    {1672}let m2_1841: bitstring = em2_1840 in
                                                    {1673}let (=OpenSecureChannelResponse,=Cli,Ns_1842: bitstring,ST_1843: bitstring,TTL_1844: bitstring) = m2_1841 in
                                                    {1674}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {1675}event endCli(Sess,Cli,Ns_1842)
                                        )
                                        else
                                            {1676}let pkDisco_1845: bitstring = fail-any in
                                            {1677}let v_1846: bool = (Sess = A) in
                                            (
                                                {1678}if v_1846 then
                                                (
                                                    {1679}let pkSess_1847: bitstring = pub(skA) in
                                                    {1680}out(c, GetEndpointRequest);
                                                    {1681}in(c, (=GetEndpointResponse,=pkSess_1847,=None,SP_1848: bitstring,UP_1849: bitstring));
                                                    {1682}new Nc_1850: bitstring;
                                                    {1683}let m1_1851: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1545,Nc_1850) in
                                                    {1684}event beginCli(Cli,Sess,Nc_1850);
                                                    {1685}out(c, (pkCli_1545,m1_1851));
                                                    {1686}in(c, em2_1852: bitstring);
                                                    {1687}let m2_1853: bitstring = em2_1852 in
                                                    {1688}let (=OpenSecureChannelResponse,=Cli,Ns_1854: bitstring,ST_1855: bitstring,TTL_1856: bitstring) = m2_1853 in
                                                    {1689}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {1690}event endCli(Sess,Cli,Ns_1854)
                                                )
                                                else
                                                    {1691}let v_1857: bool = (Sess = B) in
                                                    (
                                                        {1692}if v_1857 then
                                                        (
                                                            {1693}let pkSess_1858: bitstring = pub(skB) in
                                                            {1694}out(c, GetEndpointRequest);
                                                            {1695}in(c, (=GetEndpointResponse,=pkSess_1858,=None,SP_1859: bitstring,UP_1860: bitstring));
                                                            {1696}new Nc_1861: bitstring;
                                                            {1697}let m1_1862: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1545,Nc_1861) in
                                                            {1698}event beginCli(Cli,Sess,Nc_1861);
                                                            {1699}out(c, (pkCli_1545,m1_1862));
                                                            {1700}in(c, em2_1863: bitstring);
                                                            {1701}let m2_1864: bitstring = em2_1863 in
                                                            {1702}let (=OpenSecureChannelResponse,=Cli,Ns_1865: bitstring,ST_1866: bitstring,TTL_1867: bitstring) = m2_1864 in
                                                            {1703}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                            {1704}event endCli(Sess,Cli,Ns_1865)
                                                        )
                                                        else
                                                            {1705}let v_1868: bool = (Sess = C) in
                                                            (
                                                                {1706}if v_1868 then
                                                                (
                                                                    {1707}let pkSess_1869: bitstring = pub(skC) in
                                                                    {1708}out(c, GetEndpointRequest);
                                                                    {1709}in(c, (=GetEndpointResponse,=pkSess_1869,=None,SP_1870: bitstring,UP_1871: bitstring));
                                                                    {1710}new Nc_1872: bitstring;
                                                                    {1711}let m1_1873: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1545,Nc_1872) in
                                                                    {1712}event beginCli(Cli,Sess,Nc_1872);
                                                                    {1713}out(c, (pkCli_1545,m1_1873));
                                                                    {1714}in(c, em2_1874: bitstring);
                                                                    {1715}let m2_1875: bitstring = em2_1874 in
                                                                    {1716}let (=OpenSecureChannelResponse,=Cli,Ns_1876: bitstring,ST_1877: bitstring,TTL_1878: bitstring) = m2_1875 in
                                                                    {1717}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                    {1718}event endCli(Sess,Cli,Ns_1876)
                                                                )
                                                                else
                                                                    {1719}let pkSess_1879: bitstring = pub(sk(Sess)) in
                                                                    {1720}out(c, GetEndpointRequest);
                                                                    {1721}in(c, (=GetEndpointResponse,=pkSess_1879,=None,SP_1880: bitstring,UP_1881: bitstring));
                                                                    {1722}new Nc_1882: bitstring;
                                                                    {1723}let m1_1883: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1545,Nc_1882) in
                                                                    {1724}event beginCli(Cli,Sess,Nc_1882);
                                                                    {1725}out(c, (pkCli_1545,m1_1883));
                                                                    {1726}in(c, em2_1884: bitstring);
                                                                    {1727}let m2_1885: bitstring = em2_1884 in
                                                                    {1728}let (=OpenSecureChannelResponse,=Cli,Ns_1886: bitstring,ST_1887: bitstring,TTL_1888: bitstring) = m2_1885 in
                                                                    {1729}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                    {1730}event endCli(Sess,Cli,Ns_1886)
                                                            )
                                                            else
                                                                {1731}let pkSess_1889: bitstring = fail-any in
                                                                {1732}out(c, GetEndpointRequest);
                                                                {1733}in(c, (=GetEndpointResponse,=pkSess_1889,=None,SP_1890: bitstring,UP_1891: bitstring));
                                                                {1734}new Nc_1892: bitstring;
                                                                {1735}let m1_1893: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1545,Nc_1892) in
                                                                {1736}event beginCli(Cli,Sess,Nc_1892);
                                                                {1737}out(c, (pkCli_1545,m1_1893));
                                                                {1738}in(c, em2_1894: bitstring);
                                                                {1739}let m2_1895: bitstring = em2_1894 in
                                                                {1740}let (=OpenSecureChannelResponse,=Cli,Ns_1896: bitstring,ST_1897: bitstring,TTL_1898: bitstring) = m2_1895 in
                                                                {1741}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                {1742}event endCli(Sess,Cli,Ns_1896)
                                                    )
                                                    else
                                                        {1743}let pkSess_1899: bitstring = fail-any in
                                                        {1744}out(c, GetEndpointRequest);
                                                        {1745}in(c, (=GetEndpointResponse,=pkSess_1899,=None,SP_1900: bitstring,UP_1901: bitstring));
                                                        {1746}new Nc_1902: bitstring;
                                                        {1747}let m1_1903: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1545,Nc_1902) in
                                                        {1748}event beginCli(Cli,Sess,Nc_1902);
                                                        {1749}out(c, (pkCli_1545,m1_1903));
                                                        {1750}in(c, em2_1904: bitstring);
                                                        {1751}let m2_1905: bitstring = em2_1904 in
                                                        {1752}let (=OpenSecureChannelResponse,=Cli,Ns_1906: bitstring,ST_1907: bitstring,TTL_1908: bitstring) = m2_1905 in
                                                        {1753}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {1754}event endCli(Sess,Cli,Ns_1906)
                                            )
                                            else
                                                {1755}let pkSess_1909: bitstring = fail-any in
                                                {1756}out(c, GetEndpointRequest);
                                                {1757}in(c, (=GetEndpointResponse,=pkSess_1909,=None,SP_1910: bitstring,UP_1911: bitstring));
                                                {1758}new Nc_1912: bitstring;
                                                {1759}let m1_1913: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1545,Nc_1912) in
                                                {1760}event beginCli(Cli,Sess,Nc_1912);
                                                {1761}out(c, (pkCli_1545,m1_1913));
                                                {1762}in(c, em2_1914: bitstring);
                                                {1763}let m2_1915: bitstring = em2_1914 in
                                                {1764}let (=OpenSecureChannelResponse,=Cli,Ns_1916: bitstring,ST_1917: bitstring,TTL_1918: bitstring) = m2_1915 in
                                                {1765}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {1766}event endCli(Sess,Cli,Ns_1916)
                                )
                                else
                                    {1767}let pkDisco_1919: bitstring = fail-any in
                                    {1768}let v_1920: bool = (Sess = A) in
                                    (
                                        {1769}if v_1920 then
                                        (
                                            {1770}let pkSess_1921: bitstring = pub(skA) in
                                            {1771}out(c, GetEndpointRequest);
                                            {1772}in(c, (=GetEndpointResponse,=pkSess_1921,=None,SP_1922: bitstring,UP_1923: bitstring));
                                            {1773}new Nc_1924: bitstring;
                                            {1774}let m1_1925: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1545,Nc_1924) in
                                            {1775}event beginCli(Cli,Sess,Nc_1924);
                                            {1776}out(c, (pkCli_1545,m1_1925));
                                            {1777}in(c, em2_1926: bitstring);
                                            {1778}let m2_1927: bitstring = em2_1926 in
                                            {1779}let (=OpenSecureChannelResponse,=Cli,Ns_1928: bitstring,ST_1929: bitstring,TTL_1930: bitstring) = m2_1927 in
                                            {1780}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {1781}event endCli(Sess,Cli,Ns_1928)
                                        )
                                        else
                                            {1782}let v_1931: bool = (Sess = B) in
                                            (
                                                {1783}if v_1931 then
                                                (
                                                    {1784}let pkSess_1932: bitstring = pub(skB) in
                                                    {1785}out(c, GetEndpointRequest);
                                                    {1786}in(c, (=GetEndpointResponse,=pkSess_1932,=None,SP_1933: bitstring,UP_1934: bitstring));
                                                    {1787}new Nc_1935: bitstring;
                                                    {1788}let m1_1936: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1545,Nc_1935) in
                                                    {1789}event beginCli(Cli,Sess,Nc_1935);
                                                    {1790}out(c, (pkCli_1545,m1_1936));
                                                    {1791}in(c, em2_1937: bitstring);
                                                    {1792}let m2_1938: bitstring = em2_1937 in
                                                    {1793}let (=OpenSecureChannelResponse,=Cli,Ns_1939: bitstring,ST_1940: bitstring,TTL_1941: bitstring) = m2_1938 in
                                                    {1794}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {1795}event endCli(Sess,Cli,Ns_1939)
                                                )
                                                else
                                                    {1796}let v_1942: bool = (Sess = C) in
                                                    (
                                                        {1797}if v_1942 then
                                                        (
                                                            {1798}let pkSess_1943: bitstring = pub(skC) in
                                                            {1799}out(c, GetEndpointRequest);
                                                            {1800}in(c, (=GetEndpointResponse,=pkSess_1943,=None,SP_1944: bitstring,UP_1945: bitstring));
                                                            {1801}new Nc_1946: bitstring;
                                                            {1802}let m1_1947: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1545,Nc_1946) in
                                                            {1803}event beginCli(Cli,Sess,Nc_1946);
                                                            {1804}out(c, (pkCli_1545,m1_1947));
                                                            {1805}in(c, em2_1948: bitstring);
                                                            {1806}let m2_1949: bitstring = em2_1948 in
                                                            {1807}let (=OpenSecureChannelResponse,=Cli,Ns_1950: bitstring,ST_1951: bitstring,TTL_1952: bitstring) = m2_1949 in
                                                            {1808}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                            {1809}event endCli(Sess,Cli,Ns_1950)
                                                        )
                                                        else
                                                            {1810}let pkSess_1953: bitstring = pub(sk(Sess)) in
                                                            {1811}out(c, GetEndpointRequest);
                                                            {1812}in(c, (=GetEndpointResponse,=pkSess_1953,=None,SP_1954: bitstring,UP_1955: bitstring));
                                                            {1813}new Nc_1956: bitstring;
                                                            {1814}let m1_1957: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1545,Nc_1956) in
                                                            {1815}event beginCli(Cli,Sess,Nc_1956);
                                                            {1816}out(c, (pkCli_1545,m1_1957));
                                                            {1817}in(c, em2_1958: bitstring);
                                                            {1818}let m2_1959: bitstring = em2_1958 in
                                                            {1819}let (=OpenSecureChannelResponse,=Cli,Ns_1960: bitstring,ST_1961: bitstring,TTL_1962: bitstring) = m2_1959 in
                                                            {1820}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                            {1821}event endCli(Sess,Cli,Ns_1960)
                                                    )
                                                    else
                                                        {1822}let pkSess_1963: bitstring = fail-any in
                                                        {1823}out(c, GetEndpointRequest);
                                                        {1824}in(c, (=GetEndpointResponse,=pkSess_1963,=None,SP_1964: bitstring,UP_1965: bitstring));
                                                        {1825}new Nc_1966: bitstring;
                                                        {1826}let m1_1967: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1545,Nc_1966) in
                                                        {1827}event beginCli(Cli,Sess,Nc_1966);
                                                        {1828}out(c, (pkCli_1545,m1_1967));
                                                        {1829}in(c, em2_1968: bitstring);
                                                        {1830}let m2_1969: bitstring = em2_1968 in
                                                        {1831}let (=OpenSecureChannelResponse,=Cli,Ns_1970: bitstring,ST_1971: bitstring,TTL_1972: bitstring) = m2_1969 in
                                                        {1832}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {1833}event endCli(Sess,Cli,Ns_1970)
                                            )
                                            else
                                                {1834}let pkSess_1973: bitstring = fail-any in
                                                {1835}out(c, GetEndpointRequest);
                                                {1836}in(c, (=GetEndpointResponse,=pkSess_1973,=None,SP_1974: bitstring,UP_1975: bitstring));
                                                {1837}new Nc_1976: bitstring;
                                                {1838}let m1_1977: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1545,Nc_1976) in
                                                {1839}event beginCli(Cli,Sess,Nc_1976);
                                                {1840}out(c, (pkCli_1545,m1_1977));
                                                {1841}in(c, em2_1978: bitstring);
                                                {1842}let m2_1979: bitstring = em2_1978 in
                                                {1843}let (=OpenSecureChannelResponse,=Cli,Ns_1980: bitstring,ST_1981: bitstring,TTL_1982: bitstring) = m2_1979 in
                                                {1844}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {1845}event endCli(Sess,Cli,Ns_1980)
                                    )
                                    else
                                        {1846}let pkSess_1983: bitstring = fail-any in
                                        {1847}out(c, GetEndpointRequest);
                                        {1848}in(c, (=GetEndpointResponse,=pkSess_1983,=None,SP_1984: bitstring,UP_1985: bitstring));
                                        {1849}new Nc_1986: bitstring;
                                        {1850}let m1_1987: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1545,Nc_1986) in
                                        {1851}event beginCli(Cli,Sess,Nc_1986);
                                        {1852}out(c, (pkCli_1545,m1_1987));
                                        {1853}in(c, em2_1988: bitstring);
                                        {1854}let m2_1989: bitstring = em2_1988 in
                                        {1855}let (=OpenSecureChannelResponse,=Cli,Ns_1990: bitstring,ST_1991: bitstring,TTL_1992: bitstring) = m2_1989 in
                                        {1856}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                        {1857}event endCli(Sess,Cli,Ns_1990)
                        )
                        else
                            {1858}let pkDisco_1993: bitstring = fail-any in
                            {1859}let v_1994: bool = (Sess = A) in
                            (
                                {1860}if v_1994 then
                                (
                                    {1861}let pkSess_1995: bitstring = pub(skA) in
                                    {1862}out(c, GetEndpointRequest);
                                    {1863}in(c, (=GetEndpointResponse,=pkSess_1995,=None,SP_1996: bitstring,UP_1997: bitstring));
                                    {1864}new Nc_1998: bitstring;
                                    {1865}let m1_1999: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1545,Nc_1998) in
                                    {1866}event beginCli(Cli,Sess,Nc_1998);
                                    {1867}out(c, (pkCli_1545,m1_1999));
                                    {1868}in(c, em2_2000: bitstring);
                                    {1869}let m2_2001: bitstring = em2_2000 in
                                    {1870}let (=OpenSecureChannelResponse,=Cli,Ns_2002: bitstring,ST_2003: bitstring,TTL_2004: bitstring) = m2_2001 in
                                    {1871}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                    {1872}event endCli(Sess,Cli,Ns_2002)
                                )
                                else
                                    {1873}let v_2005: bool = (Sess = B) in
                                    (
                                        {1874}if v_2005 then
                                        (
                                            {1875}let pkSess_2006: bitstring = pub(skB) in
                                            {1876}out(c, GetEndpointRequest);
                                            {1877}in(c, (=GetEndpointResponse,=pkSess_2006,=None,SP_2007: bitstring,UP_2008: bitstring));
                                            {1878}new Nc_2009: bitstring;
                                            {1879}let m1_2010: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1545,Nc_2009) in
                                            {1880}event beginCli(Cli,Sess,Nc_2009);
                                            {1881}out(c, (pkCli_1545,m1_2010));
                                            {1882}in(c, em2_2011: bitstring);
                                            {1883}let m2_2012: bitstring = em2_2011 in
                                            {1884}let (=OpenSecureChannelResponse,=Cli,Ns_2013: bitstring,ST_2014: bitstring,TTL_2015: bitstring) = m2_2012 in
                                            {1885}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {1886}event endCli(Sess,Cli,Ns_2013)
                                        )
                                        else
                                            {1887}let v_2016: bool = (Sess = C) in
                                            (
                                                {1888}if v_2016 then
                                                (
                                                    {1889}let pkSess_2017: bitstring = pub(skC) in
                                                    {1890}out(c, GetEndpointRequest);
                                                    {1891}in(c, (=GetEndpointResponse,=pkSess_2017,=None,SP_2018: bitstring,UP_2019: bitstring));
                                                    {1892}new Nc_2020: bitstring;
                                                    {1893}let m1_2021: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1545,Nc_2020) in
                                                    {1894}event beginCli(Cli,Sess,Nc_2020);
                                                    {1895}out(c, (pkCli_1545,m1_2021));
                                                    {1896}in(c, em2_2022: bitstring);
                                                    {1897}let m2_2023: bitstring = em2_2022 in
                                                    {1898}let (=OpenSecureChannelResponse,=Cli,Ns_2024: bitstring,ST_2025: bitstring,TTL_2026: bitstring) = m2_2023 in
                                                    {1899}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {1900}event endCli(Sess,Cli,Ns_2024)
                                                )
                                                else
                                                    {1901}let pkSess_2027: bitstring = pub(sk(Sess)) in
                                                    {1902}out(c, GetEndpointRequest);
                                                    {1903}in(c, (=GetEndpointResponse,=pkSess_2027,=None,SP_2028: bitstring,UP_2029: bitstring));
                                                    {1904}new Nc_2030: bitstring;
                                                    {1905}let m1_2031: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1545,Nc_2030) in
                                                    {1906}event beginCli(Cli,Sess,Nc_2030);
                                                    {1907}out(c, (pkCli_1545,m1_2031));
                                                    {1908}in(c, em2_2032: bitstring);
                                                    {1909}let m2_2033: bitstring = em2_2032 in
                                                    {1910}let (=OpenSecureChannelResponse,=Cli,Ns_2034: bitstring,ST_2035: bitstring,TTL_2036: bitstring) = m2_2033 in
                                                    {1911}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {1912}event endCli(Sess,Cli,Ns_2034)
                                            )
                                            else
                                                {1913}let pkSess_2037: bitstring = fail-any in
                                                {1914}out(c, GetEndpointRequest);
                                                {1915}in(c, (=GetEndpointResponse,=pkSess_2037,=None,SP_2038: bitstring,UP_2039: bitstring));
                                                {1916}new Nc_2040: bitstring;
                                                {1917}let m1_2041: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1545,Nc_2040) in
                                                {1918}event beginCli(Cli,Sess,Nc_2040);
                                                {1919}out(c, (pkCli_1545,m1_2041));
                                                {1920}in(c, em2_2042: bitstring);
                                                {1921}let m2_2043: bitstring = em2_2042 in
                                                {1922}let (=OpenSecureChannelResponse,=Cli,Ns_2044: bitstring,ST_2045: bitstring,TTL_2046: bitstring) = m2_2043 in
                                                {1923}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {1924}event endCli(Sess,Cli,Ns_2044)
                                    )
                                    else
                                        {1925}let pkSess_2047: bitstring = fail-any in
                                        {1926}out(c, GetEndpointRequest);
                                        {1927}in(c, (=GetEndpointResponse,=pkSess_2047,=None,SP_2048: bitstring,UP_2049: bitstring));
                                        {1928}new Nc_2050: bitstring;
                                        {1929}let m1_2051: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1545,Nc_2050) in
                                        {1930}event beginCli(Cli,Sess,Nc_2050);
                                        {1931}out(c, (pkCli_1545,m1_2051));
                                        {1932}in(c, em2_2052: bitstring);
                                        {1933}let m2_2053: bitstring = em2_2052 in
                                        {1934}let (=OpenSecureChannelResponse,=Cli,Ns_2054: bitstring,ST_2055: bitstring,TTL_2056: bitstring) = m2_2053 in
                                        {1935}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                        {1936}event endCli(Sess,Cli,Ns_2054)
                            )
                            else
                                {1937}let pkSess_2057: bitstring = fail-any in
                                {1938}out(c, GetEndpointRequest);
                                {1939}in(c, (=GetEndpointResponse,=pkSess_2057,=None,SP_2058: bitstring,UP_2059: bitstring));
                                {1940}new Nc_2060: bitstring;
                                {1941}let m1_2061: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1545,Nc_2060) in
                                {1942}event beginCli(Cli,Sess,Nc_2060);
                                {1943}out(c, (pkCli_1545,m1_2061));
                                {1944}in(c, em2_2062: bitstring);
                                {1945}let m2_2063: bitstring = em2_2062 in
                                {1946}let (=OpenSecureChannelResponse,=Cli,Ns_2064: bitstring,ST_2065: bitstring,TTL_2066: bitstring) = m2_2063 in
                                {1947}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                {1948}event endCli(Sess,Cli,Ns_2064)
                    )
                    else
                        {1949}let skCli_2067: bitstring = fail-any in
                        {1950}let pkCli_2068: bitstring = pub(skCli_2067) in
                        {1951}let v_2069: bool = (Disco = A) in
                        (
                            {1952}if v_2069 then
                            (
                                {1953}let pkDisco_2070: bitstring = pub(skA) in
                                {1954}let v_2071: bool = (Sess = A) in
                                (
                                    {1955}if v_2071 then
                                    (
                                        {1956}let pkSess_2072: bitstring = pub(skA) in
                                        {1957}out(c, GetEndpointRequest);
                                        {1958}in(c, (=GetEndpointResponse,=pkSess_2072,=None,SP_2073: bitstring,UP_2074: bitstring));
                                        {1959}new Nc_2075: bitstring;
                                        {1960}let m1_2076: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2068,Nc_2075) in
                                        {1961}event beginCli(Cli,Sess,Nc_2075);
                                        {1962}out(c, (pkCli_2068,m1_2076));
                                        {1963}in(c, em2_2077: bitstring);
                                        {1964}let m2_2078: bitstring = em2_2077 in
                                        {1965}let (=OpenSecureChannelResponse,=Cli,Ns_2079: bitstring,ST_2080: bitstring,TTL_2081: bitstring) = m2_2078 in
                                        {1966}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                        {1967}event endCli(Sess,Cli,Ns_2079)
                                    )
                                    else
                                        {1968}let v_2082: bool = (Sess = B) in
                                        (
                                            {1969}if v_2082 then
                                            (
                                                {1970}let pkSess_2083: bitstring = pub(skB) in
                                                {1971}out(c, GetEndpointRequest);
                                                {1972}in(c, (=GetEndpointResponse,=pkSess_2083,=None,SP_2084: bitstring,UP_2085: bitstring));
                                                {1973}new Nc_2086: bitstring;
                                                {1974}let m1_2087: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2068,Nc_2086) in
                                                {1975}event beginCli(Cli,Sess,Nc_2086);
                                                {1976}out(c, (pkCli_2068,m1_2087));
                                                {1977}in(c, em2_2088: bitstring);
                                                {1978}let m2_2089: bitstring = em2_2088 in
                                                {1979}let (=OpenSecureChannelResponse,=Cli,Ns_2090: bitstring,ST_2091: bitstring,TTL_2092: bitstring) = m2_2089 in
                                                {1980}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {1981}event endCli(Sess,Cli,Ns_2090)
                                            )
                                            else
                                                {1982}let v_2093: bool = (Sess = C) in
                                                (
                                                    {1983}if v_2093 then
                                                    (
                                                        {1984}let pkSess_2094: bitstring = pub(skC) in
                                                        {1985}out(c, GetEndpointRequest);
                                                        {1986}in(c, (=GetEndpointResponse,=pkSess_2094,=None,SP_2095: bitstring,UP_2096: bitstring));
                                                        {1987}new Nc_2097: bitstring;
                                                        {1988}let m1_2098: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2068,Nc_2097) in
                                                        {1989}event beginCli(Cli,Sess,Nc_2097);
                                                        {1990}out(c, (pkCli_2068,m1_2098));
                                                        {1991}in(c, em2_2099: bitstring);
                                                        {1992}let m2_2100: bitstring = em2_2099 in
                                                        {1993}let (=OpenSecureChannelResponse,=Cli,Ns_2101: bitstring,ST_2102: bitstring,TTL_2103: bitstring) = m2_2100 in
                                                        {1994}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {1995}event endCli(Sess,Cli,Ns_2101)
                                                    )
                                                    else
                                                        {1996}let pkSess_2104: bitstring = pub(sk(Sess)) in
                                                        {1997}out(c, GetEndpointRequest);
                                                        {1998}in(c, (=GetEndpointResponse,=pkSess_2104,=None,SP_2105: bitstring,UP_2106: bitstring));
                                                        {1999}new Nc_2107: bitstring;
                                                        {2000}let m1_2108: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2068,Nc_2107) in
                                                        {2001}event beginCli(Cli,Sess,Nc_2107);
                                                        {2002}out(c, (pkCli_2068,m1_2108));
                                                        {2003}in(c, em2_2109: bitstring);
                                                        {2004}let m2_2110: bitstring = em2_2109 in
                                                        {2005}let (=OpenSecureChannelResponse,=Cli,Ns_2111: bitstring,ST_2112: bitstring,TTL_2113: bitstring) = m2_2110 in
                                                        {2006}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {2007}event endCli(Sess,Cli,Ns_2111)
                                                )
                                                else
                                                    {2008}let pkSess_2114: bitstring = fail-any in
                                                    {2009}out(c, GetEndpointRequest);
                                                    {2010}in(c, (=GetEndpointResponse,=pkSess_2114,=None,SP_2115: bitstring,UP_2116: bitstring));
                                                    {2011}new Nc_2117: bitstring;
                                                    {2012}let m1_2118: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2068,Nc_2117) in
                                                    {2013}event beginCli(Cli,Sess,Nc_2117);
                                                    {2014}out(c, (pkCli_2068,m1_2118));
                                                    {2015}in(c, em2_2119: bitstring);
                                                    {2016}let m2_2120: bitstring = em2_2119 in
                                                    {2017}let (=OpenSecureChannelResponse,=Cli,Ns_2121: bitstring,ST_2122: bitstring,TTL_2123: bitstring) = m2_2120 in
                                                    {2018}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {2019}event endCli(Sess,Cli,Ns_2121)
                                        )
                                        else
                                            {2020}let pkSess_2124: bitstring = fail-any in
                                            {2021}out(c, GetEndpointRequest);
                                            {2022}in(c, (=GetEndpointResponse,=pkSess_2124,=None,SP_2125: bitstring,UP_2126: bitstring));
                                            {2023}new Nc_2127: bitstring;
                                            {2024}let m1_2128: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2068,Nc_2127) in
                                            {2025}event beginCli(Cli,Sess,Nc_2127);
                                            {2026}out(c, (pkCli_2068,m1_2128));
                                            {2027}in(c, em2_2129: bitstring);
                                            {2028}let m2_2130: bitstring = em2_2129 in
                                            {2029}let (=OpenSecureChannelResponse,=Cli,Ns_2131: bitstring,ST_2132: bitstring,TTL_2133: bitstring) = m2_2130 in
                                            {2030}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {2031}event endCli(Sess,Cli,Ns_2131)
                                )
                                else
                                    {2032}let pkSess_2134: bitstring = fail-any in
                                    {2033}out(c, GetEndpointRequest);
                                    {2034}in(c, (=GetEndpointResponse,=pkSess_2134,=None,SP_2135: bitstring,UP_2136: bitstring));
                                    {2035}new Nc_2137: bitstring;
                                    {2036}let m1_2138: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2068,Nc_2137) in
                                    {2037}event beginCli(Cli,Sess,Nc_2137);
                                    {2038}out(c, (pkCli_2068,m1_2138));
                                    {2039}in(c, em2_2139: bitstring);
                                    {2040}let m2_2140: bitstring = em2_2139 in
                                    {2041}let (=OpenSecureChannelResponse,=Cli,Ns_2141: bitstring,ST_2142: bitstring,TTL_2143: bitstring) = m2_2140 in
                                    {2042}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                    {2043}event endCli(Sess,Cli,Ns_2141)
                            )
                            else
                                {2044}let v_2144: bool = (Disco = B) in
                                (
                                    {2045}if v_2144 then
                                    (
                                        {2046}let pkDisco_2145: bitstring = pub(skB) in
                                        {2047}let v_2146: bool = (Sess = A) in
                                        (
                                            {2048}if v_2146 then
                                            (
                                                {2049}let pkSess_2147: bitstring = pub(skA) in
                                                {2050}out(c, GetEndpointRequest);
                                                {2051}in(c, (=GetEndpointResponse,=pkSess_2147,=None,SP_2148: bitstring,UP_2149: bitstring));
                                                {2052}new Nc_2150: bitstring;
                                                {2053}let m1_2151: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2068,Nc_2150) in
                                                {2054}event beginCli(Cli,Sess,Nc_2150);
                                                {2055}out(c, (pkCli_2068,m1_2151));
                                                {2056}in(c, em2_2152: bitstring);
                                                {2057}let m2_2153: bitstring = em2_2152 in
                                                {2058}let (=OpenSecureChannelResponse,=Cli,Ns_2154: bitstring,ST_2155: bitstring,TTL_2156: bitstring) = m2_2153 in
                                                {2059}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {2060}event endCli(Sess,Cli,Ns_2154)
                                            )
                                            else
                                                {2061}let v_2157: bool = (Sess = B) in
                                                (
                                                    {2062}if v_2157 then
                                                    (
                                                        {2063}let pkSess_2158: bitstring = pub(skB) in
                                                        {2064}out(c, GetEndpointRequest);
                                                        {2065}in(c, (=GetEndpointResponse,=pkSess_2158,=None,SP_2159: bitstring,UP_2160: bitstring));
                                                        {2066}new Nc_2161: bitstring;
                                                        {2067}let m1_2162: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2068,Nc_2161) in
                                                        {2068}event beginCli(Cli,Sess,Nc_2161);
                                                        {2069}out(c, (pkCli_2068,m1_2162));
                                                        {2070}in(c, em2_2163: bitstring);
                                                        {2071}let m2_2164: bitstring = em2_2163 in
                                                        {2072}let (=OpenSecureChannelResponse,=Cli,Ns_2165: bitstring,ST_2166: bitstring,TTL_2167: bitstring) = m2_2164 in
                                                        {2073}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {2074}event endCli(Sess,Cli,Ns_2165)
                                                    )
                                                    else
                                                        {2075}let v_2168: bool = (Sess = C) in
                                                        (
                                                            {2076}if v_2168 then
                                                            (
                                                                {2077}let pkSess_2169: bitstring = pub(skC) in
                                                                {2078}out(c, GetEndpointRequest);
                                                                {2079}in(c, (=GetEndpointResponse,=pkSess_2169,=None,SP_2170: bitstring,UP_2171: bitstring));
                                                                {2080}new Nc_2172: bitstring;
                                                                {2081}let m1_2173: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2068,Nc_2172) in
                                                                {2082}event beginCli(Cli,Sess,Nc_2172);
                                                                {2083}out(c, (pkCli_2068,m1_2173));
                                                                {2084}in(c, em2_2174: bitstring);
                                                                {2085}let m2_2175: bitstring = em2_2174 in
                                                                {2086}let (=OpenSecureChannelResponse,=Cli,Ns_2176: bitstring,ST_2177: bitstring,TTL_2178: bitstring) = m2_2175 in
                                                                {2087}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                {2088}event endCli(Sess,Cli,Ns_2176)
                                                            )
                                                            else
                                                                {2089}let pkSess_2179: bitstring = pub(sk(Sess)) in
                                                                {2090}out(c, GetEndpointRequest);
                                                                {2091}in(c, (=GetEndpointResponse,=pkSess_2179,=None,SP_2180: bitstring,UP_2181: bitstring));
                                                                {2092}new Nc_2182: bitstring;
                                                                {2093}let m1_2183: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2068,Nc_2182) in
                                                                {2094}event beginCli(Cli,Sess,Nc_2182);
                                                                {2095}out(c, (pkCli_2068,m1_2183));
                                                                {2096}in(c, em2_2184: bitstring);
                                                                {2097}let m2_2185: bitstring = em2_2184 in
                                                                {2098}let (=OpenSecureChannelResponse,=Cli,Ns_2186: bitstring,ST_2187: bitstring,TTL_2188: bitstring) = m2_2185 in
                                                                {2099}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                {2100}event endCli(Sess,Cli,Ns_2186)
                                                        )
                                                        else
                                                            {2101}let pkSess_2189: bitstring = fail-any in
                                                            {2102}out(c, GetEndpointRequest);
                                                            {2103}in(c, (=GetEndpointResponse,=pkSess_2189,=None,SP_2190: bitstring,UP_2191: bitstring));
                                                            {2104}new Nc_2192: bitstring;
                                                            {2105}let m1_2193: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2068,Nc_2192) in
                                                            {2106}event beginCli(Cli,Sess,Nc_2192);
                                                            {2107}out(c, (pkCli_2068,m1_2193));
                                                            {2108}in(c, em2_2194: bitstring);
                                                            {2109}let m2_2195: bitstring = em2_2194 in
                                                            {2110}let (=OpenSecureChannelResponse,=Cli,Ns_2196: bitstring,ST_2197: bitstring,TTL_2198: bitstring) = m2_2195 in
                                                            {2111}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                            {2112}event endCli(Sess,Cli,Ns_2196)
                                                )
                                                else
                                                    {2113}let pkSess_2199: bitstring = fail-any in
                                                    {2114}out(c, GetEndpointRequest);
                                                    {2115}in(c, (=GetEndpointResponse,=pkSess_2199,=None,SP_2200: bitstring,UP_2201: bitstring));
                                                    {2116}new Nc_2202: bitstring;
                                                    {2117}let m1_2203: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2068,Nc_2202) in
                                                    {2118}event beginCli(Cli,Sess,Nc_2202);
                                                    {2119}out(c, (pkCli_2068,m1_2203));
                                                    {2120}in(c, em2_2204: bitstring);
                                                    {2121}let m2_2205: bitstring = em2_2204 in
                                                    {2122}let (=OpenSecureChannelResponse,=Cli,Ns_2206: bitstring,ST_2207: bitstring,TTL_2208: bitstring) = m2_2205 in
                                                    {2123}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {2124}event endCli(Sess,Cli,Ns_2206)
                                        )
                                        else
                                            {2125}let pkSess_2209: bitstring = fail-any in
                                            {2126}out(c, GetEndpointRequest);
                                            {2127}in(c, (=GetEndpointResponse,=pkSess_2209,=None,SP_2210: bitstring,UP_2211: bitstring));
                                            {2128}new Nc_2212: bitstring;
                                            {2129}let m1_2213: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2068,Nc_2212) in
                                            {2130}event beginCli(Cli,Sess,Nc_2212);
                                            {2131}out(c, (pkCli_2068,m1_2213));
                                            {2132}in(c, em2_2214: bitstring);
                                            {2133}let m2_2215: bitstring = em2_2214 in
                                            {2134}let (=OpenSecureChannelResponse,=Cli,Ns_2216: bitstring,ST_2217: bitstring,TTL_2218: bitstring) = m2_2215 in
                                            {2135}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {2136}event endCli(Sess,Cli,Ns_2216)
                                    )
                                    else
                                        {2137}let v_2219: bool = (Disco = C) in
                                        (
                                            {2138}if v_2219 then
                                            (
                                                {2139}let pkDisco_2220: bitstring = pub(skC) in
                                                {2140}let v_2221: bool = (Sess = A) in
                                                (
                                                    {2141}if v_2221 then
                                                    (
                                                        {2142}let pkSess_2222: bitstring = pub(skA) in
                                                        {2143}out(c, GetEndpointRequest);
                                                        {2144}in(c, (=GetEndpointResponse,=pkSess_2222,=None,SP_2223: bitstring,UP_2224: bitstring));
                                                        {2145}new Nc_2225: bitstring;
                                                        {2146}let m1_2226: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2068,Nc_2225) in
                                                        {2147}event beginCli(Cli,Sess,Nc_2225);
                                                        {2148}out(c, (pkCli_2068,m1_2226));
                                                        {2149}in(c, em2_2227: bitstring);
                                                        {2150}let m2_2228: bitstring = em2_2227 in
                                                        {2151}let (=OpenSecureChannelResponse,=Cli,Ns_2229: bitstring,ST_2230: bitstring,TTL_2231: bitstring) = m2_2228 in
                                                        {2152}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {2153}event endCli(Sess,Cli,Ns_2229)
                                                    )
                                                    else
                                                        {2154}let v_2232: bool = (Sess = B) in
                                                        (
                                                            {2155}if v_2232 then
                                                            (
                                                                {2156}let pkSess_2233: bitstring = pub(skB) in
                                                                {2157}out(c, GetEndpointRequest);
                                                                {2158}in(c, (=GetEndpointResponse,=pkSess_2233,=None,SP_2234: bitstring,UP_2235: bitstring));
                                                                {2159}new Nc_2236: bitstring;
                                                                {2160}let m1_2237: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2068,Nc_2236) in
                                                                {2161}event beginCli(Cli,Sess,Nc_2236);
                                                                {2162}out(c, (pkCli_2068,m1_2237));
                                                                {2163}in(c, em2_2238: bitstring);
                                                                {2164}let m2_2239: bitstring = em2_2238 in
                                                                {2165}let (=OpenSecureChannelResponse,=Cli,Ns_2240: bitstring,ST_2241: bitstring,TTL_2242: bitstring) = m2_2239 in
                                                                {2166}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                {2167}event endCli(Sess,Cli,Ns_2240)
                                                            )
                                                            else
                                                                {2168}let v_2243: bool = (Sess = C) in
                                                                (
                                                                    {2169}if v_2243 then
                                                                    (
                                                                        {2170}let pkSess_2244: bitstring = pub(skC) in
                                                                        {2171}out(c, GetEndpointRequest);
                                                                        {2172}in(c, (=GetEndpointResponse,=pkSess_2244,=None,SP_2245: bitstring,UP_2246: bitstring));
                                                                        {2173}new Nc_2247: bitstring;
                                                                        {2174}let m1_2248: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2068,Nc_2247) in
                                                                        {2175}event beginCli(Cli,Sess,Nc_2247);
                                                                        {2176}out(c, (pkCli_2068,m1_2248));
                                                                        {2177}in(c, em2_2249: bitstring);
                                                                        {2178}let m2_2250: bitstring = em2_2249 in
                                                                        {2179}let (=OpenSecureChannelResponse,=Cli,Ns_2251: bitstring,ST_2252: bitstring,TTL_2253: bitstring) = m2_2250 in
                                                                        {2180}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                        {2181}event endCli(Sess,Cli,Ns_2251)
                                                                    )
                                                                    else
                                                                        {2182}let pkSess_2254: bitstring = pub(sk(Sess)) in
                                                                        {2183}out(c, GetEndpointRequest);
                                                                        {2184}in(c, (=GetEndpointResponse,=pkSess_2254,=None,SP_2255: bitstring,UP_2256: bitstring));
                                                                        {2185}new Nc_2257: bitstring;
                                                                        {2186}let m1_2258: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2068,Nc_2257) in
                                                                        {2187}event beginCli(Cli,Sess,Nc_2257);
                                                                        {2188}out(c, (pkCli_2068,m1_2258));
                                                                        {2189}in(c, em2_2259: bitstring);
                                                                        {2190}let m2_2260: bitstring = em2_2259 in
                                                                        {2191}let (=OpenSecureChannelResponse,=Cli,Ns_2261: bitstring,ST_2262: bitstring,TTL_2263: bitstring) = m2_2260 in
                                                                        {2192}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                        {2193}event endCli(Sess,Cli,Ns_2261)
                                                                )
                                                                else
                                                                    {2194}let pkSess_2264: bitstring = fail-any in
                                                                    {2195}out(c, GetEndpointRequest);
                                                                    {2196}in(c, (=GetEndpointResponse,=pkSess_2264,=None,SP_2265: bitstring,UP_2266: bitstring));
                                                                    {2197}new Nc_2267: bitstring;
                                                                    {2198}let m1_2268: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2068,Nc_2267) in
                                                                    {2199}event beginCli(Cli,Sess,Nc_2267);
                                                                    {2200}out(c, (pkCli_2068,m1_2268));
                                                                    {2201}in(c, em2_2269: bitstring);
                                                                    {2202}let m2_2270: bitstring = em2_2269 in
                                                                    {2203}let (=OpenSecureChannelResponse,=Cli,Ns_2271: bitstring,ST_2272: bitstring,TTL_2273: bitstring) = m2_2270 in
                                                                    {2204}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                    {2205}event endCli(Sess,Cli,Ns_2271)
                                                        )
                                                        else
                                                            {2206}let pkSess_2274: bitstring = fail-any in
                                                            {2207}out(c, GetEndpointRequest);
                                                            {2208}in(c, (=GetEndpointResponse,=pkSess_2274,=None,SP_2275: bitstring,UP_2276: bitstring));
                                                            {2209}new Nc_2277: bitstring;
                                                            {2210}let m1_2278: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2068,Nc_2277) in
                                                            {2211}event beginCli(Cli,Sess,Nc_2277);
                                                            {2212}out(c, (pkCli_2068,m1_2278));
                                                            {2213}in(c, em2_2279: bitstring);
                                                            {2214}let m2_2280: bitstring = em2_2279 in
                                                            {2215}let (=OpenSecureChannelResponse,=Cli,Ns_2281: bitstring,ST_2282: bitstring,TTL_2283: bitstring) = m2_2280 in
                                                            {2216}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                            {2217}event endCli(Sess,Cli,Ns_2281)
                                                )
                                                else
                                                    {2218}let pkSess_2284: bitstring = fail-any in
                                                    {2219}out(c, GetEndpointRequest);
                                                    {2220}in(c, (=GetEndpointResponse,=pkSess_2284,=None,SP_2285: bitstring,UP_2286: bitstring));
                                                    {2221}new Nc_2287: bitstring;
                                                    {2222}let m1_2288: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2068,Nc_2287) in
                                                    {2223}event beginCli(Cli,Sess,Nc_2287);
                                                    {2224}out(c, (pkCli_2068,m1_2288));
                                                    {2225}in(c, em2_2289: bitstring);
                                                    {2226}let m2_2290: bitstring = em2_2289 in
                                                    {2227}let (=OpenSecureChannelResponse,=Cli,Ns_2291: bitstring,ST_2292: bitstring,TTL_2293: bitstring) = m2_2290 in
                                                    {2228}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {2229}event endCli(Sess,Cli,Ns_2291)
                                            )
                                            else
                                                {2230}let pkDisco_2294: bitstring = pub(sk(Disco)) in
                                                {2231}let v_2295: bool = (Sess = A) in
                                                (
                                                    {2232}if v_2295 then
                                                    (
                                                        {2233}let pkSess_2296: bitstring = pub(skA) in
                                                        {2234}out(c, GetEndpointRequest);
                                                        {2235}in(c, (=GetEndpointResponse,=pkSess_2296,=None,SP_2297: bitstring,UP_2298: bitstring));
                                                        {2236}new Nc_2299: bitstring;
                                                        {2237}let m1_2300: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2068,Nc_2299) in
                                                        {2238}event beginCli(Cli,Sess,Nc_2299);
                                                        {2239}out(c, (pkCli_2068,m1_2300));
                                                        {2240}in(c, em2_2301: bitstring);
                                                        {2241}let m2_2302: bitstring = em2_2301 in
                                                        {2242}let (=OpenSecureChannelResponse,=Cli,Ns_2303: bitstring,ST_2304: bitstring,TTL_2305: bitstring) = m2_2302 in
                                                        {2243}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {2244}event endCli(Sess,Cli,Ns_2303)
                                                    )
                                                    else
                                                        {2245}let v_2306: bool = (Sess = B) in
                                                        (
                                                            {2246}if v_2306 then
                                                            (
                                                                {2247}let pkSess_2307: bitstring = pub(skB) in
                                                                {2248}out(c, GetEndpointRequest);
                                                                {2249}in(c, (=GetEndpointResponse,=pkSess_2307,=None,SP_2308: bitstring,UP_2309: bitstring));
                                                                {2250}new Nc_2310: bitstring;
                                                                {2251}let m1_2311: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2068,Nc_2310) in
                                                                {2252}event beginCli(Cli,Sess,Nc_2310);
                                                                {2253}out(c, (pkCli_2068,m1_2311));
                                                                {2254}in(c, em2_2312: bitstring);
                                                                {2255}let m2_2313: bitstring = em2_2312 in
                                                                {2256}let (=OpenSecureChannelResponse,=Cli,Ns_2314: bitstring,ST_2315: bitstring,TTL_2316: bitstring) = m2_2313 in
                                                                {2257}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                {2258}event endCli(Sess,Cli,Ns_2314)
                                                            )
                                                            else
                                                                {2259}let v_2317: bool = (Sess = C) in
                                                                (
                                                                    {2260}if v_2317 then
                                                                    (
                                                                        {2261}let pkSess_2318: bitstring = pub(skC) in
                                                                        {2262}out(c, GetEndpointRequest);
                                                                        {2263}in(c, (=GetEndpointResponse,=pkSess_2318,=None,SP_2319: bitstring,UP_2320: bitstring));
                                                                        {2264}new Nc_2321: bitstring;
                                                                        {2265}let m1_2322: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2068,Nc_2321) in
                                                                        {2266}event beginCli(Cli,Sess,Nc_2321);
                                                                        {2267}out(c, (pkCli_2068,m1_2322));
                                                                        {2268}in(c, em2_2323: bitstring);
                                                                        {2269}let m2_2324: bitstring = em2_2323 in
                                                                        {2270}let (=OpenSecureChannelResponse,=Cli,Ns_2325: bitstring,ST_2326: bitstring,TTL_2327: bitstring) = m2_2324 in
                                                                        {2271}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                        {2272}event endCli(Sess,Cli,Ns_2325)
                                                                    )
                                                                    else
                                                                        {2273}let pkSess_2328: bitstring = pub(sk(Sess)) in
                                                                        {2274}out(c, GetEndpointRequest);
                                                                        {2275}in(c, (=GetEndpointResponse,=pkSess_2328,=None,SP_2329: bitstring,UP_2330: bitstring));
                                                                        {2276}new Nc_2331: bitstring;
                                                                        {2277}let m1_2332: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2068,Nc_2331) in
                                                                        {2278}event beginCli(Cli,Sess,Nc_2331);
                                                                        {2279}out(c, (pkCli_2068,m1_2332));
                                                                        {2280}in(c, em2_2333: bitstring);
                                                                        {2281}let m2_2334: bitstring = em2_2333 in
                                                                        {2282}let (=OpenSecureChannelResponse,=Cli,Ns_2335: bitstring,ST_2336: bitstring,TTL_2337: bitstring) = m2_2334 in
                                                                        {2283}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                        {2284}event endCli(Sess,Cli,Ns_2335)
                                                                )
                                                                else
                                                                    {2285}let pkSess_2338: bitstring = fail-any in
                                                                    {2286}out(c, GetEndpointRequest);
                                                                    {2287}in(c, (=GetEndpointResponse,=pkSess_2338,=None,SP_2339: bitstring,UP_2340: bitstring));
                                                                    {2288}new Nc_2341: bitstring;
                                                                    {2289}let m1_2342: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2068,Nc_2341) in
                                                                    {2290}event beginCli(Cli,Sess,Nc_2341);
                                                                    {2291}out(c, (pkCli_2068,m1_2342));
                                                                    {2292}in(c, em2_2343: bitstring);
                                                                    {2293}let m2_2344: bitstring = em2_2343 in
                                                                    {2294}let (=OpenSecureChannelResponse,=Cli,Ns_2345: bitstring,ST_2346: bitstring,TTL_2347: bitstring) = m2_2344 in
                                                                    {2295}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                    {2296}event endCli(Sess,Cli,Ns_2345)
                                                        )
                                                        else
                                                            {2297}let pkSess_2348: bitstring = fail-any in
                                                            {2298}out(c, GetEndpointRequest);
                                                            {2299}in(c, (=GetEndpointResponse,=pkSess_2348,=None,SP_2349: bitstring,UP_2350: bitstring));
                                                            {2300}new Nc_2351: bitstring;
                                                            {2301}let m1_2352: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2068,Nc_2351) in
                                                            {2302}event beginCli(Cli,Sess,Nc_2351);
                                                            {2303}out(c, (pkCli_2068,m1_2352));
                                                            {2304}in(c, em2_2353: bitstring);
                                                            {2305}let m2_2354: bitstring = em2_2353 in
                                                            {2306}let (=OpenSecureChannelResponse,=Cli,Ns_2355: bitstring,ST_2356: bitstring,TTL_2357: bitstring) = m2_2354 in
                                                            {2307}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                            {2308}event endCli(Sess,Cli,Ns_2355)
                                                )
                                                else
                                                    {2309}let pkSess_2358: bitstring = fail-any in
                                                    {2310}out(c, GetEndpointRequest);
                                                    {2311}in(c, (=GetEndpointResponse,=pkSess_2358,=None,SP_2359: bitstring,UP_2360: bitstring));
                                                    {2312}new Nc_2361: bitstring;
                                                    {2313}let m1_2362: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2068,Nc_2361) in
                                                    {2314}event beginCli(Cli,Sess,Nc_2361);
                                                    {2315}out(c, (pkCli_2068,m1_2362));
                                                    {2316}in(c, em2_2363: bitstring);
                                                    {2317}let m2_2364: bitstring = em2_2363 in
                                                    {2318}let (=OpenSecureChannelResponse,=Cli,Ns_2365: bitstring,ST_2366: bitstring,TTL_2367: bitstring) = m2_2364 in
                                                    {2319}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {2320}event endCli(Sess,Cli,Ns_2365)
                                        )
                                        else
                                            {2321}let pkDisco_2368: bitstring = fail-any in
                                            {2322}let v_2369: bool = (Sess = A) in
                                            (
                                                {2323}if v_2369 then
                                                (
                                                    {2324}let pkSess_2370: bitstring = pub(skA) in
                                                    {2325}out(c, GetEndpointRequest);
                                                    {2326}in(c, (=GetEndpointResponse,=pkSess_2370,=None,SP_2371: bitstring,UP_2372: bitstring));
                                                    {2327}new Nc_2373: bitstring;
                                                    {2328}let m1_2374: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2068,Nc_2373) in
                                                    {2329}event beginCli(Cli,Sess,Nc_2373);
                                                    {2330}out(c, (pkCli_2068,m1_2374));
                                                    {2331}in(c, em2_2375: bitstring);
                                                    {2332}let m2_2376: bitstring = em2_2375 in
                                                    {2333}let (=OpenSecureChannelResponse,=Cli,Ns_2377: bitstring,ST_2378: bitstring,TTL_2379: bitstring) = m2_2376 in
                                                    {2334}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {2335}event endCli(Sess,Cli,Ns_2377)
                                                )
                                                else
                                                    {2336}let v_2380: bool = (Sess = B) in
                                                    (
                                                        {2337}if v_2380 then
                                                        (
                                                            {2338}let pkSess_2381: bitstring = pub(skB) in
                                                            {2339}out(c, GetEndpointRequest);
                                                            {2340}in(c, (=GetEndpointResponse,=pkSess_2381,=None,SP_2382: bitstring,UP_2383: bitstring));
                                                            {2341}new Nc_2384: bitstring;
                                                            {2342}let m1_2385: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2068,Nc_2384) in
                                                            {2343}event beginCli(Cli,Sess,Nc_2384);
                                                            {2344}out(c, (pkCli_2068,m1_2385));
                                                            {2345}in(c, em2_2386: bitstring);
                                                            {2346}let m2_2387: bitstring = em2_2386 in
                                                            {2347}let (=OpenSecureChannelResponse,=Cli,Ns_2388: bitstring,ST_2389: bitstring,TTL_2390: bitstring) = m2_2387 in
                                                            {2348}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                            {2349}event endCli(Sess,Cli,Ns_2388)
                                                        )
                                                        else
                                                            {2350}let v_2391: bool = (Sess = C) in
                                                            (
                                                                {2351}if v_2391 then
                                                                (
                                                                    {2352}let pkSess_2392: bitstring = pub(skC) in
                                                                    {2353}out(c, GetEndpointRequest);
                                                                    {2354}in(c, (=GetEndpointResponse,=pkSess_2392,=None,SP_2393: bitstring,UP_2394: bitstring));
                                                                    {2355}new Nc_2395: bitstring;
                                                                    {2356}let m1_2396: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2068,Nc_2395) in
                                                                    {2357}event beginCli(Cli,Sess,Nc_2395);
                                                                    {2358}out(c, (pkCli_2068,m1_2396));
                                                                    {2359}in(c, em2_2397: bitstring);
                                                                    {2360}let m2_2398: bitstring = em2_2397 in
                                                                    {2361}let (=OpenSecureChannelResponse,=Cli,Ns_2399: bitstring,ST_2400: bitstring,TTL_2401: bitstring) = m2_2398 in
                                                                    {2362}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                    {2363}event endCli(Sess,Cli,Ns_2399)
                                                                )
                                                                else
                                                                    {2364}let pkSess_2402: bitstring = pub(sk(Sess)) in
                                                                    {2365}out(c, GetEndpointRequest);
                                                                    {2366}in(c, (=GetEndpointResponse,=pkSess_2402,=None,SP_2403: bitstring,UP_2404: bitstring));
                                                                    {2367}new Nc_2405: bitstring;
                                                                    {2368}let m1_2406: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2068,Nc_2405) in
                                                                    {2369}event beginCli(Cli,Sess,Nc_2405);
                                                                    {2370}out(c, (pkCli_2068,m1_2406));
                                                                    {2371}in(c, em2_2407: bitstring);
                                                                    {2372}let m2_2408: bitstring = em2_2407 in
                                                                    {2373}let (=OpenSecureChannelResponse,=Cli,Ns_2409: bitstring,ST_2410: bitstring,TTL_2411: bitstring) = m2_2408 in
                                                                    {2374}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                    {2375}event endCli(Sess,Cli,Ns_2409)
                                                            )
                                                            else
                                                                {2376}let pkSess_2412: bitstring = fail-any in
                                                                {2377}out(c, GetEndpointRequest);
                                                                {2378}in(c, (=GetEndpointResponse,=pkSess_2412,=None,SP_2413: bitstring,UP_2414: bitstring));
                                                                {2379}new Nc_2415: bitstring;
                                                                {2380}let m1_2416: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2068,Nc_2415) in
                                                                {2381}event beginCli(Cli,Sess,Nc_2415);
                                                                {2382}out(c, (pkCli_2068,m1_2416));
                                                                {2383}in(c, em2_2417: bitstring);
                                                                {2384}let m2_2418: bitstring = em2_2417 in
                                                                {2385}let (=OpenSecureChannelResponse,=Cli,Ns_2419: bitstring,ST_2420: bitstring,TTL_2421: bitstring) = m2_2418 in
                                                                {2386}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                {2387}event endCli(Sess,Cli,Ns_2419)
                                                    )
                                                    else
                                                        {2388}let pkSess_2422: bitstring = fail-any in
                                                        {2389}out(c, GetEndpointRequest);
                                                        {2390}in(c, (=GetEndpointResponse,=pkSess_2422,=None,SP_2423: bitstring,UP_2424: bitstring));
                                                        {2391}new Nc_2425: bitstring;
                                                        {2392}let m1_2426: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2068,Nc_2425) in
                                                        {2393}event beginCli(Cli,Sess,Nc_2425);
                                                        {2394}out(c, (pkCli_2068,m1_2426));
                                                        {2395}in(c, em2_2427: bitstring);
                                                        {2396}let m2_2428: bitstring = em2_2427 in
                                                        {2397}let (=OpenSecureChannelResponse,=Cli,Ns_2429: bitstring,ST_2430: bitstring,TTL_2431: bitstring) = m2_2428 in
                                                        {2398}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {2399}event endCli(Sess,Cli,Ns_2429)
                                            )
                                            else
                                                {2400}let pkSess_2432: bitstring = fail-any in
                                                {2401}out(c, GetEndpointRequest);
                                                {2402}in(c, (=GetEndpointResponse,=pkSess_2432,=None,SP_2433: bitstring,UP_2434: bitstring));
                                                {2403}new Nc_2435: bitstring;
                                                {2404}let m1_2436: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2068,Nc_2435) in
                                                {2405}event beginCli(Cli,Sess,Nc_2435);
                                                {2406}out(c, (pkCli_2068,m1_2436));
                                                {2407}in(c, em2_2437: bitstring);
                                                {2408}let m2_2438: bitstring = em2_2437 in
                                                {2409}let (=OpenSecureChannelResponse,=Cli,Ns_2439: bitstring,ST_2440: bitstring,TTL_2441: bitstring) = m2_2438 in
                                                {2410}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {2411}event endCli(Sess,Cli,Ns_2439)
                                )
                                else
                                    {2412}let pkDisco_2442: bitstring = fail-any in
                                    {2413}let v_2443: bool = (Sess = A) in
                                    (
                                        {2414}if v_2443 then
                                        (
                                            {2415}let pkSess_2444: bitstring = pub(skA) in
                                            {2416}out(c, GetEndpointRequest);
                                            {2417}in(c, (=GetEndpointResponse,=pkSess_2444,=None,SP_2445: bitstring,UP_2446: bitstring));
                                            {2418}new Nc_2447: bitstring;
                                            {2419}let m1_2448: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2068,Nc_2447) in
                                            {2420}event beginCli(Cli,Sess,Nc_2447);
                                            {2421}out(c, (pkCli_2068,m1_2448));
                                            {2422}in(c, em2_2449: bitstring);
                                            {2423}let m2_2450: bitstring = em2_2449 in
                                            {2424}let (=OpenSecureChannelResponse,=Cli,Ns_2451: bitstring,ST_2452: bitstring,TTL_2453: bitstring) = m2_2450 in
                                            {2425}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {2426}event endCli(Sess,Cli,Ns_2451)
                                        )
                                        else
                                            {2427}let v_2454: bool = (Sess = B) in
                                            (
                                                {2428}if v_2454 then
                                                (
                                                    {2429}let pkSess_2455: bitstring = pub(skB) in
                                                    {2430}out(c, GetEndpointRequest);
                                                    {2431}in(c, (=GetEndpointResponse,=pkSess_2455,=None,SP_2456: bitstring,UP_2457: bitstring));
                                                    {2432}new Nc_2458: bitstring;
                                                    {2433}let m1_2459: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2068,Nc_2458) in
                                                    {2434}event beginCli(Cli,Sess,Nc_2458);
                                                    {2435}out(c, (pkCli_2068,m1_2459));
                                                    {2436}in(c, em2_2460: bitstring);
                                                    {2437}let m2_2461: bitstring = em2_2460 in
                                                    {2438}let (=OpenSecureChannelResponse,=Cli,Ns_2462: bitstring,ST_2463: bitstring,TTL_2464: bitstring) = m2_2461 in
                                                    {2439}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {2440}event endCli(Sess,Cli,Ns_2462)
                                                )
                                                else
                                                    {2441}let v_2465: bool = (Sess = C) in
                                                    (
                                                        {2442}if v_2465 then
                                                        (
                                                            {2443}let pkSess_2466: bitstring = pub(skC) in
                                                            {2444}out(c, GetEndpointRequest);
                                                            {2445}in(c, (=GetEndpointResponse,=pkSess_2466,=None,SP_2467: bitstring,UP_2468: bitstring));
                                                            {2446}new Nc_2469: bitstring;
                                                            {2447}let m1_2470: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2068,Nc_2469) in
                                                            {2448}event beginCli(Cli,Sess,Nc_2469);
                                                            {2449}out(c, (pkCli_2068,m1_2470));
                                                            {2450}in(c, em2_2471: bitstring);
                                                            {2451}let m2_2472: bitstring = em2_2471 in
                                                            {2452}let (=OpenSecureChannelResponse,=Cli,Ns_2473: bitstring,ST_2474: bitstring,TTL_2475: bitstring) = m2_2472 in
                                                            {2453}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                            {2454}event endCli(Sess,Cli,Ns_2473)
                                                        )
                                                        else
                                                            {2455}let pkSess_2476: bitstring = pub(sk(Sess)) in
                                                            {2456}out(c, GetEndpointRequest);
                                                            {2457}in(c, (=GetEndpointResponse,=pkSess_2476,=None,SP_2477: bitstring,UP_2478: bitstring));
                                                            {2458}new Nc_2479: bitstring;
                                                            {2459}let m1_2480: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2068,Nc_2479) in
                                                            {2460}event beginCli(Cli,Sess,Nc_2479);
                                                            {2461}out(c, (pkCli_2068,m1_2480));
                                                            {2462}in(c, em2_2481: bitstring);
                                                            {2463}let m2_2482: bitstring = em2_2481 in
                                                            {2464}let (=OpenSecureChannelResponse,=Cli,Ns_2483: bitstring,ST_2484: bitstring,TTL_2485: bitstring) = m2_2482 in
                                                            {2465}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                            {2466}event endCli(Sess,Cli,Ns_2483)
                                                    )
                                                    else
                                                        {2467}let pkSess_2486: bitstring = fail-any in
                                                        {2468}out(c, GetEndpointRequest);
                                                        {2469}in(c, (=GetEndpointResponse,=pkSess_2486,=None,SP_2487: bitstring,UP_2488: bitstring));
                                                        {2470}new Nc_2489: bitstring;
                                                        {2471}let m1_2490: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2068,Nc_2489) in
                                                        {2472}event beginCli(Cli,Sess,Nc_2489);
                                                        {2473}out(c, (pkCli_2068,m1_2490));
                                                        {2474}in(c, em2_2491: bitstring);
                                                        {2475}let m2_2492: bitstring = em2_2491 in
                                                        {2476}let (=OpenSecureChannelResponse,=Cli,Ns_2493: bitstring,ST_2494: bitstring,TTL_2495: bitstring) = m2_2492 in
                                                        {2477}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {2478}event endCli(Sess,Cli,Ns_2493)
                                            )
                                            else
                                                {2479}let pkSess_2496: bitstring = fail-any in
                                                {2480}out(c, GetEndpointRequest);
                                                {2481}in(c, (=GetEndpointResponse,=pkSess_2496,=None,SP_2497: bitstring,UP_2498: bitstring));
                                                {2482}new Nc_2499: bitstring;
                                                {2483}let m1_2500: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2068,Nc_2499) in
                                                {2484}event beginCli(Cli,Sess,Nc_2499);
                                                {2485}out(c, (pkCli_2068,m1_2500));
                                                {2486}in(c, em2_2501: bitstring);
                                                {2487}let m2_2502: bitstring = em2_2501 in
                                                {2488}let (=OpenSecureChannelResponse,=Cli,Ns_2503: bitstring,ST_2504: bitstring,TTL_2505: bitstring) = m2_2502 in
                                                {2489}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {2490}event endCli(Sess,Cli,Ns_2503)
                                    )
                                    else
                                        {2491}let pkSess_2506: bitstring = fail-any in
                                        {2492}out(c, GetEndpointRequest);
                                        {2493}in(c, (=GetEndpointResponse,=pkSess_2506,=None,SP_2507: bitstring,UP_2508: bitstring));
                                        {2494}new Nc_2509: bitstring;
                                        {2495}let m1_2510: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2068,Nc_2509) in
                                        {2496}event beginCli(Cli,Sess,Nc_2509);
                                        {2497}out(c, (pkCli_2068,m1_2510));
                                        {2498}in(c, em2_2511: bitstring);
                                        {2499}let m2_2512: bitstring = em2_2511 in
                                        {2500}let (=OpenSecureChannelResponse,=Cli,Ns_2513: bitstring,ST_2514: bitstring,TTL_2515: bitstring) = m2_2512 in
                                        {2501}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                        {2502}event endCli(Sess,Cli,Ns_2513)
                        )
                        else
                            {2503}let pkDisco_2516: bitstring = fail-any in
                            {2504}let v_2517: bool = (Sess = A) in
                            (
                                {2505}if v_2517 then
                                (
                                    {2506}let pkSess_2518: bitstring = pub(skA) in
                                    {2507}out(c, GetEndpointRequest);
                                    {2508}in(c, (=GetEndpointResponse,=pkSess_2518,=None,SP_2519: bitstring,UP_2520: bitstring));
                                    {2509}new Nc_2521: bitstring;
                                    {2510}let m1_2522: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2068,Nc_2521) in
                                    {2511}event beginCli(Cli,Sess,Nc_2521);
                                    {2512}out(c, (pkCli_2068,m1_2522));
                                    {2513}in(c, em2_2523: bitstring);
                                    {2514}let m2_2524: bitstring = em2_2523 in
                                    {2515}let (=OpenSecureChannelResponse,=Cli,Ns_2525: bitstring,ST_2526: bitstring,TTL_2527: bitstring) = m2_2524 in
                                    {2516}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                    {2517}event endCli(Sess,Cli,Ns_2525)
                                )
                                else
                                    {2518}let v_2528: bool = (Sess = B) in
                                    (
                                        {2519}if v_2528 then
                                        (
                                            {2520}let pkSess_2529: bitstring = pub(skB) in
                                            {2521}out(c, GetEndpointRequest);
                                            {2522}in(c, (=GetEndpointResponse,=pkSess_2529,=None,SP_2530: bitstring,UP_2531: bitstring));
                                            {2523}new Nc_2532: bitstring;
                                            {2524}let m1_2533: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2068,Nc_2532) in
                                            {2525}event beginCli(Cli,Sess,Nc_2532);
                                            {2526}out(c, (pkCli_2068,m1_2533));
                                            {2527}in(c, em2_2534: bitstring);
                                            {2528}let m2_2535: bitstring = em2_2534 in
                                            {2529}let (=OpenSecureChannelResponse,=Cli,Ns_2536: bitstring,ST_2537: bitstring,TTL_2538: bitstring) = m2_2535 in
                                            {2530}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {2531}event endCli(Sess,Cli,Ns_2536)
                                        )
                                        else
                                            {2532}let v_2539: bool = (Sess = C) in
                                            (
                                                {2533}if v_2539 then
                                                (
                                                    {2534}let pkSess_2540: bitstring = pub(skC) in
                                                    {2535}out(c, GetEndpointRequest);
                                                    {2536}in(c, (=GetEndpointResponse,=pkSess_2540,=None,SP_2541: bitstring,UP_2542: bitstring));
                                                    {2537}new Nc_2543: bitstring;
                                                    {2538}let m1_2544: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2068,Nc_2543) in
                                                    {2539}event beginCli(Cli,Sess,Nc_2543);
                                                    {2540}out(c, (pkCli_2068,m1_2544));
                                                    {2541}in(c, em2_2545: bitstring);
                                                    {2542}let m2_2546: bitstring = em2_2545 in
                                                    {2543}let (=OpenSecureChannelResponse,=Cli,Ns_2547: bitstring,ST_2548: bitstring,TTL_2549: bitstring) = m2_2546 in
                                                    {2544}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {2545}event endCli(Sess,Cli,Ns_2547)
                                                )
                                                else
                                                    {2546}let pkSess_2550: bitstring = pub(sk(Sess)) in
                                                    {2547}out(c, GetEndpointRequest);
                                                    {2548}in(c, (=GetEndpointResponse,=pkSess_2550,=None,SP_2551: bitstring,UP_2552: bitstring));
                                                    {2549}new Nc_2553: bitstring;
                                                    {2550}let m1_2554: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2068,Nc_2553) in
                                                    {2551}event beginCli(Cli,Sess,Nc_2553);
                                                    {2552}out(c, (pkCli_2068,m1_2554));
                                                    {2553}in(c, em2_2555: bitstring);
                                                    {2554}let m2_2556: bitstring = em2_2555 in
                                                    {2555}let (=OpenSecureChannelResponse,=Cli,Ns_2557: bitstring,ST_2558: bitstring,TTL_2559: bitstring) = m2_2556 in
                                                    {2556}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {2557}event endCli(Sess,Cli,Ns_2557)
                                            )
                                            else
                                                {2558}let pkSess_2560: bitstring = fail-any in
                                                {2559}out(c, GetEndpointRequest);
                                                {2560}in(c, (=GetEndpointResponse,=pkSess_2560,=None,SP_2561: bitstring,UP_2562: bitstring));
                                                {2561}new Nc_2563: bitstring;
                                                {2562}let m1_2564: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2068,Nc_2563) in
                                                {2563}event beginCli(Cli,Sess,Nc_2563);
                                                {2564}out(c, (pkCli_2068,m1_2564));
                                                {2565}in(c, em2_2565: bitstring);
                                                {2566}let m2_2566: bitstring = em2_2565 in
                                                {2567}let (=OpenSecureChannelResponse,=Cli,Ns_2567: bitstring,ST_2568: bitstring,TTL_2569: bitstring) = m2_2566 in
                                                {2568}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {2569}event endCli(Sess,Cli,Ns_2567)
                                    )
                                    else
                                        {2570}let pkSess_2570: bitstring = fail-any in
                                        {2571}out(c, GetEndpointRequest);
                                        {2572}in(c, (=GetEndpointResponse,=pkSess_2570,=None,SP_2571: bitstring,UP_2572: bitstring));
                                        {2573}new Nc_2573: bitstring;
                                        {2574}let m1_2574: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2068,Nc_2573) in
                                        {2575}event beginCli(Cli,Sess,Nc_2573);
                                        {2576}out(c, (pkCli_2068,m1_2574));
                                        {2577}in(c, em2_2575: bitstring);
                                        {2578}let m2_2576: bitstring = em2_2575 in
                                        {2579}let (=OpenSecureChannelResponse,=Cli,Ns_2577: bitstring,ST_2578: bitstring,TTL_2579: bitstring) = m2_2576 in
                                        {2580}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                        {2581}event endCli(Sess,Cli,Ns_2577)
                            )
                            else
                                {2582}let pkSess_2580: bitstring = fail-any in
                                {2583}out(c, GetEndpointRequest);
                                {2584}in(c, (=GetEndpointResponse,=pkSess_2580,=None,SP_2581: bitstring,UP_2582: bitstring));
                                {2585}new Nc_2583: bitstring;
                                {2586}let m1_2584: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2068,Nc_2583) in
                                {2587}event beginCli(Cli,Sess,Nc_2583);
                                {2588}out(c, (pkCli_2068,m1_2584));
                                {2589}in(c, em2_2585: bitstring);
                                {2590}let m2_2586: bitstring = em2_2585 in
                                {2591}let (=OpenSecureChannelResponse,=Cli,Ns_2587: bitstring,ST_2588: bitstring,TTL_2589: bitstring) = m2_2586 in
                                {2592}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                {2593}event endCli(Sess,Cli,Ns_2587)
            )
            else
                {2594}let skCli_2590: bitstring = fail-any in
                {2595}let pkCli_2591: bitstring = pub(skCli_2590) in
                {2596}let v_2592: bool = (Disco = A) in
                (
                    {2597}if v_2592 then
                    (
                        {2598}let pkDisco_2593: bitstring = pub(skA) in
                        {2599}let v_2594: bool = (Sess = A) in
                        (
                            {2600}if v_2594 then
                            (
                                {2601}let pkSess_2595: bitstring = pub(skA) in
                                {2602}out(c, GetEndpointRequest);
                                {2603}in(c, (=GetEndpointResponse,=pkSess_2595,=None,SP_2596: bitstring,UP_2597: bitstring));
                                {2604}new Nc_2598: bitstring;
                                {2605}let m1_2599: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2591,Nc_2598) in
                                {2606}event beginCli(Cli,Sess,Nc_2598);
                                {2607}out(c, (pkCli_2591,m1_2599));
                                {2608}in(c, em2_2600: bitstring);
                                {2609}let m2_2601: bitstring = em2_2600 in
                                {2610}let (=OpenSecureChannelResponse,=Cli,Ns_2602: bitstring,ST_2603: bitstring,TTL_2604: bitstring) = m2_2601 in
                                {2611}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                {2612}event endCli(Sess,Cli,Ns_2602)
                            )
                            else
                                {2613}let v_2605: bool = (Sess = B) in
                                (
                                    {2614}if v_2605 then
                                    (
                                        {2615}let pkSess_2606: bitstring = pub(skB) in
                                        {2616}out(c, GetEndpointRequest);
                                        {2617}in(c, (=GetEndpointResponse,=pkSess_2606,=None,SP_2607: bitstring,UP_2608: bitstring));
                                        {2618}new Nc_2609: bitstring;
                                        {2619}let m1_2610: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2591,Nc_2609) in
                                        {2620}event beginCli(Cli,Sess,Nc_2609);
                                        {2621}out(c, (pkCli_2591,m1_2610));
                                        {2622}in(c, em2_2611: bitstring);
                                        {2623}let m2_2612: bitstring = em2_2611 in
                                        {2624}let (=OpenSecureChannelResponse,=Cli,Ns_2613: bitstring,ST_2614: bitstring,TTL_2615: bitstring) = m2_2612 in
                                        {2625}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                        {2626}event endCli(Sess,Cli,Ns_2613)
                                    )
                                    else
                                        {2627}let v_2616: bool = (Sess = C) in
                                        (
                                            {2628}if v_2616 then
                                            (
                                                {2629}let pkSess_2617: bitstring = pub(skC) in
                                                {2630}out(c, GetEndpointRequest);
                                                {2631}in(c, (=GetEndpointResponse,=pkSess_2617,=None,SP_2618: bitstring,UP_2619: bitstring));
                                                {2632}new Nc_2620: bitstring;
                                                {2633}let m1_2621: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2591,Nc_2620) in
                                                {2634}event beginCli(Cli,Sess,Nc_2620);
                                                {2635}out(c, (pkCli_2591,m1_2621));
                                                {2636}in(c, em2_2622: bitstring);
                                                {2637}let m2_2623: bitstring = em2_2622 in
                                                {2638}let (=OpenSecureChannelResponse,=Cli,Ns_2624: bitstring,ST_2625: bitstring,TTL_2626: bitstring) = m2_2623 in
                                                {2639}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {2640}event endCli(Sess,Cli,Ns_2624)
                                            )
                                            else
                                                {2641}let pkSess_2627: bitstring = pub(sk(Sess)) in
                                                {2642}out(c, GetEndpointRequest);
                                                {2643}in(c, (=GetEndpointResponse,=pkSess_2627,=None,SP_2628: bitstring,UP_2629: bitstring));
                                                {2644}new Nc_2630: bitstring;
                                                {2645}let m1_2631: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2591,Nc_2630) in
                                                {2646}event beginCli(Cli,Sess,Nc_2630);
                                                {2647}out(c, (pkCli_2591,m1_2631));
                                                {2648}in(c, em2_2632: bitstring);
                                                {2649}let m2_2633: bitstring = em2_2632 in
                                                {2650}let (=OpenSecureChannelResponse,=Cli,Ns_2634: bitstring,ST_2635: bitstring,TTL_2636: bitstring) = m2_2633 in
                                                {2651}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {2652}event endCli(Sess,Cli,Ns_2634)
                                        )
                                        else
                                            {2653}let pkSess_2637: bitstring = fail-any in
                                            {2654}out(c, GetEndpointRequest);
                                            {2655}in(c, (=GetEndpointResponse,=pkSess_2637,=None,SP_2638: bitstring,UP_2639: bitstring));
                                            {2656}new Nc_2640: bitstring;
                                            {2657}let m1_2641: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2591,Nc_2640) in
                                            {2658}event beginCli(Cli,Sess,Nc_2640);
                                            {2659}out(c, (pkCli_2591,m1_2641));
                                            {2660}in(c, em2_2642: bitstring);
                                            {2661}let m2_2643: bitstring = em2_2642 in
                                            {2662}let (=OpenSecureChannelResponse,=Cli,Ns_2644: bitstring,ST_2645: bitstring,TTL_2646: bitstring) = m2_2643 in
                                            {2663}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {2664}event endCli(Sess,Cli,Ns_2644)
                                )
                                else
                                    {2665}let pkSess_2647: bitstring = fail-any in
                                    {2666}out(c, GetEndpointRequest);
                                    {2667}in(c, (=GetEndpointResponse,=pkSess_2647,=None,SP_2648: bitstring,UP_2649: bitstring));
                                    {2668}new Nc_2650: bitstring;
                                    {2669}let m1_2651: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2591,Nc_2650) in
                                    {2670}event beginCli(Cli,Sess,Nc_2650);
                                    {2671}out(c, (pkCli_2591,m1_2651));
                                    {2672}in(c, em2_2652: bitstring);
                                    {2673}let m2_2653: bitstring = em2_2652 in
                                    {2674}let (=OpenSecureChannelResponse,=Cli,Ns_2654: bitstring,ST_2655: bitstring,TTL_2656: bitstring) = m2_2653 in
                                    {2675}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                    {2676}event endCli(Sess,Cli,Ns_2654)
                        )
                        else
                            {2677}let pkSess_2657: bitstring = fail-any in
                            {2678}out(c, GetEndpointRequest);
                            {2679}in(c, (=GetEndpointResponse,=pkSess_2657,=None,SP_2658: bitstring,UP_2659: bitstring));
                            {2680}new Nc_2660: bitstring;
                            {2681}let m1_2661: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2591,Nc_2660) in
                            {2682}event beginCli(Cli,Sess,Nc_2660);
                            {2683}out(c, (pkCli_2591,m1_2661));
                            {2684}in(c, em2_2662: bitstring);
                            {2685}let m2_2663: bitstring = em2_2662 in
                            {2686}let (=OpenSecureChannelResponse,=Cli,Ns_2664: bitstring,ST_2665: bitstring,TTL_2666: bitstring) = m2_2663 in
                            {2687}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                            {2688}event endCli(Sess,Cli,Ns_2664)
                    )
                    else
                        {2689}let v_2667: bool = (Disco = B) in
                        (
                            {2690}if v_2667 then
                            (
                                {2691}let pkDisco_2668: bitstring = pub(skB) in
                                {2692}let v_2669: bool = (Sess = A) in
                                (
                                    {2693}if v_2669 then
                                    (
                                        {2694}let pkSess_2670: bitstring = pub(skA) in
                                        {2695}out(c, GetEndpointRequest);
                                        {2696}in(c, (=GetEndpointResponse,=pkSess_2670,=None,SP_2671: bitstring,UP_2672: bitstring));
                                        {2697}new Nc_2673: bitstring;
                                        {2698}let m1_2674: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2591,Nc_2673) in
                                        {2699}event beginCli(Cli,Sess,Nc_2673);
                                        {2700}out(c, (pkCli_2591,m1_2674));
                                        {2701}in(c, em2_2675: bitstring);
                                        {2702}let m2_2676: bitstring = em2_2675 in
                                        {2703}let (=OpenSecureChannelResponse,=Cli,Ns_2677: bitstring,ST_2678: bitstring,TTL_2679: bitstring) = m2_2676 in
                                        {2704}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                        {2705}event endCli(Sess,Cli,Ns_2677)
                                    )
                                    else
                                        {2706}let v_2680: bool = (Sess = B) in
                                        (
                                            {2707}if v_2680 then
                                            (
                                                {2708}let pkSess_2681: bitstring = pub(skB) in
                                                {2709}out(c, GetEndpointRequest);
                                                {2710}in(c, (=GetEndpointResponse,=pkSess_2681,=None,SP_2682: bitstring,UP_2683: bitstring));
                                                {2711}new Nc_2684: bitstring;
                                                {2712}let m1_2685: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2591,Nc_2684) in
                                                {2713}event beginCli(Cli,Sess,Nc_2684);
                                                {2714}out(c, (pkCli_2591,m1_2685));
                                                {2715}in(c, em2_2686: bitstring);
                                                {2716}let m2_2687: bitstring = em2_2686 in
                                                {2717}let (=OpenSecureChannelResponse,=Cli,Ns_2688: bitstring,ST_2689: bitstring,TTL_2690: bitstring) = m2_2687 in
                                                {2718}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {2719}event endCli(Sess,Cli,Ns_2688)
                                            )
                                            else
                                                {2720}let v_2691: bool = (Sess = C) in
                                                (
                                                    {2721}if v_2691 then
                                                    (
                                                        {2722}let pkSess_2692: bitstring = pub(skC) in
                                                        {2723}out(c, GetEndpointRequest);
                                                        {2724}in(c, (=GetEndpointResponse,=pkSess_2692,=None,SP_2693: bitstring,UP_2694: bitstring));
                                                        {2725}new Nc_2695: bitstring;
                                                        {2726}let m1_2696: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2591,Nc_2695) in
                                                        {2727}event beginCli(Cli,Sess,Nc_2695);
                                                        {2728}out(c, (pkCli_2591,m1_2696));
                                                        {2729}in(c, em2_2697: bitstring);
                                                        {2730}let m2_2698: bitstring = em2_2697 in
                                                        {2731}let (=OpenSecureChannelResponse,=Cli,Ns_2699: bitstring,ST_2700: bitstring,TTL_2701: bitstring) = m2_2698 in
                                                        {2732}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {2733}event endCli(Sess,Cli,Ns_2699)
                                                    )
                                                    else
                                                        {2734}let pkSess_2702: bitstring = pub(sk(Sess)) in
                                                        {2735}out(c, GetEndpointRequest);
                                                        {2736}in(c, (=GetEndpointResponse,=pkSess_2702,=None,SP_2703: bitstring,UP_2704: bitstring));
                                                        {2737}new Nc_2705: bitstring;
                                                        {2738}let m1_2706: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2591,Nc_2705) in
                                                        {2739}event beginCli(Cli,Sess,Nc_2705);
                                                        {2740}out(c, (pkCli_2591,m1_2706));
                                                        {2741}in(c, em2_2707: bitstring);
                                                        {2742}let m2_2708: bitstring = em2_2707 in
                                                        {2743}let (=OpenSecureChannelResponse,=Cli,Ns_2709: bitstring,ST_2710: bitstring,TTL_2711: bitstring) = m2_2708 in
                                                        {2744}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {2745}event endCli(Sess,Cli,Ns_2709)
                                                )
                                                else
                                                    {2746}let pkSess_2712: bitstring = fail-any in
                                                    {2747}out(c, GetEndpointRequest);
                                                    {2748}in(c, (=GetEndpointResponse,=pkSess_2712,=None,SP_2713: bitstring,UP_2714: bitstring));
                                                    {2749}new Nc_2715: bitstring;
                                                    {2750}let m1_2716: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2591,Nc_2715) in
                                                    {2751}event beginCli(Cli,Sess,Nc_2715);
                                                    {2752}out(c, (pkCli_2591,m1_2716));
                                                    {2753}in(c, em2_2717: bitstring);
                                                    {2754}let m2_2718: bitstring = em2_2717 in
                                                    {2755}let (=OpenSecureChannelResponse,=Cli,Ns_2719: bitstring,ST_2720: bitstring,TTL_2721: bitstring) = m2_2718 in
                                                    {2756}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {2757}event endCli(Sess,Cli,Ns_2719)
                                        )
                                        else
                                            {2758}let pkSess_2722: bitstring = fail-any in
                                            {2759}out(c, GetEndpointRequest);
                                            {2760}in(c, (=GetEndpointResponse,=pkSess_2722,=None,SP_2723: bitstring,UP_2724: bitstring));
                                            {2761}new Nc_2725: bitstring;
                                            {2762}let m1_2726: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2591,Nc_2725) in
                                            {2763}event beginCli(Cli,Sess,Nc_2725);
                                            {2764}out(c, (pkCli_2591,m1_2726));
                                            {2765}in(c, em2_2727: bitstring);
                                            {2766}let m2_2728: bitstring = em2_2727 in
                                            {2767}let (=OpenSecureChannelResponse,=Cli,Ns_2729: bitstring,ST_2730: bitstring,TTL_2731: bitstring) = m2_2728 in
                                            {2768}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {2769}event endCli(Sess,Cli,Ns_2729)
                                )
                                else
                                    {2770}let pkSess_2732: bitstring = fail-any in
                                    {2771}out(c, GetEndpointRequest);
                                    {2772}in(c, (=GetEndpointResponse,=pkSess_2732,=None,SP_2733: bitstring,UP_2734: bitstring));
                                    {2773}new Nc_2735: bitstring;
                                    {2774}let m1_2736: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2591,Nc_2735) in
                                    {2775}event beginCli(Cli,Sess,Nc_2735);
                                    {2776}out(c, (pkCli_2591,m1_2736));
                                    {2777}in(c, em2_2737: bitstring);
                                    {2778}let m2_2738: bitstring = em2_2737 in
                                    {2779}let (=OpenSecureChannelResponse,=Cli,Ns_2739: bitstring,ST_2740: bitstring,TTL_2741: bitstring) = m2_2738 in
                                    {2780}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                    {2781}event endCli(Sess,Cli,Ns_2739)
                            )
                            else
                                {2782}let v_2742: bool = (Disco = C) in
                                (
                                    {2783}if v_2742 then
                                    (
                                        {2784}let pkDisco_2743: bitstring = pub(skC) in
                                        {2785}let v_2744: bool = (Sess = A) in
                                        (
                                            {2786}if v_2744 then
                                            (
                                                {2787}let pkSess_2745: bitstring = pub(skA) in
                                                {2788}out(c, GetEndpointRequest);
                                                {2789}in(c, (=GetEndpointResponse,=pkSess_2745,=None,SP_2746: bitstring,UP_2747: bitstring));
                                                {2790}new Nc_2748: bitstring;
                                                {2791}let m1_2749: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2591,Nc_2748) in
                                                {2792}event beginCli(Cli,Sess,Nc_2748);
                                                {2793}out(c, (pkCli_2591,m1_2749));
                                                {2794}in(c, em2_2750: bitstring);
                                                {2795}let m2_2751: bitstring = em2_2750 in
                                                {2796}let (=OpenSecureChannelResponse,=Cli,Ns_2752: bitstring,ST_2753: bitstring,TTL_2754: bitstring) = m2_2751 in
                                                {2797}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {2798}event endCli(Sess,Cli,Ns_2752)
                                            )
                                            else
                                                {2799}let v_2755: bool = (Sess = B) in
                                                (
                                                    {2800}if v_2755 then
                                                    (
                                                        {2801}let pkSess_2756: bitstring = pub(skB) in
                                                        {2802}out(c, GetEndpointRequest);
                                                        {2803}in(c, (=GetEndpointResponse,=pkSess_2756,=None,SP_2757: bitstring,UP_2758: bitstring));
                                                        {2804}new Nc_2759: bitstring;
                                                        {2805}let m1_2760: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2591,Nc_2759) in
                                                        {2806}event beginCli(Cli,Sess,Nc_2759);
                                                        {2807}out(c, (pkCli_2591,m1_2760));
                                                        {2808}in(c, em2_2761: bitstring);
                                                        {2809}let m2_2762: bitstring = em2_2761 in
                                                        {2810}let (=OpenSecureChannelResponse,=Cli,Ns_2763: bitstring,ST_2764: bitstring,TTL_2765: bitstring) = m2_2762 in
                                                        {2811}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {2812}event endCli(Sess,Cli,Ns_2763)
                                                    )
                                                    else
                                                        {2813}let v_2766: bool = (Sess = C) in
                                                        (
                                                            {2814}if v_2766 then
                                                            (
                                                                {2815}let pkSess_2767: bitstring = pub(skC) in
                                                                {2816}out(c, GetEndpointRequest);
                                                                {2817}in(c, (=GetEndpointResponse,=pkSess_2767,=None,SP_2768: bitstring,UP_2769: bitstring));
                                                                {2818}new Nc_2770: bitstring;
                                                                {2819}let m1_2771: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2591,Nc_2770) in
                                                                {2820}event beginCli(Cli,Sess,Nc_2770);
                                                                {2821}out(c, (pkCli_2591,m1_2771));
                                                                {2822}in(c, em2_2772: bitstring);
                                                                {2823}let m2_2773: bitstring = em2_2772 in
                                                                {2824}let (=OpenSecureChannelResponse,=Cli,Ns_2774: bitstring,ST_2775: bitstring,TTL_2776: bitstring) = m2_2773 in
                                                                {2825}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                {2826}event endCli(Sess,Cli,Ns_2774)
                                                            )
                                                            else
                                                                {2827}let pkSess_2777: bitstring = pub(sk(Sess)) in
                                                                {2828}out(c, GetEndpointRequest);
                                                                {2829}in(c, (=GetEndpointResponse,=pkSess_2777,=None,SP_2778: bitstring,UP_2779: bitstring));
                                                                {2830}new Nc_2780: bitstring;
                                                                {2831}let m1_2781: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2591,Nc_2780) in
                                                                {2832}event beginCli(Cli,Sess,Nc_2780);
                                                                {2833}out(c, (pkCli_2591,m1_2781));
                                                                {2834}in(c, em2_2782: bitstring);
                                                                {2835}let m2_2783: bitstring = em2_2782 in
                                                                {2836}let (=OpenSecureChannelResponse,=Cli,Ns_2784: bitstring,ST_2785: bitstring,TTL_2786: bitstring) = m2_2783 in
                                                                {2837}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                {2838}event endCli(Sess,Cli,Ns_2784)
                                                        )
                                                        else
                                                            {2839}let pkSess_2787: bitstring = fail-any in
                                                            {2840}out(c, GetEndpointRequest);
                                                            {2841}in(c, (=GetEndpointResponse,=pkSess_2787,=None,SP_2788: bitstring,UP_2789: bitstring));
                                                            {2842}new Nc_2790: bitstring;
                                                            {2843}let m1_2791: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2591,Nc_2790) in
                                                            {2844}event beginCli(Cli,Sess,Nc_2790);
                                                            {2845}out(c, (pkCli_2591,m1_2791));
                                                            {2846}in(c, em2_2792: bitstring);
                                                            {2847}let m2_2793: bitstring = em2_2792 in
                                                            {2848}let (=OpenSecureChannelResponse,=Cli,Ns_2794: bitstring,ST_2795: bitstring,TTL_2796: bitstring) = m2_2793 in
                                                            {2849}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                            {2850}event endCli(Sess,Cli,Ns_2794)
                                                )
                                                else
                                                    {2851}let pkSess_2797: bitstring = fail-any in
                                                    {2852}out(c, GetEndpointRequest);
                                                    {2853}in(c, (=GetEndpointResponse,=pkSess_2797,=None,SP_2798: bitstring,UP_2799: bitstring));
                                                    {2854}new Nc_2800: bitstring;
                                                    {2855}let m1_2801: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2591,Nc_2800) in
                                                    {2856}event beginCli(Cli,Sess,Nc_2800);
                                                    {2857}out(c, (pkCli_2591,m1_2801));
                                                    {2858}in(c, em2_2802: bitstring);
                                                    {2859}let m2_2803: bitstring = em2_2802 in
                                                    {2860}let (=OpenSecureChannelResponse,=Cli,Ns_2804: bitstring,ST_2805: bitstring,TTL_2806: bitstring) = m2_2803 in
                                                    {2861}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {2862}event endCli(Sess,Cli,Ns_2804)
                                        )
                                        else
                                            {2863}let pkSess_2807: bitstring = fail-any in
                                            {2864}out(c, GetEndpointRequest);
                                            {2865}in(c, (=GetEndpointResponse,=pkSess_2807,=None,SP_2808: bitstring,UP_2809: bitstring));
                                            {2866}new Nc_2810: bitstring;
                                            {2867}let m1_2811: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2591,Nc_2810) in
                                            {2868}event beginCli(Cli,Sess,Nc_2810);
                                            {2869}out(c, (pkCli_2591,m1_2811));
                                            {2870}in(c, em2_2812: bitstring);
                                            {2871}let m2_2813: bitstring = em2_2812 in
                                            {2872}let (=OpenSecureChannelResponse,=Cli,Ns_2814: bitstring,ST_2815: bitstring,TTL_2816: bitstring) = m2_2813 in
                                            {2873}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {2874}event endCli(Sess,Cli,Ns_2814)
                                    )
                                    else
                                        {2875}let pkDisco_2817: bitstring = pub(sk(Disco)) in
                                        {2876}let v_2818: bool = (Sess = A) in
                                        (
                                            {2877}if v_2818 then
                                            (
                                                {2878}let pkSess_2819: bitstring = pub(skA) in
                                                {2879}out(c, GetEndpointRequest);
                                                {2880}in(c, (=GetEndpointResponse,=pkSess_2819,=None,SP_2820: bitstring,UP_2821: bitstring));
                                                {2881}new Nc_2822: bitstring;
                                                {2882}let m1_2823: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2591,Nc_2822) in
                                                {2883}event beginCli(Cli,Sess,Nc_2822);
                                                {2884}out(c, (pkCli_2591,m1_2823));
                                                {2885}in(c, em2_2824: bitstring);
                                                {2886}let m2_2825: bitstring = em2_2824 in
                                                {2887}let (=OpenSecureChannelResponse,=Cli,Ns_2826: bitstring,ST_2827: bitstring,TTL_2828: bitstring) = m2_2825 in
                                                {2888}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {2889}event endCli(Sess,Cli,Ns_2826)
                                            )
                                            else
                                                {2890}let v_2829: bool = (Sess = B) in
                                                (
                                                    {2891}if v_2829 then
                                                    (
                                                        {2892}let pkSess_2830: bitstring = pub(skB) in
                                                        {2893}out(c, GetEndpointRequest);
                                                        {2894}in(c, (=GetEndpointResponse,=pkSess_2830,=None,SP_2831: bitstring,UP_2832: bitstring));
                                                        {2895}new Nc_2833: bitstring;
                                                        {2896}let m1_2834: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2591,Nc_2833) in
                                                        {2897}event beginCli(Cli,Sess,Nc_2833);
                                                        {2898}out(c, (pkCli_2591,m1_2834));
                                                        {2899}in(c, em2_2835: bitstring);
                                                        {2900}let m2_2836: bitstring = em2_2835 in
                                                        {2901}let (=OpenSecureChannelResponse,=Cli,Ns_2837: bitstring,ST_2838: bitstring,TTL_2839: bitstring) = m2_2836 in
                                                        {2902}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {2903}event endCli(Sess,Cli,Ns_2837)
                                                    )
                                                    else
                                                        {2904}let v_2840: bool = (Sess = C) in
                                                        (
                                                            {2905}if v_2840 then
                                                            (
                                                                {2906}let pkSess_2841: bitstring = pub(skC) in
                                                                {2907}out(c, GetEndpointRequest);
                                                                {2908}in(c, (=GetEndpointResponse,=pkSess_2841,=None,SP_2842: bitstring,UP_2843: bitstring));
                                                                {2909}new Nc_2844: bitstring;
                                                                {2910}let m1_2845: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2591,Nc_2844) in
                                                                {2911}event beginCli(Cli,Sess,Nc_2844);
                                                                {2912}out(c, (pkCli_2591,m1_2845));
                                                                {2913}in(c, em2_2846: bitstring);
                                                                {2914}let m2_2847: bitstring = em2_2846 in
                                                                {2915}let (=OpenSecureChannelResponse,=Cli,Ns_2848: bitstring,ST_2849: bitstring,TTL_2850: bitstring) = m2_2847 in
                                                                {2916}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                {2917}event endCli(Sess,Cli,Ns_2848)
                                                            )
                                                            else
                                                                {2918}let pkSess_2851: bitstring = pub(sk(Sess)) in
                                                                {2919}out(c, GetEndpointRequest);
                                                                {2920}in(c, (=GetEndpointResponse,=pkSess_2851,=None,SP_2852: bitstring,UP_2853: bitstring));
                                                                {2921}new Nc_2854: bitstring;
                                                                {2922}let m1_2855: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2591,Nc_2854) in
                                                                {2923}event beginCli(Cli,Sess,Nc_2854);
                                                                {2924}out(c, (pkCli_2591,m1_2855));
                                                                {2925}in(c, em2_2856: bitstring);
                                                                {2926}let m2_2857: bitstring = em2_2856 in
                                                                {2927}let (=OpenSecureChannelResponse,=Cli,Ns_2858: bitstring,ST_2859: bitstring,TTL_2860: bitstring) = m2_2857 in
                                                                {2928}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                {2929}event endCli(Sess,Cli,Ns_2858)
                                                        )
                                                        else
                                                            {2930}let pkSess_2861: bitstring = fail-any in
                                                            {2931}out(c, GetEndpointRequest);
                                                            {2932}in(c, (=GetEndpointResponse,=pkSess_2861,=None,SP_2862: bitstring,UP_2863: bitstring));
                                                            {2933}new Nc_2864: bitstring;
                                                            {2934}let m1_2865: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2591,Nc_2864) in
                                                            {2935}event beginCli(Cli,Sess,Nc_2864);
                                                            {2936}out(c, (pkCli_2591,m1_2865));
                                                            {2937}in(c, em2_2866: bitstring);
                                                            {2938}let m2_2867: bitstring = em2_2866 in
                                                            {2939}let (=OpenSecureChannelResponse,=Cli,Ns_2868: bitstring,ST_2869: bitstring,TTL_2870: bitstring) = m2_2867 in
                                                            {2940}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                            {2941}event endCli(Sess,Cli,Ns_2868)
                                                )
                                                else
                                                    {2942}let pkSess_2871: bitstring = fail-any in
                                                    {2943}out(c, GetEndpointRequest);
                                                    {2944}in(c, (=GetEndpointResponse,=pkSess_2871,=None,SP_2872: bitstring,UP_2873: bitstring));
                                                    {2945}new Nc_2874: bitstring;
                                                    {2946}let m1_2875: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2591,Nc_2874) in
                                                    {2947}event beginCli(Cli,Sess,Nc_2874);
                                                    {2948}out(c, (pkCli_2591,m1_2875));
                                                    {2949}in(c, em2_2876: bitstring);
                                                    {2950}let m2_2877: bitstring = em2_2876 in
                                                    {2951}let (=OpenSecureChannelResponse,=Cli,Ns_2878: bitstring,ST_2879: bitstring,TTL_2880: bitstring) = m2_2877 in
                                                    {2952}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {2953}event endCli(Sess,Cli,Ns_2878)
                                        )
                                        else
                                            {2954}let pkSess_2881: bitstring = fail-any in
                                            {2955}out(c, GetEndpointRequest);
                                            {2956}in(c, (=GetEndpointResponse,=pkSess_2881,=None,SP_2882: bitstring,UP_2883: bitstring));
                                            {2957}new Nc_2884: bitstring;
                                            {2958}let m1_2885: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2591,Nc_2884) in
                                            {2959}event beginCli(Cli,Sess,Nc_2884);
                                            {2960}out(c, (pkCli_2591,m1_2885));
                                            {2961}in(c, em2_2886: bitstring);
                                            {2962}let m2_2887: bitstring = em2_2886 in
                                            {2963}let (=OpenSecureChannelResponse,=Cli,Ns_2888: bitstring,ST_2889: bitstring,TTL_2890: bitstring) = m2_2887 in
                                            {2964}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {2965}event endCli(Sess,Cli,Ns_2888)
                                )
                                else
                                    {2966}let pkDisco_2891: bitstring = fail-any in
                                    {2967}let v_2892: bool = (Sess = A) in
                                    (
                                        {2968}if v_2892 then
                                        (
                                            {2969}let pkSess_2893: bitstring = pub(skA) in
                                            {2970}out(c, GetEndpointRequest);
                                            {2971}in(c, (=GetEndpointResponse,=pkSess_2893,=None,SP_2894: bitstring,UP_2895: bitstring));
                                            {2972}new Nc_2896: bitstring;
                                            {2973}let m1_2897: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2591,Nc_2896) in
                                            {2974}event beginCli(Cli,Sess,Nc_2896);
                                            {2975}out(c, (pkCli_2591,m1_2897));
                                            {2976}in(c, em2_2898: bitstring);
                                            {2977}let m2_2899: bitstring = em2_2898 in
                                            {2978}let (=OpenSecureChannelResponse,=Cli,Ns_2900: bitstring,ST_2901: bitstring,TTL_2902: bitstring) = m2_2899 in
                                            {2979}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {2980}event endCli(Sess,Cli,Ns_2900)
                                        )
                                        else
                                            {2981}let v_2903: bool = (Sess = B) in
                                            (
                                                {2982}if v_2903 then
                                                (
                                                    {2983}let pkSess_2904: bitstring = pub(skB) in
                                                    {2984}out(c, GetEndpointRequest);
                                                    {2985}in(c, (=GetEndpointResponse,=pkSess_2904,=None,SP_2905: bitstring,UP_2906: bitstring));
                                                    {2986}new Nc_2907: bitstring;
                                                    {2987}let m1_2908: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2591,Nc_2907) in
                                                    {2988}event beginCli(Cli,Sess,Nc_2907);
                                                    {2989}out(c, (pkCli_2591,m1_2908));
                                                    {2990}in(c, em2_2909: bitstring);
                                                    {2991}let m2_2910: bitstring = em2_2909 in
                                                    {2992}let (=OpenSecureChannelResponse,=Cli,Ns_2911: bitstring,ST_2912: bitstring,TTL_2913: bitstring) = m2_2910 in
                                                    {2993}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {2994}event endCli(Sess,Cli,Ns_2911)
                                                )
                                                else
                                                    {2995}let v_2914: bool = (Sess = C) in
                                                    (
                                                        {2996}if v_2914 then
                                                        (
                                                            {2997}let pkSess_2915: bitstring = pub(skC) in
                                                            {2998}out(c, GetEndpointRequest);
                                                            {2999}in(c, (=GetEndpointResponse,=pkSess_2915,=None,SP_2916: bitstring,UP_2917: bitstring));
                                                            {3000}new Nc_2918: bitstring;
                                                            {3001}let m1_2919: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2591,Nc_2918) in
                                                            {3002}event beginCli(Cli,Sess,Nc_2918);
                                                            {3003}out(c, (pkCli_2591,m1_2919));
                                                            {3004}in(c, em2_2920: bitstring);
                                                            {3005}let m2_2921: bitstring = em2_2920 in
                                                            {3006}let (=OpenSecureChannelResponse,=Cli,Ns_2922: bitstring,ST_2923: bitstring,TTL_2924: bitstring) = m2_2921 in
                                                            {3007}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                            {3008}event endCli(Sess,Cli,Ns_2922)
                                                        )
                                                        else
                                                            {3009}let pkSess_2925: bitstring = pub(sk(Sess)) in
                                                            {3010}out(c, GetEndpointRequest);
                                                            {3011}in(c, (=GetEndpointResponse,=pkSess_2925,=None,SP_2926: bitstring,UP_2927: bitstring));
                                                            {3012}new Nc_2928: bitstring;
                                                            {3013}let m1_2929: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2591,Nc_2928) in
                                                            {3014}event beginCli(Cli,Sess,Nc_2928);
                                                            {3015}out(c, (pkCli_2591,m1_2929));
                                                            {3016}in(c, em2_2930: bitstring);
                                                            {3017}let m2_2931: bitstring = em2_2930 in
                                                            {3018}let (=OpenSecureChannelResponse,=Cli,Ns_2932: bitstring,ST_2933: bitstring,TTL_2934: bitstring) = m2_2931 in
                                                            {3019}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                            {3020}event endCli(Sess,Cli,Ns_2932)
                                                    )
                                                    else
                                                        {3021}let pkSess_2935: bitstring = fail-any in
                                                        {3022}out(c, GetEndpointRequest);
                                                        {3023}in(c, (=GetEndpointResponse,=pkSess_2935,=None,SP_2936: bitstring,UP_2937: bitstring));
                                                        {3024}new Nc_2938: bitstring;
                                                        {3025}let m1_2939: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2591,Nc_2938) in
                                                        {3026}event beginCli(Cli,Sess,Nc_2938);
                                                        {3027}out(c, (pkCli_2591,m1_2939));
                                                        {3028}in(c, em2_2940: bitstring);
                                                        {3029}let m2_2941: bitstring = em2_2940 in
                                                        {3030}let (=OpenSecureChannelResponse,=Cli,Ns_2942: bitstring,ST_2943: bitstring,TTL_2944: bitstring) = m2_2941 in
                                                        {3031}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {3032}event endCli(Sess,Cli,Ns_2942)
                                            )
                                            else
                                                {3033}let pkSess_2945: bitstring = fail-any in
                                                {3034}out(c, GetEndpointRequest);
                                                {3035}in(c, (=GetEndpointResponse,=pkSess_2945,=None,SP_2946: bitstring,UP_2947: bitstring));
                                                {3036}new Nc_2948: bitstring;
                                                {3037}let m1_2949: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2591,Nc_2948) in
                                                {3038}event beginCli(Cli,Sess,Nc_2948);
                                                {3039}out(c, (pkCli_2591,m1_2949));
                                                {3040}in(c, em2_2950: bitstring);
                                                {3041}let m2_2951: bitstring = em2_2950 in
                                                {3042}let (=OpenSecureChannelResponse,=Cli,Ns_2952: bitstring,ST_2953: bitstring,TTL_2954: bitstring) = m2_2951 in
                                                {3043}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {3044}event endCli(Sess,Cli,Ns_2952)
                                    )
                                    else
                                        {3045}let pkSess_2955: bitstring = fail-any in
                                        {3046}out(c, GetEndpointRequest);
                                        {3047}in(c, (=GetEndpointResponse,=pkSess_2955,=None,SP_2956: bitstring,UP_2957: bitstring));
                                        {3048}new Nc_2958: bitstring;
                                        {3049}let m1_2959: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2591,Nc_2958) in
                                        {3050}event beginCli(Cli,Sess,Nc_2958);
                                        {3051}out(c, (pkCli_2591,m1_2959));
                                        {3052}in(c, em2_2960: bitstring);
                                        {3053}let m2_2961: bitstring = em2_2960 in
                                        {3054}let (=OpenSecureChannelResponse,=Cli,Ns_2962: bitstring,ST_2963: bitstring,TTL_2964: bitstring) = m2_2961 in
                                        {3055}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                        {3056}event endCli(Sess,Cli,Ns_2962)
                        )
                        else
                            {3057}let pkDisco_2965: bitstring = fail-any in
                            {3058}let v_2966: bool = (Sess = A) in
                            (
                                {3059}if v_2966 then
                                (
                                    {3060}let pkSess_2967: bitstring = pub(skA) in
                                    {3061}out(c, GetEndpointRequest);
                                    {3062}in(c, (=GetEndpointResponse,=pkSess_2967,=None,SP_2968: bitstring,UP_2969: bitstring));
                                    {3063}new Nc_2970: bitstring;
                                    {3064}let m1_2971: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2591,Nc_2970) in
                                    {3065}event beginCli(Cli,Sess,Nc_2970);
                                    {3066}out(c, (pkCli_2591,m1_2971));
                                    {3067}in(c, em2_2972: bitstring);
                                    {3068}let m2_2973: bitstring = em2_2972 in
                                    {3069}let (=OpenSecureChannelResponse,=Cli,Ns_2974: bitstring,ST_2975: bitstring,TTL_2976: bitstring) = m2_2973 in
                                    {3070}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                    {3071}event endCli(Sess,Cli,Ns_2974)
                                )
                                else
                                    {3072}let v_2977: bool = (Sess = B) in
                                    (
                                        {3073}if v_2977 then
                                        (
                                            {3074}let pkSess_2978: bitstring = pub(skB) in
                                            {3075}out(c, GetEndpointRequest);
                                            {3076}in(c, (=GetEndpointResponse,=pkSess_2978,=None,SP_2979: bitstring,UP_2980: bitstring));
                                            {3077}new Nc_2981: bitstring;
                                            {3078}let m1_2982: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2591,Nc_2981) in
                                            {3079}event beginCli(Cli,Sess,Nc_2981);
                                            {3080}out(c, (pkCli_2591,m1_2982));
                                            {3081}in(c, em2_2983: bitstring);
                                            {3082}let m2_2984: bitstring = em2_2983 in
                                            {3083}let (=OpenSecureChannelResponse,=Cli,Ns_2985: bitstring,ST_2986: bitstring,TTL_2987: bitstring) = m2_2984 in
                                            {3084}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {3085}event endCli(Sess,Cli,Ns_2985)
                                        )
                                        else
                                            {3086}let v_2988: bool = (Sess = C) in
                                            (
                                                {3087}if v_2988 then
                                                (
                                                    {3088}let pkSess_2989: bitstring = pub(skC) in
                                                    {3089}out(c, GetEndpointRequest);
                                                    {3090}in(c, (=GetEndpointResponse,=pkSess_2989,=None,SP_2990: bitstring,UP_2991: bitstring));
                                                    {3091}new Nc_2992: bitstring;
                                                    {3092}let m1_2993: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2591,Nc_2992) in
                                                    {3093}event beginCli(Cli,Sess,Nc_2992);
                                                    {3094}out(c, (pkCli_2591,m1_2993));
                                                    {3095}in(c, em2_2994: bitstring);
                                                    {3096}let m2_2995: bitstring = em2_2994 in
                                                    {3097}let (=OpenSecureChannelResponse,=Cli,Ns_2996: bitstring,ST_2997: bitstring,TTL_2998: bitstring) = m2_2995 in
                                                    {3098}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {3099}event endCli(Sess,Cli,Ns_2996)
                                                )
                                                else
                                                    {3100}let pkSess_2999: bitstring = pub(sk(Sess)) in
                                                    {3101}out(c, GetEndpointRequest);
                                                    {3102}in(c, (=GetEndpointResponse,=pkSess_2999,=None,SP_3000: bitstring,UP_3001: bitstring));
                                                    {3103}new Nc_3002: bitstring;
                                                    {3104}let m1_3003: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2591,Nc_3002) in
                                                    {3105}event beginCli(Cli,Sess,Nc_3002);
                                                    {3106}out(c, (pkCli_2591,m1_3003));
                                                    {3107}in(c, em2_3004: bitstring);
                                                    {3108}let m2_3005: bitstring = em2_3004 in
                                                    {3109}let (=OpenSecureChannelResponse,=Cli,Ns_3006: bitstring,ST_3007: bitstring,TTL_3008: bitstring) = m2_3005 in
                                                    {3110}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {3111}event endCli(Sess,Cli,Ns_3006)
                                            )
                                            else
                                                {3112}let pkSess_3009: bitstring = fail-any in
                                                {3113}out(c, GetEndpointRequest);
                                                {3114}in(c, (=GetEndpointResponse,=pkSess_3009,=None,SP_3010: bitstring,UP_3011: bitstring));
                                                {3115}new Nc_3012: bitstring;
                                                {3116}let m1_3013: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2591,Nc_3012) in
                                                {3117}event beginCli(Cli,Sess,Nc_3012);
                                                {3118}out(c, (pkCli_2591,m1_3013));
                                                {3119}in(c, em2_3014: bitstring);
                                                {3120}let m2_3015: bitstring = em2_3014 in
                                                {3121}let (=OpenSecureChannelResponse,=Cli,Ns_3016: bitstring,ST_3017: bitstring,TTL_3018: bitstring) = m2_3015 in
                                                {3122}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {3123}event endCli(Sess,Cli,Ns_3016)
                                    )
                                    else
                                        {3124}let pkSess_3019: bitstring = fail-any in
                                        {3125}out(c, GetEndpointRequest);
                                        {3126}in(c, (=GetEndpointResponse,=pkSess_3019,=None,SP_3020: bitstring,UP_3021: bitstring));
                                        {3127}new Nc_3022: bitstring;
                                        {3128}let m1_3023: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2591,Nc_3022) in
                                        {3129}event beginCli(Cli,Sess,Nc_3022);
                                        {3130}out(c, (pkCli_2591,m1_3023));
                                        {3131}in(c, em2_3024: bitstring);
                                        {3132}let m2_3025: bitstring = em2_3024 in
                                        {3133}let (=OpenSecureChannelResponse,=Cli,Ns_3026: bitstring,ST_3027: bitstring,TTL_3028: bitstring) = m2_3025 in
                                        {3134}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                        {3135}event endCli(Sess,Cli,Ns_3026)
                            )
                            else
                                {3136}let pkSess_3029: bitstring = fail-any in
                                {3137}out(c, GetEndpointRequest);
                                {3138}in(c, (=GetEndpointResponse,=pkSess_3029,=None,SP_3030: bitstring,UP_3031: bitstring));
                                {3139}new Nc_3032: bitstring;
                                {3140}let m1_3033: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2591,Nc_3032) in
                                {3141}event beginCli(Cli,Sess,Nc_3032);
                                {3142}out(c, (pkCli_2591,m1_3033));
                                {3143}in(c, em2_3034: bitstring);
                                {3144}let m2_3035: bitstring = em2_3034 in
                                {3145}let (=OpenSecureChannelResponse,=Cli,Ns_3036: bitstring,ST_3037: bitstring,TTL_3038: bitstring) = m2_3035 in
                                {3146}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                {3147}event endCli(Sess,Cli,Ns_3036)
                )
                else
                    {3148}let pkDisco_3039: bitstring = fail-any in
                    {3149}let v_3040: bool = (Sess = A) in
                    (
                        {3150}if v_3040 then
                        (
                            {3151}let pkSess_3041: bitstring = pub(skA) in
                            {3152}out(c, GetEndpointRequest);
                            {3153}in(c, (=GetEndpointResponse,=pkSess_3041,=None,SP_3042: bitstring,UP_3043: bitstring));
                            {3154}new Nc_3044: bitstring;
                            {3155}let m1_3045: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2591,Nc_3044) in
                            {3156}event beginCli(Cli,Sess,Nc_3044);
                            {3157}out(c, (pkCli_2591,m1_3045));
                            {3158}in(c, em2_3046: bitstring);
                            {3159}let m2_3047: bitstring = em2_3046 in
                            {3160}let (=OpenSecureChannelResponse,=Cli,Ns_3048: bitstring,ST_3049: bitstring,TTL_3050: bitstring) = m2_3047 in
                            {3161}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                            {3162}event endCli(Sess,Cli,Ns_3048)
                        )
                        else
                            {3163}let v_3051: bool = (Sess = B) in
                            (
                                {3164}if v_3051 then
                                (
                                    {3165}let pkSess_3052: bitstring = pub(skB) in
                                    {3166}out(c, GetEndpointRequest);
                                    {3167}in(c, (=GetEndpointResponse,=pkSess_3052,=None,SP_3053: bitstring,UP_3054: bitstring));
                                    {3168}new Nc_3055: bitstring;
                                    {3169}let m1_3056: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2591,Nc_3055) in
                                    {3170}event beginCli(Cli,Sess,Nc_3055);
                                    {3171}out(c, (pkCli_2591,m1_3056));
                                    {3172}in(c, em2_3057: bitstring);
                                    {3173}let m2_3058: bitstring = em2_3057 in
                                    {3174}let (=OpenSecureChannelResponse,=Cli,Ns_3059: bitstring,ST_3060: bitstring,TTL_3061: bitstring) = m2_3058 in
                                    {3175}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                    {3176}event endCli(Sess,Cli,Ns_3059)
                                )
                                else
                                    {3177}let v_3062: bool = (Sess = C) in
                                    (
                                        {3178}if v_3062 then
                                        (
                                            {3179}let pkSess_3063: bitstring = pub(skC) in
                                            {3180}out(c, GetEndpointRequest);
                                            {3181}in(c, (=GetEndpointResponse,=pkSess_3063,=None,SP_3064: bitstring,UP_3065: bitstring));
                                            {3182}new Nc_3066: bitstring;
                                            {3183}let m1_3067: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2591,Nc_3066) in
                                            {3184}event beginCli(Cli,Sess,Nc_3066);
                                            {3185}out(c, (pkCli_2591,m1_3067));
                                            {3186}in(c, em2_3068: bitstring);
                                            {3187}let m2_3069: bitstring = em2_3068 in
                                            {3188}let (=OpenSecureChannelResponse,=Cli,Ns_3070: bitstring,ST_3071: bitstring,TTL_3072: bitstring) = m2_3069 in
                                            {3189}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {3190}event endCli(Sess,Cli,Ns_3070)
                                        )
                                        else
                                            {3191}let pkSess_3073: bitstring = pub(sk(Sess)) in
                                            {3192}out(c, GetEndpointRequest);
                                            {3193}in(c, (=GetEndpointResponse,=pkSess_3073,=None,SP_3074: bitstring,UP_3075: bitstring));
                                            {3194}new Nc_3076: bitstring;
                                            {3195}let m1_3077: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2591,Nc_3076) in
                                            {3196}event beginCli(Cli,Sess,Nc_3076);
                                            {3197}out(c, (pkCli_2591,m1_3077));
                                            {3198}in(c, em2_3078: bitstring);
                                            {3199}let m2_3079: bitstring = em2_3078 in
                                            {3200}let (=OpenSecureChannelResponse,=Cli,Ns_3080: bitstring,ST_3081: bitstring,TTL_3082: bitstring) = m2_3079 in
                                            {3201}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {3202}event endCli(Sess,Cli,Ns_3080)
                                    )
                                    else
                                        {3203}let pkSess_3083: bitstring = fail-any in
                                        {3204}out(c, GetEndpointRequest);
                                        {3205}in(c, (=GetEndpointResponse,=pkSess_3083,=None,SP_3084: bitstring,UP_3085: bitstring));
                                        {3206}new Nc_3086: bitstring;
                                        {3207}let m1_3087: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2591,Nc_3086) in
                                        {3208}event beginCli(Cli,Sess,Nc_3086);
                                        {3209}out(c, (pkCli_2591,m1_3087));
                                        {3210}in(c, em2_3088: bitstring);
                                        {3211}let m2_3089: bitstring = em2_3088 in
                                        {3212}let (=OpenSecureChannelResponse,=Cli,Ns_3090: bitstring,ST_3091: bitstring,TTL_3092: bitstring) = m2_3089 in
                                        {3213}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                        {3214}event endCli(Sess,Cli,Ns_3090)
                            )
                            else
                                {3215}let pkSess_3093: bitstring = fail-any in
                                {3216}out(c, GetEndpointRequest);
                                {3217}in(c, (=GetEndpointResponse,=pkSess_3093,=None,SP_3094: bitstring,UP_3095: bitstring));
                                {3218}new Nc_3096: bitstring;
                                {3219}let m1_3097: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2591,Nc_3096) in
                                {3220}event beginCli(Cli,Sess,Nc_3096);
                                {3221}out(c, (pkCli_2591,m1_3097));
                                {3222}in(c, em2_3098: bitstring);
                                {3223}let m2_3099: bitstring = em2_3098 in
                                {3224}let (=OpenSecureChannelResponse,=Cli,Ns_3100: bitstring,ST_3101: bitstring,TTL_3102: bitstring) = m2_3099 in
                                {3225}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                {3226}event endCli(Sess,Cli,Ns_3100)
                    )
                    else
                        {3227}let pkSess_3103: bitstring = fail-any in
                        {3228}out(c, GetEndpointRequest);
                        {3229}in(c, (=GetEndpointResponse,=pkSess_3103,=None,SP_3104: bitstring,UP_3105: bitstring));
                        {3230}new Nc_3106: bitstring;
                        {3231}let m1_3107: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2591,Nc_3106) in
                        {3232}event beginCli(Cli,Sess,Nc_3106);
                        {3233}out(c, (pkCli_2591,m1_3107));
                        {3234}in(c, em2_3108: bitstring);
                        {3235}let m2_3109: bitstring = em2_3108 in
                        {3236}let (=OpenSecureChannelResponse,=Cli,Ns_3110: bitstring,ST_3111: bitstring,TTL_3112: bitstring) = m2_3109 in
                        {3237}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                        {3238}event endCli(Sess,Cli,Ns_3110)
    )
    else
        {3239}let skCli_3113: bitstring = fail-any in
        {3240}let pkCli_3114: bitstring = pub(skCli_3113) in
        {3241}let v_3115: bool = (Disco = A) in
        (
            {3242}if v_3115 then
            (
                {3243}let pkDisco_3116: bitstring = pub(skA) in
                {3244}let v_3117: bool = (Sess = A) in
                (
                    {3245}if v_3117 then
                    (
                        {3246}let pkSess_3118: bitstring = pub(skA) in
                        {3247}out(c, GetEndpointRequest);
                        {3248}in(c, (=GetEndpointResponse,=pkSess_3118,=None,SP_3119: bitstring,UP_3120: bitstring));
                        {3249}new Nc_3121: bitstring;
                        {3250}let m1_3122: bitstring = (OpenSecureChannelRequest,Sess,pkCli_3114,Nc_3121) in
                        {3251}event beginCli(Cli,Sess,Nc_3121);
                        {3252}out(c, (pkCli_3114,m1_3122));
                        {3253}in(c, em2_3123: bitstring);
                        {3254}let m2_3124: bitstring = em2_3123 in
                        {3255}let (=OpenSecureChannelResponse,=Cli,Ns_3125: bitstring,ST_3126: bitstring,TTL_3127: bitstring) = m2_3124 in
                        {3256}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                        {3257}event endCli(Sess,Cli,Ns_3125)
                    )
                    else
                        {3258}let v_3128: bool = (Sess = B) in
                        (
                            {3259}if v_3128 then
                            (
                                {3260}let pkSess_3129: bitstring = pub(skB) in
                                {3261}out(c, GetEndpointRequest);
                                {3262}in(c, (=GetEndpointResponse,=pkSess_3129,=None,SP_3130: bitstring,UP_3131: bitstring));
                                {3263}new Nc_3132: bitstring;
                                {3264}let m1_3133: bitstring = (OpenSecureChannelRequest,Sess,pkCli_3114,Nc_3132) in
                                {3265}event beginCli(Cli,Sess,Nc_3132);
                                {3266}out(c, (pkCli_3114,m1_3133));
                                {3267}in(c, em2_3134: bitstring);
                                {3268}let m2_3135: bitstring = em2_3134 in
                                {3269}let (=OpenSecureChannelResponse,=Cli,Ns_3136: bitstring,ST_3137: bitstring,TTL_3138: bitstring) = m2_3135 in
                                {3270}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                {3271}event endCli(Sess,Cli,Ns_3136)
                            )
                            else
                                {3272}let v_3139: bool = (Sess = C) in
                                (
                                    {3273}if v_3139 then
                                    (
                                        {3274}let pkSess_3140: bitstring = pub(skC) in
                                        {3275}out(c, GetEndpointRequest);
                                        {3276}in(c, (=GetEndpointResponse,=pkSess_3140,=None,SP_3141: bitstring,UP_3142: bitstring));
                                        {3277}new Nc_3143: bitstring;
                                        {3278}let m1_3144: bitstring = (OpenSecureChannelRequest,Sess,pkCli_3114,Nc_3143) in
                                        {3279}event beginCli(Cli,Sess,Nc_3143);
                                        {3280}out(c, (pkCli_3114,m1_3144));
                                        {3281}in(c, em2_3145: bitstring);
                                        {3282}let m2_3146: bitstring = em2_3145 in
                                        {3283}let (=OpenSecureChannelResponse,=Cli,Ns_3147: bitstring,ST_3148: bitstring,TTL_3149: bitstring) = m2_3146 in
                                        {3284}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                        {3285}event endCli(Sess,Cli,Ns_3147)
                                    )
                                    else
                                        {3286}let pkSess_3150: bitstring = pub(sk(Sess)) in
                                        {3287}out(c, GetEndpointRequest);
                                        {3288}in(c, (=GetEndpointResponse,=pkSess_3150,=None,SP_3151: bitstring,UP_3152: bitstring));
                                        {3289}new Nc_3153: bitstring;
                                        {3290}let m1_3154: bitstring = (OpenSecureChannelRequest,Sess,pkCli_3114,Nc_3153) in
                                        {3291}event beginCli(Cli,Sess,Nc_3153);
                                        {3292}out(c, (pkCli_3114,m1_3154));
                                        {3293}in(c, em2_3155: bitstring);
                                        {3294}let m2_3156: bitstring = em2_3155 in
                                        {3295}let (=OpenSecureChannelResponse,=Cli,Ns_3157: bitstring,ST_3158: bitstring,TTL_3159: bitstring) = m2_3156 in
                                        {3296}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                        {3297}event endCli(Sess,Cli,Ns_3157)
                                )
                                else
                                    {3298}let pkSess_3160: bitstring = fail-any in
                                    {3299}out(c, GetEndpointRequest);
                                    {3300}in(c, (=GetEndpointResponse,=pkSess_3160,=None,SP_3161: bitstring,UP_3162: bitstring));
                                    {3301}new Nc_3163: bitstring;
                                    {3302}let m1_3164: bitstring = (OpenSecureChannelRequest,Sess,pkCli_3114,Nc_3163) in
                                    {3303}event beginCli(Cli,Sess,Nc_3163);
                                    {3304}out(c, (pkCli_3114,m1_3164));
                                    {3305}in(c, em2_3165: bitstring);
                                    {3306}let m2_3166: bitstring = em2_3165 in
                                    {3307}let (=OpenSecureChannelResponse,=Cli,Ns_3167: bitstring,ST_3168: bitstring,TTL_3169: bitstring) = m2_3166 in
                                    {3308}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                    {3309}event endCli(Sess,Cli,Ns_3167)
                        )
                        else
                            {3310}let pkSess_3170: bitstring = fail-any in
                            {3311}out(c, GetEndpointRequest);
                            {3312}in(c, (=GetEndpointResponse,=pkSess_3170,=None,SP_3171: bitstring,UP_3172: bitstring));
                            {3313}new Nc_3173: bitstring;
                            {3314}let m1_3174: bitstring = (OpenSecureChannelRequest,Sess,pkCli_3114,Nc_3173) in
                            {3315}event beginCli(Cli,Sess,Nc_3173);
                            {3316}out(c, (pkCli_3114,m1_3174));
                            {3317}in(c, em2_3175: bitstring);
                            {3318}let m2_3176: bitstring = em2_3175 in
                            {3319}let (=OpenSecureChannelResponse,=Cli,Ns_3177: bitstring,ST_3178: bitstring,TTL_3179: bitstring) = m2_3176 in
                            {3320}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                            {3321}event endCli(Sess,Cli,Ns_3177)
                )
                else
                    {3322}let pkSess_3180: bitstring = fail-any in
                    {3323}out(c, GetEndpointRequest);
                    {3324}in(c, (=GetEndpointResponse,=pkSess_3180,=None,SP_3181: bitstring,UP_3182: bitstring));
                    {3325}new Nc_3183: bitstring;
                    {3326}let m1_3184: bitstring = (OpenSecureChannelRequest,Sess,pkCli_3114,Nc_3183) in
                    {3327}event beginCli(Cli,Sess,Nc_3183);
                    {3328}out(c, (pkCli_3114,m1_3184));
                    {3329}in(c, em2_3185: bitstring);
                    {3330}let m2_3186: bitstring = em2_3185 in
                    {3331}let (=OpenSecureChannelResponse,=Cli,Ns_3187: bitstring,ST_3188: bitstring,TTL_3189: bitstring) = m2_3186 in
                    {3332}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                    {3333}event endCli(Sess,Cli,Ns_3187)
            )
            else
                {3334}let v_3190: bool = (Disco = B) in
                (
                    {3335}if v_3190 then
                    (
                        {3336}let pkDisco_3191: bitstring = pub(skB) in
                        {3337}let v_3192: bool = (Sess = A) in
                        (
                            {3338}if v_3192 then
                            (
                                {3339}let pkSess_3193: bitstring = pub(skA) in
                                {3340}out(c, GetEndpointRequest);
                                {3341}in(c, (=GetEndpointResponse,=pkSess_3193,=None,SP_3194: bitstring,UP_3195: bitstring));
                                {3342}new Nc_3196: bitstring;
                                {3343}let m1_3197: bitstring = (OpenSecureChannelRequest,Sess,pkCli_3114,Nc_3196) in
                                {3344}event beginCli(Cli,Sess,Nc_3196);
                                {3345}out(c, (pkCli_3114,m1_3197));
                                {3346}in(c, em2_3198: bitstring);
                                {3347}let m2_3199: bitstring = em2_3198 in
                                {3348}let (=OpenSecureChannelResponse,=Cli,Ns_3200: bitstring,ST_3201: bitstring,TTL_3202: bitstring) = m2_3199 in
                                {3349}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                {3350}event endCli(Sess,Cli,Ns_3200)
                            )
                            else
                                {3351}let v_3203: bool = (Sess = B) in
                                (
                                    {3352}if v_3203 then
                                    (
                                        {3353}let pkSess_3204: bitstring = pub(skB) in
                                        {3354}out(c, GetEndpointRequest);
                                        {3355}in(c, (=GetEndpointResponse,=pkSess_3204,=None,SP_3205: bitstring,UP_3206: bitstring));
                                        {3356}new Nc_3207: bitstring;
                                        {3357}let m1_3208: bitstring = (OpenSecureChannelRequest,Sess,pkCli_3114,Nc_3207) in
                                        {3358}event beginCli(Cli,Sess,Nc_3207);
                                        {3359}out(c, (pkCli_3114,m1_3208));
                                        {3360}in(c, em2_3209: bitstring);
                                        {3361}let m2_3210: bitstring = em2_3209 in
                                        {3362}let (=OpenSecureChannelResponse,=Cli,Ns_3211: bitstring,ST_3212: bitstring,TTL_3213: bitstring) = m2_3210 in
                                        {3363}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                        {3364}event endCli(Sess,Cli,Ns_3211)
                                    )
                                    else
                                        {3365}let v_3214: bool = (Sess = C) in
                                        (
                                            {3366}if v_3214 then
                                            (
                                                {3367}let pkSess_3215: bitstring = pub(skC) in
                                                {3368}out(c, GetEndpointRequest);
                                                {3369}in(c, (=GetEndpointResponse,=pkSess_3215,=None,SP_3216: bitstring,UP_3217: bitstring));
                                                {3370}new Nc_3218: bitstring;
                                                {3371}let m1_3219: bitstring = (OpenSecureChannelRequest,Sess,pkCli_3114,Nc_3218) in
                                                {3372}event beginCli(Cli,Sess,Nc_3218);
                                                {3373}out(c, (pkCli_3114,m1_3219));
                                                {3374}in(c, em2_3220: bitstring);
                                                {3375}let m2_3221: bitstring = em2_3220 in
                                                {3376}let (=OpenSecureChannelResponse,=Cli,Ns_3222: bitstring,ST_3223: bitstring,TTL_3224: bitstring) = m2_3221 in
                                                {3377}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {3378}event endCli(Sess,Cli,Ns_3222)
                                            )
                                            else
                                                {3379}let pkSess_3225: bitstring = pub(sk(Sess)) in
                                                {3380}out(c, GetEndpointRequest);
                                                {3381}in(c, (=GetEndpointResponse,=pkSess_3225,=None,SP_3226: bitstring,UP_3227: bitstring));
                                                {3382}new Nc_3228: bitstring;
                                                {3383}let m1_3229: bitstring = (OpenSecureChannelRequest,Sess,pkCli_3114,Nc_3228) in
                                                {3384}event beginCli(Cli,Sess,Nc_3228);
                                                {3385}out(c, (pkCli_3114,m1_3229));
                                                {3386}in(c, em2_3230: bitstring);
                                                {3387}let m2_3231: bitstring = em2_3230 in
                                                {3388}let (=OpenSecureChannelResponse,=Cli,Ns_3232: bitstring,ST_3233: bitstring,TTL_3234: bitstring) = m2_3231 in
                                                {3389}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {3390}event endCli(Sess,Cli,Ns_3232)
                                        )
                                        else
                                            {3391}let pkSess_3235: bitstring = fail-any in
                                            {3392}out(c, GetEndpointRequest);
                                            {3393}in(c, (=GetEndpointResponse,=pkSess_3235,=None,SP_3236: bitstring,UP_3237: bitstring));
                                            {3394}new Nc_3238: bitstring;
                                            {3395}let m1_3239: bitstring = (OpenSecureChannelRequest,Sess,pkCli_3114,Nc_3238) in
                                            {3396}event beginCli(Cli,Sess,Nc_3238);
                                            {3397}out(c, (pkCli_3114,m1_3239));
                                            {3398}in(c, em2_3240: bitstring);
                                            {3399}let m2_3241: bitstring = em2_3240 in
                                            {3400}let (=OpenSecureChannelResponse,=Cli,Ns_3242: bitstring,ST_3243: bitstring,TTL_3244: bitstring) = m2_3241 in
                                            {3401}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {3402}event endCli(Sess,Cli,Ns_3242)
                                )
                                else
                                    {3403}let pkSess_3245: bitstring = fail-any in
                                    {3404}out(c, GetEndpointRequest);
                                    {3405}in(c, (=GetEndpointResponse,=pkSess_3245,=None,SP_3246: bitstring,UP_3247: bitstring));
                                    {3406}new Nc_3248: bitstring;
                                    {3407}let m1_3249: bitstring = (OpenSecureChannelRequest,Sess,pkCli_3114,Nc_3248) in
                                    {3408}event beginCli(Cli,Sess,Nc_3248);
                                    {3409}out(c, (pkCli_3114,m1_3249));
                                    {3410}in(c, em2_3250: bitstring);
                                    {3411}let m2_3251: bitstring = em2_3250 in
                                    {3412}let (=OpenSecureChannelResponse,=Cli,Ns_3252: bitstring,ST_3253: bitstring,TTL_3254: bitstring) = m2_3251 in
                                    {3413}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                    {3414}event endCli(Sess,Cli,Ns_3252)
                        )
                        else
                            {3415}let pkSess_3255: bitstring = fail-any in
                            {3416}out(c, GetEndpointRequest);
                            {3417}in(c, (=GetEndpointResponse,=pkSess_3255,=None,SP_3256: bitstring,UP_3257: bitstring));
                            {3418}new Nc_3258: bitstring;
                            {3419}let m1_3259: bitstring = (OpenSecureChannelRequest,Sess,pkCli_3114,Nc_3258) in
                            {3420}event beginCli(Cli,Sess,Nc_3258);
                            {3421}out(c, (pkCli_3114,m1_3259));
                            {3422}in(c, em2_3260: bitstring);
                            {3423}let m2_3261: bitstring = em2_3260 in
                            {3424}let (=OpenSecureChannelResponse,=Cli,Ns_3262: bitstring,ST_3263: bitstring,TTL_3264: bitstring) = m2_3261 in
                            {3425}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                            {3426}event endCli(Sess,Cli,Ns_3262)
                    )
                    else
                        {3427}let v_3265: bool = (Disco = C) in
                        (
                            {3428}if v_3265 then
                            (
                                {3429}let pkDisco_3266: bitstring = pub(skC) in
                                {3430}let v_3267: bool = (Sess = A) in
                                (
                                    {3431}if v_3267 then
                                    (
                                        {3432}let pkSess_3268: bitstring = pub(skA) in
                                        {3433}out(c, GetEndpointRequest);
                                        {3434}in(c, (=GetEndpointResponse,=pkSess_3268,=None,SP_3269: bitstring,UP_3270: bitstring));
                                        {3435}new Nc_3271: bitstring;
                                        {3436}let m1_3272: bitstring = (OpenSecureChannelRequest,Sess,pkCli_3114,Nc_3271) in
                                        {3437}event beginCli(Cli,Sess,Nc_3271);
                                        {3438}out(c, (pkCli_3114,m1_3272));
                                        {3439}in(c, em2_3273: bitstring);
                                        {3440}let m2_3274: bitstring = em2_3273 in
                                        {3441}let (=OpenSecureChannelResponse,=Cli,Ns_3275: bitstring,ST_3276: bitstring,TTL_3277: bitstring) = m2_3274 in
                                        {3442}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                        {3443}event endCli(Sess,Cli,Ns_3275)
                                    )
                                    else
                                        {3444}let v_3278: bool = (Sess = B) in
                                        (
                                            {3445}if v_3278 then
                                            (
                                                {3446}let pkSess_3279: bitstring = pub(skB) in
                                                {3447}out(c, GetEndpointRequest);
                                                {3448}in(c, (=GetEndpointResponse,=pkSess_3279,=None,SP_3280: bitstring,UP_3281: bitstring));
                                                {3449}new Nc_3282: bitstring;
                                                {3450}let m1_3283: bitstring = (OpenSecureChannelRequest,Sess,pkCli_3114,Nc_3282) in
                                                {3451}event beginCli(Cli,Sess,Nc_3282);
                                                {3452}out(c, (pkCli_3114,m1_3283));
                                                {3453}in(c, em2_3284: bitstring);
                                                {3454}let m2_3285: bitstring = em2_3284 in
                                                {3455}let (=OpenSecureChannelResponse,=Cli,Ns_3286: bitstring,ST_3287: bitstring,TTL_3288: bitstring) = m2_3285 in
                                                {3456}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {3457}event endCli(Sess,Cli,Ns_3286)
                                            )
                                            else
                                                {3458}let v_3289: bool = (Sess = C) in
                                                (
                                                    {3459}if v_3289 then
                                                    (
                                                        {3460}let pkSess_3290: bitstring = pub(skC) in
                                                        {3461}out(c, GetEndpointRequest);
                                                        {3462}in(c, (=GetEndpointResponse,=pkSess_3290,=None,SP_3291: bitstring,UP_3292: bitstring));
                                                        {3463}new Nc_3293: bitstring;
                                                        {3464}let m1_3294: bitstring = (OpenSecureChannelRequest,Sess,pkCli_3114,Nc_3293) in
                                                        {3465}event beginCli(Cli,Sess,Nc_3293);
                                                        {3466}out(c, (pkCli_3114,m1_3294));
                                                        {3467}in(c, em2_3295: bitstring);
                                                        {3468}let m2_3296: bitstring = em2_3295 in
                                                        {3469}let (=OpenSecureChannelResponse,=Cli,Ns_3297: bitstring,ST_3298: bitstring,TTL_3299: bitstring) = m2_3296 in
                                                        {3470}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {3471}event endCli(Sess,Cli,Ns_3297)
                                                    )
                                                    else
                                                        {3472}let pkSess_3300: bitstring = pub(sk(Sess)) in
                                                        {3473}out(c, GetEndpointRequest);
                                                        {3474}in(c, (=GetEndpointResponse,=pkSess_3300,=None,SP_3301: bitstring,UP_3302: bitstring));
                                                        {3475}new Nc_3303: bitstring;
                                                        {3476}let m1_3304: bitstring = (OpenSecureChannelRequest,Sess,pkCli_3114,Nc_3303) in
                                                        {3477}event beginCli(Cli,Sess,Nc_3303);
                                                        {3478}out(c, (pkCli_3114,m1_3304));
                                                        {3479}in(c, em2_3305: bitstring);
                                                        {3480}let m2_3306: bitstring = em2_3305 in
                                                        {3481}let (=OpenSecureChannelResponse,=Cli,Ns_3307: bitstring,ST_3308: bitstring,TTL_3309: bitstring) = m2_3306 in
                                                        {3482}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {3483}event endCli(Sess,Cli,Ns_3307)
                                                )
                                                else
                                                    {3484}let pkSess_3310: bitstring = fail-any in
                                                    {3485}out(c, GetEndpointRequest);
                                                    {3486}in(c, (=GetEndpointResponse,=pkSess_3310,=None,SP_3311: bitstring,UP_3312: bitstring));
                                                    {3487}new Nc_3313: bitstring;
                                                    {3488}let m1_3314: bitstring = (OpenSecureChannelRequest,Sess,pkCli_3114,Nc_3313) in
                                                    {3489}event beginCli(Cli,Sess,Nc_3313);
                                                    {3490}out(c, (pkCli_3114,m1_3314));
                                                    {3491}in(c, em2_3315: bitstring);
                                                    {3492}let m2_3316: bitstring = em2_3315 in
                                                    {3493}let (=OpenSecureChannelResponse,=Cli,Ns_3317: bitstring,ST_3318: bitstring,TTL_3319: bitstring) = m2_3316 in
                                                    {3494}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {3495}event endCli(Sess,Cli,Ns_3317)
                                        )
                                        else
                                            {3496}let pkSess_3320: bitstring = fail-any in
                                            {3497}out(c, GetEndpointRequest);
                                            {3498}in(c, (=GetEndpointResponse,=pkSess_3320,=None,SP_3321: bitstring,UP_3322: bitstring));
                                            {3499}new Nc_3323: bitstring;
                                            {3500}let m1_3324: bitstring = (OpenSecureChannelRequest,Sess,pkCli_3114,Nc_3323) in
                                            {3501}event beginCli(Cli,Sess,Nc_3323);
                                            {3502}out(c, (pkCli_3114,m1_3324));
                                            {3503}in(c, em2_3325: bitstring);
                                            {3504}let m2_3326: bitstring = em2_3325 in
                                            {3505}let (=OpenSecureChannelResponse,=Cli,Ns_3327: bitstring,ST_3328: bitstring,TTL_3329: bitstring) = m2_3326 in
                                            {3506}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {3507}event endCli(Sess,Cli,Ns_3327)
                                )
                                else
                                    {3508}let pkSess_3330: bitstring = fail-any in
                                    {3509}out(c, GetEndpointRequest);
                                    {3510}in(c, (=GetEndpointResponse,=pkSess_3330,=None,SP_3331: bitstring,UP_3332: bitstring));
                                    {3511}new Nc_3333: bitstring;
                                    {3512}let m1_3334: bitstring = (OpenSecureChannelRequest,Sess,pkCli_3114,Nc_3333) in
                                    {3513}event beginCli(Cli,Sess,Nc_3333);
                                    {3514}out(c, (pkCli_3114,m1_3334));
                                    {3515}in(c, em2_3335: bitstring);
                                    {3516}let m2_3336: bitstring = em2_3335 in
                                    {3517}let (=OpenSecureChannelResponse,=Cli,Ns_3337: bitstring,ST_3338: bitstring,TTL_3339: bitstring) = m2_3336 in
                                    {3518}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                    {3519}event endCli(Sess,Cli,Ns_3337)
                            )
                            else
                                {3520}let pkDisco_3340: bitstring = pub(sk(Disco)) in
                                {3521}let v_3341: bool = (Sess = A) in
                                (
                                    {3522}if v_3341 then
                                    (
                                        {3523}let pkSess_3342: bitstring = pub(skA) in
                                        {3524}out(c, GetEndpointRequest);
                                        {3525}in(c, (=GetEndpointResponse,=pkSess_3342,=None,SP_3343: bitstring,UP_3344: bitstring));
                                        {3526}new Nc_3345: bitstring;
                                        {3527}let m1_3346: bitstring = (OpenSecureChannelRequest,Sess,pkCli_3114,Nc_3345) in
                                        {3528}event beginCli(Cli,Sess,Nc_3345);
                                        {3529}out(c, (pkCli_3114,m1_3346));
                                        {3530}in(c, em2_3347: bitstring);
                                        {3531}let m2_3348: bitstring = em2_3347 in
                                        {3532}let (=OpenSecureChannelResponse,=Cli,Ns_3349: bitstring,ST_3350: bitstring,TTL_3351: bitstring) = m2_3348 in
                                        {3533}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                        {3534}event endCli(Sess,Cli,Ns_3349)
                                    )
                                    else
                                        {3535}let v_3352: bool = (Sess = B) in
                                        (
                                            {3536}if v_3352 then
                                            (
                                                {3537}let pkSess_3353: bitstring = pub(skB) in
                                                {3538}out(c, GetEndpointRequest);
                                                {3539}in(c, (=GetEndpointResponse,=pkSess_3353,=None,SP_3354: bitstring,UP_3355: bitstring));
                                                {3540}new Nc_3356: bitstring;
                                                {3541}let m1_3357: bitstring = (OpenSecureChannelRequest,Sess,pkCli_3114,Nc_3356) in
                                                {3542}event beginCli(Cli,Sess,Nc_3356);
                                                {3543}out(c, (pkCli_3114,m1_3357));
                                                {3544}in(c, em2_3358: bitstring);
                                                {3545}let m2_3359: bitstring = em2_3358 in
                                                {3546}let (=OpenSecureChannelResponse,=Cli,Ns_3360: bitstring,ST_3361: bitstring,TTL_3362: bitstring) = m2_3359 in
                                                {3547}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {3548}event endCli(Sess,Cli,Ns_3360)
                                            )
                                            else
                                                {3549}let v_3363: bool = (Sess = C) in
                                                (
                                                    {3550}if v_3363 then
                                                    (
                                                        {3551}let pkSess_3364: bitstring = pub(skC) in
                                                        {3552}out(c, GetEndpointRequest);
                                                        {3553}in(c, (=GetEndpointResponse,=pkSess_3364,=None,SP_3365: bitstring,UP_3366: bitstring));
                                                        {3554}new Nc_3367: bitstring;
                                                        {3555}let m1_3368: bitstring = (OpenSecureChannelRequest,Sess,pkCli_3114,Nc_3367) in
                                                        {3556}event beginCli(Cli,Sess,Nc_3367);
                                                        {3557}out(c, (pkCli_3114,m1_3368));
                                                        {3558}in(c, em2_3369: bitstring);
                                                        {3559}let m2_3370: bitstring = em2_3369 in
                                                        {3560}let (=OpenSecureChannelResponse,=Cli,Ns_3371: bitstring,ST_3372: bitstring,TTL_3373: bitstring) = m2_3370 in
                                                        {3561}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {3562}event endCli(Sess,Cli,Ns_3371)
                                                    )
                                                    else
                                                        {3563}let pkSess_3374: bitstring = pub(sk(Sess)) in
                                                        {3564}out(c, GetEndpointRequest);
                                                        {3565}in(c, (=GetEndpointResponse,=pkSess_3374,=None,SP_3375: bitstring,UP_3376: bitstring));
                                                        {3566}new Nc_3377: bitstring;
                                                        {3567}let m1_3378: bitstring = (OpenSecureChannelRequest,Sess,pkCli_3114,Nc_3377) in
                                                        {3568}event beginCli(Cli,Sess,Nc_3377);
                                                        {3569}out(c, (pkCli_3114,m1_3378));
                                                        {3570}in(c, em2_3379: bitstring);
                                                        {3571}let m2_3380: bitstring = em2_3379 in
                                                        {3572}let (=OpenSecureChannelResponse,=Cli,Ns_3381: bitstring,ST_3382: bitstring,TTL_3383: bitstring) = m2_3380 in
                                                        {3573}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {3574}event endCli(Sess,Cli,Ns_3381)
                                                )
                                                else
                                                    {3575}let pkSess_3384: bitstring = fail-any in
                                                    {3576}out(c, GetEndpointRequest);
                                                    {3577}in(c, (=GetEndpointResponse,=pkSess_3384,=None,SP_3385: bitstring,UP_3386: bitstring));
                                                    {3578}new Nc_3387: bitstring;
                                                    {3579}let m1_3388: bitstring = (OpenSecureChannelRequest,Sess,pkCli_3114,Nc_3387) in
                                                    {3580}event beginCli(Cli,Sess,Nc_3387);
                                                    {3581}out(c, (pkCli_3114,m1_3388));
                                                    {3582}in(c, em2_3389: bitstring);
                                                    {3583}let m2_3390: bitstring = em2_3389 in
                                                    {3584}let (=OpenSecureChannelResponse,=Cli,Ns_3391: bitstring,ST_3392: bitstring,TTL_3393: bitstring) = m2_3390 in
                                                    {3585}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {3586}event endCli(Sess,Cli,Ns_3391)
                                        )
                                        else
                                            {3587}let pkSess_3394: bitstring = fail-any in
                                            {3588}out(c, GetEndpointRequest);
                                            {3589}in(c, (=GetEndpointResponse,=pkSess_3394,=None,SP_3395: bitstring,UP_3396: bitstring));
                                            {3590}new Nc_3397: bitstring;
                                            {3591}let m1_3398: bitstring = (OpenSecureChannelRequest,Sess,pkCli_3114,Nc_3397) in
                                            {3592}event beginCli(Cli,Sess,Nc_3397);
                                            {3593}out(c, (pkCli_3114,m1_3398));
                                            {3594}in(c, em2_3399: bitstring);
                                            {3595}let m2_3400: bitstring = em2_3399 in
                                            {3596}let (=OpenSecureChannelResponse,=Cli,Ns_3401: bitstring,ST_3402: bitstring,TTL_3403: bitstring) = m2_3400 in
                                            {3597}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {3598}event endCli(Sess,Cli,Ns_3401)
                                )
                                else
                                    {3599}let pkSess_3404: bitstring = fail-any in
                                    {3600}out(c, GetEndpointRequest);
                                    {3601}in(c, (=GetEndpointResponse,=pkSess_3404,=None,SP_3405: bitstring,UP_3406: bitstring));
                                    {3602}new Nc_3407: bitstring;
                                    {3603}let m1_3408: bitstring = (OpenSecureChannelRequest,Sess,pkCli_3114,Nc_3407) in
                                    {3604}event beginCli(Cli,Sess,Nc_3407);
                                    {3605}out(c, (pkCli_3114,m1_3408));
                                    {3606}in(c, em2_3409: bitstring);
                                    {3607}let m2_3410: bitstring = em2_3409 in
                                    {3608}let (=OpenSecureChannelResponse,=Cli,Ns_3411: bitstring,ST_3412: bitstring,TTL_3413: bitstring) = m2_3410 in
                                    {3609}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                    {3610}event endCli(Sess,Cli,Ns_3411)
                        )
                        else
                            {3611}let pkDisco_3414: bitstring = fail-any in
                            {3612}let v_3415: bool = (Sess = A) in
                            (
                                {3613}if v_3415 then
                                (
                                    {3614}let pkSess_3416: bitstring = pub(skA) in
                                    {3615}out(c, GetEndpointRequest);
                                    {3616}in(c, (=GetEndpointResponse,=pkSess_3416,=None,SP_3417: bitstring,UP_3418: bitstring));
                                    {3617}new Nc_3419: bitstring;
                                    {3618}let m1_3420: bitstring = (OpenSecureChannelRequest,Sess,pkCli_3114,Nc_3419) in
                                    {3619}event beginCli(Cli,Sess,Nc_3419);
                                    {3620}out(c, (pkCli_3114,m1_3420));
                                    {3621}in(c, em2_3421: bitstring);
                                    {3622}let m2_3422: bitstring = em2_3421 in
                                    {3623}let (=OpenSecureChannelResponse,=Cli,Ns_3423: bitstring,ST_3424: bitstring,TTL_3425: bitstring) = m2_3422 in
                                    {3624}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                    {3625}event endCli(Sess,Cli,Ns_3423)
                                )
                                else
                                    {3626}let v_3426: bool = (Sess = B) in
                                    (
                                        {3627}if v_3426 then
                                        (
                                            {3628}let pkSess_3427: bitstring = pub(skB) in
                                            {3629}out(c, GetEndpointRequest);
                                            {3630}in(c, (=GetEndpointResponse,=pkSess_3427,=None,SP_3428: bitstring,UP_3429: bitstring));
                                            {3631}new Nc_3430: bitstring;
                                            {3632}let m1_3431: bitstring = (OpenSecureChannelRequest,Sess,pkCli_3114,Nc_3430) in
                                            {3633}event beginCli(Cli,Sess,Nc_3430);
                                            {3634}out(c, (pkCli_3114,m1_3431));
                                            {3635}in(c, em2_3432: bitstring);
                                            {3636}let m2_3433: bitstring = em2_3432 in
                                            {3637}let (=OpenSecureChannelResponse,=Cli,Ns_3434: bitstring,ST_3435: bitstring,TTL_3436: bitstring) = m2_3433 in
                                            {3638}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {3639}event endCli(Sess,Cli,Ns_3434)
                                        )
                                        else
                                            {3640}let v_3437: bool = (Sess = C) in
                                            (
                                                {3641}if v_3437 then
                                                (
                                                    {3642}let pkSess_3438: bitstring = pub(skC) in
                                                    {3643}out(c, GetEndpointRequest);
                                                    {3644}in(c, (=GetEndpointResponse,=pkSess_3438,=None,SP_3439: bitstring,UP_3440: bitstring));
                                                    {3645}new Nc_3441: bitstring;
                                                    {3646}let m1_3442: bitstring = (OpenSecureChannelRequest,Sess,pkCli_3114,Nc_3441) in
                                                    {3647}event beginCli(Cli,Sess,Nc_3441);
                                                    {3648}out(c, (pkCli_3114,m1_3442));
                                                    {3649}in(c, em2_3443: bitstring);
                                                    {3650}let m2_3444: bitstring = em2_3443 in
                                                    {3651}let (=OpenSecureChannelResponse,=Cli,Ns_3445: bitstring,ST_3446: bitstring,TTL_3447: bitstring) = m2_3444 in
                                                    {3652}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {3653}event endCli(Sess,Cli,Ns_3445)
                                                )
                                                else
                                                    {3654}let pkSess_3448: bitstring = pub(sk(Sess)) in
                                                    {3655}out(c, GetEndpointRequest);
                                                    {3656}in(c, (=GetEndpointResponse,=pkSess_3448,=None,SP_3449: bitstring,UP_3450: bitstring));
                                                    {3657}new Nc_3451: bitstring;
                                                    {3658}let m1_3452: bitstring = (OpenSecureChannelRequest,Sess,pkCli_3114,Nc_3451) in
                                                    {3659}event beginCli(Cli,Sess,Nc_3451);
                                                    {3660}out(c, (pkCli_3114,m1_3452));
                                                    {3661}in(c, em2_3453: bitstring);
                                                    {3662}let m2_3454: bitstring = em2_3453 in
                                                    {3663}let (=OpenSecureChannelResponse,=Cli,Ns_3455: bitstring,ST_3456: bitstring,TTL_3457: bitstring) = m2_3454 in
                                                    {3664}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {3665}event endCli(Sess,Cli,Ns_3455)
                                            )
                                            else
                                                {3666}let pkSess_3458: bitstring = fail-any in
                                                {3667}out(c, GetEndpointRequest);
                                                {3668}in(c, (=GetEndpointResponse,=pkSess_3458,=None,SP_3459: bitstring,UP_3460: bitstring));
                                                {3669}new Nc_3461: bitstring;
                                                {3670}let m1_3462: bitstring = (OpenSecureChannelRequest,Sess,pkCli_3114,Nc_3461) in
                                                {3671}event beginCli(Cli,Sess,Nc_3461);
                                                {3672}out(c, (pkCli_3114,m1_3462));
                                                {3673}in(c, em2_3463: bitstring);
                                                {3674}let m2_3464: bitstring = em2_3463 in
                                                {3675}let (=OpenSecureChannelResponse,=Cli,Ns_3465: bitstring,ST_3466: bitstring,TTL_3467: bitstring) = m2_3464 in
                                                {3676}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {3677}event endCli(Sess,Cli,Ns_3465)
                                    )
                                    else
                                        {3678}let pkSess_3468: bitstring = fail-any in
                                        {3679}out(c, GetEndpointRequest);
                                        {3680}in(c, (=GetEndpointResponse,=pkSess_3468,=None,SP_3469: bitstring,UP_3470: bitstring));
                                        {3681}new Nc_3471: bitstring;
                                        {3682}let m1_3472: bitstring = (OpenSecureChannelRequest,Sess,pkCli_3114,Nc_3471) in
                                        {3683}event beginCli(Cli,Sess,Nc_3471);
                                        {3684}out(c, (pkCli_3114,m1_3472));
                                        {3685}in(c, em2_3473: bitstring);
                                        {3686}let m2_3474: bitstring = em2_3473 in
                                        {3687}let (=OpenSecureChannelResponse,=Cli,Ns_3475: bitstring,ST_3476: bitstring,TTL_3477: bitstring) = m2_3474 in
                                        {3688}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                        {3689}event endCli(Sess,Cli,Ns_3475)
                            )
                            else
                                {3690}let pkSess_3478: bitstring = fail-any in
                                {3691}out(c, GetEndpointRequest);
                                {3692}in(c, (=GetEndpointResponse,=pkSess_3478,=None,SP_3479: bitstring,UP_3480: bitstring));
                                {3693}new Nc_3481: bitstring;
                                {3694}let m1_3482: bitstring = (OpenSecureChannelRequest,Sess,pkCli_3114,Nc_3481) in
                                {3695}event beginCli(Cli,Sess,Nc_3481);
                                {3696}out(c, (pkCli_3114,m1_3482));
                                {3697}in(c, em2_3483: bitstring);
                                {3698}let m2_3484: bitstring = em2_3483 in
                                {3699}let (=OpenSecureChannelResponse,=Cli,Ns_3485: bitstring,ST_3486: bitstring,TTL_3487: bitstring) = m2_3484 in
                                {3700}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                {3701}event endCli(Sess,Cli,Ns_3485)
                )
                else
                    {3702}let pkDisco_3488: bitstring = fail-any in
                    {3703}let v_3489: bool = (Sess = A) in
                    (
                        {3704}if v_3489 then
                        (
                            {3705}let pkSess_3490: bitstring = pub(skA) in
                            {3706}out(c, GetEndpointRequest);
                            {3707}in(c, (=GetEndpointResponse,=pkSess_3490,=None,SP_3491: bitstring,UP_3492: bitstring));
                            {3708}new Nc_3493: bitstring;
                            {3709}let m1_3494: bitstring = (OpenSecureChannelRequest,Sess,pkCli_3114,Nc_3493) in
                            {3710}event beginCli(Cli,Sess,Nc_3493);
                            {3711}out(c, (pkCli_3114,m1_3494));
                            {3712}in(c, em2_3495: bitstring);
                            {3713}let m2_3496: bitstring = em2_3495 in
                            {3714}let (=OpenSecureChannelResponse,=Cli,Ns_3497: bitstring,ST_3498: bitstring,TTL_3499: bitstring) = m2_3496 in
                            {3715}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                            {3716}event endCli(Sess,Cli,Ns_3497)
                        )
                        else
                            {3717}let v_3500: bool = (Sess = B) in
                            (
                                {3718}if v_3500 then
                                (
                                    {3719}let pkSess_3501: bitstring = pub(skB) in
                                    {3720}out(c, GetEndpointRequest);
                                    {3721}in(c, (=GetEndpointResponse,=pkSess_3501,=None,SP_3502: bitstring,UP_3503: bitstring));
                                    {3722}new Nc_3504: bitstring;
                                    {3723}let m1_3505: bitstring = (OpenSecureChannelRequest,Sess,pkCli_3114,Nc_3504) in
                                    {3724}event beginCli(Cli,Sess,Nc_3504);
                                    {3725}out(c, (pkCli_3114,m1_3505));
                                    {3726}in(c, em2_3506: bitstring);
                                    {3727}let m2_3507: bitstring = em2_3506 in
                                    {3728}let (=OpenSecureChannelResponse,=Cli,Ns_3508: bitstring,ST_3509: bitstring,TTL_3510: bitstring) = m2_3507 in
                                    {3729}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                    {3730}event endCli(Sess,Cli,Ns_3508)
                                )
                                else
                                    {3731}let v_3511: bool = (Sess = C) in
                                    (
                                        {3732}if v_3511 then
                                        (
                                            {3733}let pkSess_3512: bitstring = pub(skC) in
                                            {3734}out(c, GetEndpointRequest);
                                            {3735}in(c, (=GetEndpointResponse,=pkSess_3512,=None,SP_3513: bitstring,UP_3514: bitstring));
                                            {3736}new Nc_3515: bitstring;
                                            {3737}let m1_3516: bitstring = (OpenSecureChannelRequest,Sess,pkCli_3114,Nc_3515) in
                                            {3738}event beginCli(Cli,Sess,Nc_3515);
                                            {3739}out(c, (pkCli_3114,m1_3516));
                                            {3740}in(c, em2_3517: bitstring);
                                            {3741}let m2_3518: bitstring = em2_3517 in
                                            {3742}let (=OpenSecureChannelResponse,=Cli,Ns_3519: bitstring,ST_3520: bitstring,TTL_3521: bitstring) = m2_3518 in
                                            {3743}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {3744}event endCli(Sess,Cli,Ns_3519)
                                        )
                                        else
                                            {3745}let pkSess_3522: bitstring = pub(sk(Sess)) in
                                            {3746}out(c, GetEndpointRequest);
                                            {3747}in(c, (=GetEndpointResponse,=pkSess_3522,=None,SP_3523: bitstring,UP_3524: bitstring));
                                            {3748}new Nc_3525: bitstring;
                                            {3749}let m1_3526: bitstring = (OpenSecureChannelRequest,Sess,pkCli_3114,Nc_3525) in
                                            {3750}event beginCli(Cli,Sess,Nc_3525);
                                            {3751}out(c, (pkCli_3114,m1_3526));
                                            {3752}in(c, em2_3527: bitstring);
                                            {3753}let m2_3528: bitstring = em2_3527 in
                                            {3754}let (=OpenSecureChannelResponse,=Cli,Ns_3529: bitstring,ST_3530: bitstring,TTL_3531: bitstring) = m2_3528 in
                                            {3755}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {3756}event endCli(Sess,Cli,Ns_3529)
                                    )
                                    else
                                        {3757}let pkSess_3532: bitstring = fail-any in
                                        {3758}out(c, GetEndpointRequest);
                                        {3759}in(c, (=GetEndpointResponse,=pkSess_3532,=None,SP_3533: bitstring,UP_3534: bitstring));
                                        {3760}new Nc_3535: bitstring;
                                        {3761}let m1_3536: bitstring = (OpenSecureChannelRequest,Sess,pkCli_3114,Nc_3535) in
                                        {3762}event beginCli(Cli,Sess,Nc_3535);
                                        {3763}out(c, (pkCli_3114,m1_3536));
                                        {3764}in(c, em2_3537: bitstring);
                                        {3765}let m2_3538: bitstring = em2_3537 in
                                        {3766}let (=OpenSecureChannelResponse,=Cli,Ns_3539: bitstring,ST_3540: bitstring,TTL_3541: bitstring) = m2_3538 in
                                        {3767}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                        {3768}event endCli(Sess,Cli,Ns_3539)
                            )
                            else
                                {3769}let pkSess_3542: bitstring = fail-any in
                                {3770}out(c, GetEndpointRequest);
                                {3771}in(c, (=GetEndpointResponse,=pkSess_3542,=None,SP_3543: bitstring,UP_3544: bitstring));
                                {3772}new Nc_3545: bitstring;
                                {3773}let m1_3546: bitstring = (OpenSecureChannelRequest,Sess,pkCli_3114,Nc_3545) in
                                {3774}event beginCli(Cli,Sess,Nc_3545);
                                {3775}out(c, (pkCli_3114,m1_3546));
                                {3776}in(c, em2_3547: bitstring);
                                {3777}let m2_3548: bitstring = em2_3547 in
                                {3778}let (=OpenSecureChannelResponse,=Cli,Ns_3549: bitstring,ST_3550: bitstring,TTL_3551: bitstring) = m2_3548 in
                                {3779}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                {3780}event endCli(Sess,Cli,Ns_3549)
                    )
                    else
                        {3781}let pkSess_3552: bitstring = fail-any in
                        {3782}out(c, GetEndpointRequest);
                        {3783}in(c, (=GetEndpointResponse,=pkSess_3552,=None,SP_3553: bitstring,UP_3554: bitstring));
                        {3784}new Nc_3555: bitstring;
                        {3785}let m1_3556: bitstring = (OpenSecureChannelRequest,Sess,pkCli_3114,Nc_3555) in
                        {3786}event beginCli(Cli,Sess,Nc_3555);
                        {3787}out(c, (pkCli_3114,m1_3556));
                        {3788}in(c, em2_3557: bitstring);
                        {3789}let m2_3558: bitstring = em2_3557 in
                        {3790}let (=OpenSecureChannelResponse,=Cli,Ns_3559: bitstring,ST_3560: bitstring,TTL_3561: bitstring) = m2_3558 in
                        {3791}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                        {3792}event endCli(Sess,Cli,Ns_3559)
        )
        else
            {3793}let pkDisco_3562: bitstring = fail-any in
            {3794}let v_3563: bool = (Sess = A) in
            (
                {3795}if v_3563 then
                (
                    {3796}let pkSess_3564: bitstring = pub(skA) in
                    {3797}out(c, GetEndpointRequest);
                    {3798}in(c, (=GetEndpointResponse,=pkSess_3564,=None,SP_3565: bitstring,UP_3566: bitstring));
                    {3799}new Nc_3567: bitstring;
                    {3800}let m1_3568: bitstring = (OpenSecureChannelRequest,Sess,pkCli_3114,Nc_3567) in
                    {3801}event beginCli(Cli,Sess,Nc_3567);
                    {3802}out(c, (pkCli_3114,m1_3568));
                    {3803}in(c, em2_3569: bitstring);
                    {3804}let m2_3570: bitstring = em2_3569 in
                    {3805}let (=OpenSecureChannelResponse,=Cli,Ns_3571: bitstring,ST_3572: bitstring,TTL_3573: bitstring) = m2_3570 in
                    {3806}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                    {3807}event endCli(Sess,Cli,Ns_3571)
                )
                else
                    {3808}let v_3574: bool = (Sess = B) in
                    (
                        {3809}if v_3574 then
                        (
                            {3810}let pkSess_3575: bitstring = pub(skB) in
                            {3811}out(c, GetEndpointRequest);
                            {3812}in(c, (=GetEndpointResponse,=pkSess_3575,=None,SP_3576: bitstring,UP_3577: bitstring));
                            {3813}new Nc_3578: bitstring;
                            {3814}let m1_3579: bitstring = (OpenSecureChannelRequest,Sess,pkCli_3114,Nc_3578) in
                            {3815}event beginCli(Cli,Sess,Nc_3578);
                            {3816}out(c, (pkCli_3114,m1_3579));
                            {3817}in(c, em2_3580: bitstring);
                            {3818}let m2_3581: bitstring = em2_3580 in
                            {3819}let (=OpenSecureChannelResponse,=Cli,Ns_3582: bitstring,ST_3583: bitstring,TTL_3584: bitstring) = m2_3581 in
                            {3820}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                            {3821}event endCli(Sess,Cli,Ns_3582)
                        )
                        else
                            {3822}let v_3585: bool = (Sess = C) in
                            (
                                {3823}if v_3585 then
                                (
                                    {3824}let pkSess_3586: bitstring = pub(skC) in
                                    {3825}out(c, GetEndpointRequest);
                                    {3826}in(c, (=GetEndpointResponse,=pkSess_3586,=None,SP_3587: bitstring,UP_3588: bitstring));
                                    {3827}new Nc_3589: bitstring;
                                    {3828}let m1_3590: bitstring = (OpenSecureChannelRequest,Sess,pkCli_3114,Nc_3589) in
                                    {3829}event beginCli(Cli,Sess,Nc_3589);
                                    {3830}out(c, (pkCli_3114,m1_3590));
                                    {3831}in(c, em2_3591: bitstring);
                                    {3832}let m2_3592: bitstring = em2_3591 in
                                    {3833}let (=OpenSecureChannelResponse,=Cli,Ns_3593: bitstring,ST_3594: bitstring,TTL_3595: bitstring) = m2_3592 in
                                    {3834}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                    {3835}event endCli(Sess,Cli,Ns_3593)
                                )
                                else
                                    {3836}let pkSess_3596: bitstring = pub(sk(Sess)) in
                                    {3837}out(c, GetEndpointRequest);
                                    {3838}in(c, (=GetEndpointResponse,=pkSess_3596,=None,SP_3597: bitstring,UP_3598: bitstring));
                                    {3839}new Nc_3599: bitstring;
                                    {3840}let m1_3600: bitstring = (OpenSecureChannelRequest,Sess,pkCli_3114,Nc_3599) in
                                    {3841}event beginCli(Cli,Sess,Nc_3599);
                                    {3842}out(c, (pkCli_3114,m1_3600));
                                    {3843}in(c, em2_3601: bitstring);
                                    {3844}let m2_3602: bitstring = em2_3601 in
                                    {3845}let (=OpenSecureChannelResponse,=Cli,Ns_3603: bitstring,ST_3604: bitstring,TTL_3605: bitstring) = m2_3602 in
                                    {3846}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                    {3847}event endCli(Sess,Cli,Ns_3603)
                            )
                            else
                                {3848}let pkSess_3606: bitstring = fail-any in
                                {3849}out(c, GetEndpointRequest);
                                {3850}in(c, (=GetEndpointResponse,=pkSess_3606,=None,SP_3607: bitstring,UP_3608: bitstring));
                                {3851}new Nc_3609: bitstring;
                                {3852}let m1_3610: bitstring = (OpenSecureChannelRequest,Sess,pkCli_3114,Nc_3609) in
                                {3853}event beginCli(Cli,Sess,Nc_3609);
                                {3854}out(c, (pkCli_3114,m1_3610));
                                {3855}in(c, em2_3611: bitstring);
                                {3856}let m2_3612: bitstring = em2_3611 in
                                {3857}let (=OpenSecureChannelResponse,=Cli,Ns_3613: bitstring,ST_3614: bitstring,TTL_3615: bitstring) = m2_3612 in
                                {3858}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                {3859}event endCli(Sess,Cli,Ns_3613)
                    )
                    else
                        {3860}let pkSess_3616: bitstring = fail-any in
                        {3861}out(c, GetEndpointRequest);
                        {3862}in(c, (=GetEndpointResponse,=pkSess_3616,=None,SP_3617: bitstring,UP_3618: bitstring));
                        {3863}new Nc_3619: bitstring;
                        {3864}let m1_3620: bitstring = (OpenSecureChannelRequest,Sess,pkCli_3114,Nc_3619) in
                        {3865}event beginCli(Cli,Sess,Nc_3619);
                        {3866}out(c, (pkCli_3114,m1_3620));
                        {3867}in(c, em2_3621: bitstring);
                        {3868}let m2_3622: bitstring = em2_3621 in
                        {3869}let (=OpenSecureChannelResponse,=Cli,Ns_3623: bitstring,ST_3624: bitstring,TTL_3625: bitstring) = m2_3622 in
                        {3870}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                        {3871}event endCli(Sess,Cli,Ns_3623)
            )
            else
                {3872}let pkSess_3626: bitstring = fail-any in
                {3873}out(c, GetEndpointRequest);
                {3874}in(c, (=GetEndpointResponse,=pkSess_3626,=None,SP_3627: bitstring,UP_3628: bitstring));
                {3875}new Nc_3629: bitstring;
                {3876}let m1_3630: bitstring = (OpenSecureChannelRequest,Sess,pkCli_3114,Nc_3629) in
                {3877}event beginCli(Cli,Sess,Nc_3629);
                {3878}out(c, (pkCli_3114,m1_3630));
                {3879}in(c, em2_3631: bitstring);
                {3880}let m2_3632: bitstring = em2_3631 in
                {3881}let (=OpenSecureChannelResponse,=Cli,Ns_3633: bitstring,ST_3634: bitstring,TTL_3635: bitstring) = m2_3632 in
                {3882}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                {3883}event endCli(Sess,Cli,Ns_3633)
) | (
    {3884}!
    {3885}in(c, (Cli_3636: host,Disco_3637: host,Sess_3638: host));
    {3886}let v_3639: bool = (Disco_3637 = A) in
    (
        {3887}if v_3639 then
        (
            {3888}let skDisco: bitstring = skA in
            {3889}let pkDisco_3640: bitstring = pub(skDisco) in
            {3890}let v_3641: bool = (Cli_3636 = A) in
            (
                {3891}if v_3641 then
                (
                    {3892}let pkCli_3642: bitstring = pub(skA) in
                    {3893}let v_3643: bool = (Sess_3638 = A) in
                    (
                        {3894}if v_3643 then
                        (
                            {3895}let pkSess_3644: bitstring = pub(skA) in
                            {3896}in(c, =GetEndpointRequest);
                            {3897}new SP_3645: bitstring;
                            {3898}new UP_3646: bitstring;
                            {3899}out(c, (GetEndpointResponse,pkSess_3644,None,SP_3645,UP_3646))
                        )
                        else
                            {3900}let v_3647: bool = (Sess_3638 = B) in
                            (
                                {3901}if v_3647 then
                                (
                                    {3902}let pkSess_3648: bitstring = pub(skB) in
                                    {3903}in(c, =GetEndpointRequest);
                                    {3904}new SP_3649: bitstring;
                                    {3905}new UP_3650: bitstring;
                                    {3906}out(c, (GetEndpointResponse,pkSess_3648,None,SP_3649,UP_3650))
                                )
                                else
                                    {3907}let v_3651: bool = (Sess_3638 = C) in
                                    (
                                        {3908}if v_3651 then
                                        (
                                            {3909}let pkSess_3652: bitstring = pub(skC) in
                                            {3910}in(c, =GetEndpointRequest);
                                            {3911}new SP_3653: bitstring;
                                            {3912}new UP_3654: bitstring;
                                            {3913}out(c, (GetEndpointResponse,pkSess_3652,None,SP_3653,UP_3654))
                                        )
                                        else
                                            {3914}let pkSess_3655: bitstring = pub(sk(Sess_3638)) in
                                            {3915}in(c, =GetEndpointRequest);
                                            {3916}new SP_3656: bitstring;
                                            {3917}new UP_3657: bitstring;
                                            {3918}out(c, (GetEndpointResponse,pkSess_3655,None,SP_3656,UP_3657))
                                    )
                                    else
                                        {3919}let pkSess_3658: bitstring = fail-any in
                                        {3920}in(c, =GetEndpointRequest);
                                        {3921}new SP_3659: bitstring;
                                        {3922}new UP_3660: bitstring;
                                        {3923}out(c, (GetEndpointResponse,pkSess_3658,None,SP_3659,UP_3660))
                            )
                            else
                                {3924}let pkSess_3661: bitstring = fail-any in
                                {3925}in(c, =GetEndpointRequest);
                                {3926}new SP_3662: bitstring;
                                {3927}new UP_3663: bitstring;
                                {3928}out(c, (GetEndpointResponse,pkSess_3661,None,SP_3662,UP_3663))
                    )
                    else
                        {3929}let pkSess_3664: bitstring = fail-any in
                        {3930}in(c, =GetEndpointRequest);
                        {3931}new SP_3665: bitstring;
                        {3932}new UP_3666: bitstring;
                        {3933}out(c, (GetEndpointResponse,pkSess_3664,None,SP_3665,UP_3666))
                )
                else
                    {3934}let v_3667: bool = (Cli_3636 = B) in
                    (
                        {3935}if v_3667 then
                        (
                            {3936}let pkCli_3668: bitstring = pub(skB) in
                            {3937}let v_3669: bool = (Sess_3638 = A) in
                            (
                                {3938}if v_3669 then
                                (
                                    {3939}let pkSess_3670: bitstring = pub(skA) in
                                    {3940}in(c, =GetEndpointRequest);
                                    {3941}new SP_3671: bitstring;
                                    {3942}new UP_3672: bitstring;
                                    {3943}out(c, (GetEndpointResponse,pkSess_3670,None,SP_3671,UP_3672))
                                )
                                else
                                    {3944}let v_3673: bool = (Sess_3638 = B) in
                                    (
                                        {3945}if v_3673 then
                                        (
                                            {3946}let pkSess_3674: bitstring = pub(skB) in
                                            {3947}in(c, =GetEndpointRequest);
                                            {3948}new SP_3675: bitstring;
                                            {3949}new UP_3676: bitstring;
                                            {3950}out(c, (GetEndpointResponse,pkSess_3674,None,SP_3675,UP_3676))
                                        )
                                        else
                                            {3951}let v_3677: bool = (Sess_3638 = C) in
                                            (
                                                {3952}if v_3677 then
                                                (
                                                    {3953}let pkSess_3678: bitstring = pub(skC) in
                                                    {3954}in(c, =GetEndpointRequest);
                                                    {3955}new SP_3679: bitstring;
                                                    {3956}new UP_3680: bitstring;
                                                    {3957}out(c, (GetEndpointResponse,pkSess_3678,None,SP_3679,UP_3680))
                                                )
                                                else
                                                    {3958}let pkSess_3681: bitstring = pub(sk(Sess_3638)) in
                                                    {3959}in(c, =GetEndpointRequest);
                                                    {3960}new SP_3682: bitstring;
                                                    {3961}new UP_3683: bitstring;
                                                    {3962}out(c, (GetEndpointResponse,pkSess_3681,None,SP_3682,UP_3683))
                                            )
                                            else
                                                {3963}let pkSess_3684: bitstring = fail-any in
                                                {3964}in(c, =GetEndpointRequest);
                                                {3965}new SP_3685: bitstring;
                                                {3966}new UP_3686: bitstring;
                                                {3967}out(c, (GetEndpointResponse,pkSess_3684,None,SP_3685,UP_3686))
                                    )
                                    else
                                        {3968}let pkSess_3687: bitstring = fail-any in
                                        {3969}in(c, =GetEndpointRequest);
                                        {3970}new SP_3688: bitstring;
                                        {3971}new UP_3689: bitstring;
                                        {3972}out(c, (GetEndpointResponse,pkSess_3687,None,SP_3688,UP_3689))
                            )
                            else
                                {3973}let pkSess_3690: bitstring = fail-any in
                                {3974}in(c, =GetEndpointRequest);
                                {3975}new SP_3691: bitstring;
                                {3976}new UP_3692: bitstring;
                                {3977}out(c, (GetEndpointResponse,pkSess_3690,None,SP_3691,UP_3692))
                        )
                        else
                            {3978}let v_3693: bool = (Cli_3636 = C) in
                            (
                                {3979}if v_3693 then
                                (
                                    {3980}let pkCli_3694: bitstring = pub(skC) in
                                    {3981}let v_3695: bool = (Sess_3638 = A) in
                                    (
                                        {3982}if v_3695 then
                                        (
                                            {3983}let pkSess_3696: bitstring = pub(skA) in
                                            {3984}in(c, =GetEndpointRequest);
                                            {3985}new SP_3697: bitstring;
                                            {3986}new UP_3698: bitstring;
                                            {3987}out(c, (GetEndpointResponse,pkSess_3696,None,SP_3697,UP_3698))
                                        )
                                        else
                                            {3988}let v_3699: bool = (Sess_3638 = B) in
                                            (
                                                {3989}if v_3699 then
                                                (
                                                    {3990}let pkSess_3700: bitstring = pub(skB) in
                                                    {3991}in(c, =GetEndpointRequest);
                                                    {3992}new SP_3701: bitstring;
                                                    {3993}new UP_3702: bitstring;
                                                    {3994}out(c, (GetEndpointResponse,pkSess_3700,None,SP_3701,UP_3702))
                                                )
                                                else
                                                    {3995}let v_3703: bool = (Sess_3638 = C) in
                                                    (
                                                        {3996}if v_3703 then
                                                        (
                                                            {3997}let pkSess_3704: bitstring = pub(skC) in
                                                            {3998}in(c, =GetEndpointRequest);
                                                            {3999}new SP_3705: bitstring;
                                                            {4000}new UP_3706: bitstring;
                                                            {4001}out(c, (GetEndpointResponse,pkSess_3704,None,SP_3705,UP_3706))
                                                        )
                                                        else
                                                            {4002}let pkSess_3707: bitstring = pub(sk(Sess_3638)) in
                                                            {4003}in(c, =GetEndpointRequest);
                                                            {4004}new SP_3708: bitstring;
                                                            {4005}new UP_3709: bitstring;
                                                            {4006}out(c, (GetEndpointResponse,pkSess_3707,None,SP_3708,UP_3709))
                                                    )
                                                    else
                                                        {4007}let pkSess_3710: bitstring = fail-any in
                                                        {4008}in(c, =GetEndpointRequest);
                                                        {4009}new SP_3711: bitstring;
                                                        {4010}new UP_3712: bitstring;
                                                        {4011}out(c, (GetEndpointResponse,pkSess_3710,None,SP_3711,UP_3712))
                                            )
                                            else
                                                {4012}let pkSess_3713: bitstring = fail-any in
                                                {4013}in(c, =GetEndpointRequest);
                                                {4014}new SP_3714: bitstring;
                                                {4015}new UP_3715: bitstring;
                                                {4016}out(c, (GetEndpointResponse,pkSess_3713,None,SP_3714,UP_3715))
                                    )
                                    else
                                        {4017}let pkSess_3716: bitstring = fail-any in
                                        {4018}in(c, =GetEndpointRequest);
                                        {4019}new SP_3717: bitstring;
                                        {4020}new UP_3718: bitstring;
                                        {4021}out(c, (GetEndpointResponse,pkSess_3716,None,SP_3717,UP_3718))
                                )
                                else
                                    {4022}let pkCli_3719: bitstring = pub(sk(Cli_3636)) in
                                    {4023}let v_3720: bool = (Sess_3638 = A) in
                                    (
                                        {4024}if v_3720 then
                                        (
                                            {4025}let pkSess_3721: bitstring = pub(skA) in
                                            {4026}in(c, =GetEndpointRequest);
                                            {4027}new SP_3722: bitstring;
                                            {4028}new UP_3723: bitstring;
                                            {4029}out(c, (GetEndpointResponse,pkSess_3721,None,SP_3722,UP_3723))
                                        )
                                        else
                                            {4030}let v_3724: bool = (Sess_3638 = B) in
                                            (
                                                {4031}if v_3724 then
                                                (
                                                    {4032}let pkSess_3725: bitstring = pub(skB) in
                                                    {4033}in(c, =GetEndpointRequest);
                                                    {4034}new SP_3726: bitstring;
                                                    {4035}new UP_3727: bitstring;
                                                    {4036}out(c, (GetEndpointResponse,pkSess_3725,None,SP_3726,UP_3727))
                                                )
                                                else
                                                    {4037}let v_3728: bool = (Sess_3638 = C) in
                                                    (
                                                        {4038}if v_3728 then
                                                        (
                                                            {4039}let pkSess_3729: bitstring = pub(skC) in
                                                            {4040}in(c, =GetEndpointRequest);
                                                            {4041}new SP_3730: bitstring;
                                                            {4042}new UP_3731: bitstring;
                                                            {4043}out(c, (GetEndpointResponse,pkSess_3729,None,SP_3730,UP_3731))
                                                        )
                                                        else
                                                            {4044}let pkSess_3732: bitstring = pub(sk(Sess_3638)) in
                                                            {4045}in(c, =GetEndpointRequest);
                                                            {4046}new SP_3733: bitstring;
                                                            {4047}new UP_3734: bitstring;
                                                            {4048}out(c, (GetEndpointResponse,pkSess_3732,None,SP_3733,UP_3734))
                                                    )
                                                    else
                                                        {4049}let pkSess_3735: bitstring = fail-any in
                                                        {4050}in(c, =GetEndpointRequest);
                                                        {4051}new SP_3736: bitstring;
                                                        {4052}new UP_3737: bitstring;
                                                        {4053}out(c, (GetEndpointResponse,pkSess_3735,None,SP_3736,UP_3737))
                                            )
                                            else
                                                {4054}let pkSess_3738: bitstring = fail-any in
                                                {4055}in(c, =GetEndpointRequest);
                                                {4056}new SP_3739: bitstring;
                                                {4057}new UP_3740: bitstring;
                                                {4058}out(c, (GetEndpointResponse,pkSess_3738,None,SP_3739,UP_3740))
                                    )
                                    else
                                        {4059}let pkSess_3741: bitstring = fail-any in
                                        {4060}in(c, =GetEndpointRequest);
                                        {4061}new SP_3742: bitstring;
                                        {4062}new UP_3743: bitstring;
                                        {4063}out(c, (GetEndpointResponse,pkSess_3741,None,SP_3742,UP_3743))
                            )
                            else
                                {4064}let pkCli_3744: bitstring = fail-any in
                                {4065}let v_3745: bool = (Sess_3638 = A) in
                                (
                                    {4066}if v_3745 then
                                    (
                                        {4067}let pkSess_3746: bitstring = pub(skA) in
                                        {4068}in(c, =GetEndpointRequest);
                                        {4069}new SP_3747: bitstring;
                                        {4070}new UP_3748: bitstring;
                                        {4071}out(c, (GetEndpointResponse,pkSess_3746,None,SP_3747,UP_3748))
                                    )
                                    else
                                        {4072}let v_3749: bool = (Sess_3638 = B) in
                                        (
                                            {4073}if v_3749 then
                                            (
                                                {4074}let pkSess_3750: bitstring = pub(skB) in
                                                {4075}in(c, =GetEndpointRequest);
                                                {4076}new SP_3751: bitstring;
                                                {4077}new UP_3752: bitstring;
                                                {4078}out(c, (GetEndpointResponse,pkSess_3750,None,SP_3751,UP_3752))
                                            )
                                            else
                                                {4079}let v_3753: bool = (Sess_3638 = C) in
                                                (
                                                    {4080}if v_3753 then
                                                    (
                                                        {4081}let pkSess_3754: bitstring = pub(skC) in
                                                        {4082}in(c, =GetEndpointRequest);
                                                        {4083}new SP_3755: bitstring;
                                                        {4084}new UP_3756: bitstring;
                                                        {4085}out(c, (GetEndpointResponse,pkSess_3754,None,SP_3755,UP_3756))
                                                    )
                                                    else
                                                        {4086}let pkSess_3757: bitstring = pub(sk(Sess_3638)) in
                                                        {4087}in(c, =GetEndpointRequest);
                                                        {4088}new SP_3758: bitstring;
                                                        {4089}new UP_3759: bitstring;
                                                        {4090}out(c, (GetEndpointResponse,pkSess_3757,None,SP_3758,UP_3759))
                                                )
                                                else
                                                    {4091}let pkSess_3760: bitstring = fail-any in
                                                    {4092}in(c, =GetEndpointRequest);
                                                    {4093}new SP_3761: bitstring;
                                                    {4094}new UP_3762: bitstring;
                                                    {4095}out(c, (GetEndpointResponse,pkSess_3760,None,SP_3761,UP_3762))
                                        )
                                        else
                                            {4096}let pkSess_3763: bitstring = fail-any in
                                            {4097}in(c, =GetEndpointRequest);
                                            {4098}new SP_3764: bitstring;
                                            {4099}new UP_3765: bitstring;
                                            {4100}out(c, (GetEndpointResponse,pkSess_3763,None,SP_3764,UP_3765))
                                )
                                else
                                    {4101}let pkSess_3766: bitstring = fail-any in
                                    {4102}in(c, =GetEndpointRequest);
                                    {4103}new SP_3767: bitstring;
                                    {4104}new UP_3768: bitstring;
                                    {4105}out(c, (GetEndpointResponse,pkSess_3766,None,SP_3767,UP_3768))
                    )
                    else
                        {4106}let pkCli_3769: bitstring = fail-any in
                        {4107}let v_3770: bool = (Sess_3638 = A) in
                        (
                            {4108}if v_3770 then
                            (
                                {4109}let pkSess_3771: bitstring = pub(skA) in
                                {4110}in(c, =GetEndpointRequest);
                                {4111}new SP_3772: bitstring;
                                {4112}new UP_3773: bitstring;
                                {4113}out(c, (GetEndpointResponse,pkSess_3771,None,SP_3772,UP_3773))
                            )
                            else
                                {4114}let v_3774: bool = (Sess_3638 = B) in
                                (
                                    {4115}if v_3774 then
                                    (
                                        {4116}let pkSess_3775: bitstring = pub(skB) in
                                        {4117}in(c, =GetEndpointRequest);
                                        {4118}new SP_3776: bitstring;
                                        {4119}new UP_3777: bitstring;
                                        {4120}out(c, (GetEndpointResponse,pkSess_3775,None,SP_3776,UP_3777))
                                    )
                                    else
                                        {4121}let v_3778: bool = (Sess_3638 = C) in
                                        (
                                            {4122}if v_3778 then
                                            (
                                                {4123}let pkSess_3779: bitstring = pub(skC) in
                                                {4124}in(c, =GetEndpointRequest);
                                                {4125}new SP_3780: bitstring;
                                                {4126}new UP_3781: bitstring;
                                                {4127}out(c, (GetEndpointResponse,pkSess_3779,None,SP_3780,UP_3781))
                                            )
                                            else
                                                {4128}let pkSess_3782: bitstring = pub(sk(Sess_3638)) in
                                                {4129}in(c, =GetEndpointRequest);
                                                {4130}new SP_3783: bitstring;
                                                {4131}new UP_3784: bitstring;
                                                {4132}out(c, (GetEndpointResponse,pkSess_3782,None,SP_3783,UP_3784))
                                        )
                                        else
                                            {4133}let pkSess_3785: bitstring = fail-any in
                                            {4134}in(c, =GetEndpointRequest);
                                            {4135}new SP_3786: bitstring;
                                            {4136}new UP_3787: bitstring;
                                            {4137}out(c, (GetEndpointResponse,pkSess_3785,None,SP_3786,UP_3787))
                                )
                                else
                                    {4138}let pkSess_3788: bitstring = fail-any in
                                    {4139}in(c, =GetEndpointRequest);
                                    {4140}new SP_3789: bitstring;
                                    {4141}new UP_3790: bitstring;
                                    {4142}out(c, (GetEndpointResponse,pkSess_3788,None,SP_3789,UP_3790))
                        )
                        else
                            {4143}let pkSess_3791: bitstring = fail-any in
                            {4144}in(c, =GetEndpointRequest);
                            {4145}new SP_3792: bitstring;
                            {4146}new UP_3793: bitstring;
                            {4147}out(c, (GetEndpointResponse,pkSess_3791,None,SP_3792,UP_3793))
            )
            else
                {4148}let pkCli_3794: bitstring = fail-any in
                {4149}let v_3795: bool = (Sess_3638 = A) in
                (
                    {4150}if v_3795 then
                    (
                        {4151}let pkSess_3796: bitstring = pub(skA) in
                        {4152}in(c, =GetEndpointRequest);
                        {4153}new SP_3797: bitstring;
                        {4154}new UP_3798: bitstring;
                        {4155}out(c, (GetEndpointResponse,pkSess_3796,None,SP_3797,UP_3798))
                    )
                    else
                        {4156}let v_3799: bool = (Sess_3638 = B) in
                        (
                            {4157}if v_3799 then
                            (
                                {4158}let pkSess_3800: bitstring = pub(skB) in
                                {4159}in(c, =GetEndpointRequest);
                                {4160}new SP_3801: bitstring;
                                {4161}new UP_3802: bitstring;
                                {4162}out(c, (GetEndpointResponse,pkSess_3800,None,SP_3801,UP_3802))
                            )
                            else
                                {4163}let v_3803: bool = (Sess_3638 = C) in
                                (
                                    {4164}if v_3803 then
                                    (
                                        {4165}let pkSess_3804: bitstring = pub(skC) in
                                        {4166}in(c, =GetEndpointRequest);
                                        {4167}new SP_3805: bitstring;
                                        {4168}new UP_3806: bitstring;
                                        {4169}out(c, (GetEndpointResponse,pkSess_3804,None,SP_3805,UP_3806))
                                    )
                                    else
                                        {4170}let pkSess_3807: bitstring = pub(sk(Sess_3638)) in
                                        {4171}in(c, =GetEndpointRequest);
                                        {4172}new SP_3808: bitstring;
                                        {4173}new UP_3809: bitstring;
                                        {4174}out(c, (GetEndpointResponse,pkSess_3807,None,SP_3808,UP_3809))
                                )
                                else
                                    {4175}let pkSess_3810: bitstring = fail-any in
                                    {4176}in(c, =GetEndpointRequest);
                                    {4177}new SP_3811: bitstring;
                                    {4178}new UP_3812: bitstring;
                                    {4179}out(c, (GetEndpointResponse,pkSess_3810,None,SP_3811,UP_3812))
                        )
                        else
                            {4180}let pkSess_3813: bitstring = fail-any in
                            {4181}in(c, =GetEndpointRequest);
                            {4182}new SP_3814: bitstring;
                            {4183}new UP_3815: bitstring;
                            {4184}out(c, (GetEndpointResponse,pkSess_3813,None,SP_3814,UP_3815))
                )
                else
                    {4185}let pkSess_3816: bitstring = fail-any in
                    {4186}in(c, =GetEndpointRequest);
                    {4187}new SP_3817: bitstring;
                    {4188}new UP_3818: bitstring;
                    {4189}out(c, (GetEndpointResponse,pkSess_3816,None,SP_3817,UP_3818))
        )
        else
            {4190}let v_3819: bool = (Disco_3637 = B) in
            (
                {4191}if v_3819 then
                (
                    {4192}let skDisco_3820: bitstring = skB in
                    {4193}let pkDisco_3821: bitstring = pub(skDisco_3820) in
                    {4194}let v_3822: bool = (Cli_3636 = A) in
                    (
                        {4195}if v_3822 then
                        (
                            {4196}let pkCli_3823: bitstring = pub(skA) in
                            {4197}let v_3824: bool = (Sess_3638 = A) in
                            (
                                {4198}if v_3824 then
                                (
                                    {4199}let pkSess_3825: bitstring = pub(skA) in
                                    {4200}in(c, =GetEndpointRequest);
                                    {4201}new SP_3826: bitstring;
                                    {4202}new UP_3827: bitstring;
                                    {4203}out(c, (GetEndpointResponse,pkSess_3825,None,SP_3826,UP_3827))
                                )
                                else
                                    {4204}let v_3828: bool = (Sess_3638 = B) in
                                    (
                                        {4205}if v_3828 then
                                        (
                                            {4206}let pkSess_3829: bitstring = pub(skB) in
                                            {4207}in(c, =GetEndpointRequest);
                                            {4208}new SP_3830: bitstring;
                                            {4209}new UP_3831: bitstring;
                                            {4210}out(c, (GetEndpointResponse,pkSess_3829,None,SP_3830,UP_3831))
                                        )
                                        else
                                            {4211}let v_3832: bool = (Sess_3638 = C) in
                                            (
                                                {4212}if v_3832 then
                                                (
                                                    {4213}let pkSess_3833: bitstring = pub(skC) in
                                                    {4214}in(c, =GetEndpointRequest);
                                                    {4215}new SP_3834: bitstring;
                                                    {4216}new UP_3835: bitstring;
                                                    {4217}out(c, (GetEndpointResponse,pkSess_3833,None,SP_3834,UP_3835))
                                                )
                                                else
                                                    {4218}let pkSess_3836: bitstring = pub(sk(Sess_3638)) in
                                                    {4219}in(c, =GetEndpointRequest);
                                                    {4220}new SP_3837: bitstring;
                                                    {4221}new UP_3838: bitstring;
                                                    {4222}out(c, (GetEndpointResponse,pkSess_3836,None,SP_3837,UP_3838))
                                            )
                                            else
                                                {4223}let pkSess_3839: bitstring = fail-any in
                                                {4224}in(c, =GetEndpointRequest);
                                                {4225}new SP_3840: bitstring;
                                                {4226}new UP_3841: bitstring;
                                                {4227}out(c, (GetEndpointResponse,pkSess_3839,None,SP_3840,UP_3841))
                                    )
                                    else
                                        {4228}let pkSess_3842: bitstring = fail-any in
                                        {4229}in(c, =GetEndpointRequest);
                                        {4230}new SP_3843: bitstring;
                                        {4231}new UP_3844: bitstring;
                                        {4232}out(c, (GetEndpointResponse,pkSess_3842,None,SP_3843,UP_3844))
                            )
                            else
                                {4233}let pkSess_3845: bitstring = fail-any in
                                {4234}in(c, =GetEndpointRequest);
                                {4235}new SP_3846: bitstring;
                                {4236}new UP_3847: bitstring;
                                {4237}out(c, (GetEndpointResponse,pkSess_3845,None,SP_3846,UP_3847))
                        )
                        else
                            {4238}let v_3848: bool = (Cli_3636 = B) in
                            (
                                {4239}if v_3848 then
                                (
                                    {4240}let pkCli_3849: bitstring = pub(skB) in
                                    {4241}let v_3850: bool = (Sess_3638 = A) in
                                    (
                                        {4242}if v_3850 then
                                        (
                                            {4243}let pkSess_3851: bitstring = pub(skA) in
                                            {4244}in(c, =GetEndpointRequest);
                                            {4245}new SP_3852: bitstring;
                                            {4246}new UP_3853: bitstring;
                                            {4247}out(c, (GetEndpointResponse,pkSess_3851,None,SP_3852,UP_3853))
                                        )
                                        else
                                            {4248}let v_3854: bool = (Sess_3638 = B) in
                                            (
                                                {4249}if v_3854 then
                                                (
                                                    {4250}let pkSess_3855: bitstring = pub(skB) in
                                                    {4251}in(c, =GetEndpointRequest);
                                                    {4252}new SP_3856: bitstring;
                                                    {4253}new UP_3857: bitstring;
                                                    {4254}out(c, (GetEndpointResponse,pkSess_3855,None,SP_3856,UP_3857))
                                                )
                                                else
                                                    {4255}let v_3858: bool = (Sess_3638 = C) in
                                                    (
                                                        {4256}if v_3858 then
                                                        (
                                                            {4257}let pkSess_3859: bitstring = pub(skC) in
                                                            {4258}in(c, =GetEndpointRequest);
                                                            {4259}new SP_3860: bitstring;
                                                            {4260}new UP_3861: bitstring;
                                                            {4261}out(c, (GetEndpointResponse,pkSess_3859,None,SP_3860,UP_3861))
                                                        )
                                                        else
                                                            {4262}let pkSess_3862: bitstring = pub(sk(Sess_3638)) in
                                                            {4263}in(c, =GetEndpointRequest);
                                                            {4264}new SP_3863: bitstring;
                                                            {4265}new UP_3864: bitstring;
                                                            {4266}out(c, (GetEndpointResponse,pkSess_3862,None,SP_3863,UP_3864))
                                                    )
                                                    else
                                                        {4267}let pkSess_3865: bitstring = fail-any in
                                                        {4268}in(c, =GetEndpointRequest);
                                                        {4269}new SP_3866: bitstring;
                                                        {4270}new UP_3867: bitstring;
                                                        {4271}out(c, (GetEndpointResponse,pkSess_3865,None,SP_3866,UP_3867))
                                            )
                                            else
                                                {4272}let pkSess_3868: bitstring = fail-any in
                                                {4273}in(c, =GetEndpointRequest);
                                                {4274}new SP_3869: bitstring;
                                                {4275}new UP_3870: bitstring;
                                                {4276}out(c, (GetEndpointResponse,pkSess_3868,None,SP_3869,UP_3870))
                                    )
                                    else
                                        {4277}let pkSess_3871: bitstring = fail-any in
                                        {4278}in(c, =GetEndpointRequest);
                                        {4279}new SP_3872: bitstring;
                                        {4280}new UP_3873: bitstring;
                                        {4281}out(c, (GetEndpointResponse,pkSess_3871,None,SP_3872,UP_3873))
                                )
                                else
                                    {4282}let v_3874: bool = (Cli_3636 = C) in
                                    (
                                        {4283}if v_3874 then
                                        (
                                            {4284}let pkCli_3875: bitstring = pub(skC) in
                                            {4285}let v_3876: bool = (Sess_3638 = A) in
                                            (
                                                {4286}if v_3876 then
                                                (
                                                    {4287}let pkSess_3877: bitstring = pub(skA) in
                                                    {4288}in(c, =GetEndpointRequest);
                                                    {4289}new SP_3878: bitstring;
                                                    {4290}new UP_3879: bitstring;
                                                    {4291}out(c, (GetEndpointResponse,pkSess_3877,None,SP_3878,UP_3879))
                                                )
                                                else
                                                    {4292}let v_3880: bool = (Sess_3638 = B) in
                                                    (
                                                        {4293}if v_3880 then
                                                        (
                                                            {4294}let pkSess_3881: bitstring = pub(skB) in
                                                            {4295}in(c, =GetEndpointRequest);
                                                            {4296}new SP_3882: bitstring;
                                                            {4297}new UP_3883: bitstring;
                                                            {4298}out(c, (GetEndpointResponse,pkSess_3881,None,SP_3882,UP_3883))
                                                        )
                                                        else
                                                            {4299}let v_3884: bool = (Sess_3638 = C) in
                                                            (
                                                                {4300}if v_3884 then
                                                                (
                                                                    {4301}let pkSess_3885: bitstring = pub(skC) in
                                                                    {4302}in(c, =GetEndpointRequest);
                                                                    {4303}new SP_3886: bitstring;
                                                                    {4304}new UP_3887: bitstring;
                                                                    {4305}out(c, (GetEndpointResponse,pkSess_3885,None,SP_3886,UP_3887))
                                                                )
                                                                else
                                                                    {4306}let pkSess_3888: bitstring = pub(sk(Sess_3638)) in
                                                                    {4307}in(c, =GetEndpointRequest);
                                                                    {4308}new SP_3889: bitstring;
                                                                    {4309}new UP_3890: bitstring;
                                                                    {4310}out(c, (GetEndpointResponse,pkSess_3888,None,SP_3889,UP_3890))
                                                            )
                                                            else
                                                                {4311}let pkSess_3891: bitstring = fail-any in
                                                                {4312}in(c, =GetEndpointRequest);
                                                                {4313}new SP_3892: bitstring;
                                                                {4314}new UP_3893: bitstring;
                                                                {4315}out(c, (GetEndpointResponse,pkSess_3891,None,SP_3892,UP_3893))
                                                    )
                                                    else
                                                        {4316}let pkSess_3894: bitstring = fail-any in
                                                        {4317}in(c, =GetEndpointRequest);
                                                        {4318}new SP_3895: bitstring;
                                                        {4319}new UP_3896: bitstring;
                                                        {4320}out(c, (GetEndpointResponse,pkSess_3894,None,SP_3895,UP_3896))
                                            )
                                            else
                                                {4321}let pkSess_3897: bitstring = fail-any in
                                                {4322}in(c, =GetEndpointRequest);
                                                {4323}new SP_3898: bitstring;
                                                {4324}new UP_3899: bitstring;
                                                {4325}out(c, (GetEndpointResponse,pkSess_3897,None,SP_3898,UP_3899))
                                        )
                                        else
                                            {4326}let pkCli_3900: bitstring = pub(sk(Cli_3636)) in
                                            {4327}let v_3901: bool = (Sess_3638 = A) in
                                            (
                                                {4328}if v_3901 then
                                                (
                                                    {4329}let pkSess_3902: bitstring = pub(skA) in
                                                    {4330}in(c, =GetEndpointRequest);
                                                    {4331}new SP_3903: bitstring;
                                                    {4332}new UP_3904: bitstring;
                                                    {4333}out(c, (GetEndpointResponse,pkSess_3902,None,SP_3903,UP_3904))
                                                )
                                                else
                                                    {4334}let v_3905: bool = (Sess_3638 = B) in
                                                    (
                                                        {4335}if v_3905 then
                                                        (
                                                            {4336}let pkSess_3906: bitstring = pub(skB) in
                                                            {4337}in(c, =GetEndpointRequest);
                                                            {4338}new SP_3907: bitstring;
                                                            {4339}new UP_3908: bitstring;
                                                            {4340}out(c, (GetEndpointResponse,pkSess_3906,None,SP_3907,UP_3908))
                                                        )
                                                        else
                                                            {4341}let v_3909: bool = (Sess_3638 = C) in
                                                            (
                                                                {4342}if v_3909 then
                                                                (
                                                                    {4343}let pkSess_3910: bitstring = pub(skC) in
                                                                    {4344}in(c, =GetEndpointRequest);
                                                                    {4345}new SP_3911: bitstring;
                                                                    {4346}new UP_3912: bitstring;
                                                                    {4347}out(c, (GetEndpointResponse,pkSess_3910,None,SP_3911,UP_3912))
                                                                )
                                                                else
                                                                    {4348}let pkSess_3913: bitstring = pub(sk(Sess_3638)) in
                                                                    {4349}in(c, =GetEndpointRequest);
                                                                    {4350}new SP_3914: bitstring;
                                                                    {4351}new UP_3915: bitstring;
                                                                    {4352}out(c, (GetEndpointResponse,pkSess_3913,None,SP_3914,UP_3915))
                                                            )
                                                            else
                                                                {4353}let pkSess_3916: bitstring = fail-any in
                                                                {4354}in(c, =GetEndpointRequest);
                                                                {4355}new SP_3917: bitstring;
                                                                {4356}new UP_3918: bitstring;
                                                                {4357}out(c, (GetEndpointResponse,pkSess_3916,None,SP_3917,UP_3918))
                                                    )
                                                    else
                                                        {4358}let pkSess_3919: bitstring = fail-any in
                                                        {4359}in(c, =GetEndpointRequest);
                                                        {4360}new SP_3920: bitstring;
                                                        {4361}new UP_3921: bitstring;
                                                        {4362}out(c, (GetEndpointResponse,pkSess_3919,None,SP_3920,UP_3921))
                                            )
                                            else
                                                {4363}let pkSess_3922: bitstring = fail-any in
                                                {4364}in(c, =GetEndpointRequest);
                                                {4365}new SP_3923: bitstring;
                                                {4366}new UP_3924: bitstring;
                                                {4367}out(c, (GetEndpointResponse,pkSess_3922,None,SP_3923,UP_3924))
                                    )
                                    else
                                        {4368}let pkCli_3925: bitstring = fail-any in
                                        {4369}let v_3926: bool = (Sess_3638 = A) in
                                        (
                                            {4370}if v_3926 then
                                            (
                                                {4371}let pkSess_3927: bitstring = pub(skA) in
                                                {4372}in(c, =GetEndpointRequest);
                                                {4373}new SP_3928: bitstring;
                                                {4374}new UP_3929: bitstring;
                                                {4375}out(c, (GetEndpointResponse,pkSess_3927,None,SP_3928,UP_3929))
                                            )
                                            else
                                                {4376}let v_3930: bool = (Sess_3638 = B) in
                                                (
                                                    {4377}if v_3930 then
                                                    (
                                                        {4378}let pkSess_3931: bitstring = pub(skB) in
                                                        {4379}in(c, =GetEndpointRequest);
                                                        {4380}new SP_3932: bitstring;
                                                        {4381}new UP_3933: bitstring;
                                                        {4382}out(c, (GetEndpointResponse,pkSess_3931,None,SP_3932,UP_3933))
                                                    )
                                                    else
                                                        {4383}let v_3934: bool = (Sess_3638 = C) in
                                                        (
                                                            {4384}if v_3934 then
                                                            (
                                                                {4385}let pkSess_3935: bitstring = pub(skC) in
                                                                {4386}in(c, =GetEndpointRequest);
                                                                {4387}new SP_3936: bitstring;
                                                                {4388}new UP_3937: bitstring;
                                                                {4389}out(c, (GetEndpointResponse,pkSess_3935,None,SP_3936,UP_3937))
                                                            )
                                                            else
                                                                {4390}let pkSess_3938: bitstring = pub(sk(Sess_3638)) in
                                                                {4391}in(c, =GetEndpointRequest);
                                                                {4392}new SP_3939: bitstring;
                                                                {4393}new UP_3940: bitstring;
                                                                {4394}out(c, (GetEndpointResponse,pkSess_3938,None,SP_3939,UP_3940))
                                                        )
                                                        else
                                                            {4395}let pkSess_3941: bitstring = fail-any in
                                                            {4396}in(c, =GetEndpointRequest);
                                                            {4397}new SP_3942: bitstring;
                                                            {4398}new UP_3943: bitstring;
                                                            {4399}out(c, (GetEndpointResponse,pkSess_3941,None,SP_3942,UP_3943))
                                                )
                                                else
                                                    {4400}let pkSess_3944: bitstring = fail-any in
                                                    {4401}in(c, =GetEndpointRequest);
                                                    {4402}new SP_3945: bitstring;
                                                    {4403}new UP_3946: bitstring;
                                                    {4404}out(c, (GetEndpointResponse,pkSess_3944,None,SP_3945,UP_3946))
                                        )
                                        else
                                            {4405}let pkSess_3947: bitstring = fail-any in
                                            {4406}in(c, =GetEndpointRequest);
                                            {4407}new SP_3948: bitstring;
                                            {4408}new UP_3949: bitstring;
                                            {4409}out(c, (GetEndpointResponse,pkSess_3947,None,SP_3948,UP_3949))
                            )
                            else
                                {4410}let pkCli_3950: bitstring = fail-any in
                                {4411}let v_3951: bool = (Sess_3638 = A) in
                                (
                                    {4412}if v_3951 then
                                    (
                                        {4413}let pkSess_3952: bitstring = pub(skA) in
                                        {4414}in(c, =GetEndpointRequest);
                                        {4415}new SP_3953: bitstring;
                                        {4416}new UP_3954: bitstring;
                                        {4417}out(c, (GetEndpointResponse,pkSess_3952,None,SP_3953,UP_3954))
                                    )
                                    else
                                        {4418}let v_3955: bool = (Sess_3638 = B) in
                                        (
                                            {4419}if v_3955 then
                                            (
                                                {4420}let pkSess_3956: bitstring = pub(skB) in
                                                {4421}in(c, =GetEndpointRequest);
                                                {4422}new SP_3957: bitstring;
                                                {4423}new UP_3958: bitstring;
                                                {4424}out(c, (GetEndpointResponse,pkSess_3956,None,SP_3957,UP_3958))
                                            )
                                            else
                                                {4425}let v_3959: bool = (Sess_3638 = C) in
                                                (
                                                    {4426}if v_3959 then
                                                    (
                                                        {4427}let pkSess_3960: bitstring = pub(skC) in
                                                        {4428}in(c, =GetEndpointRequest);
                                                        {4429}new SP_3961: bitstring;
                                                        {4430}new UP_3962: bitstring;
                                                        {4431}out(c, (GetEndpointResponse,pkSess_3960,None,SP_3961,UP_3962))
                                                    )
                                                    else
                                                        {4432}let pkSess_3963: bitstring = pub(sk(Sess_3638)) in
                                                        {4433}in(c, =GetEndpointRequest);
                                                        {4434}new SP_3964: bitstring;
                                                        {4435}new UP_3965: bitstring;
                                                        {4436}out(c, (GetEndpointResponse,pkSess_3963,None,SP_3964,UP_3965))
                                                )
                                                else
                                                    {4437}let pkSess_3966: bitstring = fail-any in
                                                    {4438}in(c, =GetEndpointRequest);
                                                    {4439}new SP_3967: bitstring;
                                                    {4440}new UP_3968: bitstring;
                                                    {4441}out(c, (GetEndpointResponse,pkSess_3966,None,SP_3967,UP_3968))
                                        )
                                        else
                                            {4442}let pkSess_3969: bitstring = fail-any in
                                            {4443}in(c, =GetEndpointRequest);
                                            {4444}new SP_3970: bitstring;
                                            {4445}new UP_3971: bitstring;
                                            {4446}out(c, (GetEndpointResponse,pkSess_3969,None,SP_3970,UP_3971))
                                )
                                else
                                    {4447}let pkSess_3972: bitstring = fail-any in
                                    {4448}in(c, =GetEndpointRequest);
                                    {4449}new SP_3973: bitstring;
                                    {4450}new UP_3974: bitstring;
                                    {4451}out(c, (GetEndpointResponse,pkSess_3972,None,SP_3973,UP_3974))
                    )
                    else
                        {4452}let pkCli_3975: bitstring = fail-any in
                        {4453}let v_3976: bool = (Sess_3638 = A) in
                        (
                            {4454}if v_3976 then
                            (
                                {4455}let pkSess_3977: bitstring = pub(skA) in
                                {4456}in(c, =GetEndpointRequest);
                                {4457}new SP_3978: bitstring;
                                {4458}new UP_3979: bitstring;
                                {4459}out(c, (GetEndpointResponse,pkSess_3977,None,SP_3978,UP_3979))
                            )
                            else
                                {4460}let v_3980: bool = (Sess_3638 = B) in
                                (
                                    {4461}if v_3980 then
                                    (
                                        {4462}let pkSess_3981: bitstring = pub(skB) in
                                        {4463}in(c, =GetEndpointRequest);
                                        {4464}new SP_3982: bitstring;
                                        {4465}new UP_3983: bitstring;
                                        {4466}out(c, (GetEndpointResponse,pkSess_3981,None,SP_3982,UP_3983))
                                    )
                                    else
                                        {4467}let v_3984: bool = (Sess_3638 = C) in
                                        (
                                            {4468}if v_3984 then
                                            (
                                                {4469}let pkSess_3985: bitstring = pub(skC) in
                                                {4470}in(c, =GetEndpointRequest);
                                                {4471}new SP_3986: bitstring;
                                                {4472}new UP_3987: bitstring;
                                                {4473}out(c, (GetEndpointResponse,pkSess_3985,None,SP_3986,UP_3987))
                                            )
                                            else
                                                {4474}let pkSess_3988: bitstring = pub(sk(Sess_3638)) in
                                                {4475}in(c, =GetEndpointRequest);
                                                {4476}new SP_3989: bitstring;
                                                {4477}new UP_3990: bitstring;
                                                {4478}out(c, (GetEndpointResponse,pkSess_3988,None,SP_3989,UP_3990))
                                        )
                                        else
                                            {4479}let pkSess_3991: bitstring = fail-any in
                                            {4480}in(c, =GetEndpointRequest);
                                            {4481}new SP_3992: bitstring;
                                            {4482}new UP_3993: bitstring;
                                            {4483}out(c, (GetEndpointResponse,pkSess_3991,None,SP_3992,UP_3993))
                                )
                                else
                                    {4484}let pkSess_3994: bitstring = fail-any in
                                    {4485}in(c, =GetEndpointRequest);
                                    {4486}new SP_3995: bitstring;
                                    {4487}new UP_3996: bitstring;
                                    {4488}out(c, (GetEndpointResponse,pkSess_3994,None,SP_3995,UP_3996))
                        )
                        else
                            {4489}let pkSess_3997: bitstring = fail-any in
                            {4490}in(c, =GetEndpointRequest);
                            {4491}new SP_3998: bitstring;
                            {4492}new UP_3999: bitstring;
                            {4493}out(c, (GetEndpointResponse,pkSess_3997,None,SP_3998,UP_3999))
                )
                else
                    {4494}let =true = (Disco_3637 = C) in
                    (
                        {4495}let skDisco_4000: bitstring = skC in
                        {4496}let pkDisco_4001: bitstring = pub(skDisco_4000) in
                        {4497}let v_4002: bool = (Cli_3636 = A) in
                        (
                            {4498}if v_4002 then
                            (
                                {4499}let pkCli_4003: bitstring = pub(skA) in
                                {4500}let v_4004: bool = (Sess_3638 = A) in
                                (
                                    {4501}if v_4004 then
                                    (
                                        {4502}let pkSess_4005: bitstring = pub(skA) in
                                        {4503}in(c, =GetEndpointRequest);
                                        {4504}new SP_4006: bitstring;
                                        {4505}new UP_4007: bitstring;
                                        {4506}out(c, (GetEndpointResponse,pkSess_4005,None,SP_4006,UP_4007))
                                    )
                                    else
                                        {4507}let v_4008: bool = (Sess_3638 = B) in
                                        (
                                            {4508}if v_4008 then
                                            (
                                                {4509}let pkSess_4009: bitstring = pub(skB) in
                                                {4510}in(c, =GetEndpointRequest);
                                                {4511}new SP_4010: bitstring;
                                                {4512}new UP_4011: bitstring;
                                                {4513}out(c, (GetEndpointResponse,pkSess_4009,None,SP_4010,UP_4011))
                                            )
                                            else
                                                {4514}let v_4012: bool = (Sess_3638 = C) in
                                                (
                                                    {4515}if v_4012 then
                                                    (
                                                        {4516}let pkSess_4013: bitstring = pub(skC) in
                                                        {4517}in(c, =GetEndpointRequest);
                                                        {4518}new SP_4014: bitstring;
                                                        {4519}new UP_4015: bitstring;
                                                        {4520}out(c, (GetEndpointResponse,pkSess_4013,None,SP_4014,UP_4015))
                                                    )
                                                    else
                                                        {4521}let pkSess_4016: bitstring = pub(sk(Sess_3638)) in
                                                        {4522}in(c, =GetEndpointRequest);
                                                        {4523}new SP_4017: bitstring;
                                                        {4524}new UP_4018: bitstring;
                                                        {4525}out(c, (GetEndpointResponse,pkSess_4016,None,SP_4017,UP_4018))
                                                )
                                                else
                                                    {4526}let pkSess_4019: bitstring = fail-any in
                                                    {4527}in(c, =GetEndpointRequest);
                                                    {4528}new SP_4020: bitstring;
                                                    {4529}new UP_4021: bitstring;
                                                    {4530}out(c, (GetEndpointResponse,pkSess_4019,None,SP_4020,UP_4021))
                                        )
                                        else
                                            {4531}let pkSess_4022: bitstring = fail-any in
                                            {4532}in(c, =GetEndpointRequest);
                                            {4533}new SP_4023: bitstring;
                                            {4534}new UP_4024: bitstring;
                                            {4535}out(c, (GetEndpointResponse,pkSess_4022,None,SP_4023,UP_4024))
                                )
                                else
                                    {4536}let pkSess_4025: bitstring = fail-any in
                                    {4537}in(c, =GetEndpointRequest);
                                    {4538}new SP_4026: bitstring;
                                    {4539}new UP_4027: bitstring;
                                    {4540}out(c, (GetEndpointResponse,pkSess_4025,None,SP_4026,UP_4027))
                            )
                            else
                                {4541}let v_4028: bool = (Cli_3636 = B) in
                                (
                                    {4542}if v_4028 then
                                    (
                                        {4543}let pkCli_4029: bitstring = pub(skB) in
                                        {4544}let v_4030: bool = (Sess_3638 = A) in
                                        (
                                            {4545}if v_4030 then
                                            (
                                                {4546}let pkSess_4031: bitstring = pub(skA) in
                                                {4547}in(c, =GetEndpointRequest);
                                                {4548}new SP_4032: bitstring;
                                                {4549}new UP_4033: bitstring;
                                                {4550}out(c, (GetEndpointResponse,pkSess_4031,None,SP_4032,UP_4033))
                                            )
                                            else
                                                {4551}let v_4034: bool = (Sess_3638 = B) in
                                                (
                                                    {4552}if v_4034 then
                                                    (
                                                        {4553}let pkSess_4035: bitstring = pub(skB) in
                                                        {4554}in(c, =GetEndpointRequest);
                                                        {4555}new SP_4036: bitstring;
                                                        {4556}new UP_4037: bitstring;
                                                        {4557}out(c, (GetEndpointResponse,pkSess_4035,None,SP_4036,UP_4037))
                                                    )
                                                    else
                                                        {4558}let v_4038: bool = (Sess_3638 = C) in
                                                        (
                                                            {4559}if v_4038 then
                                                            (
                                                                {4560}let pkSess_4039: bitstring = pub(skC) in
                                                                {4561}in(c, =GetEndpointRequest);
                                                                {4562}new SP_4040: bitstring;
                                                                {4563}new UP_4041: bitstring;
                                                                {4564}out(c, (GetEndpointResponse,pkSess_4039,None,SP_4040,UP_4041))
                                                            )
                                                            else
                                                                {4565}let pkSess_4042: bitstring = pub(sk(Sess_3638)) in
                                                                {4566}in(c, =GetEndpointRequest);
                                                                {4567}new SP_4043: bitstring;
                                                                {4568}new UP_4044: bitstring;
                                                                {4569}out(c, (GetEndpointResponse,pkSess_4042,None,SP_4043,UP_4044))
                                                        )
                                                        else
                                                            {4570}let pkSess_4045: bitstring = fail-any in
                                                            {4571}in(c, =GetEndpointRequest);
                                                            {4572}new SP_4046: bitstring;
                                                            {4573}new UP_4047: bitstring;
                                                            {4574}out(c, (GetEndpointResponse,pkSess_4045,None,SP_4046,UP_4047))
                                                )
                                                else
                                                    {4575}let pkSess_4048: bitstring = fail-any in
                                                    {4576}in(c, =GetEndpointRequest);
                                                    {4577}new SP_4049: bitstring;
                                                    {4578}new UP_4050: bitstring;
                                                    {4579}out(c, (GetEndpointResponse,pkSess_4048,None,SP_4049,UP_4050))
                                        )
                                        else
                                            {4580}let pkSess_4051: bitstring = fail-any in
                                            {4581}in(c, =GetEndpointRequest);
                                            {4582}new SP_4052: bitstring;
                                            {4583}new UP_4053: bitstring;
                                            {4584}out(c, (GetEndpointResponse,pkSess_4051,None,SP_4052,UP_4053))
                                    )
                                    else
                                        {4585}let v_4054: bool = (Cli_3636 = C) in
                                        (
                                            {4586}if v_4054 then
                                            (
                                                {4587}let pkCli_4055: bitstring = pub(skC) in
                                                {4588}let v_4056: bool = (Sess_3638 = A) in
                                                (
                                                    {4589}if v_4056 then
                                                    (
                                                        {4590}let pkSess_4057: bitstring = pub(skA) in
                                                        {4591}in(c, =GetEndpointRequest);
                                                        {4592}new SP_4058: bitstring;
                                                        {4593}new UP_4059: bitstring;
                                                        {4594}out(c, (GetEndpointResponse,pkSess_4057,None,SP_4058,UP_4059))
                                                    )
                                                    else
                                                        {4595}let v_4060: bool = (Sess_3638 = B) in
                                                        (
                                                            {4596}if v_4060 then
                                                            (
                                                                {4597}let pkSess_4061: bitstring = pub(skB) in
                                                                {4598}in(c, =GetEndpointRequest);
                                                                {4599}new SP_4062: bitstring;
                                                                {4600}new UP_4063: bitstring;
                                                                {4601}out(c, (GetEndpointResponse,pkSess_4061,None,SP_4062,UP_4063))
                                                            )
                                                            else
                                                                {4602}let v_4064: bool = (Sess_3638 = C) in
                                                                (
                                                                    {4603}if v_4064 then
                                                                    (
                                                                        {4604}let pkSess_4065: bitstring = pub(skC) in
                                                                        {4605}in(c, =GetEndpointRequest);
                                                                        {4606}new SP_4066: bitstring;
                                                                        {4607}new UP_4067: bitstring;
                                                                        {4608}out(c, (GetEndpointResponse,pkSess_4065,None,SP_4066,UP_4067))
                                                                    )
                                                                    else
                                                                        {4609}let pkSess_4068: bitstring = pub(sk(Sess_3638)) in
                                                                        {4610}in(c, =GetEndpointRequest);
                                                                        {4611}new SP_4069: bitstring;
                                                                        {4612}new UP_4070: bitstring;
                                                                        {4613}out(c, (GetEndpointResponse,pkSess_4068,None,SP_4069,UP_4070))
                                                                )
                                                                else
                                                                    {4614}let pkSess_4071: bitstring = fail-any in
                                                                    {4615}in(c, =GetEndpointRequest);
                                                                    {4616}new SP_4072: bitstring;
                                                                    {4617}new UP_4073: bitstring;
                                                                    {4618}out(c, (GetEndpointResponse,pkSess_4071,None,SP_4072,UP_4073))
                                                        )
                                                        else
                                                            {4619}let pkSess_4074: bitstring = fail-any in
                                                            {4620}in(c, =GetEndpointRequest);
                                                            {4621}new SP_4075: bitstring;
                                                            {4622}new UP_4076: bitstring;
                                                            {4623}out(c, (GetEndpointResponse,pkSess_4074,None,SP_4075,UP_4076))
                                                )
                                                else
                                                    {4624}let pkSess_4077: bitstring = fail-any in
                                                    {4625}in(c, =GetEndpointRequest);
                                                    {4626}new SP_4078: bitstring;
                                                    {4627}new UP_4079: bitstring;
                                                    {4628}out(c, (GetEndpointResponse,pkSess_4077,None,SP_4078,UP_4079))
                                            )
                                            else
                                                {4629}let pkCli_4080: bitstring = pub(sk(Cli_3636)) in
                                                {4630}let v_4081: bool = (Sess_3638 = A) in
                                                (
                                                    {4631}if v_4081 then
                                                    (
                                                        {4632}let pkSess_4082: bitstring = pub(skA) in
                                                        {4633}in(c, =GetEndpointRequest);
                                                        {4634}new SP_4083: bitstring;
                                                        {4635}new UP_4084: bitstring;
                                                        {4636}out(c, (GetEndpointResponse,pkSess_4082,None,SP_4083,UP_4084))
                                                    )
                                                    else
                                                        {4637}let v_4085: bool = (Sess_3638 = B) in
                                                        (
                                                            {4638}if v_4085 then
                                                            (
                                                                {4639}let pkSess_4086: bitstring = pub(skB) in
                                                                {4640}in(c, =GetEndpointRequest);
                                                                {4641}new SP_4087: bitstring;
                                                                {4642}new UP_4088: bitstring;
                                                                {4643}out(c, (GetEndpointResponse,pkSess_4086,None,SP_4087,UP_4088))
                                                            )
                                                            else
                                                                {4644}let v_4089: bool = (Sess_3638 = C) in
                                                                (
                                                                    {4645}if v_4089 then
                                                                    (
                                                                        {4646}let pkSess_4090: bitstring = pub(skC) in
                                                                        {4647}in(c, =GetEndpointRequest);
                                                                        {4648}new SP_4091: bitstring;
                                                                        {4649}new UP_4092: bitstring;
                                                                        {4650}out(c, (GetEndpointResponse,pkSess_4090,None,SP_4091,UP_4092))
                                                                    )
                                                                    else
                                                                        {4651}let pkSess_4093: bitstring = pub(sk(Sess_3638)) in
                                                                        {4652}in(c, =GetEndpointRequest);
                                                                        {4653}new SP_4094: bitstring;
                                                                        {4654}new UP_4095: bitstring;
                                                                        {4655}out(c, (GetEndpointResponse,pkSess_4093,None,SP_4094,UP_4095))
                                                                )
                                                                else
                                                                    {4656}let pkSess_4096: bitstring = fail-any in
                                                                    {4657}in(c, =GetEndpointRequest);
                                                                    {4658}new SP_4097: bitstring;
                                                                    {4659}new UP_4098: bitstring;
                                                                    {4660}out(c, (GetEndpointResponse,pkSess_4096,None,SP_4097,UP_4098))
                                                        )
                                                        else
                                                            {4661}let pkSess_4099: bitstring = fail-any in
                                                            {4662}in(c, =GetEndpointRequest);
                                                            {4663}new SP_4100: bitstring;
                                                            {4664}new UP_4101: bitstring;
                                                            {4665}out(c, (GetEndpointResponse,pkSess_4099,None,SP_4100,UP_4101))
                                                )
                                                else
                                                    {4666}let pkSess_4102: bitstring = fail-any in
                                                    {4667}in(c, =GetEndpointRequest);
                                                    {4668}new SP_4103: bitstring;
                                                    {4669}new UP_4104: bitstring;
                                                    {4670}out(c, (GetEndpointResponse,pkSess_4102,None,SP_4103,UP_4104))
                                        )
                                        else
                                            {4671}let pkCli_4105: bitstring = fail-any in
                                            {4672}let v_4106: bool = (Sess_3638 = A) in
                                            (
                                                {4673}if v_4106 then
                                                (
                                                    {4674}let pkSess_4107: bitstring = pub(skA) in
                                                    {4675}in(c, =GetEndpointRequest);
                                                    {4676}new SP_4108: bitstring;
                                                    {4677}new UP_4109: bitstring;
                                                    {4678}out(c, (GetEndpointResponse,pkSess_4107,None,SP_4108,UP_4109))
                                                )
                                                else
                                                    {4679}let v_4110: bool = (Sess_3638 = B) in
                                                    (
                                                        {4680}if v_4110 then
                                                        (
                                                            {4681}let pkSess_4111: bitstring = pub(skB) in
                                                            {4682}in(c, =GetEndpointRequest);
                                                            {4683}new SP_4112: bitstring;
                                                            {4684}new UP_4113: bitstring;
                                                            {4685}out(c, (GetEndpointResponse,pkSess_4111,None,SP_4112,UP_4113))
                                                        )
                                                        else
                                                            {4686}let v_4114: bool = (Sess_3638 = C) in
                                                            (
                                                                {4687}if v_4114 then
                                                                (
                                                                    {4688}let pkSess_4115: bitstring = pub(skC) in
                                                                    {4689}in(c, =GetEndpointRequest);
                                                                    {4690}new SP_4116: bitstring;
                                                                    {4691}new UP_4117: bitstring;
                                                                    {4692}out(c, (GetEndpointResponse,pkSess_4115,None,SP_4116,UP_4117))
                                                                )
                                                                else
                                                                    {4693}let pkSess_4118: bitstring = pub(sk(Sess_3638)) in
                                                                    {4694}in(c, =GetEndpointRequest);
                                                                    {4695}new SP_4119: bitstring;
                                                                    {4696}new UP_4120: bitstring;
                                                                    {4697}out(c, (GetEndpointResponse,pkSess_4118,None,SP_4119,UP_4120))
                                                            )
                                                            else
                                                                {4698}let pkSess_4121: bitstring = fail-any in
                                                                {4699}in(c, =GetEndpointRequest);
                                                                {4700}new SP_4122: bitstring;
                                                                {4701}new UP_4123: bitstring;
                                                                {4702}out(c, (GetEndpointResponse,pkSess_4121,None,SP_4122,UP_4123))
                                                    )
                                                    else
                                                        {4703}let pkSess_4124: bitstring = fail-any in
                                                        {4704}in(c, =GetEndpointRequest);
                                                        {4705}new SP_4125: bitstring;
                                                        {4706}new UP_4126: bitstring;
                                                        {4707}out(c, (GetEndpointResponse,pkSess_4124,None,SP_4125,UP_4126))
                                            )
                                            else
                                                {4708}let pkSess_4127: bitstring = fail-any in
                                                {4709}in(c, =GetEndpointRequest);
                                                {4710}new SP_4128: bitstring;
                                                {4711}new UP_4129: bitstring;
                                                {4712}out(c, (GetEndpointResponse,pkSess_4127,None,SP_4128,UP_4129))
                                )
                                else
                                    {4713}let pkCli_4130: bitstring = fail-any in
                                    {4714}let v_4131: bool = (Sess_3638 = A) in
                                    (
                                        {4715}if v_4131 then
                                        (
                                            {4716}let pkSess_4132: bitstring = pub(skA) in
                                            {4717}in(c, =GetEndpointRequest);
                                            {4718}new SP_4133: bitstring;
                                            {4719}new UP_4134: bitstring;
                                            {4720}out(c, (GetEndpointResponse,pkSess_4132,None,SP_4133,UP_4134))
                                        )
                                        else
                                            {4721}let v_4135: bool = (Sess_3638 = B) in
                                            (
                                                {4722}if v_4135 then
                                                (
                                                    {4723}let pkSess_4136: bitstring = pub(skB) in
                                                    {4724}in(c, =GetEndpointRequest);
                                                    {4725}new SP_4137: bitstring;
                                                    {4726}new UP_4138: bitstring;
                                                    {4727}out(c, (GetEndpointResponse,pkSess_4136,None,SP_4137,UP_4138))
                                                )
                                                else
                                                    {4728}let v_4139: bool = (Sess_3638 = C) in
                                                    (
                                                        {4729}if v_4139 then
                                                        (
                                                            {4730}let pkSess_4140: bitstring = pub(skC) in
                                                            {4731}in(c, =GetEndpointRequest);
                                                            {4732}new SP_4141: bitstring;
                                                            {4733}new UP_4142: bitstring;
                                                            {4734}out(c, (GetEndpointResponse,pkSess_4140,None,SP_4141,UP_4142))
                                                        )
                                                        else
                                                            {4735}let pkSess_4143: bitstring = pub(sk(Sess_3638)) in
                                                            {4736}in(c, =GetEndpointRequest);
                                                            {4737}new SP_4144: bitstring;
                                                            {4738}new UP_4145: bitstring;
                                                            {4739}out(c, (GetEndpointResponse,pkSess_4143,None,SP_4144,UP_4145))
                                                    )
                                                    else
                                                        {4740}let pkSess_4146: bitstring = fail-any in
                                                        {4741}in(c, =GetEndpointRequest);
                                                        {4742}new SP_4147: bitstring;
                                                        {4743}new UP_4148: bitstring;
                                                        {4744}out(c, (GetEndpointResponse,pkSess_4146,None,SP_4147,UP_4148))
                                            )
                                            else
                                                {4745}let pkSess_4149: bitstring = fail-any in
                                                {4746}in(c, =GetEndpointRequest);
                                                {4747}new SP_4150: bitstring;
                                                {4748}new UP_4151: bitstring;
                                                {4749}out(c, (GetEndpointResponse,pkSess_4149,None,SP_4150,UP_4151))
                                    )
                                    else
                                        {4750}let pkSess_4152: bitstring = fail-any in
                                        {4751}in(c, =GetEndpointRequest);
                                        {4752}new SP_4153: bitstring;
                                        {4753}new UP_4154: bitstring;
                                        {4754}out(c, (GetEndpointResponse,pkSess_4152,None,SP_4153,UP_4154))
                        )
                        else
                            {4755}let pkCli_4155: bitstring = fail-any in
                            {4756}let v_4156: bool = (Sess_3638 = A) in
                            (
                                {4757}if v_4156 then
                                (
                                    {4758}let pkSess_4157: bitstring = pub(skA) in
                                    {4759}in(c, =GetEndpointRequest);
                                    {4760}new SP_4158: bitstring;
                                    {4761}new UP_4159: bitstring;
                                    {4762}out(c, (GetEndpointResponse,pkSess_4157,None,SP_4158,UP_4159))
                                )
                                else
                                    {4763}let v_4160: bool = (Sess_3638 = B) in
                                    (
                                        {4764}if v_4160 then
                                        (
                                            {4765}let pkSess_4161: bitstring = pub(skB) in
                                            {4766}in(c, =GetEndpointRequest);
                                            {4767}new SP_4162: bitstring;
                                            {4768}new UP_4163: bitstring;
                                            {4769}out(c, (GetEndpointResponse,pkSess_4161,None,SP_4162,UP_4163))
                                        )
                                        else
                                            {4770}let v_4164: bool = (Sess_3638 = C) in
                                            (
                                                {4771}if v_4164 then
                                                (
                                                    {4772}let pkSess_4165: bitstring = pub(skC) in
                                                    {4773}in(c, =GetEndpointRequest);
                                                    {4774}new SP_4166: bitstring;
                                                    {4775}new UP_4167: bitstring;
                                                    {4776}out(c, (GetEndpointResponse,pkSess_4165,None,SP_4166,UP_4167))
                                                )
                                                else
                                                    {4777}let pkSess_4168: bitstring = pub(sk(Sess_3638)) in
                                                    {4778}in(c, =GetEndpointRequest);
                                                    {4779}new SP_4169: bitstring;
                                                    {4780}new UP_4170: bitstring;
                                                    {4781}out(c, (GetEndpointResponse,pkSess_4168,None,SP_4169,UP_4170))
                                            )
                                            else
                                                {4782}let pkSess_4171: bitstring = fail-any in
                                                {4783}in(c, =GetEndpointRequest);
                                                {4784}new SP_4172: bitstring;
                                                {4785}new UP_4173: bitstring;
                                                {4786}out(c, (GetEndpointResponse,pkSess_4171,None,SP_4172,UP_4173))
                                    )
                                    else
                                        {4787}let pkSess_4174: bitstring = fail-any in
                                        {4788}in(c, =GetEndpointRequest);
                                        {4789}new SP_4175: bitstring;
                                        {4790}new UP_4176: bitstring;
                                        {4791}out(c, (GetEndpointResponse,pkSess_4174,None,SP_4175,UP_4176))
                            )
                            else
                                {4792}let pkSess_4177: bitstring = fail-any in
                                {4793}in(c, =GetEndpointRequest);
                                {4794}new SP_4178: bitstring;
                                {4795}new UP_4179: bitstring;
                                {4796}out(c, (GetEndpointResponse,pkSess_4177,None,SP_4178,UP_4179))
                    )
                    else
                        {4797}let skDisco_4180: bitstring = fail-any in
                        {4798}let pkDisco_4181: bitstring = pub(skDisco_4180) in
                        {4799}let v_4182: bool = (Cli_3636 = A) in
                        (
                            {4800}if v_4182 then
                            (
                                {4801}let pkCli_4183: bitstring = pub(skA) in
                                {4802}let v_4184: bool = (Sess_3638 = A) in
                                (
                                    {4803}if v_4184 then
                                    (
                                        {4804}let pkSess_4185: bitstring = pub(skA) in
                                        {4805}in(c, =GetEndpointRequest);
                                        {4806}new SP_4186: bitstring;
                                        {4807}new UP_4187: bitstring;
                                        {4808}out(c, (GetEndpointResponse,pkSess_4185,None,SP_4186,UP_4187))
                                    )
                                    else
                                        {4809}let v_4188: bool = (Sess_3638 = B) in
                                        (
                                            {4810}if v_4188 then
                                            (
                                                {4811}let pkSess_4189: bitstring = pub(skB) in
                                                {4812}in(c, =GetEndpointRequest);
                                                {4813}new SP_4190: bitstring;
                                                {4814}new UP_4191: bitstring;
                                                {4815}out(c, (GetEndpointResponse,pkSess_4189,None,SP_4190,UP_4191))
                                            )
                                            else
                                                {4816}let v_4192: bool = (Sess_3638 = C) in
                                                (
                                                    {4817}if v_4192 then
                                                    (
                                                        {4818}let pkSess_4193: bitstring = pub(skC) in
                                                        {4819}in(c, =GetEndpointRequest);
                                                        {4820}new SP_4194: bitstring;
                                                        {4821}new UP_4195: bitstring;
                                                        {4822}out(c, (GetEndpointResponse,pkSess_4193,None,SP_4194,UP_4195))
                                                    )
                                                    else
                                                        {4823}let pkSess_4196: bitstring = pub(sk(Sess_3638)) in
                                                        {4824}in(c, =GetEndpointRequest);
                                                        {4825}new SP_4197: bitstring;
                                                        {4826}new UP_4198: bitstring;
                                                        {4827}out(c, (GetEndpointResponse,pkSess_4196,None,SP_4197,UP_4198))
                                                )
                                                else
                                                    {4828}let pkSess_4199: bitstring = fail-any in
                                                    {4829}in(c, =GetEndpointRequest);
                                                    {4830}new SP_4200: bitstring;
                                                    {4831}new UP_4201: bitstring;
                                                    {4832}out(c, (GetEndpointResponse,pkSess_4199,None,SP_4200,UP_4201))
                                        )
                                        else
                                            {4833}let pkSess_4202: bitstring = fail-any in
                                            {4834}in(c, =GetEndpointRequest);
                                            {4835}new SP_4203: bitstring;
                                            {4836}new UP_4204: bitstring;
                                            {4837}out(c, (GetEndpointResponse,pkSess_4202,None,SP_4203,UP_4204))
                                )
                                else
                                    {4838}let pkSess_4205: bitstring = fail-any in
                                    {4839}in(c, =GetEndpointRequest);
                                    {4840}new SP_4206: bitstring;
                                    {4841}new UP_4207: bitstring;
                                    {4842}out(c, (GetEndpointResponse,pkSess_4205,None,SP_4206,UP_4207))
                            )
                            else
                                {4843}let v_4208: bool = (Cli_3636 = B) in
                                (
                                    {4844}if v_4208 then
                                    (
                                        {4845}let pkCli_4209: bitstring = pub(skB) in
                                        {4846}let v_4210: bool = (Sess_3638 = A) in
                                        (
                                            {4847}if v_4210 then
                                            (
                                                {4848}let pkSess_4211: bitstring = pub(skA) in
                                                {4849}in(c, =GetEndpointRequest);
                                                {4850}new SP_4212: bitstring;
                                                {4851}new UP_4213: bitstring;
                                                {4852}out(c, (GetEndpointResponse,pkSess_4211,None,SP_4212,UP_4213))
                                            )
                                            else
                                                {4853}let v_4214: bool = (Sess_3638 = B) in
                                                (
                                                    {4854}if v_4214 then
                                                    (
                                                        {4855}let pkSess_4215: bitstring = pub(skB) in
                                                        {4856}in(c, =GetEndpointRequest);
                                                        {4857}new SP_4216: bitstring;
                                                        {4858}new UP_4217: bitstring;
                                                        {4859}out(c, (GetEndpointResponse,pkSess_4215,None,SP_4216,UP_4217))
                                                    )
                                                    else
                                                        {4860}let v_4218: bool = (Sess_3638 = C) in
                                                        (
                                                            {4861}if v_4218 then
                                                            (
                                                                {4862}let pkSess_4219: bitstring = pub(skC) in
                                                                {4863}in(c, =GetEndpointRequest);
                                                                {4864}new SP_4220: bitstring;
                                                                {4865}new UP_4221: bitstring;
                                                                {4866}out(c, (GetEndpointResponse,pkSess_4219,None,SP_4220,UP_4221))
                                                            )
                                                            else
                                                                {4867}let pkSess_4222: bitstring = pub(sk(Sess_3638)) in
                                                                {4868}in(c, =GetEndpointRequest);
                                                                {4869}new SP_4223: bitstring;
                                                                {4870}new UP_4224: bitstring;
                                                                {4871}out(c, (GetEndpointResponse,pkSess_4222,None,SP_4223,UP_4224))
                                                        )
                                                        else
                                                            {4872}let pkSess_4225: bitstring = fail-any in
                                                            {4873}in(c, =GetEndpointRequest);
                                                            {4874}new SP_4226: bitstring;
                                                            {4875}new UP_4227: bitstring;
                                                            {4876}out(c, (GetEndpointResponse,pkSess_4225,None,SP_4226,UP_4227))
                                                )
                                                else
                                                    {4877}let pkSess_4228: bitstring = fail-any in
                                                    {4878}in(c, =GetEndpointRequest);
                                                    {4879}new SP_4229: bitstring;
                                                    {4880}new UP_4230: bitstring;
                                                    {4881}out(c, (GetEndpointResponse,pkSess_4228,None,SP_4229,UP_4230))
                                        )
                                        else
                                            {4882}let pkSess_4231: bitstring = fail-any in
                                            {4883}in(c, =GetEndpointRequest);
                                            {4884}new SP_4232: bitstring;
                                            {4885}new UP_4233: bitstring;
                                            {4886}out(c, (GetEndpointResponse,pkSess_4231,None,SP_4232,UP_4233))
                                    )
                                    else
                                        {4887}let v_4234: bool = (Cli_3636 = C) in
                                        (
                                            {4888}if v_4234 then
                                            (
                                                {4889}let pkCli_4235: bitstring = pub(skC) in
                                                {4890}let v_4236: bool = (Sess_3638 = A) in
                                                (
                                                    {4891}if v_4236 then
                                                    (
                                                        {4892}let pkSess_4237: bitstring = pub(skA) in
                                                        {4893}in(c, =GetEndpointRequest);
                                                        {4894}new SP_4238: bitstring;
                                                        {4895}new UP_4239: bitstring;
                                                        {4896}out(c, (GetEndpointResponse,pkSess_4237,None,SP_4238,UP_4239))
                                                    )
                                                    else
                                                        {4897}let v_4240: bool = (Sess_3638 = B) in
                                                        (
                                                            {4898}if v_4240 then
                                                            (
                                                                {4899}let pkSess_4241: bitstring = pub(skB) in
                                                                {4900}in(c, =GetEndpointRequest);
                                                                {4901}new SP_4242: bitstring;
                                                                {4902}new UP_4243: bitstring;
                                                                {4903}out(c, (GetEndpointResponse,pkSess_4241,None,SP_4242,UP_4243))
                                                            )
                                                            else
                                                                {4904}let v_4244: bool = (Sess_3638 = C) in
                                                                (
                                                                    {4905}if v_4244 then
                                                                    (
                                                                        {4906}let pkSess_4245: bitstring = pub(skC) in
                                                                        {4907}in(c, =GetEndpointRequest);
                                                                        {4908}new SP_4246: bitstring;
                                                                        {4909}new UP_4247: bitstring;
                                                                        {4910}out(c, (GetEndpointResponse,pkSess_4245,None,SP_4246,UP_4247))
                                                                    )
                                                                    else
                                                                        {4911}let pkSess_4248: bitstring = pub(sk(Sess_3638)) in
                                                                        {4912}in(c, =GetEndpointRequest);
                                                                        {4913}new SP_4249: bitstring;
                                                                        {4914}new UP_4250: bitstring;
                                                                        {4915}out(c, (GetEndpointResponse,pkSess_4248,None,SP_4249,UP_4250))
                                                                )
                                                                else
                                                                    {4916}let pkSess_4251: bitstring = fail-any in
                                                                    {4917}in(c, =GetEndpointRequest);
                                                                    {4918}new SP_4252: bitstring;
                                                                    {4919}new UP_4253: bitstring;
                                                                    {4920}out(c, (GetEndpointResponse,pkSess_4251,None,SP_4252,UP_4253))
                                                        )
                                                        else
                                                            {4921}let pkSess_4254: bitstring = fail-any in
                                                            {4922}in(c, =GetEndpointRequest);
                                                            {4923}new SP_4255: bitstring;
                                                            {4924}new UP_4256: bitstring;
                                                            {4925}out(c, (GetEndpointResponse,pkSess_4254,None,SP_4255,UP_4256))
                                                )
                                                else
                                                    {4926}let pkSess_4257: bitstring = fail-any in
                                                    {4927}in(c, =GetEndpointRequest);
                                                    {4928}new SP_4258: bitstring;
                                                    {4929}new UP_4259: bitstring;
                                                    {4930}out(c, (GetEndpointResponse,pkSess_4257,None,SP_4258,UP_4259))
                                            )
                                            else
                                                {4931}let pkCli_4260: bitstring = pub(sk(Cli_3636)) in
                                                {4932}let v_4261: bool = (Sess_3638 = A) in
                                                (
                                                    {4933}if v_4261 then
                                                    (
                                                        {4934}let pkSess_4262: bitstring = pub(skA) in
                                                        {4935}in(c, =GetEndpointRequest);
                                                        {4936}new SP_4263: bitstring;
                                                        {4937}new UP_4264: bitstring;
                                                        {4938}out(c, (GetEndpointResponse,pkSess_4262,None,SP_4263,UP_4264))
                                                    )
                                                    else
                                                        {4939}let v_4265: bool = (Sess_3638 = B) in
                                                        (
                                                            {4940}if v_4265 then
                                                            (
                                                                {4941}let pkSess_4266: bitstring = pub(skB) in
                                                                {4942}in(c, =GetEndpointRequest);
                                                                {4943}new SP_4267: bitstring;
                                                                {4944}new UP_4268: bitstring;
                                                                {4945}out(c, (GetEndpointResponse,pkSess_4266,None,SP_4267,UP_4268))
                                                            )
                                                            else
                                                                {4946}let v_4269: bool = (Sess_3638 = C) in
                                                                (
                                                                    {4947}if v_4269 then
                                                                    (
                                                                        {4948}let pkSess_4270: bitstring = pub(skC) in
                                                                        {4949}in(c, =GetEndpointRequest);
                                                                        {4950}new SP_4271: bitstring;
                                                                        {4951}new UP_4272: bitstring;
                                                                        {4952}out(c, (GetEndpointResponse,pkSess_4270,None,SP_4271,UP_4272))
                                                                    )
                                                                    else
                                                                        {4953}let pkSess_4273: bitstring = pub(sk(Sess_3638)) in
                                                                        {4954}in(c, =GetEndpointRequest);
                                                                        {4955}new SP_4274: bitstring;
                                                                        {4956}new UP_4275: bitstring;
                                                                        {4957}out(c, (GetEndpointResponse,pkSess_4273,None,SP_4274,UP_4275))
                                                                )
                                                                else
                                                                    {4958}let pkSess_4276: bitstring = fail-any in
                                                                    {4959}in(c, =GetEndpointRequest);
                                                                    {4960}new SP_4277: bitstring;
                                                                    {4961}new UP_4278: bitstring;
                                                                    {4962}out(c, (GetEndpointResponse,pkSess_4276,None,SP_4277,UP_4278))
                                                        )
                                                        else
                                                            {4963}let pkSess_4279: bitstring = fail-any in
                                                            {4964}in(c, =GetEndpointRequest);
                                                            {4965}new SP_4280: bitstring;
                                                            {4966}new UP_4281: bitstring;
                                                            {4967}out(c, (GetEndpointResponse,pkSess_4279,None,SP_4280,UP_4281))
                                                )
                                                else
                                                    {4968}let pkSess_4282: bitstring = fail-any in
                                                    {4969}in(c, =GetEndpointRequest);
                                                    {4970}new SP_4283: bitstring;
                                                    {4971}new UP_4284: bitstring;
                                                    {4972}out(c, (GetEndpointResponse,pkSess_4282,None,SP_4283,UP_4284))
                                        )
                                        else
                                            {4973}let pkCli_4285: bitstring = fail-any in
                                            {4974}let v_4286: bool = (Sess_3638 = A) in
                                            (
                                                {4975}if v_4286 then
                                                (
                                                    {4976}let pkSess_4287: bitstring = pub(skA) in
                                                    {4977}in(c, =GetEndpointRequest);
                                                    {4978}new SP_4288: bitstring;
                                                    {4979}new UP_4289: bitstring;
                                                    {4980}out(c, (GetEndpointResponse,pkSess_4287,None,SP_4288,UP_4289))
                                                )
                                                else
                                                    {4981}let v_4290: bool = (Sess_3638 = B) in
                                                    (
                                                        {4982}if v_4290 then
                                                        (
                                                            {4983}let pkSess_4291: bitstring = pub(skB) in
                                                            {4984}in(c, =GetEndpointRequest);
                                                            {4985}new SP_4292: bitstring;
                                                            {4986}new UP_4293: bitstring;
                                                            {4987}out(c, (GetEndpointResponse,pkSess_4291,None,SP_4292,UP_4293))
                                                        )
                                                        else
                                                            {4988}let v_4294: bool = (Sess_3638 = C) in
                                                            (
                                                                {4989}if v_4294 then
                                                                (
                                                                    {4990}let pkSess_4295: bitstring = pub(skC) in
                                                                    {4991}in(c, =GetEndpointRequest);
                                                                    {4992}new SP_4296: bitstring;
                                                                    {4993}new UP_4297: bitstring;
                                                                    {4994}out(c, (GetEndpointResponse,pkSess_4295,None,SP_4296,UP_4297))
                                                                )
                                                                else
                                                                    {4995}let pkSess_4298: bitstring = pub(sk(Sess_3638)) in
                                                                    {4996}in(c, =GetEndpointRequest);
                                                                    {4997}new SP_4299: bitstring;
                                                                    {4998}new UP_4300: bitstring;
                                                                    {4999}out(c, (GetEndpointResponse,pkSess_4298,None,SP_4299,UP_4300))
                                                            )
                                                            else
                                                                {5000}let pkSess_4301: bitstring = fail-any in
                                                                {5001}in(c, =GetEndpointRequest);
                                                                {5002}new SP_4302: bitstring;
                                                                {5003}new UP_4303: bitstring;
                                                                {5004}out(c, (GetEndpointResponse,pkSess_4301,None,SP_4302,UP_4303))
                                                    )
                                                    else
                                                        {5005}let pkSess_4304: bitstring = fail-any in
                                                        {5006}in(c, =GetEndpointRequest);
                                                        {5007}new SP_4305: bitstring;
                                                        {5008}new UP_4306: bitstring;
                                                        {5009}out(c, (GetEndpointResponse,pkSess_4304,None,SP_4305,UP_4306))
                                            )
                                            else
                                                {5010}let pkSess_4307: bitstring = fail-any in
                                                {5011}in(c, =GetEndpointRequest);
                                                {5012}new SP_4308: bitstring;
                                                {5013}new UP_4309: bitstring;
                                                {5014}out(c, (GetEndpointResponse,pkSess_4307,None,SP_4308,UP_4309))
                                )
                                else
                                    {5015}let pkCli_4310: bitstring = fail-any in
                                    {5016}let v_4311: bool = (Sess_3638 = A) in
                                    (
                                        {5017}if v_4311 then
                                        (
                                            {5018}let pkSess_4312: bitstring = pub(skA) in
                                            {5019}in(c, =GetEndpointRequest);
                                            {5020}new SP_4313: bitstring;
                                            {5021}new UP_4314: bitstring;
                                            {5022}out(c, (GetEndpointResponse,pkSess_4312,None,SP_4313,UP_4314))
                                        )
                                        else
                                            {5023}let v_4315: bool = (Sess_3638 = B) in
                                            (
                                                {5024}if v_4315 then
                                                (
                                                    {5025}let pkSess_4316: bitstring = pub(skB) in
                                                    {5026}in(c, =GetEndpointRequest);
                                                    {5027}new SP_4317: bitstring;
                                                    {5028}new UP_4318: bitstring;
                                                    {5029}out(c, (GetEndpointResponse,pkSess_4316,None,SP_4317,UP_4318))
                                                )
                                                else
                                                    {5030}let v_4319: bool = (Sess_3638 = C) in
                                                    (
                                                        {5031}if v_4319 then
                                                        (
                                                            {5032}let pkSess_4320: bitstring = pub(skC) in
                                                            {5033}in(c, =GetEndpointRequest);
                                                            {5034}new SP_4321: bitstring;
                                                            {5035}new UP_4322: bitstring;
                                                            {5036}out(c, (GetEndpointResponse,pkSess_4320,None,SP_4321,UP_4322))
                                                        )
                                                        else
                                                            {5037}let pkSess_4323: bitstring = pub(sk(Sess_3638)) in
                                                            {5038}in(c, =GetEndpointRequest);
                                                            {5039}new SP_4324: bitstring;
                                                            {5040}new UP_4325: bitstring;
                                                            {5041}out(c, (GetEndpointResponse,pkSess_4323,None,SP_4324,UP_4325))
                                                    )
                                                    else
                                                        {5042}let pkSess_4326: bitstring = fail-any in
                                                        {5043}in(c, =GetEndpointRequest);
                                                        {5044}new SP_4327: bitstring;
                                                        {5045}new UP_4328: bitstring;
                                                        {5046}out(c, (GetEndpointResponse,pkSess_4326,None,SP_4327,UP_4328))
                                            )
                                            else
                                                {5047}let pkSess_4329: bitstring = fail-any in
                                                {5048}in(c, =GetEndpointRequest);
                                                {5049}new SP_4330: bitstring;
                                                {5050}new UP_4331: bitstring;
                                                {5051}out(c, (GetEndpointResponse,pkSess_4329,None,SP_4330,UP_4331))
                                    )
                                    else
                                        {5052}let pkSess_4332: bitstring = fail-any in
                                        {5053}in(c, =GetEndpointRequest);
                                        {5054}new SP_4333: bitstring;
                                        {5055}new UP_4334: bitstring;
                                        {5056}out(c, (GetEndpointResponse,pkSess_4332,None,SP_4333,UP_4334))
                        )
                        else
                            {5057}let pkCli_4335: bitstring = fail-any in
                            {5058}let v_4336: bool = (Sess_3638 = A) in
                            (
                                {5059}if v_4336 then
                                (
                                    {5060}let pkSess_4337: bitstring = pub(skA) in
                                    {5061}in(c, =GetEndpointRequest);
                                    {5062}new SP_4338: bitstring;
                                    {5063}new UP_4339: bitstring;
                                    {5064}out(c, (GetEndpointResponse,pkSess_4337,None,SP_4338,UP_4339))
                                )
                                else
                                    {5065}let v_4340: bool = (Sess_3638 = B) in
                                    (
                                        {5066}if v_4340 then
                                        (
                                            {5067}let pkSess_4341: bitstring = pub(skB) in
                                            {5068}in(c, =GetEndpointRequest);
                                            {5069}new SP_4342: bitstring;
                                            {5070}new UP_4343: bitstring;
                                            {5071}out(c, (GetEndpointResponse,pkSess_4341,None,SP_4342,UP_4343))
                                        )
                                        else
                                            {5072}let v_4344: bool = (Sess_3638 = C) in
                                            (
                                                {5073}if v_4344 then
                                                (
                                                    {5074}let pkSess_4345: bitstring = pub(skC) in
                                                    {5075}in(c, =GetEndpointRequest);
                                                    {5076}new SP_4346: bitstring;
                                                    {5077}new UP_4347: bitstring;
                                                    {5078}out(c, (GetEndpointResponse,pkSess_4345,None,SP_4346,UP_4347))
                                                )
                                                else
                                                    {5079}let pkSess_4348: bitstring = pub(sk(Sess_3638)) in
                                                    {5080}in(c, =GetEndpointRequest);
                                                    {5081}new SP_4349: bitstring;
                                                    {5082}new UP_4350: bitstring;
                                                    {5083}out(c, (GetEndpointResponse,pkSess_4348,None,SP_4349,UP_4350))
                                            )
                                            else
                                                {5084}let pkSess_4351: bitstring = fail-any in
                                                {5085}in(c, =GetEndpointRequest);
                                                {5086}new SP_4352: bitstring;
                                                {5087}new UP_4353: bitstring;
                                                {5088}out(c, (GetEndpointResponse,pkSess_4351,None,SP_4352,UP_4353))
                                    )
                                    else
                                        {5089}let pkSess_4354: bitstring = fail-any in
                                        {5090}in(c, =GetEndpointRequest);
                                        {5091}new SP_4355: bitstring;
                                        {5092}new UP_4356: bitstring;
                                        {5093}out(c, (GetEndpointResponse,pkSess_4354,None,SP_4355,UP_4356))
                            )
                            else
                                {5094}let pkSess_4357: bitstring = fail-any in
                                {5095}in(c, =GetEndpointRequest);
                                {5096}new SP_4358: bitstring;
                                {5097}new UP_4359: bitstring;
                                {5098}out(c, (GetEndpointResponse,pkSess_4357,None,SP_4358,UP_4359))
            )
            else
                {5099}let skDisco_4360: bitstring = fail-any in
                {5100}let pkDisco_4361: bitstring = pub(skDisco_4360) in
                {5101}let v_4362: bool = (Cli_3636 = A) in
                (
                    {5102}if v_4362 then
                    (
                        {5103}let pkCli_4363: bitstring = pub(skA) in
                        {5104}let v_4364: bool = (Sess_3638 = A) in
                        (
                            {5105}if v_4364 then
                            (
                                {5106}let pkSess_4365: bitstring = pub(skA) in
                                {5107}in(c, =GetEndpointRequest);
                                {5108}new SP_4366: bitstring;
                                {5109}new UP_4367: bitstring;
                                {5110}out(c, (GetEndpointResponse,pkSess_4365,None,SP_4366,UP_4367))
                            )
                            else
                                {5111}let v_4368: bool = (Sess_3638 = B) in
                                (
                                    {5112}if v_4368 then
                                    (
                                        {5113}let pkSess_4369: bitstring = pub(skB) in
                                        {5114}in(c, =GetEndpointRequest);
                                        {5115}new SP_4370: bitstring;
                                        {5116}new UP_4371: bitstring;
                                        {5117}out(c, (GetEndpointResponse,pkSess_4369,None,SP_4370,UP_4371))
                                    )
                                    else
                                        {5118}let v_4372: bool = (Sess_3638 = C) in
                                        (
                                            {5119}if v_4372 then
                                            (
                                                {5120}let pkSess_4373: bitstring = pub(skC) in
                                                {5121}in(c, =GetEndpointRequest);
                                                {5122}new SP_4374: bitstring;
                                                {5123}new UP_4375: bitstring;
                                                {5124}out(c, (GetEndpointResponse,pkSess_4373,None,SP_4374,UP_4375))
                                            )
                                            else
                                                {5125}let pkSess_4376: bitstring = pub(sk(Sess_3638)) in
                                                {5126}in(c, =GetEndpointRequest);
                                                {5127}new SP_4377: bitstring;
                                                {5128}new UP_4378: bitstring;
                                                {5129}out(c, (GetEndpointResponse,pkSess_4376,None,SP_4377,UP_4378))
                                        )
                                        else
                                            {5130}let pkSess_4379: bitstring = fail-any in
                                            {5131}in(c, =GetEndpointRequest);
                                            {5132}new SP_4380: bitstring;
                                            {5133}new UP_4381: bitstring;
                                            {5134}out(c, (GetEndpointResponse,pkSess_4379,None,SP_4380,UP_4381))
                                )
                                else
                                    {5135}let pkSess_4382: bitstring = fail-any in
                                    {5136}in(c, =GetEndpointRequest);
                                    {5137}new SP_4383: bitstring;
                                    {5138}new UP_4384: bitstring;
                                    {5139}out(c, (GetEndpointResponse,pkSess_4382,None,SP_4383,UP_4384))
                        )
                        else
                            {5140}let pkSess_4385: bitstring = fail-any in
                            {5141}in(c, =GetEndpointRequest);
                            {5142}new SP_4386: bitstring;
                            {5143}new UP_4387: bitstring;
                            {5144}out(c, (GetEndpointResponse,pkSess_4385,None,SP_4386,UP_4387))
                    )
                    else
                        {5145}let v_4388: bool = (Cli_3636 = B) in
                        (
                            {5146}if v_4388 then
                            (
                                {5147}let pkCli_4389: bitstring = pub(skB) in
                                {5148}let v_4390: bool = (Sess_3638 = A) in
                                (
                                    {5149}if v_4390 then
                                    (
                                        {5150}let pkSess_4391: bitstring = pub(skA) in
                                        {5151}in(c, =GetEndpointRequest);
                                        {5152}new SP_4392: bitstring;
                                        {5153}new UP_4393: bitstring;
                                        {5154}out(c, (GetEndpointResponse,pkSess_4391,None,SP_4392,UP_4393))
                                    )
                                    else
                                        {5155}let v_4394: bool = (Sess_3638 = B) in
                                        (
                                            {5156}if v_4394 then
                                            (
                                                {5157}let pkSess_4395: bitstring = pub(skB) in
                                                {5158}in(c, =GetEndpointRequest);
                                                {5159}new SP_4396: bitstring;
                                                {5160}new UP_4397: bitstring;
                                                {5161}out(c, (GetEndpointResponse,pkSess_4395,None,SP_4396,UP_4397))
                                            )
                                            else
                                                {5162}let v_4398: bool = (Sess_3638 = C) in
                                                (
                                                    {5163}if v_4398 then
                                                    (
                                                        {5164}let pkSess_4399: bitstring = pub(skC) in
                                                        {5165}in(c, =GetEndpointRequest);
                                                        {5166}new SP_4400: bitstring;
                                                        {5167}new UP_4401: bitstring;
                                                        {5168}out(c, (GetEndpointResponse,pkSess_4399,None,SP_4400,UP_4401))
                                                    )
                                                    else
                                                        {5169}let pkSess_4402: bitstring = pub(sk(Sess_3638)) in
                                                        {5170}in(c, =GetEndpointRequest);
                                                        {5171}new SP_4403: bitstring;
                                                        {5172}new UP_4404: bitstring;
                                                        {5173}out(c, (GetEndpointResponse,pkSess_4402,None,SP_4403,UP_4404))
                                                )
                                                else
                                                    {5174}let pkSess_4405: bitstring = fail-any in
                                                    {5175}in(c, =GetEndpointRequest);
                                                    {5176}new SP_4406: bitstring;
                                                    {5177}new UP_4407: bitstring;
                                                    {5178}out(c, (GetEndpointResponse,pkSess_4405,None,SP_4406,UP_4407))
                                        )
                                        else
                                            {5179}let pkSess_4408: bitstring = fail-any in
                                            {5180}in(c, =GetEndpointRequest);
                                            {5181}new SP_4409: bitstring;
                                            {5182}new UP_4410: bitstring;
                                            {5183}out(c, (GetEndpointResponse,pkSess_4408,None,SP_4409,UP_4410))
                                )
                                else
                                    {5184}let pkSess_4411: bitstring = fail-any in
                                    {5185}in(c, =GetEndpointRequest);
                                    {5186}new SP_4412: bitstring;
                                    {5187}new UP_4413: bitstring;
                                    {5188}out(c, (GetEndpointResponse,pkSess_4411,None,SP_4412,UP_4413))
                            )
                            else
                                {5189}let v_4414: bool = (Cli_3636 = C) in
                                (
                                    {5190}if v_4414 then
                                    (
                                        {5191}let pkCli_4415: bitstring = pub(skC) in
                                        {5192}let v_4416: bool = (Sess_3638 = A) in
                                        (
                                            {5193}if v_4416 then
                                            (
                                                {5194}let pkSess_4417: bitstring = pub(skA) in
                                                {5195}in(c, =GetEndpointRequest);
                                                {5196}new SP_4418: bitstring;
                                                {5197}new UP_4419: bitstring;
                                                {5198}out(c, (GetEndpointResponse,pkSess_4417,None,SP_4418,UP_4419))
                                            )
                                            else
                                                {5199}let v_4420: bool = (Sess_3638 = B) in
                                                (
                                                    {5200}if v_4420 then
                                                    (
                                                        {5201}let pkSess_4421: bitstring = pub(skB) in
                                                        {5202}in(c, =GetEndpointRequest);
                                                        {5203}new SP_4422: bitstring;
                                                        {5204}new UP_4423: bitstring;
                                                        {5205}out(c, (GetEndpointResponse,pkSess_4421,None,SP_4422,UP_4423))
                                                    )
                                                    else
                                                        {5206}let v_4424: bool = (Sess_3638 = C) in
                                                        (
                                                            {5207}if v_4424 then
                                                            (
                                                                {5208}let pkSess_4425: bitstring = pub(skC) in
                                                                {5209}in(c, =GetEndpointRequest);
                                                                {5210}new SP_4426: bitstring;
                                                                {5211}new UP_4427: bitstring;
                                                                {5212}out(c, (GetEndpointResponse,pkSess_4425,None,SP_4426,UP_4427))
                                                            )
                                                            else
                                                                {5213}let pkSess_4428: bitstring = pub(sk(Sess_3638)) in
                                                                {5214}in(c, =GetEndpointRequest);
                                                                {5215}new SP_4429: bitstring;
                                                                {5216}new UP_4430: bitstring;
                                                                {5217}out(c, (GetEndpointResponse,pkSess_4428,None,SP_4429,UP_4430))
                                                        )
                                                        else
                                                            {5218}let pkSess_4431: bitstring = fail-any in
                                                            {5219}in(c, =GetEndpointRequest);
                                                            {5220}new SP_4432: bitstring;
                                                            {5221}new UP_4433: bitstring;
                                                            {5222}out(c, (GetEndpointResponse,pkSess_4431,None,SP_4432,UP_4433))
                                                )
                                                else
                                                    {5223}let pkSess_4434: bitstring = fail-any in
                                                    {5224}in(c, =GetEndpointRequest);
                                                    {5225}new SP_4435: bitstring;
                                                    {5226}new UP_4436: bitstring;
                                                    {5227}out(c, (GetEndpointResponse,pkSess_4434,None,SP_4435,UP_4436))
                                        )
                                        else
                                            {5228}let pkSess_4437: bitstring = fail-any in
                                            {5229}in(c, =GetEndpointRequest);
                                            {5230}new SP_4438: bitstring;
                                            {5231}new UP_4439: bitstring;
                                            {5232}out(c, (GetEndpointResponse,pkSess_4437,None,SP_4438,UP_4439))
                                    )
                                    else
                                        {5233}let pkCli_4440: bitstring = pub(sk(Cli_3636)) in
                                        {5234}let v_4441: bool = (Sess_3638 = A) in
                                        (
                                            {5235}if v_4441 then
                                            (
                                                {5236}let pkSess_4442: bitstring = pub(skA) in
                                                {5237}in(c, =GetEndpointRequest);
                                                {5238}new SP_4443: bitstring;
                                                {5239}new UP_4444: bitstring;
                                                {5240}out(c, (GetEndpointResponse,pkSess_4442,None,SP_4443,UP_4444))
                                            )
                                            else
                                                {5241}let v_4445: bool = (Sess_3638 = B) in
                                                (
                                                    {5242}if v_4445 then
                                                    (
                                                        {5243}let pkSess_4446: bitstring = pub(skB) in
                                                        {5244}in(c, =GetEndpointRequest);
                                                        {5245}new SP_4447: bitstring;
                                                        {5246}new UP_4448: bitstring;
                                                        {5247}out(c, (GetEndpointResponse,pkSess_4446,None,SP_4447,UP_4448))
                                                    )
                                                    else
                                                        {5248}let v_4449: bool = (Sess_3638 = C) in
                                                        (
                                                            {5249}if v_4449 then
                                                            (
                                                                {5250}let pkSess_4450: bitstring = pub(skC) in
                                                                {5251}in(c, =GetEndpointRequest);
                                                                {5252}new SP_4451: bitstring;
                                                                {5253}new UP_4452: bitstring;
                                                                {5254}out(c, (GetEndpointResponse,pkSess_4450,None,SP_4451,UP_4452))
                                                            )
                                                            else
                                                                {5255}let pkSess_4453: bitstring = pub(sk(Sess_3638)) in
                                                                {5256}in(c, =GetEndpointRequest);
                                                                {5257}new SP_4454: bitstring;
                                                                {5258}new UP_4455: bitstring;
                                                                {5259}out(c, (GetEndpointResponse,pkSess_4453,None,SP_4454,UP_4455))
                                                        )
                                                        else
                                                            {5260}let pkSess_4456: bitstring = fail-any in
                                                            {5261}in(c, =GetEndpointRequest);
                                                            {5262}new SP_4457: bitstring;
                                                            {5263}new UP_4458: bitstring;
                                                            {5264}out(c, (GetEndpointResponse,pkSess_4456,None,SP_4457,UP_4458))
                                                )
                                                else
                                                    {5265}let pkSess_4459: bitstring = fail-any in
                                                    {5266}in(c, =GetEndpointRequest);
                                                    {5267}new SP_4460: bitstring;
                                                    {5268}new UP_4461: bitstring;
                                                    {5269}out(c, (GetEndpointResponse,pkSess_4459,None,SP_4460,UP_4461))
                                        )
                                        else
                                            {5270}let pkSess_4462: bitstring = fail-any in
                                            {5271}in(c, =GetEndpointRequest);
                                            {5272}new SP_4463: bitstring;
                                            {5273}new UP_4464: bitstring;
                                            {5274}out(c, (GetEndpointResponse,pkSess_4462,None,SP_4463,UP_4464))
                                )
                                else
                                    {5275}let pkCli_4465: bitstring = fail-any in
                                    {5276}let v_4466: bool = (Sess_3638 = A) in
                                    (
                                        {5277}if v_4466 then
                                        (
                                            {5278}let pkSess_4467: bitstring = pub(skA) in
                                            {5279}in(c, =GetEndpointRequest);
                                            {5280}new SP_4468: bitstring;
                                            {5281}new UP_4469: bitstring;
                                            {5282}out(c, (GetEndpointResponse,pkSess_4467,None,SP_4468,UP_4469))
                                        )
                                        else
                                            {5283}let v_4470: bool = (Sess_3638 = B) in
                                            (
                                                {5284}if v_4470 then
                                                (
                                                    {5285}let pkSess_4471: bitstring = pub(skB) in
                                                    {5286}in(c, =GetEndpointRequest);
                                                    {5287}new SP_4472: bitstring;
                                                    {5288}new UP_4473: bitstring;
                                                    {5289}out(c, (GetEndpointResponse,pkSess_4471,None,SP_4472,UP_4473))
                                                )
                                                else
                                                    {5290}let v_4474: bool = (Sess_3638 = C) in
                                                    (
                                                        {5291}if v_4474 then
                                                        (
                                                            {5292}let pkSess_4475: bitstring = pub(skC) in
                                                            {5293}in(c, =GetEndpointRequest);
                                                            {5294}new SP_4476: bitstring;
                                                            {5295}new UP_4477: bitstring;
                                                            {5296}out(c, (GetEndpointResponse,pkSess_4475,None,SP_4476,UP_4477))
                                                        )
                                                        else
                                                            {5297}let pkSess_4478: bitstring = pub(sk(Sess_3638)) in
                                                            {5298}in(c, =GetEndpointRequest);
                                                            {5299}new SP_4479: bitstring;
                                                            {5300}new UP_4480: bitstring;
                                                            {5301}out(c, (GetEndpointResponse,pkSess_4478,None,SP_4479,UP_4480))
                                                    )
                                                    else
                                                        {5302}let pkSess_4481: bitstring = fail-any in
                                                        {5303}in(c, =GetEndpointRequest);
                                                        {5304}new SP_4482: bitstring;
                                                        {5305}new UP_4483: bitstring;
                                                        {5306}out(c, (GetEndpointResponse,pkSess_4481,None,SP_4482,UP_4483))
                                            )
                                            else
                                                {5307}let pkSess_4484: bitstring = fail-any in
                                                {5308}in(c, =GetEndpointRequest);
                                                {5309}new SP_4485: bitstring;
                                                {5310}new UP_4486: bitstring;
                                                {5311}out(c, (GetEndpointResponse,pkSess_4484,None,SP_4485,UP_4486))
                                    )
                                    else
                                        {5312}let pkSess_4487: bitstring = fail-any in
                                        {5313}in(c, =GetEndpointRequest);
                                        {5314}new SP_4488: bitstring;
                                        {5315}new UP_4489: bitstring;
                                        {5316}out(c, (GetEndpointResponse,pkSess_4487,None,SP_4488,UP_4489))
                        )
                        else
                            {5317}let pkCli_4490: bitstring = fail-any in
                            {5318}let v_4491: bool = (Sess_3638 = A) in
                            (
                                {5319}if v_4491 then
                                (
                                    {5320}let pkSess_4492: bitstring = pub(skA) in
                                    {5321}in(c, =GetEndpointRequest);
                                    {5322}new SP_4493: bitstring;
                                    {5323}new UP_4494: bitstring;
                                    {5324}out(c, (GetEndpointResponse,pkSess_4492,None,SP_4493,UP_4494))
                                )
                                else
                                    {5325}let v_4495: bool = (Sess_3638 = B) in
                                    (
                                        {5326}if v_4495 then
                                        (
                                            {5327}let pkSess_4496: bitstring = pub(skB) in
                                            {5328}in(c, =GetEndpointRequest);
                                            {5329}new SP_4497: bitstring;
                                            {5330}new UP_4498: bitstring;
                                            {5331}out(c, (GetEndpointResponse,pkSess_4496,None,SP_4497,UP_4498))
                                        )
                                        else
                                            {5332}let v_4499: bool = (Sess_3638 = C) in
                                            (
                                                {5333}if v_4499 then
                                                (
                                                    {5334}let pkSess_4500: bitstring = pub(skC) in
                                                    {5335}in(c, =GetEndpointRequest);
                                                    {5336}new SP_4501: bitstring;
                                                    {5337}new UP_4502: bitstring;
                                                    {5338}out(c, (GetEndpointResponse,pkSess_4500,None,SP_4501,UP_4502))
                                                )
                                                else
                                                    {5339}let pkSess_4503: bitstring = pub(sk(Sess_3638)) in
                                                    {5340}in(c, =GetEndpointRequest);
                                                    {5341}new SP_4504: bitstring;
                                                    {5342}new UP_4505: bitstring;
                                                    {5343}out(c, (GetEndpointResponse,pkSess_4503,None,SP_4504,UP_4505))
                                            )
                                            else
                                                {5344}let pkSess_4506: bitstring = fail-any in
                                                {5345}in(c, =GetEndpointRequest);
                                                {5346}new SP_4507: bitstring;
                                                {5347}new UP_4508: bitstring;
                                                {5348}out(c, (GetEndpointResponse,pkSess_4506,None,SP_4507,UP_4508))
                                    )
                                    else
                                        {5349}let pkSess_4509: bitstring = fail-any in
                                        {5350}in(c, =GetEndpointRequest);
                                        {5351}new SP_4510: bitstring;
                                        {5352}new UP_4511: bitstring;
                                        {5353}out(c, (GetEndpointResponse,pkSess_4509,None,SP_4510,UP_4511))
                            )
                            else
                                {5354}let pkSess_4512: bitstring = fail-any in
                                {5355}in(c, =GetEndpointRequest);
                                {5356}new SP_4513: bitstring;
                                {5357}new UP_4514: bitstring;
                                {5358}out(c, (GetEndpointResponse,pkSess_4512,None,SP_4513,UP_4514))
                )
                else
                    {5359}let pkCli_4515: bitstring = fail-any in
                    {5360}let v_4516: bool = (Sess_3638 = A) in
                    (
                        {5361}if v_4516 then
                        (
                            {5362}let pkSess_4517: bitstring = pub(skA) in
                            {5363}in(c, =GetEndpointRequest);
                            {5364}new SP_4518: bitstring;
                            {5365}new UP_4519: bitstring;
                            {5366}out(c, (GetEndpointResponse,pkSess_4517,None,SP_4518,UP_4519))
                        )
                        else
                            {5367}let v_4520: bool = (Sess_3638 = B) in
                            (
                                {5368}if v_4520 then
                                (
                                    {5369}let pkSess_4521: bitstring = pub(skB) in
                                    {5370}in(c, =GetEndpointRequest);
                                    {5371}new SP_4522: bitstring;
                                    {5372}new UP_4523: bitstring;
                                    {5373}out(c, (GetEndpointResponse,pkSess_4521,None,SP_4522,UP_4523))
                                )
                                else
                                    {5374}let v_4524: bool = (Sess_3638 = C) in
                                    (
                                        {5375}if v_4524 then
                                        (
                                            {5376}let pkSess_4525: bitstring = pub(skC) in
                                            {5377}in(c, =GetEndpointRequest);
                                            {5378}new SP_4526: bitstring;
                                            {5379}new UP_4527: bitstring;
                                            {5380}out(c, (GetEndpointResponse,pkSess_4525,None,SP_4526,UP_4527))
                                        )
                                        else
                                            {5381}let pkSess_4528: bitstring = pub(sk(Sess_3638)) in
                                            {5382}in(c, =GetEndpointRequest);
                                            {5383}new SP_4529: bitstring;
                                            {5384}new UP_4530: bitstring;
                                            {5385}out(c, (GetEndpointResponse,pkSess_4528,None,SP_4529,UP_4530))
                                    )
                                    else
                                        {5386}let pkSess_4531: bitstring = fail-any in
                                        {5387}in(c, =GetEndpointRequest);
                                        {5388}new SP_4532: bitstring;
                                        {5389}new UP_4533: bitstring;
                                        {5390}out(c, (GetEndpointResponse,pkSess_4531,None,SP_4532,UP_4533))
                            )
                            else
                                {5391}let pkSess_4534: bitstring = fail-any in
                                {5392}in(c, =GetEndpointRequest);
                                {5393}new SP_4535: bitstring;
                                {5394}new UP_4536: bitstring;
                                {5395}out(c, (GetEndpointResponse,pkSess_4534,None,SP_4535,UP_4536))
                    )
                    else
                        {5396}let pkSess_4537: bitstring = fail-any in
                        {5397}in(c, =GetEndpointRequest);
                        {5398}new SP_4538: bitstring;
                        {5399}new UP_4539: bitstring;
                        {5400}out(c, (GetEndpointResponse,pkSess_4537,None,SP_4538,UP_4539))
    )
    else
        {5401}let skDisco_4540: bitstring = fail-any in
        {5402}let pkDisco_4541: bitstring = pub(skDisco_4540) in
        {5403}let v_4542: bool = (Cli_3636 = A) in
        (
            {5404}if v_4542 then
            (
                {5405}let pkCli_4543: bitstring = pub(skA) in
                {5406}let v_4544: bool = (Sess_3638 = A) in
                (
                    {5407}if v_4544 then
                    (
                        {5408}let pkSess_4545: bitstring = pub(skA) in
                        {5409}in(c, =GetEndpointRequest);
                        {5410}new SP_4546: bitstring;
                        {5411}new UP_4547: bitstring;
                        {5412}out(c, (GetEndpointResponse,pkSess_4545,None,SP_4546,UP_4547))
                    )
                    else
                        {5413}let v_4548: bool = (Sess_3638 = B) in
                        (
                            {5414}if v_4548 then
                            (
                                {5415}let pkSess_4549: bitstring = pub(skB) in
                                {5416}in(c, =GetEndpointRequest);
                                {5417}new SP_4550: bitstring;
                                {5418}new UP_4551: bitstring;
                                {5419}out(c, (GetEndpointResponse,pkSess_4549,None,SP_4550,UP_4551))
                            )
                            else
                                {5420}let v_4552: bool = (Sess_3638 = C) in
                                (
                                    {5421}if v_4552 then
                                    (
                                        {5422}let pkSess_4553: bitstring = pub(skC) in
                                        {5423}in(c, =GetEndpointRequest);
                                        {5424}new SP_4554: bitstring;
                                        {5425}new UP_4555: bitstring;
                                        {5426}out(c, (GetEndpointResponse,pkSess_4553,None,SP_4554,UP_4555))
                                    )
                                    else
                                        {5427}let pkSess_4556: bitstring = pub(sk(Sess_3638)) in
                                        {5428}in(c, =GetEndpointRequest);
                                        {5429}new SP_4557: bitstring;
                                        {5430}new UP_4558: bitstring;
                                        {5431}out(c, (GetEndpointResponse,pkSess_4556,None,SP_4557,UP_4558))
                                )
                                else
                                    {5432}let pkSess_4559: bitstring = fail-any in
                                    {5433}in(c, =GetEndpointRequest);
                                    {5434}new SP_4560: bitstring;
                                    {5435}new UP_4561: bitstring;
                                    {5436}out(c, (GetEndpointResponse,pkSess_4559,None,SP_4560,UP_4561))
                        )
                        else
                            {5437}let pkSess_4562: bitstring = fail-any in
                            {5438}in(c, =GetEndpointRequest);
                            {5439}new SP_4563: bitstring;
                            {5440}new UP_4564: bitstring;
                            {5441}out(c, (GetEndpointResponse,pkSess_4562,None,SP_4563,UP_4564))
                )
                else
                    {5442}let pkSess_4565: bitstring = fail-any in
                    {5443}in(c, =GetEndpointRequest);
                    {5444}new SP_4566: bitstring;
                    {5445}new UP_4567: bitstring;
                    {5446}out(c, (GetEndpointResponse,pkSess_4565,None,SP_4566,UP_4567))
            )
            else
                {5447}let v_4568: bool = (Cli_3636 = B) in
                (
                    {5448}if v_4568 then
                    (
                        {5449}let pkCli_4569: bitstring = pub(skB) in
                        {5450}let v_4570: bool = (Sess_3638 = A) in
                        (
                            {5451}if v_4570 then
                            (
                                {5452}let pkSess_4571: bitstring = pub(skA) in
                                {5453}in(c, =GetEndpointRequest);
                                {5454}new SP_4572: bitstring;
                                {5455}new UP_4573: bitstring;
                                {5456}out(c, (GetEndpointResponse,pkSess_4571,None,SP_4572,UP_4573))
                            )
                            else
                                {5457}let v_4574: bool = (Sess_3638 = B) in
                                (
                                    {5458}if v_4574 then
                                    (
                                        {5459}let pkSess_4575: bitstring = pub(skB) in
                                        {5460}in(c, =GetEndpointRequest);
                                        {5461}new SP_4576: bitstring;
                                        {5462}new UP_4577: bitstring;
                                        {5463}out(c, (GetEndpointResponse,pkSess_4575,None,SP_4576,UP_4577))
                                    )
                                    else
                                        {5464}let v_4578: bool = (Sess_3638 = C) in
                                        (
                                            {5465}if v_4578 then
                                            (
                                                {5466}let pkSess_4579: bitstring = pub(skC) in
                                                {5467}in(c, =GetEndpointRequest);
                                                {5468}new SP_4580: bitstring;
                                                {5469}new UP_4581: bitstring;
                                                {5470}out(c, (GetEndpointResponse,pkSess_4579,None,SP_4580,UP_4581))
                                            )
                                            else
                                                {5471}let pkSess_4582: bitstring = pub(sk(Sess_3638)) in
                                                {5472}in(c, =GetEndpointRequest);
                                                {5473}new SP_4583: bitstring;
                                                {5474}new UP_4584: bitstring;
                                                {5475}out(c, (GetEndpointResponse,pkSess_4582,None,SP_4583,UP_4584))
                                        )
                                        else
                                            {5476}let pkSess_4585: bitstring = fail-any in
                                            {5477}in(c, =GetEndpointRequest);
                                            {5478}new SP_4586: bitstring;
                                            {5479}new UP_4587: bitstring;
                                            {5480}out(c, (GetEndpointResponse,pkSess_4585,None,SP_4586,UP_4587))
                                )
                                else
                                    {5481}let pkSess_4588: bitstring = fail-any in
                                    {5482}in(c, =GetEndpointRequest);
                                    {5483}new SP_4589: bitstring;
                                    {5484}new UP_4590: bitstring;
                                    {5485}out(c, (GetEndpointResponse,pkSess_4588,None,SP_4589,UP_4590))
                        )
                        else
                            {5486}let pkSess_4591: bitstring = fail-any in
                            {5487}in(c, =GetEndpointRequest);
                            {5488}new SP_4592: bitstring;
                            {5489}new UP_4593: bitstring;
                            {5490}out(c, (GetEndpointResponse,pkSess_4591,None,SP_4592,UP_4593))
                    )
                    else
                        {5491}let v_4594: bool = (Cli_3636 = C) in
                        (
                            {5492}if v_4594 then
                            (
                                {5493}let pkCli_4595: bitstring = pub(skC) in
                                {5494}let v_4596: bool = (Sess_3638 = A) in
                                (
                                    {5495}if v_4596 then
                                    (
                                        {5496}let pkSess_4597: bitstring = pub(skA) in
                                        {5497}in(c, =GetEndpointRequest);
                                        {5498}new SP_4598: bitstring;
                                        {5499}new UP_4599: bitstring;
                                        {5500}out(c, (GetEndpointResponse,pkSess_4597,None,SP_4598,UP_4599))
                                    )
                                    else
                                        {5501}let v_4600: bool = (Sess_3638 = B) in
                                        (
                                            {5502}if v_4600 then
                                            (
                                                {5503}let pkSess_4601: bitstring = pub(skB) in
                                                {5504}in(c, =GetEndpointRequest);
                                                {5505}new SP_4602: bitstring;
                                                {5506}new UP_4603: bitstring;
                                                {5507}out(c, (GetEndpointResponse,pkSess_4601,None,SP_4602,UP_4603))
                                            )
                                            else
                                                {5508}let v_4604: bool = (Sess_3638 = C) in
                                                (
                                                    {5509}if v_4604 then
                                                    (
                                                        {5510}let pkSess_4605: bitstring = pub(skC) in
                                                        {5511}in(c, =GetEndpointRequest);
                                                        {5512}new SP_4606: bitstring;
                                                        {5513}new UP_4607: bitstring;
                                                        {5514}out(c, (GetEndpointResponse,pkSess_4605,None,SP_4606,UP_4607))
                                                    )
                                                    else
                                                        {5515}let pkSess_4608: bitstring = pub(sk(Sess_3638)) in
                                                        {5516}in(c, =GetEndpointRequest);
                                                        {5517}new SP_4609: bitstring;
                                                        {5518}new UP_4610: bitstring;
                                                        {5519}out(c, (GetEndpointResponse,pkSess_4608,None,SP_4609,UP_4610))
                                                )
                                                else
                                                    {5520}let pkSess_4611: bitstring = fail-any in
                                                    {5521}in(c, =GetEndpointRequest);
                                                    {5522}new SP_4612: bitstring;
                                                    {5523}new UP_4613: bitstring;
                                                    {5524}out(c, (GetEndpointResponse,pkSess_4611,None,SP_4612,UP_4613))
                                        )
                                        else
                                            {5525}let pkSess_4614: bitstring = fail-any in
                                            {5526}in(c, =GetEndpointRequest);
                                            {5527}new SP_4615: bitstring;
                                            {5528}new UP_4616: bitstring;
                                            {5529}out(c, (GetEndpointResponse,pkSess_4614,None,SP_4615,UP_4616))
                                )
                                else
                                    {5530}let pkSess_4617: bitstring = fail-any in
                                    {5531}in(c, =GetEndpointRequest);
                                    {5532}new SP_4618: bitstring;
                                    {5533}new UP_4619: bitstring;
                                    {5534}out(c, (GetEndpointResponse,pkSess_4617,None,SP_4618,UP_4619))
                            )
                            else
                                {5535}let pkCli_4620: bitstring = pub(sk(Cli_3636)) in
                                {5536}let v_4621: bool = (Sess_3638 = A) in
                                (
                                    {5537}if v_4621 then
                                    (
                                        {5538}let pkSess_4622: bitstring = pub(skA) in
                                        {5539}in(c, =GetEndpointRequest);
                                        {5540}new SP_4623: bitstring;
                                        {5541}new UP_4624: bitstring;
                                        {5542}out(c, (GetEndpointResponse,pkSess_4622,None,SP_4623,UP_4624))
                                    )
                                    else
                                        {5543}let v_4625: bool = (Sess_3638 = B) in
                                        (
                                            {5544}if v_4625 then
                                            (
                                                {5545}let pkSess_4626: bitstring = pub(skB) in
                                                {5546}in(c, =GetEndpointRequest);
                                                {5547}new SP_4627: bitstring;
                                                {5548}new UP_4628: bitstring;
                                                {5549}out(c, (GetEndpointResponse,pkSess_4626,None,SP_4627,UP_4628))
                                            )
                                            else
                                                {5550}let v_4629: bool = (Sess_3638 = C) in
                                                (
                                                    {5551}if v_4629 then
                                                    (
                                                        {5552}let pkSess_4630: bitstring = pub(skC) in
                                                        {5553}in(c, =GetEndpointRequest);
                                                        {5554}new SP_4631: bitstring;
                                                        {5555}new UP_4632: bitstring;
                                                        {5556}out(c, (GetEndpointResponse,pkSess_4630,None,SP_4631,UP_4632))
                                                    )
                                                    else
                                                        {5557}let pkSess_4633: bitstring = pub(sk(Sess_3638)) in
                                                        {5558}in(c, =GetEndpointRequest);
                                                        {5559}new SP_4634: bitstring;
                                                        {5560}new UP_4635: bitstring;
                                                        {5561}out(c, (GetEndpointResponse,pkSess_4633,None,SP_4634,UP_4635))
                                                )
                                                else
                                                    {5562}let pkSess_4636: bitstring = fail-any in
                                                    {5563}in(c, =GetEndpointRequest);
                                                    {5564}new SP_4637: bitstring;
                                                    {5565}new UP_4638: bitstring;
                                                    {5566}out(c, (GetEndpointResponse,pkSess_4636,None,SP_4637,UP_4638))
                                        )
                                        else
                                            {5567}let pkSess_4639: bitstring = fail-any in
                                            {5568}in(c, =GetEndpointRequest);
                                            {5569}new SP_4640: bitstring;
                                            {5570}new UP_4641: bitstring;
                                            {5571}out(c, (GetEndpointResponse,pkSess_4639,None,SP_4640,UP_4641))
                                )
                                else
                                    {5572}let pkSess_4642: bitstring = fail-any in
                                    {5573}in(c, =GetEndpointRequest);
                                    {5574}new SP_4643: bitstring;
                                    {5575}new UP_4644: bitstring;
                                    {5576}out(c, (GetEndpointResponse,pkSess_4642,None,SP_4643,UP_4644))
                        )
                        else
                            {5577}let pkCli_4645: bitstring = fail-any in
                            {5578}let v_4646: bool = (Sess_3638 = A) in
                            (
                                {5579}if v_4646 then
                                (
                                    {5580}let pkSess_4647: bitstring = pub(skA) in
                                    {5581}in(c, =GetEndpointRequest);
                                    {5582}new SP_4648: bitstring;
                                    {5583}new UP_4649: bitstring;
                                    {5584}out(c, (GetEndpointResponse,pkSess_4647,None,SP_4648,UP_4649))
                                )
                                else
                                    {5585}let v_4650: bool = (Sess_3638 = B) in
                                    (
                                        {5586}if v_4650 then
                                        (
                                            {5587}let pkSess_4651: bitstring = pub(skB) in
                                            {5588}in(c, =GetEndpointRequest);
                                            {5589}new SP_4652: bitstring;
                                            {5590}new UP_4653: bitstring;
                                            {5591}out(c, (GetEndpointResponse,pkSess_4651,None,SP_4652,UP_4653))
                                        )
                                        else
                                            {5592}let v_4654: bool = (Sess_3638 = C) in
                                            (
                                                {5593}if v_4654 then
                                                (
                                                    {5594}let pkSess_4655: bitstring = pub(skC) in
                                                    {5595}in(c, =GetEndpointRequest);
                                                    {5596}new SP_4656: bitstring;
                                                    {5597}new UP_4657: bitstring;
                                                    {5598}out(c, (GetEndpointResponse,pkSess_4655,None,SP_4656,UP_4657))
                                                )
                                                else
                                                    {5599}let pkSess_4658: bitstring = pub(sk(Sess_3638)) in
                                                    {5600}in(c, =GetEndpointRequest);
                                                    {5601}new SP_4659: bitstring;
                                                    {5602}new UP_4660: bitstring;
                                                    {5603}out(c, (GetEndpointResponse,pkSess_4658,None,SP_4659,UP_4660))
                                            )
                                            else
                                                {5604}let pkSess_4661: bitstring = fail-any in
                                                {5605}in(c, =GetEndpointRequest);
                                                {5606}new SP_4662: bitstring;
                                                {5607}new UP_4663: bitstring;
                                                {5608}out(c, (GetEndpointResponse,pkSess_4661,None,SP_4662,UP_4663))
                                    )
                                    else
                                        {5609}let pkSess_4664: bitstring = fail-any in
                                        {5610}in(c, =GetEndpointRequest);
                                        {5611}new SP_4665: bitstring;
                                        {5612}new UP_4666: bitstring;
                                        {5613}out(c, (GetEndpointResponse,pkSess_4664,None,SP_4665,UP_4666))
                            )
                            else
                                {5614}let pkSess_4667: bitstring = fail-any in
                                {5615}in(c, =GetEndpointRequest);
                                {5616}new SP_4668: bitstring;
                                {5617}new UP_4669: bitstring;
                                {5618}out(c, (GetEndpointResponse,pkSess_4667,None,SP_4668,UP_4669))
                )
                else
                    {5619}let pkCli_4670: bitstring = fail-any in
                    {5620}let v_4671: bool = (Sess_3638 = A) in
                    (
                        {5621}if v_4671 then
                        (
                            {5622}let pkSess_4672: bitstring = pub(skA) in
                            {5623}in(c, =GetEndpointRequest);
                            {5624}new SP_4673: bitstring;
                            {5625}new UP_4674: bitstring;
                            {5626}out(c, (GetEndpointResponse,pkSess_4672,None,SP_4673,UP_4674))
                        )
                        else
                            {5627}let v_4675: bool = (Sess_3638 = B) in
                            (
                                {5628}if v_4675 then
                                (
                                    {5629}let pkSess_4676: bitstring = pub(skB) in
                                    {5630}in(c, =GetEndpointRequest);
                                    {5631}new SP_4677: bitstring;
                                    {5632}new UP_4678: bitstring;
                                    {5633}out(c, (GetEndpointResponse,pkSess_4676,None,SP_4677,UP_4678))
                                )
                                else
                                    {5634}let v_4679: bool = (Sess_3638 = C) in
                                    (
                                        {5635}if v_4679 then
                                        (
                                            {5636}let pkSess_4680: bitstring = pub(skC) in
                                            {5637}in(c, =GetEndpointRequest);
                                            {5638}new SP_4681: bitstring;
                                            {5639}new UP_4682: bitstring;
                                            {5640}out(c, (GetEndpointResponse,pkSess_4680,None,SP_4681,UP_4682))
                                        )
                                        else
                                            {5641}let pkSess_4683: bitstring = pub(sk(Sess_3638)) in
                                            {5642}in(c, =GetEndpointRequest);
                                            {5643}new SP_4684: bitstring;
                                            {5644}new UP_4685: bitstring;
                                            {5645}out(c, (GetEndpointResponse,pkSess_4683,None,SP_4684,UP_4685))
                                    )
                                    else
                                        {5646}let pkSess_4686: bitstring = fail-any in
                                        {5647}in(c, =GetEndpointRequest);
                                        {5648}new SP_4687: bitstring;
                                        {5649}new UP_4688: bitstring;
                                        {5650}out(c, (GetEndpointResponse,pkSess_4686,None,SP_4687,UP_4688))
                            )
                            else
                                {5651}let pkSess_4689: bitstring = fail-any in
                                {5652}in(c, =GetEndpointRequest);
                                {5653}new SP_4690: bitstring;
                                {5654}new UP_4691: bitstring;
                                {5655}out(c, (GetEndpointResponse,pkSess_4689,None,SP_4690,UP_4691))
                    )
                    else
                        {5656}let pkSess_4692: bitstring = fail-any in
                        {5657}in(c, =GetEndpointRequest);
                        {5658}new SP_4693: bitstring;
                        {5659}new UP_4694: bitstring;
                        {5660}out(c, (GetEndpointResponse,pkSess_4692,None,SP_4693,UP_4694))
        )
        else
            {5661}let pkCli_4695: bitstring = fail-any in
            {5662}let v_4696: bool = (Sess_3638 = A) in
            (
                {5663}if v_4696 then
                (
                    {5664}let pkSess_4697: bitstring = pub(skA) in
                    {5665}in(c, =GetEndpointRequest);
                    {5666}new SP_4698: bitstring;
                    {5667}new UP_4699: bitstring;
                    {5668}out(c, (GetEndpointResponse,pkSess_4697,None,SP_4698,UP_4699))
                )
                else
                    {5669}let v_4700: bool = (Sess_3638 = B) in
                    (
                        {5670}if v_4700 then
                        (
                            {5671}let pkSess_4701: bitstring = pub(skB) in
                            {5672}in(c, =GetEndpointRequest);
                            {5673}new SP_4702: bitstring;
                            {5674}new UP_4703: bitstring;
                            {5675}out(c, (GetEndpointResponse,pkSess_4701,None,SP_4702,UP_4703))
                        )
                        else
                            {5676}let v_4704: bool = (Sess_3638 = C) in
                            (
                                {5677}if v_4704 then
                                (
                                    {5678}let pkSess_4705: bitstring = pub(skC) in
                                    {5679}in(c, =GetEndpointRequest);
                                    {5680}new SP_4706: bitstring;
                                    {5681}new UP_4707: bitstring;
                                    {5682}out(c, (GetEndpointResponse,pkSess_4705,None,SP_4706,UP_4707))
                                )
                                else
                                    {5683}let pkSess_4708: bitstring = pub(sk(Sess_3638)) in
                                    {5684}in(c, =GetEndpointRequest);
                                    {5685}new SP_4709: bitstring;
                                    {5686}new UP_4710: bitstring;
                                    {5687}out(c, (GetEndpointResponse,pkSess_4708,None,SP_4709,UP_4710))
                            )
                            else
                                {5688}let pkSess_4711: bitstring = fail-any in
                                {5689}in(c, =GetEndpointRequest);
                                {5690}new SP_4712: bitstring;
                                {5691}new UP_4713: bitstring;
                                {5692}out(c, (GetEndpointResponse,pkSess_4711,None,SP_4712,UP_4713))
                    )
                    else
                        {5693}let pkSess_4714: bitstring = fail-any in
                        {5694}in(c, =GetEndpointRequest);
                        {5695}new SP_4715: bitstring;
                        {5696}new UP_4716: bitstring;
                        {5697}out(c, (GetEndpointResponse,pkSess_4714,None,SP_4715,UP_4716))
            )
            else
                {5698}let pkSess_4717: bitstring = fail-any in
                {5699}in(c, =GetEndpointRequest);
                {5700}new SP_4718: bitstring;
                {5701}new UP_4719: bitstring;
                {5702}out(c, (GetEndpointResponse,pkSess_4717,None,SP_4718,UP_4719))
) | (
    {5703}!
    {5704}in(c, (Cli_4720: host,Disco_4721: host,Sess_4722: host));
    {5705}let v_4723: bool = (Sess_4722 = A) in
    (
        {5706}if v_4723 then
        (
            {5707}let skSess: bitstring = skA in
            {5708}let pkSess_4724: bitstring = pub(skSess) in
            {5709}let v_4725: bool = (Cli_4720 = A) in
            (
                {5710}if v_4725 then
                (
                    {5711}let pkCli_4726: bitstring = pub(skA) in
                    {5712}let v_4727: bool = (Disco_4721 = A) in
                    (
                        {5713}if v_4727 then
                        (
                            {5714}let pkDisco_4728: bitstring = pub(skA) in
                            {5715}in(c, (=pkCli_4726,em1: bitstring));
                            {5716}let m1_4729: bitstring = em1 in
                            {5717}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_4726,Nc_4730: bitstring) = m1_4729 in
                            {5718}new Ns_4731: bitstring;
                            {5719}new ST_4732: bitstring;
                            {5720}new TTL_4733: bitstring;
                            {5721}let m2_4734: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_4731,ST_4732,TTL_4733) in
                            {5722}event beginSrv(Sess_4722,Cli_4720,Ns_4731);
                            {5723}out(c, m2_4734);
                            {5724}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                            {5725}event endSrv(Cli_4720,Sess_4722,Nc_4730)
                        )
                        else
                            {5726}let v_4735: bool = (Disco_4721 = B) in
                            (
                                {5727}if v_4735 then
                                (
                                    {5728}let pkDisco_4736: bitstring = pub(skB) in
                                    {5729}in(c, (=pkCli_4726,em1_4737: bitstring));
                                    {5730}let m1_4738: bitstring = em1_4737 in
                                    {5731}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_4726,Nc_4739: bitstring) = m1_4738 in
                                    {5732}new Ns_4740: bitstring;
                                    {5733}new ST_4741: bitstring;
                                    {5734}new TTL_4742: bitstring;
                                    {5735}let m2_4743: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_4740,ST_4741,TTL_4742) in
                                    {5736}event beginSrv(Sess_4722,Cli_4720,Ns_4740);
                                    {5737}out(c, m2_4743);
                                    {5738}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                    {5739}event endSrv(Cli_4720,Sess_4722,Nc_4739)
                                )
                                else
                                    {5740}let v_4744: bool = (Disco_4721 = C) in
                                    (
                                        {5741}if v_4744 then
                                        (
                                            {5742}let pkDisco_4745: bitstring = pub(skC) in
                                            {5743}in(c, (=pkCli_4726,em1_4746: bitstring));
                                            {5744}let m1_4747: bitstring = em1_4746 in
                                            {5745}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_4726,Nc_4748: bitstring) = m1_4747 in
                                            {5746}new Ns_4749: bitstring;
                                            {5747}new ST_4750: bitstring;
                                            {5748}new TTL_4751: bitstring;
                                            {5749}let m2_4752: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_4749,ST_4750,TTL_4751) in
                                            {5750}event beginSrv(Sess_4722,Cli_4720,Ns_4749);
                                            {5751}out(c, m2_4752);
                                            {5752}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                            {5753}event endSrv(Cli_4720,Sess_4722,Nc_4748)
                                        )
                                        else
                                            {5754}let pkDisco_4753: bitstring = pub(sk(Disco_4721)) in
                                            {5755}in(c, (=pkCli_4726,em1_4754: bitstring));
                                            {5756}let m1_4755: bitstring = em1_4754 in
                                            {5757}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_4726,Nc_4756: bitstring) = m1_4755 in
                                            {5758}new Ns_4757: bitstring;
                                            {5759}new ST_4758: bitstring;
                                            {5760}new TTL_4759: bitstring;
                                            {5761}let m2_4760: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_4757,ST_4758,TTL_4759) in
                                            {5762}event beginSrv(Sess_4722,Cli_4720,Ns_4757);
                                            {5763}out(c, m2_4760);
                                            {5764}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                            {5765}event endSrv(Cli_4720,Sess_4722,Nc_4756)
                                    )
                                    else
                                        {5766}let pkDisco_4761: bitstring = fail-any in
                                        {5767}in(c, (=pkCli_4726,em1_4762: bitstring));
                                        {5768}let m1_4763: bitstring = em1_4762 in
                                        {5769}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_4726,Nc_4764: bitstring) = m1_4763 in
                                        {5770}new Ns_4765: bitstring;
                                        {5771}new ST_4766: bitstring;
                                        {5772}new TTL_4767: bitstring;
                                        {5773}let m2_4768: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_4765,ST_4766,TTL_4767) in
                                        {5774}event beginSrv(Sess_4722,Cli_4720,Ns_4765);
                                        {5775}out(c, m2_4768);
                                        {5776}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                        {5777}event endSrv(Cli_4720,Sess_4722,Nc_4764)
                            )
                            else
                                {5778}let pkDisco_4769: bitstring = fail-any in
                                {5779}in(c, (=pkCli_4726,em1_4770: bitstring));
                                {5780}let m1_4771: bitstring = em1_4770 in
                                {5781}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_4726,Nc_4772: bitstring) = m1_4771 in
                                {5782}new Ns_4773: bitstring;
                                {5783}new ST_4774: bitstring;
                                {5784}new TTL_4775: bitstring;
                                {5785}let m2_4776: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_4773,ST_4774,TTL_4775) in
                                {5786}event beginSrv(Sess_4722,Cli_4720,Ns_4773);
                                {5787}out(c, m2_4776);
                                {5788}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                {5789}event endSrv(Cli_4720,Sess_4722,Nc_4772)
                    )
                    else
                        {5790}let pkDisco_4777: bitstring = fail-any in
                        {5791}in(c, (=pkCli_4726,em1_4778: bitstring));
                        {5792}let m1_4779: bitstring = em1_4778 in
                        {5793}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_4726,Nc_4780: bitstring) = m1_4779 in
                        {5794}new Ns_4781: bitstring;
                        {5795}new ST_4782: bitstring;
                        {5796}new TTL_4783: bitstring;
                        {5797}let m2_4784: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_4781,ST_4782,TTL_4783) in
                        {5798}event beginSrv(Sess_4722,Cli_4720,Ns_4781);
                        {5799}out(c, m2_4784);
                        {5800}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                        {5801}event endSrv(Cli_4720,Sess_4722,Nc_4780)
                )
                else
                    {5802}let v_4785: bool = (Cli_4720 = B) in
                    (
                        {5803}if v_4785 then
                        (
                            {5804}let pkCli_4786: bitstring = pub(skB) in
                            {5805}let v_4787: bool = (Disco_4721 = A) in
                            (
                                {5806}if v_4787 then
                                (
                                    {5807}let pkDisco_4788: bitstring = pub(skA) in
                                    {5808}in(c, (=pkCli_4786,em1_4789: bitstring));
                                    {5809}let m1_4790: bitstring = em1_4789 in
                                    {5810}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_4786,Nc_4791: bitstring) = m1_4790 in
                                    {5811}new Ns_4792: bitstring;
                                    {5812}new ST_4793: bitstring;
                                    {5813}new TTL_4794: bitstring;
                                    {5814}let m2_4795: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_4792,ST_4793,TTL_4794) in
                                    {5815}event beginSrv(Sess_4722,Cli_4720,Ns_4792);
                                    {5816}out(c, m2_4795);
                                    {5817}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                    {5818}event endSrv(Cli_4720,Sess_4722,Nc_4791)
                                )
                                else
                                    {5819}let v_4796: bool = (Disco_4721 = B) in
                                    (
                                        {5820}if v_4796 then
                                        (
                                            {5821}let pkDisco_4797: bitstring = pub(skB) in
                                            {5822}in(c, (=pkCli_4786,em1_4798: bitstring));
                                            {5823}let m1_4799: bitstring = em1_4798 in
                                            {5824}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_4786,Nc_4800: bitstring) = m1_4799 in
                                            {5825}new Ns_4801: bitstring;
                                            {5826}new ST_4802: bitstring;
                                            {5827}new TTL_4803: bitstring;
                                            {5828}let m2_4804: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_4801,ST_4802,TTL_4803) in
                                            {5829}event beginSrv(Sess_4722,Cli_4720,Ns_4801);
                                            {5830}out(c, m2_4804);
                                            {5831}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                            {5832}event endSrv(Cli_4720,Sess_4722,Nc_4800)
                                        )
                                        else
                                            {5833}let v_4805: bool = (Disco_4721 = C) in
                                            (
                                                {5834}if v_4805 then
                                                (
                                                    {5835}let pkDisco_4806: bitstring = pub(skC) in
                                                    {5836}in(c, (=pkCli_4786,em1_4807: bitstring));
                                                    {5837}let m1_4808: bitstring = em1_4807 in
                                                    {5838}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_4786,Nc_4809: bitstring) = m1_4808 in
                                                    {5839}new Ns_4810: bitstring;
                                                    {5840}new ST_4811: bitstring;
                                                    {5841}new TTL_4812: bitstring;
                                                    {5842}let m2_4813: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_4810,ST_4811,TTL_4812) in
                                                    {5843}event beginSrv(Sess_4722,Cli_4720,Ns_4810);
                                                    {5844}out(c, m2_4813);
                                                    {5845}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                                    {5846}event endSrv(Cli_4720,Sess_4722,Nc_4809)
                                                )
                                                else
                                                    {5847}let pkDisco_4814: bitstring = pub(sk(Disco_4721)) in
                                                    {5848}in(c, (=pkCli_4786,em1_4815: bitstring));
                                                    {5849}let m1_4816: bitstring = em1_4815 in
                                                    {5850}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_4786,Nc_4817: bitstring) = m1_4816 in
                                                    {5851}new Ns_4818: bitstring;
                                                    {5852}new ST_4819: bitstring;
                                                    {5853}new TTL_4820: bitstring;
                                                    {5854}let m2_4821: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_4818,ST_4819,TTL_4820) in
                                                    {5855}event beginSrv(Sess_4722,Cli_4720,Ns_4818);
                                                    {5856}out(c, m2_4821);
                                                    {5857}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                                    {5858}event endSrv(Cli_4720,Sess_4722,Nc_4817)
                                            )
                                            else
                                                {5859}let pkDisco_4822: bitstring = fail-any in
                                                {5860}in(c, (=pkCli_4786,em1_4823: bitstring));
                                                {5861}let m1_4824: bitstring = em1_4823 in
                                                {5862}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_4786,Nc_4825: bitstring) = m1_4824 in
                                                {5863}new Ns_4826: bitstring;
                                                {5864}new ST_4827: bitstring;
                                                {5865}new TTL_4828: bitstring;
                                                {5866}let m2_4829: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_4826,ST_4827,TTL_4828) in
                                                {5867}event beginSrv(Sess_4722,Cli_4720,Ns_4826);
                                                {5868}out(c, m2_4829);
                                                {5869}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                                {5870}event endSrv(Cli_4720,Sess_4722,Nc_4825)
                                    )
                                    else
                                        {5871}let pkDisco_4830: bitstring = fail-any in
                                        {5872}in(c, (=pkCli_4786,em1_4831: bitstring));
                                        {5873}let m1_4832: bitstring = em1_4831 in
                                        {5874}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_4786,Nc_4833: bitstring) = m1_4832 in
                                        {5875}new Ns_4834: bitstring;
                                        {5876}new ST_4835: bitstring;
                                        {5877}new TTL_4836: bitstring;
                                        {5878}let m2_4837: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_4834,ST_4835,TTL_4836) in
                                        {5879}event beginSrv(Sess_4722,Cli_4720,Ns_4834);
                                        {5880}out(c, m2_4837);
                                        {5881}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                        {5882}event endSrv(Cli_4720,Sess_4722,Nc_4833)
                            )
                            else
                                {5883}let pkDisco_4838: bitstring = fail-any in
                                {5884}in(c, (=pkCli_4786,em1_4839: bitstring));
                                {5885}let m1_4840: bitstring = em1_4839 in
                                {5886}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_4786,Nc_4841: bitstring) = m1_4840 in
                                {5887}new Ns_4842: bitstring;
                                {5888}new ST_4843: bitstring;
                                {5889}new TTL_4844: bitstring;
                                {5890}let m2_4845: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_4842,ST_4843,TTL_4844) in
                                {5891}event beginSrv(Sess_4722,Cli_4720,Ns_4842);
                                {5892}out(c, m2_4845);
                                {5893}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                {5894}event endSrv(Cli_4720,Sess_4722,Nc_4841)
                        )
                        else
                            {5895}let v_4846: bool = (Cli_4720 = C) in
                            (
                                {5896}if v_4846 then
                                (
                                    {5897}let pkCli_4847: bitstring = pub(skC) in
                                    {5898}let v_4848: bool = (Disco_4721 = A) in
                                    (
                                        {5899}if v_4848 then
                                        (
                                            {5900}let pkDisco_4849: bitstring = pub(skA) in
                                            {5901}in(c, (=pkCli_4847,em1_4850: bitstring));
                                            {5902}let m1_4851: bitstring = em1_4850 in
                                            {5903}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_4847,Nc_4852: bitstring) = m1_4851 in
                                            {5904}new Ns_4853: bitstring;
                                            {5905}new ST_4854: bitstring;
                                            {5906}new TTL_4855: bitstring;
                                            {5907}let m2_4856: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_4853,ST_4854,TTL_4855) in
                                            {5908}event beginSrv(Sess_4722,Cli_4720,Ns_4853);
                                            {5909}out(c, m2_4856);
                                            {5910}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                            {5911}event endSrv(Cli_4720,Sess_4722,Nc_4852)
                                        )
                                        else
                                            {5912}let v_4857: bool = (Disco_4721 = B) in
                                            (
                                                {5913}if v_4857 then
                                                (
                                                    {5914}let pkDisco_4858: bitstring = pub(skB) in
                                                    {5915}in(c, (=pkCli_4847,em1_4859: bitstring));
                                                    {5916}let m1_4860: bitstring = em1_4859 in
                                                    {5917}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_4847,Nc_4861: bitstring) = m1_4860 in
                                                    {5918}new Ns_4862: bitstring;
                                                    {5919}new ST_4863: bitstring;
                                                    {5920}new TTL_4864: bitstring;
                                                    {5921}let m2_4865: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_4862,ST_4863,TTL_4864) in
                                                    {5922}event beginSrv(Sess_4722,Cli_4720,Ns_4862);
                                                    {5923}out(c, m2_4865);
                                                    {5924}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                                    {5925}event endSrv(Cli_4720,Sess_4722,Nc_4861)
                                                )
                                                else
                                                    {5926}let v_4866: bool = (Disco_4721 = C) in
                                                    (
                                                        {5927}if v_4866 then
                                                        (
                                                            {5928}let pkDisco_4867: bitstring = pub(skC) in
                                                            {5929}in(c, (=pkCli_4847,em1_4868: bitstring));
                                                            {5930}let m1_4869: bitstring = em1_4868 in
                                                            {5931}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_4847,Nc_4870: bitstring) = m1_4869 in
                                                            {5932}new Ns_4871: bitstring;
                                                            {5933}new ST_4872: bitstring;
                                                            {5934}new TTL_4873: bitstring;
                                                            {5935}let m2_4874: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_4871,ST_4872,TTL_4873) in
                                                            {5936}event beginSrv(Sess_4722,Cli_4720,Ns_4871);
                                                            {5937}out(c, m2_4874);
                                                            {5938}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                                            {5939}event endSrv(Cli_4720,Sess_4722,Nc_4870)
                                                        )
                                                        else
                                                            {5940}let pkDisco_4875: bitstring = pub(sk(Disco_4721)) in
                                                            {5941}in(c, (=pkCli_4847,em1_4876: bitstring));
                                                            {5942}let m1_4877: bitstring = em1_4876 in
                                                            {5943}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_4847,Nc_4878: bitstring) = m1_4877 in
                                                            {5944}new Ns_4879: bitstring;
                                                            {5945}new ST_4880: bitstring;
                                                            {5946}new TTL_4881: bitstring;
                                                            {5947}let m2_4882: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_4879,ST_4880,TTL_4881) in
                                                            {5948}event beginSrv(Sess_4722,Cli_4720,Ns_4879);
                                                            {5949}out(c, m2_4882);
                                                            {5950}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                                            {5951}event endSrv(Cli_4720,Sess_4722,Nc_4878)
                                                    )
                                                    else
                                                        {5952}let pkDisco_4883: bitstring = fail-any in
                                                        {5953}in(c, (=pkCli_4847,em1_4884: bitstring));
                                                        {5954}let m1_4885: bitstring = em1_4884 in
                                                        {5955}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_4847,Nc_4886: bitstring) = m1_4885 in
                                                        {5956}new Ns_4887: bitstring;
                                                        {5957}new ST_4888: bitstring;
                                                        {5958}new TTL_4889: bitstring;
                                                        {5959}let m2_4890: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_4887,ST_4888,TTL_4889) in
                                                        {5960}event beginSrv(Sess_4722,Cli_4720,Ns_4887);
                                                        {5961}out(c, m2_4890);
                                                        {5962}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                                        {5963}event endSrv(Cli_4720,Sess_4722,Nc_4886)
                                            )
                                            else
                                                {5964}let pkDisco_4891: bitstring = fail-any in
                                                {5965}in(c, (=pkCli_4847,em1_4892: bitstring));
                                                {5966}let m1_4893: bitstring = em1_4892 in
                                                {5967}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_4847,Nc_4894: bitstring) = m1_4893 in
                                                {5968}new Ns_4895: bitstring;
                                                {5969}new ST_4896: bitstring;
                                                {5970}new TTL_4897: bitstring;
                                                {5971}let m2_4898: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_4895,ST_4896,TTL_4897) in
                                                {5972}event beginSrv(Sess_4722,Cli_4720,Ns_4895);
                                                {5973}out(c, m2_4898);
                                                {5974}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                                {5975}event endSrv(Cli_4720,Sess_4722,Nc_4894)
                                    )
                                    else
                                        {5976}let pkDisco_4899: bitstring = fail-any in
                                        {5977}in(c, (=pkCli_4847,em1_4900: bitstring));
                                        {5978}let m1_4901: bitstring = em1_4900 in
                                        {5979}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_4847,Nc_4902: bitstring) = m1_4901 in
                                        {5980}new Ns_4903: bitstring;
                                        {5981}new ST_4904: bitstring;
                                        {5982}new TTL_4905: bitstring;
                                        {5983}let m2_4906: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_4903,ST_4904,TTL_4905) in
                                        {5984}event beginSrv(Sess_4722,Cli_4720,Ns_4903);
                                        {5985}out(c, m2_4906);
                                        {5986}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                        {5987}event endSrv(Cli_4720,Sess_4722,Nc_4902)
                                )
                                else
                                    {5988}let pkCli_4907: bitstring = pub(sk(Cli_4720)) in
                                    {5989}let v_4908: bool = (Disco_4721 = A) in
                                    (
                                        {5990}if v_4908 then
                                        (
                                            {5991}let pkDisco_4909: bitstring = pub(skA) in
                                            {5992}in(c, (=pkCli_4907,em1_4910: bitstring));
                                            {5993}let m1_4911: bitstring = em1_4910 in
                                            {5994}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_4907,Nc_4912: bitstring) = m1_4911 in
                                            {5995}new Ns_4913: bitstring;
                                            {5996}new ST_4914: bitstring;
                                            {5997}new TTL_4915: bitstring;
                                            {5998}let m2_4916: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_4913,ST_4914,TTL_4915) in
                                            {5999}event beginSrv(Sess_4722,Cli_4720,Ns_4913);
                                            {6000}out(c, m2_4916);
                                            {6001}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                            {6002}event endSrv(Cli_4720,Sess_4722,Nc_4912)
                                        )
                                        else
                                            {6003}let v_4917: bool = (Disco_4721 = B) in
                                            (
                                                {6004}if v_4917 then
                                                (
                                                    {6005}let pkDisco_4918: bitstring = pub(skB) in
                                                    {6006}in(c, (=pkCli_4907,em1_4919: bitstring));
                                                    {6007}let m1_4920: bitstring = em1_4919 in
                                                    {6008}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_4907,Nc_4921: bitstring) = m1_4920 in
                                                    {6009}new Ns_4922: bitstring;
                                                    {6010}new ST_4923: bitstring;
                                                    {6011}new TTL_4924: bitstring;
                                                    {6012}let m2_4925: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_4922,ST_4923,TTL_4924) in
                                                    {6013}event beginSrv(Sess_4722,Cli_4720,Ns_4922);
                                                    {6014}out(c, m2_4925);
                                                    {6015}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                                    {6016}event endSrv(Cli_4720,Sess_4722,Nc_4921)
                                                )
                                                else
                                                    {6017}let v_4926: bool = (Disco_4721 = C) in
                                                    (
                                                        {6018}if v_4926 then
                                                        (
                                                            {6019}let pkDisco_4927: bitstring = pub(skC) in
                                                            {6020}in(c, (=pkCli_4907,em1_4928: bitstring));
                                                            {6021}let m1_4929: bitstring = em1_4928 in
                                                            {6022}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_4907,Nc_4930: bitstring) = m1_4929 in
                                                            {6023}new Ns_4931: bitstring;
                                                            {6024}new ST_4932: bitstring;
                                                            {6025}new TTL_4933: bitstring;
                                                            {6026}let m2_4934: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_4931,ST_4932,TTL_4933) in
                                                            {6027}event beginSrv(Sess_4722,Cli_4720,Ns_4931);
                                                            {6028}out(c, m2_4934);
                                                            {6029}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                                            {6030}event endSrv(Cli_4720,Sess_4722,Nc_4930)
                                                        )
                                                        else
                                                            {6031}let pkDisco_4935: bitstring = pub(sk(Disco_4721)) in
                                                            {6032}in(c, (=pkCli_4907,em1_4936: bitstring));
                                                            {6033}let m1_4937: bitstring = em1_4936 in
                                                            {6034}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_4907,Nc_4938: bitstring) = m1_4937 in
                                                            {6035}new Ns_4939: bitstring;
                                                            {6036}new ST_4940: bitstring;
                                                            {6037}new TTL_4941: bitstring;
                                                            {6038}let m2_4942: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_4939,ST_4940,TTL_4941) in
                                                            {6039}event beginSrv(Sess_4722,Cli_4720,Ns_4939);
                                                            {6040}out(c, m2_4942);
                                                            {6041}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                                            {6042}event endSrv(Cli_4720,Sess_4722,Nc_4938)
                                                    )
                                                    else
                                                        {6043}let pkDisco_4943: bitstring = fail-any in
                                                        {6044}in(c, (=pkCli_4907,em1_4944: bitstring));
                                                        {6045}let m1_4945: bitstring = em1_4944 in
                                                        {6046}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_4907,Nc_4946: bitstring) = m1_4945 in
                                                        {6047}new Ns_4947: bitstring;
                                                        {6048}new ST_4948: bitstring;
                                                        {6049}new TTL_4949: bitstring;
                                                        {6050}let m2_4950: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_4947,ST_4948,TTL_4949) in
                                                        {6051}event beginSrv(Sess_4722,Cli_4720,Ns_4947);
                                                        {6052}out(c, m2_4950);
                                                        {6053}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                                        {6054}event endSrv(Cli_4720,Sess_4722,Nc_4946)
                                            )
                                            else
                                                {6055}let pkDisco_4951: bitstring = fail-any in
                                                {6056}in(c, (=pkCli_4907,em1_4952: bitstring));
                                                {6057}let m1_4953: bitstring = em1_4952 in
                                                {6058}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_4907,Nc_4954: bitstring) = m1_4953 in
                                                {6059}new Ns_4955: bitstring;
                                                {6060}new ST_4956: bitstring;
                                                {6061}new TTL_4957: bitstring;
                                                {6062}let m2_4958: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_4955,ST_4956,TTL_4957) in
                                                {6063}event beginSrv(Sess_4722,Cli_4720,Ns_4955);
                                                {6064}out(c, m2_4958);
                                                {6065}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                                {6066}event endSrv(Cli_4720,Sess_4722,Nc_4954)
                                    )
                                    else
                                        {6067}let pkDisco_4959: bitstring = fail-any in
                                        {6068}in(c, (=pkCli_4907,em1_4960: bitstring));
                                        {6069}let m1_4961: bitstring = em1_4960 in
                                        {6070}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_4907,Nc_4962: bitstring) = m1_4961 in
                                        {6071}new Ns_4963: bitstring;
                                        {6072}new ST_4964: bitstring;
                                        {6073}new TTL_4965: bitstring;
                                        {6074}let m2_4966: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_4963,ST_4964,TTL_4965) in
                                        {6075}event beginSrv(Sess_4722,Cli_4720,Ns_4963);
                                        {6076}out(c, m2_4966);
                                        {6077}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                        {6078}event endSrv(Cli_4720,Sess_4722,Nc_4962)
                            )
                            else
                                {6079}let pkCli_4967: bitstring = fail-any in
                                {6080}let v_4968: bool = (Disco_4721 = A) in
                                (
                                    {6081}if v_4968 then
                                    (
                                        {6082}let pkDisco_4969: bitstring = pub(skA) in
                                        {6083}in(c, (=pkCli_4967,em1_4970: bitstring));
                                        {6084}let m1_4971: bitstring = em1_4970 in
                                        {6085}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_4967,Nc_4972: bitstring) = m1_4971 in
                                        {6086}new Ns_4973: bitstring;
                                        {6087}new ST_4974: bitstring;
                                        {6088}new TTL_4975: bitstring;
                                        {6089}let m2_4976: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_4973,ST_4974,TTL_4975) in
                                        {6090}event beginSrv(Sess_4722,Cli_4720,Ns_4973);
                                        {6091}out(c, m2_4976);
                                        {6092}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                        {6093}event endSrv(Cli_4720,Sess_4722,Nc_4972)
                                    )
                                    else
                                        {6094}let v_4977: bool = (Disco_4721 = B) in
                                        (
                                            {6095}if v_4977 then
                                            (
                                                {6096}let pkDisco_4978: bitstring = pub(skB) in
                                                {6097}in(c, (=pkCli_4967,em1_4979: bitstring));
                                                {6098}let m1_4980: bitstring = em1_4979 in
                                                {6099}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_4967,Nc_4981: bitstring) = m1_4980 in
                                                {6100}new Ns_4982: bitstring;
                                                {6101}new ST_4983: bitstring;
                                                {6102}new TTL_4984: bitstring;
                                                {6103}let m2_4985: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_4982,ST_4983,TTL_4984) in
                                                {6104}event beginSrv(Sess_4722,Cli_4720,Ns_4982);
                                                {6105}out(c, m2_4985);
                                                {6106}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                                {6107}event endSrv(Cli_4720,Sess_4722,Nc_4981)
                                            )
                                            else
                                                {6108}let v_4986: bool = (Disco_4721 = C) in
                                                (
                                                    {6109}if v_4986 then
                                                    (
                                                        {6110}let pkDisco_4987: bitstring = pub(skC) in
                                                        {6111}in(c, (=pkCli_4967,em1_4988: bitstring));
                                                        {6112}let m1_4989: bitstring = em1_4988 in
                                                        {6113}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_4967,Nc_4990: bitstring) = m1_4989 in
                                                        {6114}new Ns_4991: bitstring;
                                                        {6115}new ST_4992: bitstring;
                                                        {6116}new TTL_4993: bitstring;
                                                        {6117}let m2_4994: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_4991,ST_4992,TTL_4993) in
                                                        {6118}event beginSrv(Sess_4722,Cli_4720,Ns_4991);
                                                        {6119}out(c, m2_4994);
                                                        {6120}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                                        {6121}event endSrv(Cli_4720,Sess_4722,Nc_4990)
                                                    )
                                                    else
                                                        {6122}let pkDisco_4995: bitstring = pub(sk(Disco_4721)) in
                                                        {6123}in(c, (=pkCli_4967,em1_4996: bitstring));
                                                        {6124}let m1_4997: bitstring = em1_4996 in
                                                        {6125}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_4967,Nc_4998: bitstring) = m1_4997 in
                                                        {6126}new Ns_4999: bitstring;
                                                        {6127}new ST_5000: bitstring;
                                                        {6128}new TTL_5001: bitstring;
                                                        {6129}let m2_5002: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_4999,ST_5000,TTL_5001) in
                                                        {6130}event beginSrv(Sess_4722,Cli_4720,Ns_4999);
                                                        {6131}out(c, m2_5002);
                                                        {6132}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                                        {6133}event endSrv(Cli_4720,Sess_4722,Nc_4998)
                                                )
                                                else
                                                    {6134}let pkDisco_5003: bitstring = fail-any in
                                                    {6135}in(c, (=pkCli_4967,em1_5004: bitstring));
                                                    {6136}let m1_5005: bitstring = em1_5004 in
                                                    {6137}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_4967,Nc_5006: bitstring) = m1_5005 in
                                                    {6138}new Ns_5007: bitstring;
                                                    {6139}new ST_5008: bitstring;
                                                    {6140}new TTL_5009: bitstring;
                                                    {6141}let m2_5010: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_5007,ST_5008,TTL_5009) in
                                                    {6142}event beginSrv(Sess_4722,Cli_4720,Ns_5007);
                                                    {6143}out(c, m2_5010);
                                                    {6144}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                                    {6145}event endSrv(Cli_4720,Sess_4722,Nc_5006)
                                        )
                                        else
                                            {6146}let pkDisco_5011: bitstring = fail-any in
                                            {6147}in(c, (=pkCli_4967,em1_5012: bitstring));
                                            {6148}let m1_5013: bitstring = em1_5012 in
                                            {6149}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_4967,Nc_5014: bitstring) = m1_5013 in
                                            {6150}new Ns_5015: bitstring;
                                            {6151}new ST_5016: bitstring;
                                            {6152}new TTL_5017: bitstring;
                                            {6153}let m2_5018: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_5015,ST_5016,TTL_5017) in
                                            {6154}event beginSrv(Sess_4722,Cli_4720,Ns_5015);
                                            {6155}out(c, m2_5018);
                                            {6156}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                            {6157}event endSrv(Cli_4720,Sess_4722,Nc_5014)
                                )
                                else
                                    {6158}let pkDisco_5019: bitstring = fail-any in
                                    {6159}in(c, (=pkCli_4967,em1_5020: bitstring));
                                    {6160}let m1_5021: bitstring = em1_5020 in
                                    {6161}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_4967,Nc_5022: bitstring) = m1_5021 in
                                    {6162}new Ns_5023: bitstring;
                                    {6163}new ST_5024: bitstring;
                                    {6164}new TTL_5025: bitstring;
                                    {6165}let m2_5026: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_5023,ST_5024,TTL_5025) in
                                    {6166}event beginSrv(Sess_4722,Cli_4720,Ns_5023);
                                    {6167}out(c, m2_5026);
                                    {6168}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                    {6169}event endSrv(Cli_4720,Sess_4722,Nc_5022)
                    )
                    else
                        {6170}let pkCli_5027: bitstring = fail-any in
                        {6171}let v_5028: bool = (Disco_4721 = A) in
                        (
                            {6172}if v_5028 then
                            (
                                {6173}let pkDisco_5029: bitstring = pub(skA) in
                                {6174}in(c, (=pkCli_5027,em1_5030: bitstring));
                                {6175}let m1_5031: bitstring = em1_5030 in
                                {6176}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_5027,Nc_5032: bitstring) = m1_5031 in
                                {6177}new Ns_5033: bitstring;
                                {6178}new ST_5034: bitstring;
                                {6179}new TTL_5035: bitstring;
                                {6180}let m2_5036: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_5033,ST_5034,TTL_5035) in
                                {6181}event beginSrv(Sess_4722,Cli_4720,Ns_5033);
                                {6182}out(c, m2_5036);
                                {6183}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                {6184}event endSrv(Cli_4720,Sess_4722,Nc_5032)
                            )
                            else
                                {6185}let v_5037: bool = (Disco_4721 = B) in
                                (
                                    {6186}if v_5037 then
                                    (
                                        {6187}let pkDisco_5038: bitstring = pub(skB) in
                                        {6188}in(c, (=pkCli_5027,em1_5039: bitstring));
                                        {6189}let m1_5040: bitstring = em1_5039 in
                                        {6190}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_5027,Nc_5041: bitstring) = m1_5040 in
                                        {6191}new Ns_5042: bitstring;
                                        {6192}new ST_5043: bitstring;
                                        {6193}new TTL_5044: bitstring;
                                        {6194}let m2_5045: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_5042,ST_5043,TTL_5044) in
                                        {6195}event beginSrv(Sess_4722,Cli_4720,Ns_5042);
                                        {6196}out(c, m2_5045);
                                        {6197}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                        {6198}event endSrv(Cli_4720,Sess_4722,Nc_5041)
                                    )
                                    else
                                        {6199}let v_5046: bool = (Disco_4721 = C) in
                                        (
                                            {6200}if v_5046 then
                                            (
                                                {6201}let pkDisco_5047: bitstring = pub(skC) in
                                                {6202}in(c, (=pkCli_5027,em1_5048: bitstring));
                                                {6203}let m1_5049: bitstring = em1_5048 in
                                                {6204}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_5027,Nc_5050: bitstring) = m1_5049 in
                                                {6205}new Ns_5051: bitstring;
                                                {6206}new ST_5052: bitstring;
                                                {6207}new TTL_5053: bitstring;
                                                {6208}let m2_5054: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_5051,ST_5052,TTL_5053) in
                                                {6209}event beginSrv(Sess_4722,Cli_4720,Ns_5051);
                                                {6210}out(c, m2_5054);
                                                {6211}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                                {6212}event endSrv(Cli_4720,Sess_4722,Nc_5050)
                                            )
                                            else
                                                {6213}let pkDisco_5055: bitstring = pub(sk(Disco_4721)) in
                                                {6214}in(c, (=pkCli_5027,em1_5056: bitstring));
                                                {6215}let m1_5057: bitstring = em1_5056 in
                                                {6216}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_5027,Nc_5058: bitstring) = m1_5057 in
                                                {6217}new Ns_5059: bitstring;
                                                {6218}new ST_5060: bitstring;
                                                {6219}new TTL_5061: bitstring;
                                                {6220}let m2_5062: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_5059,ST_5060,TTL_5061) in
                                                {6221}event beginSrv(Sess_4722,Cli_4720,Ns_5059);
                                                {6222}out(c, m2_5062);
                                                {6223}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                                {6224}event endSrv(Cli_4720,Sess_4722,Nc_5058)
                                        )
                                        else
                                            {6225}let pkDisco_5063: bitstring = fail-any in
                                            {6226}in(c, (=pkCli_5027,em1_5064: bitstring));
                                            {6227}let m1_5065: bitstring = em1_5064 in
                                            {6228}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_5027,Nc_5066: bitstring) = m1_5065 in
                                            {6229}new Ns_5067: bitstring;
                                            {6230}new ST_5068: bitstring;
                                            {6231}new TTL_5069: bitstring;
                                            {6232}let m2_5070: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_5067,ST_5068,TTL_5069) in
                                            {6233}event beginSrv(Sess_4722,Cli_4720,Ns_5067);
                                            {6234}out(c, m2_5070);
                                            {6235}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                            {6236}event endSrv(Cli_4720,Sess_4722,Nc_5066)
                                )
                                else
                                    {6237}let pkDisco_5071: bitstring = fail-any in
                                    {6238}in(c, (=pkCli_5027,em1_5072: bitstring));
                                    {6239}let m1_5073: bitstring = em1_5072 in
                                    {6240}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_5027,Nc_5074: bitstring) = m1_5073 in
                                    {6241}new Ns_5075: bitstring;
                                    {6242}new ST_5076: bitstring;
                                    {6243}new TTL_5077: bitstring;
                                    {6244}let m2_5078: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_5075,ST_5076,TTL_5077) in
                                    {6245}event beginSrv(Sess_4722,Cli_4720,Ns_5075);
                                    {6246}out(c, m2_5078);
                                    {6247}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                    {6248}event endSrv(Cli_4720,Sess_4722,Nc_5074)
                        )
                        else
                            {6249}let pkDisco_5079: bitstring = fail-any in
                            {6250}in(c, (=pkCli_5027,em1_5080: bitstring));
                            {6251}let m1_5081: bitstring = em1_5080 in
                            {6252}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_5027,Nc_5082: bitstring) = m1_5081 in
                            {6253}new Ns_5083: bitstring;
                            {6254}new ST_5084: bitstring;
                            {6255}new TTL_5085: bitstring;
                            {6256}let m2_5086: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_5083,ST_5084,TTL_5085) in
                            {6257}event beginSrv(Sess_4722,Cli_4720,Ns_5083);
                            {6258}out(c, m2_5086);
                            {6259}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                            {6260}event endSrv(Cli_4720,Sess_4722,Nc_5082)
            )
            else
                {6261}let pkCli_5087: bitstring = fail-any in
                {6262}let v_5088: bool = (Disco_4721 = A) in
                (
                    {6263}if v_5088 then
                    (
                        {6264}let pkDisco_5089: bitstring = pub(skA) in
                        {6265}in(c, (=pkCli_5087,em1_5090: bitstring));
                        {6266}let m1_5091: bitstring = em1_5090 in
                        {6267}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_5087,Nc_5092: bitstring) = m1_5091 in
                        {6268}new Ns_5093: bitstring;
                        {6269}new ST_5094: bitstring;
                        {6270}new TTL_5095: bitstring;
                        {6271}let m2_5096: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_5093,ST_5094,TTL_5095) in
                        {6272}event beginSrv(Sess_4722,Cli_4720,Ns_5093);
                        {6273}out(c, m2_5096);
                        {6274}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                        {6275}event endSrv(Cli_4720,Sess_4722,Nc_5092)
                    )
                    else
                        {6276}let v_5097: bool = (Disco_4721 = B) in
                        (
                            {6277}if v_5097 then
                            (
                                {6278}let pkDisco_5098: bitstring = pub(skB) in
                                {6279}in(c, (=pkCli_5087,em1_5099: bitstring));
                                {6280}let m1_5100: bitstring = em1_5099 in
                                {6281}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_5087,Nc_5101: bitstring) = m1_5100 in
                                {6282}new Ns_5102: bitstring;
                                {6283}new ST_5103: bitstring;
                                {6284}new TTL_5104: bitstring;
                                {6285}let m2_5105: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_5102,ST_5103,TTL_5104) in
                                {6286}event beginSrv(Sess_4722,Cli_4720,Ns_5102);
                                {6287}out(c, m2_5105);
                                {6288}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                {6289}event endSrv(Cli_4720,Sess_4722,Nc_5101)
                            )
                            else
                                {6290}let v_5106: bool = (Disco_4721 = C) in
                                (
                                    {6291}if v_5106 then
                                    (
                                        {6292}let pkDisco_5107: bitstring = pub(skC) in
                                        {6293}in(c, (=pkCli_5087,em1_5108: bitstring));
                                        {6294}let m1_5109: bitstring = em1_5108 in
                                        {6295}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_5087,Nc_5110: bitstring) = m1_5109 in
                                        {6296}new Ns_5111: bitstring;
                                        {6297}new ST_5112: bitstring;
                                        {6298}new TTL_5113: bitstring;
                                        {6299}let m2_5114: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_5111,ST_5112,TTL_5113) in
                                        {6300}event beginSrv(Sess_4722,Cli_4720,Ns_5111);
                                        {6301}out(c, m2_5114);
                                        {6302}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                        {6303}event endSrv(Cli_4720,Sess_4722,Nc_5110)
                                    )
                                    else
                                        {6304}let pkDisco_5115: bitstring = pub(sk(Disco_4721)) in
                                        {6305}in(c, (=pkCli_5087,em1_5116: bitstring));
                                        {6306}let m1_5117: bitstring = em1_5116 in
                                        {6307}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_5087,Nc_5118: bitstring) = m1_5117 in
                                        {6308}new Ns_5119: bitstring;
                                        {6309}new ST_5120: bitstring;
                                        {6310}new TTL_5121: bitstring;
                                        {6311}let m2_5122: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_5119,ST_5120,TTL_5121) in
                                        {6312}event beginSrv(Sess_4722,Cli_4720,Ns_5119);
                                        {6313}out(c, m2_5122);
                                        {6314}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                        {6315}event endSrv(Cli_4720,Sess_4722,Nc_5118)
                                )
                                else
                                    {6316}let pkDisco_5123: bitstring = fail-any in
                                    {6317}in(c, (=pkCli_5087,em1_5124: bitstring));
                                    {6318}let m1_5125: bitstring = em1_5124 in
                                    {6319}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_5087,Nc_5126: bitstring) = m1_5125 in
                                    {6320}new Ns_5127: bitstring;
                                    {6321}new ST_5128: bitstring;
                                    {6322}new TTL_5129: bitstring;
                                    {6323}let m2_5130: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_5127,ST_5128,TTL_5129) in
                                    {6324}event beginSrv(Sess_4722,Cli_4720,Ns_5127);
                                    {6325}out(c, m2_5130);
                                    {6326}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                    {6327}event endSrv(Cli_4720,Sess_4722,Nc_5126)
                        )
                        else
                            {6328}let pkDisco_5131: bitstring = fail-any in
                            {6329}in(c, (=pkCli_5087,em1_5132: bitstring));
                            {6330}let m1_5133: bitstring = em1_5132 in
                            {6331}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_5087,Nc_5134: bitstring) = m1_5133 in
                            {6332}new Ns_5135: bitstring;
                            {6333}new ST_5136: bitstring;
                            {6334}new TTL_5137: bitstring;
                            {6335}let m2_5138: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_5135,ST_5136,TTL_5137) in
                            {6336}event beginSrv(Sess_4722,Cli_4720,Ns_5135);
                            {6337}out(c, m2_5138);
                            {6338}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                            {6339}event endSrv(Cli_4720,Sess_4722,Nc_5134)
                )
                else
                    {6340}let pkDisco_5139: bitstring = fail-any in
                    {6341}in(c, (=pkCli_5087,em1_5140: bitstring));
                    {6342}let m1_5141: bitstring = em1_5140 in
                    {6343}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_5087,Nc_5142: bitstring) = m1_5141 in
                    {6344}new Ns_5143: bitstring;
                    {6345}new ST_5144: bitstring;
                    {6346}new TTL_5145: bitstring;
                    {6347}let m2_5146: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_5143,ST_5144,TTL_5145) in
                    {6348}event beginSrv(Sess_4722,Cli_4720,Ns_5143);
                    {6349}out(c, m2_5146);
                    {6350}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                    {6351}event endSrv(Cli_4720,Sess_4722,Nc_5142)
        )
        else
            {6352}let v_5147: bool = (Sess_4722 = B) in
            (
                {6353}if v_5147 then
                (
                    {6354}let skSess_5148: bitstring = skB in
                    {6355}let pkSess_5149: bitstring = pub(skSess_5148) in
                    {6356}let v_5150: bool = (Cli_4720 = A) in
                    (
                        {6357}if v_5150 then
                        (
                            {6358}let pkCli_5151: bitstring = pub(skA) in
                            {6359}let v_5152: bool = (Disco_4721 = A) in
                            (
                                {6360}if v_5152 then
                                (
                                    {6361}let pkDisco_5153: bitstring = pub(skA) in
                                    {6362}in(c, (=pkCli_5151,em1_5154: bitstring));
                                    {6363}let m1_5155: bitstring = em1_5154 in
                                    {6364}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_5151,Nc_5156: bitstring) = m1_5155 in
                                    {6365}new Ns_5157: bitstring;
                                    {6366}new ST_5158: bitstring;
                                    {6367}new TTL_5159: bitstring;
                                    {6368}let m2_5160: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_5157,ST_5158,TTL_5159) in
                                    {6369}event beginSrv(Sess_4722,Cli_4720,Ns_5157);
                                    {6370}out(c, m2_5160);
                                    {6371}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                    {6372}event endSrv(Cli_4720,Sess_4722,Nc_5156)
                                )
                                else
                                    {6373}let v_5161: bool = (Disco_4721 = B) in
                                    (
                                        {6374}if v_5161 then
                                        (
                                            {6375}let pkDisco_5162: bitstring = pub(skB) in
                                            {6376}in(c, (=pkCli_5151,em1_5163: bitstring));
                                            {6377}let m1_5164: bitstring = em1_5163 in
                                            {6378}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_5151,Nc_5165: bitstring) = m1_5164 in
                                            {6379}new Ns_5166: bitstring;
                                            {6380}new ST_5167: bitstring;
                                            {6381}new TTL_5168: bitstring;
                                            {6382}let m2_5169: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_5166,ST_5167,TTL_5168) in
                                            {6383}event beginSrv(Sess_4722,Cli_4720,Ns_5166);
                                            {6384}out(c, m2_5169);
                                            {6385}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                            {6386}event endSrv(Cli_4720,Sess_4722,Nc_5165)
                                        )
                                        else
                                            {6387}let v_5170: bool = (Disco_4721 = C) in
                                            (
                                                {6388}if v_5170 then
                                                (
                                                    {6389}let pkDisco_5171: bitstring = pub(skC) in
                                                    {6390}in(c, (=pkCli_5151,em1_5172: bitstring));
                                                    {6391}let m1_5173: bitstring = em1_5172 in
                                                    {6392}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_5151,Nc_5174: bitstring) = m1_5173 in
                                                    {6393}new Ns_5175: bitstring;
                                                    {6394}new ST_5176: bitstring;
                                                    {6395}new TTL_5177: bitstring;
                                                    {6396}let m2_5178: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_5175,ST_5176,TTL_5177) in
                                                    {6397}event beginSrv(Sess_4722,Cli_4720,Ns_5175);
                                                    {6398}out(c, m2_5178);
                                                    {6399}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                                    {6400}event endSrv(Cli_4720,Sess_4722,Nc_5174)
                                                )
                                                else
                                                    {6401}let pkDisco_5179: bitstring = pub(sk(Disco_4721)) in
                                                    {6402}in(c, (=pkCli_5151,em1_5180: bitstring));
                                                    {6403}let m1_5181: bitstring = em1_5180 in
                                                    {6404}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_5151,Nc_5182: bitstring) = m1_5181 in
                                                    {6405}new Ns_5183: bitstring;
                                                    {6406}new ST_5184: bitstring;
                                                    {6407}new TTL_5185: bitstring;
                                                    {6408}let m2_5186: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_5183,ST_5184,TTL_5185) in
                                                    {6409}event beginSrv(Sess_4722,Cli_4720,Ns_5183);
                                                    {6410}out(c, m2_5186);
                                                    {6411}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                                    {6412}event endSrv(Cli_4720,Sess_4722,Nc_5182)
                                            )
                                            else
                                                {6413}let pkDisco_5187: bitstring = fail-any in
                                                {6414}in(c, (=pkCli_5151,em1_5188: bitstring));
                                                {6415}let m1_5189: bitstring = em1_5188 in
                                                {6416}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_5151,Nc_5190: bitstring) = m1_5189 in
                                                {6417}new Ns_5191: bitstring;
                                                {6418}new ST_5192: bitstring;
                                                {6419}new TTL_5193: bitstring;
                                                {6420}let m2_5194: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_5191,ST_5192,TTL_5193) in
                                                {6421}event beginSrv(Sess_4722,Cli_4720,Ns_5191);
                                                {6422}out(c, m2_5194);
                                                {6423}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                                {6424}event endSrv(Cli_4720,Sess_4722,Nc_5190)
                                    )
                                    else
                                        {6425}let pkDisco_5195: bitstring = fail-any in
                                        {6426}in(c, (=pkCli_5151,em1_5196: bitstring));
                                        {6427}let m1_5197: bitstring = em1_5196 in
                                        {6428}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_5151,Nc_5198: bitstring) = m1_5197 in
                                        {6429}new Ns_5199: bitstring;
                                        {6430}new ST_5200: bitstring;
                                        {6431}new TTL_5201: bitstring;
                                        {6432}let m2_5202: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_5199,ST_5200,TTL_5201) in
                                        {6433}event beginSrv(Sess_4722,Cli_4720,Ns_5199);
                                        {6434}out(c, m2_5202);
                                        {6435}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                        {6436}event endSrv(Cli_4720,Sess_4722,Nc_5198)
                            )
                            else
                                {6437}let pkDisco_5203: bitstring = fail-any in
                                {6438}in(c, (=pkCli_5151,em1_5204: bitstring));
                                {6439}let m1_5205: bitstring = em1_5204 in
                                {6440}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_5151,Nc_5206: bitstring) = m1_5205 in
                                {6441}new Ns_5207: bitstring;
                                {6442}new ST_5208: bitstring;
                                {6443}new TTL_5209: bitstring;
                                {6444}let m2_5210: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_5207,ST_5208,TTL_5209) in
                                {6445}event beginSrv(Sess_4722,Cli_4720,Ns_5207);
                                {6446}out(c, m2_5210);
                                {6447}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                {6448}event endSrv(Cli_4720,Sess_4722,Nc_5206)
                        )
                        else
                            {6449}let v_5211: bool = (Cli_4720 = B) in
                            (
                                {6450}if v_5211 then
                                (
                                    {6451}let pkCli_5212: bitstring = pub(skB) in
                                    {6452}let v_5213: bool = (Disco_4721 = A) in
                                    (
                                        {6453}if v_5213 then
                                        (
                                            {6454}let pkDisco_5214: bitstring = pub(skA) in
                                            {6455}in(c, (=pkCli_5212,em1_5215: bitstring));
                                            {6456}let m1_5216: bitstring = em1_5215 in
                                            {6457}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_5212,Nc_5217: bitstring) = m1_5216 in
                                            {6458}new Ns_5218: bitstring;
                                            {6459}new ST_5219: bitstring;
                                            {6460}new TTL_5220: bitstring;
                                            {6461}let m2_5221: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_5218,ST_5219,TTL_5220) in
                                            {6462}event beginSrv(Sess_4722,Cli_4720,Ns_5218);
                                            {6463}out(c, m2_5221);
                                            {6464}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                            {6465}event endSrv(Cli_4720,Sess_4722,Nc_5217)
                                        )
                                        else
                                            {6466}let v_5222: bool = (Disco_4721 = B) in
                                            (
                                                {6467}if v_5222 then
                                                (
                                                    {6468}let pkDisco_5223: bitstring = pub(skB) in
                                                    {6469}in(c, (=pkCli_5212,em1_5224: bitstring));
                                                    {6470}let m1_5225: bitstring = em1_5224 in
                                                    {6471}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_5212,Nc_5226: bitstring) = m1_5225 in
                                                    {6472}new Ns_5227: bitstring;
                                                    {6473}new ST_5228: bitstring;
                                                    {6474}new TTL_5229: bitstring;
                                                    {6475}let m2_5230: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_5227,ST_5228,TTL_5229) in
                                                    {6476}event beginSrv(Sess_4722,Cli_4720,Ns_5227);
                                                    {6477}out(c, m2_5230);
                                                    {6478}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                                    {6479}event endSrv(Cli_4720,Sess_4722,Nc_5226)
                                                )
                                                else
                                                    {6480}let v_5231: bool = (Disco_4721 = C) in
                                                    (
                                                        {6481}if v_5231 then
                                                        (
                                                            {6482}let pkDisco_5232: bitstring = pub(skC) in
                                                            {6483}in(c, (=pkCli_5212,em1_5233: bitstring));
                                                            {6484}let m1_5234: bitstring = em1_5233 in
                                                            {6485}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_5212,Nc_5235: bitstring) = m1_5234 in
                                                            {6486}new Ns_5236: bitstring;
                                                            {6487}new ST_5237: bitstring;
                                                            {6488}new TTL_5238: bitstring;
                                                            {6489}let m2_5239: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_5236,ST_5237,TTL_5238) in
                                                            {6490}event beginSrv(Sess_4722,Cli_4720,Ns_5236);
                                                            {6491}out(c, m2_5239);
                                                            {6492}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                                            {6493}event endSrv(Cli_4720,Sess_4722,Nc_5235)
                                                        )
                                                        else
                                                            {6494}let pkDisco_5240: bitstring = pub(sk(Disco_4721)) in
                                                            {6495}in(c, (=pkCli_5212,em1_5241: bitstring));
                                                            {6496}let m1_5242: bitstring = em1_5241 in
                                                            {6497}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_5212,Nc_5243: bitstring) = m1_5242 in
                                                            {6498}new Ns_5244: bitstring;
                                                            {6499}new ST_5245: bitstring;
                                                            {6500}new TTL_5246: bitstring;
                                                            {6501}let m2_5247: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_5244,ST_5245,TTL_5246) in
                                                            {6502}event beginSrv(Sess_4722,Cli_4720,Ns_5244);
                                                            {6503}out(c, m2_5247);
                                                            {6504}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                                            {6505}event endSrv(Cli_4720,Sess_4722,Nc_5243)
                                                    )
                                                    else
                                                        {6506}let pkDisco_5248: bitstring = fail-any in
                                                        {6507}in(c, (=pkCli_5212,em1_5249: bitstring));
                                                        {6508}let m1_5250: bitstring = em1_5249 in
                                                        {6509}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_5212,Nc_5251: bitstring) = m1_5250 in
                                                        {6510}new Ns_5252: bitstring;
                                                        {6511}new ST_5253: bitstring;
                                                        {6512}new TTL_5254: bitstring;
                                                        {6513}let m2_5255: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_5252,ST_5253,TTL_5254) in
                                                        {6514}event beginSrv(Sess_4722,Cli_4720,Ns_5252);
                                                        {6515}out(c, m2_5255);
                                                        {6516}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                                        {6517}event endSrv(Cli_4720,Sess_4722,Nc_5251)
                                            )
                                            else
                                                {6518}let pkDisco_5256: bitstring = fail-any in
                                                {6519}in(c, (=pkCli_5212,em1_5257: bitstring));
                                                {6520}let m1_5258: bitstring = em1_5257 in
                                                {6521}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_5212,Nc_5259: bitstring) = m1_5258 in
                                                {6522}new Ns_5260: bitstring;
                                                {6523}new ST_5261: bitstring;
                                                {6524}new TTL_5262: bitstring;
                                                {6525}let m2_5263: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_5260,ST_5261,TTL_5262) in
                                                {6526}event beginSrv(Sess_4722,Cli_4720,Ns_5260);
                                                {6527}out(c, m2_5263);
                                                {6528}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                                {6529}event endSrv(Cli_4720,Sess_4722,Nc_5259)
                                    )
                                    else
                                        {6530}let pkDisco_5264: bitstring = fail-any in
                                        {6531}in(c, (=pkCli_5212,em1_5265: bitstring));
                                        {6532}let m1_5266: bitstring = em1_5265 in
                                        {6533}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_5212,Nc_5267: bitstring) = m1_5266 in
                                        {6534}new Ns_5268: bitstring;
                                        {6535}new ST_5269: bitstring;
                                        {6536}new TTL_5270: bitstring;
                                        {6537}let m2_5271: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_5268,ST_5269,TTL_5270) in
                                        {6538}event beginSrv(Sess_4722,Cli_4720,Ns_5268);
                                        {6539}out(c, m2_5271);
                                        {6540}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                        {6541}event endSrv(Cli_4720,Sess_4722,Nc_5267)
                                )
                                else
                                    {6542}let v_5272: bool = (Cli_4720 = C) in
                                    (
                                        {6543}if v_5272 then
                                        (
                                            {6544}let pkCli_5273: bitstring = pub(skC) in
                                            {6545}let v_5274: bool = (Disco_4721 = A) in
                                            (
                                                {6546}if v_5274 then
                                                (
                                                    {6547}let pkDisco_5275: bitstring = pub(skA) in
                                                    {6548}in(c, (=pkCli_5273,em1_5276: bitstring));
                                                    {6549}let m1_5277: bitstring = em1_5276 in
                                                    {6550}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_5273,Nc_5278: bitstring) = m1_5277 in
                                                    {6551}new Ns_5279: bitstring;
                                                    {6552}new ST_5280: bitstring;
                                                    {6553}new TTL_5281: bitstring;
                                                    {6554}let m2_5282: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_5279,ST_5280,TTL_5281) in
                                                    {6555}event beginSrv(Sess_4722,Cli_4720,Ns_5279);
                                                    {6556}out(c, m2_5282);
                                                    {6557}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                                    {6558}event endSrv(Cli_4720,Sess_4722,Nc_5278)
                                                )
                                                else
                                                    {6559}let v_5283: bool = (Disco_4721 = B) in
                                                    (
                                                        {6560}if v_5283 then
                                                        (
                                                            {6561}let pkDisco_5284: bitstring = pub(skB) in
                                                            {6562}in(c, (=pkCli_5273,em1_5285: bitstring));
                                                            {6563}let m1_5286: bitstring = em1_5285 in
                                                            {6564}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_5273,Nc_5287: bitstring) = m1_5286 in
                                                            {6565}new Ns_5288: bitstring;
                                                            {6566}new ST_5289: bitstring;
                                                            {6567}new TTL_5290: bitstring;
                                                            {6568}let m2_5291: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_5288,ST_5289,TTL_5290) in
                                                            {6569}event beginSrv(Sess_4722,Cli_4720,Ns_5288);
                                                            {6570}out(c, m2_5291);
                                                            {6571}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                                            {6572}event endSrv(Cli_4720,Sess_4722,Nc_5287)
                                                        )
                                                        else
                                                            {6573}let v_5292: bool = (Disco_4721 = C) in
                                                            (
                                                                {6574}if v_5292 then
                                                                (
                                                                    {6575}let pkDisco_5293: bitstring = pub(skC) in
                                                                    {6576}in(c, (=pkCli_5273,em1_5294: bitstring));
                                                                    {6577}let m1_5295: bitstring = em1_5294 in
                                                                    {6578}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_5273,Nc_5296: bitstring) = m1_5295 in
                                                                    {6579}new Ns_5297: bitstring;
                                                                    {6580}new ST_5298: bitstring;
                                                                    {6581}new TTL_5299: bitstring;
                                                                    {6582}let m2_5300: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_5297,ST_5298,TTL_5299) in
                                                                    {6583}event beginSrv(Sess_4722,Cli_4720,Ns_5297);
                                                                    {6584}out(c, m2_5300);
                                                                    {6585}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                                                    {6586}event endSrv(Cli_4720,Sess_4722,Nc_5296)
                                                                )
                                                                else
                                                                    {6587}let pkDisco_5301: bitstring = pub(sk(Disco_4721)) in
                                                                    {6588}in(c, (=pkCli_5273,em1_5302: bitstring));
                                                                    {6589}let m1_5303: bitstring = em1_5302 in
                                                                    {6590}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_5273,Nc_5304: bitstring) = m1_5303 in
                                                                    {6591}new Ns_5305: bitstring;
                                                                    {6592}new ST_5306: bitstring;
                                                                    {6593}new TTL_5307: bitstring;
                                                                    {6594}let m2_5308: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_5305,ST_5306,TTL_5307) in
                                                                    {6595}event beginSrv(Sess_4722,Cli_4720,Ns_5305);
                                                                    {6596}out(c, m2_5308);
                                                                    {6597}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                                                    {6598}event endSrv(Cli_4720,Sess_4722,Nc_5304)
                                                            )
                                                            else
                                                                {6599}let pkDisco_5309: bitstring = fail-any in
                                                                {6600}in(c, (=pkCli_5273,em1_5310: bitstring));
                                                                {6601}let m1_5311: bitstring = em1_5310 in
                                                                {6602}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_5273,Nc_5312: bitstring) = m1_5311 in
                                                                {6603}new Ns_5313: bitstring;
                                                                {6604}new ST_5314: bitstring;
                                                                {6605}new TTL_5315: bitstring;
                                                                {6606}let m2_5316: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_5313,ST_5314,TTL_5315) in
                                                                {6607}event beginSrv(Sess_4722,Cli_4720,Ns_5313);
                                                                {6608}out(c, m2_5316);
                                                                {6609}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                                                {6610}event endSrv(Cli_4720,Sess_4722,Nc_5312)
                                                    )
                                                    else
                                                        {6611}let pkDisco_5317: bitstring = fail-any in
                                                        {6612}in(c, (=pkCli_5273,em1_5318: bitstring));
                                                        {6613}let m1_5319: bitstring = em1_5318 in
                                                        {6614}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_5273,Nc_5320: bitstring) = m1_5319 in
                                                        {6615}new Ns_5321: bitstring;
                                                        {6616}new ST_5322: bitstring;
                                                        {6617}new TTL_5323: bitstring;
                                                        {6618}let m2_5324: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_5321,ST_5322,TTL_5323) in
                                                        {6619}event beginSrv(Sess_4722,Cli_4720,Ns_5321);
                                                        {6620}out(c, m2_5324);
                                                        {6621}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                                        {6622}event endSrv(Cli_4720,Sess_4722,Nc_5320)
                                            )
                                            else
                                                {6623}let pkDisco_5325: bitstring = fail-any in
                                                {6624}in(c, (=pkCli_5273,em1_5326: bitstring));
                                                {6625}let m1_5327: bitstring = em1_5326 in
                                                {6626}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_5273,Nc_5328: bitstring) = m1_5327 in
                                                {6627}new Ns_5329: bitstring;
                                                {6628}new ST_5330: bitstring;
                                                {6629}new TTL_5331: bitstring;
                                                {6630}let m2_5332: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_5329,ST_5330,TTL_5331) in
                                                {6631}event beginSrv(Sess_4722,Cli_4720,Ns_5329);
                                                {6632}out(c, m2_5332);
                                                {6633}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                                {6634}event endSrv(Cli_4720,Sess_4722,Nc_5328)
                                        )
                                        else
                                            {6635}let pkCli_5333: bitstring = pub(sk(Cli_4720)) in
                                            {6636}let v_5334: bool = (Disco_4721 = A) in
                                            (
                                                {6637}if v_5334 then
                                                (
                                                    {6638}let pkDisco_5335: bitstring = pub(skA) in
                                                    {6639}in(c, (=pkCli_5333,em1_5336: bitstring));
                                                    {6640}let m1_5337: bitstring = em1_5336 in
                                                    {6641}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_5333,Nc_5338: bitstring) = m1_5337 in
                                                    {6642}new Ns_5339: bitstring;
                                                    {6643}new ST_5340: bitstring;
                                                    {6644}new TTL_5341: bitstring;
                                                    {6645}let m2_5342: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_5339,ST_5340,TTL_5341) in
                                                    {6646}event beginSrv(Sess_4722,Cli_4720,Ns_5339);
                                                    {6647}out(c, m2_5342);
                                                    {6648}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                                    {6649}event endSrv(Cli_4720,Sess_4722,Nc_5338)
                                                )
                                                else
                                                    {6650}let v_5343: bool = (Disco_4721 = B) in
                                                    (
                                                        {6651}if v_5343 then
                                                        (
                                                            {6652}let pkDisco_5344: bitstring = pub(skB) in
                                                            {6653}in(c, (=pkCli_5333,em1_5345: bitstring));
                                                            {6654}let m1_5346: bitstring = em1_5345 in
                                                            {6655}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_5333,Nc_5347: bitstring) = m1_5346 in
                                                            {6656}new Ns_5348: bitstring;
                                                            {6657}new ST_5349: bitstring;
                                                            {6658}new TTL_5350: bitstring;
                                                            {6659}let m2_5351: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_5348,ST_5349,TTL_5350) in
                                                            {6660}event beginSrv(Sess_4722,Cli_4720,Ns_5348);
                                                            {6661}out(c, m2_5351);
                                                            {6662}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                                            {6663}event endSrv(Cli_4720,Sess_4722,Nc_5347)
                                                        )
                                                        else
                                                            {6664}let v_5352: bool = (Disco_4721 = C) in
                                                            (
                                                                {6665}if v_5352 then
                                                                (
                                                                    {6666}let pkDisco_5353: bitstring = pub(skC) in
                                                                    {6667}in(c, (=pkCli_5333,em1_5354: bitstring));
                                                                    {6668}let m1_5355: bitstring = em1_5354 in
                                                                    {6669}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_5333,Nc_5356: bitstring) = m1_5355 in
                                                                    {6670}new Ns_5357: bitstring;
                                                                    {6671}new ST_5358: bitstring;
                                                                    {6672}new TTL_5359: bitstring;
                                                                    {6673}let m2_5360: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_5357,ST_5358,TTL_5359) in
                                                                    {6674}event beginSrv(Sess_4722,Cli_4720,Ns_5357);
                                                                    {6675}out(c, m2_5360);
                                                                    {6676}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                                                    {6677}event endSrv(Cli_4720,Sess_4722,Nc_5356)
                                                                )
                                                                else
                                                                    {6678}let pkDisco_5361: bitstring = pub(sk(Disco_4721)) in
                                                                    {6679}in(c, (=pkCli_5333,em1_5362: bitstring));
                                                                    {6680}let m1_5363: bitstring = em1_5362 in
                                                                    {6681}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_5333,Nc_5364: bitstring) = m1_5363 in
                                                                    {6682}new Ns_5365: bitstring;
                                                                    {6683}new ST_5366: bitstring;
                                                                    {6684}new TTL_5367: bitstring;
                                                                    {6685}let m2_5368: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_5365,ST_5366,TTL_5367) in
                                                                    {6686}event beginSrv(Sess_4722,Cli_4720,Ns_5365);
                                                                    {6687}out(c, m2_5368);
                                                                    {6688}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                                                    {6689}event endSrv(Cli_4720,Sess_4722,Nc_5364)
                                                            )
                                                            else
                                                                {6690}let pkDisco_5369: bitstring = fail-any in
                                                                {6691}in(c, (=pkCli_5333,em1_5370: bitstring));
                                                                {6692}let m1_5371: bitstring = em1_5370 in
                                                                {6693}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_5333,Nc_5372: bitstring) = m1_5371 in
                                                                {6694}new Ns_5373: bitstring;
                                                                {6695}new ST_5374: bitstring;
                                                                {6696}new TTL_5375: bitstring;
                                                                {6697}let m2_5376: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_5373,ST_5374,TTL_5375) in
                                                                {6698}event beginSrv(Sess_4722,Cli_4720,Ns_5373);
                                                                {6699}out(c, m2_5376);
                                                                {6700}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                                                {6701}event endSrv(Cli_4720,Sess_4722,Nc_5372)
                                                    )
                                                    else
                                                        {6702}let pkDisco_5377: bitstring = fail-any in
                                                        {6703}in(c, (=pkCli_5333,em1_5378: bitstring));
                                                        {6704}let m1_5379: bitstring = em1_5378 in
                                                        {6705}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_5333,Nc_5380: bitstring) = m1_5379 in
                                                        {6706}new Ns_5381: bitstring;
                                                        {6707}new ST_5382: bitstring;
                                                        {6708}new TTL_5383: bitstring;
                                                        {6709}let m2_5384: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_5381,ST_5382,TTL_5383) in
                                                        {6710}event beginSrv(Sess_4722,Cli_4720,Ns_5381);
                                                        {6711}out(c, m2_5384);
                                                        {6712}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                                        {6713}event endSrv(Cli_4720,Sess_4722,Nc_5380)
                                            )
                                            else
                                                {6714}let pkDisco_5385: bitstring = fail-any in
                                                {6715}in(c, (=pkCli_5333,em1_5386: bitstring));
                                                {6716}let m1_5387: bitstring = em1_5386 in
                                                {6717}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_5333,Nc_5388: bitstring) = m1_5387 in
                                                {6718}new Ns_5389: bitstring;
                                                {6719}new ST_5390: bitstring;
                                                {6720}new TTL_5391: bitstring;
                                                {6721}let m2_5392: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_5389,ST_5390,TTL_5391) in
                                                {6722}event beginSrv(Sess_4722,Cli_4720,Ns_5389);
                                                {6723}out(c, m2_5392);
                                                {6724}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                                {6725}event endSrv(Cli_4720,Sess_4722,Nc_5388)
                                    )
                                    else
                                        {6726}let pkCli_5393: bitstring = fail-any in
                                        {6727}let v_5394: bool = (Disco_4721 = A) in
                                        (
                                            {6728}if v_5394 then
                                            (
                                                {6729}let pkDisco_5395: bitstring = pub(skA) in
                                                {6730}in(c, (=pkCli_5393,em1_5396: bitstring));
                                                {6731}let m1_5397: bitstring = em1_5396 in
                                                {6732}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_5393,Nc_5398: bitstring) = m1_5397 in
                                                {6733}new Ns_5399: bitstring;
                                                {6734}new ST_5400: bitstring;
                                                {6735}new TTL_5401: bitstring;
                                                {6736}let m2_5402: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_5399,ST_5400,TTL_5401) in
                                                {6737}event beginSrv(Sess_4722,Cli_4720,Ns_5399);
                                                {6738}out(c, m2_5402);
                                                {6739}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                                {6740}event endSrv(Cli_4720,Sess_4722,Nc_5398)
                                            )
                                            else
                                                {6741}let v_5403: bool = (Disco_4721 = B) in
                                                (
                                                    {6742}if v_5403 then
                                                    (
                                                        {6743}let pkDisco_5404: bitstring = pub(skB) in
                                                        {6744}in(c, (=pkCli_5393,em1_5405: bitstring));
                                                        {6745}let m1_5406: bitstring = em1_5405 in
                                                        {6746}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_5393,Nc_5407: bitstring) = m1_5406 in
                                                        {6747}new Ns_5408: bitstring;
                                                        {6748}new ST_5409: bitstring;
                                                        {6749}new TTL_5410: bitstring;
                                                        {6750}let m2_5411: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_5408,ST_5409,TTL_5410) in
                                                        {6751}event beginSrv(Sess_4722,Cli_4720,Ns_5408);
                                                        {6752}out(c, m2_5411);
                                                        {6753}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                                        {6754}event endSrv(Cli_4720,Sess_4722,Nc_5407)
                                                    )
                                                    else
                                                        {6755}let v_5412: bool = (Disco_4721 = C) in
                                                        (
                                                            {6756}if v_5412 then
                                                            (
                                                                {6757}let pkDisco_5413: bitstring = pub(skC) in
                                                                {6758}in(c, (=pkCli_5393,em1_5414: bitstring));
                                                                {6759}let m1_5415: bitstring = em1_5414 in
                                                                {6760}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_5393,Nc_5416: bitstring) = m1_5415 in
                                                                {6761}new Ns_5417: bitstring;
                                                                {6762}new ST_5418: bitstring;
                                                                {6763}new TTL_5419: bitstring;
                                                                {6764}let m2_5420: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_5417,ST_5418,TTL_5419) in
                                                                {6765}event beginSrv(Sess_4722,Cli_4720,Ns_5417);
                                                                {6766}out(c, m2_5420);
                                                                {6767}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                                                {6768}event endSrv(Cli_4720,Sess_4722,Nc_5416)
                                                            )
                                                            else
                                                                {6769}let pkDisco_5421: bitstring = pub(sk(Disco_4721)) in
                                                                {6770}in(c, (=pkCli_5393,em1_5422: bitstring));
                                                                {6771}let m1_5423: bitstring = em1_5422 in
                                                                {6772}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_5393,Nc_5424: bitstring) = m1_5423 in
                                                                {6773}new Ns_5425: bitstring;
                                                                {6774}new ST_5426: bitstring;
                                                                {6775}new TTL_5427: bitstring;
                                                                {6776}let m2_5428: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_5425,ST_5426,TTL_5427) in
                                                                {6777}event beginSrv(Sess_4722,Cli_4720,Ns_5425);
                                                                {6778}out(c, m2_5428);
                                                                {6779}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                                                {6780}event endSrv(Cli_4720,Sess_4722,Nc_5424)
                                                        )
                                                        else
                                                            {6781}let pkDisco_5429: bitstring = fail-any in
                                                            {6782}in(c, (=pkCli_5393,em1_5430: bitstring));
                                                            {6783}let m1_5431: bitstring = em1_5430 in
                                                            {6784}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_5393,Nc_5432: bitstring) = m1_5431 in
                                                            {6785}new Ns_5433: bitstring;
                                                            {6786}new ST_5434: bitstring;
                                                            {6787}new TTL_5435: bitstring;
                                                            {6788}let m2_5436: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_5433,ST_5434,TTL_5435) in
                                                            {6789}event beginSrv(Sess_4722,Cli_4720,Ns_5433);
                                                            {6790}out(c, m2_5436);
                                                            {6791}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                                            {6792}event endSrv(Cli_4720,Sess_4722,Nc_5432)
                                                )
                                                else
                                                    {6793}let pkDisco_5437: bitstring = fail-any in
                                                    {6794}in(c, (=pkCli_5393,em1_5438: bitstring));
                                                    {6795}let m1_5439: bitstring = em1_5438 in
                                                    {6796}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_5393,Nc_5440: bitstring) = m1_5439 in
                                                    {6797}new Ns_5441: bitstring;
                                                    {6798}new ST_5442: bitstring;
                                                    {6799}new TTL_5443: bitstring;
                                                    {6800}let m2_5444: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_5441,ST_5442,TTL_5443) in
                                                    {6801}event beginSrv(Sess_4722,Cli_4720,Ns_5441);
                                                    {6802}out(c, m2_5444);
                                                    {6803}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                                    {6804}event endSrv(Cli_4720,Sess_4722,Nc_5440)
                                        )
                                        else
                                            {6805}let pkDisco_5445: bitstring = fail-any in
                                            {6806}in(c, (=pkCli_5393,em1_5446: bitstring));
                                            {6807}let m1_5447: bitstring = em1_5446 in
                                            {6808}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_5393,Nc_5448: bitstring) = m1_5447 in
                                            {6809}new Ns_5449: bitstring;
                                            {6810}new ST_5450: bitstring;
                                            {6811}new TTL_5451: bitstring;
                                            {6812}let m2_5452: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_5449,ST_5450,TTL_5451) in
                                            {6813}event beginSrv(Sess_4722,Cli_4720,Ns_5449);
                                            {6814}out(c, m2_5452);
                                            {6815}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                            {6816}event endSrv(Cli_4720,Sess_4722,Nc_5448)
                            )
                            else
                                {6817}let pkCli_5453: bitstring = fail-any in
                                {6818}let v_5454: bool = (Disco_4721 = A) in
                                (
                                    {6819}if v_5454 then
                                    (
                                        {6820}let pkDisco_5455: bitstring = pub(skA) in
                                        {6821}in(c, (=pkCli_5453,em1_5456: bitstring));
                                        {6822}let m1_5457: bitstring = em1_5456 in
                                        {6823}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_5453,Nc_5458: bitstring) = m1_5457 in
                                        {6824}new Ns_5459: bitstring;
                                        {6825}new ST_5460: bitstring;
                                        {6826}new TTL_5461: bitstring;
                                        {6827}let m2_5462: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_5459,ST_5460,TTL_5461) in
                                        {6828}event beginSrv(Sess_4722,Cli_4720,Ns_5459);
                                        {6829}out(c, m2_5462);
                                        {6830}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                        {6831}event endSrv(Cli_4720,Sess_4722,Nc_5458)
                                    )
                                    else
                                        {6832}let v_5463: bool = (Disco_4721 = B) in
                                        (
                                            {6833}if v_5463 then
                                            (
                                                {6834}let pkDisco_5464: bitstring = pub(skB) in
                                                {6835}in(c, (=pkCli_5453,em1_5465: bitstring));
                                                {6836}let m1_5466: bitstring = em1_5465 in
                                                {6837}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_5453,Nc_5467: bitstring) = m1_5466 in
                                                {6838}new Ns_5468: bitstring;
                                                {6839}new ST_5469: bitstring;
                                                {6840}new TTL_5470: bitstring;
                                                {6841}let m2_5471: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_5468,ST_5469,TTL_5470) in
                                                {6842}event beginSrv(Sess_4722,Cli_4720,Ns_5468);
                                                {6843}out(c, m2_5471);
                                                {6844}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                                {6845}event endSrv(Cli_4720,Sess_4722,Nc_5467)
                                            )
                                            else
                                                {6846}let v_5472: bool = (Disco_4721 = C) in
                                                (
                                                    {6847}if v_5472 then
                                                    (
                                                        {6848}let pkDisco_5473: bitstring = pub(skC) in
                                                        {6849}in(c, (=pkCli_5453,em1_5474: bitstring));
                                                        {6850}let m1_5475: bitstring = em1_5474 in
                                                        {6851}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_5453,Nc_5476: bitstring) = m1_5475 in
                                                        {6852}new Ns_5477: bitstring;
                                                        {6853}new ST_5478: bitstring;
                                                        {6854}new TTL_5479: bitstring;
                                                        {6855}let m2_5480: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_5477,ST_5478,TTL_5479) in
                                                        {6856}event beginSrv(Sess_4722,Cli_4720,Ns_5477);
                                                        {6857}out(c, m2_5480);
                                                        {6858}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                                        {6859}event endSrv(Cli_4720,Sess_4722,Nc_5476)
                                                    )
                                                    else
                                                        {6860}let pkDisco_5481: bitstring = pub(sk(Disco_4721)) in
                                                        {6861}in(c, (=pkCli_5453,em1_5482: bitstring));
                                                        {6862}let m1_5483: bitstring = em1_5482 in
                                                        {6863}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_5453,Nc_5484: bitstring) = m1_5483 in
                                                        {6864}new Ns_5485: bitstring;
                                                        {6865}new ST_5486: bitstring;
                                                        {6866}new TTL_5487: bitstring;
                                                        {6867}let m2_5488: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_5485,ST_5486,TTL_5487) in
                                                        {6868}event beginSrv(Sess_4722,Cli_4720,Ns_5485);
                                                        {6869}out(c, m2_5488);
                                                        {6870}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                                        {6871}event endSrv(Cli_4720,Sess_4722,Nc_5484)
                                                )
                                                else
                                                    {6872}let pkDisco_5489: bitstring = fail-any in
                                                    {6873}in(c, (=pkCli_5453,em1_5490: bitstring));
                                                    {6874}let m1_5491: bitstring = em1_5490 in
                                                    {6875}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_5453,Nc_5492: bitstring) = m1_5491 in
                                                    {6876}new Ns_5493: bitstring;
                                                    {6877}new ST_5494: bitstring;
                                                    {6878}new TTL_5495: bitstring;
                                                    {6879}let m2_5496: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_5493,ST_5494,TTL_5495) in
                                                    {6880}event beginSrv(Sess_4722,Cli_4720,Ns_5493);
                                                    {6881}out(c, m2_5496);
                                                    {6882}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                                    {6883}event endSrv(Cli_4720,Sess_4722,Nc_5492)
                                        )
                                        else
                                            {6884}let pkDisco_5497: bitstring = fail-any in
                                            {6885}in(c, (=pkCli_5453,em1_5498: bitstring));
                                            {6886}let m1_5499: bitstring = em1_5498 in
                                            {6887}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_5453,Nc_5500: bitstring) = m1_5499 in
                                            {6888}new Ns_5501: bitstring;
                                            {6889}new ST_5502: bitstring;
                                            {6890}new TTL_5503: bitstring;
                                            {6891}let m2_5504: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_5501,ST_5502,TTL_5503) in
                                            {6892}event beginSrv(Sess_4722,Cli_4720,Ns_5501);
                                            {6893}out(c, m2_5504);
                                            {6894}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                            {6895}event endSrv(Cli_4720,Sess_4722,Nc_5500)
                                )
                                else
                                    {6896}let pkDisco_5505: bitstring = fail-any in
                                    {6897}in(c, (=pkCli_5453,em1_5506: bitstring));
                                    {6898}let m1_5507: bitstring = em1_5506 in
                                    {6899}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_5453,Nc_5508: bitstring) = m1_5507 in
                                    {6900}new Ns_5509: bitstring;
                                    {6901}new ST_5510: bitstring;
                                    {6902}new TTL_5511: bitstring;
                                    {6903}let m2_5512: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_5509,ST_5510,TTL_5511) in
                                    {6904}event beginSrv(Sess_4722,Cli_4720,Ns_5509);
                                    {6905}out(c, m2_5512);
                                    {6906}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                    {6907}event endSrv(Cli_4720,Sess_4722,Nc_5508)
                    )
                    else
                        {6908}let pkCli_5513: bitstring = fail-any in
                        {6909}let v_5514: bool = (Disco_4721 = A) in
                        (
                            {6910}if v_5514 then
                            (
                                {6911}let pkDisco_5515: bitstring = pub(skA) in
                                {6912}in(c, (=pkCli_5513,em1_5516: bitstring));
                                {6913}let m1_5517: bitstring = em1_5516 in
                                {6914}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_5513,Nc_5518: bitstring) = m1_5517 in
                                {6915}new Ns_5519: bitstring;
                                {6916}new ST_5520: bitstring;
                                {6917}new TTL_5521: bitstring;
                                {6918}let m2_5522: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_5519,ST_5520,TTL_5521) in
                                {6919}event beginSrv(Sess_4722,Cli_4720,Ns_5519);
                                {6920}out(c, m2_5522);
                                {6921}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                {6922}event endSrv(Cli_4720,Sess_4722,Nc_5518)
                            )
                            else
                                {6923}let v_5523: bool = (Disco_4721 = B) in
                                (
                                    {6924}if v_5523 then
                                    (
                                        {6925}let pkDisco_5524: bitstring = pub(skB) in
                                        {6926}in(c, (=pkCli_5513,em1_5525: bitstring));
                                        {6927}let m1_5526: bitstring = em1_5525 in
                                        {6928}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_5513,Nc_5527: bitstring) = m1_5526 in
                                        {6929}new Ns_5528: bitstring;
                                        {6930}new ST_5529: bitstring;
                                        {6931}new TTL_5530: bitstring;
                                        {6932}let m2_5531: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_5528,ST_5529,TTL_5530) in
                                        {6933}event beginSrv(Sess_4722,Cli_4720,Ns_5528);
                                        {6934}out(c, m2_5531);
                                        {6935}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                        {6936}event endSrv(Cli_4720,Sess_4722,Nc_5527)
                                    )
                                    else
                                        {6937}let v_5532: bool = (Disco_4721 = C) in
                                        (
                                            {6938}if v_5532 then
                                            (
                                                {6939}let pkDisco_5533: bitstring = pub(skC) in
                                                {6940}in(c, (=pkCli_5513,em1_5534: bitstring));
                                                {6941}let m1_5535: bitstring = em1_5534 in
                                                {6942}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_5513,Nc_5536: bitstring) = m1_5535 in
                                                {6943}new Ns_5537: bitstring;
                                                {6944}new ST_5538: bitstring;
                                                {6945}new TTL_5539: bitstring;
                                                {6946}let m2_5540: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_5537,ST_5538,TTL_5539) in
                                                {6947}event beginSrv(Sess_4722,Cli_4720,Ns_5537);
                                                {6948}out(c, m2_5540);
                                                {6949}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                                {6950}event endSrv(Cli_4720,Sess_4722,Nc_5536)
                                            )
                                            else
                                                {6951}let pkDisco_5541: bitstring = pub(sk(Disco_4721)) in
                                                {6952}in(c, (=pkCli_5513,em1_5542: bitstring));
                                                {6953}let m1_5543: bitstring = em1_5542 in
                                                {6954}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_5513,Nc_5544: bitstring) = m1_5543 in
                                                {6955}new Ns_5545: bitstring;
                                                {6956}new ST_5546: bitstring;
                                                {6957}new TTL_5547: bitstring;
                                                {6958}let m2_5548: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_5545,ST_5546,TTL_5547) in
                                                {6959}event beginSrv(Sess_4722,Cli_4720,Ns_5545);
                                                {6960}out(c, m2_5548);
                                                {6961}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                                {6962}event endSrv(Cli_4720,Sess_4722,Nc_5544)
                                        )
                                        else
                                            {6963}let pkDisco_5549: bitstring = fail-any in
                                            {6964}in(c, (=pkCli_5513,em1_5550: bitstring));
                                            {6965}let m1_5551: bitstring = em1_5550 in
                                            {6966}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_5513,Nc_5552: bitstring) = m1_5551 in
                                            {6967}new Ns_5553: bitstring;
                                            {6968}new ST_5554: bitstring;
                                            {6969}new TTL_5555: bitstring;
                                            {6970}let m2_5556: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_5553,ST_5554,TTL_5555) in
                                            {6971}event beginSrv(Sess_4722,Cli_4720,Ns_5553);
                                            {6972}out(c, m2_5556);
                                            {6973}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                            {6974}event endSrv(Cli_4720,Sess_4722,Nc_5552)
                                )
                                else
                                    {6975}let pkDisco_5557: bitstring = fail-any in
                                    {6976}in(c, (=pkCli_5513,em1_5558: bitstring));
                                    {6977}let m1_5559: bitstring = em1_5558 in
                                    {6978}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_5513,Nc_5560: bitstring) = m1_5559 in
                                    {6979}new Ns_5561: bitstring;
                                    {6980}new ST_5562: bitstring;
                                    {6981}new TTL_5563: bitstring;
                                    {6982}let m2_5564: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_5561,ST_5562,TTL_5563) in
                                    {6983}event beginSrv(Sess_4722,Cli_4720,Ns_5561);
                                    {6984}out(c, m2_5564);
                                    {6985}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                    {6986}event endSrv(Cli_4720,Sess_4722,Nc_5560)
                        )
                        else
                            {6987}let pkDisco_5565: bitstring = fail-any in
                            {6988}in(c, (=pkCli_5513,em1_5566: bitstring));
                            {6989}let m1_5567: bitstring = em1_5566 in
                            {6990}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_5513,Nc_5568: bitstring) = m1_5567 in
                            {6991}new Ns_5569: bitstring;
                            {6992}new ST_5570: bitstring;
                            {6993}new TTL_5571: bitstring;
                            {6994}let m2_5572: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_5569,ST_5570,TTL_5571) in
                            {6995}event beginSrv(Sess_4722,Cli_4720,Ns_5569);
                            {6996}out(c, m2_5572);
                            {6997}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                            {6998}event endSrv(Cli_4720,Sess_4722,Nc_5568)
                )
                else
                    {6999}let =true = (Sess_4722 = C) in
                    (
                        {7000}let skSess_5573: bitstring = skC in
                        {7001}let pkSess_5574: bitstring = pub(skSess_5573) in
                        {7002}let v_5575: bool = (Cli_4720 = A) in
                        (
                            {7003}if v_5575 then
                            (
                                {7004}let pkCli_5576: bitstring = pub(skA) in
                                {7005}let v_5577: bool = (Disco_4721 = A) in
                                (
                                    {7006}if v_5577 then
                                    (
                                        {7007}let pkDisco_5578: bitstring = pub(skA) in
                                        {7008}in(c, (=pkCli_5576,em1_5579: bitstring));
                                        {7009}let m1_5580: bitstring = em1_5579 in
                                        {7010}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_5576,Nc_5581: bitstring) = m1_5580 in
                                        {7011}new Ns_5582: bitstring;
                                        {7012}new ST_5583: bitstring;
                                        {7013}new TTL_5584: bitstring;
                                        {7014}let m2_5585: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_5582,ST_5583,TTL_5584) in
                                        {7015}event beginSrv(Sess_4722,Cli_4720,Ns_5582);
                                        {7016}out(c, m2_5585);
                                        {7017}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                        {7018}event endSrv(Cli_4720,Sess_4722,Nc_5581)
                                    )
                                    else
                                        {7019}let v_5586: bool = (Disco_4721 = B) in
                                        (
                                            {7020}if v_5586 then
                                            (
                                                {7021}let pkDisco_5587: bitstring = pub(skB) in
                                                {7022}in(c, (=pkCli_5576,em1_5588: bitstring));
                                                {7023}let m1_5589: bitstring = em1_5588 in
                                                {7024}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_5576,Nc_5590: bitstring) = m1_5589 in
                                                {7025}new Ns_5591: bitstring;
                                                {7026}new ST_5592: bitstring;
                                                {7027}new TTL_5593: bitstring;
                                                {7028}let m2_5594: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_5591,ST_5592,TTL_5593) in
                                                {7029}event beginSrv(Sess_4722,Cli_4720,Ns_5591);
                                                {7030}out(c, m2_5594);
                                                {7031}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                                {7032}event endSrv(Cli_4720,Sess_4722,Nc_5590)
                                            )
                                            else
                                                {7033}let v_5595: bool = (Disco_4721 = C) in
                                                (
                                                    {7034}if v_5595 then
                                                    (
                                                        {7035}let pkDisco_5596: bitstring = pub(skC) in
                                                        {7036}in(c, (=pkCli_5576,em1_5597: bitstring));
                                                        {7037}let m1_5598: bitstring = em1_5597 in
                                                        {7038}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_5576,Nc_5599: bitstring) = m1_5598 in
                                                        {7039}new Ns_5600: bitstring;
                                                        {7040}new ST_5601: bitstring;
                                                        {7041}new TTL_5602: bitstring;
                                                        {7042}let m2_5603: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_5600,ST_5601,TTL_5602) in
                                                        {7043}event beginSrv(Sess_4722,Cli_4720,Ns_5600);
                                                        {7044}out(c, m2_5603);
                                                        {7045}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                                        {7046}event endSrv(Cli_4720,Sess_4722,Nc_5599)
                                                    )
                                                    else
                                                        {7047}let pkDisco_5604: bitstring = pub(sk(Disco_4721)) in
                                                        {7048}in(c, (=pkCli_5576,em1_5605: bitstring));
                                                        {7049}let m1_5606: bitstring = em1_5605 in
                                                        {7050}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_5576,Nc_5607: bitstring) = m1_5606 in
                                                        {7051}new Ns_5608: bitstring;
                                                        {7052}new ST_5609: bitstring;
                                                        {7053}new TTL_5610: bitstring;
                                                        {7054}let m2_5611: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_5608,ST_5609,TTL_5610) in
                                                        {7055}event beginSrv(Sess_4722,Cli_4720,Ns_5608);
                                                        {7056}out(c, m2_5611);
                                                        {7057}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                                        {7058}event endSrv(Cli_4720,Sess_4722,Nc_5607)
                                                )
                                                else
                                                    {7059}let pkDisco_5612: bitstring = fail-any in
                                                    {7060}in(c, (=pkCli_5576,em1_5613: bitstring));
                                                    {7061}let m1_5614: bitstring = em1_5613 in
                                                    {7062}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_5576,Nc_5615: bitstring) = m1_5614 in
                                                    {7063}new Ns_5616: bitstring;
                                                    {7064}new ST_5617: bitstring;
                                                    {7065}new TTL_5618: bitstring;
                                                    {7066}let m2_5619: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_5616,ST_5617,TTL_5618) in
                                                    {7067}event beginSrv(Sess_4722,Cli_4720,Ns_5616);
                                                    {7068}out(c, m2_5619);
                                                    {7069}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                                    {7070}event endSrv(Cli_4720,Sess_4722,Nc_5615)
                                        )
                                        else
                                            {7071}let pkDisco_5620: bitstring = fail-any in
                                            {7072}in(c, (=pkCli_5576,em1_5621: bitstring));
                                            {7073}let m1_5622: bitstring = em1_5621 in
                                            {7074}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_5576,Nc_5623: bitstring) = m1_5622 in
                                            {7075}new Ns_5624: bitstring;
                                            {7076}new ST_5625: bitstring;
                                            {7077}new TTL_5626: bitstring;
                                            {7078}let m2_5627: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_5624,ST_5625,TTL_5626) in
                                            {7079}event beginSrv(Sess_4722,Cli_4720,Ns_5624);
                                            {7080}out(c, m2_5627);
                                            {7081}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                            {7082}event endSrv(Cli_4720,Sess_4722,Nc_5623)
                                )
                                else
                                    {7083}let pkDisco_5628: bitstring = fail-any in
                                    {7084}in(c, (=pkCli_5576,em1_5629: bitstring));
                                    {7085}let m1_5630: bitstring = em1_5629 in
                                    {7086}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_5576,Nc_5631: bitstring) = m1_5630 in
                                    {7087}new Ns_5632: bitstring;
                                    {7088}new ST_5633: bitstring;
                                    {7089}new TTL_5634: bitstring;
                                    {7090}let m2_5635: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_5632,ST_5633,TTL_5634) in
                                    {7091}event beginSrv(Sess_4722,Cli_4720,Ns_5632);
                                    {7092}out(c, m2_5635);
                                    {7093}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                    {7094}event endSrv(Cli_4720,Sess_4722,Nc_5631)
                            )
                            else
                                {7095}let v_5636: bool = (Cli_4720 = B) in
                                (
                                    {7096}if v_5636 then
                                    (
                                        {7097}let pkCli_5637: bitstring = pub(skB) in
                                        {7098}let v_5638: bool = (Disco_4721 = A) in
                                        (
                                            {7099}if v_5638 then
                                            (
                                                {7100}let pkDisco_5639: bitstring = pub(skA) in
                                                {7101}in(c, (=pkCli_5637,em1_5640: bitstring));
                                                {7102}let m1_5641: bitstring = em1_5640 in
                                                {7103}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_5637,Nc_5642: bitstring) = m1_5641 in
                                                {7104}new Ns_5643: bitstring;
                                                {7105}new ST_5644: bitstring;
                                                {7106}new TTL_5645: bitstring;
                                                {7107}let m2_5646: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_5643,ST_5644,TTL_5645) in
                                                {7108}event beginSrv(Sess_4722,Cli_4720,Ns_5643);
                                                {7109}out(c, m2_5646);
                                                {7110}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                                {7111}event endSrv(Cli_4720,Sess_4722,Nc_5642)
                                            )
                                            else
                                                {7112}let v_5647: bool = (Disco_4721 = B) in
                                                (
                                                    {7113}if v_5647 then
                                                    (
                                                        {7114}let pkDisco_5648: bitstring = pub(skB) in
                                                        {7115}in(c, (=pkCli_5637,em1_5649: bitstring));
                                                        {7116}let m1_5650: bitstring = em1_5649 in
                                                        {7117}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_5637,Nc_5651: bitstring) = m1_5650 in
                                                        {7118}new Ns_5652: bitstring;
                                                        {7119}new ST_5653: bitstring;
                                                        {7120}new TTL_5654: bitstring;
                                                        {7121}let m2_5655: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_5652,ST_5653,TTL_5654) in
                                                        {7122}event beginSrv(Sess_4722,Cli_4720,Ns_5652);
                                                        {7123}out(c, m2_5655);
                                                        {7124}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                                        {7125}event endSrv(Cli_4720,Sess_4722,Nc_5651)
                                                    )
                                                    else
                                                        {7126}let v_5656: bool = (Disco_4721 = C) in
                                                        (
                                                            {7127}if v_5656 then
                                                            (
                                                                {7128}let pkDisco_5657: bitstring = pub(skC) in
                                                                {7129}in(c, (=pkCli_5637,em1_5658: bitstring));
                                                                {7130}let m1_5659: bitstring = em1_5658 in
                                                                {7131}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_5637,Nc_5660: bitstring) = m1_5659 in
                                                                {7132}new Ns_5661: bitstring;
                                                                {7133}new ST_5662: bitstring;
                                                                {7134}new TTL_5663: bitstring;
                                                                {7135}let m2_5664: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_5661,ST_5662,TTL_5663) in
                                                                {7136}event beginSrv(Sess_4722,Cli_4720,Ns_5661);
                                                                {7137}out(c, m2_5664);
                                                                {7138}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                                                {7139}event endSrv(Cli_4720,Sess_4722,Nc_5660)
                                                            )
                                                            else
                                                                {7140}let pkDisco_5665: bitstring = pub(sk(Disco_4721)) in
                                                                {7141}in(c, (=pkCli_5637,em1_5666: bitstring));
                                                                {7142}let m1_5667: bitstring = em1_5666 in
                                                                {7143}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_5637,Nc_5668: bitstring) = m1_5667 in
                                                                {7144}new Ns_5669: bitstring;
                                                                {7145}new ST_5670: bitstring;
                                                                {7146}new TTL_5671: bitstring;
                                                                {7147}let m2_5672: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_5669,ST_5670,TTL_5671) in
                                                                {7148}event beginSrv(Sess_4722,Cli_4720,Ns_5669);
                                                                {7149}out(c, m2_5672);
                                                                {7150}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                                                {7151}event endSrv(Cli_4720,Sess_4722,Nc_5668)
                                                        )
                                                        else
                                                            {7152}let pkDisco_5673: bitstring = fail-any in
                                                            {7153}in(c, (=pkCli_5637,em1_5674: bitstring));
                                                            {7154}let m1_5675: bitstring = em1_5674 in
                                                            {7155}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_5637,Nc_5676: bitstring) = m1_5675 in
                                                            {7156}new Ns_5677: bitstring;
                                                            {7157}new ST_5678: bitstring;
                                                            {7158}new TTL_5679: bitstring;
                                                            {7159}let m2_5680: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_5677,ST_5678,TTL_5679) in
                                                            {7160}event beginSrv(Sess_4722,Cli_4720,Ns_5677);
                                                            {7161}out(c, m2_5680);
                                                            {7162}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                                            {7163}event endSrv(Cli_4720,Sess_4722,Nc_5676)
                                                )
                                                else
                                                    {7164}let pkDisco_5681: bitstring = fail-any in
                                                    {7165}in(c, (=pkCli_5637,em1_5682: bitstring));
                                                    {7166}let m1_5683: bitstring = em1_5682 in
                                                    {7167}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_5637,Nc_5684: bitstring) = m1_5683 in
                                                    {7168}new Ns_5685: bitstring;
                                                    {7169}new ST_5686: bitstring;
                                                    {7170}new TTL_5687: bitstring;
                                                    {7171}let m2_5688: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_5685,ST_5686,TTL_5687) in
                                                    {7172}event beginSrv(Sess_4722,Cli_4720,Ns_5685);
                                                    {7173}out(c, m2_5688);
                                                    {7174}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                                    {7175}event endSrv(Cli_4720,Sess_4722,Nc_5684)
                                        )
                                        else
                                            {7176}let pkDisco_5689: bitstring = fail-any in
                                            {7177}in(c, (=pkCli_5637,em1_5690: bitstring));
                                            {7178}let m1_5691: bitstring = em1_5690 in
                                            {7179}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_5637,Nc_5692: bitstring) = m1_5691 in
                                            {7180}new Ns_5693: bitstring;
                                            {7181}new ST_5694: bitstring;
                                            {7182}new TTL_5695: bitstring;
                                            {7183}let m2_5696: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_5693,ST_5694,TTL_5695) in
                                            {7184}event beginSrv(Sess_4722,Cli_4720,Ns_5693);
                                            {7185}out(c, m2_5696);
                                            {7186}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                            {7187}event endSrv(Cli_4720,Sess_4722,Nc_5692)
                                    )
                                    else
                                        {7188}let v_5697: bool = (Cli_4720 = C) in
                                        (
                                            {7189}if v_5697 then
                                            (
                                                {7190}let pkCli_5698: bitstring = pub(skC) in
                                                {7191}let v_5699: bool = (Disco_4721 = A) in
                                                (
                                                    {7192}if v_5699 then
                                                    (
                                                        {7193}let pkDisco_5700: bitstring = pub(skA) in
                                                        {7194}in(c, (=pkCli_5698,em1_5701: bitstring));
                                                        {7195}let m1_5702: bitstring = em1_5701 in
                                                        {7196}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_5698,Nc_5703: bitstring) = m1_5702 in
                                                        {7197}new Ns_5704: bitstring;
                                                        {7198}new ST_5705: bitstring;
                                                        {7199}new TTL_5706: bitstring;
                                                        {7200}let m2_5707: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_5704,ST_5705,TTL_5706) in
                                                        {7201}event beginSrv(Sess_4722,Cli_4720,Ns_5704);
                                                        {7202}out(c, m2_5707);
                                                        {7203}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                                        {7204}event endSrv(Cli_4720,Sess_4722,Nc_5703)
                                                    )
                                                    else
                                                        {7205}let v_5708: bool = (Disco_4721 = B) in
                                                        (
                                                            {7206}if v_5708 then
                                                            (
                                                                {7207}let pkDisco_5709: bitstring = pub(skB) in
                                                                {7208}in(c, (=pkCli_5698,em1_5710: bitstring));
                                                                {7209}let m1_5711: bitstring = em1_5710 in
                                                                {7210}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_5698,Nc_5712: bitstring) = m1_5711 in
                                                                {7211}new Ns_5713: bitstring;
                                                                {7212}new ST_5714: bitstring;
                                                                {7213}new TTL_5715: bitstring;
                                                                {7214}let m2_5716: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_5713,ST_5714,TTL_5715) in
                                                                {7215}event beginSrv(Sess_4722,Cli_4720,Ns_5713);
                                                                {7216}out(c, m2_5716);
                                                                {7217}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                                                {7218}event endSrv(Cli_4720,Sess_4722,Nc_5712)
                                                            )
                                                            else
                                                                {7219}let v_5717: bool = (Disco_4721 = C) in
                                                                (
                                                                    {7220}if v_5717 then
                                                                    (
                                                                        {7221}let pkDisco_5718: bitstring = pub(skC) in
                                                                        {7222}in(c, (=pkCli_5698,em1_5719: bitstring));
                                                                        {7223}let m1_5720: bitstring = em1_5719 in
                                                                        {7224}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_5698,Nc_5721: bitstring) = m1_5720 in
                                                                        {7225}new Ns_5722: bitstring;
                                                                        {7226}new ST_5723: bitstring;
                                                                        {7227}new TTL_5724: bitstring;
                                                                        {7228}let m2_5725: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_5722,ST_5723,TTL_5724) in
                                                                        {7229}event beginSrv(Sess_4722,Cli_4720,Ns_5722);
                                                                        {7230}out(c, m2_5725);
                                                                        {7231}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                                                        {7232}event endSrv(Cli_4720,Sess_4722,Nc_5721)
                                                                    )
                                                                    else
                                                                        {7233}let pkDisco_5726: bitstring = pub(sk(Disco_4721)) in
                                                                        {7234}in(c, (=pkCli_5698,em1_5727: bitstring));
                                                                        {7235}let m1_5728: bitstring = em1_5727 in
                                                                        {7236}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_5698,Nc_5729: bitstring) = m1_5728 in
                                                                        {7237}new Ns_5730: bitstring;
                                                                        {7238}new ST_5731: bitstring;
                                                                        {7239}new TTL_5732: bitstring;
                                                                        {7240}let m2_5733: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_5730,ST_5731,TTL_5732) in
                                                                        {7241}event beginSrv(Sess_4722,Cli_4720,Ns_5730);
                                                                        {7242}out(c, m2_5733);
                                                                        {7243}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                                                        {7244}event endSrv(Cli_4720,Sess_4722,Nc_5729)
                                                                )
                                                                else
                                                                    {7245}let pkDisco_5734: bitstring = fail-any in
                                                                    {7246}in(c, (=pkCli_5698,em1_5735: bitstring));
                                                                    {7247}let m1_5736: bitstring = em1_5735 in
                                                                    {7248}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_5698,Nc_5737: bitstring) = m1_5736 in
                                                                    {7249}new Ns_5738: bitstring;
                                                                    {7250}new ST_5739: bitstring;
                                                                    {7251}new TTL_5740: bitstring;
                                                                    {7252}let m2_5741: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_5738,ST_5739,TTL_5740) in
                                                                    {7253}event beginSrv(Sess_4722,Cli_4720,Ns_5738);
                                                                    {7254}out(c, m2_5741);
                                                                    {7255}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                                                    {7256}event endSrv(Cli_4720,Sess_4722,Nc_5737)
                                                        )
                                                        else
                                                            {7257}let pkDisco_5742: bitstring = fail-any in
                                                            {7258}in(c, (=pkCli_5698,em1_5743: bitstring));
                                                            {7259}let m1_5744: bitstring = em1_5743 in
                                                            {7260}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_5698,Nc_5745: bitstring) = m1_5744 in
                                                            {7261}new Ns_5746: bitstring;
                                                            {7262}new ST_5747: bitstring;
                                                            {7263}new TTL_5748: bitstring;
                                                            {7264}let m2_5749: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_5746,ST_5747,TTL_5748) in
                                                            {7265}event beginSrv(Sess_4722,Cli_4720,Ns_5746);
                                                            {7266}out(c, m2_5749);
                                                            {7267}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                                            {7268}event endSrv(Cli_4720,Sess_4722,Nc_5745)
                                                )
                                                else
                                                    {7269}let pkDisco_5750: bitstring = fail-any in
                                                    {7270}in(c, (=pkCli_5698,em1_5751: bitstring));
                                                    {7271}let m1_5752: bitstring = em1_5751 in
                                                    {7272}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_5698,Nc_5753: bitstring) = m1_5752 in
                                                    {7273}new Ns_5754: bitstring;
                                                    {7274}new ST_5755: bitstring;
                                                    {7275}new TTL_5756: bitstring;
                                                    {7276}let m2_5757: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_5754,ST_5755,TTL_5756) in
                                                    {7277}event beginSrv(Sess_4722,Cli_4720,Ns_5754);
                                                    {7278}out(c, m2_5757);
                                                    {7279}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                                    {7280}event endSrv(Cli_4720,Sess_4722,Nc_5753)
                                            )
                                            else
                                                {7281}let pkCli_5758: bitstring = pub(sk(Cli_4720)) in
                                                {7282}let v_5759: bool = (Disco_4721 = A) in
                                                (
                                                    {7283}if v_5759 then
                                                    (
                                                        {7284}let pkDisco_5760: bitstring = pub(skA) in
                                                        {7285}in(c, (=pkCli_5758,em1_5761: bitstring));
                                                        {7286}let m1_5762: bitstring = em1_5761 in
                                                        {7287}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_5758,Nc_5763: bitstring) = m1_5762 in
                                                        {7288}new Ns_5764: bitstring;
                                                        {7289}new ST_5765: bitstring;
                                                        {7290}new TTL_5766: bitstring;
                                                        {7291}let m2_5767: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_5764,ST_5765,TTL_5766) in
                                                        {7292}event beginSrv(Sess_4722,Cli_4720,Ns_5764);
                                                        {7293}out(c, m2_5767);
                                                        {7294}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                                        {7295}event endSrv(Cli_4720,Sess_4722,Nc_5763)
                                                    )
                                                    else
                                                        {7296}let v_5768: bool = (Disco_4721 = B) in
                                                        (
                                                            {7297}if v_5768 then
                                                            (
                                                                {7298}let pkDisco_5769: bitstring = pub(skB) in
                                                                {7299}in(c, (=pkCli_5758,em1_5770: bitstring));
                                                                {7300}let m1_5771: bitstring = em1_5770 in
                                                                {7301}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_5758,Nc_5772: bitstring) = m1_5771 in
                                                                {7302}new Ns_5773: bitstring;
                                                                {7303}new ST_5774: bitstring;
                                                                {7304}new TTL_5775: bitstring;
                                                                {7305}let m2_5776: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_5773,ST_5774,TTL_5775) in
                                                                {7306}event beginSrv(Sess_4722,Cli_4720,Ns_5773);
                                                                {7307}out(c, m2_5776);
                                                                {7308}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                                                {7309}event endSrv(Cli_4720,Sess_4722,Nc_5772)
                                                            )
                                                            else
                                                                {7310}let v_5777: bool = (Disco_4721 = C) in
                                                                (
                                                                    {7311}if v_5777 then
                                                                    (
                                                                        {7312}let pkDisco_5778: bitstring = pub(skC) in
                                                                        {7313}in(c, (=pkCli_5758,em1_5779: bitstring));
                                                                        {7314}let m1_5780: bitstring = em1_5779 in
                                                                        {7315}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_5758,Nc_5781: bitstring) = m1_5780 in
                                                                        {7316}new Ns_5782: bitstring;
                                                                        {7317}new ST_5783: bitstring;
                                                                        {7318}new TTL_5784: bitstring;
                                                                        {7319}let m2_5785: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_5782,ST_5783,TTL_5784) in
                                                                        {7320}event beginSrv(Sess_4722,Cli_4720,Ns_5782);
                                                                        {7321}out(c, m2_5785);
                                                                        {7322}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                                                        {7323}event endSrv(Cli_4720,Sess_4722,Nc_5781)
                                                                    )
                                                                    else
                                                                        {7324}let pkDisco_5786: bitstring = pub(sk(Disco_4721)) in
                                                                        {7325}in(c, (=pkCli_5758,em1_5787: bitstring));
                                                                        {7326}let m1_5788: bitstring = em1_5787 in
                                                                        {7327}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_5758,Nc_5789: bitstring) = m1_5788 in
                                                                        {7328}new Ns_5790: bitstring;
                                                                        {7329}new ST_5791: bitstring;
                                                                        {7330}new TTL_5792: bitstring;
                                                                        {7331}let m2_5793: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_5790,ST_5791,TTL_5792) in
                                                                        {7332}event beginSrv(Sess_4722,Cli_4720,Ns_5790);
                                                                        {7333}out(c, m2_5793);
                                                                        {7334}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                                                        {7335}event endSrv(Cli_4720,Sess_4722,Nc_5789)
                                                                )
                                                                else
                                                                    {7336}let pkDisco_5794: bitstring = fail-any in
                                                                    {7337}in(c, (=pkCli_5758,em1_5795: bitstring));
                                                                    {7338}let m1_5796: bitstring = em1_5795 in
                                                                    {7339}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_5758,Nc_5797: bitstring) = m1_5796 in
                                                                    {7340}new Ns_5798: bitstring;
                                                                    {7341}new ST_5799: bitstring;
                                                                    {7342}new TTL_5800: bitstring;
                                                                    {7343}let m2_5801: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_5798,ST_5799,TTL_5800) in
                                                                    {7344}event beginSrv(Sess_4722,Cli_4720,Ns_5798);
                                                                    {7345}out(c, m2_5801);
                                                                    {7346}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                                                    {7347}event endSrv(Cli_4720,Sess_4722,Nc_5797)
                                                        )
                                                        else
                                                            {7348}let pkDisco_5802: bitstring = fail-any in
                                                            {7349}in(c, (=pkCli_5758,em1_5803: bitstring));
                                                            {7350}let m1_5804: bitstring = em1_5803 in
                                                            {7351}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_5758,Nc_5805: bitstring) = m1_5804 in
                                                            {7352}new Ns_5806: bitstring;
                                                            {7353}new ST_5807: bitstring;
                                                            {7354}new TTL_5808: bitstring;
                                                            {7355}let m2_5809: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_5806,ST_5807,TTL_5808) in
                                                            {7356}event beginSrv(Sess_4722,Cli_4720,Ns_5806);
                                                            {7357}out(c, m2_5809);
                                                            {7358}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                                            {7359}event endSrv(Cli_4720,Sess_4722,Nc_5805)
                                                )
                                                else
                                                    {7360}let pkDisco_5810: bitstring = fail-any in
                                                    {7361}in(c, (=pkCli_5758,em1_5811: bitstring));
                                                    {7362}let m1_5812: bitstring = em1_5811 in
                                                    {7363}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_5758,Nc_5813: bitstring) = m1_5812 in
                                                    {7364}new Ns_5814: bitstring;
                                                    {7365}new ST_5815: bitstring;
                                                    {7366}new TTL_5816: bitstring;
                                                    {7367}let m2_5817: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_5814,ST_5815,TTL_5816) in
                                                    {7368}event beginSrv(Sess_4722,Cli_4720,Ns_5814);
                                                    {7369}out(c, m2_5817);
                                                    {7370}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                                    {7371}event endSrv(Cli_4720,Sess_4722,Nc_5813)
                                        )
                                        else
                                            {7372}let pkCli_5818: bitstring = fail-any in
                                            {7373}let v_5819: bool = (Disco_4721 = A) in
                                            (
                                                {7374}if v_5819 then
                                                (
                                                    {7375}let pkDisco_5820: bitstring = pub(skA) in
                                                    {7376}in(c, (=pkCli_5818,em1_5821: bitstring));
                                                    {7377}let m1_5822: bitstring = em1_5821 in
                                                    {7378}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_5818,Nc_5823: bitstring) = m1_5822 in
                                                    {7379}new Ns_5824: bitstring;
                                                    {7380}new ST_5825: bitstring;
                                                    {7381}new TTL_5826: bitstring;
                                                    {7382}let m2_5827: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_5824,ST_5825,TTL_5826) in
                                                    {7383}event beginSrv(Sess_4722,Cli_4720,Ns_5824);
                                                    {7384}out(c, m2_5827);
                                                    {7385}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                                    {7386}event endSrv(Cli_4720,Sess_4722,Nc_5823)
                                                )
                                                else
                                                    {7387}let v_5828: bool = (Disco_4721 = B) in
                                                    (
                                                        {7388}if v_5828 then
                                                        (
                                                            {7389}let pkDisco_5829: bitstring = pub(skB) in
                                                            {7390}in(c, (=pkCli_5818,em1_5830: bitstring));
                                                            {7391}let m1_5831: bitstring = em1_5830 in
                                                            {7392}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_5818,Nc_5832: bitstring) = m1_5831 in
                                                            {7393}new Ns_5833: bitstring;
                                                            {7394}new ST_5834: bitstring;
                                                            {7395}new TTL_5835: bitstring;
                                                            {7396}let m2_5836: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_5833,ST_5834,TTL_5835) in
                                                            {7397}event beginSrv(Sess_4722,Cli_4720,Ns_5833);
                                                            {7398}out(c, m2_5836);
                                                            {7399}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                                            {7400}event endSrv(Cli_4720,Sess_4722,Nc_5832)
                                                        )
                                                        else
                                                            {7401}let v_5837: bool = (Disco_4721 = C) in
                                                            (
                                                                {7402}if v_5837 then
                                                                (
                                                                    {7403}let pkDisco_5838: bitstring = pub(skC) in
                                                                    {7404}in(c, (=pkCli_5818,em1_5839: bitstring));
                                                                    {7405}let m1_5840: bitstring = em1_5839 in
                                                                    {7406}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_5818,Nc_5841: bitstring) = m1_5840 in
                                                                    {7407}new Ns_5842: bitstring;
                                                                    {7408}new ST_5843: bitstring;
                                                                    {7409}new TTL_5844: bitstring;
                                                                    {7410}let m2_5845: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_5842,ST_5843,TTL_5844) in
                                                                    {7411}event beginSrv(Sess_4722,Cli_4720,Ns_5842);
                                                                    {7412}out(c, m2_5845);
                                                                    {7413}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                                                    {7414}event endSrv(Cli_4720,Sess_4722,Nc_5841)
                                                                )
                                                                else
                                                                    {7415}let pkDisco_5846: bitstring = pub(sk(Disco_4721)) in
                                                                    {7416}in(c, (=pkCli_5818,em1_5847: bitstring));
                                                                    {7417}let m1_5848: bitstring = em1_5847 in
                                                                    {7418}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_5818,Nc_5849: bitstring) = m1_5848 in
                                                                    {7419}new Ns_5850: bitstring;
                                                                    {7420}new ST_5851: bitstring;
                                                                    {7421}new TTL_5852: bitstring;
                                                                    {7422}let m2_5853: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_5850,ST_5851,TTL_5852) in
                                                                    {7423}event beginSrv(Sess_4722,Cli_4720,Ns_5850);
                                                                    {7424}out(c, m2_5853);
                                                                    {7425}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                                                    {7426}event endSrv(Cli_4720,Sess_4722,Nc_5849)
                                                            )
                                                            else
                                                                {7427}let pkDisco_5854: bitstring = fail-any in
                                                                {7428}in(c, (=pkCli_5818,em1_5855: bitstring));
                                                                {7429}let m1_5856: bitstring = em1_5855 in
                                                                {7430}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_5818,Nc_5857: bitstring) = m1_5856 in
                                                                {7431}new Ns_5858: bitstring;
                                                                {7432}new ST_5859: bitstring;
                                                                {7433}new TTL_5860: bitstring;
                                                                {7434}let m2_5861: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_5858,ST_5859,TTL_5860) in
                                                                {7435}event beginSrv(Sess_4722,Cli_4720,Ns_5858);
                                                                {7436}out(c, m2_5861);
                                                                {7437}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                                                {7438}event endSrv(Cli_4720,Sess_4722,Nc_5857)
                                                    )
                                                    else
                                                        {7439}let pkDisco_5862: bitstring = fail-any in
                                                        {7440}in(c, (=pkCli_5818,em1_5863: bitstring));
                                                        {7441}let m1_5864: bitstring = em1_5863 in
                                                        {7442}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_5818,Nc_5865: bitstring) = m1_5864 in
                                                        {7443}new Ns_5866: bitstring;
                                                        {7444}new ST_5867: bitstring;
                                                        {7445}new TTL_5868: bitstring;
                                                        {7446}let m2_5869: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_5866,ST_5867,TTL_5868) in
                                                        {7447}event beginSrv(Sess_4722,Cli_4720,Ns_5866);
                                                        {7448}out(c, m2_5869);
                                                        {7449}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                                        {7450}event endSrv(Cli_4720,Sess_4722,Nc_5865)
                                            )
                                            else
                                                {7451}let pkDisco_5870: bitstring = fail-any in
                                                {7452}in(c, (=pkCli_5818,em1_5871: bitstring));
                                                {7453}let m1_5872: bitstring = em1_5871 in
                                                {7454}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_5818,Nc_5873: bitstring) = m1_5872 in
                                                {7455}new Ns_5874: bitstring;
                                                {7456}new ST_5875: bitstring;
                                                {7457}new TTL_5876: bitstring;
                                                {7458}let m2_5877: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_5874,ST_5875,TTL_5876) in
                                                {7459}event beginSrv(Sess_4722,Cli_4720,Ns_5874);
                                                {7460}out(c, m2_5877);
                                                {7461}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                                {7462}event endSrv(Cli_4720,Sess_4722,Nc_5873)
                                )
                                else
                                    {7463}let pkCli_5878: bitstring = fail-any in
                                    {7464}let v_5879: bool = (Disco_4721 = A) in
                                    (
                                        {7465}if v_5879 then
                                        (
                                            {7466}let pkDisco_5880: bitstring = pub(skA) in
                                            {7467}in(c, (=pkCli_5878,em1_5881: bitstring));
                                            {7468}let m1_5882: bitstring = em1_5881 in
                                            {7469}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_5878,Nc_5883: bitstring) = m1_5882 in
                                            {7470}new Ns_5884: bitstring;
                                            {7471}new ST_5885: bitstring;
                                            {7472}new TTL_5886: bitstring;
                                            {7473}let m2_5887: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_5884,ST_5885,TTL_5886) in
                                            {7474}event beginSrv(Sess_4722,Cli_4720,Ns_5884);
                                            {7475}out(c, m2_5887);
                                            {7476}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                            {7477}event endSrv(Cli_4720,Sess_4722,Nc_5883)
                                        )
                                        else
                                            {7478}let v_5888: bool = (Disco_4721 = B) in
                                            (
                                                {7479}if v_5888 then
                                                (
                                                    {7480}let pkDisco_5889: bitstring = pub(skB) in
                                                    {7481}in(c, (=pkCli_5878,em1_5890: bitstring));
                                                    {7482}let m1_5891: bitstring = em1_5890 in
                                                    {7483}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_5878,Nc_5892: bitstring) = m1_5891 in
                                                    {7484}new Ns_5893: bitstring;
                                                    {7485}new ST_5894: bitstring;
                                                    {7486}new TTL_5895: bitstring;
                                                    {7487}let m2_5896: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_5893,ST_5894,TTL_5895) in
                                                    {7488}event beginSrv(Sess_4722,Cli_4720,Ns_5893);
                                                    {7489}out(c, m2_5896);
                                                    {7490}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                                    {7491}event endSrv(Cli_4720,Sess_4722,Nc_5892)
                                                )
                                                else
                                                    {7492}let v_5897: bool = (Disco_4721 = C) in
                                                    (
                                                        {7493}if v_5897 then
                                                        (
                                                            {7494}let pkDisco_5898: bitstring = pub(skC) in
                                                            {7495}in(c, (=pkCli_5878,em1_5899: bitstring));
                                                            {7496}let m1_5900: bitstring = em1_5899 in
                                                            {7497}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_5878,Nc_5901: bitstring) = m1_5900 in
                                                            {7498}new Ns_5902: bitstring;
                                                            {7499}new ST_5903: bitstring;
                                                            {7500}new TTL_5904: bitstring;
                                                            {7501}let m2_5905: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_5902,ST_5903,TTL_5904) in
                                                            {7502}event beginSrv(Sess_4722,Cli_4720,Ns_5902);
                                                            {7503}out(c, m2_5905);
                                                            {7504}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                                            {7505}event endSrv(Cli_4720,Sess_4722,Nc_5901)
                                                        )
                                                        else
                                                            {7506}let pkDisco_5906: bitstring = pub(sk(Disco_4721)) in
                                                            {7507}in(c, (=pkCli_5878,em1_5907: bitstring));
                                                            {7508}let m1_5908: bitstring = em1_5907 in
                                                            {7509}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_5878,Nc_5909: bitstring) = m1_5908 in
                                                            {7510}new Ns_5910: bitstring;
                                                            {7511}new ST_5911: bitstring;
                                                            {7512}new TTL_5912: bitstring;
                                                            {7513}let m2_5913: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_5910,ST_5911,TTL_5912) in
                                                            {7514}event beginSrv(Sess_4722,Cli_4720,Ns_5910);
                                                            {7515}out(c, m2_5913);
                                                            {7516}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                                            {7517}event endSrv(Cli_4720,Sess_4722,Nc_5909)
                                                    )
                                                    else
                                                        {7518}let pkDisco_5914: bitstring = fail-any in
                                                        {7519}in(c, (=pkCli_5878,em1_5915: bitstring));
                                                        {7520}let m1_5916: bitstring = em1_5915 in
                                                        {7521}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_5878,Nc_5917: bitstring) = m1_5916 in
                                                        {7522}new Ns_5918: bitstring;
                                                        {7523}new ST_5919: bitstring;
                                                        {7524}new TTL_5920: bitstring;
                                                        {7525}let m2_5921: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_5918,ST_5919,TTL_5920) in
                                                        {7526}event beginSrv(Sess_4722,Cli_4720,Ns_5918);
                                                        {7527}out(c, m2_5921);
                                                        {7528}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                                        {7529}event endSrv(Cli_4720,Sess_4722,Nc_5917)
                                            )
                                            else
                                                {7530}let pkDisco_5922: bitstring = fail-any in
                                                {7531}in(c, (=pkCli_5878,em1_5923: bitstring));
                                                {7532}let m1_5924: bitstring = em1_5923 in
                                                {7533}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_5878,Nc_5925: bitstring) = m1_5924 in
                                                {7534}new Ns_5926: bitstring;
                                                {7535}new ST_5927: bitstring;
                                                {7536}new TTL_5928: bitstring;
                                                {7537}let m2_5929: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_5926,ST_5927,TTL_5928) in
                                                {7538}event beginSrv(Sess_4722,Cli_4720,Ns_5926);
                                                {7539}out(c, m2_5929);
                                                {7540}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                                {7541}event endSrv(Cli_4720,Sess_4722,Nc_5925)
                                    )
                                    else
                                        {7542}let pkDisco_5930: bitstring = fail-any in
                                        {7543}in(c, (=pkCli_5878,em1_5931: bitstring));
                                        {7544}let m1_5932: bitstring = em1_5931 in
                                        {7545}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_5878,Nc_5933: bitstring) = m1_5932 in
                                        {7546}new Ns_5934: bitstring;
                                        {7547}new ST_5935: bitstring;
                                        {7548}new TTL_5936: bitstring;
                                        {7549}let m2_5937: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_5934,ST_5935,TTL_5936) in
                                        {7550}event beginSrv(Sess_4722,Cli_4720,Ns_5934);
                                        {7551}out(c, m2_5937);
                                        {7552}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                        {7553}event endSrv(Cli_4720,Sess_4722,Nc_5933)
                        )
                        else
                            {7554}let pkCli_5938: bitstring = fail-any in
                            {7555}let v_5939: bool = (Disco_4721 = A) in
                            (
                                {7556}if v_5939 then
                                (
                                    {7557}let pkDisco_5940: bitstring = pub(skA) in
                                    {7558}in(c, (=pkCli_5938,em1_5941: bitstring));
                                    {7559}let m1_5942: bitstring = em1_5941 in
                                    {7560}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_5938,Nc_5943: bitstring) = m1_5942 in
                                    {7561}new Ns_5944: bitstring;
                                    {7562}new ST_5945: bitstring;
                                    {7563}new TTL_5946: bitstring;
                                    {7564}let m2_5947: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_5944,ST_5945,TTL_5946) in
                                    {7565}event beginSrv(Sess_4722,Cli_4720,Ns_5944);
                                    {7566}out(c, m2_5947);
                                    {7567}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                    {7568}event endSrv(Cli_4720,Sess_4722,Nc_5943)
                                )
                                else
                                    {7569}let v_5948: bool = (Disco_4721 = B) in
                                    (
                                        {7570}if v_5948 then
                                        (
                                            {7571}let pkDisco_5949: bitstring = pub(skB) in
                                            {7572}in(c, (=pkCli_5938,em1_5950: bitstring));
                                            {7573}let m1_5951: bitstring = em1_5950 in
                                            {7574}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_5938,Nc_5952: bitstring) = m1_5951 in
                                            {7575}new Ns_5953: bitstring;
                                            {7576}new ST_5954: bitstring;
                                            {7577}new TTL_5955: bitstring;
                                            {7578}let m2_5956: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_5953,ST_5954,TTL_5955) in
                                            {7579}event beginSrv(Sess_4722,Cli_4720,Ns_5953);
                                            {7580}out(c, m2_5956);
                                            {7581}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                            {7582}event endSrv(Cli_4720,Sess_4722,Nc_5952)
                                        )
                                        else
                                            {7583}let v_5957: bool = (Disco_4721 = C) in
                                            (
                                                {7584}if v_5957 then
                                                (
                                                    {7585}let pkDisco_5958: bitstring = pub(skC) in
                                                    {7586}in(c, (=pkCli_5938,em1_5959: bitstring));
                                                    {7587}let m1_5960: bitstring = em1_5959 in
                                                    {7588}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_5938,Nc_5961: bitstring) = m1_5960 in
                                                    {7589}new Ns_5962: bitstring;
                                                    {7590}new ST_5963: bitstring;
                                                    {7591}new TTL_5964: bitstring;
                                                    {7592}let m2_5965: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_5962,ST_5963,TTL_5964) in
                                                    {7593}event beginSrv(Sess_4722,Cli_4720,Ns_5962);
                                                    {7594}out(c, m2_5965);
                                                    {7595}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                                    {7596}event endSrv(Cli_4720,Sess_4722,Nc_5961)
                                                )
                                                else
                                                    {7597}let pkDisco_5966: bitstring = pub(sk(Disco_4721)) in
                                                    {7598}in(c, (=pkCli_5938,em1_5967: bitstring));
                                                    {7599}let m1_5968: bitstring = em1_5967 in
                                                    {7600}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_5938,Nc_5969: bitstring) = m1_5968 in
                                                    {7601}new Ns_5970: bitstring;
                                                    {7602}new ST_5971: bitstring;
                                                    {7603}new TTL_5972: bitstring;
                                                    {7604}let m2_5973: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_5970,ST_5971,TTL_5972) in
                                                    {7605}event beginSrv(Sess_4722,Cli_4720,Ns_5970);
                                                    {7606}out(c, m2_5973);
                                                    {7607}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                                    {7608}event endSrv(Cli_4720,Sess_4722,Nc_5969)
                                            )
                                            else
                                                {7609}let pkDisco_5974: bitstring = fail-any in
                                                {7610}in(c, (=pkCli_5938,em1_5975: bitstring));
                                                {7611}let m1_5976: bitstring = em1_5975 in
                                                {7612}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_5938,Nc_5977: bitstring) = m1_5976 in
                                                {7613}new Ns_5978: bitstring;
                                                {7614}new ST_5979: bitstring;
                                                {7615}new TTL_5980: bitstring;
                                                {7616}let m2_5981: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_5978,ST_5979,TTL_5980) in
                                                {7617}event beginSrv(Sess_4722,Cli_4720,Ns_5978);
                                                {7618}out(c, m2_5981);
                                                {7619}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                                {7620}event endSrv(Cli_4720,Sess_4722,Nc_5977)
                                    )
                                    else
                                        {7621}let pkDisco_5982: bitstring = fail-any in
                                        {7622}in(c, (=pkCli_5938,em1_5983: bitstring));
                                        {7623}let m1_5984: bitstring = em1_5983 in
                                        {7624}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_5938,Nc_5985: bitstring) = m1_5984 in
                                        {7625}new Ns_5986: bitstring;
                                        {7626}new ST_5987: bitstring;
                                        {7627}new TTL_5988: bitstring;
                                        {7628}let m2_5989: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_5986,ST_5987,TTL_5988) in
                                        {7629}event beginSrv(Sess_4722,Cli_4720,Ns_5986);
                                        {7630}out(c, m2_5989);
                                        {7631}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                        {7632}event endSrv(Cli_4720,Sess_4722,Nc_5985)
                            )
                            else
                                {7633}let pkDisco_5990: bitstring = fail-any in
                                {7634}in(c, (=pkCli_5938,em1_5991: bitstring));
                                {7635}let m1_5992: bitstring = em1_5991 in
                                {7636}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_5938,Nc_5993: bitstring) = m1_5992 in
                                {7637}new Ns_5994: bitstring;
                                {7638}new ST_5995: bitstring;
                                {7639}new TTL_5996: bitstring;
                                {7640}let m2_5997: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_5994,ST_5995,TTL_5996) in
                                {7641}event beginSrv(Sess_4722,Cli_4720,Ns_5994);
                                {7642}out(c, m2_5997);
                                {7643}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                {7644}event endSrv(Cli_4720,Sess_4722,Nc_5993)
                    )
                    else
                        {7645}let skSess_5998: bitstring = fail-any in
                        {7646}let pkSess_5999: bitstring = pub(skSess_5998) in
                        {7647}let v_6000: bool = (Cli_4720 = A) in
                        (
                            {7648}if v_6000 then
                            (
                                {7649}let pkCli_6001: bitstring = pub(skA) in
                                {7650}let v_6002: bool = (Disco_4721 = A) in
                                (
                                    {7651}if v_6002 then
                                    (
                                        {7652}let pkDisco_6003: bitstring = pub(skA) in
                                        {7653}in(c, (=pkCli_6001,em1_6004: bitstring));
                                        {7654}let m1_6005: bitstring = em1_6004 in
                                        {7655}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_6001,Nc_6006: bitstring) = m1_6005 in
                                        {7656}new Ns_6007: bitstring;
                                        {7657}new ST_6008: bitstring;
                                        {7658}new TTL_6009: bitstring;
                                        {7659}let m2_6010: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_6007,ST_6008,TTL_6009) in
                                        {7660}event beginSrv(Sess_4722,Cli_4720,Ns_6007);
                                        {7661}out(c, m2_6010);
                                        {7662}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                        {7663}event endSrv(Cli_4720,Sess_4722,Nc_6006)
                                    )
                                    else
                                        {7664}let v_6011: bool = (Disco_4721 = B) in
                                        (
                                            {7665}if v_6011 then
                                            (
                                                {7666}let pkDisco_6012: bitstring = pub(skB) in
                                                {7667}in(c, (=pkCli_6001,em1_6013: bitstring));
                                                {7668}let m1_6014: bitstring = em1_6013 in
                                                {7669}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_6001,Nc_6015: bitstring) = m1_6014 in
                                                {7670}new Ns_6016: bitstring;
                                                {7671}new ST_6017: bitstring;
                                                {7672}new TTL_6018: bitstring;
                                                {7673}let m2_6019: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_6016,ST_6017,TTL_6018) in
                                                {7674}event beginSrv(Sess_4722,Cli_4720,Ns_6016);
                                                {7675}out(c, m2_6019);
                                                {7676}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                                {7677}event endSrv(Cli_4720,Sess_4722,Nc_6015)
                                            )
                                            else
                                                {7678}let v_6020: bool = (Disco_4721 = C) in
                                                (
                                                    {7679}if v_6020 then
                                                    (
                                                        {7680}let pkDisco_6021: bitstring = pub(skC) in
                                                        {7681}in(c, (=pkCli_6001,em1_6022: bitstring));
                                                        {7682}let m1_6023: bitstring = em1_6022 in
                                                        {7683}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_6001,Nc_6024: bitstring) = m1_6023 in
                                                        {7684}new Ns_6025: bitstring;
                                                        {7685}new ST_6026: bitstring;
                                                        {7686}new TTL_6027: bitstring;
                                                        {7687}let m2_6028: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_6025,ST_6026,TTL_6027) in
                                                        {7688}event beginSrv(Sess_4722,Cli_4720,Ns_6025);
                                                        {7689}out(c, m2_6028);
                                                        {7690}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                                        {7691}event endSrv(Cli_4720,Sess_4722,Nc_6024)
                                                    )
                                                    else
                                                        {7692}let pkDisco_6029: bitstring = pub(sk(Disco_4721)) in
                                                        {7693}in(c, (=pkCli_6001,em1_6030: bitstring));
                                                        {7694}let m1_6031: bitstring = em1_6030 in
                                                        {7695}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_6001,Nc_6032: bitstring) = m1_6031 in
                                                        {7696}new Ns_6033: bitstring;
                                                        {7697}new ST_6034: bitstring;
                                                        {7698}new TTL_6035: bitstring;
                                                        {7699}let m2_6036: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_6033,ST_6034,TTL_6035) in
                                                        {7700}event beginSrv(Sess_4722,Cli_4720,Ns_6033);
                                                        {7701}out(c, m2_6036);
                                                        {7702}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                                        {7703}event endSrv(Cli_4720,Sess_4722,Nc_6032)
                                                )
                                                else
                                                    {7704}let pkDisco_6037: bitstring = fail-any in
                                                    {7705}in(c, (=pkCli_6001,em1_6038: bitstring));
                                                    {7706}let m1_6039: bitstring = em1_6038 in
                                                    {7707}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_6001,Nc_6040: bitstring) = m1_6039 in
                                                    {7708}new Ns_6041: bitstring;
                                                    {7709}new ST_6042: bitstring;
                                                    {7710}new TTL_6043: bitstring;
                                                    {7711}let m2_6044: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_6041,ST_6042,TTL_6043) in
                                                    {7712}event beginSrv(Sess_4722,Cli_4720,Ns_6041);
                                                    {7713}out(c, m2_6044);
                                                    {7714}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                                    {7715}event endSrv(Cli_4720,Sess_4722,Nc_6040)
                                        )
                                        else
                                            {7716}let pkDisco_6045: bitstring = fail-any in
                                            {7717}in(c, (=pkCli_6001,em1_6046: bitstring));
                                            {7718}let m1_6047: bitstring = em1_6046 in
                                            {7719}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_6001,Nc_6048: bitstring) = m1_6047 in
                                            {7720}new Ns_6049: bitstring;
                                            {7721}new ST_6050: bitstring;
                                            {7722}new TTL_6051: bitstring;
                                            {7723}let m2_6052: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_6049,ST_6050,TTL_6051) in
                                            {7724}event beginSrv(Sess_4722,Cli_4720,Ns_6049);
                                            {7725}out(c, m2_6052);
                                            {7726}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                            {7727}event endSrv(Cli_4720,Sess_4722,Nc_6048)
                                )
                                else
                                    {7728}let pkDisco_6053: bitstring = fail-any in
                                    {7729}in(c, (=pkCli_6001,em1_6054: bitstring));
                                    {7730}let m1_6055: bitstring = em1_6054 in
                                    {7731}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_6001,Nc_6056: bitstring) = m1_6055 in
                                    {7732}new Ns_6057: bitstring;
                                    {7733}new ST_6058: bitstring;
                                    {7734}new TTL_6059: bitstring;
                                    {7735}let m2_6060: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_6057,ST_6058,TTL_6059) in
                                    {7736}event beginSrv(Sess_4722,Cli_4720,Ns_6057);
                                    {7737}out(c, m2_6060);
                                    {7738}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                    {7739}event endSrv(Cli_4720,Sess_4722,Nc_6056)
                            )
                            else
                                {7740}let v_6061: bool = (Cli_4720 = B) in
                                (
                                    {7741}if v_6061 then
                                    (
                                        {7742}let pkCli_6062: bitstring = pub(skB) in
                                        {7743}let v_6063: bool = (Disco_4721 = A) in
                                        (
                                            {7744}if v_6063 then
                                            (
                                                {7745}let pkDisco_6064: bitstring = pub(skA) in
                                                {7746}in(c, (=pkCli_6062,em1_6065: bitstring));
                                                {7747}let m1_6066: bitstring = em1_6065 in
                                                {7748}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_6062,Nc_6067: bitstring) = m1_6066 in
                                                {7749}new Ns_6068: bitstring;
                                                {7750}new ST_6069: bitstring;
                                                {7751}new TTL_6070: bitstring;
                                                {7752}let m2_6071: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_6068,ST_6069,TTL_6070) in
                                                {7753}event beginSrv(Sess_4722,Cli_4720,Ns_6068);
                                                {7754}out(c, m2_6071);
                                                {7755}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                                {7756}event endSrv(Cli_4720,Sess_4722,Nc_6067)
                                            )
                                            else
                                                {7757}let v_6072: bool = (Disco_4721 = B) in
                                                (
                                                    {7758}if v_6072 then
                                                    (
                                                        {7759}let pkDisco_6073: bitstring = pub(skB) in
                                                        {7760}in(c, (=pkCli_6062,em1_6074: bitstring));
                                                        {7761}let m1_6075: bitstring = em1_6074 in
                                                        {7762}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_6062,Nc_6076: bitstring) = m1_6075 in
                                                        {7763}new Ns_6077: bitstring;
                                                        {7764}new ST_6078: bitstring;
                                                        {7765}new TTL_6079: bitstring;
                                                        {7766}let m2_6080: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_6077,ST_6078,TTL_6079) in
                                                        {7767}event beginSrv(Sess_4722,Cli_4720,Ns_6077);
                                                        {7768}out(c, m2_6080);
                                                        {7769}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                                        {7770}event endSrv(Cli_4720,Sess_4722,Nc_6076)
                                                    )
                                                    else
                                                        {7771}let v_6081: bool = (Disco_4721 = C) in
                                                        (
                                                            {7772}if v_6081 then
                                                            (
                                                                {7773}let pkDisco_6082: bitstring = pub(skC) in
                                                                {7774}in(c, (=pkCli_6062,em1_6083: bitstring));
                                                                {7775}let m1_6084: bitstring = em1_6083 in
                                                                {7776}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_6062,Nc_6085: bitstring) = m1_6084 in
                                                                {7777}new Ns_6086: bitstring;
                                                                {7778}new ST_6087: bitstring;
                                                                {7779}new TTL_6088: bitstring;
                                                                {7780}let m2_6089: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_6086,ST_6087,TTL_6088) in
                                                                {7781}event beginSrv(Sess_4722,Cli_4720,Ns_6086);
                                                                {7782}out(c, m2_6089);
                                                                {7783}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                                                {7784}event endSrv(Cli_4720,Sess_4722,Nc_6085)
                                                            )
                                                            else
                                                                {7785}let pkDisco_6090: bitstring = pub(sk(Disco_4721)) in
                                                                {7786}in(c, (=pkCli_6062,em1_6091: bitstring));
                                                                {7787}let m1_6092: bitstring = em1_6091 in
                                                                {7788}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_6062,Nc_6093: bitstring) = m1_6092 in
                                                                {7789}new Ns_6094: bitstring;
                                                                {7790}new ST_6095: bitstring;
                                                                {7791}new TTL_6096: bitstring;
                                                                {7792}let m2_6097: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_6094,ST_6095,TTL_6096) in
                                                                {7793}event beginSrv(Sess_4722,Cli_4720,Ns_6094);
                                                                {7794}out(c, m2_6097);
                                                                {7795}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                                                {7796}event endSrv(Cli_4720,Sess_4722,Nc_6093)
                                                        )
                                                        else
                                                            {7797}let pkDisco_6098: bitstring = fail-any in
                                                            {7798}in(c, (=pkCli_6062,em1_6099: bitstring));
                                                            {7799}let m1_6100: bitstring = em1_6099 in
                                                            {7800}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_6062,Nc_6101: bitstring) = m1_6100 in
                                                            {7801}new Ns_6102: bitstring;
                                                            {7802}new ST_6103: bitstring;
                                                            {7803}new TTL_6104: bitstring;
                                                            {7804}let m2_6105: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_6102,ST_6103,TTL_6104) in
                                                            {7805}event beginSrv(Sess_4722,Cli_4720,Ns_6102);
                                                            {7806}out(c, m2_6105);
                                                            {7807}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                                            {7808}event endSrv(Cli_4720,Sess_4722,Nc_6101)
                                                )
                                                else
                                                    {7809}let pkDisco_6106: bitstring = fail-any in
                                                    {7810}in(c, (=pkCli_6062,em1_6107: bitstring));
                                                    {7811}let m1_6108: bitstring = em1_6107 in
                                                    {7812}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_6062,Nc_6109: bitstring) = m1_6108 in
                                                    {7813}new Ns_6110: bitstring;
                                                    {7814}new ST_6111: bitstring;
                                                    {7815}new TTL_6112: bitstring;
                                                    {7816}let m2_6113: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_6110,ST_6111,TTL_6112) in
                                                    {7817}event beginSrv(Sess_4722,Cli_4720,Ns_6110);
                                                    {7818}out(c, m2_6113);
                                                    {7819}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                                    {7820}event endSrv(Cli_4720,Sess_4722,Nc_6109)
                                        )
                                        else
                                            {7821}let pkDisco_6114: bitstring = fail-any in
                                            {7822}in(c, (=pkCli_6062,em1_6115: bitstring));
                                            {7823}let m1_6116: bitstring = em1_6115 in
                                            {7824}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_6062,Nc_6117: bitstring) = m1_6116 in
                                            {7825}new Ns_6118: bitstring;
                                            {7826}new ST_6119: bitstring;
                                            {7827}new TTL_6120: bitstring;
                                            {7828}let m2_6121: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_6118,ST_6119,TTL_6120) in
                                            {7829}event beginSrv(Sess_4722,Cli_4720,Ns_6118);
                                            {7830}out(c, m2_6121);
                                            {7831}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                            {7832}event endSrv(Cli_4720,Sess_4722,Nc_6117)
                                    )
                                    else
                                        {7833}let v_6122: bool = (Cli_4720 = C) in
                                        (
                                            {7834}if v_6122 then
                                            (
                                                {7835}let pkCli_6123: bitstring = pub(skC) in
                                                {7836}let v_6124: bool = (Disco_4721 = A) in
                                                (
                                                    {7837}if v_6124 then
                                                    (
                                                        {7838}let pkDisco_6125: bitstring = pub(skA) in
                                                        {7839}in(c, (=pkCli_6123,em1_6126: bitstring));
                                                        {7840}let m1_6127: bitstring = em1_6126 in
                                                        {7841}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_6123,Nc_6128: bitstring) = m1_6127 in
                                                        {7842}new Ns_6129: bitstring;
                                                        {7843}new ST_6130: bitstring;
                                                        {7844}new TTL_6131: bitstring;
                                                        {7845}let m2_6132: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_6129,ST_6130,TTL_6131) in
                                                        {7846}event beginSrv(Sess_4722,Cli_4720,Ns_6129);
                                                        {7847}out(c, m2_6132);
                                                        {7848}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                                        {7849}event endSrv(Cli_4720,Sess_4722,Nc_6128)
                                                    )
                                                    else
                                                        {7850}let v_6133: bool = (Disco_4721 = B) in
                                                        (
                                                            {7851}if v_6133 then
                                                            (
                                                                {7852}let pkDisco_6134: bitstring = pub(skB) in
                                                                {7853}in(c, (=pkCli_6123,em1_6135: bitstring));
                                                                {7854}let m1_6136: bitstring = em1_6135 in
                                                                {7855}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_6123,Nc_6137: bitstring) = m1_6136 in
                                                                {7856}new Ns_6138: bitstring;
                                                                {7857}new ST_6139: bitstring;
                                                                {7858}new TTL_6140: bitstring;
                                                                {7859}let m2_6141: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_6138,ST_6139,TTL_6140) in
                                                                {7860}event beginSrv(Sess_4722,Cli_4720,Ns_6138);
                                                                {7861}out(c, m2_6141);
                                                                {7862}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                                                {7863}event endSrv(Cli_4720,Sess_4722,Nc_6137)
                                                            )
                                                            else
                                                                {7864}let v_6142: bool = (Disco_4721 = C) in
                                                                (
                                                                    {7865}if v_6142 then
                                                                    (
                                                                        {7866}let pkDisco_6143: bitstring = pub(skC) in
                                                                        {7867}in(c, (=pkCli_6123,em1_6144: bitstring));
                                                                        {7868}let m1_6145: bitstring = em1_6144 in
                                                                        {7869}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_6123,Nc_6146: bitstring) = m1_6145 in
                                                                        {7870}new Ns_6147: bitstring;
                                                                        {7871}new ST_6148: bitstring;
                                                                        {7872}new TTL_6149: bitstring;
                                                                        {7873}let m2_6150: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_6147,ST_6148,TTL_6149) in
                                                                        {7874}event beginSrv(Sess_4722,Cli_4720,Ns_6147);
                                                                        {7875}out(c, m2_6150);
                                                                        {7876}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                                                        {7877}event endSrv(Cli_4720,Sess_4722,Nc_6146)
                                                                    )
                                                                    else
                                                                        {7878}let pkDisco_6151: bitstring = pub(sk(Disco_4721)) in
                                                                        {7879}in(c, (=pkCli_6123,em1_6152: bitstring));
                                                                        {7880}let m1_6153: bitstring = em1_6152 in
                                                                        {7881}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_6123,Nc_6154: bitstring) = m1_6153 in
                                                                        {7882}new Ns_6155: bitstring;
                                                                        {7883}new ST_6156: bitstring;
                                                                        {7884}new TTL_6157: bitstring;
                                                                        {7885}let m2_6158: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_6155,ST_6156,TTL_6157) in
                                                                        {7886}event beginSrv(Sess_4722,Cli_4720,Ns_6155);
                                                                        {7887}out(c, m2_6158);
                                                                        {7888}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                                                        {7889}event endSrv(Cli_4720,Sess_4722,Nc_6154)
                                                                )
                                                                else
                                                                    {7890}let pkDisco_6159: bitstring = fail-any in
                                                                    {7891}in(c, (=pkCli_6123,em1_6160: bitstring));
                                                                    {7892}let m1_6161: bitstring = em1_6160 in
                                                                    {7893}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_6123,Nc_6162: bitstring) = m1_6161 in
                                                                    {7894}new Ns_6163: bitstring;
                                                                    {7895}new ST_6164: bitstring;
                                                                    {7896}new TTL_6165: bitstring;
                                                                    {7897}let m2_6166: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_6163,ST_6164,TTL_6165) in
                                                                    {7898}event beginSrv(Sess_4722,Cli_4720,Ns_6163);
                                                                    {7899}out(c, m2_6166);
                                                                    {7900}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                                                    {7901}event endSrv(Cli_4720,Sess_4722,Nc_6162)
                                                        )
                                                        else
                                                            {7902}let pkDisco_6167: bitstring = fail-any in
                                                            {7903}in(c, (=pkCli_6123,em1_6168: bitstring));
                                                            {7904}let m1_6169: bitstring = em1_6168 in
                                                            {7905}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_6123,Nc_6170: bitstring) = m1_6169 in
                                                            {7906}new Ns_6171: bitstring;
                                                            {7907}new ST_6172: bitstring;
                                                            {7908}new TTL_6173: bitstring;
                                                            {7909}let m2_6174: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_6171,ST_6172,TTL_6173) in
                                                            {7910}event beginSrv(Sess_4722,Cli_4720,Ns_6171);
                                                            {7911}out(c, m2_6174);
                                                            {7912}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                                            {7913}event endSrv(Cli_4720,Sess_4722,Nc_6170)
                                                )
                                                else
                                                    {7914}let pkDisco_6175: bitstring = fail-any in
                                                    {7915}in(c, (=pkCli_6123,em1_6176: bitstring));
                                                    {7916}let m1_6177: bitstring = em1_6176 in
                                                    {7917}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_6123,Nc_6178: bitstring) = m1_6177 in
                                                    {7918}new Ns_6179: bitstring;
                                                    {7919}new ST_6180: bitstring;
                                                    {7920}new TTL_6181: bitstring;
                                                    {7921}let m2_6182: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_6179,ST_6180,TTL_6181) in
                                                    {7922}event beginSrv(Sess_4722,Cli_4720,Ns_6179);
                                                    {7923}out(c, m2_6182);
                                                    {7924}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                                    {7925}event endSrv(Cli_4720,Sess_4722,Nc_6178)
                                            )
                                            else
                                                {7926}let pkCli_6183: bitstring = pub(sk(Cli_4720)) in
                                                {7927}let v_6184: bool = (Disco_4721 = A) in
                                                (
                                                    {7928}if v_6184 then
                                                    (
                                                        {7929}let pkDisco_6185: bitstring = pub(skA) in
                                                        {7930}in(c, (=pkCli_6183,em1_6186: bitstring));
                                                        {7931}let m1_6187: bitstring = em1_6186 in
                                                        {7932}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_6183,Nc_6188: bitstring) = m1_6187 in
                                                        {7933}new Ns_6189: bitstring;
                                                        {7934}new ST_6190: bitstring;
                                                        {7935}new TTL_6191: bitstring;
                                                        {7936}let m2_6192: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_6189,ST_6190,TTL_6191) in
                                                        {7937}event beginSrv(Sess_4722,Cli_4720,Ns_6189);
                                                        {7938}out(c, m2_6192);
                                                        {7939}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                                        {7940}event endSrv(Cli_4720,Sess_4722,Nc_6188)
                                                    )
                                                    else
                                                        {7941}let v_6193: bool = (Disco_4721 = B) in
                                                        (
                                                            {7942}if v_6193 then
                                                            (
                                                                {7943}let pkDisco_6194: bitstring = pub(skB) in
                                                                {7944}in(c, (=pkCli_6183,em1_6195: bitstring));
                                                                {7945}let m1_6196: bitstring = em1_6195 in
                                                                {7946}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_6183,Nc_6197: bitstring) = m1_6196 in
                                                                {7947}new Ns_6198: bitstring;
                                                                {7948}new ST_6199: bitstring;
                                                                {7949}new TTL_6200: bitstring;
                                                                {7950}let m2_6201: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_6198,ST_6199,TTL_6200) in
                                                                {7951}event beginSrv(Sess_4722,Cli_4720,Ns_6198);
                                                                {7952}out(c, m2_6201);
                                                                {7953}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                                                {7954}event endSrv(Cli_4720,Sess_4722,Nc_6197)
                                                            )
                                                            else
                                                                {7955}let v_6202: bool = (Disco_4721 = C) in
                                                                (
                                                                    {7956}if v_6202 then
                                                                    (
                                                                        {7957}let pkDisco_6203: bitstring = pub(skC) in
                                                                        {7958}in(c, (=pkCli_6183,em1_6204: bitstring));
                                                                        {7959}let m1_6205: bitstring = em1_6204 in
                                                                        {7960}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_6183,Nc_6206: bitstring) = m1_6205 in
                                                                        {7961}new Ns_6207: bitstring;
                                                                        {7962}new ST_6208: bitstring;
                                                                        {7963}new TTL_6209: bitstring;
                                                                        {7964}let m2_6210: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_6207,ST_6208,TTL_6209) in
                                                                        {7965}event beginSrv(Sess_4722,Cli_4720,Ns_6207);
                                                                        {7966}out(c, m2_6210);
                                                                        {7967}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                                                        {7968}event endSrv(Cli_4720,Sess_4722,Nc_6206)
                                                                    )
                                                                    else
                                                                        {7969}let pkDisco_6211: bitstring = pub(sk(Disco_4721)) in
                                                                        {7970}in(c, (=pkCli_6183,em1_6212: bitstring));
                                                                        {7971}let m1_6213: bitstring = em1_6212 in
                                                                        {7972}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_6183,Nc_6214: bitstring) = m1_6213 in
                                                                        {7973}new Ns_6215: bitstring;
                                                                        {7974}new ST_6216: bitstring;
                                                                        {7975}new TTL_6217: bitstring;
                                                                        {7976}let m2_6218: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_6215,ST_6216,TTL_6217) in
                                                                        {7977}event beginSrv(Sess_4722,Cli_4720,Ns_6215);
                                                                        {7978}out(c, m2_6218);
                                                                        {7979}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                                                        {7980}event endSrv(Cli_4720,Sess_4722,Nc_6214)
                                                                )
                                                                else
                                                                    {7981}let pkDisco_6219: bitstring = fail-any in
                                                                    {7982}in(c, (=pkCli_6183,em1_6220: bitstring));
                                                                    {7983}let m1_6221: bitstring = em1_6220 in
                                                                    {7984}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_6183,Nc_6222: bitstring) = m1_6221 in
                                                                    {7985}new Ns_6223: bitstring;
                                                                    {7986}new ST_6224: bitstring;
                                                                    {7987}new TTL_6225: bitstring;
                                                                    {7988}let m2_6226: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_6223,ST_6224,TTL_6225) in
                                                                    {7989}event beginSrv(Sess_4722,Cli_4720,Ns_6223);
                                                                    {7990}out(c, m2_6226);
                                                                    {7991}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                                                    {7992}event endSrv(Cli_4720,Sess_4722,Nc_6222)
                                                        )
                                                        else
                                                            {7993}let pkDisco_6227: bitstring = fail-any in
                                                            {7994}in(c, (=pkCli_6183,em1_6228: bitstring));
                                                            {7995}let m1_6229: bitstring = em1_6228 in
                                                            {7996}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_6183,Nc_6230: bitstring) = m1_6229 in
                                                            {7997}new Ns_6231: bitstring;
                                                            {7998}new ST_6232: bitstring;
                                                            {7999}new TTL_6233: bitstring;
                                                            {8000}let m2_6234: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_6231,ST_6232,TTL_6233) in
                                                            {8001}event beginSrv(Sess_4722,Cli_4720,Ns_6231);
                                                            {8002}out(c, m2_6234);
                                                            {8003}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                                            {8004}event endSrv(Cli_4720,Sess_4722,Nc_6230)
                                                )
                                                else
                                                    {8005}let pkDisco_6235: bitstring = fail-any in
                                                    {8006}in(c, (=pkCli_6183,em1_6236: bitstring));
                                                    {8007}let m1_6237: bitstring = em1_6236 in
                                                    {8008}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_6183,Nc_6238: bitstring) = m1_6237 in
                                                    {8009}new Ns_6239: bitstring;
                                                    {8010}new ST_6240: bitstring;
                                                    {8011}new TTL_6241: bitstring;
                                                    {8012}let m2_6242: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_6239,ST_6240,TTL_6241) in
                                                    {8013}event beginSrv(Sess_4722,Cli_4720,Ns_6239);
                                                    {8014}out(c, m2_6242);
                                                    {8015}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                                    {8016}event endSrv(Cli_4720,Sess_4722,Nc_6238)
                                        )
                                        else
                                            {8017}let pkCli_6243: bitstring = fail-any in
                                            {8018}let v_6244: bool = (Disco_4721 = A) in
                                            (
                                                {8019}if v_6244 then
                                                (
                                                    {8020}let pkDisco_6245: bitstring = pub(skA) in
                                                    {8021}in(c, (=pkCli_6243,em1_6246: bitstring));
                                                    {8022}let m1_6247: bitstring = em1_6246 in
                                                    {8023}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_6243,Nc_6248: bitstring) = m1_6247 in
                                                    {8024}new Ns_6249: bitstring;
                                                    {8025}new ST_6250: bitstring;
                                                    {8026}new TTL_6251: bitstring;
                                                    {8027}let m2_6252: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_6249,ST_6250,TTL_6251) in
                                                    {8028}event beginSrv(Sess_4722,Cli_4720,Ns_6249);
                                                    {8029}out(c, m2_6252);
                                                    {8030}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                                    {8031}event endSrv(Cli_4720,Sess_4722,Nc_6248)
                                                )
                                                else
                                                    {8032}let v_6253: bool = (Disco_4721 = B) in
                                                    (
                                                        {8033}if v_6253 then
                                                        (
                                                            {8034}let pkDisco_6254: bitstring = pub(skB) in
                                                            {8035}in(c, (=pkCli_6243,em1_6255: bitstring));
                                                            {8036}let m1_6256: bitstring = em1_6255 in
                                                            {8037}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_6243,Nc_6257: bitstring) = m1_6256 in
                                                            {8038}new Ns_6258: bitstring;
                                                            {8039}new ST_6259: bitstring;
                                                            {8040}new TTL_6260: bitstring;
                                                            {8041}let m2_6261: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_6258,ST_6259,TTL_6260) in
                                                            {8042}event beginSrv(Sess_4722,Cli_4720,Ns_6258);
                                                            {8043}out(c, m2_6261);
                                                            {8044}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                                            {8045}event endSrv(Cli_4720,Sess_4722,Nc_6257)
                                                        )
                                                        else
                                                            {8046}let v_6262: bool = (Disco_4721 = C) in
                                                            (
                                                                {8047}if v_6262 then
                                                                (
                                                                    {8048}let pkDisco_6263: bitstring = pub(skC) in
                                                                    {8049}in(c, (=pkCli_6243,em1_6264: bitstring));
                                                                    {8050}let m1_6265: bitstring = em1_6264 in
                                                                    {8051}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_6243,Nc_6266: bitstring) = m1_6265 in
                                                                    {8052}new Ns_6267: bitstring;
                                                                    {8053}new ST_6268: bitstring;
                                                                    {8054}new TTL_6269: bitstring;
                                                                    {8055}let m2_6270: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_6267,ST_6268,TTL_6269) in
                                                                    {8056}event beginSrv(Sess_4722,Cli_4720,Ns_6267);
                                                                    {8057}out(c, m2_6270);
                                                                    {8058}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                                                    {8059}event endSrv(Cli_4720,Sess_4722,Nc_6266)
                                                                )
                                                                else
                                                                    {8060}let pkDisco_6271: bitstring = pub(sk(Disco_4721)) in
                                                                    {8061}in(c, (=pkCli_6243,em1_6272: bitstring));
                                                                    {8062}let m1_6273: bitstring = em1_6272 in
                                                                    {8063}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_6243,Nc_6274: bitstring) = m1_6273 in
                                                                    {8064}new Ns_6275: bitstring;
                                                                    {8065}new ST_6276: bitstring;
                                                                    {8066}new TTL_6277: bitstring;
                                                                    {8067}let m2_6278: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_6275,ST_6276,TTL_6277) in
                                                                    {8068}event beginSrv(Sess_4722,Cli_4720,Ns_6275);
                                                                    {8069}out(c, m2_6278);
                                                                    {8070}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                                                    {8071}event endSrv(Cli_4720,Sess_4722,Nc_6274)
                                                            )
                                                            else
                                                                {8072}let pkDisco_6279: bitstring = fail-any in
                                                                {8073}in(c, (=pkCli_6243,em1_6280: bitstring));
                                                                {8074}let m1_6281: bitstring = em1_6280 in
                                                                {8075}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_6243,Nc_6282: bitstring) = m1_6281 in
                                                                {8076}new Ns_6283: bitstring;
                                                                {8077}new ST_6284: bitstring;
                                                                {8078}new TTL_6285: bitstring;
                                                                {8079}let m2_6286: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_6283,ST_6284,TTL_6285) in
                                                                {8080}event beginSrv(Sess_4722,Cli_4720,Ns_6283);
                                                                {8081}out(c, m2_6286);
                                                                {8082}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                                                {8083}event endSrv(Cli_4720,Sess_4722,Nc_6282)
                                                    )
                                                    else
                                                        {8084}let pkDisco_6287: bitstring = fail-any in
                                                        {8085}in(c, (=pkCli_6243,em1_6288: bitstring));
                                                        {8086}let m1_6289: bitstring = em1_6288 in
                                                        {8087}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_6243,Nc_6290: bitstring) = m1_6289 in
                                                        {8088}new Ns_6291: bitstring;
                                                        {8089}new ST_6292: bitstring;
                                                        {8090}new TTL_6293: bitstring;
                                                        {8091}let m2_6294: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_6291,ST_6292,TTL_6293) in
                                                        {8092}event beginSrv(Sess_4722,Cli_4720,Ns_6291);
                                                        {8093}out(c, m2_6294);
                                                        {8094}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                                        {8095}event endSrv(Cli_4720,Sess_4722,Nc_6290)
                                            )
                                            else
                                                {8096}let pkDisco_6295: bitstring = fail-any in
                                                {8097}in(c, (=pkCli_6243,em1_6296: bitstring));
                                                {8098}let m1_6297: bitstring = em1_6296 in
                                                {8099}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_6243,Nc_6298: bitstring) = m1_6297 in
                                                {8100}new Ns_6299: bitstring;
                                                {8101}new ST_6300: bitstring;
                                                {8102}new TTL_6301: bitstring;
                                                {8103}let m2_6302: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_6299,ST_6300,TTL_6301) in
                                                {8104}event beginSrv(Sess_4722,Cli_4720,Ns_6299);
                                                {8105}out(c, m2_6302);
                                                {8106}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                                {8107}event endSrv(Cli_4720,Sess_4722,Nc_6298)
                                )
                                else
                                    {8108}let pkCli_6303: bitstring = fail-any in
                                    {8109}let v_6304: bool = (Disco_4721 = A) in
                                    (
                                        {8110}if v_6304 then
                                        (
                                            {8111}let pkDisco_6305: bitstring = pub(skA) in
                                            {8112}in(c, (=pkCli_6303,em1_6306: bitstring));
                                            {8113}let m1_6307: bitstring = em1_6306 in
                                            {8114}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_6303,Nc_6308: bitstring) = m1_6307 in
                                            {8115}new Ns_6309: bitstring;
                                            {8116}new ST_6310: bitstring;
                                            {8117}new TTL_6311: bitstring;
                                            {8118}let m2_6312: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_6309,ST_6310,TTL_6311) in
                                            {8119}event beginSrv(Sess_4722,Cli_4720,Ns_6309);
                                            {8120}out(c, m2_6312);
                                            {8121}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                            {8122}event endSrv(Cli_4720,Sess_4722,Nc_6308)
                                        )
                                        else
                                            {8123}let v_6313: bool = (Disco_4721 = B) in
                                            (
                                                {8124}if v_6313 then
                                                (
                                                    {8125}let pkDisco_6314: bitstring = pub(skB) in
                                                    {8126}in(c, (=pkCli_6303,em1_6315: bitstring));
                                                    {8127}let m1_6316: bitstring = em1_6315 in
                                                    {8128}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_6303,Nc_6317: bitstring) = m1_6316 in
                                                    {8129}new Ns_6318: bitstring;
                                                    {8130}new ST_6319: bitstring;
                                                    {8131}new TTL_6320: bitstring;
                                                    {8132}let m2_6321: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_6318,ST_6319,TTL_6320) in
                                                    {8133}event beginSrv(Sess_4722,Cli_4720,Ns_6318);
                                                    {8134}out(c, m2_6321);
                                                    {8135}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                                    {8136}event endSrv(Cli_4720,Sess_4722,Nc_6317)
                                                )
                                                else
                                                    {8137}let v_6322: bool = (Disco_4721 = C) in
                                                    (
                                                        {8138}if v_6322 then
                                                        (
                                                            {8139}let pkDisco_6323: bitstring = pub(skC) in
                                                            {8140}in(c, (=pkCli_6303,em1_6324: bitstring));
                                                            {8141}let m1_6325: bitstring = em1_6324 in
                                                            {8142}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_6303,Nc_6326: bitstring) = m1_6325 in
                                                            {8143}new Ns_6327: bitstring;
                                                            {8144}new ST_6328: bitstring;
                                                            {8145}new TTL_6329: bitstring;
                                                            {8146}let m2_6330: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_6327,ST_6328,TTL_6329) in
                                                            {8147}event beginSrv(Sess_4722,Cli_4720,Ns_6327);
                                                            {8148}out(c, m2_6330);
                                                            {8149}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                                            {8150}event endSrv(Cli_4720,Sess_4722,Nc_6326)
                                                        )
                                                        else
                                                            {8151}let pkDisco_6331: bitstring = pub(sk(Disco_4721)) in
                                                            {8152}in(c, (=pkCli_6303,em1_6332: bitstring));
                                                            {8153}let m1_6333: bitstring = em1_6332 in
                                                            {8154}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_6303,Nc_6334: bitstring) = m1_6333 in
                                                            {8155}new Ns_6335: bitstring;
                                                            {8156}new ST_6336: bitstring;
                                                            {8157}new TTL_6337: bitstring;
                                                            {8158}let m2_6338: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_6335,ST_6336,TTL_6337) in
                                                            {8159}event beginSrv(Sess_4722,Cli_4720,Ns_6335);
                                                            {8160}out(c, m2_6338);
                                                            {8161}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                                            {8162}event endSrv(Cli_4720,Sess_4722,Nc_6334)
                                                    )
                                                    else
                                                        {8163}let pkDisco_6339: bitstring = fail-any in
                                                        {8164}in(c, (=pkCli_6303,em1_6340: bitstring));
                                                        {8165}let m1_6341: bitstring = em1_6340 in
                                                        {8166}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_6303,Nc_6342: bitstring) = m1_6341 in
                                                        {8167}new Ns_6343: bitstring;
                                                        {8168}new ST_6344: bitstring;
                                                        {8169}new TTL_6345: bitstring;
                                                        {8170}let m2_6346: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_6343,ST_6344,TTL_6345) in
                                                        {8171}event beginSrv(Sess_4722,Cli_4720,Ns_6343);
                                                        {8172}out(c, m2_6346);
                                                        {8173}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                                        {8174}event endSrv(Cli_4720,Sess_4722,Nc_6342)
                                            )
                                            else
                                                {8175}let pkDisco_6347: bitstring = fail-any in
                                                {8176}in(c, (=pkCli_6303,em1_6348: bitstring));
                                                {8177}let m1_6349: bitstring = em1_6348 in
                                                {8178}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_6303,Nc_6350: bitstring) = m1_6349 in
                                                {8179}new Ns_6351: bitstring;
                                                {8180}new ST_6352: bitstring;
                                                {8181}new TTL_6353: bitstring;
                                                {8182}let m2_6354: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_6351,ST_6352,TTL_6353) in
                                                {8183}event beginSrv(Sess_4722,Cli_4720,Ns_6351);
                                                {8184}out(c, m2_6354);
                                                {8185}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                                {8186}event endSrv(Cli_4720,Sess_4722,Nc_6350)
                                    )
                                    else
                                        {8187}let pkDisco_6355: bitstring = fail-any in
                                        {8188}in(c, (=pkCli_6303,em1_6356: bitstring));
                                        {8189}let m1_6357: bitstring = em1_6356 in
                                        {8190}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_6303,Nc_6358: bitstring) = m1_6357 in
                                        {8191}new Ns_6359: bitstring;
                                        {8192}new ST_6360: bitstring;
                                        {8193}new TTL_6361: bitstring;
                                        {8194}let m2_6362: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_6359,ST_6360,TTL_6361) in
                                        {8195}event beginSrv(Sess_4722,Cli_4720,Ns_6359);
                                        {8196}out(c, m2_6362);
                                        {8197}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                        {8198}event endSrv(Cli_4720,Sess_4722,Nc_6358)
                        )
                        else
                            {8199}let pkCli_6363: bitstring = fail-any in
                            {8200}let v_6364: bool = (Disco_4721 = A) in
                            (
                                {8201}if v_6364 then
                                (
                                    {8202}let pkDisco_6365: bitstring = pub(skA) in
                                    {8203}in(c, (=pkCli_6363,em1_6366: bitstring));
                                    {8204}let m1_6367: bitstring = em1_6366 in
                                    {8205}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_6363,Nc_6368: bitstring) = m1_6367 in
                                    {8206}new Ns_6369: bitstring;
                                    {8207}new ST_6370: bitstring;
                                    {8208}new TTL_6371: bitstring;
                                    {8209}let m2_6372: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_6369,ST_6370,TTL_6371) in
                                    {8210}event beginSrv(Sess_4722,Cli_4720,Ns_6369);
                                    {8211}out(c, m2_6372);
                                    {8212}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                    {8213}event endSrv(Cli_4720,Sess_4722,Nc_6368)
                                )
                                else
                                    {8214}let v_6373: bool = (Disco_4721 = B) in
                                    (
                                        {8215}if v_6373 then
                                        (
                                            {8216}let pkDisco_6374: bitstring = pub(skB) in
                                            {8217}in(c, (=pkCli_6363,em1_6375: bitstring));
                                            {8218}let m1_6376: bitstring = em1_6375 in
                                            {8219}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_6363,Nc_6377: bitstring) = m1_6376 in
                                            {8220}new Ns_6378: bitstring;
                                            {8221}new ST_6379: bitstring;
                                            {8222}new TTL_6380: bitstring;
                                            {8223}let m2_6381: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_6378,ST_6379,TTL_6380) in
                                            {8224}event beginSrv(Sess_4722,Cli_4720,Ns_6378);
                                            {8225}out(c, m2_6381);
                                            {8226}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                            {8227}event endSrv(Cli_4720,Sess_4722,Nc_6377)
                                        )
                                        else
                                            {8228}let v_6382: bool = (Disco_4721 = C) in
                                            (
                                                {8229}if v_6382 then
                                                (
                                                    {8230}let pkDisco_6383: bitstring = pub(skC) in
                                                    {8231}in(c, (=pkCli_6363,em1_6384: bitstring));
                                                    {8232}let m1_6385: bitstring = em1_6384 in
                                                    {8233}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_6363,Nc_6386: bitstring) = m1_6385 in
                                                    {8234}new Ns_6387: bitstring;
                                                    {8235}new ST_6388: bitstring;
                                                    {8236}new TTL_6389: bitstring;
                                                    {8237}let m2_6390: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_6387,ST_6388,TTL_6389) in
                                                    {8238}event beginSrv(Sess_4722,Cli_4720,Ns_6387);
                                                    {8239}out(c, m2_6390);
                                                    {8240}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                                    {8241}event endSrv(Cli_4720,Sess_4722,Nc_6386)
                                                )
                                                else
                                                    {8242}let pkDisco_6391: bitstring = pub(sk(Disco_4721)) in
                                                    {8243}in(c, (=pkCli_6363,em1_6392: bitstring));
                                                    {8244}let m1_6393: bitstring = em1_6392 in
                                                    {8245}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_6363,Nc_6394: bitstring) = m1_6393 in
                                                    {8246}new Ns_6395: bitstring;
                                                    {8247}new ST_6396: bitstring;
                                                    {8248}new TTL_6397: bitstring;
                                                    {8249}let m2_6398: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_6395,ST_6396,TTL_6397) in
                                                    {8250}event beginSrv(Sess_4722,Cli_4720,Ns_6395);
                                                    {8251}out(c, m2_6398);
                                                    {8252}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                                    {8253}event endSrv(Cli_4720,Sess_4722,Nc_6394)
                                            )
                                            else
                                                {8254}let pkDisco_6399: bitstring = fail-any in
                                                {8255}in(c, (=pkCli_6363,em1_6400: bitstring));
                                                {8256}let m1_6401: bitstring = em1_6400 in
                                                {8257}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_6363,Nc_6402: bitstring) = m1_6401 in
                                                {8258}new Ns_6403: bitstring;
                                                {8259}new ST_6404: bitstring;
                                                {8260}new TTL_6405: bitstring;
                                                {8261}let m2_6406: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_6403,ST_6404,TTL_6405) in
                                                {8262}event beginSrv(Sess_4722,Cli_4720,Ns_6403);
                                                {8263}out(c, m2_6406);
                                                {8264}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                                {8265}event endSrv(Cli_4720,Sess_4722,Nc_6402)
                                    )
                                    else
                                        {8266}let pkDisco_6407: bitstring = fail-any in
                                        {8267}in(c, (=pkCli_6363,em1_6408: bitstring));
                                        {8268}let m1_6409: bitstring = em1_6408 in
                                        {8269}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_6363,Nc_6410: bitstring) = m1_6409 in
                                        {8270}new Ns_6411: bitstring;
                                        {8271}new ST_6412: bitstring;
                                        {8272}new TTL_6413: bitstring;
                                        {8273}let m2_6414: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_6411,ST_6412,TTL_6413) in
                                        {8274}event beginSrv(Sess_4722,Cli_4720,Ns_6411);
                                        {8275}out(c, m2_6414);
                                        {8276}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                        {8277}event endSrv(Cli_4720,Sess_4722,Nc_6410)
                            )
                            else
                                {8278}let pkDisco_6415: bitstring = fail-any in
                                {8279}in(c, (=pkCli_6363,em1_6416: bitstring));
                                {8280}let m1_6417: bitstring = em1_6416 in
                                {8281}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_6363,Nc_6418: bitstring) = m1_6417 in
                                {8282}new Ns_6419: bitstring;
                                {8283}new ST_6420: bitstring;
                                {8284}new TTL_6421: bitstring;
                                {8285}let m2_6422: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_6419,ST_6420,TTL_6421) in
                                {8286}event beginSrv(Sess_4722,Cli_4720,Ns_6419);
                                {8287}out(c, m2_6422);
                                {8288}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                {8289}event endSrv(Cli_4720,Sess_4722,Nc_6418)
            )
            else
                {8290}let skSess_6423: bitstring = fail-any in
                {8291}let pkSess_6424: bitstring = pub(skSess_6423) in
                {8292}let v_6425: bool = (Cli_4720 = A) in
                (
                    {8293}if v_6425 then
                    (
                        {8294}let pkCli_6426: bitstring = pub(skA) in
                        {8295}let v_6427: bool = (Disco_4721 = A) in
                        (
                            {8296}if v_6427 then
                            (
                                {8297}let pkDisco_6428: bitstring = pub(skA) in
                                {8298}in(c, (=pkCli_6426,em1_6429: bitstring));
                                {8299}let m1_6430: bitstring = em1_6429 in
                                {8300}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_6426,Nc_6431: bitstring) = m1_6430 in
                                {8301}new Ns_6432: bitstring;
                                {8302}new ST_6433: bitstring;
                                {8303}new TTL_6434: bitstring;
                                {8304}let m2_6435: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_6432,ST_6433,TTL_6434) in
                                {8305}event beginSrv(Sess_4722,Cli_4720,Ns_6432);
                                {8306}out(c, m2_6435);
                                {8307}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                {8308}event endSrv(Cli_4720,Sess_4722,Nc_6431)
                            )
                            else
                                {8309}let v_6436: bool = (Disco_4721 = B) in
                                (
                                    {8310}if v_6436 then
                                    (
                                        {8311}let pkDisco_6437: bitstring = pub(skB) in
                                        {8312}in(c, (=pkCli_6426,em1_6438: bitstring));
                                        {8313}let m1_6439: bitstring = em1_6438 in
                                        {8314}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_6426,Nc_6440: bitstring) = m1_6439 in
                                        {8315}new Ns_6441: bitstring;
                                        {8316}new ST_6442: bitstring;
                                        {8317}new TTL_6443: bitstring;
                                        {8318}let m2_6444: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_6441,ST_6442,TTL_6443) in
                                        {8319}event beginSrv(Sess_4722,Cli_4720,Ns_6441);
                                        {8320}out(c, m2_6444);
                                        {8321}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                        {8322}event endSrv(Cli_4720,Sess_4722,Nc_6440)
                                    )
                                    else
                                        {8323}let v_6445: bool = (Disco_4721 = C) in
                                        (
                                            {8324}if v_6445 then
                                            (
                                                {8325}let pkDisco_6446: bitstring = pub(skC) in
                                                {8326}in(c, (=pkCli_6426,em1_6447: bitstring));
                                                {8327}let m1_6448: bitstring = em1_6447 in
                                                {8328}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_6426,Nc_6449: bitstring) = m1_6448 in
                                                {8329}new Ns_6450: bitstring;
                                                {8330}new ST_6451: bitstring;
                                                {8331}new TTL_6452: bitstring;
                                                {8332}let m2_6453: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_6450,ST_6451,TTL_6452) in
                                                {8333}event beginSrv(Sess_4722,Cli_4720,Ns_6450);
                                                {8334}out(c, m2_6453);
                                                {8335}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                                {8336}event endSrv(Cli_4720,Sess_4722,Nc_6449)
                                            )
                                            else
                                                {8337}let pkDisco_6454: bitstring = pub(sk(Disco_4721)) in
                                                {8338}in(c, (=pkCli_6426,em1_6455: bitstring));
                                                {8339}let m1_6456: bitstring = em1_6455 in
                                                {8340}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_6426,Nc_6457: bitstring) = m1_6456 in
                                                {8341}new Ns_6458: bitstring;
                                                {8342}new ST_6459: bitstring;
                                                {8343}new TTL_6460: bitstring;
                                                {8344}let m2_6461: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_6458,ST_6459,TTL_6460) in
                                                {8345}event beginSrv(Sess_4722,Cli_4720,Ns_6458);
                                                {8346}out(c, m2_6461);
                                                {8347}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                                {8348}event endSrv(Cli_4720,Sess_4722,Nc_6457)
                                        )
                                        else
                                            {8349}let pkDisco_6462: bitstring = fail-any in
                                            {8350}in(c, (=pkCli_6426,em1_6463: bitstring));
                                            {8351}let m1_6464: bitstring = em1_6463 in
                                            {8352}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_6426,Nc_6465: bitstring) = m1_6464 in
                                            {8353}new Ns_6466: bitstring;
                                            {8354}new ST_6467: bitstring;
                                            {8355}new TTL_6468: bitstring;
                                            {8356}let m2_6469: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_6466,ST_6467,TTL_6468) in
                                            {8357}event beginSrv(Sess_4722,Cli_4720,Ns_6466);
                                            {8358}out(c, m2_6469);
                                            {8359}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                            {8360}event endSrv(Cli_4720,Sess_4722,Nc_6465)
                                )
                                else
                                    {8361}let pkDisco_6470: bitstring = fail-any in
                                    {8362}in(c, (=pkCli_6426,em1_6471: bitstring));
                                    {8363}let m1_6472: bitstring = em1_6471 in
                                    {8364}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_6426,Nc_6473: bitstring) = m1_6472 in
                                    {8365}new Ns_6474: bitstring;
                                    {8366}new ST_6475: bitstring;
                                    {8367}new TTL_6476: bitstring;
                                    {8368}let m2_6477: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_6474,ST_6475,TTL_6476) in
                                    {8369}event beginSrv(Sess_4722,Cli_4720,Ns_6474);
                                    {8370}out(c, m2_6477);
                                    {8371}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                    {8372}event endSrv(Cli_4720,Sess_4722,Nc_6473)
                        )
                        else
                            {8373}let pkDisco_6478: bitstring = fail-any in
                            {8374}in(c, (=pkCli_6426,em1_6479: bitstring));
                            {8375}let m1_6480: bitstring = em1_6479 in
                            {8376}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_6426,Nc_6481: bitstring) = m1_6480 in
                            {8377}new Ns_6482: bitstring;
                            {8378}new ST_6483: bitstring;
                            {8379}new TTL_6484: bitstring;
                            {8380}let m2_6485: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_6482,ST_6483,TTL_6484) in
                            {8381}event beginSrv(Sess_4722,Cli_4720,Ns_6482);
                            {8382}out(c, m2_6485);
                            {8383}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                            {8384}event endSrv(Cli_4720,Sess_4722,Nc_6481)
                    )
                    else
                        {8385}let v_6486: bool = (Cli_4720 = B) in
                        (
                            {8386}if v_6486 then
                            (
                                {8387}let pkCli_6487: bitstring = pub(skB) in
                                {8388}let v_6488: bool = (Disco_4721 = A) in
                                (
                                    {8389}if v_6488 then
                                    (
                                        {8390}let pkDisco_6489: bitstring = pub(skA) in
                                        {8391}in(c, (=pkCli_6487,em1_6490: bitstring));
                                        {8392}let m1_6491: bitstring = em1_6490 in
                                        {8393}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_6487,Nc_6492: bitstring) = m1_6491 in
                                        {8394}new Ns_6493: bitstring;
                                        {8395}new ST_6494: bitstring;
                                        {8396}new TTL_6495: bitstring;
                                        {8397}let m2_6496: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_6493,ST_6494,TTL_6495) in
                                        {8398}event beginSrv(Sess_4722,Cli_4720,Ns_6493);
                                        {8399}out(c, m2_6496);
                                        {8400}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                        {8401}event endSrv(Cli_4720,Sess_4722,Nc_6492)
                                    )
                                    else
                                        {8402}let v_6497: bool = (Disco_4721 = B) in
                                        (
                                            {8403}if v_6497 then
                                            (
                                                {8404}let pkDisco_6498: bitstring = pub(skB) in
                                                {8405}in(c, (=pkCli_6487,em1_6499: bitstring));
                                                {8406}let m1_6500: bitstring = em1_6499 in
                                                {8407}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_6487,Nc_6501: bitstring) = m1_6500 in
                                                {8408}new Ns_6502: bitstring;
                                                {8409}new ST_6503: bitstring;
                                                {8410}new TTL_6504: bitstring;
                                                {8411}let m2_6505: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_6502,ST_6503,TTL_6504) in
                                                {8412}event beginSrv(Sess_4722,Cli_4720,Ns_6502);
                                                {8413}out(c, m2_6505);
                                                {8414}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                                {8415}event endSrv(Cli_4720,Sess_4722,Nc_6501)
                                            )
                                            else
                                                {8416}let v_6506: bool = (Disco_4721 = C) in
                                                (
                                                    {8417}if v_6506 then
                                                    (
                                                        {8418}let pkDisco_6507: bitstring = pub(skC) in
                                                        {8419}in(c, (=pkCli_6487,em1_6508: bitstring));
                                                        {8420}let m1_6509: bitstring = em1_6508 in
                                                        {8421}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_6487,Nc_6510: bitstring) = m1_6509 in
                                                        {8422}new Ns_6511: bitstring;
                                                        {8423}new ST_6512: bitstring;
                                                        {8424}new TTL_6513: bitstring;
                                                        {8425}let m2_6514: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_6511,ST_6512,TTL_6513) in
                                                        {8426}event beginSrv(Sess_4722,Cli_4720,Ns_6511);
                                                        {8427}out(c, m2_6514);
                                                        {8428}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                                        {8429}event endSrv(Cli_4720,Sess_4722,Nc_6510)
                                                    )
                                                    else
                                                        {8430}let pkDisco_6515: bitstring = pub(sk(Disco_4721)) in
                                                        {8431}in(c, (=pkCli_6487,em1_6516: bitstring));
                                                        {8432}let m1_6517: bitstring = em1_6516 in
                                                        {8433}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_6487,Nc_6518: bitstring) = m1_6517 in
                                                        {8434}new Ns_6519: bitstring;
                                                        {8435}new ST_6520: bitstring;
                                                        {8436}new TTL_6521: bitstring;
                                                        {8437}let m2_6522: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_6519,ST_6520,TTL_6521) in
                                                        {8438}event beginSrv(Sess_4722,Cli_4720,Ns_6519);
                                                        {8439}out(c, m2_6522);
                                                        {8440}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                                        {8441}event endSrv(Cli_4720,Sess_4722,Nc_6518)
                                                )
                                                else
                                                    {8442}let pkDisco_6523: bitstring = fail-any in
                                                    {8443}in(c, (=pkCli_6487,em1_6524: bitstring));
                                                    {8444}let m1_6525: bitstring = em1_6524 in
                                                    {8445}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_6487,Nc_6526: bitstring) = m1_6525 in
                                                    {8446}new Ns_6527: bitstring;
                                                    {8447}new ST_6528: bitstring;
                                                    {8448}new TTL_6529: bitstring;
                                                    {8449}let m2_6530: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_6527,ST_6528,TTL_6529) in
                                                    {8450}event beginSrv(Sess_4722,Cli_4720,Ns_6527);
                                                    {8451}out(c, m2_6530);
                                                    {8452}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                                    {8453}event endSrv(Cli_4720,Sess_4722,Nc_6526)
                                        )
                                        else
                                            {8454}let pkDisco_6531: bitstring = fail-any in
                                            {8455}in(c, (=pkCli_6487,em1_6532: bitstring));
                                            {8456}let m1_6533: bitstring = em1_6532 in
                                            {8457}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_6487,Nc_6534: bitstring) = m1_6533 in
                                            {8458}new Ns_6535: bitstring;
                                            {8459}new ST_6536: bitstring;
                                            {8460}new TTL_6537: bitstring;
                                            {8461}let m2_6538: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_6535,ST_6536,TTL_6537) in
                                            {8462}event beginSrv(Sess_4722,Cli_4720,Ns_6535);
                                            {8463}out(c, m2_6538);
                                            {8464}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                            {8465}event endSrv(Cli_4720,Sess_4722,Nc_6534)
                                )
                                else
                                    {8466}let pkDisco_6539: bitstring = fail-any in
                                    {8467}in(c, (=pkCli_6487,em1_6540: bitstring));
                                    {8468}let m1_6541: bitstring = em1_6540 in
                                    {8469}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_6487,Nc_6542: bitstring) = m1_6541 in
                                    {8470}new Ns_6543: bitstring;
                                    {8471}new ST_6544: bitstring;
                                    {8472}new TTL_6545: bitstring;
                                    {8473}let m2_6546: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_6543,ST_6544,TTL_6545) in
                                    {8474}event beginSrv(Sess_4722,Cli_4720,Ns_6543);
                                    {8475}out(c, m2_6546);
                                    {8476}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                    {8477}event endSrv(Cli_4720,Sess_4722,Nc_6542)
                            )
                            else
                                {8478}let v_6547: bool = (Cli_4720 = C) in
                                (
                                    {8479}if v_6547 then
                                    (
                                        {8480}let pkCli_6548: bitstring = pub(skC) in
                                        {8481}let v_6549: bool = (Disco_4721 = A) in
                                        (
                                            {8482}if v_6549 then
                                            (
                                                {8483}let pkDisco_6550: bitstring = pub(skA) in
                                                {8484}in(c, (=pkCli_6548,em1_6551: bitstring));
                                                {8485}let m1_6552: bitstring = em1_6551 in
                                                {8486}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_6548,Nc_6553: bitstring) = m1_6552 in
                                                {8487}new Ns_6554: bitstring;
                                                {8488}new ST_6555: bitstring;
                                                {8489}new TTL_6556: bitstring;
                                                {8490}let m2_6557: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_6554,ST_6555,TTL_6556) in
                                                {8491}event beginSrv(Sess_4722,Cli_4720,Ns_6554);
                                                {8492}out(c, m2_6557);
                                                {8493}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                                {8494}event endSrv(Cli_4720,Sess_4722,Nc_6553)
                                            )
                                            else
                                                {8495}let v_6558: bool = (Disco_4721 = B) in
                                                (
                                                    {8496}if v_6558 then
                                                    (
                                                        {8497}let pkDisco_6559: bitstring = pub(skB) in
                                                        {8498}in(c, (=pkCli_6548,em1_6560: bitstring));
                                                        {8499}let m1_6561: bitstring = em1_6560 in
                                                        {8500}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_6548,Nc_6562: bitstring) = m1_6561 in
                                                        {8501}new Ns_6563: bitstring;
                                                        {8502}new ST_6564: bitstring;
                                                        {8503}new TTL_6565: bitstring;
                                                        {8504}let m2_6566: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_6563,ST_6564,TTL_6565) in
                                                        {8505}event beginSrv(Sess_4722,Cli_4720,Ns_6563);
                                                        {8506}out(c, m2_6566);
                                                        {8507}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                                        {8508}event endSrv(Cli_4720,Sess_4722,Nc_6562)
                                                    )
                                                    else
                                                        {8509}let v_6567: bool = (Disco_4721 = C) in
                                                        (
                                                            {8510}if v_6567 then
                                                            (
                                                                {8511}let pkDisco_6568: bitstring = pub(skC) in
                                                                {8512}in(c, (=pkCli_6548,em1_6569: bitstring));
                                                                {8513}let m1_6570: bitstring = em1_6569 in
                                                                {8514}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_6548,Nc_6571: bitstring) = m1_6570 in
                                                                {8515}new Ns_6572: bitstring;
                                                                {8516}new ST_6573: bitstring;
                                                                {8517}new TTL_6574: bitstring;
                                                                {8518}let m2_6575: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_6572,ST_6573,TTL_6574) in
                                                                {8519}event beginSrv(Sess_4722,Cli_4720,Ns_6572);
                                                                {8520}out(c, m2_6575);
                                                                {8521}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                                                {8522}event endSrv(Cli_4720,Sess_4722,Nc_6571)
                                                            )
                                                            else
                                                                {8523}let pkDisco_6576: bitstring = pub(sk(Disco_4721)) in
                                                                {8524}in(c, (=pkCli_6548,em1_6577: bitstring));
                                                                {8525}let m1_6578: bitstring = em1_6577 in
                                                                {8526}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_6548,Nc_6579: bitstring) = m1_6578 in
                                                                {8527}new Ns_6580: bitstring;
                                                                {8528}new ST_6581: bitstring;
                                                                {8529}new TTL_6582: bitstring;
                                                                {8530}let m2_6583: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_6580,ST_6581,TTL_6582) in
                                                                {8531}event beginSrv(Sess_4722,Cli_4720,Ns_6580);
                                                                {8532}out(c, m2_6583);
                                                                {8533}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                                                {8534}event endSrv(Cli_4720,Sess_4722,Nc_6579)
                                                        )
                                                        else
                                                            {8535}let pkDisco_6584: bitstring = fail-any in
                                                            {8536}in(c, (=pkCli_6548,em1_6585: bitstring));
                                                            {8537}let m1_6586: bitstring = em1_6585 in
                                                            {8538}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_6548,Nc_6587: bitstring) = m1_6586 in
                                                            {8539}new Ns_6588: bitstring;
                                                            {8540}new ST_6589: bitstring;
                                                            {8541}new TTL_6590: bitstring;
                                                            {8542}let m2_6591: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_6588,ST_6589,TTL_6590) in
                                                            {8543}event beginSrv(Sess_4722,Cli_4720,Ns_6588);
                                                            {8544}out(c, m2_6591);
                                                            {8545}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                                            {8546}event endSrv(Cli_4720,Sess_4722,Nc_6587)
                                                )
                                                else
                                                    {8547}let pkDisco_6592: bitstring = fail-any in
                                                    {8548}in(c, (=pkCli_6548,em1_6593: bitstring));
                                                    {8549}let m1_6594: bitstring = em1_6593 in
                                                    {8550}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_6548,Nc_6595: bitstring) = m1_6594 in
                                                    {8551}new Ns_6596: bitstring;
                                                    {8552}new ST_6597: bitstring;
                                                    {8553}new TTL_6598: bitstring;
                                                    {8554}let m2_6599: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_6596,ST_6597,TTL_6598) in
                                                    {8555}event beginSrv(Sess_4722,Cli_4720,Ns_6596);
                                                    {8556}out(c, m2_6599);
                                                    {8557}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                                    {8558}event endSrv(Cli_4720,Sess_4722,Nc_6595)
                                        )
                                        else
                                            {8559}let pkDisco_6600: bitstring = fail-any in
                                            {8560}in(c, (=pkCli_6548,em1_6601: bitstring));
                                            {8561}let m1_6602: bitstring = em1_6601 in
                                            {8562}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_6548,Nc_6603: bitstring) = m1_6602 in
                                            {8563}new Ns_6604: bitstring;
                                            {8564}new ST_6605: bitstring;
                                            {8565}new TTL_6606: bitstring;
                                            {8566}let m2_6607: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_6604,ST_6605,TTL_6606) in
                                            {8567}event beginSrv(Sess_4722,Cli_4720,Ns_6604);
                                            {8568}out(c, m2_6607);
                                            {8569}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                            {8570}event endSrv(Cli_4720,Sess_4722,Nc_6603)
                                    )
                                    else
                                        {8571}let pkCli_6608: bitstring = pub(sk(Cli_4720)) in
                                        {8572}let v_6609: bool = (Disco_4721 = A) in
                                        (
                                            {8573}if v_6609 then
                                            (
                                                {8574}let pkDisco_6610: bitstring = pub(skA) in
                                                {8575}in(c, (=pkCli_6608,em1_6611: bitstring));
                                                {8576}let m1_6612: bitstring = em1_6611 in
                                                {8577}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_6608,Nc_6613: bitstring) = m1_6612 in
                                                {8578}new Ns_6614: bitstring;
                                                {8579}new ST_6615: bitstring;
                                                {8580}new TTL_6616: bitstring;
                                                {8581}let m2_6617: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_6614,ST_6615,TTL_6616) in
                                                {8582}event beginSrv(Sess_4722,Cli_4720,Ns_6614);
                                                {8583}out(c, m2_6617);
                                                {8584}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                                {8585}event endSrv(Cli_4720,Sess_4722,Nc_6613)
                                            )
                                            else
                                                {8586}let v_6618: bool = (Disco_4721 = B) in
                                                (
                                                    {8587}if v_6618 then
                                                    (
                                                        {8588}let pkDisco_6619: bitstring = pub(skB) in
                                                        {8589}in(c, (=pkCli_6608,em1_6620: bitstring));
                                                        {8590}let m1_6621: bitstring = em1_6620 in
                                                        {8591}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_6608,Nc_6622: bitstring) = m1_6621 in
                                                        {8592}new Ns_6623: bitstring;
                                                        {8593}new ST_6624: bitstring;
                                                        {8594}new TTL_6625: bitstring;
                                                        {8595}let m2_6626: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_6623,ST_6624,TTL_6625) in
                                                        {8596}event beginSrv(Sess_4722,Cli_4720,Ns_6623);
                                                        {8597}out(c, m2_6626);
                                                        {8598}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                                        {8599}event endSrv(Cli_4720,Sess_4722,Nc_6622)
                                                    )
                                                    else
                                                        {8600}let v_6627: bool = (Disco_4721 = C) in
                                                        (
                                                            {8601}if v_6627 then
                                                            (
                                                                {8602}let pkDisco_6628: bitstring = pub(skC) in
                                                                {8603}in(c, (=pkCli_6608,em1_6629: bitstring));
                                                                {8604}let m1_6630: bitstring = em1_6629 in
                                                                {8605}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_6608,Nc_6631: bitstring) = m1_6630 in
                                                                {8606}new Ns_6632: bitstring;
                                                                {8607}new ST_6633: bitstring;
                                                                {8608}new TTL_6634: bitstring;
                                                                {8609}let m2_6635: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_6632,ST_6633,TTL_6634) in
                                                                {8610}event beginSrv(Sess_4722,Cli_4720,Ns_6632);
                                                                {8611}out(c, m2_6635);
                                                                {8612}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                                                {8613}event endSrv(Cli_4720,Sess_4722,Nc_6631)
                                                            )
                                                            else
                                                                {8614}let pkDisco_6636: bitstring = pub(sk(Disco_4721)) in
                                                                {8615}in(c, (=pkCli_6608,em1_6637: bitstring));
                                                                {8616}let m1_6638: bitstring = em1_6637 in
                                                                {8617}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_6608,Nc_6639: bitstring) = m1_6638 in
                                                                {8618}new Ns_6640: bitstring;
                                                                {8619}new ST_6641: bitstring;
                                                                {8620}new TTL_6642: bitstring;
                                                                {8621}let m2_6643: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_6640,ST_6641,TTL_6642) in
                                                                {8622}event beginSrv(Sess_4722,Cli_4720,Ns_6640);
                                                                {8623}out(c, m2_6643);
                                                                {8624}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                                                {8625}event endSrv(Cli_4720,Sess_4722,Nc_6639)
                                                        )
                                                        else
                                                            {8626}let pkDisco_6644: bitstring = fail-any in
                                                            {8627}in(c, (=pkCli_6608,em1_6645: bitstring));
                                                            {8628}let m1_6646: bitstring = em1_6645 in
                                                            {8629}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_6608,Nc_6647: bitstring) = m1_6646 in
                                                            {8630}new Ns_6648: bitstring;
                                                            {8631}new ST_6649: bitstring;
                                                            {8632}new TTL_6650: bitstring;
                                                            {8633}let m2_6651: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_6648,ST_6649,TTL_6650) in
                                                            {8634}event beginSrv(Sess_4722,Cli_4720,Ns_6648);
                                                            {8635}out(c, m2_6651);
                                                            {8636}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                                            {8637}event endSrv(Cli_4720,Sess_4722,Nc_6647)
                                                )
                                                else
                                                    {8638}let pkDisco_6652: bitstring = fail-any in
                                                    {8639}in(c, (=pkCli_6608,em1_6653: bitstring));
                                                    {8640}let m1_6654: bitstring = em1_6653 in
                                                    {8641}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_6608,Nc_6655: bitstring) = m1_6654 in
                                                    {8642}new Ns_6656: bitstring;
                                                    {8643}new ST_6657: bitstring;
                                                    {8644}new TTL_6658: bitstring;
                                                    {8645}let m2_6659: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_6656,ST_6657,TTL_6658) in
                                                    {8646}event beginSrv(Sess_4722,Cli_4720,Ns_6656);
                                                    {8647}out(c, m2_6659);
                                                    {8648}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                                    {8649}event endSrv(Cli_4720,Sess_4722,Nc_6655)
                                        )
                                        else
                                            {8650}let pkDisco_6660: bitstring = fail-any in
                                            {8651}in(c, (=pkCli_6608,em1_6661: bitstring));
                                            {8652}let m1_6662: bitstring = em1_6661 in
                                            {8653}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_6608,Nc_6663: bitstring) = m1_6662 in
                                            {8654}new Ns_6664: bitstring;
                                            {8655}new ST_6665: bitstring;
                                            {8656}new TTL_6666: bitstring;
                                            {8657}let m2_6667: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_6664,ST_6665,TTL_6666) in
                                            {8658}event beginSrv(Sess_4722,Cli_4720,Ns_6664);
                                            {8659}out(c, m2_6667);
                                            {8660}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                            {8661}event endSrv(Cli_4720,Sess_4722,Nc_6663)
                                )
                                else
                                    {8662}let pkCli_6668: bitstring = fail-any in
                                    {8663}let v_6669: bool = (Disco_4721 = A) in
                                    (
                                        {8664}if v_6669 then
                                        (
                                            {8665}let pkDisco_6670: bitstring = pub(skA) in
                                            {8666}in(c, (=pkCli_6668,em1_6671: bitstring));
                                            {8667}let m1_6672: bitstring = em1_6671 in
                                            {8668}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_6668,Nc_6673: bitstring) = m1_6672 in
                                            {8669}new Ns_6674: bitstring;
                                            {8670}new ST_6675: bitstring;
                                            {8671}new TTL_6676: bitstring;
                                            {8672}let m2_6677: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_6674,ST_6675,TTL_6676) in
                                            {8673}event beginSrv(Sess_4722,Cli_4720,Ns_6674);
                                            {8674}out(c, m2_6677);
                                            {8675}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                            {8676}event endSrv(Cli_4720,Sess_4722,Nc_6673)
                                        )
                                        else
                                            {8677}let v_6678: bool = (Disco_4721 = B) in
                                            (
                                                {8678}if v_6678 then
                                                (
                                                    {8679}let pkDisco_6679: bitstring = pub(skB) in
                                                    {8680}in(c, (=pkCli_6668,em1_6680: bitstring));
                                                    {8681}let m1_6681: bitstring = em1_6680 in
                                                    {8682}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_6668,Nc_6682: bitstring) = m1_6681 in
                                                    {8683}new Ns_6683: bitstring;
                                                    {8684}new ST_6684: bitstring;
                                                    {8685}new TTL_6685: bitstring;
                                                    {8686}let m2_6686: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_6683,ST_6684,TTL_6685) in
                                                    {8687}event beginSrv(Sess_4722,Cli_4720,Ns_6683);
                                                    {8688}out(c, m2_6686);
                                                    {8689}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                                    {8690}event endSrv(Cli_4720,Sess_4722,Nc_6682)
                                                )
                                                else
                                                    {8691}let v_6687: bool = (Disco_4721 = C) in
                                                    (
                                                        {8692}if v_6687 then
                                                        (
                                                            {8693}let pkDisco_6688: bitstring = pub(skC) in
                                                            {8694}in(c, (=pkCli_6668,em1_6689: bitstring));
                                                            {8695}let m1_6690: bitstring = em1_6689 in
                                                            {8696}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_6668,Nc_6691: bitstring) = m1_6690 in
                                                            {8697}new Ns_6692: bitstring;
                                                            {8698}new ST_6693: bitstring;
                                                            {8699}new TTL_6694: bitstring;
                                                            {8700}let m2_6695: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_6692,ST_6693,TTL_6694) in
                                                            {8701}event beginSrv(Sess_4722,Cli_4720,Ns_6692);
                                                            {8702}out(c, m2_6695);
                                                            {8703}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                                            {8704}event endSrv(Cli_4720,Sess_4722,Nc_6691)
                                                        )
                                                        else
                                                            {8705}let pkDisco_6696: bitstring = pub(sk(Disco_4721)) in
                                                            {8706}in(c, (=pkCli_6668,em1_6697: bitstring));
                                                            {8707}let m1_6698: bitstring = em1_6697 in
                                                            {8708}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_6668,Nc_6699: bitstring) = m1_6698 in
                                                            {8709}new Ns_6700: bitstring;
                                                            {8710}new ST_6701: bitstring;
                                                            {8711}new TTL_6702: bitstring;
                                                            {8712}let m2_6703: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_6700,ST_6701,TTL_6702) in
                                                            {8713}event beginSrv(Sess_4722,Cli_4720,Ns_6700);
                                                            {8714}out(c, m2_6703);
                                                            {8715}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                                            {8716}event endSrv(Cli_4720,Sess_4722,Nc_6699)
                                                    )
                                                    else
                                                        {8717}let pkDisco_6704: bitstring = fail-any in
                                                        {8718}in(c, (=pkCli_6668,em1_6705: bitstring));
                                                        {8719}let m1_6706: bitstring = em1_6705 in
                                                        {8720}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_6668,Nc_6707: bitstring) = m1_6706 in
                                                        {8721}new Ns_6708: bitstring;
                                                        {8722}new ST_6709: bitstring;
                                                        {8723}new TTL_6710: bitstring;
                                                        {8724}let m2_6711: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_6708,ST_6709,TTL_6710) in
                                                        {8725}event beginSrv(Sess_4722,Cli_4720,Ns_6708);
                                                        {8726}out(c, m2_6711);
                                                        {8727}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                                        {8728}event endSrv(Cli_4720,Sess_4722,Nc_6707)
                                            )
                                            else
                                                {8729}let pkDisco_6712: bitstring = fail-any in
                                                {8730}in(c, (=pkCli_6668,em1_6713: bitstring));
                                                {8731}let m1_6714: bitstring = em1_6713 in
                                                {8732}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_6668,Nc_6715: bitstring) = m1_6714 in
                                                {8733}new Ns_6716: bitstring;
                                                {8734}new ST_6717: bitstring;
                                                {8735}new TTL_6718: bitstring;
                                                {8736}let m2_6719: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_6716,ST_6717,TTL_6718) in
                                                {8737}event beginSrv(Sess_4722,Cli_4720,Ns_6716);
                                                {8738}out(c, m2_6719);
                                                {8739}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                                {8740}event endSrv(Cli_4720,Sess_4722,Nc_6715)
                                    )
                                    else
                                        {8741}let pkDisco_6720: bitstring = fail-any in
                                        {8742}in(c, (=pkCli_6668,em1_6721: bitstring));
                                        {8743}let m1_6722: bitstring = em1_6721 in
                                        {8744}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_6668,Nc_6723: bitstring) = m1_6722 in
                                        {8745}new Ns_6724: bitstring;
                                        {8746}new ST_6725: bitstring;
                                        {8747}new TTL_6726: bitstring;
                                        {8748}let m2_6727: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_6724,ST_6725,TTL_6726) in
                                        {8749}event beginSrv(Sess_4722,Cli_4720,Ns_6724);
                                        {8750}out(c, m2_6727);
                                        {8751}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                        {8752}event endSrv(Cli_4720,Sess_4722,Nc_6723)
                        )
                        else
                            {8753}let pkCli_6728: bitstring = fail-any in
                            {8754}let v_6729: bool = (Disco_4721 = A) in
                            (
                                {8755}if v_6729 then
                                (
                                    {8756}let pkDisco_6730: bitstring = pub(skA) in
                                    {8757}in(c, (=pkCli_6728,em1_6731: bitstring));
                                    {8758}let m1_6732: bitstring = em1_6731 in
                                    {8759}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_6728,Nc_6733: bitstring) = m1_6732 in
                                    {8760}new Ns_6734: bitstring;
                                    {8761}new ST_6735: bitstring;
                                    {8762}new TTL_6736: bitstring;
                                    {8763}let m2_6737: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_6734,ST_6735,TTL_6736) in
                                    {8764}event beginSrv(Sess_4722,Cli_4720,Ns_6734);
                                    {8765}out(c, m2_6737);
                                    {8766}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                    {8767}event endSrv(Cli_4720,Sess_4722,Nc_6733)
                                )
                                else
                                    {8768}let v_6738: bool = (Disco_4721 = B) in
                                    (
                                        {8769}if v_6738 then
                                        (
                                            {8770}let pkDisco_6739: bitstring = pub(skB) in
                                            {8771}in(c, (=pkCli_6728,em1_6740: bitstring));
                                            {8772}let m1_6741: bitstring = em1_6740 in
                                            {8773}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_6728,Nc_6742: bitstring) = m1_6741 in
                                            {8774}new Ns_6743: bitstring;
                                            {8775}new ST_6744: bitstring;
                                            {8776}new TTL_6745: bitstring;
                                            {8777}let m2_6746: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_6743,ST_6744,TTL_6745) in
                                            {8778}event beginSrv(Sess_4722,Cli_4720,Ns_6743);
                                            {8779}out(c, m2_6746);
                                            {8780}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                            {8781}event endSrv(Cli_4720,Sess_4722,Nc_6742)
                                        )
                                        else
                                            {8782}let v_6747: bool = (Disco_4721 = C) in
                                            (
                                                {8783}if v_6747 then
                                                (
                                                    {8784}let pkDisco_6748: bitstring = pub(skC) in
                                                    {8785}in(c, (=pkCli_6728,em1_6749: bitstring));
                                                    {8786}let m1_6750: bitstring = em1_6749 in
                                                    {8787}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_6728,Nc_6751: bitstring) = m1_6750 in
                                                    {8788}new Ns_6752: bitstring;
                                                    {8789}new ST_6753: bitstring;
                                                    {8790}new TTL_6754: bitstring;
                                                    {8791}let m2_6755: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_6752,ST_6753,TTL_6754) in
                                                    {8792}event beginSrv(Sess_4722,Cli_4720,Ns_6752);
                                                    {8793}out(c, m2_6755);
                                                    {8794}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                                    {8795}event endSrv(Cli_4720,Sess_4722,Nc_6751)
                                                )
                                                else
                                                    {8796}let pkDisco_6756: bitstring = pub(sk(Disco_4721)) in
                                                    {8797}in(c, (=pkCli_6728,em1_6757: bitstring));
                                                    {8798}let m1_6758: bitstring = em1_6757 in
                                                    {8799}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_6728,Nc_6759: bitstring) = m1_6758 in
                                                    {8800}new Ns_6760: bitstring;
                                                    {8801}new ST_6761: bitstring;
                                                    {8802}new TTL_6762: bitstring;
                                                    {8803}let m2_6763: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_6760,ST_6761,TTL_6762) in
                                                    {8804}event beginSrv(Sess_4722,Cli_4720,Ns_6760);
                                                    {8805}out(c, m2_6763);
                                                    {8806}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                                    {8807}event endSrv(Cli_4720,Sess_4722,Nc_6759)
                                            )
                                            else
                                                {8808}let pkDisco_6764: bitstring = fail-any in
                                                {8809}in(c, (=pkCli_6728,em1_6765: bitstring));
                                                {8810}let m1_6766: bitstring = em1_6765 in
                                                {8811}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_6728,Nc_6767: bitstring) = m1_6766 in
                                                {8812}new Ns_6768: bitstring;
                                                {8813}new ST_6769: bitstring;
                                                {8814}new TTL_6770: bitstring;
                                                {8815}let m2_6771: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_6768,ST_6769,TTL_6770) in
                                                {8816}event beginSrv(Sess_4722,Cli_4720,Ns_6768);
                                                {8817}out(c, m2_6771);
                                                {8818}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                                {8819}event endSrv(Cli_4720,Sess_4722,Nc_6767)
                                    )
                                    else
                                        {8820}let pkDisco_6772: bitstring = fail-any in
                                        {8821}in(c, (=pkCli_6728,em1_6773: bitstring));
                                        {8822}let m1_6774: bitstring = em1_6773 in
                                        {8823}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_6728,Nc_6775: bitstring) = m1_6774 in
                                        {8824}new Ns_6776: bitstring;
                                        {8825}new ST_6777: bitstring;
                                        {8826}new TTL_6778: bitstring;
                                        {8827}let m2_6779: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_6776,ST_6777,TTL_6778) in
                                        {8828}event beginSrv(Sess_4722,Cli_4720,Ns_6776);
                                        {8829}out(c, m2_6779);
                                        {8830}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                        {8831}event endSrv(Cli_4720,Sess_4722,Nc_6775)
                            )
                            else
                                {8832}let pkDisco_6780: bitstring = fail-any in
                                {8833}in(c, (=pkCli_6728,em1_6781: bitstring));
                                {8834}let m1_6782: bitstring = em1_6781 in
                                {8835}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_6728,Nc_6783: bitstring) = m1_6782 in
                                {8836}new Ns_6784: bitstring;
                                {8837}new ST_6785: bitstring;
                                {8838}new TTL_6786: bitstring;
                                {8839}let m2_6787: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_6784,ST_6785,TTL_6786) in
                                {8840}event beginSrv(Sess_4722,Cli_4720,Ns_6784);
                                {8841}out(c, m2_6787);
                                {8842}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                {8843}event endSrv(Cli_4720,Sess_4722,Nc_6783)
                )
                else
                    {8844}let pkCli_6788: bitstring = fail-any in
                    {8845}let v_6789: bool = (Disco_4721 = A) in
                    (
                        {8846}if v_6789 then
                        (
                            {8847}let pkDisco_6790: bitstring = pub(skA) in
                            {8848}in(c, (=pkCli_6788,em1_6791: bitstring));
                            {8849}let m1_6792: bitstring = em1_6791 in
                            {8850}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_6788,Nc_6793: bitstring) = m1_6792 in
                            {8851}new Ns_6794: bitstring;
                            {8852}new ST_6795: bitstring;
                            {8853}new TTL_6796: bitstring;
                            {8854}let m2_6797: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_6794,ST_6795,TTL_6796) in
                            {8855}event beginSrv(Sess_4722,Cli_4720,Ns_6794);
                            {8856}out(c, m2_6797);
                            {8857}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                            {8858}event endSrv(Cli_4720,Sess_4722,Nc_6793)
                        )
                        else
                            {8859}let v_6798: bool = (Disco_4721 = B) in
                            (
                                {8860}if v_6798 then
                                (
                                    {8861}let pkDisco_6799: bitstring = pub(skB) in
                                    {8862}in(c, (=pkCli_6788,em1_6800: bitstring));
                                    {8863}let m1_6801: bitstring = em1_6800 in
                                    {8864}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_6788,Nc_6802: bitstring) = m1_6801 in
                                    {8865}new Ns_6803: bitstring;
                                    {8866}new ST_6804: bitstring;
                                    {8867}new TTL_6805: bitstring;
                                    {8868}let m2_6806: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_6803,ST_6804,TTL_6805) in
                                    {8869}event beginSrv(Sess_4722,Cli_4720,Ns_6803);
                                    {8870}out(c, m2_6806);
                                    {8871}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                    {8872}event endSrv(Cli_4720,Sess_4722,Nc_6802)
                                )
                                else
                                    {8873}let v_6807: bool = (Disco_4721 = C) in
                                    (
                                        {8874}if v_6807 then
                                        (
                                            {8875}let pkDisco_6808: bitstring = pub(skC) in
                                            {8876}in(c, (=pkCli_6788,em1_6809: bitstring));
                                            {8877}let m1_6810: bitstring = em1_6809 in
                                            {8878}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_6788,Nc_6811: bitstring) = m1_6810 in
                                            {8879}new Ns_6812: bitstring;
                                            {8880}new ST_6813: bitstring;
                                            {8881}new TTL_6814: bitstring;
                                            {8882}let m2_6815: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_6812,ST_6813,TTL_6814) in
                                            {8883}event beginSrv(Sess_4722,Cli_4720,Ns_6812);
                                            {8884}out(c, m2_6815);
                                            {8885}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                            {8886}event endSrv(Cli_4720,Sess_4722,Nc_6811)
                                        )
                                        else
                                            {8887}let pkDisco_6816: bitstring = pub(sk(Disco_4721)) in
                                            {8888}in(c, (=pkCli_6788,em1_6817: bitstring));
                                            {8889}let m1_6818: bitstring = em1_6817 in
                                            {8890}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_6788,Nc_6819: bitstring) = m1_6818 in
                                            {8891}new Ns_6820: bitstring;
                                            {8892}new ST_6821: bitstring;
                                            {8893}new TTL_6822: bitstring;
                                            {8894}let m2_6823: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_6820,ST_6821,TTL_6822) in
                                            {8895}event beginSrv(Sess_4722,Cli_4720,Ns_6820);
                                            {8896}out(c, m2_6823);
                                            {8897}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                            {8898}event endSrv(Cli_4720,Sess_4722,Nc_6819)
                                    )
                                    else
                                        {8899}let pkDisco_6824: bitstring = fail-any in
                                        {8900}in(c, (=pkCli_6788,em1_6825: bitstring));
                                        {8901}let m1_6826: bitstring = em1_6825 in
                                        {8902}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_6788,Nc_6827: bitstring) = m1_6826 in
                                        {8903}new Ns_6828: bitstring;
                                        {8904}new ST_6829: bitstring;
                                        {8905}new TTL_6830: bitstring;
                                        {8906}let m2_6831: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_6828,ST_6829,TTL_6830) in
                                        {8907}event beginSrv(Sess_4722,Cli_4720,Ns_6828);
                                        {8908}out(c, m2_6831);
                                        {8909}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                        {8910}event endSrv(Cli_4720,Sess_4722,Nc_6827)
                            )
                            else
                                {8911}let pkDisco_6832: bitstring = fail-any in
                                {8912}in(c, (=pkCli_6788,em1_6833: bitstring));
                                {8913}let m1_6834: bitstring = em1_6833 in
                                {8914}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_6788,Nc_6835: bitstring) = m1_6834 in
                                {8915}new Ns_6836: bitstring;
                                {8916}new ST_6837: bitstring;
                                {8917}new TTL_6838: bitstring;
                                {8918}let m2_6839: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_6836,ST_6837,TTL_6838) in
                                {8919}event beginSrv(Sess_4722,Cli_4720,Ns_6836);
                                {8920}out(c, m2_6839);
                                {8921}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                {8922}event endSrv(Cli_4720,Sess_4722,Nc_6835)
                    )
                    else
                        {8923}let pkDisco_6840: bitstring = fail-any in
                        {8924}in(c, (=pkCli_6788,em1_6841: bitstring));
                        {8925}let m1_6842: bitstring = em1_6841 in
                        {8926}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_6788,Nc_6843: bitstring) = m1_6842 in
                        {8927}new Ns_6844: bitstring;
                        {8928}new ST_6845: bitstring;
                        {8929}new TTL_6846: bitstring;
                        {8930}let m2_6847: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_6844,ST_6845,TTL_6846) in
                        {8931}event beginSrv(Sess_4722,Cli_4720,Ns_6844);
                        {8932}out(c, m2_6847);
                        {8933}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                        {8934}event endSrv(Cli_4720,Sess_4722,Nc_6843)
    )
    else
        {8935}let skSess_6848: bitstring = fail-any in
        {8936}let pkSess_6849: bitstring = pub(skSess_6848) in
        {8937}let v_6850: bool = (Cli_4720 = A) in
        (
            {8938}if v_6850 then
            (
                {8939}let pkCli_6851: bitstring = pub(skA) in
                {8940}let v_6852: bool = (Disco_4721 = A) in
                (
                    {8941}if v_6852 then
                    (
                        {8942}let pkDisco_6853: bitstring = pub(skA) in
                        {8943}in(c, (=pkCli_6851,em1_6854: bitstring));
                        {8944}let m1_6855: bitstring = em1_6854 in
                        {8945}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_6851,Nc_6856: bitstring) = m1_6855 in
                        {8946}new Ns_6857: bitstring;
                        {8947}new ST_6858: bitstring;
                        {8948}new TTL_6859: bitstring;
                        {8949}let m2_6860: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_6857,ST_6858,TTL_6859) in
                        {8950}event beginSrv(Sess_4722,Cli_4720,Ns_6857);
                        {8951}out(c, m2_6860);
                        {8952}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                        {8953}event endSrv(Cli_4720,Sess_4722,Nc_6856)
                    )
                    else
                        {8954}let v_6861: bool = (Disco_4721 = B) in
                        (
                            {8955}if v_6861 then
                            (
                                {8956}let pkDisco_6862: bitstring = pub(skB) in
                                {8957}in(c, (=pkCli_6851,em1_6863: bitstring));
                                {8958}let m1_6864: bitstring = em1_6863 in
                                {8959}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_6851,Nc_6865: bitstring) = m1_6864 in
                                {8960}new Ns_6866: bitstring;
                                {8961}new ST_6867: bitstring;
                                {8962}new TTL_6868: bitstring;
                                {8963}let m2_6869: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_6866,ST_6867,TTL_6868) in
                                {8964}event beginSrv(Sess_4722,Cli_4720,Ns_6866);
                                {8965}out(c, m2_6869);
                                {8966}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                {8967}event endSrv(Cli_4720,Sess_4722,Nc_6865)
                            )
                            else
                                {8968}let v_6870: bool = (Disco_4721 = C) in
                                (
                                    {8969}if v_6870 then
                                    (
                                        {8970}let pkDisco_6871: bitstring = pub(skC) in
                                        {8971}in(c, (=pkCli_6851,em1_6872: bitstring));
                                        {8972}let m1_6873: bitstring = em1_6872 in
                                        {8973}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_6851,Nc_6874: bitstring) = m1_6873 in
                                        {8974}new Ns_6875: bitstring;
                                        {8975}new ST_6876: bitstring;
                                        {8976}new TTL_6877: bitstring;
                                        {8977}let m2_6878: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_6875,ST_6876,TTL_6877) in
                                        {8978}event beginSrv(Sess_4722,Cli_4720,Ns_6875);
                                        {8979}out(c, m2_6878);
                                        {8980}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                        {8981}event endSrv(Cli_4720,Sess_4722,Nc_6874)
                                    )
                                    else
                                        {8982}let pkDisco_6879: bitstring = pub(sk(Disco_4721)) in
                                        {8983}in(c, (=pkCli_6851,em1_6880: bitstring));
                                        {8984}let m1_6881: bitstring = em1_6880 in
                                        {8985}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_6851,Nc_6882: bitstring) = m1_6881 in
                                        {8986}new Ns_6883: bitstring;
                                        {8987}new ST_6884: bitstring;
                                        {8988}new TTL_6885: bitstring;
                                        {8989}let m2_6886: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_6883,ST_6884,TTL_6885) in
                                        {8990}event beginSrv(Sess_4722,Cli_4720,Ns_6883);
                                        {8991}out(c, m2_6886);
                                        {8992}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                        {8993}event endSrv(Cli_4720,Sess_4722,Nc_6882)
                                )
                                else
                                    {8994}let pkDisco_6887: bitstring = fail-any in
                                    {8995}in(c, (=pkCli_6851,em1_6888: bitstring));
                                    {8996}let m1_6889: bitstring = em1_6888 in
                                    {8997}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_6851,Nc_6890: bitstring) = m1_6889 in
                                    {8998}new Ns_6891: bitstring;
                                    {8999}new ST_6892: bitstring;
                                    {9000}new TTL_6893: bitstring;
                                    {9001}let m2_6894: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_6891,ST_6892,TTL_6893) in
                                    {9002}event beginSrv(Sess_4722,Cli_4720,Ns_6891);
                                    {9003}out(c, m2_6894);
                                    {9004}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                    {9005}event endSrv(Cli_4720,Sess_4722,Nc_6890)
                        )
                        else
                            {9006}let pkDisco_6895: bitstring = fail-any in
                            {9007}in(c, (=pkCli_6851,em1_6896: bitstring));
                            {9008}let m1_6897: bitstring = em1_6896 in
                            {9009}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_6851,Nc_6898: bitstring) = m1_6897 in
                            {9010}new Ns_6899: bitstring;
                            {9011}new ST_6900: bitstring;
                            {9012}new TTL_6901: bitstring;
                            {9013}let m2_6902: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_6899,ST_6900,TTL_6901) in
                            {9014}event beginSrv(Sess_4722,Cli_4720,Ns_6899);
                            {9015}out(c, m2_6902);
                            {9016}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                            {9017}event endSrv(Cli_4720,Sess_4722,Nc_6898)
                )
                else
                    {9018}let pkDisco_6903: bitstring = fail-any in
                    {9019}in(c, (=pkCli_6851,em1_6904: bitstring));
                    {9020}let m1_6905: bitstring = em1_6904 in
                    {9021}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_6851,Nc_6906: bitstring) = m1_6905 in
                    {9022}new Ns_6907: bitstring;
                    {9023}new ST_6908: bitstring;
                    {9024}new TTL_6909: bitstring;
                    {9025}let m2_6910: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_6907,ST_6908,TTL_6909) in
                    {9026}event beginSrv(Sess_4722,Cli_4720,Ns_6907);
                    {9027}out(c, m2_6910);
                    {9028}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                    {9029}event endSrv(Cli_4720,Sess_4722,Nc_6906)
            )
            else
                {9030}let v_6911: bool = (Cli_4720 = B) in
                (
                    {9031}if v_6911 then
                    (
                        {9032}let pkCli_6912: bitstring = pub(skB) in
                        {9033}let v_6913: bool = (Disco_4721 = A) in
                        (
                            {9034}if v_6913 then
                            (
                                {9035}let pkDisco_6914: bitstring = pub(skA) in
                                {9036}in(c, (=pkCli_6912,em1_6915: bitstring));
                                {9037}let m1_6916: bitstring = em1_6915 in
                                {9038}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_6912,Nc_6917: bitstring) = m1_6916 in
                                {9039}new Ns_6918: bitstring;
                                {9040}new ST_6919: bitstring;
                                {9041}new TTL_6920: bitstring;
                                {9042}let m2_6921: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_6918,ST_6919,TTL_6920) in
                                {9043}event beginSrv(Sess_4722,Cli_4720,Ns_6918);
                                {9044}out(c, m2_6921);
                                {9045}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                {9046}event endSrv(Cli_4720,Sess_4722,Nc_6917)
                            )
                            else
                                {9047}let v_6922: bool = (Disco_4721 = B) in
                                (
                                    {9048}if v_6922 then
                                    (
                                        {9049}let pkDisco_6923: bitstring = pub(skB) in
                                        {9050}in(c, (=pkCli_6912,em1_6924: bitstring));
                                        {9051}let m1_6925: bitstring = em1_6924 in
                                        {9052}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_6912,Nc_6926: bitstring) = m1_6925 in
                                        {9053}new Ns_6927: bitstring;
                                        {9054}new ST_6928: bitstring;
                                        {9055}new TTL_6929: bitstring;
                                        {9056}let m2_6930: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_6927,ST_6928,TTL_6929) in
                                        {9057}event beginSrv(Sess_4722,Cli_4720,Ns_6927);
                                        {9058}out(c, m2_6930);
                                        {9059}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                        {9060}event endSrv(Cli_4720,Sess_4722,Nc_6926)
                                    )
                                    else
                                        {9061}let v_6931: bool = (Disco_4721 = C) in
                                        (
                                            {9062}if v_6931 then
                                            (
                                                {9063}let pkDisco_6932: bitstring = pub(skC) in
                                                {9064}in(c, (=pkCli_6912,em1_6933: bitstring));
                                                {9065}let m1_6934: bitstring = em1_6933 in
                                                {9066}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_6912,Nc_6935: bitstring) = m1_6934 in
                                                {9067}new Ns_6936: bitstring;
                                                {9068}new ST_6937: bitstring;
                                                {9069}new TTL_6938: bitstring;
                                                {9070}let m2_6939: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_6936,ST_6937,TTL_6938) in
                                                {9071}event beginSrv(Sess_4722,Cli_4720,Ns_6936);
                                                {9072}out(c, m2_6939);
                                                {9073}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                                {9074}event endSrv(Cli_4720,Sess_4722,Nc_6935)
                                            )
                                            else
                                                {9075}let pkDisco_6940: bitstring = pub(sk(Disco_4721)) in
                                                {9076}in(c, (=pkCli_6912,em1_6941: bitstring));
                                                {9077}let m1_6942: bitstring = em1_6941 in
                                                {9078}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_6912,Nc_6943: bitstring) = m1_6942 in
                                                {9079}new Ns_6944: bitstring;
                                                {9080}new ST_6945: bitstring;
                                                {9081}new TTL_6946: bitstring;
                                                {9082}let m2_6947: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_6944,ST_6945,TTL_6946) in
                                                {9083}event beginSrv(Sess_4722,Cli_4720,Ns_6944);
                                                {9084}out(c, m2_6947);
                                                {9085}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                                {9086}event endSrv(Cli_4720,Sess_4722,Nc_6943)
                                        )
                                        else
                                            {9087}let pkDisco_6948: bitstring = fail-any in
                                            {9088}in(c, (=pkCli_6912,em1_6949: bitstring));
                                            {9089}let m1_6950: bitstring = em1_6949 in
                                            {9090}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_6912,Nc_6951: bitstring) = m1_6950 in
                                            {9091}new Ns_6952: bitstring;
                                            {9092}new ST_6953: bitstring;
                                            {9093}new TTL_6954: bitstring;
                                            {9094}let m2_6955: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_6952,ST_6953,TTL_6954) in
                                            {9095}event beginSrv(Sess_4722,Cli_4720,Ns_6952);
                                            {9096}out(c, m2_6955);
                                            {9097}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                            {9098}event endSrv(Cli_4720,Sess_4722,Nc_6951)
                                )
                                else
                                    {9099}let pkDisco_6956: bitstring = fail-any in
                                    {9100}in(c, (=pkCli_6912,em1_6957: bitstring));
                                    {9101}let m1_6958: bitstring = em1_6957 in
                                    {9102}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_6912,Nc_6959: bitstring) = m1_6958 in
                                    {9103}new Ns_6960: bitstring;
                                    {9104}new ST_6961: bitstring;
                                    {9105}new TTL_6962: bitstring;
                                    {9106}let m2_6963: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_6960,ST_6961,TTL_6962) in
                                    {9107}event beginSrv(Sess_4722,Cli_4720,Ns_6960);
                                    {9108}out(c, m2_6963);
                                    {9109}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                    {9110}event endSrv(Cli_4720,Sess_4722,Nc_6959)
                        )
                        else
                            {9111}let pkDisco_6964: bitstring = fail-any in
                            {9112}in(c, (=pkCli_6912,em1_6965: bitstring));
                            {9113}let m1_6966: bitstring = em1_6965 in
                            {9114}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_6912,Nc_6967: bitstring) = m1_6966 in
                            {9115}new Ns_6968: bitstring;
                            {9116}new ST_6969: bitstring;
                            {9117}new TTL_6970: bitstring;
                            {9118}let m2_6971: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_6968,ST_6969,TTL_6970) in
                            {9119}event beginSrv(Sess_4722,Cli_4720,Ns_6968);
                            {9120}out(c, m2_6971);
                            {9121}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                            {9122}event endSrv(Cli_4720,Sess_4722,Nc_6967)
                    )
                    else
                        {9123}let v_6972: bool = (Cli_4720 = C) in
                        (
                            {9124}if v_6972 then
                            (
                                {9125}let pkCli_6973: bitstring = pub(skC) in
                                {9126}let v_6974: bool = (Disco_4721 = A) in
                                (
                                    {9127}if v_6974 then
                                    (
                                        {9128}let pkDisco_6975: bitstring = pub(skA) in
                                        {9129}in(c, (=pkCli_6973,em1_6976: bitstring));
                                        {9130}let m1_6977: bitstring = em1_6976 in
                                        {9131}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_6973,Nc_6978: bitstring) = m1_6977 in
                                        {9132}new Ns_6979: bitstring;
                                        {9133}new ST_6980: bitstring;
                                        {9134}new TTL_6981: bitstring;
                                        {9135}let m2_6982: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_6979,ST_6980,TTL_6981) in
                                        {9136}event beginSrv(Sess_4722,Cli_4720,Ns_6979);
                                        {9137}out(c, m2_6982);
                                        {9138}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                        {9139}event endSrv(Cli_4720,Sess_4722,Nc_6978)
                                    )
                                    else
                                        {9140}let v_6983: bool = (Disco_4721 = B) in
                                        (
                                            {9141}if v_6983 then
                                            (
                                                {9142}let pkDisco_6984: bitstring = pub(skB) in
                                                {9143}in(c, (=pkCli_6973,em1_6985: bitstring));
                                                {9144}let m1_6986: bitstring = em1_6985 in
                                                {9145}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_6973,Nc_6987: bitstring) = m1_6986 in
                                                {9146}new Ns_6988: bitstring;
                                                {9147}new ST_6989: bitstring;
                                                {9148}new TTL_6990: bitstring;
                                                {9149}let m2_6991: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_6988,ST_6989,TTL_6990) in
                                                {9150}event beginSrv(Sess_4722,Cli_4720,Ns_6988);
                                                {9151}out(c, m2_6991);
                                                {9152}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                                {9153}event endSrv(Cli_4720,Sess_4722,Nc_6987)
                                            )
                                            else
                                                {9154}let v_6992: bool = (Disco_4721 = C) in
                                                (
                                                    {9155}if v_6992 then
                                                    (
                                                        {9156}let pkDisco_6993: bitstring = pub(skC) in
                                                        {9157}in(c, (=pkCli_6973,em1_6994: bitstring));
                                                        {9158}let m1_6995: bitstring = em1_6994 in
                                                        {9159}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_6973,Nc_6996: bitstring) = m1_6995 in
                                                        {9160}new Ns_6997: bitstring;
                                                        {9161}new ST_6998: bitstring;
                                                        {9162}new TTL_6999: bitstring;
                                                        {9163}let m2_7000: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_6997,ST_6998,TTL_6999) in
                                                        {9164}event beginSrv(Sess_4722,Cli_4720,Ns_6997);
                                                        {9165}out(c, m2_7000);
                                                        {9166}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                                        {9167}event endSrv(Cli_4720,Sess_4722,Nc_6996)
                                                    )
                                                    else
                                                        {9168}let pkDisco_7001: bitstring = pub(sk(Disco_4721)) in
                                                        {9169}in(c, (=pkCli_6973,em1_7002: bitstring));
                                                        {9170}let m1_7003: bitstring = em1_7002 in
                                                        {9171}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_6973,Nc_7004: bitstring) = m1_7003 in
                                                        {9172}new Ns_7005: bitstring;
                                                        {9173}new ST_7006: bitstring;
                                                        {9174}new TTL_7007: bitstring;
                                                        {9175}let m2_7008: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_7005,ST_7006,TTL_7007) in
                                                        {9176}event beginSrv(Sess_4722,Cli_4720,Ns_7005);
                                                        {9177}out(c, m2_7008);
                                                        {9178}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                                        {9179}event endSrv(Cli_4720,Sess_4722,Nc_7004)
                                                )
                                                else
                                                    {9180}let pkDisco_7009: bitstring = fail-any in
                                                    {9181}in(c, (=pkCli_6973,em1_7010: bitstring));
                                                    {9182}let m1_7011: bitstring = em1_7010 in
                                                    {9183}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_6973,Nc_7012: bitstring) = m1_7011 in
                                                    {9184}new Ns_7013: bitstring;
                                                    {9185}new ST_7014: bitstring;
                                                    {9186}new TTL_7015: bitstring;
                                                    {9187}let m2_7016: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_7013,ST_7014,TTL_7015) in
                                                    {9188}event beginSrv(Sess_4722,Cli_4720,Ns_7013);
                                                    {9189}out(c, m2_7016);
                                                    {9190}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                                    {9191}event endSrv(Cli_4720,Sess_4722,Nc_7012)
                                        )
                                        else
                                            {9192}let pkDisco_7017: bitstring = fail-any in
                                            {9193}in(c, (=pkCli_6973,em1_7018: bitstring));
                                            {9194}let m1_7019: bitstring = em1_7018 in
                                            {9195}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_6973,Nc_7020: bitstring) = m1_7019 in
                                            {9196}new Ns_7021: bitstring;
                                            {9197}new ST_7022: bitstring;
                                            {9198}new TTL_7023: bitstring;
                                            {9199}let m2_7024: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_7021,ST_7022,TTL_7023) in
                                            {9200}event beginSrv(Sess_4722,Cli_4720,Ns_7021);
                                            {9201}out(c, m2_7024);
                                            {9202}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                            {9203}event endSrv(Cli_4720,Sess_4722,Nc_7020)
                                )
                                else
                                    {9204}let pkDisco_7025: bitstring = fail-any in
                                    {9205}in(c, (=pkCli_6973,em1_7026: bitstring));
                                    {9206}let m1_7027: bitstring = em1_7026 in
                                    {9207}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_6973,Nc_7028: bitstring) = m1_7027 in
                                    {9208}new Ns_7029: bitstring;
                                    {9209}new ST_7030: bitstring;
                                    {9210}new TTL_7031: bitstring;
                                    {9211}let m2_7032: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_7029,ST_7030,TTL_7031) in
                                    {9212}event beginSrv(Sess_4722,Cli_4720,Ns_7029);
                                    {9213}out(c, m2_7032);
                                    {9214}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                    {9215}event endSrv(Cli_4720,Sess_4722,Nc_7028)
                            )
                            else
                                {9216}let pkCli_7033: bitstring = pub(sk(Cli_4720)) in
                                {9217}let v_7034: bool = (Disco_4721 = A) in
                                (
                                    {9218}if v_7034 then
                                    (
                                        {9219}let pkDisco_7035: bitstring = pub(skA) in
                                        {9220}in(c, (=pkCli_7033,em1_7036: bitstring));
                                        {9221}let m1_7037: bitstring = em1_7036 in
                                        {9222}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_7033,Nc_7038: bitstring) = m1_7037 in
                                        {9223}new Ns_7039: bitstring;
                                        {9224}new ST_7040: bitstring;
                                        {9225}new TTL_7041: bitstring;
                                        {9226}let m2_7042: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_7039,ST_7040,TTL_7041) in
                                        {9227}event beginSrv(Sess_4722,Cli_4720,Ns_7039);
                                        {9228}out(c, m2_7042);
                                        {9229}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                        {9230}event endSrv(Cli_4720,Sess_4722,Nc_7038)
                                    )
                                    else
                                        {9231}let v_7043: bool = (Disco_4721 = B) in
                                        (
                                            {9232}if v_7043 then
                                            (
                                                {9233}let pkDisco_7044: bitstring = pub(skB) in
                                                {9234}in(c, (=pkCli_7033,em1_7045: bitstring));
                                                {9235}let m1_7046: bitstring = em1_7045 in
                                                {9236}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_7033,Nc_7047: bitstring) = m1_7046 in
                                                {9237}new Ns_7048: bitstring;
                                                {9238}new ST_7049: bitstring;
                                                {9239}new TTL_7050: bitstring;
                                                {9240}let m2_7051: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_7048,ST_7049,TTL_7050) in
                                                {9241}event beginSrv(Sess_4722,Cli_4720,Ns_7048);
                                                {9242}out(c, m2_7051);
                                                {9243}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                                {9244}event endSrv(Cli_4720,Sess_4722,Nc_7047)
                                            )
                                            else
                                                {9245}let v_7052: bool = (Disco_4721 = C) in
                                                (
                                                    {9246}if v_7052 then
                                                    (
                                                        {9247}let pkDisco_7053: bitstring = pub(skC) in
                                                        {9248}in(c, (=pkCli_7033,em1_7054: bitstring));
                                                        {9249}let m1_7055: bitstring = em1_7054 in
                                                        {9250}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_7033,Nc_7056: bitstring) = m1_7055 in
                                                        {9251}new Ns_7057: bitstring;
                                                        {9252}new ST_7058: bitstring;
                                                        {9253}new TTL_7059: bitstring;
                                                        {9254}let m2_7060: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_7057,ST_7058,TTL_7059) in
                                                        {9255}event beginSrv(Sess_4722,Cli_4720,Ns_7057);
                                                        {9256}out(c, m2_7060);
                                                        {9257}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                                        {9258}event endSrv(Cli_4720,Sess_4722,Nc_7056)
                                                    )
                                                    else
                                                        {9259}let pkDisco_7061: bitstring = pub(sk(Disco_4721)) in
                                                        {9260}in(c, (=pkCli_7033,em1_7062: bitstring));
                                                        {9261}let m1_7063: bitstring = em1_7062 in
                                                        {9262}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_7033,Nc_7064: bitstring) = m1_7063 in
                                                        {9263}new Ns_7065: bitstring;
                                                        {9264}new ST_7066: bitstring;
                                                        {9265}new TTL_7067: bitstring;
                                                        {9266}let m2_7068: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_7065,ST_7066,TTL_7067) in
                                                        {9267}event beginSrv(Sess_4722,Cli_4720,Ns_7065);
                                                        {9268}out(c, m2_7068);
                                                        {9269}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                                        {9270}event endSrv(Cli_4720,Sess_4722,Nc_7064)
                                                )
                                                else
                                                    {9271}let pkDisco_7069: bitstring = fail-any in
                                                    {9272}in(c, (=pkCli_7033,em1_7070: bitstring));
                                                    {9273}let m1_7071: bitstring = em1_7070 in
                                                    {9274}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_7033,Nc_7072: bitstring) = m1_7071 in
                                                    {9275}new Ns_7073: bitstring;
                                                    {9276}new ST_7074: bitstring;
                                                    {9277}new TTL_7075: bitstring;
                                                    {9278}let m2_7076: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_7073,ST_7074,TTL_7075) in
                                                    {9279}event beginSrv(Sess_4722,Cli_4720,Ns_7073);
                                                    {9280}out(c, m2_7076);
                                                    {9281}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                                    {9282}event endSrv(Cli_4720,Sess_4722,Nc_7072)
                                        )
                                        else
                                            {9283}let pkDisco_7077: bitstring = fail-any in
                                            {9284}in(c, (=pkCli_7033,em1_7078: bitstring));
                                            {9285}let m1_7079: bitstring = em1_7078 in
                                            {9286}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_7033,Nc_7080: bitstring) = m1_7079 in
                                            {9287}new Ns_7081: bitstring;
                                            {9288}new ST_7082: bitstring;
                                            {9289}new TTL_7083: bitstring;
                                            {9290}let m2_7084: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_7081,ST_7082,TTL_7083) in
                                            {9291}event beginSrv(Sess_4722,Cli_4720,Ns_7081);
                                            {9292}out(c, m2_7084);
                                            {9293}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                            {9294}event endSrv(Cli_4720,Sess_4722,Nc_7080)
                                )
                                else
                                    {9295}let pkDisco_7085: bitstring = fail-any in
                                    {9296}in(c, (=pkCli_7033,em1_7086: bitstring));
                                    {9297}let m1_7087: bitstring = em1_7086 in
                                    {9298}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_7033,Nc_7088: bitstring) = m1_7087 in
                                    {9299}new Ns_7089: bitstring;
                                    {9300}new ST_7090: bitstring;
                                    {9301}new TTL_7091: bitstring;
                                    {9302}let m2_7092: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_7089,ST_7090,TTL_7091) in
                                    {9303}event beginSrv(Sess_4722,Cli_4720,Ns_7089);
                                    {9304}out(c, m2_7092);
                                    {9305}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                    {9306}event endSrv(Cli_4720,Sess_4722,Nc_7088)
                        )
                        else
                            {9307}let pkCli_7093: bitstring = fail-any in
                            {9308}let v_7094: bool = (Disco_4721 = A) in
                            (
                                {9309}if v_7094 then
                                (
                                    {9310}let pkDisco_7095: bitstring = pub(skA) in
                                    {9311}in(c, (=pkCli_7093,em1_7096: bitstring));
                                    {9312}let m1_7097: bitstring = em1_7096 in
                                    {9313}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_7093,Nc_7098: bitstring) = m1_7097 in
                                    {9314}new Ns_7099: bitstring;
                                    {9315}new ST_7100: bitstring;
                                    {9316}new TTL_7101: bitstring;
                                    {9317}let m2_7102: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_7099,ST_7100,TTL_7101) in
                                    {9318}event beginSrv(Sess_4722,Cli_4720,Ns_7099);
                                    {9319}out(c, m2_7102);
                                    {9320}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                    {9321}event endSrv(Cli_4720,Sess_4722,Nc_7098)
                                )
                                else
                                    {9322}let v_7103: bool = (Disco_4721 = B) in
                                    (
                                        {9323}if v_7103 then
                                        (
                                            {9324}let pkDisco_7104: bitstring = pub(skB) in
                                            {9325}in(c, (=pkCli_7093,em1_7105: bitstring));
                                            {9326}let m1_7106: bitstring = em1_7105 in
                                            {9327}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_7093,Nc_7107: bitstring) = m1_7106 in
                                            {9328}new Ns_7108: bitstring;
                                            {9329}new ST_7109: bitstring;
                                            {9330}new TTL_7110: bitstring;
                                            {9331}let m2_7111: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_7108,ST_7109,TTL_7110) in
                                            {9332}event beginSrv(Sess_4722,Cli_4720,Ns_7108);
                                            {9333}out(c, m2_7111);
                                            {9334}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                            {9335}event endSrv(Cli_4720,Sess_4722,Nc_7107)
                                        )
                                        else
                                            {9336}let v_7112: bool = (Disco_4721 = C) in
                                            (
                                                {9337}if v_7112 then
                                                (
                                                    {9338}let pkDisco_7113: bitstring = pub(skC) in
                                                    {9339}in(c, (=pkCli_7093,em1_7114: bitstring));
                                                    {9340}let m1_7115: bitstring = em1_7114 in
                                                    {9341}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_7093,Nc_7116: bitstring) = m1_7115 in
                                                    {9342}new Ns_7117: bitstring;
                                                    {9343}new ST_7118: bitstring;
                                                    {9344}new TTL_7119: bitstring;
                                                    {9345}let m2_7120: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_7117,ST_7118,TTL_7119) in
                                                    {9346}event beginSrv(Sess_4722,Cli_4720,Ns_7117);
                                                    {9347}out(c, m2_7120);
                                                    {9348}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                                    {9349}event endSrv(Cli_4720,Sess_4722,Nc_7116)
                                                )
                                                else
                                                    {9350}let pkDisco_7121: bitstring = pub(sk(Disco_4721)) in
                                                    {9351}in(c, (=pkCli_7093,em1_7122: bitstring));
                                                    {9352}let m1_7123: bitstring = em1_7122 in
                                                    {9353}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_7093,Nc_7124: bitstring) = m1_7123 in
                                                    {9354}new Ns_7125: bitstring;
                                                    {9355}new ST_7126: bitstring;
                                                    {9356}new TTL_7127: bitstring;
                                                    {9357}let m2_7128: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_7125,ST_7126,TTL_7127) in
                                                    {9358}event beginSrv(Sess_4722,Cli_4720,Ns_7125);
                                                    {9359}out(c, m2_7128);
                                                    {9360}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                                    {9361}event endSrv(Cli_4720,Sess_4722,Nc_7124)
                                            )
                                            else
                                                {9362}let pkDisco_7129: bitstring = fail-any in
                                                {9363}in(c, (=pkCli_7093,em1_7130: bitstring));
                                                {9364}let m1_7131: bitstring = em1_7130 in
                                                {9365}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_7093,Nc_7132: bitstring) = m1_7131 in
                                                {9366}new Ns_7133: bitstring;
                                                {9367}new ST_7134: bitstring;
                                                {9368}new TTL_7135: bitstring;
                                                {9369}let m2_7136: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_7133,ST_7134,TTL_7135) in
                                                {9370}event beginSrv(Sess_4722,Cli_4720,Ns_7133);
                                                {9371}out(c, m2_7136);
                                                {9372}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                                {9373}event endSrv(Cli_4720,Sess_4722,Nc_7132)
                                    )
                                    else
                                        {9374}let pkDisco_7137: bitstring = fail-any in
                                        {9375}in(c, (=pkCli_7093,em1_7138: bitstring));
                                        {9376}let m1_7139: bitstring = em1_7138 in
                                        {9377}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_7093,Nc_7140: bitstring) = m1_7139 in
                                        {9378}new Ns_7141: bitstring;
                                        {9379}new ST_7142: bitstring;
                                        {9380}new TTL_7143: bitstring;
                                        {9381}let m2_7144: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_7141,ST_7142,TTL_7143) in
                                        {9382}event beginSrv(Sess_4722,Cli_4720,Ns_7141);
                                        {9383}out(c, m2_7144);
                                        {9384}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                        {9385}event endSrv(Cli_4720,Sess_4722,Nc_7140)
                            )
                            else
                                {9386}let pkDisco_7145: bitstring = fail-any in
                                {9387}in(c, (=pkCli_7093,em1_7146: bitstring));
                                {9388}let m1_7147: bitstring = em1_7146 in
                                {9389}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_7093,Nc_7148: bitstring) = m1_7147 in
                                {9390}new Ns_7149: bitstring;
                                {9391}new ST_7150: bitstring;
                                {9392}new TTL_7151: bitstring;
                                {9393}let m2_7152: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_7149,ST_7150,TTL_7151) in
                                {9394}event beginSrv(Sess_4722,Cli_4720,Ns_7149);
                                {9395}out(c, m2_7152);
                                {9396}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                {9397}event endSrv(Cli_4720,Sess_4722,Nc_7148)
                )
                else
                    {9398}let pkCli_7153: bitstring = fail-any in
                    {9399}let v_7154: bool = (Disco_4721 = A) in
                    (
                        {9400}if v_7154 then
                        (
                            {9401}let pkDisco_7155: bitstring = pub(skA) in
                            {9402}in(c, (=pkCli_7153,em1_7156: bitstring));
                            {9403}let m1_7157: bitstring = em1_7156 in
                            {9404}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_7153,Nc_7158: bitstring) = m1_7157 in
                            {9405}new Ns_7159: bitstring;
                            {9406}new ST_7160: bitstring;
                            {9407}new TTL_7161: bitstring;
                            {9408}let m2_7162: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_7159,ST_7160,TTL_7161) in
                            {9409}event beginSrv(Sess_4722,Cli_4720,Ns_7159);
                            {9410}out(c, m2_7162);
                            {9411}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                            {9412}event endSrv(Cli_4720,Sess_4722,Nc_7158)
                        )
                        else
                            {9413}let v_7163: bool = (Disco_4721 = B) in
                            (
                                {9414}if v_7163 then
                                (
                                    {9415}let pkDisco_7164: bitstring = pub(skB) in
                                    {9416}in(c, (=pkCli_7153,em1_7165: bitstring));
                                    {9417}let m1_7166: bitstring = em1_7165 in
                                    {9418}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_7153,Nc_7167: bitstring) = m1_7166 in
                                    {9419}new Ns_7168: bitstring;
                                    {9420}new ST_7169: bitstring;
                                    {9421}new TTL_7170: bitstring;
                                    {9422}let m2_7171: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_7168,ST_7169,TTL_7170) in
                                    {9423}event beginSrv(Sess_4722,Cli_4720,Ns_7168);
                                    {9424}out(c, m2_7171);
                                    {9425}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                    {9426}event endSrv(Cli_4720,Sess_4722,Nc_7167)
                                )
                                else
                                    {9427}let v_7172: bool = (Disco_4721 = C) in
                                    (
                                        {9428}if v_7172 then
                                        (
                                            {9429}let pkDisco_7173: bitstring = pub(skC) in
                                            {9430}in(c, (=pkCli_7153,em1_7174: bitstring));
                                            {9431}let m1_7175: bitstring = em1_7174 in
                                            {9432}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_7153,Nc_7176: bitstring) = m1_7175 in
                                            {9433}new Ns_7177: bitstring;
                                            {9434}new ST_7178: bitstring;
                                            {9435}new TTL_7179: bitstring;
                                            {9436}let m2_7180: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_7177,ST_7178,TTL_7179) in
                                            {9437}event beginSrv(Sess_4722,Cli_4720,Ns_7177);
                                            {9438}out(c, m2_7180);
                                            {9439}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                            {9440}event endSrv(Cli_4720,Sess_4722,Nc_7176)
                                        )
                                        else
                                            {9441}let pkDisco_7181: bitstring = pub(sk(Disco_4721)) in
                                            {9442}in(c, (=pkCli_7153,em1_7182: bitstring));
                                            {9443}let m1_7183: bitstring = em1_7182 in
                                            {9444}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_7153,Nc_7184: bitstring) = m1_7183 in
                                            {9445}new Ns_7185: bitstring;
                                            {9446}new ST_7186: bitstring;
                                            {9447}new TTL_7187: bitstring;
                                            {9448}let m2_7188: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_7185,ST_7186,TTL_7187) in
                                            {9449}event beginSrv(Sess_4722,Cli_4720,Ns_7185);
                                            {9450}out(c, m2_7188);
                                            {9451}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                            {9452}event endSrv(Cli_4720,Sess_4722,Nc_7184)
                                    )
                                    else
                                        {9453}let pkDisco_7189: bitstring = fail-any in
                                        {9454}in(c, (=pkCli_7153,em1_7190: bitstring));
                                        {9455}let m1_7191: bitstring = em1_7190 in
                                        {9456}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_7153,Nc_7192: bitstring) = m1_7191 in
                                        {9457}new Ns_7193: bitstring;
                                        {9458}new ST_7194: bitstring;
                                        {9459}new TTL_7195: bitstring;
                                        {9460}let m2_7196: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_7193,ST_7194,TTL_7195) in
                                        {9461}event beginSrv(Sess_4722,Cli_4720,Ns_7193);
                                        {9462}out(c, m2_7196);
                                        {9463}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                        {9464}event endSrv(Cli_4720,Sess_4722,Nc_7192)
                            )
                            else
                                {9465}let pkDisco_7197: bitstring = fail-any in
                                {9466}in(c, (=pkCli_7153,em1_7198: bitstring));
                                {9467}let m1_7199: bitstring = em1_7198 in
                                {9468}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_7153,Nc_7200: bitstring) = m1_7199 in
                                {9469}new Ns_7201: bitstring;
                                {9470}new ST_7202: bitstring;
                                {9471}new TTL_7203: bitstring;
                                {9472}let m2_7204: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_7201,ST_7202,TTL_7203) in
                                {9473}event beginSrv(Sess_4722,Cli_4720,Ns_7201);
                                {9474}out(c, m2_7204);
                                {9475}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                {9476}event endSrv(Cli_4720,Sess_4722,Nc_7200)
                    )
                    else
                        {9477}let pkDisco_7205: bitstring = fail-any in
                        {9478}in(c, (=pkCli_7153,em1_7206: bitstring));
                        {9479}let m1_7207: bitstring = em1_7206 in
                        {9480}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_7153,Nc_7208: bitstring) = m1_7207 in
                        {9481}new Ns_7209: bitstring;
                        {9482}new ST_7210: bitstring;
                        {9483}new TTL_7211: bitstring;
                        {9484}let m2_7212: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_7209,ST_7210,TTL_7211) in
                        {9485}event beginSrv(Sess_4722,Cli_4720,Ns_7209);
                        {9486}out(c, m2_7212);
                        {9487}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                        {9488}event endSrv(Cli_4720,Sess_4722,Nc_7208)
        )
        else
            {9489}let pkCli_7213: bitstring = fail-any in
            {9490}let v_7214: bool = (Disco_4721 = A) in
            (
                {9491}if v_7214 then
                (
                    {9492}let pkDisco_7215: bitstring = pub(skA) in
                    {9493}in(c, (=pkCli_7213,em1_7216: bitstring));
                    {9494}let m1_7217: bitstring = em1_7216 in
                    {9495}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_7213,Nc_7218: bitstring) = m1_7217 in
                    {9496}new Ns_7219: bitstring;
                    {9497}new ST_7220: bitstring;
                    {9498}new TTL_7221: bitstring;
                    {9499}let m2_7222: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_7219,ST_7220,TTL_7221) in
                    {9500}event beginSrv(Sess_4722,Cli_4720,Ns_7219);
                    {9501}out(c, m2_7222);
                    {9502}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                    {9503}event endSrv(Cli_4720,Sess_4722,Nc_7218)
                )
                else
                    {9504}let v_7223: bool = (Disco_4721 = B) in
                    (
                        {9505}if v_7223 then
                        (
                            {9506}let pkDisco_7224: bitstring = pub(skB) in
                            {9507}in(c, (=pkCli_7213,em1_7225: bitstring));
                            {9508}let m1_7226: bitstring = em1_7225 in
                            {9509}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_7213,Nc_7227: bitstring) = m1_7226 in
                            {9510}new Ns_7228: bitstring;
                            {9511}new ST_7229: bitstring;
                            {9512}new TTL_7230: bitstring;
                            {9513}let m2_7231: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_7228,ST_7229,TTL_7230) in
                            {9514}event beginSrv(Sess_4722,Cli_4720,Ns_7228);
                            {9515}out(c, m2_7231);
                            {9516}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                            {9517}event endSrv(Cli_4720,Sess_4722,Nc_7227)
                        )
                        else
                            {9518}let v_7232: bool = (Disco_4721 = C) in
                            (
                                {9519}if v_7232 then
                                (
                                    {9520}let pkDisco_7233: bitstring = pub(skC) in
                                    {9521}in(c, (=pkCli_7213,em1_7234: bitstring));
                                    {9522}let m1_7235: bitstring = em1_7234 in
                                    {9523}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_7213,Nc_7236: bitstring) = m1_7235 in
                                    {9524}new Ns_7237: bitstring;
                                    {9525}new ST_7238: bitstring;
                                    {9526}new TTL_7239: bitstring;
                                    {9527}let m2_7240: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_7237,ST_7238,TTL_7239) in
                                    {9528}event beginSrv(Sess_4722,Cli_4720,Ns_7237);
                                    {9529}out(c, m2_7240);
                                    {9530}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                    {9531}event endSrv(Cli_4720,Sess_4722,Nc_7236)
                                )
                                else
                                    {9532}let pkDisco_7241: bitstring = pub(sk(Disco_4721)) in
                                    {9533}in(c, (=pkCli_7213,em1_7242: bitstring));
                                    {9534}let m1_7243: bitstring = em1_7242 in
                                    {9535}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_7213,Nc_7244: bitstring) = m1_7243 in
                                    {9536}new Ns_7245: bitstring;
                                    {9537}new ST_7246: bitstring;
                                    {9538}new TTL_7247: bitstring;
                                    {9539}let m2_7248: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_7245,ST_7246,TTL_7247) in
                                    {9540}event beginSrv(Sess_4722,Cli_4720,Ns_7245);
                                    {9541}out(c, m2_7248);
                                    {9542}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                    {9543}event endSrv(Cli_4720,Sess_4722,Nc_7244)
                            )
                            else
                                {9544}let pkDisco_7249: bitstring = fail-any in
                                {9545}in(c, (=pkCli_7213,em1_7250: bitstring));
                                {9546}let m1_7251: bitstring = em1_7250 in
                                {9547}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_7213,Nc_7252: bitstring) = m1_7251 in
                                {9548}new Ns_7253: bitstring;
                                {9549}new ST_7254: bitstring;
                                {9550}new TTL_7255: bitstring;
                                {9551}let m2_7256: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_7253,ST_7254,TTL_7255) in
                                {9552}event beginSrv(Sess_4722,Cli_4720,Ns_7253);
                                {9553}out(c, m2_7256);
                                {9554}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                                {9555}event endSrv(Cli_4720,Sess_4722,Nc_7252)
                    )
                    else
                        {9556}let pkDisco_7257: bitstring = fail-any in
                        {9557}in(c, (=pkCli_7213,em1_7258: bitstring));
                        {9558}let m1_7259: bitstring = em1_7258 in
                        {9559}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_7213,Nc_7260: bitstring) = m1_7259 in
                        {9560}new Ns_7261: bitstring;
                        {9561}new ST_7262: bitstring;
                        {9562}new TTL_7263: bitstring;
                        {9563}let m2_7264: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_7261,ST_7262,TTL_7263) in
                        {9564}event beginSrv(Sess_4722,Cli_4720,Ns_7261);
                        {9565}out(c, m2_7264);
                        {9566}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                        {9567}event endSrv(Cli_4720,Sess_4722,Nc_7260)
            )
            else
                {9568}let pkDisco_7265: bitstring = fail-any in
                {9569}in(c, (=pkCli_7213,em1_7266: bitstring));
                {9570}let m1_7267: bitstring = em1_7266 in
                {9571}let (=OpenSecureChannelRequest,=Sess_4722,=pkCli_7213,Nc_7268: bitstring) = m1_7267 in
                {9572}new Ns_7269: bitstring;
                {9573}new ST_7270: bitstring;
                {9574}new TTL_7271: bitstring;
                {9575}let m2_7272: bitstring = (OpenSecureChannelResponse,Cli_4720,Ns_7269,ST_7270,TTL_7271) in
                {9576}event beginSrv(Sess_4722,Cli_4720,Ns_7269);
                {9577}out(c, m2_7272);
                {9578}if ((Cli_4720 = A) || ((Cli_4720 = B) || (Cli_4720 = C))) then
                {9579}event endSrv(Cli_4720,Sess_4722,Nc_7268)
)

-- Query event(endCli(X,Y,N)) ==> event(beginSrv(X,Y,N))
Completing...
200 rules inserted. The rule base contains 64 rules. 301 rules in the queue.
400 rules inserted. The rule base contains 100 rules. 301 rules in the queue.
600 rules inserted. The rule base contains 100 rules. 299 rules in the queue.
800 rules inserted. The rule base contains 108 rules. 277 rules in the queue.
1000 rules inserted. The rule base contains 76 rules. 273 rules in the queue.
1200 rules inserted. The rule base contains 148 rules. 201 rules in the queue.
1400 rules inserted. The rule base contains 250 rules. 99 rules in the queue.
Starting query event(endCli(X,Y,N)) ==> event(beginSrv(X,Y,N))
goal reachable: attacker(N_35582) -> end(endCli(B[],C[],N_35582))

1. The attacker initially knows B[].
attacker(B[]).

2. The attacker initially knows C[].
attacker(C[]).

3. By 2, the attacker may know C[].
By 1, the attacker may know B[].
By 1, the attacker may know B[].
Using the function 3-tuple the attacker may obtain (C[],B[],B[]).
attacker((C[],B[],B[])).

4. The attacker has some term UP_35611.
attacker(UP_35611).

5. The attacker has some term SP_35610.
attacker(SP_35610).

6. Using the function None the attacker may obtain None.
attacker(None).

7. The message pub(skB[]) may be sent to the attacker at output {4}.
attacker(pub(skB[])).

8. Using the function GetEndpointResponse the attacker may obtain GetEndpointResponse.
attacker(GetEndpointResponse).

9. By 8, the attacker may know GetEndpointResponse.
By 7, the attacker may know pub(skB[]).
By 6, the attacker may know None.
By 5, the attacker may know SP_35610.
By 4, the attacker may know UP_35611.
Using the function 5-tuple the attacker may obtain (GetEndpointResponse,pub(skB[]),None,SP_35610,UP_35611).
attacker((GetEndpointResponse,pub(skB[]),None,SP_35610,UP_35611)).

10. The attacker has some term TTL_35609.
attacker(TTL_35609).

11. The attacker has some term ST_35608.
attacker(ST_35608).

12. We assume as hypothesis that
attacker(N_35615).

13. Using the function OpenSecureChannelResponse the attacker may obtain OpenSecureChannelResponse.
attacker(OpenSecureChannelResponse).

14. By 13, the attacker may know OpenSecureChannelResponse.
By 2, the attacker may know C[].
By 12, the attacker may know N_35615.
By 11, the attacker may know ST_35608.
By 10, the attacker may know TTL_35609.
Using the function 5-tuple the attacker may obtain (OpenSecureChannelResponse,C[],N_35615,ST_35608,TTL_35609).
attacker((OpenSecureChannelResponse,C[],N_35615,ST_35608,TTL_35609)).

15. The message (C[],B[],B[]) that the attacker may have by 3 may be received at input {8}.
The message (GetEndpointResponse,pub(skB[]),None,SP_35610,UP_35611) that the attacker may have by 9 may be received at input {1420}.
The message (OpenSecureChannelResponse,C[],N_35615,ST_35608,TTL_35609) that the attacker may have by 14 may be received at input {1425}.
So event endCli(B[],C[],N_35615) may be executed at {1429}.
end(endCli(B[],C[],N_35615)).


A more detailed output of the traces is available with
  set traceDisplay = long.

out(c, pub(skA)) at {2}

out(c, pub(skB)) at {4}

out(c, pub(skC)) at {6}

in(c, (C,B,B)) at {8} in copy a_35620

out(c, GetEndpointRequest) at {1419} in copy a_35620

in(c, (GetEndpointResponse,pub(skB),None,a_35618,a_35619)) at {1420} in copy a_35620

new Nc_1638 creating Nc_62461 at {1421} in copy a_35620

event(beginCli(C,B,Nc_62461)) at {1423} in copy a_35620

out(c, (pub(skC),(OpenSecureChannelRequest,B,pub(skC),Nc_62461))) at {1424} in copy a_35620

in(c, (OpenSecureChannelResponse,C,a,a_35616,a_35617)) at {1425} in copy a_35620

event(endCli(B,C,a)) at {1429} in copy a_35620

The event endCli(B,C,a) is executed.
A trace has been found.
RESULT event(endCli(X,Y,N)) ==> event(beginSrv(X,Y,N)) is false.
-- Query event(endSrv(X_62491,Y_62492,N_62493)) ==> event(beginCli(X_62491,Y_62492,N_62493))
Completing...
200 rules inserted. The rule base contains 64 rules. 301 rules in the queue.
400 rules inserted. The rule base contains 100 rules. 301 rules in the queue.
600 rules inserted. The rule base contains 100 rules. 299 rules in the queue.
800 rules inserted. The rule base contains 112 rules. 273 rules in the queue.
1000 rules inserted. The rule base contains 78 rules. 271 rules in the queue.
1200 rules inserted. The rule base contains 150 rules. 199 rules in the queue.
1400 rules inserted. The rule base contains 262 rules. 87 rules in the queue.
Starting query event(endSrv(X_62491,Y_62492,N_62493)) ==> event(beginCli(X_62491,Y_62492,N_62493))
goal reachable: attacker(N_89975) -> end(endSrv(B[],C[],N_89975))

1. The attacker initially knows C[].
attacker(C[]).

2. The attacker initially knows B[].
attacker(B[]).

3. By 2, the attacker may know B[].
By 2, the attacker may know B[].
By 1, the attacker may know C[].
Using the function 3-tuple the attacker may obtain (B[],B[],C[]).
attacker((B[],B[],C[])).

4. We assume as hypothesis that
attacker(N_90000).

5. The message pub(skB[]) may be sent to the attacker at output {4}.
attacker(pub(skB[])).

6. Using the function OpenSecureChannelRequest the attacker may obtain OpenSecureChannelRequest.
attacker(OpenSecureChannelRequest).

7. By 6, the attacker may know OpenSecureChannelRequest.
By 1, the attacker may know C[].
By 5, the attacker may know pub(skB[]).
By 4, the attacker may know N_90000.
Using the function 4-tuple the attacker may obtain (OpenSecureChannelRequest,C[],pub(skB[]),N_90000).
attacker((OpenSecureChannelRequest,C[],pub(skB[]),N_90000)).

8. By 5, the attacker may know pub(skB[]).
By 7, the attacker may know (OpenSecureChannelRequest,C[],pub(skB[]),N_90000).
Using the function 2-tuple the attacker may obtain (pub(skB[]),(OpenSecureChannelRequest,C[],pub(skB[]),N_90000)).
attacker((pub(skB[]),(OpenSecureChannelRequest,C[],pub(skB[]),N_90000))).

9. The message (B[],B[],C[]) that the attacker may have by 3 may be received at input {5704}.
The message (pub(skB[]),(OpenSecureChannelRequest,C[],pub(skB[]),N_90000)) that the attacker may have by 8 may be received at input {7115}.
So event endSrv(B[],C[],N_90000) may be executed at {7125}.
end(endSrv(B[],C[],N_90000)).


A more detailed output of the traces is available with
  set traceDisplay = long.

out(c, pub(skA)) at {2}

out(c, pub(skB)) at {4}

out(c, pub(skC)) at {6}

in(c, (B,B,C)) at {5704} in copy a_90002

in(c, (pub(skB),(OpenSecureChannelRequest,C,pub(skB),a_90001))) at {7115} in copy a_90002

new Ns_5652 creating Ns_111985 at {7118} in copy a_90002

new ST_5653 creating ST_111986 at {7119} in copy a_90002

new TTL_5654 creating TTL_111987 at {7120} in copy a_90002

event(beginSrv(C,B,Ns_111985)) at {7122} in copy a_90002

out(c, (OpenSecureChannelResponse,B,Ns_111985,ST_111986,TTL_111987)) at {7123} in copy a_90002

event(endSrv(B,C,a_90001)) at {7125} in copy a_90002

The event endSrv(B,C,a_90001) is executed.
A trace has been found.
RESULT event(endSrv(X_62491,Y_62492,N_62493)) ==> event(beginCli(X_62491,Y_62492,N_62493)) is false.
