Linear part:
exp(exp(g,x_26),y) = exp(exp(g,y),x_26)
Completing equations...
Completed equations:
exp(exp(g,x_26),y) = exp(exp(g,y),x_26)
Convergent part:
dec(enc(x_13,pub(k_14)),k_14) = x_13
Completing equations...
Completed equations:
dec(enc(x_13,pub(k_14)),k_14) = x_13
Process:
{1}let pkA: bitstring = pub(skA) in
{2}out(c, pkA);
{3}let pkB: bitstring = pub(skB) in
{4}out(c, pkB);
{5}let pkC: bitstring = pub(skC) in
{6}out(c, pkC);
(
    {7}!
    {8}in(c, (Cli: host,Disco: host,Sess: host));
    {9}let v_512: bool = (Cli = A) in
    (
        {10}if v_512 then
        (
            {11}let skCli: bitstring = skA in
            {12}let pkCli: bitstring = pub(skCli) in
            {13}let v_513: bool = (Disco = A) in
            (
                {14}if v_513 then
                (
                    {15}let pkDisco: bitstring = pub(skA) in
                    {16}let v_514: bool = (Sess = A) in
                    (
                        {17}if v_514 then
                        (
                            {18}let pkSess: bitstring = pub(skA) in
                            {19}out(c, GetEndpointRequest);
                            {20}in(c, (=GetEndpointResponse,=pkSess,=Sign,SP: bitstring,UP: bitstring));
                            {21}new Nc: bitstring;
                            {22}let m1: bitstring = (OpenSecureChannelRequest,pkCli,Nc) in
                            {23}out(c, (pkCli,m1,sign(h(m1),skCli)));
                            {24}in(c, (em2: bitstring,sigM2: bitstring));
                            {25}let m2: bitstring = em2 in
                            {26}if (verify(h(m2),sigM2,pkSess) <> true) then
                                0
                            else
                                {27}let (=OpenSecureChannelResponse,Ns: bitstring,ST: bitstring,TTL: bitstring) = m2 in
                                {28}let Kcli: bitstring = h((Nc,Ns)) in
                                {29}out(c, senc(mCli(pkCli,pkSess),Kcli))
                        )
                        else
                            {30}let v_515: bool = (Sess = B) in
                            (
                                {31}if v_515 then
                                (
                                    {32}let pkSess_516: bitstring = pub(skB) in
                                    {33}out(c, GetEndpointRequest);
                                    {34}in(c, (=GetEndpointResponse,=pkSess_516,=Sign,SP_517: bitstring,UP_518: bitstring));
                                    {35}new Nc_519: bitstring;
                                    {36}let m1_520: bitstring = (OpenSecureChannelRequest,pkCli,Nc_519) in
                                    {37}out(c, (pkCli,m1_520,sign(h(m1_520),skCli)));
                                    {38}in(c, (em2_521: bitstring,sigM2_522: bitstring));
                                    {39}let m2_523: bitstring = em2_521 in
                                    {40}if (verify(h(m2_523),sigM2_522,pkSess_516) <> true) then
                                        0
                                    else
                                        {41}let (=OpenSecureChannelResponse,Ns_524: bitstring,ST_525: bitstring,TTL_526: bitstring) = m2_523 in
                                        {42}let Kcli_527: bitstring = h((Nc_519,Ns_524)) in
                                        {43}out(c, senc(mCli(pkCli,pkSess_516),Kcli_527))
                                )
                                else
                                    {44}let v_528: bool = (Sess = C) in
                                    (
                                        {45}if v_528 then
                                        (
                                            {46}let pkSess_529: bitstring = pub(skC) in
                                            {47}out(c, GetEndpointRequest);
                                            {48}in(c, (=GetEndpointResponse,=pkSess_529,=Sign,SP_530: bitstring,UP_531: bitstring));
                                            {49}new Nc_532: bitstring;
                                            {50}let m1_533: bitstring = (OpenSecureChannelRequest,pkCli,Nc_532) in
                                            {51}out(c, (pkCli,m1_533,sign(h(m1_533),skCli)));
                                            {52}in(c, (em2_534: bitstring,sigM2_535: bitstring));
                                            {53}let m2_536: bitstring = em2_534 in
                                            {54}if (verify(h(m2_536),sigM2_535,pkSess_529) <> true) then
                                                0
                                            else
                                                {55}let (=OpenSecureChannelResponse,Ns_537: bitstring,ST_538: bitstring,TTL_539: bitstring) = m2_536 in
                                                {56}let Kcli_540: bitstring = h((Nc_532,Ns_537)) in
                                                {57}out(c, senc(mCli(pkCli,pkSess_529),Kcli_540))
                                        )
                                        else
                                            {58}let pkSess_541: bitstring = pub(sk(Sess)) in
                                            {59}out(c, GetEndpointRequest);
                                            {60}in(c, (=GetEndpointResponse,=pkSess_541,=Sign,SP_542: bitstring,UP_543: bitstring));
                                            {61}new Nc_544: bitstring;
                                            {62}let m1_545: bitstring = (OpenSecureChannelRequest,pkCli,Nc_544) in
                                            {63}out(c, (pkCli,m1_545,sign(h(m1_545),skCli)));
                                            {64}in(c, (em2_546: bitstring,sigM2_547: bitstring));
                                            {65}let m2_548: bitstring = em2_546 in
                                            {66}if (verify(h(m2_548),sigM2_547,pkSess_541) <> true) then
                                                0
                                            else
                                                {67}let (=OpenSecureChannelResponse,Ns_549: bitstring,ST_550: bitstring,TTL_551: bitstring) = m2_548 in
                                                {68}let Kcli_552: bitstring = h((Nc_544,Ns_549)) in
                                                {69}out(c, senc(mCli(pkCli,pkSess_541),Kcli_552))
                                    )
                                    else
                                        {70}let pkSess_553: bitstring = fail-any in
                                        {71}out(c, GetEndpointRequest);
                                        {72}in(c, (=GetEndpointResponse,=pkSess_553,=Sign,SP_554: bitstring,UP_555: bitstring));
                                        {73}new Nc_556: bitstring;
                                        {74}let m1_557: bitstring = (OpenSecureChannelRequest,pkCli,Nc_556) in
                                        {75}out(c, (pkCli,m1_557,sign(h(m1_557),skCli)));
                                        {76}in(c, (em2_558: bitstring,sigM2_559: bitstring));
                                        {77}let m2_560: bitstring = em2_558 in
                                        {78}if (verify(h(m2_560),sigM2_559,pkSess_553) <> true) then
                                            0
                                        else
                                            {79}let (=OpenSecureChannelResponse,Ns_561: bitstring,ST_562: bitstring,TTL_563: bitstring) = m2_560 in
                                            {80}let Kcli_564: bitstring = h((Nc_556,Ns_561)) in
                                            {81}out(c, senc(mCli(pkCli,pkSess_553),Kcli_564))
                            )
                            else
                                {82}let pkSess_565: bitstring = fail-any in
                                {83}out(c, GetEndpointRequest);
                                {84}in(c, (=GetEndpointResponse,=pkSess_565,=Sign,SP_566: bitstring,UP_567: bitstring));
                                {85}new Nc_568: bitstring;
                                {86}let m1_569: bitstring = (OpenSecureChannelRequest,pkCli,Nc_568) in
                                {87}out(c, (pkCli,m1_569,sign(h(m1_569),skCli)));
                                {88}in(c, (em2_570: bitstring,sigM2_571: bitstring));
                                {89}let m2_572: bitstring = em2_570 in
                                {90}if (verify(h(m2_572),sigM2_571,pkSess_565) <> true) then
                                    0
                                else
                                    {91}let (=OpenSecureChannelResponse,Ns_573: bitstring,ST_574: bitstring,TTL_575: bitstring) = m2_572 in
                                    {92}let Kcli_576: bitstring = h((Nc_568,Ns_573)) in
                                    {93}out(c, senc(mCli(pkCli,pkSess_565),Kcli_576))
                    )
                    else
                        {94}let pkSess_577: bitstring = fail-any in
                        {95}out(c, GetEndpointRequest);
                        {96}in(c, (=GetEndpointResponse,=pkSess_577,=Sign,SP_578: bitstring,UP_579: bitstring));
                        {97}new Nc_580: bitstring;
                        {98}let m1_581: bitstring = (OpenSecureChannelRequest,pkCli,Nc_580) in
                        {99}out(c, (pkCli,m1_581,sign(h(m1_581),skCli)));
                        {100}in(c, (em2_582: bitstring,sigM2_583: bitstring));
                        {101}let m2_584: bitstring = em2_582 in
                        {102}if (verify(h(m2_584),sigM2_583,pkSess_577) <> true) then
                            0
                        else
                            {103}let (=OpenSecureChannelResponse,Ns_585: bitstring,ST_586: bitstring,TTL_587: bitstring) = m2_584 in
                            {104}let Kcli_588: bitstring = h((Nc_580,Ns_585)) in
                            {105}out(c, senc(mCli(pkCli,pkSess_577),Kcli_588))
                )
                else
                    {106}let v_589: bool = (Disco = B) in
                    (
                        {107}if v_589 then
                        (
                            {108}let pkDisco_590: bitstring = pub(skB) in
                            {109}let v_591: bool = (Sess = A) in
                            (
                                {110}if v_591 then
                                (
                                    {111}let pkSess_592: bitstring = pub(skA) in
                                    {112}out(c, GetEndpointRequest);
                                    {113}in(c, (=GetEndpointResponse,=pkSess_592,=Sign,SP_593: bitstring,UP_594: bitstring));
                                    {114}new Nc_595: bitstring;
                                    {115}let m1_596: bitstring = (OpenSecureChannelRequest,pkCli,Nc_595) in
                                    {116}out(c, (pkCli,m1_596,sign(h(m1_596),skCli)));
                                    {117}in(c, (em2_597: bitstring,sigM2_598: bitstring));
                                    {118}let m2_599: bitstring = em2_597 in
                                    {119}if (verify(h(m2_599),sigM2_598,pkSess_592) <> true) then
                                        0
                                    else
                                        {120}let (=OpenSecureChannelResponse,Ns_600: bitstring,ST_601: bitstring,TTL_602: bitstring) = m2_599 in
                                        {121}let Kcli_603: bitstring = h((Nc_595,Ns_600)) in
                                        {122}out(c, senc(mCli(pkCli,pkSess_592),Kcli_603))
                                )
                                else
                                    {123}let v_604: bool = (Sess = B) in
                                    (
                                        {124}if v_604 then
                                        (
                                            {125}let pkSess_605: bitstring = pub(skB) in
                                            {126}out(c, GetEndpointRequest);
                                            {127}in(c, (=GetEndpointResponse,=pkSess_605,=Sign,SP_606: bitstring,UP_607: bitstring));
                                            {128}new Nc_608: bitstring;
                                            {129}let m1_609: bitstring = (OpenSecureChannelRequest,pkCli,Nc_608) in
                                            {130}out(c, (pkCli,m1_609,sign(h(m1_609),skCli)));
                                            {131}in(c, (em2_610: bitstring,sigM2_611: bitstring));
                                            {132}let m2_612: bitstring = em2_610 in
                                            {133}if (verify(h(m2_612),sigM2_611,pkSess_605) <> true) then
                                                0
                                            else
                                                {134}let (=OpenSecureChannelResponse,Ns_613: bitstring,ST_614: bitstring,TTL_615: bitstring) = m2_612 in
                                                {135}let Kcli_616: bitstring = h((Nc_608,Ns_613)) in
                                                {136}out(c, senc(mCli(pkCli,pkSess_605),Kcli_616))
                                        )
                                        else
                                            {137}let v_617: bool = (Sess = C) in
                                            (
                                                {138}if v_617 then
                                                (
                                                    {139}let pkSess_618: bitstring = pub(skC) in
                                                    {140}out(c, GetEndpointRequest);
                                                    {141}in(c, (=GetEndpointResponse,=pkSess_618,=Sign,SP_619: bitstring,UP_620: bitstring));
                                                    {142}new Nc_621: bitstring;
                                                    {143}let m1_622: bitstring = (OpenSecureChannelRequest,pkCli,Nc_621) in
                                                    {144}out(c, (pkCli,m1_622,sign(h(m1_622),skCli)));
                                                    {145}in(c, (em2_623: bitstring,sigM2_624: bitstring));
                                                    {146}let m2_625: bitstring = em2_623 in
                                                    {147}if (verify(h(m2_625),sigM2_624,pkSess_618) <> true) then
                                                        0
                                                    else
                                                        {148}let (=OpenSecureChannelResponse,Ns_626: bitstring,ST_627: bitstring,TTL_628: bitstring) = m2_625 in
                                                        {149}let Kcli_629: bitstring = h((Nc_621,Ns_626)) in
                                                        {150}out(c, senc(mCli(pkCli,pkSess_618),Kcli_629))
                                                )
                                                else
                                                    {151}let pkSess_630: bitstring = pub(sk(Sess)) in
                                                    {152}out(c, GetEndpointRequest);
                                                    {153}in(c, (=GetEndpointResponse,=pkSess_630,=Sign,SP_631: bitstring,UP_632: bitstring));
                                                    {154}new Nc_633: bitstring;
                                                    {155}let m1_634: bitstring = (OpenSecureChannelRequest,pkCli,Nc_633) in
                                                    {156}out(c, (pkCli,m1_634,sign(h(m1_634),skCli)));
                                                    {157}in(c, (em2_635: bitstring,sigM2_636: bitstring));
                                                    {158}let m2_637: bitstring = em2_635 in
                                                    {159}if (verify(h(m2_637),sigM2_636,pkSess_630) <> true) then
                                                        0
                                                    else
                                                        {160}let (=OpenSecureChannelResponse,Ns_638: bitstring,ST_639: bitstring,TTL_640: bitstring) = m2_637 in
                                                        {161}let Kcli_641: bitstring = h((Nc_633,Ns_638)) in
                                                        {162}out(c, senc(mCli(pkCli,pkSess_630),Kcli_641))
                                            )
                                            else
                                                {163}let pkSess_642: bitstring = fail-any in
                                                {164}out(c, GetEndpointRequest);
                                                {165}in(c, (=GetEndpointResponse,=pkSess_642,=Sign,SP_643: bitstring,UP_644: bitstring));
                                                {166}new Nc_645: bitstring;
                                                {167}let m1_646: bitstring = (OpenSecureChannelRequest,pkCli,Nc_645) in
                                                {168}out(c, (pkCli,m1_646,sign(h(m1_646),skCli)));
                                                {169}in(c, (em2_647: bitstring,sigM2_648: bitstring));
                                                {170}let m2_649: bitstring = em2_647 in
                                                {171}if (verify(h(m2_649),sigM2_648,pkSess_642) <> true) then
                                                    0
                                                else
                                                    {172}let (=OpenSecureChannelResponse,Ns_650: bitstring,ST_651: bitstring,TTL_652: bitstring) = m2_649 in
                                                    {173}let Kcli_653: bitstring = h((Nc_645,Ns_650)) in
                                                    {174}out(c, senc(mCli(pkCli,pkSess_642),Kcli_653))
                                    )
                                    else
                                        {175}let pkSess_654: bitstring = fail-any in
                                        {176}out(c, GetEndpointRequest);
                                        {177}in(c, (=GetEndpointResponse,=pkSess_654,=Sign,SP_655: bitstring,UP_656: bitstring));
                                        {178}new Nc_657: bitstring;
                                        {179}let m1_658: bitstring = (OpenSecureChannelRequest,pkCli,Nc_657) in
                                        {180}out(c, (pkCli,m1_658,sign(h(m1_658),skCli)));
                                        {181}in(c, (em2_659: bitstring,sigM2_660: bitstring));
                                        {182}let m2_661: bitstring = em2_659 in
                                        {183}if (verify(h(m2_661),sigM2_660,pkSess_654) <> true) then
                                            0
                                        else
                                            {184}let (=OpenSecureChannelResponse,Ns_662: bitstring,ST_663: bitstring,TTL_664: bitstring) = m2_661 in
                                            {185}let Kcli_665: bitstring = h((Nc_657,Ns_662)) in
                                            {186}out(c, senc(mCli(pkCli,pkSess_654),Kcli_665))
                            )
                            else
                                {187}let pkSess_666: bitstring = fail-any in
                                {188}out(c, GetEndpointRequest);
                                {189}in(c, (=GetEndpointResponse,=pkSess_666,=Sign,SP_667: bitstring,UP_668: bitstring));
                                {190}new Nc_669: bitstring;
                                {191}let m1_670: bitstring = (OpenSecureChannelRequest,pkCli,Nc_669) in
                                {192}out(c, (pkCli,m1_670,sign(h(m1_670),skCli)));
                                {193}in(c, (em2_671: bitstring,sigM2_672: bitstring));
                                {194}let m2_673: bitstring = em2_671 in
                                {195}if (verify(h(m2_673),sigM2_672,pkSess_666) <> true) then
                                    0
                                else
                                    {196}let (=OpenSecureChannelResponse,Ns_674: bitstring,ST_675: bitstring,TTL_676: bitstring) = m2_673 in
                                    {197}let Kcli_677: bitstring = h((Nc_669,Ns_674)) in
                                    {198}out(c, senc(mCli(pkCli,pkSess_666),Kcli_677))
                        )
                        else
                            {199}let v_678: bool = (Disco = C) in
                            (
                                {200}if v_678 then
                                (
                                    {201}let pkDisco_679: bitstring = pub(skC) in
                                    {202}let v_680: bool = (Sess = A) in
                                    (
                                        {203}if v_680 then
                                        (
                                            {204}let pkSess_681: bitstring = pub(skA) in
                                            {205}out(c, GetEndpointRequest);
                                            {206}in(c, (=GetEndpointResponse,=pkSess_681,=Sign,SP_682: bitstring,UP_683: bitstring));
                                            {207}new Nc_684: bitstring;
                                            {208}let m1_685: bitstring = (OpenSecureChannelRequest,pkCli,Nc_684) in
                                            {209}out(c, (pkCli,m1_685,sign(h(m1_685),skCli)));
                                            {210}in(c, (em2_686: bitstring,sigM2_687: bitstring));
                                            {211}let m2_688: bitstring = em2_686 in
                                            {212}if (verify(h(m2_688),sigM2_687,pkSess_681) <> true) then
                                                0
                                            else
                                                {213}let (=OpenSecureChannelResponse,Ns_689: bitstring,ST_690: bitstring,TTL_691: bitstring) = m2_688 in
                                                {214}let Kcli_692: bitstring = h((Nc_684,Ns_689)) in
                                                {215}out(c, senc(mCli(pkCli,pkSess_681),Kcli_692))
                                        )
                                        else
                                            {216}let v_693: bool = (Sess = B) in
                                            (
                                                {217}if v_693 then
                                                (
                                                    {218}let pkSess_694: bitstring = pub(skB) in
                                                    {219}out(c, GetEndpointRequest);
                                                    {220}in(c, (=GetEndpointResponse,=pkSess_694,=Sign,SP_695: bitstring,UP_696: bitstring));
                                                    {221}new Nc_697: bitstring;
                                                    {222}let m1_698: bitstring = (OpenSecureChannelRequest,pkCli,Nc_697) in
                                                    {223}out(c, (pkCli,m1_698,sign(h(m1_698),skCli)));
                                                    {224}in(c, (em2_699: bitstring,sigM2_700: bitstring));
                                                    {225}let m2_701: bitstring = em2_699 in
                                                    {226}if (verify(h(m2_701),sigM2_700,pkSess_694) <> true) then
                                                        0
                                                    else
                                                        {227}let (=OpenSecureChannelResponse,Ns_702: bitstring,ST_703: bitstring,TTL_704: bitstring) = m2_701 in
                                                        {228}let Kcli_705: bitstring = h((Nc_697,Ns_702)) in
                                                        {229}out(c, senc(mCli(pkCli,pkSess_694),Kcli_705))
                                                )
                                                else
                                                    {230}let v_706: bool = (Sess = C) in
                                                    (
                                                        {231}if v_706 then
                                                        (
                                                            {232}let pkSess_707: bitstring = pub(skC) in
                                                            {233}out(c, GetEndpointRequest);
                                                            {234}in(c, (=GetEndpointResponse,=pkSess_707,=Sign,SP_708: bitstring,UP_709: bitstring));
                                                            {235}new Nc_710: bitstring;
                                                            {236}let m1_711: bitstring = (OpenSecureChannelRequest,pkCli,Nc_710) in
                                                            {237}out(c, (pkCli,m1_711,sign(h(m1_711),skCli)));
                                                            {238}in(c, (em2_712: bitstring,sigM2_713: bitstring));
                                                            {239}let m2_714: bitstring = em2_712 in
                                                            {240}if (verify(h(m2_714),sigM2_713,pkSess_707) <> true) then
                                                                0
                                                            else
                                                                {241}let (=OpenSecureChannelResponse,Ns_715: bitstring,ST_716: bitstring,TTL_717: bitstring) = m2_714 in
                                                                {242}let Kcli_718: bitstring = h((Nc_710,Ns_715)) in
                                                                {243}out(c, senc(mCli(pkCli,pkSess_707),Kcli_718))
                                                        )
                                                        else
                                                            {244}let pkSess_719: bitstring = pub(sk(Sess)) in
                                                            {245}out(c, GetEndpointRequest);
                                                            {246}in(c, (=GetEndpointResponse,=pkSess_719,=Sign,SP_720: bitstring,UP_721: bitstring));
                                                            {247}new Nc_722: bitstring;
                                                            {248}let m1_723: bitstring = (OpenSecureChannelRequest,pkCli,Nc_722) in
                                                            {249}out(c, (pkCli,m1_723,sign(h(m1_723),skCli)));
                                                            {250}in(c, (em2_724: bitstring,sigM2_725: bitstring));
                                                            {251}let m2_726: bitstring = em2_724 in
                                                            {252}if (verify(h(m2_726),sigM2_725,pkSess_719) <> true) then
                                                                0
                                                            else
                                                                {253}let (=OpenSecureChannelResponse,Ns_727: bitstring,ST_728: bitstring,TTL_729: bitstring) = m2_726 in
                                                                {254}let Kcli_730: bitstring = h((Nc_722,Ns_727)) in
                                                                {255}out(c, senc(mCli(pkCli,pkSess_719),Kcli_730))
                                                    )
                                                    else
                                                        {256}let pkSess_731: bitstring = fail-any in
                                                        {257}out(c, GetEndpointRequest);
                                                        {258}in(c, (=GetEndpointResponse,=pkSess_731,=Sign,SP_732: bitstring,UP_733: bitstring));
                                                        {259}new Nc_734: bitstring;
                                                        {260}let m1_735: bitstring = (OpenSecureChannelRequest,pkCli,Nc_734) in
                                                        {261}out(c, (pkCli,m1_735,sign(h(m1_735),skCli)));
                                                        {262}in(c, (em2_736: bitstring,sigM2_737: bitstring));
                                                        {263}let m2_738: bitstring = em2_736 in
                                                        {264}if (verify(h(m2_738),sigM2_737,pkSess_731) <> true) then
                                                            0
                                                        else
                                                            {265}let (=OpenSecureChannelResponse,Ns_739: bitstring,ST_740: bitstring,TTL_741: bitstring) = m2_738 in
                                                            {266}let Kcli_742: bitstring = h((Nc_734,Ns_739)) in
                                                            {267}out(c, senc(mCli(pkCli,pkSess_731),Kcli_742))
                                            )
                                            else
                                                {268}let pkSess_743: bitstring = fail-any in
                                                {269}out(c, GetEndpointRequest);
                                                {270}in(c, (=GetEndpointResponse,=pkSess_743,=Sign,SP_744: bitstring,UP_745: bitstring));
                                                {271}new Nc_746: bitstring;
                                                {272}let m1_747: bitstring = (OpenSecureChannelRequest,pkCli,Nc_746) in
                                                {273}out(c, (pkCli,m1_747,sign(h(m1_747),skCli)));
                                                {274}in(c, (em2_748: bitstring,sigM2_749: bitstring));
                                                {275}let m2_750: bitstring = em2_748 in
                                                {276}if (verify(h(m2_750),sigM2_749,pkSess_743) <> true) then
                                                    0
                                                else
                                                    {277}let (=OpenSecureChannelResponse,Ns_751: bitstring,ST_752: bitstring,TTL_753: bitstring) = m2_750 in
                                                    {278}let Kcli_754: bitstring = h((Nc_746,Ns_751)) in
                                                    {279}out(c, senc(mCli(pkCli,pkSess_743),Kcli_754))
                                    )
                                    else
                                        {280}let pkSess_755: bitstring = fail-any in
                                        {281}out(c, GetEndpointRequest);
                                        {282}in(c, (=GetEndpointResponse,=pkSess_755,=Sign,SP_756: bitstring,UP_757: bitstring));
                                        {283}new Nc_758: bitstring;
                                        {284}let m1_759: bitstring = (OpenSecureChannelRequest,pkCli,Nc_758) in
                                        {285}out(c, (pkCli,m1_759,sign(h(m1_759),skCli)));
                                        {286}in(c, (em2_760: bitstring,sigM2_761: bitstring));
                                        {287}let m2_762: bitstring = em2_760 in
                                        {288}if (verify(h(m2_762),sigM2_761,pkSess_755) <> true) then
                                            0
                                        else
                                            {289}let (=OpenSecureChannelResponse,Ns_763: bitstring,ST_764: bitstring,TTL_765: bitstring) = m2_762 in
                                            {290}let Kcli_766: bitstring = h((Nc_758,Ns_763)) in
                                            {291}out(c, senc(mCli(pkCli,pkSess_755),Kcli_766))
                                )
                                else
                                    {292}let pkDisco_767: bitstring = pub(sk(Disco)) in
                                    {293}let v_768: bool = (Sess = A) in
                                    (
                                        {294}if v_768 then
                                        (
                                            {295}let pkSess_769: bitstring = pub(skA) in
                                            {296}out(c, GetEndpointRequest);
                                            {297}in(c, (=GetEndpointResponse,=pkSess_769,=Sign,SP_770: bitstring,UP_771: bitstring));
                                            {298}new Nc_772: bitstring;
                                            {299}let m1_773: bitstring = (OpenSecureChannelRequest,pkCli,Nc_772) in
                                            {300}out(c, (pkCli,m1_773,sign(h(m1_773),skCli)));
                                            {301}in(c, (em2_774: bitstring,sigM2_775: bitstring));
                                            {302}let m2_776: bitstring = em2_774 in
                                            {303}if (verify(h(m2_776),sigM2_775,pkSess_769) <> true) then
                                                0
                                            else
                                                {304}let (=OpenSecureChannelResponse,Ns_777: bitstring,ST_778: bitstring,TTL_779: bitstring) = m2_776 in
                                                {305}let Kcli_780: bitstring = h((Nc_772,Ns_777)) in
                                                {306}out(c, senc(mCli(pkCli,pkSess_769),Kcli_780))
                                        )
                                        else
                                            {307}let v_781: bool = (Sess = B) in
                                            (
                                                {308}if v_781 then
                                                (
                                                    {309}let pkSess_782: bitstring = pub(skB) in
                                                    {310}out(c, GetEndpointRequest);
                                                    {311}in(c, (=GetEndpointResponse,=pkSess_782,=Sign,SP_783: bitstring,UP_784: bitstring));
                                                    {312}new Nc_785: bitstring;
                                                    {313}let m1_786: bitstring = (OpenSecureChannelRequest,pkCli,Nc_785) in
                                                    {314}out(c, (pkCli,m1_786,sign(h(m1_786),skCli)));
                                                    {315}in(c, (em2_787: bitstring,sigM2_788: bitstring));
                                                    {316}let m2_789: bitstring = em2_787 in
                                                    {317}if (verify(h(m2_789),sigM2_788,pkSess_782) <> true) then
                                                        0
                                                    else
                                                        {318}let (=OpenSecureChannelResponse,Ns_790: bitstring,ST_791: bitstring,TTL_792: bitstring) = m2_789 in
                                                        {319}let Kcli_793: bitstring = h((Nc_785,Ns_790)) in
                                                        {320}out(c, senc(mCli(pkCli,pkSess_782),Kcli_793))
                                                )
                                                else
                                                    {321}let v_794: bool = (Sess = C) in
                                                    (
                                                        {322}if v_794 then
                                                        (
                                                            {323}let pkSess_795: bitstring = pub(skC) in
                                                            {324}out(c, GetEndpointRequest);
                                                            {325}in(c, (=GetEndpointResponse,=pkSess_795,=Sign,SP_796: bitstring,UP_797: bitstring));
                                                            {326}new Nc_798: bitstring;
                                                            {327}let m1_799: bitstring = (OpenSecureChannelRequest,pkCli,Nc_798) in
                                                            {328}out(c, (pkCli,m1_799,sign(h(m1_799),skCli)));
                                                            {329}in(c, (em2_800: bitstring,sigM2_801: bitstring));
                                                            {330}let m2_802: bitstring = em2_800 in
                                                            {331}if (verify(h(m2_802),sigM2_801,pkSess_795) <> true) then
                                                                0
                                                            else
                                                                {332}let (=OpenSecureChannelResponse,Ns_803: bitstring,ST_804: bitstring,TTL_805: bitstring) = m2_802 in
                                                                {333}let Kcli_806: bitstring = h((Nc_798,Ns_803)) in
                                                                {334}out(c, senc(mCli(pkCli,pkSess_795),Kcli_806))
                                                        )
                                                        else
                                                            {335}let pkSess_807: bitstring = pub(sk(Sess)) in
                                                            {336}out(c, GetEndpointRequest);
                                                            {337}in(c, (=GetEndpointResponse,=pkSess_807,=Sign,SP_808: bitstring,UP_809: bitstring));
                                                            {338}new Nc_810: bitstring;
                                                            {339}let m1_811: bitstring = (OpenSecureChannelRequest,pkCli,Nc_810) in
                                                            {340}out(c, (pkCli,m1_811,sign(h(m1_811),skCli)));
                                                            {341}in(c, (em2_812: bitstring,sigM2_813: bitstring));
                                                            {342}let m2_814: bitstring = em2_812 in
                                                            {343}if (verify(h(m2_814),sigM2_813,pkSess_807) <> true) then
                                                                0
                                                            else
                                                                {344}let (=OpenSecureChannelResponse,Ns_815: bitstring,ST_816: bitstring,TTL_817: bitstring) = m2_814 in
                                                                {345}let Kcli_818: bitstring = h((Nc_810,Ns_815)) in
                                                                {346}out(c, senc(mCli(pkCli,pkSess_807),Kcli_818))
                                                    )
                                                    else
                                                        {347}let pkSess_819: bitstring = fail-any in
                                                        {348}out(c, GetEndpointRequest);
                                                        {349}in(c, (=GetEndpointResponse,=pkSess_819,=Sign,SP_820: bitstring,UP_821: bitstring));
                                                        {350}new Nc_822: bitstring;
                                                        {351}let m1_823: bitstring = (OpenSecureChannelRequest,pkCli,Nc_822) in
                                                        {352}out(c, (pkCli,m1_823,sign(h(m1_823),skCli)));
                                                        {353}in(c, (em2_824: bitstring,sigM2_825: bitstring));
                                                        {354}let m2_826: bitstring = em2_824 in
                                                        {355}if (verify(h(m2_826),sigM2_825,pkSess_819) <> true) then
                                                            0
                                                        else
                                                            {356}let (=OpenSecureChannelResponse,Ns_827: bitstring,ST_828: bitstring,TTL_829: bitstring) = m2_826 in
                                                            {357}let Kcli_830: bitstring = h((Nc_822,Ns_827)) in
                                                            {358}out(c, senc(mCli(pkCli,pkSess_819),Kcli_830))
                                            )
                                            else
                                                {359}let pkSess_831: bitstring = fail-any in
                                                {360}out(c, GetEndpointRequest);
                                                {361}in(c, (=GetEndpointResponse,=pkSess_831,=Sign,SP_832: bitstring,UP_833: bitstring));
                                                {362}new Nc_834: bitstring;
                                                {363}let m1_835: bitstring = (OpenSecureChannelRequest,pkCli,Nc_834) in
                                                {364}out(c, (pkCli,m1_835,sign(h(m1_835),skCli)));
                                                {365}in(c, (em2_836: bitstring,sigM2_837: bitstring));
                                                {366}let m2_838: bitstring = em2_836 in
                                                {367}if (verify(h(m2_838),sigM2_837,pkSess_831) <> true) then
                                                    0
                                                else
                                                    {368}let (=OpenSecureChannelResponse,Ns_839: bitstring,ST_840: bitstring,TTL_841: bitstring) = m2_838 in
                                                    {369}let Kcli_842: bitstring = h((Nc_834,Ns_839)) in
                                                    {370}out(c, senc(mCli(pkCli,pkSess_831),Kcli_842))
                                    )
                                    else
                                        {371}let pkSess_843: bitstring = fail-any in
                                        {372}out(c, GetEndpointRequest);
                                        {373}in(c, (=GetEndpointResponse,=pkSess_843,=Sign,SP_844: bitstring,UP_845: bitstring));
                                        {374}new Nc_846: bitstring;
                                        {375}let m1_847: bitstring = (OpenSecureChannelRequest,pkCli,Nc_846) in
                                        {376}out(c, (pkCli,m1_847,sign(h(m1_847),skCli)));
                                        {377}in(c, (em2_848: bitstring,sigM2_849: bitstring));
                                        {378}let m2_850: bitstring = em2_848 in
                                        {379}if (verify(h(m2_850),sigM2_849,pkSess_843) <> true) then
                                            0
                                        else
                                            {380}let (=OpenSecureChannelResponse,Ns_851: bitstring,ST_852: bitstring,TTL_853: bitstring) = m2_850 in
                                            {381}let Kcli_854: bitstring = h((Nc_846,Ns_851)) in
                                            {382}out(c, senc(mCli(pkCli,pkSess_843),Kcli_854))
                            )
                            else
                                {383}let pkDisco_855: bitstring = fail-any in
                                {384}let v_856: bool = (Sess = A) in
                                (
                                    {385}if v_856 then
                                    (
                                        {386}let pkSess_857: bitstring = pub(skA) in
                                        {387}out(c, GetEndpointRequest);
                                        {388}in(c, (=GetEndpointResponse,=pkSess_857,=Sign,SP_858: bitstring,UP_859: bitstring));
                                        {389}new Nc_860: bitstring;
                                        {390}let m1_861: bitstring = (OpenSecureChannelRequest,pkCli,Nc_860) in
                                        {391}out(c, (pkCli,m1_861,sign(h(m1_861),skCli)));
                                        {392}in(c, (em2_862: bitstring,sigM2_863: bitstring));
                                        {393}let m2_864: bitstring = em2_862 in
                                        {394}if (verify(h(m2_864),sigM2_863,pkSess_857) <> true) then
                                            0
                                        else
                                            {395}let (=OpenSecureChannelResponse,Ns_865: bitstring,ST_866: bitstring,TTL_867: bitstring) = m2_864 in
                                            {396}let Kcli_868: bitstring = h((Nc_860,Ns_865)) in
                                            {397}out(c, senc(mCli(pkCli,pkSess_857),Kcli_868))
                                    )
                                    else
                                        {398}let v_869: bool = (Sess = B) in
                                        (
                                            {399}if v_869 then
                                            (
                                                {400}let pkSess_870: bitstring = pub(skB) in
                                                {401}out(c, GetEndpointRequest);
                                                {402}in(c, (=GetEndpointResponse,=pkSess_870,=Sign,SP_871: bitstring,UP_872: bitstring));
                                                {403}new Nc_873: bitstring;
                                                {404}let m1_874: bitstring = (OpenSecureChannelRequest,pkCli,Nc_873) in
                                                {405}out(c, (pkCli,m1_874,sign(h(m1_874),skCli)));
                                                {406}in(c, (em2_875: bitstring,sigM2_876: bitstring));
                                                {407}let m2_877: bitstring = em2_875 in
                                                {408}if (verify(h(m2_877),sigM2_876,pkSess_870) <> true) then
                                                    0
                                                else
                                                    {409}let (=OpenSecureChannelResponse,Ns_878: bitstring,ST_879: bitstring,TTL_880: bitstring) = m2_877 in
                                                    {410}let Kcli_881: bitstring = h((Nc_873,Ns_878)) in
                                                    {411}out(c, senc(mCli(pkCli,pkSess_870),Kcli_881))
                                            )
                                            else
                                                {412}let v_882: bool = (Sess = C) in
                                                (
                                                    {413}if v_882 then
                                                    (
                                                        {414}let pkSess_883: bitstring = pub(skC) in
                                                        {415}out(c, GetEndpointRequest);
                                                        {416}in(c, (=GetEndpointResponse,=pkSess_883,=Sign,SP_884: bitstring,UP_885: bitstring));
                                                        {417}new Nc_886: bitstring;
                                                        {418}let m1_887: bitstring = (OpenSecureChannelRequest,pkCli,Nc_886) in
                                                        {419}out(c, (pkCli,m1_887,sign(h(m1_887),skCli)));
                                                        {420}in(c, (em2_888: bitstring,sigM2_889: bitstring));
                                                        {421}let m2_890: bitstring = em2_888 in
                                                        {422}if (verify(h(m2_890),sigM2_889,pkSess_883) <> true) then
                                                            0
                                                        else
                                                            {423}let (=OpenSecureChannelResponse,Ns_891: bitstring,ST_892: bitstring,TTL_893: bitstring) = m2_890 in
                                                            {424}let Kcli_894: bitstring = h((Nc_886,Ns_891)) in
                                                            {425}out(c, senc(mCli(pkCli,pkSess_883),Kcli_894))
                                                    )
                                                    else
                                                        {426}let pkSess_895: bitstring = pub(sk(Sess)) in
                                                        {427}out(c, GetEndpointRequest);
                                                        {428}in(c, (=GetEndpointResponse,=pkSess_895,=Sign,SP_896: bitstring,UP_897: bitstring));
                                                        {429}new Nc_898: bitstring;
                                                        {430}let m1_899: bitstring = (OpenSecureChannelRequest,pkCli,Nc_898) in
                                                        {431}out(c, (pkCli,m1_899,sign(h(m1_899),skCli)));
                                                        {432}in(c, (em2_900: bitstring,sigM2_901: bitstring));
                                                        {433}let m2_902: bitstring = em2_900 in
                                                        {434}if (verify(h(m2_902),sigM2_901,pkSess_895) <> true) then
                                                            0
                                                        else
                                                            {435}let (=OpenSecureChannelResponse,Ns_903: bitstring,ST_904: bitstring,TTL_905: bitstring) = m2_902 in
                                                            {436}let Kcli_906: bitstring = h((Nc_898,Ns_903)) in
                                                            {437}out(c, senc(mCli(pkCli,pkSess_895),Kcli_906))
                                                )
                                                else
                                                    {438}let pkSess_907: bitstring = fail-any in
                                                    {439}out(c, GetEndpointRequest);
                                                    {440}in(c, (=GetEndpointResponse,=pkSess_907,=Sign,SP_908: bitstring,UP_909: bitstring));
                                                    {441}new Nc_910: bitstring;
                                                    {442}let m1_911: bitstring = (OpenSecureChannelRequest,pkCli,Nc_910) in
                                                    {443}out(c, (pkCli,m1_911,sign(h(m1_911),skCli)));
                                                    {444}in(c, (em2_912: bitstring,sigM2_913: bitstring));
                                                    {445}let m2_914: bitstring = em2_912 in
                                                    {446}if (verify(h(m2_914),sigM2_913,pkSess_907) <> true) then
                                                        0
                                                    else
                                                        {447}let (=OpenSecureChannelResponse,Ns_915: bitstring,ST_916: bitstring,TTL_917: bitstring) = m2_914 in
                                                        {448}let Kcli_918: bitstring = h((Nc_910,Ns_915)) in
                                                        {449}out(c, senc(mCli(pkCli,pkSess_907),Kcli_918))
                                        )
                                        else
                                            {450}let pkSess_919: bitstring = fail-any in
                                            {451}out(c, GetEndpointRequest);
                                            {452}in(c, (=GetEndpointResponse,=pkSess_919,=Sign,SP_920: bitstring,UP_921: bitstring));
                                            {453}new Nc_922: bitstring;
                                            {454}let m1_923: bitstring = (OpenSecureChannelRequest,pkCli,Nc_922) in
                                            {455}out(c, (pkCli,m1_923,sign(h(m1_923),skCli)));
                                            {456}in(c, (em2_924: bitstring,sigM2_925: bitstring));
                                            {457}let m2_926: bitstring = em2_924 in
                                            {458}if (verify(h(m2_926),sigM2_925,pkSess_919) <> true) then
                                                0
                                            else
                                                {459}let (=OpenSecureChannelResponse,Ns_927: bitstring,ST_928: bitstring,TTL_929: bitstring) = m2_926 in
                                                {460}let Kcli_930: bitstring = h((Nc_922,Ns_927)) in
                                                {461}out(c, senc(mCli(pkCli,pkSess_919),Kcli_930))
                                )
                                else
                                    {462}let pkSess_931: bitstring = fail-any in
                                    {463}out(c, GetEndpointRequest);
                                    {464}in(c, (=GetEndpointResponse,=pkSess_931,=Sign,SP_932: bitstring,UP_933: bitstring));
                                    {465}new Nc_934: bitstring;
                                    {466}let m1_935: bitstring = (OpenSecureChannelRequest,pkCli,Nc_934) in
                                    {467}out(c, (pkCli,m1_935,sign(h(m1_935),skCli)));
                                    {468}in(c, (em2_936: bitstring,sigM2_937: bitstring));
                                    {469}let m2_938: bitstring = em2_936 in
                                    {470}if (verify(h(m2_938),sigM2_937,pkSess_931) <> true) then
                                        0
                                    else
                                        {471}let (=OpenSecureChannelResponse,Ns_939: bitstring,ST_940: bitstring,TTL_941: bitstring) = m2_938 in
                                        {472}let Kcli_942: bitstring = h((Nc_934,Ns_939)) in
                                        {473}out(c, senc(mCli(pkCli,pkSess_931),Kcli_942))
                    )
                    else
                        {474}let pkDisco_943: bitstring = fail-any in
                        {475}let v_944: bool = (Sess = A) in
                        (
                            {476}if v_944 then
                            (
                                {477}let pkSess_945: bitstring = pub(skA) in
                                {478}out(c, GetEndpointRequest);
                                {479}in(c, (=GetEndpointResponse,=pkSess_945,=Sign,SP_946: bitstring,UP_947: bitstring));
                                {480}new Nc_948: bitstring;
                                {481}let m1_949: bitstring = (OpenSecureChannelRequest,pkCli,Nc_948) in
                                {482}out(c, (pkCli,m1_949,sign(h(m1_949),skCli)));
                                {483}in(c, (em2_950: bitstring,sigM2_951: bitstring));
                                {484}let m2_952: bitstring = em2_950 in
                                {485}if (verify(h(m2_952),sigM2_951,pkSess_945) <> true) then
                                    0
                                else
                                    {486}let (=OpenSecureChannelResponse,Ns_953: bitstring,ST_954: bitstring,TTL_955: bitstring) = m2_952 in
                                    {487}let Kcli_956: bitstring = h((Nc_948,Ns_953)) in
                                    {488}out(c, senc(mCli(pkCli,pkSess_945),Kcli_956))
                            )
                            else
                                {489}let v_957: bool = (Sess = B) in
                                (
                                    {490}if v_957 then
                                    (
                                        {491}let pkSess_958: bitstring = pub(skB) in
                                        {492}out(c, GetEndpointRequest);
                                        {493}in(c, (=GetEndpointResponse,=pkSess_958,=Sign,SP_959: bitstring,UP_960: bitstring));
                                        {494}new Nc_961: bitstring;
                                        {495}let m1_962: bitstring = (OpenSecureChannelRequest,pkCli,Nc_961) in
                                        {496}out(c, (pkCli,m1_962,sign(h(m1_962),skCli)));
                                        {497}in(c, (em2_963: bitstring,sigM2_964: bitstring));
                                        {498}let m2_965: bitstring = em2_963 in
                                        {499}if (verify(h(m2_965),sigM2_964,pkSess_958) <> true) then
                                            0
                                        else
                                            {500}let (=OpenSecureChannelResponse,Ns_966: bitstring,ST_967: bitstring,TTL_968: bitstring) = m2_965 in
                                            {501}let Kcli_969: bitstring = h((Nc_961,Ns_966)) in
                                            {502}out(c, senc(mCli(pkCli,pkSess_958),Kcli_969))
                                    )
                                    else
                                        {503}let v_970: bool = (Sess = C) in
                                        (
                                            {504}if v_970 then
                                            (
                                                {505}let pkSess_971: bitstring = pub(skC) in
                                                {506}out(c, GetEndpointRequest);
                                                {507}in(c, (=GetEndpointResponse,=pkSess_971,=Sign,SP_972: bitstring,UP_973: bitstring));
                                                {508}new Nc_974: bitstring;
                                                {509}let m1_975: bitstring = (OpenSecureChannelRequest,pkCli,Nc_974) in
                                                {510}out(c, (pkCli,m1_975,sign(h(m1_975),skCli)));
                                                {511}in(c, (em2_976: bitstring,sigM2_977: bitstring));
                                                {512}let m2_978: bitstring = em2_976 in
                                                {513}if (verify(h(m2_978),sigM2_977,pkSess_971) <> true) then
                                                    0
                                                else
                                                    {514}let (=OpenSecureChannelResponse,Ns_979: bitstring,ST_980: bitstring,TTL_981: bitstring) = m2_978 in
                                                    {515}let Kcli_982: bitstring = h((Nc_974,Ns_979)) in
                                                    {516}out(c, senc(mCli(pkCli,pkSess_971),Kcli_982))
                                            )
                                            else
                                                {517}let pkSess_983: bitstring = pub(sk(Sess)) in
                                                {518}out(c, GetEndpointRequest);
                                                {519}in(c, (=GetEndpointResponse,=pkSess_983,=Sign,SP_984: bitstring,UP_985: bitstring));
                                                {520}new Nc_986: bitstring;
                                                {521}let m1_987: bitstring = (OpenSecureChannelRequest,pkCli,Nc_986) in
                                                {522}out(c, (pkCli,m1_987,sign(h(m1_987),skCli)));
                                                {523}in(c, (em2_988: bitstring,sigM2_989: bitstring));
                                                {524}let m2_990: bitstring = em2_988 in
                                                {525}if (verify(h(m2_990),sigM2_989,pkSess_983) <> true) then
                                                    0
                                                else
                                                    {526}let (=OpenSecureChannelResponse,Ns_991: bitstring,ST_992: bitstring,TTL_993: bitstring) = m2_990 in
                                                    {527}let Kcli_994: bitstring = h((Nc_986,Ns_991)) in
                                                    {528}out(c, senc(mCli(pkCli,pkSess_983),Kcli_994))
                                        )
                                        else
                                            {529}let pkSess_995: bitstring = fail-any in
                                            {530}out(c, GetEndpointRequest);
                                            {531}in(c, (=GetEndpointResponse,=pkSess_995,=Sign,SP_996: bitstring,UP_997: bitstring));
                                            {532}new Nc_998: bitstring;
                                            {533}let m1_999: bitstring = (OpenSecureChannelRequest,pkCli,Nc_998) in
                                            {534}out(c, (pkCli,m1_999,sign(h(m1_999),skCli)));
                                            {535}in(c, (em2_1000: bitstring,sigM2_1001: bitstring));
                                            {536}let m2_1002: bitstring = em2_1000 in
                                            {537}if (verify(h(m2_1002),sigM2_1001,pkSess_995) <> true) then
                                                0
                                            else
                                                {538}let (=OpenSecureChannelResponse,Ns_1003: bitstring,ST_1004: bitstring,TTL_1005: bitstring) = m2_1002 in
                                                {539}let Kcli_1006: bitstring = h((Nc_998,Ns_1003)) in
                                                {540}out(c, senc(mCli(pkCli,pkSess_995),Kcli_1006))
                                )
                                else
                                    {541}let pkSess_1007: bitstring = fail-any in
                                    {542}out(c, GetEndpointRequest);
                                    {543}in(c, (=GetEndpointResponse,=pkSess_1007,=Sign,SP_1008: bitstring,UP_1009: bitstring));
                                    {544}new Nc_1010: bitstring;
                                    {545}let m1_1011: bitstring = (OpenSecureChannelRequest,pkCli,Nc_1010) in
                                    {546}out(c, (pkCli,m1_1011,sign(h(m1_1011),skCli)));
                                    {547}in(c, (em2_1012: bitstring,sigM2_1013: bitstring));
                                    {548}let m2_1014: bitstring = em2_1012 in
                                    {549}if (verify(h(m2_1014),sigM2_1013,pkSess_1007) <> true) then
                                        0
                                    else
                                        {550}let (=OpenSecureChannelResponse,Ns_1015: bitstring,ST_1016: bitstring,TTL_1017: bitstring) = m2_1014 in
                                        {551}let Kcli_1018: bitstring = h((Nc_1010,Ns_1015)) in
                                        {552}out(c, senc(mCli(pkCli,pkSess_1007),Kcli_1018))
                        )
                        else
                            {553}let pkSess_1019: bitstring = fail-any in
                            {554}out(c, GetEndpointRequest);
                            {555}in(c, (=GetEndpointResponse,=pkSess_1019,=Sign,SP_1020: bitstring,UP_1021: bitstring));
                            {556}new Nc_1022: bitstring;
                            {557}let m1_1023: bitstring = (OpenSecureChannelRequest,pkCli,Nc_1022) in
                            {558}out(c, (pkCli,m1_1023,sign(h(m1_1023),skCli)));
                            {559}in(c, (em2_1024: bitstring,sigM2_1025: bitstring));
                            {560}let m2_1026: bitstring = em2_1024 in
                            {561}if (verify(h(m2_1026),sigM2_1025,pkSess_1019) <> true) then
                                0
                            else
                                {562}let (=OpenSecureChannelResponse,Ns_1027: bitstring,ST_1028: bitstring,TTL_1029: bitstring) = m2_1026 in
                                {563}let Kcli_1030: bitstring = h((Nc_1022,Ns_1027)) in
                                {564}out(c, senc(mCli(pkCli,pkSess_1019),Kcli_1030))
            )
            else
                {565}let pkDisco_1031: bitstring = fail-any in
                {566}let v_1032: bool = (Sess = A) in
                (
                    {567}if v_1032 then
                    (
                        {568}let pkSess_1033: bitstring = pub(skA) in
                        {569}out(c, GetEndpointRequest);
                        {570}in(c, (=GetEndpointResponse,=pkSess_1033,=Sign,SP_1034: bitstring,UP_1035: bitstring));
                        {571}new Nc_1036: bitstring;
                        {572}let m1_1037: bitstring = (OpenSecureChannelRequest,pkCli,Nc_1036) in
                        {573}out(c, (pkCli,m1_1037,sign(h(m1_1037),skCli)));
                        {574}in(c, (em2_1038: bitstring,sigM2_1039: bitstring));
                        {575}let m2_1040: bitstring = em2_1038 in
                        {576}if (verify(h(m2_1040),sigM2_1039,pkSess_1033) <> true) then
                            0
                        else
                            {577}let (=OpenSecureChannelResponse,Ns_1041: bitstring,ST_1042: bitstring,TTL_1043: bitstring) = m2_1040 in
                            {578}let Kcli_1044: bitstring = h((Nc_1036,Ns_1041)) in
                            {579}out(c, senc(mCli(pkCli,pkSess_1033),Kcli_1044))
                    )
                    else
                        {580}let v_1045: bool = (Sess = B) in
                        (
                            {581}if v_1045 then
                            (
                                {582}let pkSess_1046: bitstring = pub(skB) in
                                {583}out(c, GetEndpointRequest);
                                {584}in(c, (=GetEndpointResponse,=pkSess_1046,=Sign,SP_1047: bitstring,UP_1048: bitstring));
                                {585}new Nc_1049: bitstring;
                                {586}let m1_1050: bitstring = (OpenSecureChannelRequest,pkCli,Nc_1049) in
                                {587}out(c, (pkCli,m1_1050,sign(h(m1_1050),skCli)));
                                {588}in(c, (em2_1051: bitstring,sigM2_1052: bitstring));
                                {589}let m2_1053: bitstring = em2_1051 in
                                {590}if (verify(h(m2_1053),sigM2_1052,pkSess_1046) <> true) then
                                    0
                                else
                                    {591}let (=OpenSecureChannelResponse,Ns_1054: bitstring,ST_1055: bitstring,TTL_1056: bitstring) = m2_1053 in
                                    {592}let Kcli_1057: bitstring = h((Nc_1049,Ns_1054)) in
                                    {593}out(c, senc(mCli(pkCli,pkSess_1046),Kcli_1057))
                            )
                            else
                                {594}let v_1058: bool = (Sess = C) in
                                (
                                    {595}if v_1058 then
                                    (
                                        {596}let pkSess_1059: bitstring = pub(skC) in
                                        {597}out(c, GetEndpointRequest);
                                        {598}in(c, (=GetEndpointResponse,=pkSess_1059,=Sign,SP_1060: bitstring,UP_1061: bitstring));
                                        {599}new Nc_1062: bitstring;
                                        {600}let m1_1063: bitstring = (OpenSecureChannelRequest,pkCli,Nc_1062) in
                                        {601}out(c, (pkCli,m1_1063,sign(h(m1_1063),skCli)));
                                        {602}in(c, (em2_1064: bitstring,sigM2_1065: bitstring));
                                        {603}let m2_1066: bitstring = em2_1064 in
                                        {604}if (verify(h(m2_1066),sigM2_1065,pkSess_1059) <> true) then
                                            0
                                        else
                                            {605}let (=OpenSecureChannelResponse,Ns_1067: bitstring,ST_1068: bitstring,TTL_1069: bitstring) = m2_1066 in
                                            {606}let Kcli_1070: bitstring = h((Nc_1062,Ns_1067)) in
                                            {607}out(c, senc(mCli(pkCli,pkSess_1059),Kcli_1070))
                                    )
                                    else
                                        {608}let pkSess_1071: bitstring = pub(sk(Sess)) in
                                        {609}out(c, GetEndpointRequest);
                                        {610}in(c, (=GetEndpointResponse,=pkSess_1071,=Sign,SP_1072: bitstring,UP_1073: bitstring));
                                        {611}new Nc_1074: bitstring;
                                        {612}let m1_1075: bitstring = (OpenSecureChannelRequest,pkCli,Nc_1074) in
                                        {613}out(c, (pkCli,m1_1075,sign(h(m1_1075),skCli)));
                                        {614}in(c, (em2_1076: bitstring,sigM2_1077: bitstring));
                                        {615}let m2_1078: bitstring = em2_1076 in
                                        {616}if (verify(h(m2_1078),sigM2_1077,pkSess_1071) <> true) then
                                            0
                                        else
                                            {617}let (=OpenSecureChannelResponse,Ns_1079: bitstring,ST_1080: bitstring,TTL_1081: bitstring) = m2_1078 in
                                            {618}let Kcli_1082: bitstring = h((Nc_1074,Ns_1079)) in
                                            {619}out(c, senc(mCli(pkCli,pkSess_1071),Kcli_1082))
                                )
                                else
                                    {620}let pkSess_1083: bitstring = fail-any in
                                    {621}out(c, GetEndpointRequest);
                                    {622}in(c, (=GetEndpointResponse,=pkSess_1083,=Sign,SP_1084: bitstring,UP_1085: bitstring));
                                    {623}new Nc_1086: bitstring;
                                    {624}let m1_1087: bitstring = (OpenSecureChannelRequest,pkCli,Nc_1086) in
                                    {625}out(c, (pkCli,m1_1087,sign(h(m1_1087),skCli)));
                                    {626}in(c, (em2_1088: bitstring,sigM2_1089: bitstring));
                                    {627}let m2_1090: bitstring = em2_1088 in
                                    {628}if (verify(h(m2_1090),sigM2_1089,pkSess_1083) <> true) then
                                        0
                                    else
                                        {629}let (=OpenSecureChannelResponse,Ns_1091: bitstring,ST_1092: bitstring,TTL_1093: bitstring) = m2_1090 in
                                        {630}let Kcli_1094: bitstring = h((Nc_1086,Ns_1091)) in
                                        {631}out(c, senc(mCli(pkCli,pkSess_1083),Kcli_1094))
                        )
                        else
                            {632}let pkSess_1095: bitstring = fail-any in
                            {633}out(c, GetEndpointRequest);
                            {634}in(c, (=GetEndpointResponse,=pkSess_1095,=Sign,SP_1096: bitstring,UP_1097: bitstring));
                            {635}new Nc_1098: bitstring;
                            {636}let m1_1099: bitstring = (OpenSecureChannelRequest,pkCli,Nc_1098) in
                            {637}out(c, (pkCli,m1_1099,sign(h(m1_1099),skCli)));
                            {638}in(c, (em2_1100: bitstring,sigM2_1101: bitstring));
                            {639}let m2_1102: bitstring = em2_1100 in
                            {640}if (verify(h(m2_1102),sigM2_1101,pkSess_1095) <> true) then
                                0
                            else
                                {641}let (=OpenSecureChannelResponse,Ns_1103: bitstring,ST_1104: bitstring,TTL_1105: bitstring) = m2_1102 in
                                {642}let Kcli_1106: bitstring = h((Nc_1098,Ns_1103)) in
                                {643}out(c, senc(mCli(pkCli,pkSess_1095),Kcli_1106))
                )
                else
                    {644}let pkSess_1107: bitstring = fail-any in
                    {645}out(c, GetEndpointRequest);
                    {646}in(c, (=GetEndpointResponse,=pkSess_1107,=Sign,SP_1108: bitstring,UP_1109: bitstring));
                    {647}new Nc_1110: bitstring;
                    {648}let m1_1111: bitstring = (OpenSecureChannelRequest,pkCli,Nc_1110) in
                    {649}out(c, (pkCli,m1_1111,sign(h(m1_1111),skCli)));
                    {650}in(c, (em2_1112: bitstring,sigM2_1113: bitstring));
                    {651}let m2_1114: bitstring = em2_1112 in
                    {652}if (verify(h(m2_1114),sigM2_1113,pkSess_1107) <> true) then
                        0
                    else
                        {653}let (=OpenSecureChannelResponse,Ns_1115: bitstring,ST_1116: bitstring,TTL_1117: bitstring) = m2_1114 in
                        {654}let Kcli_1118: bitstring = h((Nc_1110,Ns_1115)) in
                        {655}out(c, senc(mCli(pkCli,pkSess_1107),Kcli_1118))
        )
        else
            {656}let v_1119: bool = (Cli = B) in
            (
                {657}if v_1119 then
                (
                    {658}let skCli_1120: bitstring = skB in
                    {659}let pkCli_1121: bitstring = pub(skCli_1120) in
                    {660}let v_1122: bool = (Disco = A) in
                    (
                        {661}if v_1122 then
                        (
                            {662}let pkDisco_1123: bitstring = pub(skA) in
                            {663}let v_1124: bool = (Sess = A) in
                            (
                                {664}if v_1124 then
                                (
                                    {665}let pkSess_1125: bitstring = pub(skA) in
                                    {666}out(c, GetEndpointRequest);
                                    {667}in(c, (=GetEndpointResponse,=pkSess_1125,=Sign,SP_1126: bitstring,UP_1127: bitstring));
                                    {668}new Nc_1128: bitstring;
                                    {669}let m1_1129: bitstring = (OpenSecureChannelRequest,pkCli_1121,Nc_1128) in
                                    {670}out(c, (pkCli_1121,m1_1129,sign(h(m1_1129),skCli_1120)));
                                    {671}in(c, (em2_1130: bitstring,sigM2_1131: bitstring));
                                    {672}let m2_1132: bitstring = em2_1130 in
                                    {673}if (verify(h(m2_1132),sigM2_1131,pkSess_1125) <> true) then
                                        0
                                    else
                                        {674}let (=OpenSecureChannelResponse,Ns_1133: bitstring,ST_1134: bitstring,TTL_1135: bitstring) = m2_1132 in
                                        {675}let Kcli_1136: bitstring = h((Nc_1128,Ns_1133)) in
                                        {676}out(c, senc(mCli(pkCli_1121,pkSess_1125),Kcli_1136))
                                )
                                else
                                    {677}let v_1137: bool = (Sess = B) in
                                    (
                                        {678}if v_1137 then
                                        (
                                            {679}let pkSess_1138: bitstring = pub(skB) in
                                            {680}out(c, GetEndpointRequest);
                                            {681}in(c, (=GetEndpointResponse,=pkSess_1138,=Sign,SP_1139: bitstring,UP_1140: bitstring));
                                            {682}new Nc_1141: bitstring;
                                            {683}let m1_1142: bitstring = (OpenSecureChannelRequest,pkCli_1121,Nc_1141) in
                                            {684}out(c, (pkCli_1121,m1_1142,sign(h(m1_1142),skCli_1120)));
                                            {685}in(c, (em2_1143: bitstring,sigM2_1144: bitstring));
                                            {686}let m2_1145: bitstring = em2_1143 in
                                            {687}if (verify(h(m2_1145),sigM2_1144,pkSess_1138) <> true) then
                                                0
                                            else
                                                {688}let (=OpenSecureChannelResponse,Ns_1146: bitstring,ST_1147: bitstring,TTL_1148: bitstring) = m2_1145 in
                                                {689}let Kcli_1149: bitstring = h((Nc_1141,Ns_1146)) in
                                                {690}out(c, senc(mCli(pkCli_1121,pkSess_1138),Kcli_1149))
                                        )
                                        else
                                            {691}let v_1150: bool = (Sess = C) in
                                            (
                                                {692}if v_1150 then
                                                (
                                                    {693}let pkSess_1151: bitstring = pub(skC) in
                                                    {694}out(c, GetEndpointRequest);
                                                    {695}in(c, (=GetEndpointResponse,=pkSess_1151,=Sign,SP_1152: bitstring,UP_1153: bitstring));
                                                    {696}new Nc_1154: bitstring;
                                                    {697}let m1_1155: bitstring = (OpenSecureChannelRequest,pkCli_1121,Nc_1154) in
                                                    {698}out(c, (pkCli_1121,m1_1155,sign(h(m1_1155),skCli_1120)));
                                                    {699}in(c, (em2_1156: bitstring,sigM2_1157: bitstring));
                                                    {700}let m2_1158: bitstring = em2_1156 in
                                                    {701}if (verify(h(m2_1158),sigM2_1157,pkSess_1151) <> true) then
                                                        0
                                                    else
                                                        {702}let (=OpenSecureChannelResponse,Ns_1159: bitstring,ST_1160: bitstring,TTL_1161: bitstring) = m2_1158 in
                                                        {703}let Kcli_1162: bitstring = h((Nc_1154,Ns_1159)) in
                                                        {704}out(c, senc(mCli(pkCli_1121,pkSess_1151),Kcli_1162))
                                                )
                                                else
                                                    {705}let pkSess_1163: bitstring = pub(sk(Sess)) in
                                                    {706}out(c, GetEndpointRequest);
                                                    {707}in(c, (=GetEndpointResponse,=pkSess_1163,=Sign,SP_1164: bitstring,UP_1165: bitstring));
                                                    {708}new Nc_1166: bitstring;
                                                    {709}let m1_1167: bitstring = (OpenSecureChannelRequest,pkCli_1121,Nc_1166) in
                                                    {710}out(c, (pkCli_1121,m1_1167,sign(h(m1_1167),skCli_1120)));
                                                    {711}in(c, (em2_1168: bitstring,sigM2_1169: bitstring));
                                                    {712}let m2_1170: bitstring = em2_1168 in
                                                    {713}if (verify(h(m2_1170),sigM2_1169,pkSess_1163) <> true) then
                                                        0
                                                    else
                                                        {714}let (=OpenSecureChannelResponse,Ns_1171: bitstring,ST_1172: bitstring,TTL_1173: bitstring) = m2_1170 in
                                                        {715}let Kcli_1174: bitstring = h((Nc_1166,Ns_1171)) in
                                                        {716}out(c, senc(mCli(pkCli_1121,pkSess_1163),Kcli_1174))
                                            )
                                            else
                                                {717}let pkSess_1175: bitstring = fail-any in
                                                {718}out(c, GetEndpointRequest);
                                                {719}in(c, (=GetEndpointResponse,=pkSess_1175,=Sign,SP_1176: bitstring,UP_1177: bitstring));
                                                {720}new Nc_1178: bitstring;
                                                {721}let m1_1179: bitstring = (OpenSecureChannelRequest,pkCli_1121,Nc_1178) in
                                                {722}out(c, (pkCli_1121,m1_1179,sign(h(m1_1179),skCli_1120)));
                                                {723}in(c, (em2_1180: bitstring,sigM2_1181: bitstring));
                                                {724}let m2_1182: bitstring = em2_1180 in
                                                {725}if (verify(h(m2_1182),sigM2_1181,pkSess_1175) <> true) then
                                                    0
                                                else
                                                    {726}let (=OpenSecureChannelResponse,Ns_1183: bitstring,ST_1184: bitstring,TTL_1185: bitstring) = m2_1182 in
                                                    {727}let Kcli_1186: bitstring = h((Nc_1178,Ns_1183)) in
                                                    {728}out(c, senc(mCli(pkCli_1121,pkSess_1175),Kcli_1186))
                                    )
                                    else
                                        {729}let pkSess_1187: bitstring = fail-any in
                                        {730}out(c, GetEndpointRequest);
                                        {731}in(c, (=GetEndpointResponse,=pkSess_1187,=Sign,SP_1188: bitstring,UP_1189: bitstring));
                                        {732}new Nc_1190: bitstring;
                                        {733}let m1_1191: bitstring = (OpenSecureChannelRequest,pkCli_1121,Nc_1190) in
                                        {734}out(c, (pkCli_1121,m1_1191,sign(h(m1_1191),skCli_1120)));
                                        {735}in(c, (em2_1192: bitstring,sigM2_1193: bitstring));
                                        {736}let m2_1194: bitstring = em2_1192 in
                                        {737}if (verify(h(m2_1194),sigM2_1193,pkSess_1187) <> true) then
                                            0
                                        else
                                            {738}let (=OpenSecureChannelResponse,Ns_1195: bitstring,ST_1196: bitstring,TTL_1197: bitstring) = m2_1194 in
                                            {739}let Kcli_1198: bitstring = h((Nc_1190,Ns_1195)) in
                                            {740}out(c, senc(mCli(pkCli_1121,pkSess_1187),Kcli_1198))
                            )
                            else
                                {741}let pkSess_1199: bitstring = fail-any in
                                {742}out(c, GetEndpointRequest);
                                {743}in(c, (=GetEndpointResponse,=pkSess_1199,=Sign,SP_1200: bitstring,UP_1201: bitstring));
                                {744}new Nc_1202: bitstring;
                                {745}let m1_1203: bitstring = (OpenSecureChannelRequest,pkCli_1121,Nc_1202) in
                                {746}out(c, (pkCli_1121,m1_1203,sign(h(m1_1203),skCli_1120)));
                                {747}in(c, (em2_1204: bitstring,sigM2_1205: bitstring));
                                {748}let m2_1206: bitstring = em2_1204 in
                                {749}if (verify(h(m2_1206),sigM2_1205,pkSess_1199) <> true) then
                                    0
                                else
                                    {750}let (=OpenSecureChannelResponse,Ns_1207: bitstring,ST_1208: bitstring,TTL_1209: bitstring) = m2_1206 in
                                    {751}let Kcli_1210: bitstring = h((Nc_1202,Ns_1207)) in
                                    {752}out(c, senc(mCli(pkCli_1121,pkSess_1199),Kcli_1210))
                        )
                        else
                            {753}let v_1211: bool = (Disco = B) in
                            (
                                {754}if v_1211 then
                                (
                                    {755}let pkDisco_1212: bitstring = pub(skB) in
                                    {756}let v_1213: bool = (Sess = A) in
                                    (
                                        {757}if v_1213 then
                                        (
                                            {758}let pkSess_1214: bitstring = pub(skA) in
                                            {759}out(c, GetEndpointRequest);
                                            {760}in(c, (=GetEndpointResponse,=pkSess_1214,=Sign,SP_1215: bitstring,UP_1216: bitstring));
                                            {761}new Nc_1217: bitstring;
                                            {762}let m1_1218: bitstring = (OpenSecureChannelRequest,pkCli_1121,Nc_1217) in
                                            {763}out(c, (pkCli_1121,m1_1218,sign(h(m1_1218),skCli_1120)));
                                            {764}in(c, (em2_1219: bitstring,sigM2_1220: bitstring));
                                            {765}let m2_1221: bitstring = em2_1219 in
                                            {766}if (verify(h(m2_1221),sigM2_1220,pkSess_1214) <> true) then
                                                0
                                            else
                                                {767}let (=OpenSecureChannelResponse,Ns_1222: bitstring,ST_1223: bitstring,TTL_1224: bitstring) = m2_1221 in
                                                {768}let Kcli_1225: bitstring = h((Nc_1217,Ns_1222)) in
                                                {769}out(c, senc(mCli(pkCli_1121,pkSess_1214),Kcli_1225))
                                        )
                                        else
                                            {770}let v_1226: bool = (Sess = B) in
                                            (
                                                {771}if v_1226 then
                                                (
                                                    {772}let pkSess_1227: bitstring = pub(skB) in
                                                    {773}out(c, GetEndpointRequest);
                                                    {774}in(c, (=GetEndpointResponse,=pkSess_1227,=Sign,SP_1228: bitstring,UP_1229: bitstring));
                                                    {775}new Nc_1230: bitstring;
                                                    {776}let m1_1231: bitstring = (OpenSecureChannelRequest,pkCli_1121,Nc_1230) in
                                                    {777}out(c, (pkCli_1121,m1_1231,sign(h(m1_1231),skCli_1120)));
                                                    {778}in(c, (em2_1232: bitstring,sigM2_1233: bitstring));
                                                    {779}let m2_1234: bitstring = em2_1232 in
                                                    {780}if (verify(h(m2_1234),sigM2_1233,pkSess_1227) <> true) then
                                                        0
                                                    else
                                                        {781}let (=OpenSecureChannelResponse,Ns_1235: bitstring,ST_1236: bitstring,TTL_1237: bitstring) = m2_1234 in
                                                        {782}let Kcli_1238: bitstring = h((Nc_1230,Ns_1235)) in
                                                        {783}out(c, senc(mCli(pkCli_1121,pkSess_1227),Kcli_1238))
                                                )
                                                else
                                                    {784}let v_1239: bool = (Sess = C) in
                                                    (
                                                        {785}if v_1239 then
                                                        (
                                                            {786}let pkSess_1240: bitstring = pub(skC) in
                                                            {787}out(c, GetEndpointRequest);
                                                            {788}in(c, (=GetEndpointResponse,=pkSess_1240,=Sign,SP_1241: bitstring,UP_1242: bitstring));
                                                            {789}new Nc_1243: bitstring;
                                                            {790}let m1_1244: bitstring = (OpenSecureChannelRequest,pkCli_1121,Nc_1243) in
                                                            {791}out(c, (pkCli_1121,m1_1244,sign(h(m1_1244),skCli_1120)));
                                                            {792}in(c, (em2_1245: bitstring,sigM2_1246: bitstring));
                                                            {793}let m2_1247: bitstring = em2_1245 in
                                                            {794}if (verify(h(m2_1247),sigM2_1246,pkSess_1240) <> true) then
                                                                0
                                                            else
                                                                {795}let (=OpenSecureChannelResponse,Ns_1248: bitstring,ST_1249: bitstring,TTL_1250: bitstring) = m2_1247 in
                                                                {796}let Kcli_1251: bitstring = h((Nc_1243,Ns_1248)) in
                                                                {797}out(c, senc(mCli(pkCli_1121,pkSess_1240),Kcli_1251))
                                                        )
                                                        else
                                                            {798}let pkSess_1252: bitstring = pub(sk(Sess)) in
                                                            {799}out(c, GetEndpointRequest);
                                                            {800}in(c, (=GetEndpointResponse,=pkSess_1252,=Sign,SP_1253: bitstring,UP_1254: bitstring));
                                                            {801}new Nc_1255: bitstring;
                                                            {802}let m1_1256: bitstring = (OpenSecureChannelRequest,pkCli_1121,Nc_1255) in
                                                            {803}out(c, (pkCli_1121,m1_1256,sign(h(m1_1256),skCli_1120)));
                                                            {804}in(c, (em2_1257: bitstring,sigM2_1258: bitstring));
                                                            {805}let m2_1259: bitstring = em2_1257 in
                                                            {806}if (verify(h(m2_1259),sigM2_1258,pkSess_1252) <> true) then
                                                                0
                                                            else
                                                                {807}let (=OpenSecureChannelResponse,Ns_1260: bitstring,ST_1261: bitstring,TTL_1262: bitstring) = m2_1259 in
                                                                {808}let Kcli_1263: bitstring = h((Nc_1255,Ns_1260)) in
                                                                {809}out(c, senc(mCli(pkCli_1121,pkSess_1252),Kcli_1263))
                                                    )
                                                    else
                                                        {810}let pkSess_1264: bitstring = fail-any in
                                                        {811}out(c, GetEndpointRequest);
                                                        {812}in(c, (=GetEndpointResponse,=pkSess_1264,=Sign,SP_1265: bitstring,UP_1266: bitstring));
                                                        {813}new Nc_1267: bitstring;
                                                        {814}let m1_1268: bitstring = (OpenSecureChannelRequest,pkCli_1121,Nc_1267) in
                                                        {815}out(c, (pkCli_1121,m1_1268,sign(h(m1_1268),skCli_1120)));
                                                        {816}in(c, (em2_1269: bitstring,sigM2_1270: bitstring));
                                                        {817}let m2_1271: bitstring = em2_1269 in
                                                        {818}if (verify(h(m2_1271),sigM2_1270,pkSess_1264) <> true) then
                                                            0
                                                        else
                                                            {819}let (=OpenSecureChannelResponse,Ns_1272: bitstring,ST_1273: bitstring,TTL_1274: bitstring) = m2_1271 in
                                                            {820}let Kcli_1275: bitstring = h((Nc_1267,Ns_1272)) in
                                                            {821}out(c, senc(mCli(pkCli_1121,pkSess_1264),Kcli_1275))
                                            )
                                            else
                                                {822}let pkSess_1276: bitstring = fail-any in
                                                {823}out(c, GetEndpointRequest);
                                                {824}in(c, (=GetEndpointResponse,=pkSess_1276,=Sign,SP_1277: bitstring,UP_1278: bitstring));
                                                {825}new Nc_1279: bitstring;
                                                {826}let m1_1280: bitstring = (OpenSecureChannelRequest,pkCli_1121,Nc_1279) in
                                                {827}out(c, (pkCli_1121,m1_1280,sign(h(m1_1280),skCli_1120)));
                                                {828}in(c, (em2_1281: bitstring,sigM2_1282: bitstring));
                                                {829}let m2_1283: bitstring = em2_1281 in
                                                {830}if (verify(h(m2_1283),sigM2_1282,pkSess_1276) <> true) then
                                                    0
                                                else
                                                    {831}let (=OpenSecureChannelResponse,Ns_1284: bitstring,ST_1285: bitstring,TTL_1286: bitstring) = m2_1283 in
                                                    {832}let Kcli_1287: bitstring = h((Nc_1279,Ns_1284)) in
                                                    {833}out(c, senc(mCli(pkCli_1121,pkSess_1276),Kcli_1287))
                                    )
                                    else
                                        {834}let pkSess_1288: bitstring = fail-any in
                                        {835}out(c, GetEndpointRequest);
                                        {836}in(c, (=GetEndpointResponse,=pkSess_1288,=Sign,SP_1289: bitstring,UP_1290: bitstring));
                                        {837}new Nc_1291: bitstring;
                                        {838}let m1_1292: bitstring = (OpenSecureChannelRequest,pkCli_1121,Nc_1291) in
                                        {839}out(c, (pkCli_1121,m1_1292,sign(h(m1_1292),skCli_1120)));
                                        {840}in(c, (em2_1293: bitstring,sigM2_1294: bitstring));
                                        {841}let m2_1295: bitstring = em2_1293 in
                                        {842}if (verify(h(m2_1295),sigM2_1294,pkSess_1288) <> true) then
                                            0
                                        else
                                            {843}let (=OpenSecureChannelResponse,Ns_1296: bitstring,ST_1297: bitstring,TTL_1298: bitstring) = m2_1295 in
                                            {844}let Kcli_1299: bitstring = h((Nc_1291,Ns_1296)) in
                                            {845}out(c, senc(mCli(pkCli_1121,pkSess_1288),Kcli_1299))
                                )
                                else
                                    {846}let v_1300: bool = (Disco = C) in
                                    (
                                        {847}if v_1300 then
                                        (
                                            {848}let pkDisco_1301: bitstring = pub(skC) in
                                            {849}let v_1302: bool = (Sess = A) in
                                            (
                                                {850}if v_1302 then
                                                (
                                                    {851}let pkSess_1303: bitstring = pub(skA) in
                                                    {852}out(c, GetEndpointRequest);
                                                    {853}in(c, (=GetEndpointResponse,=pkSess_1303,=Sign,SP_1304: bitstring,UP_1305: bitstring));
                                                    {854}new Nc_1306: bitstring;
                                                    {855}let m1_1307: bitstring = (OpenSecureChannelRequest,pkCli_1121,Nc_1306) in
                                                    {856}out(c, (pkCli_1121,m1_1307,sign(h(m1_1307),skCli_1120)));
                                                    {857}in(c, (em2_1308: bitstring,sigM2_1309: bitstring));
                                                    {858}let m2_1310: bitstring = em2_1308 in
                                                    {859}if (verify(h(m2_1310),sigM2_1309,pkSess_1303) <> true) then
                                                        0
                                                    else
                                                        {860}let (=OpenSecureChannelResponse,Ns_1311: bitstring,ST_1312: bitstring,TTL_1313: bitstring) = m2_1310 in
                                                        {861}let Kcli_1314: bitstring = h((Nc_1306,Ns_1311)) in
                                                        {862}out(c, senc(mCli(pkCli_1121,pkSess_1303),Kcli_1314))
                                                )
                                                else
                                                    {863}let v_1315: bool = (Sess = B) in
                                                    (
                                                        {864}if v_1315 then
                                                        (
                                                            {865}let pkSess_1316: bitstring = pub(skB) in
                                                            {866}out(c, GetEndpointRequest);
                                                            {867}in(c, (=GetEndpointResponse,=pkSess_1316,=Sign,SP_1317: bitstring,UP_1318: bitstring));
                                                            {868}new Nc_1319: bitstring;
                                                            {869}let m1_1320: bitstring = (OpenSecureChannelRequest,pkCli_1121,Nc_1319) in
                                                            {870}out(c, (pkCli_1121,m1_1320,sign(h(m1_1320),skCli_1120)));
                                                            {871}in(c, (em2_1321: bitstring,sigM2_1322: bitstring));
                                                            {872}let m2_1323: bitstring = em2_1321 in
                                                            {873}if (verify(h(m2_1323),sigM2_1322,pkSess_1316) <> true) then
                                                                0
                                                            else
                                                                {874}let (=OpenSecureChannelResponse,Ns_1324: bitstring,ST_1325: bitstring,TTL_1326: bitstring) = m2_1323 in
                                                                {875}let Kcli_1327: bitstring = h((Nc_1319,Ns_1324)) in
                                                                {876}out(c, senc(mCli(pkCli_1121,pkSess_1316),Kcli_1327))
                                                        )
                                                        else
                                                            {877}let v_1328: bool = (Sess = C) in
                                                            (
                                                                {878}if v_1328 then
                                                                (
                                                                    {879}let pkSess_1329: bitstring = pub(skC) in
                                                                    {880}out(c, GetEndpointRequest);
                                                                    {881}in(c, (=GetEndpointResponse,=pkSess_1329,=Sign,SP_1330: bitstring,UP_1331: bitstring));
                                                                    {882}new Nc_1332: bitstring;
                                                                    {883}let m1_1333: bitstring = (OpenSecureChannelRequest,pkCli_1121,Nc_1332) in
                                                                    {884}out(c, (pkCli_1121,m1_1333,sign(h(m1_1333),skCli_1120)));
                                                                    {885}in(c, (em2_1334: bitstring,sigM2_1335: bitstring));
                                                                    {886}let m2_1336: bitstring = em2_1334 in
                                                                    {887}if (verify(h(m2_1336),sigM2_1335,pkSess_1329) <> true) then
                                                                        0
                                                                    else
                                                                        {888}let (=OpenSecureChannelResponse,Ns_1337: bitstring,ST_1338: bitstring,TTL_1339: bitstring) = m2_1336 in
                                                                        {889}let Kcli_1340: bitstring = h((Nc_1332,Ns_1337)) in
                                                                        {890}out(c, senc(mCli(pkCli_1121,pkSess_1329),Kcli_1340))
                                                                )
                                                                else
                                                                    {891}let pkSess_1341: bitstring = pub(sk(Sess)) in
                                                                    {892}out(c, GetEndpointRequest);
                                                                    {893}in(c, (=GetEndpointResponse,=pkSess_1341,=Sign,SP_1342: bitstring,UP_1343: bitstring));
                                                                    {894}new Nc_1344: bitstring;
                                                                    {895}let m1_1345: bitstring = (OpenSecureChannelRequest,pkCli_1121,Nc_1344) in
                                                                    {896}out(c, (pkCli_1121,m1_1345,sign(h(m1_1345),skCli_1120)));
                                                                    {897}in(c, (em2_1346: bitstring,sigM2_1347: bitstring));
                                                                    {898}let m2_1348: bitstring = em2_1346 in
                                                                    {899}if (verify(h(m2_1348),sigM2_1347,pkSess_1341) <> true) then
                                                                        0
                                                                    else
                                                                        {900}let (=OpenSecureChannelResponse,Ns_1349: bitstring,ST_1350: bitstring,TTL_1351: bitstring) = m2_1348 in
                                                                        {901}let Kcli_1352: bitstring = h((Nc_1344,Ns_1349)) in
                                                                        {902}out(c, senc(mCli(pkCli_1121,pkSess_1341),Kcli_1352))
                                                            )
                                                            else
                                                                {903}let pkSess_1353: bitstring = fail-any in
                                                                {904}out(c, GetEndpointRequest);
                                                                {905}in(c, (=GetEndpointResponse,=pkSess_1353,=Sign,SP_1354: bitstring,UP_1355: bitstring));
                                                                {906}new Nc_1356: bitstring;
                                                                {907}let m1_1357: bitstring = (OpenSecureChannelRequest,pkCli_1121,Nc_1356) in
                                                                {908}out(c, (pkCli_1121,m1_1357,sign(h(m1_1357),skCli_1120)));
                                                                {909}in(c, (em2_1358: bitstring,sigM2_1359: bitstring));
                                                                {910}let m2_1360: bitstring = em2_1358 in
                                                                {911}if (verify(h(m2_1360),sigM2_1359,pkSess_1353) <> true) then
                                                                    0
                                                                else
                                                                    {912}let (=OpenSecureChannelResponse,Ns_1361: bitstring,ST_1362: bitstring,TTL_1363: bitstring) = m2_1360 in
                                                                    {913}let Kcli_1364: bitstring = h((Nc_1356,Ns_1361)) in
                                                                    {914}out(c, senc(mCli(pkCli_1121,pkSess_1353),Kcli_1364))
                                                    )
                                                    else
                                                        {915}let pkSess_1365: bitstring = fail-any in
                                                        {916}out(c, GetEndpointRequest);
                                                        {917}in(c, (=GetEndpointResponse,=pkSess_1365,=Sign,SP_1366: bitstring,UP_1367: bitstring));
                                                        {918}new Nc_1368: bitstring;
                                                        {919}let m1_1369: bitstring = (OpenSecureChannelRequest,pkCli_1121,Nc_1368) in
                                                        {920}out(c, (pkCli_1121,m1_1369,sign(h(m1_1369),skCli_1120)));
                                                        {921}in(c, (em2_1370: bitstring,sigM2_1371: bitstring));
                                                        {922}let m2_1372: bitstring = em2_1370 in
                                                        {923}if (verify(h(m2_1372),sigM2_1371,pkSess_1365) <> true) then
                                                            0
                                                        else
                                                            {924}let (=OpenSecureChannelResponse,Ns_1373: bitstring,ST_1374: bitstring,TTL_1375: bitstring) = m2_1372 in
                                                            {925}let Kcli_1376: bitstring = h((Nc_1368,Ns_1373)) in
                                                            {926}out(c, senc(mCli(pkCli_1121,pkSess_1365),Kcli_1376))
                                            )
                                            else
                                                {927}let pkSess_1377: bitstring = fail-any in
                                                {928}out(c, GetEndpointRequest);
                                                {929}in(c, (=GetEndpointResponse,=pkSess_1377,=Sign,SP_1378: bitstring,UP_1379: bitstring));
                                                {930}new Nc_1380: bitstring;
                                                {931}let m1_1381: bitstring = (OpenSecureChannelRequest,pkCli_1121,Nc_1380) in
                                                {932}out(c, (pkCli_1121,m1_1381,sign(h(m1_1381),skCli_1120)));
                                                {933}in(c, (em2_1382: bitstring,sigM2_1383: bitstring));
                                                {934}let m2_1384: bitstring = em2_1382 in
                                                {935}if (verify(h(m2_1384),sigM2_1383,pkSess_1377) <> true) then
                                                    0
                                                else
                                                    {936}let (=OpenSecureChannelResponse,Ns_1385: bitstring,ST_1386: bitstring,TTL_1387: bitstring) = m2_1384 in
                                                    {937}let Kcli_1388: bitstring = h((Nc_1380,Ns_1385)) in
                                                    {938}out(c, senc(mCli(pkCli_1121,pkSess_1377),Kcli_1388))
                                        )
                                        else
                                            {939}let pkDisco_1389: bitstring = pub(sk(Disco)) in
                                            {940}let v_1390: bool = (Sess = A) in
                                            (
                                                {941}if v_1390 then
                                                (
                                                    {942}let pkSess_1391: bitstring = pub(skA) in
                                                    {943}out(c, GetEndpointRequest);
                                                    {944}in(c, (=GetEndpointResponse,=pkSess_1391,=Sign,SP_1392: bitstring,UP_1393: bitstring));
                                                    {945}new Nc_1394: bitstring;
                                                    {946}let m1_1395: bitstring = (OpenSecureChannelRequest,pkCli_1121,Nc_1394) in
                                                    {947}out(c, (pkCli_1121,m1_1395,sign(h(m1_1395),skCli_1120)));
                                                    {948}in(c, (em2_1396: bitstring,sigM2_1397: bitstring));
                                                    {949}let m2_1398: bitstring = em2_1396 in
                                                    {950}if (verify(h(m2_1398),sigM2_1397,pkSess_1391) <> true) then
                                                        0
                                                    else
                                                        {951}let (=OpenSecureChannelResponse,Ns_1399: bitstring,ST_1400: bitstring,TTL_1401: bitstring) = m2_1398 in
                                                        {952}let Kcli_1402: bitstring = h((Nc_1394,Ns_1399)) in
                                                        {953}out(c, senc(mCli(pkCli_1121,pkSess_1391),Kcli_1402))
                                                )
                                                else
                                                    {954}let v_1403: bool = (Sess = B) in
                                                    (
                                                        {955}if v_1403 then
                                                        (
                                                            {956}let pkSess_1404: bitstring = pub(skB) in
                                                            {957}out(c, GetEndpointRequest);
                                                            {958}in(c, (=GetEndpointResponse,=pkSess_1404,=Sign,SP_1405: bitstring,UP_1406: bitstring));
                                                            {959}new Nc_1407: bitstring;
                                                            {960}let m1_1408: bitstring = (OpenSecureChannelRequest,pkCli_1121,Nc_1407) in
                                                            {961}out(c, (pkCli_1121,m1_1408,sign(h(m1_1408),skCli_1120)));
                                                            {962}in(c, (em2_1409: bitstring,sigM2_1410: bitstring));
                                                            {963}let m2_1411: bitstring = em2_1409 in
                                                            {964}if (verify(h(m2_1411),sigM2_1410,pkSess_1404) <> true) then
                                                                0
                                                            else
                                                                {965}let (=OpenSecureChannelResponse,Ns_1412: bitstring,ST_1413: bitstring,TTL_1414: bitstring) = m2_1411 in
                                                                {966}let Kcli_1415: bitstring = h((Nc_1407,Ns_1412)) in
                                                                {967}out(c, senc(mCli(pkCli_1121,pkSess_1404),Kcli_1415))
                                                        )
                                                        else
                                                            {968}let v_1416: bool = (Sess = C) in
                                                            (
                                                                {969}if v_1416 then
                                                                (
                                                                    {970}let pkSess_1417: bitstring = pub(skC) in
                                                                    {971}out(c, GetEndpointRequest);
                                                                    {972}in(c, (=GetEndpointResponse,=pkSess_1417,=Sign,SP_1418: bitstring,UP_1419: bitstring));
                                                                    {973}new Nc_1420: bitstring;
                                                                    {974}let m1_1421: bitstring = (OpenSecureChannelRequest,pkCli_1121,Nc_1420) in
                                                                    {975}out(c, (pkCli_1121,m1_1421,sign(h(m1_1421),skCli_1120)));
                                                                    {976}in(c, (em2_1422: bitstring,sigM2_1423: bitstring));
                                                                    {977}let m2_1424: bitstring = em2_1422 in
                                                                    {978}if (verify(h(m2_1424),sigM2_1423,pkSess_1417) <> true) then
                                                                        0
                                                                    else
                                                                        {979}let (=OpenSecureChannelResponse,Ns_1425: bitstring,ST_1426: bitstring,TTL_1427: bitstring) = m2_1424 in
                                                                        {980}let Kcli_1428: bitstring = h((Nc_1420,Ns_1425)) in
                                                                        {981}out(c, senc(mCli(pkCli_1121,pkSess_1417),Kcli_1428))
                                                                )
                                                                else
                                                                    {982}let pkSess_1429: bitstring = pub(sk(Sess)) in
                                                                    {983}out(c, GetEndpointRequest);
                                                                    {984}in(c, (=GetEndpointResponse,=pkSess_1429,=Sign,SP_1430: bitstring,UP_1431: bitstring));
                                                                    {985}new Nc_1432: bitstring;
                                                                    {986}let m1_1433: bitstring = (OpenSecureChannelRequest,pkCli_1121,Nc_1432) in
                                                                    {987}out(c, (pkCli_1121,m1_1433,sign(h(m1_1433),skCli_1120)));
                                                                    {988}in(c, (em2_1434: bitstring,sigM2_1435: bitstring));
                                                                    {989}let m2_1436: bitstring = em2_1434 in
                                                                    {990}if (verify(h(m2_1436),sigM2_1435,pkSess_1429) <> true) then
                                                                        0
                                                                    else
                                                                        {991}let (=OpenSecureChannelResponse,Ns_1437: bitstring,ST_1438: bitstring,TTL_1439: bitstring) = m2_1436 in
                                                                        {992}let Kcli_1440: bitstring = h((Nc_1432,Ns_1437)) in
                                                                        {993}out(c, senc(mCli(pkCli_1121,pkSess_1429),Kcli_1440))
                                                            )
                                                            else
                                                                {994}let pkSess_1441: bitstring = fail-any in
                                                                {995}out(c, GetEndpointRequest);
                                                                {996}in(c, (=GetEndpointResponse,=pkSess_1441,=Sign,SP_1442: bitstring,UP_1443: bitstring));
                                                                {997}new Nc_1444: bitstring;
                                                                {998}let m1_1445: bitstring = (OpenSecureChannelRequest,pkCli_1121,Nc_1444) in
                                                                {999}out(c, (pkCli_1121,m1_1445,sign(h(m1_1445),skCli_1120)));
                                                                {1000}in(c, (em2_1446: bitstring,sigM2_1447: bitstring));
                                                                {1001}let m2_1448: bitstring = em2_1446 in
                                                                {1002}if (verify(h(m2_1448),sigM2_1447,pkSess_1441) <> true) then
                                                                    0
                                                                else
                                                                    {1003}let (=OpenSecureChannelResponse,Ns_1449: bitstring,ST_1450: bitstring,TTL_1451: bitstring) = m2_1448 in
                                                                    {1004}let Kcli_1452: bitstring = h((Nc_1444,Ns_1449)) in
                                                                    {1005}out(c, senc(mCli(pkCli_1121,pkSess_1441),Kcli_1452))
                                                    )
                                                    else
                                                        {1006}let pkSess_1453: bitstring = fail-any in
                                                        {1007}out(c, GetEndpointRequest);
                                                        {1008}in(c, (=GetEndpointResponse,=pkSess_1453,=Sign,SP_1454: bitstring,UP_1455: bitstring));
                                                        {1009}new Nc_1456: bitstring;
                                                        {1010}let m1_1457: bitstring = (OpenSecureChannelRequest,pkCli_1121,Nc_1456) in
                                                        {1011}out(c, (pkCli_1121,m1_1457,sign(h(m1_1457),skCli_1120)));
                                                        {1012}in(c, (em2_1458: bitstring,sigM2_1459: bitstring));
                                                        {1013}let m2_1460: bitstring = em2_1458 in
                                                        {1014}if (verify(h(m2_1460),sigM2_1459,pkSess_1453) <> true) then
                                                            0
                                                        else
                                                            {1015}let (=OpenSecureChannelResponse,Ns_1461: bitstring,ST_1462: bitstring,TTL_1463: bitstring) = m2_1460 in
                                                            {1016}let Kcli_1464: bitstring = h((Nc_1456,Ns_1461)) in
                                                            {1017}out(c, senc(mCli(pkCli_1121,pkSess_1453),Kcli_1464))
                                            )
                                            else
                                                {1018}let pkSess_1465: bitstring = fail-any in
                                                {1019}out(c, GetEndpointRequest);
                                                {1020}in(c, (=GetEndpointResponse,=pkSess_1465,=Sign,SP_1466: bitstring,UP_1467: bitstring));
                                                {1021}new Nc_1468: bitstring;
                                                {1022}let m1_1469: bitstring = (OpenSecureChannelRequest,pkCli_1121,Nc_1468) in
                                                {1023}out(c, (pkCli_1121,m1_1469,sign(h(m1_1469),skCli_1120)));
                                                {1024}in(c, (em2_1470: bitstring,sigM2_1471: bitstring));
                                                {1025}let m2_1472: bitstring = em2_1470 in
                                                {1026}if (verify(h(m2_1472),sigM2_1471,pkSess_1465) <> true) then
                                                    0
                                                else
                                                    {1027}let (=OpenSecureChannelResponse,Ns_1473: bitstring,ST_1474: bitstring,TTL_1475: bitstring) = m2_1472 in
                                                    {1028}let Kcli_1476: bitstring = h((Nc_1468,Ns_1473)) in
                                                    {1029}out(c, senc(mCli(pkCli_1121,pkSess_1465),Kcli_1476))
                                    )
                                    else
                                        {1030}let pkDisco_1477: bitstring = fail-any in
                                        {1031}let v_1478: bool = (Sess = A) in
                                        (
                                            {1032}if v_1478 then
                                            (
                                                {1033}let pkSess_1479: bitstring = pub(skA) in
                                                {1034}out(c, GetEndpointRequest);
                                                {1035}in(c, (=GetEndpointResponse,=pkSess_1479,=Sign,SP_1480: bitstring,UP_1481: bitstring));
                                                {1036}new Nc_1482: bitstring;
                                                {1037}let m1_1483: bitstring = (OpenSecureChannelRequest,pkCli_1121,Nc_1482) in
                                                {1038}out(c, (pkCli_1121,m1_1483,sign(h(m1_1483),skCli_1120)));
                                                {1039}in(c, (em2_1484: bitstring,sigM2_1485: bitstring));
                                                {1040}let m2_1486: bitstring = em2_1484 in
                                                {1041}if (verify(h(m2_1486),sigM2_1485,pkSess_1479) <> true) then
                                                    0
                                                else
                                                    {1042}let (=OpenSecureChannelResponse,Ns_1487: bitstring,ST_1488: bitstring,TTL_1489: bitstring) = m2_1486 in
                                                    {1043}let Kcli_1490: bitstring = h((Nc_1482,Ns_1487)) in
                                                    {1044}out(c, senc(mCli(pkCli_1121,pkSess_1479),Kcli_1490))
                                            )
                                            else
                                                {1045}let v_1491: bool = (Sess = B) in
                                                (
                                                    {1046}if v_1491 then
                                                    (
                                                        {1047}let pkSess_1492: bitstring = pub(skB) in
                                                        {1048}out(c, GetEndpointRequest);
                                                        {1049}in(c, (=GetEndpointResponse,=pkSess_1492,=Sign,SP_1493: bitstring,UP_1494: bitstring));
                                                        {1050}new Nc_1495: bitstring;
                                                        {1051}let m1_1496: bitstring = (OpenSecureChannelRequest,pkCli_1121,Nc_1495) in
                                                        {1052}out(c, (pkCli_1121,m1_1496,sign(h(m1_1496),skCli_1120)));
                                                        {1053}in(c, (em2_1497: bitstring,sigM2_1498: bitstring));
                                                        {1054}let m2_1499: bitstring = em2_1497 in
                                                        {1055}if (verify(h(m2_1499),sigM2_1498,pkSess_1492) <> true) then
                                                            0
                                                        else
                                                            {1056}let (=OpenSecureChannelResponse,Ns_1500: bitstring,ST_1501: bitstring,TTL_1502: bitstring) = m2_1499 in
                                                            {1057}let Kcli_1503: bitstring = h((Nc_1495,Ns_1500)) in
                                                            {1058}out(c, senc(mCli(pkCli_1121,pkSess_1492),Kcli_1503))
                                                    )
                                                    else
                                                        {1059}let v_1504: bool = (Sess = C) in
                                                        (
                                                            {1060}if v_1504 then
                                                            (
                                                                {1061}let pkSess_1505: bitstring = pub(skC) in
                                                                {1062}out(c, GetEndpointRequest);
                                                                {1063}in(c, (=GetEndpointResponse,=pkSess_1505,=Sign,SP_1506: bitstring,UP_1507: bitstring));
                                                                {1064}new Nc_1508: bitstring;
                                                                {1065}let m1_1509: bitstring = (OpenSecureChannelRequest,pkCli_1121,Nc_1508) in
                                                                {1066}out(c, (pkCli_1121,m1_1509,sign(h(m1_1509),skCli_1120)));
                                                                {1067}in(c, (em2_1510: bitstring,sigM2_1511: bitstring));
                                                                {1068}let m2_1512: bitstring = em2_1510 in
                                                                {1069}if (verify(h(m2_1512),sigM2_1511,pkSess_1505) <> true) then
                                                                    0
                                                                else
                                                                    {1070}let (=OpenSecureChannelResponse,Ns_1513: bitstring,ST_1514: bitstring,TTL_1515: bitstring) = m2_1512 in
                                                                    {1071}let Kcli_1516: bitstring = h((Nc_1508,Ns_1513)) in
                                                                    {1072}out(c, senc(mCli(pkCli_1121,pkSess_1505),Kcli_1516))
                                                            )
                                                            else
                                                                {1073}let pkSess_1517: bitstring = pub(sk(Sess)) in
                                                                {1074}out(c, GetEndpointRequest);
                                                                {1075}in(c, (=GetEndpointResponse,=pkSess_1517,=Sign,SP_1518: bitstring,UP_1519: bitstring));
                                                                {1076}new Nc_1520: bitstring;
                                                                {1077}let m1_1521: bitstring = (OpenSecureChannelRequest,pkCli_1121,Nc_1520) in
                                                                {1078}out(c, (pkCli_1121,m1_1521,sign(h(m1_1521),skCli_1120)));
                                                                {1079}in(c, (em2_1522: bitstring,sigM2_1523: bitstring));
                                                                {1080}let m2_1524: bitstring = em2_1522 in
                                                                {1081}if (verify(h(m2_1524),sigM2_1523,pkSess_1517) <> true) then
                                                                    0
                                                                else
                                                                    {1082}let (=OpenSecureChannelResponse,Ns_1525: bitstring,ST_1526: bitstring,TTL_1527: bitstring) = m2_1524 in
                                                                    {1083}let Kcli_1528: bitstring = h((Nc_1520,Ns_1525)) in
                                                                    {1084}out(c, senc(mCli(pkCli_1121,pkSess_1517),Kcli_1528))
                                                        )
                                                        else
                                                            {1085}let pkSess_1529: bitstring = fail-any in
                                                            {1086}out(c, GetEndpointRequest);
                                                            {1087}in(c, (=GetEndpointResponse,=pkSess_1529,=Sign,SP_1530: bitstring,UP_1531: bitstring));
                                                            {1088}new Nc_1532: bitstring;
                                                            {1089}let m1_1533: bitstring = (OpenSecureChannelRequest,pkCli_1121,Nc_1532) in
                                                            {1090}out(c, (pkCli_1121,m1_1533,sign(h(m1_1533),skCli_1120)));
                                                            {1091}in(c, (em2_1534: bitstring,sigM2_1535: bitstring));
                                                            {1092}let m2_1536: bitstring = em2_1534 in
                                                            {1093}if (verify(h(m2_1536),sigM2_1535,pkSess_1529) <> true) then
                                                                0
                                                            else
                                                                {1094}let (=OpenSecureChannelResponse,Ns_1537: bitstring,ST_1538: bitstring,TTL_1539: bitstring) = m2_1536 in
                                                                {1095}let Kcli_1540: bitstring = h((Nc_1532,Ns_1537)) in
                                                                {1096}out(c, senc(mCli(pkCli_1121,pkSess_1529),Kcli_1540))
                                                )
                                                else
                                                    {1097}let pkSess_1541: bitstring = fail-any in
                                                    {1098}out(c, GetEndpointRequest);
                                                    {1099}in(c, (=GetEndpointResponse,=pkSess_1541,=Sign,SP_1542: bitstring,UP_1543: bitstring));
                                                    {1100}new Nc_1544: bitstring;
                                                    {1101}let m1_1545: bitstring = (OpenSecureChannelRequest,pkCli_1121,Nc_1544) in
                                                    {1102}out(c, (pkCli_1121,m1_1545,sign(h(m1_1545),skCli_1120)));
                                                    {1103}in(c, (em2_1546: bitstring,sigM2_1547: bitstring));
                                                    {1104}let m2_1548: bitstring = em2_1546 in
                                                    {1105}if (verify(h(m2_1548),sigM2_1547,pkSess_1541) <> true) then
                                                        0
                                                    else
                                                        {1106}let (=OpenSecureChannelResponse,Ns_1549: bitstring,ST_1550: bitstring,TTL_1551: bitstring) = m2_1548 in
                                                        {1107}let Kcli_1552: bitstring = h((Nc_1544,Ns_1549)) in
                                                        {1108}out(c, senc(mCli(pkCli_1121,pkSess_1541),Kcli_1552))
                                        )
                                        else
                                            {1109}let pkSess_1553: bitstring = fail-any in
                                            {1110}out(c, GetEndpointRequest);
                                            {1111}in(c, (=GetEndpointResponse,=pkSess_1553,=Sign,SP_1554: bitstring,UP_1555: bitstring));
                                            {1112}new Nc_1556: bitstring;
                                            {1113}let m1_1557: bitstring = (OpenSecureChannelRequest,pkCli_1121,Nc_1556) in
                                            {1114}out(c, (pkCli_1121,m1_1557,sign(h(m1_1557),skCli_1120)));
                                            {1115}in(c, (em2_1558: bitstring,sigM2_1559: bitstring));
                                            {1116}let m2_1560: bitstring = em2_1558 in
                                            {1117}if (verify(h(m2_1560),sigM2_1559,pkSess_1553) <> true) then
                                                0
                                            else
                                                {1118}let (=OpenSecureChannelResponse,Ns_1561: bitstring,ST_1562: bitstring,TTL_1563: bitstring) = m2_1560 in
                                                {1119}let Kcli_1564: bitstring = h((Nc_1556,Ns_1561)) in
                                                {1120}out(c, senc(mCli(pkCli_1121,pkSess_1553),Kcli_1564))
                            )
                            else
                                {1121}let pkDisco_1565: bitstring = fail-any in
                                {1122}let v_1566: bool = (Sess = A) in
                                (
                                    {1123}if v_1566 then
                                    (
                                        {1124}let pkSess_1567: bitstring = pub(skA) in
                                        {1125}out(c, GetEndpointRequest);
                                        {1126}in(c, (=GetEndpointResponse,=pkSess_1567,=Sign,SP_1568: bitstring,UP_1569: bitstring));
                                        {1127}new Nc_1570: bitstring;
                                        {1128}let m1_1571: bitstring = (OpenSecureChannelRequest,pkCli_1121,Nc_1570) in
                                        {1129}out(c, (pkCli_1121,m1_1571,sign(h(m1_1571),skCli_1120)));
                                        {1130}in(c, (em2_1572: bitstring,sigM2_1573: bitstring));
                                        {1131}let m2_1574: bitstring = em2_1572 in
                                        {1132}if (verify(h(m2_1574),sigM2_1573,pkSess_1567) <> true) then
                                            0
                                        else
                                            {1133}let (=OpenSecureChannelResponse,Ns_1575: bitstring,ST_1576: bitstring,TTL_1577: bitstring) = m2_1574 in
                                            {1134}let Kcli_1578: bitstring = h((Nc_1570,Ns_1575)) in
                                            {1135}out(c, senc(mCli(pkCli_1121,pkSess_1567),Kcli_1578))
                                    )
                                    else
                                        {1136}let v_1579: bool = (Sess = B) in
                                        (
                                            {1137}if v_1579 then
                                            (
                                                {1138}let pkSess_1580: bitstring = pub(skB) in
                                                {1139}out(c, GetEndpointRequest);
                                                {1140}in(c, (=GetEndpointResponse,=pkSess_1580,=Sign,SP_1581: bitstring,UP_1582: bitstring));
                                                {1141}new Nc_1583: bitstring;
                                                {1142}let m1_1584: bitstring = (OpenSecureChannelRequest,pkCli_1121,Nc_1583) in
                                                {1143}out(c, (pkCli_1121,m1_1584,sign(h(m1_1584),skCli_1120)));
                                                {1144}in(c, (em2_1585: bitstring,sigM2_1586: bitstring));
                                                {1145}let m2_1587: bitstring = em2_1585 in
                                                {1146}if (verify(h(m2_1587),sigM2_1586,pkSess_1580) <> true) then
                                                    0
                                                else
                                                    {1147}let (=OpenSecureChannelResponse,Ns_1588: bitstring,ST_1589: bitstring,TTL_1590: bitstring) = m2_1587 in
                                                    {1148}let Kcli_1591: bitstring = h((Nc_1583,Ns_1588)) in
                                                    {1149}out(c, senc(mCli(pkCli_1121,pkSess_1580),Kcli_1591))
                                            )
                                            else
                                                {1150}let v_1592: bool = (Sess = C) in
                                                (
                                                    {1151}if v_1592 then
                                                    (
                                                        {1152}let pkSess_1593: bitstring = pub(skC) in
                                                        {1153}out(c, GetEndpointRequest);
                                                        {1154}in(c, (=GetEndpointResponse,=pkSess_1593,=Sign,SP_1594: bitstring,UP_1595: bitstring));
                                                        {1155}new Nc_1596: bitstring;
                                                        {1156}let m1_1597: bitstring = (OpenSecureChannelRequest,pkCli_1121,Nc_1596) in
                                                        {1157}out(c, (pkCli_1121,m1_1597,sign(h(m1_1597),skCli_1120)));
                                                        {1158}in(c, (em2_1598: bitstring,sigM2_1599: bitstring));
                                                        {1159}let m2_1600: bitstring = em2_1598 in
                                                        {1160}if (verify(h(m2_1600),sigM2_1599,pkSess_1593) <> true) then
                                                            0
                                                        else
                                                            {1161}let (=OpenSecureChannelResponse,Ns_1601: bitstring,ST_1602: bitstring,TTL_1603: bitstring) = m2_1600 in
                                                            {1162}let Kcli_1604: bitstring = h((Nc_1596,Ns_1601)) in
                                                            {1163}out(c, senc(mCli(pkCli_1121,pkSess_1593),Kcli_1604))
                                                    )
                                                    else
                                                        {1164}let pkSess_1605: bitstring = pub(sk(Sess)) in
                                                        {1165}out(c, GetEndpointRequest);
                                                        {1166}in(c, (=GetEndpointResponse,=pkSess_1605,=Sign,SP_1606: bitstring,UP_1607: bitstring));
                                                        {1167}new Nc_1608: bitstring;
                                                        {1168}let m1_1609: bitstring = (OpenSecureChannelRequest,pkCli_1121,Nc_1608) in
                                                        {1169}out(c, (pkCli_1121,m1_1609,sign(h(m1_1609),skCli_1120)));
                                                        {1170}in(c, (em2_1610: bitstring,sigM2_1611: bitstring));
                                                        {1171}let m2_1612: bitstring = em2_1610 in
                                                        {1172}if (verify(h(m2_1612),sigM2_1611,pkSess_1605) <> true) then
                                                            0
                                                        else
                                                            {1173}let (=OpenSecureChannelResponse,Ns_1613: bitstring,ST_1614: bitstring,TTL_1615: bitstring) = m2_1612 in
                                                            {1174}let Kcli_1616: bitstring = h((Nc_1608,Ns_1613)) in
                                                            {1175}out(c, senc(mCli(pkCli_1121,pkSess_1605),Kcli_1616))
                                                )
                                                else
                                                    {1176}let pkSess_1617: bitstring = fail-any in
                                                    {1177}out(c, GetEndpointRequest);
                                                    {1178}in(c, (=GetEndpointResponse,=pkSess_1617,=Sign,SP_1618: bitstring,UP_1619: bitstring));
                                                    {1179}new Nc_1620: bitstring;
                                                    {1180}let m1_1621: bitstring = (OpenSecureChannelRequest,pkCli_1121,Nc_1620) in
                                                    {1181}out(c, (pkCli_1121,m1_1621,sign(h(m1_1621),skCli_1120)));
                                                    {1182}in(c, (em2_1622: bitstring,sigM2_1623: bitstring));
                                                    {1183}let m2_1624: bitstring = em2_1622 in
                                                    {1184}if (verify(h(m2_1624),sigM2_1623,pkSess_1617) <> true) then
                                                        0
                                                    else
                                                        {1185}let (=OpenSecureChannelResponse,Ns_1625: bitstring,ST_1626: bitstring,TTL_1627: bitstring) = m2_1624 in
                                                        {1186}let Kcli_1628: bitstring = h((Nc_1620,Ns_1625)) in
                                                        {1187}out(c, senc(mCli(pkCli_1121,pkSess_1617),Kcli_1628))
                                        )
                                        else
                                            {1188}let pkSess_1629: bitstring = fail-any in
                                            {1189}out(c, GetEndpointRequest);
                                            {1190}in(c, (=GetEndpointResponse,=pkSess_1629,=Sign,SP_1630: bitstring,UP_1631: bitstring));
                                            {1191}new Nc_1632: bitstring;
                                            {1192}let m1_1633: bitstring = (OpenSecureChannelRequest,pkCli_1121,Nc_1632) in
                                            {1193}out(c, (pkCli_1121,m1_1633,sign(h(m1_1633),skCli_1120)));
                                            {1194}in(c, (em2_1634: bitstring,sigM2_1635: bitstring));
                                            {1195}let m2_1636: bitstring = em2_1634 in
                                            {1196}if (verify(h(m2_1636),sigM2_1635,pkSess_1629) <> true) then
                                                0
                                            else
                                                {1197}let (=OpenSecureChannelResponse,Ns_1637: bitstring,ST_1638: bitstring,TTL_1639: bitstring) = m2_1636 in
                                                {1198}let Kcli_1640: bitstring = h((Nc_1632,Ns_1637)) in
                                                {1199}out(c, senc(mCli(pkCli_1121,pkSess_1629),Kcli_1640))
                                )
                                else
                                    {1200}let pkSess_1641: bitstring = fail-any in
                                    {1201}out(c, GetEndpointRequest);
                                    {1202}in(c, (=GetEndpointResponse,=pkSess_1641,=Sign,SP_1642: bitstring,UP_1643: bitstring));
                                    {1203}new Nc_1644: bitstring;
                                    {1204}let m1_1645: bitstring = (OpenSecureChannelRequest,pkCli_1121,Nc_1644) in
                                    {1205}out(c, (pkCli_1121,m1_1645,sign(h(m1_1645),skCli_1120)));
                                    {1206}in(c, (em2_1646: bitstring,sigM2_1647: bitstring));
                                    {1207}let m2_1648: bitstring = em2_1646 in
                                    {1208}if (verify(h(m2_1648),sigM2_1647,pkSess_1641) <> true) then
                                        0
                                    else
                                        {1209}let (=OpenSecureChannelResponse,Ns_1649: bitstring,ST_1650: bitstring,TTL_1651: bitstring) = m2_1648 in
                                        {1210}let Kcli_1652: bitstring = h((Nc_1644,Ns_1649)) in
                                        {1211}out(c, senc(mCli(pkCli_1121,pkSess_1641),Kcli_1652))
                    )
                    else
                        {1212}let pkDisco_1653: bitstring = fail-any in
                        {1213}let v_1654: bool = (Sess = A) in
                        (
                            {1214}if v_1654 then
                            (
                                {1215}let pkSess_1655: bitstring = pub(skA) in
                                {1216}out(c, GetEndpointRequest);
                                {1217}in(c, (=GetEndpointResponse,=pkSess_1655,=Sign,SP_1656: bitstring,UP_1657: bitstring));
                                {1218}new Nc_1658: bitstring;
                                {1219}let m1_1659: bitstring = (OpenSecureChannelRequest,pkCli_1121,Nc_1658) in
                                {1220}out(c, (pkCli_1121,m1_1659,sign(h(m1_1659),skCli_1120)));
                                {1221}in(c, (em2_1660: bitstring,sigM2_1661: bitstring));
                                {1222}let m2_1662: bitstring = em2_1660 in
                                {1223}if (verify(h(m2_1662),sigM2_1661,pkSess_1655) <> true) then
                                    0
                                else
                                    {1224}let (=OpenSecureChannelResponse,Ns_1663: bitstring,ST_1664: bitstring,TTL_1665: bitstring) = m2_1662 in
                                    {1225}let Kcli_1666: bitstring = h((Nc_1658,Ns_1663)) in
                                    {1226}out(c, senc(mCli(pkCli_1121,pkSess_1655),Kcli_1666))
                            )
                            else
                                {1227}let v_1667: bool = (Sess = B) in
                                (
                                    {1228}if v_1667 then
                                    (
                                        {1229}let pkSess_1668: bitstring = pub(skB) in
                                        {1230}out(c, GetEndpointRequest);
                                        {1231}in(c, (=GetEndpointResponse,=pkSess_1668,=Sign,SP_1669: bitstring,UP_1670: bitstring));
                                        {1232}new Nc_1671: bitstring;
                                        {1233}let m1_1672: bitstring = (OpenSecureChannelRequest,pkCli_1121,Nc_1671) in
                                        {1234}out(c, (pkCli_1121,m1_1672,sign(h(m1_1672),skCli_1120)));
                                        {1235}in(c, (em2_1673: bitstring,sigM2_1674: bitstring));
                                        {1236}let m2_1675: bitstring = em2_1673 in
                                        {1237}if (verify(h(m2_1675),sigM2_1674,pkSess_1668) <> true) then
                                            0
                                        else
                                            {1238}let (=OpenSecureChannelResponse,Ns_1676: bitstring,ST_1677: bitstring,TTL_1678: bitstring) = m2_1675 in
                                            {1239}let Kcli_1679: bitstring = h((Nc_1671,Ns_1676)) in
                                            {1240}out(c, senc(mCli(pkCli_1121,pkSess_1668),Kcli_1679))
                                    )
                                    else
                                        {1241}let v_1680: bool = (Sess = C) in
                                        (
                                            {1242}if v_1680 then
                                            (
                                                {1243}let pkSess_1681: bitstring = pub(skC) in
                                                {1244}out(c, GetEndpointRequest);
                                                {1245}in(c, (=GetEndpointResponse,=pkSess_1681,=Sign,SP_1682: bitstring,UP_1683: bitstring));
                                                {1246}new Nc_1684: bitstring;
                                                {1247}let m1_1685: bitstring = (OpenSecureChannelRequest,pkCli_1121,Nc_1684) in
                                                {1248}out(c, (pkCli_1121,m1_1685,sign(h(m1_1685),skCli_1120)));
                                                {1249}in(c, (em2_1686: bitstring,sigM2_1687: bitstring));
                                                {1250}let m2_1688: bitstring = em2_1686 in
                                                {1251}if (verify(h(m2_1688),sigM2_1687,pkSess_1681) <> true) then
                                                    0
                                                else
                                                    {1252}let (=OpenSecureChannelResponse,Ns_1689: bitstring,ST_1690: bitstring,TTL_1691: bitstring) = m2_1688 in
                                                    {1253}let Kcli_1692: bitstring = h((Nc_1684,Ns_1689)) in
                                                    {1254}out(c, senc(mCli(pkCli_1121,pkSess_1681),Kcli_1692))
                                            )
                                            else
                                                {1255}let pkSess_1693: bitstring = pub(sk(Sess)) in
                                                {1256}out(c, GetEndpointRequest);
                                                {1257}in(c, (=GetEndpointResponse,=pkSess_1693,=Sign,SP_1694: bitstring,UP_1695: bitstring));
                                                {1258}new Nc_1696: bitstring;
                                                {1259}let m1_1697: bitstring = (OpenSecureChannelRequest,pkCli_1121,Nc_1696) in
                                                {1260}out(c, (pkCli_1121,m1_1697,sign(h(m1_1697),skCli_1120)));
                                                {1261}in(c, (em2_1698: bitstring,sigM2_1699: bitstring));
                                                {1262}let m2_1700: bitstring = em2_1698 in
                                                {1263}if (verify(h(m2_1700),sigM2_1699,pkSess_1693) <> true) then
                                                    0
                                                else
                                                    {1264}let (=OpenSecureChannelResponse,Ns_1701: bitstring,ST_1702: bitstring,TTL_1703: bitstring) = m2_1700 in
                                                    {1265}let Kcli_1704: bitstring = h((Nc_1696,Ns_1701)) in
                                                    {1266}out(c, senc(mCli(pkCli_1121,pkSess_1693),Kcli_1704))
                                        )
                                        else
                                            {1267}let pkSess_1705: bitstring = fail-any in
                                            {1268}out(c, GetEndpointRequest);
                                            {1269}in(c, (=GetEndpointResponse,=pkSess_1705,=Sign,SP_1706: bitstring,UP_1707: bitstring));
                                            {1270}new Nc_1708: bitstring;
                                            {1271}let m1_1709: bitstring = (OpenSecureChannelRequest,pkCli_1121,Nc_1708) in
                                            {1272}out(c, (pkCli_1121,m1_1709,sign(h(m1_1709),skCli_1120)));
                                            {1273}in(c, (em2_1710: bitstring,sigM2_1711: bitstring));
                                            {1274}let m2_1712: bitstring = em2_1710 in
                                            {1275}if (verify(h(m2_1712),sigM2_1711,pkSess_1705) <> true) then
                                                0
                                            else
                                                {1276}let (=OpenSecureChannelResponse,Ns_1713: bitstring,ST_1714: bitstring,TTL_1715: bitstring) = m2_1712 in
                                                {1277}let Kcli_1716: bitstring = h((Nc_1708,Ns_1713)) in
                                                {1278}out(c, senc(mCli(pkCli_1121,pkSess_1705),Kcli_1716))
                                )
                                else
                                    {1279}let pkSess_1717: bitstring = fail-any in
                                    {1280}out(c, GetEndpointRequest);
                                    {1281}in(c, (=GetEndpointResponse,=pkSess_1717,=Sign,SP_1718: bitstring,UP_1719: bitstring));
                                    {1282}new Nc_1720: bitstring;
                                    {1283}let m1_1721: bitstring = (OpenSecureChannelRequest,pkCli_1121,Nc_1720) in
                                    {1284}out(c, (pkCli_1121,m1_1721,sign(h(m1_1721),skCli_1120)));
                                    {1285}in(c, (em2_1722: bitstring,sigM2_1723: bitstring));
                                    {1286}let m2_1724: bitstring = em2_1722 in
                                    {1287}if (verify(h(m2_1724),sigM2_1723,pkSess_1717) <> true) then
                                        0
                                    else
                                        {1288}let (=OpenSecureChannelResponse,Ns_1725: bitstring,ST_1726: bitstring,TTL_1727: bitstring) = m2_1724 in
                                        {1289}let Kcli_1728: bitstring = h((Nc_1720,Ns_1725)) in
                                        {1290}out(c, senc(mCli(pkCli_1121,pkSess_1717),Kcli_1728))
                        )
                        else
                            {1291}let pkSess_1729: bitstring = fail-any in
                            {1292}out(c, GetEndpointRequest);
                            {1293}in(c, (=GetEndpointResponse,=pkSess_1729,=Sign,SP_1730: bitstring,UP_1731: bitstring));
                            {1294}new Nc_1732: bitstring;
                            {1295}let m1_1733: bitstring = (OpenSecureChannelRequest,pkCli_1121,Nc_1732) in
                            {1296}out(c, (pkCli_1121,m1_1733,sign(h(m1_1733),skCli_1120)));
                            {1297}in(c, (em2_1734: bitstring,sigM2_1735: bitstring));
                            {1298}let m2_1736: bitstring = em2_1734 in
                            {1299}if (verify(h(m2_1736),sigM2_1735,pkSess_1729) <> true) then
                                0
                            else
                                {1300}let (=OpenSecureChannelResponse,Ns_1737: bitstring,ST_1738: bitstring,TTL_1739: bitstring) = m2_1736 in
                                {1301}let Kcli_1740: bitstring = h((Nc_1732,Ns_1737)) in
                                {1302}out(c, senc(mCli(pkCli_1121,pkSess_1729),Kcli_1740))
                )
                else
                    {1303}let =true = (Cli = C) in
                    (
                        {1304}let skCli_1741: bitstring = skC in
                        {1305}let pkCli_1742: bitstring = pub(skCli_1741) in
                        {1306}let v_1743: bool = (Disco = A) in
                        (
                            {1307}if v_1743 then
                            (
                                {1308}let pkDisco_1744: bitstring = pub(skA) in
                                {1309}let v_1745: bool = (Sess = A) in
                                (
                                    {1310}if v_1745 then
                                    (
                                        {1311}let pkSess_1746: bitstring = pub(skA) in
                                        {1312}out(c, GetEndpointRequest);
                                        {1313}in(c, (=GetEndpointResponse,=pkSess_1746,=Sign,SP_1747: bitstring,UP_1748: bitstring));
                                        {1314}new Nc_1749: bitstring;
                                        {1315}let m1_1750: bitstring = (OpenSecureChannelRequest,pkCli_1742,Nc_1749) in
                                        {1316}out(c, (pkCli_1742,m1_1750,sign(h(m1_1750),skCli_1741)));
                                        {1317}in(c, (em2_1751: bitstring,sigM2_1752: bitstring));
                                        {1318}let m2_1753: bitstring = em2_1751 in
                                        {1319}if (verify(h(m2_1753),sigM2_1752,pkSess_1746) <> true) then
                                            0
                                        else
                                            {1320}let (=OpenSecureChannelResponse,Ns_1754: bitstring,ST_1755: bitstring,TTL_1756: bitstring) = m2_1753 in
                                            {1321}let Kcli_1757: bitstring = h((Nc_1749,Ns_1754)) in
                                            {1322}out(c, senc(mCli(pkCli_1742,pkSess_1746),Kcli_1757))
                                    )
                                    else
                                        {1323}let v_1758: bool = (Sess = B) in
                                        (
                                            {1324}if v_1758 then
                                            (
                                                {1325}let pkSess_1759: bitstring = pub(skB) in
                                                {1326}out(c, GetEndpointRequest);
                                                {1327}in(c, (=GetEndpointResponse,=pkSess_1759,=Sign,SP_1760: bitstring,UP_1761: bitstring));
                                                {1328}new Nc_1762: bitstring;
                                                {1329}let m1_1763: bitstring = (OpenSecureChannelRequest,pkCli_1742,Nc_1762) in
                                                {1330}out(c, (pkCli_1742,m1_1763,sign(h(m1_1763),skCli_1741)));
                                                {1331}in(c, (em2_1764: bitstring,sigM2_1765: bitstring));
                                                {1332}let m2_1766: bitstring = em2_1764 in
                                                {1333}if (verify(h(m2_1766),sigM2_1765,pkSess_1759) <> true) then
                                                    0
                                                else
                                                    {1334}let (=OpenSecureChannelResponse,Ns_1767: bitstring,ST_1768: bitstring,TTL_1769: bitstring) = m2_1766 in
                                                    {1335}let Kcli_1770: bitstring = h((Nc_1762,Ns_1767)) in
                                                    {1336}out(c, senc(mCli(pkCli_1742,pkSess_1759),Kcli_1770))
                                            )
                                            else
                                                {1337}let v_1771: bool = (Sess = C) in
                                                (
                                                    {1338}if v_1771 then
                                                    (
                                                        {1339}let pkSess_1772: bitstring = pub(skC) in
                                                        {1340}out(c, GetEndpointRequest);
                                                        {1341}in(c, (=GetEndpointResponse,=pkSess_1772,=Sign,SP_1773: bitstring,UP_1774: bitstring));
                                                        {1342}new Nc_1775: bitstring;
                                                        {1343}let m1_1776: bitstring = (OpenSecureChannelRequest,pkCli_1742,Nc_1775) in
                                                        {1344}out(c, (pkCli_1742,m1_1776,sign(h(m1_1776),skCli_1741)));
                                                        {1345}in(c, (em2_1777: bitstring,sigM2_1778: bitstring));
                                                        {1346}let m2_1779: bitstring = em2_1777 in
                                                        {1347}if (verify(h(m2_1779),sigM2_1778,pkSess_1772) <> true) then
                                                            0
                                                        else
                                                            {1348}let (=OpenSecureChannelResponse,Ns_1780: bitstring,ST_1781: bitstring,TTL_1782: bitstring) = m2_1779 in
                                                            {1349}let Kcli_1783: bitstring = h((Nc_1775,Ns_1780)) in
                                                            {1350}out(c, senc(mCli(pkCli_1742,pkSess_1772),Kcli_1783))
                                                    )
                                                    else
                                                        {1351}let pkSess_1784: bitstring = pub(sk(Sess)) in
                                                        {1352}out(c, GetEndpointRequest);
                                                        {1353}in(c, (=GetEndpointResponse,=pkSess_1784,=Sign,SP_1785: bitstring,UP_1786: bitstring));
                                                        {1354}new Nc_1787: bitstring;
                                                        {1355}let m1_1788: bitstring = (OpenSecureChannelRequest,pkCli_1742,Nc_1787) in
                                                        {1356}out(c, (pkCli_1742,m1_1788,sign(h(m1_1788),skCli_1741)));
                                                        {1357}in(c, (em2_1789: bitstring,sigM2_1790: bitstring));
                                                        {1358}let m2_1791: bitstring = em2_1789 in
                                                        {1359}if (verify(h(m2_1791),sigM2_1790,pkSess_1784) <> true) then
                                                            0
                                                        else
                                                            {1360}let (=OpenSecureChannelResponse,Ns_1792: bitstring,ST_1793: bitstring,TTL_1794: bitstring) = m2_1791 in
                                                            {1361}let Kcli_1795: bitstring = h((Nc_1787,Ns_1792)) in
                                                            {1362}out(c, senc(mCli(pkCli_1742,pkSess_1784),Kcli_1795))
                                                )
                                                else
                                                    {1363}let pkSess_1796: bitstring = fail-any in
                                                    {1364}out(c, GetEndpointRequest);
                                                    {1365}in(c, (=GetEndpointResponse,=pkSess_1796,=Sign,SP_1797: bitstring,UP_1798: bitstring));
                                                    {1366}new Nc_1799: bitstring;
                                                    {1367}let m1_1800: bitstring = (OpenSecureChannelRequest,pkCli_1742,Nc_1799) in
                                                    {1368}out(c, (pkCli_1742,m1_1800,sign(h(m1_1800),skCli_1741)));
                                                    {1369}in(c, (em2_1801: bitstring,sigM2_1802: bitstring));
                                                    {1370}let m2_1803: bitstring = em2_1801 in
                                                    {1371}if (verify(h(m2_1803),sigM2_1802,pkSess_1796) <> true) then
                                                        0
                                                    else
                                                        {1372}let (=OpenSecureChannelResponse,Ns_1804: bitstring,ST_1805: bitstring,TTL_1806: bitstring) = m2_1803 in
                                                        {1373}let Kcli_1807: bitstring = h((Nc_1799,Ns_1804)) in
                                                        {1374}out(c, senc(mCli(pkCli_1742,pkSess_1796),Kcli_1807))
                                        )
                                        else
                                            {1375}let pkSess_1808: bitstring = fail-any in
                                            {1376}out(c, GetEndpointRequest);
                                            {1377}in(c, (=GetEndpointResponse,=pkSess_1808,=Sign,SP_1809: bitstring,UP_1810: bitstring));
                                            {1378}new Nc_1811: bitstring;
                                            {1379}let m1_1812: bitstring = (OpenSecureChannelRequest,pkCli_1742,Nc_1811) in
                                            {1380}out(c, (pkCli_1742,m1_1812,sign(h(m1_1812),skCli_1741)));
                                            {1381}in(c, (em2_1813: bitstring,sigM2_1814: bitstring));
                                            {1382}let m2_1815: bitstring = em2_1813 in
                                            {1383}if (verify(h(m2_1815),sigM2_1814,pkSess_1808) <> true) then
                                                0
                                            else
                                                {1384}let (=OpenSecureChannelResponse,Ns_1816: bitstring,ST_1817: bitstring,TTL_1818: bitstring) = m2_1815 in
                                                {1385}let Kcli_1819: bitstring = h((Nc_1811,Ns_1816)) in
                                                {1386}out(c, senc(mCli(pkCli_1742,pkSess_1808),Kcli_1819))
                                )
                                else
                                    {1387}let pkSess_1820: bitstring = fail-any in
                                    {1388}out(c, GetEndpointRequest);
                                    {1389}in(c, (=GetEndpointResponse,=pkSess_1820,=Sign,SP_1821: bitstring,UP_1822: bitstring));
                                    {1390}new Nc_1823: bitstring;
                                    {1391}let m1_1824: bitstring = (OpenSecureChannelRequest,pkCli_1742,Nc_1823) in
                                    {1392}out(c, (pkCli_1742,m1_1824,sign(h(m1_1824),skCli_1741)));
                                    {1393}in(c, (em2_1825: bitstring,sigM2_1826: bitstring));
                                    {1394}let m2_1827: bitstring = em2_1825 in
                                    {1395}if (verify(h(m2_1827),sigM2_1826,pkSess_1820) <> true) then
                                        0
                                    else
                                        {1396}let (=OpenSecureChannelResponse,Ns_1828: bitstring,ST_1829: bitstring,TTL_1830: bitstring) = m2_1827 in
                                        {1397}let Kcli_1831: bitstring = h((Nc_1823,Ns_1828)) in
                                        {1398}out(c, senc(mCli(pkCli_1742,pkSess_1820),Kcli_1831))
                            )
                            else
                                {1399}let v_1832: bool = (Disco = B) in
                                (
                                    {1400}if v_1832 then
                                    (
                                        {1401}let pkDisco_1833: bitstring = pub(skB) in
                                        {1402}let v_1834: bool = (Sess = A) in
                                        (
                                            {1403}if v_1834 then
                                            (
                                                {1404}let pkSess_1835: bitstring = pub(skA) in
                                                {1405}out(c, GetEndpointRequest);
                                                {1406}in(c, (=GetEndpointResponse,=pkSess_1835,=Sign,SP_1836: bitstring,UP_1837: bitstring));
                                                {1407}new Nc_1838: bitstring;
                                                {1408}let m1_1839: bitstring = (OpenSecureChannelRequest,pkCli_1742,Nc_1838) in
                                                {1409}out(c, (pkCli_1742,m1_1839,sign(h(m1_1839),skCli_1741)));
                                                {1410}in(c, (em2_1840: bitstring,sigM2_1841: bitstring));
                                                {1411}let m2_1842: bitstring = em2_1840 in
                                                {1412}if (verify(h(m2_1842),sigM2_1841,pkSess_1835) <> true) then
                                                    0
                                                else
                                                    {1413}let (=OpenSecureChannelResponse,Ns_1843: bitstring,ST_1844: bitstring,TTL_1845: bitstring) = m2_1842 in
                                                    {1414}let Kcli_1846: bitstring = h((Nc_1838,Ns_1843)) in
                                                    {1415}out(c, senc(mCli(pkCli_1742,pkSess_1835),Kcli_1846))
                                            )
                                            else
                                                {1416}let v_1847: bool = (Sess = B) in
                                                (
                                                    {1417}if v_1847 then
                                                    (
                                                        {1418}let pkSess_1848: bitstring = pub(skB) in
                                                        {1419}out(c, GetEndpointRequest);
                                                        {1420}in(c, (=GetEndpointResponse,=pkSess_1848,=Sign,SP_1849: bitstring,UP_1850: bitstring));
                                                        {1421}new Nc_1851: bitstring;
                                                        {1422}let m1_1852: bitstring = (OpenSecureChannelRequest,pkCli_1742,Nc_1851) in
                                                        {1423}out(c, (pkCli_1742,m1_1852,sign(h(m1_1852),skCli_1741)));
                                                        {1424}in(c, (em2_1853: bitstring,sigM2_1854: bitstring));
                                                        {1425}let m2_1855: bitstring = em2_1853 in
                                                        {1426}if (verify(h(m2_1855),sigM2_1854,pkSess_1848) <> true) then
                                                            0
                                                        else
                                                            {1427}let (=OpenSecureChannelResponse,Ns_1856: bitstring,ST_1857: bitstring,TTL_1858: bitstring) = m2_1855 in
                                                            {1428}let Kcli_1859: bitstring = h((Nc_1851,Ns_1856)) in
                                                            {1429}out(c, senc(mCli(pkCli_1742,pkSess_1848),Kcli_1859))
                                                    )
                                                    else
                                                        {1430}let v_1860: bool = (Sess = C) in
                                                        (
                                                            {1431}if v_1860 then
                                                            (
                                                                {1432}let pkSess_1861: bitstring = pub(skC) in
                                                                {1433}out(c, GetEndpointRequest);
                                                                {1434}in(c, (=GetEndpointResponse,=pkSess_1861,=Sign,SP_1862: bitstring,UP_1863: bitstring));
                                                                {1435}new Nc_1864: bitstring;
                                                                {1436}let m1_1865: bitstring = (OpenSecureChannelRequest,pkCli_1742,Nc_1864) in
                                                                {1437}out(c, (pkCli_1742,m1_1865,sign(h(m1_1865),skCli_1741)));
                                                                {1438}in(c, (em2_1866: bitstring,sigM2_1867: bitstring));
                                                                {1439}let m2_1868: bitstring = em2_1866 in
                                                                {1440}if (verify(h(m2_1868),sigM2_1867,pkSess_1861) <> true) then
                                                                    0
                                                                else
                                                                    {1441}let (=OpenSecureChannelResponse,Ns_1869: bitstring,ST_1870: bitstring,TTL_1871: bitstring) = m2_1868 in
                                                                    {1442}let Kcli_1872: bitstring = h((Nc_1864,Ns_1869)) in
                                                                    {1443}out(c, senc(mCli(pkCli_1742,pkSess_1861),Kcli_1872))
                                                            )
                                                            else
                                                                {1444}let pkSess_1873: bitstring = pub(sk(Sess)) in
                                                                {1445}out(c, GetEndpointRequest);
                                                                {1446}in(c, (=GetEndpointResponse,=pkSess_1873,=Sign,SP_1874: bitstring,UP_1875: bitstring));
                                                                {1447}new Nc_1876: bitstring;
                                                                {1448}let m1_1877: bitstring = (OpenSecureChannelRequest,pkCli_1742,Nc_1876) in
                                                                {1449}out(c, (pkCli_1742,m1_1877,sign(h(m1_1877),skCli_1741)));
                                                                {1450}in(c, (em2_1878: bitstring,sigM2_1879: bitstring));
                                                                {1451}let m2_1880: bitstring = em2_1878 in
                                                                {1452}if (verify(h(m2_1880),sigM2_1879,pkSess_1873) <> true) then
                                                                    0
                                                                else
                                                                    {1453}let (=OpenSecureChannelResponse,Ns_1881: bitstring,ST_1882: bitstring,TTL_1883: bitstring) = m2_1880 in
                                                                    {1454}let Kcli_1884: bitstring = h((Nc_1876,Ns_1881)) in
                                                                    {1455}out(c, senc(mCli(pkCli_1742,pkSess_1873),Kcli_1884))
                                                        )
                                                        else
                                                            {1456}let pkSess_1885: bitstring = fail-any in
                                                            {1457}out(c, GetEndpointRequest);
                                                            {1458}in(c, (=GetEndpointResponse,=pkSess_1885,=Sign,SP_1886: bitstring,UP_1887: bitstring));
                                                            {1459}new Nc_1888: bitstring;
                                                            {1460}let m1_1889: bitstring = (OpenSecureChannelRequest,pkCli_1742,Nc_1888) in
                                                            {1461}out(c, (pkCli_1742,m1_1889,sign(h(m1_1889),skCli_1741)));
                                                            {1462}in(c, (em2_1890: bitstring,sigM2_1891: bitstring));
                                                            {1463}let m2_1892: bitstring = em2_1890 in
                                                            {1464}if (verify(h(m2_1892),sigM2_1891,pkSess_1885) <> true) then
                                                                0
                                                            else
                                                                {1465}let (=OpenSecureChannelResponse,Ns_1893: bitstring,ST_1894: bitstring,TTL_1895: bitstring) = m2_1892 in
                                                                {1466}let Kcli_1896: bitstring = h((Nc_1888,Ns_1893)) in
                                                                {1467}out(c, senc(mCli(pkCli_1742,pkSess_1885),Kcli_1896))
                                                )
                                                else
                                                    {1468}let pkSess_1897: bitstring = fail-any in
                                                    {1469}out(c, GetEndpointRequest);
                                                    {1470}in(c, (=GetEndpointResponse,=pkSess_1897,=Sign,SP_1898: bitstring,UP_1899: bitstring));
                                                    {1471}new Nc_1900: bitstring;
                                                    {1472}let m1_1901: bitstring = (OpenSecureChannelRequest,pkCli_1742,Nc_1900) in
                                                    {1473}out(c, (pkCli_1742,m1_1901,sign(h(m1_1901),skCli_1741)));
                                                    {1474}in(c, (em2_1902: bitstring,sigM2_1903: bitstring));
                                                    {1475}let m2_1904: bitstring = em2_1902 in
                                                    {1476}if (verify(h(m2_1904),sigM2_1903,pkSess_1897) <> true) then
                                                        0
                                                    else
                                                        {1477}let (=OpenSecureChannelResponse,Ns_1905: bitstring,ST_1906: bitstring,TTL_1907: bitstring) = m2_1904 in
                                                        {1478}let Kcli_1908: bitstring = h((Nc_1900,Ns_1905)) in
                                                        {1479}out(c, senc(mCli(pkCli_1742,pkSess_1897),Kcli_1908))
                                        )
                                        else
                                            {1480}let pkSess_1909: bitstring = fail-any in
                                            {1481}out(c, GetEndpointRequest);
                                            {1482}in(c, (=GetEndpointResponse,=pkSess_1909,=Sign,SP_1910: bitstring,UP_1911: bitstring));
                                            {1483}new Nc_1912: bitstring;
                                            {1484}let m1_1913: bitstring = (OpenSecureChannelRequest,pkCli_1742,Nc_1912) in
                                            {1485}out(c, (pkCli_1742,m1_1913,sign(h(m1_1913),skCli_1741)));
                                            {1486}in(c, (em2_1914: bitstring,sigM2_1915: bitstring));
                                            {1487}let m2_1916: bitstring = em2_1914 in
                                            {1488}if (verify(h(m2_1916),sigM2_1915,pkSess_1909) <> true) then
                                                0
                                            else
                                                {1489}let (=OpenSecureChannelResponse,Ns_1917: bitstring,ST_1918: bitstring,TTL_1919: bitstring) = m2_1916 in
                                                {1490}let Kcli_1920: bitstring = h((Nc_1912,Ns_1917)) in
                                                {1491}out(c, senc(mCli(pkCli_1742,pkSess_1909),Kcli_1920))
                                    )
                                    else
                                        {1492}let v_1921: bool = (Disco = C) in
                                        (
                                            {1493}if v_1921 then
                                            (
                                                {1494}let pkDisco_1922: bitstring = pub(skC) in
                                                {1495}let v_1923: bool = (Sess = A) in
                                                (
                                                    {1496}if v_1923 then
                                                    (
                                                        {1497}let pkSess_1924: bitstring = pub(skA) in
                                                        {1498}out(c, GetEndpointRequest);
                                                        {1499}in(c, (=GetEndpointResponse,=pkSess_1924,=Sign,SP_1925: bitstring,UP_1926: bitstring));
                                                        {1500}new Nc_1927: bitstring;
                                                        {1501}let m1_1928: bitstring = (OpenSecureChannelRequest,pkCli_1742,Nc_1927) in
                                                        {1502}out(c, (pkCli_1742,m1_1928,sign(h(m1_1928),skCli_1741)));
                                                        {1503}in(c, (em2_1929: bitstring,sigM2_1930: bitstring));
                                                        {1504}let m2_1931: bitstring = em2_1929 in
                                                        {1505}if (verify(h(m2_1931),sigM2_1930,pkSess_1924) <> true) then
                                                            0
                                                        else
                                                            {1506}let (=OpenSecureChannelResponse,Ns_1932: bitstring,ST_1933: bitstring,TTL_1934: bitstring) = m2_1931 in
                                                            {1507}let Kcli_1935: bitstring = h((Nc_1927,Ns_1932)) in
                                                            {1508}out(c, senc(mCli(pkCli_1742,pkSess_1924),Kcli_1935))
                                                    )
                                                    else
                                                        {1509}let v_1936: bool = (Sess = B) in
                                                        (
                                                            {1510}if v_1936 then
                                                            (
                                                                {1511}let pkSess_1937: bitstring = pub(skB) in
                                                                {1512}out(c, GetEndpointRequest);
                                                                {1513}in(c, (=GetEndpointResponse,=pkSess_1937,=Sign,SP_1938: bitstring,UP_1939: bitstring));
                                                                {1514}new Nc_1940: bitstring;
                                                                {1515}let m1_1941: bitstring = (OpenSecureChannelRequest,pkCli_1742,Nc_1940) in
                                                                {1516}out(c, (pkCli_1742,m1_1941,sign(h(m1_1941),skCli_1741)));
                                                                {1517}in(c, (em2_1942: bitstring,sigM2_1943: bitstring));
                                                                {1518}let m2_1944: bitstring = em2_1942 in
                                                                {1519}if (verify(h(m2_1944),sigM2_1943,pkSess_1937) <> true) then
                                                                    0
                                                                else
                                                                    {1520}let (=OpenSecureChannelResponse,Ns_1945: bitstring,ST_1946: bitstring,TTL_1947: bitstring) = m2_1944 in
                                                                    {1521}let Kcli_1948: bitstring = h((Nc_1940,Ns_1945)) in
                                                                    {1522}out(c, senc(mCli(pkCli_1742,pkSess_1937),Kcli_1948))
                                                            )
                                                            else
                                                                {1523}let v_1949: bool = (Sess = C) in
                                                                (
                                                                    {1524}if v_1949 then
                                                                    (
                                                                        {1525}let pkSess_1950: bitstring = pub(skC) in
                                                                        {1526}out(c, GetEndpointRequest);
                                                                        {1527}in(c, (=GetEndpointResponse,=pkSess_1950,=Sign,SP_1951: bitstring,UP_1952: bitstring));
                                                                        {1528}new Nc_1953: bitstring;
                                                                        {1529}let m1_1954: bitstring = (OpenSecureChannelRequest,pkCli_1742,Nc_1953) in
                                                                        {1530}out(c, (pkCli_1742,m1_1954,sign(h(m1_1954),skCli_1741)));
                                                                        {1531}in(c, (em2_1955: bitstring,sigM2_1956: bitstring));
                                                                        {1532}let m2_1957: bitstring = em2_1955 in
                                                                        {1533}if (verify(h(m2_1957),sigM2_1956,pkSess_1950) <> true) then
                                                                            0
                                                                        else
                                                                            {1534}let (=OpenSecureChannelResponse,Ns_1958: bitstring,ST_1959: bitstring,TTL_1960: bitstring) = m2_1957 in
                                                                            {1535}let Kcli_1961: bitstring = h((Nc_1953,Ns_1958)) in
                                                                            {1536}out(c, senc(mCli(pkCli_1742,pkSess_1950),Kcli_1961))
                                                                    )
                                                                    else
                                                                        {1537}let pkSess_1962: bitstring = pub(sk(Sess)) in
                                                                        {1538}out(c, GetEndpointRequest);
                                                                        {1539}in(c, (=GetEndpointResponse,=pkSess_1962,=Sign,SP_1963: bitstring,UP_1964: bitstring));
                                                                        {1540}new Nc_1965: bitstring;
                                                                        {1541}let m1_1966: bitstring = (OpenSecureChannelRequest,pkCli_1742,Nc_1965) in
                                                                        {1542}out(c, (pkCli_1742,m1_1966,sign(h(m1_1966),skCli_1741)));
                                                                        {1543}in(c, (em2_1967: bitstring,sigM2_1968: bitstring));
                                                                        {1544}let m2_1969: bitstring = em2_1967 in
                                                                        {1545}if (verify(h(m2_1969),sigM2_1968,pkSess_1962) <> true) then
                                                                            0
                                                                        else
                                                                            {1546}let (=OpenSecureChannelResponse,Ns_1970: bitstring,ST_1971: bitstring,TTL_1972: bitstring) = m2_1969 in
                                                                            {1547}let Kcli_1973: bitstring = h((Nc_1965,Ns_1970)) in
                                                                            {1548}out(c, senc(mCli(pkCli_1742,pkSess_1962),Kcli_1973))
                                                                )
                                                                else
                                                                    {1549}let pkSess_1974: bitstring = fail-any in
                                                                    {1550}out(c, GetEndpointRequest);
                                                                    {1551}in(c, (=GetEndpointResponse,=pkSess_1974,=Sign,SP_1975: bitstring,UP_1976: bitstring));
                                                                    {1552}new Nc_1977: bitstring;
                                                                    {1553}let m1_1978: bitstring = (OpenSecureChannelRequest,pkCli_1742,Nc_1977) in
                                                                    {1554}out(c, (pkCli_1742,m1_1978,sign(h(m1_1978),skCli_1741)));
                                                                    {1555}in(c, (em2_1979: bitstring,sigM2_1980: bitstring));
                                                                    {1556}let m2_1981: bitstring = em2_1979 in
                                                                    {1557}if (verify(h(m2_1981),sigM2_1980,pkSess_1974) <> true) then
                                                                        0
                                                                    else
                                                                        {1558}let (=OpenSecureChannelResponse,Ns_1982: bitstring,ST_1983: bitstring,TTL_1984: bitstring) = m2_1981 in
                                                                        {1559}let Kcli_1985: bitstring = h((Nc_1977,Ns_1982)) in
                                                                        {1560}out(c, senc(mCli(pkCli_1742,pkSess_1974),Kcli_1985))
                                                        )
                                                        else
                                                            {1561}let pkSess_1986: bitstring = fail-any in
                                                            {1562}out(c, GetEndpointRequest);
                                                            {1563}in(c, (=GetEndpointResponse,=pkSess_1986,=Sign,SP_1987: bitstring,UP_1988: bitstring));
                                                            {1564}new Nc_1989: bitstring;
                                                            {1565}let m1_1990: bitstring = (OpenSecureChannelRequest,pkCli_1742,Nc_1989) in
                                                            {1566}out(c, (pkCli_1742,m1_1990,sign(h(m1_1990),skCli_1741)));
                                                            {1567}in(c, (em2_1991: bitstring,sigM2_1992: bitstring));
                                                            {1568}let m2_1993: bitstring = em2_1991 in
                                                            {1569}if (verify(h(m2_1993),sigM2_1992,pkSess_1986) <> true) then
                                                                0
                                                            else
                                                                {1570}let (=OpenSecureChannelResponse,Ns_1994: bitstring,ST_1995: bitstring,TTL_1996: bitstring) = m2_1993 in
                                                                {1571}let Kcli_1997: bitstring = h((Nc_1989,Ns_1994)) in
                                                                {1572}out(c, senc(mCli(pkCli_1742,pkSess_1986),Kcli_1997))
                                                )
                                                else
                                                    {1573}let pkSess_1998: bitstring = fail-any in
                                                    {1574}out(c, GetEndpointRequest);
                                                    {1575}in(c, (=GetEndpointResponse,=pkSess_1998,=Sign,SP_1999: bitstring,UP_2000: bitstring));
                                                    {1576}new Nc_2001: bitstring;
                                                    {1577}let m1_2002: bitstring = (OpenSecureChannelRequest,pkCli_1742,Nc_2001) in
                                                    {1578}out(c, (pkCli_1742,m1_2002,sign(h(m1_2002),skCli_1741)));
                                                    {1579}in(c, (em2_2003: bitstring,sigM2_2004: bitstring));
                                                    {1580}let m2_2005: bitstring = em2_2003 in
                                                    {1581}if (verify(h(m2_2005),sigM2_2004,pkSess_1998) <> true) then
                                                        0
                                                    else
                                                        {1582}let (=OpenSecureChannelResponse,Ns_2006: bitstring,ST_2007: bitstring,TTL_2008: bitstring) = m2_2005 in
                                                        {1583}let Kcli_2009: bitstring = h((Nc_2001,Ns_2006)) in
                                                        {1584}out(c, senc(mCli(pkCli_1742,pkSess_1998),Kcli_2009))
                                            )
                                            else
                                                {1585}let pkDisco_2010: bitstring = pub(sk(Disco)) in
                                                {1586}let v_2011: bool = (Sess = A) in
                                                (
                                                    {1587}if v_2011 then
                                                    (
                                                        {1588}let pkSess_2012: bitstring = pub(skA) in
                                                        {1589}out(c, GetEndpointRequest);
                                                        {1590}in(c, (=GetEndpointResponse,=pkSess_2012,=Sign,SP_2013: bitstring,UP_2014: bitstring));
                                                        {1591}new Nc_2015: bitstring;
                                                        {1592}let m1_2016: bitstring = (OpenSecureChannelRequest,pkCli_1742,Nc_2015) in
                                                        {1593}out(c, (pkCli_1742,m1_2016,sign(h(m1_2016),skCli_1741)));
                                                        {1594}in(c, (em2_2017: bitstring,sigM2_2018: bitstring));
                                                        {1595}let m2_2019: bitstring = em2_2017 in
                                                        {1596}if (verify(h(m2_2019),sigM2_2018,pkSess_2012) <> true) then
                                                            0
                                                        else
                                                            {1597}let (=OpenSecureChannelResponse,Ns_2020: bitstring,ST_2021: bitstring,TTL_2022: bitstring) = m2_2019 in
                                                            {1598}let Kcli_2023: bitstring = h((Nc_2015,Ns_2020)) in
                                                            {1599}out(c, senc(mCli(pkCli_1742,pkSess_2012),Kcli_2023))
                                                    )
                                                    else
                                                        {1600}let v_2024: bool = (Sess = B) in
                                                        (
                                                            {1601}if v_2024 then
                                                            (
                                                                {1602}let pkSess_2025: bitstring = pub(skB) in
                                                                {1603}out(c, GetEndpointRequest);
                                                                {1604}in(c, (=GetEndpointResponse,=pkSess_2025,=Sign,SP_2026: bitstring,UP_2027: bitstring));
                                                                {1605}new Nc_2028: bitstring;
                                                                {1606}let m1_2029: bitstring = (OpenSecureChannelRequest,pkCli_1742,Nc_2028) in
                                                                {1607}out(c, (pkCli_1742,m1_2029,sign(h(m1_2029),skCli_1741)));
                                                                {1608}in(c, (em2_2030: bitstring,sigM2_2031: bitstring));
                                                                {1609}let m2_2032: bitstring = em2_2030 in
                                                                {1610}if (verify(h(m2_2032),sigM2_2031,pkSess_2025) <> true) then
                                                                    0
                                                                else
                                                                    {1611}let (=OpenSecureChannelResponse,Ns_2033: bitstring,ST_2034: bitstring,TTL_2035: bitstring) = m2_2032 in
                                                                    {1612}let Kcli_2036: bitstring = h((Nc_2028,Ns_2033)) in
                                                                    {1613}out(c, senc(mCli(pkCli_1742,pkSess_2025),Kcli_2036))
                                                            )
                                                            else
                                                                {1614}let v_2037: bool = (Sess = C) in
                                                                (
                                                                    {1615}if v_2037 then
                                                                    (
                                                                        {1616}let pkSess_2038: bitstring = pub(skC) in
                                                                        {1617}out(c, GetEndpointRequest);
                                                                        {1618}in(c, (=GetEndpointResponse,=pkSess_2038,=Sign,SP_2039: bitstring,UP_2040: bitstring));
                                                                        {1619}new Nc_2041: bitstring;
                                                                        {1620}let m1_2042: bitstring = (OpenSecureChannelRequest,pkCli_1742,Nc_2041) in
                                                                        {1621}out(c, (pkCli_1742,m1_2042,sign(h(m1_2042),skCli_1741)));
                                                                        {1622}in(c, (em2_2043: bitstring,sigM2_2044: bitstring));
                                                                        {1623}let m2_2045: bitstring = em2_2043 in
                                                                        {1624}if (verify(h(m2_2045),sigM2_2044,pkSess_2038) <> true) then
                                                                            0
                                                                        else
                                                                            {1625}let (=OpenSecureChannelResponse,Ns_2046: bitstring,ST_2047: bitstring,TTL_2048: bitstring) = m2_2045 in
                                                                            {1626}let Kcli_2049: bitstring = h((Nc_2041,Ns_2046)) in
                                                                            {1627}out(c, senc(mCli(pkCli_1742,pkSess_2038),Kcli_2049))
                                                                    )
                                                                    else
                                                                        {1628}let pkSess_2050: bitstring = pub(sk(Sess)) in
                                                                        {1629}out(c, GetEndpointRequest);
                                                                        {1630}in(c, (=GetEndpointResponse,=pkSess_2050,=Sign,SP_2051: bitstring,UP_2052: bitstring));
                                                                        {1631}new Nc_2053: bitstring;
                                                                        {1632}let m1_2054: bitstring = (OpenSecureChannelRequest,pkCli_1742,Nc_2053) in
                                                                        {1633}out(c, (pkCli_1742,m1_2054,sign(h(m1_2054),skCli_1741)));
                                                                        {1634}in(c, (em2_2055: bitstring,sigM2_2056: bitstring));
                                                                        {1635}let m2_2057: bitstring = em2_2055 in
                                                                        {1636}if (verify(h(m2_2057),sigM2_2056,pkSess_2050) <> true) then
                                                                            0
                                                                        else
                                                                            {1637}let (=OpenSecureChannelResponse,Ns_2058: bitstring,ST_2059: bitstring,TTL_2060: bitstring) = m2_2057 in
                                                                            {1638}let Kcli_2061: bitstring = h((Nc_2053,Ns_2058)) in
                                                                            {1639}out(c, senc(mCli(pkCli_1742,pkSess_2050),Kcli_2061))
                                                                )
                                                                else
                                                                    {1640}let pkSess_2062: bitstring = fail-any in
                                                                    {1641}out(c, GetEndpointRequest);
                                                                    {1642}in(c, (=GetEndpointResponse,=pkSess_2062,=Sign,SP_2063: bitstring,UP_2064: bitstring));
                                                                    {1643}new Nc_2065: bitstring;
                                                                    {1644}let m1_2066: bitstring = (OpenSecureChannelRequest,pkCli_1742,Nc_2065) in
                                                                    {1645}out(c, (pkCli_1742,m1_2066,sign(h(m1_2066),skCli_1741)));
                                                                    {1646}in(c, (em2_2067: bitstring,sigM2_2068: bitstring));
                                                                    {1647}let m2_2069: bitstring = em2_2067 in
                                                                    {1648}if (verify(h(m2_2069),sigM2_2068,pkSess_2062) <> true) then
                                                                        0
                                                                    else
                                                                        {1649}let (=OpenSecureChannelResponse,Ns_2070: bitstring,ST_2071: bitstring,TTL_2072: bitstring) = m2_2069 in
                                                                        {1650}let Kcli_2073: bitstring = h((Nc_2065,Ns_2070)) in
                                                                        {1651}out(c, senc(mCli(pkCli_1742,pkSess_2062),Kcli_2073))
                                                        )
                                                        else
                                                            {1652}let pkSess_2074: bitstring = fail-any in
                                                            {1653}out(c, GetEndpointRequest);
                                                            {1654}in(c, (=GetEndpointResponse,=pkSess_2074,=Sign,SP_2075: bitstring,UP_2076: bitstring));
                                                            {1655}new Nc_2077: bitstring;
                                                            {1656}let m1_2078: bitstring = (OpenSecureChannelRequest,pkCli_1742,Nc_2077) in
                                                            {1657}out(c, (pkCli_1742,m1_2078,sign(h(m1_2078),skCli_1741)));
                                                            {1658}in(c, (em2_2079: bitstring,sigM2_2080: bitstring));
                                                            {1659}let m2_2081: bitstring = em2_2079 in
                                                            {1660}if (verify(h(m2_2081),sigM2_2080,pkSess_2074) <> true) then
                                                                0
                                                            else
                                                                {1661}let (=OpenSecureChannelResponse,Ns_2082: bitstring,ST_2083: bitstring,TTL_2084: bitstring) = m2_2081 in
                                                                {1662}let Kcli_2085: bitstring = h((Nc_2077,Ns_2082)) in
                                                                {1663}out(c, senc(mCli(pkCli_1742,pkSess_2074),Kcli_2085))
                                                )
                                                else
                                                    {1664}let pkSess_2086: bitstring = fail-any in
                                                    {1665}out(c, GetEndpointRequest);
                                                    {1666}in(c, (=GetEndpointResponse,=pkSess_2086,=Sign,SP_2087: bitstring,UP_2088: bitstring));
                                                    {1667}new Nc_2089: bitstring;
                                                    {1668}let m1_2090: bitstring = (OpenSecureChannelRequest,pkCli_1742,Nc_2089) in
                                                    {1669}out(c, (pkCli_1742,m1_2090,sign(h(m1_2090),skCli_1741)));
                                                    {1670}in(c, (em2_2091: bitstring,sigM2_2092: bitstring));
                                                    {1671}let m2_2093: bitstring = em2_2091 in
                                                    {1672}if (verify(h(m2_2093),sigM2_2092,pkSess_2086) <> true) then
                                                        0
                                                    else
                                                        {1673}let (=OpenSecureChannelResponse,Ns_2094: bitstring,ST_2095: bitstring,TTL_2096: bitstring) = m2_2093 in
                                                        {1674}let Kcli_2097: bitstring = h((Nc_2089,Ns_2094)) in
                                                        {1675}out(c, senc(mCli(pkCli_1742,pkSess_2086),Kcli_2097))
                                        )
                                        else
                                            {1676}let pkDisco_2098: bitstring = fail-any in
                                            {1677}let v_2099: bool = (Sess = A) in
                                            (
                                                {1678}if v_2099 then
                                                (
                                                    {1679}let pkSess_2100: bitstring = pub(skA) in
                                                    {1680}out(c, GetEndpointRequest);
                                                    {1681}in(c, (=GetEndpointResponse,=pkSess_2100,=Sign,SP_2101: bitstring,UP_2102: bitstring));
                                                    {1682}new Nc_2103: bitstring;
                                                    {1683}let m1_2104: bitstring = (OpenSecureChannelRequest,pkCli_1742,Nc_2103) in
                                                    {1684}out(c, (pkCli_1742,m1_2104,sign(h(m1_2104),skCli_1741)));
                                                    {1685}in(c, (em2_2105: bitstring,sigM2_2106: bitstring));
                                                    {1686}let m2_2107: bitstring = em2_2105 in
                                                    {1687}if (verify(h(m2_2107),sigM2_2106,pkSess_2100) <> true) then
                                                        0
                                                    else
                                                        {1688}let (=OpenSecureChannelResponse,Ns_2108: bitstring,ST_2109: bitstring,TTL_2110: bitstring) = m2_2107 in
                                                        {1689}let Kcli_2111: bitstring = h((Nc_2103,Ns_2108)) in
                                                        {1690}out(c, senc(mCli(pkCli_1742,pkSess_2100),Kcli_2111))
                                                )
                                                else
                                                    {1691}let v_2112: bool = (Sess = B) in
                                                    (
                                                        {1692}if v_2112 then
                                                        (
                                                            {1693}let pkSess_2113: bitstring = pub(skB) in
                                                            {1694}out(c, GetEndpointRequest);
                                                            {1695}in(c, (=GetEndpointResponse,=pkSess_2113,=Sign,SP_2114: bitstring,UP_2115: bitstring));
                                                            {1696}new Nc_2116: bitstring;
                                                            {1697}let m1_2117: bitstring = (OpenSecureChannelRequest,pkCli_1742,Nc_2116) in
                                                            {1698}out(c, (pkCli_1742,m1_2117,sign(h(m1_2117),skCli_1741)));
                                                            {1699}in(c, (em2_2118: bitstring,sigM2_2119: bitstring));
                                                            {1700}let m2_2120: bitstring = em2_2118 in
                                                            {1701}if (verify(h(m2_2120),sigM2_2119,pkSess_2113) <> true) then
                                                                0
                                                            else
                                                                {1702}let (=OpenSecureChannelResponse,Ns_2121: bitstring,ST_2122: bitstring,TTL_2123: bitstring) = m2_2120 in
                                                                {1703}let Kcli_2124: bitstring = h((Nc_2116,Ns_2121)) in
                                                                {1704}out(c, senc(mCli(pkCli_1742,pkSess_2113),Kcli_2124))
                                                        )
                                                        else
                                                            {1705}let v_2125: bool = (Sess = C) in
                                                            (
                                                                {1706}if v_2125 then
                                                                (
                                                                    {1707}let pkSess_2126: bitstring = pub(skC) in
                                                                    {1708}out(c, GetEndpointRequest);
                                                                    {1709}in(c, (=GetEndpointResponse,=pkSess_2126,=Sign,SP_2127: bitstring,UP_2128: bitstring));
                                                                    {1710}new Nc_2129: bitstring;
                                                                    {1711}let m1_2130: bitstring = (OpenSecureChannelRequest,pkCli_1742,Nc_2129) in
                                                                    {1712}out(c, (pkCli_1742,m1_2130,sign(h(m1_2130),skCli_1741)));
                                                                    {1713}in(c, (em2_2131: bitstring,sigM2_2132: bitstring));
                                                                    {1714}let m2_2133: bitstring = em2_2131 in
                                                                    {1715}if (verify(h(m2_2133),sigM2_2132,pkSess_2126) <> true) then
                                                                        0
                                                                    else
                                                                        {1716}let (=OpenSecureChannelResponse,Ns_2134: bitstring,ST_2135: bitstring,TTL_2136: bitstring) = m2_2133 in
                                                                        {1717}let Kcli_2137: bitstring = h((Nc_2129,Ns_2134)) in
                                                                        {1718}out(c, senc(mCli(pkCli_1742,pkSess_2126),Kcli_2137))
                                                                )
                                                                else
                                                                    {1719}let pkSess_2138: bitstring = pub(sk(Sess)) in
                                                                    {1720}out(c, GetEndpointRequest);
                                                                    {1721}in(c, (=GetEndpointResponse,=pkSess_2138,=Sign,SP_2139: bitstring,UP_2140: bitstring));
                                                                    {1722}new Nc_2141: bitstring;
                                                                    {1723}let m1_2142: bitstring = (OpenSecureChannelRequest,pkCli_1742,Nc_2141) in
                                                                    {1724}out(c, (pkCli_1742,m1_2142,sign(h(m1_2142),skCli_1741)));
                                                                    {1725}in(c, (em2_2143: bitstring,sigM2_2144: bitstring));
                                                                    {1726}let m2_2145: bitstring = em2_2143 in
                                                                    {1727}if (verify(h(m2_2145),sigM2_2144,pkSess_2138) <> true) then
                                                                        0
                                                                    else
                                                                        {1728}let (=OpenSecureChannelResponse,Ns_2146: bitstring,ST_2147: bitstring,TTL_2148: bitstring) = m2_2145 in
                                                                        {1729}let Kcli_2149: bitstring = h((Nc_2141,Ns_2146)) in
                                                                        {1730}out(c, senc(mCli(pkCli_1742,pkSess_2138),Kcli_2149))
                                                            )
                                                            else
                                                                {1731}let pkSess_2150: bitstring = fail-any in
                                                                {1732}out(c, GetEndpointRequest);
                                                                {1733}in(c, (=GetEndpointResponse,=pkSess_2150,=Sign,SP_2151: bitstring,UP_2152: bitstring));
                                                                {1734}new Nc_2153: bitstring;
                                                                {1735}let m1_2154: bitstring = (OpenSecureChannelRequest,pkCli_1742,Nc_2153) in
                                                                {1736}out(c, (pkCli_1742,m1_2154,sign(h(m1_2154),skCli_1741)));
                                                                {1737}in(c, (em2_2155: bitstring,sigM2_2156: bitstring));
                                                                {1738}let m2_2157: bitstring = em2_2155 in
                                                                {1739}if (verify(h(m2_2157),sigM2_2156,pkSess_2150) <> true) then
                                                                    0
                                                                else
                                                                    {1740}let (=OpenSecureChannelResponse,Ns_2158: bitstring,ST_2159: bitstring,TTL_2160: bitstring) = m2_2157 in
                                                                    {1741}let Kcli_2161: bitstring = h((Nc_2153,Ns_2158)) in
                                                                    {1742}out(c, senc(mCli(pkCli_1742,pkSess_2150),Kcli_2161))
                                                    )
                                                    else
                                                        {1743}let pkSess_2162: bitstring = fail-any in
                                                        {1744}out(c, GetEndpointRequest);
                                                        {1745}in(c, (=GetEndpointResponse,=pkSess_2162,=Sign,SP_2163: bitstring,UP_2164: bitstring));
                                                        {1746}new Nc_2165: bitstring;
                                                        {1747}let m1_2166: bitstring = (OpenSecureChannelRequest,pkCli_1742,Nc_2165) in
                                                        {1748}out(c, (pkCli_1742,m1_2166,sign(h(m1_2166),skCli_1741)));
                                                        {1749}in(c, (em2_2167: bitstring,sigM2_2168: bitstring));
                                                        {1750}let m2_2169: bitstring = em2_2167 in
                                                        {1751}if (verify(h(m2_2169),sigM2_2168,pkSess_2162) <> true) then
                                                            0
                                                        else
                                                            {1752}let (=OpenSecureChannelResponse,Ns_2170: bitstring,ST_2171: bitstring,TTL_2172: bitstring) = m2_2169 in
                                                            {1753}let Kcli_2173: bitstring = h((Nc_2165,Ns_2170)) in
                                                            {1754}out(c, senc(mCli(pkCli_1742,pkSess_2162),Kcli_2173))
                                            )
                                            else
                                                {1755}let pkSess_2174: bitstring = fail-any in
                                                {1756}out(c, GetEndpointRequest);
                                                {1757}in(c, (=GetEndpointResponse,=pkSess_2174,=Sign,SP_2175: bitstring,UP_2176: bitstring));
                                                {1758}new Nc_2177: bitstring;
                                                {1759}let m1_2178: bitstring = (OpenSecureChannelRequest,pkCli_1742,Nc_2177) in
                                                {1760}out(c, (pkCli_1742,m1_2178,sign(h(m1_2178),skCli_1741)));
                                                {1761}in(c, (em2_2179: bitstring,sigM2_2180: bitstring));
                                                {1762}let m2_2181: bitstring = em2_2179 in
                                                {1763}if (verify(h(m2_2181),sigM2_2180,pkSess_2174) <> true) then
                                                    0
                                                else
                                                    {1764}let (=OpenSecureChannelResponse,Ns_2182: bitstring,ST_2183: bitstring,TTL_2184: bitstring) = m2_2181 in
                                                    {1765}let Kcli_2185: bitstring = h((Nc_2177,Ns_2182)) in
                                                    {1766}out(c, senc(mCli(pkCli_1742,pkSess_2174),Kcli_2185))
                                )
                                else
                                    {1767}let pkDisco_2186: bitstring = fail-any in
                                    {1768}let v_2187: bool = (Sess = A) in
                                    (
                                        {1769}if v_2187 then
                                        (
                                            {1770}let pkSess_2188: bitstring = pub(skA) in
                                            {1771}out(c, GetEndpointRequest);
                                            {1772}in(c, (=GetEndpointResponse,=pkSess_2188,=Sign,SP_2189: bitstring,UP_2190: bitstring));
                                            {1773}new Nc_2191: bitstring;
                                            {1774}let m1_2192: bitstring = (OpenSecureChannelRequest,pkCli_1742,Nc_2191) in
                                            {1775}out(c, (pkCli_1742,m1_2192,sign(h(m1_2192),skCli_1741)));
                                            {1776}in(c, (em2_2193: bitstring,sigM2_2194: bitstring));
                                            {1777}let m2_2195: bitstring = em2_2193 in
                                            {1778}if (verify(h(m2_2195),sigM2_2194,pkSess_2188) <> true) then
                                                0
                                            else
                                                {1779}let (=OpenSecureChannelResponse,Ns_2196: bitstring,ST_2197: bitstring,TTL_2198: bitstring) = m2_2195 in
                                                {1780}let Kcli_2199: bitstring = h((Nc_2191,Ns_2196)) in
                                                {1781}out(c, senc(mCli(pkCli_1742,pkSess_2188),Kcli_2199))
                                        )
                                        else
                                            {1782}let v_2200: bool = (Sess = B) in
                                            (
                                                {1783}if v_2200 then
                                                (
                                                    {1784}let pkSess_2201: bitstring = pub(skB) in
                                                    {1785}out(c, GetEndpointRequest);
                                                    {1786}in(c, (=GetEndpointResponse,=pkSess_2201,=Sign,SP_2202: bitstring,UP_2203: bitstring));
                                                    {1787}new Nc_2204: bitstring;
                                                    {1788}let m1_2205: bitstring = (OpenSecureChannelRequest,pkCli_1742,Nc_2204) in
                                                    {1789}out(c, (pkCli_1742,m1_2205,sign(h(m1_2205),skCli_1741)));
                                                    {1790}in(c, (em2_2206: bitstring,sigM2_2207: bitstring));
                                                    {1791}let m2_2208: bitstring = em2_2206 in
                                                    {1792}if (verify(h(m2_2208),sigM2_2207,pkSess_2201) <> true) then
                                                        0
                                                    else
                                                        {1793}let (=OpenSecureChannelResponse,Ns_2209: bitstring,ST_2210: bitstring,TTL_2211: bitstring) = m2_2208 in
                                                        {1794}let Kcli_2212: bitstring = h((Nc_2204,Ns_2209)) in
                                                        {1795}out(c, senc(mCli(pkCli_1742,pkSess_2201),Kcli_2212))
                                                )
                                                else
                                                    {1796}let v_2213: bool = (Sess = C) in
                                                    (
                                                        {1797}if v_2213 then
                                                        (
                                                            {1798}let pkSess_2214: bitstring = pub(skC) in
                                                            {1799}out(c, GetEndpointRequest);
                                                            {1800}in(c, (=GetEndpointResponse,=pkSess_2214,=Sign,SP_2215: bitstring,UP_2216: bitstring));
                                                            {1801}new Nc_2217: bitstring;
                                                            {1802}let m1_2218: bitstring = (OpenSecureChannelRequest,pkCli_1742,Nc_2217) in
                                                            {1803}out(c, (pkCli_1742,m1_2218,sign(h(m1_2218),skCli_1741)));
                                                            {1804}in(c, (em2_2219: bitstring,sigM2_2220: bitstring));
                                                            {1805}let m2_2221: bitstring = em2_2219 in
                                                            {1806}if (verify(h(m2_2221),sigM2_2220,pkSess_2214) <> true) then
                                                                0
                                                            else
                                                                {1807}let (=OpenSecureChannelResponse,Ns_2222: bitstring,ST_2223: bitstring,TTL_2224: bitstring) = m2_2221 in
                                                                {1808}let Kcli_2225: bitstring = h((Nc_2217,Ns_2222)) in
                                                                {1809}out(c, senc(mCli(pkCli_1742,pkSess_2214),Kcli_2225))
                                                        )
                                                        else
                                                            {1810}let pkSess_2226: bitstring = pub(sk(Sess)) in
                                                            {1811}out(c, GetEndpointRequest);
                                                            {1812}in(c, (=GetEndpointResponse,=pkSess_2226,=Sign,SP_2227: bitstring,UP_2228: bitstring));
                                                            {1813}new Nc_2229: bitstring;
                                                            {1814}let m1_2230: bitstring = (OpenSecureChannelRequest,pkCli_1742,Nc_2229) in
                                                            {1815}out(c, (pkCli_1742,m1_2230,sign(h(m1_2230),skCli_1741)));
                                                            {1816}in(c, (em2_2231: bitstring,sigM2_2232: bitstring));
                                                            {1817}let m2_2233: bitstring = em2_2231 in
                                                            {1818}if (verify(h(m2_2233),sigM2_2232,pkSess_2226) <> true) then
                                                                0
                                                            else
                                                                {1819}let (=OpenSecureChannelResponse,Ns_2234: bitstring,ST_2235: bitstring,TTL_2236: bitstring) = m2_2233 in
                                                                {1820}let Kcli_2237: bitstring = h((Nc_2229,Ns_2234)) in
                                                                {1821}out(c, senc(mCli(pkCli_1742,pkSess_2226),Kcli_2237))
                                                    )
                                                    else
                                                        {1822}let pkSess_2238: bitstring = fail-any in
                                                        {1823}out(c, GetEndpointRequest);
                                                        {1824}in(c, (=GetEndpointResponse,=pkSess_2238,=Sign,SP_2239: bitstring,UP_2240: bitstring));
                                                        {1825}new Nc_2241: bitstring;
                                                        {1826}let m1_2242: bitstring = (OpenSecureChannelRequest,pkCli_1742,Nc_2241) in
                                                        {1827}out(c, (pkCli_1742,m1_2242,sign(h(m1_2242),skCli_1741)));
                                                        {1828}in(c, (em2_2243: bitstring,sigM2_2244: bitstring));
                                                        {1829}let m2_2245: bitstring = em2_2243 in
                                                        {1830}if (verify(h(m2_2245),sigM2_2244,pkSess_2238) <> true) then
                                                            0
                                                        else
                                                            {1831}let (=OpenSecureChannelResponse,Ns_2246: bitstring,ST_2247: bitstring,TTL_2248: bitstring) = m2_2245 in
                                                            {1832}let Kcli_2249: bitstring = h((Nc_2241,Ns_2246)) in
                                                            {1833}out(c, senc(mCli(pkCli_1742,pkSess_2238),Kcli_2249))
                                            )
                                            else
                                                {1834}let pkSess_2250: bitstring = fail-any in
                                                {1835}out(c, GetEndpointRequest);
                                                {1836}in(c, (=GetEndpointResponse,=pkSess_2250,=Sign,SP_2251: bitstring,UP_2252: bitstring));
                                                {1837}new Nc_2253: bitstring;
                                                {1838}let m1_2254: bitstring = (OpenSecureChannelRequest,pkCli_1742,Nc_2253) in
                                                {1839}out(c, (pkCli_1742,m1_2254,sign(h(m1_2254),skCli_1741)));
                                                {1840}in(c, (em2_2255: bitstring,sigM2_2256: bitstring));
                                                {1841}let m2_2257: bitstring = em2_2255 in
                                                {1842}if (verify(h(m2_2257),sigM2_2256,pkSess_2250) <> true) then
                                                    0
                                                else
                                                    {1843}let (=OpenSecureChannelResponse,Ns_2258: bitstring,ST_2259: bitstring,TTL_2260: bitstring) = m2_2257 in
                                                    {1844}let Kcli_2261: bitstring = h((Nc_2253,Ns_2258)) in
                                                    {1845}out(c, senc(mCli(pkCli_1742,pkSess_2250),Kcli_2261))
                                    )
                                    else
                                        {1846}let pkSess_2262: bitstring = fail-any in
                                        {1847}out(c, GetEndpointRequest);
                                        {1848}in(c, (=GetEndpointResponse,=pkSess_2262,=Sign,SP_2263: bitstring,UP_2264: bitstring));
                                        {1849}new Nc_2265: bitstring;
                                        {1850}let m1_2266: bitstring = (OpenSecureChannelRequest,pkCli_1742,Nc_2265) in
                                        {1851}out(c, (pkCli_1742,m1_2266,sign(h(m1_2266),skCli_1741)));
                                        {1852}in(c, (em2_2267: bitstring,sigM2_2268: bitstring));
                                        {1853}let m2_2269: bitstring = em2_2267 in
                                        {1854}if (verify(h(m2_2269),sigM2_2268,pkSess_2262) <> true) then
                                            0
                                        else
                                            {1855}let (=OpenSecureChannelResponse,Ns_2270: bitstring,ST_2271: bitstring,TTL_2272: bitstring) = m2_2269 in
                                            {1856}let Kcli_2273: bitstring = h((Nc_2265,Ns_2270)) in
                                            {1857}out(c, senc(mCli(pkCli_1742,pkSess_2262),Kcli_2273))
                        )
                        else
                            {1858}let pkDisco_2274: bitstring = fail-any in
                            {1859}let v_2275: bool = (Sess = A) in
                            (
                                {1860}if v_2275 then
                                (
                                    {1861}let pkSess_2276: bitstring = pub(skA) in
                                    {1862}out(c, GetEndpointRequest);
                                    {1863}in(c, (=GetEndpointResponse,=pkSess_2276,=Sign,SP_2277: bitstring,UP_2278: bitstring));
                                    {1864}new Nc_2279: bitstring;
                                    {1865}let m1_2280: bitstring = (OpenSecureChannelRequest,pkCli_1742,Nc_2279) in
                                    {1866}out(c, (pkCli_1742,m1_2280,sign(h(m1_2280),skCli_1741)));
                                    {1867}in(c, (em2_2281: bitstring,sigM2_2282: bitstring));
                                    {1868}let m2_2283: bitstring = em2_2281 in
                                    {1869}if (verify(h(m2_2283),sigM2_2282,pkSess_2276) <> true) then
                                        0
                                    else
                                        {1870}let (=OpenSecureChannelResponse,Ns_2284: bitstring,ST_2285: bitstring,TTL_2286: bitstring) = m2_2283 in
                                        {1871}let Kcli_2287: bitstring = h((Nc_2279,Ns_2284)) in
                                        {1872}out(c, senc(mCli(pkCli_1742,pkSess_2276),Kcli_2287))
                                )
                                else
                                    {1873}let v_2288: bool = (Sess = B) in
                                    (
                                        {1874}if v_2288 then
                                        (
                                            {1875}let pkSess_2289: bitstring = pub(skB) in
                                            {1876}out(c, GetEndpointRequest);
                                            {1877}in(c, (=GetEndpointResponse,=pkSess_2289,=Sign,SP_2290: bitstring,UP_2291: bitstring));
                                            {1878}new Nc_2292: bitstring;
                                            {1879}let m1_2293: bitstring = (OpenSecureChannelRequest,pkCli_1742,Nc_2292) in
                                            {1880}out(c, (pkCli_1742,m1_2293,sign(h(m1_2293),skCli_1741)));
                                            {1881}in(c, (em2_2294: bitstring,sigM2_2295: bitstring));
                                            {1882}let m2_2296: bitstring = em2_2294 in
                                            {1883}if (verify(h(m2_2296),sigM2_2295,pkSess_2289) <> true) then
                                                0
                                            else
                                                {1884}let (=OpenSecureChannelResponse,Ns_2297: bitstring,ST_2298: bitstring,TTL_2299: bitstring) = m2_2296 in
                                                {1885}let Kcli_2300: bitstring = h((Nc_2292,Ns_2297)) in
                                                {1886}out(c, senc(mCli(pkCli_1742,pkSess_2289),Kcli_2300))
                                        )
                                        else
                                            {1887}let v_2301: bool = (Sess = C) in
                                            (
                                                {1888}if v_2301 then
                                                (
                                                    {1889}let pkSess_2302: bitstring = pub(skC) in
                                                    {1890}out(c, GetEndpointRequest);
                                                    {1891}in(c, (=GetEndpointResponse,=pkSess_2302,=Sign,SP_2303: bitstring,UP_2304: bitstring));
                                                    {1892}new Nc_2305: bitstring;
                                                    {1893}let m1_2306: bitstring = (OpenSecureChannelRequest,pkCli_1742,Nc_2305) in
                                                    {1894}out(c, (pkCli_1742,m1_2306,sign(h(m1_2306),skCli_1741)));
                                                    {1895}in(c, (em2_2307: bitstring,sigM2_2308: bitstring));
                                                    {1896}let m2_2309: bitstring = em2_2307 in
                                                    {1897}if (verify(h(m2_2309),sigM2_2308,pkSess_2302) <> true) then
                                                        0
                                                    else
                                                        {1898}let (=OpenSecureChannelResponse,Ns_2310: bitstring,ST_2311: bitstring,TTL_2312: bitstring) = m2_2309 in
                                                        {1899}let Kcli_2313: bitstring = h((Nc_2305,Ns_2310)) in
                                                        {1900}out(c, senc(mCli(pkCli_1742,pkSess_2302),Kcli_2313))
                                                )
                                                else
                                                    {1901}let pkSess_2314: bitstring = pub(sk(Sess)) in
                                                    {1902}out(c, GetEndpointRequest);
                                                    {1903}in(c, (=GetEndpointResponse,=pkSess_2314,=Sign,SP_2315: bitstring,UP_2316: bitstring));
                                                    {1904}new Nc_2317: bitstring;
                                                    {1905}let m1_2318: bitstring = (OpenSecureChannelRequest,pkCli_1742,Nc_2317) in
                                                    {1906}out(c, (pkCli_1742,m1_2318,sign(h(m1_2318),skCli_1741)));
                                                    {1907}in(c, (em2_2319: bitstring,sigM2_2320: bitstring));
                                                    {1908}let m2_2321: bitstring = em2_2319 in
                                                    {1909}if (verify(h(m2_2321),sigM2_2320,pkSess_2314) <> true) then
                                                        0
                                                    else
                                                        {1910}let (=OpenSecureChannelResponse,Ns_2322: bitstring,ST_2323: bitstring,TTL_2324: bitstring) = m2_2321 in
                                                        {1911}let Kcli_2325: bitstring = h((Nc_2317,Ns_2322)) in
                                                        {1912}out(c, senc(mCli(pkCli_1742,pkSess_2314),Kcli_2325))
                                            )
                                            else
                                                {1913}let pkSess_2326: bitstring = fail-any in
                                                {1914}out(c, GetEndpointRequest);
                                                {1915}in(c, (=GetEndpointResponse,=pkSess_2326,=Sign,SP_2327: bitstring,UP_2328: bitstring));
                                                {1916}new Nc_2329: bitstring;
                                                {1917}let m1_2330: bitstring = (OpenSecureChannelRequest,pkCli_1742,Nc_2329) in
                                                {1918}out(c, (pkCli_1742,m1_2330,sign(h(m1_2330),skCli_1741)));
                                                {1919}in(c, (em2_2331: bitstring,sigM2_2332: bitstring));
                                                {1920}let m2_2333: bitstring = em2_2331 in
                                                {1921}if (verify(h(m2_2333),sigM2_2332,pkSess_2326) <> true) then
                                                    0
                                                else
                                                    {1922}let (=OpenSecureChannelResponse,Ns_2334: bitstring,ST_2335: bitstring,TTL_2336: bitstring) = m2_2333 in
                                                    {1923}let Kcli_2337: bitstring = h((Nc_2329,Ns_2334)) in
                                                    {1924}out(c, senc(mCli(pkCli_1742,pkSess_2326),Kcli_2337))
                                    )
                                    else
                                        {1925}let pkSess_2338: bitstring = fail-any in
                                        {1926}out(c, GetEndpointRequest);
                                        {1927}in(c, (=GetEndpointResponse,=pkSess_2338,=Sign,SP_2339: bitstring,UP_2340: bitstring));
                                        {1928}new Nc_2341: bitstring;
                                        {1929}let m1_2342: bitstring = (OpenSecureChannelRequest,pkCli_1742,Nc_2341) in
                                        {1930}out(c, (pkCli_1742,m1_2342,sign(h(m1_2342),skCli_1741)));
                                        {1931}in(c, (em2_2343: bitstring,sigM2_2344: bitstring));
                                        {1932}let m2_2345: bitstring = em2_2343 in
                                        {1933}if (verify(h(m2_2345),sigM2_2344,pkSess_2338) <> true) then
                                            0
                                        else
                                            {1934}let (=OpenSecureChannelResponse,Ns_2346: bitstring,ST_2347: bitstring,TTL_2348: bitstring) = m2_2345 in
                                            {1935}let Kcli_2349: bitstring = h((Nc_2341,Ns_2346)) in
                                            {1936}out(c, senc(mCli(pkCli_1742,pkSess_2338),Kcli_2349))
                            )
                            else
                                {1937}let pkSess_2350: bitstring = fail-any in
                                {1938}out(c, GetEndpointRequest);
                                {1939}in(c, (=GetEndpointResponse,=pkSess_2350,=Sign,SP_2351: bitstring,UP_2352: bitstring));
                                {1940}new Nc_2353: bitstring;
                                {1941}let m1_2354: bitstring = (OpenSecureChannelRequest,pkCli_1742,Nc_2353) in
                                {1942}out(c, (pkCli_1742,m1_2354,sign(h(m1_2354),skCli_1741)));
                                {1943}in(c, (em2_2355: bitstring,sigM2_2356: bitstring));
                                {1944}let m2_2357: bitstring = em2_2355 in
                                {1945}if (verify(h(m2_2357),sigM2_2356,pkSess_2350) <> true) then
                                    0
                                else
                                    {1946}let (=OpenSecureChannelResponse,Ns_2358: bitstring,ST_2359: bitstring,TTL_2360: bitstring) = m2_2357 in
                                    {1947}let Kcli_2361: bitstring = h((Nc_2353,Ns_2358)) in
                                    {1948}out(c, senc(mCli(pkCli_1742,pkSess_2350),Kcli_2361))
                    )
                    else
                        {1949}let skCli_2362: bitstring = fail-any in
                        {1950}let pkCli_2363: bitstring = pub(skCli_2362) in
                        {1951}let v_2364: bool = (Disco = A) in
                        (
                            {1952}if v_2364 then
                            (
                                {1953}let pkDisco_2365: bitstring = pub(skA) in
                                {1954}let v_2366: bool = (Sess = A) in
                                (
                                    {1955}if v_2366 then
                                    (
                                        {1956}let pkSess_2367: bitstring = pub(skA) in
                                        {1957}out(c, GetEndpointRequest);
                                        {1958}in(c, (=GetEndpointResponse,=pkSess_2367,=Sign,SP_2368: bitstring,UP_2369: bitstring));
                                        {1959}new Nc_2370: bitstring;
                                        {1960}let m1_2371: bitstring = (OpenSecureChannelRequest,pkCli_2363,Nc_2370) in
                                        {1961}out(c, (pkCli_2363,m1_2371,sign(h(m1_2371),skCli_2362)));
                                        {1962}in(c, (em2_2372: bitstring,sigM2_2373: bitstring));
                                        {1963}let m2_2374: bitstring = em2_2372 in
                                        {1964}if (verify(h(m2_2374),sigM2_2373,pkSess_2367) <> true) then
                                            0
                                        else
                                            {1965}let (=OpenSecureChannelResponse,Ns_2375: bitstring,ST_2376: bitstring,TTL_2377: bitstring) = m2_2374 in
                                            {1966}let Kcli_2378: bitstring = h((Nc_2370,Ns_2375)) in
                                            {1967}out(c, senc(mCli(pkCli_2363,pkSess_2367),Kcli_2378))
                                    )
                                    else
                                        {1968}let v_2379: bool = (Sess = B) in
                                        (
                                            {1969}if v_2379 then
                                            (
                                                {1970}let pkSess_2380: bitstring = pub(skB) in
                                                {1971}out(c, GetEndpointRequest);
                                                {1972}in(c, (=GetEndpointResponse,=pkSess_2380,=Sign,SP_2381: bitstring,UP_2382: bitstring));
                                                {1973}new Nc_2383: bitstring;
                                                {1974}let m1_2384: bitstring = (OpenSecureChannelRequest,pkCli_2363,Nc_2383) in
                                                {1975}out(c, (pkCli_2363,m1_2384,sign(h(m1_2384),skCli_2362)));
                                                {1976}in(c, (em2_2385: bitstring,sigM2_2386: bitstring));
                                                {1977}let m2_2387: bitstring = em2_2385 in
                                                {1978}if (verify(h(m2_2387),sigM2_2386,pkSess_2380) <> true) then
                                                    0
                                                else
                                                    {1979}let (=OpenSecureChannelResponse,Ns_2388: bitstring,ST_2389: bitstring,TTL_2390: bitstring) = m2_2387 in
                                                    {1980}let Kcli_2391: bitstring = h((Nc_2383,Ns_2388)) in
                                                    {1981}out(c, senc(mCli(pkCli_2363,pkSess_2380),Kcli_2391))
                                            )
                                            else
                                                {1982}let v_2392: bool = (Sess = C) in
                                                (
                                                    {1983}if v_2392 then
                                                    (
                                                        {1984}let pkSess_2393: bitstring = pub(skC) in
                                                        {1985}out(c, GetEndpointRequest);
                                                        {1986}in(c, (=GetEndpointResponse,=pkSess_2393,=Sign,SP_2394: bitstring,UP_2395: bitstring));
                                                        {1987}new Nc_2396: bitstring;
                                                        {1988}let m1_2397: bitstring = (OpenSecureChannelRequest,pkCli_2363,Nc_2396) in
                                                        {1989}out(c, (pkCli_2363,m1_2397,sign(h(m1_2397),skCli_2362)));
                                                        {1990}in(c, (em2_2398: bitstring,sigM2_2399: bitstring));
                                                        {1991}let m2_2400: bitstring = em2_2398 in
                                                        {1992}if (verify(h(m2_2400),sigM2_2399,pkSess_2393) <> true) then
                                                            0
                                                        else
                                                            {1993}let (=OpenSecureChannelResponse,Ns_2401: bitstring,ST_2402: bitstring,TTL_2403: bitstring) = m2_2400 in
                                                            {1994}let Kcli_2404: bitstring = h((Nc_2396,Ns_2401)) in
                                                            {1995}out(c, senc(mCli(pkCli_2363,pkSess_2393),Kcli_2404))
                                                    )
                                                    else
                                                        {1996}let pkSess_2405: bitstring = pub(sk(Sess)) in
                                                        {1997}out(c, GetEndpointRequest);
                                                        {1998}in(c, (=GetEndpointResponse,=pkSess_2405,=Sign,SP_2406: bitstring,UP_2407: bitstring));
                                                        {1999}new Nc_2408: bitstring;
                                                        {2000}let m1_2409: bitstring = (OpenSecureChannelRequest,pkCli_2363,Nc_2408) in
                                                        {2001}out(c, (pkCli_2363,m1_2409,sign(h(m1_2409),skCli_2362)));
                                                        {2002}in(c, (em2_2410: bitstring,sigM2_2411: bitstring));
                                                        {2003}let m2_2412: bitstring = em2_2410 in
                                                        {2004}if (verify(h(m2_2412),sigM2_2411,pkSess_2405) <> true) then
                                                            0
                                                        else
                                                            {2005}let (=OpenSecureChannelResponse,Ns_2413: bitstring,ST_2414: bitstring,TTL_2415: bitstring) = m2_2412 in
                                                            {2006}let Kcli_2416: bitstring = h((Nc_2408,Ns_2413)) in
                                                            {2007}out(c, senc(mCli(pkCli_2363,pkSess_2405),Kcli_2416))
                                                )
                                                else
                                                    {2008}let pkSess_2417: bitstring = fail-any in
                                                    {2009}out(c, GetEndpointRequest);
                                                    {2010}in(c, (=GetEndpointResponse,=pkSess_2417,=Sign,SP_2418: bitstring,UP_2419: bitstring));
                                                    {2011}new Nc_2420: bitstring;
                                                    {2012}let m1_2421: bitstring = (OpenSecureChannelRequest,pkCli_2363,Nc_2420) in
                                                    {2013}out(c, (pkCli_2363,m1_2421,sign(h(m1_2421),skCli_2362)));
                                                    {2014}in(c, (em2_2422: bitstring,sigM2_2423: bitstring));
                                                    {2015}let m2_2424: bitstring = em2_2422 in
                                                    {2016}if (verify(h(m2_2424),sigM2_2423,pkSess_2417) <> true) then
                                                        0
                                                    else
                                                        {2017}let (=OpenSecureChannelResponse,Ns_2425: bitstring,ST_2426: bitstring,TTL_2427: bitstring) = m2_2424 in
                                                        {2018}let Kcli_2428: bitstring = h((Nc_2420,Ns_2425)) in
                                                        {2019}out(c, senc(mCli(pkCli_2363,pkSess_2417),Kcli_2428))
                                        )
                                        else
                                            {2020}let pkSess_2429: bitstring = fail-any in
                                            {2021}out(c, GetEndpointRequest);
                                            {2022}in(c, (=GetEndpointResponse,=pkSess_2429,=Sign,SP_2430: bitstring,UP_2431: bitstring));
                                            {2023}new Nc_2432: bitstring;
                                            {2024}let m1_2433: bitstring = (OpenSecureChannelRequest,pkCli_2363,Nc_2432) in
                                            {2025}out(c, (pkCli_2363,m1_2433,sign(h(m1_2433),skCli_2362)));
                                            {2026}in(c, (em2_2434: bitstring,sigM2_2435: bitstring));
                                            {2027}let m2_2436: bitstring = em2_2434 in
                                            {2028}if (verify(h(m2_2436),sigM2_2435,pkSess_2429) <> true) then
                                                0
                                            else
                                                {2029}let (=OpenSecureChannelResponse,Ns_2437: bitstring,ST_2438: bitstring,TTL_2439: bitstring) = m2_2436 in
                                                {2030}let Kcli_2440: bitstring = h((Nc_2432,Ns_2437)) in
                                                {2031}out(c, senc(mCli(pkCli_2363,pkSess_2429),Kcli_2440))
                                )
                                else
                                    {2032}let pkSess_2441: bitstring = fail-any in
                                    {2033}out(c, GetEndpointRequest);
                                    {2034}in(c, (=GetEndpointResponse,=pkSess_2441,=Sign,SP_2442: bitstring,UP_2443: bitstring));
                                    {2035}new Nc_2444: bitstring;
                                    {2036}let m1_2445: bitstring = (OpenSecureChannelRequest,pkCli_2363,Nc_2444) in
                                    {2037}out(c, (pkCli_2363,m1_2445,sign(h(m1_2445),skCli_2362)));
                                    {2038}in(c, (em2_2446: bitstring,sigM2_2447: bitstring));
                                    {2039}let m2_2448: bitstring = em2_2446 in
                                    {2040}if (verify(h(m2_2448),sigM2_2447,pkSess_2441) <> true) then
                                        0
                                    else
                                        {2041}let (=OpenSecureChannelResponse,Ns_2449: bitstring,ST_2450: bitstring,TTL_2451: bitstring) = m2_2448 in
                                        {2042}let Kcli_2452: bitstring = h((Nc_2444,Ns_2449)) in
                                        {2043}out(c, senc(mCli(pkCli_2363,pkSess_2441),Kcli_2452))
                            )
                            else
                                {2044}let v_2453: bool = (Disco = B) in
                                (
                                    {2045}if v_2453 then
                                    (
                                        {2046}let pkDisco_2454: bitstring = pub(skB) in
                                        {2047}let v_2455: bool = (Sess = A) in
                                        (
                                            {2048}if v_2455 then
                                            (
                                                {2049}let pkSess_2456: bitstring = pub(skA) in
                                                {2050}out(c, GetEndpointRequest);
                                                {2051}in(c, (=GetEndpointResponse,=pkSess_2456,=Sign,SP_2457: bitstring,UP_2458: bitstring));
                                                {2052}new Nc_2459: bitstring;
                                                {2053}let m1_2460: bitstring = (OpenSecureChannelRequest,pkCli_2363,Nc_2459) in
                                                {2054}out(c, (pkCli_2363,m1_2460,sign(h(m1_2460),skCli_2362)));
                                                {2055}in(c, (em2_2461: bitstring,sigM2_2462: bitstring));
                                                {2056}let m2_2463: bitstring = em2_2461 in
                                                {2057}if (verify(h(m2_2463),sigM2_2462,pkSess_2456) <> true) then
                                                    0
                                                else
                                                    {2058}let (=OpenSecureChannelResponse,Ns_2464: bitstring,ST_2465: bitstring,TTL_2466: bitstring) = m2_2463 in
                                                    {2059}let Kcli_2467: bitstring = h((Nc_2459,Ns_2464)) in
                                                    {2060}out(c, senc(mCli(pkCli_2363,pkSess_2456),Kcli_2467))
                                            )
                                            else
                                                {2061}let v_2468: bool = (Sess = B) in
                                                (
                                                    {2062}if v_2468 then
                                                    (
                                                        {2063}let pkSess_2469: bitstring = pub(skB) in
                                                        {2064}out(c, GetEndpointRequest);
                                                        {2065}in(c, (=GetEndpointResponse,=pkSess_2469,=Sign,SP_2470: bitstring,UP_2471: bitstring));
                                                        {2066}new Nc_2472: bitstring;
                                                        {2067}let m1_2473: bitstring = (OpenSecureChannelRequest,pkCli_2363,Nc_2472) in
                                                        {2068}out(c, (pkCli_2363,m1_2473,sign(h(m1_2473),skCli_2362)));
                                                        {2069}in(c, (em2_2474: bitstring,sigM2_2475: bitstring));
                                                        {2070}let m2_2476: bitstring = em2_2474 in
                                                        {2071}if (verify(h(m2_2476),sigM2_2475,pkSess_2469) <> true) then
                                                            0
                                                        else
                                                            {2072}let (=OpenSecureChannelResponse,Ns_2477: bitstring,ST_2478: bitstring,TTL_2479: bitstring) = m2_2476 in
                                                            {2073}let Kcli_2480: bitstring = h((Nc_2472,Ns_2477)) in
                                                            {2074}out(c, senc(mCli(pkCli_2363,pkSess_2469),Kcli_2480))
                                                    )
                                                    else
                                                        {2075}let v_2481: bool = (Sess = C) in
                                                        (
                                                            {2076}if v_2481 then
                                                            (
                                                                {2077}let pkSess_2482: bitstring = pub(skC) in
                                                                {2078}out(c, GetEndpointRequest);
                                                                {2079}in(c, (=GetEndpointResponse,=pkSess_2482,=Sign,SP_2483: bitstring,UP_2484: bitstring));
                                                                {2080}new Nc_2485: bitstring;
                                                                {2081}let m1_2486: bitstring = (OpenSecureChannelRequest,pkCli_2363,Nc_2485) in
                                                                {2082}out(c, (pkCli_2363,m1_2486,sign(h(m1_2486),skCli_2362)));
                                                                {2083}in(c, (em2_2487: bitstring,sigM2_2488: bitstring));
                                                                {2084}let m2_2489: bitstring = em2_2487 in
                                                                {2085}if (verify(h(m2_2489),sigM2_2488,pkSess_2482) <> true) then
                                                                    0
                                                                else
                                                                    {2086}let (=OpenSecureChannelResponse,Ns_2490: bitstring,ST_2491: bitstring,TTL_2492: bitstring) = m2_2489 in
                                                                    {2087}let Kcli_2493: bitstring = h((Nc_2485,Ns_2490)) in
                                                                    {2088}out(c, senc(mCli(pkCli_2363,pkSess_2482),Kcli_2493))
                                                            )
                                                            else
                                                                {2089}let pkSess_2494: bitstring = pub(sk(Sess)) in
                                                                {2090}out(c, GetEndpointRequest);
                                                                {2091}in(c, (=GetEndpointResponse,=pkSess_2494,=Sign,SP_2495: bitstring,UP_2496: bitstring));
                                                                {2092}new Nc_2497: bitstring;
                                                                {2093}let m1_2498: bitstring = (OpenSecureChannelRequest,pkCli_2363,Nc_2497) in
                                                                {2094}out(c, (pkCli_2363,m1_2498,sign(h(m1_2498),skCli_2362)));
                                                                {2095}in(c, (em2_2499: bitstring,sigM2_2500: bitstring));
                                                                {2096}let m2_2501: bitstring = em2_2499 in
                                                                {2097}if (verify(h(m2_2501),sigM2_2500,pkSess_2494) <> true) then
                                                                    0
                                                                else
                                                                    {2098}let (=OpenSecureChannelResponse,Ns_2502: bitstring,ST_2503: bitstring,TTL_2504: bitstring) = m2_2501 in
                                                                    {2099}let Kcli_2505: bitstring = h((Nc_2497,Ns_2502)) in
                                                                    {2100}out(c, senc(mCli(pkCli_2363,pkSess_2494),Kcli_2505))
                                                        )
                                                        else
                                                            {2101}let pkSess_2506: bitstring = fail-any in
                                                            {2102}out(c, GetEndpointRequest);
                                                            {2103}in(c, (=GetEndpointResponse,=pkSess_2506,=Sign,SP_2507: bitstring,UP_2508: bitstring));
                                                            {2104}new Nc_2509: bitstring;
                                                            {2105}let m1_2510: bitstring = (OpenSecureChannelRequest,pkCli_2363,Nc_2509) in
                                                            {2106}out(c, (pkCli_2363,m1_2510,sign(h(m1_2510),skCli_2362)));
                                                            {2107}in(c, (em2_2511: bitstring,sigM2_2512: bitstring));
                                                            {2108}let m2_2513: bitstring = em2_2511 in
                                                            {2109}if (verify(h(m2_2513),sigM2_2512,pkSess_2506) <> true) then
                                                                0
                                                            else
                                                                {2110}let (=OpenSecureChannelResponse,Ns_2514: bitstring,ST_2515: bitstring,TTL_2516: bitstring) = m2_2513 in
                                                                {2111}let Kcli_2517: bitstring = h((Nc_2509,Ns_2514)) in
                                                                {2112}out(c, senc(mCli(pkCli_2363,pkSess_2506),Kcli_2517))
                                                )
                                                else
                                                    {2113}let pkSess_2518: bitstring = fail-any in
                                                    {2114}out(c, GetEndpointRequest);
                                                    {2115}in(c, (=GetEndpointResponse,=pkSess_2518,=Sign,SP_2519: bitstring,UP_2520: bitstring));
                                                    {2116}new Nc_2521: bitstring;
                                                    {2117}let m1_2522: bitstring = (OpenSecureChannelRequest,pkCli_2363,Nc_2521) in
                                                    {2118}out(c, (pkCli_2363,m1_2522,sign(h(m1_2522),skCli_2362)));
                                                    {2119}in(c, (em2_2523: bitstring,sigM2_2524: bitstring));
                                                    {2120}let m2_2525: bitstring = em2_2523 in
                                                    {2121}if (verify(h(m2_2525),sigM2_2524,pkSess_2518) <> true) then
                                                        0
                                                    else
                                                        {2122}let (=OpenSecureChannelResponse,Ns_2526: bitstring,ST_2527: bitstring,TTL_2528: bitstring) = m2_2525 in
                                                        {2123}let Kcli_2529: bitstring = h((Nc_2521,Ns_2526)) in
                                                        {2124}out(c, senc(mCli(pkCli_2363,pkSess_2518),Kcli_2529))
                                        )
                                        else
                                            {2125}let pkSess_2530: bitstring = fail-any in
                                            {2126}out(c, GetEndpointRequest);
                                            {2127}in(c, (=GetEndpointResponse,=pkSess_2530,=Sign,SP_2531: bitstring,UP_2532: bitstring));
                                            {2128}new Nc_2533: bitstring;
                                            {2129}let m1_2534: bitstring = (OpenSecureChannelRequest,pkCli_2363,Nc_2533) in
                                            {2130}out(c, (pkCli_2363,m1_2534,sign(h(m1_2534),skCli_2362)));
                                            {2131}in(c, (em2_2535: bitstring,sigM2_2536: bitstring));
                                            {2132}let m2_2537: bitstring = em2_2535 in
                                            {2133}if (verify(h(m2_2537),sigM2_2536,pkSess_2530) <> true) then
                                                0
                                            else
                                                {2134}let (=OpenSecureChannelResponse,Ns_2538: bitstring,ST_2539: bitstring,TTL_2540: bitstring) = m2_2537 in
                                                {2135}let Kcli_2541: bitstring = h((Nc_2533,Ns_2538)) in
                                                {2136}out(c, senc(mCli(pkCli_2363,pkSess_2530),Kcli_2541))
                                    )
                                    else
                                        {2137}let v_2542: bool = (Disco = C) in
                                        (
                                            {2138}if v_2542 then
                                            (
                                                {2139}let pkDisco_2543: bitstring = pub(skC) in
                                                {2140}let v_2544: bool = (Sess = A) in
                                                (
                                                    {2141}if v_2544 then
                                                    (
                                                        {2142}let pkSess_2545: bitstring = pub(skA) in
                                                        {2143}out(c, GetEndpointRequest);
                                                        {2144}in(c, (=GetEndpointResponse,=pkSess_2545,=Sign,SP_2546: bitstring,UP_2547: bitstring));
                                                        {2145}new Nc_2548: bitstring;
                                                        {2146}let m1_2549: bitstring = (OpenSecureChannelRequest,pkCli_2363,Nc_2548) in
                                                        {2147}out(c, (pkCli_2363,m1_2549,sign(h(m1_2549),skCli_2362)));
                                                        {2148}in(c, (em2_2550: bitstring,sigM2_2551: bitstring));
                                                        {2149}let m2_2552: bitstring = em2_2550 in
                                                        {2150}if (verify(h(m2_2552),sigM2_2551,pkSess_2545) <> true) then
                                                            0
                                                        else
                                                            {2151}let (=OpenSecureChannelResponse,Ns_2553: bitstring,ST_2554: bitstring,TTL_2555: bitstring) = m2_2552 in
                                                            {2152}let Kcli_2556: bitstring = h((Nc_2548,Ns_2553)) in
                                                            {2153}out(c, senc(mCli(pkCli_2363,pkSess_2545),Kcli_2556))
                                                    )
                                                    else
                                                        {2154}let v_2557: bool = (Sess = B) in
                                                        (
                                                            {2155}if v_2557 then
                                                            (
                                                                {2156}let pkSess_2558: bitstring = pub(skB) in
                                                                {2157}out(c, GetEndpointRequest);
                                                                {2158}in(c, (=GetEndpointResponse,=pkSess_2558,=Sign,SP_2559: bitstring,UP_2560: bitstring));
                                                                {2159}new Nc_2561: bitstring;
                                                                {2160}let m1_2562: bitstring = (OpenSecureChannelRequest,pkCli_2363,Nc_2561) in
                                                                {2161}out(c, (pkCli_2363,m1_2562,sign(h(m1_2562),skCli_2362)));
                                                                {2162}in(c, (em2_2563: bitstring,sigM2_2564: bitstring));
                                                                {2163}let m2_2565: bitstring = em2_2563 in
                                                                {2164}if (verify(h(m2_2565),sigM2_2564,pkSess_2558) <> true) then
                                                                    0
                                                                else
                                                                    {2165}let (=OpenSecureChannelResponse,Ns_2566: bitstring,ST_2567: bitstring,TTL_2568: bitstring) = m2_2565 in
                                                                    {2166}let Kcli_2569: bitstring = h((Nc_2561,Ns_2566)) in
                                                                    {2167}out(c, senc(mCli(pkCli_2363,pkSess_2558),Kcli_2569))
                                                            )
                                                            else
                                                                {2168}let v_2570: bool = (Sess = C) in
                                                                (
                                                                    {2169}if v_2570 then
                                                                    (
                                                                        {2170}let pkSess_2571: bitstring = pub(skC) in
                                                                        {2171}out(c, GetEndpointRequest);
                                                                        {2172}in(c, (=GetEndpointResponse,=pkSess_2571,=Sign,SP_2572: bitstring,UP_2573: bitstring));
                                                                        {2173}new Nc_2574: bitstring;
                                                                        {2174}let m1_2575: bitstring = (OpenSecureChannelRequest,pkCli_2363,Nc_2574) in
                                                                        {2175}out(c, (pkCli_2363,m1_2575,sign(h(m1_2575),skCli_2362)));
                                                                        {2176}in(c, (em2_2576: bitstring,sigM2_2577: bitstring));
                                                                        {2177}let m2_2578: bitstring = em2_2576 in
                                                                        {2178}if (verify(h(m2_2578),sigM2_2577,pkSess_2571) <> true) then
                                                                            0
                                                                        else
                                                                            {2179}let (=OpenSecureChannelResponse,Ns_2579: bitstring,ST_2580: bitstring,TTL_2581: bitstring) = m2_2578 in
                                                                            {2180}let Kcli_2582: bitstring = h((Nc_2574,Ns_2579)) in
                                                                            {2181}out(c, senc(mCli(pkCli_2363,pkSess_2571),Kcli_2582))
                                                                    )
                                                                    else
                                                                        {2182}let pkSess_2583: bitstring = pub(sk(Sess)) in
                                                                        {2183}out(c, GetEndpointRequest);
                                                                        {2184}in(c, (=GetEndpointResponse,=pkSess_2583,=Sign,SP_2584: bitstring,UP_2585: bitstring));
                                                                        {2185}new Nc_2586: bitstring;
                                                                        {2186}let m1_2587: bitstring = (OpenSecureChannelRequest,pkCli_2363,Nc_2586) in
                                                                        {2187}out(c, (pkCli_2363,m1_2587,sign(h(m1_2587),skCli_2362)));
                                                                        {2188}in(c, (em2_2588: bitstring,sigM2_2589: bitstring));
                                                                        {2189}let m2_2590: bitstring = em2_2588 in
                                                                        {2190}if (verify(h(m2_2590),sigM2_2589,pkSess_2583) <> true) then
                                                                            0
                                                                        else
                                                                            {2191}let (=OpenSecureChannelResponse,Ns_2591: bitstring,ST_2592: bitstring,TTL_2593: bitstring) = m2_2590 in
                                                                            {2192}let Kcli_2594: bitstring = h((Nc_2586,Ns_2591)) in
                                                                            {2193}out(c, senc(mCli(pkCli_2363,pkSess_2583),Kcli_2594))
                                                                )
                                                                else
                                                                    {2194}let pkSess_2595: bitstring = fail-any in
                                                                    {2195}out(c, GetEndpointRequest);
                                                                    {2196}in(c, (=GetEndpointResponse,=pkSess_2595,=Sign,SP_2596: bitstring,UP_2597: bitstring));
                                                                    {2197}new Nc_2598: bitstring;
                                                                    {2198}let m1_2599: bitstring = (OpenSecureChannelRequest,pkCli_2363,Nc_2598) in
                                                                    {2199}out(c, (pkCli_2363,m1_2599,sign(h(m1_2599),skCli_2362)));
                                                                    {2200}in(c, (em2_2600: bitstring,sigM2_2601: bitstring));
                                                                    {2201}let m2_2602: bitstring = em2_2600 in
                                                                    {2202}if (verify(h(m2_2602),sigM2_2601,pkSess_2595) <> true) then
                                                                        0
                                                                    else
                                                                        {2203}let (=OpenSecureChannelResponse,Ns_2603: bitstring,ST_2604: bitstring,TTL_2605: bitstring) = m2_2602 in
                                                                        {2204}let Kcli_2606: bitstring = h((Nc_2598,Ns_2603)) in
                                                                        {2205}out(c, senc(mCli(pkCli_2363,pkSess_2595),Kcli_2606))
                                                        )
                                                        else
                                                            {2206}let pkSess_2607: bitstring = fail-any in
                                                            {2207}out(c, GetEndpointRequest);
                                                            {2208}in(c, (=GetEndpointResponse,=pkSess_2607,=Sign,SP_2608: bitstring,UP_2609: bitstring));
                                                            {2209}new Nc_2610: bitstring;
                                                            {2210}let m1_2611: bitstring = (OpenSecureChannelRequest,pkCli_2363,Nc_2610) in
                                                            {2211}out(c, (pkCli_2363,m1_2611,sign(h(m1_2611),skCli_2362)));
                                                            {2212}in(c, (em2_2612: bitstring,sigM2_2613: bitstring));
                                                            {2213}let m2_2614: bitstring = em2_2612 in
                                                            {2214}if (verify(h(m2_2614),sigM2_2613,pkSess_2607) <> true) then
                                                                0
                                                            else
                                                                {2215}let (=OpenSecureChannelResponse,Ns_2615: bitstring,ST_2616: bitstring,TTL_2617: bitstring) = m2_2614 in
                                                                {2216}let Kcli_2618: bitstring = h((Nc_2610,Ns_2615)) in
                                                                {2217}out(c, senc(mCli(pkCli_2363,pkSess_2607),Kcli_2618))
                                                )
                                                else
                                                    {2218}let pkSess_2619: bitstring = fail-any in
                                                    {2219}out(c, GetEndpointRequest);
                                                    {2220}in(c, (=GetEndpointResponse,=pkSess_2619,=Sign,SP_2620: bitstring,UP_2621: bitstring));
                                                    {2221}new Nc_2622: bitstring;
                                                    {2222}let m1_2623: bitstring = (OpenSecureChannelRequest,pkCli_2363,Nc_2622) in
                                                    {2223}out(c, (pkCli_2363,m1_2623,sign(h(m1_2623),skCli_2362)));
                                                    {2224}in(c, (em2_2624: bitstring,sigM2_2625: bitstring));
                                                    {2225}let m2_2626: bitstring = em2_2624 in
                                                    {2226}if (verify(h(m2_2626),sigM2_2625,pkSess_2619) <> true) then
                                                        0
                                                    else
                                                        {2227}let (=OpenSecureChannelResponse,Ns_2627: bitstring,ST_2628: bitstring,TTL_2629: bitstring) = m2_2626 in
                                                        {2228}let Kcli_2630: bitstring = h((Nc_2622,Ns_2627)) in
                                                        {2229}out(c, senc(mCli(pkCli_2363,pkSess_2619),Kcli_2630))
                                            )
                                            else
                                                {2230}let pkDisco_2631: bitstring = pub(sk(Disco)) in
                                                {2231}let v_2632: bool = (Sess = A) in
                                                (
                                                    {2232}if v_2632 then
                                                    (
                                                        {2233}let pkSess_2633: bitstring = pub(skA) in
                                                        {2234}out(c, GetEndpointRequest);
                                                        {2235}in(c, (=GetEndpointResponse,=pkSess_2633,=Sign,SP_2634: bitstring,UP_2635: bitstring));
                                                        {2236}new Nc_2636: bitstring;
                                                        {2237}let m1_2637: bitstring = (OpenSecureChannelRequest,pkCli_2363,Nc_2636) in
                                                        {2238}out(c, (pkCli_2363,m1_2637,sign(h(m1_2637),skCli_2362)));
                                                        {2239}in(c, (em2_2638: bitstring,sigM2_2639: bitstring));
                                                        {2240}let m2_2640: bitstring = em2_2638 in
                                                        {2241}if (verify(h(m2_2640),sigM2_2639,pkSess_2633) <> true) then
                                                            0
                                                        else
                                                            {2242}let (=OpenSecureChannelResponse,Ns_2641: bitstring,ST_2642: bitstring,TTL_2643: bitstring) = m2_2640 in
                                                            {2243}let Kcli_2644: bitstring = h((Nc_2636,Ns_2641)) in
                                                            {2244}out(c, senc(mCli(pkCli_2363,pkSess_2633),Kcli_2644))
                                                    )
                                                    else
                                                        {2245}let v_2645: bool = (Sess = B) in
                                                        (
                                                            {2246}if v_2645 then
                                                            (
                                                                {2247}let pkSess_2646: bitstring = pub(skB) in
                                                                {2248}out(c, GetEndpointRequest);
                                                                {2249}in(c, (=GetEndpointResponse,=pkSess_2646,=Sign,SP_2647: bitstring,UP_2648: bitstring));
                                                                {2250}new Nc_2649: bitstring;
                                                                {2251}let m1_2650: bitstring = (OpenSecureChannelRequest,pkCli_2363,Nc_2649) in
                                                                {2252}out(c, (pkCli_2363,m1_2650,sign(h(m1_2650),skCli_2362)));
                                                                {2253}in(c, (em2_2651: bitstring,sigM2_2652: bitstring));
                                                                {2254}let m2_2653: bitstring = em2_2651 in
                                                                {2255}if (verify(h(m2_2653),sigM2_2652,pkSess_2646) <> true) then
                                                                    0
                                                                else
                                                                    {2256}let (=OpenSecureChannelResponse,Ns_2654: bitstring,ST_2655: bitstring,TTL_2656: bitstring) = m2_2653 in
                                                                    {2257}let Kcli_2657: bitstring = h((Nc_2649,Ns_2654)) in
                                                                    {2258}out(c, senc(mCli(pkCli_2363,pkSess_2646),Kcli_2657))
                                                            )
                                                            else
                                                                {2259}let v_2658: bool = (Sess = C) in
                                                                (
                                                                    {2260}if v_2658 then
                                                                    (
                                                                        {2261}let pkSess_2659: bitstring = pub(skC) in
                                                                        {2262}out(c, GetEndpointRequest);
                                                                        {2263}in(c, (=GetEndpointResponse,=pkSess_2659,=Sign,SP_2660: bitstring,UP_2661: bitstring));
                                                                        {2264}new Nc_2662: bitstring;
                                                                        {2265}let m1_2663: bitstring = (OpenSecureChannelRequest,pkCli_2363,Nc_2662) in
                                                                        {2266}out(c, (pkCli_2363,m1_2663,sign(h(m1_2663),skCli_2362)));
                                                                        {2267}in(c, (em2_2664: bitstring,sigM2_2665: bitstring));
                                                                        {2268}let m2_2666: bitstring = em2_2664 in
                                                                        {2269}if (verify(h(m2_2666),sigM2_2665,pkSess_2659) <> true) then
                                                                            0
                                                                        else
                                                                            {2270}let (=OpenSecureChannelResponse,Ns_2667: bitstring,ST_2668: bitstring,TTL_2669: bitstring) = m2_2666 in
                                                                            {2271}let Kcli_2670: bitstring = h((Nc_2662,Ns_2667)) in
                                                                            {2272}out(c, senc(mCli(pkCli_2363,pkSess_2659),Kcli_2670))
                                                                    )
                                                                    else
                                                                        {2273}let pkSess_2671: bitstring = pub(sk(Sess)) in
                                                                        {2274}out(c, GetEndpointRequest);
                                                                        {2275}in(c, (=GetEndpointResponse,=pkSess_2671,=Sign,SP_2672: bitstring,UP_2673: bitstring));
                                                                        {2276}new Nc_2674: bitstring;
                                                                        {2277}let m1_2675: bitstring = (OpenSecureChannelRequest,pkCli_2363,Nc_2674) in
                                                                        {2278}out(c, (pkCli_2363,m1_2675,sign(h(m1_2675),skCli_2362)));
                                                                        {2279}in(c, (em2_2676: bitstring,sigM2_2677: bitstring));
                                                                        {2280}let m2_2678: bitstring = em2_2676 in
                                                                        {2281}if (verify(h(m2_2678),sigM2_2677,pkSess_2671) <> true) then
                                                                            0
                                                                        else
                                                                            {2282}let (=OpenSecureChannelResponse,Ns_2679: bitstring,ST_2680: bitstring,TTL_2681: bitstring) = m2_2678 in
                                                                            {2283}let Kcli_2682: bitstring = h((Nc_2674,Ns_2679)) in
                                                                            {2284}out(c, senc(mCli(pkCli_2363,pkSess_2671),Kcli_2682))
                                                                )
                                                                else
                                                                    {2285}let pkSess_2683: bitstring = fail-any in
                                                                    {2286}out(c, GetEndpointRequest);
                                                                    {2287}in(c, (=GetEndpointResponse,=pkSess_2683,=Sign,SP_2684: bitstring,UP_2685: bitstring));
                                                                    {2288}new Nc_2686: bitstring;
                                                                    {2289}let m1_2687: bitstring = (OpenSecureChannelRequest,pkCli_2363,Nc_2686) in
                                                                    {2290}out(c, (pkCli_2363,m1_2687,sign(h(m1_2687),skCli_2362)));
                                                                    {2291}in(c, (em2_2688: bitstring,sigM2_2689: bitstring));
                                                                    {2292}let m2_2690: bitstring = em2_2688 in
                                                                    {2293}if (verify(h(m2_2690),sigM2_2689,pkSess_2683) <> true) then
                                                                        0
                                                                    else
                                                                        {2294}let (=OpenSecureChannelResponse,Ns_2691: bitstring,ST_2692: bitstring,TTL_2693: bitstring) = m2_2690 in
                                                                        {2295}let Kcli_2694: bitstring = h((Nc_2686,Ns_2691)) in
                                                                        {2296}out(c, senc(mCli(pkCli_2363,pkSess_2683),Kcli_2694))
                                                        )
                                                        else
                                                            {2297}let pkSess_2695: bitstring = fail-any in
                                                            {2298}out(c, GetEndpointRequest);
                                                            {2299}in(c, (=GetEndpointResponse,=pkSess_2695,=Sign,SP_2696: bitstring,UP_2697: bitstring));
                                                            {2300}new Nc_2698: bitstring;
                                                            {2301}let m1_2699: bitstring = (OpenSecureChannelRequest,pkCli_2363,Nc_2698) in
                                                            {2302}out(c, (pkCli_2363,m1_2699,sign(h(m1_2699),skCli_2362)));
                                                            {2303}in(c, (em2_2700: bitstring,sigM2_2701: bitstring));
                                                            {2304}let m2_2702: bitstring = em2_2700 in
                                                            {2305}if (verify(h(m2_2702),sigM2_2701,pkSess_2695) <> true) then
                                                                0
                                                            else
                                                                {2306}let (=OpenSecureChannelResponse,Ns_2703: bitstring,ST_2704: bitstring,TTL_2705: bitstring) = m2_2702 in
                                                                {2307}let Kcli_2706: bitstring = h((Nc_2698,Ns_2703)) in
                                                                {2308}out(c, senc(mCli(pkCli_2363,pkSess_2695),Kcli_2706))
                                                )
                                                else
                                                    {2309}let pkSess_2707: bitstring = fail-any in
                                                    {2310}out(c, GetEndpointRequest);
                                                    {2311}in(c, (=GetEndpointResponse,=pkSess_2707,=Sign,SP_2708: bitstring,UP_2709: bitstring));
                                                    {2312}new Nc_2710: bitstring;
                                                    {2313}let m1_2711: bitstring = (OpenSecureChannelRequest,pkCli_2363,Nc_2710) in
                                                    {2314}out(c, (pkCli_2363,m1_2711,sign(h(m1_2711),skCli_2362)));
                                                    {2315}in(c, (em2_2712: bitstring,sigM2_2713: bitstring));
                                                    {2316}let m2_2714: bitstring = em2_2712 in
                                                    {2317}if (verify(h(m2_2714),sigM2_2713,pkSess_2707) <> true) then
                                                        0
                                                    else
                                                        {2318}let (=OpenSecureChannelResponse,Ns_2715: bitstring,ST_2716: bitstring,TTL_2717: bitstring) = m2_2714 in
                                                        {2319}let Kcli_2718: bitstring = h((Nc_2710,Ns_2715)) in
                                                        {2320}out(c, senc(mCli(pkCli_2363,pkSess_2707),Kcli_2718))
                                        )
                                        else
                                            {2321}let pkDisco_2719: bitstring = fail-any in
                                            {2322}let v_2720: bool = (Sess = A) in
                                            (
                                                {2323}if v_2720 then
                                                (
                                                    {2324}let pkSess_2721: bitstring = pub(skA) in
                                                    {2325}out(c, GetEndpointRequest);
                                                    {2326}in(c, (=GetEndpointResponse,=pkSess_2721,=Sign,SP_2722: bitstring,UP_2723: bitstring));
                                                    {2327}new Nc_2724: bitstring;
                                                    {2328}let m1_2725: bitstring = (OpenSecureChannelRequest,pkCli_2363,Nc_2724) in
                                                    {2329}out(c, (pkCli_2363,m1_2725,sign(h(m1_2725),skCli_2362)));
                                                    {2330}in(c, (em2_2726: bitstring,sigM2_2727: bitstring));
                                                    {2331}let m2_2728: bitstring = em2_2726 in
                                                    {2332}if (verify(h(m2_2728),sigM2_2727,pkSess_2721) <> true) then
                                                        0
                                                    else
                                                        {2333}let (=OpenSecureChannelResponse,Ns_2729: bitstring,ST_2730: bitstring,TTL_2731: bitstring) = m2_2728 in
                                                        {2334}let Kcli_2732: bitstring = h((Nc_2724,Ns_2729)) in
                                                        {2335}out(c, senc(mCli(pkCli_2363,pkSess_2721),Kcli_2732))
                                                )
                                                else
                                                    {2336}let v_2733: bool = (Sess = B) in
                                                    (
                                                        {2337}if v_2733 then
                                                        (
                                                            {2338}let pkSess_2734: bitstring = pub(skB) in
                                                            {2339}out(c, GetEndpointRequest);
                                                            {2340}in(c, (=GetEndpointResponse,=pkSess_2734,=Sign,SP_2735: bitstring,UP_2736: bitstring));
                                                            {2341}new Nc_2737: bitstring;
                                                            {2342}let m1_2738: bitstring = (OpenSecureChannelRequest,pkCli_2363,Nc_2737) in
                                                            {2343}out(c, (pkCli_2363,m1_2738,sign(h(m1_2738),skCli_2362)));
                                                            {2344}in(c, (em2_2739: bitstring,sigM2_2740: bitstring));
                                                            {2345}let m2_2741: bitstring = em2_2739 in
                                                            {2346}if (verify(h(m2_2741),sigM2_2740,pkSess_2734) <> true) then
                                                                0
                                                            else
                                                                {2347}let (=OpenSecureChannelResponse,Ns_2742: bitstring,ST_2743: bitstring,TTL_2744: bitstring) = m2_2741 in
                                                                {2348}let Kcli_2745: bitstring = h((Nc_2737,Ns_2742)) in
                                                                {2349}out(c, senc(mCli(pkCli_2363,pkSess_2734),Kcli_2745))
                                                        )
                                                        else
                                                            {2350}let v_2746: bool = (Sess = C) in
                                                            (
                                                                {2351}if v_2746 then
                                                                (
                                                                    {2352}let pkSess_2747: bitstring = pub(skC) in
                                                                    {2353}out(c, GetEndpointRequest);
                                                                    {2354}in(c, (=GetEndpointResponse,=pkSess_2747,=Sign,SP_2748: bitstring,UP_2749: bitstring));
                                                                    {2355}new Nc_2750: bitstring;
                                                                    {2356}let m1_2751: bitstring = (OpenSecureChannelRequest,pkCli_2363,Nc_2750) in
                                                                    {2357}out(c, (pkCli_2363,m1_2751,sign(h(m1_2751),skCli_2362)));
                                                                    {2358}in(c, (em2_2752: bitstring,sigM2_2753: bitstring));
                                                                    {2359}let m2_2754: bitstring = em2_2752 in
                                                                    {2360}if (verify(h(m2_2754),sigM2_2753,pkSess_2747) <> true) then
                                                                        0
                                                                    else
                                                                        {2361}let (=OpenSecureChannelResponse,Ns_2755: bitstring,ST_2756: bitstring,TTL_2757: bitstring) = m2_2754 in
                                                                        {2362}let Kcli_2758: bitstring = h((Nc_2750,Ns_2755)) in
                                                                        {2363}out(c, senc(mCli(pkCli_2363,pkSess_2747),Kcli_2758))
                                                                )
                                                                else
                                                                    {2364}let pkSess_2759: bitstring = pub(sk(Sess)) in
                                                                    {2365}out(c, GetEndpointRequest);
                                                                    {2366}in(c, (=GetEndpointResponse,=pkSess_2759,=Sign,SP_2760: bitstring,UP_2761: bitstring));
                                                                    {2367}new Nc_2762: bitstring;
                                                                    {2368}let m1_2763: bitstring = (OpenSecureChannelRequest,pkCli_2363,Nc_2762) in
                                                                    {2369}out(c, (pkCli_2363,m1_2763,sign(h(m1_2763),skCli_2362)));
                                                                    {2370}in(c, (em2_2764: bitstring,sigM2_2765: bitstring));
                                                                    {2371}let m2_2766: bitstring = em2_2764 in
                                                                    {2372}if (verify(h(m2_2766),sigM2_2765,pkSess_2759) <> true) then
                                                                        0
                                                                    else
                                                                        {2373}let (=OpenSecureChannelResponse,Ns_2767: bitstring,ST_2768: bitstring,TTL_2769: bitstring) = m2_2766 in
                                                                        {2374}let Kcli_2770: bitstring = h((Nc_2762,Ns_2767)) in
                                                                        {2375}out(c, senc(mCli(pkCli_2363,pkSess_2759),Kcli_2770))
                                                            )
                                                            else
                                                                {2376}let pkSess_2771: bitstring = fail-any in
                                                                {2377}out(c, GetEndpointRequest);
                                                                {2378}in(c, (=GetEndpointResponse,=pkSess_2771,=Sign,SP_2772: bitstring,UP_2773: bitstring));
                                                                {2379}new Nc_2774: bitstring;
                                                                {2380}let m1_2775: bitstring = (OpenSecureChannelRequest,pkCli_2363,Nc_2774) in
                                                                {2381}out(c, (pkCli_2363,m1_2775,sign(h(m1_2775),skCli_2362)));
                                                                {2382}in(c, (em2_2776: bitstring,sigM2_2777: bitstring));
                                                                {2383}let m2_2778: bitstring = em2_2776 in
                                                                {2384}if (verify(h(m2_2778),sigM2_2777,pkSess_2771) <> true) then
                                                                    0
                                                                else
                                                                    {2385}let (=OpenSecureChannelResponse,Ns_2779: bitstring,ST_2780: bitstring,TTL_2781: bitstring) = m2_2778 in
                                                                    {2386}let Kcli_2782: bitstring = h((Nc_2774,Ns_2779)) in
                                                                    {2387}out(c, senc(mCli(pkCli_2363,pkSess_2771),Kcli_2782))
                                                    )
                                                    else
                                                        {2388}let pkSess_2783: bitstring = fail-any in
                                                        {2389}out(c, GetEndpointRequest);
                                                        {2390}in(c, (=GetEndpointResponse,=pkSess_2783,=Sign,SP_2784: bitstring,UP_2785: bitstring));
                                                        {2391}new Nc_2786: bitstring;
                                                        {2392}let m1_2787: bitstring = (OpenSecureChannelRequest,pkCli_2363,Nc_2786) in
                                                        {2393}out(c, (pkCli_2363,m1_2787,sign(h(m1_2787),skCli_2362)));
                                                        {2394}in(c, (em2_2788: bitstring,sigM2_2789: bitstring));
                                                        {2395}let m2_2790: bitstring = em2_2788 in
                                                        {2396}if (verify(h(m2_2790),sigM2_2789,pkSess_2783) <> true) then
                                                            0
                                                        else
                                                            {2397}let (=OpenSecureChannelResponse,Ns_2791: bitstring,ST_2792: bitstring,TTL_2793: bitstring) = m2_2790 in
                                                            {2398}let Kcli_2794: bitstring = h((Nc_2786,Ns_2791)) in
                                                            {2399}out(c, senc(mCli(pkCli_2363,pkSess_2783),Kcli_2794))
                                            )
                                            else
                                                {2400}let pkSess_2795: bitstring = fail-any in
                                                {2401}out(c, GetEndpointRequest);
                                                {2402}in(c, (=GetEndpointResponse,=pkSess_2795,=Sign,SP_2796: bitstring,UP_2797: bitstring));
                                                {2403}new Nc_2798: bitstring;
                                                {2404}let m1_2799: bitstring = (OpenSecureChannelRequest,pkCli_2363,Nc_2798) in
                                                {2405}out(c, (pkCli_2363,m1_2799,sign(h(m1_2799),skCli_2362)));
                                                {2406}in(c, (em2_2800: bitstring,sigM2_2801: bitstring));
                                                {2407}let m2_2802: bitstring = em2_2800 in
                                                {2408}if (verify(h(m2_2802),sigM2_2801,pkSess_2795) <> true) then
                                                    0
                                                else
                                                    {2409}let (=OpenSecureChannelResponse,Ns_2803: bitstring,ST_2804: bitstring,TTL_2805: bitstring) = m2_2802 in
                                                    {2410}let Kcli_2806: bitstring = h((Nc_2798,Ns_2803)) in
                                                    {2411}out(c, senc(mCli(pkCli_2363,pkSess_2795),Kcli_2806))
                                )
                                else
                                    {2412}let pkDisco_2807: bitstring = fail-any in
                                    {2413}let v_2808: bool = (Sess = A) in
                                    (
                                        {2414}if v_2808 then
                                        (
                                            {2415}let pkSess_2809: bitstring = pub(skA) in
                                            {2416}out(c, GetEndpointRequest);
                                            {2417}in(c, (=GetEndpointResponse,=pkSess_2809,=Sign,SP_2810: bitstring,UP_2811: bitstring));
                                            {2418}new Nc_2812: bitstring;
                                            {2419}let m1_2813: bitstring = (OpenSecureChannelRequest,pkCli_2363,Nc_2812) in
                                            {2420}out(c, (pkCli_2363,m1_2813,sign(h(m1_2813),skCli_2362)));
                                            {2421}in(c, (em2_2814: bitstring,sigM2_2815: bitstring));
                                            {2422}let m2_2816: bitstring = em2_2814 in
                                            {2423}if (verify(h(m2_2816),sigM2_2815,pkSess_2809) <> true) then
                                                0
                                            else
                                                {2424}let (=OpenSecureChannelResponse,Ns_2817: bitstring,ST_2818: bitstring,TTL_2819: bitstring) = m2_2816 in
                                                {2425}let Kcli_2820: bitstring = h((Nc_2812,Ns_2817)) in
                                                {2426}out(c, senc(mCli(pkCli_2363,pkSess_2809),Kcli_2820))
                                        )
                                        else
                                            {2427}let v_2821: bool = (Sess = B) in
                                            (
                                                {2428}if v_2821 then
                                                (
                                                    {2429}let pkSess_2822: bitstring = pub(skB) in
                                                    {2430}out(c, GetEndpointRequest);
                                                    {2431}in(c, (=GetEndpointResponse,=pkSess_2822,=Sign,SP_2823: bitstring,UP_2824: bitstring));
                                                    {2432}new Nc_2825: bitstring;
                                                    {2433}let m1_2826: bitstring = (OpenSecureChannelRequest,pkCli_2363,Nc_2825) in
                                                    {2434}out(c, (pkCli_2363,m1_2826,sign(h(m1_2826),skCli_2362)));
                                                    {2435}in(c, (em2_2827: bitstring,sigM2_2828: bitstring));
                                                    {2436}let m2_2829: bitstring = em2_2827 in
                                                    {2437}if (verify(h(m2_2829),sigM2_2828,pkSess_2822) <> true) then
                                                        0
                                                    else
                                                        {2438}let (=OpenSecureChannelResponse,Ns_2830: bitstring,ST_2831: bitstring,TTL_2832: bitstring) = m2_2829 in
                                                        {2439}let Kcli_2833: bitstring = h((Nc_2825,Ns_2830)) in
                                                        {2440}out(c, senc(mCli(pkCli_2363,pkSess_2822),Kcli_2833))
                                                )
                                                else
                                                    {2441}let v_2834: bool = (Sess = C) in
                                                    (
                                                        {2442}if v_2834 then
                                                        (
                                                            {2443}let pkSess_2835: bitstring = pub(skC) in
                                                            {2444}out(c, GetEndpointRequest);
                                                            {2445}in(c, (=GetEndpointResponse,=pkSess_2835,=Sign,SP_2836: bitstring,UP_2837: bitstring));
                                                            {2446}new Nc_2838: bitstring;
                                                            {2447}let m1_2839: bitstring = (OpenSecureChannelRequest,pkCli_2363,Nc_2838) in
                                                            {2448}out(c, (pkCli_2363,m1_2839,sign(h(m1_2839),skCli_2362)));
                                                            {2449}in(c, (em2_2840: bitstring,sigM2_2841: bitstring));
                                                            {2450}let m2_2842: bitstring = em2_2840 in
                                                            {2451}if (verify(h(m2_2842),sigM2_2841,pkSess_2835) <> true) then
                                                                0
                                                            else
                                                                {2452}let (=OpenSecureChannelResponse,Ns_2843: bitstring,ST_2844: bitstring,TTL_2845: bitstring) = m2_2842 in
                                                                {2453}let Kcli_2846: bitstring = h((Nc_2838,Ns_2843)) in
                                                                {2454}out(c, senc(mCli(pkCli_2363,pkSess_2835),Kcli_2846))
                                                        )
                                                        else
                                                            {2455}let pkSess_2847: bitstring = pub(sk(Sess)) in
                                                            {2456}out(c, GetEndpointRequest);
                                                            {2457}in(c, (=GetEndpointResponse,=pkSess_2847,=Sign,SP_2848: bitstring,UP_2849: bitstring));
                                                            {2458}new Nc_2850: bitstring;
                                                            {2459}let m1_2851: bitstring = (OpenSecureChannelRequest,pkCli_2363,Nc_2850) in
                                                            {2460}out(c, (pkCli_2363,m1_2851,sign(h(m1_2851),skCli_2362)));
                                                            {2461}in(c, (em2_2852: bitstring,sigM2_2853: bitstring));
                                                            {2462}let m2_2854: bitstring = em2_2852 in
                                                            {2463}if (verify(h(m2_2854),sigM2_2853,pkSess_2847) <> true) then
                                                                0
                                                            else
                                                                {2464}let (=OpenSecureChannelResponse,Ns_2855: bitstring,ST_2856: bitstring,TTL_2857: bitstring) = m2_2854 in
                                                                {2465}let Kcli_2858: bitstring = h((Nc_2850,Ns_2855)) in
                                                                {2466}out(c, senc(mCli(pkCli_2363,pkSess_2847),Kcli_2858))
                                                    )
                                                    else
                                                        {2467}let pkSess_2859: bitstring = fail-any in
                                                        {2468}out(c, GetEndpointRequest);
                                                        {2469}in(c, (=GetEndpointResponse,=pkSess_2859,=Sign,SP_2860: bitstring,UP_2861: bitstring));
                                                        {2470}new Nc_2862: bitstring;
                                                        {2471}let m1_2863: bitstring = (OpenSecureChannelRequest,pkCli_2363,Nc_2862) in
                                                        {2472}out(c, (pkCli_2363,m1_2863,sign(h(m1_2863),skCli_2362)));
                                                        {2473}in(c, (em2_2864: bitstring,sigM2_2865: bitstring));
                                                        {2474}let m2_2866: bitstring = em2_2864 in
                                                        {2475}if (verify(h(m2_2866),sigM2_2865,pkSess_2859) <> true) then
                                                            0
                                                        else
                                                            {2476}let (=OpenSecureChannelResponse,Ns_2867: bitstring,ST_2868: bitstring,TTL_2869: bitstring) = m2_2866 in
                                                            {2477}let Kcli_2870: bitstring = h((Nc_2862,Ns_2867)) in
                                                            {2478}out(c, senc(mCli(pkCli_2363,pkSess_2859),Kcli_2870))
                                            )
                                            else
                                                {2479}let pkSess_2871: bitstring = fail-any in
                                                {2480}out(c, GetEndpointRequest);
                                                {2481}in(c, (=GetEndpointResponse,=pkSess_2871,=Sign,SP_2872: bitstring,UP_2873: bitstring));
                                                {2482}new Nc_2874: bitstring;
                                                {2483}let m1_2875: bitstring = (OpenSecureChannelRequest,pkCli_2363,Nc_2874) in
                                                {2484}out(c, (pkCli_2363,m1_2875,sign(h(m1_2875),skCli_2362)));
                                                {2485}in(c, (em2_2876: bitstring,sigM2_2877: bitstring));
                                                {2486}let m2_2878: bitstring = em2_2876 in
                                                {2487}if (verify(h(m2_2878),sigM2_2877,pkSess_2871) <> true) then
                                                    0
                                                else
                                                    {2488}let (=OpenSecureChannelResponse,Ns_2879: bitstring,ST_2880: bitstring,TTL_2881: bitstring) = m2_2878 in
                                                    {2489}let Kcli_2882: bitstring = h((Nc_2874,Ns_2879)) in
                                                    {2490}out(c, senc(mCli(pkCli_2363,pkSess_2871),Kcli_2882))
                                    )
                                    else
                                        {2491}let pkSess_2883: bitstring = fail-any in
                                        {2492}out(c, GetEndpointRequest);
                                        {2493}in(c, (=GetEndpointResponse,=pkSess_2883,=Sign,SP_2884: bitstring,UP_2885: bitstring));
                                        {2494}new Nc_2886: bitstring;
                                        {2495}let m1_2887: bitstring = (OpenSecureChannelRequest,pkCli_2363,Nc_2886) in
                                        {2496}out(c, (pkCli_2363,m1_2887,sign(h(m1_2887),skCli_2362)));
                                        {2497}in(c, (em2_2888: bitstring,sigM2_2889: bitstring));
                                        {2498}let m2_2890: bitstring = em2_2888 in
                                        {2499}if (verify(h(m2_2890),sigM2_2889,pkSess_2883) <> true) then
                                            0
                                        else
                                            {2500}let (=OpenSecureChannelResponse,Ns_2891: bitstring,ST_2892: bitstring,TTL_2893: bitstring) = m2_2890 in
                                            {2501}let Kcli_2894: bitstring = h((Nc_2886,Ns_2891)) in
                                            {2502}out(c, senc(mCli(pkCli_2363,pkSess_2883),Kcli_2894))
                        )
                        else
                            {2503}let pkDisco_2895: bitstring = fail-any in
                            {2504}let v_2896: bool = (Sess = A) in
                            (
                                {2505}if v_2896 then
                                (
                                    {2506}let pkSess_2897: bitstring = pub(skA) in
                                    {2507}out(c, GetEndpointRequest);
                                    {2508}in(c, (=GetEndpointResponse,=pkSess_2897,=Sign,SP_2898: bitstring,UP_2899: bitstring));
                                    {2509}new Nc_2900: bitstring;
                                    {2510}let m1_2901: bitstring = (OpenSecureChannelRequest,pkCli_2363,Nc_2900) in
                                    {2511}out(c, (pkCli_2363,m1_2901,sign(h(m1_2901),skCli_2362)));
                                    {2512}in(c, (em2_2902: bitstring,sigM2_2903: bitstring));
                                    {2513}let m2_2904: bitstring = em2_2902 in
                                    {2514}if (verify(h(m2_2904),sigM2_2903,pkSess_2897) <> true) then
                                        0
                                    else
                                        {2515}let (=OpenSecureChannelResponse,Ns_2905: bitstring,ST_2906: bitstring,TTL_2907: bitstring) = m2_2904 in
                                        {2516}let Kcli_2908: bitstring = h((Nc_2900,Ns_2905)) in
                                        {2517}out(c, senc(mCli(pkCli_2363,pkSess_2897),Kcli_2908))
                                )
                                else
                                    {2518}let v_2909: bool = (Sess = B) in
                                    (
                                        {2519}if v_2909 then
                                        (
                                            {2520}let pkSess_2910: bitstring = pub(skB) in
                                            {2521}out(c, GetEndpointRequest);
                                            {2522}in(c, (=GetEndpointResponse,=pkSess_2910,=Sign,SP_2911: bitstring,UP_2912: bitstring));
                                            {2523}new Nc_2913: bitstring;
                                            {2524}let m1_2914: bitstring = (OpenSecureChannelRequest,pkCli_2363,Nc_2913) in
                                            {2525}out(c, (pkCli_2363,m1_2914,sign(h(m1_2914),skCli_2362)));
                                            {2526}in(c, (em2_2915: bitstring,sigM2_2916: bitstring));
                                            {2527}let m2_2917: bitstring = em2_2915 in
                                            {2528}if (verify(h(m2_2917),sigM2_2916,pkSess_2910) <> true) then
                                                0
                                            else
                                                {2529}let (=OpenSecureChannelResponse,Ns_2918: bitstring,ST_2919: bitstring,TTL_2920: bitstring) = m2_2917 in
                                                {2530}let Kcli_2921: bitstring = h((Nc_2913,Ns_2918)) in
                                                {2531}out(c, senc(mCli(pkCli_2363,pkSess_2910),Kcli_2921))
                                        )
                                        else
                                            {2532}let v_2922: bool = (Sess = C) in
                                            (
                                                {2533}if v_2922 then
                                                (
                                                    {2534}let pkSess_2923: bitstring = pub(skC) in
                                                    {2535}out(c, GetEndpointRequest);
                                                    {2536}in(c, (=GetEndpointResponse,=pkSess_2923,=Sign,SP_2924: bitstring,UP_2925: bitstring));
                                                    {2537}new Nc_2926: bitstring;
                                                    {2538}let m1_2927: bitstring = (OpenSecureChannelRequest,pkCli_2363,Nc_2926) in
                                                    {2539}out(c, (pkCli_2363,m1_2927,sign(h(m1_2927),skCli_2362)));
                                                    {2540}in(c, (em2_2928: bitstring,sigM2_2929: bitstring));
                                                    {2541}let m2_2930: bitstring = em2_2928 in
                                                    {2542}if (verify(h(m2_2930),sigM2_2929,pkSess_2923) <> true) then
                                                        0
                                                    else
                                                        {2543}let (=OpenSecureChannelResponse,Ns_2931: bitstring,ST_2932: bitstring,TTL_2933: bitstring) = m2_2930 in
                                                        {2544}let Kcli_2934: bitstring = h((Nc_2926,Ns_2931)) in
                                                        {2545}out(c, senc(mCli(pkCli_2363,pkSess_2923),Kcli_2934))
                                                )
                                                else
                                                    {2546}let pkSess_2935: bitstring = pub(sk(Sess)) in
                                                    {2547}out(c, GetEndpointRequest);
                                                    {2548}in(c, (=GetEndpointResponse,=pkSess_2935,=Sign,SP_2936: bitstring,UP_2937: bitstring));
                                                    {2549}new Nc_2938: bitstring;
                                                    {2550}let m1_2939: bitstring = (OpenSecureChannelRequest,pkCli_2363,Nc_2938) in
                                                    {2551}out(c, (pkCli_2363,m1_2939,sign(h(m1_2939),skCli_2362)));
                                                    {2552}in(c, (em2_2940: bitstring,sigM2_2941: bitstring));
                                                    {2553}let m2_2942: bitstring = em2_2940 in
                                                    {2554}if (verify(h(m2_2942),sigM2_2941,pkSess_2935) <> true) then
                                                        0
                                                    else
                                                        {2555}let (=OpenSecureChannelResponse,Ns_2943: bitstring,ST_2944: bitstring,TTL_2945: bitstring) = m2_2942 in
                                                        {2556}let Kcli_2946: bitstring = h((Nc_2938,Ns_2943)) in
                                                        {2557}out(c, senc(mCli(pkCli_2363,pkSess_2935),Kcli_2946))
                                            )
                                            else
                                                {2558}let pkSess_2947: bitstring = fail-any in
                                                {2559}out(c, GetEndpointRequest);
                                                {2560}in(c, (=GetEndpointResponse,=pkSess_2947,=Sign,SP_2948: bitstring,UP_2949: bitstring));
                                                {2561}new Nc_2950: bitstring;
                                                {2562}let m1_2951: bitstring = (OpenSecureChannelRequest,pkCli_2363,Nc_2950) in
                                                {2563}out(c, (pkCli_2363,m1_2951,sign(h(m1_2951),skCli_2362)));
                                                {2564}in(c, (em2_2952: bitstring,sigM2_2953: bitstring));
                                                {2565}let m2_2954: bitstring = em2_2952 in
                                                {2566}if (verify(h(m2_2954),sigM2_2953,pkSess_2947) <> true) then
                                                    0
                                                else
                                                    {2567}let (=OpenSecureChannelResponse,Ns_2955: bitstring,ST_2956: bitstring,TTL_2957: bitstring) = m2_2954 in
                                                    {2568}let Kcli_2958: bitstring = h((Nc_2950,Ns_2955)) in
                                                    {2569}out(c, senc(mCli(pkCli_2363,pkSess_2947),Kcli_2958))
                                    )
                                    else
                                        {2570}let pkSess_2959: bitstring = fail-any in
                                        {2571}out(c, GetEndpointRequest);
                                        {2572}in(c, (=GetEndpointResponse,=pkSess_2959,=Sign,SP_2960: bitstring,UP_2961: bitstring));
                                        {2573}new Nc_2962: bitstring;
                                        {2574}let m1_2963: bitstring = (OpenSecureChannelRequest,pkCli_2363,Nc_2962) in
                                        {2575}out(c, (pkCli_2363,m1_2963,sign(h(m1_2963),skCli_2362)));
                                        {2576}in(c, (em2_2964: bitstring,sigM2_2965: bitstring));
                                        {2577}let m2_2966: bitstring = em2_2964 in
                                        {2578}if (verify(h(m2_2966),sigM2_2965,pkSess_2959) <> true) then
                                            0
                                        else
                                            {2579}let (=OpenSecureChannelResponse,Ns_2967: bitstring,ST_2968: bitstring,TTL_2969: bitstring) = m2_2966 in
                                            {2580}let Kcli_2970: bitstring = h((Nc_2962,Ns_2967)) in
                                            {2581}out(c, senc(mCli(pkCli_2363,pkSess_2959),Kcli_2970))
                            )
                            else
                                {2582}let pkSess_2971: bitstring = fail-any in
                                {2583}out(c, GetEndpointRequest);
                                {2584}in(c, (=GetEndpointResponse,=pkSess_2971,=Sign,SP_2972: bitstring,UP_2973: bitstring));
                                {2585}new Nc_2974: bitstring;
                                {2586}let m1_2975: bitstring = (OpenSecureChannelRequest,pkCli_2363,Nc_2974) in
                                {2587}out(c, (pkCli_2363,m1_2975,sign(h(m1_2975),skCli_2362)));
                                {2588}in(c, (em2_2976: bitstring,sigM2_2977: bitstring));
                                {2589}let m2_2978: bitstring = em2_2976 in
                                {2590}if (verify(h(m2_2978),sigM2_2977,pkSess_2971) <> true) then
                                    0
                                else
                                    {2591}let (=OpenSecureChannelResponse,Ns_2979: bitstring,ST_2980: bitstring,TTL_2981: bitstring) = m2_2978 in
                                    {2592}let Kcli_2982: bitstring = h((Nc_2974,Ns_2979)) in
                                    {2593}out(c, senc(mCli(pkCli_2363,pkSess_2971),Kcli_2982))
            )
            else
                {2594}let skCli_2983: bitstring = fail-any in
                {2595}let pkCli_2984: bitstring = pub(skCli_2983) in
                {2596}let v_2985: bool = (Disco = A) in
                (
                    {2597}if v_2985 then
                    (
                        {2598}let pkDisco_2986: bitstring = pub(skA) in
                        {2599}let v_2987: bool = (Sess = A) in
                        (
                            {2600}if v_2987 then
                            (
                                {2601}let pkSess_2988: bitstring = pub(skA) in
                                {2602}out(c, GetEndpointRequest);
                                {2603}in(c, (=GetEndpointResponse,=pkSess_2988,=Sign,SP_2989: bitstring,UP_2990: bitstring));
                                {2604}new Nc_2991: bitstring;
                                {2605}let m1_2992: bitstring = (OpenSecureChannelRequest,pkCli_2984,Nc_2991) in
                                {2606}out(c, (pkCli_2984,m1_2992,sign(h(m1_2992),skCli_2983)));
                                {2607}in(c, (em2_2993: bitstring,sigM2_2994: bitstring));
                                {2608}let m2_2995: bitstring = em2_2993 in
                                {2609}if (verify(h(m2_2995),sigM2_2994,pkSess_2988) <> true) then
                                    0
                                else
                                    {2610}let (=OpenSecureChannelResponse,Ns_2996: bitstring,ST_2997: bitstring,TTL_2998: bitstring) = m2_2995 in
                                    {2611}let Kcli_2999: bitstring = h((Nc_2991,Ns_2996)) in
                                    {2612}out(c, senc(mCli(pkCli_2984,pkSess_2988),Kcli_2999))
                            )
                            else
                                {2613}let v_3000: bool = (Sess = B) in
                                (
                                    {2614}if v_3000 then
                                    (
                                        {2615}let pkSess_3001: bitstring = pub(skB) in
                                        {2616}out(c, GetEndpointRequest);
                                        {2617}in(c, (=GetEndpointResponse,=pkSess_3001,=Sign,SP_3002: bitstring,UP_3003: bitstring));
                                        {2618}new Nc_3004: bitstring;
                                        {2619}let m1_3005: bitstring = (OpenSecureChannelRequest,pkCli_2984,Nc_3004) in
                                        {2620}out(c, (pkCli_2984,m1_3005,sign(h(m1_3005),skCli_2983)));
                                        {2621}in(c, (em2_3006: bitstring,sigM2_3007: bitstring));
                                        {2622}let m2_3008: bitstring = em2_3006 in
                                        {2623}if (verify(h(m2_3008),sigM2_3007,pkSess_3001) <> true) then
                                            0
                                        else
                                            {2624}let (=OpenSecureChannelResponse,Ns_3009: bitstring,ST_3010: bitstring,TTL_3011: bitstring) = m2_3008 in
                                            {2625}let Kcli_3012: bitstring = h((Nc_3004,Ns_3009)) in
                                            {2626}out(c, senc(mCli(pkCli_2984,pkSess_3001),Kcli_3012))
                                    )
                                    else
                                        {2627}let v_3013: bool = (Sess = C) in
                                        (
                                            {2628}if v_3013 then
                                            (
                                                {2629}let pkSess_3014: bitstring = pub(skC) in
                                                {2630}out(c, GetEndpointRequest);
                                                {2631}in(c, (=GetEndpointResponse,=pkSess_3014,=Sign,SP_3015: bitstring,UP_3016: bitstring));
                                                {2632}new Nc_3017: bitstring;
                                                {2633}let m1_3018: bitstring = (OpenSecureChannelRequest,pkCli_2984,Nc_3017) in
                                                {2634}out(c, (pkCli_2984,m1_3018,sign(h(m1_3018),skCli_2983)));
                                                {2635}in(c, (em2_3019: bitstring,sigM2_3020: bitstring));
                                                {2636}let m2_3021: bitstring = em2_3019 in
                                                {2637}if (verify(h(m2_3021),sigM2_3020,pkSess_3014) <> true) then
                                                    0
                                                else
                                                    {2638}let (=OpenSecureChannelResponse,Ns_3022: bitstring,ST_3023: bitstring,TTL_3024: bitstring) = m2_3021 in
                                                    {2639}let Kcli_3025: bitstring = h((Nc_3017,Ns_3022)) in
                                                    {2640}out(c, senc(mCli(pkCli_2984,pkSess_3014),Kcli_3025))
                                            )
                                            else
                                                {2641}let pkSess_3026: bitstring = pub(sk(Sess)) in
                                                {2642}out(c, GetEndpointRequest);
                                                {2643}in(c, (=GetEndpointResponse,=pkSess_3026,=Sign,SP_3027: bitstring,UP_3028: bitstring));
                                                {2644}new Nc_3029: bitstring;
                                                {2645}let m1_3030: bitstring = (OpenSecureChannelRequest,pkCli_2984,Nc_3029) in
                                                {2646}out(c, (pkCli_2984,m1_3030,sign(h(m1_3030),skCli_2983)));
                                                {2647}in(c, (em2_3031: bitstring,sigM2_3032: bitstring));
                                                {2648}let m2_3033: bitstring = em2_3031 in
                                                {2649}if (verify(h(m2_3033),sigM2_3032,pkSess_3026) <> true) then
                                                    0
                                                else
                                                    {2650}let (=OpenSecureChannelResponse,Ns_3034: bitstring,ST_3035: bitstring,TTL_3036: bitstring) = m2_3033 in
                                                    {2651}let Kcli_3037: bitstring = h((Nc_3029,Ns_3034)) in
                                                    {2652}out(c, senc(mCli(pkCli_2984,pkSess_3026),Kcli_3037))
                                        )
                                        else
                                            {2653}let pkSess_3038: bitstring = fail-any in
                                            {2654}out(c, GetEndpointRequest);
                                            {2655}in(c, (=GetEndpointResponse,=pkSess_3038,=Sign,SP_3039: bitstring,UP_3040: bitstring));
                                            {2656}new Nc_3041: bitstring;
                                            {2657}let m1_3042: bitstring = (OpenSecureChannelRequest,pkCli_2984,Nc_3041) in
                                            {2658}out(c, (pkCli_2984,m1_3042,sign(h(m1_3042),skCli_2983)));
                                            {2659}in(c, (em2_3043: bitstring,sigM2_3044: bitstring));
                                            {2660}let m2_3045: bitstring = em2_3043 in
                                            {2661}if (verify(h(m2_3045),sigM2_3044,pkSess_3038) <> true) then
                                                0
                                            else
                                                {2662}let (=OpenSecureChannelResponse,Ns_3046: bitstring,ST_3047: bitstring,TTL_3048: bitstring) = m2_3045 in
                                                {2663}let Kcli_3049: bitstring = h((Nc_3041,Ns_3046)) in
                                                {2664}out(c, senc(mCli(pkCli_2984,pkSess_3038),Kcli_3049))
                                )
                                else
                                    {2665}let pkSess_3050: bitstring = fail-any in
                                    {2666}out(c, GetEndpointRequest);
                                    {2667}in(c, (=GetEndpointResponse,=pkSess_3050,=Sign,SP_3051: bitstring,UP_3052: bitstring));
                                    {2668}new Nc_3053: bitstring;
                                    {2669}let m1_3054: bitstring = (OpenSecureChannelRequest,pkCli_2984,Nc_3053) in
                                    {2670}out(c, (pkCli_2984,m1_3054,sign(h(m1_3054),skCli_2983)));
                                    {2671}in(c, (em2_3055: bitstring,sigM2_3056: bitstring));
                                    {2672}let m2_3057: bitstring = em2_3055 in
                                    {2673}if (verify(h(m2_3057),sigM2_3056,pkSess_3050) <> true) then
                                        0
                                    else
                                        {2674}let (=OpenSecureChannelResponse,Ns_3058: bitstring,ST_3059: bitstring,TTL_3060: bitstring) = m2_3057 in
                                        {2675}let Kcli_3061: bitstring = h((Nc_3053,Ns_3058)) in
                                        {2676}out(c, senc(mCli(pkCli_2984,pkSess_3050),Kcli_3061))
                        )
                        else
                            {2677}let pkSess_3062: bitstring = fail-any in
                            {2678}out(c, GetEndpointRequest);
                            {2679}in(c, (=GetEndpointResponse,=pkSess_3062,=Sign,SP_3063: bitstring,UP_3064: bitstring));
                            {2680}new Nc_3065: bitstring;
                            {2681}let m1_3066: bitstring = (OpenSecureChannelRequest,pkCli_2984,Nc_3065) in
                            {2682}out(c, (pkCli_2984,m1_3066,sign(h(m1_3066),skCli_2983)));
                            {2683}in(c, (em2_3067: bitstring,sigM2_3068: bitstring));
                            {2684}let m2_3069: bitstring = em2_3067 in
                            {2685}if (verify(h(m2_3069),sigM2_3068,pkSess_3062) <> true) then
                                0
                            else
                                {2686}let (=OpenSecureChannelResponse,Ns_3070: bitstring,ST_3071: bitstring,TTL_3072: bitstring) = m2_3069 in
                                {2687}let Kcli_3073: bitstring = h((Nc_3065,Ns_3070)) in
                                {2688}out(c, senc(mCli(pkCli_2984,pkSess_3062),Kcli_3073))
                    )
                    else
                        {2689}let v_3074: bool = (Disco = B) in
                        (
                            {2690}if v_3074 then
                            (
                                {2691}let pkDisco_3075: bitstring = pub(skB) in
                                {2692}let v_3076: bool = (Sess = A) in
                                (
                                    {2693}if v_3076 then
                                    (
                                        {2694}let pkSess_3077: bitstring = pub(skA) in
                                        {2695}out(c, GetEndpointRequest);
                                        {2696}in(c, (=GetEndpointResponse,=pkSess_3077,=Sign,SP_3078: bitstring,UP_3079: bitstring));
                                        {2697}new Nc_3080: bitstring;
                                        {2698}let m1_3081: bitstring = (OpenSecureChannelRequest,pkCli_2984,Nc_3080) in
                                        {2699}out(c, (pkCli_2984,m1_3081,sign(h(m1_3081),skCli_2983)));
                                        {2700}in(c, (em2_3082: bitstring,sigM2_3083: bitstring));
                                        {2701}let m2_3084: bitstring = em2_3082 in
                                        {2702}if (verify(h(m2_3084),sigM2_3083,pkSess_3077) <> true) then
                                            0
                                        else
                                            {2703}let (=OpenSecureChannelResponse,Ns_3085: bitstring,ST_3086: bitstring,TTL_3087: bitstring) = m2_3084 in
                                            {2704}let Kcli_3088: bitstring = h((Nc_3080,Ns_3085)) in
                                            {2705}out(c, senc(mCli(pkCli_2984,pkSess_3077),Kcli_3088))
                                    )
                                    else
                                        {2706}let v_3089: bool = (Sess = B) in
                                        (
                                            {2707}if v_3089 then
                                            (
                                                {2708}let pkSess_3090: bitstring = pub(skB) in
                                                {2709}out(c, GetEndpointRequest);
                                                {2710}in(c, (=GetEndpointResponse,=pkSess_3090,=Sign,SP_3091: bitstring,UP_3092: bitstring));
                                                {2711}new Nc_3093: bitstring;
                                                {2712}let m1_3094: bitstring = (OpenSecureChannelRequest,pkCli_2984,Nc_3093) in
                                                {2713}out(c, (pkCli_2984,m1_3094,sign(h(m1_3094),skCli_2983)));
                                                {2714}in(c, (em2_3095: bitstring,sigM2_3096: bitstring));
                                                {2715}let m2_3097: bitstring = em2_3095 in
                                                {2716}if (verify(h(m2_3097),sigM2_3096,pkSess_3090) <> true) then
                                                    0
                                                else
                                                    {2717}let (=OpenSecureChannelResponse,Ns_3098: bitstring,ST_3099: bitstring,TTL_3100: bitstring) = m2_3097 in
                                                    {2718}let Kcli_3101: bitstring = h((Nc_3093,Ns_3098)) in
                                                    {2719}out(c, senc(mCli(pkCli_2984,pkSess_3090),Kcli_3101))
                                            )
                                            else
                                                {2720}let v_3102: bool = (Sess = C) in
                                                (
                                                    {2721}if v_3102 then
                                                    (
                                                        {2722}let pkSess_3103: bitstring = pub(skC) in
                                                        {2723}out(c, GetEndpointRequest);
                                                        {2724}in(c, (=GetEndpointResponse,=pkSess_3103,=Sign,SP_3104: bitstring,UP_3105: bitstring));
                                                        {2725}new Nc_3106: bitstring;
                                                        {2726}let m1_3107: bitstring = (OpenSecureChannelRequest,pkCli_2984,Nc_3106) in
                                                        {2727}out(c, (pkCli_2984,m1_3107,sign(h(m1_3107),skCli_2983)));
                                                        {2728}in(c, (em2_3108: bitstring,sigM2_3109: bitstring));
                                                        {2729}let m2_3110: bitstring = em2_3108 in
                                                        {2730}if (verify(h(m2_3110),sigM2_3109,pkSess_3103) <> true) then
                                                            0
                                                        else
                                                            {2731}let (=OpenSecureChannelResponse,Ns_3111: bitstring,ST_3112: bitstring,TTL_3113: bitstring) = m2_3110 in
                                                            {2732}let Kcli_3114: bitstring = h((Nc_3106,Ns_3111)) in
                                                            {2733}out(c, senc(mCli(pkCli_2984,pkSess_3103),Kcli_3114))
                                                    )
                                                    else
                                                        {2734}let pkSess_3115: bitstring = pub(sk(Sess)) in
                                                        {2735}out(c, GetEndpointRequest);
                                                        {2736}in(c, (=GetEndpointResponse,=pkSess_3115,=Sign,SP_3116: bitstring,UP_3117: bitstring));
                                                        {2737}new Nc_3118: bitstring;
                                                        {2738}let m1_3119: bitstring = (OpenSecureChannelRequest,pkCli_2984,Nc_3118) in
                                                        {2739}out(c, (pkCli_2984,m1_3119,sign(h(m1_3119),skCli_2983)));
                                                        {2740}in(c, (em2_3120: bitstring,sigM2_3121: bitstring));
                                                        {2741}let m2_3122: bitstring = em2_3120 in
                                                        {2742}if (verify(h(m2_3122),sigM2_3121,pkSess_3115) <> true) then
                                                            0
                                                        else
                                                            {2743}let (=OpenSecureChannelResponse,Ns_3123: bitstring,ST_3124: bitstring,TTL_3125: bitstring) = m2_3122 in
                                                            {2744}let Kcli_3126: bitstring = h((Nc_3118,Ns_3123)) in
                                                            {2745}out(c, senc(mCli(pkCli_2984,pkSess_3115),Kcli_3126))
                                                )
                                                else
                                                    {2746}let pkSess_3127: bitstring = fail-any in
                                                    {2747}out(c, GetEndpointRequest);
                                                    {2748}in(c, (=GetEndpointResponse,=pkSess_3127,=Sign,SP_3128: bitstring,UP_3129: bitstring));
                                                    {2749}new Nc_3130: bitstring;
                                                    {2750}let m1_3131: bitstring = (OpenSecureChannelRequest,pkCli_2984,Nc_3130) in
                                                    {2751}out(c, (pkCli_2984,m1_3131,sign(h(m1_3131),skCli_2983)));
                                                    {2752}in(c, (em2_3132: bitstring,sigM2_3133: bitstring));
                                                    {2753}let m2_3134: bitstring = em2_3132 in
                                                    {2754}if (verify(h(m2_3134),sigM2_3133,pkSess_3127) <> true) then
                                                        0
                                                    else
                                                        {2755}let (=OpenSecureChannelResponse,Ns_3135: bitstring,ST_3136: bitstring,TTL_3137: bitstring) = m2_3134 in
                                                        {2756}let Kcli_3138: bitstring = h((Nc_3130,Ns_3135)) in
                                                        {2757}out(c, senc(mCli(pkCli_2984,pkSess_3127),Kcli_3138))
                                        )
                                        else
                                            {2758}let pkSess_3139: bitstring = fail-any in
                                            {2759}out(c, GetEndpointRequest);
                                            {2760}in(c, (=GetEndpointResponse,=pkSess_3139,=Sign,SP_3140: bitstring,UP_3141: bitstring));
                                            {2761}new Nc_3142: bitstring;
                                            {2762}let m1_3143: bitstring = (OpenSecureChannelRequest,pkCli_2984,Nc_3142) in
                                            {2763}out(c, (pkCli_2984,m1_3143,sign(h(m1_3143),skCli_2983)));
                                            {2764}in(c, (em2_3144: bitstring,sigM2_3145: bitstring));
                                            {2765}let m2_3146: bitstring = em2_3144 in
                                            {2766}if (verify(h(m2_3146),sigM2_3145,pkSess_3139) <> true) then
                                                0
                                            else
                                                {2767}let (=OpenSecureChannelResponse,Ns_3147: bitstring,ST_3148: bitstring,TTL_3149: bitstring) = m2_3146 in
                                                {2768}let Kcli_3150: bitstring = h((Nc_3142,Ns_3147)) in
                                                {2769}out(c, senc(mCli(pkCli_2984,pkSess_3139),Kcli_3150))
                                )
                                else
                                    {2770}let pkSess_3151: bitstring = fail-any in
                                    {2771}out(c, GetEndpointRequest);
                                    {2772}in(c, (=GetEndpointResponse,=pkSess_3151,=Sign,SP_3152: bitstring,UP_3153: bitstring));
                                    {2773}new Nc_3154: bitstring;
                                    {2774}let m1_3155: bitstring = (OpenSecureChannelRequest,pkCli_2984,Nc_3154) in
                                    {2775}out(c, (pkCli_2984,m1_3155,sign(h(m1_3155),skCli_2983)));
                                    {2776}in(c, (em2_3156: bitstring,sigM2_3157: bitstring));
                                    {2777}let m2_3158: bitstring = em2_3156 in
                                    {2778}if (verify(h(m2_3158),sigM2_3157,pkSess_3151) <> true) then
                                        0
                                    else
                                        {2779}let (=OpenSecureChannelResponse,Ns_3159: bitstring,ST_3160: bitstring,TTL_3161: bitstring) = m2_3158 in
                                        {2780}let Kcli_3162: bitstring = h((Nc_3154,Ns_3159)) in
                                        {2781}out(c, senc(mCli(pkCli_2984,pkSess_3151),Kcli_3162))
                            )
                            else
                                {2782}let v_3163: bool = (Disco = C) in
                                (
                                    {2783}if v_3163 then
                                    (
                                        {2784}let pkDisco_3164: bitstring = pub(skC) in
                                        {2785}let v_3165: bool = (Sess = A) in
                                        (
                                            {2786}if v_3165 then
                                            (
                                                {2787}let pkSess_3166: bitstring = pub(skA) in
                                                {2788}out(c, GetEndpointRequest);
                                                {2789}in(c, (=GetEndpointResponse,=pkSess_3166,=Sign,SP_3167: bitstring,UP_3168: bitstring));
                                                {2790}new Nc_3169: bitstring;
                                                {2791}let m1_3170: bitstring = (OpenSecureChannelRequest,pkCli_2984,Nc_3169) in
                                                {2792}out(c, (pkCli_2984,m1_3170,sign(h(m1_3170),skCli_2983)));
                                                {2793}in(c, (em2_3171: bitstring,sigM2_3172: bitstring));
                                                {2794}let m2_3173: bitstring = em2_3171 in
                                                {2795}if (verify(h(m2_3173),sigM2_3172,pkSess_3166) <> true) then
                                                    0
                                                else
                                                    {2796}let (=OpenSecureChannelResponse,Ns_3174: bitstring,ST_3175: bitstring,TTL_3176: bitstring) = m2_3173 in
                                                    {2797}let Kcli_3177: bitstring = h((Nc_3169,Ns_3174)) in
                                                    {2798}out(c, senc(mCli(pkCli_2984,pkSess_3166),Kcli_3177))
                                            )
                                            else
                                                {2799}let v_3178: bool = (Sess = B) in
                                                (
                                                    {2800}if v_3178 then
                                                    (
                                                        {2801}let pkSess_3179: bitstring = pub(skB) in
                                                        {2802}out(c, GetEndpointRequest);
                                                        {2803}in(c, (=GetEndpointResponse,=pkSess_3179,=Sign,SP_3180: bitstring,UP_3181: bitstring));
                                                        {2804}new Nc_3182: bitstring;
                                                        {2805}let m1_3183: bitstring = (OpenSecureChannelRequest,pkCli_2984,Nc_3182) in
                                                        {2806}out(c, (pkCli_2984,m1_3183,sign(h(m1_3183),skCli_2983)));
                                                        {2807}in(c, (em2_3184: bitstring,sigM2_3185: bitstring));
                                                        {2808}let m2_3186: bitstring = em2_3184 in
                                                        {2809}if (verify(h(m2_3186),sigM2_3185,pkSess_3179) <> true) then
                                                            0
                                                        else
                                                            {2810}let (=OpenSecureChannelResponse,Ns_3187: bitstring,ST_3188: bitstring,TTL_3189: bitstring) = m2_3186 in
                                                            {2811}let Kcli_3190: bitstring = h((Nc_3182,Ns_3187)) in
                                                            {2812}out(c, senc(mCli(pkCli_2984,pkSess_3179),Kcli_3190))
                                                    )
                                                    else
                                                        {2813}let v_3191: bool = (Sess = C) in
                                                        (
                                                            {2814}if v_3191 then
                                                            (
                                                                {2815}let pkSess_3192: bitstring = pub(skC) in
                                                                {2816}out(c, GetEndpointRequest);
                                                                {2817}in(c, (=GetEndpointResponse,=pkSess_3192,=Sign,SP_3193: bitstring,UP_3194: bitstring));
                                                                {2818}new Nc_3195: bitstring;
                                                                {2819}let m1_3196: bitstring = (OpenSecureChannelRequest,pkCli_2984,Nc_3195) in
                                                                {2820}out(c, (pkCli_2984,m1_3196,sign(h(m1_3196),skCli_2983)));
                                                                {2821}in(c, (em2_3197: bitstring,sigM2_3198: bitstring));
                                                                {2822}let m2_3199: bitstring = em2_3197 in
                                                                {2823}if (verify(h(m2_3199),sigM2_3198,pkSess_3192) <> true) then
                                                                    0
                                                                else
                                                                    {2824}let (=OpenSecureChannelResponse,Ns_3200: bitstring,ST_3201: bitstring,TTL_3202: bitstring) = m2_3199 in
                                                                    {2825}let Kcli_3203: bitstring = h((Nc_3195,Ns_3200)) in
                                                                    {2826}out(c, senc(mCli(pkCli_2984,pkSess_3192),Kcli_3203))
                                                            )
                                                            else
                                                                {2827}let pkSess_3204: bitstring = pub(sk(Sess)) in
                                                                {2828}out(c, GetEndpointRequest);
                                                                {2829}in(c, (=GetEndpointResponse,=pkSess_3204,=Sign,SP_3205: bitstring,UP_3206: bitstring));
                                                                {2830}new Nc_3207: bitstring;
                                                                {2831}let m1_3208: bitstring = (OpenSecureChannelRequest,pkCli_2984,Nc_3207) in
                                                                {2832}out(c, (pkCli_2984,m1_3208,sign(h(m1_3208),skCli_2983)));
                                                                {2833}in(c, (em2_3209: bitstring,sigM2_3210: bitstring));
                                                                {2834}let m2_3211: bitstring = em2_3209 in
                                                                {2835}if (verify(h(m2_3211),sigM2_3210,pkSess_3204) <> true) then
                                                                    0
                                                                else
                                                                    {2836}let (=OpenSecureChannelResponse,Ns_3212: bitstring,ST_3213: bitstring,TTL_3214: bitstring) = m2_3211 in
                                                                    {2837}let Kcli_3215: bitstring = h((Nc_3207,Ns_3212)) in
                                                                    {2838}out(c, senc(mCli(pkCli_2984,pkSess_3204),Kcli_3215))
                                                        )
                                                        else
                                                            {2839}let pkSess_3216: bitstring = fail-any in
                                                            {2840}out(c, GetEndpointRequest);
                                                            {2841}in(c, (=GetEndpointResponse,=pkSess_3216,=Sign,SP_3217: bitstring,UP_3218: bitstring));
                                                            {2842}new Nc_3219: bitstring;
                                                            {2843}let m1_3220: bitstring = (OpenSecureChannelRequest,pkCli_2984,Nc_3219) in
                                                            {2844}out(c, (pkCli_2984,m1_3220,sign(h(m1_3220),skCli_2983)));
                                                            {2845}in(c, (em2_3221: bitstring,sigM2_3222: bitstring));
                                                            {2846}let m2_3223: bitstring = em2_3221 in
                                                            {2847}if (verify(h(m2_3223),sigM2_3222,pkSess_3216) <> true) then
                                                                0
                                                            else
                                                                {2848}let (=OpenSecureChannelResponse,Ns_3224: bitstring,ST_3225: bitstring,TTL_3226: bitstring) = m2_3223 in
                                                                {2849}let Kcli_3227: bitstring = h((Nc_3219,Ns_3224)) in
                                                                {2850}out(c, senc(mCli(pkCli_2984,pkSess_3216),Kcli_3227))
                                                )
                                                else
                                                    {2851}let pkSess_3228: bitstring = fail-any in
                                                    {2852}out(c, GetEndpointRequest);
                                                    {2853}in(c, (=GetEndpointResponse,=pkSess_3228,=Sign,SP_3229: bitstring,UP_3230: bitstring));
                                                    {2854}new Nc_3231: bitstring;
                                                    {2855}let m1_3232: bitstring = (OpenSecureChannelRequest,pkCli_2984,Nc_3231) in
                                                    {2856}out(c, (pkCli_2984,m1_3232,sign(h(m1_3232),skCli_2983)));
                                                    {2857}in(c, (em2_3233: bitstring,sigM2_3234: bitstring));
                                                    {2858}let m2_3235: bitstring = em2_3233 in
                                                    {2859}if (verify(h(m2_3235),sigM2_3234,pkSess_3228) <> true) then
                                                        0
                                                    else
                                                        {2860}let (=OpenSecureChannelResponse,Ns_3236: bitstring,ST_3237: bitstring,TTL_3238: bitstring) = m2_3235 in
                                                        {2861}let Kcli_3239: bitstring = h((Nc_3231,Ns_3236)) in
                                                        {2862}out(c, senc(mCli(pkCli_2984,pkSess_3228),Kcli_3239))
                                        )
                                        else
                                            {2863}let pkSess_3240: bitstring = fail-any in
                                            {2864}out(c, GetEndpointRequest);
                                            {2865}in(c, (=GetEndpointResponse,=pkSess_3240,=Sign,SP_3241: bitstring,UP_3242: bitstring));
                                            {2866}new Nc_3243: bitstring;
                                            {2867}let m1_3244: bitstring = (OpenSecureChannelRequest,pkCli_2984,Nc_3243) in
                                            {2868}out(c, (pkCli_2984,m1_3244,sign(h(m1_3244),skCli_2983)));
                                            {2869}in(c, (em2_3245: bitstring,sigM2_3246: bitstring));
                                            {2870}let m2_3247: bitstring = em2_3245 in
                                            {2871}if (verify(h(m2_3247),sigM2_3246,pkSess_3240) <> true) then
                                                0
                                            else
                                                {2872}let (=OpenSecureChannelResponse,Ns_3248: bitstring,ST_3249: bitstring,TTL_3250: bitstring) = m2_3247 in
                                                {2873}let Kcli_3251: bitstring = h((Nc_3243,Ns_3248)) in
                                                {2874}out(c, senc(mCli(pkCli_2984,pkSess_3240),Kcli_3251))
                                    )
                                    else
                                        {2875}let pkDisco_3252: bitstring = pub(sk(Disco)) in
                                        {2876}let v_3253: bool = (Sess = A) in
                                        (
                                            {2877}if v_3253 then
                                            (
                                                {2878}let pkSess_3254: bitstring = pub(skA) in
                                                {2879}out(c, GetEndpointRequest);
                                                {2880}in(c, (=GetEndpointResponse,=pkSess_3254,=Sign,SP_3255: bitstring,UP_3256: bitstring));
                                                {2881}new Nc_3257: bitstring;
                                                {2882}let m1_3258: bitstring = (OpenSecureChannelRequest,pkCli_2984,Nc_3257) in
                                                {2883}out(c, (pkCli_2984,m1_3258,sign(h(m1_3258),skCli_2983)));
                                                {2884}in(c, (em2_3259: bitstring,sigM2_3260: bitstring));
                                                {2885}let m2_3261: bitstring = em2_3259 in
                                                {2886}if (verify(h(m2_3261),sigM2_3260,pkSess_3254) <> true) then
                                                    0
                                                else
                                                    {2887}let (=OpenSecureChannelResponse,Ns_3262: bitstring,ST_3263: bitstring,TTL_3264: bitstring) = m2_3261 in
                                                    {2888}let Kcli_3265: bitstring = h((Nc_3257,Ns_3262)) in
                                                    {2889}out(c, senc(mCli(pkCli_2984,pkSess_3254),Kcli_3265))
                                            )
                                            else
                                                {2890}let v_3266: bool = (Sess = B) in
                                                (
                                                    {2891}if v_3266 then
                                                    (
                                                        {2892}let pkSess_3267: bitstring = pub(skB) in
                                                        {2893}out(c, GetEndpointRequest);
                                                        {2894}in(c, (=GetEndpointResponse,=pkSess_3267,=Sign,SP_3268: bitstring,UP_3269: bitstring));
                                                        {2895}new Nc_3270: bitstring;
                                                        {2896}let m1_3271: bitstring = (OpenSecureChannelRequest,pkCli_2984,Nc_3270) in
                                                        {2897}out(c, (pkCli_2984,m1_3271,sign(h(m1_3271),skCli_2983)));
                                                        {2898}in(c, (em2_3272: bitstring,sigM2_3273: bitstring));
                                                        {2899}let m2_3274: bitstring = em2_3272 in
                                                        {2900}if (verify(h(m2_3274),sigM2_3273,pkSess_3267) <> true) then
                                                            0
                                                        else
                                                            {2901}let (=OpenSecureChannelResponse,Ns_3275: bitstring,ST_3276: bitstring,TTL_3277: bitstring) = m2_3274 in
                                                            {2902}let Kcli_3278: bitstring = h((Nc_3270,Ns_3275)) in
                                                            {2903}out(c, senc(mCli(pkCli_2984,pkSess_3267),Kcli_3278))
                                                    )
                                                    else
                                                        {2904}let v_3279: bool = (Sess = C) in
                                                        (
                                                            {2905}if v_3279 then
                                                            (
                                                                {2906}let pkSess_3280: bitstring = pub(skC) in
                                                                {2907}out(c, GetEndpointRequest);
                                                                {2908}in(c, (=GetEndpointResponse,=pkSess_3280,=Sign,SP_3281: bitstring,UP_3282: bitstring));
                                                                {2909}new Nc_3283: bitstring;
                                                                {2910}let m1_3284: bitstring = (OpenSecureChannelRequest,pkCli_2984,Nc_3283) in
                                                                {2911}out(c, (pkCli_2984,m1_3284,sign(h(m1_3284),skCli_2983)));
                                                                {2912}in(c, (em2_3285: bitstring,sigM2_3286: bitstring));
                                                                {2913}let m2_3287: bitstring = em2_3285 in
                                                                {2914}if (verify(h(m2_3287),sigM2_3286,pkSess_3280) <> true) then
                                                                    0
                                                                else
                                                                    {2915}let (=OpenSecureChannelResponse,Ns_3288: bitstring,ST_3289: bitstring,TTL_3290: bitstring) = m2_3287 in
                                                                    {2916}let Kcli_3291: bitstring = h((Nc_3283,Ns_3288)) in
                                                                    {2917}out(c, senc(mCli(pkCli_2984,pkSess_3280),Kcli_3291))
                                                            )
                                                            else
                                                                {2918}let pkSess_3292: bitstring = pub(sk(Sess)) in
                                                                {2919}out(c, GetEndpointRequest);
                                                                {2920}in(c, (=GetEndpointResponse,=pkSess_3292,=Sign,SP_3293: bitstring,UP_3294: bitstring));
                                                                {2921}new Nc_3295: bitstring;
                                                                {2922}let m1_3296: bitstring = (OpenSecureChannelRequest,pkCli_2984,Nc_3295) in
                                                                {2923}out(c, (pkCli_2984,m1_3296,sign(h(m1_3296),skCli_2983)));
                                                                {2924}in(c, (em2_3297: bitstring,sigM2_3298: bitstring));
                                                                {2925}let m2_3299: bitstring = em2_3297 in
                                                                {2926}if (verify(h(m2_3299),sigM2_3298,pkSess_3292) <> true) then
                                                                    0
                                                                else
                                                                    {2927}let (=OpenSecureChannelResponse,Ns_3300: bitstring,ST_3301: bitstring,TTL_3302: bitstring) = m2_3299 in
                                                                    {2928}let Kcli_3303: bitstring = h((Nc_3295,Ns_3300)) in
                                                                    {2929}out(c, senc(mCli(pkCli_2984,pkSess_3292),Kcli_3303))
                                                        )
                                                        else
                                                            {2930}let pkSess_3304: bitstring = fail-any in
                                                            {2931}out(c, GetEndpointRequest);
                                                            {2932}in(c, (=GetEndpointResponse,=pkSess_3304,=Sign,SP_3305: bitstring,UP_3306: bitstring));
                                                            {2933}new Nc_3307: bitstring;
                                                            {2934}let m1_3308: bitstring = (OpenSecureChannelRequest,pkCli_2984,Nc_3307) in
                                                            {2935}out(c, (pkCli_2984,m1_3308,sign(h(m1_3308),skCli_2983)));
                                                            {2936}in(c, (em2_3309: bitstring,sigM2_3310: bitstring));
                                                            {2937}let m2_3311: bitstring = em2_3309 in
                                                            {2938}if (verify(h(m2_3311),sigM2_3310,pkSess_3304) <> true) then
                                                                0
                                                            else
                                                                {2939}let (=OpenSecureChannelResponse,Ns_3312: bitstring,ST_3313: bitstring,TTL_3314: bitstring) = m2_3311 in
                                                                {2940}let Kcli_3315: bitstring = h((Nc_3307,Ns_3312)) in
                                                                {2941}out(c, senc(mCli(pkCli_2984,pkSess_3304),Kcli_3315))
                                                )
                                                else
                                                    {2942}let pkSess_3316: bitstring = fail-any in
                                                    {2943}out(c, GetEndpointRequest);
                                                    {2944}in(c, (=GetEndpointResponse,=pkSess_3316,=Sign,SP_3317: bitstring,UP_3318: bitstring));
                                                    {2945}new Nc_3319: bitstring;
                                                    {2946}let m1_3320: bitstring = (OpenSecureChannelRequest,pkCli_2984,Nc_3319) in
                                                    {2947}out(c, (pkCli_2984,m1_3320,sign(h(m1_3320),skCli_2983)));
                                                    {2948}in(c, (em2_3321: bitstring,sigM2_3322: bitstring));
                                                    {2949}let m2_3323: bitstring = em2_3321 in
                                                    {2950}if (verify(h(m2_3323),sigM2_3322,pkSess_3316) <> true) then
                                                        0
                                                    else
                                                        {2951}let (=OpenSecureChannelResponse,Ns_3324: bitstring,ST_3325: bitstring,TTL_3326: bitstring) = m2_3323 in
                                                        {2952}let Kcli_3327: bitstring = h((Nc_3319,Ns_3324)) in
                                                        {2953}out(c, senc(mCli(pkCli_2984,pkSess_3316),Kcli_3327))
                                        )
                                        else
                                            {2954}let pkSess_3328: bitstring = fail-any in
                                            {2955}out(c, GetEndpointRequest);
                                            {2956}in(c, (=GetEndpointResponse,=pkSess_3328,=Sign,SP_3329: bitstring,UP_3330: bitstring));
                                            {2957}new Nc_3331: bitstring;
                                            {2958}let m1_3332: bitstring = (OpenSecureChannelRequest,pkCli_2984,Nc_3331) in
                                            {2959}out(c, (pkCli_2984,m1_3332,sign(h(m1_3332),skCli_2983)));
                                            {2960}in(c, (em2_3333: bitstring,sigM2_3334: bitstring));
                                            {2961}let m2_3335: bitstring = em2_3333 in
                                            {2962}if (verify(h(m2_3335),sigM2_3334,pkSess_3328) <> true) then
                                                0
                                            else
                                                {2963}let (=OpenSecureChannelResponse,Ns_3336: bitstring,ST_3337: bitstring,TTL_3338: bitstring) = m2_3335 in
                                                {2964}let Kcli_3339: bitstring = h((Nc_3331,Ns_3336)) in
                                                {2965}out(c, senc(mCli(pkCli_2984,pkSess_3328),Kcli_3339))
                                )
                                else
                                    {2966}let pkDisco_3340: bitstring = fail-any in
                                    {2967}let v_3341: bool = (Sess = A) in
                                    (
                                        {2968}if v_3341 then
                                        (
                                            {2969}let pkSess_3342: bitstring = pub(skA) in
                                            {2970}out(c, GetEndpointRequest);
                                            {2971}in(c, (=GetEndpointResponse,=pkSess_3342,=Sign,SP_3343: bitstring,UP_3344: bitstring));
                                            {2972}new Nc_3345: bitstring;
                                            {2973}let m1_3346: bitstring = (OpenSecureChannelRequest,pkCli_2984,Nc_3345) in
                                            {2974}out(c, (pkCli_2984,m1_3346,sign(h(m1_3346),skCli_2983)));
                                            {2975}in(c, (em2_3347: bitstring,sigM2_3348: bitstring));
                                            {2976}let m2_3349: bitstring = em2_3347 in
                                            {2977}if (verify(h(m2_3349),sigM2_3348,pkSess_3342) <> true) then
                                                0
                                            else
                                                {2978}let (=OpenSecureChannelResponse,Ns_3350: bitstring,ST_3351: bitstring,TTL_3352: bitstring) = m2_3349 in
                                                {2979}let Kcli_3353: bitstring = h((Nc_3345,Ns_3350)) in
                                                {2980}out(c, senc(mCli(pkCli_2984,pkSess_3342),Kcli_3353))
                                        )
                                        else
                                            {2981}let v_3354: bool = (Sess = B) in
                                            (
                                                {2982}if v_3354 then
                                                (
                                                    {2983}let pkSess_3355: bitstring = pub(skB) in
                                                    {2984}out(c, GetEndpointRequest);
                                                    {2985}in(c, (=GetEndpointResponse,=pkSess_3355,=Sign,SP_3356: bitstring,UP_3357: bitstring));
                                                    {2986}new Nc_3358: bitstring;
                                                    {2987}let m1_3359: bitstring = (OpenSecureChannelRequest,pkCli_2984,Nc_3358) in
                                                    {2988}out(c, (pkCli_2984,m1_3359,sign(h(m1_3359),skCli_2983)));
                                                    {2989}in(c, (em2_3360: bitstring,sigM2_3361: bitstring));
                                                    {2990}let m2_3362: bitstring = em2_3360 in
                                                    {2991}if (verify(h(m2_3362),sigM2_3361,pkSess_3355) <> true) then
                                                        0
                                                    else
                                                        {2992}let (=OpenSecureChannelResponse,Ns_3363: bitstring,ST_3364: bitstring,TTL_3365: bitstring) = m2_3362 in
                                                        {2993}let Kcli_3366: bitstring = h((Nc_3358,Ns_3363)) in
                                                        {2994}out(c, senc(mCli(pkCli_2984,pkSess_3355),Kcli_3366))
                                                )
                                                else
                                                    {2995}let v_3367: bool = (Sess = C) in
                                                    (
                                                        {2996}if v_3367 then
                                                        (
                                                            {2997}let pkSess_3368: bitstring = pub(skC) in
                                                            {2998}out(c, GetEndpointRequest);
                                                            {2999}in(c, (=GetEndpointResponse,=pkSess_3368,=Sign,SP_3369: bitstring,UP_3370: bitstring));
                                                            {3000}new Nc_3371: bitstring;
                                                            {3001}let m1_3372: bitstring = (OpenSecureChannelRequest,pkCli_2984,Nc_3371) in
                                                            {3002}out(c, (pkCli_2984,m1_3372,sign(h(m1_3372),skCli_2983)));
                                                            {3003}in(c, (em2_3373: bitstring,sigM2_3374: bitstring));
                                                            {3004}let m2_3375: bitstring = em2_3373 in
                                                            {3005}if (verify(h(m2_3375),sigM2_3374,pkSess_3368) <> true) then
                                                                0
                                                            else
                                                                {3006}let (=OpenSecureChannelResponse,Ns_3376: bitstring,ST_3377: bitstring,TTL_3378: bitstring) = m2_3375 in
                                                                {3007}let Kcli_3379: bitstring = h((Nc_3371,Ns_3376)) in
                                                                {3008}out(c, senc(mCli(pkCli_2984,pkSess_3368),Kcli_3379))
                                                        )
                                                        else
                                                            {3009}let pkSess_3380: bitstring = pub(sk(Sess)) in
                                                            {3010}out(c, GetEndpointRequest);
                                                            {3011}in(c, (=GetEndpointResponse,=pkSess_3380,=Sign,SP_3381: bitstring,UP_3382: bitstring));
                                                            {3012}new Nc_3383: bitstring;
                                                            {3013}let m1_3384: bitstring = (OpenSecureChannelRequest,pkCli_2984,Nc_3383) in
                                                            {3014}out(c, (pkCli_2984,m1_3384,sign(h(m1_3384),skCli_2983)));
                                                            {3015}in(c, (em2_3385: bitstring,sigM2_3386: bitstring));
                                                            {3016}let m2_3387: bitstring = em2_3385 in
                                                            {3017}if (verify(h(m2_3387),sigM2_3386,pkSess_3380) <> true) then
                                                                0
                                                            else
                                                                {3018}let (=OpenSecureChannelResponse,Ns_3388: bitstring,ST_3389: bitstring,TTL_3390: bitstring) = m2_3387 in
                                                                {3019}let Kcli_3391: bitstring = h((Nc_3383,Ns_3388)) in
                                                                {3020}out(c, senc(mCli(pkCli_2984,pkSess_3380),Kcli_3391))
                                                    )
                                                    else
                                                        {3021}let pkSess_3392: bitstring = fail-any in
                                                        {3022}out(c, GetEndpointRequest);
                                                        {3023}in(c, (=GetEndpointResponse,=pkSess_3392,=Sign,SP_3393: bitstring,UP_3394: bitstring));
                                                        {3024}new Nc_3395: bitstring;
                                                        {3025}let m1_3396: bitstring = (OpenSecureChannelRequest,pkCli_2984,Nc_3395) in
                                                        {3026}out(c, (pkCli_2984,m1_3396,sign(h(m1_3396),skCli_2983)));
                                                        {3027}in(c, (em2_3397: bitstring,sigM2_3398: bitstring));
                                                        {3028}let m2_3399: bitstring = em2_3397 in
                                                        {3029}if (verify(h(m2_3399),sigM2_3398,pkSess_3392) <> true) then
                                                            0
                                                        else
                                                            {3030}let (=OpenSecureChannelResponse,Ns_3400: bitstring,ST_3401: bitstring,TTL_3402: bitstring) = m2_3399 in
                                                            {3031}let Kcli_3403: bitstring = h((Nc_3395,Ns_3400)) in
                                                            {3032}out(c, senc(mCli(pkCli_2984,pkSess_3392),Kcli_3403))
                                            )
                                            else
                                                {3033}let pkSess_3404: bitstring = fail-any in
                                                {3034}out(c, GetEndpointRequest);
                                                {3035}in(c, (=GetEndpointResponse,=pkSess_3404,=Sign,SP_3405: bitstring,UP_3406: bitstring));
                                                {3036}new Nc_3407: bitstring;
                                                {3037}let m1_3408: bitstring = (OpenSecureChannelRequest,pkCli_2984,Nc_3407) in
                                                {3038}out(c, (pkCli_2984,m1_3408,sign(h(m1_3408),skCli_2983)));
                                                {3039}in(c, (em2_3409: bitstring,sigM2_3410: bitstring));
                                                {3040}let m2_3411: bitstring = em2_3409 in
                                                {3041}if (verify(h(m2_3411),sigM2_3410,pkSess_3404) <> true) then
                                                    0
                                                else
                                                    {3042}let (=OpenSecureChannelResponse,Ns_3412: bitstring,ST_3413: bitstring,TTL_3414: bitstring) = m2_3411 in
                                                    {3043}let Kcli_3415: bitstring = h((Nc_3407,Ns_3412)) in
                                                    {3044}out(c, senc(mCli(pkCli_2984,pkSess_3404),Kcli_3415))
                                    )
                                    else
                                        {3045}let pkSess_3416: bitstring = fail-any in
                                        {3046}out(c, GetEndpointRequest);
                                        {3047}in(c, (=GetEndpointResponse,=pkSess_3416,=Sign,SP_3417: bitstring,UP_3418: bitstring));
                                        {3048}new Nc_3419: bitstring;
                                        {3049}let m1_3420: bitstring = (OpenSecureChannelRequest,pkCli_2984,Nc_3419) in
                                        {3050}out(c, (pkCli_2984,m1_3420,sign(h(m1_3420),skCli_2983)));
                                        {3051}in(c, (em2_3421: bitstring,sigM2_3422: bitstring));
                                        {3052}let m2_3423: bitstring = em2_3421 in
                                        {3053}if (verify(h(m2_3423),sigM2_3422,pkSess_3416) <> true) then
                                            0
                                        else
                                            {3054}let (=OpenSecureChannelResponse,Ns_3424: bitstring,ST_3425: bitstring,TTL_3426: bitstring) = m2_3423 in
                                            {3055}let Kcli_3427: bitstring = h((Nc_3419,Ns_3424)) in
                                            {3056}out(c, senc(mCli(pkCli_2984,pkSess_3416),Kcli_3427))
                        )
                        else
                            {3057}let pkDisco_3428: bitstring = fail-any in
                            {3058}let v_3429: bool = (Sess = A) in
                            (
                                {3059}if v_3429 then
                                (
                                    {3060}let pkSess_3430: bitstring = pub(skA) in
                                    {3061}out(c, GetEndpointRequest);
                                    {3062}in(c, (=GetEndpointResponse,=pkSess_3430,=Sign,SP_3431: bitstring,UP_3432: bitstring));
                                    {3063}new Nc_3433: bitstring;
                                    {3064}let m1_3434: bitstring = (OpenSecureChannelRequest,pkCli_2984,Nc_3433) in
                                    {3065}out(c, (pkCli_2984,m1_3434,sign(h(m1_3434),skCli_2983)));
                                    {3066}in(c, (em2_3435: bitstring,sigM2_3436: bitstring));
                                    {3067}let m2_3437: bitstring = em2_3435 in
                                    {3068}if (verify(h(m2_3437),sigM2_3436,pkSess_3430) <> true) then
                                        0
                                    else
                                        {3069}let (=OpenSecureChannelResponse,Ns_3438: bitstring,ST_3439: bitstring,TTL_3440: bitstring) = m2_3437 in
                                        {3070}let Kcli_3441: bitstring = h((Nc_3433,Ns_3438)) in
                                        {3071}out(c, senc(mCli(pkCli_2984,pkSess_3430),Kcli_3441))
                                )
                                else
                                    {3072}let v_3442: bool = (Sess = B) in
                                    (
                                        {3073}if v_3442 then
                                        (
                                            {3074}let pkSess_3443: bitstring = pub(skB) in
                                            {3075}out(c, GetEndpointRequest);
                                            {3076}in(c, (=GetEndpointResponse,=pkSess_3443,=Sign,SP_3444: bitstring,UP_3445: bitstring));
                                            {3077}new Nc_3446: bitstring;
                                            {3078}let m1_3447: bitstring = (OpenSecureChannelRequest,pkCli_2984,Nc_3446) in
                                            {3079}out(c, (pkCli_2984,m1_3447,sign(h(m1_3447),skCli_2983)));
                                            {3080}in(c, (em2_3448: bitstring,sigM2_3449: bitstring));
                                            {3081}let m2_3450: bitstring = em2_3448 in
                                            {3082}if (verify(h(m2_3450),sigM2_3449,pkSess_3443) <> true) then
                                                0
                                            else
                                                {3083}let (=OpenSecureChannelResponse,Ns_3451: bitstring,ST_3452: bitstring,TTL_3453: bitstring) = m2_3450 in
                                                {3084}let Kcli_3454: bitstring = h((Nc_3446,Ns_3451)) in
                                                {3085}out(c, senc(mCli(pkCli_2984,pkSess_3443),Kcli_3454))
                                        )
                                        else
                                            {3086}let v_3455: bool = (Sess = C) in
                                            (
                                                {3087}if v_3455 then
                                                (
                                                    {3088}let pkSess_3456: bitstring = pub(skC) in
                                                    {3089}out(c, GetEndpointRequest);
                                                    {3090}in(c, (=GetEndpointResponse,=pkSess_3456,=Sign,SP_3457: bitstring,UP_3458: bitstring));
                                                    {3091}new Nc_3459: bitstring;
                                                    {3092}let m1_3460: bitstring = (OpenSecureChannelRequest,pkCli_2984,Nc_3459) in
                                                    {3093}out(c, (pkCli_2984,m1_3460,sign(h(m1_3460),skCli_2983)));
                                                    {3094}in(c, (em2_3461: bitstring,sigM2_3462: bitstring));
                                                    {3095}let m2_3463: bitstring = em2_3461 in
                                                    {3096}if (verify(h(m2_3463),sigM2_3462,pkSess_3456) <> true) then
                                                        0
                                                    else
                                                        {3097}let (=OpenSecureChannelResponse,Ns_3464: bitstring,ST_3465: bitstring,TTL_3466: bitstring) = m2_3463 in
                                                        {3098}let Kcli_3467: bitstring = h((Nc_3459,Ns_3464)) in
                                                        {3099}out(c, senc(mCli(pkCli_2984,pkSess_3456),Kcli_3467))
                                                )
                                                else
                                                    {3100}let pkSess_3468: bitstring = pub(sk(Sess)) in
                                                    {3101}out(c, GetEndpointRequest);
                                                    {3102}in(c, (=GetEndpointResponse,=pkSess_3468,=Sign,SP_3469: bitstring,UP_3470: bitstring));
                                                    {3103}new Nc_3471: bitstring;
                                                    {3104}let m1_3472: bitstring = (OpenSecureChannelRequest,pkCli_2984,Nc_3471) in
                                                    {3105}out(c, (pkCli_2984,m1_3472,sign(h(m1_3472),skCli_2983)));
                                                    {3106}in(c, (em2_3473: bitstring,sigM2_3474: bitstring));
                                                    {3107}let m2_3475: bitstring = em2_3473 in
                                                    {3108}if (verify(h(m2_3475),sigM2_3474,pkSess_3468) <> true) then
                                                        0
                                                    else
                                                        {3109}let (=OpenSecureChannelResponse,Ns_3476: bitstring,ST_3477: bitstring,TTL_3478: bitstring) = m2_3475 in
                                                        {3110}let Kcli_3479: bitstring = h((Nc_3471,Ns_3476)) in
                                                        {3111}out(c, senc(mCli(pkCli_2984,pkSess_3468),Kcli_3479))
                                            )
                                            else
                                                {3112}let pkSess_3480: bitstring = fail-any in
                                                {3113}out(c, GetEndpointRequest);
                                                {3114}in(c, (=GetEndpointResponse,=pkSess_3480,=Sign,SP_3481: bitstring,UP_3482: bitstring));
                                                {3115}new Nc_3483: bitstring;
                                                {3116}let m1_3484: bitstring = (OpenSecureChannelRequest,pkCli_2984,Nc_3483) in
                                                {3117}out(c, (pkCli_2984,m1_3484,sign(h(m1_3484),skCli_2983)));
                                                {3118}in(c, (em2_3485: bitstring,sigM2_3486: bitstring));
                                                {3119}let m2_3487: bitstring = em2_3485 in
                                                {3120}if (verify(h(m2_3487),sigM2_3486,pkSess_3480) <> true) then
                                                    0
                                                else
                                                    {3121}let (=OpenSecureChannelResponse,Ns_3488: bitstring,ST_3489: bitstring,TTL_3490: bitstring) = m2_3487 in
                                                    {3122}let Kcli_3491: bitstring = h((Nc_3483,Ns_3488)) in
                                                    {3123}out(c, senc(mCli(pkCli_2984,pkSess_3480),Kcli_3491))
                                    )
                                    else
                                        {3124}let pkSess_3492: bitstring = fail-any in
                                        {3125}out(c, GetEndpointRequest);
                                        {3126}in(c, (=GetEndpointResponse,=pkSess_3492,=Sign,SP_3493: bitstring,UP_3494: bitstring));
                                        {3127}new Nc_3495: bitstring;
                                        {3128}let m1_3496: bitstring = (OpenSecureChannelRequest,pkCli_2984,Nc_3495) in
                                        {3129}out(c, (pkCli_2984,m1_3496,sign(h(m1_3496),skCli_2983)));
                                        {3130}in(c, (em2_3497: bitstring,sigM2_3498: bitstring));
                                        {3131}let m2_3499: bitstring = em2_3497 in
                                        {3132}if (verify(h(m2_3499),sigM2_3498,pkSess_3492) <> true) then
                                            0
                                        else
                                            {3133}let (=OpenSecureChannelResponse,Ns_3500: bitstring,ST_3501: bitstring,TTL_3502: bitstring) = m2_3499 in
                                            {3134}let Kcli_3503: bitstring = h((Nc_3495,Ns_3500)) in
                                            {3135}out(c, senc(mCli(pkCli_2984,pkSess_3492),Kcli_3503))
                            )
                            else
                                {3136}let pkSess_3504: bitstring = fail-any in
                                {3137}out(c, GetEndpointRequest);
                                {3138}in(c, (=GetEndpointResponse,=pkSess_3504,=Sign,SP_3505: bitstring,UP_3506: bitstring));
                                {3139}new Nc_3507: bitstring;
                                {3140}let m1_3508: bitstring = (OpenSecureChannelRequest,pkCli_2984,Nc_3507) in
                                {3141}out(c, (pkCli_2984,m1_3508,sign(h(m1_3508),skCli_2983)));
                                {3142}in(c, (em2_3509: bitstring,sigM2_3510: bitstring));
                                {3143}let m2_3511: bitstring = em2_3509 in
                                {3144}if (verify(h(m2_3511),sigM2_3510,pkSess_3504) <> true) then
                                    0
                                else
                                    {3145}let (=OpenSecureChannelResponse,Ns_3512: bitstring,ST_3513: bitstring,TTL_3514: bitstring) = m2_3511 in
                                    {3146}let Kcli_3515: bitstring = h((Nc_3507,Ns_3512)) in
                                    {3147}out(c, senc(mCli(pkCli_2984,pkSess_3504),Kcli_3515))
                )
                else
                    {3148}let pkDisco_3516: bitstring = fail-any in
                    {3149}let v_3517: bool = (Sess = A) in
                    (
                        {3150}if v_3517 then
                        (
                            {3151}let pkSess_3518: bitstring = pub(skA) in
                            {3152}out(c, GetEndpointRequest);
                            {3153}in(c, (=GetEndpointResponse,=pkSess_3518,=Sign,SP_3519: bitstring,UP_3520: bitstring));
                            {3154}new Nc_3521: bitstring;
                            {3155}let m1_3522: bitstring = (OpenSecureChannelRequest,pkCli_2984,Nc_3521) in
                            {3156}out(c, (pkCli_2984,m1_3522,sign(h(m1_3522),skCli_2983)));
                            {3157}in(c, (em2_3523: bitstring,sigM2_3524: bitstring));
                            {3158}let m2_3525: bitstring = em2_3523 in
                            {3159}if (verify(h(m2_3525),sigM2_3524,pkSess_3518) <> true) then
                                0
                            else
                                {3160}let (=OpenSecureChannelResponse,Ns_3526: bitstring,ST_3527: bitstring,TTL_3528: bitstring) = m2_3525 in
                                {3161}let Kcli_3529: bitstring = h((Nc_3521,Ns_3526)) in
                                {3162}out(c, senc(mCli(pkCli_2984,pkSess_3518),Kcli_3529))
                        )
                        else
                            {3163}let v_3530: bool = (Sess = B) in
                            (
                                {3164}if v_3530 then
                                (
                                    {3165}let pkSess_3531: bitstring = pub(skB) in
                                    {3166}out(c, GetEndpointRequest);
                                    {3167}in(c, (=GetEndpointResponse,=pkSess_3531,=Sign,SP_3532: bitstring,UP_3533: bitstring));
                                    {3168}new Nc_3534: bitstring;
                                    {3169}let m1_3535: bitstring = (OpenSecureChannelRequest,pkCli_2984,Nc_3534) in
                                    {3170}out(c, (pkCli_2984,m1_3535,sign(h(m1_3535),skCli_2983)));
                                    {3171}in(c, (em2_3536: bitstring,sigM2_3537: bitstring));
                                    {3172}let m2_3538: bitstring = em2_3536 in
                                    {3173}if (verify(h(m2_3538),sigM2_3537,pkSess_3531) <> true) then
                                        0
                                    else
                                        {3174}let (=OpenSecureChannelResponse,Ns_3539: bitstring,ST_3540: bitstring,TTL_3541: bitstring) = m2_3538 in
                                        {3175}let Kcli_3542: bitstring = h((Nc_3534,Ns_3539)) in
                                        {3176}out(c, senc(mCli(pkCli_2984,pkSess_3531),Kcli_3542))
                                )
                                else
                                    {3177}let v_3543: bool = (Sess = C) in
                                    (
                                        {3178}if v_3543 then
                                        (
                                            {3179}let pkSess_3544: bitstring = pub(skC) in
                                            {3180}out(c, GetEndpointRequest);
                                            {3181}in(c, (=GetEndpointResponse,=pkSess_3544,=Sign,SP_3545: bitstring,UP_3546: bitstring));
                                            {3182}new Nc_3547: bitstring;
                                            {3183}let m1_3548: bitstring = (OpenSecureChannelRequest,pkCli_2984,Nc_3547) in
                                            {3184}out(c, (pkCli_2984,m1_3548,sign(h(m1_3548),skCli_2983)));
                                            {3185}in(c, (em2_3549: bitstring,sigM2_3550: bitstring));
                                            {3186}let m2_3551: bitstring = em2_3549 in
                                            {3187}if (verify(h(m2_3551),sigM2_3550,pkSess_3544) <> true) then
                                                0
                                            else
                                                {3188}let (=OpenSecureChannelResponse,Ns_3552: bitstring,ST_3553: bitstring,TTL_3554: bitstring) = m2_3551 in
                                                {3189}let Kcli_3555: bitstring = h((Nc_3547,Ns_3552)) in
                                                {3190}out(c, senc(mCli(pkCli_2984,pkSess_3544),Kcli_3555))
                                        )
                                        else
                                            {3191}let pkSess_3556: bitstring = pub(sk(Sess)) in
                                            {3192}out(c, GetEndpointRequest);
                                            {3193}in(c, (=GetEndpointResponse,=pkSess_3556,=Sign,SP_3557: bitstring,UP_3558: bitstring));
                                            {3194}new Nc_3559: bitstring;
                                            {3195}let m1_3560: bitstring = (OpenSecureChannelRequest,pkCli_2984,Nc_3559) in
                                            {3196}out(c, (pkCli_2984,m1_3560,sign(h(m1_3560),skCli_2983)));
                                            {3197}in(c, (em2_3561: bitstring,sigM2_3562: bitstring));
                                            {3198}let m2_3563: bitstring = em2_3561 in
                                            {3199}if (verify(h(m2_3563),sigM2_3562,pkSess_3556) <> true) then
                                                0
                                            else
                                                {3200}let (=OpenSecureChannelResponse,Ns_3564: bitstring,ST_3565: bitstring,TTL_3566: bitstring) = m2_3563 in
                                                {3201}let Kcli_3567: bitstring = h((Nc_3559,Ns_3564)) in
                                                {3202}out(c, senc(mCli(pkCli_2984,pkSess_3556),Kcli_3567))
                                    )
                                    else
                                        {3203}let pkSess_3568: bitstring = fail-any in
                                        {3204}out(c, GetEndpointRequest);
                                        {3205}in(c, (=GetEndpointResponse,=pkSess_3568,=Sign,SP_3569: bitstring,UP_3570: bitstring));
                                        {3206}new Nc_3571: bitstring;
                                        {3207}let m1_3572: bitstring = (OpenSecureChannelRequest,pkCli_2984,Nc_3571) in
                                        {3208}out(c, (pkCli_2984,m1_3572,sign(h(m1_3572),skCli_2983)));
                                        {3209}in(c, (em2_3573: bitstring,sigM2_3574: bitstring));
                                        {3210}let m2_3575: bitstring = em2_3573 in
                                        {3211}if (verify(h(m2_3575),sigM2_3574,pkSess_3568) <> true) then
                                            0
                                        else
                                            {3212}let (=OpenSecureChannelResponse,Ns_3576: bitstring,ST_3577: bitstring,TTL_3578: bitstring) = m2_3575 in
                                            {3213}let Kcli_3579: bitstring = h((Nc_3571,Ns_3576)) in
                                            {3214}out(c, senc(mCli(pkCli_2984,pkSess_3568),Kcli_3579))
                            )
                            else
                                {3215}let pkSess_3580: bitstring = fail-any in
                                {3216}out(c, GetEndpointRequest);
                                {3217}in(c, (=GetEndpointResponse,=pkSess_3580,=Sign,SP_3581: bitstring,UP_3582: bitstring));
                                {3218}new Nc_3583: bitstring;
                                {3219}let m1_3584: bitstring = (OpenSecureChannelRequest,pkCli_2984,Nc_3583) in
                                {3220}out(c, (pkCli_2984,m1_3584,sign(h(m1_3584),skCli_2983)));
                                {3221}in(c, (em2_3585: bitstring,sigM2_3586: bitstring));
                                {3222}let m2_3587: bitstring = em2_3585 in
                                {3223}if (verify(h(m2_3587),sigM2_3586,pkSess_3580) <> true) then
                                    0
                                else
                                    {3224}let (=OpenSecureChannelResponse,Ns_3588: bitstring,ST_3589: bitstring,TTL_3590: bitstring) = m2_3587 in
                                    {3225}let Kcli_3591: bitstring = h((Nc_3583,Ns_3588)) in
                                    {3226}out(c, senc(mCli(pkCli_2984,pkSess_3580),Kcli_3591))
                    )
                    else
                        {3227}let pkSess_3592: bitstring = fail-any in
                        {3228}out(c, GetEndpointRequest);
                        {3229}in(c, (=GetEndpointResponse,=pkSess_3592,=Sign,SP_3593: bitstring,UP_3594: bitstring));
                        {3230}new Nc_3595: bitstring;
                        {3231}let m1_3596: bitstring = (OpenSecureChannelRequest,pkCli_2984,Nc_3595) in
                        {3232}out(c, (pkCli_2984,m1_3596,sign(h(m1_3596),skCli_2983)));
                        {3233}in(c, (em2_3597: bitstring,sigM2_3598: bitstring));
                        {3234}let m2_3599: bitstring = em2_3597 in
                        {3235}if (verify(h(m2_3599),sigM2_3598,pkSess_3592) <> true) then
                            0
                        else
                            {3236}let (=OpenSecureChannelResponse,Ns_3600: bitstring,ST_3601: bitstring,TTL_3602: bitstring) = m2_3599 in
                            {3237}let Kcli_3603: bitstring = h((Nc_3595,Ns_3600)) in
                            {3238}out(c, senc(mCli(pkCli_2984,pkSess_3592),Kcli_3603))
    )
    else
        {3239}let skCli_3604: bitstring = fail-any in
        {3240}let pkCli_3605: bitstring = pub(skCli_3604) in
        {3241}let v_3606: bool = (Disco = A) in
        (
            {3242}if v_3606 then
            (
                {3243}let pkDisco_3607: bitstring = pub(skA) in
                {3244}let v_3608: bool = (Sess = A) in
                (
                    {3245}if v_3608 then
                    (
                        {3246}let pkSess_3609: bitstring = pub(skA) in
                        {3247}out(c, GetEndpointRequest);
                        {3248}in(c, (=GetEndpointResponse,=pkSess_3609,=Sign,SP_3610: bitstring,UP_3611: bitstring));
                        {3249}new Nc_3612: bitstring;
                        {3250}let m1_3613: bitstring = (OpenSecureChannelRequest,pkCli_3605,Nc_3612) in
                        {3251}out(c, (pkCli_3605,m1_3613,sign(h(m1_3613),skCli_3604)));
                        {3252}in(c, (em2_3614: bitstring,sigM2_3615: bitstring));
                        {3253}let m2_3616: bitstring = em2_3614 in
                        {3254}if (verify(h(m2_3616),sigM2_3615,pkSess_3609) <> true) then
                            0
                        else
                            {3255}let (=OpenSecureChannelResponse,Ns_3617: bitstring,ST_3618: bitstring,TTL_3619: bitstring) = m2_3616 in
                            {3256}let Kcli_3620: bitstring = h((Nc_3612,Ns_3617)) in
                            {3257}out(c, senc(mCli(pkCli_3605,pkSess_3609),Kcli_3620))
                    )
                    else
                        {3258}let v_3621: bool = (Sess = B) in
                        (
                            {3259}if v_3621 then
                            (
                                {3260}let pkSess_3622: bitstring = pub(skB) in
                                {3261}out(c, GetEndpointRequest);
                                {3262}in(c, (=GetEndpointResponse,=pkSess_3622,=Sign,SP_3623: bitstring,UP_3624: bitstring));
                                {3263}new Nc_3625: bitstring;
                                {3264}let m1_3626: bitstring = (OpenSecureChannelRequest,pkCli_3605,Nc_3625) in
                                {3265}out(c, (pkCli_3605,m1_3626,sign(h(m1_3626),skCli_3604)));
                                {3266}in(c, (em2_3627: bitstring,sigM2_3628: bitstring));
                                {3267}let m2_3629: bitstring = em2_3627 in
                                {3268}if (verify(h(m2_3629),sigM2_3628,pkSess_3622) <> true) then
                                    0
                                else
                                    {3269}let (=OpenSecureChannelResponse,Ns_3630: bitstring,ST_3631: bitstring,TTL_3632: bitstring) = m2_3629 in
                                    {3270}let Kcli_3633: bitstring = h((Nc_3625,Ns_3630)) in
                                    {3271}out(c, senc(mCli(pkCli_3605,pkSess_3622),Kcli_3633))
                            )
                            else
                                {3272}let v_3634: bool = (Sess = C) in
                                (
                                    {3273}if v_3634 then
                                    (
                                        {3274}let pkSess_3635: bitstring = pub(skC) in
                                        {3275}out(c, GetEndpointRequest);
                                        {3276}in(c, (=GetEndpointResponse,=pkSess_3635,=Sign,SP_3636: bitstring,UP_3637: bitstring));
                                        {3277}new Nc_3638: bitstring;
                                        {3278}let m1_3639: bitstring = (OpenSecureChannelRequest,pkCli_3605,Nc_3638) in
                                        {3279}out(c, (pkCli_3605,m1_3639,sign(h(m1_3639),skCli_3604)));
                                        {3280}in(c, (em2_3640: bitstring,sigM2_3641: bitstring));
                                        {3281}let m2_3642: bitstring = em2_3640 in
                                        {3282}if (verify(h(m2_3642),sigM2_3641,pkSess_3635) <> true) then
                                            0
                                        else
                                            {3283}let (=OpenSecureChannelResponse,Ns_3643: bitstring,ST_3644: bitstring,TTL_3645: bitstring) = m2_3642 in
                                            {3284}let Kcli_3646: bitstring = h((Nc_3638,Ns_3643)) in
                                            {3285}out(c, senc(mCli(pkCli_3605,pkSess_3635),Kcli_3646))
                                    )
                                    else
                                        {3286}let pkSess_3647: bitstring = pub(sk(Sess)) in
                                        {3287}out(c, GetEndpointRequest);
                                        {3288}in(c, (=GetEndpointResponse,=pkSess_3647,=Sign,SP_3648: bitstring,UP_3649: bitstring));
                                        {3289}new Nc_3650: bitstring;
                                        {3290}let m1_3651: bitstring = (OpenSecureChannelRequest,pkCli_3605,Nc_3650) in
                                        {3291}out(c, (pkCli_3605,m1_3651,sign(h(m1_3651),skCli_3604)));
                                        {3292}in(c, (em2_3652: bitstring,sigM2_3653: bitstring));
                                        {3293}let m2_3654: bitstring = em2_3652 in
                                        {3294}if (verify(h(m2_3654),sigM2_3653,pkSess_3647) <> true) then
                                            0
                                        else
                                            {3295}let (=OpenSecureChannelResponse,Ns_3655: bitstring,ST_3656: bitstring,TTL_3657: bitstring) = m2_3654 in
                                            {3296}let Kcli_3658: bitstring = h((Nc_3650,Ns_3655)) in
                                            {3297}out(c, senc(mCli(pkCli_3605,pkSess_3647),Kcli_3658))
                                )
                                else
                                    {3298}let pkSess_3659: bitstring = fail-any in
                                    {3299}out(c, GetEndpointRequest);
                                    {3300}in(c, (=GetEndpointResponse,=pkSess_3659,=Sign,SP_3660: bitstring,UP_3661: bitstring));
                                    {3301}new Nc_3662: bitstring;
                                    {3302}let m1_3663: bitstring = (OpenSecureChannelRequest,pkCli_3605,Nc_3662) in
                                    {3303}out(c, (pkCli_3605,m1_3663,sign(h(m1_3663),skCli_3604)));
                                    {3304}in(c, (em2_3664: bitstring,sigM2_3665: bitstring));
                                    {3305}let m2_3666: bitstring = em2_3664 in
                                    {3306}if (verify(h(m2_3666),sigM2_3665,pkSess_3659) <> true) then
                                        0
                                    else
                                        {3307}let (=OpenSecureChannelResponse,Ns_3667: bitstring,ST_3668: bitstring,TTL_3669: bitstring) = m2_3666 in
                                        {3308}let Kcli_3670: bitstring = h((Nc_3662,Ns_3667)) in
                                        {3309}out(c, senc(mCli(pkCli_3605,pkSess_3659),Kcli_3670))
                        )
                        else
                            {3310}let pkSess_3671: bitstring = fail-any in
                            {3311}out(c, GetEndpointRequest);
                            {3312}in(c, (=GetEndpointResponse,=pkSess_3671,=Sign,SP_3672: bitstring,UP_3673: bitstring));
                            {3313}new Nc_3674: bitstring;
                            {3314}let m1_3675: bitstring = (OpenSecureChannelRequest,pkCli_3605,Nc_3674) in
                            {3315}out(c, (pkCli_3605,m1_3675,sign(h(m1_3675),skCli_3604)));
                            {3316}in(c, (em2_3676: bitstring,sigM2_3677: bitstring));
                            {3317}let m2_3678: bitstring = em2_3676 in
                            {3318}if (verify(h(m2_3678),sigM2_3677,pkSess_3671) <> true) then
                                0
                            else
                                {3319}let (=OpenSecureChannelResponse,Ns_3679: bitstring,ST_3680: bitstring,TTL_3681: bitstring) = m2_3678 in
                                {3320}let Kcli_3682: bitstring = h((Nc_3674,Ns_3679)) in
                                {3321}out(c, senc(mCli(pkCli_3605,pkSess_3671),Kcli_3682))
                )
                else
                    {3322}let pkSess_3683: bitstring = fail-any in
                    {3323}out(c, GetEndpointRequest);
                    {3324}in(c, (=GetEndpointResponse,=pkSess_3683,=Sign,SP_3684: bitstring,UP_3685: bitstring));
                    {3325}new Nc_3686: bitstring;
                    {3326}let m1_3687: bitstring = (OpenSecureChannelRequest,pkCli_3605,Nc_3686) in
                    {3327}out(c, (pkCli_3605,m1_3687,sign(h(m1_3687),skCli_3604)));
                    {3328}in(c, (em2_3688: bitstring,sigM2_3689: bitstring));
                    {3329}let m2_3690: bitstring = em2_3688 in
                    {3330}if (verify(h(m2_3690),sigM2_3689,pkSess_3683) <> true) then
                        0
                    else
                        {3331}let (=OpenSecureChannelResponse,Ns_3691: bitstring,ST_3692: bitstring,TTL_3693: bitstring) = m2_3690 in
                        {3332}let Kcli_3694: bitstring = h((Nc_3686,Ns_3691)) in
                        {3333}out(c, senc(mCli(pkCli_3605,pkSess_3683),Kcli_3694))
            )
            else
                {3334}let v_3695: bool = (Disco = B) in
                (
                    {3335}if v_3695 then
                    (
                        {3336}let pkDisco_3696: bitstring = pub(skB) in
                        {3337}let v_3697: bool = (Sess = A) in
                        (
                            {3338}if v_3697 then
                            (
                                {3339}let pkSess_3698: bitstring = pub(skA) in
                                {3340}out(c, GetEndpointRequest);
                                {3341}in(c, (=GetEndpointResponse,=pkSess_3698,=Sign,SP_3699: bitstring,UP_3700: bitstring));
                                {3342}new Nc_3701: bitstring;
                                {3343}let m1_3702: bitstring = (OpenSecureChannelRequest,pkCli_3605,Nc_3701) in
                                {3344}out(c, (pkCli_3605,m1_3702,sign(h(m1_3702),skCli_3604)));
                                {3345}in(c, (em2_3703: bitstring,sigM2_3704: bitstring));
                                {3346}let m2_3705: bitstring = em2_3703 in
                                {3347}if (verify(h(m2_3705),sigM2_3704,pkSess_3698) <> true) then
                                    0
                                else
                                    {3348}let (=OpenSecureChannelResponse,Ns_3706: bitstring,ST_3707: bitstring,TTL_3708: bitstring) = m2_3705 in
                                    {3349}let Kcli_3709: bitstring = h((Nc_3701,Ns_3706)) in
                                    {3350}out(c, senc(mCli(pkCli_3605,pkSess_3698),Kcli_3709))
                            )
                            else
                                {3351}let v_3710: bool = (Sess = B) in
                                (
                                    {3352}if v_3710 then
                                    (
                                        {3353}let pkSess_3711: bitstring = pub(skB) in
                                        {3354}out(c, GetEndpointRequest);
                                        {3355}in(c, (=GetEndpointResponse,=pkSess_3711,=Sign,SP_3712: bitstring,UP_3713: bitstring));
                                        {3356}new Nc_3714: bitstring;
                                        {3357}let m1_3715: bitstring = (OpenSecureChannelRequest,pkCli_3605,Nc_3714) in
                                        {3358}out(c, (pkCli_3605,m1_3715,sign(h(m1_3715),skCli_3604)));
                                        {3359}in(c, (em2_3716: bitstring,sigM2_3717: bitstring));
                                        {3360}let m2_3718: bitstring = em2_3716 in
                                        {3361}if (verify(h(m2_3718),sigM2_3717,pkSess_3711) <> true) then
                                            0
                                        else
                                            {3362}let (=OpenSecureChannelResponse,Ns_3719: bitstring,ST_3720: bitstring,TTL_3721: bitstring) = m2_3718 in
                                            {3363}let Kcli_3722: bitstring = h((Nc_3714,Ns_3719)) in
                                            {3364}out(c, senc(mCli(pkCli_3605,pkSess_3711),Kcli_3722))
                                    )
                                    else
                                        {3365}let v_3723: bool = (Sess = C) in
                                        (
                                            {3366}if v_3723 then
                                            (
                                                {3367}let pkSess_3724: bitstring = pub(skC) in
                                                {3368}out(c, GetEndpointRequest);
                                                {3369}in(c, (=GetEndpointResponse,=pkSess_3724,=Sign,SP_3725: bitstring,UP_3726: bitstring));
                                                {3370}new Nc_3727: bitstring;
                                                {3371}let m1_3728: bitstring = (OpenSecureChannelRequest,pkCli_3605,Nc_3727) in
                                                {3372}out(c, (pkCli_3605,m1_3728,sign(h(m1_3728),skCli_3604)));
                                                {3373}in(c, (em2_3729: bitstring,sigM2_3730: bitstring));
                                                {3374}let m2_3731: bitstring = em2_3729 in
                                                {3375}if (verify(h(m2_3731),sigM2_3730,pkSess_3724) <> true) then
                                                    0
                                                else
                                                    {3376}let (=OpenSecureChannelResponse,Ns_3732: bitstring,ST_3733: bitstring,TTL_3734: bitstring) = m2_3731 in
                                                    {3377}let Kcli_3735: bitstring = h((Nc_3727,Ns_3732)) in
                                                    {3378}out(c, senc(mCli(pkCli_3605,pkSess_3724),Kcli_3735))
                                            )
                                            else
                                                {3379}let pkSess_3736: bitstring = pub(sk(Sess)) in
                                                {3380}out(c, GetEndpointRequest);
                                                {3381}in(c, (=GetEndpointResponse,=pkSess_3736,=Sign,SP_3737: bitstring,UP_3738: bitstring));
                                                {3382}new Nc_3739: bitstring;
                                                {3383}let m1_3740: bitstring = (OpenSecureChannelRequest,pkCli_3605,Nc_3739) in
                                                {3384}out(c, (pkCli_3605,m1_3740,sign(h(m1_3740),skCli_3604)));
                                                {3385}in(c, (em2_3741: bitstring,sigM2_3742: bitstring));
                                                {3386}let m2_3743: bitstring = em2_3741 in
                                                {3387}if (verify(h(m2_3743),sigM2_3742,pkSess_3736) <> true) then
                                                    0
                                                else
                                                    {3388}let (=OpenSecureChannelResponse,Ns_3744: bitstring,ST_3745: bitstring,TTL_3746: bitstring) = m2_3743 in
                                                    {3389}let Kcli_3747: bitstring = h((Nc_3739,Ns_3744)) in
                                                    {3390}out(c, senc(mCli(pkCli_3605,pkSess_3736),Kcli_3747))
                                        )
                                        else
                                            {3391}let pkSess_3748: bitstring = fail-any in
                                            {3392}out(c, GetEndpointRequest);
                                            {3393}in(c, (=GetEndpointResponse,=pkSess_3748,=Sign,SP_3749: bitstring,UP_3750: bitstring));
                                            {3394}new Nc_3751: bitstring;
                                            {3395}let m1_3752: bitstring = (OpenSecureChannelRequest,pkCli_3605,Nc_3751) in
                                            {3396}out(c, (pkCli_3605,m1_3752,sign(h(m1_3752),skCli_3604)));
                                            {3397}in(c, (em2_3753: bitstring,sigM2_3754: bitstring));
                                            {3398}let m2_3755: bitstring = em2_3753 in
                                            {3399}if (verify(h(m2_3755),sigM2_3754,pkSess_3748) <> true) then
                                                0
                                            else
                                                {3400}let (=OpenSecureChannelResponse,Ns_3756: bitstring,ST_3757: bitstring,TTL_3758: bitstring) = m2_3755 in
                                                {3401}let Kcli_3759: bitstring = h((Nc_3751,Ns_3756)) in
                                                {3402}out(c, senc(mCli(pkCli_3605,pkSess_3748),Kcli_3759))
                                )
                                else
                                    {3403}let pkSess_3760: bitstring = fail-any in
                                    {3404}out(c, GetEndpointRequest);
                                    {3405}in(c, (=GetEndpointResponse,=pkSess_3760,=Sign,SP_3761: bitstring,UP_3762: bitstring));
                                    {3406}new Nc_3763: bitstring;
                                    {3407}let m1_3764: bitstring = (OpenSecureChannelRequest,pkCli_3605,Nc_3763) in
                                    {3408}out(c, (pkCli_3605,m1_3764,sign(h(m1_3764),skCli_3604)));
                                    {3409}in(c, (em2_3765: bitstring,sigM2_3766: bitstring));
                                    {3410}let m2_3767: bitstring = em2_3765 in
                                    {3411}if (verify(h(m2_3767),sigM2_3766,pkSess_3760) <> true) then
                                        0
                                    else
                                        {3412}let (=OpenSecureChannelResponse,Ns_3768: bitstring,ST_3769: bitstring,TTL_3770: bitstring) = m2_3767 in
                                        {3413}let Kcli_3771: bitstring = h((Nc_3763,Ns_3768)) in
                                        {3414}out(c, senc(mCli(pkCli_3605,pkSess_3760),Kcli_3771))
                        )
                        else
                            {3415}let pkSess_3772: bitstring = fail-any in
                            {3416}out(c, GetEndpointRequest);
                            {3417}in(c, (=GetEndpointResponse,=pkSess_3772,=Sign,SP_3773: bitstring,UP_3774: bitstring));
                            {3418}new Nc_3775: bitstring;
                            {3419}let m1_3776: bitstring = (OpenSecureChannelRequest,pkCli_3605,Nc_3775) in
                            {3420}out(c, (pkCli_3605,m1_3776,sign(h(m1_3776),skCli_3604)));
                            {3421}in(c, (em2_3777: bitstring,sigM2_3778: bitstring));
                            {3422}let m2_3779: bitstring = em2_3777 in
                            {3423}if (verify(h(m2_3779),sigM2_3778,pkSess_3772) <> true) then
                                0
                            else
                                {3424}let (=OpenSecureChannelResponse,Ns_3780: bitstring,ST_3781: bitstring,TTL_3782: bitstring) = m2_3779 in
                                {3425}let Kcli_3783: bitstring = h((Nc_3775,Ns_3780)) in
                                {3426}out(c, senc(mCli(pkCli_3605,pkSess_3772),Kcli_3783))
                    )
                    else
                        {3427}let v_3784: bool = (Disco = C) in
                        (
                            {3428}if v_3784 then
                            (
                                {3429}let pkDisco_3785: bitstring = pub(skC) in
                                {3430}let v_3786: bool = (Sess = A) in
                                (
                                    {3431}if v_3786 then
                                    (
                                        {3432}let pkSess_3787: bitstring = pub(skA) in
                                        {3433}out(c, GetEndpointRequest);
                                        {3434}in(c, (=GetEndpointResponse,=pkSess_3787,=Sign,SP_3788: bitstring,UP_3789: bitstring));
                                        {3435}new Nc_3790: bitstring;
                                        {3436}let m1_3791: bitstring = (OpenSecureChannelRequest,pkCli_3605,Nc_3790) in
                                        {3437}out(c, (pkCli_3605,m1_3791,sign(h(m1_3791),skCli_3604)));
                                        {3438}in(c, (em2_3792: bitstring,sigM2_3793: bitstring));
                                        {3439}let m2_3794: bitstring = em2_3792 in
                                        {3440}if (verify(h(m2_3794),sigM2_3793,pkSess_3787) <> true) then
                                            0
                                        else
                                            {3441}let (=OpenSecureChannelResponse,Ns_3795: bitstring,ST_3796: bitstring,TTL_3797: bitstring) = m2_3794 in
                                            {3442}let Kcli_3798: bitstring = h((Nc_3790,Ns_3795)) in
                                            {3443}out(c, senc(mCli(pkCli_3605,pkSess_3787),Kcli_3798))
                                    )
                                    else
                                        {3444}let v_3799: bool = (Sess = B) in
                                        (
                                            {3445}if v_3799 then
                                            (
                                                {3446}let pkSess_3800: bitstring = pub(skB) in
                                                {3447}out(c, GetEndpointRequest);
                                                {3448}in(c, (=GetEndpointResponse,=pkSess_3800,=Sign,SP_3801: bitstring,UP_3802: bitstring));
                                                {3449}new Nc_3803: bitstring;
                                                {3450}let m1_3804: bitstring = (OpenSecureChannelRequest,pkCli_3605,Nc_3803) in
                                                {3451}out(c, (pkCli_3605,m1_3804,sign(h(m1_3804),skCli_3604)));
                                                {3452}in(c, (em2_3805: bitstring,sigM2_3806: bitstring));
                                                {3453}let m2_3807: bitstring = em2_3805 in
                                                {3454}if (verify(h(m2_3807),sigM2_3806,pkSess_3800) <> true) then
                                                    0
                                                else
                                                    {3455}let (=OpenSecureChannelResponse,Ns_3808: bitstring,ST_3809: bitstring,TTL_3810: bitstring) = m2_3807 in
                                                    {3456}let Kcli_3811: bitstring = h((Nc_3803,Ns_3808)) in
                                                    {3457}out(c, senc(mCli(pkCli_3605,pkSess_3800),Kcli_3811))
                                            )
                                            else
                                                {3458}let v_3812: bool = (Sess = C) in
                                                (
                                                    {3459}if v_3812 then
                                                    (
                                                        {3460}let pkSess_3813: bitstring = pub(skC) in
                                                        {3461}out(c, GetEndpointRequest);
                                                        {3462}in(c, (=GetEndpointResponse,=pkSess_3813,=Sign,SP_3814: bitstring,UP_3815: bitstring));
                                                        {3463}new Nc_3816: bitstring;
                                                        {3464}let m1_3817: bitstring = (OpenSecureChannelRequest,pkCli_3605,Nc_3816) in
                                                        {3465}out(c, (pkCli_3605,m1_3817,sign(h(m1_3817),skCli_3604)));
                                                        {3466}in(c, (em2_3818: bitstring,sigM2_3819: bitstring));
                                                        {3467}let m2_3820: bitstring = em2_3818 in
                                                        {3468}if (verify(h(m2_3820),sigM2_3819,pkSess_3813) <> true) then
                                                            0
                                                        else
                                                            {3469}let (=OpenSecureChannelResponse,Ns_3821: bitstring,ST_3822: bitstring,TTL_3823: bitstring) = m2_3820 in
                                                            {3470}let Kcli_3824: bitstring = h((Nc_3816,Ns_3821)) in
                                                            {3471}out(c, senc(mCli(pkCli_3605,pkSess_3813),Kcli_3824))
                                                    )
                                                    else
                                                        {3472}let pkSess_3825: bitstring = pub(sk(Sess)) in
                                                        {3473}out(c, GetEndpointRequest);
                                                        {3474}in(c, (=GetEndpointResponse,=pkSess_3825,=Sign,SP_3826: bitstring,UP_3827: bitstring));
                                                        {3475}new Nc_3828: bitstring;
                                                        {3476}let m1_3829: bitstring = (OpenSecureChannelRequest,pkCli_3605,Nc_3828) in
                                                        {3477}out(c, (pkCli_3605,m1_3829,sign(h(m1_3829),skCli_3604)));
                                                        {3478}in(c, (em2_3830: bitstring,sigM2_3831: bitstring));
                                                        {3479}let m2_3832: bitstring = em2_3830 in
                                                        {3480}if (verify(h(m2_3832),sigM2_3831,pkSess_3825) <> true) then
                                                            0
                                                        else
                                                            {3481}let (=OpenSecureChannelResponse,Ns_3833: bitstring,ST_3834: bitstring,TTL_3835: bitstring) = m2_3832 in
                                                            {3482}let Kcli_3836: bitstring = h((Nc_3828,Ns_3833)) in
                                                            {3483}out(c, senc(mCli(pkCli_3605,pkSess_3825),Kcli_3836))
                                                )
                                                else
                                                    {3484}let pkSess_3837: bitstring = fail-any in
                                                    {3485}out(c, GetEndpointRequest);
                                                    {3486}in(c, (=GetEndpointResponse,=pkSess_3837,=Sign,SP_3838: bitstring,UP_3839: bitstring));
                                                    {3487}new Nc_3840: bitstring;
                                                    {3488}let m1_3841: bitstring = (OpenSecureChannelRequest,pkCli_3605,Nc_3840) in
                                                    {3489}out(c, (pkCli_3605,m1_3841,sign(h(m1_3841),skCli_3604)));
                                                    {3490}in(c, (em2_3842: bitstring,sigM2_3843: bitstring));
                                                    {3491}let m2_3844: bitstring = em2_3842 in
                                                    {3492}if (verify(h(m2_3844),sigM2_3843,pkSess_3837) <> true) then
                                                        0
                                                    else
                                                        {3493}let (=OpenSecureChannelResponse,Ns_3845: bitstring,ST_3846: bitstring,TTL_3847: bitstring) = m2_3844 in
                                                        {3494}let Kcli_3848: bitstring = h((Nc_3840,Ns_3845)) in
                                                        {3495}out(c, senc(mCli(pkCli_3605,pkSess_3837),Kcli_3848))
                                        )
                                        else
                                            {3496}let pkSess_3849: bitstring = fail-any in
                                            {3497}out(c, GetEndpointRequest);
                                            {3498}in(c, (=GetEndpointResponse,=pkSess_3849,=Sign,SP_3850: bitstring,UP_3851: bitstring));
                                            {3499}new Nc_3852: bitstring;
                                            {3500}let m1_3853: bitstring = (OpenSecureChannelRequest,pkCli_3605,Nc_3852) in
                                            {3501}out(c, (pkCli_3605,m1_3853,sign(h(m1_3853),skCli_3604)));
                                            {3502}in(c, (em2_3854: bitstring,sigM2_3855: bitstring));
                                            {3503}let m2_3856: bitstring = em2_3854 in
                                            {3504}if (verify(h(m2_3856),sigM2_3855,pkSess_3849) <> true) then
                                                0
                                            else
                                                {3505}let (=OpenSecureChannelResponse,Ns_3857: bitstring,ST_3858: bitstring,TTL_3859: bitstring) = m2_3856 in
                                                {3506}let Kcli_3860: bitstring = h((Nc_3852,Ns_3857)) in
                                                {3507}out(c, senc(mCli(pkCli_3605,pkSess_3849),Kcli_3860))
                                )
                                else
                                    {3508}let pkSess_3861: bitstring = fail-any in
                                    {3509}out(c, GetEndpointRequest);
                                    {3510}in(c, (=GetEndpointResponse,=pkSess_3861,=Sign,SP_3862: bitstring,UP_3863: bitstring));
                                    {3511}new Nc_3864: bitstring;
                                    {3512}let m1_3865: bitstring = (OpenSecureChannelRequest,pkCli_3605,Nc_3864) in
                                    {3513}out(c, (pkCli_3605,m1_3865,sign(h(m1_3865),skCli_3604)));
                                    {3514}in(c, (em2_3866: bitstring,sigM2_3867: bitstring));
                                    {3515}let m2_3868: bitstring = em2_3866 in
                                    {3516}if (verify(h(m2_3868),sigM2_3867,pkSess_3861) <> true) then
                                        0
                                    else
                                        {3517}let (=OpenSecureChannelResponse,Ns_3869: bitstring,ST_3870: bitstring,TTL_3871: bitstring) = m2_3868 in
                                        {3518}let Kcli_3872: bitstring = h((Nc_3864,Ns_3869)) in
                                        {3519}out(c, senc(mCli(pkCli_3605,pkSess_3861),Kcli_3872))
                            )
                            else
                                {3520}let pkDisco_3873: bitstring = pub(sk(Disco)) in
                                {3521}let v_3874: bool = (Sess = A) in
                                (
                                    {3522}if v_3874 then
                                    (
                                        {3523}let pkSess_3875: bitstring = pub(skA) in
                                        {3524}out(c, GetEndpointRequest);
                                        {3525}in(c, (=GetEndpointResponse,=pkSess_3875,=Sign,SP_3876: bitstring,UP_3877: bitstring));
                                        {3526}new Nc_3878: bitstring;
                                        {3527}let m1_3879: bitstring = (OpenSecureChannelRequest,pkCli_3605,Nc_3878) in
                                        {3528}out(c, (pkCli_3605,m1_3879,sign(h(m1_3879),skCli_3604)));
                                        {3529}in(c, (em2_3880: bitstring,sigM2_3881: bitstring));
                                        {3530}let m2_3882: bitstring = em2_3880 in
                                        {3531}if (verify(h(m2_3882),sigM2_3881,pkSess_3875) <> true) then
                                            0
                                        else
                                            {3532}let (=OpenSecureChannelResponse,Ns_3883: bitstring,ST_3884: bitstring,TTL_3885: bitstring) = m2_3882 in
                                            {3533}let Kcli_3886: bitstring = h((Nc_3878,Ns_3883)) in
                                            {3534}out(c, senc(mCli(pkCli_3605,pkSess_3875),Kcli_3886))
                                    )
                                    else
                                        {3535}let v_3887: bool = (Sess = B) in
                                        (
                                            {3536}if v_3887 then
                                            (
                                                {3537}let pkSess_3888: bitstring = pub(skB) in
                                                {3538}out(c, GetEndpointRequest);
                                                {3539}in(c, (=GetEndpointResponse,=pkSess_3888,=Sign,SP_3889: bitstring,UP_3890: bitstring));
                                                {3540}new Nc_3891: bitstring;
                                                {3541}let m1_3892: bitstring = (OpenSecureChannelRequest,pkCli_3605,Nc_3891) in
                                                {3542}out(c, (pkCli_3605,m1_3892,sign(h(m1_3892),skCli_3604)));
                                                {3543}in(c, (em2_3893: bitstring,sigM2_3894: bitstring));
                                                {3544}let m2_3895: bitstring = em2_3893 in
                                                {3545}if (verify(h(m2_3895),sigM2_3894,pkSess_3888) <> true) then
                                                    0
                                                else
                                                    {3546}let (=OpenSecureChannelResponse,Ns_3896: bitstring,ST_3897: bitstring,TTL_3898: bitstring) = m2_3895 in
                                                    {3547}let Kcli_3899: bitstring = h((Nc_3891,Ns_3896)) in
                                                    {3548}out(c, senc(mCli(pkCli_3605,pkSess_3888),Kcli_3899))
                                            )
                                            else
                                                {3549}let v_3900: bool = (Sess = C) in
                                                (
                                                    {3550}if v_3900 then
                                                    (
                                                        {3551}let pkSess_3901: bitstring = pub(skC) in
                                                        {3552}out(c, GetEndpointRequest);
                                                        {3553}in(c, (=GetEndpointResponse,=pkSess_3901,=Sign,SP_3902: bitstring,UP_3903: bitstring));
                                                        {3554}new Nc_3904: bitstring;
                                                        {3555}let m1_3905: bitstring = (OpenSecureChannelRequest,pkCli_3605,Nc_3904) in
                                                        {3556}out(c, (pkCli_3605,m1_3905,sign(h(m1_3905),skCli_3604)));
                                                        {3557}in(c, (em2_3906: bitstring,sigM2_3907: bitstring));
                                                        {3558}let m2_3908: bitstring = em2_3906 in
                                                        {3559}if (verify(h(m2_3908),sigM2_3907,pkSess_3901) <> true) then
                                                            0
                                                        else
                                                            {3560}let (=OpenSecureChannelResponse,Ns_3909: bitstring,ST_3910: bitstring,TTL_3911: bitstring) = m2_3908 in
                                                            {3561}let Kcli_3912: bitstring = h((Nc_3904,Ns_3909)) in
                                                            {3562}out(c, senc(mCli(pkCli_3605,pkSess_3901),Kcli_3912))
                                                    )
                                                    else
                                                        {3563}let pkSess_3913: bitstring = pub(sk(Sess)) in
                                                        {3564}out(c, GetEndpointRequest);
                                                        {3565}in(c, (=GetEndpointResponse,=pkSess_3913,=Sign,SP_3914: bitstring,UP_3915: bitstring));
                                                        {3566}new Nc_3916: bitstring;
                                                        {3567}let m1_3917: bitstring = (OpenSecureChannelRequest,pkCli_3605,Nc_3916) in
                                                        {3568}out(c, (pkCli_3605,m1_3917,sign(h(m1_3917),skCli_3604)));
                                                        {3569}in(c, (em2_3918: bitstring,sigM2_3919: bitstring));
                                                        {3570}let m2_3920: bitstring = em2_3918 in
                                                        {3571}if (verify(h(m2_3920),sigM2_3919,pkSess_3913) <> true) then
                                                            0
                                                        else
                                                            {3572}let (=OpenSecureChannelResponse,Ns_3921: bitstring,ST_3922: bitstring,TTL_3923: bitstring) = m2_3920 in
                                                            {3573}let Kcli_3924: bitstring = h((Nc_3916,Ns_3921)) in
                                                            {3574}out(c, senc(mCli(pkCli_3605,pkSess_3913),Kcli_3924))
                                                )
                                                else
                                                    {3575}let pkSess_3925: bitstring = fail-any in
                                                    {3576}out(c, GetEndpointRequest);
                                                    {3577}in(c, (=GetEndpointResponse,=pkSess_3925,=Sign,SP_3926: bitstring,UP_3927: bitstring));
                                                    {3578}new Nc_3928: bitstring;
                                                    {3579}let m1_3929: bitstring = (OpenSecureChannelRequest,pkCli_3605,Nc_3928) in
                                                    {3580}out(c, (pkCli_3605,m1_3929,sign(h(m1_3929),skCli_3604)));
                                                    {3581}in(c, (em2_3930: bitstring,sigM2_3931: bitstring));
                                                    {3582}let m2_3932: bitstring = em2_3930 in
                                                    {3583}if (verify(h(m2_3932),sigM2_3931,pkSess_3925) <> true) then
                                                        0
                                                    else
                                                        {3584}let (=OpenSecureChannelResponse,Ns_3933: bitstring,ST_3934: bitstring,TTL_3935: bitstring) = m2_3932 in
                                                        {3585}let Kcli_3936: bitstring = h((Nc_3928,Ns_3933)) in
                                                        {3586}out(c, senc(mCli(pkCli_3605,pkSess_3925),Kcli_3936))
                                        )
                                        else
                                            {3587}let pkSess_3937: bitstring = fail-any in
                                            {3588}out(c, GetEndpointRequest);
                                            {3589}in(c, (=GetEndpointResponse,=pkSess_3937,=Sign,SP_3938: bitstring,UP_3939: bitstring));
                                            {3590}new Nc_3940: bitstring;
                                            {3591}let m1_3941: bitstring = (OpenSecureChannelRequest,pkCli_3605,Nc_3940) in
                                            {3592}out(c, (pkCli_3605,m1_3941,sign(h(m1_3941),skCli_3604)));
                                            {3593}in(c, (em2_3942: bitstring,sigM2_3943: bitstring));
                                            {3594}let m2_3944: bitstring = em2_3942 in
                                            {3595}if (verify(h(m2_3944),sigM2_3943,pkSess_3937) <> true) then
                                                0
                                            else
                                                {3596}let (=OpenSecureChannelResponse,Ns_3945: bitstring,ST_3946: bitstring,TTL_3947: bitstring) = m2_3944 in
                                                {3597}let Kcli_3948: bitstring = h((Nc_3940,Ns_3945)) in
                                                {3598}out(c, senc(mCli(pkCli_3605,pkSess_3937),Kcli_3948))
                                )
                                else
                                    {3599}let pkSess_3949: bitstring = fail-any in
                                    {3600}out(c, GetEndpointRequest);
                                    {3601}in(c, (=GetEndpointResponse,=pkSess_3949,=Sign,SP_3950: bitstring,UP_3951: bitstring));
                                    {3602}new Nc_3952: bitstring;
                                    {3603}let m1_3953: bitstring = (OpenSecureChannelRequest,pkCli_3605,Nc_3952) in
                                    {3604}out(c, (pkCli_3605,m1_3953,sign(h(m1_3953),skCli_3604)));
                                    {3605}in(c, (em2_3954: bitstring,sigM2_3955: bitstring));
                                    {3606}let m2_3956: bitstring = em2_3954 in
                                    {3607}if (verify(h(m2_3956),sigM2_3955,pkSess_3949) <> true) then
                                        0
                                    else
                                        {3608}let (=OpenSecureChannelResponse,Ns_3957: bitstring,ST_3958: bitstring,TTL_3959: bitstring) = m2_3956 in
                                        {3609}let Kcli_3960: bitstring = h((Nc_3952,Ns_3957)) in
                                        {3610}out(c, senc(mCli(pkCli_3605,pkSess_3949),Kcli_3960))
                        )
                        else
                            {3611}let pkDisco_3961: bitstring = fail-any in
                            {3612}let v_3962: bool = (Sess = A) in
                            (
                                {3613}if v_3962 then
                                (
                                    {3614}let pkSess_3963: bitstring = pub(skA) in
                                    {3615}out(c, GetEndpointRequest);
                                    {3616}in(c, (=GetEndpointResponse,=pkSess_3963,=Sign,SP_3964: bitstring,UP_3965: bitstring));
                                    {3617}new Nc_3966: bitstring;
                                    {3618}let m1_3967: bitstring = (OpenSecureChannelRequest,pkCli_3605,Nc_3966) in
                                    {3619}out(c, (pkCli_3605,m1_3967,sign(h(m1_3967),skCli_3604)));
                                    {3620}in(c, (em2_3968: bitstring,sigM2_3969: bitstring));
                                    {3621}let m2_3970: bitstring = em2_3968 in
                                    {3622}if (verify(h(m2_3970),sigM2_3969,pkSess_3963) <> true) then
                                        0
                                    else
                                        {3623}let (=OpenSecureChannelResponse,Ns_3971: bitstring,ST_3972: bitstring,TTL_3973: bitstring) = m2_3970 in
                                        {3624}let Kcli_3974: bitstring = h((Nc_3966,Ns_3971)) in
                                        {3625}out(c, senc(mCli(pkCli_3605,pkSess_3963),Kcli_3974))
                                )
                                else
                                    {3626}let v_3975: bool = (Sess = B) in
                                    (
                                        {3627}if v_3975 then
                                        (
                                            {3628}let pkSess_3976: bitstring = pub(skB) in
                                            {3629}out(c, GetEndpointRequest);
                                            {3630}in(c, (=GetEndpointResponse,=pkSess_3976,=Sign,SP_3977: bitstring,UP_3978: bitstring));
                                            {3631}new Nc_3979: bitstring;
                                            {3632}let m1_3980: bitstring = (OpenSecureChannelRequest,pkCli_3605,Nc_3979) in
                                            {3633}out(c, (pkCli_3605,m1_3980,sign(h(m1_3980),skCli_3604)));
                                            {3634}in(c, (em2_3981: bitstring,sigM2_3982: bitstring));
                                            {3635}let m2_3983: bitstring = em2_3981 in
                                            {3636}if (verify(h(m2_3983),sigM2_3982,pkSess_3976) <> true) then
                                                0
                                            else
                                                {3637}let (=OpenSecureChannelResponse,Ns_3984: bitstring,ST_3985: bitstring,TTL_3986: bitstring) = m2_3983 in
                                                {3638}let Kcli_3987: bitstring = h((Nc_3979,Ns_3984)) in
                                                {3639}out(c, senc(mCli(pkCli_3605,pkSess_3976),Kcli_3987))
                                        )
                                        else
                                            {3640}let v_3988: bool = (Sess = C) in
                                            (
                                                {3641}if v_3988 then
                                                (
                                                    {3642}let pkSess_3989: bitstring = pub(skC) in
                                                    {3643}out(c, GetEndpointRequest);
                                                    {3644}in(c, (=GetEndpointResponse,=pkSess_3989,=Sign,SP_3990: bitstring,UP_3991: bitstring));
                                                    {3645}new Nc_3992: bitstring;
                                                    {3646}let m1_3993: bitstring = (OpenSecureChannelRequest,pkCli_3605,Nc_3992) in
                                                    {3647}out(c, (pkCli_3605,m1_3993,sign(h(m1_3993),skCli_3604)));
                                                    {3648}in(c, (em2_3994: bitstring,sigM2_3995: bitstring));
                                                    {3649}let m2_3996: bitstring = em2_3994 in
                                                    {3650}if (verify(h(m2_3996),sigM2_3995,pkSess_3989) <> true) then
                                                        0
                                                    else
                                                        {3651}let (=OpenSecureChannelResponse,Ns_3997: bitstring,ST_3998: bitstring,TTL_3999: bitstring) = m2_3996 in
                                                        {3652}let Kcli_4000: bitstring = h((Nc_3992,Ns_3997)) in
                                                        {3653}out(c, senc(mCli(pkCli_3605,pkSess_3989),Kcli_4000))
                                                )
                                                else
                                                    {3654}let pkSess_4001: bitstring = pub(sk(Sess)) in
                                                    {3655}out(c, GetEndpointRequest);
                                                    {3656}in(c, (=GetEndpointResponse,=pkSess_4001,=Sign,SP_4002: bitstring,UP_4003: bitstring));
                                                    {3657}new Nc_4004: bitstring;
                                                    {3658}let m1_4005: bitstring = (OpenSecureChannelRequest,pkCli_3605,Nc_4004) in
                                                    {3659}out(c, (pkCli_3605,m1_4005,sign(h(m1_4005),skCli_3604)));
                                                    {3660}in(c, (em2_4006: bitstring,sigM2_4007: bitstring));
                                                    {3661}let m2_4008: bitstring = em2_4006 in
                                                    {3662}if (verify(h(m2_4008),sigM2_4007,pkSess_4001) <> true) then
                                                        0
                                                    else
                                                        {3663}let (=OpenSecureChannelResponse,Ns_4009: bitstring,ST_4010: bitstring,TTL_4011: bitstring) = m2_4008 in
                                                        {3664}let Kcli_4012: bitstring = h((Nc_4004,Ns_4009)) in
                                                        {3665}out(c, senc(mCli(pkCli_3605,pkSess_4001),Kcli_4012))
                                            )
                                            else
                                                {3666}let pkSess_4013: bitstring = fail-any in
                                                {3667}out(c, GetEndpointRequest);
                                                {3668}in(c, (=GetEndpointResponse,=pkSess_4013,=Sign,SP_4014: bitstring,UP_4015: bitstring));
                                                {3669}new Nc_4016: bitstring;
                                                {3670}let m1_4017: bitstring = (OpenSecureChannelRequest,pkCli_3605,Nc_4016) in
                                                {3671}out(c, (pkCli_3605,m1_4017,sign(h(m1_4017),skCli_3604)));
                                                {3672}in(c, (em2_4018: bitstring,sigM2_4019: bitstring));
                                                {3673}let m2_4020: bitstring = em2_4018 in
                                                {3674}if (verify(h(m2_4020),sigM2_4019,pkSess_4013) <> true) then
                                                    0
                                                else
                                                    {3675}let (=OpenSecureChannelResponse,Ns_4021: bitstring,ST_4022: bitstring,TTL_4023: bitstring) = m2_4020 in
                                                    {3676}let Kcli_4024: bitstring = h((Nc_4016,Ns_4021)) in
                                                    {3677}out(c, senc(mCli(pkCli_3605,pkSess_4013),Kcli_4024))
                                    )
                                    else
                                        {3678}let pkSess_4025: bitstring = fail-any in
                                        {3679}out(c, GetEndpointRequest);
                                        {3680}in(c, (=GetEndpointResponse,=pkSess_4025,=Sign,SP_4026: bitstring,UP_4027: bitstring));
                                        {3681}new Nc_4028: bitstring;
                                        {3682}let m1_4029: bitstring = (OpenSecureChannelRequest,pkCli_3605,Nc_4028) in
                                        {3683}out(c, (pkCli_3605,m1_4029,sign(h(m1_4029),skCli_3604)));
                                        {3684}in(c, (em2_4030: bitstring,sigM2_4031: bitstring));
                                        {3685}let m2_4032: bitstring = em2_4030 in
                                        {3686}if (verify(h(m2_4032),sigM2_4031,pkSess_4025) <> true) then
                                            0
                                        else
                                            {3687}let (=OpenSecureChannelResponse,Ns_4033: bitstring,ST_4034: bitstring,TTL_4035: bitstring) = m2_4032 in
                                            {3688}let Kcli_4036: bitstring = h((Nc_4028,Ns_4033)) in
                                            {3689}out(c, senc(mCli(pkCli_3605,pkSess_4025),Kcli_4036))
                            )
                            else
                                {3690}let pkSess_4037: bitstring = fail-any in
                                {3691}out(c, GetEndpointRequest);
                                {3692}in(c, (=GetEndpointResponse,=pkSess_4037,=Sign,SP_4038: bitstring,UP_4039: bitstring));
                                {3693}new Nc_4040: bitstring;
                                {3694}let m1_4041: bitstring = (OpenSecureChannelRequest,pkCli_3605,Nc_4040) in
                                {3695}out(c, (pkCli_3605,m1_4041,sign(h(m1_4041),skCli_3604)));
                                {3696}in(c, (em2_4042: bitstring,sigM2_4043: bitstring));
                                {3697}let m2_4044: bitstring = em2_4042 in
                                {3698}if (verify(h(m2_4044),sigM2_4043,pkSess_4037) <> true) then
                                    0
                                else
                                    {3699}let (=OpenSecureChannelResponse,Ns_4045: bitstring,ST_4046: bitstring,TTL_4047: bitstring) = m2_4044 in
                                    {3700}let Kcli_4048: bitstring = h((Nc_4040,Ns_4045)) in
                                    {3701}out(c, senc(mCli(pkCli_3605,pkSess_4037),Kcli_4048))
                )
                else
                    {3702}let pkDisco_4049: bitstring = fail-any in
                    {3703}let v_4050: bool = (Sess = A) in
                    (
                        {3704}if v_4050 then
                        (
                            {3705}let pkSess_4051: bitstring = pub(skA) in
                            {3706}out(c, GetEndpointRequest);
                            {3707}in(c, (=GetEndpointResponse,=pkSess_4051,=Sign,SP_4052: bitstring,UP_4053: bitstring));
                            {3708}new Nc_4054: bitstring;
                            {3709}let m1_4055: bitstring = (OpenSecureChannelRequest,pkCli_3605,Nc_4054) in
                            {3710}out(c, (pkCli_3605,m1_4055,sign(h(m1_4055),skCli_3604)));
                            {3711}in(c, (em2_4056: bitstring,sigM2_4057: bitstring));
                            {3712}let m2_4058: bitstring = em2_4056 in
                            {3713}if (verify(h(m2_4058),sigM2_4057,pkSess_4051) <> true) then
                                0
                            else
                                {3714}let (=OpenSecureChannelResponse,Ns_4059: bitstring,ST_4060: bitstring,TTL_4061: bitstring) = m2_4058 in
                                {3715}let Kcli_4062: bitstring = h((Nc_4054,Ns_4059)) in
                                {3716}out(c, senc(mCli(pkCli_3605,pkSess_4051),Kcli_4062))
                        )
                        else
                            {3717}let v_4063: bool = (Sess = B) in
                            (
                                {3718}if v_4063 then
                                (
                                    {3719}let pkSess_4064: bitstring = pub(skB) in
                                    {3720}out(c, GetEndpointRequest);
                                    {3721}in(c, (=GetEndpointResponse,=pkSess_4064,=Sign,SP_4065: bitstring,UP_4066: bitstring));
                                    {3722}new Nc_4067: bitstring;
                                    {3723}let m1_4068: bitstring = (OpenSecureChannelRequest,pkCli_3605,Nc_4067) in
                                    {3724}out(c, (pkCli_3605,m1_4068,sign(h(m1_4068),skCli_3604)));
                                    {3725}in(c, (em2_4069: bitstring,sigM2_4070: bitstring));
                                    {3726}let m2_4071: bitstring = em2_4069 in
                                    {3727}if (verify(h(m2_4071),sigM2_4070,pkSess_4064) <> true) then
                                        0
                                    else
                                        {3728}let (=OpenSecureChannelResponse,Ns_4072: bitstring,ST_4073: bitstring,TTL_4074: bitstring) = m2_4071 in
                                        {3729}let Kcli_4075: bitstring = h((Nc_4067,Ns_4072)) in
                                        {3730}out(c, senc(mCli(pkCli_3605,pkSess_4064),Kcli_4075))
                                )
                                else
                                    {3731}let v_4076: bool = (Sess = C) in
                                    (
                                        {3732}if v_4076 then
                                        (
                                            {3733}let pkSess_4077: bitstring = pub(skC) in
                                            {3734}out(c, GetEndpointRequest);
                                            {3735}in(c, (=GetEndpointResponse,=pkSess_4077,=Sign,SP_4078: bitstring,UP_4079: bitstring));
                                            {3736}new Nc_4080: bitstring;
                                            {3737}let m1_4081: bitstring = (OpenSecureChannelRequest,pkCli_3605,Nc_4080) in
                                            {3738}out(c, (pkCli_3605,m1_4081,sign(h(m1_4081),skCli_3604)));
                                            {3739}in(c, (em2_4082: bitstring,sigM2_4083: bitstring));
                                            {3740}let m2_4084: bitstring = em2_4082 in
                                            {3741}if (verify(h(m2_4084),sigM2_4083,pkSess_4077) <> true) then
                                                0
                                            else
                                                {3742}let (=OpenSecureChannelResponse,Ns_4085: bitstring,ST_4086: bitstring,TTL_4087: bitstring) = m2_4084 in
                                                {3743}let Kcli_4088: bitstring = h((Nc_4080,Ns_4085)) in
                                                {3744}out(c, senc(mCli(pkCli_3605,pkSess_4077),Kcli_4088))
                                        )
                                        else
                                            {3745}let pkSess_4089: bitstring = pub(sk(Sess)) in
                                            {3746}out(c, GetEndpointRequest);
                                            {3747}in(c, (=GetEndpointResponse,=pkSess_4089,=Sign,SP_4090: bitstring,UP_4091: bitstring));
                                            {3748}new Nc_4092: bitstring;
                                            {3749}let m1_4093: bitstring = (OpenSecureChannelRequest,pkCli_3605,Nc_4092) in
                                            {3750}out(c, (pkCli_3605,m1_4093,sign(h(m1_4093),skCli_3604)));
                                            {3751}in(c, (em2_4094: bitstring,sigM2_4095: bitstring));
                                            {3752}let m2_4096: bitstring = em2_4094 in
                                            {3753}if (verify(h(m2_4096),sigM2_4095,pkSess_4089) <> true) then
                                                0
                                            else
                                                {3754}let (=OpenSecureChannelResponse,Ns_4097: bitstring,ST_4098: bitstring,TTL_4099: bitstring) = m2_4096 in
                                                {3755}let Kcli_4100: bitstring = h((Nc_4092,Ns_4097)) in
                                                {3756}out(c, senc(mCli(pkCli_3605,pkSess_4089),Kcli_4100))
                                    )
                                    else
                                        {3757}let pkSess_4101: bitstring = fail-any in
                                        {3758}out(c, GetEndpointRequest);
                                        {3759}in(c, (=GetEndpointResponse,=pkSess_4101,=Sign,SP_4102: bitstring,UP_4103: bitstring));
                                        {3760}new Nc_4104: bitstring;
                                        {3761}let m1_4105: bitstring = (OpenSecureChannelRequest,pkCli_3605,Nc_4104) in
                                        {3762}out(c, (pkCli_3605,m1_4105,sign(h(m1_4105),skCli_3604)));
                                        {3763}in(c, (em2_4106: bitstring,sigM2_4107: bitstring));
                                        {3764}let m2_4108: bitstring = em2_4106 in
                                        {3765}if (verify(h(m2_4108),sigM2_4107,pkSess_4101) <> true) then
                                            0
                                        else
                                            {3766}let (=OpenSecureChannelResponse,Ns_4109: bitstring,ST_4110: bitstring,TTL_4111: bitstring) = m2_4108 in
                                            {3767}let Kcli_4112: bitstring = h((Nc_4104,Ns_4109)) in
                                            {3768}out(c, senc(mCli(pkCli_3605,pkSess_4101),Kcli_4112))
                            )
                            else
                                {3769}let pkSess_4113: bitstring = fail-any in
                                {3770}out(c, GetEndpointRequest);
                                {3771}in(c, (=GetEndpointResponse,=pkSess_4113,=Sign,SP_4114: bitstring,UP_4115: bitstring));
                                {3772}new Nc_4116: bitstring;
                                {3773}let m1_4117: bitstring = (OpenSecureChannelRequest,pkCli_3605,Nc_4116) in
                                {3774}out(c, (pkCli_3605,m1_4117,sign(h(m1_4117),skCli_3604)));
                                {3775}in(c, (em2_4118: bitstring,sigM2_4119: bitstring));
                                {3776}let m2_4120: bitstring = em2_4118 in
                                {3777}if (verify(h(m2_4120),sigM2_4119,pkSess_4113) <> true) then
                                    0
                                else
                                    {3778}let (=OpenSecureChannelResponse,Ns_4121: bitstring,ST_4122: bitstring,TTL_4123: bitstring) = m2_4120 in
                                    {3779}let Kcli_4124: bitstring = h((Nc_4116,Ns_4121)) in
                                    {3780}out(c, senc(mCli(pkCli_3605,pkSess_4113),Kcli_4124))
                    )
                    else
                        {3781}let pkSess_4125: bitstring = fail-any in
                        {3782}out(c, GetEndpointRequest);
                        {3783}in(c, (=GetEndpointResponse,=pkSess_4125,=Sign,SP_4126: bitstring,UP_4127: bitstring));
                        {3784}new Nc_4128: bitstring;
                        {3785}let m1_4129: bitstring = (OpenSecureChannelRequest,pkCli_3605,Nc_4128) in
                        {3786}out(c, (pkCli_3605,m1_4129,sign(h(m1_4129),skCli_3604)));
                        {3787}in(c, (em2_4130: bitstring,sigM2_4131: bitstring));
                        {3788}let m2_4132: bitstring = em2_4130 in
                        {3789}if (verify(h(m2_4132),sigM2_4131,pkSess_4125) <> true) then
                            0
                        else
                            {3790}let (=OpenSecureChannelResponse,Ns_4133: bitstring,ST_4134: bitstring,TTL_4135: bitstring) = m2_4132 in
                            {3791}let Kcli_4136: bitstring = h((Nc_4128,Ns_4133)) in
                            {3792}out(c, senc(mCli(pkCli_3605,pkSess_4125),Kcli_4136))
        )
        else
            {3793}let pkDisco_4137: bitstring = fail-any in
            {3794}let v_4138: bool = (Sess = A) in
            (
                {3795}if v_4138 then
                (
                    {3796}let pkSess_4139: bitstring = pub(skA) in
                    {3797}out(c, GetEndpointRequest);
                    {3798}in(c, (=GetEndpointResponse,=pkSess_4139,=Sign,SP_4140: bitstring,UP_4141: bitstring));
                    {3799}new Nc_4142: bitstring;
                    {3800}let m1_4143: bitstring = (OpenSecureChannelRequest,pkCli_3605,Nc_4142) in
                    {3801}out(c, (pkCli_3605,m1_4143,sign(h(m1_4143),skCli_3604)));
                    {3802}in(c, (em2_4144: bitstring,sigM2_4145: bitstring));
                    {3803}let m2_4146: bitstring = em2_4144 in
                    {3804}if (verify(h(m2_4146),sigM2_4145,pkSess_4139) <> true) then
                        0
                    else
                        {3805}let (=OpenSecureChannelResponse,Ns_4147: bitstring,ST_4148: bitstring,TTL_4149: bitstring) = m2_4146 in
                        {3806}let Kcli_4150: bitstring = h((Nc_4142,Ns_4147)) in
                        {3807}out(c, senc(mCli(pkCli_3605,pkSess_4139),Kcli_4150))
                )
                else
                    {3808}let v_4151: bool = (Sess = B) in
                    (
                        {3809}if v_4151 then
                        (
                            {3810}let pkSess_4152: bitstring = pub(skB) in
                            {3811}out(c, GetEndpointRequest);
                            {3812}in(c, (=GetEndpointResponse,=pkSess_4152,=Sign,SP_4153: bitstring,UP_4154: bitstring));
                            {3813}new Nc_4155: bitstring;
                            {3814}let m1_4156: bitstring = (OpenSecureChannelRequest,pkCli_3605,Nc_4155) in
                            {3815}out(c, (pkCli_3605,m1_4156,sign(h(m1_4156),skCli_3604)));
                            {3816}in(c, (em2_4157: bitstring,sigM2_4158: bitstring));
                            {3817}let m2_4159: bitstring = em2_4157 in
                            {3818}if (verify(h(m2_4159),sigM2_4158,pkSess_4152) <> true) then
                                0
                            else
                                {3819}let (=OpenSecureChannelResponse,Ns_4160: bitstring,ST_4161: bitstring,TTL_4162: bitstring) = m2_4159 in
                                {3820}let Kcli_4163: bitstring = h((Nc_4155,Ns_4160)) in
                                {3821}out(c, senc(mCli(pkCli_3605,pkSess_4152),Kcli_4163))
                        )
                        else
                            {3822}let v_4164: bool = (Sess = C) in
                            (
                                {3823}if v_4164 then
                                (
                                    {3824}let pkSess_4165: bitstring = pub(skC) in
                                    {3825}out(c, GetEndpointRequest);
                                    {3826}in(c, (=GetEndpointResponse,=pkSess_4165,=Sign,SP_4166: bitstring,UP_4167: bitstring));
                                    {3827}new Nc_4168: bitstring;
                                    {3828}let m1_4169: bitstring = (OpenSecureChannelRequest,pkCli_3605,Nc_4168) in
                                    {3829}out(c, (pkCli_3605,m1_4169,sign(h(m1_4169),skCli_3604)));
                                    {3830}in(c, (em2_4170: bitstring,sigM2_4171: bitstring));
                                    {3831}let m2_4172: bitstring = em2_4170 in
                                    {3832}if (verify(h(m2_4172),sigM2_4171,pkSess_4165) <> true) then
                                        0
                                    else
                                        {3833}let (=OpenSecureChannelResponse,Ns_4173: bitstring,ST_4174: bitstring,TTL_4175: bitstring) = m2_4172 in
                                        {3834}let Kcli_4176: bitstring = h((Nc_4168,Ns_4173)) in
                                        {3835}out(c, senc(mCli(pkCli_3605,pkSess_4165),Kcli_4176))
                                )
                                else
                                    {3836}let pkSess_4177: bitstring = pub(sk(Sess)) in
                                    {3837}out(c, GetEndpointRequest);
                                    {3838}in(c, (=GetEndpointResponse,=pkSess_4177,=Sign,SP_4178: bitstring,UP_4179: bitstring));
                                    {3839}new Nc_4180: bitstring;
                                    {3840}let m1_4181: bitstring = (OpenSecureChannelRequest,pkCli_3605,Nc_4180) in
                                    {3841}out(c, (pkCli_3605,m1_4181,sign(h(m1_4181),skCli_3604)));
                                    {3842}in(c, (em2_4182: bitstring,sigM2_4183: bitstring));
                                    {3843}let m2_4184: bitstring = em2_4182 in
                                    {3844}if (verify(h(m2_4184),sigM2_4183,pkSess_4177) <> true) then
                                        0
                                    else
                                        {3845}let (=OpenSecureChannelResponse,Ns_4185: bitstring,ST_4186: bitstring,TTL_4187: bitstring) = m2_4184 in
                                        {3846}let Kcli_4188: bitstring = h((Nc_4180,Ns_4185)) in
                                        {3847}out(c, senc(mCli(pkCli_3605,pkSess_4177),Kcli_4188))
                            )
                            else
                                {3848}let pkSess_4189: bitstring = fail-any in
                                {3849}out(c, GetEndpointRequest);
                                {3850}in(c, (=GetEndpointResponse,=pkSess_4189,=Sign,SP_4190: bitstring,UP_4191: bitstring));
                                {3851}new Nc_4192: bitstring;
                                {3852}let m1_4193: bitstring = (OpenSecureChannelRequest,pkCli_3605,Nc_4192) in
                                {3853}out(c, (pkCli_3605,m1_4193,sign(h(m1_4193),skCli_3604)));
                                {3854}in(c, (em2_4194: bitstring,sigM2_4195: bitstring));
                                {3855}let m2_4196: bitstring = em2_4194 in
                                {3856}if (verify(h(m2_4196),sigM2_4195,pkSess_4189) <> true) then
                                    0
                                else
                                    {3857}let (=OpenSecureChannelResponse,Ns_4197: bitstring,ST_4198: bitstring,TTL_4199: bitstring) = m2_4196 in
                                    {3858}let Kcli_4200: bitstring = h((Nc_4192,Ns_4197)) in
                                    {3859}out(c, senc(mCli(pkCli_3605,pkSess_4189),Kcli_4200))
                    )
                    else
                        {3860}let pkSess_4201: bitstring = fail-any in
                        {3861}out(c, GetEndpointRequest);
                        {3862}in(c, (=GetEndpointResponse,=pkSess_4201,=Sign,SP_4202: bitstring,UP_4203: bitstring));
                        {3863}new Nc_4204: bitstring;
                        {3864}let m1_4205: bitstring = (OpenSecureChannelRequest,pkCli_3605,Nc_4204) in
                        {3865}out(c, (pkCli_3605,m1_4205,sign(h(m1_4205),skCli_3604)));
                        {3866}in(c, (em2_4206: bitstring,sigM2_4207: bitstring));
                        {3867}let m2_4208: bitstring = em2_4206 in
                        {3868}if (verify(h(m2_4208),sigM2_4207,pkSess_4201) <> true) then
                            0
                        else
                            {3869}let (=OpenSecureChannelResponse,Ns_4209: bitstring,ST_4210: bitstring,TTL_4211: bitstring) = m2_4208 in
                            {3870}let Kcli_4212: bitstring = h((Nc_4204,Ns_4209)) in
                            {3871}out(c, senc(mCli(pkCli_3605,pkSess_4201),Kcli_4212))
            )
            else
                {3872}let pkSess_4213: bitstring = fail-any in
                {3873}out(c, GetEndpointRequest);
                {3874}in(c, (=GetEndpointResponse,=pkSess_4213,=Sign,SP_4214: bitstring,UP_4215: bitstring));
                {3875}new Nc_4216: bitstring;
                {3876}let m1_4217: bitstring = (OpenSecureChannelRequest,pkCli_3605,Nc_4216) in
                {3877}out(c, (pkCli_3605,m1_4217,sign(h(m1_4217),skCli_3604)));
                {3878}in(c, (em2_4218: bitstring,sigM2_4219: bitstring));
                {3879}let m2_4220: bitstring = em2_4218 in
                {3880}if (verify(h(m2_4220),sigM2_4219,pkSess_4213) <> true) then
                    0
                else
                    {3881}let (=OpenSecureChannelResponse,Ns_4221: bitstring,ST_4222: bitstring,TTL_4223: bitstring) = m2_4220 in
                    {3882}let Kcli_4224: bitstring = h((Nc_4216,Ns_4221)) in
                    {3883}out(c, senc(mCli(pkCli_3605,pkSess_4213),Kcli_4224))
) | (
    {3884}!
    {3885}in(c, (Cli_4225: host,Disco_4226: host,Sess_4227: host));
    {3886}let v_4228: bool = (Disco_4226 = A) in
    (
        {3887}if v_4228 then
        (
            {3888}let skDisco: bitstring = skA in
            {3889}let pkDisco_4229: bitstring = pub(skDisco) in
            {3890}let v_4230: bool = (Cli_4225 = A) in
            (
                {3891}if v_4230 then
                (
                    {3892}let pkCli_4231: bitstring = pub(skA) in
                    {3893}let v_4232: bool = (Sess_4227 = A) in
                    (
                        {3894}if v_4232 then
                        (
                            {3895}let pkSess_4233: bitstring = pub(skA) in
                            {3896}in(c, =GetEndpointRequest);
                            {3897}new SP_4234: bitstring;
                            {3898}new UP_4235: bitstring;
                            {3899}out(c, (GetEndpointResponse,pkSess_4233,Sign,SP_4234,UP_4235))
                        )
                        else
                            {3900}let v_4236: bool = (Sess_4227 = B) in
                            (
                                {3901}if v_4236 then
                                (
                                    {3902}let pkSess_4237: bitstring = pub(skB) in
                                    {3903}in(c, =GetEndpointRequest);
                                    {3904}new SP_4238: bitstring;
                                    {3905}new UP_4239: bitstring;
                                    {3906}out(c, (GetEndpointResponse,pkSess_4237,Sign,SP_4238,UP_4239))
                                )
                                else
                                    {3907}let v_4240: bool = (Sess_4227 = C) in
                                    (
                                        {3908}if v_4240 then
                                        (
                                            {3909}let pkSess_4241: bitstring = pub(skC) in
                                            {3910}in(c, =GetEndpointRequest);
                                            {3911}new SP_4242: bitstring;
                                            {3912}new UP_4243: bitstring;
                                            {3913}out(c, (GetEndpointResponse,pkSess_4241,Sign,SP_4242,UP_4243))
                                        )
                                        else
                                            {3914}let pkSess_4244: bitstring = pub(sk(Sess_4227)) in
                                            {3915}in(c, =GetEndpointRequest);
                                            {3916}new SP_4245: bitstring;
                                            {3917}new UP_4246: bitstring;
                                            {3918}out(c, (GetEndpointResponse,pkSess_4244,Sign,SP_4245,UP_4246))
                                    )
                                    else
                                        {3919}let pkSess_4247: bitstring = fail-any in
                                        {3920}in(c, =GetEndpointRequest);
                                        {3921}new SP_4248: bitstring;
                                        {3922}new UP_4249: bitstring;
                                        {3923}out(c, (GetEndpointResponse,pkSess_4247,Sign,SP_4248,UP_4249))
                            )
                            else
                                {3924}let pkSess_4250: bitstring = fail-any in
                                {3925}in(c, =GetEndpointRequest);
                                {3926}new SP_4251: bitstring;
                                {3927}new UP_4252: bitstring;
                                {3928}out(c, (GetEndpointResponse,pkSess_4250,Sign,SP_4251,UP_4252))
                    )
                    else
                        {3929}let pkSess_4253: bitstring = fail-any in
                        {3930}in(c, =GetEndpointRequest);
                        {3931}new SP_4254: bitstring;
                        {3932}new UP_4255: bitstring;
                        {3933}out(c, (GetEndpointResponse,pkSess_4253,Sign,SP_4254,UP_4255))
                )
                else
                    {3934}let v_4256: bool = (Cli_4225 = B) in
                    (
                        {3935}if v_4256 then
                        (
                            {3936}let pkCli_4257: bitstring = pub(skB) in
                            {3937}let v_4258: bool = (Sess_4227 = A) in
                            (
                                {3938}if v_4258 then
                                (
                                    {3939}let pkSess_4259: bitstring = pub(skA) in
                                    {3940}in(c, =GetEndpointRequest);
                                    {3941}new SP_4260: bitstring;
                                    {3942}new UP_4261: bitstring;
                                    {3943}out(c, (GetEndpointResponse,pkSess_4259,Sign,SP_4260,UP_4261))
                                )
                                else
                                    {3944}let v_4262: bool = (Sess_4227 = B) in
                                    (
                                        {3945}if v_4262 then
                                        (
                                            {3946}let pkSess_4263: bitstring = pub(skB) in
                                            {3947}in(c, =GetEndpointRequest);
                                            {3948}new SP_4264: bitstring;
                                            {3949}new UP_4265: bitstring;
                                            {3950}out(c, (GetEndpointResponse,pkSess_4263,Sign,SP_4264,UP_4265))
                                        )
                                        else
                                            {3951}let v_4266: bool = (Sess_4227 = C) in
                                            (
                                                {3952}if v_4266 then
                                                (
                                                    {3953}let pkSess_4267: bitstring = pub(skC) in
                                                    {3954}in(c, =GetEndpointRequest);
                                                    {3955}new SP_4268: bitstring;
                                                    {3956}new UP_4269: bitstring;
                                                    {3957}out(c, (GetEndpointResponse,pkSess_4267,Sign,SP_4268,UP_4269))
                                                )
                                                else
                                                    {3958}let pkSess_4270: bitstring = pub(sk(Sess_4227)) in
                                                    {3959}in(c, =GetEndpointRequest);
                                                    {3960}new SP_4271: bitstring;
                                                    {3961}new UP_4272: bitstring;
                                                    {3962}out(c, (GetEndpointResponse,pkSess_4270,Sign,SP_4271,UP_4272))
                                            )
                                            else
                                                {3963}let pkSess_4273: bitstring = fail-any in
                                                {3964}in(c, =GetEndpointRequest);
                                                {3965}new SP_4274: bitstring;
                                                {3966}new UP_4275: bitstring;
                                                {3967}out(c, (GetEndpointResponse,pkSess_4273,Sign,SP_4274,UP_4275))
                                    )
                                    else
                                        {3968}let pkSess_4276: bitstring = fail-any in
                                        {3969}in(c, =GetEndpointRequest);
                                        {3970}new SP_4277: bitstring;
                                        {3971}new UP_4278: bitstring;
                                        {3972}out(c, (GetEndpointResponse,pkSess_4276,Sign,SP_4277,UP_4278))
                            )
                            else
                                {3973}let pkSess_4279: bitstring = fail-any in
                                {3974}in(c, =GetEndpointRequest);
                                {3975}new SP_4280: bitstring;
                                {3976}new UP_4281: bitstring;
                                {3977}out(c, (GetEndpointResponse,pkSess_4279,Sign,SP_4280,UP_4281))
                        )
                        else
                            {3978}let v_4282: bool = (Cli_4225 = C) in
                            (
                                {3979}if v_4282 then
                                (
                                    {3980}let pkCli_4283: bitstring = pub(skC) in
                                    {3981}let v_4284: bool = (Sess_4227 = A) in
                                    (
                                        {3982}if v_4284 then
                                        (
                                            {3983}let pkSess_4285: bitstring = pub(skA) in
                                            {3984}in(c, =GetEndpointRequest);
                                            {3985}new SP_4286: bitstring;
                                            {3986}new UP_4287: bitstring;
                                            {3987}out(c, (GetEndpointResponse,pkSess_4285,Sign,SP_4286,UP_4287))
                                        )
                                        else
                                            {3988}let v_4288: bool = (Sess_4227 = B) in
                                            (
                                                {3989}if v_4288 then
                                                (
                                                    {3990}let pkSess_4289: bitstring = pub(skB) in
                                                    {3991}in(c, =GetEndpointRequest);
                                                    {3992}new SP_4290: bitstring;
                                                    {3993}new UP_4291: bitstring;
                                                    {3994}out(c, (GetEndpointResponse,pkSess_4289,Sign,SP_4290,UP_4291))
                                                )
                                                else
                                                    {3995}let v_4292: bool = (Sess_4227 = C) in
                                                    (
                                                        {3996}if v_4292 then
                                                        (
                                                            {3997}let pkSess_4293: bitstring = pub(skC) in
                                                            {3998}in(c, =GetEndpointRequest);
                                                            {3999}new SP_4294: bitstring;
                                                            {4000}new UP_4295: bitstring;
                                                            {4001}out(c, (GetEndpointResponse,pkSess_4293,Sign,SP_4294,UP_4295))
                                                        )
                                                        else
                                                            {4002}let pkSess_4296: bitstring = pub(sk(Sess_4227)) in
                                                            {4003}in(c, =GetEndpointRequest);
                                                            {4004}new SP_4297: bitstring;
                                                            {4005}new UP_4298: bitstring;
                                                            {4006}out(c, (GetEndpointResponse,pkSess_4296,Sign,SP_4297,UP_4298))
                                                    )
                                                    else
                                                        {4007}let pkSess_4299: bitstring = fail-any in
                                                        {4008}in(c, =GetEndpointRequest);
                                                        {4009}new SP_4300: bitstring;
                                                        {4010}new UP_4301: bitstring;
                                                        {4011}out(c, (GetEndpointResponse,pkSess_4299,Sign,SP_4300,UP_4301))
                                            )
                                            else
                                                {4012}let pkSess_4302: bitstring = fail-any in
                                                {4013}in(c, =GetEndpointRequest);
                                                {4014}new SP_4303: bitstring;
                                                {4015}new UP_4304: bitstring;
                                                {4016}out(c, (GetEndpointResponse,pkSess_4302,Sign,SP_4303,UP_4304))
                                    )
                                    else
                                        {4017}let pkSess_4305: bitstring = fail-any in
                                        {4018}in(c, =GetEndpointRequest);
                                        {4019}new SP_4306: bitstring;
                                        {4020}new UP_4307: bitstring;
                                        {4021}out(c, (GetEndpointResponse,pkSess_4305,Sign,SP_4306,UP_4307))
                                )
                                else
                                    {4022}let pkCli_4308: bitstring = pub(sk(Cli_4225)) in
                                    {4023}let v_4309: bool = (Sess_4227 = A) in
                                    (
                                        {4024}if v_4309 then
                                        (
                                            {4025}let pkSess_4310: bitstring = pub(skA) in
                                            {4026}in(c, =GetEndpointRequest);
                                            {4027}new SP_4311: bitstring;
                                            {4028}new UP_4312: bitstring;
                                            {4029}out(c, (GetEndpointResponse,pkSess_4310,Sign,SP_4311,UP_4312))
                                        )
                                        else
                                            {4030}let v_4313: bool = (Sess_4227 = B) in
                                            (
                                                {4031}if v_4313 then
                                                (
                                                    {4032}let pkSess_4314: bitstring = pub(skB) in
                                                    {4033}in(c, =GetEndpointRequest);
                                                    {4034}new SP_4315: bitstring;
                                                    {4035}new UP_4316: bitstring;
                                                    {4036}out(c, (GetEndpointResponse,pkSess_4314,Sign,SP_4315,UP_4316))
                                                )
                                                else
                                                    {4037}let v_4317: bool = (Sess_4227 = C) in
                                                    (
                                                        {4038}if v_4317 then
                                                        (
                                                            {4039}let pkSess_4318: bitstring = pub(skC) in
                                                            {4040}in(c, =GetEndpointRequest);
                                                            {4041}new SP_4319: bitstring;
                                                            {4042}new UP_4320: bitstring;
                                                            {4043}out(c, (GetEndpointResponse,pkSess_4318,Sign,SP_4319,UP_4320))
                                                        )
                                                        else
                                                            {4044}let pkSess_4321: bitstring = pub(sk(Sess_4227)) in
                                                            {4045}in(c, =GetEndpointRequest);
                                                            {4046}new SP_4322: bitstring;
                                                            {4047}new UP_4323: bitstring;
                                                            {4048}out(c, (GetEndpointResponse,pkSess_4321,Sign,SP_4322,UP_4323))
                                                    )
                                                    else
                                                        {4049}let pkSess_4324: bitstring = fail-any in
                                                        {4050}in(c, =GetEndpointRequest);
                                                        {4051}new SP_4325: bitstring;
                                                        {4052}new UP_4326: bitstring;
                                                        {4053}out(c, (GetEndpointResponse,pkSess_4324,Sign,SP_4325,UP_4326))
                                            )
                                            else
                                                {4054}let pkSess_4327: bitstring = fail-any in
                                                {4055}in(c, =GetEndpointRequest);
                                                {4056}new SP_4328: bitstring;
                                                {4057}new UP_4329: bitstring;
                                                {4058}out(c, (GetEndpointResponse,pkSess_4327,Sign,SP_4328,UP_4329))
                                    )
                                    else
                                        {4059}let pkSess_4330: bitstring = fail-any in
                                        {4060}in(c, =GetEndpointRequest);
                                        {4061}new SP_4331: bitstring;
                                        {4062}new UP_4332: bitstring;
                                        {4063}out(c, (GetEndpointResponse,pkSess_4330,Sign,SP_4331,UP_4332))
                            )
                            else
                                {4064}let pkCli_4333: bitstring = fail-any in
                                {4065}let v_4334: bool = (Sess_4227 = A) in
                                (
                                    {4066}if v_4334 then
                                    (
                                        {4067}let pkSess_4335: bitstring = pub(skA) in
                                        {4068}in(c, =GetEndpointRequest);
                                        {4069}new SP_4336: bitstring;
                                        {4070}new UP_4337: bitstring;
                                        {4071}out(c, (GetEndpointResponse,pkSess_4335,Sign,SP_4336,UP_4337))
                                    )
                                    else
                                        {4072}let v_4338: bool = (Sess_4227 = B) in
                                        (
                                            {4073}if v_4338 then
                                            (
                                                {4074}let pkSess_4339: bitstring = pub(skB) in
                                                {4075}in(c, =GetEndpointRequest);
                                                {4076}new SP_4340: bitstring;
                                                {4077}new UP_4341: bitstring;
                                                {4078}out(c, (GetEndpointResponse,pkSess_4339,Sign,SP_4340,UP_4341))
                                            )
                                            else
                                                {4079}let v_4342: bool = (Sess_4227 = C) in
                                                (
                                                    {4080}if v_4342 then
                                                    (
                                                        {4081}let pkSess_4343: bitstring = pub(skC) in
                                                        {4082}in(c, =GetEndpointRequest);
                                                        {4083}new SP_4344: bitstring;
                                                        {4084}new UP_4345: bitstring;
                                                        {4085}out(c, (GetEndpointResponse,pkSess_4343,Sign,SP_4344,UP_4345))
                                                    )
                                                    else
                                                        {4086}let pkSess_4346: bitstring = pub(sk(Sess_4227)) in
                                                        {4087}in(c, =GetEndpointRequest);
                                                        {4088}new SP_4347: bitstring;
                                                        {4089}new UP_4348: bitstring;
                                                        {4090}out(c, (GetEndpointResponse,pkSess_4346,Sign,SP_4347,UP_4348))
                                                )
                                                else
                                                    {4091}let pkSess_4349: bitstring = fail-any in
                                                    {4092}in(c, =GetEndpointRequest);
                                                    {4093}new SP_4350: bitstring;
                                                    {4094}new UP_4351: bitstring;
                                                    {4095}out(c, (GetEndpointResponse,pkSess_4349,Sign,SP_4350,UP_4351))
                                        )
                                        else
                                            {4096}let pkSess_4352: bitstring = fail-any in
                                            {4097}in(c, =GetEndpointRequest);
                                            {4098}new SP_4353: bitstring;
                                            {4099}new UP_4354: bitstring;
                                            {4100}out(c, (GetEndpointResponse,pkSess_4352,Sign,SP_4353,UP_4354))
                                )
                                else
                                    {4101}let pkSess_4355: bitstring = fail-any in
                                    {4102}in(c, =GetEndpointRequest);
                                    {4103}new SP_4356: bitstring;
                                    {4104}new UP_4357: bitstring;
                                    {4105}out(c, (GetEndpointResponse,pkSess_4355,Sign,SP_4356,UP_4357))
                    )
                    else
                        {4106}let pkCli_4358: bitstring = fail-any in
                        {4107}let v_4359: bool = (Sess_4227 = A) in
                        (
                            {4108}if v_4359 then
                            (
                                {4109}let pkSess_4360: bitstring = pub(skA) in
                                {4110}in(c, =GetEndpointRequest);
                                {4111}new SP_4361: bitstring;
                                {4112}new UP_4362: bitstring;
                                {4113}out(c, (GetEndpointResponse,pkSess_4360,Sign,SP_4361,UP_4362))
                            )
                            else
                                {4114}let v_4363: bool = (Sess_4227 = B) in
                                (
                                    {4115}if v_4363 then
                                    (
                                        {4116}let pkSess_4364: bitstring = pub(skB) in
                                        {4117}in(c, =GetEndpointRequest);
                                        {4118}new SP_4365: bitstring;
                                        {4119}new UP_4366: bitstring;
                                        {4120}out(c, (GetEndpointResponse,pkSess_4364,Sign,SP_4365,UP_4366))
                                    )
                                    else
                                        {4121}let v_4367: bool = (Sess_4227 = C) in
                                        (
                                            {4122}if v_4367 then
                                            (
                                                {4123}let pkSess_4368: bitstring = pub(skC) in
                                                {4124}in(c, =GetEndpointRequest);
                                                {4125}new SP_4369: bitstring;
                                                {4126}new UP_4370: bitstring;
                                                {4127}out(c, (GetEndpointResponse,pkSess_4368,Sign,SP_4369,UP_4370))
                                            )
                                            else
                                                {4128}let pkSess_4371: bitstring = pub(sk(Sess_4227)) in
                                                {4129}in(c, =GetEndpointRequest);
                                                {4130}new SP_4372: bitstring;
                                                {4131}new UP_4373: bitstring;
                                                {4132}out(c, (GetEndpointResponse,pkSess_4371,Sign,SP_4372,UP_4373))
                                        )
                                        else
                                            {4133}let pkSess_4374: bitstring = fail-any in
                                            {4134}in(c, =GetEndpointRequest);
                                            {4135}new SP_4375: bitstring;
                                            {4136}new UP_4376: bitstring;
                                            {4137}out(c, (GetEndpointResponse,pkSess_4374,Sign,SP_4375,UP_4376))
                                )
                                else
                                    {4138}let pkSess_4377: bitstring = fail-any in
                                    {4139}in(c, =GetEndpointRequest);
                                    {4140}new SP_4378: bitstring;
                                    {4141}new UP_4379: bitstring;
                                    {4142}out(c, (GetEndpointResponse,pkSess_4377,Sign,SP_4378,UP_4379))
                        )
                        else
                            {4143}let pkSess_4380: bitstring = fail-any in
                            {4144}in(c, =GetEndpointRequest);
                            {4145}new SP_4381: bitstring;
                            {4146}new UP_4382: bitstring;
                            {4147}out(c, (GetEndpointResponse,pkSess_4380,Sign,SP_4381,UP_4382))
            )
            else
                {4148}let pkCli_4383: bitstring = fail-any in
                {4149}let v_4384: bool = (Sess_4227 = A) in
                (
                    {4150}if v_4384 then
                    (
                        {4151}let pkSess_4385: bitstring = pub(skA) in
                        {4152}in(c, =GetEndpointRequest);
                        {4153}new SP_4386: bitstring;
                        {4154}new UP_4387: bitstring;
                        {4155}out(c, (GetEndpointResponse,pkSess_4385,Sign,SP_4386,UP_4387))
                    )
                    else
                        {4156}let v_4388: bool = (Sess_4227 = B) in
                        (
                            {4157}if v_4388 then
                            (
                                {4158}let pkSess_4389: bitstring = pub(skB) in
                                {4159}in(c, =GetEndpointRequest);
                                {4160}new SP_4390: bitstring;
                                {4161}new UP_4391: bitstring;
                                {4162}out(c, (GetEndpointResponse,pkSess_4389,Sign,SP_4390,UP_4391))
                            )
                            else
                                {4163}let v_4392: bool = (Sess_4227 = C) in
                                (
                                    {4164}if v_4392 then
                                    (
                                        {4165}let pkSess_4393: bitstring = pub(skC) in
                                        {4166}in(c, =GetEndpointRequest);
                                        {4167}new SP_4394: bitstring;
                                        {4168}new UP_4395: bitstring;
                                        {4169}out(c, (GetEndpointResponse,pkSess_4393,Sign,SP_4394,UP_4395))
                                    )
                                    else
                                        {4170}let pkSess_4396: bitstring = pub(sk(Sess_4227)) in
                                        {4171}in(c, =GetEndpointRequest);
                                        {4172}new SP_4397: bitstring;
                                        {4173}new UP_4398: bitstring;
                                        {4174}out(c, (GetEndpointResponse,pkSess_4396,Sign,SP_4397,UP_4398))
                                )
                                else
                                    {4175}let pkSess_4399: bitstring = fail-any in
                                    {4176}in(c, =GetEndpointRequest);
                                    {4177}new SP_4400: bitstring;
                                    {4178}new UP_4401: bitstring;
                                    {4179}out(c, (GetEndpointResponse,pkSess_4399,Sign,SP_4400,UP_4401))
                        )
                        else
                            {4180}let pkSess_4402: bitstring = fail-any in
                            {4181}in(c, =GetEndpointRequest);
                            {4182}new SP_4403: bitstring;
                            {4183}new UP_4404: bitstring;
                            {4184}out(c, (GetEndpointResponse,pkSess_4402,Sign,SP_4403,UP_4404))
                )
                else
                    {4185}let pkSess_4405: bitstring = fail-any in
                    {4186}in(c, =GetEndpointRequest);
                    {4187}new SP_4406: bitstring;
                    {4188}new UP_4407: bitstring;
                    {4189}out(c, (GetEndpointResponse,pkSess_4405,Sign,SP_4406,UP_4407))
        )
        else
            {4190}let v_4408: bool = (Disco_4226 = B) in
            (
                {4191}if v_4408 then
                (
                    {4192}let skDisco_4409: bitstring = skB in
                    {4193}let pkDisco_4410: bitstring = pub(skDisco_4409) in
                    {4194}let v_4411: bool = (Cli_4225 = A) in
                    (
                        {4195}if v_4411 then
                        (
                            {4196}let pkCli_4412: bitstring = pub(skA) in
                            {4197}let v_4413: bool = (Sess_4227 = A) in
                            (
                                {4198}if v_4413 then
                                (
                                    {4199}let pkSess_4414: bitstring = pub(skA) in
                                    {4200}in(c, =GetEndpointRequest);
                                    {4201}new SP_4415: bitstring;
                                    {4202}new UP_4416: bitstring;
                                    {4203}out(c, (GetEndpointResponse,pkSess_4414,Sign,SP_4415,UP_4416))
                                )
                                else
                                    {4204}let v_4417: bool = (Sess_4227 = B) in
                                    (
                                        {4205}if v_4417 then
                                        (
                                            {4206}let pkSess_4418: bitstring = pub(skB) in
                                            {4207}in(c, =GetEndpointRequest);
                                            {4208}new SP_4419: bitstring;
                                            {4209}new UP_4420: bitstring;
                                            {4210}out(c, (GetEndpointResponse,pkSess_4418,Sign,SP_4419,UP_4420))
                                        )
                                        else
                                            {4211}let v_4421: bool = (Sess_4227 = C) in
                                            (
                                                {4212}if v_4421 then
                                                (
                                                    {4213}let pkSess_4422: bitstring = pub(skC) in
                                                    {4214}in(c, =GetEndpointRequest);
                                                    {4215}new SP_4423: bitstring;
                                                    {4216}new UP_4424: bitstring;
                                                    {4217}out(c, (GetEndpointResponse,pkSess_4422,Sign,SP_4423,UP_4424))
                                                )
                                                else
                                                    {4218}let pkSess_4425: bitstring = pub(sk(Sess_4227)) in
                                                    {4219}in(c, =GetEndpointRequest);
                                                    {4220}new SP_4426: bitstring;
                                                    {4221}new UP_4427: bitstring;
                                                    {4222}out(c, (GetEndpointResponse,pkSess_4425,Sign,SP_4426,UP_4427))
                                            )
                                            else
                                                {4223}let pkSess_4428: bitstring = fail-any in
                                                {4224}in(c, =GetEndpointRequest);
                                                {4225}new SP_4429: bitstring;
                                                {4226}new UP_4430: bitstring;
                                                {4227}out(c, (GetEndpointResponse,pkSess_4428,Sign,SP_4429,UP_4430))
                                    )
                                    else
                                        {4228}let pkSess_4431: bitstring = fail-any in
                                        {4229}in(c, =GetEndpointRequest);
                                        {4230}new SP_4432: bitstring;
                                        {4231}new UP_4433: bitstring;
                                        {4232}out(c, (GetEndpointResponse,pkSess_4431,Sign,SP_4432,UP_4433))
                            )
                            else
                                {4233}let pkSess_4434: bitstring = fail-any in
                                {4234}in(c, =GetEndpointRequest);
                                {4235}new SP_4435: bitstring;
                                {4236}new UP_4436: bitstring;
                                {4237}out(c, (GetEndpointResponse,pkSess_4434,Sign,SP_4435,UP_4436))
                        )
                        else
                            {4238}let v_4437: bool = (Cli_4225 = B) in
                            (
                                {4239}if v_4437 then
                                (
                                    {4240}let pkCli_4438: bitstring = pub(skB) in
                                    {4241}let v_4439: bool = (Sess_4227 = A) in
                                    (
                                        {4242}if v_4439 then
                                        (
                                            {4243}let pkSess_4440: bitstring = pub(skA) in
                                            {4244}in(c, =GetEndpointRequest);
                                            {4245}new SP_4441: bitstring;
                                            {4246}new UP_4442: bitstring;
                                            {4247}out(c, (GetEndpointResponse,pkSess_4440,Sign,SP_4441,UP_4442))
                                        )
                                        else
                                            {4248}let v_4443: bool = (Sess_4227 = B) in
                                            (
                                                {4249}if v_4443 then
                                                (
                                                    {4250}let pkSess_4444: bitstring = pub(skB) in
                                                    {4251}in(c, =GetEndpointRequest);
                                                    {4252}new SP_4445: bitstring;
                                                    {4253}new UP_4446: bitstring;
                                                    {4254}out(c, (GetEndpointResponse,pkSess_4444,Sign,SP_4445,UP_4446))
                                                )
                                                else
                                                    {4255}let v_4447: bool = (Sess_4227 = C) in
                                                    (
                                                        {4256}if v_4447 then
                                                        (
                                                            {4257}let pkSess_4448: bitstring = pub(skC) in
                                                            {4258}in(c, =GetEndpointRequest);
                                                            {4259}new SP_4449: bitstring;
                                                            {4260}new UP_4450: bitstring;
                                                            {4261}out(c, (GetEndpointResponse,pkSess_4448,Sign,SP_4449,UP_4450))
                                                        )
                                                        else
                                                            {4262}let pkSess_4451: bitstring = pub(sk(Sess_4227)) in
                                                            {4263}in(c, =GetEndpointRequest);
                                                            {4264}new SP_4452: bitstring;
                                                            {4265}new UP_4453: bitstring;
                                                            {4266}out(c, (GetEndpointResponse,pkSess_4451,Sign,SP_4452,UP_4453))
                                                    )
                                                    else
                                                        {4267}let pkSess_4454: bitstring = fail-any in
                                                        {4268}in(c, =GetEndpointRequest);
                                                        {4269}new SP_4455: bitstring;
                                                        {4270}new UP_4456: bitstring;
                                                        {4271}out(c, (GetEndpointResponse,pkSess_4454,Sign,SP_4455,UP_4456))
                                            )
                                            else
                                                {4272}let pkSess_4457: bitstring = fail-any in
                                                {4273}in(c, =GetEndpointRequest);
                                                {4274}new SP_4458: bitstring;
                                                {4275}new UP_4459: bitstring;
                                                {4276}out(c, (GetEndpointResponse,pkSess_4457,Sign,SP_4458,UP_4459))
                                    )
                                    else
                                        {4277}let pkSess_4460: bitstring = fail-any in
                                        {4278}in(c, =GetEndpointRequest);
                                        {4279}new SP_4461: bitstring;
                                        {4280}new UP_4462: bitstring;
                                        {4281}out(c, (GetEndpointResponse,pkSess_4460,Sign,SP_4461,UP_4462))
                                )
                                else
                                    {4282}let v_4463: bool = (Cli_4225 = C) in
                                    (
                                        {4283}if v_4463 then
                                        (
                                            {4284}let pkCli_4464: bitstring = pub(skC) in
                                            {4285}let v_4465: bool = (Sess_4227 = A) in
                                            (
                                                {4286}if v_4465 then
                                                (
                                                    {4287}let pkSess_4466: bitstring = pub(skA) in
                                                    {4288}in(c, =GetEndpointRequest);
                                                    {4289}new SP_4467: bitstring;
                                                    {4290}new UP_4468: bitstring;
                                                    {4291}out(c, (GetEndpointResponse,pkSess_4466,Sign,SP_4467,UP_4468))
                                                )
                                                else
                                                    {4292}let v_4469: bool = (Sess_4227 = B) in
                                                    (
                                                        {4293}if v_4469 then
                                                        (
                                                            {4294}let pkSess_4470: bitstring = pub(skB) in
                                                            {4295}in(c, =GetEndpointRequest);
                                                            {4296}new SP_4471: bitstring;
                                                            {4297}new UP_4472: bitstring;
                                                            {4298}out(c, (GetEndpointResponse,pkSess_4470,Sign,SP_4471,UP_4472))
                                                        )
                                                        else
                                                            {4299}let v_4473: bool = (Sess_4227 = C) in
                                                            (
                                                                {4300}if v_4473 then
                                                                (
                                                                    {4301}let pkSess_4474: bitstring = pub(skC) in
                                                                    {4302}in(c, =GetEndpointRequest);
                                                                    {4303}new SP_4475: bitstring;
                                                                    {4304}new UP_4476: bitstring;
                                                                    {4305}out(c, (GetEndpointResponse,pkSess_4474,Sign,SP_4475,UP_4476))
                                                                )
                                                                else
                                                                    {4306}let pkSess_4477: bitstring = pub(sk(Sess_4227)) in
                                                                    {4307}in(c, =GetEndpointRequest);
                                                                    {4308}new SP_4478: bitstring;
                                                                    {4309}new UP_4479: bitstring;
                                                                    {4310}out(c, (GetEndpointResponse,pkSess_4477,Sign,SP_4478,UP_4479))
                                                            )
                                                            else
                                                                {4311}let pkSess_4480: bitstring = fail-any in
                                                                {4312}in(c, =GetEndpointRequest);
                                                                {4313}new SP_4481: bitstring;
                                                                {4314}new UP_4482: bitstring;
                                                                {4315}out(c, (GetEndpointResponse,pkSess_4480,Sign,SP_4481,UP_4482))
                                                    )
                                                    else
                                                        {4316}let pkSess_4483: bitstring = fail-any in
                                                        {4317}in(c, =GetEndpointRequest);
                                                        {4318}new SP_4484: bitstring;
                                                        {4319}new UP_4485: bitstring;
                                                        {4320}out(c, (GetEndpointResponse,pkSess_4483,Sign,SP_4484,UP_4485))
                                            )
                                            else
                                                {4321}let pkSess_4486: bitstring = fail-any in
                                                {4322}in(c, =GetEndpointRequest);
                                                {4323}new SP_4487: bitstring;
                                                {4324}new UP_4488: bitstring;
                                                {4325}out(c, (GetEndpointResponse,pkSess_4486,Sign,SP_4487,UP_4488))
                                        )
                                        else
                                            {4326}let pkCli_4489: bitstring = pub(sk(Cli_4225)) in
                                            {4327}let v_4490: bool = (Sess_4227 = A) in
                                            (
                                                {4328}if v_4490 then
                                                (
                                                    {4329}let pkSess_4491: bitstring = pub(skA) in
                                                    {4330}in(c, =GetEndpointRequest);
                                                    {4331}new SP_4492: bitstring;
                                                    {4332}new UP_4493: bitstring;
                                                    {4333}out(c, (GetEndpointResponse,pkSess_4491,Sign,SP_4492,UP_4493))
                                                )
                                                else
                                                    {4334}let v_4494: bool = (Sess_4227 = B) in
                                                    (
                                                        {4335}if v_4494 then
                                                        (
                                                            {4336}let pkSess_4495: bitstring = pub(skB) in
                                                            {4337}in(c, =GetEndpointRequest);
                                                            {4338}new SP_4496: bitstring;
                                                            {4339}new UP_4497: bitstring;
                                                            {4340}out(c, (GetEndpointResponse,pkSess_4495,Sign,SP_4496,UP_4497))
                                                        )
                                                        else
                                                            {4341}let v_4498: bool = (Sess_4227 = C) in
                                                            (
                                                                {4342}if v_4498 then
                                                                (
                                                                    {4343}let pkSess_4499: bitstring = pub(skC) in
                                                                    {4344}in(c, =GetEndpointRequest);
                                                                    {4345}new SP_4500: bitstring;
                                                                    {4346}new UP_4501: bitstring;
                                                                    {4347}out(c, (GetEndpointResponse,pkSess_4499,Sign,SP_4500,UP_4501))
                                                                )
                                                                else
                                                                    {4348}let pkSess_4502: bitstring = pub(sk(Sess_4227)) in
                                                                    {4349}in(c, =GetEndpointRequest);
                                                                    {4350}new SP_4503: bitstring;
                                                                    {4351}new UP_4504: bitstring;
                                                                    {4352}out(c, (GetEndpointResponse,pkSess_4502,Sign,SP_4503,UP_4504))
                                                            )
                                                            else
                                                                {4353}let pkSess_4505: bitstring = fail-any in
                                                                {4354}in(c, =GetEndpointRequest);
                                                                {4355}new SP_4506: bitstring;
                                                                {4356}new UP_4507: bitstring;
                                                                {4357}out(c, (GetEndpointResponse,pkSess_4505,Sign,SP_4506,UP_4507))
                                                    )
                                                    else
                                                        {4358}let pkSess_4508: bitstring = fail-any in
                                                        {4359}in(c, =GetEndpointRequest);
                                                        {4360}new SP_4509: bitstring;
                                                        {4361}new UP_4510: bitstring;
                                                        {4362}out(c, (GetEndpointResponse,pkSess_4508,Sign,SP_4509,UP_4510))
                                            )
                                            else
                                                {4363}let pkSess_4511: bitstring = fail-any in
                                                {4364}in(c, =GetEndpointRequest);
                                                {4365}new SP_4512: bitstring;
                                                {4366}new UP_4513: bitstring;
                                                {4367}out(c, (GetEndpointResponse,pkSess_4511,Sign,SP_4512,UP_4513))
                                    )
                                    else
                                        {4368}let pkCli_4514: bitstring = fail-any in
                                        {4369}let v_4515: bool = (Sess_4227 = A) in
                                        (
                                            {4370}if v_4515 then
                                            (
                                                {4371}let pkSess_4516: bitstring = pub(skA) in
                                                {4372}in(c, =GetEndpointRequest);
                                                {4373}new SP_4517: bitstring;
                                                {4374}new UP_4518: bitstring;
                                                {4375}out(c, (GetEndpointResponse,pkSess_4516,Sign,SP_4517,UP_4518))
                                            )
                                            else
                                                {4376}let v_4519: bool = (Sess_4227 = B) in
                                                (
                                                    {4377}if v_4519 then
                                                    (
                                                        {4378}let pkSess_4520: bitstring = pub(skB) in
                                                        {4379}in(c, =GetEndpointRequest);
                                                        {4380}new SP_4521: bitstring;
                                                        {4381}new UP_4522: bitstring;
                                                        {4382}out(c, (GetEndpointResponse,pkSess_4520,Sign,SP_4521,UP_4522))
                                                    )
                                                    else
                                                        {4383}let v_4523: bool = (Sess_4227 = C) in
                                                        (
                                                            {4384}if v_4523 then
                                                            (
                                                                {4385}let pkSess_4524: bitstring = pub(skC) in
                                                                {4386}in(c, =GetEndpointRequest);
                                                                {4387}new SP_4525: bitstring;
                                                                {4388}new UP_4526: bitstring;
                                                                {4389}out(c, (GetEndpointResponse,pkSess_4524,Sign,SP_4525,UP_4526))
                                                            )
                                                            else
                                                                {4390}let pkSess_4527: bitstring = pub(sk(Sess_4227)) in
                                                                {4391}in(c, =GetEndpointRequest);
                                                                {4392}new SP_4528: bitstring;
                                                                {4393}new UP_4529: bitstring;
                                                                {4394}out(c, (GetEndpointResponse,pkSess_4527,Sign,SP_4528,UP_4529))
                                                        )
                                                        else
                                                            {4395}let pkSess_4530: bitstring = fail-any in
                                                            {4396}in(c, =GetEndpointRequest);
                                                            {4397}new SP_4531: bitstring;
                                                            {4398}new UP_4532: bitstring;
                                                            {4399}out(c, (GetEndpointResponse,pkSess_4530,Sign,SP_4531,UP_4532))
                                                )
                                                else
                                                    {4400}let pkSess_4533: bitstring = fail-any in
                                                    {4401}in(c, =GetEndpointRequest);
                                                    {4402}new SP_4534: bitstring;
                                                    {4403}new UP_4535: bitstring;
                                                    {4404}out(c, (GetEndpointResponse,pkSess_4533,Sign,SP_4534,UP_4535))
                                        )
                                        else
                                            {4405}let pkSess_4536: bitstring = fail-any in
                                            {4406}in(c, =GetEndpointRequest);
                                            {4407}new SP_4537: bitstring;
                                            {4408}new UP_4538: bitstring;
                                            {4409}out(c, (GetEndpointResponse,pkSess_4536,Sign,SP_4537,UP_4538))
                            )
                            else
                                {4410}let pkCli_4539: bitstring = fail-any in
                                {4411}let v_4540: bool = (Sess_4227 = A) in
                                (
                                    {4412}if v_4540 then
                                    (
                                        {4413}let pkSess_4541: bitstring = pub(skA) in
                                        {4414}in(c, =GetEndpointRequest);
                                        {4415}new SP_4542: bitstring;
                                        {4416}new UP_4543: bitstring;
                                        {4417}out(c, (GetEndpointResponse,pkSess_4541,Sign,SP_4542,UP_4543))
                                    )
                                    else
                                        {4418}let v_4544: bool = (Sess_4227 = B) in
                                        (
                                            {4419}if v_4544 then
                                            (
                                                {4420}let pkSess_4545: bitstring = pub(skB) in
                                                {4421}in(c, =GetEndpointRequest);
                                                {4422}new SP_4546: bitstring;
                                                {4423}new UP_4547: bitstring;
                                                {4424}out(c, (GetEndpointResponse,pkSess_4545,Sign,SP_4546,UP_4547))
                                            )
                                            else
                                                {4425}let v_4548: bool = (Sess_4227 = C) in
                                                (
                                                    {4426}if v_4548 then
                                                    (
                                                        {4427}let pkSess_4549: bitstring = pub(skC) in
                                                        {4428}in(c, =GetEndpointRequest);
                                                        {4429}new SP_4550: bitstring;
                                                        {4430}new UP_4551: bitstring;
                                                        {4431}out(c, (GetEndpointResponse,pkSess_4549,Sign,SP_4550,UP_4551))
                                                    )
                                                    else
                                                        {4432}let pkSess_4552: bitstring = pub(sk(Sess_4227)) in
                                                        {4433}in(c, =GetEndpointRequest);
                                                        {4434}new SP_4553: bitstring;
                                                        {4435}new UP_4554: bitstring;
                                                        {4436}out(c, (GetEndpointResponse,pkSess_4552,Sign,SP_4553,UP_4554))
                                                )
                                                else
                                                    {4437}let pkSess_4555: bitstring = fail-any in
                                                    {4438}in(c, =GetEndpointRequest);
                                                    {4439}new SP_4556: bitstring;
                                                    {4440}new UP_4557: bitstring;
                                                    {4441}out(c, (GetEndpointResponse,pkSess_4555,Sign,SP_4556,UP_4557))
                                        )
                                        else
                                            {4442}let pkSess_4558: bitstring = fail-any in
                                            {4443}in(c, =GetEndpointRequest);
                                            {4444}new SP_4559: bitstring;
                                            {4445}new UP_4560: bitstring;
                                            {4446}out(c, (GetEndpointResponse,pkSess_4558,Sign,SP_4559,UP_4560))
                                )
                                else
                                    {4447}let pkSess_4561: bitstring = fail-any in
                                    {4448}in(c, =GetEndpointRequest);
                                    {4449}new SP_4562: bitstring;
                                    {4450}new UP_4563: bitstring;
                                    {4451}out(c, (GetEndpointResponse,pkSess_4561,Sign,SP_4562,UP_4563))
                    )
                    else
                        {4452}let pkCli_4564: bitstring = fail-any in
                        {4453}let v_4565: bool = (Sess_4227 = A) in
                        (
                            {4454}if v_4565 then
                            (
                                {4455}let pkSess_4566: bitstring = pub(skA) in
                                {4456}in(c, =GetEndpointRequest);
                                {4457}new SP_4567: bitstring;
                                {4458}new UP_4568: bitstring;
                                {4459}out(c, (GetEndpointResponse,pkSess_4566,Sign,SP_4567,UP_4568))
                            )
                            else
                                {4460}let v_4569: bool = (Sess_4227 = B) in
                                (
                                    {4461}if v_4569 then
                                    (
                                        {4462}let pkSess_4570: bitstring = pub(skB) in
                                        {4463}in(c, =GetEndpointRequest);
                                        {4464}new SP_4571: bitstring;
                                        {4465}new UP_4572: bitstring;
                                        {4466}out(c, (GetEndpointResponse,pkSess_4570,Sign,SP_4571,UP_4572))
                                    )
                                    else
                                        {4467}let v_4573: bool = (Sess_4227 = C) in
                                        (
                                            {4468}if v_4573 then
                                            (
                                                {4469}let pkSess_4574: bitstring = pub(skC) in
                                                {4470}in(c, =GetEndpointRequest);
                                                {4471}new SP_4575: bitstring;
                                                {4472}new UP_4576: bitstring;
                                                {4473}out(c, (GetEndpointResponse,pkSess_4574,Sign,SP_4575,UP_4576))
                                            )
                                            else
                                                {4474}let pkSess_4577: bitstring = pub(sk(Sess_4227)) in
                                                {4475}in(c, =GetEndpointRequest);
                                                {4476}new SP_4578: bitstring;
                                                {4477}new UP_4579: bitstring;
                                                {4478}out(c, (GetEndpointResponse,pkSess_4577,Sign,SP_4578,UP_4579))
                                        )
                                        else
                                            {4479}let pkSess_4580: bitstring = fail-any in
                                            {4480}in(c, =GetEndpointRequest);
                                            {4481}new SP_4581: bitstring;
                                            {4482}new UP_4582: bitstring;
                                            {4483}out(c, (GetEndpointResponse,pkSess_4580,Sign,SP_4581,UP_4582))
                                )
                                else
                                    {4484}let pkSess_4583: bitstring = fail-any in
                                    {4485}in(c, =GetEndpointRequest);
                                    {4486}new SP_4584: bitstring;
                                    {4487}new UP_4585: bitstring;
                                    {4488}out(c, (GetEndpointResponse,pkSess_4583,Sign,SP_4584,UP_4585))
                        )
                        else
                            {4489}let pkSess_4586: bitstring = fail-any in
                            {4490}in(c, =GetEndpointRequest);
                            {4491}new SP_4587: bitstring;
                            {4492}new UP_4588: bitstring;
                            {4493}out(c, (GetEndpointResponse,pkSess_4586,Sign,SP_4587,UP_4588))
                )
                else
                    {4494}let =true = (Disco_4226 = C) in
                    (
                        {4495}let skDisco_4589: bitstring = skC in
                        {4496}let pkDisco_4590: bitstring = pub(skDisco_4589) in
                        {4497}let v_4591: bool = (Cli_4225 = A) in
                        (
                            {4498}if v_4591 then
                            (
                                {4499}let pkCli_4592: bitstring = pub(skA) in
                                {4500}let v_4593: bool = (Sess_4227 = A) in
                                (
                                    {4501}if v_4593 then
                                    (
                                        {4502}let pkSess_4594: bitstring = pub(skA) in
                                        {4503}in(c, =GetEndpointRequest);
                                        {4504}new SP_4595: bitstring;
                                        {4505}new UP_4596: bitstring;
                                        {4506}out(c, (GetEndpointResponse,pkSess_4594,Sign,SP_4595,UP_4596))
                                    )
                                    else
                                        {4507}let v_4597: bool = (Sess_4227 = B) in
                                        (
                                            {4508}if v_4597 then
                                            (
                                                {4509}let pkSess_4598: bitstring = pub(skB) in
                                                {4510}in(c, =GetEndpointRequest);
                                                {4511}new SP_4599: bitstring;
                                                {4512}new UP_4600: bitstring;
                                                {4513}out(c, (GetEndpointResponse,pkSess_4598,Sign,SP_4599,UP_4600))
                                            )
                                            else
                                                {4514}let v_4601: bool = (Sess_4227 = C) in
                                                (
                                                    {4515}if v_4601 then
                                                    (
                                                        {4516}let pkSess_4602: bitstring = pub(skC) in
                                                        {4517}in(c, =GetEndpointRequest);
                                                        {4518}new SP_4603: bitstring;
                                                        {4519}new UP_4604: bitstring;
                                                        {4520}out(c, (GetEndpointResponse,pkSess_4602,Sign,SP_4603,UP_4604))
                                                    )
                                                    else
                                                        {4521}let pkSess_4605: bitstring = pub(sk(Sess_4227)) in
                                                        {4522}in(c, =GetEndpointRequest);
                                                        {4523}new SP_4606: bitstring;
                                                        {4524}new UP_4607: bitstring;
                                                        {4525}out(c, (GetEndpointResponse,pkSess_4605,Sign,SP_4606,UP_4607))
                                                )
                                                else
                                                    {4526}let pkSess_4608: bitstring = fail-any in
                                                    {4527}in(c, =GetEndpointRequest);
                                                    {4528}new SP_4609: bitstring;
                                                    {4529}new UP_4610: bitstring;
                                                    {4530}out(c, (GetEndpointResponse,pkSess_4608,Sign,SP_4609,UP_4610))
                                        )
                                        else
                                            {4531}let pkSess_4611: bitstring = fail-any in
                                            {4532}in(c, =GetEndpointRequest);
                                            {4533}new SP_4612: bitstring;
                                            {4534}new UP_4613: bitstring;
                                            {4535}out(c, (GetEndpointResponse,pkSess_4611,Sign,SP_4612,UP_4613))
                                )
                                else
                                    {4536}let pkSess_4614: bitstring = fail-any in
                                    {4537}in(c, =GetEndpointRequest);
                                    {4538}new SP_4615: bitstring;
                                    {4539}new UP_4616: bitstring;
                                    {4540}out(c, (GetEndpointResponse,pkSess_4614,Sign,SP_4615,UP_4616))
                            )
                            else
                                {4541}let v_4617: bool = (Cli_4225 = B) in
                                (
                                    {4542}if v_4617 then
                                    (
                                        {4543}let pkCli_4618: bitstring = pub(skB) in
                                        {4544}let v_4619: bool = (Sess_4227 = A) in
                                        (
                                            {4545}if v_4619 then
                                            (
                                                {4546}let pkSess_4620: bitstring = pub(skA) in
                                                {4547}in(c, =GetEndpointRequest);
                                                {4548}new SP_4621: bitstring;
                                                {4549}new UP_4622: bitstring;
                                                {4550}out(c, (GetEndpointResponse,pkSess_4620,Sign,SP_4621,UP_4622))
                                            )
                                            else
                                                {4551}let v_4623: bool = (Sess_4227 = B) in
                                                (
                                                    {4552}if v_4623 then
                                                    (
                                                        {4553}let pkSess_4624: bitstring = pub(skB) in
                                                        {4554}in(c, =GetEndpointRequest);
                                                        {4555}new SP_4625: bitstring;
                                                        {4556}new UP_4626: bitstring;
                                                        {4557}out(c, (GetEndpointResponse,pkSess_4624,Sign,SP_4625,UP_4626))
                                                    )
                                                    else
                                                        {4558}let v_4627: bool = (Sess_4227 = C) in
                                                        (
                                                            {4559}if v_4627 then
                                                            (
                                                                {4560}let pkSess_4628: bitstring = pub(skC) in
                                                                {4561}in(c, =GetEndpointRequest);
                                                                {4562}new SP_4629: bitstring;
                                                                {4563}new UP_4630: bitstring;
                                                                {4564}out(c, (GetEndpointResponse,pkSess_4628,Sign,SP_4629,UP_4630))
                                                            )
                                                            else
                                                                {4565}let pkSess_4631: bitstring = pub(sk(Sess_4227)) in
                                                                {4566}in(c, =GetEndpointRequest);
                                                                {4567}new SP_4632: bitstring;
                                                                {4568}new UP_4633: bitstring;
                                                                {4569}out(c, (GetEndpointResponse,pkSess_4631,Sign,SP_4632,UP_4633))
                                                        )
                                                        else
                                                            {4570}let pkSess_4634: bitstring = fail-any in
                                                            {4571}in(c, =GetEndpointRequest);
                                                            {4572}new SP_4635: bitstring;
                                                            {4573}new UP_4636: bitstring;
                                                            {4574}out(c, (GetEndpointResponse,pkSess_4634,Sign,SP_4635,UP_4636))
                                                )
                                                else
                                                    {4575}let pkSess_4637: bitstring = fail-any in
                                                    {4576}in(c, =GetEndpointRequest);
                                                    {4577}new SP_4638: bitstring;
                                                    {4578}new UP_4639: bitstring;
                                                    {4579}out(c, (GetEndpointResponse,pkSess_4637,Sign,SP_4638,UP_4639))
                                        )
                                        else
                                            {4580}let pkSess_4640: bitstring = fail-any in
                                            {4581}in(c, =GetEndpointRequest);
                                            {4582}new SP_4641: bitstring;
                                            {4583}new UP_4642: bitstring;
                                            {4584}out(c, (GetEndpointResponse,pkSess_4640,Sign,SP_4641,UP_4642))
                                    )
                                    else
                                        {4585}let v_4643: bool = (Cli_4225 = C) in
                                        (
                                            {4586}if v_4643 then
                                            (
                                                {4587}let pkCli_4644: bitstring = pub(skC) in
                                                {4588}let v_4645: bool = (Sess_4227 = A) in
                                                (
                                                    {4589}if v_4645 then
                                                    (
                                                        {4590}let pkSess_4646: bitstring = pub(skA) in
                                                        {4591}in(c, =GetEndpointRequest);
                                                        {4592}new SP_4647: bitstring;
                                                        {4593}new UP_4648: bitstring;
                                                        {4594}out(c, (GetEndpointResponse,pkSess_4646,Sign,SP_4647,UP_4648))
                                                    )
                                                    else
                                                        {4595}let v_4649: bool = (Sess_4227 = B) in
                                                        (
                                                            {4596}if v_4649 then
                                                            (
                                                                {4597}let pkSess_4650: bitstring = pub(skB) in
                                                                {4598}in(c, =GetEndpointRequest);
                                                                {4599}new SP_4651: bitstring;
                                                                {4600}new UP_4652: bitstring;
                                                                {4601}out(c, (GetEndpointResponse,pkSess_4650,Sign,SP_4651,UP_4652))
                                                            )
                                                            else
                                                                {4602}let v_4653: bool = (Sess_4227 = C) in
                                                                (
                                                                    {4603}if v_4653 then
                                                                    (
                                                                        {4604}let pkSess_4654: bitstring = pub(skC) in
                                                                        {4605}in(c, =GetEndpointRequest);
                                                                        {4606}new SP_4655: bitstring;
                                                                        {4607}new UP_4656: bitstring;
                                                                        {4608}out(c, (GetEndpointResponse,pkSess_4654,Sign,SP_4655,UP_4656))
                                                                    )
                                                                    else
                                                                        {4609}let pkSess_4657: bitstring = pub(sk(Sess_4227)) in
                                                                        {4610}in(c, =GetEndpointRequest);
                                                                        {4611}new SP_4658: bitstring;
                                                                        {4612}new UP_4659: bitstring;
                                                                        {4613}out(c, (GetEndpointResponse,pkSess_4657,Sign,SP_4658,UP_4659))
                                                                )
                                                                else
                                                                    {4614}let pkSess_4660: bitstring = fail-any in
                                                                    {4615}in(c, =GetEndpointRequest);
                                                                    {4616}new SP_4661: bitstring;
                                                                    {4617}new UP_4662: bitstring;
                                                                    {4618}out(c, (GetEndpointResponse,pkSess_4660,Sign,SP_4661,UP_4662))
                                                        )
                                                        else
                                                            {4619}let pkSess_4663: bitstring = fail-any in
                                                            {4620}in(c, =GetEndpointRequest);
                                                            {4621}new SP_4664: bitstring;
                                                            {4622}new UP_4665: bitstring;
                                                            {4623}out(c, (GetEndpointResponse,pkSess_4663,Sign,SP_4664,UP_4665))
                                                )
                                                else
                                                    {4624}let pkSess_4666: bitstring = fail-any in
                                                    {4625}in(c, =GetEndpointRequest);
                                                    {4626}new SP_4667: bitstring;
                                                    {4627}new UP_4668: bitstring;
                                                    {4628}out(c, (GetEndpointResponse,pkSess_4666,Sign,SP_4667,UP_4668))
                                            )
                                            else
                                                {4629}let pkCli_4669: bitstring = pub(sk(Cli_4225)) in
                                                {4630}let v_4670: bool = (Sess_4227 = A) in
                                                (
                                                    {4631}if v_4670 then
                                                    (
                                                        {4632}let pkSess_4671: bitstring = pub(skA) in
                                                        {4633}in(c, =GetEndpointRequest);
                                                        {4634}new SP_4672: bitstring;
                                                        {4635}new UP_4673: bitstring;
                                                        {4636}out(c, (GetEndpointResponse,pkSess_4671,Sign,SP_4672,UP_4673))
                                                    )
                                                    else
                                                        {4637}let v_4674: bool = (Sess_4227 = B) in
                                                        (
                                                            {4638}if v_4674 then
                                                            (
                                                                {4639}let pkSess_4675: bitstring = pub(skB) in
                                                                {4640}in(c, =GetEndpointRequest);
                                                                {4641}new SP_4676: bitstring;
                                                                {4642}new UP_4677: bitstring;
                                                                {4643}out(c, (GetEndpointResponse,pkSess_4675,Sign,SP_4676,UP_4677))
                                                            )
                                                            else
                                                                {4644}let v_4678: bool = (Sess_4227 = C) in
                                                                (
                                                                    {4645}if v_4678 then
                                                                    (
                                                                        {4646}let pkSess_4679: bitstring = pub(skC) in
                                                                        {4647}in(c, =GetEndpointRequest);
                                                                        {4648}new SP_4680: bitstring;
                                                                        {4649}new UP_4681: bitstring;
                                                                        {4650}out(c, (GetEndpointResponse,pkSess_4679,Sign,SP_4680,UP_4681))
                                                                    )
                                                                    else
                                                                        {4651}let pkSess_4682: bitstring = pub(sk(Sess_4227)) in
                                                                        {4652}in(c, =GetEndpointRequest);
                                                                        {4653}new SP_4683: bitstring;
                                                                        {4654}new UP_4684: bitstring;
                                                                        {4655}out(c, (GetEndpointResponse,pkSess_4682,Sign,SP_4683,UP_4684))
                                                                )
                                                                else
                                                                    {4656}let pkSess_4685: bitstring = fail-any in
                                                                    {4657}in(c, =GetEndpointRequest);
                                                                    {4658}new SP_4686: bitstring;
                                                                    {4659}new UP_4687: bitstring;
                                                                    {4660}out(c, (GetEndpointResponse,pkSess_4685,Sign,SP_4686,UP_4687))
                                                        )
                                                        else
                                                            {4661}let pkSess_4688: bitstring = fail-any in
                                                            {4662}in(c, =GetEndpointRequest);
                                                            {4663}new SP_4689: bitstring;
                                                            {4664}new UP_4690: bitstring;
                                                            {4665}out(c, (GetEndpointResponse,pkSess_4688,Sign,SP_4689,UP_4690))
                                                )
                                                else
                                                    {4666}let pkSess_4691: bitstring = fail-any in
                                                    {4667}in(c, =GetEndpointRequest);
                                                    {4668}new SP_4692: bitstring;
                                                    {4669}new UP_4693: bitstring;
                                                    {4670}out(c, (GetEndpointResponse,pkSess_4691,Sign,SP_4692,UP_4693))
                                        )
                                        else
                                            {4671}let pkCli_4694: bitstring = fail-any in
                                            {4672}let v_4695: bool = (Sess_4227 = A) in
                                            (
                                                {4673}if v_4695 then
                                                (
                                                    {4674}let pkSess_4696: bitstring = pub(skA) in
                                                    {4675}in(c, =GetEndpointRequest);
                                                    {4676}new SP_4697: bitstring;
                                                    {4677}new UP_4698: bitstring;
                                                    {4678}out(c, (GetEndpointResponse,pkSess_4696,Sign,SP_4697,UP_4698))
                                                )
                                                else
                                                    {4679}let v_4699: bool = (Sess_4227 = B) in
                                                    (
                                                        {4680}if v_4699 then
                                                        (
                                                            {4681}let pkSess_4700: bitstring = pub(skB) in
                                                            {4682}in(c, =GetEndpointRequest);
                                                            {4683}new SP_4701: bitstring;
                                                            {4684}new UP_4702: bitstring;
                                                            {4685}out(c, (GetEndpointResponse,pkSess_4700,Sign,SP_4701,UP_4702))
                                                        )
                                                        else
                                                            {4686}let v_4703: bool = (Sess_4227 = C) in
                                                            (
                                                                {4687}if v_4703 then
                                                                (
                                                                    {4688}let pkSess_4704: bitstring = pub(skC) in
                                                                    {4689}in(c, =GetEndpointRequest);
                                                                    {4690}new SP_4705: bitstring;
                                                                    {4691}new UP_4706: bitstring;
                                                                    {4692}out(c, (GetEndpointResponse,pkSess_4704,Sign,SP_4705,UP_4706))
                                                                )
                                                                else
                                                                    {4693}let pkSess_4707: bitstring = pub(sk(Sess_4227)) in
                                                                    {4694}in(c, =GetEndpointRequest);
                                                                    {4695}new SP_4708: bitstring;
                                                                    {4696}new UP_4709: bitstring;
                                                                    {4697}out(c, (GetEndpointResponse,pkSess_4707,Sign,SP_4708,UP_4709))
                                                            )
                                                            else
                                                                {4698}let pkSess_4710: bitstring = fail-any in
                                                                {4699}in(c, =GetEndpointRequest);
                                                                {4700}new SP_4711: bitstring;
                                                                {4701}new UP_4712: bitstring;
                                                                {4702}out(c, (GetEndpointResponse,pkSess_4710,Sign,SP_4711,UP_4712))
                                                    )
                                                    else
                                                        {4703}let pkSess_4713: bitstring = fail-any in
                                                        {4704}in(c, =GetEndpointRequest);
                                                        {4705}new SP_4714: bitstring;
                                                        {4706}new UP_4715: bitstring;
                                                        {4707}out(c, (GetEndpointResponse,pkSess_4713,Sign,SP_4714,UP_4715))
                                            )
                                            else
                                                {4708}let pkSess_4716: bitstring = fail-any in
                                                {4709}in(c, =GetEndpointRequest);
                                                {4710}new SP_4717: bitstring;
                                                {4711}new UP_4718: bitstring;
                                                {4712}out(c, (GetEndpointResponse,pkSess_4716,Sign,SP_4717,UP_4718))
                                )
                                else
                                    {4713}let pkCli_4719: bitstring = fail-any in
                                    {4714}let v_4720: bool = (Sess_4227 = A) in
                                    (
                                        {4715}if v_4720 then
                                        (
                                            {4716}let pkSess_4721: bitstring = pub(skA) in
                                            {4717}in(c, =GetEndpointRequest);
                                            {4718}new SP_4722: bitstring;
                                            {4719}new UP_4723: bitstring;
                                            {4720}out(c, (GetEndpointResponse,pkSess_4721,Sign,SP_4722,UP_4723))
                                        )
                                        else
                                            {4721}let v_4724: bool = (Sess_4227 = B) in
                                            (
                                                {4722}if v_4724 then
                                                (
                                                    {4723}let pkSess_4725: bitstring = pub(skB) in
                                                    {4724}in(c, =GetEndpointRequest);
                                                    {4725}new SP_4726: bitstring;
                                                    {4726}new UP_4727: bitstring;
                                                    {4727}out(c, (GetEndpointResponse,pkSess_4725,Sign,SP_4726,UP_4727))
                                                )
                                                else
                                                    {4728}let v_4728: bool = (Sess_4227 = C) in
                                                    (
                                                        {4729}if v_4728 then
                                                        (
                                                            {4730}let pkSess_4729: bitstring = pub(skC) in
                                                            {4731}in(c, =GetEndpointRequest);
                                                            {4732}new SP_4730: bitstring;
                                                            {4733}new UP_4731: bitstring;
                                                            {4734}out(c, (GetEndpointResponse,pkSess_4729,Sign,SP_4730,UP_4731))
                                                        )
                                                        else
                                                            {4735}let pkSess_4732: bitstring = pub(sk(Sess_4227)) in
                                                            {4736}in(c, =GetEndpointRequest);
                                                            {4737}new SP_4733: bitstring;
                                                            {4738}new UP_4734: bitstring;
                                                            {4739}out(c, (GetEndpointResponse,pkSess_4732,Sign,SP_4733,UP_4734))
                                                    )
                                                    else
                                                        {4740}let pkSess_4735: bitstring = fail-any in
                                                        {4741}in(c, =GetEndpointRequest);
                                                        {4742}new SP_4736: bitstring;
                                                        {4743}new UP_4737: bitstring;
                                                        {4744}out(c, (GetEndpointResponse,pkSess_4735,Sign,SP_4736,UP_4737))
                                            )
                                            else
                                                {4745}let pkSess_4738: bitstring = fail-any in
                                                {4746}in(c, =GetEndpointRequest);
                                                {4747}new SP_4739: bitstring;
                                                {4748}new UP_4740: bitstring;
                                                {4749}out(c, (GetEndpointResponse,pkSess_4738,Sign,SP_4739,UP_4740))
                                    )
                                    else
                                        {4750}let pkSess_4741: bitstring = fail-any in
                                        {4751}in(c, =GetEndpointRequest);
                                        {4752}new SP_4742: bitstring;
                                        {4753}new UP_4743: bitstring;
                                        {4754}out(c, (GetEndpointResponse,pkSess_4741,Sign,SP_4742,UP_4743))
                        )
                        else
                            {4755}let pkCli_4744: bitstring = fail-any in
                            {4756}let v_4745: bool = (Sess_4227 = A) in
                            (
                                {4757}if v_4745 then
                                (
                                    {4758}let pkSess_4746: bitstring = pub(skA) in
                                    {4759}in(c, =GetEndpointRequest);
                                    {4760}new SP_4747: bitstring;
                                    {4761}new UP_4748: bitstring;
                                    {4762}out(c, (GetEndpointResponse,pkSess_4746,Sign,SP_4747,UP_4748))
                                )
                                else
                                    {4763}let v_4749: bool = (Sess_4227 = B) in
                                    (
                                        {4764}if v_4749 then
                                        (
                                            {4765}let pkSess_4750: bitstring = pub(skB) in
                                            {4766}in(c, =GetEndpointRequest);
                                            {4767}new SP_4751: bitstring;
                                            {4768}new UP_4752: bitstring;
                                            {4769}out(c, (GetEndpointResponse,pkSess_4750,Sign,SP_4751,UP_4752))
                                        )
                                        else
                                            {4770}let v_4753: bool = (Sess_4227 = C) in
                                            (
                                                {4771}if v_4753 then
                                                (
                                                    {4772}let pkSess_4754: bitstring = pub(skC) in
                                                    {4773}in(c, =GetEndpointRequest);
                                                    {4774}new SP_4755: bitstring;
                                                    {4775}new UP_4756: bitstring;
                                                    {4776}out(c, (GetEndpointResponse,pkSess_4754,Sign,SP_4755,UP_4756))
                                                )
                                                else
                                                    {4777}let pkSess_4757: bitstring = pub(sk(Sess_4227)) in
                                                    {4778}in(c, =GetEndpointRequest);
                                                    {4779}new SP_4758: bitstring;
                                                    {4780}new UP_4759: bitstring;
                                                    {4781}out(c, (GetEndpointResponse,pkSess_4757,Sign,SP_4758,UP_4759))
                                            )
                                            else
                                                {4782}let pkSess_4760: bitstring = fail-any in
                                                {4783}in(c, =GetEndpointRequest);
                                                {4784}new SP_4761: bitstring;
                                                {4785}new UP_4762: bitstring;
                                                {4786}out(c, (GetEndpointResponse,pkSess_4760,Sign,SP_4761,UP_4762))
                                    )
                                    else
                                        {4787}let pkSess_4763: bitstring = fail-any in
                                        {4788}in(c, =GetEndpointRequest);
                                        {4789}new SP_4764: bitstring;
                                        {4790}new UP_4765: bitstring;
                                        {4791}out(c, (GetEndpointResponse,pkSess_4763,Sign,SP_4764,UP_4765))
                            )
                            else
                                {4792}let pkSess_4766: bitstring = fail-any in
                                {4793}in(c, =GetEndpointRequest);
                                {4794}new SP_4767: bitstring;
                                {4795}new UP_4768: bitstring;
                                {4796}out(c, (GetEndpointResponse,pkSess_4766,Sign,SP_4767,UP_4768))
                    )
                    else
                        {4797}let skDisco_4769: bitstring = fail-any in
                        {4798}let pkDisco_4770: bitstring = pub(skDisco_4769) in
                        {4799}let v_4771: bool = (Cli_4225 = A) in
                        (
                            {4800}if v_4771 then
                            (
                                {4801}let pkCli_4772: bitstring = pub(skA) in
                                {4802}let v_4773: bool = (Sess_4227 = A) in
                                (
                                    {4803}if v_4773 then
                                    (
                                        {4804}let pkSess_4774: bitstring = pub(skA) in
                                        {4805}in(c, =GetEndpointRequest);
                                        {4806}new SP_4775: bitstring;
                                        {4807}new UP_4776: bitstring;
                                        {4808}out(c, (GetEndpointResponse,pkSess_4774,Sign,SP_4775,UP_4776))
                                    )
                                    else
                                        {4809}let v_4777: bool = (Sess_4227 = B) in
                                        (
                                            {4810}if v_4777 then
                                            (
                                                {4811}let pkSess_4778: bitstring = pub(skB) in
                                                {4812}in(c, =GetEndpointRequest);
                                                {4813}new SP_4779: bitstring;
                                                {4814}new UP_4780: bitstring;
                                                {4815}out(c, (GetEndpointResponse,pkSess_4778,Sign,SP_4779,UP_4780))
                                            )
                                            else
                                                {4816}let v_4781: bool = (Sess_4227 = C) in
                                                (
                                                    {4817}if v_4781 then
                                                    (
                                                        {4818}let pkSess_4782: bitstring = pub(skC) in
                                                        {4819}in(c, =GetEndpointRequest);
                                                        {4820}new SP_4783: bitstring;
                                                        {4821}new UP_4784: bitstring;
                                                        {4822}out(c, (GetEndpointResponse,pkSess_4782,Sign,SP_4783,UP_4784))
                                                    )
                                                    else
                                                        {4823}let pkSess_4785: bitstring = pub(sk(Sess_4227)) in
                                                        {4824}in(c, =GetEndpointRequest);
                                                        {4825}new SP_4786: bitstring;
                                                        {4826}new UP_4787: bitstring;
                                                        {4827}out(c, (GetEndpointResponse,pkSess_4785,Sign,SP_4786,UP_4787))
                                                )
                                                else
                                                    {4828}let pkSess_4788: bitstring = fail-any in
                                                    {4829}in(c, =GetEndpointRequest);
                                                    {4830}new SP_4789: bitstring;
                                                    {4831}new UP_4790: bitstring;
                                                    {4832}out(c, (GetEndpointResponse,pkSess_4788,Sign,SP_4789,UP_4790))
                                        )
                                        else
                                            {4833}let pkSess_4791: bitstring = fail-any in
                                            {4834}in(c, =GetEndpointRequest);
                                            {4835}new SP_4792: bitstring;
                                            {4836}new UP_4793: bitstring;
                                            {4837}out(c, (GetEndpointResponse,pkSess_4791,Sign,SP_4792,UP_4793))
                                )
                                else
                                    {4838}let pkSess_4794: bitstring = fail-any in
                                    {4839}in(c, =GetEndpointRequest);
                                    {4840}new SP_4795: bitstring;
                                    {4841}new UP_4796: bitstring;
                                    {4842}out(c, (GetEndpointResponse,pkSess_4794,Sign,SP_4795,UP_4796))
                            )
                            else
                                {4843}let v_4797: bool = (Cli_4225 = B) in
                                (
                                    {4844}if v_4797 then
                                    (
                                        {4845}let pkCli_4798: bitstring = pub(skB) in
                                        {4846}let v_4799: bool = (Sess_4227 = A) in
                                        (
                                            {4847}if v_4799 then
                                            (
                                                {4848}let pkSess_4800: bitstring = pub(skA) in
                                                {4849}in(c, =GetEndpointRequest);
                                                {4850}new SP_4801: bitstring;
                                                {4851}new UP_4802: bitstring;
                                                {4852}out(c, (GetEndpointResponse,pkSess_4800,Sign,SP_4801,UP_4802))
                                            )
                                            else
                                                {4853}let v_4803: bool = (Sess_4227 = B) in
                                                (
                                                    {4854}if v_4803 then
                                                    (
                                                        {4855}let pkSess_4804: bitstring = pub(skB) in
                                                        {4856}in(c, =GetEndpointRequest);
                                                        {4857}new SP_4805: bitstring;
                                                        {4858}new UP_4806: bitstring;
                                                        {4859}out(c, (GetEndpointResponse,pkSess_4804,Sign,SP_4805,UP_4806))
                                                    )
                                                    else
                                                        {4860}let v_4807: bool = (Sess_4227 = C) in
                                                        (
                                                            {4861}if v_4807 then
                                                            (
                                                                {4862}let pkSess_4808: bitstring = pub(skC) in
                                                                {4863}in(c, =GetEndpointRequest);
                                                                {4864}new SP_4809: bitstring;
                                                                {4865}new UP_4810: bitstring;
                                                                {4866}out(c, (GetEndpointResponse,pkSess_4808,Sign,SP_4809,UP_4810))
                                                            )
                                                            else
                                                                {4867}let pkSess_4811: bitstring = pub(sk(Sess_4227)) in
                                                                {4868}in(c, =GetEndpointRequest);
                                                                {4869}new SP_4812: bitstring;
                                                                {4870}new UP_4813: bitstring;
                                                                {4871}out(c, (GetEndpointResponse,pkSess_4811,Sign,SP_4812,UP_4813))
                                                        )
                                                        else
                                                            {4872}let pkSess_4814: bitstring = fail-any in
                                                            {4873}in(c, =GetEndpointRequest);
                                                            {4874}new SP_4815: bitstring;
                                                            {4875}new UP_4816: bitstring;
                                                            {4876}out(c, (GetEndpointResponse,pkSess_4814,Sign,SP_4815,UP_4816))
                                                )
                                                else
                                                    {4877}let pkSess_4817: bitstring = fail-any in
                                                    {4878}in(c, =GetEndpointRequest);
                                                    {4879}new SP_4818: bitstring;
                                                    {4880}new UP_4819: bitstring;
                                                    {4881}out(c, (GetEndpointResponse,pkSess_4817,Sign,SP_4818,UP_4819))
                                        )
                                        else
                                            {4882}let pkSess_4820: bitstring = fail-any in
                                            {4883}in(c, =GetEndpointRequest);
                                            {4884}new SP_4821: bitstring;
                                            {4885}new UP_4822: bitstring;
                                            {4886}out(c, (GetEndpointResponse,pkSess_4820,Sign,SP_4821,UP_4822))
                                    )
                                    else
                                        {4887}let v_4823: bool = (Cli_4225 = C) in
                                        (
                                            {4888}if v_4823 then
                                            (
                                                {4889}let pkCli_4824: bitstring = pub(skC) in
                                                {4890}let v_4825: bool = (Sess_4227 = A) in
                                                (
                                                    {4891}if v_4825 then
                                                    (
                                                        {4892}let pkSess_4826: bitstring = pub(skA) in
                                                        {4893}in(c, =GetEndpointRequest);
                                                        {4894}new SP_4827: bitstring;
                                                        {4895}new UP_4828: bitstring;
                                                        {4896}out(c, (GetEndpointResponse,pkSess_4826,Sign,SP_4827,UP_4828))
                                                    )
                                                    else
                                                        {4897}let v_4829: bool = (Sess_4227 = B) in
                                                        (
                                                            {4898}if v_4829 then
                                                            (
                                                                {4899}let pkSess_4830: bitstring = pub(skB) in
                                                                {4900}in(c, =GetEndpointRequest);
                                                                {4901}new SP_4831: bitstring;
                                                                {4902}new UP_4832: bitstring;
                                                                {4903}out(c, (GetEndpointResponse,pkSess_4830,Sign,SP_4831,UP_4832))
                                                            )
                                                            else
                                                                {4904}let v_4833: bool = (Sess_4227 = C) in
                                                                (
                                                                    {4905}if v_4833 then
                                                                    (
                                                                        {4906}let pkSess_4834: bitstring = pub(skC) in
                                                                        {4907}in(c, =GetEndpointRequest);
                                                                        {4908}new SP_4835: bitstring;
                                                                        {4909}new UP_4836: bitstring;
                                                                        {4910}out(c, (GetEndpointResponse,pkSess_4834,Sign,SP_4835,UP_4836))
                                                                    )
                                                                    else
                                                                        {4911}let pkSess_4837: bitstring = pub(sk(Sess_4227)) in
                                                                        {4912}in(c, =GetEndpointRequest);
                                                                        {4913}new SP_4838: bitstring;
                                                                        {4914}new UP_4839: bitstring;
                                                                        {4915}out(c, (GetEndpointResponse,pkSess_4837,Sign,SP_4838,UP_4839))
                                                                )
                                                                else
                                                                    {4916}let pkSess_4840: bitstring = fail-any in
                                                                    {4917}in(c, =GetEndpointRequest);
                                                                    {4918}new SP_4841: bitstring;
                                                                    {4919}new UP_4842: bitstring;
                                                                    {4920}out(c, (GetEndpointResponse,pkSess_4840,Sign,SP_4841,UP_4842))
                                                        )
                                                        else
                                                            {4921}let pkSess_4843: bitstring = fail-any in
                                                            {4922}in(c, =GetEndpointRequest);
                                                            {4923}new SP_4844: bitstring;
                                                            {4924}new UP_4845: bitstring;
                                                            {4925}out(c, (GetEndpointResponse,pkSess_4843,Sign,SP_4844,UP_4845))
                                                )
                                                else
                                                    {4926}let pkSess_4846: bitstring = fail-any in
                                                    {4927}in(c, =GetEndpointRequest);
                                                    {4928}new SP_4847: bitstring;
                                                    {4929}new UP_4848: bitstring;
                                                    {4930}out(c, (GetEndpointResponse,pkSess_4846,Sign,SP_4847,UP_4848))
                                            )
                                            else
                                                {4931}let pkCli_4849: bitstring = pub(sk(Cli_4225)) in
                                                {4932}let v_4850: bool = (Sess_4227 = A) in
                                                (
                                                    {4933}if v_4850 then
                                                    (
                                                        {4934}let pkSess_4851: bitstring = pub(skA) in
                                                        {4935}in(c, =GetEndpointRequest);
                                                        {4936}new SP_4852: bitstring;
                                                        {4937}new UP_4853: bitstring;
                                                        {4938}out(c, (GetEndpointResponse,pkSess_4851,Sign,SP_4852,UP_4853))
                                                    )
                                                    else
                                                        {4939}let v_4854: bool = (Sess_4227 = B) in
                                                        (
                                                            {4940}if v_4854 then
                                                            (
                                                                {4941}let pkSess_4855: bitstring = pub(skB) in
                                                                {4942}in(c, =GetEndpointRequest);
                                                                {4943}new SP_4856: bitstring;
                                                                {4944}new UP_4857: bitstring;
                                                                {4945}out(c, (GetEndpointResponse,pkSess_4855,Sign,SP_4856,UP_4857))
                                                            )
                                                            else
                                                                {4946}let v_4858: bool = (Sess_4227 = C) in
                                                                (
                                                                    {4947}if v_4858 then
                                                                    (
                                                                        {4948}let pkSess_4859: bitstring = pub(skC) in
                                                                        {4949}in(c, =GetEndpointRequest);
                                                                        {4950}new SP_4860: bitstring;
                                                                        {4951}new UP_4861: bitstring;
                                                                        {4952}out(c, (GetEndpointResponse,pkSess_4859,Sign,SP_4860,UP_4861))
                                                                    )
                                                                    else
                                                                        {4953}let pkSess_4862: bitstring = pub(sk(Sess_4227)) in
                                                                        {4954}in(c, =GetEndpointRequest);
                                                                        {4955}new SP_4863: bitstring;
                                                                        {4956}new UP_4864: bitstring;
                                                                        {4957}out(c, (GetEndpointResponse,pkSess_4862,Sign,SP_4863,UP_4864))
                                                                )
                                                                else
                                                                    {4958}let pkSess_4865: bitstring = fail-any in
                                                                    {4959}in(c, =GetEndpointRequest);
                                                                    {4960}new SP_4866: bitstring;
                                                                    {4961}new UP_4867: bitstring;
                                                                    {4962}out(c, (GetEndpointResponse,pkSess_4865,Sign,SP_4866,UP_4867))
                                                        )
                                                        else
                                                            {4963}let pkSess_4868: bitstring = fail-any in
                                                            {4964}in(c, =GetEndpointRequest);
                                                            {4965}new SP_4869: bitstring;
                                                            {4966}new UP_4870: bitstring;
                                                            {4967}out(c, (GetEndpointResponse,pkSess_4868,Sign,SP_4869,UP_4870))
                                                )
                                                else
                                                    {4968}let pkSess_4871: bitstring = fail-any in
                                                    {4969}in(c, =GetEndpointRequest);
                                                    {4970}new SP_4872: bitstring;
                                                    {4971}new UP_4873: bitstring;
                                                    {4972}out(c, (GetEndpointResponse,pkSess_4871,Sign,SP_4872,UP_4873))
                                        )
                                        else
                                            {4973}let pkCli_4874: bitstring = fail-any in
                                            {4974}let v_4875: bool = (Sess_4227 = A) in
                                            (
                                                {4975}if v_4875 then
                                                (
                                                    {4976}let pkSess_4876: bitstring = pub(skA) in
                                                    {4977}in(c, =GetEndpointRequest);
                                                    {4978}new SP_4877: bitstring;
                                                    {4979}new UP_4878: bitstring;
                                                    {4980}out(c, (GetEndpointResponse,pkSess_4876,Sign,SP_4877,UP_4878))
                                                )
                                                else
                                                    {4981}let v_4879: bool = (Sess_4227 = B) in
                                                    (
                                                        {4982}if v_4879 then
                                                        (
                                                            {4983}let pkSess_4880: bitstring = pub(skB) in
                                                            {4984}in(c, =GetEndpointRequest);
                                                            {4985}new SP_4881: bitstring;
                                                            {4986}new UP_4882: bitstring;
                                                            {4987}out(c, (GetEndpointResponse,pkSess_4880,Sign,SP_4881,UP_4882))
                                                        )
                                                        else
                                                            {4988}let v_4883: bool = (Sess_4227 = C) in
                                                            (
                                                                {4989}if v_4883 then
                                                                (
                                                                    {4990}let pkSess_4884: bitstring = pub(skC) in
                                                                    {4991}in(c, =GetEndpointRequest);
                                                                    {4992}new SP_4885: bitstring;
                                                                    {4993}new UP_4886: bitstring;
                                                                    {4994}out(c, (GetEndpointResponse,pkSess_4884,Sign,SP_4885,UP_4886))
                                                                )
                                                                else
                                                                    {4995}let pkSess_4887: bitstring = pub(sk(Sess_4227)) in
                                                                    {4996}in(c, =GetEndpointRequest);
                                                                    {4997}new SP_4888: bitstring;
                                                                    {4998}new UP_4889: bitstring;
                                                                    {4999}out(c, (GetEndpointResponse,pkSess_4887,Sign,SP_4888,UP_4889))
                                                            )
                                                            else
                                                                {5000}let pkSess_4890: bitstring = fail-any in
                                                                {5001}in(c, =GetEndpointRequest);
                                                                {5002}new SP_4891: bitstring;
                                                                {5003}new UP_4892: bitstring;
                                                                {5004}out(c, (GetEndpointResponse,pkSess_4890,Sign,SP_4891,UP_4892))
                                                    )
                                                    else
                                                        {5005}let pkSess_4893: bitstring = fail-any in
                                                        {5006}in(c, =GetEndpointRequest);
                                                        {5007}new SP_4894: bitstring;
                                                        {5008}new UP_4895: bitstring;
                                                        {5009}out(c, (GetEndpointResponse,pkSess_4893,Sign,SP_4894,UP_4895))
                                            )
                                            else
                                                {5010}let pkSess_4896: bitstring = fail-any in
                                                {5011}in(c, =GetEndpointRequest);
                                                {5012}new SP_4897: bitstring;
                                                {5013}new UP_4898: bitstring;
                                                {5014}out(c, (GetEndpointResponse,pkSess_4896,Sign,SP_4897,UP_4898))
                                )
                                else
                                    {5015}let pkCli_4899: bitstring = fail-any in
                                    {5016}let v_4900: bool = (Sess_4227 = A) in
                                    (
                                        {5017}if v_4900 then
                                        (
                                            {5018}let pkSess_4901: bitstring = pub(skA) in
                                            {5019}in(c, =GetEndpointRequest);
                                            {5020}new SP_4902: bitstring;
                                            {5021}new UP_4903: bitstring;
                                            {5022}out(c, (GetEndpointResponse,pkSess_4901,Sign,SP_4902,UP_4903))
                                        )
                                        else
                                            {5023}let v_4904: bool = (Sess_4227 = B) in
                                            (
                                                {5024}if v_4904 then
                                                (
                                                    {5025}let pkSess_4905: bitstring = pub(skB) in
                                                    {5026}in(c, =GetEndpointRequest);
                                                    {5027}new SP_4906: bitstring;
                                                    {5028}new UP_4907: bitstring;
                                                    {5029}out(c, (GetEndpointResponse,pkSess_4905,Sign,SP_4906,UP_4907))
                                                )
                                                else
                                                    {5030}let v_4908: bool = (Sess_4227 = C) in
                                                    (
                                                        {5031}if v_4908 then
                                                        (
                                                            {5032}let pkSess_4909: bitstring = pub(skC) in
                                                            {5033}in(c, =GetEndpointRequest);
                                                            {5034}new SP_4910: bitstring;
                                                            {5035}new UP_4911: bitstring;
                                                            {5036}out(c, (GetEndpointResponse,pkSess_4909,Sign,SP_4910,UP_4911))
                                                        )
                                                        else
                                                            {5037}let pkSess_4912: bitstring = pub(sk(Sess_4227)) in
                                                            {5038}in(c, =GetEndpointRequest);
                                                            {5039}new SP_4913: bitstring;
                                                            {5040}new UP_4914: bitstring;
                                                            {5041}out(c, (GetEndpointResponse,pkSess_4912,Sign,SP_4913,UP_4914))
                                                    )
                                                    else
                                                        {5042}let pkSess_4915: bitstring = fail-any in
                                                        {5043}in(c, =GetEndpointRequest);
                                                        {5044}new SP_4916: bitstring;
                                                        {5045}new UP_4917: bitstring;
                                                        {5046}out(c, (GetEndpointResponse,pkSess_4915,Sign,SP_4916,UP_4917))
                                            )
                                            else
                                                {5047}let pkSess_4918: bitstring = fail-any in
                                                {5048}in(c, =GetEndpointRequest);
                                                {5049}new SP_4919: bitstring;
                                                {5050}new UP_4920: bitstring;
                                                {5051}out(c, (GetEndpointResponse,pkSess_4918,Sign,SP_4919,UP_4920))
                                    )
                                    else
                                        {5052}let pkSess_4921: bitstring = fail-any in
                                        {5053}in(c, =GetEndpointRequest);
                                        {5054}new SP_4922: bitstring;
                                        {5055}new UP_4923: bitstring;
                                        {5056}out(c, (GetEndpointResponse,pkSess_4921,Sign,SP_4922,UP_4923))
                        )
                        else
                            {5057}let pkCli_4924: bitstring = fail-any in
                            {5058}let v_4925: bool = (Sess_4227 = A) in
                            (
                                {5059}if v_4925 then
                                (
                                    {5060}let pkSess_4926: bitstring = pub(skA) in
                                    {5061}in(c, =GetEndpointRequest);
                                    {5062}new SP_4927: bitstring;
                                    {5063}new UP_4928: bitstring;
                                    {5064}out(c, (GetEndpointResponse,pkSess_4926,Sign,SP_4927,UP_4928))
                                )
                                else
                                    {5065}let v_4929: bool = (Sess_4227 = B) in
                                    (
                                        {5066}if v_4929 then
                                        (
                                            {5067}let pkSess_4930: bitstring = pub(skB) in
                                            {5068}in(c, =GetEndpointRequest);
                                            {5069}new SP_4931: bitstring;
                                            {5070}new UP_4932: bitstring;
                                            {5071}out(c, (GetEndpointResponse,pkSess_4930,Sign,SP_4931,UP_4932))
                                        )
                                        else
                                            {5072}let v_4933: bool = (Sess_4227 = C) in
                                            (
                                                {5073}if v_4933 then
                                                (
                                                    {5074}let pkSess_4934: bitstring = pub(skC) in
                                                    {5075}in(c, =GetEndpointRequest);
                                                    {5076}new SP_4935: bitstring;
                                                    {5077}new UP_4936: bitstring;
                                                    {5078}out(c, (GetEndpointResponse,pkSess_4934,Sign,SP_4935,UP_4936))
                                                )
                                                else
                                                    {5079}let pkSess_4937: bitstring = pub(sk(Sess_4227)) in
                                                    {5080}in(c, =GetEndpointRequest);
                                                    {5081}new SP_4938: bitstring;
                                                    {5082}new UP_4939: bitstring;
                                                    {5083}out(c, (GetEndpointResponse,pkSess_4937,Sign,SP_4938,UP_4939))
                                            )
                                            else
                                                {5084}let pkSess_4940: bitstring = fail-any in
                                                {5085}in(c, =GetEndpointRequest);
                                                {5086}new SP_4941: bitstring;
                                                {5087}new UP_4942: bitstring;
                                                {5088}out(c, (GetEndpointResponse,pkSess_4940,Sign,SP_4941,UP_4942))
                                    )
                                    else
                                        {5089}let pkSess_4943: bitstring = fail-any in
                                        {5090}in(c, =GetEndpointRequest);
                                        {5091}new SP_4944: bitstring;
                                        {5092}new UP_4945: bitstring;
                                        {5093}out(c, (GetEndpointResponse,pkSess_4943,Sign,SP_4944,UP_4945))
                            )
                            else
                                {5094}let pkSess_4946: bitstring = fail-any in
                                {5095}in(c, =GetEndpointRequest);
                                {5096}new SP_4947: bitstring;
                                {5097}new UP_4948: bitstring;
                                {5098}out(c, (GetEndpointResponse,pkSess_4946,Sign,SP_4947,UP_4948))
            )
            else
                {5099}let skDisco_4949: bitstring = fail-any in
                {5100}let pkDisco_4950: bitstring = pub(skDisco_4949) in
                {5101}let v_4951: bool = (Cli_4225 = A) in
                (
                    {5102}if v_4951 then
                    (
                        {5103}let pkCli_4952: bitstring = pub(skA) in
                        {5104}let v_4953: bool = (Sess_4227 = A) in
                        (
                            {5105}if v_4953 then
                            (
                                {5106}let pkSess_4954: bitstring = pub(skA) in
                                {5107}in(c, =GetEndpointRequest);
                                {5108}new SP_4955: bitstring;
                                {5109}new UP_4956: bitstring;
                                {5110}out(c, (GetEndpointResponse,pkSess_4954,Sign,SP_4955,UP_4956))
                            )
                            else
                                {5111}let v_4957: bool = (Sess_4227 = B) in
                                (
                                    {5112}if v_4957 then
                                    (
                                        {5113}let pkSess_4958: bitstring = pub(skB) in
                                        {5114}in(c, =GetEndpointRequest);
                                        {5115}new SP_4959: bitstring;
                                        {5116}new UP_4960: bitstring;
                                        {5117}out(c, (GetEndpointResponse,pkSess_4958,Sign,SP_4959,UP_4960))
                                    )
                                    else
                                        {5118}let v_4961: bool = (Sess_4227 = C) in
                                        (
                                            {5119}if v_4961 then
                                            (
                                                {5120}let pkSess_4962: bitstring = pub(skC) in
                                                {5121}in(c, =GetEndpointRequest);
                                                {5122}new SP_4963: bitstring;
                                                {5123}new UP_4964: bitstring;
                                                {5124}out(c, (GetEndpointResponse,pkSess_4962,Sign,SP_4963,UP_4964))
                                            )
                                            else
                                                {5125}let pkSess_4965: bitstring = pub(sk(Sess_4227)) in
                                                {5126}in(c, =GetEndpointRequest);
                                                {5127}new SP_4966: bitstring;
                                                {5128}new UP_4967: bitstring;
                                                {5129}out(c, (GetEndpointResponse,pkSess_4965,Sign,SP_4966,UP_4967))
                                        )
                                        else
                                            {5130}let pkSess_4968: bitstring = fail-any in
                                            {5131}in(c, =GetEndpointRequest);
                                            {5132}new SP_4969: bitstring;
                                            {5133}new UP_4970: bitstring;
                                            {5134}out(c, (GetEndpointResponse,pkSess_4968,Sign,SP_4969,UP_4970))
                                )
                                else
                                    {5135}let pkSess_4971: bitstring = fail-any in
                                    {5136}in(c, =GetEndpointRequest);
                                    {5137}new SP_4972: bitstring;
                                    {5138}new UP_4973: bitstring;
                                    {5139}out(c, (GetEndpointResponse,pkSess_4971,Sign,SP_4972,UP_4973))
                        )
                        else
                            {5140}let pkSess_4974: bitstring = fail-any in
                            {5141}in(c, =GetEndpointRequest);
                            {5142}new SP_4975: bitstring;
                            {5143}new UP_4976: bitstring;
                            {5144}out(c, (GetEndpointResponse,pkSess_4974,Sign,SP_4975,UP_4976))
                    )
                    else
                        {5145}let v_4977: bool = (Cli_4225 = B) in
                        (
                            {5146}if v_4977 then
                            (
                                {5147}let pkCli_4978: bitstring = pub(skB) in
                                {5148}let v_4979: bool = (Sess_4227 = A) in
                                (
                                    {5149}if v_4979 then
                                    (
                                        {5150}let pkSess_4980: bitstring = pub(skA) in
                                        {5151}in(c, =GetEndpointRequest);
                                        {5152}new SP_4981: bitstring;
                                        {5153}new UP_4982: bitstring;
                                        {5154}out(c, (GetEndpointResponse,pkSess_4980,Sign,SP_4981,UP_4982))
                                    )
                                    else
                                        {5155}let v_4983: bool = (Sess_4227 = B) in
                                        (
                                            {5156}if v_4983 then
                                            (
                                                {5157}let pkSess_4984: bitstring = pub(skB) in
                                                {5158}in(c, =GetEndpointRequest);
                                                {5159}new SP_4985: bitstring;
                                                {5160}new UP_4986: bitstring;
                                                {5161}out(c, (GetEndpointResponse,pkSess_4984,Sign,SP_4985,UP_4986))
                                            )
                                            else
                                                {5162}let v_4987: bool = (Sess_4227 = C) in
                                                (
                                                    {5163}if v_4987 then
                                                    (
                                                        {5164}let pkSess_4988: bitstring = pub(skC) in
                                                        {5165}in(c, =GetEndpointRequest);
                                                        {5166}new SP_4989: bitstring;
                                                        {5167}new UP_4990: bitstring;
                                                        {5168}out(c, (GetEndpointResponse,pkSess_4988,Sign,SP_4989,UP_4990))
                                                    )
                                                    else
                                                        {5169}let pkSess_4991: bitstring = pub(sk(Sess_4227)) in
                                                        {5170}in(c, =GetEndpointRequest);
                                                        {5171}new SP_4992: bitstring;
                                                        {5172}new UP_4993: bitstring;
                                                        {5173}out(c, (GetEndpointResponse,pkSess_4991,Sign,SP_4992,UP_4993))
                                                )
                                                else
                                                    {5174}let pkSess_4994: bitstring = fail-any in
                                                    {5175}in(c, =GetEndpointRequest);
                                                    {5176}new SP_4995: bitstring;
                                                    {5177}new UP_4996: bitstring;
                                                    {5178}out(c, (GetEndpointResponse,pkSess_4994,Sign,SP_4995,UP_4996))
                                        )
                                        else
                                            {5179}let pkSess_4997: bitstring = fail-any in
                                            {5180}in(c, =GetEndpointRequest);
                                            {5181}new SP_4998: bitstring;
                                            {5182}new UP_4999: bitstring;
                                            {5183}out(c, (GetEndpointResponse,pkSess_4997,Sign,SP_4998,UP_4999))
                                )
                                else
                                    {5184}let pkSess_5000: bitstring = fail-any in
                                    {5185}in(c, =GetEndpointRequest);
                                    {5186}new SP_5001: bitstring;
                                    {5187}new UP_5002: bitstring;
                                    {5188}out(c, (GetEndpointResponse,pkSess_5000,Sign,SP_5001,UP_5002))
                            )
                            else
                                {5189}let v_5003: bool = (Cli_4225 = C) in
                                (
                                    {5190}if v_5003 then
                                    (
                                        {5191}let pkCli_5004: bitstring = pub(skC) in
                                        {5192}let v_5005: bool = (Sess_4227 = A) in
                                        (
                                            {5193}if v_5005 then
                                            (
                                                {5194}let pkSess_5006: bitstring = pub(skA) in
                                                {5195}in(c, =GetEndpointRequest);
                                                {5196}new SP_5007: bitstring;
                                                {5197}new UP_5008: bitstring;
                                                {5198}out(c, (GetEndpointResponse,pkSess_5006,Sign,SP_5007,UP_5008))
                                            )
                                            else
                                                {5199}let v_5009: bool = (Sess_4227 = B) in
                                                (
                                                    {5200}if v_5009 then
                                                    (
                                                        {5201}let pkSess_5010: bitstring = pub(skB) in
                                                        {5202}in(c, =GetEndpointRequest);
                                                        {5203}new SP_5011: bitstring;
                                                        {5204}new UP_5012: bitstring;
                                                        {5205}out(c, (GetEndpointResponse,pkSess_5010,Sign,SP_5011,UP_5012))
                                                    )
                                                    else
                                                        {5206}let v_5013: bool = (Sess_4227 = C) in
                                                        (
                                                            {5207}if v_5013 then
                                                            (
                                                                {5208}let pkSess_5014: bitstring = pub(skC) in
                                                                {5209}in(c, =GetEndpointRequest);
                                                                {5210}new SP_5015: bitstring;
                                                                {5211}new UP_5016: bitstring;
                                                                {5212}out(c, (GetEndpointResponse,pkSess_5014,Sign,SP_5015,UP_5016))
                                                            )
                                                            else
                                                                {5213}let pkSess_5017: bitstring = pub(sk(Sess_4227)) in
                                                                {5214}in(c, =GetEndpointRequest);
                                                                {5215}new SP_5018: bitstring;
                                                                {5216}new UP_5019: bitstring;
                                                                {5217}out(c, (GetEndpointResponse,pkSess_5017,Sign,SP_5018,UP_5019))
                                                        )
                                                        else
                                                            {5218}let pkSess_5020: bitstring = fail-any in
                                                            {5219}in(c, =GetEndpointRequest);
                                                            {5220}new SP_5021: bitstring;
                                                            {5221}new UP_5022: bitstring;
                                                            {5222}out(c, (GetEndpointResponse,pkSess_5020,Sign,SP_5021,UP_5022))
                                                )
                                                else
                                                    {5223}let pkSess_5023: bitstring = fail-any in
                                                    {5224}in(c, =GetEndpointRequest);
                                                    {5225}new SP_5024: bitstring;
                                                    {5226}new UP_5025: bitstring;
                                                    {5227}out(c, (GetEndpointResponse,pkSess_5023,Sign,SP_5024,UP_5025))
                                        )
                                        else
                                            {5228}let pkSess_5026: bitstring = fail-any in
                                            {5229}in(c, =GetEndpointRequest);
                                            {5230}new SP_5027: bitstring;
                                            {5231}new UP_5028: bitstring;
                                            {5232}out(c, (GetEndpointResponse,pkSess_5026,Sign,SP_5027,UP_5028))
                                    )
                                    else
                                        {5233}let pkCli_5029: bitstring = pub(sk(Cli_4225)) in
                                        {5234}let v_5030: bool = (Sess_4227 = A) in
                                        (
                                            {5235}if v_5030 then
                                            (
                                                {5236}let pkSess_5031: bitstring = pub(skA) in
                                                {5237}in(c, =GetEndpointRequest);
                                                {5238}new SP_5032: bitstring;
                                                {5239}new UP_5033: bitstring;
                                                {5240}out(c, (GetEndpointResponse,pkSess_5031,Sign,SP_5032,UP_5033))
                                            )
                                            else
                                                {5241}let v_5034: bool = (Sess_4227 = B) in
                                                (
                                                    {5242}if v_5034 then
                                                    (
                                                        {5243}let pkSess_5035: bitstring = pub(skB) in
                                                        {5244}in(c, =GetEndpointRequest);
                                                        {5245}new SP_5036: bitstring;
                                                        {5246}new UP_5037: bitstring;
                                                        {5247}out(c, (GetEndpointResponse,pkSess_5035,Sign,SP_5036,UP_5037))
                                                    )
                                                    else
                                                        {5248}let v_5038: bool = (Sess_4227 = C) in
                                                        (
                                                            {5249}if v_5038 then
                                                            (
                                                                {5250}let pkSess_5039: bitstring = pub(skC) in
                                                                {5251}in(c, =GetEndpointRequest);
                                                                {5252}new SP_5040: bitstring;
                                                                {5253}new UP_5041: bitstring;
                                                                {5254}out(c, (GetEndpointResponse,pkSess_5039,Sign,SP_5040,UP_5041))
                                                            )
                                                            else
                                                                {5255}let pkSess_5042: bitstring = pub(sk(Sess_4227)) in
                                                                {5256}in(c, =GetEndpointRequest);
                                                                {5257}new SP_5043: bitstring;
                                                                {5258}new UP_5044: bitstring;
                                                                {5259}out(c, (GetEndpointResponse,pkSess_5042,Sign,SP_5043,UP_5044))
                                                        )
                                                        else
                                                            {5260}let pkSess_5045: bitstring = fail-any in
                                                            {5261}in(c, =GetEndpointRequest);
                                                            {5262}new SP_5046: bitstring;
                                                            {5263}new UP_5047: bitstring;
                                                            {5264}out(c, (GetEndpointResponse,pkSess_5045,Sign,SP_5046,UP_5047))
                                                )
                                                else
                                                    {5265}let pkSess_5048: bitstring = fail-any in
                                                    {5266}in(c, =GetEndpointRequest);
                                                    {5267}new SP_5049: bitstring;
                                                    {5268}new UP_5050: bitstring;
                                                    {5269}out(c, (GetEndpointResponse,pkSess_5048,Sign,SP_5049,UP_5050))
                                        )
                                        else
                                            {5270}let pkSess_5051: bitstring = fail-any in
                                            {5271}in(c, =GetEndpointRequest);
                                            {5272}new SP_5052: bitstring;
                                            {5273}new UP_5053: bitstring;
                                            {5274}out(c, (GetEndpointResponse,pkSess_5051,Sign,SP_5052,UP_5053))
                                )
                                else
                                    {5275}let pkCli_5054: bitstring = fail-any in
                                    {5276}let v_5055: bool = (Sess_4227 = A) in
                                    (
                                        {5277}if v_5055 then
                                        (
                                            {5278}let pkSess_5056: bitstring = pub(skA) in
                                            {5279}in(c, =GetEndpointRequest);
                                            {5280}new SP_5057: bitstring;
                                            {5281}new UP_5058: bitstring;
                                            {5282}out(c, (GetEndpointResponse,pkSess_5056,Sign,SP_5057,UP_5058))
                                        )
                                        else
                                            {5283}let v_5059: bool = (Sess_4227 = B) in
                                            (
                                                {5284}if v_5059 then
                                                (
                                                    {5285}let pkSess_5060: bitstring = pub(skB) in
                                                    {5286}in(c, =GetEndpointRequest);
                                                    {5287}new SP_5061: bitstring;
                                                    {5288}new UP_5062: bitstring;
                                                    {5289}out(c, (GetEndpointResponse,pkSess_5060,Sign,SP_5061,UP_5062))
                                                )
                                                else
                                                    {5290}let v_5063: bool = (Sess_4227 = C) in
                                                    (
                                                        {5291}if v_5063 then
                                                        (
                                                            {5292}let pkSess_5064: bitstring = pub(skC) in
                                                            {5293}in(c, =GetEndpointRequest);
                                                            {5294}new SP_5065: bitstring;
                                                            {5295}new UP_5066: bitstring;
                                                            {5296}out(c, (GetEndpointResponse,pkSess_5064,Sign,SP_5065,UP_5066))
                                                        )
                                                        else
                                                            {5297}let pkSess_5067: bitstring = pub(sk(Sess_4227)) in
                                                            {5298}in(c, =GetEndpointRequest);
                                                            {5299}new SP_5068: bitstring;
                                                            {5300}new UP_5069: bitstring;
                                                            {5301}out(c, (GetEndpointResponse,pkSess_5067,Sign,SP_5068,UP_5069))
                                                    )
                                                    else
                                                        {5302}let pkSess_5070: bitstring = fail-any in
                                                        {5303}in(c, =GetEndpointRequest);
                                                        {5304}new SP_5071: bitstring;
                                                        {5305}new UP_5072: bitstring;
                                                        {5306}out(c, (GetEndpointResponse,pkSess_5070,Sign,SP_5071,UP_5072))
                                            )
                                            else
                                                {5307}let pkSess_5073: bitstring = fail-any in
                                                {5308}in(c, =GetEndpointRequest);
                                                {5309}new SP_5074: bitstring;
                                                {5310}new UP_5075: bitstring;
                                                {5311}out(c, (GetEndpointResponse,pkSess_5073,Sign,SP_5074,UP_5075))
                                    )
                                    else
                                        {5312}let pkSess_5076: bitstring = fail-any in
                                        {5313}in(c, =GetEndpointRequest);
                                        {5314}new SP_5077: bitstring;
                                        {5315}new UP_5078: bitstring;
                                        {5316}out(c, (GetEndpointResponse,pkSess_5076,Sign,SP_5077,UP_5078))
                        )
                        else
                            {5317}let pkCli_5079: bitstring = fail-any in
                            {5318}let v_5080: bool = (Sess_4227 = A) in
                            (
                                {5319}if v_5080 then
                                (
                                    {5320}let pkSess_5081: bitstring = pub(skA) in
                                    {5321}in(c, =GetEndpointRequest);
                                    {5322}new SP_5082: bitstring;
                                    {5323}new UP_5083: bitstring;
                                    {5324}out(c, (GetEndpointResponse,pkSess_5081,Sign,SP_5082,UP_5083))
                                )
                                else
                                    {5325}let v_5084: bool = (Sess_4227 = B) in
                                    (
                                        {5326}if v_5084 then
                                        (
                                            {5327}let pkSess_5085: bitstring = pub(skB) in
                                            {5328}in(c, =GetEndpointRequest);
                                            {5329}new SP_5086: bitstring;
                                            {5330}new UP_5087: bitstring;
                                            {5331}out(c, (GetEndpointResponse,pkSess_5085,Sign,SP_5086,UP_5087))
                                        )
                                        else
                                            {5332}let v_5088: bool = (Sess_4227 = C) in
                                            (
                                                {5333}if v_5088 then
                                                (
                                                    {5334}let pkSess_5089: bitstring = pub(skC) in
                                                    {5335}in(c, =GetEndpointRequest);
                                                    {5336}new SP_5090: bitstring;
                                                    {5337}new UP_5091: bitstring;
                                                    {5338}out(c, (GetEndpointResponse,pkSess_5089,Sign,SP_5090,UP_5091))
                                                )
                                                else
                                                    {5339}let pkSess_5092: bitstring = pub(sk(Sess_4227)) in
                                                    {5340}in(c, =GetEndpointRequest);
                                                    {5341}new SP_5093: bitstring;
                                                    {5342}new UP_5094: bitstring;
                                                    {5343}out(c, (GetEndpointResponse,pkSess_5092,Sign,SP_5093,UP_5094))
                                            )
                                            else
                                                {5344}let pkSess_5095: bitstring = fail-any in
                                                {5345}in(c, =GetEndpointRequest);
                                                {5346}new SP_5096: bitstring;
                                                {5347}new UP_5097: bitstring;
                                                {5348}out(c, (GetEndpointResponse,pkSess_5095,Sign,SP_5096,UP_5097))
                                    )
                                    else
                                        {5349}let pkSess_5098: bitstring = fail-any in
                                        {5350}in(c, =GetEndpointRequest);
                                        {5351}new SP_5099: bitstring;
                                        {5352}new UP_5100: bitstring;
                                        {5353}out(c, (GetEndpointResponse,pkSess_5098,Sign,SP_5099,UP_5100))
                            )
                            else
                                {5354}let pkSess_5101: bitstring = fail-any in
                                {5355}in(c, =GetEndpointRequest);
                                {5356}new SP_5102: bitstring;
                                {5357}new UP_5103: bitstring;
                                {5358}out(c, (GetEndpointResponse,pkSess_5101,Sign,SP_5102,UP_5103))
                )
                else
                    {5359}let pkCli_5104: bitstring = fail-any in
                    {5360}let v_5105: bool = (Sess_4227 = A) in
                    (
                        {5361}if v_5105 then
                        (
                            {5362}let pkSess_5106: bitstring = pub(skA) in
                            {5363}in(c, =GetEndpointRequest);
                            {5364}new SP_5107: bitstring;
                            {5365}new UP_5108: bitstring;
                            {5366}out(c, (GetEndpointResponse,pkSess_5106,Sign,SP_5107,UP_5108))
                        )
                        else
                            {5367}let v_5109: bool = (Sess_4227 = B) in
                            (
                                {5368}if v_5109 then
                                (
                                    {5369}let pkSess_5110: bitstring = pub(skB) in
                                    {5370}in(c, =GetEndpointRequest);
                                    {5371}new SP_5111: bitstring;
                                    {5372}new UP_5112: bitstring;
                                    {5373}out(c, (GetEndpointResponse,pkSess_5110,Sign,SP_5111,UP_5112))
                                )
                                else
                                    {5374}let v_5113: bool = (Sess_4227 = C) in
                                    (
                                        {5375}if v_5113 then
                                        (
                                            {5376}let pkSess_5114: bitstring = pub(skC) in
                                            {5377}in(c, =GetEndpointRequest);
                                            {5378}new SP_5115: bitstring;
                                            {5379}new UP_5116: bitstring;
                                            {5380}out(c, (GetEndpointResponse,pkSess_5114,Sign,SP_5115,UP_5116))
                                        )
                                        else
                                            {5381}let pkSess_5117: bitstring = pub(sk(Sess_4227)) in
                                            {5382}in(c, =GetEndpointRequest);
                                            {5383}new SP_5118: bitstring;
                                            {5384}new UP_5119: bitstring;
                                            {5385}out(c, (GetEndpointResponse,pkSess_5117,Sign,SP_5118,UP_5119))
                                    )
                                    else
                                        {5386}let pkSess_5120: bitstring = fail-any in
                                        {5387}in(c, =GetEndpointRequest);
                                        {5388}new SP_5121: bitstring;
                                        {5389}new UP_5122: bitstring;
                                        {5390}out(c, (GetEndpointResponse,pkSess_5120,Sign,SP_5121,UP_5122))
                            )
                            else
                                {5391}let pkSess_5123: bitstring = fail-any in
                                {5392}in(c, =GetEndpointRequest);
                                {5393}new SP_5124: bitstring;
                                {5394}new UP_5125: bitstring;
                                {5395}out(c, (GetEndpointResponse,pkSess_5123,Sign,SP_5124,UP_5125))
                    )
                    else
                        {5396}let pkSess_5126: bitstring = fail-any in
                        {5397}in(c, =GetEndpointRequest);
                        {5398}new SP_5127: bitstring;
                        {5399}new UP_5128: bitstring;
                        {5400}out(c, (GetEndpointResponse,pkSess_5126,Sign,SP_5127,UP_5128))
    )
    else
        {5401}let skDisco_5129: bitstring = fail-any in
        {5402}let pkDisco_5130: bitstring = pub(skDisco_5129) in
        {5403}let v_5131: bool = (Cli_4225 = A) in
        (
            {5404}if v_5131 then
            (
                {5405}let pkCli_5132: bitstring = pub(skA) in
                {5406}let v_5133: bool = (Sess_4227 = A) in
                (
                    {5407}if v_5133 then
                    (
                        {5408}let pkSess_5134: bitstring = pub(skA) in
                        {5409}in(c, =GetEndpointRequest);
                        {5410}new SP_5135: bitstring;
                        {5411}new UP_5136: bitstring;
                        {5412}out(c, (GetEndpointResponse,pkSess_5134,Sign,SP_5135,UP_5136))
                    )
                    else
                        {5413}let v_5137: bool = (Sess_4227 = B) in
                        (
                            {5414}if v_5137 then
                            (
                                {5415}let pkSess_5138: bitstring = pub(skB) in
                                {5416}in(c, =GetEndpointRequest);
                                {5417}new SP_5139: bitstring;
                                {5418}new UP_5140: bitstring;
                                {5419}out(c, (GetEndpointResponse,pkSess_5138,Sign,SP_5139,UP_5140))
                            )
                            else
                                {5420}let v_5141: bool = (Sess_4227 = C) in
                                (
                                    {5421}if v_5141 then
                                    (
                                        {5422}let pkSess_5142: bitstring = pub(skC) in
                                        {5423}in(c, =GetEndpointRequest);
                                        {5424}new SP_5143: bitstring;
                                        {5425}new UP_5144: bitstring;
                                        {5426}out(c, (GetEndpointResponse,pkSess_5142,Sign,SP_5143,UP_5144))
                                    )
                                    else
                                        {5427}let pkSess_5145: bitstring = pub(sk(Sess_4227)) in
                                        {5428}in(c, =GetEndpointRequest);
                                        {5429}new SP_5146: bitstring;
                                        {5430}new UP_5147: bitstring;
                                        {5431}out(c, (GetEndpointResponse,pkSess_5145,Sign,SP_5146,UP_5147))
                                )
                                else
                                    {5432}let pkSess_5148: bitstring = fail-any in
                                    {5433}in(c, =GetEndpointRequest);
                                    {5434}new SP_5149: bitstring;
                                    {5435}new UP_5150: bitstring;
                                    {5436}out(c, (GetEndpointResponse,pkSess_5148,Sign,SP_5149,UP_5150))
                        )
                        else
                            {5437}let pkSess_5151: bitstring = fail-any in
                            {5438}in(c, =GetEndpointRequest);
                            {5439}new SP_5152: bitstring;
                            {5440}new UP_5153: bitstring;
                            {5441}out(c, (GetEndpointResponse,pkSess_5151,Sign,SP_5152,UP_5153))
                )
                else
                    {5442}let pkSess_5154: bitstring = fail-any in
                    {5443}in(c, =GetEndpointRequest);
                    {5444}new SP_5155: bitstring;
                    {5445}new UP_5156: bitstring;
                    {5446}out(c, (GetEndpointResponse,pkSess_5154,Sign,SP_5155,UP_5156))
            )
            else
                {5447}let v_5157: bool = (Cli_4225 = B) in
                (
                    {5448}if v_5157 then
                    (
                        {5449}let pkCli_5158: bitstring = pub(skB) in
                        {5450}let v_5159: bool = (Sess_4227 = A) in
                        (
                            {5451}if v_5159 then
                            (
                                {5452}let pkSess_5160: bitstring = pub(skA) in
                                {5453}in(c, =GetEndpointRequest);
                                {5454}new SP_5161: bitstring;
                                {5455}new UP_5162: bitstring;
                                {5456}out(c, (GetEndpointResponse,pkSess_5160,Sign,SP_5161,UP_5162))
                            )
                            else
                                {5457}let v_5163: bool = (Sess_4227 = B) in
                                (
                                    {5458}if v_5163 then
                                    (
                                        {5459}let pkSess_5164: bitstring = pub(skB) in
                                        {5460}in(c, =GetEndpointRequest);
                                        {5461}new SP_5165: bitstring;
                                        {5462}new UP_5166: bitstring;
                                        {5463}out(c, (GetEndpointResponse,pkSess_5164,Sign,SP_5165,UP_5166))
                                    )
                                    else
                                        {5464}let v_5167: bool = (Sess_4227 = C) in
                                        (
                                            {5465}if v_5167 then
                                            (
                                                {5466}let pkSess_5168: bitstring = pub(skC) in
                                                {5467}in(c, =GetEndpointRequest);
                                                {5468}new SP_5169: bitstring;
                                                {5469}new UP_5170: bitstring;
                                                {5470}out(c, (GetEndpointResponse,pkSess_5168,Sign,SP_5169,UP_5170))
                                            )
                                            else
                                                {5471}let pkSess_5171: bitstring = pub(sk(Sess_4227)) in
                                                {5472}in(c, =GetEndpointRequest);
                                                {5473}new SP_5172: bitstring;
                                                {5474}new UP_5173: bitstring;
                                                {5475}out(c, (GetEndpointResponse,pkSess_5171,Sign,SP_5172,UP_5173))
                                        )
                                        else
                                            {5476}let pkSess_5174: bitstring = fail-any in
                                            {5477}in(c, =GetEndpointRequest);
                                            {5478}new SP_5175: bitstring;
                                            {5479}new UP_5176: bitstring;
                                            {5480}out(c, (GetEndpointResponse,pkSess_5174,Sign,SP_5175,UP_5176))
                                )
                                else
                                    {5481}let pkSess_5177: bitstring = fail-any in
                                    {5482}in(c, =GetEndpointRequest);
                                    {5483}new SP_5178: bitstring;
                                    {5484}new UP_5179: bitstring;
                                    {5485}out(c, (GetEndpointResponse,pkSess_5177,Sign,SP_5178,UP_5179))
                        )
                        else
                            {5486}let pkSess_5180: bitstring = fail-any in
                            {5487}in(c, =GetEndpointRequest);
                            {5488}new SP_5181: bitstring;
                            {5489}new UP_5182: bitstring;
                            {5490}out(c, (GetEndpointResponse,pkSess_5180,Sign,SP_5181,UP_5182))
                    )
                    else
                        {5491}let v_5183: bool = (Cli_4225 = C) in
                        (
                            {5492}if v_5183 then
                            (
                                {5493}let pkCli_5184: bitstring = pub(skC) in
                                {5494}let v_5185: bool = (Sess_4227 = A) in
                                (
                                    {5495}if v_5185 then
                                    (
                                        {5496}let pkSess_5186: bitstring = pub(skA) in
                                        {5497}in(c, =GetEndpointRequest);
                                        {5498}new SP_5187: bitstring;
                                        {5499}new UP_5188: bitstring;
                                        {5500}out(c, (GetEndpointResponse,pkSess_5186,Sign,SP_5187,UP_5188))
                                    )
                                    else
                                        {5501}let v_5189: bool = (Sess_4227 = B) in
                                        (
                                            {5502}if v_5189 then
                                            (
                                                {5503}let pkSess_5190: bitstring = pub(skB) in
                                                {5504}in(c, =GetEndpointRequest);
                                                {5505}new SP_5191: bitstring;
                                                {5506}new UP_5192: bitstring;
                                                {5507}out(c, (GetEndpointResponse,pkSess_5190,Sign,SP_5191,UP_5192))
                                            )
                                            else
                                                {5508}let v_5193: bool = (Sess_4227 = C) in
                                                (
                                                    {5509}if v_5193 then
                                                    (
                                                        {5510}let pkSess_5194: bitstring = pub(skC) in
                                                        {5511}in(c, =GetEndpointRequest);
                                                        {5512}new SP_5195: bitstring;
                                                        {5513}new UP_5196: bitstring;
                                                        {5514}out(c, (GetEndpointResponse,pkSess_5194,Sign,SP_5195,UP_5196))
                                                    )
                                                    else
                                                        {5515}let pkSess_5197: bitstring = pub(sk(Sess_4227)) in
                                                        {5516}in(c, =GetEndpointRequest);
                                                        {5517}new SP_5198: bitstring;
                                                        {5518}new UP_5199: bitstring;
                                                        {5519}out(c, (GetEndpointResponse,pkSess_5197,Sign,SP_5198,UP_5199))
                                                )
                                                else
                                                    {5520}let pkSess_5200: bitstring = fail-any in
                                                    {5521}in(c, =GetEndpointRequest);
                                                    {5522}new SP_5201: bitstring;
                                                    {5523}new UP_5202: bitstring;
                                                    {5524}out(c, (GetEndpointResponse,pkSess_5200,Sign,SP_5201,UP_5202))
                                        )
                                        else
                                            {5525}let pkSess_5203: bitstring = fail-any in
                                            {5526}in(c, =GetEndpointRequest);
                                            {5527}new SP_5204: bitstring;
                                            {5528}new UP_5205: bitstring;
                                            {5529}out(c, (GetEndpointResponse,pkSess_5203,Sign,SP_5204,UP_5205))
                                )
                                else
                                    {5530}let pkSess_5206: bitstring = fail-any in
                                    {5531}in(c, =GetEndpointRequest);
                                    {5532}new SP_5207: bitstring;
                                    {5533}new UP_5208: bitstring;
                                    {5534}out(c, (GetEndpointResponse,pkSess_5206,Sign,SP_5207,UP_5208))
                            )
                            else
                                {5535}let pkCli_5209: bitstring = pub(sk(Cli_4225)) in
                                {5536}let v_5210: bool = (Sess_4227 = A) in
                                (
                                    {5537}if v_5210 then
                                    (
                                        {5538}let pkSess_5211: bitstring = pub(skA) in
                                        {5539}in(c, =GetEndpointRequest);
                                        {5540}new SP_5212: bitstring;
                                        {5541}new UP_5213: bitstring;
                                        {5542}out(c, (GetEndpointResponse,pkSess_5211,Sign,SP_5212,UP_5213))
                                    )
                                    else
                                        {5543}let v_5214: bool = (Sess_4227 = B) in
                                        (
                                            {5544}if v_5214 then
                                            (
                                                {5545}let pkSess_5215: bitstring = pub(skB) in
                                                {5546}in(c, =GetEndpointRequest);
                                                {5547}new SP_5216: bitstring;
                                                {5548}new UP_5217: bitstring;
                                                {5549}out(c, (GetEndpointResponse,pkSess_5215,Sign,SP_5216,UP_5217))
                                            )
                                            else
                                                {5550}let v_5218: bool = (Sess_4227 = C) in
                                                (
                                                    {5551}if v_5218 then
                                                    (
                                                        {5552}let pkSess_5219: bitstring = pub(skC) in
                                                        {5553}in(c, =GetEndpointRequest);
                                                        {5554}new SP_5220: bitstring;
                                                        {5555}new UP_5221: bitstring;
                                                        {5556}out(c, (GetEndpointResponse,pkSess_5219,Sign,SP_5220,UP_5221))
                                                    )
                                                    else
                                                        {5557}let pkSess_5222: bitstring = pub(sk(Sess_4227)) in
                                                        {5558}in(c, =GetEndpointRequest);
                                                        {5559}new SP_5223: bitstring;
                                                        {5560}new UP_5224: bitstring;
                                                        {5561}out(c, (GetEndpointResponse,pkSess_5222,Sign,SP_5223,UP_5224))
                                                )
                                                else
                                                    {5562}let pkSess_5225: bitstring = fail-any in
                                                    {5563}in(c, =GetEndpointRequest);
                                                    {5564}new SP_5226: bitstring;
                                                    {5565}new UP_5227: bitstring;
                                                    {5566}out(c, (GetEndpointResponse,pkSess_5225,Sign,SP_5226,UP_5227))
                                        )
                                        else
                                            {5567}let pkSess_5228: bitstring = fail-any in
                                            {5568}in(c, =GetEndpointRequest);
                                            {5569}new SP_5229: bitstring;
                                            {5570}new UP_5230: bitstring;
                                            {5571}out(c, (GetEndpointResponse,pkSess_5228,Sign,SP_5229,UP_5230))
                                )
                                else
                                    {5572}let pkSess_5231: bitstring = fail-any in
                                    {5573}in(c, =GetEndpointRequest);
                                    {5574}new SP_5232: bitstring;
                                    {5575}new UP_5233: bitstring;
                                    {5576}out(c, (GetEndpointResponse,pkSess_5231,Sign,SP_5232,UP_5233))
                        )
                        else
                            {5577}let pkCli_5234: bitstring = fail-any in
                            {5578}let v_5235: bool = (Sess_4227 = A) in
                            (
                                {5579}if v_5235 then
                                (
                                    {5580}let pkSess_5236: bitstring = pub(skA) in
                                    {5581}in(c, =GetEndpointRequest);
                                    {5582}new SP_5237: bitstring;
                                    {5583}new UP_5238: bitstring;
                                    {5584}out(c, (GetEndpointResponse,pkSess_5236,Sign,SP_5237,UP_5238))
                                )
                                else
                                    {5585}let v_5239: bool = (Sess_4227 = B) in
                                    (
                                        {5586}if v_5239 then
                                        (
                                            {5587}let pkSess_5240: bitstring = pub(skB) in
                                            {5588}in(c, =GetEndpointRequest);
                                            {5589}new SP_5241: bitstring;
                                            {5590}new UP_5242: bitstring;
                                            {5591}out(c, (GetEndpointResponse,pkSess_5240,Sign,SP_5241,UP_5242))
                                        )
                                        else
                                            {5592}let v_5243: bool = (Sess_4227 = C) in
                                            (
                                                {5593}if v_5243 then
                                                (
                                                    {5594}let pkSess_5244: bitstring = pub(skC) in
                                                    {5595}in(c, =GetEndpointRequest);
                                                    {5596}new SP_5245: bitstring;
                                                    {5597}new UP_5246: bitstring;
                                                    {5598}out(c, (GetEndpointResponse,pkSess_5244,Sign,SP_5245,UP_5246))
                                                )
                                                else
                                                    {5599}let pkSess_5247: bitstring = pub(sk(Sess_4227)) in
                                                    {5600}in(c, =GetEndpointRequest);
                                                    {5601}new SP_5248: bitstring;
                                                    {5602}new UP_5249: bitstring;
                                                    {5603}out(c, (GetEndpointResponse,pkSess_5247,Sign,SP_5248,UP_5249))
                                            )
                                            else
                                                {5604}let pkSess_5250: bitstring = fail-any in
                                                {5605}in(c, =GetEndpointRequest);
                                                {5606}new SP_5251: bitstring;
                                                {5607}new UP_5252: bitstring;
                                                {5608}out(c, (GetEndpointResponse,pkSess_5250,Sign,SP_5251,UP_5252))
                                    )
                                    else
                                        {5609}let pkSess_5253: bitstring = fail-any in
                                        {5610}in(c, =GetEndpointRequest);
                                        {5611}new SP_5254: bitstring;
                                        {5612}new UP_5255: bitstring;
                                        {5613}out(c, (GetEndpointResponse,pkSess_5253,Sign,SP_5254,UP_5255))
                            )
                            else
                                {5614}let pkSess_5256: bitstring = fail-any in
                                {5615}in(c, =GetEndpointRequest);
                                {5616}new SP_5257: bitstring;
                                {5617}new UP_5258: bitstring;
                                {5618}out(c, (GetEndpointResponse,pkSess_5256,Sign,SP_5257,UP_5258))
                )
                else
                    {5619}let pkCli_5259: bitstring = fail-any in
                    {5620}let v_5260: bool = (Sess_4227 = A) in
                    (
                        {5621}if v_5260 then
                        (
                            {5622}let pkSess_5261: bitstring = pub(skA) in
                            {5623}in(c, =GetEndpointRequest);
                            {5624}new SP_5262: bitstring;
                            {5625}new UP_5263: bitstring;
                            {5626}out(c, (GetEndpointResponse,pkSess_5261,Sign,SP_5262,UP_5263))
                        )
                        else
                            {5627}let v_5264: bool = (Sess_4227 = B) in
                            (
                                {5628}if v_5264 then
                                (
                                    {5629}let pkSess_5265: bitstring = pub(skB) in
                                    {5630}in(c, =GetEndpointRequest);
                                    {5631}new SP_5266: bitstring;
                                    {5632}new UP_5267: bitstring;
                                    {5633}out(c, (GetEndpointResponse,pkSess_5265,Sign,SP_5266,UP_5267))
                                )
                                else
                                    {5634}let v_5268: bool = (Sess_4227 = C) in
                                    (
                                        {5635}if v_5268 then
                                        (
                                            {5636}let pkSess_5269: bitstring = pub(skC) in
                                            {5637}in(c, =GetEndpointRequest);
                                            {5638}new SP_5270: bitstring;
                                            {5639}new UP_5271: bitstring;
                                            {5640}out(c, (GetEndpointResponse,pkSess_5269,Sign,SP_5270,UP_5271))
                                        )
                                        else
                                            {5641}let pkSess_5272: bitstring = pub(sk(Sess_4227)) in
                                            {5642}in(c, =GetEndpointRequest);
                                            {5643}new SP_5273: bitstring;
                                            {5644}new UP_5274: bitstring;
                                            {5645}out(c, (GetEndpointResponse,pkSess_5272,Sign,SP_5273,UP_5274))
                                    )
                                    else
                                        {5646}let pkSess_5275: bitstring = fail-any in
                                        {5647}in(c, =GetEndpointRequest);
                                        {5648}new SP_5276: bitstring;
                                        {5649}new UP_5277: bitstring;
                                        {5650}out(c, (GetEndpointResponse,pkSess_5275,Sign,SP_5276,UP_5277))
                            )
                            else
                                {5651}let pkSess_5278: bitstring = fail-any in
                                {5652}in(c, =GetEndpointRequest);
                                {5653}new SP_5279: bitstring;
                                {5654}new UP_5280: bitstring;
                                {5655}out(c, (GetEndpointResponse,pkSess_5278,Sign,SP_5279,UP_5280))
                    )
                    else
                        {5656}let pkSess_5281: bitstring = fail-any in
                        {5657}in(c, =GetEndpointRequest);
                        {5658}new SP_5282: bitstring;
                        {5659}new UP_5283: bitstring;
                        {5660}out(c, (GetEndpointResponse,pkSess_5281,Sign,SP_5282,UP_5283))
        )
        else
            {5661}let pkCli_5284: bitstring = fail-any in
            {5662}let v_5285: bool = (Sess_4227 = A) in
            (
                {5663}if v_5285 then
                (
                    {5664}let pkSess_5286: bitstring = pub(skA) in
                    {5665}in(c, =GetEndpointRequest);
                    {5666}new SP_5287: bitstring;
                    {5667}new UP_5288: bitstring;
                    {5668}out(c, (GetEndpointResponse,pkSess_5286,Sign,SP_5287,UP_5288))
                )
                else
                    {5669}let v_5289: bool = (Sess_4227 = B) in
                    (
                        {5670}if v_5289 then
                        (
                            {5671}let pkSess_5290: bitstring = pub(skB) in
                            {5672}in(c, =GetEndpointRequest);
                            {5673}new SP_5291: bitstring;
                            {5674}new UP_5292: bitstring;
                            {5675}out(c, (GetEndpointResponse,pkSess_5290,Sign,SP_5291,UP_5292))
                        )
                        else
                            {5676}let v_5293: bool = (Sess_4227 = C) in
                            (
                                {5677}if v_5293 then
                                (
                                    {5678}let pkSess_5294: bitstring = pub(skC) in
                                    {5679}in(c, =GetEndpointRequest);
                                    {5680}new SP_5295: bitstring;
                                    {5681}new UP_5296: bitstring;
                                    {5682}out(c, (GetEndpointResponse,pkSess_5294,Sign,SP_5295,UP_5296))
                                )
                                else
                                    {5683}let pkSess_5297: bitstring = pub(sk(Sess_4227)) in
                                    {5684}in(c, =GetEndpointRequest);
                                    {5685}new SP_5298: bitstring;
                                    {5686}new UP_5299: bitstring;
                                    {5687}out(c, (GetEndpointResponse,pkSess_5297,Sign,SP_5298,UP_5299))
                            )
                            else
                                {5688}let pkSess_5300: bitstring = fail-any in
                                {5689}in(c, =GetEndpointRequest);
                                {5690}new SP_5301: bitstring;
                                {5691}new UP_5302: bitstring;
                                {5692}out(c, (GetEndpointResponse,pkSess_5300,Sign,SP_5301,UP_5302))
                    )
                    else
                        {5693}let pkSess_5303: bitstring = fail-any in
                        {5694}in(c, =GetEndpointRequest);
                        {5695}new SP_5304: bitstring;
                        {5696}new UP_5305: bitstring;
                        {5697}out(c, (GetEndpointResponse,pkSess_5303,Sign,SP_5304,UP_5305))
            )
            else
                {5698}let pkSess_5306: bitstring = fail-any in
                {5699}in(c, =GetEndpointRequest);
                {5700}new SP_5307: bitstring;
                {5701}new UP_5308: bitstring;
                {5702}out(c, (GetEndpointResponse,pkSess_5306,Sign,SP_5307,UP_5308))
) | (
    {5703}!
    {5704}in(c, (Cli_5309: host,Disco_5310: host,Sess_5311: host));
    {5705}let v_5312: bool = (Sess_5311 = A) in
    (
        {5706}if v_5312 then
        (
            {5707}let skSess: bitstring = skA in
            {5708}let pkSess_5313: bitstring = pub(skSess) in
            {5709}let v_5314: bool = (Cli_5309 = A) in
            (
                {5710}if v_5314 then
                (
                    {5711}let pkCli_5315: bitstring = pub(skA) in
                    {5712}let v_5316: bool = (Disco_5310 = A) in
                    (
                        {5713}if v_5316 then
                        (
                            {5714}let pkDisco_5317: bitstring = pub(skA) in
                            {5715}in(c, (=pkCli_5315,em1: bitstring,sigM1: bitstring));
                            {5716}let m1_5318: bitstring = em1 in
                            {5717}if (verify(h(m1_5318),sigM1,pkCli_5315) <> true) then
                                0
                            else
                                {5718}let (=OpenSecureChannelRequest,=pkCli_5315,Nc_5319: bitstring) = m1_5318 in
                                {5719}new Ns_5320: bitstring;
                                {5720}new ST_5321: bitstring;
                                {5721}new TTL_5322: bitstring;
                                {5722}let m2_5323: bitstring = (OpenSecureChannelResponse,Ns_5320,ST_5321,TTL_5322) in
                                {5723}out(c, (m2_5323,sign(h(m2_5323),skSess)));
                                {5724}let Ksrv: bitstring = h((Ns_5320,Nc_5319)) in
                                {5725}out(c, senc(mSrv(pkCli_5315,pkSess_5313),Ksrv))
                        )
                        else
                            {5726}let v_5324: bool = (Disco_5310 = B) in
                            (
                                {5727}if v_5324 then
                                (
                                    {5728}let pkDisco_5325: bitstring = pub(skB) in
                                    {5729}in(c, (=pkCli_5315,em1_5326: bitstring,sigM1_5327: bitstring));
                                    {5730}let m1_5328: bitstring = em1_5326 in
                                    {5731}if (verify(h(m1_5328),sigM1_5327,pkCli_5315) <> true) then
                                        0
                                    else
                                        {5732}let (=OpenSecureChannelRequest,=pkCli_5315,Nc_5329: bitstring) = m1_5328 in
                                        {5733}new Ns_5330: bitstring;
                                        {5734}new ST_5331: bitstring;
                                        {5735}new TTL_5332: bitstring;
                                        {5736}let m2_5333: bitstring = (OpenSecureChannelResponse,Ns_5330,ST_5331,TTL_5332) in
                                        {5737}out(c, (m2_5333,sign(h(m2_5333),skSess)));
                                        {5738}let Ksrv_5334: bitstring = h((Ns_5330,Nc_5329)) in
                                        {5739}out(c, senc(mSrv(pkCli_5315,pkSess_5313),Ksrv_5334))
                                )
                                else
                                    {5740}let v_5335: bool = (Disco_5310 = C) in
                                    (
                                        {5741}if v_5335 then
                                        (
                                            {5742}let pkDisco_5336: bitstring = pub(skC) in
                                            {5743}in(c, (=pkCli_5315,em1_5337: bitstring,sigM1_5338: bitstring));
                                            {5744}let m1_5339: bitstring = em1_5337 in
                                            {5745}if (verify(h(m1_5339),sigM1_5338,pkCli_5315) <> true) then
                                                0
                                            else
                                                {5746}let (=OpenSecureChannelRequest,=pkCli_5315,Nc_5340: bitstring) = m1_5339 in
                                                {5747}new Ns_5341: bitstring;
                                                {5748}new ST_5342: bitstring;
                                                {5749}new TTL_5343: bitstring;
                                                {5750}let m2_5344: bitstring = (OpenSecureChannelResponse,Ns_5341,ST_5342,TTL_5343) in
                                                {5751}out(c, (m2_5344,sign(h(m2_5344),skSess)));
                                                {5752}let Ksrv_5345: bitstring = h((Ns_5341,Nc_5340)) in
                                                {5753}out(c, senc(mSrv(pkCli_5315,pkSess_5313),Ksrv_5345))
                                        )
                                        else
                                            {5754}let pkDisco_5346: bitstring = pub(sk(Disco_5310)) in
                                            {5755}in(c, (=pkCli_5315,em1_5347: bitstring,sigM1_5348: bitstring));
                                            {5756}let m1_5349: bitstring = em1_5347 in
                                            {5757}if (verify(h(m1_5349),sigM1_5348,pkCli_5315) <> true) then
                                                0
                                            else
                                                {5758}let (=OpenSecureChannelRequest,=pkCli_5315,Nc_5350: bitstring) = m1_5349 in
                                                {5759}new Ns_5351: bitstring;
                                                {5760}new ST_5352: bitstring;
                                                {5761}new TTL_5353: bitstring;
                                                {5762}let m2_5354: bitstring = (OpenSecureChannelResponse,Ns_5351,ST_5352,TTL_5353) in
                                                {5763}out(c, (m2_5354,sign(h(m2_5354),skSess)));
                                                {5764}let Ksrv_5355: bitstring = h((Ns_5351,Nc_5350)) in
                                                {5765}out(c, senc(mSrv(pkCli_5315,pkSess_5313),Ksrv_5355))
                                    )
                                    else
                                        {5766}let pkDisco_5356: bitstring = fail-any in
                                        {5767}in(c, (=pkCli_5315,em1_5357: bitstring,sigM1_5358: bitstring));
                                        {5768}let m1_5359: bitstring = em1_5357 in
                                        {5769}if (verify(h(m1_5359),sigM1_5358,pkCli_5315) <> true) then
                                            0
                                        else
                                            {5770}let (=OpenSecureChannelRequest,=pkCli_5315,Nc_5360: bitstring) = m1_5359 in
                                            {5771}new Ns_5361: bitstring;
                                            {5772}new ST_5362: bitstring;
                                            {5773}new TTL_5363: bitstring;
                                            {5774}let m2_5364: bitstring = (OpenSecureChannelResponse,Ns_5361,ST_5362,TTL_5363) in
                                            {5775}out(c, (m2_5364,sign(h(m2_5364),skSess)));
                                            {5776}let Ksrv_5365: bitstring = h((Ns_5361,Nc_5360)) in
                                            {5777}out(c, senc(mSrv(pkCli_5315,pkSess_5313),Ksrv_5365))
                            )
                            else
                                {5778}let pkDisco_5366: bitstring = fail-any in
                                {5779}in(c, (=pkCli_5315,em1_5367: bitstring,sigM1_5368: bitstring));
                                {5780}let m1_5369: bitstring = em1_5367 in
                                {5781}if (verify(h(m1_5369),sigM1_5368,pkCli_5315) <> true) then
                                    0
                                else
                                    {5782}let (=OpenSecureChannelRequest,=pkCli_5315,Nc_5370: bitstring) = m1_5369 in
                                    {5783}new Ns_5371: bitstring;
                                    {5784}new ST_5372: bitstring;
                                    {5785}new TTL_5373: bitstring;
                                    {5786}let m2_5374: bitstring = (OpenSecureChannelResponse,Ns_5371,ST_5372,TTL_5373) in
                                    {5787}out(c, (m2_5374,sign(h(m2_5374),skSess)));
                                    {5788}let Ksrv_5375: bitstring = h((Ns_5371,Nc_5370)) in
                                    {5789}out(c, senc(mSrv(pkCli_5315,pkSess_5313),Ksrv_5375))
                    )
                    else
                        {5790}let pkDisco_5376: bitstring = fail-any in
                        {5791}in(c, (=pkCli_5315,em1_5377: bitstring,sigM1_5378: bitstring));
                        {5792}let m1_5379: bitstring = em1_5377 in
                        {5793}if (verify(h(m1_5379),sigM1_5378,pkCli_5315) <> true) then
                            0
                        else
                            {5794}let (=OpenSecureChannelRequest,=pkCli_5315,Nc_5380: bitstring) = m1_5379 in
                            {5795}new Ns_5381: bitstring;
                            {5796}new ST_5382: bitstring;
                            {5797}new TTL_5383: bitstring;
                            {5798}let m2_5384: bitstring = (OpenSecureChannelResponse,Ns_5381,ST_5382,TTL_5383) in
                            {5799}out(c, (m2_5384,sign(h(m2_5384),skSess)));
                            {5800}let Ksrv_5385: bitstring = h((Ns_5381,Nc_5380)) in
                            {5801}out(c, senc(mSrv(pkCli_5315,pkSess_5313),Ksrv_5385))
                )
                else
                    {5802}let v_5386: bool = (Cli_5309 = B) in
                    (
                        {5803}if v_5386 then
                        (
                            {5804}let pkCli_5387: bitstring = pub(skB) in
                            {5805}let v_5388: bool = (Disco_5310 = A) in
                            (
                                {5806}if v_5388 then
                                (
                                    {5807}let pkDisco_5389: bitstring = pub(skA) in
                                    {5808}in(c, (=pkCli_5387,em1_5390: bitstring,sigM1_5391: bitstring));
                                    {5809}let m1_5392: bitstring = em1_5390 in
                                    {5810}if (verify(h(m1_5392),sigM1_5391,pkCli_5387) <> true) then
                                        0
                                    else
                                        {5811}let (=OpenSecureChannelRequest,=pkCli_5387,Nc_5393: bitstring) = m1_5392 in
                                        {5812}new Ns_5394: bitstring;
                                        {5813}new ST_5395: bitstring;
                                        {5814}new TTL_5396: bitstring;
                                        {5815}let m2_5397: bitstring = (OpenSecureChannelResponse,Ns_5394,ST_5395,TTL_5396) in
                                        {5816}out(c, (m2_5397,sign(h(m2_5397),skSess)));
                                        {5817}let Ksrv_5398: bitstring = h((Ns_5394,Nc_5393)) in
                                        {5818}out(c, senc(mSrv(pkCli_5387,pkSess_5313),Ksrv_5398))
                                )
                                else
                                    {5819}let v_5399: bool = (Disco_5310 = B) in
                                    (
                                        {5820}if v_5399 then
                                        (
                                            {5821}let pkDisco_5400: bitstring = pub(skB) in
                                            {5822}in(c, (=pkCli_5387,em1_5401: bitstring,sigM1_5402: bitstring));
                                            {5823}let m1_5403: bitstring = em1_5401 in
                                            {5824}if (verify(h(m1_5403),sigM1_5402,pkCli_5387) <> true) then
                                                0
                                            else
                                                {5825}let (=OpenSecureChannelRequest,=pkCli_5387,Nc_5404: bitstring) = m1_5403 in
                                                {5826}new Ns_5405: bitstring;
                                                {5827}new ST_5406: bitstring;
                                                {5828}new TTL_5407: bitstring;
                                                {5829}let m2_5408: bitstring = (OpenSecureChannelResponse,Ns_5405,ST_5406,TTL_5407) in
                                                {5830}out(c, (m2_5408,sign(h(m2_5408),skSess)));
                                                {5831}let Ksrv_5409: bitstring = h((Ns_5405,Nc_5404)) in
                                                {5832}out(c, senc(mSrv(pkCli_5387,pkSess_5313),Ksrv_5409))
                                        )
                                        else
                                            {5833}let v_5410: bool = (Disco_5310 = C) in
                                            (
                                                {5834}if v_5410 then
                                                (
                                                    {5835}let pkDisco_5411: bitstring = pub(skC) in
                                                    {5836}in(c, (=pkCli_5387,em1_5412: bitstring,sigM1_5413: bitstring));
                                                    {5837}let m1_5414: bitstring = em1_5412 in
                                                    {5838}if (verify(h(m1_5414),sigM1_5413,pkCli_5387) <> true) then
                                                        0
                                                    else
                                                        {5839}let (=OpenSecureChannelRequest,=pkCli_5387,Nc_5415: bitstring) = m1_5414 in
                                                        {5840}new Ns_5416: bitstring;
                                                        {5841}new ST_5417: bitstring;
                                                        {5842}new TTL_5418: bitstring;
                                                        {5843}let m2_5419: bitstring = (OpenSecureChannelResponse,Ns_5416,ST_5417,TTL_5418) in
                                                        {5844}out(c, (m2_5419,sign(h(m2_5419),skSess)));
                                                        {5845}let Ksrv_5420: bitstring = h((Ns_5416,Nc_5415)) in
                                                        {5846}out(c, senc(mSrv(pkCli_5387,pkSess_5313),Ksrv_5420))
                                                )
                                                else
                                                    {5847}let pkDisco_5421: bitstring = pub(sk(Disco_5310)) in
                                                    {5848}in(c, (=pkCli_5387,em1_5422: bitstring,sigM1_5423: bitstring));
                                                    {5849}let m1_5424: bitstring = em1_5422 in
                                                    {5850}if (verify(h(m1_5424),sigM1_5423,pkCli_5387) <> true) then
                                                        0
                                                    else
                                                        {5851}let (=OpenSecureChannelRequest,=pkCli_5387,Nc_5425: bitstring) = m1_5424 in
                                                        {5852}new Ns_5426: bitstring;
                                                        {5853}new ST_5427: bitstring;
                                                        {5854}new TTL_5428: bitstring;
                                                        {5855}let m2_5429: bitstring = (OpenSecureChannelResponse,Ns_5426,ST_5427,TTL_5428) in
                                                        {5856}out(c, (m2_5429,sign(h(m2_5429),skSess)));
                                                        {5857}let Ksrv_5430: bitstring = h((Ns_5426,Nc_5425)) in
                                                        {5858}out(c, senc(mSrv(pkCli_5387,pkSess_5313),Ksrv_5430))
                                            )
                                            else
                                                {5859}let pkDisco_5431: bitstring = fail-any in
                                                {5860}in(c, (=pkCli_5387,em1_5432: bitstring,sigM1_5433: bitstring));
                                                {5861}let m1_5434: bitstring = em1_5432 in
                                                {5862}if (verify(h(m1_5434),sigM1_5433,pkCli_5387) <> true) then
                                                    0
                                                else
                                                    {5863}let (=OpenSecureChannelRequest,=pkCli_5387,Nc_5435: bitstring) = m1_5434 in
                                                    {5864}new Ns_5436: bitstring;
                                                    {5865}new ST_5437: bitstring;
                                                    {5866}new TTL_5438: bitstring;
                                                    {5867}let m2_5439: bitstring = (OpenSecureChannelResponse,Ns_5436,ST_5437,TTL_5438) in
                                                    {5868}out(c, (m2_5439,sign(h(m2_5439),skSess)));
                                                    {5869}let Ksrv_5440: bitstring = h((Ns_5436,Nc_5435)) in
                                                    {5870}out(c, senc(mSrv(pkCli_5387,pkSess_5313),Ksrv_5440))
                                    )
                                    else
                                        {5871}let pkDisco_5441: bitstring = fail-any in
                                        {5872}in(c, (=pkCli_5387,em1_5442: bitstring,sigM1_5443: bitstring));
                                        {5873}let m1_5444: bitstring = em1_5442 in
                                        {5874}if (verify(h(m1_5444),sigM1_5443,pkCli_5387) <> true) then
                                            0
                                        else
                                            {5875}let (=OpenSecureChannelRequest,=pkCli_5387,Nc_5445: bitstring) = m1_5444 in
                                            {5876}new Ns_5446: bitstring;
                                            {5877}new ST_5447: bitstring;
                                            {5878}new TTL_5448: bitstring;
                                            {5879}let m2_5449: bitstring = (OpenSecureChannelResponse,Ns_5446,ST_5447,TTL_5448) in
                                            {5880}out(c, (m2_5449,sign(h(m2_5449),skSess)));
                                            {5881}let Ksrv_5450: bitstring = h((Ns_5446,Nc_5445)) in
                                            {5882}out(c, senc(mSrv(pkCli_5387,pkSess_5313),Ksrv_5450))
                            )
                            else
                                {5883}let pkDisco_5451: bitstring = fail-any in
                                {5884}in(c, (=pkCli_5387,em1_5452: bitstring,sigM1_5453: bitstring));
                                {5885}let m1_5454: bitstring = em1_5452 in
                                {5886}if (verify(h(m1_5454),sigM1_5453,pkCli_5387) <> true) then
                                    0
                                else
                                    {5887}let (=OpenSecureChannelRequest,=pkCli_5387,Nc_5455: bitstring) = m1_5454 in
                                    {5888}new Ns_5456: bitstring;
                                    {5889}new ST_5457: bitstring;
                                    {5890}new TTL_5458: bitstring;
                                    {5891}let m2_5459: bitstring = (OpenSecureChannelResponse,Ns_5456,ST_5457,TTL_5458) in
                                    {5892}out(c, (m2_5459,sign(h(m2_5459),skSess)));
                                    {5893}let Ksrv_5460: bitstring = h((Ns_5456,Nc_5455)) in
                                    {5894}out(c, senc(mSrv(pkCli_5387,pkSess_5313),Ksrv_5460))
                        )
                        else
                            {5895}let v_5461: bool = (Cli_5309 = C) in
                            (
                                {5896}if v_5461 then
                                (
                                    {5897}let pkCli_5462: bitstring = pub(skC) in
                                    {5898}let v_5463: bool = (Disco_5310 = A) in
                                    (
                                        {5899}if v_5463 then
                                        (
                                            {5900}let pkDisco_5464: bitstring = pub(skA) in
                                            {5901}in(c, (=pkCli_5462,em1_5465: bitstring,sigM1_5466: bitstring));
                                            {5902}let m1_5467: bitstring = em1_5465 in
                                            {5903}if (verify(h(m1_5467),sigM1_5466,pkCli_5462) <> true) then
                                                0
                                            else
                                                {5904}let (=OpenSecureChannelRequest,=pkCli_5462,Nc_5468: bitstring) = m1_5467 in
                                                {5905}new Ns_5469: bitstring;
                                                {5906}new ST_5470: bitstring;
                                                {5907}new TTL_5471: bitstring;
                                                {5908}let m2_5472: bitstring = (OpenSecureChannelResponse,Ns_5469,ST_5470,TTL_5471) in
                                                {5909}out(c, (m2_5472,sign(h(m2_5472),skSess)));
                                                {5910}let Ksrv_5473: bitstring = h((Ns_5469,Nc_5468)) in
                                                {5911}out(c, senc(mSrv(pkCli_5462,pkSess_5313),Ksrv_5473))
                                        )
                                        else
                                            {5912}let v_5474: bool = (Disco_5310 = B) in
                                            (
                                                {5913}if v_5474 then
                                                (
                                                    {5914}let pkDisco_5475: bitstring = pub(skB) in
                                                    {5915}in(c, (=pkCli_5462,em1_5476: bitstring,sigM1_5477: bitstring));
                                                    {5916}let m1_5478: bitstring = em1_5476 in
                                                    {5917}if (verify(h(m1_5478),sigM1_5477,pkCli_5462) <> true) then
                                                        0
                                                    else
                                                        {5918}let (=OpenSecureChannelRequest,=pkCli_5462,Nc_5479: bitstring) = m1_5478 in
                                                        {5919}new Ns_5480: bitstring;
                                                        {5920}new ST_5481: bitstring;
                                                        {5921}new TTL_5482: bitstring;
                                                        {5922}let m2_5483: bitstring = (OpenSecureChannelResponse,Ns_5480,ST_5481,TTL_5482) in
                                                        {5923}out(c, (m2_5483,sign(h(m2_5483),skSess)));
                                                        {5924}let Ksrv_5484: bitstring = h((Ns_5480,Nc_5479)) in
                                                        {5925}out(c, senc(mSrv(pkCli_5462,pkSess_5313),Ksrv_5484))
                                                )
                                                else
                                                    {5926}let v_5485: bool = (Disco_5310 = C) in
                                                    (
                                                        {5927}if v_5485 then
                                                        (
                                                            {5928}let pkDisco_5486: bitstring = pub(skC) in
                                                            {5929}in(c, (=pkCli_5462,em1_5487: bitstring,sigM1_5488: bitstring));
                                                            {5930}let m1_5489: bitstring = em1_5487 in
                                                            {5931}if (verify(h(m1_5489),sigM1_5488,pkCli_5462) <> true) then
                                                                0
                                                            else
                                                                {5932}let (=OpenSecureChannelRequest,=pkCli_5462,Nc_5490: bitstring) = m1_5489 in
                                                                {5933}new Ns_5491: bitstring;
                                                                {5934}new ST_5492: bitstring;
                                                                {5935}new TTL_5493: bitstring;
                                                                {5936}let m2_5494: bitstring = (OpenSecureChannelResponse,Ns_5491,ST_5492,TTL_5493) in
                                                                {5937}out(c, (m2_5494,sign(h(m2_5494),skSess)));
                                                                {5938}let Ksrv_5495: bitstring = h((Ns_5491,Nc_5490)) in
                                                                {5939}out(c, senc(mSrv(pkCli_5462,pkSess_5313),Ksrv_5495))
                                                        )
                                                        else
                                                            {5940}let pkDisco_5496: bitstring = pub(sk(Disco_5310)) in
                                                            {5941}in(c, (=pkCli_5462,em1_5497: bitstring,sigM1_5498: bitstring));
                                                            {5942}let m1_5499: bitstring = em1_5497 in
                                                            {5943}if (verify(h(m1_5499),sigM1_5498,pkCli_5462) <> true) then
                                                                0
                                                            else
                                                                {5944}let (=OpenSecureChannelRequest,=pkCli_5462,Nc_5500: bitstring) = m1_5499 in
                                                                {5945}new Ns_5501: bitstring;
                                                                {5946}new ST_5502: bitstring;
                                                                {5947}new TTL_5503: bitstring;
                                                                {5948}let m2_5504: bitstring = (OpenSecureChannelResponse,Ns_5501,ST_5502,TTL_5503) in
                                                                {5949}out(c, (m2_5504,sign(h(m2_5504),skSess)));
                                                                {5950}let Ksrv_5505: bitstring = h((Ns_5501,Nc_5500)) in
                                                                {5951}out(c, senc(mSrv(pkCli_5462,pkSess_5313),Ksrv_5505))
                                                    )
                                                    else
                                                        {5952}let pkDisco_5506: bitstring = fail-any in
                                                        {5953}in(c, (=pkCli_5462,em1_5507: bitstring,sigM1_5508: bitstring));
                                                        {5954}let m1_5509: bitstring = em1_5507 in
                                                        {5955}if (verify(h(m1_5509),sigM1_5508,pkCli_5462) <> true) then
                                                            0
                                                        else
                                                            {5956}let (=OpenSecureChannelRequest,=pkCli_5462,Nc_5510: bitstring) = m1_5509 in
                                                            {5957}new Ns_5511: bitstring;
                                                            {5958}new ST_5512: bitstring;
                                                            {5959}new TTL_5513: bitstring;
                                                            {5960}let m2_5514: bitstring = (OpenSecureChannelResponse,Ns_5511,ST_5512,TTL_5513) in
                                                            {5961}out(c, (m2_5514,sign(h(m2_5514),skSess)));
                                                            {5962}let Ksrv_5515: bitstring = h((Ns_5511,Nc_5510)) in
                                                            {5963}out(c, senc(mSrv(pkCli_5462,pkSess_5313),Ksrv_5515))
                                            )
                                            else
                                                {5964}let pkDisco_5516: bitstring = fail-any in
                                                {5965}in(c, (=pkCli_5462,em1_5517: bitstring,sigM1_5518: bitstring));
                                                {5966}let m1_5519: bitstring = em1_5517 in
                                                {5967}if (verify(h(m1_5519),sigM1_5518,pkCli_5462) <> true) then
                                                    0
                                                else
                                                    {5968}let (=OpenSecureChannelRequest,=pkCli_5462,Nc_5520: bitstring) = m1_5519 in
                                                    {5969}new Ns_5521: bitstring;
                                                    {5970}new ST_5522: bitstring;
                                                    {5971}new TTL_5523: bitstring;
                                                    {5972}let m2_5524: bitstring = (OpenSecureChannelResponse,Ns_5521,ST_5522,TTL_5523) in
                                                    {5973}out(c, (m2_5524,sign(h(m2_5524),skSess)));
                                                    {5974}let Ksrv_5525: bitstring = h((Ns_5521,Nc_5520)) in
                                                    {5975}out(c, senc(mSrv(pkCli_5462,pkSess_5313),Ksrv_5525))
                                    )
                                    else
                                        {5976}let pkDisco_5526: bitstring = fail-any in
                                        {5977}in(c, (=pkCli_5462,em1_5527: bitstring,sigM1_5528: bitstring));
                                        {5978}let m1_5529: bitstring = em1_5527 in
                                        {5979}if (verify(h(m1_5529),sigM1_5528,pkCli_5462) <> true) then
                                            0
                                        else
                                            {5980}let (=OpenSecureChannelRequest,=pkCli_5462,Nc_5530: bitstring) = m1_5529 in
                                            {5981}new Ns_5531: bitstring;
                                            {5982}new ST_5532: bitstring;
                                            {5983}new TTL_5533: bitstring;
                                            {5984}let m2_5534: bitstring = (OpenSecureChannelResponse,Ns_5531,ST_5532,TTL_5533) in
                                            {5985}out(c, (m2_5534,sign(h(m2_5534),skSess)));
                                            {5986}let Ksrv_5535: bitstring = h((Ns_5531,Nc_5530)) in
                                            {5987}out(c, senc(mSrv(pkCli_5462,pkSess_5313),Ksrv_5535))
                                )
                                else
                                    {5988}let pkCli_5536: bitstring = pub(sk(Cli_5309)) in
                                    {5989}let v_5537: bool = (Disco_5310 = A) in
                                    (
                                        {5990}if v_5537 then
                                        (
                                            {5991}let pkDisco_5538: bitstring = pub(skA) in
                                            {5992}in(c, (=pkCli_5536,em1_5539: bitstring,sigM1_5540: bitstring));
                                            {5993}let m1_5541: bitstring = em1_5539 in
                                            {5994}if (verify(h(m1_5541),sigM1_5540,pkCli_5536) <> true) then
                                                0
                                            else
                                                {5995}let (=OpenSecureChannelRequest,=pkCli_5536,Nc_5542: bitstring) = m1_5541 in
                                                {5996}new Ns_5543: bitstring;
                                                {5997}new ST_5544: bitstring;
                                                {5998}new TTL_5545: bitstring;
                                                {5999}let m2_5546: bitstring = (OpenSecureChannelResponse,Ns_5543,ST_5544,TTL_5545) in
                                                {6000}out(c, (m2_5546,sign(h(m2_5546),skSess)));
                                                {6001}let Ksrv_5547: bitstring = h((Ns_5543,Nc_5542)) in
                                                {6002}out(c, senc(mSrv(pkCli_5536,pkSess_5313),Ksrv_5547))
                                        )
                                        else
                                            {6003}let v_5548: bool = (Disco_5310 = B) in
                                            (
                                                {6004}if v_5548 then
                                                (
                                                    {6005}let pkDisco_5549: bitstring = pub(skB) in
                                                    {6006}in(c, (=pkCli_5536,em1_5550: bitstring,sigM1_5551: bitstring));
                                                    {6007}let m1_5552: bitstring = em1_5550 in
                                                    {6008}if (verify(h(m1_5552),sigM1_5551,pkCli_5536) <> true) then
                                                        0
                                                    else
                                                        {6009}let (=OpenSecureChannelRequest,=pkCli_5536,Nc_5553: bitstring) = m1_5552 in
                                                        {6010}new Ns_5554: bitstring;
                                                        {6011}new ST_5555: bitstring;
                                                        {6012}new TTL_5556: bitstring;
                                                        {6013}let m2_5557: bitstring = (OpenSecureChannelResponse,Ns_5554,ST_5555,TTL_5556) in
                                                        {6014}out(c, (m2_5557,sign(h(m2_5557),skSess)));
                                                        {6015}let Ksrv_5558: bitstring = h((Ns_5554,Nc_5553)) in
                                                        {6016}out(c, senc(mSrv(pkCli_5536,pkSess_5313),Ksrv_5558))
                                                )
                                                else
                                                    {6017}let v_5559: bool = (Disco_5310 = C) in
                                                    (
                                                        {6018}if v_5559 then
                                                        (
                                                            {6019}let pkDisco_5560: bitstring = pub(skC) in
                                                            {6020}in(c, (=pkCli_5536,em1_5561: bitstring,sigM1_5562: bitstring));
                                                            {6021}let m1_5563: bitstring = em1_5561 in
                                                            {6022}if (verify(h(m1_5563),sigM1_5562,pkCli_5536) <> true) then
                                                                0
                                                            else
                                                                {6023}let (=OpenSecureChannelRequest,=pkCli_5536,Nc_5564: bitstring) = m1_5563 in
                                                                {6024}new Ns_5565: bitstring;
                                                                {6025}new ST_5566: bitstring;
                                                                {6026}new TTL_5567: bitstring;
                                                                {6027}let m2_5568: bitstring = (OpenSecureChannelResponse,Ns_5565,ST_5566,TTL_5567) in
                                                                {6028}out(c, (m2_5568,sign(h(m2_5568),skSess)));
                                                                {6029}let Ksrv_5569: bitstring = h((Ns_5565,Nc_5564)) in
                                                                {6030}out(c, senc(mSrv(pkCli_5536,pkSess_5313),Ksrv_5569))
                                                        )
                                                        else
                                                            {6031}let pkDisco_5570: bitstring = pub(sk(Disco_5310)) in
                                                            {6032}in(c, (=pkCli_5536,em1_5571: bitstring,sigM1_5572: bitstring));
                                                            {6033}let m1_5573: bitstring = em1_5571 in
                                                            {6034}if (verify(h(m1_5573),sigM1_5572,pkCli_5536) <> true) then
                                                                0
                                                            else
                                                                {6035}let (=OpenSecureChannelRequest,=pkCli_5536,Nc_5574: bitstring) = m1_5573 in
                                                                {6036}new Ns_5575: bitstring;
                                                                {6037}new ST_5576: bitstring;
                                                                {6038}new TTL_5577: bitstring;
                                                                {6039}let m2_5578: bitstring = (OpenSecureChannelResponse,Ns_5575,ST_5576,TTL_5577) in
                                                                {6040}out(c, (m2_5578,sign(h(m2_5578),skSess)));
                                                                {6041}let Ksrv_5579: bitstring = h((Ns_5575,Nc_5574)) in
                                                                {6042}out(c, senc(mSrv(pkCli_5536,pkSess_5313),Ksrv_5579))
                                                    )
                                                    else
                                                        {6043}let pkDisco_5580: bitstring = fail-any in
                                                        {6044}in(c, (=pkCli_5536,em1_5581: bitstring,sigM1_5582: bitstring));
                                                        {6045}let m1_5583: bitstring = em1_5581 in
                                                        {6046}if (verify(h(m1_5583),sigM1_5582,pkCli_5536) <> true) then
                                                            0
                                                        else
                                                            {6047}let (=OpenSecureChannelRequest,=pkCli_5536,Nc_5584: bitstring) = m1_5583 in
                                                            {6048}new Ns_5585: bitstring;
                                                            {6049}new ST_5586: bitstring;
                                                            {6050}new TTL_5587: bitstring;
                                                            {6051}let m2_5588: bitstring = (OpenSecureChannelResponse,Ns_5585,ST_5586,TTL_5587) in
                                                            {6052}out(c, (m2_5588,sign(h(m2_5588),skSess)));
                                                            {6053}let Ksrv_5589: bitstring = h((Ns_5585,Nc_5584)) in
                                                            {6054}out(c, senc(mSrv(pkCli_5536,pkSess_5313),Ksrv_5589))
                                            )
                                            else
                                                {6055}let pkDisco_5590: bitstring = fail-any in
                                                {6056}in(c, (=pkCli_5536,em1_5591: bitstring,sigM1_5592: bitstring));
                                                {6057}let m1_5593: bitstring = em1_5591 in
                                                {6058}if (verify(h(m1_5593),sigM1_5592,pkCli_5536) <> true) then
                                                    0
                                                else
                                                    {6059}let (=OpenSecureChannelRequest,=pkCli_5536,Nc_5594: bitstring) = m1_5593 in
                                                    {6060}new Ns_5595: bitstring;
                                                    {6061}new ST_5596: bitstring;
                                                    {6062}new TTL_5597: bitstring;
                                                    {6063}let m2_5598: bitstring = (OpenSecureChannelResponse,Ns_5595,ST_5596,TTL_5597) in
                                                    {6064}out(c, (m2_5598,sign(h(m2_5598),skSess)));
                                                    {6065}let Ksrv_5599: bitstring = h((Ns_5595,Nc_5594)) in
                                                    {6066}out(c, senc(mSrv(pkCli_5536,pkSess_5313),Ksrv_5599))
                                    )
                                    else
                                        {6067}let pkDisco_5600: bitstring = fail-any in
                                        {6068}in(c, (=pkCli_5536,em1_5601: bitstring,sigM1_5602: bitstring));
                                        {6069}let m1_5603: bitstring = em1_5601 in
                                        {6070}if (verify(h(m1_5603),sigM1_5602,pkCli_5536) <> true) then
                                            0
                                        else
                                            {6071}let (=OpenSecureChannelRequest,=pkCli_5536,Nc_5604: bitstring) = m1_5603 in
                                            {6072}new Ns_5605: bitstring;
                                            {6073}new ST_5606: bitstring;
                                            {6074}new TTL_5607: bitstring;
                                            {6075}let m2_5608: bitstring = (OpenSecureChannelResponse,Ns_5605,ST_5606,TTL_5607) in
                                            {6076}out(c, (m2_5608,sign(h(m2_5608),skSess)));
                                            {6077}let Ksrv_5609: bitstring = h((Ns_5605,Nc_5604)) in
                                            {6078}out(c, senc(mSrv(pkCli_5536,pkSess_5313),Ksrv_5609))
                            )
                            else
                                {6079}let pkCli_5610: bitstring = fail-any in
                                {6080}let v_5611: bool = (Disco_5310 = A) in
                                (
                                    {6081}if v_5611 then
                                    (
                                        {6082}let pkDisco_5612: bitstring = pub(skA) in
                                        {6083}in(c, (=pkCli_5610,em1_5613: bitstring,sigM1_5614: bitstring));
                                        {6084}let m1_5615: bitstring = em1_5613 in
                                        {6085}if (verify(h(m1_5615),sigM1_5614,pkCli_5610) <> true) then
                                            0
                                        else
                                            {6086}let (=OpenSecureChannelRequest,=pkCli_5610,Nc_5616: bitstring) = m1_5615 in
                                            {6087}new Ns_5617: bitstring;
                                            {6088}new ST_5618: bitstring;
                                            {6089}new TTL_5619: bitstring;
                                            {6090}let m2_5620: bitstring = (OpenSecureChannelResponse,Ns_5617,ST_5618,TTL_5619) in
                                            {6091}out(c, (m2_5620,sign(h(m2_5620),skSess)));
                                            {6092}let Ksrv_5621: bitstring = h((Ns_5617,Nc_5616)) in
                                            {6093}out(c, senc(mSrv(pkCli_5610,pkSess_5313),Ksrv_5621))
                                    )
                                    else
                                        {6094}let v_5622: bool = (Disco_5310 = B) in
                                        (
                                            {6095}if v_5622 then
                                            (
                                                {6096}let pkDisco_5623: bitstring = pub(skB) in
                                                {6097}in(c, (=pkCli_5610,em1_5624: bitstring,sigM1_5625: bitstring));
                                                {6098}let m1_5626: bitstring = em1_5624 in
                                                {6099}if (verify(h(m1_5626),sigM1_5625,pkCli_5610) <> true) then
                                                    0
                                                else
                                                    {6100}let (=OpenSecureChannelRequest,=pkCli_5610,Nc_5627: bitstring) = m1_5626 in
                                                    {6101}new Ns_5628: bitstring;
                                                    {6102}new ST_5629: bitstring;
                                                    {6103}new TTL_5630: bitstring;
                                                    {6104}let m2_5631: bitstring = (OpenSecureChannelResponse,Ns_5628,ST_5629,TTL_5630) in
                                                    {6105}out(c, (m2_5631,sign(h(m2_5631),skSess)));
                                                    {6106}let Ksrv_5632: bitstring = h((Ns_5628,Nc_5627)) in
                                                    {6107}out(c, senc(mSrv(pkCli_5610,pkSess_5313),Ksrv_5632))
                                            )
                                            else
                                                {6108}let v_5633: bool = (Disco_5310 = C) in
                                                (
                                                    {6109}if v_5633 then
                                                    (
                                                        {6110}let pkDisco_5634: bitstring = pub(skC) in
                                                        {6111}in(c, (=pkCli_5610,em1_5635: bitstring,sigM1_5636: bitstring));
                                                        {6112}let m1_5637: bitstring = em1_5635 in
                                                        {6113}if (verify(h(m1_5637),sigM1_5636,pkCli_5610) <> true) then
                                                            0
                                                        else
                                                            {6114}let (=OpenSecureChannelRequest,=pkCli_5610,Nc_5638: bitstring) = m1_5637 in
                                                            {6115}new Ns_5639: bitstring;
                                                            {6116}new ST_5640: bitstring;
                                                            {6117}new TTL_5641: bitstring;
                                                            {6118}let m2_5642: bitstring = (OpenSecureChannelResponse,Ns_5639,ST_5640,TTL_5641) in
                                                            {6119}out(c, (m2_5642,sign(h(m2_5642),skSess)));
                                                            {6120}let Ksrv_5643: bitstring = h((Ns_5639,Nc_5638)) in
                                                            {6121}out(c, senc(mSrv(pkCli_5610,pkSess_5313),Ksrv_5643))
                                                    )
                                                    else
                                                        {6122}let pkDisco_5644: bitstring = pub(sk(Disco_5310)) in
                                                        {6123}in(c, (=pkCli_5610,em1_5645: bitstring,sigM1_5646: bitstring));
                                                        {6124}let m1_5647: bitstring = em1_5645 in
                                                        {6125}if (verify(h(m1_5647),sigM1_5646,pkCli_5610) <> true) then
                                                            0
                                                        else
                                                            {6126}let (=OpenSecureChannelRequest,=pkCli_5610,Nc_5648: bitstring) = m1_5647 in
                                                            {6127}new Ns_5649: bitstring;
                                                            {6128}new ST_5650: bitstring;
                                                            {6129}new TTL_5651: bitstring;
                                                            {6130}let m2_5652: bitstring = (OpenSecureChannelResponse,Ns_5649,ST_5650,TTL_5651) in
                                                            {6131}out(c, (m2_5652,sign(h(m2_5652),skSess)));
                                                            {6132}let Ksrv_5653: bitstring = h((Ns_5649,Nc_5648)) in
                                                            {6133}out(c, senc(mSrv(pkCli_5610,pkSess_5313),Ksrv_5653))
                                                )
                                                else
                                                    {6134}let pkDisco_5654: bitstring = fail-any in
                                                    {6135}in(c, (=pkCli_5610,em1_5655: bitstring,sigM1_5656: bitstring));
                                                    {6136}let m1_5657: bitstring = em1_5655 in
                                                    {6137}if (verify(h(m1_5657),sigM1_5656,pkCli_5610) <> true) then
                                                        0
                                                    else
                                                        {6138}let (=OpenSecureChannelRequest,=pkCli_5610,Nc_5658: bitstring) = m1_5657 in
                                                        {6139}new Ns_5659: bitstring;
                                                        {6140}new ST_5660: bitstring;
                                                        {6141}new TTL_5661: bitstring;
                                                        {6142}let m2_5662: bitstring = (OpenSecureChannelResponse,Ns_5659,ST_5660,TTL_5661) in
                                                        {6143}out(c, (m2_5662,sign(h(m2_5662),skSess)));
                                                        {6144}let Ksrv_5663: bitstring = h((Ns_5659,Nc_5658)) in
                                                        {6145}out(c, senc(mSrv(pkCli_5610,pkSess_5313),Ksrv_5663))
                                        )
                                        else
                                            {6146}let pkDisco_5664: bitstring = fail-any in
                                            {6147}in(c, (=pkCli_5610,em1_5665: bitstring,sigM1_5666: bitstring));
                                            {6148}let m1_5667: bitstring = em1_5665 in
                                            {6149}if (verify(h(m1_5667),sigM1_5666,pkCli_5610) <> true) then
                                                0
                                            else
                                                {6150}let (=OpenSecureChannelRequest,=pkCli_5610,Nc_5668: bitstring) = m1_5667 in
                                                {6151}new Ns_5669: bitstring;
                                                {6152}new ST_5670: bitstring;
                                                {6153}new TTL_5671: bitstring;
                                                {6154}let m2_5672: bitstring = (OpenSecureChannelResponse,Ns_5669,ST_5670,TTL_5671) in
                                                {6155}out(c, (m2_5672,sign(h(m2_5672),skSess)));
                                                {6156}let Ksrv_5673: bitstring = h((Ns_5669,Nc_5668)) in
                                                {6157}out(c, senc(mSrv(pkCli_5610,pkSess_5313),Ksrv_5673))
                                )
                                else
                                    {6158}let pkDisco_5674: bitstring = fail-any in
                                    {6159}in(c, (=pkCli_5610,em1_5675: bitstring,sigM1_5676: bitstring));
                                    {6160}let m1_5677: bitstring = em1_5675 in
                                    {6161}if (verify(h(m1_5677),sigM1_5676,pkCli_5610) <> true) then
                                        0
                                    else
                                        {6162}let (=OpenSecureChannelRequest,=pkCli_5610,Nc_5678: bitstring) = m1_5677 in
                                        {6163}new Ns_5679: bitstring;
                                        {6164}new ST_5680: bitstring;
                                        {6165}new TTL_5681: bitstring;
                                        {6166}let m2_5682: bitstring = (OpenSecureChannelResponse,Ns_5679,ST_5680,TTL_5681) in
                                        {6167}out(c, (m2_5682,sign(h(m2_5682),skSess)));
                                        {6168}let Ksrv_5683: bitstring = h((Ns_5679,Nc_5678)) in
                                        {6169}out(c, senc(mSrv(pkCli_5610,pkSess_5313),Ksrv_5683))
                    )
                    else
                        {6170}let pkCli_5684: bitstring = fail-any in
                        {6171}let v_5685: bool = (Disco_5310 = A) in
                        (
                            {6172}if v_5685 then
                            (
                                {6173}let pkDisco_5686: bitstring = pub(skA) in
                                {6174}in(c, (=pkCli_5684,em1_5687: bitstring,sigM1_5688: bitstring));
                                {6175}let m1_5689: bitstring = em1_5687 in
                                {6176}if (verify(h(m1_5689),sigM1_5688,pkCli_5684) <> true) then
                                    0
                                else
                                    {6177}let (=OpenSecureChannelRequest,=pkCli_5684,Nc_5690: bitstring) = m1_5689 in
                                    {6178}new Ns_5691: bitstring;
                                    {6179}new ST_5692: bitstring;
                                    {6180}new TTL_5693: bitstring;
                                    {6181}let m2_5694: bitstring = (OpenSecureChannelResponse,Ns_5691,ST_5692,TTL_5693) in
                                    {6182}out(c, (m2_5694,sign(h(m2_5694),skSess)));
                                    {6183}let Ksrv_5695: bitstring = h((Ns_5691,Nc_5690)) in
                                    {6184}out(c, senc(mSrv(pkCli_5684,pkSess_5313),Ksrv_5695))
                            )
                            else
                                {6185}let v_5696: bool = (Disco_5310 = B) in
                                (
                                    {6186}if v_5696 then
                                    (
                                        {6187}let pkDisco_5697: bitstring = pub(skB) in
                                        {6188}in(c, (=pkCli_5684,em1_5698: bitstring,sigM1_5699: bitstring));
                                        {6189}let m1_5700: bitstring = em1_5698 in
                                        {6190}if (verify(h(m1_5700),sigM1_5699,pkCli_5684) <> true) then
                                            0
                                        else
                                            {6191}let (=OpenSecureChannelRequest,=pkCli_5684,Nc_5701: bitstring) = m1_5700 in
                                            {6192}new Ns_5702: bitstring;
                                            {6193}new ST_5703: bitstring;
                                            {6194}new TTL_5704: bitstring;
                                            {6195}let m2_5705: bitstring = (OpenSecureChannelResponse,Ns_5702,ST_5703,TTL_5704) in
                                            {6196}out(c, (m2_5705,sign(h(m2_5705),skSess)));
                                            {6197}let Ksrv_5706: bitstring = h((Ns_5702,Nc_5701)) in
                                            {6198}out(c, senc(mSrv(pkCli_5684,pkSess_5313),Ksrv_5706))
                                    )
                                    else
                                        {6199}let v_5707: bool = (Disco_5310 = C) in
                                        (
                                            {6200}if v_5707 then
                                            (
                                                {6201}let pkDisco_5708: bitstring = pub(skC) in
                                                {6202}in(c, (=pkCli_5684,em1_5709: bitstring,sigM1_5710: bitstring));
                                                {6203}let m1_5711: bitstring = em1_5709 in
                                                {6204}if (verify(h(m1_5711),sigM1_5710,pkCli_5684) <> true) then
                                                    0
                                                else
                                                    {6205}let (=OpenSecureChannelRequest,=pkCli_5684,Nc_5712: bitstring) = m1_5711 in
                                                    {6206}new Ns_5713: bitstring;
                                                    {6207}new ST_5714: bitstring;
                                                    {6208}new TTL_5715: bitstring;
                                                    {6209}let m2_5716: bitstring = (OpenSecureChannelResponse,Ns_5713,ST_5714,TTL_5715) in
                                                    {6210}out(c, (m2_5716,sign(h(m2_5716),skSess)));
                                                    {6211}let Ksrv_5717: bitstring = h((Ns_5713,Nc_5712)) in
                                                    {6212}out(c, senc(mSrv(pkCli_5684,pkSess_5313),Ksrv_5717))
                                            )
                                            else
                                                {6213}let pkDisco_5718: bitstring = pub(sk(Disco_5310)) in
                                                {6214}in(c, (=pkCli_5684,em1_5719: bitstring,sigM1_5720: bitstring));
                                                {6215}let m1_5721: bitstring = em1_5719 in
                                                {6216}if (verify(h(m1_5721),sigM1_5720,pkCli_5684) <> true) then
                                                    0
                                                else
                                                    {6217}let (=OpenSecureChannelRequest,=pkCli_5684,Nc_5722: bitstring) = m1_5721 in
                                                    {6218}new Ns_5723: bitstring;
                                                    {6219}new ST_5724: bitstring;
                                                    {6220}new TTL_5725: bitstring;
                                                    {6221}let m2_5726: bitstring = (OpenSecureChannelResponse,Ns_5723,ST_5724,TTL_5725) in
                                                    {6222}out(c, (m2_5726,sign(h(m2_5726),skSess)));
                                                    {6223}let Ksrv_5727: bitstring = h((Ns_5723,Nc_5722)) in
                                                    {6224}out(c, senc(mSrv(pkCli_5684,pkSess_5313),Ksrv_5727))
                                        )
                                        else
                                            {6225}let pkDisco_5728: bitstring = fail-any in
                                            {6226}in(c, (=pkCli_5684,em1_5729: bitstring,sigM1_5730: bitstring));
                                            {6227}let m1_5731: bitstring = em1_5729 in
                                            {6228}if (verify(h(m1_5731),sigM1_5730,pkCli_5684) <> true) then
                                                0
                                            else
                                                {6229}let (=OpenSecureChannelRequest,=pkCli_5684,Nc_5732: bitstring) = m1_5731 in
                                                {6230}new Ns_5733: bitstring;
                                                {6231}new ST_5734: bitstring;
                                                {6232}new TTL_5735: bitstring;
                                                {6233}let m2_5736: bitstring = (OpenSecureChannelResponse,Ns_5733,ST_5734,TTL_5735) in
                                                {6234}out(c, (m2_5736,sign(h(m2_5736),skSess)));
                                                {6235}let Ksrv_5737: bitstring = h((Ns_5733,Nc_5732)) in
                                                {6236}out(c, senc(mSrv(pkCli_5684,pkSess_5313),Ksrv_5737))
                                )
                                else
                                    {6237}let pkDisco_5738: bitstring = fail-any in
                                    {6238}in(c, (=pkCli_5684,em1_5739: bitstring,sigM1_5740: bitstring));
                                    {6239}let m1_5741: bitstring = em1_5739 in
                                    {6240}if (verify(h(m1_5741),sigM1_5740,pkCli_5684) <> true) then
                                        0
                                    else
                                        {6241}let (=OpenSecureChannelRequest,=pkCli_5684,Nc_5742: bitstring) = m1_5741 in
                                        {6242}new Ns_5743: bitstring;
                                        {6243}new ST_5744: bitstring;
                                        {6244}new TTL_5745: bitstring;
                                        {6245}let m2_5746: bitstring = (OpenSecureChannelResponse,Ns_5743,ST_5744,TTL_5745) in
                                        {6246}out(c, (m2_5746,sign(h(m2_5746),skSess)));
                                        {6247}let Ksrv_5747: bitstring = h((Ns_5743,Nc_5742)) in
                                        {6248}out(c, senc(mSrv(pkCli_5684,pkSess_5313),Ksrv_5747))
                        )
                        else
                            {6249}let pkDisco_5748: bitstring = fail-any in
                            {6250}in(c, (=pkCli_5684,em1_5749: bitstring,sigM1_5750: bitstring));
                            {6251}let m1_5751: bitstring = em1_5749 in
                            {6252}if (verify(h(m1_5751),sigM1_5750,pkCli_5684) <> true) then
                                0
                            else
                                {6253}let (=OpenSecureChannelRequest,=pkCli_5684,Nc_5752: bitstring) = m1_5751 in
                                {6254}new Ns_5753: bitstring;
                                {6255}new ST_5754: bitstring;
                                {6256}new TTL_5755: bitstring;
                                {6257}let m2_5756: bitstring = (OpenSecureChannelResponse,Ns_5753,ST_5754,TTL_5755) in
                                {6258}out(c, (m2_5756,sign(h(m2_5756),skSess)));
                                {6259}let Ksrv_5757: bitstring = h((Ns_5753,Nc_5752)) in
                                {6260}out(c, senc(mSrv(pkCli_5684,pkSess_5313),Ksrv_5757))
            )
            else
                {6261}let pkCli_5758: bitstring = fail-any in
                {6262}let v_5759: bool = (Disco_5310 = A) in
                (
                    {6263}if v_5759 then
                    (
                        {6264}let pkDisco_5760: bitstring = pub(skA) in
                        {6265}in(c, (=pkCli_5758,em1_5761: bitstring,sigM1_5762: bitstring));
                        {6266}let m1_5763: bitstring = em1_5761 in
                        {6267}if (verify(h(m1_5763),sigM1_5762,pkCli_5758) <> true) then
                            0
                        else
                            {6268}let (=OpenSecureChannelRequest,=pkCli_5758,Nc_5764: bitstring) = m1_5763 in
                            {6269}new Ns_5765: bitstring;
                            {6270}new ST_5766: bitstring;
                            {6271}new TTL_5767: bitstring;
                            {6272}let m2_5768: bitstring = (OpenSecureChannelResponse,Ns_5765,ST_5766,TTL_5767) in
                            {6273}out(c, (m2_5768,sign(h(m2_5768),skSess)));
                            {6274}let Ksrv_5769: bitstring = h((Ns_5765,Nc_5764)) in
                            {6275}out(c, senc(mSrv(pkCli_5758,pkSess_5313),Ksrv_5769))
                    )
                    else
                        {6276}let v_5770: bool = (Disco_5310 = B) in
                        (
                            {6277}if v_5770 then
                            (
                                {6278}let pkDisco_5771: bitstring = pub(skB) in
                                {6279}in(c, (=pkCli_5758,em1_5772: bitstring,sigM1_5773: bitstring));
                                {6280}let m1_5774: bitstring = em1_5772 in
                                {6281}if (verify(h(m1_5774),sigM1_5773,pkCli_5758) <> true) then
                                    0
                                else
                                    {6282}let (=OpenSecureChannelRequest,=pkCli_5758,Nc_5775: bitstring) = m1_5774 in
                                    {6283}new Ns_5776: bitstring;
                                    {6284}new ST_5777: bitstring;
                                    {6285}new TTL_5778: bitstring;
                                    {6286}let m2_5779: bitstring = (OpenSecureChannelResponse,Ns_5776,ST_5777,TTL_5778) in
                                    {6287}out(c, (m2_5779,sign(h(m2_5779),skSess)));
                                    {6288}let Ksrv_5780: bitstring = h((Ns_5776,Nc_5775)) in
                                    {6289}out(c, senc(mSrv(pkCli_5758,pkSess_5313),Ksrv_5780))
                            )
                            else
                                {6290}let v_5781: bool = (Disco_5310 = C) in
                                (
                                    {6291}if v_5781 then
                                    (
                                        {6292}let pkDisco_5782: bitstring = pub(skC) in
                                        {6293}in(c, (=pkCli_5758,em1_5783: bitstring,sigM1_5784: bitstring));
                                        {6294}let m1_5785: bitstring = em1_5783 in
                                        {6295}if (verify(h(m1_5785),sigM1_5784,pkCli_5758) <> true) then
                                            0
                                        else
                                            {6296}let (=OpenSecureChannelRequest,=pkCli_5758,Nc_5786: bitstring) = m1_5785 in
                                            {6297}new Ns_5787: bitstring;
                                            {6298}new ST_5788: bitstring;
                                            {6299}new TTL_5789: bitstring;
                                            {6300}let m2_5790: bitstring = (OpenSecureChannelResponse,Ns_5787,ST_5788,TTL_5789) in
                                            {6301}out(c, (m2_5790,sign(h(m2_5790),skSess)));
                                            {6302}let Ksrv_5791: bitstring = h((Ns_5787,Nc_5786)) in
                                            {6303}out(c, senc(mSrv(pkCli_5758,pkSess_5313),Ksrv_5791))
                                    )
                                    else
                                        {6304}let pkDisco_5792: bitstring = pub(sk(Disco_5310)) in
                                        {6305}in(c, (=pkCli_5758,em1_5793: bitstring,sigM1_5794: bitstring));
                                        {6306}let m1_5795: bitstring = em1_5793 in
                                        {6307}if (verify(h(m1_5795),sigM1_5794,pkCli_5758) <> true) then
                                            0
                                        else
                                            {6308}let (=OpenSecureChannelRequest,=pkCli_5758,Nc_5796: bitstring) = m1_5795 in
                                            {6309}new Ns_5797: bitstring;
                                            {6310}new ST_5798: bitstring;
                                            {6311}new TTL_5799: bitstring;
                                            {6312}let m2_5800: bitstring = (OpenSecureChannelResponse,Ns_5797,ST_5798,TTL_5799) in
                                            {6313}out(c, (m2_5800,sign(h(m2_5800),skSess)));
                                            {6314}let Ksrv_5801: bitstring = h((Ns_5797,Nc_5796)) in
                                            {6315}out(c, senc(mSrv(pkCli_5758,pkSess_5313),Ksrv_5801))
                                )
                                else
                                    {6316}let pkDisco_5802: bitstring = fail-any in
                                    {6317}in(c, (=pkCli_5758,em1_5803: bitstring,sigM1_5804: bitstring));
                                    {6318}let m1_5805: bitstring = em1_5803 in
                                    {6319}if (verify(h(m1_5805),sigM1_5804,pkCli_5758) <> true) then
                                        0
                                    else
                                        {6320}let (=OpenSecureChannelRequest,=pkCli_5758,Nc_5806: bitstring) = m1_5805 in
                                        {6321}new Ns_5807: bitstring;
                                        {6322}new ST_5808: bitstring;
                                        {6323}new TTL_5809: bitstring;
                                        {6324}let m2_5810: bitstring = (OpenSecureChannelResponse,Ns_5807,ST_5808,TTL_5809) in
                                        {6325}out(c, (m2_5810,sign(h(m2_5810),skSess)));
                                        {6326}let Ksrv_5811: bitstring = h((Ns_5807,Nc_5806)) in
                                        {6327}out(c, senc(mSrv(pkCli_5758,pkSess_5313),Ksrv_5811))
                        )
                        else
                            {6328}let pkDisco_5812: bitstring = fail-any in
                            {6329}in(c, (=pkCli_5758,em1_5813: bitstring,sigM1_5814: bitstring));
                            {6330}let m1_5815: bitstring = em1_5813 in
                            {6331}if (verify(h(m1_5815),sigM1_5814,pkCli_5758) <> true) then
                                0
                            else
                                {6332}let (=OpenSecureChannelRequest,=pkCli_5758,Nc_5816: bitstring) = m1_5815 in
                                {6333}new Ns_5817: bitstring;
                                {6334}new ST_5818: bitstring;
                                {6335}new TTL_5819: bitstring;
                                {6336}let m2_5820: bitstring = (OpenSecureChannelResponse,Ns_5817,ST_5818,TTL_5819) in
                                {6337}out(c, (m2_5820,sign(h(m2_5820),skSess)));
                                {6338}let Ksrv_5821: bitstring = h((Ns_5817,Nc_5816)) in
                                {6339}out(c, senc(mSrv(pkCli_5758,pkSess_5313),Ksrv_5821))
                )
                else
                    {6340}let pkDisco_5822: bitstring = fail-any in
                    {6341}in(c, (=pkCli_5758,em1_5823: bitstring,sigM1_5824: bitstring));
                    {6342}let m1_5825: bitstring = em1_5823 in
                    {6343}if (verify(h(m1_5825),sigM1_5824,pkCli_5758) <> true) then
                        0
                    else
                        {6344}let (=OpenSecureChannelRequest,=pkCli_5758,Nc_5826: bitstring) = m1_5825 in
                        {6345}new Ns_5827: bitstring;
                        {6346}new ST_5828: bitstring;
                        {6347}new TTL_5829: bitstring;
                        {6348}let m2_5830: bitstring = (OpenSecureChannelResponse,Ns_5827,ST_5828,TTL_5829) in
                        {6349}out(c, (m2_5830,sign(h(m2_5830),skSess)));
                        {6350}let Ksrv_5831: bitstring = h((Ns_5827,Nc_5826)) in
                        {6351}out(c, senc(mSrv(pkCli_5758,pkSess_5313),Ksrv_5831))
        )
        else
            {6352}let v_5832: bool = (Sess_5311 = B) in
            (
                {6353}if v_5832 then
                (
                    {6354}let skSess_5833: bitstring = skB in
                    {6355}let pkSess_5834: bitstring = pub(skSess_5833) in
                    {6356}let v_5835: bool = (Cli_5309 = A) in
                    (
                        {6357}if v_5835 then
                        (
                            {6358}let pkCli_5836: bitstring = pub(skA) in
                            {6359}let v_5837: bool = (Disco_5310 = A) in
                            (
                                {6360}if v_5837 then
                                (
                                    {6361}let pkDisco_5838: bitstring = pub(skA) in
                                    {6362}in(c, (=pkCli_5836,em1_5839: bitstring,sigM1_5840: bitstring));
                                    {6363}let m1_5841: bitstring = em1_5839 in
                                    {6364}if (verify(h(m1_5841),sigM1_5840,pkCli_5836) <> true) then
                                        0
                                    else
                                        {6365}let (=OpenSecureChannelRequest,=pkCli_5836,Nc_5842: bitstring) = m1_5841 in
                                        {6366}new Ns_5843: bitstring;
                                        {6367}new ST_5844: bitstring;
                                        {6368}new TTL_5845: bitstring;
                                        {6369}let m2_5846: bitstring = (OpenSecureChannelResponse,Ns_5843,ST_5844,TTL_5845) in
                                        {6370}out(c, (m2_5846,sign(h(m2_5846),skSess_5833)));
                                        {6371}let Ksrv_5847: bitstring = h((Ns_5843,Nc_5842)) in
                                        {6372}out(c, senc(mSrv(pkCli_5836,pkSess_5834),Ksrv_5847))
                                )
                                else
                                    {6373}let v_5848: bool = (Disco_5310 = B) in
                                    (
                                        {6374}if v_5848 then
                                        (
                                            {6375}let pkDisco_5849: bitstring = pub(skB) in
                                            {6376}in(c, (=pkCli_5836,em1_5850: bitstring,sigM1_5851: bitstring));
                                            {6377}let m1_5852: bitstring = em1_5850 in
                                            {6378}if (verify(h(m1_5852),sigM1_5851,pkCli_5836) <> true) then
                                                0
                                            else
                                                {6379}let (=OpenSecureChannelRequest,=pkCli_5836,Nc_5853: bitstring) = m1_5852 in
                                                {6380}new Ns_5854: bitstring;
                                                {6381}new ST_5855: bitstring;
                                                {6382}new TTL_5856: bitstring;
                                                {6383}let m2_5857: bitstring = (OpenSecureChannelResponse,Ns_5854,ST_5855,TTL_5856) in
                                                {6384}out(c, (m2_5857,sign(h(m2_5857),skSess_5833)));
                                                {6385}let Ksrv_5858: bitstring = h((Ns_5854,Nc_5853)) in
                                                {6386}out(c, senc(mSrv(pkCli_5836,pkSess_5834),Ksrv_5858))
                                        )
                                        else
                                            {6387}let v_5859: bool = (Disco_5310 = C) in
                                            (
                                                {6388}if v_5859 then
                                                (
                                                    {6389}let pkDisco_5860: bitstring = pub(skC) in
                                                    {6390}in(c, (=pkCli_5836,em1_5861: bitstring,sigM1_5862: bitstring));
                                                    {6391}let m1_5863: bitstring = em1_5861 in
                                                    {6392}if (verify(h(m1_5863),sigM1_5862,pkCli_5836) <> true) then
                                                        0
                                                    else
                                                        {6393}let (=OpenSecureChannelRequest,=pkCli_5836,Nc_5864: bitstring) = m1_5863 in
                                                        {6394}new Ns_5865: bitstring;
                                                        {6395}new ST_5866: bitstring;
                                                        {6396}new TTL_5867: bitstring;
                                                        {6397}let m2_5868: bitstring = (OpenSecureChannelResponse,Ns_5865,ST_5866,TTL_5867) in
                                                        {6398}out(c, (m2_5868,sign(h(m2_5868),skSess_5833)));
                                                        {6399}let Ksrv_5869: bitstring = h((Ns_5865,Nc_5864)) in
                                                        {6400}out(c, senc(mSrv(pkCli_5836,pkSess_5834),Ksrv_5869))
                                                )
                                                else
                                                    {6401}let pkDisco_5870: bitstring = pub(sk(Disco_5310)) in
                                                    {6402}in(c, (=pkCli_5836,em1_5871: bitstring,sigM1_5872: bitstring));
                                                    {6403}let m1_5873: bitstring = em1_5871 in
                                                    {6404}if (verify(h(m1_5873),sigM1_5872,pkCli_5836) <> true) then
                                                        0
                                                    else
                                                        {6405}let (=OpenSecureChannelRequest,=pkCli_5836,Nc_5874: bitstring) = m1_5873 in
                                                        {6406}new Ns_5875: bitstring;
                                                        {6407}new ST_5876: bitstring;
                                                        {6408}new TTL_5877: bitstring;
                                                        {6409}let m2_5878: bitstring = (OpenSecureChannelResponse,Ns_5875,ST_5876,TTL_5877) in
                                                        {6410}out(c, (m2_5878,sign(h(m2_5878),skSess_5833)));
                                                        {6411}let Ksrv_5879: bitstring = h((Ns_5875,Nc_5874)) in
                                                        {6412}out(c, senc(mSrv(pkCli_5836,pkSess_5834),Ksrv_5879))
                                            )
                                            else
                                                {6413}let pkDisco_5880: bitstring = fail-any in
                                                {6414}in(c, (=pkCli_5836,em1_5881: bitstring,sigM1_5882: bitstring));
                                                {6415}let m1_5883: bitstring = em1_5881 in
                                                {6416}if (verify(h(m1_5883),sigM1_5882,pkCli_5836) <> true) then
                                                    0
                                                else
                                                    {6417}let (=OpenSecureChannelRequest,=pkCli_5836,Nc_5884: bitstring) = m1_5883 in
                                                    {6418}new Ns_5885: bitstring;
                                                    {6419}new ST_5886: bitstring;
                                                    {6420}new TTL_5887: bitstring;
                                                    {6421}let m2_5888: bitstring = (OpenSecureChannelResponse,Ns_5885,ST_5886,TTL_5887) in
                                                    {6422}out(c, (m2_5888,sign(h(m2_5888),skSess_5833)));
                                                    {6423}let Ksrv_5889: bitstring = h((Ns_5885,Nc_5884)) in
                                                    {6424}out(c, senc(mSrv(pkCli_5836,pkSess_5834),Ksrv_5889))
                                    )
                                    else
                                        {6425}let pkDisco_5890: bitstring = fail-any in
                                        {6426}in(c, (=pkCli_5836,em1_5891: bitstring,sigM1_5892: bitstring));
                                        {6427}let m1_5893: bitstring = em1_5891 in
                                        {6428}if (verify(h(m1_5893),sigM1_5892,pkCli_5836) <> true) then
                                            0
                                        else
                                            {6429}let (=OpenSecureChannelRequest,=pkCli_5836,Nc_5894: bitstring) = m1_5893 in
                                            {6430}new Ns_5895: bitstring;
                                            {6431}new ST_5896: bitstring;
                                            {6432}new TTL_5897: bitstring;
                                            {6433}let m2_5898: bitstring = (OpenSecureChannelResponse,Ns_5895,ST_5896,TTL_5897) in
                                            {6434}out(c, (m2_5898,sign(h(m2_5898),skSess_5833)));
                                            {6435}let Ksrv_5899: bitstring = h((Ns_5895,Nc_5894)) in
                                            {6436}out(c, senc(mSrv(pkCli_5836,pkSess_5834),Ksrv_5899))
                            )
                            else
                                {6437}let pkDisco_5900: bitstring = fail-any in
                                {6438}in(c, (=pkCli_5836,em1_5901: bitstring,sigM1_5902: bitstring));
                                {6439}let m1_5903: bitstring = em1_5901 in
                                {6440}if (verify(h(m1_5903),sigM1_5902,pkCli_5836) <> true) then
                                    0
                                else
                                    {6441}let (=OpenSecureChannelRequest,=pkCli_5836,Nc_5904: bitstring) = m1_5903 in
                                    {6442}new Ns_5905: bitstring;
                                    {6443}new ST_5906: bitstring;
                                    {6444}new TTL_5907: bitstring;
                                    {6445}let m2_5908: bitstring = (OpenSecureChannelResponse,Ns_5905,ST_5906,TTL_5907) in
                                    {6446}out(c, (m2_5908,sign(h(m2_5908),skSess_5833)));
                                    {6447}let Ksrv_5909: bitstring = h((Ns_5905,Nc_5904)) in
                                    {6448}out(c, senc(mSrv(pkCli_5836,pkSess_5834),Ksrv_5909))
                        )
                        else
                            {6449}let v_5910: bool = (Cli_5309 = B) in
                            (
                                {6450}if v_5910 then
                                (
                                    {6451}let pkCli_5911: bitstring = pub(skB) in
                                    {6452}let v_5912: bool = (Disco_5310 = A) in
                                    (
                                        {6453}if v_5912 then
                                        (
                                            {6454}let pkDisco_5913: bitstring = pub(skA) in
                                            {6455}in(c, (=pkCli_5911,em1_5914: bitstring,sigM1_5915: bitstring));
                                            {6456}let m1_5916: bitstring = em1_5914 in
                                            {6457}if (verify(h(m1_5916),sigM1_5915,pkCli_5911) <> true) then
                                                0
                                            else
                                                {6458}let (=OpenSecureChannelRequest,=pkCli_5911,Nc_5917: bitstring) = m1_5916 in
                                                {6459}new Ns_5918: bitstring;
                                                {6460}new ST_5919: bitstring;
                                                {6461}new TTL_5920: bitstring;
                                                {6462}let m2_5921: bitstring = (OpenSecureChannelResponse,Ns_5918,ST_5919,TTL_5920) in
                                                {6463}out(c, (m2_5921,sign(h(m2_5921),skSess_5833)));
                                                {6464}let Ksrv_5922: bitstring = h((Ns_5918,Nc_5917)) in
                                                {6465}out(c, senc(mSrv(pkCli_5911,pkSess_5834),Ksrv_5922))
                                        )
                                        else
                                            {6466}let v_5923: bool = (Disco_5310 = B) in
                                            (
                                                {6467}if v_5923 then
                                                (
                                                    {6468}let pkDisco_5924: bitstring = pub(skB) in
                                                    {6469}in(c, (=pkCli_5911,em1_5925: bitstring,sigM1_5926: bitstring));
                                                    {6470}let m1_5927: bitstring = em1_5925 in
                                                    {6471}if (verify(h(m1_5927),sigM1_5926,pkCli_5911) <> true) then
                                                        0
                                                    else
                                                        {6472}let (=OpenSecureChannelRequest,=pkCli_5911,Nc_5928: bitstring) = m1_5927 in
                                                        {6473}new Ns_5929: bitstring;
                                                        {6474}new ST_5930: bitstring;
                                                        {6475}new TTL_5931: bitstring;
                                                        {6476}let m2_5932: bitstring = (OpenSecureChannelResponse,Ns_5929,ST_5930,TTL_5931) in
                                                        {6477}out(c, (m2_5932,sign(h(m2_5932),skSess_5833)));
                                                        {6478}let Ksrv_5933: bitstring = h((Ns_5929,Nc_5928)) in
                                                        {6479}out(c, senc(mSrv(pkCli_5911,pkSess_5834),Ksrv_5933))
                                                )
                                                else
                                                    {6480}let v_5934: bool = (Disco_5310 = C) in
                                                    (
                                                        {6481}if v_5934 then
                                                        (
                                                            {6482}let pkDisco_5935: bitstring = pub(skC) in
                                                            {6483}in(c, (=pkCli_5911,em1_5936: bitstring,sigM1_5937: bitstring));
                                                            {6484}let m1_5938: bitstring = em1_5936 in
                                                            {6485}if (verify(h(m1_5938),sigM1_5937,pkCli_5911) <> true) then
                                                                0
                                                            else
                                                                {6486}let (=OpenSecureChannelRequest,=pkCli_5911,Nc_5939: bitstring) = m1_5938 in
                                                                {6487}new Ns_5940: bitstring;
                                                                {6488}new ST_5941: bitstring;
                                                                {6489}new TTL_5942: bitstring;
                                                                {6490}let m2_5943: bitstring = (OpenSecureChannelResponse,Ns_5940,ST_5941,TTL_5942) in
                                                                {6491}out(c, (m2_5943,sign(h(m2_5943),skSess_5833)));
                                                                {6492}let Ksrv_5944: bitstring = h((Ns_5940,Nc_5939)) in
                                                                {6493}out(c, senc(mSrv(pkCli_5911,pkSess_5834),Ksrv_5944))
                                                        )
                                                        else
                                                            {6494}let pkDisco_5945: bitstring = pub(sk(Disco_5310)) in
                                                            {6495}in(c, (=pkCli_5911,em1_5946: bitstring,sigM1_5947: bitstring));
                                                            {6496}let m1_5948: bitstring = em1_5946 in
                                                            {6497}if (verify(h(m1_5948),sigM1_5947,pkCli_5911) <> true) then
                                                                0
                                                            else
                                                                {6498}let (=OpenSecureChannelRequest,=pkCli_5911,Nc_5949: bitstring) = m1_5948 in
                                                                {6499}new Ns_5950: bitstring;
                                                                {6500}new ST_5951: bitstring;
                                                                {6501}new TTL_5952: bitstring;
                                                                {6502}let m2_5953: bitstring = (OpenSecureChannelResponse,Ns_5950,ST_5951,TTL_5952) in
                                                                {6503}out(c, (m2_5953,sign(h(m2_5953),skSess_5833)));
                                                                {6504}let Ksrv_5954: bitstring = h((Ns_5950,Nc_5949)) in
                                                                {6505}out(c, senc(mSrv(pkCli_5911,pkSess_5834),Ksrv_5954))
                                                    )
                                                    else
                                                        {6506}let pkDisco_5955: bitstring = fail-any in
                                                        {6507}in(c, (=pkCli_5911,em1_5956: bitstring,sigM1_5957: bitstring));
                                                        {6508}let m1_5958: bitstring = em1_5956 in
                                                        {6509}if (verify(h(m1_5958),sigM1_5957,pkCli_5911) <> true) then
                                                            0
                                                        else
                                                            {6510}let (=OpenSecureChannelRequest,=pkCli_5911,Nc_5959: bitstring) = m1_5958 in
                                                            {6511}new Ns_5960: bitstring;
                                                            {6512}new ST_5961: bitstring;
                                                            {6513}new TTL_5962: bitstring;
                                                            {6514}let m2_5963: bitstring = (OpenSecureChannelResponse,Ns_5960,ST_5961,TTL_5962) in
                                                            {6515}out(c, (m2_5963,sign(h(m2_5963),skSess_5833)));
                                                            {6516}let Ksrv_5964: bitstring = h((Ns_5960,Nc_5959)) in
                                                            {6517}out(c, senc(mSrv(pkCli_5911,pkSess_5834),Ksrv_5964))
                                            )
                                            else
                                                {6518}let pkDisco_5965: bitstring = fail-any in
                                                {6519}in(c, (=pkCli_5911,em1_5966: bitstring,sigM1_5967: bitstring));
                                                {6520}let m1_5968: bitstring = em1_5966 in
                                                {6521}if (verify(h(m1_5968),sigM1_5967,pkCli_5911) <> true) then
                                                    0
                                                else
                                                    {6522}let (=OpenSecureChannelRequest,=pkCli_5911,Nc_5969: bitstring) = m1_5968 in
                                                    {6523}new Ns_5970: bitstring;
                                                    {6524}new ST_5971: bitstring;
                                                    {6525}new TTL_5972: bitstring;
                                                    {6526}let m2_5973: bitstring = (OpenSecureChannelResponse,Ns_5970,ST_5971,TTL_5972) in
                                                    {6527}out(c, (m2_5973,sign(h(m2_5973),skSess_5833)));
                                                    {6528}let Ksrv_5974: bitstring = h((Ns_5970,Nc_5969)) in
                                                    {6529}out(c, senc(mSrv(pkCli_5911,pkSess_5834),Ksrv_5974))
                                    )
                                    else
                                        {6530}let pkDisco_5975: bitstring = fail-any in
                                        {6531}in(c, (=pkCli_5911,em1_5976: bitstring,sigM1_5977: bitstring));
                                        {6532}let m1_5978: bitstring = em1_5976 in
                                        {6533}if (verify(h(m1_5978),sigM1_5977,pkCli_5911) <> true) then
                                            0
                                        else
                                            {6534}let (=OpenSecureChannelRequest,=pkCli_5911,Nc_5979: bitstring) = m1_5978 in
                                            {6535}new Ns_5980: bitstring;
                                            {6536}new ST_5981: bitstring;
                                            {6537}new TTL_5982: bitstring;
                                            {6538}let m2_5983: bitstring = (OpenSecureChannelResponse,Ns_5980,ST_5981,TTL_5982) in
                                            {6539}out(c, (m2_5983,sign(h(m2_5983),skSess_5833)));
                                            {6540}let Ksrv_5984: bitstring = h((Ns_5980,Nc_5979)) in
                                            {6541}out(c, senc(mSrv(pkCli_5911,pkSess_5834),Ksrv_5984))
                                )
                                else
                                    {6542}let v_5985: bool = (Cli_5309 = C) in
                                    (
                                        {6543}if v_5985 then
                                        (
                                            {6544}let pkCli_5986: bitstring = pub(skC) in
                                            {6545}let v_5987: bool = (Disco_5310 = A) in
                                            (
                                                {6546}if v_5987 then
                                                (
                                                    {6547}let pkDisco_5988: bitstring = pub(skA) in
                                                    {6548}in(c, (=pkCli_5986,em1_5989: bitstring,sigM1_5990: bitstring));
                                                    {6549}let m1_5991: bitstring = em1_5989 in
                                                    {6550}if (verify(h(m1_5991),sigM1_5990,pkCli_5986) <> true) then
                                                        0
                                                    else
                                                        {6551}let (=OpenSecureChannelRequest,=pkCli_5986,Nc_5992: bitstring) = m1_5991 in
                                                        {6552}new Ns_5993: bitstring;
                                                        {6553}new ST_5994: bitstring;
                                                        {6554}new TTL_5995: bitstring;
                                                        {6555}let m2_5996: bitstring = (OpenSecureChannelResponse,Ns_5993,ST_5994,TTL_5995) in
                                                        {6556}out(c, (m2_5996,sign(h(m2_5996),skSess_5833)));
                                                        {6557}let Ksrv_5997: bitstring = h((Ns_5993,Nc_5992)) in
                                                        {6558}out(c, senc(mSrv(pkCli_5986,pkSess_5834),Ksrv_5997))
                                                )
                                                else
                                                    {6559}let v_5998: bool = (Disco_5310 = B) in
                                                    (
                                                        {6560}if v_5998 then
                                                        (
                                                            {6561}let pkDisco_5999: bitstring = pub(skB) in
                                                            {6562}in(c, (=pkCli_5986,em1_6000: bitstring,sigM1_6001: bitstring));
                                                            {6563}let m1_6002: bitstring = em1_6000 in
                                                            {6564}if (verify(h(m1_6002),sigM1_6001,pkCli_5986) <> true) then
                                                                0
                                                            else
                                                                {6565}let (=OpenSecureChannelRequest,=pkCli_5986,Nc_6003: bitstring) = m1_6002 in
                                                                {6566}new Ns_6004: bitstring;
                                                                {6567}new ST_6005: bitstring;
                                                                {6568}new TTL_6006: bitstring;
                                                                {6569}let m2_6007: bitstring = (OpenSecureChannelResponse,Ns_6004,ST_6005,TTL_6006) in
                                                                {6570}out(c, (m2_6007,sign(h(m2_6007),skSess_5833)));
                                                                {6571}let Ksrv_6008: bitstring = h((Ns_6004,Nc_6003)) in
                                                                {6572}out(c, senc(mSrv(pkCli_5986,pkSess_5834),Ksrv_6008))
                                                        )
                                                        else
                                                            {6573}let v_6009: bool = (Disco_5310 = C) in
                                                            (
                                                                {6574}if v_6009 then
                                                                (
                                                                    {6575}let pkDisco_6010: bitstring = pub(skC) in
                                                                    {6576}in(c, (=pkCli_5986,em1_6011: bitstring,sigM1_6012: bitstring));
                                                                    {6577}let m1_6013: bitstring = em1_6011 in
                                                                    {6578}if (verify(h(m1_6013),sigM1_6012,pkCli_5986) <> true) then
                                                                        0
                                                                    else
                                                                        {6579}let (=OpenSecureChannelRequest,=pkCli_5986,Nc_6014: bitstring) = m1_6013 in
                                                                        {6580}new Ns_6015: bitstring;
                                                                        {6581}new ST_6016: bitstring;
                                                                        {6582}new TTL_6017: bitstring;
                                                                        {6583}let m2_6018: bitstring = (OpenSecureChannelResponse,Ns_6015,ST_6016,TTL_6017) in
                                                                        {6584}out(c, (m2_6018,sign(h(m2_6018),skSess_5833)));
                                                                        {6585}let Ksrv_6019: bitstring = h((Ns_6015,Nc_6014)) in
                                                                        {6586}out(c, senc(mSrv(pkCli_5986,pkSess_5834),Ksrv_6019))
                                                                )
                                                                else
                                                                    {6587}let pkDisco_6020: bitstring = pub(sk(Disco_5310)) in
                                                                    {6588}in(c, (=pkCli_5986,em1_6021: bitstring,sigM1_6022: bitstring));
                                                                    {6589}let m1_6023: bitstring = em1_6021 in
                                                                    {6590}if (verify(h(m1_6023),sigM1_6022,pkCli_5986) <> true) then
                                                                        0
                                                                    else
                                                                        {6591}let (=OpenSecureChannelRequest,=pkCli_5986,Nc_6024: bitstring) = m1_6023 in
                                                                        {6592}new Ns_6025: bitstring;
                                                                        {6593}new ST_6026: bitstring;
                                                                        {6594}new TTL_6027: bitstring;
                                                                        {6595}let m2_6028: bitstring = (OpenSecureChannelResponse,Ns_6025,ST_6026,TTL_6027) in
                                                                        {6596}out(c, (m2_6028,sign(h(m2_6028),skSess_5833)));
                                                                        {6597}let Ksrv_6029: bitstring = h((Ns_6025,Nc_6024)) in
                                                                        {6598}out(c, senc(mSrv(pkCli_5986,pkSess_5834),Ksrv_6029))
                                                            )
                                                            else
                                                                {6599}let pkDisco_6030: bitstring = fail-any in
                                                                {6600}in(c, (=pkCli_5986,em1_6031: bitstring,sigM1_6032: bitstring));
                                                                {6601}let m1_6033: bitstring = em1_6031 in
                                                                {6602}if (verify(h(m1_6033),sigM1_6032,pkCli_5986) <> true) then
                                                                    0
                                                                else
                                                                    {6603}let (=OpenSecureChannelRequest,=pkCli_5986,Nc_6034: bitstring) = m1_6033 in
                                                                    {6604}new Ns_6035: bitstring;
                                                                    {6605}new ST_6036: bitstring;
                                                                    {6606}new TTL_6037: bitstring;
                                                                    {6607}let m2_6038: bitstring = (OpenSecureChannelResponse,Ns_6035,ST_6036,TTL_6037) in
                                                                    {6608}out(c, (m2_6038,sign(h(m2_6038),skSess_5833)));
                                                                    {6609}let Ksrv_6039: bitstring = h((Ns_6035,Nc_6034)) in
                                                                    {6610}out(c, senc(mSrv(pkCli_5986,pkSess_5834),Ksrv_6039))
                                                    )
                                                    else
                                                        {6611}let pkDisco_6040: bitstring = fail-any in
                                                        {6612}in(c, (=pkCli_5986,em1_6041: bitstring,sigM1_6042: bitstring));
                                                        {6613}let m1_6043: bitstring = em1_6041 in
                                                        {6614}if (verify(h(m1_6043),sigM1_6042,pkCli_5986) <> true) then
                                                            0
                                                        else
                                                            {6615}let (=OpenSecureChannelRequest,=pkCli_5986,Nc_6044: bitstring) = m1_6043 in
                                                            {6616}new Ns_6045: bitstring;
                                                            {6617}new ST_6046: bitstring;
                                                            {6618}new TTL_6047: bitstring;
                                                            {6619}let m2_6048: bitstring = (OpenSecureChannelResponse,Ns_6045,ST_6046,TTL_6047) in
                                                            {6620}out(c, (m2_6048,sign(h(m2_6048),skSess_5833)));
                                                            {6621}let Ksrv_6049: bitstring = h((Ns_6045,Nc_6044)) in
                                                            {6622}out(c, senc(mSrv(pkCli_5986,pkSess_5834),Ksrv_6049))
                                            )
                                            else
                                                {6623}let pkDisco_6050: bitstring = fail-any in
                                                {6624}in(c, (=pkCli_5986,em1_6051: bitstring,sigM1_6052: bitstring));
                                                {6625}let m1_6053: bitstring = em1_6051 in
                                                {6626}if (verify(h(m1_6053),sigM1_6052,pkCli_5986) <> true) then
                                                    0
                                                else
                                                    {6627}let (=OpenSecureChannelRequest,=pkCli_5986,Nc_6054: bitstring) = m1_6053 in
                                                    {6628}new Ns_6055: bitstring;
                                                    {6629}new ST_6056: bitstring;
                                                    {6630}new TTL_6057: bitstring;
                                                    {6631}let m2_6058: bitstring = (OpenSecureChannelResponse,Ns_6055,ST_6056,TTL_6057) in
                                                    {6632}out(c, (m2_6058,sign(h(m2_6058),skSess_5833)));
                                                    {6633}let Ksrv_6059: bitstring = h((Ns_6055,Nc_6054)) in
                                                    {6634}out(c, senc(mSrv(pkCli_5986,pkSess_5834),Ksrv_6059))
                                        )
                                        else
                                            {6635}let pkCli_6060: bitstring = pub(sk(Cli_5309)) in
                                            {6636}let v_6061: bool = (Disco_5310 = A) in
                                            (
                                                {6637}if v_6061 then
                                                (
                                                    {6638}let pkDisco_6062: bitstring = pub(skA) in
                                                    {6639}in(c, (=pkCli_6060,em1_6063: bitstring,sigM1_6064: bitstring));
                                                    {6640}let m1_6065: bitstring = em1_6063 in
                                                    {6641}if (verify(h(m1_6065),sigM1_6064,pkCli_6060) <> true) then
                                                        0
                                                    else
                                                        {6642}let (=OpenSecureChannelRequest,=pkCli_6060,Nc_6066: bitstring) = m1_6065 in
                                                        {6643}new Ns_6067: bitstring;
                                                        {6644}new ST_6068: bitstring;
                                                        {6645}new TTL_6069: bitstring;
                                                        {6646}let m2_6070: bitstring = (OpenSecureChannelResponse,Ns_6067,ST_6068,TTL_6069) in
                                                        {6647}out(c, (m2_6070,sign(h(m2_6070),skSess_5833)));
                                                        {6648}let Ksrv_6071: bitstring = h((Ns_6067,Nc_6066)) in
                                                        {6649}out(c, senc(mSrv(pkCli_6060,pkSess_5834),Ksrv_6071))
                                                )
                                                else
                                                    {6650}let v_6072: bool = (Disco_5310 = B) in
                                                    (
                                                        {6651}if v_6072 then
                                                        (
                                                            {6652}let pkDisco_6073: bitstring = pub(skB) in
                                                            {6653}in(c, (=pkCli_6060,em1_6074: bitstring,sigM1_6075: bitstring));
                                                            {6654}let m1_6076: bitstring = em1_6074 in
                                                            {6655}if (verify(h(m1_6076),sigM1_6075,pkCli_6060) <> true) then
                                                                0
                                                            else
                                                                {6656}let (=OpenSecureChannelRequest,=pkCli_6060,Nc_6077: bitstring) = m1_6076 in
                                                                {6657}new Ns_6078: bitstring;
                                                                {6658}new ST_6079: bitstring;
                                                                {6659}new TTL_6080: bitstring;
                                                                {6660}let m2_6081: bitstring = (OpenSecureChannelResponse,Ns_6078,ST_6079,TTL_6080) in
                                                                {6661}out(c, (m2_6081,sign(h(m2_6081),skSess_5833)));
                                                                {6662}let Ksrv_6082: bitstring = h((Ns_6078,Nc_6077)) in
                                                                {6663}out(c, senc(mSrv(pkCli_6060,pkSess_5834),Ksrv_6082))
                                                        )
                                                        else
                                                            {6664}let v_6083: bool = (Disco_5310 = C) in
                                                            (
                                                                {6665}if v_6083 then
                                                                (
                                                                    {6666}let pkDisco_6084: bitstring = pub(skC) in
                                                                    {6667}in(c, (=pkCli_6060,em1_6085: bitstring,sigM1_6086: bitstring));
                                                                    {6668}let m1_6087: bitstring = em1_6085 in
                                                                    {6669}if (verify(h(m1_6087),sigM1_6086,pkCli_6060) <> true) then
                                                                        0
                                                                    else
                                                                        {6670}let (=OpenSecureChannelRequest,=pkCli_6060,Nc_6088: bitstring) = m1_6087 in
                                                                        {6671}new Ns_6089: bitstring;
                                                                        {6672}new ST_6090: bitstring;
                                                                        {6673}new TTL_6091: bitstring;
                                                                        {6674}let m2_6092: bitstring = (OpenSecureChannelResponse,Ns_6089,ST_6090,TTL_6091) in
                                                                        {6675}out(c, (m2_6092,sign(h(m2_6092),skSess_5833)));
                                                                        {6676}let Ksrv_6093: bitstring = h((Ns_6089,Nc_6088)) in
                                                                        {6677}out(c, senc(mSrv(pkCli_6060,pkSess_5834),Ksrv_6093))
                                                                )
                                                                else
                                                                    {6678}let pkDisco_6094: bitstring = pub(sk(Disco_5310)) in
                                                                    {6679}in(c, (=pkCli_6060,em1_6095: bitstring,sigM1_6096: bitstring));
                                                                    {6680}let m1_6097: bitstring = em1_6095 in
                                                                    {6681}if (verify(h(m1_6097),sigM1_6096,pkCli_6060) <> true) then
                                                                        0
                                                                    else
                                                                        {6682}let (=OpenSecureChannelRequest,=pkCli_6060,Nc_6098: bitstring) = m1_6097 in
                                                                        {6683}new Ns_6099: bitstring;
                                                                        {6684}new ST_6100: bitstring;
                                                                        {6685}new TTL_6101: bitstring;
                                                                        {6686}let m2_6102: bitstring = (OpenSecureChannelResponse,Ns_6099,ST_6100,TTL_6101) in
                                                                        {6687}out(c, (m2_6102,sign(h(m2_6102),skSess_5833)));
                                                                        {6688}let Ksrv_6103: bitstring = h((Ns_6099,Nc_6098)) in
                                                                        {6689}out(c, senc(mSrv(pkCli_6060,pkSess_5834),Ksrv_6103))
                                                            )
                                                            else
                                                                {6690}let pkDisco_6104: bitstring = fail-any in
                                                                {6691}in(c, (=pkCli_6060,em1_6105: bitstring,sigM1_6106: bitstring));
                                                                {6692}let m1_6107: bitstring = em1_6105 in
                                                                {6693}if (verify(h(m1_6107),sigM1_6106,pkCli_6060) <> true) then
                                                                    0
                                                                else
                                                                    {6694}let (=OpenSecureChannelRequest,=pkCli_6060,Nc_6108: bitstring) = m1_6107 in
                                                                    {6695}new Ns_6109: bitstring;
                                                                    {6696}new ST_6110: bitstring;
                                                                    {6697}new TTL_6111: bitstring;
                                                                    {6698}let m2_6112: bitstring = (OpenSecureChannelResponse,Ns_6109,ST_6110,TTL_6111) in
                                                                    {6699}out(c, (m2_6112,sign(h(m2_6112),skSess_5833)));
                                                                    {6700}let Ksrv_6113: bitstring = h((Ns_6109,Nc_6108)) in
                                                                    {6701}out(c, senc(mSrv(pkCli_6060,pkSess_5834),Ksrv_6113))
                                                    )
                                                    else
                                                        {6702}let pkDisco_6114: bitstring = fail-any in
                                                        {6703}in(c, (=pkCli_6060,em1_6115: bitstring,sigM1_6116: bitstring));
                                                        {6704}let m1_6117: bitstring = em1_6115 in
                                                        {6705}if (verify(h(m1_6117),sigM1_6116,pkCli_6060) <> true) then
                                                            0
                                                        else
                                                            {6706}let (=OpenSecureChannelRequest,=pkCli_6060,Nc_6118: bitstring) = m1_6117 in
                                                            {6707}new Ns_6119: bitstring;
                                                            {6708}new ST_6120: bitstring;
                                                            {6709}new TTL_6121: bitstring;
                                                            {6710}let m2_6122: bitstring = (OpenSecureChannelResponse,Ns_6119,ST_6120,TTL_6121) in
                                                            {6711}out(c, (m2_6122,sign(h(m2_6122),skSess_5833)));
                                                            {6712}let Ksrv_6123: bitstring = h((Ns_6119,Nc_6118)) in
                                                            {6713}out(c, senc(mSrv(pkCli_6060,pkSess_5834),Ksrv_6123))
                                            )
                                            else
                                                {6714}let pkDisco_6124: bitstring = fail-any in
                                                {6715}in(c, (=pkCli_6060,em1_6125: bitstring,sigM1_6126: bitstring));
                                                {6716}let m1_6127: bitstring = em1_6125 in
                                                {6717}if (verify(h(m1_6127),sigM1_6126,pkCli_6060) <> true) then
                                                    0
                                                else
                                                    {6718}let (=OpenSecureChannelRequest,=pkCli_6060,Nc_6128: bitstring) = m1_6127 in
                                                    {6719}new Ns_6129: bitstring;
                                                    {6720}new ST_6130: bitstring;
                                                    {6721}new TTL_6131: bitstring;
                                                    {6722}let m2_6132: bitstring = (OpenSecureChannelResponse,Ns_6129,ST_6130,TTL_6131) in
                                                    {6723}out(c, (m2_6132,sign(h(m2_6132),skSess_5833)));
                                                    {6724}let Ksrv_6133: bitstring = h((Ns_6129,Nc_6128)) in
                                                    {6725}out(c, senc(mSrv(pkCli_6060,pkSess_5834),Ksrv_6133))
                                    )
                                    else
                                        {6726}let pkCli_6134: bitstring = fail-any in
                                        {6727}let v_6135: bool = (Disco_5310 = A) in
                                        (
                                            {6728}if v_6135 then
                                            (
                                                {6729}let pkDisco_6136: bitstring = pub(skA) in
                                                {6730}in(c, (=pkCli_6134,em1_6137: bitstring,sigM1_6138: bitstring));
                                                {6731}let m1_6139: bitstring = em1_6137 in
                                                {6732}if (verify(h(m1_6139),sigM1_6138,pkCli_6134) <> true) then
                                                    0
                                                else
                                                    {6733}let (=OpenSecureChannelRequest,=pkCli_6134,Nc_6140: bitstring) = m1_6139 in
                                                    {6734}new Ns_6141: bitstring;
                                                    {6735}new ST_6142: bitstring;
                                                    {6736}new TTL_6143: bitstring;
                                                    {6737}let m2_6144: bitstring = (OpenSecureChannelResponse,Ns_6141,ST_6142,TTL_6143) in
                                                    {6738}out(c, (m2_6144,sign(h(m2_6144),skSess_5833)));
                                                    {6739}let Ksrv_6145: bitstring = h((Ns_6141,Nc_6140)) in
                                                    {6740}out(c, senc(mSrv(pkCli_6134,pkSess_5834),Ksrv_6145))
                                            )
                                            else
                                                {6741}let v_6146: bool = (Disco_5310 = B) in
                                                (
                                                    {6742}if v_6146 then
                                                    (
                                                        {6743}let pkDisco_6147: bitstring = pub(skB) in
                                                        {6744}in(c, (=pkCli_6134,em1_6148: bitstring,sigM1_6149: bitstring));
                                                        {6745}let m1_6150: bitstring = em1_6148 in
                                                        {6746}if (verify(h(m1_6150),sigM1_6149,pkCli_6134) <> true) then
                                                            0
                                                        else
                                                            {6747}let (=OpenSecureChannelRequest,=pkCli_6134,Nc_6151: bitstring) = m1_6150 in
                                                            {6748}new Ns_6152: bitstring;
                                                            {6749}new ST_6153: bitstring;
                                                            {6750}new TTL_6154: bitstring;
                                                            {6751}let m2_6155: bitstring = (OpenSecureChannelResponse,Ns_6152,ST_6153,TTL_6154) in
                                                            {6752}out(c, (m2_6155,sign(h(m2_6155),skSess_5833)));
                                                            {6753}let Ksrv_6156: bitstring = h((Ns_6152,Nc_6151)) in
                                                            {6754}out(c, senc(mSrv(pkCli_6134,pkSess_5834),Ksrv_6156))
                                                    )
                                                    else
                                                        {6755}let v_6157: bool = (Disco_5310 = C) in
                                                        (
                                                            {6756}if v_6157 then
                                                            (
                                                                {6757}let pkDisco_6158: bitstring = pub(skC) in
                                                                {6758}in(c, (=pkCli_6134,em1_6159: bitstring,sigM1_6160: bitstring));
                                                                {6759}let m1_6161: bitstring = em1_6159 in
                                                                {6760}if (verify(h(m1_6161),sigM1_6160,pkCli_6134) <> true) then
                                                                    0
                                                                else
                                                                    {6761}let (=OpenSecureChannelRequest,=pkCli_6134,Nc_6162: bitstring) = m1_6161 in
                                                                    {6762}new Ns_6163: bitstring;
                                                                    {6763}new ST_6164: bitstring;
                                                                    {6764}new TTL_6165: bitstring;
                                                                    {6765}let m2_6166: bitstring = (OpenSecureChannelResponse,Ns_6163,ST_6164,TTL_6165) in
                                                                    {6766}out(c, (m2_6166,sign(h(m2_6166),skSess_5833)));
                                                                    {6767}let Ksrv_6167: bitstring = h((Ns_6163,Nc_6162)) in
                                                                    {6768}out(c, senc(mSrv(pkCli_6134,pkSess_5834),Ksrv_6167))
                                                            )
                                                            else
                                                                {6769}let pkDisco_6168: bitstring = pub(sk(Disco_5310)) in
                                                                {6770}in(c, (=pkCli_6134,em1_6169: bitstring,sigM1_6170: bitstring));
                                                                {6771}let m1_6171: bitstring = em1_6169 in
                                                                {6772}if (verify(h(m1_6171),sigM1_6170,pkCli_6134) <> true) then
                                                                    0
                                                                else
                                                                    {6773}let (=OpenSecureChannelRequest,=pkCli_6134,Nc_6172: bitstring) = m1_6171 in
                                                                    {6774}new Ns_6173: bitstring;
                                                                    {6775}new ST_6174: bitstring;
                                                                    {6776}new TTL_6175: bitstring;
                                                                    {6777}let m2_6176: bitstring = (OpenSecureChannelResponse,Ns_6173,ST_6174,TTL_6175) in
                                                                    {6778}out(c, (m2_6176,sign(h(m2_6176),skSess_5833)));
                                                                    {6779}let Ksrv_6177: bitstring = h((Ns_6173,Nc_6172)) in
                                                                    {6780}out(c, senc(mSrv(pkCli_6134,pkSess_5834),Ksrv_6177))
                                                        )
                                                        else
                                                            {6781}let pkDisco_6178: bitstring = fail-any in
                                                            {6782}in(c, (=pkCli_6134,em1_6179: bitstring,sigM1_6180: bitstring));
                                                            {6783}let m1_6181: bitstring = em1_6179 in
                                                            {6784}if (verify(h(m1_6181),sigM1_6180,pkCli_6134) <> true) then
                                                                0
                                                            else
                                                                {6785}let (=OpenSecureChannelRequest,=pkCli_6134,Nc_6182: bitstring) = m1_6181 in
                                                                {6786}new Ns_6183: bitstring;
                                                                {6787}new ST_6184: bitstring;
                                                                {6788}new TTL_6185: bitstring;
                                                                {6789}let m2_6186: bitstring = (OpenSecureChannelResponse,Ns_6183,ST_6184,TTL_6185) in
                                                                {6790}out(c, (m2_6186,sign(h(m2_6186),skSess_5833)));
                                                                {6791}let Ksrv_6187: bitstring = h((Ns_6183,Nc_6182)) in
                                                                {6792}out(c, senc(mSrv(pkCli_6134,pkSess_5834),Ksrv_6187))
                                                )
                                                else
                                                    {6793}let pkDisco_6188: bitstring = fail-any in
                                                    {6794}in(c, (=pkCli_6134,em1_6189: bitstring,sigM1_6190: bitstring));
                                                    {6795}let m1_6191: bitstring = em1_6189 in
                                                    {6796}if (verify(h(m1_6191),sigM1_6190,pkCli_6134) <> true) then
                                                        0
                                                    else
                                                        {6797}let (=OpenSecureChannelRequest,=pkCli_6134,Nc_6192: bitstring) = m1_6191 in
                                                        {6798}new Ns_6193: bitstring;
                                                        {6799}new ST_6194: bitstring;
                                                        {6800}new TTL_6195: bitstring;
                                                        {6801}let m2_6196: bitstring = (OpenSecureChannelResponse,Ns_6193,ST_6194,TTL_6195) in
                                                        {6802}out(c, (m2_6196,sign(h(m2_6196),skSess_5833)));
                                                        {6803}let Ksrv_6197: bitstring = h((Ns_6193,Nc_6192)) in
                                                        {6804}out(c, senc(mSrv(pkCli_6134,pkSess_5834),Ksrv_6197))
                                        )
                                        else
                                            {6805}let pkDisco_6198: bitstring = fail-any in
                                            {6806}in(c, (=pkCli_6134,em1_6199: bitstring,sigM1_6200: bitstring));
                                            {6807}let m1_6201: bitstring = em1_6199 in
                                            {6808}if (verify(h(m1_6201),sigM1_6200,pkCli_6134) <> true) then
                                                0
                                            else
                                                {6809}let (=OpenSecureChannelRequest,=pkCli_6134,Nc_6202: bitstring) = m1_6201 in
                                                {6810}new Ns_6203: bitstring;
                                                {6811}new ST_6204: bitstring;
                                                {6812}new TTL_6205: bitstring;
                                                {6813}let m2_6206: bitstring = (OpenSecureChannelResponse,Ns_6203,ST_6204,TTL_6205) in
                                                {6814}out(c, (m2_6206,sign(h(m2_6206),skSess_5833)));
                                                {6815}let Ksrv_6207: bitstring = h((Ns_6203,Nc_6202)) in
                                                {6816}out(c, senc(mSrv(pkCli_6134,pkSess_5834),Ksrv_6207))
                            )
                            else
                                {6817}let pkCli_6208: bitstring = fail-any in
                                {6818}let v_6209: bool = (Disco_5310 = A) in
                                (
                                    {6819}if v_6209 then
                                    (
                                        {6820}let pkDisco_6210: bitstring = pub(skA) in
                                        {6821}in(c, (=pkCli_6208,em1_6211: bitstring,sigM1_6212: bitstring));
                                        {6822}let m1_6213: bitstring = em1_6211 in
                                        {6823}if (verify(h(m1_6213),sigM1_6212,pkCli_6208) <> true) then
                                            0
                                        else
                                            {6824}let (=OpenSecureChannelRequest,=pkCli_6208,Nc_6214: bitstring) = m1_6213 in
                                            {6825}new Ns_6215: bitstring;
                                            {6826}new ST_6216: bitstring;
                                            {6827}new TTL_6217: bitstring;
                                            {6828}let m2_6218: bitstring = (OpenSecureChannelResponse,Ns_6215,ST_6216,TTL_6217) in
                                            {6829}out(c, (m2_6218,sign(h(m2_6218),skSess_5833)));
                                            {6830}let Ksrv_6219: bitstring = h((Ns_6215,Nc_6214)) in
                                            {6831}out(c, senc(mSrv(pkCli_6208,pkSess_5834),Ksrv_6219))
                                    )
                                    else
                                        {6832}let v_6220: bool = (Disco_5310 = B) in
                                        (
                                            {6833}if v_6220 then
                                            (
                                                {6834}let pkDisco_6221: bitstring = pub(skB) in
                                                {6835}in(c, (=pkCli_6208,em1_6222: bitstring,sigM1_6223: bitstring));
                                                {6836}let m1_6224: bitstring = em1_6222 in
                                                {6837}if (verify(h(m1_6224),sigM1_6223,pkCli_6208) <> true) then
                                                    0
                                                else
                                                    {6838}let (=OpenSecureChannelRequest,=pkCli_6208,Nc_6225: bitstring) = m1_6224 in
                                                    {6839}new Ns_6226: bitstring;
                                                    {6840}new ST_6227: bitstring;
                                                    {6841}new TTL_6228: bitstring;
                                                    {6842}let m2_6229: bitstring = (OpenSecureChannelResponse,Ns_6226,ST_6227,TTL_6228) in
                                                    {6843}out(c, (m2_6229,sign(h(m2_6229),skSess_5833)));
                                                    {6844}let Ksrv_6230: bitstring = h((Ns_6226,Nc_6225)) in
                                                    {6845}out(c, senc(mSrv(pkCli_6208,pkSess_5834),Ksrv_6230))
                                            )
                                            else
                                                {6846}let v_6231: bool = (Disco_5310 = C) in
                                                (
                                                    {6847}if v_6231 then
                                                    (
                                                        {6848}let pkDisco_6232: bitstring = pub(skC) in
                                                        {6849}in(c, (=pkCli_6208,em1_6233: bitstring,sigM1_6234: bitstring));
                                                        {6850}let m1_6235: bitstring = em1_6233 in
                                                        {6851}if (verify(h(m1_6235),sigM1_6234,pkCli_6208) <> true) then
                                                            0
                                                        else
                                                            {6852}let (=OpenSecureChannelRequest,=pkCli_6208,Nc_6236: bitstring) = m1_6235 in
                                                            {6853}new Ns_6237: bitstring;
                                                            {6854}new ST_6238: bitstring;
                                                            {6855}new TTL_6239: bitstring;
                                                            {6856}let m2_6240: bitstring = (OpenSecureChannelResponse,Ns_6237,ST_6238,TTL_6239) in
                                                            {6857}out(c, (m2_6240,sign(h(m2_6240),skSess_5833)));
                                                            {6858}let Ksrv_6241: bitstring = h((Ns_6237,Nc_6236)) in
                                                            {6859}out(c, senc(mSrv(pkCli_6208,pkSess_5834),Ksrv_6241))
                                                    )
                                                    else
                                                        {6860}let pkDisco_6242: bitstring = pub(sk(Disco_5310)) in
                                                        {6861}in(c, (=pkCli_6208,em1_6243: bitstring,sigM1_6244: bitstring));
                                                        {6862}let m1_6245: bitstring = em1_6243 in
                                                        {6863}if (verify(h(m1_6245),sigM1_6244,pkCli_6208) <> true) then
                                                            0
                                                        else
                                                            {6864}let (=OpenSecureChannelRequest,=pkCli_6208,Nc_6246: bitstring) = m1_6245 in
                                                            {6865}new Ns_6247: bitstring;
                                                            {6866}new ST_6248: bitstring;
                                                            {6867}new TTL_6249: bitstring;
                                                            {6868}let m2_6250: bitstring = (OpenSecureChannelResponse,Ns_6247,ST_6248,TTL_6249) in
                                                            {6869}out(c, (m2_6250,sign(h(m2_6250),skSess_5833)));
                                                            {6870}let Ksrv_6251: bitstring = h((Ns_6247,Nc_6246)) in
                                                            {6871}out(c, senc(mSrv(pkCli_6208,pkSess_5834),Ksrv_6251))
                                                )
                                                else
                                                    {6872}let pkDisco_6252: bitstring = fail-any in
                                                    {6873}in(c, (=pkCli_6208,em1_6253: bitstring,sigM1_6254: bitstring));
                                                    {6874}let m1_6255: bitstring = em1_6253 in
                                                    {6875}if (verify(h(m1_6255),sigM1_6254,pkCli_6208) <> true) then
                                                        0
                                                    else
                                                        {6876}let (=OpenSecureChannelRequest,=pkCli_6208,Nc_6256: bitstring) = m1_6255 in
                                                        {6877}new Ns_6257: bitstring;
                                                        {6878}new ST_6258: bitstring;
                                                        {6879}new TTL_6259: bitstring;
                                                        {6880}let m2_6260: bitstring = (OpenSecureChannelResponse,Ns_6257,ST_6258,TTL_6259) in
                                                        {6881}out(c, (m2_6260,sign(h(m2_6260),skSess_5833)));
                                                        {6882}let Ksrv_6261: bitstring = h((Ns_6257,Nc_6256)) in
                                                        {6883}out(c, senc(mSrv(pkCli_6208,pkSess_5834),Ksrv_6261))
                                        )
                                        else
                                            {6884}let pkDisco_6262: bitstring = fail-any in
                                            {6885}in(c, (=pkCli_6208,em1_6263: bitstring,sigM1_6264: bitstring));
                                            {6886}let m1_6265: bitstring = em1_6263 in
                                            {6887}if (verify(h(m1_6265),sigM1_6264,pkCli_6208) <> true) then
                                                0
                                            else
                                                {6888}let (=OpenSecureChannelRequest,=pkCli_6208,Nc_6266: bitstring) = m1_6265 in
                                                {6889}new Ns_6267: bitstring;
                                                {6890}new ST_6268: bitstring;
                                                {6891}new TTL_6269: bitstring;
                                                {6892}let m2_6270: bitstring = (OpenSecureChannelResponse,Ns_6267,ST_6268,TTL_6269) in
                                                {6893}out(c, (m2_6270,sign(h(m2_6270),skSess_5833)));
                                                {6894}let Ksrv_6271: bitstring = h((Ns_6267,Nc_6266)) in
                                                {6895}out(c, senc(mSrv(pkCli_6208,pkSess_5834),Ksrv_6271))
                                )
                                else
                                    {6896}let pkDisco_6272: bitstring = fail-any in
                                    {6897}in(c, (=pkCli_6208,em1_6273: bitstring,sigM1_6274: bitstring));
                                    {6898}let m1_6275: bitstring = em1_6273 in
                                    {6899}if (verify(h(m1_6275),sigM1_6274,pkCli_6208) <> true) then
                                        0
                                    else
                                        {6900}let (=OpenSecureChannelRequest,=pkCli_6208,Nc_6276: bitstring) = m1_6275 in
                                        {6901}new Ns_6277: bitstring;
                                        {6902}new ST_6278: bitstring;
                                        {6903}new TTL_6279: bitstring;
                                        {6904}let m2_6280: bitstring = (OpenSecureChannelResponse,Ns_6277,ST_6278,TTL_6279) in
                                        {6905}out(c, (m2_6280,sign(h(m2_6280),skSess_5833)));
                                        {6906}let Ksrv_6281: bitstring = h((Ns_6277,Nc_6276)) in
                                        {6907}out(c, senc(mSrv(pkCli_6208,pkSess_5834),Ksrv_6281))
                    )
                    else
                        {6908}let pkCli_6282: bitstring = fail-any in
                        {6909}let v_6283: bool = (Disco_5310 = A) in
                        (
                            {6910}if v_6283 then
                            (
                                {6911}let pkDisco_6284: bitstring = pub(skA) in
                                {6912}in(c, (=pkCli_6282,em1_6285: bitstring,sigM1_6286: bitstring));
                                {6913}let m1_6287: bitstring = em1_6285 in
                                {6914}if (verify(h(m1_6287),sigM1_6286,pkCli_6282) <> true) then
                                    0
                                else
                                    {6915}let (=OpenSecureChannelRequest,=pkCli_6282,Nc_6288: bitstring) = m1_6287 in
                                    {6916}new Ns_6289: bitstring;
                                    {6917}new ST_6290: bitstring;
                                    {6918}new TTL_6291: bitstring;
                                    {6919}let m2_6292: bitstring = (OpenSecureChannelResponse,Ns_6289,ST_6290,TTL_6291) in
                                    {6920}out(c, (m2_6292,sign(h(m2_6292),skSess_5833)));
                                    {6921}let Ksrv_6293: bitstring = h((Ns_6289,Nc_6288)) in
                                    {6922}out(c, senc(mSrv(pkCli_6282,pkSess_5834),Ksrv_6293))
                            )
                            else
                                {6923}let v_6294: bool = (Disco_5310 = B) in
                                (
                                    {6924}if v_6294 then
                                    (
                                        {6925}let pkDisco_6295: bitstring = pub(skB) in
                                        {6926}in(c, (=pkCli_6282,em1_6296: bitstring,sigM1_6297: bitstring));
                                        {6927}let m1_6298: bitstring = em1_6296 in
                                        {6928}if (verify(h(m1_6298),sigM1_6297,pkCli_6282) <> true) then
                                            0
                                        else
                                            {6929}let (=OpenSecureChannelRequest,=pkCli_6282,Nc_6299: bitstring) = m1_6298 in
                                            {6930}new Ns_6300: bitstring;
                                            {6931}new ST_6301: bitstring;
                                            {6932}new TTL_6302: bitstring;
                                            {6933}let m2_6303: bitstring = (OpenSecureChannelResponse,Ns_6300,ST_6301,TTL_6302) in
                                            {6934}out(c, (m2_6303,sign(h(m2_6303),skSess_5833)));
                                            {6935}let Ksrv_6304: bitstring = h((Ns_6300,Nc_6299)) in
                                            {6936}out(c, senc(mSrv(pkCli_6282,pkSess_5834),Ksrv_6304))
                                    )
                                    else
                                        {6937}let v_6305: bool = (Disco_5310 = C) in
                                        (
                                            {6938}if v_6305 then
                                            (
                                                {6939}let pkDisco_6306: bitstring = pub(skC) in
                                                {6940}in(c, (=pkCli_6282,em1_6307: bitstring,sigM1_6308: bitstring));
                                                {6941}let m1_6309: bitstring = em1_6307 in
                                                {6942}if (verify(h(m1_6309),sigM1_6308,pkCli_6282) <> true) then
                                                    0
                                                else
                                                    {6943}let (=OpenSecureChannelRequest,=pkCli_6282,Nc_6310: bitstring) = m1_6309 in
                                                    {6944}new Ns_6311: bitstring;
                                                    {6945}new ST_6312: bitstring;
                                                    {6946}new TTL_6313: bitstring;
                                                    {6947}let m2_6314: bitstring = (OpenSecureChannelResponse,Ns_6311,ST_6312,TTL_6313) in
                                                    {6948}out(c, (m2_6314,sign(h(m2_6314),skSess_5833)));
                                                    {6949}let Ksrv_6315: bitstring = h((Ns_6311,Nc_6310)) in
                                                    {6950}out(c, senc(mSrv(pkCli_6282,pkSess_5834),Ksrv_6315))
                                            )
                                            else
                                                {6951}let pkDisco_6316: bitstring = pub(sk(Disco_5310)) in
                                                {6952}in(c, (=pkCli_6282,em1_6317: bitstring,sigM1_6318: bitstring));
                                                {6953}let m1_6319: bitstring = em1_6317 in
                                                {6954}if (verify(h(m1_6319),sigM1_6318,pkCli_6282) <> true) then
                                                    0
                                                else
                                                    {6955}let (=OpenSecureChannelRequest,=pkCli_6282,Nc_6320: bitstring) = m1_6319 in
                                                    {6956}new Ns_6321: bitstring;
                                                    {6957}new ST_6322: bitstring;
                                                    {6958}new TTL_6323: bitstring;
                                                    {6959}let m2_6324: bitstring = (OpenSecureChannelResponse,Ns_6321,ST_6322,TTL_6323) in
                                                    {6960}out(c, (m2_6324,sign(h(m2_6324),skSess_5833)));
                                                    {6961}let Ksrv_6325: bitstring = h((Ns_6321,Nc_6320)) in
                                                    {6962}out(c, senc(mSrv(pkCli_6282,pkSess_5834),Ksrv_6325))
                                        )
                                        else
                                            {6963}let pkDisco_6326: bitstring = fail-any in
                                            {6964}in(c, (=pkCli_6282,em1_6327: bitstring,sigM1_6328: bitstring));
                                            {6965}let m1_6329: bitstring = em1_6327 in
                                            {6966}if (verify(h(m1_6329),sigM1_6328,pkCli_6282) <> true) then
                                                0
                                            else
                                                {6967}let (=OpenSecureChannelRequest,=pkCli_6282,Nc_6330: bitstring) = m1_6329 in
                                                {6968}new Ns_6331: bitstring;
                                                {6969}new ST_6332: bitstring;
                                                {6970}new TTL_6333: bitstring;
                                                {6971}let m2_6334: bitstring = (OpenSecureChannelResponse,Ns_6331,ST_6332,TTL_6333) in
                                                {6972}out(c, (m2_6334,sign(h(m2_6334),skSess_5833)));
                                                {6973}let Ksrv_6335: bitstring = h((Ns_6331,Nc_6330)) in
                                                {6974}out(c, senc(mSrv(pkCli_6282,pkSess_5834),Ksrv_6335))
                                )
                                else
                                    {6975}let pkDisco_6336: bitstring = fail-any in
                                    {6976}in(c, (=pkCli_6282,em1_6337: bitstring,sigM1_6338: bitstring));
                                    {6977}let m1_6339: bitstring = em1_6337 in
                                    {6978}if (verify(h(m1_6339),sigM1_6338,pkCli_6282) <> true) then
                                        0
                                    else
                                        {6979}let (=OpenSecureChannelRequest,=pkCli_6282,Nc_6340: bitstring) = m1_6339 in
                                        {6980}new Ns_6341: bitstring;
                                        {6981}new ST_6342: bitstring;
                                        {6982}new TTL_6343: bitstring;
                                        {6983}let m2_6344: bitstring = (OpenSecureChannelResponse,Ns_6341,ST_6342,TTL_6343) in
                                        {6984}out(c, (m2_6344,sign(h(m2_6344),skSess_5833)));
                                        {6985}let Ksrv_6345: bitstring = h((Ns_6341,Nc_6340)) in
                                        {6986}out(c, senc(mSrv(pkCli_6282,pkSess_5834),Ksrv_6345))
                        )
                        else
                            {6987}let pkDisco_6346: bitstring = fail-any in
                            {6988}in(c, (=pkCli_6282,em1_6347: bitstring,sigM1_6348: bitstring));
                            {6989}let m1_6349: bitstring = em1_6347 in
                            {6990}if (verify(h(m1_6349),sigM1_6348,pkCli_6282) <> true) then
                                0
                            else
                                {6991}let (=OpenSecureChannelRequest,=pkCli_6282,Nc_6350: bitstring) = m1_6349 in
                                {6992}new Ns_6351: bitstring;
                                {6993}new ST_6352: bitstring;
                                {6994}new TTL_6353: bitstring;
                                {6995}let m2_6354: bitstring = (OpenSecureChannelResponse,Ns_6351,ST_6352,TTL_6353) in
                                {6996}out(c, (m2_6354,sign(h(m2_6354),skSess_5833)));
                                {6997}let Ksrv_6355: bitstring = h((Ns_6351,Nc_6350)) in
                                {6998}out(c, senc(mSrv(pkCli_6282,pkSess_5834),Ksrv_6355))
                )
                else
                    {6999}let =true = (Sess_5311 = C) in
                    (
                        {7000}let skSess_6356: bitstring = skC in
                        {7001}let pkSess_6357: bitstring = pub(skSess_6356) in
                        {7002}let v_6358: bool = (Cli_5309 = A) in
                        (
                            {7003}if v_6358 then
                            (
                                {7004}let pkCli_6359: bitstring = pub(skA) in
                                {7005}let v_6360: bool = (Disco_5310 = A) in
                                (
                                    {7006}if v_6360 then
                                    (
                                        {7007}let pkDisco_6361: bitstring = pub(skA) in
                                        {7008}in(c, (=pkCli_6359,em1_6362: bitstring,sigM1_6363: bitstring));
                                        {7009}let m1_6364: bitstring = em1_6362 in
                                        {7010}if (verify(h(m1_6364),sigM1_6363,pkCli_6359) <> true) then
                                            0
                                        else
                                            {7011}let (=OpenSecureChannelRequest,=pkCli_6359,Nc_6365: bitstring) = m1_6364 in
                                            {7012}new Ns_6366: bitstring;
                                            {7013}new ST_6367: bitstring;
                                            {7014}new TTL_6368: bitstring;
                                            {7015}let m2_6369: bitstring = (OpenSecureChannelResponse,Ns_6366,ST_6367,TTL_6368) in
                                            {7016}out(c, (m2_6369,sign(h(m2_6369),skSess_6356)));
                                            {7017}let Ksrv_6370: bitstring = h((Ns_6366,Nc_6365)) in
                                            {7018}out(c, senc(mSrv(pkCli_6359,pkSess_6357),Ksrv_6370))
                                    )
                                    else
                                        {7019}let v_6371: bool = (Disco_5310 = B) in
                                        (
                                            {7020}if v_6371 then
                                            (
                                                {7021}let pkDisco_6372: bitstring = pub(skB) in
                                                {7022}in(c, (=pkCli_6359,em1_6373: bitstring,sigM1_6374: bitstring));
                                                {7023}let m1_6375: bitstring = em1_6373 in
                                                {7024}if (verify(h(m1_6375),sigM1_6374,pkCli_6359) <> true) then
                                                    0
                                                else
                                                    {7025}let (=OpenSecureChannelRequest,=pkCli_6359,Nc_6376: bitstring) = m1_6375 in
                                                    {7026}new Ns_6377: bitstring;
                                                    {7027}new ST_6378: bitstring;
                                                    {7028}new TTL_6379: bitstring;
                                                    {7029}let m2_6380: bitstring = (OpenSecureChannelResponse,Ns_6377,ST_6378,TTL_6379) in
                                                    {7030}out(c, (m2_6380,sign(h(m2_6380),skSess_6356)));
                                                    {7031}let Ksrv_6381: bitstring = h((Ns_6377,Nc_6376)) in
                                                    {7032}out(c, senc(mSrv(pkCli_6359,pkSess_6357),Ksrv_6381))
                                            )
                                            else
                                                {7033}let v_6382: bool = (Disco_5310 = C) in
                                                (
                                                    {7034}if v_6382 then
                                                    (
                                                        {7035}let pkDisco_6383: bitstring = pub(skC) in
                                                        {7036}in(c, (=pkCli_6359,em1_6384: bitstring,sigM1_6385: bitstring));
                                                        {7037}let m1_6386: bitstring = em1_6384 in
                                                        {7038}if (verify(h(m1_6386),sigM1_6385,pkCli_6359) <> true) then
                                                            0
                                                        else
                                                            {7039}let (=OpenSecureChannelRequest,=pkCli_6359,Nc_6387: bitstring) = m1_6386 in
                                                            {7040}new Ns_6388: bitstring;
                                                            {7041}new ST_6389: bitstring;
                                                            {7042}new TTL_6390: bitstring;
                                                            {7043}let m2_6391: bitstring = (OpenSecureChannelResponse,Ns_6388,ST_6389,TTL_6390) in
                                                            {7044}out(c, (m2_6391,sign(h(m2_6391),skSess_6356)));
                                                            {7045}let Ksrv_6392: bitstring = h((Ns_6388,Nc_6387)) in
                                                            {7046}out(c, senc(mSrv(pkCli_6359,pkSess_6357),Ksrv_6392))
                                                    )
                                                    else
                                                        {7047}let pkDisco_6393: bitstring = pub(sk(Disco_5310)) in
                                                        {7048}in(c, (=pkCli_6359,em1_6394: bitstring,sigM1_6395: bitstring));
                                                        {7049}let m1_6396: bitstring = em1_6394 in
                                                        {7050}if (verify(h(m1_6396),sigM1_6395,pkCli_6359) <> true) then
                                                            0
                                                        else
                                                            {7051}let (=OpenSecureChannelRequest,=pkCli_6359,Nc_6397: bitstring) = m1_6396 in
                                                            {7052}new Ns_6398: bitstring;
                                                            {7053}new ST_6399: bitstring;
                                                            {7054}new TTL_6400: bitstring;
                                                            {7055}let m2_6401: bitstring = (OpenSecureChannelResponse,Ns_6398,ST_6399,TTL_6400) in
                                                            {7056}out(c, (m2_6401,sign(h(m2_6401),skSess_6356)));
                                                            {7057}let Ksrv_6402: bitstring = h((Ns_6398,Nc_6397)) in
                                                            {7058}out(c, senc(mSrv(pkCli_6359,pkSess_6357),Ksrv_6402))
                                                )
                                                else
                                                    {7059}let pkDisco_6403: bitstring = fail-any in
                                                    {7060}in(c, (=pkCli_6359,em1_6404: bitstring,sigM1_6405: bitstring));
                                                    {7061}let m1_6406: bitstring = em1_6404 in
                                                    {7062}if (verify(h(m1_6406),sigM1_6405,pkCli_6359) <> true) then
                                                        0
                                                    else
                                                        {7063}let (=OpenSecureChannelRequest,=pkCli_6359,Nc_6407: bitstring) = m1_6406 in
                                                        {7064}new Ns_6408: bitstring;
                                                        {7065}new ST_6409: bitstring;
                                                        {7066}new TTL_6410: bitstring;
                                                        {7067}let m2_6411: bitstring = (OpenSecureChannelResponse,Ns_6408,ST_6409,TTL_6410) in
                                                        {7068}out(c, (m2_6411,sign(h(m2_6411),skSess_6356)));
                                                        {7069}let Ksrv_6412: bitstring = h((Ns_6408,Nc_6407)) in
                                                        {7070}out(c, senc(mSrv(pkCli_6359,pkSess_6357),Ksrv_6412))
                                        )
                                        else
                                            {7071}let pkDisco_6413: bitstring = fail-any in
                                            {7072}in(c, (=pkCli_6359,em1_6414: bitstring,sigM1_6415: bitstring));
                                            {7073}let m1_6416: bitstring = em1_6414 in
                                            {7074}if (verify(h(m1_6416),sigM1_6415,pkCli_6359) <> true) then
                                                0
                                            else
                                                {7075}let (=OpenSecureChannelRequest,=pkCli_6359,Nc_6417: bitstring) = m1_6416 in
                                                {7076}new Ns_6418: bitstring;
                                                {7077}new ST_6419: bitstring;
                                                {7078}new TTL_6420: bitstring;
                                                {7079}let m2_6421: bitstring = (OpenSecureChannelResponse,Ns_6418,ST_6419,TTL_6420) in
                                                {7080}out(c, (m2_6421,sign(h(m2_6421),skSess_6356)));
                                                {7081}let Ksrv_6422: bitstring = h((Ns_6418,Nc_6417)) in
                                                {7082}out(c, senc(mSrv(pkCli_6359,pkSess_6357),Ksrv_6422))
                                )
                                else
                                    {7083}let pkDisco_6423: bitstring = fail-any in
                                    {7084}in(c, (=pkCli_6359,em1_6424: bitstring,sigM1_6425: bitstring));
                                    {7085}let m1_6426: bitstring = em1_6424 in
                                    {7086}if (verify(h(m1_6426),sigM1_6425,pkCli_6359) <> true) then
                                        0
                                    else
                                        {7087}let (=OpenSecureChannelRequest,=pkCli_6359,Nc_6427: bitstring) = m1_6426 in
                                        {7088}new Ns_6428: bitstring;
                                        {7089}new ST_6429: bitstring;
                                        {7090}new TTL_6430: bitstring;
                                        {7091}let m2_6431: bitstring = (OpenSecureChannelResponse,Ns_6428,ST_6429,TTL_6430) in
                                        {7092}out(c, (m2_6431,sign(h(m2_6431),skSess_6356)));
                                        {7093}let Ksrv_6432: bitstring = h((Ns_6428,Nc_6427)) in
                                        {7094}out(c, senc(mSrv(pkCli_6359,pkSess_6357),Ksrv_6432))
                            )
                            else
                                {7095}let v_6433: bool = (Cli_5309 = B) in
                                (
                                    {7096}if v_6433 then
                                    (
                                        {7097}let pkCli_6434: bitstring = pub(skB) in
                                        {7098}let v_6435: bool = (Disco_5310 = A) in
                                        (
                                            {7099}if v_6435 then
                                            (
                                                {7100}let pkDisco_6436: bitstring = pub(skA) in
                                                {7101}in(c, (=pkCli_6434,em1_6437: bitstring,sigM1_6438: bitstring));
                                                {7102}let m1_6439: bitstring = em1_6437 in
                                                {7103}if (verify(h(m1_6439),sigM1_6438,pkCli_6434) <> true) then
                                                    0
                                                else
                                                    {7104}let (=OpenSecureChannelRequest,=pkCli_6434,Nc_6440: bitstring) = m1_6439 in
                                                    {7105}new Ns_6441: bitstring;
                                                    {7106}new ST_6442: bitstring;
                                                    {7107}new TTL_6443: bitstring;
                                                    {7108}let m2_6444: bitstring = (OpenSecureChannelResponse,Ns_6441,ST_6442,TTL_6443) in
                                                    {7109}out(c, (m2_6444,sign(h(m2_6444),skSess_6356)));
                                                    {7110}let Ksrv_6445: bitstring = h((Ns_6441,Nc_6440)) in
                                                    {7111}out(c, senc(mSrv(pkCli_6434,pkSess_6357),Ksrv_6445))
                                            )
                                            else
                                                {7112}let v_6446: bool = (Disco_5310 = B) in
                                                (
                                                    {7113}if v_6446 then
                                                    (
                                                        {7114}let pkDisco_6447: bitstring = pub(skB) in
                                                        {7115}in(c, (=pkCli_6434,em1_6448: bitstring,sigM1_6449: bitstring));
                                                        {7116}let m1_6450: bitstring = em1_6448 in
                                                        {7117}if (verify(h(m1_6450),sigM1_6449,pkCli_6434) <> true) then
                                                            0
                                                        else
                                                            {7118}let (=OpenSecureChannelRequest,=pkCli_6434,Nc_6451: bitstring) = m1_6450 in
                                                            {7119}new Ns_6452: bitstring;
                                                            {7120}new ST_6453: bitstring;
                                                            {7121}new TTL_6454: bitstring;
                                                            {7122}let m2_6455: bitstring = (OpenSecureChannelResponse,Ns_6452,ST_6453,TTL_6454) in
                                                            {7123}out(c, (m2_6455,sign(h(m2_6455),skSess_6356)));
                                                            {7124}let Ksrv_6456: bitstring = h((Ns_6452,Nc_6451)) in
                                                            {7125}out(c, senc(mSrv(pkCli_6434,pkSess_6357),Ksrv_6456))
                                                    )
                                                    else
                                                        {7126}let v_6457: bool = (Disco_5310 = C) in
                                                        (
                                                            {7127}if v_6457 then
                                                            (
                                                                {7128}let pkDisco_6458: bitstring = pub(skC) in
                                                                {7129}in(c, (=pkCli_6434,em1_6459: bitstring,sigM1_6460: bitstring));
                                                                {7130}let m1_6461: bitstring = em1_6459 in
                                                                {7131}if (verify(h(m1_6461),sigM1_6460,pkCli_6434) <> true) then
                                                                    0
                                                                else
                                                                    {7132}let (=OpenSecureChannelRequest,=pkCli_6434,Nc_6462: bitstring) = m1_6461 in
                                                                    {7133}new Ns_6463: bitstring;
                                                                    {7134}new ST_6464: bitstring;
                                                                    {7135}new TTL_6465: bitstring;
                                                                    {7136}let m2_6466: bitstring = (OpenSecureChannelResponse,Ns_6463,ST_6464,TTL_6465) in
                                                                    {7137}out(c, (m2_6466,sign(h(m2_6466),skSess_6356)));
                                                                    {7138}let Ksrv_6467: bitstring = h((Ns_6463,Nc_6462)) in
                                                                    {7139}out(c, senc(mSrv(pkCli_6434,pkSess_6357),Ksrv_6467))
                                                            )
                                                            else
                                                                {7140}let pkDisco_6468: bitstring = pub(sk(Disco_5310)) in
                                                                {7141}in(c, (=pkCli_6434,em1_6469: bitstring,sigM1_6470: bitstring));
                                                                {7142}let m1_6471: bitstring = em1_6469 in
                                                                {7143}if (verify(h(m1_6471),sigM1_6470,pkCli_6434) <> true) then
                                                                    0
                                                                else
                                                                    {7144}let (=OpenSecureChannelRequest,=pkCli_6434,Nc_6472: bitstring) = m1_6471 in
                                                                    {7145}new Ns_6473: bitstring;
                                                                    {7146}new ST_6474: bitstring;
                                                                    {7147}new TTL_6475: bitstring;
                                                                    {7148}let m2_6476: bitstring = (OpenSecureChannelResponse,Ns_6473,ST_6474,TTL_6475) in
                                                                    {7149}out(c, (m2_6476,sign(h(m2_6476),skSess_6356)));
                                                                    {7150}let Ksrv_6477: bitstring = h((Ns_6473,Nc_6472)) in
                                                                    {7151}out(c, senc(mSrv(pkCli_6434,pkSess_6357),Ksrv_6477))
                                                        )
                                                        else
                                                            {7152}let pkDisco_6478: bitstring = fail-any in
                                                            {7153}in(c, (=pkCli_6434,em1_6479: bitstring,sigM1_6480: bitstring));
                                                            {7154}let m1_6481: bitstring = em1_6479 in
                                                            {7155}if (verify(h(m1_6481),sigM1_6480,pkCli_6434) <> true) then
                                                                0
                                                            else
                                                                {7156}let (=OpenSecureChannelRequest,=pkCli_6434,Nc_6482: bitstring) = m1_6481 in
                                                                {7157}new Ns_6483: bitstring;
                                                                {7158}new ST_6484: bitstring;
                                                                {7159}new TTL_6485: bitstring;
                                                                {7160}let m2_6486: bitstring = (OpenSecureChannelResponse,Ns_6483,ST_6484,TTL_6485) in
                                                                {7161}out(c, (m2_6486,sign(h(m2_6486),skSess_6356)));
                                                                {7162}let Ksrv_6487: bitstring = h((Ns_6483,Nc_6482)) in
                                                                {7163}out(c, senc(mSrv(pkCli_6434,pkSess_6357),Ksrv_6487))
                                                )
                                                else
                                                    {7164}let pkDisco_6488: bitstring = fail-any in
                                                    {7165}in(c, (=pkCli_6434,em1_6489: bitstring,sigM1_6490: bitstring));
                                                    {7166}let m1_6491: bitstring = em1_6489 in
                                                    {7167}if (verify(h(m1_6491),sigM1_6490,pkCli_6434) <> true) then
                                                        0
                                                    else
                                                        {7168}let (=OpenSecureChannelRequest,=pkCli_6434,Nc_6492: bitstring) = m1_6491 in
                                                        {7169}new Ns_6493: bitstring;
                                                        {7170}new ST_6494: bitstring;
                                                        {7171}new TTL_6495: bitstring;
                                                        {7172}let m2_6496: bitstring = (OpenSecureChannelResponse,Ns_6493,ST_6494,TTL_6495) in
                                                        {7173}out(c, (m2_6496,sign(h(m2_6496),skSess_6356)));
                                                        {7174}let Ksrv_6497: bitstring = h((Ns_6493,Nc_6492)) in
                                                        {7175}out(c, senc(mSrv(pkCli_6434,pkSess_6357),Ksrv_6497))
                                        )
                                        else
                                            {7176}let pkDisco_6498: bitstring = fail-any in
                                            {7177}in(c, (=pkCli_6434,em1_6499: bitstring,sigM1_6500: bitstring));
                                            {7178}let m1_6501: bitstring = em1_6499 in
                                            {7179}if (verify(h(m1_6501),sigM1_6500,pkCli_6434) <> true) then
                                                0
                                            else
                                                {7180}let (=OpenSecureChannelRequest,=pkCli_6434,Nc_6502: bitstring) = m1_6501 in
                                                {7181}new Ns_6503: bitstring;
                                                {7182}new ST_6504: bitstring;
                                                {7183}new TTL_6505: bitstring;
                                                {7184}let m2_6506: bitstring = (OpenSecureChannelResponse,Ns_6503,ST_6504,TTL_6505) in
                                                {7185}out(c, (m2_6506,sign(h(m2_6506),skSess_6356)));
                                                {7186}let Ksrv_6507: bitstring = h((Ns_6503,Nc_6502)) in
                                                {7187}out(c, senc(mSrv(pkCli_6434,pkSess_6357),Ksrv_6507))
                                    )
                                    else
                                        {7188}let v_6508: bool = (Cli_5309 = C) in
                                        (
                                            {7189}if v_6508 then
                                            (
                                                {7190}let pkCli_6509: bitstring = pub(skC) in
                                                {7191}let v_6510: bool = (Disco_5310 = A) in
                                                (
                                                    {7192}if v_6510 then
                                                    (
                                                        {7193}let pkDisco_6511: bitstring = pub(skA) in
                                                        {7194}in(c, (=pkCli_6509,em1_6512: bitstring,sigM1_6513: bitstring));
                                                        {7195}let m1_6514: bitstring = em1_6512 in
                                                        {7196}if (verify(h(m1_6514),sigM1_6513,pkCli_6509) <> true) then
                                                            0
                                                        else
                                                            {7197}let (=OpenSecureChannelRequest,=pkCli_6509,Nc_6515: bitstring) = m1_6514 in
                                                            {7198}new Ns_6516: bitstring;
                                                            {7199}new ST_6517: bitstring;
                                                            {7200}new TTL_6518: bitstring;
                                                            {7201}let m2_6519: bitstring = (OpenSecureChannelResponse,Ns_6516,ST_6517,TTL_6518) in
                                                            {7202}out(c, (m2_6519,sign(h(m2_6519),skSess_6356)));
                                                            {7203}let Ksrv_6520: bitstring = h((Ns_6516,Nc_6515)) in
                                                            {7204}out(c, senc(mSrv(pkCli_6509,pkSess_6357),Ksrv_6520))
                                                    )
                                                    else
                                                        {7205}let v_6521: bool = (Disco_5310 = B) in
                                                        (
                                                            {7206}if v_6521 then
                                                            (
                                                                {7207}let pkDisco_6522: bitstring = pub(skB) in
                                                                {7208}in(c, (=pkCli_6509,em1_6523: bitstring,sigM1_6524: bitstring));
                                                                {7209}let m1_6525: bitstring = em1_6523 in
                                                                {7210}if (verify(h(m1_6525),sigM1_6524,pkCli_6509) <> true) then
                                                                    0
                                                                else
                                                                    {7211}let (=OpenSecureChannelRequest,=pkCli_6509,Nc_6526: bitstring) = m1_6525 in
                                                                    {7212}new Ns_6527: bitstring;
                                                                    {7213}new ST_6528: bitstring;
                                                                    {7214}new TTL_6529: bitstring;
                                                                    {7215}let m2_6530: bitstring = (OpenSecureChannelResponse,Ns_6527,ST_6528,TTL_6529) in
                                                                    {7216}out(c, (m2_6530,sign(h(m2_6530),skSess_6356)));
                                                                    {7217}let Ksrv_6531: bitstring = h((Ns_6527,Nc_6526)) in
                                                                    {7218}out(c, senc(mSrv(pkCli_6509,pkSess_6357),Ksrv_6531))
                                                            )
                                                            else
                                                                {7219}let v_6532: bool = (Disco_5310 = C) in
                                                                (
                                                                    {7220}if v_6532 then
                                                                    (
                                                                        {7221}let pkDisco_6533: bitstring = pub(skC) in
                                                                        {7222}in(c, (=pkCli_6509,em1_6534: bitstring,sigM1_6535: bitstring));
                                                                        {7223}let m1_6536: bitstring = em1_6534 in
                                                                        {7224}if (verify(h(m1_6536),sigM1_6535,pkCli_6509) <> true) then
                                                                            0
                                                                        else
                                                                            {7225}let (=OpenSecureChannelRequest,=pkCli_6509,Nc_6537: bitstring) = m1_6536 in
                                                                            {7226}new Ns_6538: bitstring;
                                                                            {7227}new ST_6539: bitstring;
                                                                            {7228}new TTL_6540: bitstring;
                                                                            {7229}let m2_6541: bitstring = (OpenSecureChannelResponse,Ns_6538,ST_6539,TTL_6540) in
                                                                            {7230}out(c, (m2_6541,sign(h(m2_6541),skSess_6356)));
                                                                            {7231}let Ksrv_6542: bitstring = h((Ns_6538,Nc_6537)) in
                                                                            {7232}out(c, senc(mSrv(pkCli_6509,pkSess_6357),Ksrv_6542))
                                                                    )
                                                                    else
                                                                        {7233}let pkDisco_6543: bitstring = pub(sk(Disco_5310)) in
                                                                        {7234}in(c, (=pkCli_6509,em1_6544: bitstring,sigM1_6545: bitstring));
                                                                        {7235}let m1_6546: bitstring = em1_6544 in
                                                                        {7236}if (verify(h(m1_6546),sigM1_6545,pkCli_6509) <> true) then
                                                                            0
                                                                        else
                                                                            {7237}let (=OpenSecureChannelRequest,=pkCli_6509,Nc_6547: bitstring) = m1_6546 in
                                                                            {7238}new Ns_6548: bitstring;
                                                                            {7239}new ST_6549: bitstring;
                                                                            {7240}new TTL_6550: bitstring;
                                                                            {7241}let m2_6551: bitstring = (OpenSecureChannelResponse,Ns_6548,ST_6549,TTL_6550) in
                                                                            {7242}out(c, (m2_6551,sign(h(m2_6551),skSess_6356)));
                                                                            {7243}let Ksrv_6552: bitstring = h((Ns_6548,Nc_6547)) in
                                                                            {7244}out(c, senc(mSrv(pkCli_6509,pkSess_6357),Ksrv_6552))
                                                                )
                                                                else
                                                                    {7245}let pkDisco_6553: bitstring = fail-any in
                                                                    {7246}in(c, (=pkCli_6509,em1_6554: bitstring,sigM1_6555: bitstring));
                                                                    {7247}let m1_6556: bitstring = em1_6554 in
                                                                    {7248}if (verify(h(m1_6556),sigM1_6555,pkCli_6509) <> true) then
                                                                        0
                                                                    else
                                                                        {7249}let (=OpenSecureChannelRequest,=pkCli_6509,Nc_6557: bitstring) = m1_6556 in
                                                                        {7250}new Ns_6558: bitstring;
                                                                        {7251}new ST_6559: bitstring;
                                                                        {7252}new TTL_6560: bitstring;
                                                                        {7253}let m2_6561: bitstring = (OpenSecureChannelResponse,Ns_6558,ST_6559,TTL_6560) in
                                                                        {7254}out(c, (m2_6561,sign(h(m2_6561),skSess_6356)));
                                                                        {7255}let Ksrv_6562: bitstring = h((Ns_6558,Nc_6557)) in
                                                                        {7256}out(c, senc(mSrv(pkCli_6509,pkSess_6357),Ksrv_6562))
                                                        )
                                                        else
                                                            {7257}let pkDisco_6563: bitstring = fail-any in
                                                            {7258}in(c, (=pkCli_6509,em1_6564: bitstring,sigM1_6565: bitstring));
                                                            {7259}let m1_6566: bitstring = em1_6564 in
                                                            {7260}if (verify(h(m1_6566),sigM1_6565,pkCli_6509) <> true) then
                                                                0
                                                            else
                                                                {7261}let (=OpenSecureChannelRequest,=pkCli_6509,Nc_6567: bitstring) = m1_6566 in
                                                                {7262}new Ns_6568: bitstring;
                                                                {7263}new ST_6569: bitstring;
                                                                {7264}new TTL_6570: bitstring;
                                                                {7265}let m2_6571: bitstring = (OpenSecureChannelResponse,Ns_6568,ST_6569,TTL_6570) in
                                                                {7266}out(c, (m2_6571,sign(h(m2_6571),skSess_6356)));
                                                                {7267}let Ksrv_6572: bitstring = h((Ns_6568,Nc_6567)) in
                                                                {7268}out(c, senc(mSrv(pkCli_6509,pkSess_6357),Ksrv_6572))
                                                )
                                                else
                                                    {7269}let pkDisco_6573: bitstring = fail-any in
                                                    {7270}in(c, (=pkCli_6509,em1_6574: bitstring,sigM1_6575: bitstring));
                                                    {7271}let m1_6576: bitstring = em1_6574 in
                                                    {7272}if (verify(h(m1_6576),sigM1_6575,pkCli_6509) <> true) then
                                                        0
                                                    else
                                                        {7273}let (=OpenSecureChannelRequest,=pkCli_6509,Nc_6577: bitstring) = m1_6576 in
                                                        {7274}new Ns_6578: bitstring;
                                                        {7275}new ST_6579: bitstring;
                                                        {7276}new TTL_6580: bitstring;
                                                        {7277}let m2_6581: bitstring = (OpenSecureChannelResponse,Ns_6578,ST_6579,TTL_6580) in
                                                        {7278}out(c, (m2_6581,sign(h(m2_6581),skSess_6356)));
                                                        {7279}let Ksrv_6582: bitstring = h((Ns_6578,Nc_6577)) in
                                                        {7280}out(c, senc(mSrv(pkCli_6509,pkSess_6357),Ksrv_6582))
                                            )
                                            else
                                                {7281}let pkCli_6583: bitstring = pub(sk(Cli_5309)) in
                                                {7282}let v_6584: bool = (Disco_5310 = A) in
                                                (
                                                    {7283}if v_6584 then
                                                    (
                                                        {7284}let pkDisco_6585: bitstring = pub(skA) in
                                                        {7285}in(c, (=pkCli_6583,em1_6586: bitstring,sigM1_6587: bitstring));
                                                        {7286}let m1_6588: bitstring = em1_6586 in
                                                        {7287}if (verify(h(m1_6588),sigM1_6587,pkCli_6583) <> true) then
                                                            0
                                                        else
                                                            {7288}let (=OpenSecureChannelRequest,=pkCli_6583,Nc_6589: bitstring) = m1_6588 in
                                                            {7289}new Ns_6590: bitstring;
                                                            {7290}new ST_6591: bitstring;
                                                            {7291}new TTL_6592: bitstring;
                                                            {7292}let m2_6593: bitstring = (OpenSecureChannelResponse,Ns_6590,ST_6591,TTL_6592) in
                                                            {7293}out(c, (m2_6593,sign(h(m2_6593),skSess_6356)));
                                                            {7294}let Ksrv_6594: bitstring = h((Ns_6590,Nc_6589)) in
                                                            {7295}out(c, senc(mSrv(pkCli_6583,pkSess_6357),Ksrv_6594))
                                                    )
                                                    else
                                                        {7296}let v_6595: bool = (Disco_5310 = B) in
                                                        (
                                                            {7297}if v_6595 then
                                                            (
                                                                {7298}let pkDisco_6596: bitstring = pub(skB) in
                                                                {7299}in(c, (=pkCli_6583,em1_6597: bitstring,sigM1_6598: bitstring));
                                                                {7300}let m1_6599: bitstring = em1_6597 in
                                                                {7301}if (verify(h(m1_6599),sigM1_6598,pkCli_6583) <> true) then
                                                                    0
                                                                else
                                                                    {7302}let (=OpenSecureChannelRequest,=pkCli_6583,Nc_6600: bitstring) = m1_6599 in
                                                                    {7303}new Ns_6601: bitstring;
                                                                    {7304}new ST_6602: bitstring;
                                                                    {7305}new TTL_6603: bitstring;
                                                                    {7306}let m2_6604: bitstring = (OpenSecureChannelResponse,Ns_6601,ST_6602,TTL_6603) in
                                                                    {7307}out(c, (m2_6604,sign(h(m2_6604),skSess_6356)));
                                                                    {7308}let Ksrv_6605: bitstring = h((Ns_6601,Nc_6600)) in
                                                                    {7309}out(c, senc(mSrv(pkCli_6583,pkSess_6357),Ksrv_6605))
                                                            )
                                                            else
                                                                {7310}let v_6606: bool = (Disco_5310 = C) in
                                                                (
                                                                    {7311}if v_6606 then
                                                                    (
                                                                        {7312}let pkDisco_6607: bitstring = pub(skC) in
                                                                        {7313}in(c, (=pkCli_6583,em1_6608: bitstring,sigM1_6609: bitstring));
                                                                        {7314}let m1_6610: bitstring = em1_6608 in
                                                                        {7315}if (verify(h(m1_6610),sigM1_6609,pkCli_6583) <> true) then
                                                                            0
                                                                        else
                                                                            {7316}let (=OpenSecureChannelRequest,=pkCli_6583,Nc_6611: bitstring) = m1_6610 in
                                                                            {7317}new Ns_6612: bitstring;
                                                                            {7318}new ST_6613: bitstring;
                                                                            {7319}new TTL_6614: bitstring;
                                                                            {7320}let m2_6615: bitstring = (OpenSecureChannelResponse,Ns_6612,ST_6613,TTL_6614) in
                                                                            {7321}out(c, (m2_6615,sign(h(m2_6615),skSess_6356)));
                                                                            {7322}let Ksrv_6616: bitstring = h((Ns_6612,Nc_6611)) in
                                                                            {7323}out(c, senc(mSrv(pkCli_6583,pkSess_6357),Ksrv_6616))
                                                                    )
                                                                    else
                                                                        {7324}let pkDisco_6617: bitstring = pub(sk(Disco_5310)) in
                                                                        {7325}in(c, (=pkCli_6583,em1_6618: bitstring,sigM1_6619: bitstring));
                                                                        {7326}let m1_6620: bitstring = em1_6618 in
                                                                        {7327}if (verify(h(m1_6620),sigM1_6619,pkCli_6583) <> true) then
                                                                            0
                                                                        else
                                                                            {7328}let (=OpenSecureChannelRequest,=pkCli_6583,Nc_6621: bitstring) = m1_6620 in
                                                                            {7329}new Ns_6622: bitstring;
                                                                            {7330}new ST_6623: bitstring;
                                                                            {7331}new TTL_6624: bitstring;
                                                                            {7332}let m2_6625: bitstring = (OpenSecureChannelResponse,Ns_6622,ST_6623,TTL_6624) in
                                                                            {7333}out(c, (m2_6625,sign(h(m2_6625),skSess_6356)));
                                                                            {7334}let Ksrv_6626: bitstring = h((Ns_6622,Nc_6621)) in
                                                                            {7335}out(c, senc(mSrv(pkCli_6583,pkSess_6357),Ksrv_6626))
                                                                )
                                                                else
                                                                    {7336}let pkDisco_6627: bitstring = fail-any in
                                                                    {7337}in(c, (=pkCli_6583,em1_6628: bitstring,sigM1_6629: bitstring));
                                                                    {7338}let m1_6630: bitstring = em1_6628 in
                                                                    {7339}if (verify(h(m1_6630),sigM1_6629,pkCli_6583) <> true) then
                                                                        0
                                                                    else
                                                                        {7340}let (=OpenSecureChannelRequest,=pkCli_6583,Nc_6631: bitstring) = m1_6630 in
                                                                        {7341}new Ns_6632: bitstring;
                                                                        {7342}new ST_6633: bitstring;
                                                                        {7343}new TTL_6634: bitstring;
                                                                        {7344}let m2_6635: bitstring = (OpenSecureChannelResponse,Ns_6632,ST_6633,TTL_6634) in
                                                                        {7345}out(c, (m2_6635,sign(h(m2_6635),skSess_6356)));
                                                                        {7346}let Ksrv_6636: bitstring = h((Ns_6632,Nc_6631)) in
                                                                        {7347}out(c, senc(mSrv(pkCli_6583,pkSess_6357),Ksrv_6636))
                                                        )
                                                        else
                                                            {7348}let pkDisco_6637: bitstring = fail-any in
                                                            {7349}in(c, (=pkCli_6583,em1_6638: bitstring,sigM1_6639: bitstring));
                                                            {7350}let m1_6640: bitstring = em1_6638 in
                                                            {7351}if (verify(h(m1_6640),sigM1_6639,pkCli_6583) <> true) then
                                                                0
                                                            else
                                                                {7352}let (=OpenSecureChannelRequest,=pkCli_6583,Nc_6641: bitstring) = m1_6640 in
                                                                {7353}new Ns_6642: bitstring;
                                                                {7354}new ST_6643: bitstring;
                                                                {7355}new TTL_6644: bitstring;
                                                                {7356}let m2_6645: bitstring = (OpenSecureChannelResponse,Ns_6642,ST_6643,TTL_6644) in
                                                                {7357}out(c, (m2_6645,sign(h(m2_6645),skSess_6356)));
                                                                {7358}let Ksrv_6646: bitstring = h((Ns_6642,Nc_6641)) in
                                                                {7359}out(c, senc(mSrv(pkCli_6583,pkSess_6357),Ksrv_6646))
                                                )
                                                else
                                                    {7360}let pkDisco_6647: bitstring = fail-any in
                                                    {7361}in(c, (=pkCli_6583,em1_6648: bitstring,sigM1_6649: bitstring));
                                                    {7362}let m1_6650: bitstring = em1_6648 in
                                                    {7363}if (verify(h(m1_6650),sigM1_6649,pkCli_6583) <> true) then
                                                        0
                                                    else
                                                        {7364}let (=OpenSecureChannelRequest,=pkCli_6583,Nc_6651: bitstring) = m1_6650 in
                                                        {7365}new Ns_6652: bitstring;
                                                        {7366}new ST_6653: bitstring;
                                                        {7367}new TTL_6654: bitstring;
                                                        {7368}let m2_6655: bitstring = (OpenSecureChannelResponse,Ns_6652,ST_6653,TTL_6654) in
                                                        {7369}out(c, (m2_6655,sign(h(m2_6655),skSess_6356)));
                                                        {7370}let Ksrv_6656: bitstring = h((Ns_6652,Nc_6651)) in
                                                        {7371}out(c, senc(mSrv(pkCli_6583,pkSess_6357),Ksrv_6656))
                                        )
                                        else
                                            {7372}let pkCli_6657: bitstring = fail-any in
                                            {7373}let v_6658: bool = (Disco_5310 = A) in
                                            (
                                                {7374}if v_6658 then
                                                (
                                                    {7375}let pkDisco_6659: bitstring = pub(skA) in
                                                    {7376}in(c, (=pkCli_6657,em1_6660: bitstring,sigM1_6661: bitstring));
                                                    {7377}let m1_6662: bitstring = em1_6660 in
                                                    {7378}if (verify(h(m1_6662),sigM1_6661,pkCli_6657) <> true) then
                                                        0
                                                    else
                                                        {7379}let (=OpenSecureChannelRequest,=pkCli_6657,Nc_6663: bitstring) = m1_6662 in
                                                        {7380}new Ns_6664: bitstring;
                                                        {7381}new ST_6665: bitstring;
                                                        {7382}new TTL_6666: bitstring;
                                                        {7383}let m2_6667: bitstring = (OpenSecureChannelResponse,Ns_6664,ST_6665,TTL_6666) in
                                                        {7384}out(c, (m2_6667,sign(h(m2_6667),skSess_6356)));
                                                        {7385}let Ksrv_6668: bitstring = h((Ns_6664,Nc_6663)) in
                                                        {7386}out(c, senc(mSrv(pkCli_6657,pkSess_6357),Ksrv_6668))
                                                )
                                                else
                                                    {7387}let v_6669: bool = (Disco_5310 = B) in
                                                    (
                                                        {7388}if v_6669 then
                                                        (
                                                            {7389}let pkDisco_6670: bitstring = pub(skB) in
                                                            {7390}in(c, (=pkCli_6657,em1_6671: bitstring,sigM1_6672: bitstring));
                                                            {7391}let m1_6673: bitstring = em1_6671 in
                                                            {7392}if (verify(h(m1_6673),sigM1_6672,pkCli_6657) <> true) then
                                                                0
                                                            else
                                                                {7393}let (=OpenSecureChannelRequest,=pkCli_6657,Nc_6674: bitstring) = m1_6673 in
                                                                {7394}new Ns_6675: bitstring;
                                                                {7395}new ST_6676: bitstring;
                                                                {7396}new TTL_6677: bitstring;
                                                                {7397}let m2_6678: bitstring = (OpenSecureChannelResponse,Ns_6675,ST_6676,TTL_6677) in
                                                                {7398}out(c, (m2_6678,sign(h(m2_6678),skSess_6356)));
                                                                {7399}let Ksrv_6679: bitstring = h((Ns_6675,Nc_6674)) in
                                                                {7400}out(c, senc(mSrv(pkCli_6657,pkSess_6357),Ksrv_6679))
                                                        )
                                                        else
                                                            {7401}let v_6680: bool = (Disco_5310 = C) in
                                                            (
                                                                {7402}if v_6680 then
                                                                (
                                                                    {7403}let pkDisco_6681: bitstring = pub(skC) in
                                                                    {7404}in(c, (=pkCli_6657,em1_6682: bitstring,sigM1_6683: bitstring));
                                                                    {7405}let m1_6684: bitstring = em1_6682 in
                                                                    {7406}if (verify(h(m1_6684),sigM1_6683,pkCli_6657) <> true) then
                                                                        0
                                                                    else
                                                                        {7407}let (=OpenSecureChannelRequest,=pkCli_6657,Nc_6685: bitstring) = m1_6684 in
                                                                        {7408}new Ns_6686: bitstring;
                                                                        {7409}new ST_6687: bitstring;
                                                                        {7410}new TTL_6688: bitstring;
                                                                        {7411}let m2_6689: bitstring = (OpenSecureChannelResponse,Ns_6686,ST_6687,TTL_6688) in
                                                                        {7412}out(c, (m2_6689,sign(h(m2_6689),skSess_6356)));
                                                                        {7413}let Ksrv_6690: bitstring = h((Ns_6686,Nc_6685)) in
                                                                        {7414}out(c, senc(mSrv(pkCli_6657,pkSess_6357),Ksrv_6690))
                                                                )
                                                                else
                                                                    {7415}let pkDisco_6691: bitstring = pub(sk(Disco_5310)) in
                                                                    {7416}in(c, (=pkCli_6657,em1_6692: bitstring,sigM1_6693: bitstring));
                                                                    {7417}let m1_6694: bitstring = em1_6692 in
                                                                    {7418}if (verify(h(m1_6694),sigM1_6693,pkCli_6657) <> true) then
                                                                        0
                                                                    else
                                                                        {7419}let (=OpenSecureChannelRequest,=pkCli_6657,Nc_6695: bitstring) = m1_6694 in
                                                                        {7420}new Ns_6696: bitstring;
                                                                        {7421}new ST_6697: bitstring;
                                                                        {7422}new TTL_6698: bitstring;
                                                                        {7423}let m2_6699: bitstring = (OpenSecureChannelResponse,Ns_6696,ST_6697,TTL_6698) in
                                                                        {7424}out(c, (m2_6699,sign(h(m2_6699),skSess_6356)));
                                                                        {7425}let Ksrv_6700: bitstring = h((Ns_6696,Nc_6695)) in
                                                                        {7426}out(c, senc(mSrv(pkCli_6657,pkSess_6357),Ksrv_6700))
                                                            )
                                                            else
                                                                {7427}let pkDisco_6701: bitstring = fail-any in
                                                                {7428}in(c, (=pkCli_6657,em1_6702: bitstring,sigM1_6703: bitstring));
                                                                {7429}let m1_6704: bitstring = em1_6702 in
                                                                {7430}if (verify(h(m1_6704),sigM1_6703,pkCli_6657) <> true) then
                                                                    0
                                                                else
                                                                    {7431}let (=OpenSecureChannelRequest,=pkCli_6657,Nc_6705: bitstring) = m1_6704 in
                                                                    {7432}new Ns_6706: bitstring;
                                                                    {7433}new ST_6707: bitstring;
                                                                    {7434}new TTL_6708: bitstring;
                                                                    {7435}let m2_6709: bitstring = (OpenSecureChannelResponse,Ns_6706,ST_6707,TTL_6708) in
                                                                    {7436}out(c, (m2_6709,sign(h(m2_6709),skSess_6356)));
                                                                    {7437}let Ksrv_6710: bitstring = h((Ns_6706,Nc_6705)) in
                                                                    {7438}out(c, senc(mSrv(pkCli_6657,pkSess_6357),Ksrv_6710))
                                                    )
                                                    else
                                                        {7439}let pkDisco_6711: bitstring = fail-any in
                                                        {7440}in(c, (=pkCli_6657,em1_6712: bitstring,sigM1_6713: bitstring));
                                                        {7441}let m1_6714: bitstring = em1_6712 in
                                                        {7442}if (verify(h(m1_6714),sigM1_6713,pkCli_6657) <> true) then
                                                            0
                                                        else
                                                            {7443}let (=OpenSecureChannelRequest,=pkCli_6657,Nc_6715: bitstring) = m1_6714 in
                                                            {7444}new Ns_6716: bitstring;
                                                            {7445}new ST_6717: bitstring;
                                                            {7446}new TTL_6718: bitstring;
                                                            {7447}let m2_6719: bitstring = (OpenSecureChannelResponse,Ns_6716,ST_6717,TTL_6718) in
                                                            {7448}out(c, (m2_6719,sign(h(m2_6719),skSess_6356)));
                                                            {7449}let Ksrv_6720: bitstring = h((Ns_6716,Nc_6715)) in
                                                            {7450}out(c, senc(mSrv(pkCli_6657,pkSess_6357),Ksrv_6720))
                                            )
                                            else
                                                {7451}let pkDisco_6721: bitstring = fail-any in
                                                {7452}in(c, (=pkCli_6657,em1_6722: bitstring,sigM1_6723: bitstring));
                                                {7453}let m1_6724: bitstring = em1_6722 in
                                                {7454}if (verify(h(m1_6724),sigM1_6723,pkCli_6657) <> true) then
                                                    0
                                                else
                                                    {7455}let (=OpenSecureChannelRequest,=pkCli_6657,Nc_6725: bitstring) = m1_6724 in
                                                    {7456}new Ns_6726: bitstring;
                                                    {7457}new ST_6727: bitstring;
                                                    {7458}new TTL_6728: bitstring;
                                                    {7459}let m2_6729: bitstring = (OpenSecureChannelResponse,Ns_6726,ST_6727,TTL_6728) in
                                                    {7460}out(c, (m2_6729,sign(h(m2_6729),skSess_6356)));
                                                    {7461}let Ksrv_6730: bitstring = h((Ns_6726,Nc_6725)) in
                                                    {7462}out(c, senc(mSrv(pkCli_6657,pkSess_6357),Ksrv_6730))
                                )
                                else
                                    {7463}let pkCli_6731: bitstring = fail-any in
                                    {7464}let v_6732: bool = (Disco_5310 = A) in
                                    (
                                        {7465}if v_6732 then
                                        (
                                            {7466}let pkDisco_6733: bitstring = pub(skA) in
                                            {7467}in(c, (=pkCli_6731,em1_6734: bitstring,sigM1_6735: bitstring));
                                            {7468}let m1_6736: bitstring = em1_6734 in
                                            {7469}if (verify(h(m1_6736),sigM1_6735,pkCli_6731) <> true) then
                                                0
                                            else
                                                {7470}let (=OpenSecureChannelRequest,=pkCli_6731,Nc_6737: bitstring) = m1_6736 in
                                                {7471}new Ns_6738: bitstring;
                                                {7472}new ST_6739: bitstring;
                                                {7473}new TTL_6740: bitstring;
                                                {7474}let m2_6741: bitstring = (OpenSecureChannelResponse,Ns_6738,ST_6739,TTL_6740) in
                                                {7475}out(c, (m2_6741,sign(h(m2_6741),skSess_6356)));
                                                {7476}let Ksrv_6742: bitstring = h((Ns_6738,Nc_6737)) in
                                                {7477}out(c, senc(mSrv(pkCli_6731,pkSess_6357),Ksrv_6742))
                                        )
                                        else
                                            {7478}let v_6743: bool = (Disco_5310 = B) in
                                            (
                                                {7479}if v_6743 then
                                                (
                                                    {7480}let pkDisco_6744: bitstring = pub(skB) in
                                                    {7481}in(c, (=pkCli_6731,em1_6745: bitstring,sigM1_6746: bitstring));
                                                    {7482}let m1_6747: bitstring = em1_6745 in
                                                    {7483}if (verify(h(m1_6747),sigM1_6746,pkCli_6731) <> true) then
                                                        0
                                                    else
                                                        {7484}let (=OpenSecureChannelRequest,=pkCli_6731,Nc_6748: bitstring) = m1_6747 in
                                                        {7485}new Ns_6749: bitstring;
                                                        {7486}new ST_6750: bitstring;
                                                        {7487}new TTL_6751: bitstring;
                                                        {7488}let m2_6752: bitstring = (OpenSecureChannelResponse,Ns_6749,ST_6750,TTL_6751) in
                                                        {7489}out(c, (m2_6752,sign(h(m2_6752),skSess_6356)));
                                                        {7490}let Ksrv_6753: bitstring = h((Ns_6749,Nc_6748)) in
                                                        {7491}out(c, senc(mSrv(pkCli_6731,pkSess_6357),Ksrv_6753))
                                                )
                                                else
                                                    {7492}let v_6754: bool = (Disco_5310 = C) in
                                                    (
                                                        {7493}if v_6754 then
                                                        (
                                                            {7494}let pkDisco_6755: bitstring = pub(skC) in
                                                            {7495}in(c, (=pkCli_6731,em1_6756: bitstring,sigM1_6757: bitstring));
                                                            {7496}let m1_6758: bitstring = em1_6756 in
                                                            {7497}if (verify(h(m1_6758),sigM1_6757,pkCli_6731) <> true) then
                                                                0
                                                            else
                                                                {7498}let (=OpenSecureChannelRequest,=pkCli_6731,Nc_6759: bitstring) = m1_6758 in
                                                                {7499}new Ns_6760: bitstring;
                                                                {7500}new ST_6761: bitstring;
                                                                {7501}new TTL_6762: bitstring;
                                                                {7502}let m2_6763: bitstring = (OpenSecureChannelResponse,Ns_6760,ST_6761,TTL_6762) in
                                                                {7503}out(c, (m2_6763,sign(h(m2_6763),skSess_6356)));
                                                                {7504}let Ksrv_6764: bitstring = h((Ns_6760,Nc_6759)) in
                                                                {7505}out(c, senc(mSrv(pkCli_6731,pkSess_6357),Ksrv_6764))
                                                        )
                                                        else
                                                            {7506}let pkDisco_6765: bitstring = pub(sk(Disco_5310)) in
                                                            {7507}in(c, (=pkCli_6731,em1_6766: bitstring,sigM1_6767: bitstring));
                                                            {7508}let m1_6768: bitstring = em1_6766 in
                                                            {7509}if (verify(h(m1_6768),sigM1_6767,pkCli_6731) <> true) then
                                                                0
                                                            else
                                                                {7510}let (=OpenSecureChannelRequest,=pkCli_6731,Nc_6769: bitstring) = m1_6768 in
                                                                {7511}new Ns_6770: bitstring;
                                                                {7512}new ST_6771: bitstring;
                                                                {7513}new TTL_6772: bitstring;
                                                                {7514}let m2_6773: bitstring = (OpenSecureChannelResponse,Ns_6770,ST_6771,TTL_6772) in
                                                                {7515}out(c, (m2_6773,sign(h(m2_6773),skSess_6356)));
                                                                {7516}let Ksrv_6774: bitstring = h((Ns_6770,Nc_6769)) in
                                                                {7517}out(c, senc(mSrv(pkCli_6731,pkSess_6357),Ksrv_6774))
                                                    )
                                                    else
                                                        {7518}let pkDisco_6775: bitstring = fail-any in
                                                        {7519}in(c, (=pkCli_6731,em1_6776: bitstring,sigM1_6777: bitstring));
                                                        {7520}let m1_6778: bitstring = em1_6776 in
                                                        {7521}if (verify(h(m1_6778),sigM1_6777,pkCli_6731) <> true) then
                                                            0
                                                        else
                                                            {7522}let (=OpenSecureChannelRequest,=pkCli_6731,Nc_6779: bitstring) = m1_6778 in
                                                            {7523}new Ns_6780: bitstring;
                                                            {7524}new ST_6781: bitstring;
                                                            {7525}new TTL_6782: bitstring;
                                                            {7526}let m2_6783: bitstring = (OpenSecureChannelResponse,Ns_6780,ST_6781,TTL_6782) in
                                                            {7527}out(c, (m2_6783,sign(h(m2_6783),skSess_6356)));
                                                            {7528}let Ksrv_6784: bitstring = h((Ns_6780,Nc_6779)) in
                                                            {7529}out(c, senc(mSrv(pkCli_6731,pkSess_6357),Ksrv_6784))
                                            )
                                            else
                                                {7530}let pkDisco_6785: bitstring = fail-any in
                                                {7531}in(c, (=pkCli_6731,em1_6786: bitstring,sigM1_6787: bitstring));
                                                {7532}let m1_6788: bitstring = em1_6786 in
                                                {7533}if (verify(h(m1_6788),sigM1_6787,pkCli_6731) <> true) then
                                                    0
                                                else
                                                    {7534}let (=OpenSecureChannelRequest,=pkCli_6731,Nc_6789: bitstring) = m1_6788 in
                                                    {7535}new Ns_6790: bitstring;
                                                    {7536}new ST_6791: bitstring;
                                                    {7537}new TTL_6792: bitstring;
                                                    {7538}let m2_6793: bitstring = (OpenSecureChannelResponse,Ns_6790,ST_6791,TTL_6792) in
                                                    {7539}out(c, (m2_6793,sign(h(m2_6793),skSess_6356)));
                                                    {7540}let Ksrv_6794: bitstring = h((Ns_6790,Nc_6789)) in
                                                    {7541}out(c, senc(mSrv(pkCli_6731,pkSess_6357),Ksrv_6794))
                                    )
                                    else
                                        {7542}let pkDisco_6795: bitstring = fail-any in
                                        {7543}in(c, (=pkCli_6731,em1_6796: bitstring,sigM1_6797: bitstring));
                                        {7544}let m1_6798: bitstring = em1_6796 in
                                        {7545}if (verify(h(m1_6798),sigM1_6797,pkCli_6731) <> true) then
                                            0
                                        else
                                            {7546}let (=OpenSecureChannelRequest,=pkCli_6731,Nc_6799: bitstring) = m1_6798 in
                                            {7547}new Ns_6800: bitstring;
                                            {7548}new ST_6801: bitstring;
                                            {7549}new TTL_6802: bitstring;
                                            {7550}let m2_6803: bitstring = (OpenSecureChannelResponse,Ns_6800,ST_6801,TTL_6802) in
                                            {7551}out(c, (m2_6803,sign(h(m2_6803),skSess_6356)));
                                            {7552}let Ksrv_6804: bitstring = h((Ns_6800,Nc_6799)) in
                                            {7553}out(c, senc(mSrv(pkCli_6731,pkSess_6357),Ksrv_6804))
                        )
                        else
                            {7554}let pkCli_6805: bitstring = fail-any in
                            {7555}let v_6806: bool = (Disco_5310 = A) in
                            (
                                {7556}if v_6806 then
                                (
                                    {7557}let pkDisco_6807: bitstring = pub(skA) in
                                    {7558}in(c, (=pkCli_6805,em1_6808: bitstring,sigM1_6809: bitstring));
                                    {7559}let m1_6810: bitstring = em1_6808 in
                                    {7560}if (verify(h(m1_6810),sigM1_6809,pkCli_6805) <> true) then
                                        0
                                    else
                                        {7561}let (=OpenSecureChannelRequest,=pkCli_6805,Nc_6811: bitstring) = m1_6810 in
                                        {7562}new Ns_6812: bitstring;
                                        {7563}new ST_6813: bitstring;
                                        {7564}new TTL_6814: bitstring;
                                        {7565}let m2_6815: bitstring = (OpenSecureChannelResponse,Ns_6812,ST_6813,TTL_6814) in
                                        {7566}out(c, (m2_6815,sign(h(m2_6815),skSess_6356)));
                                        {7567}let Ksrv_6816: bitstring = h((Ns_6812,Nc_6811)) in
                                        {7568}out(c, senc(mSrv(pkCli_6805,pkSess_6357),Ksrv_6816))
                                )
                                else
                                    {7569}let v_6817: bool = (Disco_5310 = B) in
                                    (
                                        {7570}if v_6817 then
                                        (
                                            {7571}let pkDisco_6818: bitstring = pub(skB) in
                                            {7572}in(c, (=pkCli_6805,em1_6819: bitstring,sigM1_6820: bitstring));
                                            {7573}let m1_6821: bitstring = em1_6819 in
                                            {7574}if (verify(h(m1_6821),sigM1_6820,pkCli_6805) <> true) then
                                                0
                                            else
                                                {7575}let (=OpenSecureChannelRequest,=pkCli_6805,Nc_6822: bitstring) = m1_6821 in
                                                {7576}new Ns_6823: bitstring;
                                                {7577}new ST_6824: bitstring;
                                                {7578}new TTL_6825: bitstring;
                                                {7579}let m2_6826: bitstring = (OpenSecureChannelResponse,Ns_6823,ST_6824,TTL_6825) in
                                                {7580}out(c, (m2_6826,sign(h(m2_6826),skSess_6356)));
                                                {7581}let Ksrv_6827: bitstring = h((Ns_6823,Nc_6822)) in
                                                {7582}out(c, senc(mSrv(pkCli_6805,pkSess_6357),Ksrv_6827))
                                        )
                                        else
                                            {7583}let v_6828: bool = (Disco_5310 = C) in
                                            (
                                                {7584}if v_6828 then
                                                (
                                                    {7585}let pkDisco_6829: bitstring = pub(skC) in
                                                    {7586}in(c, (=pkCli_6805,em1_6830: bitstring,sigM1_6831: bitstring));
                                                    {7587}let m1_6832: bitstring = em1_6830 in
                                                    {7588}if (verify(h(m1_6832),sigM1_6831,pkCli_6805) <> true) then
                                                        0
                                                    else
                                                        {7589}let (=OpenSecureChannelRequest,=pkCli_6805,Nc_6833: bitstring) = m1_6832 in
                                                        {7590}new Ns_6834: bitstring;
                                                        {7591}new ST_6835: bitstring;
                                                        {7592}new TTL_6836: bitstring;
                                                        {7593}let m2_6837: bitstring = (OpenSecureChannelResponse,Ns_6834,ST_6835,TTL_6836) in
                                                        {7594}out(c, (m2_6837,sign(h(m2_6837),skSess_6356)));
                                                        {7595}let Ksrv_6838: bitstring = h((Ns_6834,Nc_6833)) in
                                                        {7596}out(c, senc(mSrv(pkCli_6805,pkSess_6357),Ksrv_6838))
                                                )
                                                else
                                                    {7597}let pkDisco_6839: bitstring = pub(sk(Disco_5310)) in
                                                    {7598}in(c, (=pkCli_6805,em1_6840: bitstring,sigM1_6841: bitstring));
                                                    {7599}let m1_6842: bitstring = em1_6840 in
                                                    {7600}if (verify(h(m1_6842),sigM1_6841,pkCli_6805) <> true) then
                                                        0
                                                    else
                                                        {7601}let (=OpenSecureChannelRequest,=pkCli_6805,Nc_6843: bitstring) = m1_6842 in
                                                        {7602}new Ns_6844: bitstring;
                                                        {7603}new ST_6845: bitstring;
                                                        {7604}new TTL_6846: bitstring;
                                                        {7605}let m2_6847: bitstring = (OpenSecureChannelResponse,Ns_6844,ST_6845,TTL_6846) in
                                                        {7606}out(c, (m2_6847,sign(h(m2_6847),skSess_6356)));
                                                        {7607}let Ksrv_6848: bitstring = h((Ns_6844,Nc_6843)) in
                                                        {7608}out(c, senc(mSrv(pkCli_6805,pkSess_6357),Ksrv_6848))
                                            )
                                            else
                                                {7609}let pkDisco_6849: bitstring = fail-any in
                                                {7610}in(c, (=pkCli_6805,em1_6850: bitstring,sigM1_6851: bitstring));
                                                {7611}let m1_6852: bitstring = em1_6850 in
                                                {7612}if (verify(h(m1_6852),sigM1_6851,pkCli_6805) <> true) then
                                                    0
                                                else
                                                    {7613}let (=OpenSecureChannelRequest,=pkCli_6805,Nc_6853: bitstring) = m1_6852 in
                                                    {7614}new Ns_6854: bitstring;
                                                    {7615}new ST_6855: bitstring;
                                                    {7616}new TTL_6856: bitstring;
                                                    {7617}let m2_6857: bitstring = (OpenSecureChannelResponse,Ns_6854,ST_6855,TTL_6856) in
                                                    {7618}out(c, (m2_6857,sign(h(m2_6857),skSess_6356)));
                                                    {7619}let Ksrv_6858: bitstring = h((Ns_6854,Nc_6853)) in
                                                    {7620}out(c, senc(mSrv(pkCli_6805,pkSess_6357),Ksrv_6858))
                                    )
                                    else
                                        {7621}let pkDisco_6859: bitstring = fail-any in
                                        {7622}in(c, (=pkCli_6805,em1_6860: bitstring,sigM1_6861: bitstring));
                                        {7623}let m1_6862: bitstring = em1_6860 in
                                        {7624}if (verify(h(m1_6862),sigM1_6861,pkCli_6805) <> true) then
                                            0
                                        else
                                            {7625}let (=OpenSecureChannelRequest,=pkCli_6805,Nc_6863: bitstring) = m1_6862 in
                                            {7626}new Ns_6864: bitstring;
                                            {7627}new ST_6865: bitstring;
                                            {7628}new TTL_6866: bitstring;
                                            {7629}let m2_6867: bitstring = (OpenSecureChannelResponse,Ns_6864,ST_6865,TTL_6866) in
                                            {7630}out(c, (m2_6867,sign(h(m2_6867),skSess_6356)));
                                            {7631}let Ksrv_6868: bitstring = h((Ns_6864,Nc_6863)) in
                                            {7632}out(c, senc(mSrv(pkCli_6805,pkSess_6357),Ksrv_6868))
                            )
                            else
                                {7633}let pkDisco_6869: bitstring = fail-any in
                                {7634}in(c, (=pkCli_6805,em1_6870: bitstring,sigM1_6871: bitstring));
                                {7635}let m1_6872: bitstring = em1_6870 in
                                {7636}if (verify(h(m1_6872),sigM1_6871,pkCli_6805) <> true) then
                                    0
                                else
                                    {7637}let (=OpenSecureChannelRequest,=pkCli_6805,Nc_6873: bitstring) = m1_6872 in
                                    {7638}new Ns_6874: bitstring;
                                    {7639}new ST_6875: bitstring;
                                    {7640}new TTL_6876: bitstring;
                                    {7641}let m2_6877: bitstring = (OpenSecureChannelResponse,Ns_6874,ST_6875,TTL_6876) in
                                    {7642}out(c, (m2_6877,sign(h(m2_6877),skSess_6356)));
                                    {7643}let Ksrv_6878: bitstring = h((Ns_6874,Nc_6873)) in
                                    {7644}out(c, senc(mSrv(pkCli_6805,pkSess_6357),Ksrv_6878))
                    )
                    else
                        {7645}let skSess_6879: bitstring = fail-any in
                        {7646}let pkSess_6880: bitstring = pub(skSess_6879) in
                        {7647}let v_6881: bool = (Cli_5309 = A) in
                        (
                            {7648}if v_6881 then
                            (
                                {7649}let pkCli_6882: bitstring = pub(skA) in
                                {7650}let v_6883: bool = (Disco_5310 = A) in
                                (
                                    {7651}if v_6883 then
                                    (
                                        {7652}let pkDisco_6884: bitstring = pub(skA) in
                                        {7653}in(c, (=pkCli_6882,em1_6885: bitstring,sigM1_6886: bitstring));
                                        {7654}let m1_6887: bitstring = em1_6885 in
                                        {7655}if (verify(h(m1_6887),sigM1_6886,pkCli_6882) <> true) then
                                            0
                                        else
                                            {7656}let (=OpenSecureChannelRequest,=pkCli_6882,Nc_6888: bitstring) = m1_6887 in
                                            {7657}new Ns_6889: bitstring;
                                            {7658}new ST_6890: bitstring;
                                            {7659}new TTL_6891: bitstring;
                                            {7660}let m2_6892: bitstring = (OpenSecureChannelResponse,Ns_6889,ST_6890,TTL_6891) in
                                            {7661}out(c, (m2_6892,sign(h(m2_6892),skSess_6879)));
                                            {7662}let Ksrv_6893: bitstring = h((Ns_6889,Nc_6888)) in
                                            {7663}out(c, senc(mSrv(pkCli_6882,pkSess_6880),Ksrv_6893))
                                    )
                                    else
                                        {7664}let v_6894: bool = (Disco_5310 = B) in
                                        (
                                            {7665}if v_6894 then
                                            (
                                                {7666}let pkDisco_6895: bitstring = pub(skB) in
                                                {7667}in(c, (=pkCli_6882,em1_6896: bitstring,sigM1_6897: bitstring));
                                                {7668}let m1_6898: bitstring = em1_6896 in
                                                {7669}if (verify(h(m1_6898),sigM1_6897,pkCli_6882) <> true) then
                                                    0
                                                else
                                                    {7670}let (=OpenSecureChannelRequest,=pkCli_6882,Nc_6899: bitstring) = m1_6898 in
                                                    {7671}new Ns_6900: bitstring;
                                                    {7672}new ST_6901: bitstring;
                                                    {7673}new TTL_6902: bitstring;
                                                    {7674}let m2_6903: bitstring = (OpenSecureChannelResponse,Ns_6900,ST_6901,TTL_6902) in
                                                    {7675}out(c, (m2_6903,sign(h(m2_6903),skSess_6879)));
                                                    {7676}let Ksrv_6904: bitstring = h((Ns_6900,Nc_6899)) in
                                                    {7677}out(c, senc(mSrv(pkCli_6882,pkSess_6880),Ksrv_6904))
                                            )
                                            else
                                                {7678}let v_6905: bool = (Disco_5310 = C) in
                                                (
                                                    {7679}if v_6905 then
                                                    (
                                                        {7680}let pkDisco_6906: bitstring = pub(skC) in
                                                        {7681}in(c, (=pkCli_6882,em1_6907: bitstring,sigM1_6908: bitstring));
                                                        {7682}let m1_6909: bitstring = em1_6907 in
                                                        {7683}if (verify(h(m1_6909),sigM1_6908,pkCli_6882) <> true) then
                                                            0
                                                        else
                                                            {7684}let (=OpenSecureChannelRequest,=pkCli_6882,Nc_6910: bitstring) = m1_6909 in
                                                            {7685}new Ns_6911: bitstring;
                                                            {7686}new ST_6912: bitstring;
                                                            {7687}new TTL_6913: bitstring;
                                                            {7688}let m2_6914: bitstring = (OpenSecureChannelResponse,Ns_6911,ST_6912,TTL_6913) in
                                                            {7689}out(c, (m2_6914,sign(h(m2_6914),skSess_6879)));
                                                            {7690}let Ksrv_6915: bitstring = h((Ns_6911,Nc_6910)) in
                                                            {7691}out(c, senc(mSrv(pkCli_6882,pkSess_6880),Ksrv_6915))
                                                    )
                                                    else
                                                        {7692}let pkDisco_6916: bitstring = pub(sk(Disco_5310)) in
                                                        {7693}in(c, (=pkCli_6882,em1_6917: bitstring,sigM1_6918: bitstring));
                                                        {7694}let m1_6919: bitstring = em1_6917 in
                                                        {7695}if (verify(h(m1_6919),sigM1_6918,pkCli_6882) <> true) then
                                                            0
                                                        else
                                                            {7696}let (=OpenSecureChannelRequest,=pkCli_6882,Nc_6920: bitstring) = m1_6919 in
                                                            {7697}new Ns_6921: bitstring;
                                                            {7698}new ST_6922: bitstring;
                                                            {7699}new TTL_6923: bitstring;
                                                            {7700}let m2_6924: bitstring = (OpenSecureChannelResponse,Ns_6921,ST_6922,TTL_6923) in
                                                            {7701}out(c, (m2_6924,sign(h(m2_6924),skSess_6879)));
                                                            {7702}let Ksrv_6925: bitstring = h((Ns_6921,Nc_6920)) in
                                                            {7703}out(c, senc(mSrv(pkCli_6882,pkSess_6880),Ksrv_6925))
                                                )
                                                else
                                                    {7704}let pkDisco_6926: bitstring = fail-any in
                                                    {7705}in(c, (=pkCli_6882,em1_6927: bitstring,sigM1_6928: bitstring));
                                                    {7706}let m1_6929: bitstring = em1_6927 in
                                                    {7707}if (verify(h(m1_6929),sigM1_6928,pkCli_6882) <> true) then
                                                        0
                                                    else
                                                        {7708}let (=OpenSecureChannelRequest,=pkCli_6882,Nc_6930: bitstring) = m1_6929 in
                                                        {7709}new Ns_6931: bitstring;
                                                        {7710}new ST_6932: bitstring;
                                                        {7711}new TTL_6933: bitstring;
                                                        {7712}let m2_6934: bitstring = (OpenSecureChannelResponse,Ns_6931,ST_6932,TTL_6933) in
                                                        {7713}out(c, (m2_6934,sign(h(m2_6934),skSess_6879)));
                                                        {7714}let Ksrv_6935: bitstring = h((Ns_6931,Nc_6930)) in
                                                        {7715}out(c, senc(mSrv(pkCli_6882,pkSess_6880),Ksrv_6935))
                                        )
                                        else
                                            {7716}let pkDisco_6936: bitstring = fail-any in
                                            {7717}in(c, (=pkCli_6882,em1_6937: bitstring,sigM1_6938: bitstring));
                                            {7718}let m1_6939: bitstring = em1_6937 in
                                            {7719}if (verify(h(m1_6939),sigM1_6938,pkCli_6882) <> true) then
                                                0
                                            else
                                                {7720}let (=OpenSecureChannelRequest,=pkCli_6882,Nc_6940: bitstring) = m1_6939 in
                                                {7721}new Ns_6941: bitstring;
                                                {7722}new ST_6942: bitstring;
                                                {7723}new TTL_6943: bitstring;
                                                {7724}let m2_6944: bitstring = (OpenSecureChannelResponse,Ns_6941,ST_6942,TTL_6943) in
                                                {7725}out(c, (m2_6944,sign(h(m2_6944),skSess_6879)));
                                                {7726}let Ksrv_6945: bitstring = h((Ns_6941,Nc_6940)) in
                                                {7727}out(c, senc(mSrv(pkCli_6882,pkSess_6880),Ksrv_6945))
                                )
                                else
                                    {7728}let pkDisco_6946: bitstring = fail-any in
                                    {7729}in(c, (=pkCli_6882,em1_6947: bitstring,sigM1_6948: bitstring));
                                    {7730}let m1_6949: bitstring = em1_6947 in
                                    {7731}if (verify(h(m1_6949),sigM1_6948,pkCli_6882) <> true) then
                                        0
                                    else
                                        {7732}let (=OpenSecureChannelRequest,=pkCli_6882,Nc_6950: bitstring) = m1_6949 in
                                        {7733}new Ns_6951: bitstring;
                                        {7734}new ST_6952: bitstring;
                                        {7735}new TTL_6953: bitstring;
                                        {7736}let m2_6954: bitstring = (OpenSecureChannelResponse,Ns_6951,ST_6952,TTL_6953) in
                                        {7737}out(c, (m2_6954,sign(h(m2_6954),skSess_6879)));
                                        {7738}let Ksrv_6955: bitstring = h((Ns_6951,Nc_6950)) in
                                        {7739}out(c, senc(mSrv(pkCli_6882,pkSess_6880),Ksrv_6955))
                            )
                            else
                                {7740}let v_6956: bool = (Cli_5309 = B) in
                                (
                                    {7741}if v_6956 then
                                    (
                                        {7742}let pkCli_6957: bitstring = pub(skB) in
                                        {7743}let v_6958: bool = (Disco_5310 = A) in
                                        (
                                            {7744}if v_6958 then
                                            (
                                                {7745}let pkDisco_6959: bitstring = pub(skA) in
                                                {7746}in(c, (=pkCli_6957,em1_6960: bitstring,sigM1_6961: bitstring));
                                                {7747}let m1_6962: bitstring = em1_6960 in
                                                {7748}if (verify(h(m1_6962),sigM1_6961,pkCli_6957) <> true) then
                                                    0
                                                else
                                                    {7749}let (=OpenSecureChannelRequest,=pkCli_6957,Nc_6963: bitstring) = m1_6962 in
                                                    {7750}new Ns_6964: bitstring;
                                                    {7751}new ST_6965: bitstring;
                                                    {7752}new TTL_6966: bitstring;
                                                    {7753}let m2_6967: bitstring = (OpenSecureChannelResponse,Ns_6964,ST_6965,TTL_6966) in
                                                    {7754}out(c, (m2_6967,sign(h(m2_6967),skSess_6879)));
                                                    {7755}let Ksrv_6968: bitstring = h((Ns_6964,Nc_6963)) in
                                                    {7756}out(c, senc(mSrv(pkCli_6957,pkSess_6880),Ksrv_6968))
                                            )
                                            else
                                                {7757}let v_6969: bool = (Disco_5310 = B) in
                                                (
                                                    {7758}if v_6969 then
                                                    (
                                                        {7759}let pkDisco_6970: bitstring = pub(skB) in
                                                        {7760}in(c, (=pkCli_6957,em1_6971: bitstring,sigM1_6972: bitstring));
                                                        {7761}let m1_6973: bitstring = em1_6971 in
                                                        {7762}if (verify(h(m1_6973),sigM1_6972,pkCli_6957) <> true) then
                                                            0
                                                        else
                                                            {7763}let (=OpenSecureChannelRequest,=pkCli_6957,Nc_6974: bitstring) = m1_6973 in
                                                            {7764}new Ns_6975: bitstring;
                                                            {7765}new ST_6976: bitstring;
                                                            {7766}new TTL_6977: bitstring;
                                                            {7767}let m2_6978: bitstring = (OpenSecureChannelResponse,Ns_6975,ST_6976,TTL_6977) in
                                                            {7768}out(c, (m2_6978,sign(h(m2_6978),skSess_6879)));
                                                            {7769}let Ksrv_6979: bitstring = h((Ns_6975,Nc_6974)) in
                                                            {7770}out(c, senc(mSrv(pkCli_6957,pkSess_6880),Ksrv_6979))
                                                    )
                                                    else
                                                        {7771}let v_6980: bool = (Disco_5310 = C) in
                                                        (
                                                            {7772}if v_6980 then
                                                            (
                                                                {7773}let pkDisco_6981: bitstring = pub(skC) in
                                                                {7774}in(c, (=pkCli_6957,em1_6982: bitstring,sigM1_6983: bitstring));
                                                                {7775}let m1_6984: bitstring = em1_6982 in
                                                                {7776}if (verify(h(m1_6984),sigM1_6983,pkCli_6957) <> true) then
                                                                    0
                                                                else
                                                                    {7777}let (=OpenSecureChannelRequest,=pkCli_6957,Nc_6985: bitstring) = m1_6984 in
                                                                    {7778}new Ns_6986: bitstring;
                                                                    {7779}new ST_6987: bitstring;
                                                                    {7780}new TTL_6988: bitstring;
                                                                    {7781}let m2_6989: bitstring = (OpenSecureChannelResponse,Ns_6986,ST_6987,TTL_6988) in
                                                                    {7782}out(c, (m2_6989,sign(h(m2_6989),skSess_6879)));
                                                                    {7783}let Ksrv_6990: bitstring = h((Ns_6986,Nc_6985)) in
                                                                    {7784}out(c, senc(mSrv(pkCli_6957,pkSess_6880),Ksrv_6990))
                                                            )
                                                            else
                                                                {7785}let pkDisco_6991: bitstring = pub(sk(Disco_5310)) in
                                                                {7786}in(c, (=pkCli_6957,em1_6992: bitstring,sigM1_6993: bitstring));
                                                                {7787}let m1_6994: bitstring = em1_6992 in
                                                                {7788}if (verify(h(m1_6994),sigM1_6993,pkCli_6957) <> true) then
                                                                    0
                                                                else
                                                                    {7789}let (=OpenSecureChannelRequest,=pkCli_6957,Nc_6995: bitstring) = m1_6994 in
                                                                    {7790}new Ns_6996: bitstring;
                                                                    {7791}new ST_6997: bitstring;
                                                                    {7792}new TTL_6998: bitstring;
                                                                    {7793}let m2_6999: bitstring = (OpenSecureChannelResponse,Ns_6996,ST_6997,TTL_6998) in
                                                                    {7794}out(c, (m2_6999,sign(h(m2_6999),skSess_6879)));
                                                                    {7795}let Ksrv_7000: bitstring = h((Ns_6996,Nc_6995)) in
                                                                    {7796}out(c, senc(mSrv(pkCli_6957,pkSess_6880),Ksrv_7000))
                                                        )
                                                        else
                                                            {7797}let pkDisco_7001: bitstring = fail-any in
                                                            {7798}in(c, (=pkCli_6957,em1_7002: bitstring,sigM1_7003: bitstring));
                                                            {7799}let m1_7004: bitstring = em1_7002 in
                                                            {7800}if (verify(h(m1_7004),sigM1_7003,pkCli_6957) <> true) then
                                                                0
                                                            else
                                                                {7801}let (=OpenSecureChannelRequest,=pkCli_6957,Nc_7005: bitstring) = m1_7004 in
                                                                {7802}new Ns_7006: bitstring;
                                                                {7803}new ST_7007: bitstring;
                                                                {7804}new TTL_7008: bitstring;
                                                                {7805}let m2_7009: bitstring = (OpenSecureChannelResponse,Ns_7006,ST_7007,TTL_7008) in
                                                                {7806}out(c, (m2_7009,sign(h(m2_7009),skSess_6879)));
                                                                {7807}let Ksrv_7010: bitstring = h((Ns_7006,Nc_7005)) in
                                                                {7808}out(c, senc(mSrv(pkCli_6957,pkSess_6880),Ksrv_7010))
                                                )
                                                else
                                                    {7809}let pkDisco_7011: bitstring = fail-any in
                                                    {7810}in(c, (=pkCli_6957,em1_7012: bitstring,sigM1_7013: bitstring));
                                                    {7811}let m1_7014: bitstring = em1_7012 in
                                                    {7812}if (verify(h(m1_7014),sigM1_7013,pkCli_6957) <> true) then
                                                        0
                                                    else
                                                        {7813}let (=OpenSecureChannelRequest,=pkCli_6957,Nc_7015: bitstring) = m1_7014 in
                                                        {7814}new Ns_7016: bitstring;
                                                        {7815}new ST_7017: bitstring;
                                                        {7816}new TTL_7018: bitstring;
                                                        {7817}let m2_7019: bitstring = (OpenSecureChannelResponse,Ns_7016,ST_7017,TTL_7018) in
                                                        {7818}out(c, (m2_7019,sign(h(m2_7019),skSess_6879)));
                                                        {7819}let Ksrv_7020: bitstring = h((Ns_7016,Nc_7015)) in
                                                        {7820}out(c, senc(mSrv(pkCli_6957,pkSess_6880),Ksrv_7020))
                                        )
                                        else
                                            {7821}let pkDisco_7021: bitstring = fail-any in
                                            {7822}in(c, (=pkCli_6957,em1_7022: bitstring,sigM1_7023: bitstring));
                                            {7823}let m1_7024: bitstring = em1_7022 in
                                            {7824}if (verify(h(m1_7024),sigM1_7023,pkCli_6957) <> true) then
                                                0
                                            else
                                                {7825}let (=OpenSecureChannelRequest,=pkCli_6957,Nc_7025: bitstring) = m1_7024 in
                                                {7826}new Ns_7026: bitstring;
                                                {7827}new ST_7027: bitstring;
                                                {7828}new TTL_7028: bitstring;
                                                {7829}let m2_7029: bitstring = (OpenSecureChannelResponse,Ns_7026,ST_7027,TTL_7028) in
                                                {7830}out(c, (m2_7029,sign(h(m2_7029),skSess_6879)));
                                                {7831}let Ksrv_7030: bitstring = h((Ns_7026,Nc_7025)) in
                                                {7832}out(c, senc(mSrv(pkCli_6957,pkSess_6880),Ksrv_7030))
                                    )
                                    else
                                        {7833}let v_7031: bool = (Cli_5309 = C) in
                                        (
                                            {7834}if v_7031 then
                                            (
                                                {7835}let pkCli_7032: bitstring = pub(skC) in
                                                {7836}let v_7033: bool = (Disco_5310 = A) in
                                                (
                                                    {7837}if v_7033 then
                                                    (
                                                        {7838}let pkDisco_7034: bitstring = pub(skA) in
                                                        {7839}in(c, (=pkCli_7032,em1_7035: bitstring,sigM1_7036: bitstring));
                                                        {7840}let m1_7037: bitstring = em1_7035 in
                                                        {7841}if (verify(h(m1_7037),sigM1_7036,pkCli_7032) <> true) then
                                                            0
                                                        else
                                                            {7842}let (=OpenSecureChannelRequest,=pkCli_7032,Nc_7038: bitstring) = m1_7037 in
                                                            {7843}new Ns_7039: bitstring;
                                                            {7844}new ST_7040: bitstring;
                                                            {7845}new TTL_7041: bitstring;
                                                            {7846}let m2_7042: bitstring = (OpenSecureChannelResponse,Ns_7039,ST_7040,TTL_7041) in
                                                            {7847}out(c, (m2_7042,sign(h(m2_7042),skSess_6879)));
                                                            {7848}let Ksrv_7043: bitstring = h((Ns_7039,Nc_7038)) in
                                                            {7849}out(c, senc(mSrv(pkCli_7032,pkSess_6880),Ksrv_7043))
                                                    )
                                                    else
                                                        {7850}let v_7044: bool = (Disco_5310 = B) in
                                                        (
                                                            {7851}if v_7044 then
                                                            (
                                                                {7852}let pkDisco_7045: bitstring = pub(skB) in
                                                                {7853}in(c, (=pkCli_7032,em1_7046: bitstring,sigM1_7047: bitstring));
                                                                {7854}let m1_7048: bitstring = em1_7046 in
                                                                {7855}if (verify(h(m1_7048),sigM1_7047,pkCli_7032) <> true) then
                                                                    0
                                                                else
                                                                    {7856}let (=OpenSecureChannelRequest,=pkCli_7032,Nc_7049: bitstring) = m1_7048 in
                                                                    {7857}new Ns_7050: bitstring;
                                                                    {7858}new ST_7051: bitstring;
                                                                    {7859}new TTL_7052: bitstring;
                                                                    {7860}let m2_7053: bitstring = (OpenSecureChannelResponse,Ns_7050,ST_7051,TTL_7052) in
                                                                    {7861}out(c, (m2_7053,sign(h(m2_7053),skSess_6879)));
                                                                    {7862}let Ksrv_7054: bitstring = h((Ns_7050,Nc_7049)) in
                                                                    {7863}out(c, senc(mSrv(pkCli_7032,pkSess_6880),Ksrv_7054))
                                                            )
                                                            else
                                                                {7864}let v_7055: bool = (Disco_5310 = C) in
                                                                (
                                                                    {7865}if v_7055 then
                                                                    (
                                                                        {7866}let pkDisco_7056: bitstring = pub(skC) in
                                                                        {7867}in(c, (=pkCli_7032,em1_7057: bitstring,sigM1_7058: bitstring));
                                                                        {7868}let m1_7059: bitstring = em1_7057 in
                                                                        {7869}if (verify(h(m1_7059),sigM1_7058,pkCli_7032) <> true) then
                                                                            0
                                                                        else
                                                                            {7870}let (=OpenSecureChannelRequest,=pkCli_7032,Nc_7060: bitstring) = m1_7059 in
                                                                            {7871}new Ns_7061: bitstring;
                                                                            {7872}new ST_7062: bitstring;
                                                                            {7873}new TTL_7063: bitstring;
                                                                            {7874}let m2_7064: bitstring = (OpenSecureChannelResponse,Ns_7061,ST_7062,TTL_7063) in
                                                                            {7875}out(c, (m2_7064,sign(h(m2_7064),skSess_6879)));
                                                                            {7876}let Ksrv_7065: bitstring = h((Ns_7061,Nc_7060)) in
                                                                            {7877}out(c, senc(mSrv(pkCli_7032,pkSess_6880),Ksrv_7065))
                                                                    )
                                                                    else
                                                                        {7878}let pkDisco_7066: bitstring = pub(sk(Disco_5310)) in
                                                                        {7879}in(c, (=pkCli_7032,em1_7067: bitstring,sigM1_7068: bitstring));
                                                                        {7880}let m1_7069: bitstring = em1_7067 in
                                                                        {7881}if (verify(h(m1_7069),sigM1_7068,pkCli_7032) <> true) then
                                                                            0
                                                                        else
                                                                            {7882}let (=OpenSecureChannelRequest,=pkCli_7032,Nc_7070: bitstring) = m1_7069 in
                                                                            {7883}new Ns_7071: bitstring;
                                                                            {7884}new ST_7072: bitstring;
                                                                            {7885}new TTL_7073: bitstring;
                                                                            {7886}let m2_7074: bitstring = (OpenSecureChannelResponse,Ns_7071,ST_7072,TTL_7073) in
                                                                            {7887}out(c, (m2_7074,sign(h(m2_7074),skSess_6879)));
                                                                            {7888}let Ksrv_7075: bitstring = h((Ns_7071,Nc_7070)) in
                                                                            {7889}out(c, senc(mSrv(pkCli_7032,pkSess_6880),Ksrv_7075))
                                                                )
                                                                else
                                                                    {7890}let pkDisco_7076: bitstring = fail-any in
                                                                    {7891}in(c, (=pkCli_7032,em1_7077: bitstring,sigM1_7078: bitstring));
                                                                    {7892}let m1_7079: bitstring = em1_7077 in
                                                                    {7893}if (verify(h(m1_7079),sigM1_7078,pkCli_7032) <> true) then
                                                                        0
                                                                    else
                                                                        {7894}let (=OpenSecureChannelRequest,=pkCli_7032,Nc_7080: bitstring) = m1_7079 in
                                                                        {7895}new Ns_7081: bitstring;
                                                                        {7896}new ST_7082: bitstring;
                                                                        {7897}new TTL_7083: bitstring;
                                                                        {7898}let m2_7084: bitstring = (OpenSecureChannelResponse,Ns_7081,ST_7082,TTL_7083) in
                                                                        {7899}out(c, (m2_7084,sign(h(m2_7084),skSess_6879)));
                                                                        {7900}let Ksrv_7085: bitstring = h((Ns_7081,Nc_7080)) in
                                                                        {7901}out(c, senc(mSrv(pkCli_7032,pkSess_6880),Ksrv_7085))
                                                        )
                                                        else
                                                            {7902}let pkDisco_7086: bitstring = fail-any in
                                                            {7903}in(c, (=pkCli_7032,em1_7087: bitstring,sigM1_7088: bitstring));
                                                            {7904}let m1_7089: bitstring = em1_7087 in
                                                            {7905}if (verify(h(m1_7089),sigM1_7088,pkCli_7032) <> true) then
                                                                0
                                                            else
                                                                {7906}let (=OpenSecureChannelRequest,=pkCli_7032,Nc_7090: bitstring) = m1_7089 in
                                                                {7907}new Ns_7091: bitstring;
                                                                {7908}new ST_7092: bitstring;
                                                                {7909}new TTL_7093: bitstring;
                                                                {7910}let m2_7094: bitstring = (OpenSecureChannelResponse,Ns_7091,ST_7092,TTL_7093) in
                                                                {7911}out(c, (m2_7094,sign(h(m2_7094),skSess_6879)));
                                                                {7912}let Ksrv_7095: bitstring = h((Ns_7091,Nc_7090)) in
                                                                {7913}out(c, senc(mSrv(pkCli_7032,pkSess_6880),Ksrv_7095))
                                                )
                                                else
                                                    {7914}let pkDisco_7096: bitstring = fail-any in
                                                    {7915}in(c, (=pkCli_7032,em1_7097: bitstring,sigM1_7098: bitstring));
                                                    {7916}let m1_7099: bitstring = em1_7097 in
                                                    {7917}if (verify(h(m1_7099),sigM1_7098,pkCli_7032) <> true) then
                                                        0
                                                    else
                                                        {7918}let (=OpenSecureChannelRequest,=pkCli_7032,Nc_7100: bitstring) = m1_7099 in
                                                        {7919}new Ns_7101: bitstring;
                                                        {7920}new ST_7102: bitstring;
                                                        {7921}new TTL_7103: bitstring;
                                                        {7922}let m2_7104: bitstring = (OpenSecureChannelResponse,Ns_7101,ST_7102,TTL_7103) in
                                                        {7923}out(c, (m2_7104,sign(h(m2_7104),skSess_6879)));
                                                        {7924}let Ksrv_7105: bitstring = h((Ns_7101,Nc_7100)) in
                                                        {7925}out(c, senc(mSrv(pkCli_7032,pkSess_6880),Ksrv_7105))
                                            )
                                            else
                                                {7926}let pkCli_7106: bitstring = pub(sk(Cli_5309)) in
                                                {7927}let v_7107: bool = (Disco_5310 = A) in
                                                (
                                                    {7928}if v_7107 then
                                                    (
                                                        {7929}let pkDisco_7108: bitstring = pub(skA) in
                                                        {7930}in(c, (=pkCli_7106,em1_7109: bitstring,sigM1_7110: bitstring));
                                                        {7931}let m1_7111: bitstring = em1_7109 in
                                                        {7932}if (verify(h(m1_7111),sigM1_7110,pkCli_7106) <> true) then
                                                            0
                                                        else
                                                            {7933}let (=OpenSecureChannelRequest,=pkCli_7106,Nc_7112: bitstring) = m1_7111 in
                                                            {7934}new Ns_7113: bitstring;
                                                            {7935}new ST_7114: bitstring;
                                                            {7936}new TTL_7115: bitstring;
                                                            {7937}let m2_7116: bitstring = (OpenSecureChannelResponse,Ns_7113,ST_7114,TTL_7115) in
                                                            {7938}out(c, (m2_7116,sign(h(m2_7116),skSess_6879)));
                                                            {7939}let Ksrv_7117: bitstring = h((Ns_7113,Nc_7112)) in
                                                            {7940}out(c, senc(mSrv(pkCli_7106,pkSess_6880),Ksrv_7117))
                                                    )
                                                    else
                                                        {7941}let v_7118: bool = (Disco_5310 = B) in
                                                        (
                                                            {7942}if v_7118 then
                                                            (
                                                                {7943}let pkDisco_7119: bitstring = pub(skB) in
                                                                {7944}in(c, (=pkCli_7106,em1_7120: bitstring,sigM1_7121: bitstring));
                                                                {7945}let m1_7122: bitstring = em1_7120 in
                                                                {7946}if (verify(h(m1_7122),sigM1_7121,pkCli_7106) <> true) then
                                                                    0
                                                                else
                                                                    {7947}let (=OpenSecureChannelRequest,=pkCli_7106,Nc_7123: bitstring) = m1_7122 in
                                                                    {7948}new Ns_7124: bitstring;
                                                                    {7949}new ST_7125: bitstring;
                                                                    {7950}new TTL_7126: bitstring;
                                                                    {7951}let m2_7127: bitstring = (OpenSecureChannelResponse,Ns_7124,ST_7125,TTL_7126) in
                                                                    {7952}out(c, (m2_7127,sign(h(m2_7127),skSess_6879)));
                                                                    {7953}let Ksrv_7128: bitstring = h((Ns_7124,Nc_7123)) in
                                                                    {7954}out(c, senc(mSrv(pkCli_7106,pkSess_6880),Ksrv_7128))
                                                            )
                                                            else
                                                                {7955}let v_7129: bool = (Disco_5310 = C) in
                                                                (
                                                                    {7956}if v_7129 then
                                                                    (
                                                                        {7957}let pkDisco_7130: bitstring = pub(skC) in
                                                                        {7958}in(c, (=pkCli_7106,em1_7131: bitstring,sigM1_7132: bitstring));
                                                                        {7959}let m1_7133: bitstring = em1_7131 in
                                                                        {7960}if (verify(h(m1_7133),sigM1_7132,pkCli_7106) <> true) then
                                                                            0
                                                                        else
                                                                            {7961}let (=OpenSecureChannelRequest,=pkCli_7106,Nc_7134: bitstring) = m1_7133 in
                                                                            {7962}new Ns_7135: bitstring;
                                                                            {7963}new ST_7136: bitstring;
                                                                            {7964}new TTL_7137: bitstring;
                                                                            {7965}let m2_7138: bitstring = (OpenSecureChannelResponse,Ns_7135,ST_7136,TTL_7137) in
                                                                            {7966}out(c, (m2_7138,sign(h(m2_7138),skSess_6879)));
                                                                            {7967}let Ksrv_7139: bitstring = h((Ns_7135,Nc_7134)) in
                                                                            {7968}out(c, senc(mSrv(pkCli_7106,pkSess_6880),Ksrv_7139))
                                                                    )
                                                                    else
                                                                        {7969}let pkDisco_7140: bitstring = pub(sk(Disco_5310)) in
                                                                        {7970}in(c, (=pkCli_7106,em1_7141: bitstring,sigM1_7142: bitstring));
                                                                        {7971}let m1_7143: bitstring = em1_7141 in
                                                                        {7972}if (verify(h(m1_7143),sigM1_7142,pkCli_7106) <> true) then
                                                                            0
                                                                        else
                                                                            {7973}let (=OpenSecureChannelRequest,=pkCli_7106,Nc_7144: bitstring) = m1_7143 in
                                                                            {7974}new Ns_7145: bitstring;
                                                                            {7975}new ST_7146: bitstring;
                                                                            {7976}new TTL_7147: bitstring;
                                                                            {7977}let m2_7148: bitstring = (OpenSecureChannelResponse,Ns_7145,ST_7146,TTL_7147) in
                                                                            {7978}out(c, (m2_7148,sign(h(m2_7148),skSess_6879)));
                                                                            {7979}let Ksrv_7149: bitstring = h((Ns_7145,Nc_7144)) in
                                                                            {7980}out(c, senc(mSrv(pkCli_7106,pkSess_6880),Ksrv_7149))
                                                                )
                                                                else
                                                                    {7981}let pkDisco_7150: bitstring = fail-any in
                                                                    {7982}in(c, (=pkCli_7106,em1_7151: bitstring,sigM1_7152: bitstring));
                                                                    {7983}let m1_7153: bitstring = em1_7151 in
                                                                    {7984}if (verify(h(m1_7153),sigM1_7152,pkCli_7106) <> true) then
                                                                        0
                                                                    else
                                                                        {7985}let (=OpenSecureChannelRequest,=pkCli_7106,Nc_7154: bitstring) = m1_7153 in
                                                                        {7986}new Ns_7155: bitstring;
                                                                        {7987}new ST_7156: bitstring;
                                                                        {7988}new TTL_7157: bitstring;
                                                                        {7989}let m2_7158: bitstring = (OpenSecureChannelResponse,Ns_7155,ST_7156,TTL_7157) in
                                                                        {7990}out(c, (m2_7158,sign(h(m2_7158),skSess_6879)));
                                                                        {7991}let Ksrv_7159: bitstring = h((Ns_7155,Nc_7154)) in
                                                                        {7992}out(c, senc(mSrv(pkCli_7106,pkSess_6880),Ksrv_7159))
                                                        )
                                                        else
                                                            {7993}let pkDisco_7160: bitstring = fail-any in
                                                            {7994}in(c, (=pkCli_7106,em1_7161: bitstring,sigM1_7162: bitstring));
                                                            {7995}let m1_7163: bitstring = em1_7161 in
                                                            {7996}if (verify(h(m1_7163),sigM1_7162,pkCli_7106) <> true) then
                                                                0
                                                            else
                                                                {7997}let (=OpenSecureChannelRequest,=pkCli_7106,Nc_7164: bitstring) = m1_7163 in
                                                                {7998}new Ns_7165: bitstring;
                                                                {7999}new ST_7166: bitstring;
                                                                {8000}new TTL_7167: bitstring;
                                                                {8001}let m2_7168: bitstring = (OpenSecureChannelResponse,Ns_7165,ST_7166,TTL_7167) in
                                                                {8002}out(c, (m2_7168,sign(h(m2_7168),skSess_6879)));
                                                                {8003}let Ksrv_7169: bitstring = h((Ns_7165,Nc_7164)) in
                                                                {8004}out(c, senc(mSrv(pkCli_7106,pkSess_6880),Ksrv_7169))
                                                )
                                                else
                                                    {8005}let pkDisco_7170: bitstring = fail-any in
                                                    {8006}in(c, (=pkCli_7106,em1_7171: bitstring,sigM1_7172: bitstring));
                                                    {8007}let m1_7173: bitstring = em1_7171 in
                                                    {8008}if (verify(h(m1_7173),sigM1_7172,pkCli_7106) <> true) then
                                                        0
                                                    else
                                                        {8009}let (=OpenSecureChannelRequest,=pkCli_7106,Nc_7174: bitstring) = m1_7173 in
                                                        {8010}new Ns_7175: bitstring;
                                                        {8011}new ST_7176: bitstring;
                                                        {8012}new TTL_7177: bitstring;
                                                        {8013}let m2_7178: bitstring = (OpenSecureChannelResponse,Ns_7175,ST_7176,TTL_7177) in
                                                        {8014}out(c, (m2_7178,sign(h(m2_7178),skSess_6879)));
                                                        {8015}let Ksrv_7179: bitstring = h((Ns_7175,Nc_7174)) in
                                                        {8016}out(c, senc(mSrv(pkCli_7106,pkSess_6880),Ksrv_7179))
                                        )
                                        else
                                            {8017}let pkCli_7180: bitstring = fail-any in
                                            {8018}let v_7181: bool = (Disco_5310 = A) in
                                            (
                                                {8019}if v_7181 then
                                                (
                                                    {8020}let pkDisco_7182: bitstring = pub(skA) in
                                                    {8021}in(c, (=pkCli_7180,em1_7183: bitstring,sigM1_7184: bitstring));
                                                    {8022}let m1_7185: bitstring = em1_7183 in
                                                    {8023}if (verify(h(m1_7185),sigM1_7184,pkCli_7180) <> true) then
                                                        0
                                                    else
                                                        {8024}let (=OpenSecureChannelRequest,=pkCli_7180,Nc_7186: bitstring) = m1_7185 in
                                                        {8025}new Ns_7187: bitstring;
                                                        {8026}new ST_7188: bitstring;
                                                        {8027}new TTL_7189: bitstring;
                                                        {8028}let m2_7190: bitstring = (OpenSecureChannelResponse,Ns_7187,ST_7188,TTL_7189) in
                                                        {8029}out(c, (m2_7190,sign(h(m2_7190),skSess_6879)));
                                                        {8030}let Ksrv_7191: bitstring = h((Ns_7187,Nc_7186)) in
                                                        {8031}out(c, senc(mSrv(pkCli_7180,pkSess_6880),Ksrv_7191))
                                                )
                                                else
                                                    {8032}let v_7192: bool = (Disco_5310 = B) in
                                                    (
                                                        {8033}if v_7192 then
                                                        (
                                                            {8034}let pkDisco_7193: bitstring = pub(skB) in
                                                            {8035}in(c, (=pkCli_7180,em1_7194: bitstring,sigM1_7195: bitstring));
                                                            {8036}let m1_7196: bitstring = em1_7194 in
                                                            {8037}if (verify(h(m1_7196),sigM1_7195,pkCli_7180) <> true) then
                                                                0
                                                            else
                                                                {8038}let (=OpenSecureChannelRequest,=pkCli_7180,Nc_7197: bitstring) = m1_7196 in
                                                                {8039}new Ns_7198: bitstring;
                                                                {8040}new ST_7199: bitstring;
                                                                {8041}new TTL_7200: bitstring;
                                                                {8042}let m2_7201: bitstring = (OpenSecureChannelResponse,Ns_7198,ST_7199,TTL_7200) in
                                                                {8043}out(c, (m2_7201,sign(h(m2_7201),skSess_6879)));
                                                                {8044}let Ksrv_7202: bitstring = h((Ns_7198,Nc_7197)) in
                                                                {8045}out(c, senc(mSrv(pkCli_7180,pkSess_6880),Ksrv_7202))
                                                        )
                                                        else
                                                            {8046}let v_7203: bool = (Disco_5310 = C) in
                                                            (
                                                                {8047}if v_7203 then
                                                                (
                                                                    {8048}let pkDisco_7204: bitstring = pub(skC) in
                                                                    {8049}in(c, (=pkCli_7180,em1_7205: bitstring,sigM1_7206: bitstring));
                                                                    {8050}let m1_7207: bitstring = em1_7205 in
                                                                    {8051}if (verify(h(m1_7207),sigM1_7206,pkCli_7180) <> true) then
                                                                        0
                                                                    else
                                                                        {8052}let (=OpenSecureChannelRequest,=pkCli_7180,Nc_7208: bitstring) = m1_7207 in
                                                                        {8053}new Ns_7209: bitstring;
                                                                        {8054}new ST_7210: bitstring;
                                                                        {8055}new TTL_7211: bitstring;
                                                                        {8056}let m2_7212: bitstring = (OpenSecureChannelResponse,Ns_7209,ST_7210,TTL_7211) in
                                                                        {8057}out(c, (m2_7212,sign(h(m2_7212),skSess_6879)));
                                                                        {8058}let Ksrv_7213: bitstring = h((Ns_7209,Nc_7208)) in
                                                                        {8059}out(c, senc(mSrv(pkCli_7180,pkSess_6880),Ksrv_7213))
                                                                )
                                                                else
                                                                    {8060}let pkDisco_7214: bitstring = pub(sk(Disco_5310)) in
                                                                    {8061}in(c, (=pkCli_7180,em1_7215: bitstring,sigM1_7216: bitstring));
                                                                    {8062}let m1_7217: bitstring = em1_7215 in
                                                                    {8063}if (verify(h(m1_7217),sigM1_7216,pkCli_7180) <> true) then
                                                                        0
                                                                    else
                                                                        {8064}let (=OpenSecureChannelRequest,=pkCli_7180,Nc_7218: bitstring) = m1_7217 in
                                                                        {8065}new Ns_7219: bitstring;
                                                                        {8066}new ST_7220: bitstring;
                                                                        {8067}new TTL_7221: bitstring;
                                                                        {8068}let m2_7222: bitstring = (OpenSecureChannelResponse,Ns_7219,ST_7220,TTL_7221) in
                                                                        {8069}out(c, (m2_7222,sign(h(m2_7222),skSess_6879)));
                                                                        {8070}let Ksrv_7223: bitstring = h((Ns_7219,Nc_7218)) in
                                                                        {8071}out(c, senc(mSrv(pkCli_7180,pkSess_6880),Ksrv_7223))
                                                            )
                                                            else
                                                                {8072}let pkDisco_7224: bitstring = fail-any in
                                                                {8073}in(c, (=pkCli_7180,em1_7225: bitstring,sigM1_7226: bitstring));
                                                                {8074}let m1_7227: bitstring = em1_7225 in
                                                                {8075}if (verify(h(m1_7227),sigM1_7226,pkCli_7180) <> true) then
                                                                    0
                                                                else
                                                                    {8076}let (=OpenSecureChannelRequest,=pkCli_7180,Nc_7228: bitstring) = m1_7227 in
                                                                    {8077}new Ns_7229: bitstring;
                                                                    {8078}new ST_7230: bitstring;
                                                                    {8079}new TTL_7231: bitstring;
                                                                    {8080}let m2_7232: bitstring = (OpenSecureChannelResponse,Ns_7229,ST_7230,TTL_7231) in
                                                                    {8081}out(c, (m2_7232,sign(h(m2_7232),skSess_6879)));
                                                                    {8082}let Ksrv_7233: bitstring = h((Ns_7229,Nc_7228)) in
                                                                    {8083}out(c, senc(mSrv(pkCli_7180,pkSess_6880),Ksrv_7233))
                                                    )
                                                    else
                                                        {8084}let pkDisco_7234: bitstring = fail-any in
                                                        {8085}in(c, (=pkCli_7180,em1_7235: bitstring,sigM1_7236: bitstring));
                                                        {8086}let m1_7237: bitstring = em1_7235 in
                                                        {8087}if (verify(h(m1_7237),sigM1_7236,pkCli_7180) <> true) then
                                                            0
                                                        else
                                                            {8088}let (=OpenSecureChannelRequest,=pkCli_7180,Nc_7238: bitstring) = m1_7237 in
                                                            {8089}new Ns_7239: bitstring;
                                                            {8090}new ST_7240: bitstring;
                                                            {8091}new TTL_7241: bitstring;
                                                            {8092}let m2_7242: bitstring = (OpenSecureChannelResponse,Ns_7239,ST_7240,TTL_7241) in
                                                            {8093}out(c, (m2_7242,sign(h(m2_7242),skSess_6879)));
                                                            {8094}let Ksrv_7243: bitstring = h((Ns_7239,Nc_7238)) in
                                                            {8095}out(c, senc(mSrv(pkCli_7180,pkSess_6880),Ksrv_7243))
                                            )
                                            else
                                                {8096}let pkDisco_7244: bitstring = fail-any in
                                                {8097}in(c, (=pkCli_7180,em1_7245: bitstring,sigM1_7246: bitstring));
                                                {8098}let m1_7247: bitstring = em1_7245 in
                                                {8099}if (verify(h(m1_7247),sigM1_7246,pkCli_7180) <> true) then
                                                    0
                                                else
                                                    {8100}let (=OpenSecureChannelRequest,=pkCli_7180,Nc_7248: bitstring) = m1_7247 in
                                                    {8101}new Ns_7249: bitstring;
                                                    {8102}new ST_7250: bitstring;
                                                    {8103}new TTL_7251: bitstring;
                                                    {8104}let m2_7252: bitstring = (OpenSecureChannelResponse,Ns_7249,ST_7250,TTL_7251) in
                                                    {8105}out(c, (m2_7252,sign(h(m2_7252),skSess_6879)));
                                                    {8106}let Ksrv_7253: bitstring = h((Ns_7249,Nc_7248)) in
                                                    {8107}out(c, senc(mSrv(pkCli_7180,pkSess_6880),Ksrv_7253))
                                )
                                else
                                    {8108}let pkCli_7254: bitstring = fail-any in
                                    {8109}let v_7255: bool = (Disco_5310 = A) in
                                    (
                                        {8110}if v_7255 then
                                        (
                                            {8111}let pkDisco_7256: bitstring = pub(skA) in
                                            {8112}in(c, (=pkCli_7254,em1_7257: bitstring,sigM1_7258: bitstring));
                                            {8113}let m1_7259: bitstring = em1_7257 in
                                            {8114}if (verify(h(m1_7259),sigM1_7258,pkCli_7254) <> true) then
                                                0
                                            else
                                                {8115}let (=OpenSecureChannelRequest,=pkCli_7254,Nc_7260: bitstring) = m1_7259 in
                                                {8116}new Ns_7261: bitstring;
                                                {8117}new ST_7262: bitstring;
                                                {8118}new TTL_7263: bitstring;
                                                {8119}let m2_7264: bitstring = (OpenSecureChannelResponse,Ns_7261,ST_7262,TTL_7263) in
                                                {8120}out(c, (m2_7264,sign(h(m2_7264),skSess_6879)));
                                                {8121}let Ksrv_7265: bitstring = h((Ns_7261,Nc_7260)) in
                                                {8122}out(c, senc(mSrv(pkCli_7254,pkSess_6880),Ksrv_7265))
                                        )
                                        else
                                            {8123}let v_7266: bool = (Disco_5310 = B) in
                                            (
                                                {8124}if v_7266 then
                                                (
                                                    {8125}let pkDisco_7267: bitstring = pub(skB) in
                                                    {8126}in(c, (=pkCli_7254,em1_7268: bitstring,sigM1_7269: bitstring));
                                                    {8127}let m1_7270: bitstring = em1_7268 in
                                                    {8128}if (verify(h(m1_7270),sigM1_7269,pkCli_7254) <> true) then
                                                        0
                                                    else
                                                        {8129}let (=OpenSecureChannelRequest,=pkCli_7254,Nc_7271: bitstring) = m1_7270 in
                                                        {8130}new Ns_7272: bitstring;
                                                        {8131}new ST_7273: bitstring;
                                                        {8132}new TTL_7274: bitstring;
                                                        {8133}let m2_7275: bitstring = (OpenSecureChannelResponse,Ns_7272,ST_7273,TTL_7274) in
                                                        {8134}out(c, (m2_7275,sign(h(m2_7275),skSess_6879)));
                                                        {8135}let Ksrv_7276: bitstring = h((Ns_7272,Nc_7271)) in
                                                        {8136}out(c, senc(mSrv(pkCli_7254,pkSess_6880),Ksrv_7276))
                                                )
                                                else
                                                    {8137}let v_7277: bool = (Disco_5310 = C) in
                                                    (
                                                        {8138}if v_7277 then
                                                        (
                                                            {8139}let pkDisco_7278: bitstring = pub(skC) in
                                                            {8140}in(c, (=pkCli_7254,em1_7279: bitstring,sigM1_7280: bitstring));
                                                            {8141}let m1_7281: bitstring = em1_7279 in
                                                            {8142}if (verify(h(m1_7281),sigM1_7280,pkCli_7254) <> true) then
                                                                0
                                                            else
                                                                {8143}let (=OpenSecureChannelRequest,=pkCli_7254,Nc_7282: bitstring) = m1_7281 in
                                                                {8144}new Ns_7283: bitstring;
                                                                {8145}new ST_7284: bitstring;
                                                                {8146}new TTL_7285: bitstring;
                                                                {8147}let m2_7286: bitstring = (OpenSecureChannelResponse,Ns_7283,ST_7284,TTL_7285) in
                                                                {8148}out(c, (m2_7286,sign(h(m2_7286),skSess_6879)));
                                                                {8149}let Ksrv_7287: bitstring = h((Ns_7283,Nc_7282)) in
                                                                {8150}out(c, senc(mSrv(pkCli_7254,pkSess_6880),Ksrv_7287))
                                                        )
                                                        else
                                                            {8151}let pkDisco_7288: bitstring = pub(sk(Disco_5310)) in
                                                            {8152}in(c, (=pkCli_7254,em1_7289: bitstring,sigM1_7290: bitstring));
                                                            {8153}let m1_7291: bitstring = em1_7289 in
                                                            {8154}if (verify(h(m1_7291),sigM1_7290,pkCli_7254) <> true) then
                                                                0
                                                            else
                                                                {8155}let (=OpenSecureChannelRequest,=pkCli_7254,Nc_7292: bitstring) = m1_7291 in
                                                                {8156}new Ns_7293: bitstring;
                                                                {8157}new ST_7294: bitstring;
                                                                {8158}new TTL_7295: bitstring;
                                                                {8159}let m2_7296: bitstring = (OpenSecureChannelResponse,Ns_7293,ST_7294,TTL_7295) in
                                                                {8160}out(c, (m2_7296,sign(h(m2_7296),skSess_6879)));
                                                                {8161}let Ksrv_7297: bitstring = h((Ns_7293,Nc_7292)) in
                                                                {8162}out(c, senc(mSrv(pkCli_7254,pkSess_6880),Ksrv_7297))
                                                    )
                                                    else
                                                        {8163}let pkDisco_7298: bitstring = fail-any in
                                                        {8164}in(c, (=pkCli_7254,em1_7299: bitstring,sigM1_7300: bitstring));
                                                        {8165}let m1_7301: bitstring = em1_7299 in
                                                        {8166}if (verify(h(m1_7301),sigM1_7300,pkCli_7254) <> true) then
                                                            0
                                                        else
                                                            {8167}let (=OpenSecureChannelRequest,=pkCli_7254,Nc_7302: bitstring) = m1_7301 in
                                                            {8168}new Ns_7303: bitstring;
                                                            {8169}new ST_7304: bitstring;
                                                            {8170}new TTL_7305: bitstring;
                                                            {8171}let m2_7306: bitstring = (OpenSecureChannelResponse,Ns_7303,ST_7304,TTL_7305) in
                                                            {8172}out(c, (m2_7306,sign(h(m2_7306),skSess_6879)));
                                                            {8173}let Ksrv_7307: bitstring = h((Ns_7303,Nc_7302)) in
                                                            {8174}out(c, senc(mSrv(pkCli_7254,pkSess_6880),Ksrv_7307))
                                            )
                                            else
                                                {8175}let pkDisco_7308: bitstring = fail-any in
                                                {8176}in(c, (=pkCli_7254,em1_7309: bitstring,sigM1_7310: bitstring));
                                                {8177}let m1_7311: bitstring = em1_7309 in
                                                {8178}if (verify(h(m1_7311),sigM1_7310,pkCli_7254) <> true) then
                                                    0
                                                else
                                                    {8179}let (=OpenSecureChannelRequest,=pkCli_7254,Nc_7312: bitstring) = m1_7311 in
                                                    {8180}new Ns_7313: bitstring;
                                                    {8181}new ST_7314: bitstring;
                                                    {8182}new TTL_7315: bitstring;
                                                    {8183}let m2_7316: bitstring = (OpenSecureChannelResponse,Ns_7313,ST_7314,TTL_7315) in
                                                    {8184}out(c, (m2_7316,sign(h(m2_7316),skSess_6879)));
                                                    {8185}let Ksrv_7317: bitstring = h((Ns_7313,Nc_7312)) in
                                                    {8186}out(c, senc(mSrv(pkCli_7254,pkSess_6880),Ksrv_7317))
                                    )
                                    else
                                        {8187}let pkDisco_7318: bitstring = fail-any in
                                        {8188}in(c, (=pkCli_7254,em1_7319: bitstring,sigM1_7320: bitstring));
                                        {8189}let m1_7321: bitstring = em1_7319 in
                                        {8190}if (verify(h(m1_7321),sigM1_7320,pkCli_7254) <> true) then
                                            0
                                        else
                                            {8191}let (=OpenSecureChannelRequest,=pkCli_7254,Nc_7322: bitstring) = m1_7321 in
                                            {8192}new Ns_7323: bitstring;
                                            {8193}new ST_7324: bitstring;
                                            {8194}new TTL_7325: bitstring;
                                            {8195}let m2_7326: bitstring = (OpenSecureChannelResponse,Ns_7323,ST_7324,TTL_7325) in
                                            {8196}out(c, (m2_7326,sign(h(m2_7326),skSess_6879)));
                                            {8197}let Ksrv_7327: bitstring = h((Ns_7323,Nc_7322)) in
                                            {8198}out(c, senc(mSrv(pkCli_7254,pkSess_6880),Ksrv_7327))
                        )
                        else
                            {8199}let pkCli_7328: bitstring = fail-any in
                            {8200}let v_7329: bool = (Disco_5310 = A) in
                            (
                                {8201}if v_7329 then
                                (
                                    {8202}let pkDisco_7330: bitstring = pub(skA) in
                                    {8203}in(c, (=pkCli_7328,em1_7331: bitstring,sigM1_7332: bitstring));
                                    {8204}let m1_7333: bitstring = em1_7331 in
                                    {8205}if (verify(h(m1_7333),sigM1_7332,pkCli_7328) <> true) then
                                        0
                                    else
                                        {8206}let (=OpenSecureChannelRequest,=pkCli_7328,Nc_7334: bitstring) = m1_7333 in
                                        {8207}new Ns_7335: bitstring;
                                        {8208}new ST_7336: bitstring;
                                        {8209}new TTL_7337: bitstring;
                                        {8210}let m2_7338: bitstring = (OpenSecureChannelResponse,Ns_7335,ST_7336,TTL_7337) in
                                        {8211}out(c, (m2_7338,sign(h(m2_7338),skSess_6879)));
                                        {8212}let Ksrv_7339: bitstring = h((Ns_7335,Nc_7334)) in
                                        {8213}out(c, senc(mSrv(pkCli_7328,pkSess_6880),Ksrv_7339))
                                )
                                else
                                    {8214}let v_7340: bool = (Disco_5310 = B) in
                                    (
                                        {8215}if v_7340 then
                                        (
                                            {8216}let pkDisco_7341: bitstring = pub(skB) in
                                            {8217}in(c, (=pkCli_7328,em1_7342: bitstring,sigM1_7343: bitstring));
                                            {8218}let m1_7344: bitstring = em1_7342 in
                                            {8219}if (verify(h(m1_7344),sigM1_7343,pkCli_7328) <> true) then
                                                0
                                            else
                                                {8220}let (=OpenSecureChannelRequest,=pkCli_7328,Nc_7345: bitstring) = m1_7344 in
                                                {8221}new Ns_7346: bitstring;
                                                {8222}new ST_7347: bitstring;
                                                {8223}new TTL_7348: bitstring;
                                                {8224}let m2_7349: bitstring = (OpenSecureChannelResponse,Ns_7346,ST_7347,TTL_7348) in
                                                {8225}out(c, (m2_7349,sign(h(m2_7349),skSess_6879)));
                                                {8226}let Ksrv_7350: bitstring = h((Ns_7346,Nc_7345)) in
                                                {8227}out(c, senc(mSrv(pkCli_7328,pkSess_6880),Ksrv_7350))
                                        )
                                        else
                                            {8228}let v_7351: bool = (Disco_5310 = C) in
                                            (
                                                {8229}if v_7351 then
                                                (
                                                    {8230}let pkDisco_7352: bitstring = pub(skC) in
                                                    {8231}in(c, (=pkCli_7328,em1_7353: bitstring,sigM1_7354: bitstring));
                                                    {8232}let m1_7355: bitstring = em1_7353 in
                                                    {8233}if (verify(h(m1_7355),sigM1_7354,pkCli_7328) <> true) then
                                                        0
                                                    else
                                                        {8234}let (=OpenSecureChannelRequest,=pkCli_7328,Nc_7356: bitstring) = m1_7355 in
                                                        {8235}new Ns_7357: bitstring;
                                                        {8236}new ST_7358: bitstring;
                                                        {8237}new TTL_7359: bitstring;
                                                        {8238}let m2_7360: bitstring = (OpenSecureChannelResponse,Ns_7357,ST_7358,TTL_7359) in
                                                        {8239}out(c, (m2_7360,sign(h(m2_7360),skSess_6879)));
                                                        {8240}let Ksrv_7361: bitstring = h((Ns_7357,Nc_7356)) in
                                                        {8241}out(c, senc(mSrv(pkCli_7328,pkSess_6880),Ksrv_7361))
                                                )
                                                else
                                                    {8242}let pkDisco_7362: bitstring = pub(sk(Disco_5310)) in
                                                    {8243}in(c, (=pkCli_7328,em1_7363: bitstring,sigM1_7364: bitstring));
                                                    {8244}let m1_7365: bitstring = em1_7363 in
                                                    {8245}if (verify(h(m1_7365),sigM1_7364,pkCli_7328) <> true) then
                                                        0
                                                    else
                                                        {8246}let (=OpenSecureChannelRequest,=pkCli_7328,Nc_7366: bitstring) = m1_7365 in
                                                        {8247}new Ns_7367: bitstring;
                                                        {8248}new ST_7368: bitstring;
                                                        {8249}new TTL_7369: bitstring;
                                                        {8250}let m2_7370: bitstring = (OpenSecureChannelResponse,Ns_7367,ST_7368,TTL_7369) in
                                                        {8251}out(c, (m2_7370,sign(h(m2_7370),skSess_6879)));
                                                        {8252}let Ksrv_7371: bitstring = h((Ns_7367,Nc_7366)) in
                                                        {8253}out(c, senc(mSrv(pkCli_7328,pkSess_6880),Ksrv_7371))
                                            )
                                            else
                                                {8254}let pkDisco_7372: bitstring = fail-any in
                                                {8255}in(c, (=pkCli_7328,em1_7373: bitstring,sigM1_7374: bitstring));
                                                {8256}let m1_7375: bitstring = em1_7373 in
                                                {8257}if (verify(h(m1_7375),sigM1_7374,pkCli_7328) <> true) then
                                                    0
                                                else
                                                    {8258}let (=OpenSecureChannelRequest,=pkCli_7328,Nc_7376: bitstring) = m1_7375 in
                                                    {8259}new Ns_7377: bitstring;
                                                    {8260}new ST_7378: bitstring;
                                                    {8261}new TTL_7379: bitstring;
                                                    {8262}let m2_7380: bitstring = (OpenSecureChannelResponse,Ns_7377,ST_7378,TTL_7379) in
                                                    {8263}out(c, (m2_7380,sign(h(m2_7380),skSess_6879)));
                                                    {8264}let Ksrv_7381: bitstring = h((Ns_7377,Nc_7376)) in
                                                    {8265}out(c, senc(mSrv(pkCli_7328,pkSess_6880),Ksrv_7381))
                                    )
                                    else
                                        {8266}let pkDisco_7382: bitstring = fail-any in
                                        {8267}in(c, (=pkCli_7328,em1_7383: bitstring,sigM1_7384: bitstring));
                                        {8268}let m1_7385: bitstring = em1_7383 in
                                        {8269}if (verify(h(m1_7385),sigM1_7384,pkCli_7328) <> true) then
                                            0
                                        else
                                            {8270}let (=OpenSecureChannelRequest,=pkCli_7328,Nc_7386: bitstring) = m1_7385 in
                                            {8271}new Ns_7387: bitstring;
                                            {8272}new ST_7388: bitstring;
                                            {8273}new TTL_7389: bitstring;
                                            {8274}let m2_7390: bitstring = (OpenSecureChannelResponse,Ns_7387,ST_7388,TTL_7389) in
                                            {8275}out(c, (m2_7390,sign(h(m2_7390),skSess_6879)));
                                            {8276}let Ksrv_7391: bitstring = h((Ns_7387,Nc_7386)) in
                                            {8277}out(c, senc(mSrv(pkCli_7328,pkSess_6880),Ksrv_7391))
                            )
                            else
                                {8278}let pkDisco_7392: bitstring = fail-any in
                                {8279}in(c, (=pkCli_7328,em1_7393: bitstring,sigM1_7394: bitstring));
                                {8280}let m1_7395: bitstring = em1_7393 in
                                {8281}if (verify(h(m1_7395),sigM1_7394,pkCli_7328) <> true) then
                                    0
                                else
                                    {8282}let (=OpenSecureChannelRequest,=pkCli_7328,Nc_7396: bitstring) = m1_7395 in
                                    {8283}new Ns_7397: bitstring;
                                    {8284}new ST_7398: bitstring;
                                    {8285}new TTL_7399: bitstring;
                                    {8286}let m2_7400: bitstring = (OpenSecureChannelResponse,Ns_7397,ST_7398,TTL_7399) in
                                    {8287}out(c, (m2_7400,sign(h(m2_7400),skSess_6879)));
                                    {8288}let Ksrv_7401: bitstring = h((Ns_7397,Nc_7396)) in
                                    {8289}out(c, senc(mSrv(pkCli_7328,pkSess_6880),Ksrv_7401))
            )
            else
                {8290}let skSess_7402: bitstring = fail-any in
                {8291}let pkSess_7403: bitstring = pub(skSess_7402) in
                {8292}let v_7404: bool = (Cli_5309 = A) in
                (
                    {8293}if v_7404 then
                    (
                        {8294}let pkCli_7405: bitstring = pub(skA) in
                        {8295}let v_7406: bool = (Disco_5310 = A) in
                        (
                            {8296}if v_7406 then
                            (
                                {8297}let pkDisco_7407: bitstring = pub(skA) in
                                {8298}in(c, (=pkCli_7405,em1_7408: bitstring,sigM1_7409: bitstring));
                                {8299}let m1_7410: bitstring = em1_7408 in
                                {8300}if (verify(h(m1_7410),sigM1_7409,pkCli_7405) <> true) then
                                    0
                                else
                                    {8301}let (=OpenSecureChannelRequest,=pkCli_7405,Nc_7411: bitstring) = m1_7410 in
                                    {8302}new Ns_7412: bitstring;
                                    {8303}new ST_7413: bitstring;
                                    {8304}new TTL_7414: bitstring;
                                    {8305}let m2_7415: bitstring = (OpenSecureChannelResponse,Ns_7412,ST_7413,TTL_7414) in
                                    {8306}out(c, (m2_7415,sign(h(m2_7415),skSess_7402)));
                                    {8307}let Ksrv_7416: bitstring = h((Ns_7412,Nc_7411)) in
                                    {8308}out(c, senc(mSrv(pkCli_7405,pkSess_7403),Ksrv_7416))
                            )
                            else
                                {8309}let v_7417: bool = (Disco_5310 = B) in
                                (
                                    {8310}if v_7417 then
                                    (
                                        {8311}let pkDisco_7418: bitstring = pub(skB) in
                                        {8312}in(c, (=pkCli_7405,em1_7419: bitstring,sigM1_7420: bitstring));
                                        {8313}let m1_7421: bitstring = em1_7419 in
                                        {8314}if (verify(h(m1_7421),sigM1_7420,pkCli_7405) <> true) then
                                            0
                                        else
                                            {8315}let (=OpenSecureChannelRequest,=pkCli_7405,Nc_7422: bitstring) = m1_7421 in
                                            {8316}new Ns_7423: bitstring;
                                            {8317}new ST_7424: bitstring;
                                            {8318}new TTL_7425: bitstring;
                                            {8319}let m2_7426: bitstring = (OpenSecureChannelResponse,Ns_7423,ST_7424,TTL_7425) in
                                            {8320}out(c, (m2_7426,sign(h(m2_7426),skSess_7402)));
                                            {8321}let Ksrv_7427: bitstring = h((Ns_7423,Nc_7422)) in
                                            {8322}out(c, senc(mSrv(pkCli_7405,pkSess_7403),Ksrv_7427))
                                    )
                                    else
                                        {8323}let v_7428: bool = (Disco_5310 = C) in
                                        (
                                            {8324}if v_7428 then
                                            (
                                                {8325}let pkDisco_7429: bitstring = pub(skC) in
                                                {8326}in(c, (=pkCli_7405,em1_7430: bitstring,sigM1_7431: bitstring));
                                                {8327}let m1_7432: bitstring = em1_7430 in
                                                {8328}if (verify(h(m1_7432),sigM1_7431,pkCli_7405) <> true) then
                                                    0
                                                else
                                                    {8329}let (=OpenSecureChannelRequest,=pkCli_7405,Nc_7433: bitstring) = m1_7432 in
                                                    {8330}new Ns_7434: bitstring;
                                                    {8331}new ST_7435: bitstring;
                                                    {8332}new TTL_7436: bitstring;
                                                    {8333}let m2_7437: bitstring = (OpenSecureChannelResponse,Ns_7434,ST_7435,TTL_7436) in
                                                    {8334}out(c, (m2_7437,sign(h(m2_7437),skSess_7402)));
                                                    {8335}let Ksrv_7438: bitstring = h((Ns_7434,Nc_7433)) in
                                                    {8336}out(c, senc(mSrv(pkCli_7405,pkSess_7403),Ksrv_7438))
                                            )
                                            else
                                                {8337}let pkDisco_7439: bitstring = pub(sk(Disco_5310)) in
                                                {8338}in(c, (=pkCli_7405,em1_7440: bitstring,sigM1_7441: bitstring));
                                                {8339}let m1_7442: bitstring = em1_7440 in
                                                {8340}if (verify(h(m1_7442),sigM1_7441,pkCli_7405) <> true) then
                                                    0
                                                else
                                                    {8341}let (=OpenSecureChannelRequest,=pkCli_7405,Nc_7443: bitstring) = m1_7442 in
                                                    {8342}new Ns_7444: bitstring;
                                                    {8343}new ST_7445: bitstring;
                                                    {8344}new TTL_7446: bitstring;
                                                    {8345}let m2_7447: bitstring = (OpenSecureChannelResponse,Ns_7444,ST_7445,TTL_7446) in
                                                    {8346}out(c, (m2_7447,sign(h(m2_7447),skSess_7402)));
                                                    {8347}let Ksrv_7448: bitstring = h((Ns_7444,Nc_7443)) in
                                                    {8348}out(c, senc(mSrv(pkCli_7405,pkSess_7403),Ksrv_7448))
                                        )
                                        else
                                            {8349}let pkDisco_7449: bitstring = fail-any in
                                            {8350}in(c, (=pkCli_7405,em1_7450: bitstring,sigM1_7451: bitstring));
                                            {8351}let m1_7452: bitstring = em1_7450 in
                                            {8352}if (verify(h(m1_7452),sigM1_7451,pkCli_7405) <> true) then
                                                0
                                            else
                                                {8353}let (=OpenSecureChannelRequest,=pkCli_7405,Nc_7453: bitstring) = m1_7452 in
                                                {8354}new Ns_7454: bitstring;
                                                {8355}new ST_7455: bitstring;
                                                {8356}new TTL_7456: bitstring;
                                                {8357}let m2_7457: bitstring = (OpenSecureChannelResponse,Ns_7454,ST_7455,TTL_7456) in
                                                {8358}out(c, (m2_7457,sign(h(m2_7457),skSess_7402)));
                                                {8359}let Ksrv_7458: bitstring = h((Ns_7454,Nc_7453)) in
                                                {8360}out(c, senc(mSrv(pkCli_7405,pkSess_7403),Ksrv_7458))
                                )
                                else
                                    {8361}let pkDisco_7459: bitstring = fail-any in
                                    {8362}in(c, (=pkCli_7405,em1_7460: bitstring,sigM1_7461: bitstring));
                                    {8363}let m1_7462: bitstring = em1_7460 in
                                    {8364}if (verify(h(m1_7462),sigM1_7461,pkCli_7405) <> true) then
                                        0
                                    else
                                        {8365}let (=OpenSecureChannelRequest,=pkCli_7405,Nc_7463: bitstring) = m1_7462 in
                                        {8366}new Ns_7464: bitstring;
                                        {8367}new ST_7465: bitstring;
                                        {8368}new TTL_7466: bitstring;
                                        {8369}let m2_7467: bitstring = (OpenSecureChannelResponse,Ns_7464,ST_7465,TTL_7466) in
                                        {8370}out(c, (m2_7467,sign(h(m2_7467),skSess_7402)));
                                        {8371}let Ksrv_7468: bitstring = h((Ns_7464,Nc_7463)) in
                                        {8372}out(c, senc(mSrv(pkCli_7405,pkSess_7403),Ksrv_7468))
                        )
                        else
                            {8373}let pkDisco_7469: bitstring = fail-any in
                            {8374}in(c, (=pkCli_7405,em1_7470: bitstring,sigM1_7471: bitstring));
                            {8375}let m1_7472: bitstring = em1_7470 in
                            {8376}if (verify(h(m1_7472),sigM1_7471,pkCli_7405) <> true) then
                                0
                            else
                                {8377}let (=OpenSecureChannelRequest,=pkCli_7405,Nc_7473: bitstring) = m1_7472 in
                                {8378}new Ns_7474: bitstring;
                                {8379}new ST_7475: bitstring;
                                {8380}new TTL_7476: bitstring;
                                {8381}let m2_7477: bitstring = (OpenSecureChannelResponse,Ns_7474,ST_7475,TTL_7476) in
                                {8382}out(c, (m2_7477,sign(h(m2_7477),skSess_7402)));
                                {8383}let Ksrv_7478: bitstring = h((Ns_7474,Nc_7473)) in
                                {8384}out(c, senc(mSrv(pkCli_7405,pkSess_7403),Ksrv_7478))
                    )
                    else
                        {8385}let v_7479: bool = (Cli_5309 = B) in
                        (
                            {8386}if v_7479 then
                            (
                                {8387}let pkCli_7480: bitstring = pub(skB) in
                                {8388}let v_7481: bool = (Disco_5310 = A) in
                                (
                                    {8389}if v_7481 then
                                    (
                                        {8390}let pkDisco_7482: bitstring = pub(skA) in
                                        {8391}in(c, (=pkCli_7480,em1_7483: bitstring,sigM1_7484: bitstring));
                                        {8392}let m1_7485: bitstring = em1_7483 in
                                        {8393}if (verify(h(m1_7485),sigM1_7484,pkCli_7480) <> true) then
                                            0
                                        else
                                            {8394}let (=OpenSecureChannelRequest,=pkCli_7480,Nc_7486: bitstring) = m1_7485 in
                                            {8395}new Ns_7487: bitstring;
                                            {8396}new ST_7488: bitstring;
                                            {8397}new TTL_7489: bitstring;
                                            {8398}let m2_7490: bitstring = (OpenSecureChannelResponse,Ns_7487,ST_7488,TTL_7489) in
                                            {8399}out(c, (m2_7490,sign(h(m2_7490),skSess_7402)));
                                            {8400}let Ksrv_7491: bitstring = h((Ns_7487,Nc_7486)) in
                                            {8401}out(c, senc(mSrv(pkCli_7480,pkSess_7403),Ksrv_7491))
                                    )
                                    else
                                        {8402}let v_7492: bool = (Disco_5310 = B) in
                                        (
                                            {8403}if v_7492 then
                                            (
                                                {8404}let pkDisco_7493: bitstring = pub(skB) in
                                                {8405}in(c, (=pkCli_7480,em1_7494: bitstring,sigM1_7495: bitstring));
                                                {8406}let m1_7496: bitstring = em1_7494 in
                                                {8407}if (verify(h(m1_7496),sigM1_7495,pkCli_7480) <> true) then
                                                    0
                                                else
                                                    {8408}let (=OpenSecureChannelRequest,=pkCli_7480,Nc_7497: bitstring) = m1_7496 in
                                                    {8409}new Ns_7498: bitstring;
                                                    {8410}new ST_7499: bitstring;
                                                    {8411}new TTL_7500: bitstring;
                                                    {8412}let m2_7501: bitstring = (OpenSecureChannelResponse,Ns_7498,ST_7499,TTL_7500) in
                                                    {8413}out(c, (m2_7501,sign(h(m2_7501),skSess_7402)));
                                                    {8414}let Ksrv_7502: bitstring = h((Ns_7498,Nc_7497)) in
                                                    {8415}out(c, senc(mSrv(pkCli_7480,pkSess_7403),Ksrv_7502))
                                            )
                                            else
                                                {8416}let v_7503: bool = (Disco_5310 = C) in
                                                (
                                                    {8417}if v_7503 then
                                                    (
                                                        {8418}let pkDisco_7504: bitstring = pub(skC) in
                                                        {8419}in(c, (=pkCli_7480,em1_7505: bitstring,sigM1_7506: bitstring));
                                                        {8420}let m1_7507: bitstring = em1_7505 in
                                                        {8421}if (verify(h(m1_7507),sigM1_7506,pkCli_7480) <> true) then
                                                            0
                                                        else
                                                            {8422}let (=OpenSecureChannelRequest,=pkCli_7480,Nc_7508: bitstring) = m1_7507 in
                                                            {8423}new Ns_7509: bitstring;
                                                            {8424}new ST_7510: bitstring;
                                                            {8425}new TTL_7511: bitstring;
                                                            {8426}let m2_7512: bitstring = (OpenSecureChannelResponse,Ns_7509,ST_7510,TTL_7511) in
                                                            {8427}out(c, (m2_7512,sign(h(m2_7512),skSess_7402)));
                                                            {8428}let Ksrv_7513: bitstring = h((Ns_7509,Nc_7508)) in
                                                            {8429}out(c, senc(mSrv(pkCli_7480,pkSess_7403),Ksrv_7513))
                                                    )
                                                    else
                                                        {8430}let pkDisco_7514: bitstring = pub(sk(Disco_5310)) in
                                                        {8431}in(c, (=pkCli_7480,em1_7515: bitstring,sigM1_7516: bitstring));
                                                        {8432}let m1_7517: bitstring = em1_7515 in
                                                        {8433}if (verify(h(m1_7517),sigM1_7516,pkCli_7480) <> true) then
                                                            0
                                                        else
                                                            {8434}let (=OpenSecureChannelRequest,=pkCli_7480,Nc_7518: bitstring) = m1_7517 in
                                                            {8435}new Ns_7519: bitstring;
                                                            {8436}new ST_7520: bitstring;
                                                            {8437}new TTL_7521: bitstring;
                                                            {8438}let m2_7522: bitstring = (OpenSecureChannelResponse,Ns_7519,ST_7520,TTL_7521) in
                                                            {8439}out(c, (m2_7522,sign(h(m2_7522),skSess_7402)));
                                                            {8440}let Ksrv_7523: bitstring = h((Ns_7519,Nc_7518)) in
                                                            {8441}out(c, senc(mSrv(pkCli_7480,pkSess_7403),Ksrv_7523))
                                                )
                                                else
                                                    {8442}let pkDisco_7524: bitstring = fail-any in
                                                    {8443}in(c, (=pkCli_7480,em1_7525: bitstring,sigM1_7526: bitstring));
                                                    {8444}let m1_7527: bitstring = em1_7525 in
                                                    {8445}if (verify(h(m1_7527),sigM1_7526,pkCli_7480) <> true) then
                                                        0
                                                    else
                                                        {8446}let (=OpenSecureChannelRequest,=pkCli_7480,Nc_7528: bitstring) = m1_7527 in
                                                        {8447}new Ns_7529: bitstring;
                                                        {8448}new ST_7530: bitstring;
                                                        {8449}new TTL_7531: bitstring;
                                                        {8450}let m2_7532: bitstring = (OpenSecureChannelResponse,Ns_7529,ST_7530,TTL_7531) in
                                                        {8451}out(c, (m2_7532,sign(h(m2_7532),skSess_7402)));
                                                        {8452}let Ksrv_7533: bitstring = h((Ns_7529,Nc_7528)) in
                                                        {8453}out(c, senc(mSrv(pkCli_7480,pkSess_7403),Ksrv_7533))
                                        )
                                        else
                                            {8454}let pkDisco_7534: bitstring = fail-any in
                                            {8455}in(c, (=pkCli_7480,em1_7535: bitstring,sigM1_7536: bitstring));
                                            {8456}let m1_7537: bitstring = em1_7535 in
                                            {8457}if (verify(h(m1_7537),sigM1_7536,pkCli_7480) <> true) then
                                                0
                                            else
                                                {8458}let (=OpenSecureChannelRequest,=pkCli_7480,Nc_7538: bitstring) = m1_7537 in
                                                {8459}new Ns_7539: bitstring;
                                                {8460}new ST_7540: bitstring;
                                                {8461}new TTL_7541: bitstring;
                                                {8462}let m2_7542: bitstring = (OpenSecureChannelResponse,Ns_7539,ST_7540,TTL_7541) in
                                                {8463}out(c, (m2_7542,sign(h(m2_7542),skSess_7402)));
                                                {8464}let Ksrv_7543: bitstring = h((Ns_7539,Nc_7538)) in
                                                {8465}out(c, senc(mSrv(pkCli_7480,pkSess_7403),Ksrv_7543))
                                )
                                else
                                    {8466}let pkDisco_7544: bitstring = fail-any in
                                    {8467}in(c, (=pkCli_7480,em1_7545: bitstring,sigM1_7546: bitstring));
                                    {8468}let m1_7547: bitstring = em1_7545 in
                                    {8469}if (verify(h(m1_7547),sigM1_7546,pkCli_7480) <> true) then
                                        0
                                    else
                                        {8470}let (=OpenSecureChannelRequest,=pkCli_7480,Nc_7548: bitstring) = m1_7547 in
                                        {8471}new Ns_7549: bitstring;
                                        {8472}new ST_7550: bitstring;
                                        {8473}new TTL_7551: bitstring;
                                        {8474}let m2_7552: bitstring = (OpenSecureChannelResponse,Ns_7549,ST_7550,TTL_7551) in
                                        {8475}out(c, (m2_7552,sign(h(m2_7552),skSess_7402)));
                                        {8476}let Ksrv_7553: bitstring = h((Ns_7549,Nc_7548)) in
                                        {8477}out(c, senc(mSrv(pkCli_7480,pkSess_7403),Ksrv_7553))
                            )
                            else
                                {8478}let v_7554: bool = (Cli_5309 = C) in
                                (
                                    {8479}if v_7554 then
                                    (
                                        {8480}let pkCli_7555: bitstring = pub(skC) in
                                        {8481}let v_7556: bool = (Disco_5310 = A) in
                                        (
                                            {8482}if v_7556 then
                                            (
                                                {8483}let pkDisco_7557: bitstring = pub(skA) in
                                                {8484}in(c, (=pkCli_7555,em1_7558: bitstring,sigM1_7559: bitstring));
                                                {8485}let m1_7560: bitstring = em1_7558 in
                                                {8486}if (verify(h(m1_7560),sigM1_7559,pkCli_7555) <> true) then
                                                    0
                                                else
                                                    {8487}let (=OpenSecureChannelRequest,=pkCli_7555,Nc_7561: bitstring) = m1_7560 in
                                                    {8488}new Ns_7562: bitstring;
                                                    {8489}new ST_7563: bitstring;
                                                    {8490}new TTL_7564: bitstring;
                                                    {8491}let m2_7565: bitstring = (OpenSecureChannelResponse,Ns_7562,ST_7563,TTL_7564) in
                                                    {8492}out(c, (m2_7565,sign(h(m2_7565),skSess_7402)));
                                                    {8493}let Ksrv_7566: bitstring = h((Ns_7562,Nc_7561)) in
                                                    {8494}out(c, senc(mSrv(pkCli_7555,pkSess_7403),Ksrv_7566))
                                            )
                                            else
                                                {8495}let v_7567: bool = (Disco_5310 = B) in
                                                (
                                                    {8496}if v_7567 then
                                                    (
                                                        {8497}let pkDisco_7568: bitstring = pub(skB) in
                                                        {8498}in(c, (=pkCli_7555,em1_7569: bitstring,sigM1_7570: bitstring));
                                                        {8499}let m1_7571: bitstring = em1_7569 in
                                                        {8500}if (verify(h(m1_7571),sigM1_7570,pkCli_7555) <> true) then
                                                            0
                                                        else
                                                            {8501}let (=OpenSecureChannelRequest,=pkCli_7555,Nc_7572: bitstring) = m1_7571 in
                                                            {8502}new Ns_7573: bitstring;
                                                            {8503}new ST_7574: bitstring;
                                                            {8504}new TTL_7575: bitstring;
                                                            {8505}let m2_7576: bitstring = (OpenSecureChannelResponse,Ns_7573,ST_7574,TTL_7575) in
                                                            {8506}out(c, (m2_7576,sign(h(m2_7576),skSess_7402)));
                                                            {8507}let Ksrv_7577: bitstring = h((Ns_7573,Nc_7572)) in
                                                            {8508}out(c, senc(mSrv(pkCli_7555,pkSess_7403),Ksrv_7577))
                                                    )
                                                    else
                                                        {8509}let v_7578: bool = (Disco_5310 = C) in
                                                        (
                                                            {8510}if v_7578 then
                                                            (
                                                                {8511}let pkDisco_7579: bitstring = pub(skC) in
                                                                {8512}in(c, (=pkCli_7555,em1_7580: bitstring,sigM1_7581: bitstring));
                                                                {8513}let m1_7582: bitstring = em1_7580 in
                                                                {8514}if (verify(h(m1_7582),sigM1_7581,pkCli_7555) <> true) then
                                                                    0
                                                                else
                                                                    {8515}let (=OpenSecureChannelRequest,=pkCli_7555,Nc_7583: bitstring) = m1_7582 in
                                                                    {8516}new Ns_7584: bitstring;
                                                                    {8517}new ST_7585: bitstring;
                                                                    {8518}new TTL_7586: bitstring;
                                                                    {8519}let m2_7587: bitstring = (OpenSecureChannelResponse,Ns_7584,ST_7585,TTL_7586) in
                                                                    {8520}out(c, (m2_7587,sign(h(m2_7587),skSess_7402)));
                                                                    {8521}let Ksrv_7588: bitstring = h((Ns_7584,Nc_7583)) in
                                                                    {8522}out(c, senc(mSrv(pkCli_7555,pkSess_7403),Ksrv_7588))
                                                            )
                                                            else
                                                                {8523}let pkDisco_7589: bitstring = pub(sk(Disco_5310)) in
                                                                {8524}in(c, (=pkCli_7555,em1_7590: bitstring,sigM1_7591: bitstring));
                                                                {8525}let m1_7592: bitstring = em1_7590 in
                                                                {8526}if (verify(h(m1_7592),sigM1_7591,pkCli_7555) <> true) then
                                                                    0
                                                                else
                                                                    {8527}let (=OpenSecureChannelRequest,=pkCli_7555,Nc_7593: bitstring) = m1_7592 in
                                                                    {8528}new Ns_7594: bitstring;
                                                                    {8529}new ST_7595: bitstring;
                                                                    {8530}new TTL_7596: bitstring;
                                                                    {8531}let m2_7597: bitstring = (OpenSecureChannelResponse,Ns_7594,ST_7595,TTL_7596) in
                                                                    {8532}out(c, (m2_7597,sign(h(m2_7597),skSess_7402)));
                                                                    {8533}let Ksrv_7598: bitstring = h((Ns_7594,Nc_7593)) in
                                                                    {8534}out(c, senc(mSrv(pkCli_7555,pkSess_7403),Ksrv_7598))
                                                        )
                                                        else
                                                            {8535}let pkDisco_7599: bitstring = fail-any in
                                                            {8536}in(c, (=pkCli_7555,em1_7600: bitstring,sigM1_7601: bitstring));
                                                            {8537}let m1_7602: bitstring = em1_7600 in
                                                            {8538}if (verify(h(m1_7602),sigM1_7601,pkCli_7555) <> true) then
                                                                0
                                                            else
                                                                {8539}let (=OpenSecureChannelRequest,=pkCli_7555,Nc_7603: bitstring) = m1_7602 in
                                                                {8540}new Ns_7604: bitstring;
                                                                {8541}new ST_7605: bitstring;
                                                                {8542}new TTL_7606: bitstring;
                                                                {8543}let m2_7607: bitstring = (OpenSecureChannelResponse,Ns_7604,ST_7605,TTL_7606) in
                                                                {8544}out(c, (m2_7607,sign(h(m2_7607),skSess_7402)));
                                                                {8545}let Ksrv_7608: bitstring = h((Ns_7604,Nc_7603)) in
                                                                {8546}out(c, senc(mSrv(pkCli_7555,pkSess_7403),Ksrv_7608))
                                                )
                                                else
                                                    {8547}let pkDisco_7609: bitstring = fail-any in
                                                    {8548}in(c, (=pkCli_7555,em1_7610: bitstring,sigM1_7611: bitstring));
                                                    {8549}let m1_7612: bitstring = em1_7610 in
                                                    {8550}if (verify(h(m1_7612),sigM1_7611,pkCli_7555) <> true) then
                                                        0
                                                    else
                                                        {8551}let (=OpenSecureChannelRequest,=pkCli_7555,Nc_7613: bitstring) = m1_7612 in
                                                        {8552}new Ns_7614: bitstring;
                                                        {8553}new ST_7615: bitstring;
                                                        {8554}new TTL_7616: bitstring;
                                                        {8555}let m2_7617: bitstring = (OpenSecureChannelResponse,Ns_7614,ST_7615,TTL_7616) in
                                                        {8556}out(c, (m2_7617,sign(h(m2_7617),skSess_7402)));
                                                        {8557}let Ksrv_7618: bitstring = h((Ns_7614,Nc_7613)) in
                                                        {8558}out(c, senc(mSrv(pkCli_7555,pkSess_7403),Ksrv_7618))
                                        )
                                        else
                                            {8559}let pkDisco_7619: bitstring = fail-any in
                                            {8560}in(c, (=pkCli_7555,em1_7620: bitstring,sigM1_7621: bitstring));
                                            {8561}let m1_7622: bitstring = em1_7620 in
                                            {8562}if (verify(h(m1_7622),sigM1_7621,pkCli_7555) <> true) then
                                                0
                                            else
                                                {8563}let (=OpenSecureChannelRequest,=pkCli_7555,Nc_7623: bitstring) = m1_7622 in
                                                {8564}new Ns_7624: bitstring;
                                                {8565}new ST_7625: bitstring;
                                                {8566}new TTL_7626: bitstring;
                                                {8567}let m2_7627: bitstring = (OpenSecureChannelResponse,Ns_7624,ST_7625,TTL_7626) in
                                                {8568}out(c, (m2_7627,sign(h(m2_7627),skSess_7402)));
                                                {8569}let Ksrv_7628: bitstring = h((Ns_7624,Nc_7623)) in
                                                {8570}out(c, senc(mSrv(pkCli_7555,pkSess_7403),Ksrv_7628))
                                    )
                                    else
                                        {8571}let pkCli_7629: bitstring = pub(sk(Cli_5309)) in
                                        {8572}let v_7630: bool = (Disco_5310 = A) in
                                        (
                                            {8573}if v_7630 then
                                            (
                                                {8574}let pkDisco_7631: bitstring = pub(skA) in
                                                {8575}in(c, (=pkCli_7629,em1_7632: bitstring,sigM1_7633: bitstring));
                                                {8576}let m1_7634: bitstring = em1_7632 in
                                                {8577}if (verify(h(m1_7634),sigM1_7633,pkCli_7629) <> true) then
                                                    0
                                                else
                                                    {8578}let (=OpenSecureChannelRequest,=pkCli_7629,Nc_7635: bitstring) = m1_7634 in
                                                    {8579}new Ns_7636: bitstring;
                                                    {8580}new ST_7637: bitstring;
                                                    {8581}new TTL_7638: bitstring;
                                                    {8582}let m2_7639: bitstring = (OpenSecureChannelResponse,Ns_7636,ST_7637,TTL_7638) in
                                                    {8583}out(c, (m2_7639,sign(h(m2_7639),skSess_7402)));
                                                    {8584}let Ksrv_7640: bitstring = h((Ns_7636,Nc_7635)) in
                                                    {8585}out(c, senc(mSrv(pkCli_7629,pkSess_7403),Ksrv_7640))
                                            )
                                            else
                                                {8586}let v_7641: bool = (Disco_5310 = B) in
                                                (
                                                    {8587}if v_7641 then
                                                    (
                                                        {8588}let pkDisco_7642: bitstring = pub(skB) in
                                                        {8589}in(c, (=pkCli_7629,em1_7643: bitstring,sigM1_7644: bitstring));
                                                        {8590}let m1_7645: bitstring = em1_7643 in
                                                        {8591}if (verify(h(m1_7645),sigM1_7644,pkCli_7629) <> true) then
                                                            0
                                                        else
                                                            {8592}let (=OpenSecureChannelRequest,=pkCli_7629,Nc_7646: bitstring) = m1_7645 in
                                                            {8593}new Ns_7647: bitstring;
                                                            {8594}new ST_7648: bitstring;
                                                            {8595}new TTL_7649: bitstring;
                                                            {8596}let m2_7650: bitstring = (OpenSecureChannelResponse,Ns_7647,ST_7648,TTL_7649) in
                                                            {8597}out(c, (m2_7650,sign(h(m2_7650),skSess_7402)));
                                                            {8598}let Ksrv_7651: bitstring = h((Ns_7647,Nc_7646)) in
                                                            {8599}out(c, senc(mSrv(pkCli_7629,pkSess_7403),Ksrv_7651))
                                                    )
                                                    else
                                                        {8600}let v_7652: bool = (Disco_5310 = C) in
                                                        (
                                                            {8601}if v_7652 then
                                                            (
                                                                {8602}let pkDisco_7653: bitstring = pub(skC) in
                                                                {8603}in(c, (=pkCli_7629,em1_7654: bitstring,sigM1_7655: bitstring));
                                                                {8604}let m1_7656: bitstring = em1_7654 in
                                                                {8605}if (verify(h(m1_7656),sigM1_7655,pkCli_7629) <> true) then
                                                                    0
                                                                else
                                                                    {8606}let (=OpenSecureChannelRequest,=pkCli_7629,Nc_7657: bitstring) = m1_7656 in
                                                                    {8607}new Ns_7658: bitstring;
                                                                    {8608}new ST_7659: bitstring;
                                                                    {8609}new TTL_7660: bitstring;
                                                                    {8610}let m2_7661: bitstring = (OpenSecureChannelResponse,Ns_7658,ST_7659,TTL_7660) in
                                                                    {8611}out(c, (m2_7661,sign(h(m2_7661),skSess_7402)));
                                                                    {8612}let Ksrv_7662: bitstring = h((Ns_7658,Nc_7657)) in
                                                                    {8613}out(c, senc(mSrv(pkCli_7629,pkSess_7403),Ksrv_7662))
                                                            )
                                                            else
                                                                {8614}let pkDisco_7663: bitstring = pub(sk(Disco_5310)) in
                                                                {8615}in(c, (=pkCli_7629,em1_7664: bitstring,sigM1_7665: bitstring));
                                                                {8616}let m1_7666: bitstring = em1_7664 in
                                                                {8617}if (verify(h(m1_7666),sigM1_7665,pkCli_7629) <> true) then
                                                                    0
                                                                else
                                                                    {8618}let (=OpenSecureChannelRequest,=pkCli_7629,Nc_7667: bitstring) = m1_7666 in
                                                                    {8619}new Ns_7668: bitstring;
                                                                    {8620}new ST_7669: bitstring;
                                                                    {8621}new TTL_7670: bitstring;
                                                                    {8622}let m2_7671: bitstring = (OpenSecureChannelResponse,Ns_7668,ST_7669,TTL_7670) in
                                                                    {8623}out(c, (m2_7671,sign(h(m2_7671),skSess_7402)));
                                                                    {8624}let Ksrv_7672: bitstring = h((Ns_7668,Nc_7667)) in
                                                                    {8625}out(c, senc(mSrv(pkCli_7629,pkSess_7403),Ksrv_7672))
                                                        )
                                                        else
                                                            {8626}let pkDisco_7673: bitstring = fail-any in
                                                            {8627}in(c, (=pkCli_7629,em1_7674: bitstring,sigM1_7675: bitstring));
                                                            {8628}let m1_7676: bitstring = em1_7674 in
                                                            {8629}if (verify(h(m1_7676),sigM1_7675,pkCli_7629) <> true) then
                                                                0
                                                            else
                                                                {8630}let (=OpenSecureChannelRequest,=pkCli_7629,Nc_7677: bitstring) = m1_7676 in
                                                                {8631}new Ns_7678: bitstring;
                                                                {8632}new ST_7679: bitstring;
                                                                {8633}new TTL_7680: bitstring;
                                                                {8634}let m2_7681: bitstring = (OpenSecureChannelResponse,Ns_7678,ST_7679,TTL_7680) in
                                                                {8635}out(c, (m2_7681,sign(h(m2_7681),skSess_7402)));
                                                                {8636}let Ksrv_7682: bitstring = h((Ns_7678,Nc_7677)) in
                                                                {8637}out(c, senc(mSrv(pkCli_7629,pkSess_7403),Ksrv_7682))
                                                )
                                                else
                                                    {8638}let pkDisco_7683: bitstring = fail-any in
                                                    {8639}in(c, (=pkCli_7629,em1_7684: bitstring,sigM1_7685: bitstring));
                                                    {8640}let m1_7686: bitstring = em1_7684 in
                                                    {8641}if (verify(h(m1_7686),sigM1_7685,pkCli_7629) <> true) then
                                                        0
                                                    else
                                                        {8642}let (=OpenSecureChannelRequest,=pkCli_7629,Nc_7687: bitstring) = m1_7686 in
                                                        {8643}new Ns_7688: bitstring;
                                                        {8644}new ST_7689: bitstring;
                                                        {8645}new TTL_7690: bitstring;
                                                        {8646}let m2_7691: bitstring = (OpenSecureChannelResponse,Ns_7688,ST_7689,TTL_7690) in
                                                        {8647}out(c, (m2_7691,sign(h(m2_7691),skSess_7402)));
                                                        {8648}let Ksrv_7692: bitstring = h((Ns_7688,Nc_7687)) in
                                                        {8649}out(c, senc(mSrv(pkCli_7629,pkSess_7403),Ksrv_7692))
                                        )
                                        else
                                            {8650}let pkDisco_7693: bitstring = fail-any in
                                            {8651}in(c, (=pkCli_7629,em1_7694: bitstring,sigM1_7695: bitstring));
                                            {8652}let m1_7696: bitstring = em1_7694 in
                                            {8653}if (verify(h(m1_7696),sigM1_7695,pkCli_7629) <> true) then
                                                0
                                            else
                                                {8654}let (=OpenSecureChannelRequest,=pkCli_7629,Nc_7697: bitstring) = m1_7696 in
                                                {8655}new Ns_7698: bitstring;
                                                {8656}new ST_7699: bitstring;
                                                {8657}new TTL_7700: bitstring;
                                                {8658}let m2_7701: bitstring = (OpenSecureChannelResponse,Ns_7698,ST_7699,TTL_7700) in
                                                {8659}out(c, (m2_7701,sign(h(m2_7701),skSess_7402)));
                                                {8660}let Ksrv_7702: bitstring = h((Ns_7698,Nc_7697)) in
                                                {8661}out(c, senc(mSrv(pkCli_7629,pkSess_7403),Ksrv_7702))
                                )
                                else
                                    {8662}let pkCli_7703: bitstring = fail-any in
                                    {8663}let v_7704: bool = (Disco_5310 = A) in
                                    (
                                        {8664}if v_7704 then
                                        (
                                            {8665}let pkDisco_7705: bitstring = pub(skA) in
                                            {8666}in(c, (=pkCli_7703,em1_7706: bitstring,sigM1_7707: bitstring));
                                            {8667}let m1_7708: bitstring = em1_7706 in
                                            {8668}if (verify(h(m1_7708),sigM1_7707,pkCli_7703) <> true) then
                                                0
                                            else
                                                {8669}let (=OpenSecureChannelRequest,=pkCli_7703,Nc_7709: bitstring) = m1_7708 in
                                                {8670}new Ns_7710: bitstring;
                                                {8671}new ST_7711: bitstring;
                                                {8672}new TTL_7712: bitstring;
                                                {8673}let m2_7713: bitstring = (OpenSecureChannelResponse,Ns_7710,ST_7711,TTL_7712) in
                                                {8674}out(c, (m2_7713,sign(h(m2_7713),skSess_7402)));
                                                {8675}let Ksrv_7714: bitstring = h((Ns_7710,Nc_7709)) in
                                                {8676}out(c, senc(mSrv(pkCli_7703,pkSess_7403),Ksrv_7714))
                                        )
                                        else
                                            {8677}let v_7715: bool = (Disco_5310 = B) in
                                            (
                                                {8678}if v_7715 then
                                                (
                                                    {8679}let pkDisco_7716: bitstring = pub(skB) in
                                                    {8680}in(c, (=pkCli_7703,em1_7717: bitstring,sigM1_7718: bitstring));
                                                    {8681}let m1_7719: bitstring = em1_7717 in
                                                    {8682}if (verify(h(m1_7719),sigM1_7718,pkCli_7703) <> true) then
                                                        0
                                                    else
                                                        {8683}let (=OpenSecureChannelRequest,=pkCli_7703,Nc_7720: bitstring) = m1_7719 in
                                                        {8684}new Ns_7721: bitstring;
                                                        {8685}new ST_7722: bitstring;
                                                        {8686}new TTL_7723: bitstring;
                                                        {8687}let m2_7724: bitstring = (OpenSecureChannelResponse,Ns_7721,ST_7722,TTL_7723) in
                                                        {8688}out(c, (m2_7724,sign(h(m2_7724),skSess_7402)));
                                                        {8689}let Ksrv_7725: bitstring = h((Ns_7721,Nc_7720)) in
                                                        {8690}out(c, senc(mSrv(pkCli_7703,pkSess_7403),Ksrv_7725))
                                                )
                                                else
                                                    {8691}let v_7726: bool = (Disco_5310 = C) in
                                                    (
                                                        {8692}if v_7726 then
                                                        (
                                                            {8693}let pkDisco_7727: bitstring = pub(skC) in
                                                            {8694}in(c, (=pkCli_7703,em1_7728: bitstring,sigM1_7729: bitstring));
                                                            {8695}let m1_7730: bitstring = em1_7728 in
                                                            {8696}if (verify(h(m1_7730),sigM1_7729,pkCli_7703) <> true) then
                                                                0
                                                            else
                                                                {8697}let (=OpenSecureChannelRequest,=pkCli_7703,Nc_7731: bitstring) = m1_7730 in
                                                                {8698}new Ns_7732: bitstring;
                                                                {8699}new ST_7733: bitstring;
                                                                {8700}new TTL_7734: bitstring;
                                                                {8701}let m2_7735: bitstring = (OpenSecureChannelResponse,Ns_7732,ST_7733,TTL_7734) in
                                                                {8702}out(c, (m2_7735,sign(h(m2_7735),skSess_7402)));
                                                                {8703}let Ksrv_7736: bitstring = h((Ns_7732,Nc_7731)) in
                                                                {8704}out(c, senc(mSrv(pkCli_7703,pkSess_7403),Ksrv_7736))
                                                        )
                                                        else
                                                            {8705}let pkDisco_7737: bitstring = pub(sk(Disco_5310)) in
                                                            {8706}in(c, (=pkCli_7703,em1_7738: bitstring,sigM1_7739: bitstring));
                                                            {8707}let m1_7740: bitstring = em1_7738 in
                                                            {8708}if (verify(h(m1_7740),sigM1_7739,pkCli_7703) <> true) then
                                                                0
                                                            else
                                                                {8709}let (=OpenSecureChannelRequest,=pkCli_7703,Nc_7741: bitstring) = m1_7740 in
                                                                {8710}new Ns_7742: bitstring;
                                                                {8711}new ST_7743: bitstring;
                                                                {8712}new TTL_7744: bitstring;
                                                                {8713}let m2_7745: bitstring = (OpenSecureChannelResponse,Ns_7742,ST_7743,TTL_7744) in
                                                                {8714}out(c, (m2_7745,sign(h(m2_7745),skSess_7402)));
                                                                {8715}let Ksrv_7746: bitstring = h((Ns_7742,Nc_7741)) in
                                                                {8716}out(c, senc(mSrv(pkCli_7703,pkSess_7403),Ksrv_7746))
                                                    )
                                                    else
                                                        {8717}let pkDisco_7747: bitstring = fail-any in
                                                        {8718}in(c, (=pkCli_7703,em1_7748: bitstring,sigM1_7749: bitstring));
                                                        {8719}let m1_7750: bitstring = em1_7748 in
                                                        {8720}if (verify(h(m1_7750),sigM1_7749,pkCli_7703) <> true) then
                                                            0
                                                        else
                                                            {8721}let (=OpenSecureChannelRequest,=pkCli_7703,Nc_7751: bitstring) = m1_7750 in
                                                            {8722}new Ns_7752: bitstring;
                                                            {8723}new ST_7753: bitstring;
                                                            {8724}new TTL_7754: bitstring;
                                                            {8725}let m2_7755: bitstring = (OpenSecureChannelResponse,Ns_7752,ST_7753,TTL_7754) in
                                                            {8726}out(c, (m2_7755,sign(h(m2_7755),skSess_7402)));
                                                            {8727}let Ksrv_7756: bitstring = h((Ns_7752,Nc_7751)) in
                                                            {8728}out(c, senc(mSrv(pkCli_7703,pkSess_7403),Ksrv_7756))
                                            )
                                            else
                                                {8729}let pkDisco_7757: bitstring = fail-any in
                                                {8730}in(c, (=pkCli_7703,em1_7758: bitstring,sigM1_7759: bitstring));
                                                {8731}let m1_7760: bitstring = em1_7758 in
                                                {8732}if (verify(h(m1_7760),sigM1_7759,pkCli_7703) <> true) then
                                                    0
                                                else
                                                    {8733}let (=OpenSecureChannelRequest,=pkCli_7703,Nc_7761: bitstring) = m1_7760 in
                                                    {8734}new Ns_7762: bitstring;
                                                    {8735}new ST_7763: bitstring;
                                                    {8736}new TTL_7764: bitstring;
                                                    {8737}let m2_7765: bitstring = (OpenSecureChannelResponse,Ns_7762,ST_7763,TTL_7764) in
                                                    {8738}out(c, (m2_7765,sign(h(m2_7765),skSess_7402)));
                                                    {8739}let Ksrv_7766: bitstring = h((Ns_7762,Nc_7761)) in
                                                    {8740}out(c, senc(mSrv(pkCli_7703,pkSess_7403),Ksrv_7766))
                                    )
                                    else
                                        {8741}let pkDisco_7767: bitstring = fail-any in
                                        {8742}in(c, (=pkCli_7703,em1_7768: bitstring,sigM1_7769: bitstring));
                                        {8743}let m1_7770: bitstring = em1_7768 in
                                        {8744}if (verify(h(m1_7770),sigM1_7769,pkCli_7703) <> true) then
                                            0
                                        else
                                            {8745}let (=OpenSecureChannelRequest,=pkCli_7703,Nc_7771: bitstring) = m1_7770 in
                                            {8746}new Ns_7772: bitstring;
                                            {8747}new ST_7773: bitstring;
                                            {8748}new TTL_7774: bitstring;
                                            {8749}let m2_7775: bitstring = (OpenSecureChannelResponse,Ns_7772,ST_7773,TTL_7774) in
                                            {8750}out(c, (m2_7775,sign(h(m2_7775),skSess_7402)));
                                            {8751}let Ksrv_7776: bitstring = h((Ns_7772,Nc_7771)) in
                                            {8752}out(c, senc(mSrv(pkCli_7703,pkSess_7403),Ksrv_7776))
                        )
                        else
                            {8753}let pkCli_7777: bitstring = fail-any in
                            {8754}let v_7778: bool = (Disco_5310 = A) in
                            (
                                {8755}if v_7778 then
                                (
                                    {8756}let pkDisco_7779: bitstring = pub(skA) in
                                    {8757}in(c, (=pkCli_7777,em1_7780: bitstring,sigM1_7781: bitstring));
                                    {8758}let m1_7782: bitstring = em1_7780 in
                                    {8759}if (verify(h(m1_7782),sigM1_7781,pkCli_7777) <> true) then
                                        0
                                    else
                                        {8760}let (=OpenSecureChannelRequest,=pkCli_7777,Nc_7783: bitstring) = m1_7782 in
                                        {8761}new Ns_7784: bitstring;
                                        {8762}new ST_7785: bitstring;
                                        {8763}new TTL_7786: bitstring;
                                        {8764}let m2_7787: bitstring = (OpenSecureChannelResponse,Ns_7784,ST_7785,TTL_7786) in
                                        {8765}out(c, (m2_7787,sign(h(m2_7787),skSess_7402)));
                                        {8766}let Ksrv_7788: bitstring = h((Ns_7784,Nc_7783)) in
                                        {8767}out(c, senc(mSrv(pkCli_7777,pkSess_7403),Ksrv_7788))
                                )
                                else
                                    {8768}let v_7789: bool = (Disco_5310 = B) in
                                    (
                                        {8769}if v_7789 then
                                        (
                                            {8770}let pkDisco_7790: bitstring = pub(skB) in
                                            {8771}in(c, (=pkCli_7777,em1_7791: bitstring,sigM1_7792: bitstring));
                                            {8772}let m1_7793: bitstring = em1_7791 in
                                            {8773}if (verify(h(m1_7793),sigM1_7792,pkCli_7777) <> true) then
                                                0
                                            else
                                                {8774}let (=OpenSecureChannelRequest,=pkCli_7777,Nc_7794: bitstring) = m1_7793 in
                                                {8775}new Ns_7795: bitstring;
                                                {8776}new ST_7796: bitstring;
                                                {8777}new TTL_7797: bitstring;
                                                {8778}let m2_7798: bitstring = (OpenSecureChannelResponse,Ns_7795,ST_7796,TTL_7797) in
                                                {8779}out(c, (m2_7798,sign(h(m2_7798),skSess_7402)));
                                                {8780}let Ksrv_7799: bitstring = h((Ns_7795,Nc_7794)) in
                                                {8781}out(c, senc(mSrv(pkCli_7777,pkSess_7403),Ksrv_7799))
                                        )
                                        else
                                            {8782}let v_7800: bool = (Disco_5310 = C) in
                                            (
                                                {8783}if v_7800 then
                                                (
                                                    {8784}let pkDisco_7801: bitstring = pub(skC) in
                                                    {8785}in(c, (=pkCli_7777,em1_7802: bitstring,sigM1_7803: bitstring));
                                                    {8786}let m1_7804: bitstring = em1_7802 in
                                                    {8787}if (verify(h(m1_7804),sigM1_7803,pkCli_7777) <> true) then
                                                        0
                                                    else
                                                        {8788}let (=OpenSecureChannelRequest,=pkCli_7777,Nc_7805: bitstring) = m1_7804 in
                                                        {8789}new Ns_7806: bitstring;
                                                        {8790}new ST_7807: bitstring;
                                                        {8791}new TTL_7808: bitstring;
                                                        {8792}let m2_7809: bitstring = (OpenSecureChannelResponse,Ns_7806,ST_7807,TTL_7808) in
                                                        {8793}out(c, (m2_7809,sign(h(m2_7809),skSess_7402)));
                                                        {8794}let Ksrv_7810: bitstring = h((Ns_7806,Nc_7805)) in
                                                        {8795}out(c, senc(mSrv(pkCli_7777,pkSess_7403),Ksrv_7810))
                                                )
                                                else
                                                    {8796}let pkDisco_7811: bitstring = pub(sk(Disco_5310)) in
                                                    {8797}in(c, (=pkCli_7777,em1_7812: bitstring,sigM1_7813: bitstring));
                                                    {8798}let m1_7814: bitstring = em1_7812 in
                                                    {8799}if (verify(h(m1_7814),sigM1_7813,pkCli_7777) <> true) then
                                                        0
                                                    else
                                                        {8800}let (=OpenSecureChannelRequest,=pkCli_7777,Nc_7815: bitstring) = m1_7814 in
                                                        {8801}new Ns_7816: bitstring;
                                                        {8802}new ST_7817: bitstring;
                                                        {8803}new TTL_7818: bitstring;
                                                        {8804}let m2_7819: bitstring = (OpenSecureChannelResponse,Ns_7816,ST_7817,TTL_7818) in
                                                        {8805}out(c, (m2_7819,sign(h(m2_7819),skSess_7402)));
                                                        {8806}let Ksrv_7820: bitstring = h((Ns_7816,Nc_7815)) in
                                                        {8807}out(c, senc(mSrv(pkCli_7777,pkSess_7403),Ksrv_7820))
                                            )
                                            else
                                                {8808}let pkDisco_7821: bitstring = fail-any in
                                                {8809}in(c, (=pkCli_7777,em1_7822: bitstring,sigM1_7823: bitstring));
                                                {8810}let m1_7824: bitstring = em1_7822 in
                                                {8811}if (verify(h(m1_7824),sigM1_7823,pkCli_7777) <> true) then
                                                    0
                                                else
                                                    {8812}let (=OpenSecureChannelRequest,=pkCli_7777,Nc_7825: bitstring) = m1_7824 in
                                                    {8813}new Ns_7826: bitstring;
                                                    {8814}new ST_7827: bitstring;
                                                    {8815}new TTL_7828: bitstring;
                                                    {8816}let m2_7829: bitstring = (OpenSecureChannelResponse,Ns_7826,ST_7827,TTL_7828) in
                                                    {8817}out(c, (m2_7829,sign(h(m2_7829),skSess_7402)));
                                                    {8818}let Ksrv_7830: bitstring = h((Ns_7826,Nc_7825)) in
                                                    {8819}out(c, senc(mSrv(pkCli_7777,pkSess_7403),Ksrv_7830))
                                    )
                                    else
                                        {8820}let pkDisco_7831: bitstring = fail-any in
                                        {8821}in(c, (=pkCli_7777,em1_7832: bitstring,sigM1_7833: bitstring));
                                        {8822}let m1_7834: bitstring = em1_7832 in
                                        {8823}if (verify(h(m1_7834),sigM1_7833,pkCli_7777) <> true) then
                                            0
                                        else
                                            {8824}let (=OpenSecureChannelRequest,=pkCli_7777,Nc_7835: bitstring) = m1_7834 in
                                            {8825}new Ns_7836: bitstring;
                                            {8826}new ST_7837: bitstring;
                                            {8827}new TTL_7838: bitstring;
                                            {8828}let m2_7839: bitstring = (OpenSecureChannelResponse,Ns_7836,ST_7837,TTL_7838) in
                                            {8829}out(c, (m2_7839,sign(h(m2_7839),skSess_7402)));
                                            {8830}let Ksrv_7840: bitstring = h((Ns_7836,Nc_7835)) in
                                            {8831}out(c, senc(mSrv(pkCli_7777,pkSess_7403),Ksrv_7840))
                            )
                            else
                                {8832}let pkDisco_7841: bitstring = fail-any in
                                {8833}in(c, (=pkCli_7777,em1_7842: bitstring,sigM1_7843: bitstring));
                                {8834}let m1_7844: bitstring = em1_7842 in
                                {8835}if (verify(h(m1_7844),sigM1_7843,pkCli_7777) <> true) then
                                    0
                                else
                                    {8836}let (=OpenSecureChannelRequest,=pkCli_7777,Nc_7845: bitstring) = m1_7844 in
                                    {8837}new Ns_7846: bitstring;
                                    {8838}new ST_7847: bitstring;
                                    {8839}new TTL_7848: bitstring;
                                    {8840}let m2_7849: bitstring = (OpenSecureChannelResponse,Ns_7846,ST_7847,TTL_7848) in
                                    {8841}out(c, (m2_7849,sign(h(m2_7849),skSess_7402)));
                                    {8842}let Ksrv_7850: bitstring = h((Ns_7846,Nc_7845)) in
                                    {8843}out(c, senc(mSrv(pkCli_7777,pkSess_7403),Ksrv_7850))
                )
                else
                    {8844}let pkCli_7851: bitstring = fail-any in
                    {8845}let v_7852: bool = (Disco_5310 = A) in
                    (
                        {8846}if v_7852 then
                        (
                            {8847}let pkDisco_7853: bitstring = pub(skA) in
                            {8848}in(c, (=pkCli_7851,em1_7854: bitstring,sigM1_7855: bitstring));
                            {8849}let m1_7856: bitstring = em1_7854 in
                            {8850}if (verify(h(m1_7856),sigM1_7855,pkCli_7851) <> true) then
                                0
                            else
                                {8851}let (=OpenSecureChannelRequest,=pkCli_7851,Nc_7857: bitstring) = m1_7856 in
                                {8852}new Ns_7858: bitstring;
                                {8853}new ST_7859: bitstring;
                                {8854}new TTL_7860: bitstring;
                                {8855}let m2_7861: bitstring = (OpenSecureChannelResponse,Ns_7858,ST_7859,TTL_7860) in
                                {8856}out(c, (m2_7861,sign(h(m2_7861),skSess_7402)));
                                {8857}let Ksrv_7862: bitstring = h((Ns_7858,Nc_7857)) in
                                {8858}out(c, senc(mSrv(pkCli_7851,pkSess_7403),Ksrv_7862))
                        )
                        else
                            {8859}let v_7863: bool = (Disco_5310 = B) in
                            (
                                {8860}if v_7863 then
                                (
                                    {8861}let pkDisco_7864: bitstring = pub(skB) in
                                    {8862}in(c, (=pkCli_7851,em1_7865: bitstring,sigM1_7866: bitstring));
                                    {8863}let m1_7867: bitstring = em1_7865 in
                                    {8864}if (verify(h(m1_7867),sigM1_7866,pkCli_7851) <> true) then
                                        0
                                    else
                                        {8865}let (=OpenSecureChannelRequest,=pkCli_7851,Nc_7868: bitstring) = m1_7867 in
                                        {8866}new Ns_7869: bitstring;
                                        {8867}new ST_7870: bitstring;
                                        {8868}new TTL_7871: bitstring;
                                        {8869}let m2_7872: bitstring = (OpenSecureChannelResponse,Ns_7869,ST_7870,TTL_7871) in
                                        {8870}out(c, (m2_7872,sign(h(m2_7872),skSess_7402)));
                                        {8871}let Ksrv_7873: bitstring = h((Ns_7869,Nc_7868)) in
                                        {8872}out(c, senc(mSrv(pkCli_7851,pkSess_7403),Ksrv_7873))
                                )
                                else
                                    {8873}let v_7874: bool = (Disco_5310 = C) in
                                    (
                                        {8874}if v_7874 then
                                        (
                                            {8875}let pkDisco_7875: bitstring = pub(skC) in
                                            {8876}in(c, (=pkCli_7851,em1_7876: bitstring,sigM1_7877: bitstring));
                                            {8877}let m1_7878: bitstring = em1_7876 in
                                            {8878}if (verify(h(m1_7878),sigM1_7877,pkCli_7851) <> true) then
                                                0
                                            else
                                                {8879}let (=OpenSecureChannelRequest,=pkCli_7851,Nc_7879: bitstring) = m1_7878 in
                                                {8880}new Ns_7880: bitstring;
                                                {8881}new ST_7881: bitstring;
                                                {8882}new TTL_7882: bitstring;
                                                {8883}let m2_7883: bitstring = (OpenSecureChannelResponse,Ns_7880,ST_7881,TTL_7882) in
                                                {8884}out(c, (m2_7883,sign(h(m2_7883),skSess_7402)));
                                                {8885}let Ksrv_7884: bitstring = h((Ns_7880,Nc_7879)) in
                                                {8886}out(c, senc(mSrv(pkCli_7851,pkSess_7403),Ksrv_7884))
                                        )
                                        else
                                            {8887}let pkDisco_7885: bitstring = pub(sk(Disco_5310)) in
                                            {8888}in(c, (=pkCli_7851,em1_7886: bitstring,sigM1_7887: bitstring));
                                            {8889}let m1_7888: bitstring = em1_7886 in
                                            {8890}if (verify(h(m1_7888),sigM1_7887,pkCli_7851) <> true) then
                                                0
                                            else
                                                {8891}let (=OpenSecureChannelRequest,=pkCli_7851,Nc_7889: bitstring) = m1_7888 in
                                                {8892}new Ns_7890: bitstring;
                                                {8893}new ST_7891: bitstring;
                                                {8894}new TTL_7892: bitstring;
                                                {8895}let m2_7893: bitstring = (OpenSecureChannelResponse,Ns_7890,ST_7891,TTL_7892) in
                                                {8896}out(c, (m2_7893,sign(h(m2_7893),skSess_7402)));
                                                {8897}let Ksrv_7894: bitstring = h((Ns_7890,Nc_7889)) in
                                                {8898}out(c, senc(mSrv(pkCli_7851,pkSess_7403),Ksrv_7894))
                                    )
                                    else
                                        {8899}let pkDisco_7895: bitstring = fail-any in
                                        {8900}in(c, (=pkCli_7851,em1_7896: bitstring,sigM1_7897: bitstring));
                                        {8901}let m1_7898: bitstring = em1_7896 in
                                        {8902}if (verify(h(m1_7898),sigM1_7897,pkCli_7851) <> true) then
                                            0
                                        else
                                            {8903}let (=OpenSecureChannelRequest,=pkCli_7851,Nc_7899: bitstring) = m1_7898 in
                                            {8904}new Ns_7900: bitstring;
                                            {8905}new ST_7901: bitstring;
                                            {8906}new TTL_7902: bitstring;
                                            {8907}let m2_7903: bitstring = (OpenSecureChannelResponse,Ns_7900,ST_7901,TTL_7902) in
                                            {8908}out(c, (m2_7903,sign(h(m2_7903),skSess_7402)));
                                            {8909}let Ksrv_7904: bitstring = h((Ns_7900,Nc_7899)) in
                                            {8910}out(c, senc(mSrv(pkCli_7851,pkSess_7403),Ksrv_7904))
                            )
                            else
                                {8911}let pkDisco_7905: bitstring = fail-any in
                                {8912}in(c, (=pkCli_7851,em1_7906: bitstring,sigM1_7907: bitstring));
                                {8913}let m1_7908: bitstring = em1_7906 in
                                {8914}if (verify(h(m1_7908),sigM1_7907,pkCli_7851) <> true) then
                                    0
                                else
                                    {8915}let (=OpenSecureChannelRequest,=pkCli_7851,Nc_7909: bitstring) = m1_7908 in
                                    {8916}new Ns_7910: bitstring;
                                    {8917}new ST_7911: bitstring;
                                    {8918}new TTL_7912: bitstring;
                                    {8919}let m2_7913: bitstring = (OpenSecureChannelResponse,Ns_7910,ST_7911,TTL_7912) in
                                    {8920}out(c, (m2_7913,sign(h(m2_7913),skSess_7402)));
                                    {8921}let Ksrv_7914: bitstring = h((Ns_7910,Nc_7909)) in
                                    {8922}out(c, senc(mSrv(pkCli_7851,pkSess_7403),Ksrv_7914))
                    )
                    else
                        {8923}let pkDisco_7915: bitstring = fail-any in
                        {8924}in(c, (=pkCli_7851,em1_7916: bitstring,sigM1_7917: bitstring));
                        {8925}let m1_7918: bitstring = em1_7916 in
                        {8926}if (verify(h(m1_7918),sigM1_7917,pkCli_7851) <> true) then
                            0
                        else
                            {8927}let (=OpenSecureChannelRequest,=pkCli_7851,Nc_7919: bitstring) = m1_7918 in
                            {8928}new Ns_7920: bitstring;
                            {8929}new ST_7921: bitstring;
                            {8930}new TTL_7922: bitstring;
                            {8931}let m2_7923: bitstring = (OpenSecureChannelResponse,Ns_7920,ST_7921,TTL_7922) in
                            {8932}out(c, (m2_7923,sign(h(m2_7923),skSess_7402)));
                            {8933}let Ksrv_7924: bitstring = h((Ns_7920,Nc_7919)) in
                            {8934}out(c, senc(mSrv(pkCli_7851,pkSess_7403),Ksrv_7924))
    )
    else
        {8935}let skSess_7925: bitstring = fail-any in
        {8936}let pkSess_7926: bitstring = pub(skSess_7925) in
        {8937}let v_7927: bool = (Cli_5309 = A) in
        (
            {8938}if v_7927 then
            (
                {8939}let pkCli_7928: bitstring = pub(skA) in
                {8940}let v_7929: bool = (Disco_5310 = A) in
                (
                    {8941}if v_7929 then
                    (
                        {8942}let pkDisco_7930: bitstring = pub(skA) in
                        {8943}in(c, (=pkCli_7928,em1_7931: bitstring,sigM1_7932: bitstring));
                        {8944}let m1_7933: bitstring = em1_7931 in
                        {8945}if (verify(h(m1_7933),sigM1_7932,pkCli_7928) <> true) then
                            0
                        else
                            {8946}let (=OpenSecureChannelRequest,=pkCli_7928,Nc_7934: bitstring) = m1_7933 in
                            {8947}new Ns_7935: bitstring;
                            {8948}new ST_7936: bitstring;
                            {8949}new TTL_7937: bitstring;
                            {8950}let m2_7938: bitstring = (OpenSecureChannelResponse,Ns_7935,ST_7936,TTL_7937) in
                            {8951}out(c, (m2_7938,sign(h(m2_7938),skSess_7925)));
                            {8952}let Ksrv_7939: bitstring = h((Ns_7935,Nc_7934)) in
                            {8953}out(c, senc(mSrv(pkCli_7928,pkSess_7926),Ksrv_7939))
                    )
                    else
                        {8954}let v_7940: bool = (Disco_5310 = B) in
                        (
                            {8955}if v_7940 then
                            (
                                {8956}let pkDisco_7941: bitstring = pub(skB) in
                                {8957}in(c, (=pkCli_7928,em1_7942: bitstring,sigM1_7943: bitstring));
                                {8958}let m1_7944: bitstring = em1_7942 in
                                {8959}if (verify(h(m1_7944),sigM1_7943,pkCli_7928) <> true) then
                                    0
                                else
                                    {8960}let (=OpenSecureChannelRequest,=pkCli_7928,Nc_7945: bitstring) = m1_7944 in
                                    {8961}new Ns_7946: bitstring;
                                    {8962}new ST_7947: bitstring;
                                    {8963}new TTL_7948: bitstring;
                                    {8964}let m2_7949: bitstring = (OpenSecureChannelResponse,Ns_7946,ST_7947,TTL_7948) in
                                    {8965}out(c, (m2_7949,sign(h(m2_7949),skSess_7925)));
                                    {8966}let Ksrv_7950: bitstring = h((Ns_7946,Nc_7945)) in
                                    {8967}out(c, senc(mSrv(pkCli_7928,pkSess_7926),Ksrv_7950))
                            )
                            else
                                {8968}let v_7951: bool = (Disco_5310 = C) in
                                (
                                    {8969}if v_7951 then
                                    (
                                        {8970}let pkDisco_7952: bitstring = pub(skC) in
                                        {8971}in(c, (=pkCli_7928,em1_7953: bitstring,sigM1_7954: bitstring));
                                        {8972}let m1_7955: bitstring = em1_7953 in
                                        {8973}if (verify(h(m1_7955),sigM1_7954,pkCli_7928) <> true) then
                                            0
                                        else
                                            {8974}let (=OpenSecureChannelRequest,=pkCli_7928,Nc_7956: bitstring) = m1_7955 in
                                            {8975}new Ns_7957: bitstring;
                                            {8976}new ST_7958: bitstring;
                                            {8977}new TTL_7959: bitstring;
                                            {8978}let m2_7960: bitstring = (OpenSecureChannelResponse,Ns_7957,ST_7958,TTL_7959) in
                                            {8979}out(c, (m2_7960,sign(h(m2_7960),skSess_7925)));
                                            {8980}let Ksrv_7961: bitstring = h((Ns_7957,Nc_7956)) in
                                            {8981}out(c, senc(mSrv(pkCli_7928,pkSess_7926),Ksrv_7961))
                                    )
                                    else
                                        {8982}let pkDisco_7962: bitstring = pub(sk(Disco_5310)) in
                                        {8983}in(c, (=pkCli_7928,em1_7963: bitstring,sigM1_7964: bitstring));
                                        {8984}let m1_7965: bitstring = em1_7963 in
                                        {8985}if (verify(h(m1_7965),sigM1_7964,pkCli_7928) <> true) then
                                            0
                                        else
                                            {8986}let (=OpenSecureChannelRequest,=pkCli_7928,Nc_7966: bitstring) = m1_7965 in
                                            {8987}new Ns_7967: bitstring;
                                            {8988}new ST_7968: bitstring;
                                            {8989}new TTL_7969: bitstring;
                                            {8990}let m2_7970: bitstring = (OpenSecureChannelResponse,Ns_7967,ST_7968,TTL_7969) in
                                            {8991}out(c, (m2_7970,sign(h(m2_7970),skSess_7925)));
                                            {8992}let Ksrv_7971: bitstring = h((Ns_7967,Nc_7966)) in
                                            {8993}out(c, senc(mSrv(pkCli_7928,pkSess_7926),Ksrv_7971))
                                )
                                else
                                    {8994}let pkDisco_7972: bitstring = fail-any in
                                    {8995}in(c, (=pkCli_7928,em1_7973: bitstring,sigM1_7974: bitstring));
                                    {8996}let m1_7975: bitstring = em1_7973 in
                                    {8997}if (verify(h(m1_7975),sigM1_7974,pkCli_7928) <> true) then
                                        0
                                    else
                                        {8998}let (=OpenSecureChannelRequest,=pkCli_7928,Nc_7976: bitstring) = m1_7975 in
                                        {8999}new Ns_7977: bitstring;
                                        {9000}new ST_7978: bitstring;
                                        {9001}new TTL_7979: bitstring;
                                        {9002}let m2_7980: bitstring = (OpenSecureChannelResponse,Ns_7977,ST_7978,TTL_7979) in
                                        {9003}out(c, (m2_7980,sign(h(m2_7980),skSess_7925)));
                                        {9004}let Ksrv_7981: bitstring = h((Ns_7977,Nc_7976)) in
                                        {9005}out(c, senc(mSrv(pkCli_7928,pkSess_7926),Ksrv_7981))
                        )
                        else
                            {9006}let pkDisco_7982: bitstring = fail-any in
                            {9007}in(c, (=pkCli_7928,em1_7983: bitstring,sigM1_7984: bitstring));
                            {9008}let m1_7985: bitstring = em1_7983 in
                            {9009}if (verify(h(m1_7985),sigM1_7984,pkCli_7928) <> true) then
                                0
                            else
                                {9010}let (=OpenSecureChannelRequest,=pkCli_7928,Nc_7986: bitstring) = m1_7985 in
                                {9011}new Ns_7987: bitstring;
                                {9012}new ST_7988: bitstring;
                                {9013}new TTL_7989: bitstring;
                                {9014}let m2_7990: bitstring = (OpenSecureChannelResponse,Ns_7987,ST_7988,TTL_7989) in
                                {9015}out(c, (m2_7990,sign(h(m2_7990),skSess_7925)));
                                {9016}let Ksrv_7991: bitstring = h((Ns_7987,Nc_7986)) in
                                {9017}out(c, senc(mSrv(pkCli_7928,pkSess_7926),Ksrv_7991))
                )
                else
                    {9018}let pkDisco_7992: bitstring = fail-any in
                    {9019}in(c, (=pkCli_7928,em1_7993: bitstring,sigM1_7994: bitstring));
                    {9020}let m1_7995: bitstring = em1_7993 in
                    {9021}if (verify(h(m1_7995),sigM1_7994,pkCli_7928) <> true) then
                        0
                    else
                        {9022}let (=OpenSecureChannelRequest,=pkCli_7928,Nc_7996: bitstring) = m1_7995 in
                        {9023}new Ns_7997: bitstring;
                        {9024}new ST_7998: bitstring;
                        {9025}new TTL_7999: bitstring;
                        {9026}let m2_8000: bitstring = (OpenSecureChannelResponse,Ns_7997,ST_7998,TTL_7999) in
                        {9027}out(c, (m2_8000,sign(h(m2_8000),skSess_7925)));
                        {9028}let Ksrv_8001: bitstring = h((Ns_7997,Nc_7996)) in
                        {9029}out(c, senc(mSrv(pkCli_7928,pkSess_7926),Ksrv_8001))
            )
            else
                {9030}let v_8002: bool = (Cli_5309 = B) in
                (
                    {9031}if v_8002 then
                    (
                        {9032}let pkCli_8003: bitstring = pub(skB) in
                        {9033}let v_8004: bool = (Disco_5310 = A) in
                        (
                            {9034}if v_8004 then
                            (
                                {9035}let pkDisco_8005: bitstring = pub(skA) in
                                {9036}in(c, (=pkCli_8003,em1_8006: bitstring,sigM1_8007: bitstring));
                                {9037}let m1_8008: bitstring = em1_8006 in
                                {9038}if (verify(h(m1_8008),sigM1_8007,pkCli_8003) <> true) then
                                    0
                                else
                                    {9039}let (=OpenSecureChannelRequest,=pkCli_8003,Nc_8009: bitstring) = m1_8008 in
                                    {9040}new Ns_8010: bitstring;
                                    {9041}new ST_8011: bitstring;
                                    {9042}new TTL_8012: bitstring;
                                    {9043}let m2_8013: bitstring = (OpenSecureChannelResponse,Ns_8010,ST_8011,TTL_8012) in
                                    {9044}out(c, (m2_8013,sign(h(m2_8013),skSess_7925)));
                                    {9045}let Ksrv_8014: bitstring = h((Ns_8010,Nc_8009)) in
                                    {9046}out(c, senc(mSrv(pkCli_8003,pkSess_7926),Ksrv_8014))
                            )
                            else
                                {9047}let v_8015: bool = (Disco_5310 = B) in
                                (
                                    {9048}if v_8015 then
                                    (
                                        {9049}let pkDisco_8016: bitstring = pub(skB) in
                                        {9050}in(c, (=pkCli_8003,em1_8017: bitstring,sigM1_8018: bitstring));
                                        {9051}let m1_8019: bitstring = em1_8017 in
                                        {9052}if (verify(h(m1_8019),sigM1_8018,pkCli_8003) <> true) then
                                            0
                                        else
                                            {9053}let (=OpenSecureChannelRequest,=pkCli_8003,Nc_8020: bitstring) = m1_8019 in
                                            {9054}new Ns_8021: bitstring;
                                            {9055}new ST_8022: bitstring;
                                            {9056}new TTL_8023: bitstring;
                                            {9057}let m2_8024: bitstring = (OpenSecureChannelResponse,Ns_8021,ST_8022,TTL_8023) in
                                            {9058}out(c, (m2_8024,sign(h(m2_8024),skSess_7925)));
                                            {9059}let Ksrv_8025: bitstring = h((Ns_8021,Nc_8020)) in
                                            {9060}out(c, senc(mSrv(pkCli_8003,pkSess_7926),Ksrv_8025))
                                    )
                                    else
                                        {9061}let v_8026: bool = (Disco_5310 = C) in
                                        (
                                            {9062}if v_8026 then
                                            (
                                                {9063}let pkDisco_8027: bitstring = pub(skC) in
                                                {9064}in(c, (=pkCli_8003,em1_8028: bitstring,sigM1_8029: bitstring));
                                                {9065}let m1_8030: bitstring = em1_8028 in
                                                {9066}if (verify(h(m1_8030),sigM1_8029,pkCli_8003) <> true) then
                                                    0
                                                else
                                                    {9067}let (=OpenSecureChannelRequest,=pkCli_8003,Nc_8031: bitstring) = m1_8030 in
                                                    {9068}new Ns_8032: bitstring;
                                                    {9069}new ST_8033: bitstring;
                                                    {9070}new TTL_8034: bitstring;
                                                    {9071}let m2_8035: bitstring = (OpenSecureChannelResponse,Ns_8032,ST_8033,TTL_8034) in
                                                    {9072}out(c, (m2_8035,sign(h(m2_8035),skSess_7925)));
                                                    {9073}let Ksrv_8036: bitstring = h((Ns_8032,Nc_8031)) in
                                                    {9074}out(c, senc(mSrv(pkCli_8003,pkSess_7926),Ksrv_8036))
                                            )
                                            else
                                                {9075}let pkDisco_8037: bitstring = pub(sk(Disco_5310)) in
                                                {9076}in(c, (=pkCli_8003,em1_8038: bitstring,sigM1_8039: bitstring));
                                                {9077}let m1_8040: bitstring = em1_8038 in
                                                {9078}if (verify(h(m1_8040),sigM1_8039,pkCli_8003) <> true) then
                                                    0
                                                else
                                                    {9079}let (=OpenSecureChannelRequest,=pkCli_8003,Nc_8041: bitstring) = m1_8040 in
                                                    {9080}new Ns_8042: bitstring;
                                                    {9081}new ST_8043: bitstring;
                                                    {9082}new TTL_8044: bitstring;
                                                    {9083}let m2_8045: bitstring = (OpenSecureChannelResponse,Ns_8042,ST_8043,TTL_8044) in
                                                    {9084}out(c, (m2_8045,sign(h(m2_8045),skSess_7925)));
                                                    {9085}let Ksrv_8046: bitstring = h((Ns_8042,Nc_8041)) in
                                                    {9086}out(c, senc(mSrv(pkCli_8003,pkSess_7926),Ksrv_8046))
                                        )
                                        else
                                            {9087}let pkDisco_8047: bitstring = fail-any in
                                            {9088}in(c, (=pkCli_8003,em1_8048: bitstring,sigM1_8049: bitstring));
                                            {9089}let m1_8050: bitstring = em1_8048 in
                                            {9090}if (verify(h(m1_8050),sigM1_8049,pkCli_8003) <> true) then
                                                0
                                            else
                                                {9091}let (=OpenSecureChannelRequest,=pkCli_8003,Nc_8051: bitstring) = m1_8050 in
                                                {9092}new Ns_8052: bitstring;
                                                {9093}new ST_8053: bitstring;
                                                {9094}new TTL_8054: bitstring;
                                                {9095}let m2_8055: bitstring = (OpenSecureChannelResponse,Ns_8052,ST_8053,TTL_8054) in
                                                {9096}out(c, (m2_8055,sign(h(m2_8055),skSess_7925)));
                                                {9097}let Ksrv_8056: bitstring = h((Ns_8052,Nc_8051)) in
                                                {9098}out(c, senc(mSrv(pkCli_8003,pkSess_7926),Ksrv_8056))
                                )
                                else
                                    {9099}let pkDisco_8057: bitstring = fail-any in
                                    {9100}in(c, (=pkCli_8003,em1_8058: bitstring,sigM1_8059: bitstring));
                                    {9101}let m1_8060: bitstring = em1_8058 in
                                    {9102}if (verify(h(m1_8060),sigM1_8059,pkCli_8003) <> true) then
                                        0
                                    else
                                        {9103}let (=OpenSecureChannelRequest,=pkCli_8003,Nc_8061: bitstring) = m1_8060 in
                                        {9104}new Ns_8062: bitstring;
                                        {9105}new ST_8063: bitstring;
                                        {9106}new TTL_8064: bitstring;
                                        {9107}let m2_8065: bitstring = (OpenSecureChannelResponse,Ns_8062,ST_8063,TTL_8064) in
                                        {9108}out(c, (m2_8065,sign(h(m2_8065),skSess_7925)));
                                        {9109}let Ksrv_8066: bitstring = h((Ns_8062,Nc_8061)) in
                                        {9110}out(c, senc(mSrv(pkCli_8003,pkSess_7926),Ksrv_8066))
                        )
                        else
                            {9111}let pkDisco_8067: bitstring = fail-any in
                            {9112}in(c, (=pkCli_8003,em1_8068: bitstring,sigM1_8069: bitstring));
                            {9113}let m1_8070: bitstring = em1_8068 in
                            {9114}if (verify(h(m1_8070),sigM1_8069,pkCli_8003) <> true) then
                                0
                            else
                                {9115}let (=OpenSecureChannelRequest,=pkCli_8003,Nc_8071: bitstring) = m1_8070 in
                                {9116}new Ns_8072: bitstring;
                                {9117}new ST_8073: bitstring;
                                {9118}new TTL_8074: bitstring;
                                {9119}let m2_8075: bitstring = (OpenSecureChannelResponse,Ns_8072,ST_8073,TTL_8074) in
                                {9120}out(c, (m2_8075,sign(h(m2_8075),skSess_7925)));
                                {9121}let Ksrv_8076: bitstring = h((Ns_8072,Nc_8071)) in
                                {9122}out(c, senc(mSrv(pkCli_8003,pkSess_7926),Ksrv_8076))
                    )
                    else
                        {9123}let v_8077: bool = (Cli_5309 = C) in
                        (
                            {9124}if v_8077 then
                            (
                                {9125}let pkCli_8078: bitstring = pub(skC) in
                                {9126}let v_8079: bool = (Disco_5310 = A) in
                                (
                                    {9127}if v_8079 then
                                    (
                                        {9128}let pkDisco_8080: bitstring = pub(skA) in
                                        {9129}in(c, (=pkCli_8078,em1_8081: bitstring,sigM1_8082: bitstring));
                                        {9130}let m1_8083: bitstring = em1_8081 in
                                        {9131}if (verify(h(m1_8083),sigM1_8082,pkCli_8078) <> true) then
                                            0
                                        else
                                            {9132}let (=OpenSecureChannelRequest,=pkCli_8078,Nc_8084: bitstring) = m1_8083 in
                                            {9133}new Ns_8085: bitstring;
                                            {9134}new ST_8086: bitstring;
                                            {9135}new TTL_8087: bitstring;
                                            {9136}let m2_8088: bitstring = (OpenSecureChannelResponse,Ns_8085,ST_8086,TTL_8087) in
                                            {9137}out(c, (m2_8088,sign(h(m2_8088),skSess_7925)));
                                            {9138}let Ksrv_8089: bitstring = h((Ns_8085,Nc_8084)) in
                                            {9139}out(c, senc(mSrv(pkCli_8078,pkSess_7926),Ksrv_8089))
                                    )
                                    else
                                        {9140}let v_8090: bool = (Disco_5310 = B) in
                                        (
                                            {9141}if v_8090 then
                                            (
                                                {9142}let pkDisco_8091: bitstring = pub(skB) in
                                                {9143}in(c, (=pkCli_8078,em1_8092: bitstring,sigM1_8093: bitstring));
                                                {9144}let m1_8094: bitstring = em1_8092 in
                                                {9145}if (verify(h(m1_8094),sigM1_8093,pkCli_8078) <> true) then
                                                    0
                                                else
                                                    {9146}let (=OpenSecureChannelRequest,=pkCli_8078,Nc_8095: bitstring) = m1_8094 in
                                                    {9147}new Ns_8096: bitstring;
                                                    {9148}new ST_8097: bitstring;
                                                    {9149}new TTL_8098: bitstring;
                                                    {9150}let m2_8099: bitstring = (OpenSecureChannelResponse,Ns_8096,ST_8097,TTL_8098) in
                                                    {9151}out(c, (m2_8099,sign(h(m2_8099),skSess_7925)));
                                                    {9152}let Ksrv_8100: bitstring = h((Ns_8096,Nc_8095)) in
                                                    {9153}out(c, senc(mSrv(pkCli_8078,pkSess_7926),Ksrv_8100))
                                            )
                                            else
                                                {9154}let v_8101: bool = (Disco_5310 = C) in
                                                (
                                                    {9155}if v_8101 then
                                                    (
                                                        {9156}let pkDisco_8102: bitstring = pub(skC) in
                                                        {9157}in(c, (=pkCli_8078,em1_8103: bitstring,sigM1_8104: bitstring));
                                                        {9158}let m1_8105: bitstring = em1_8103 in
                                                        {9159}if (verify(h(m1_8105),sigM1_8104,pkCli_8078) <> true) then
                                                            0
                                                        else
                                                            {9160}let (=OpenSecureChannelRequest,=pkCli_8078,Nc_8106: bitstring) = m1_8105 in
                                                            {9161}new Ns_8107: bitstring;
                                                            {9162}new ST_8108: bitstring;
                                                            {9163}new TTL_8109: bitstring;
                                                            {9164}let m2_8110: bitstring = (OpenSecureChannelResponse,Ns_8107,ST_8108,TTL_8109) in
                                                            {9165}out(c, (m2_8110,sign(h(m2_8110),skSess_7925)));
                                                            {9166}let Ksrv_8111: bitstring = h((Ns_8107,Nc_8106)) in
                                                            {9167}out(c, senc(mSrv(pkCli_8078,pkSess_7926),Ksrv_8111))
                                                    )
                                                    else
                                                        {9168}let pkDisco_8112: bitstring = pub(sk(Disco_5310)) in
                                                        {9169}in(c, (=pkCli_8078,em1_8113: bitstring,sigM1_8114: bitstring));
                                                        {9170}let m1_8115: bitstring = em1_8113 in
                                                        {9171}if (verify(h(m1_8115),sigM1_8114,pkCli_8078) <> true) then
                                                            0
                                                        else
                                                            {9172}let (=OpenSecureChannelRequest,=pkCli_8078,Nc_8116: bitstring) = m1_8115 in
                                                            {9173}new Ns_8117: bitstring;
                                                            {9174}new ST_8118: bitstring;
                                                            {9175}new TTL_8119: bitstring;
                                                            {9176}let m2_8120: bitstring = (OpenSecureChannelResponse,Ns_8117,ST_8118,TTL_8119) in
                                                            {9177}out(c, (m2_8120,sign(h(m2_8120),skSess_7925)));
                                                            {9178}let Ksrv_8121: bitstring = h((Ns_8117,Nc_8116)) in
                                                            {9179}out(c, senc(mSrv(pkCli_8078,pkSess_7926),Ksrv_8121))
                                                )
                                                else
                                                    {9180}let pkDisco_8122: bitstring = fail-any in
                                                    {9181}in(c, (=pkCli_8078,em1_8123: bitstring,sigM1_8124: bitstring));
                                                    {9182}let m1_8125: bitstring = em1_8123 in
                                                    {9183}if (verify(h(m1_8125),sigM1_8124,pkCli_8078) <> true) then
                                                        0
                                                    else
                                                        {9184}let (=OpenSecureChannelRequest,=pkCli_8078,Nc_8126: bitstring) = m1_8125 in
                                                        {9185}new Ns_8127: bitstring;
                                                        {9186}new ST_8128: bitstring;
                                                        {9187}new TTL_8129: bitstring;
                                                        {9188}let m2_8130: bitstring = (OpenSecureChannelResponse,Ns_8127,ST_8128,TTL_8129) in
                                                        {9189}out(c, (m2_8130,sign(h(m2_8130),skSess_7925)));
                                                        {9190}let Ksrv_8131: bitstring = h((Ns_8127,Nc_8126)) in
                                                        {9191}out(c, senc(mSrv(pkCli_8078,pkSess_7926),Ksrv_8131))
                                        )
                                        else
                                            {9192}let pkDisco_8132: bitstring = fail-any in
                                            {9193}in(c, (=pkCli_8078,em1_8133: bitstring,sigM1_8134: bitstring));
                                            {9194}let m1_8135: bitstring = em1_8133 in
                                            {9195}if (verify(h(m1_8135),sigM1_8134,pkCli_8078) <> true) then
                                                0
                                            else
                                                {9196}let (=OpenSecureChannelRequest,=pkCli_8078,Nc_8136: bitstring) = m1_8135 in
                                                {9197}new Ns_8137: bitstring;
                                                {9198}new ST_8138: bitstring;
                                                {9199}new TTL_8139: bitstring;
                                                {9200}let m2_8140: bitstring = (OpenSecureChannelResponse,Ns_8137,ST_8138,TTL_8139) in
                                                {9201}out(c, (m2_8140,sign(h(m2_8140),skSess_7925)));
                                                {9202}let Ksrv_8141: bitstring = h((Ns_8137,Nc_8136)) in
                                                {9203}out(c, senc(mSrv(pkCli_8078,pkSess_7926),Ksrv_8141))
                                )
                                else
                                    {9204}let pkDisco_8142: bitstring = fail-any in
                                    {9205}in(c, (=pkCli_8078,em1_8143: bitstring,sigM1_8144: bitstring));
                                    {9206}let m1_8145: bitstring = em1_8143 in
                                    {9207}if (verify(h(m1_8145),sigM1_8144,pkCli_8078) <> true) then
                                        0
                                    else
                                        {9208}let (=OpenSecureChannelRequest,=pkCli_8078,Nc_8146: bitstring) = m1_8145 in
                                        {9209}new Ns_8147: bitstring;
                                        {9210}new ST_8148: bitstring;
                                        {9211}new TTL_8149: bitstring;
                                        {9212}let m2_8150: bitstring = (OpenSecureChannelResponse,Ns_8147,ST_8148,TTL_8149) in
                                        {9213}out(c, (m2_8150,sign(h(m2_8150),skSess_7925)));
                                        {9214}let Ksrv_8151: bitstring = h((Ns_8147,Nc_8146)) in
                                        {9215}out(c, senc(mSrv(pkCli_8078,pkSess_7926),Ksrv_8151))
                            )
                            else
                                {9216}let pkCli_8152: bitstring = pub(sk(Cli_5309)) in
                                {9217}let v_8153: bool = (Disco_5310 = A) in
                                (
                                    {9218}if v_8153 then
                                    (
                                        {9219}let pkDisco_8154: bitstring = pub(skA) in
                                        {9220}in(c, (=pkCli_8152,em1_8155: bitstring,sigM1_8156: bitstring));
                                        {9221}let m1_8157: bitstring = em1_8155 in
                                        {9222}if (verify(h(m1_8157),sigM1_8156,pkCli_8152) <> true) then
                                            0
                                        else
                                            {9223}let (=OpenSecureChannelRequest,=pkCli_8152,Nc_8158: bitstring) = m1_8157 in
                                            {9224}new Ns_8159: bitstring;
                                            {9225}new ST_8160: bitstring;
                                            {9226}new TTL_8161: bitstring;
                                            {9227}let m2_8162: bitstring = (OpenSecureChannelResponse,Ns_8159,ST_8160,TTL_8161) in
                                            {9228}out(c, (m2_8162,sign(h(m2_8162),skSess_7925)));
                                            {9229}let Ksrv_8163: bitstring = h((Ns_8159,Nc_8158)) in
                                            {9230}out(c, senc(mSrv(pkCli_8152,pkSess_7926),Ksrv_8163))
                                    )
                                    else
                                        {9231}let v_8164: bool = (Disco_5310 = B) in
                                        (
                                            {9232}if v_8164 then
                                            (
                                                {9233}let pkDisco_8165: bitstring = pub(skB) in
                                                {9234}in(c, (=pkCli_8152,em1_8166: bitstring,sigM1_8167: bitstring));
                                                {9235}let m1_8168: bitstring = em1_8166 in
                                                {9236}if (verify(h(m1_8168),sigM1_8167,pkCli_8152) <> true) then
                                                    0
                                                else
                                                    {9237}let (=OpenSecureChannelRequest,=pkCli_8152,Nc_8169: bitstring) = m1_8168 in
                                                    {9238}new Ns_8170: bitstring;
                                                    {9239}new ST_8171: bitstring;
                                                    {9240}new TTL_8172: bitstring;
                                                    {9241}let m2_8173: bitstring = (OpenSecureChannelResponse,Ns_8170,ST_8171,TTL_8172) in
                                                    {9242}out(c, (m2_8173,sign(h(m2_8173),skSess_7925)));
                                                    {9243}let Ksrv_8174: bitstring = h((Ns_8170,Nc_8169)) in
                                                    {9244}out(c, senc(mSrv(pkCli_8152,pkSess_7926),Ksrv_8174))
                                            )
                                            else
                                                {9245}let v_8175: bool = (Disco_5310 = C) in
                                                (
                                                    {9246}if v_8175 then
                                                    (
                                                        {9247}let pkDisco_8176: bitstring = pub(skC) in
                                                        {9248}in(c, (=pkCli_8152,em1_8177: bitstring,sigM1_8178: bitstring));
                                                        {9249}let m1_8179: bitstring = em1_8177 in
                                                        {9250}if (verify(h(m1_8179),sigM1_8178,pkCli_8152) <> true) then
                                                            0
                                                        else
                                                            {9251}let (=OpenSecureChannelRequest,=pkCli_8152,Nc_8180: bitstring) = m1_8179 in
                                                            {9252}new Ns_8181: bitstring;
                                                            {9253}new ST_8182: bitstring;
                                                            {9254}new TTL_8183: bitstring;
                                                            {9255}let m2_8184: bitstring = (OpenSecureChannelResponse,Ns_8181,ST_8182,TTL_8183) in
                                                            {9256}out(c, (m2_8184,sign(h(m2_8184),skSess_7925)));
                                                            {9257}let Ksrv_8185: bitstring = h((Ns_8181,Nc_8180)) in
                                                            {9258}out(c, senc(mSrv(pkCli_8152,pkSess_7926),Ksrv_8185))
                                                    )
                                                    else
                                                        {9259}let pkDisco_8186: bitstring = pub(sk(Disco_5310)) in
                                                        {9260}in(c, (=pkCli_8152,em1_8187: bitstring,sigM1_8188: bitstring));
                                                        {9261}let m1_8189: bitstring = em1_8187 in
                                                        {9262}if (verify(h(m1_8189),sigM1_8188,pkCli_8152) <> true) then
                                                            0
                                                        else
                                                            {9263}let (=OpenSecureChannelRequest,=pkCli_8152,Nc_8190: bitstring) = m1_8189 in
                                                            {9264}new Ns_8191: bitstring;
                                                            {9265}new ST_8192: bitstring;
                                                            {9266}new TTL_8193: bitstring;
                                                            {9267}let m2_8194: bitstring = (OpenSecureChannelResponse,Ns_8191,ST_8192,TTL_8193) in
                                                            {9268}out(c, (m2_8194,sign(h(m2_8194),skSess_7925)));
                                                            {9269}let Ksrv_8195: bitstring = h((Ns_8191,Nc_8190)) in
                                                            {9270}out(c, senc(mSrv(pkCli_8152,pkSess_7926),Ksrv_8195))
                                                )
                                                else
                                                    {9271}let pkDisco_8196: bitstring = fail-any in
                                                    {9272}in(c, (=pkCli_8152,em1_8197: bitstring,sigM1_8198: bitstring));
                                                    {9273}let m1_8199: bitstring = em1_8197 in
                                                    {9274}if (verify(h(m1_8199),sigM1_8198,pkCli_8152) <> true) then
                                                        0
                                                    else
                                                        {9275}let (=OpenSecureChannelRequest,=pkCli_8152,Nc_8200: bitstring) = m1_8199 in
                                                        {9276}new Ns_8201: bitstring;
                                                        {9277}new ST_8202: bitstring;
                                                        {9278}new TTL_8203: bitstring;
                                                        {9279}let m2_8204: bitstring = (OpenSecureChannelResponse,Ns_8201,ST_8202,TTL_8203) in
                                                        {9280}out(c, (m2_8204,sign(h(m2_8204),skSess_7925)));
                                                        {9281}let Ksrv_8205: bitstring = h((Ns_8201,Nc_8200)) in
                                                        {9282}out(c, senc(mSrv(pkCli_8152,pkSess_7926),Ksrv_8205))
                                        )
                                        else
                                            {9283}let pkDisco_8206: bitstring = fail-any in
                                            {9284}in(c, (=pkCli_8152,em1_8207: bitstring,sigM1_8208: bitstring));
                                            {9285}let m1_8209: bitstring = em1_8207 in
                                            {9286}if (verify(h(m1_8209),sigM1_8208,pkCli_8152) <> true) then
                                                0
                                            else
                                                {9287}let (=OpenSecureChannelRequest,=pkCli_8152,Nc_8210: bitstring) = m1_8209 in
                                                {9288}new Ns_8211: bitstring;
                                                {9289}new ST_8212: bitstring;
                                                {9290}new TTL_8213: bitstring;
                                                {9291}let m2_8214: bitstring = (OpenSecureChannelResponse,Ns_8211,ST_8212,TTL_8213) in
                                                {9292}out(c, (m2_8214,sign(h(m2_8214),skSess_7925)));
                                                {9293}let Ksrv_8215: bitstring = h((Ns_8211,Nc_8210)) in
                                                {9294}out(c, senc(mSrv(pkCli_8152,pkSess_7926),Ksrv_8215))
                                )
                                else
                                    {9295}let pkDisco_8216: bitstring = fail-any in
                                    {9296}in(c, (=pkCli_8152,em1_8217: bitstring,sigM1_8218: bitstring));
                                    {9297}let m1_8219: bitstring = em1_8217 in
                                    {9298}if (verify(h(m1_8219),sigM1_8218,pkCli_8152) <> true) then
                                        0
                                    else
                                        {9299}let (=OpenSecureChannelRequest,=pkCli_8152,Nc_8220: bitstring) = m1_8219 in
                                        {9300}new Ns_8221: bitstring;
                                        {9301}new ST_8222: bitstring;
                                        {9302}new TTL_8223: bitstring;
                                        {9303}let m2_8224: bitstring = (OpenSecureChannelResponse,Ns_8221,ST_8222,TTL_8223) in
                                        {9304}out(c, (m2_8224,sign(h(m2_8224),skSess_7925)));
                                        {9305}let Ksrv_8225: bitstring = h((Ns_8221,Nc_8220)) in
                                        {9306}out(c, senc(mSrv(pkCli_8152,pkSess_7926),Ksrv_8225))
                        )
                        else
                            {9307}let pkCli_8226: bitstring = fail-any in
                            {9308}let v_8227: bool = (Disco_5310 = A) in
                            (
                                {9309}if v_8227 then
                                (
                                    {9310}let pkDisco_8228: bitstring = pub(skA) in
                                    {9311}in(c, (=pkCli_8226,em1_8229: bitstring,sigM1_8230: bitstring));
                                    {9312}let m1_8231: bitstring = em1_8229 in
                                    {9313}if (verify(h(m1_8231),sigM1_8230,pkCli_8226) <> true) then
                                        0
                                    else
                                        {9314}let (=OpenSecureChannelRequest,=pkCli_8226,Nc_8232: bitstring) = m1_8231 in
                                        {9315}new Ns_8233: bitstring;
                                        {9316}new ST_8234: bitstring;
                                        {9317}new TTL_8235: bitstring;
                                        {9318}let m2_8236: bitstring = (OpenSecureChannelResponse,Ns_8233,ST_8234,TTL_8235) in
                                        {9319}out(c, (m2_8236,sign(h(m2_8236),skSess_7925)));
                                        {9320}let Ksrv_8237: bitstring = h((Ns_8233,Nc_8232)) in
                                        {9321}out(c, senc(mSrv(pkCli_8226,pkSess_7926),Ksrv_8237))
                                )
                                else
                                    {9322}let v_8238: bool = (Disco_5310 = B) in
                                    (
                                        {9323}if v_8238 then
                                        (
                                            {9324}let pkDisco_8239: bitstring = pub(skB) in
                                            {9325}in(c, (=pkCli_8226,em1_8240: bitstring,sigM1_8241: bitstring));
                                            {9326}let m1_8242: bitstring = em1_8240 in
                                            {9327}if (verify(h(m1_8242),sigM1_8241,pkCli_8226) <> true) then
                                                0
                                            else
                                                {9328}let (=OpenSecureChannelRequest,=pkCli_8226,Nc_8243: bitstring) = m1_8242 in
                                                {9329}new Ns_8244: bitstring;
                                                {9330}new ST_8245: bitstring;
                                                {9331}new TTL_8246: bitstring;
                                                {9332}let m2_8247: bitstring = (OpenSecureChannelResponse,Ns_8244,ST_8245,TTL_8246) in
                                                {9333}out(c, (m2_8247,sign(h(m2_8247),skSess_7925)));
                                                {9334}let Ksrv_8248: bitstring = h((Ns_8244,Nc_8243)) in
                                                {9335}out(c, senc(mSrv(pkCli_8226,pkSess_7926),Ksrv_8248))
                                        )
                                        else
                                            {9336}let v_8249: bool = (Disco_5310 = C) in
                                            (
                                                {9337}if v_8249 then
                                                (
                                                    {9338}let pkDisco_8250: bitstring = pub(skC) in
                                                    {9339}in(c, (=pkCli_8226,em1_8251: bitstring,sigM1_8252: bitstring));
                                                    {9340}let m1_8253: bitstring = em1_8251 in
                                                    {9341}if (verify(h(m1_8253),sigM1_8252,pkCli_8226) <> true) then
                                                        0
                                                    else
                                                        {9342}let (=OpenSecureChannelRequest,=pkCli_8226,Nc_8254: bitstring) = m1_8253 in
                                                        {9343}new Ns_8255: bitstring;
                                                        {9344}new ST_8256: bitstring;
                                                        {9345}new TTL_8257: bitstring;
                                                        {9346}let m2_8258: bitstring = (OpenSecureChannelResponse,Ns_8255,ST_8256,TTL_8257) in
                                                        {9347}out(c, (m2_8258,sign(h(m2_8258),skSess_7925)));
                                                        {9348}let Ksrv_8259: bitstring = h((Ns_8255,Nc_8254)) in
                                                        {9349}out(c, senc(mSrv(pkCli_8226,pkSess_7926),Ksrv_8259))
                                                )
                                                else
                                                    {9350}let pkDisco_8260: bitstring = pub(sk(Disco_5310)) in
                                                    {9351}in(c, (=pkCli_8226,em1_8261: bitstring,sigM1_8262: bitstring));
                                                    {9352}let m1_8263: bitstring = em1_8261 in
                                                    {9353}if (verify(h(m1_8263),sigM1_8262,pkCli_8226) <> true) then
                                                        0
                                                    else
                                                        {9354}let (=OpenSecureChannelRequest,=pkCli_8226,Nc_8264: bitstring) = m1_8263 in
                                                        {9355}new Ns_8265: bitstring;
                                                        {9356}new ST_8266: bitstring;
                                                        {9357}new TTL_8267: bitstring;
                                                        {9358}let m2_8268: bitstring = (OpenSecureChannelResponse,Ns_8265,ST_8266,TTL_8267) in
                                                        {9359}out(c, (m2_8268,sign(h(m2_8268),skSess_7925)));
                                                        {9360}let Ksrv_8269: bitstring = h((Ns_8265,Nc_8264)) in
                                                        {9361}out(c, senc(mSrv(pkCli_8226,pkSess_7926),Ksrv_8269))
                                            )
                                            else
                                                {9362}let pkDisco_8270: bitstring = fail-any in
                                                {9363}in(c, (=pkCli_8226,em1_8271: bitstring,sigM1_8272: bitstring));
                                                {9364}let m1_8273: bitstring = em1_8271 in
                                                {9365}if (verify(h(m1_8273),sigM1_8272,pkCli_8226) <> true) then
                                                    0
                                                else
                                                    {9366}let (=OpenSecureChannelRequest,=pkCli_8226,Nc_8274: bitstring) = m1_8273 in
                                                    {9367}new Ns_8275: bitstring;
                                                    {9368}new ST_8276: bitstring;
                                                    {9369}new TTL_8277: bitstring;
                                                    {9370}let m2_8278: bitstring = (OpenSecureChannelResponse,Ns_8275,ST_8276,TTL_8277) in
                                                    {9371}out(c, (m2_8278,sign(h(m2_8278),skSess_7925)));
                                                    {9372}let Ksrv_8279: bitstring = h((Ns_8275,Nc_8274)) in
                                                    {9373}out(c, senc(mSrv(pkCli_8226,pkSess_7926),Ksrv_8279))
                                    )
                                    else
                                        {9374}let pkDisco_8280: bitstring = fail-any in
                                        {9375}in(c, (=pkCli_8226,em1_8281: bitstring,sigM1_8282: bitstring));
                                        {9376}let m1_8283: bitstring = em1_8281 in
                                        {9377}if (verify(h(m1_8283),sigM1_8282,pkCli_8226) <> true) then
                                            0
                                        else
                                            {9378}let (=OpenSecureChannelRequest,=pkCli_8226,Nc_8284: bitstring) = m1_8283 in
                                            {9379}new Ns_8285: bitstring;
                                            {9380}new ST_8286: bitstring;
                                            {9381}new TTL_8287: bitstring;
                                            {9382}let m2_8288: bitstring = (OpenSecureChannelResponse,Ns_8285,ST_8286,TTL_8287) in
                                            {9383}out(c, (m2_8288,sign(h(m2_8288),skSess_7925)));
                                            {9384}let Ksrv_8289: bitstring = h((Ns_8285,Nc_8284)) in
                                            {9385}out(c, senc(mSrv(pkCli_8226,pkSess_7926),Ksrv_8289))
                            )
                            else
                                {9386}let pkDisco_8290: bitstring = fail-any in
                                {9387}in(c, (=pkCli_8226,em1_8291: bitstring,sigM1_8292: bitstring));
                                {9388}let m1_8293: bitstring = em1_8291 in
                                {9389}if (verify(h(m1_8293),sigM1_8292,pkCli_8226) <> true) then
                                    0
                                else
                                    {9390}let (=OpenSecureChannelRequest,=pkCli_8226,Nc_8294: bitstring) = m1_8293 in
                                    {9391}new Ns_8295: bitstring;
                                    {9392}new ST_8296: bitstring;
                                    {9393}new TTL_8297: bitstring;
                                    {9394}let m2_8298: bitstring = (OpenSecureChannelResponse,Ns_8295,ST_8296,TTL_8297) in
                                    {9395}out(c, (m2_8298,sign(h(m2_8298),skSess_7925)));
                                    {9396}let Ksrv_8299: bitstring = h((Ns_8295,Nc_8294)) in
                                    {9397}out(c, senc(mSrv(pkCli_8226,pkSess_7926),Ksrv_8299))
                )
                else
                    {9398}let pkCli_8300: bitstring = fail-any in
                    {9399}let v_8301: bool = (Disco_5310 = A) in
                    (
                        {9400}if v_8301 then
                        (
                            {9401}let pkDisco_8302: bitstring = pub(skA) in
                            {9402}in(c, (=pkCli_8300,em1_8303: bitstring,sigM1_8304: bitstring));
                            {9403}let m1_8305: bitstring = em1_8303 in
                            {9404}if (verify(h(m1_8305),sigM1_8304,pkCli_8300) <> true) then
                                0
                            else
                                {9405}let (=OpenSecureChannelRequest,=pkCli_8300,Nc_8306: bitstring) = m1_8305 in
                                {9406}new Ns_8307: bitstring;
                                {9407}new ST_8308: bitstring;
                                {9408}new TTL_8309: bitstring;
                                {9409}let m2_8310: bitstring = (OpenSecureChannelResponse,Ns_8307,ST_8308,TTL_8309) in
                                {9410}out(c, (m2_8310,sign(h(m2_8310),skSess_7925)));
                                {9411}let Ksrv_8311: bitstring = h((Ns_8307,Nc_8306)) in
                                {9412}out(c, senc(mSrv(pkCli_8300,pkSess_7926),Ksrv_8311))
                        )
                        else
                            {9413}let v_8312: bool = (Disco_5310 = B) in
                            (
                                {9414}if v_8312 then
                                (
                                    {9415}let pkDisco_8313: bitstring = pub(skB) in
                                    {9416}in(c, (=pkCli_8300,em1_8314: bitstring,sigM1_8315: bitstring));
                                    {9417}let m1_8316: bitstring = em1_8314 in
                                    {9418}if (verify(h(m1_8316),sigM1_8315,pkCli_8300) <> true) then
                                        0
                                    else
                                        {9419}let (=OpenSecureChannelRequest,=pkCli_8300,Nc_8317: bitstring) = m1_8316 in
                                        {9420}new Ns_8318: bitstring;
                                        {9421}new ST_8319: bitstring;
                                        {9422}new TTL_8320: bitstring;
                                        {9423}let m2_8321: bitstring = (OpenSecureChannelResponse,Ns_8318,ST_8319,TTL_8320) in
                                        {9424}out(c, (m2_8321,sign(h(m2_8321),skSess_7925)));
                                        {9425}let Ksrv_8322: bitstring = h((Ns_8318,Nc_8317)) in
                                        {9426}out(c, senc(mSrv(pkCli_8300,pkSess_7926),Ksrv_8322))
                                )
                                else
                                    {9427}let v_8323: bool = (Disco_5310 = C) in
                                    (
                                        {9428}if v_8323 then
                                        (
                                            {9429}let pkDisco_8324: bitstring = pub(skC) in
                                            {9430}in(c, (=pkCli_8300,em1_8325: bitstring,sigM1_8326: bitstring));
                                            {9431}let m1_8327: bitstring = em1_8325 in
                                            {9432}if (verify(h(m1_8327),sigM1_8326,pkCli_8300) <> true) then
                                                0
                                            else
                                                {9433}let (=OpenSecureChannelRequest,=pkCli_8300,Nc_8328: bitstring) = m1_8327 in
                                                {9434}new Ns_8329: bitstring;
                                                {9435}new ST_8330: bitstring;
                                                {9436}new TTL_8331: bitstring;
                                                {9437}let m2_8332: bitstring = (OpenSecureChannelResponse,Ns_8329,ST_8330,TTL_8331) in
                                                {9438}out(c, (m2_8332,sign(h(m2_8332),skSess_7925)));
                                                {9439}let Ksrv_8333: bitstring = h((Ns_8329,Nc_8328)) in
                                                {9440}out(c, senc(mSrv(pkCli_8300,pkSess_7926),Ksrv_8333))
                                        )
                                        else
                                            {9441}let pkDisco_8334: bitstring = pub(sk(Disco_5310)) in
                                            {9442}in(c, (=pkCli_8300,em1_8335: bitstring,sigM1_8336: bitstring));
                                            {9443}let m1_8337: bitstring = em1_8335 in
                                            {9444}if (verify(h(m1_8337),sigM1_8336,pkCli_8300) <> true) then
                                                0
                                            else
                                                {9445}let (=OpenSecureChannelRequest,=pkCli_8300,Nc_8338: bitstring) = m1_8337 in
                                                {9446}new Ns_8339: bitstring;
                                                {9447}new ST_8340: bitstring;
                                                {9448}new TTL_8341: bitstring;
                                                {9449}let m2_8342: bitstring = (OpenSecureChannelResponse,Ns_8339,ST_8340,TTL_8341) in
                                                {9450}out(c, (m2_8342,sign(h(m2_8342),skSess_7925)));
                                                {9451}let Ksrv_8343: bitstring = h((Ns_8339,Nc_8338)) in
                                                {9452}out(c, senc(mSrv(pkCli_8300,pkSess_7926),Ksrv_8343))
                                    )
                                    else
                                        {9453}let pkDisco_8344: bitstring = fail-any in
                                        {9454}in(c, (=pkCli_8300,em1_8345: bitstring,sigM1_8346: bitstring));
                                        {9455}let m1_8347: bitstring = em1_8345 in
                                        {9456}if (verify(h(m1_8347),sigM1_8346,pkCli_8300) <> true) then
                                            0
                                        else
                                            {9457}let (=OpenSecureChannelRequest,=pkCli_8300,Nc_8348: bitstring) = m1_8347 in
                                            {9458}new Ns_8349: bitstring;
                                            {9459}new ST_8350: bitstring;
                                            {9460}new TTL_8351: bitstring;
                                            {9461}let m2_8352: bitstring = (OpenSecureChannelResponse,Ns_8349,ST_8350,TTL_8351) in
                                            {9462}out(c, (m2_8352,sign(h(m2_8352),skSess_7925)));
                                            {9463}let Ksrv_8353: bitstring = h((Ns_8349,Nc_8348)) in
                                            {9464}out(c, senc(mSrv(pkCli_8300,pkSess_7926),Ksrv_8353))
                            )
                            else
                                {9465}let pkDisco_8354: bitstring = fail-any in
                                {9466}in(c, (=pkCli_8300,em1_8355: bitstring,sigM1_8356: bitstring));
                                {9467}let m1_8357: bitstring = em1_8355 in
                                {9468}if (verify(h(m1_8357),sigM1_8356,pkCli_8300) <> true) then
                                    0
                                else
                                    {9469}let (=OpenSecureChannelRequest,=pkCli_8300,Nc_8358: bitstring) = m1_8357 in
                                    {9470}new Ns_8359: bitstring;
                                    {9471}new ST_8360: bitstring;
                                    {9472}new TTL_8361: bitstring;
                                    {9473}let m2_8362: bitstring = (OpenSecureChannelResponse,Ns_8359,ST_8360,TTL_8361) in
                                    {9474}out(c, (m2_8362,sign(h(m2_8362),skSess_7925)));
                                    {9475}let Ksrv_8363: bitstring = h((Ns_8359,Nc_8358)) in
                                    {9476}out(c, senc(mSrv(pkCli_8300,pkSess_7926),Ksrv_8363))
                    )
                    else
                        {9477}let pkDisco_8364: bitstring = fail-any in
                        {9478}in(c, (=pkCli_8300,em1_8365: bitstring,sigM1_8366: bitstring));
                        {9479}let m1_8367: bitstring = em1_8365 in
                        {9480}if (verify(h(m1_8367),sigM1_8366,pkCli_8300) <> true) then
                            0
                        else
                            {9481}let (=OpenSecureChannelRequest,=pkCli_8300,Nc_8368: bitstring) = m1_8367 in
                            {9482}new Ns_8369: bitstring;
                            {9483}new ST_8370: bitstring;
                            {9484}new TTL_8371: bitstring;
                            {9485}let m2_8372: bitstring = (OpenSecureChannelResponse,Ns_8369,ST_8370,TTL_8371) in
                            {9486}out(c, (m2_8372,sign(h(m2_8372),skSess_7925)));
                            {9487}let Ksrv_8373: bitstring = h((Ns_8369,Nc_8368)) in
                            {9488}out(c, senc(mSrv(pkCli_8300,pkSess_7926),Ksrv_8373))
        )
        else
            {9489}let pkCli_8374: bitstring = fail-any in
            {9490}let v_8375: bool = (Disco_5310 = A) in
            (
                {9491}if v_8375 then
                (
                    {9492}let pkDisco_8376: bitstring = pub(skA) in
                    {9493}in(c, (=pkCli_8374,em1_8377: bitstring,sigM1_8378: bitstring));
                    {9494}let m1_8379: bitstring = em1_8377 in
                    {9495}if (verify(h(m1_8379),sigM1_8378,pkCli_8374) <> true) then
                        0
                    else
                        {9496}let (=OpenSecureChannelRequest,=pkCli_8374,Nc_8380: bitstring) = m1_8379 in
                        {9497}new Ns_8381: bitstring;
                        {9498}new ST_8382: bitstring;
                        {9499}new TTL_8383: bitstring;
                        {9500}let m2_8384: bitstring = (OpenSecureChannelResponse,Ns_8381,ST_8382,TTL_8383) in
                        {9501}out(c, (m2_8384,sign(h(m2_8384),skSess_7925)));
                        {9502}let Ksrv_8385: bitstring = h((Ns_8381,Nc_8380)) in
                        {9503}out(c, senc(mSrv(pkCli_8374,pkSess_7926),Ksrv_8385))
                )
                else
                    {9504}let v_8386: bool = (Disco_5310 = B) in
                    (
                        {9505}if v_8386 then
                        (
                            {9506}let pkDisco_8387: bitstring = pub(skB) in
                            {9507}in(c, (=pkCli_8374,em1_8388: bitstring,sigM1_8389: bitstring));
                            {9508}let m1_8390: bitstring = em1_8388 in
                            {9509}if (verify(h(m1_8390),sigM1_8389,pkCli_8374) <> true) then
                                0
                            else
                                {9510}let (=OpenSecureChannelRequest,=pkCli_8374,Nc_8391: bitstring) = m1_8390 in
                                {9511}new Ns_8392: bitstring;
                                {9512}new ST_8393: bitstring;
                                {9513}new TTL_8394: bitstring;
                                {9514}let m2_8395: bitstring = (OpenSecureChannelResponse,Ns_8392,ST_8393,TTL_8394) in
                                {9515}out(c, (m2_8395,sign(h(m2_8395),skSess_7925)));
                                {9516}let Ksrv_8396: bitstring = h((Ns_8392,Nc_8391)) in
                                {9517}out(c, senc(mSrv(pkCli_8374,pkSess_7926),Ksrv_8396))
                        )
                        else
                            {9518}let v_8397: bool = (Disco_5310 = C) in
                            (
                                {9519}if v_8397 then
                                (
                                    {9520}let pkDisco_8398: bitstring = pub(skC) in
                                    {9521}in(c, (=pkCli_8374,em1_8399: bitstring,sigM1_8400: bitstring));
                                    {9522}let m1_8401: bitstring = em1_8399 in
                                    {9523}if (verify(h(m1_8401),sigM1_8400,pkCli_8374) <> true) then
                                        0
                                    else
                                        {9524}let (=OpenSecureChannelRequest,=pkCli_8374,Nc_8402: bitstring) = m1_8401 in
                                        {9525}new Ns_8403: bitstring;
                                        {9526}new ST_8404: bitstring;
                                        {9527}new TTL_8405: bitstring;
                                        {9528}let m2_8406: bitstring = (OpenSecureChannelResponse,Ns_8403,ST_8404,TTL_8405) in
                                        {9529}out(c, (m2_8406,sign(h(m2_8406),skSess_7925)));
                                        {9530}let Ksrv_8407: bitstring = h((Ns_8403,Nc_8402)) in
                                        {9531}out(c, senc(mSrv(pkCli_8374,pkSess_7926),Ksrv_8407))
                                )
                                else
                                    {9532}let pkDisco_8408: bitstring = pub(sk(Disco_5310)) in
                                    {9533}in(c, (=pkCli_8374,em1_8409: bitstring,sigM1_8410: bitstring));
                                    {9534}let m1_8411: bitstring = em1_8409 in
                                    {9535}if (verify(h(m1_8411),sigM1_8410,pkCli_8374) <> true) then
                                        0
                                    else
                                        {9536}let (=OpenSecureChannelRequest,=pkCli_8374,Nc_8412: bitstring) = m1_8411 in
                                        {9537}new Ns_8413: bitstring;
                                        {9538}new ST_8414: bitstring;
                                        {9539}new TTL_8415: bitstring;
                                        {9540}let m2_8416: bitstring = (OpenSecureChannelResponse,Ns_8413,ST_8414,TTL_8415) in
                                        {9541}out(c, (m2_8416,sign(h(m2_8416),skSess_7925)));
                                        {9542}let Ksrv_8417: bitstring = h((Ns_8413,Nc_8412)) in
                                        {9543}out(c, senc(mSrv(pkCli_8374,pkSess_7926),Ksrv_8417))
                            )
                            else
                                {9544}let pkDisco_8418: bitstring = fail-any in
                                {9545}in(c, (=pkCli_8374,em1_8419: bitstring,sigM1_8420: bitstring));
                                {9546}let m1_8421: bitstring = em1_8419 in
                                {9547}if (verify(h(m1_8421),sigM1_8420,pkCli_8374) <> true) then
                                    0
                                else
                                    {9548}let (=OpenSecureChannelRequest,=pkCli_8374,Nc_8422: bitstring) = m1_8421 in
                                    {9549}new Ns_8423: bitstring;
                                    {9550}new ST_8424: bitstring;
                                    {9551}new TTL_8425: bitstring;
                                    {9552}let m2_8426: bitstring = (OpenSecureChannelResponse,Ns_8423,ST_8424,TTL_8425) in
                                    {9553}out(c, (m2_8426,sign(h(m2_8426),skSess_7925)));
                                    {9554}let Ksrv_8427: bitstring = h((Ns_8423,Nc_8422)) in
                                    {9555}out(c, senc(mSrv(pkCli_8374,pkSess_7926),Ksrv_8427))
                    )
                    else
                        {9556}let pkDisco_8428: bitstring = fail-any in
                        {9557}in(c, (=pkCli_8374,em1_8429: bitstring,sigM1_8430: bitstring));
                        {9558}let m1_8431: bitstring = em1_8429 in
                        {9559}if (verify(h(m1_8431),sigM1_8430,pkCli_8374) <> true) then
                            0
                        else
                            {9560}let (=OpenSecureChannelRequest,=pkCli_8374,Nc_8432: bitstring) = m1_8431 in
                            {9561}new Ns_8433: bitstring;
                            {9562}new ST_8434: bitstring;
                            {9563}new TTL_8435: bitstring;
                            {9564}let m2_8436: bitstring = (OpenSecureChannelResponse,Ns_8433,ST_8434,TTL_8435) in
                            {9565}out(c, (m2_8436,sign(h(m2_8436),skSess_7925)));
                            {9566}let Ksrv_8437: bitstring = h((Ns_8433,Nc_8432)) in
                            {9567}out(c, senc(mSrv(pkCli_8374,pkSess_7926),Ksrv_8437))
            )
            else
                {9568}let pkDisco_8438: bitstring = fail-any in
                {9569}in(c, (=pkCli_8374,em1_8439: bitstring,sigM1_8440: bitstring));
                {9570}let m1_8441: bitstring = em1_8439 in
                {9571}if (verify(h(m1_8441),sigM1_8440,pkCli_8374) <> true) then
                    0
                else
                    {9572}let (=OpenSecureChannelRequest,=pkCli_8374,Nc_8442: bitstring) = m1_8441 in
                    {9573}new Ns_8443: bitstring;
                    {9574}new ST_8444: bitstring;
                    {9575}new TTL_8445: bitstring;
                    {9576}let m2_8446: bitstring = (OpenSecureChannelResponse,Ns_8443,ST_8444,TTL_8445) in
                    {9577}out(c, (m2_8446,sign(h(m2_8446),skSess_7925)));
                    {9578}let Ksrv_8447: bitstring = h((Ns_8443,Nc_8442)) in
                    {9579}out(c, senc(mSrv(pkCli_8374,pkSess_7926),Ksrv_8447))
)

-- Query not attacker(mSrv(pub(skA[]),pub(skC[])))
Completing...
200 rules inserted. The rule base contains 124 rules. 484 rules in the queue.
400 rules inserted. The rule base contains 229 rules. 484 rules in the queue.
600 rules inserted. The rule base contains 364 rules. 484 rules in the queue.
800 rules inserted. The rule base contains 364 rules. 482 rules in the queue.
1000 rules inserted. The rule base contains 364 rules. 482 rules in the queue.
1200 rules inserted. The rule base contains 348 rules. 472 rules in the queue.
1400 rules inserted. The rule base contains 364 rules. 456 rules in the queue.
1600 rules inserted. The rule base contains 364 rules. 456 rules in the queue.
1800 rules inserted. The rule base contains 424 rules. 396 rules in the queue.
2000 rules inserted. The rule base contains 440 rules. 500 rules in the queue.
2200 rules inserted. The rule base contains 533 rules. 627 rules in the queue.
2400 rules inserted. The rule base contains 604 rules. 516 rules in the queue.
2600 rules inserted. The rule base contains 633 rules. 1560 rules in the queue.
2800 rules inserted. The rule base contains 651 rules. 2198 rules in the queue.
3000 rules inserted. The rule base contains 652 rules. 2256 rules in the queue.
3200 rules inserted. The rule base contains 652 rules. 2256 rules in the queue.
3400 rules inserted. The rule base contains 660 rules. 2488 rules in the queue.
3600 rules inserted. The rule base contains 660 rules. 2488 rules in the queue.
3800 rules inserted. The rule base contains 664 rules. 2604 rules in the queue.
4000 rules inserted. The rule base contains 666 rules. 2662 rules in the queue.
4200 rules inserted. The rule base contains 668 rules. 2720 rules in the queue.
4400 rules inserted. The rule base contains 670 rules. 2778 rules in the queue.
4600 rules inserted. The rule base contains 676 rules. 2952 rules in the queue.
4800 rules inserted. The rule base contains 676 rules. 2952 rules in the queue.
5000 rules inserted. The rule base contains 676 rules. 2952 rules in the queue.
5200 rules inserted. The rule base contains 706 rules. 3000 rules in the queue.
5400 rules inserted. The rule base contains 706 rules. 3000 rules in the queue.
5600 rules inserted. The rule base contains 706 rules. 3000 rules in the queue.
5800 rules inserted. The rule base contains 706 rules. 3000 rules in the queue.
6000 rules inserted. The rule base contains 706 rules. 3000 rules in the queue.
6200 rules inserted. The rule base contains 706 rules. 3000 rules in the queue.
6400 rules inserted. The rule base contains 706 rules. 3000 rules in the queue.
6600 rules inserted. The rule base contains 706 rules. 3000 rules in the queue.
6800 rules inserted. The rule base contains 706 rules. 3000 rules in the queue.
7000 rules inserted. The rule base contains 706 rules. 3000 rules in the queue.
7200 rules inserted. The rule base contains 706 rules. 3000 rules in the queue.
7400 rules inserted. The rule base contains 706 rules. 3000 rules in the queue.
7600 rules inserted. The rule base contains 706 rules. 3000 rules in the queue.
7800 rules inserted. The rule base contains 706 rules. 3000 rules in the queue.
8000 rules inserted. The rule base contains 706 rules. 3000 rules in the queue.
8200 rules inserted. The rule base contains 742 rules. 3048 rules in the queue.
8400 rules inserted. The rule base contains 743 rules. 3048 rules in the queue.
8600 rules inserted. The rule base contains 743 rules. 3048 rules in the queue.
8800 rules inserted. The rule base contains 743 rules. 3048 rules in the queue.
9000 rules inserted. The rule base contains 743 rules. 3048 rules in the queue.
9200 rules inserted. The rule base contains 744 rules. 3048 rules in the queue.
9400 rules inserted. The rule base contains 744 rules. 3048 rules in the queue.
9600 rules inserted. The rule base contains 745 rules. 3048 rules in the queue.
9800 rules inserted. The rule base contains 745 rules. 3048 rules in the queue.
10000 rules inserted. The rule base contains 745 rules. 3048 rules in the queue.
10200 rules inserted. The rule base contains 746 rules. 3048 rules in the queue.
10400 rules inserted. The rule base contains 746 rules. 3048 rules in the queue.
10600 rules inserted. The rule base contains 746 rules. 3048 rules in the queue.
10800 rules inserted. The rule base contains 747 rules. 3048 rules in the queue.
11000 rules inserted. The rule base contains 747 rules. 3048 rules in the queue.
11200 rules inserted. The rule base contains 742 rules. 3039 rules in the queue.
11400 rules inserted. The rule base contains 752 rules. 3055 rules in the queue.
11600 rules inserted. The rule base contains 753 rules. 3055 rules in the queue.
11800 rules inserted. The rule base contains 754 rules. 3055 rules in the queue.
12000 rules inserted. The rule base contains 765 rules. 3071 rules in the queue.
12200 rules inserted. The rule base contains 766 rules. 3071 rules in the queue.
12400 rules inserted. The rule base contains 767 rules. 3071 rules in the queue.
12600 rules inserted. The rule base contains 777 rules. 3087 rules in the queue.
12800 rules inserted. The rule base contains 778 rules. 3087 rules in the queue.
13000 rules inserted. The rule base contains 789 rules. 3103 rules in the queue.
13200 rules inserted. The rule base contains 790 rules. 3103 rules in the queue.
13400 rules inserted. The rule base contains 791 rules. 3103 rules in the queue.
13600 rules inserted. The rule base contains 792 rules. 3103 rules in the queue.
13800 rules inserted. The rule base contains 802 rules. 3119 rules in the queue.
14000 rules inserted. The rule base contains 813 rules. 3135 rules in the queue.
14200 rules inserted. The rule base contains 817 rules. 3132 rules in the queue.
14400 rules inserted. The rule base contains 879 rules. 3228 rules in the queue.
14600 rules inserted. The rule base contains 907 rules. 3273 rules in the queue.
14800 rules inserted. The rule base contains 917 rules. 3289 rules in the queue.
15000 rules inserted. The rule base contains 964 rules. 3361 rules in the queue.
15200 rules inserted. The rule base contains 999 rules. 3417 rules in the queue.
15400 rules inserted. The rule base contains 1019 rules. 3449 rules in the queue.
15600 rules inserted. The rule base contains 1077 rules. 3537 rules in the queue.
15800 rules inserted. The rule base contains 1099 rules. 3574 rules in the queue.
16000 rules inserted. The rule base contains 1124 rules. 3614 rules in the queue.
16200 rules inserted. The rule base contains 1190 rules. 3707 rules in the queue.
16400 rules inserted. The rule base contains 1201 rules. 3734 rules in the queue.
16600 rules inserted. The rule base contains 1222 rules. 3766 rules in the queue.
16800 rules inserted. The rule base contains 1244 rules. 3798 rules in the queue.
17000 rules inserted. The rule base contains 1311 rules. 3907 rules in the queue.
17200 rules inserted. The rule base contains 1363 rules. 3987 rules in the queue.
17400 rules inserted. The rule base contains 1378 rules. 4003 rules in the queue.
17600 rules inserted. The rule base contains 1456 rules. 4111 rules in the queue.
17800 rules inserted. The rule base contains 1570 rules. 4287 rules in the queue.
18000 rules inserted. The rule base contains 1632 rules. 4383 rules in the queue.
18200 rules inserted. The rule base contains 1706 rules. 4495 rules in the queue.
18400 rules inserted. The rule base contains 1748 rules. 4537 rules in the queue.
18600 rules inserted. The rule base contains 1860 rules. 4716 rules in the queue.
18800 rules inserted. The rule base contains 1954 rules. 4860 rules in the queue.
19000 rules inserted. The rule base contains 2013 rules. 4937 rules in the queue.
19200 rules inserted. The rule base contains 2082 rules. 5041 rules in the queue.
19400 rules inserted. The rule base contains 2176 rules. 5184 rules in the queue.
19600 rules inserted. The rule base contains 2256 rules. 5304 rules in the queue.
19800 rules inserted. The rule base contains 2305 rules. 5365 rules in the queue.
20000 rules inserted. The rule base contains 2409 rules. 5525 rules in the queue.
20200 rules inserted. The rule base contains 2471 rules. 5621 rules in the queue.
20400 rules inserted. The rule base contains 2565 rules. 5765 rules in the queue.
20600 rules inserted. The rule base contains 2649 rules. 5892 rules in the queue.
20800 rules inserted. The rule base contains 2710 rules. 5969 rules in the queue.
21000 rules inserted. The rule base contains 2796 rules. 6094 rules in the queue.
21200 rules inserted. The rule base contains 2854 rules. 6174 rules in the queue.
21400 rules inserted. The rule base contains 2856 rules. 6168 rules in the queue.
21600 rules inserted. The rule base contains 2845 rules. 6135 rules in the queue.
21800 rules inserted. The rule base contains 2875 rules. 6167 rules in the queue.
22000 rules inserted. The rule base contains 2892 rules. 6183 rules in the queue.
22200 rules inserted. The rule base contains 2946 rules. 6251 rules in the queue.
22400 rules inserted. The rule base contains 3004 rules. 6339 rules in the queue.
22600 rules inserted. The rule base contains 3060 rules. 6417 rules in the queue.
22800 rules inserted. The rule base contains 3102 rules. 6473 rules in the queue.
23000 rules inserted. The rule base contains 3119 rules. 6489 rules in the queue.
23200 rules inserted. The rule base contains 3149 rules. 6521 rules in the queue.
23400 rules inserted. The rule base contains 3168 rules. 6534 rules in the queue.
23600 rules inserted. The rule base contains 3215 rules. 6586 rules in the queue.
23800 rules inserted. The rule base contains 3281 rules. 6680 rules in the queue.
24000 rules inserted. The rule base contains 3254 rules. 6638 rules in the queue.
24200 rules inserted. The rule base contains 3276 rules. 6662 rules in the queue.
24400 rules inserted. The rule base contains 3332 rules. 6740 rules in the queue.
24600 rules inserted. The rule base contains 3356 rules. 6764 rules in the queue.
24800 rules inserted. The rule base contains 3412 rules. 6842 rules in the queue.
25000 rules inserted. The rule base contains 3420 rules. 6834 rules in the queue.
25200 rules inserted. The rule base contains 3440 rules. 6860 rules in the queue.
25400 rules inserted. The rule base contains 3471 rules. 6889 rules in the queue.
25600 rules inserted. The rule base contains 3526 rules. 6958 rules in the queue.
25800 rules inserted. The rule base contains 3611 rules. 7083 rules in the queue.
26000 rules inserted. The rule base contains 3642 rules. 7101 rules in the queue.
26200 rules inserted. The rule base contains 3698 rules. 7181 rules in the queue.
26400 rules inserted. The rule base contains 3674 rules. 7163 rules in the queue.
26600 rules inserted. The rule base contains 3679 rules. 7157 rules in the queue.
26800 rules inserted. The rule base contains 3708 rules. 7189 rules in the queue.
27000 rules inserted. The rule base contains 3724 rules. 7203 rules in the queue.
27200 rules inserted. The rule base contains 3742 rules. 7215 rules in the queue.
27400 rules inserted. The rule base contains 3704 rules. 7162 rules in the queue.
27600 rules inserted. The rule base contains 3667 rules. 7108 rules in the queue.
27800 rules inserted. The rule base contains 3667 rules. 7108 rules in the queue.
28000 rules inserted. The rule base contains 3667 rules. 7108 rules in the queue.
28200 rules inserted. The rule base contains 3667 rules. 7108 rules in the queue.
28400 rules inserted. The rule base contains 3682 rules. 7129 rules in the queue.
28600 rules inserted. The rule base contains 3687 rules. 7136 rules in the queue.
28800 rules inserted. The rule base contains 3697 rules. 7150 rules in the queue.
29000 rules inserted. The rule base contains 3707 rules. 7164 rules in the queue.
29200 rules inserted. The rule base contains 3707 rules. 7164 rules in the queue.
29400 rules inserted. The rule base contains 3707 rules. 7164 rules in the queue.
29600 rules inserted. The rule base contains 3707 rules. 7164 rules in the queue.
29800 rules inserted. The rule base contains 3710 rules. 7155 rules in the queue.
30000 rules inserted. The rule base contains 3720 rules. 7160 rules in the queue.
30200 rules inserted. The rule base contains 3743 rules. 7182 rules in the queue.
30400 rules inserted. The rule base contains 3699 rules. 7131 rules in the queue.
30600 rules inserted. The rule base contains 3652 rules. 7085 rules in the queue.
30800 rules inserted. The rule base contains 3657 rules. 7092 rules in the queue.
31000 rules inserted. The rule base contains 3662 rules. 7099 rules in the queue.
31200 rules inserted. The rule base contains 3662 rules. 7099 rules in the queue.
31400 rules inserted. The rule base contains 3672 rules. 7113 rules in the queue.
31600 rules inserted. The rule base contains 3672 rules. 7113 rules in the queue.
31800 rules inserted. The rule base contains 3672 rules. 7113 rules in the queue.
32000 rules inserted. The rule base contains 3673 rules. 7108 rules in the queue.
32200 rules inserted. The rule base contains 3690 rules. 7123 rules in the queue.
32400 rules inserted. The rule base contains 3697 rules. 7116 rules in the queue.
32600 rules inserted. The rule base contains 3724 rules. 7149 rules in the queue.
32800 rules inserted. The rule base contains 3726 rules. 7141 rules in the queue.
33000 rules inserted. The rule base contains 3741 rules. 7143 rules in the queue.
33200 rules inserted. The rule base contains 3746 rules. 7147 rules in the queue.
33400 rules inserted. The rule base contains 3693 rules. 7101 rules in the queue.
33600 rules inserted. The rule base contains 3637 rules. 7062 rules in the queue.
33800 rules inserted. The rule base contains 3637 rules. 7062 rules in the queue.
34000 rules inserted. The rule base contains 3637 rules. 7062 rules in the queue.
34200 rules inserted. The rule base contains 3637 rules. 7062 rules in the queue.
34400 rules inserted. The rule base contains 3639 rules. 7060 rules in the queue.
34600 rules inserted. The rule base contains 3639 rules. 7060 rules in the queue.
34800 rules inserted. The rule base contains 3639 rules. 7060 rules in the queue.
35000 rules inserted. The rule base contains 3639 rules. 7060 rules in the queue.
35200 rules inserted. The rule base contains 3639 rules. 7060 rules in the queue.
35400 rules inserted. The rule base contains 3639 rules. 7060 rules in the queue.
35600 rules inserted. The rule base contains 3639 rules. 7060 rules in the queue.
35800 rules inserted. The rule base contains 3639 rules. 7060 rules in the queue.
36000 rules inserted. The rule base contains 3639 rules. 7060 rules in the queue.
36200 rules inserted. The rule base contains 3639 rules. 7060 rules in the queue.
36400 rules inserted. The rule base contains 3639 rules. 7060 rules in the queue.
36600 rules inserted. The rule base contains 3639 rules. 7060 rules in the queue.
36800 rules inserted. The rule base contains 3639 rules. 7060 rules in the queue.
37000 rules inserted. The rule base contains 3639 rules. 7060 rules in the queue.
37200 rules inserted. The rule base contains 3639 rules. 7060 rules in the queue.
37400 rules inserted. The rule base contains 3640 rules. 7059 rules in the queue.
37600 rules inserted. The rule base contains 3641 rules. 7058 rules in the queue.
37800 rules inserted. The rule base contains 3641 rules. 7058 rules in the queue.
38000 rules inserted. The rule base contains 3641 rules. 7058 rules in the queue.
38200 rules inserted. The rule base contains 3641 rules. 7058 rules in the queue.
38400 rules inserted. The rule base contains 3641 rules. 7058 rules in the queue.
38600 rules inserted. The rule base contains 3641 rules. 7058 rules in the queue.
38800 rules inserted. The rule base contains 3641 rules. 7058 rules in the queue.
39000 rules inserted. The rule base contains 3641 rules. 7058 rules in the queue.
39200 rules inserted. The rule base contains 3641 rules. 7058 rules in the queue.
39400 rules inserted. The rule base contains 3641 rules. 7058 rules in the queue.
39600 rules inserted. The rule base contains 3641 rules. 7058 rules in the queue.
39800 rules inserted. The rule base contains 3641 rules. 7058 rules in the queue.
40000 rules inserted. The rule base contains 3641 rules. 7058 rules in the queue.
40200 rules inserted. The rule base contains 3641 rules. 7058 rules in the queue.
40400 rules inserted. The rule base contains 3641 rules. 7058 rules in the queue.
40600 rules inserted. The rule base contains 3643 rules. 7056 rules in the queue.
40800 rules inserted. The rule base contains 3643 rules. 7056 rules in the queue.
41000 rules inserted. The rule base contains 3643 rules. 7056 rules in the queue.
41200 rules inserted. The rule base contains 3643 rules. 7056 rules in the queue.
41400 rules inserted. The rule base contains 3643 rules. 7056 rules in the queue.
41600 rules inserted. The rule base contains 3643 rules. 7056 rules in the queue.
41800 rules inserted. The rule base contains 3643 rules. 7056 rules in the queue.
42000 rules inserted. The rule base contains 3643 rules. 7056 rules in the queue.
42200 rules inserted. The rule base contains 3643 rules. 7056 rules in the queue.
42400 rules inserted. The rule base contains 3643 rules. 7056 rules in the queue.
42600 rules inserted. The rule base contains 3643 rules. 7056 rules in the queue.
42800 rules inserted. The rule base contains 3643 rules. 7056 rules in the queue.
43000 rules inserted. The rule base contains 3643 rules. 7056 rules in the queue.
43200 rules inserted. The rule base contains 3643 rules. 7056 rules in the queue.
43400 rules inserted. The rule base contains 3643 rules. 7056 rules in the queue.
43600 rules inserted. The rule base contains 3643 rules. 7056 rules in the queue.
43800 rules inserted. The rule base contains 3643 rules. 7056 rules in the queue.
44000 rules inserted. The rule base contains 3643 rules. 7056 rules in the queue.
44200 rules inserted. The rule base contains 3643 rules. 7056 rules in the queue.
44400 rules inserted. The rule base contains 3643 rules. 7056 rules in the queue.
44600 rules inserted. The rule base contains 3643 rules. 7056 rules in the queue.
44800 rules inserted. The rule base contains 3643 rules. 7056 rules in the queue.
45000 rules inserted. The rule base contains 3643 rules. 7056 rules in the queue.
45200 rules inserted. The rule base contains 3643 rules. 7056 rules in the queue.
45400 rules inserted. The rule base contains 3643 rules. 7056 rules in the queue.
45600 rules inserted. The rule base contains 3643 rules. 7056 rules in the queue.
45800 rules inserted. The rule base contains 3643 rules. 7056 rules in the queue.
46000 rules inserted. The rule base contains 3643 rules. 7056 rules in the queue.
46200 rules inserted. The rule base contains 3643 rules. 7056 rules in the queue.
46400 rules inserted. The rule base contains 3643 rules. 7056 rules in the queue.
46600 rules inserted. The rule base contains 3643 rules. 7056 rules in the queue.
46800 rules inserted. The rule base contains 3643 rules. 7056 rules in the queue.
47000 rules inserted. The rule base contains 3643 rules. 7056 rules in the queue.
47200 rules inserted. The rule base contains 3643 rules. 7056 rules in the queue.
47400 rules inserted. The rule base contains 3643 rules. 7056 rules in the queue.
47600 rules inserted. The rule base contains 3643 rules. 7056 rules in the queue.
47800 rules inserted. The rule base contains 3643 rules. 7056 rules in the queue.
48000 rules inserted. The rule base contains 3643 rules. 7056 rules in the queue.
48200 rules inserted. The rule base contains 3643 rules. 7056 rules in the queue.
48400 rules inserted. The rule base contains 3651 rules. 7056 rules in the queue.
48600 rules inserted. The rule base contains 3655 rules. 7056 rules in the queue.
48800 rules inserted. The rule base contains 3655 rules. 7056 rules in the queue.
49000 rules inserted. The rule base contains 3655 rules. 7056 rules in the queue.
49200 rules inserted. The rule base contains 3655 rules. 7056 rules in the queue.
49400 rules inserted. The rule base contains 3655 rules. 7056 rules in the queue.
49600 rules inserted. The rule base contains 3655 rules. 7056 rules in the queue.
49800 rules inserted. The rule base contains 3655 rules. 7056 rules in the queue.
50000 rules inserted. The rule base contains 3655 rules. 7056 rules in the queue.
50200 rules inserted. The rule base contains 3655 rules. 7056 rules in the queue.
50400 rules inserted. The rule base contains 3655 rules. 7056 rules in the queue.
50600 rules inserted. The rule base contains 3655 rules. 7056 rules in the queue.
50800 rules inserted. The rule base contains 3655 rules. 7056 rules in the queue.
51000 rules inserted. The rule base contains 3655 rules. 7056 rules in the queue.
51200 rules inserted. The rule base contains 3655 rules. 7056 rules in the queue.
51400 rules inserted. The rule base contains 3655 rules. 7056 rules in the queue.
51600 rules inserted. The rule base contains 3655 rules. 7056 rules in the queue.
51800 rules inserted. The rule base contains 3655 rules. 7056 rules in the queue.
52000 rules inserted. The rule base contains 3655 rules. 7056 rules in the queue.
52200 rules inserted. The rule base contains 3655 rules. 7056 rules in the queue.
52400 rules inserted. The rule base contains 3655 rules. 7056 rules in the queue.
52600 rules inserted. The rule base contains 3655 rules. 7056 rules in the queue.
52800 rules inserted. The rule base contains 3655 rules. 7056 rules in the queue.
53000 rules inserted. The rule base contains 3655 rules. 7056 rules in the queue.
53200 rules inserted. The rule base contains 3655 rules. 7056 rules in the queue.
53400 rules inserted. The rule base contains 3655 rules. 7056 rules in the queue.
53600 rules inserted. The rule base contains 3655 rules. 7056 rules in the queue.
53800 rules inserted. The rule base contains 3655 rules. 7056 rules in the queue.
54000 rules inserted. The rule base contains 3655 rules. 7056 rules in the queue.
54200 rules inserted. The rule base contains 3655 rules. 7056 rules in the queue.
54400 rules inserted. The rule base contains 3655 rules. 7056 rules in the queue.
54600 rules inserted. The rule base contains 3655 rules. 7056 rules in the queue.
54800 rules inserted. The rule base contains 3655 rules. 7056 rules in the queue.
55000 rules inserted. The rule base contains 3655 rules. 7056 rules in the queue.
55200 rules inserted. The rule base contains 3655 rules. 7056 rules in the queue.
55400 rules inserted. The rule base contains 3679 rules. 7056 rules in the queue.
55600 rules inserted. The rule base contains 3727 rules. 7056 rules in the queue.
55800 rules inserted. The rule base contains 3727 rules. 7056 rules in the queue.
56000 rules inserted. The rule base contains 3727 rules. 7056 rules in the queue.
56200 rules inserted. The rule base contains 3727 rules. 7056 rules in the queue.
56400 rules inserted. The rule base contains 3727 rules. 7056 rules in the queue.
56600 rules inserted. The rule base contains 3727 rules. 7056 rules in the queue.
56800 rules inserted. The rule base contains 3727 rules. 7056 rules in the queue.
57000 rules inserted. The rule base contains 3727 rules. 7056 rules in the queue.
57200 rules inserted. The rule base contains 3727 rules. 7056 rules in the queue.
57400 rules inserted. The rule base contains 3727 rules. 7056 rules in the queue.
57600 rules inserted. The rule base contains 3727 rules. 7056 rules in the queue.
57800 rules inserted. The rule base contains 3727 rules. 7056 rules in the queue.
58000 rules inserted. The rule base contains 3727 rules. 7056 rules in the queue.
58200 rules inserted. The rule base contains 3727 rules. 7056 rules in the queue.
58400 rules inserted. The rule base contains 3727 rules. 7056 rules in the queue.
58600 rules inserted. The rule base contains 3727 rules. 7056 rules in the queue.
58800 rules inserted. The rule base contains 3727 rules. 7056 rules in the queue.
59000 rules inserted. The rule base contains 3727 rules. 7056 rules in the queue.
59200 rules inserted. The rule base contains 3727 rules. 7056 rules in the queue.
59400 rules inserted. The rule base contains 3727 rules. 7056 rules in the queue.
59600 rules inserted. The rule base contains 3727 rules. 7056 rules in the queue.
59800 rules inserted. The rule base contains 3727 rules. 7056 rules in the queue.
60000 rules inserted. The rule base contains 3727 rules. 7056 rules in the queue.
60200 rules inserted. The rule base contains 3727 rules. 7056 rules in the queue.
60400 rules inserted. The rule base contains 3727 rules. 7056 rules in the queue.
60600 rules inserted. The rule base contains 3727 rules. 7056 rules in the queue.
60800 rules inserted. The rule base contains 3727 rules. 7056 rules in the queue.
61000 rules inserted. The rule base contains 3727 rules. 7056 rules in the queue.
61200 rules inserted. The rule base contains 3727 rules. 7056 rules in the queue.
61400 rules inserted. The rule base contains 3727 rules. 7056 rules in the queue.
61600 rules inserted. The rule base contains 3727 rules. 7056 rules in the queue.
61800 rules inserted. The rule base contains 3727 rules. 7056 rules in the queue.
62000 rules inserted. The rule base contains 3727 rules. 7056 rules in the queue.
62200 rules inserted. The rule base contains 3727 rules. 7056 rules in the queue.
62400 rules inserted. The rule base contains 3727 rules. 7056 rules in the queue.
62600 rules inserted. The rule base contains 3847 rules. 7038 rules in the queue.
62800 rules inserted. The rule base contains 3851 rules. 7038 rules in the queue.
63000 rules inserted. The rule base contains 3851 rules. 7038 rules in the queue.
63200 rules inserted. The rule base contains 3851 rules. 7038 rules in the queue.
63400 rules inserted. The rule base contains 3851 rules. 7038 rules in the queue.
63600 rules inserted. The rule base contains 3851 rules. 7038 rules in the queue.
63800 rules inserted. The rule base contains 3851 rules. 7038 rules in the queue.
64000 rules inserted. The rule base contains 3851 rules. 7038 rules in the queue.
64200 rules inserted. The rule base contains 3851 rules. 7038 rules in the queue.
64400 rules inserted. The rule base contains 3853 rules. 7038 rules in the queue.
64600 rules inserted. The rule base contains 3855 rules. 7038 rules in the queue.
64800 rules inserted. The rule base contains 3855 rules. 7038 rules in the queue.
65000 rules inserted. The rule base contains 3855 rules. 7038 rules in the queue.
65200 rules inserted. The rule base contains 3855 rules. 7038 rules in the queue.
65400 rules inserted. The rule base contains 3855 rules. 7038 rules in the queue.
65600 rules inserted. The rule base contains 3855 rules. 7038 rules in the queue.
65800 rules inserted. The rule base contains 3859 rules. 7038 rules in the queue.
66000 rules inserted. The rule base contains 3859 rules. 7038 rules in the queue.
66200 rules inserted. The rule base contains 3859 rules. 7038 rules in the queue.
66400 rules inserted. The rule base contains 3859 rules. 7038 rules in the queue.
66600 rules inserted. The rule base contains 3859 rules. 7038 rules in the queue.
66800 rules inserted. The rule base contains 3862 rules. 7038 rules in the queue.
67000 rules inserted. The rule base contains 3863 rules. 7038 rules in the queue.
67200 rules inserted. The rule base contains 3863 rules. 7038 rules in the queue.
67400 rules inserted. The rule base contains 3863 rules. 7038 rules in the queue.
67600 rules inserted. The rule base contains 3863 rules. 7038 rules in the queue.
67800 rules inserted. The rule base contains 3863 rules. 7038 rules in the queue.
68000 rules inserted. The rule base contains 3863 rules. 7038 rules in the queue.
68200 rules inserted. The rule base contains 3863 rules. 7038 rules in the queue.
68400 rules inserted. The rule base contains 3863 rules. 7038 rules in the queue.
68600 rules inserted. The rule base contains 3865 rules. 7038 rules in the queue.
68800 rules inserted. The rule base contains 3867 rules. 7038 rules in the queue.
69000 rules inserted. The rule base contains 3867 rules. 7038 rules in the queue.
69200 rules inserted. The rule base contains 3871 rules. 7038 rules in the queue.
69400 rules inserted. The rule base contains 3871 rules. 7038 rules in the queue.
69600 rules inserted. The rule base contains 3903 rules. 6925 rules in the queue.
69800 rules inserted. The rule base contains 3929 rules. 6911 rules in the queue.
70000 rules inserted. The rule base contains 3935 rules. 6905 rules in the queue.
70200 rules inserted. The rule base contains 3939 rules. 6901 rules in the queue.
70400 rules inserted. The rule base contains 3945 rules. 6895 rules in the queue.
70600 rules inserted. The rule base contains 3947 rules. 6893 rules in the queue.
70800 rules inserted. The rule base contains 3948 rules. 6892 rules in the queue.
71000 rules inserted. The rule base contains 3951 rules. 6889 rules in the queue.
71200 rules inserted. The rule base contains 3955 rules. 6885 rules in the queue.
71400 rules inserted. The rule base contains 3980 rules. 6867 rules in the queue.
71600 rules inserted. The rule base contains 3991 rules. 6861 rules in the queue.
71800 rules inserted. The rule base contains 3995 rules. 6857 rules in the queue.
72000 rules inserted. The rule base contains 4003 rules. 6849 rules in the queue.
72200 rules inserted. The rule base contains 4007 rules. 6845 rules in the queue.
72400 rules inserted. The rule base contains 4007 rules. 6845 rules in the queue.
72600 rules inserted. The rule base contains 4017 rules. 6835 rules in the queue.
72800 rules inserted. The rule base contains 4047 rules. 6817 rules in the queue.
73000 rules inserted. The rule base contains 4051 rules. 6813 rules in the queue.
73200 rules inserted. The rule base contains 4053 rules. 6811 rules in the queue.
73400 rules inserted. The rule base contains 4059 rules. 6805 rules in the queue.
73600 rules inserted. The rule base contains 4059 rules. 6805 rules in the queue.
73800 rules inserted. The rule base contains 4089 rules. 6787 rules in the queue.
74000 rules inserted. The rule base contains 4099 rules. 6777 rules in the queue.
74200 rules inserted. The rule base contains 4107 rules. 6769 rules in the queue.
74400 rules inserted. The rule base contains 4107 rules. 6769 rules in the queue.
74600 rules inserted. The rule base contains 4111 rules. 6765 rules in the queue.
74800 rules inserted. The rule base contains 4111 rules. 6765 rules in the queue.
75000 rules inserted. The rule base contains 4115 rules. 6761 rules in the queue.
75200 rules inserted. The rule base contains 4119 rules. 6757 rules in the queue.
75400 rules inserted. The rule base contains 4123 rules. 6753 rules in the queue.
75600 rules inserted. The rule base contains 4145 rules. 6743 rules in the queue.
75800 rules inserted. The rule base contains 4163 rules. 6725 rules in the queue.
76000 rules inserted. The rule base contains 4167 rules. 6721 rules in the queue.
76200 rules inserted. The rule base contains 4193 rules. 6707 rules in the queue.
76400 rules inserted. The rule base contains 4207 rules. 6693 rules in the queue.
76600 rules inserted. The rule base contains 4178 rules. 6504 rules in the queue.
76800 rules inserted. The rule base contains 4196 rules. 6460 rules in the queue.
77000 rules inserted. The rule base contains 4214 rules. 6410 rules in the queue.
77200 rules inserted. The rule base contains 4226 rules. 6372 rules in the queue.
77400 rules inserted. The rule base contains 4238 rules. 6346 rules in the queue.
77600 rules inserted. The rule base contains 4238 rules. 6334 rules in the queue.
77800 rules inserted. The rule base contains 4250 rules. 6308 rules in the queue.
78000 rules inserted. The rule base contains 4262 rules. 6274 rules in the queue.
78200 rules inserted. The rule base contains 4302 rules. 6214 rules in the queue.
78400 rules inserted. The rule base contains 4326 rules. 6160 rules in the queue.
78600 rules inserted. The rule base contains 4341 rules. 6119 rules in the queue.
78800 rules inserted. The rule base contains 4362 rules. 6066 rules in the queue.
79000 rules inserted. The rule base contains 4374 rules. 6034 rules in the queue.
79200 rules inserted. The rule base contains 4374 rules. 6030 rules in the queue.
79400 rules inserted. The rule base contains 4410 rules. 5964 rules in the queue.
79600 rules inserted. The rule base contains 4450 rules. 5892 rules in the queue.
79800 rules inserted. The rule base contains 4462 rules. 5860 rules in the queue.
80000 rules inserted. The rule base contains 4474 rules. 5830 rules in the queue.
80200 rules inserted. The rule base contains 4486 rules. 5794 rules in the queue.
80400 rules inserted. The rule base contains 4498 rules. 5764 rules in the queue.
80600 rules inserted. The rule base contains 4550 rules. 5680 rules in the queue.
80800 rules inserted. The rule base contains 4574 rules. 5626 rules in the queue.
81000 rules inserted. The rule base contains 4586 rules. 5586 rules in the queue.
81200 rules inserted. The rule base contains 4598 rules. 5560 rules in the queue.
81400 rules inserted. The rule base contains 4598 rules. 5550 rules in the queue.
81600 rules inserted. The rule base contains 4610 rules. 5524 rules in the queue.
81800 rules inserted. The rule base contains 4622 rules. 5484 rules in the queue.
82000 rules inserted. The rule base contains 4634 rules. 5460 rules in the queue.
82200 rules inserted. The rule base contains 4646 rules. 5420 rules in the queue.
82400 rules inserted. The rule base contains 4710 rules. 5322 rules in the queue.
82600 rules inserted. The rule base contains 4722 rules. 5282 rules in the queue.
82800 rules inserted. The rule base contains 4750 rules. 5226 rules in the queue.
83000 rules inserted. The rule base contains 4798 rules. 5144 rules in the queue.
83200 rules inserted. The rule base contains 4804 rules. 5014 rules in the queue.
83400 rules inserted. The rule base contains 4804 rules. 4880 rules in the queue.
83600 rules inserted. The rule base contains 4804 rules. 4750 rules in the queue.
83800 rules inserted. The rule base contains 4804 rules. 4705 rules in the queue.
84000 rules inserted. The rule base contains 4804 rules. 4606 rules in the queue.
84200 rules inserted. The rule base contains 4804 rules. 4538 rules in the queue.
84400 rules inserted. The rule base contains 4804 rules. 4456 rules in the queue.
84600 rules inserted. The rule base contains 4804 rules. 4324 rules in the queue.
84800 rules inserted. The rule base contains 4804 rules. 4184 rules in the queue.
85000 rules inserted. The rule base contains 4804 rules. 4074 rules in the queue.
85200 rules inserted. The rule base contains 4804 rules. 4021 rules in the queue.
85400 rules inserted. The rule base contains 4804 rules. 3897 rules in the queue.
85600 rules inserted. The rule base contains 4804 rules. 3766 rules in the queue.
85800 rules inserted. The rule base contains 4804 rules. 3693 rules in the queue.
86000 rules inserted. The rule base contains 4804 rules. 3586 rules in the queue.
86200 rules inserted. The rule base contains 4804 rules. 3490 rules in the queue.
86400 rules inserted. The rule base contains 4804 rules. 3348 rules in the queue.
86600 rules inserted. The rule base contains 4804 rules. 3220 rules in the queue.
86800 rules inserted. The rule base contains 4804 rules. 3144 rules in the queue.
87000 rules inserted. The rule base contains 4804 rules. 3083 rules in the queue.
87200 rules inserted. The rule base contains 4804 rules. 2998 rules in the queue.
87400 rules inserted. The rule base contains 4804 rules. 2902 rules in the queue.
87600 rules inserted. The rule base contains 4804 rules. 2786 rules in the queue.
87800 rules inserted. The rule base contains 4804 rules. 2653 rules in the queue.
88000 rules inserted. The rule base contains 4804 rules. 2514 rules in the queue.
88200 rules inserted. The rule base contains 4804 rules. 2370 rules in the queue.
88400 rules inserted. The rule base contains 4804 rules. 2204 rules in the queue.
88600 rules inserted. The rule base contains 4804 rules. 2062 rules in the queue.
88800 rules inserted. The rule base contains 4804 rules. 1922 rules in the queue.
89000 rules inserted. The rule base contains 4804 rules. 1754 rules in the queue.
89200 rules inserted. The rule base contains 4804 rules. 1612 rules in the queue.
89400 rules inserted. The rule base contains 4804 rules. 1450 rules in the queue.
89600 rules inserted. The rule base contains 4804 rules. 1304 rules in the queue.
89800 rules inserted. The rule base contains 4804 rules. 1138 rules in the queue.
90000 rules inserted. The rule base contains 4804 rules. 988 rules in the queue.
90200 rules inserted. The rule base contains 4804 rules. 854 rules in the queue.
90400 rules inserted. The rule base contains 4804 rules. 700 rules in the queue.
90600 rules inserted. The rule base contains 4804 rules. 520 rules in the queue.
90800 rules inserted. The rule base contains 4804 rules. 338 rules in the queue.
91000 rules inserted. The rule base contains 4804 rules. 156 rules in the queue.
Starting query not attacker(mSrv(pub(skA[]),pub(skC[])))
goal reachable: attacker(mSrv(pub(skA[]),pub(skC[])))
Abbreviations:
Nc_1055242 = Nc[UP = UP_1055223,SP = SP_1055222,Sess = A[],Disco = A[],Cli = A[],!1 = @sid_1055224]
Ns_1055243 = Ns_6398[sigM1_6395 = sign(h((OpenSecureChannelRequest,pub(skA[]),Nc_1055242)),skA[]),em1_6394 = (OpenSecureChannelRequest,pub(skA[]),Nc_1055242),Sess_5311 = C[],Disco_5310 = Disco_1055238,Cli_5309 = A[],!1 = @sid_1055239]
ST_1055244 = ST_6399[sigM1_6395 = sign(h((OpenSecureChannelRequest,pub(skA[]),Nc_1055242)),skA[]),em1_6394 = (OpenSecureChannelRequest,pub(skA[]),Nc_1055242),Sess_5311 = C[],Disco_5310 = Disco_1055238,Cli_5309 = A[],!1 = @sid_1055239]
TTL_1055245 = TTL_6400[sigM1_6395 = sign(h((OpenSecureChannelRequest,pub(skA[]),Nc_1055242)),skA[]),em1_6394 = (OpenSecureChannelRequest,pub(skA[]),Nc_1055242),Sess_5311 = C[],Disco_5310 = Disco_1055238,Cli_5309 = A[],!1 = @sid_1055239]

1. The attacker initially knows A[].
attacker(A[]).

2. By 1, the attacker may know A[].
By 1, the attacker may know A[].
By 1, the attacker may know A[].
Using the function 3-tuple the attacker may obtain (A[],A[],A[]).
attacker((A[],A[],A[])).

3. The attacker has some term UP_1055223.
attacker(UP_1055223).

4. The attacker has some term SP_1055222.
attacker(SP_1055222).

5. Using the function Sign the attacker may obtain Sign.
attacker(Sign).

6. The message pub(skA[]) may be sent to the attacker at output {2}.
attacker(pub(skA[])).

7. Using the function GetEndpointResponse the attacker may obtain GetEndpointResponse.
attacker(GetEndpointResponse).

8. By 7, the attacker may know GetEndpointResponse.
By 6, the attacker may know pub(skA[]).
By 5, the attacker may know Sign.
By 4, the attacker may know SP_1055222.
By 3, the attacker may know UP_1055223.
Using the function 5-tuple the attacker may obtain (GetEndpointResponse,pub(skA[]),Sign,SP_1055222,UP_1055223).
attacker((GetEndpointResponse,pub(skA[]),Sign,SP_1055222,UP_1055223)).

9. The message (A[],A[],A[]) that the attacker may have by 2 may be received at input {8}.
The message (GetEndpointResponse,pub(skA[]),Sign,SP_1055222,UP_1055223) that the attacker may have by 8 may be received at input {20}.
So the message (pub(skA[]),(OpenSecureChannelRequest,pub(skA[]),Nc_1055242),sign(h((OpenSecureChannelRequest,pub(skA[]),Nc_1055242)),skA[])) may be sent to the attacker at output {23}.
attacker((pub(skA[]),(OpenSecureChannelRequest,pub(skA[]),Nc_1055242),sign(h((OpenSecureChannelRequest,pub(skA[]),Nc_1055242)),skA[]))).

10. By 9, the attacker may know (pub(skA[]),(OpenSecureChannelRequest,pub(skA[]),Nc_1055242),sign(h((OpenSecureChannelRequest,pub(skA[]),Nc_1055242)),skA[])).
Using the function 2-proj-3-tuple the attacker may obtain (OpenSecureChannelRequest,pub(skA[]),Nc_1055242).
attacker((OpenSecureChannelRequest,pub(skA[]),Nc_1055242)).

11. By 10, the attacker may know (OpenSecureChannelRequest,pub(skA[]),Nc_1055242).
Using the function 3-proj-3-tuple the attacker may obtain Nc_1055242.
attacker(Nc_1055242).

12. The attacker initially knows C[].
attacker(C[]).

13. The attacker has some term Disco_1055238.
attacker(Disco_1055238).

14. By 1, the attacker may know A[].
By 13, the attacker may know Disco_1055238.
By 12, the attacker may know C[].
Using the function 3-tuple the attacker may obtain (A[],Disco_1055238,C[]).
attacker((A[],Disco_1055238,C[])).

15. The message (A[],Disco_1055238,C[]) that the attacker may have by 14 may be received at input {5704}.
The message (pub(skA[]),(OpenSecureChannelRequest,pub(skA[]),Nc_1055242),sign(h((OpenSecureChannelRequest,pub(skA[]),Nc_1055242)),skA[])) that the attacker may have by 9 may be received at input {7048}.
We have Disco_1055238 <> C[] & Disco_1055238 <> B[] & Disco_1055238 <> A[].
So the message ((OpenSecureChannelResponse,Ns_1055243,ST_1055244,TTL_1055245),sign(h((OpenSecureChannelResponse,Ns_1055243,ST_1055244,TTL_1055245)),skC[])) may be sent to the attacker at output {7056}.
attacker(((OpenSecureChannelResponse,Ns_1055243,ST_1055244,TTL_1055245),sign(h((OpenSecureChannelResponse,Ns_1055243,ST_1055244,TTL_1055245)),skC[]))).

16. By 15, the attacker may know ((OpenSecureChannelResponse,Ns_1055243,ST_1055244,TTL_1055245),sign(h((OpenSecureChannelResponse,Ns_1055243,ST_1055244,TTL_1055245)),skC[])).
Using the function 1-proj-2-tuple the attacker may obtain (OpenSecureChannelResponse,Ns_1055243,ST_1055244,TTL_1055245).
attacker((OpenSecureChannelResponse,Ns_1055243,ST_1055244,TTL_1055245)).

17. By 16, the attacker may know (OpenSecureChannelResponse,Ns_1055243,ST_1055244,TTL_1055245).
Using the function 2-proj-4-tuple the attacker may obtain Ns_1055243.
attacker(Ns_1055243).

18. By 17, the attacker may know Ns_1055243.
By 11, the attacker may know Nc_1055242.
Using the function 2-tuple the attacker may obtain (Ns_1055243,Nc_1055242).
attacker((Ns_1055243,Nc_1055242)).

19. By 18, the attacker may know (Ns_1055243,Nc_1055242).
Using the function h the attacker may obtain h((Ns_1055243,Nc_1055242)).
attacker(h((Ns_1055243,Nc_1055242))).

20. The message (A[],Disco_1055238,C[]) that the attacker may have by 14 may be received at input {5704}.
The message (pub(skA[]),(OpenSecureChannelRequest,pub(skA[]),Nc_1055242),sign(h((OpenSecureChannelRequest,pub(skA[]),Nc_1055242)),skA[])) that the attacker may have by 9 may be received at input {7048}.
We have Disco_1055238 <> C[] & Disco_1055238 <> B[] & Disco_1055238 <> A[].
So the message senc(mSrv(pub(skA[]),pub(skC[])),h((Ns_1055243,Nc_1055242))) may be sent to the attacker at output {7058}.
attacker(senc(mSrv(pub(skA[]),pub(skC[])),h((Ns_1055243,Nc_1055242)))).

21. By 20, the attacker may know senc(mSrv(pub(skA[]),pub(skC[])),h((Ns_1055243,Nc_1055242))).
By 19, the attacker may know h((Ns_1055243,Nc_1055242)).
Using the function sdec the attacker may obtain mSrv(pub(skA[]),pub(skC[])).
attacker(mSrv(pub(skA[]),pub(skC[]))).


A more detailed output of the traces is available with
  set traceDisplay = long.

out(c, pub(skA)) at {2}

out(c, pub(skB)) at {4}

out(c, pub(skC)) at {6}

in(c, (A,A,A)) at {8} in copy a_1055247

out(c, GetEndpointRequest) at {19} in copy a_1055247

in(c, (GetEndpointResponse,pub(skA),Sign,a_1055246,a)) at {20} in copy a_1055247

new Nc creating Nc_1055250 at {21} in copy a_1055247

out(c, (pub(skA),(OpenSecureChannelRequest,pub(skA),Nc_1055250),sign(h((OpenSecureChannelRequest,pub(skA),Nc_1055250)),skA))) at {23} in copy a_1055247

in(c, (A,a_1055248,C)) at {5704} in copy a_1055249

in(c, (pub(skA),(OpenSecureChannelRequest,pub(skA),Nc_1055250),sign(h((OpenSecureChannelRequest,pub(skA),Nc_1055250)),skA))) at {7048} in copy a_1055249

new Ns_6398 creating Ns_1055251 at {7052} in copy a_1055249

new ST_6399 creating ST_1055252 at {7053} in copy a_1055249

new TTL_6400 creating TTL_1055253 at {7054} in copy a_1055249

out(c, ((OpenSecureChannelResponse,Ns_1055251,ST_1055252,TTL_1055253),sign(h((OpenSecureChannelResponse,Ns_1055251,ST_1055252,TTL_1055253)),skC))) at {7056} in copy a_1055249

out(c, senc(mSrv(pub(skA),pub(skC)),h((Ns_1055251,Nc_1055250)))) at {7058} in copy a_1055249

The attacker has the message mSrv(pub(skA),pub(skC)).
A trace has been found.
RESULT not attacker(mSrv(pub(skA[]),pub(skC[]))) is false.
-- Query not attacker(mCli(pub(skA[]),pub(skC[])))
Completing...
200 rules inserted. The rule base contains 124 rules. 484 rules in the queue.
400 rules inserted. The rule base contains 229 rules. 484 rules in the queue.
600 rules inserted. The rule base contains 364 rules. 484 rules in the queue.
800 rules inserted. The rule base contains 364 rules. 482 rules in the queue.
1000 rules inserted. The rule base contains 364 rules. 482 rules in the queue.
1200 rules inserted. The rule base contains 348 rules. 472 rules in the queue.
1400 rules inserted. The rule base contains 364 rules. 456 rules in the queue.
1600 rules inserted. The rule base contains 364 rules. 456 rules in the queue.
1800 rules inserted. The rule base contains 424 rules. 396 rules in the queue.
2000 rules inserted. The rule base contains 440 rules. 500 rules in the queue.
2200 rules inserted. The rule base contains 533 rules. 627 rules in the queue.
2400 rules inserted. The rule base contains 604 rules. 516 rules in the queue.
2600 rules inserted. The rule base contains 633 rules. 1560 rules in the queue.
2800 rules inserted. The rule base contains 651 rules. 2198 rules in the queue.
3000 rules inserted. The rule base contains 652 rules. 2256 rules in the queue.
3200 rules inserted. The rule base contains 652 rules. 2256 rules in the queue.
3400 rules inserted. The rule base contains 660 rules. 2488 rules in the queue.
3600 rules inserted. The rule base contains 660 rules. 2488 rules in the queue.
3800 rules inserted. The rule base contains 664 rules. 2604 rules in the queue.
4000 rules inserted. The rule base contains 666 rules. 2662 rules in the queue.
4200 rules inserted. The rule base contains 668 rules. 2720 rules in the queue.
4400 rules inserted. The rule base contains 670 rules. 2778 rules in the queue.
4600 rules inserted. The rule base contains 676 rules. 2952 rules in the queue.
4800 rules inserted. The rule base contains 676 rules. 2952 rules in the queue.
5000 rules inserted. The rule base contains 676 rules. 2952 rules in the queue.
5200 rules inserted. The rule base contains 706 rules. 3000 rules in the queue.
5400 rules inserted. The rule base contains 706 rules. 3000 rules in the queue.
5600 rules inserted. The rule base contains 706 rules. 3000 rules in the queue.
5800 rules inserted. The rule base contains 706 rules. 3000 rules in the queue.
6000 rules inserted. The rule base contains 706 rules. 3000 rules in the queue.
6200 rules inserted. The rule base contains 706 rules. 3000 rules in the queue.
6400 rules inserted. The rule base contains 706 rules. 3000 rules in the queue.
6600 rules inserted. The rule base contains 706 rules. 3000 rules in the queue.
6800 rules inserted. The rule base contains 706 rules. 3000 rules in the queue.
7000 rules inserted. The rule base contains 706 rules. 3000 rules in the queue.
7200 rules inserted. The rule base contains 706 rules. 3000 rules in the queue.
7400 rules inserted. The rule base contains 706 rules. 3000 rules in the queue.
7600 rules inserted. The rule base contains 706 rules. 3000 rules in the queue.
7800 rules inserted. The rule base contains 706 rules. 3000 rules in the queue.
8000 rules inserted. The rule base contains 706 rules. 3000 rules in the queue.
8200 rules inserted. The rule base contains 742 rules. 3048 rules in the queue.
8400 rules inserted. The rule base contains 743 rules. 3048 rules in the queue.
8600 rules inserted. The rule base contains 743 rules. 3048 rules in the queue.
8800 rules inserted. The rule base contains 743 rules. 3048 rules in the queue.
9000 rules inserted. The rule base contains 743 rules. 3048 rules in the queue.
9200 rules inserted. The rule base contains 744 rules. 3048 rules in the queue.
9400 rules inserted. The rule base contains 744 rules. 3048 rules in the queue.
9600 rules inserted. The rule base contains 745 rules. 3048 rules in the queue.
9800 rules inserted. The rule base contains 745 rules. 3048 rules in the queue.
10000 rules inserted. The rule base contains 745 rules. 3048 rules in the queue.
10200 rules inserted. The rule base contains 746 rules. 3048 rules in the queue.
10400 rules inserted. The rule base contains 746 rules. 3048 rules in the queue.
10600 rules inserted. The rule base contains 746 rules. 3048 rules in the queue.
10800 rules inserted. The rule base contains 747 rules. 3048 rules in the queue.
11000 rules inserted. The rule base contains 747 rules. 3048 rules in the queue.
11200 rules inserted. The rule base contains 742 rules. 3039 rules in the queue.
11400 rules inserted. The rule base contains 752 rules. 3055 rules in the queue.
11600 rules inserted. The rule base contains 753 rules. 3055 rules in the queue.
11800 rules inserted. The rule base contains 754 rules. 3055 rules in the queue.
12000 rules inserted. The rule base contains 765 rules. 3071 rules in the queue.
12200 rules inserted. The rule base contains 766 rules. 3071 rules in the queue.
12400 rules inserted. The rule base contains 767 rules. 3071 rules in the queue.
12600 rules inserted. The rule base contains 777 rules. 3087 rules in the queue.
12800 rules inserted. The rule base contains 778 rules. 3087 rules in the queue.
13000 rules inserted. The rule base contains 789 rules. 3103 rules in the queue.
13200 rules inserted. The rule base contains 790 rules. 3103 rules in the queue.
13400 rules inserted. The rule base contains 791 rules. 3103 rules in the queue.
13600 rules inserted. The rule base contains 792 rules. 3103 rules in the queue.
13800 rules inserted. The rule base contains 802 rules. 3119 rules in the queue.
14000 rules inserted. The rule base contains 813 rules. 3135 rules in the queue.
14200 rules inserted. The rule base contains 817 rules. 3132 rules in the queue.
14400 rules inserted. The rule base contains 879 rules. 3228 rules in the queue.
14600 rules inserted. The rule base contains 907 rules. 3273 rules in the queue.
14800 rules inserted. The rule base contains 917 rules. 3289 rules in the queue.
15000 rules inserted. The rule base contains 964 rules. 3361 rules in the queue.
15200 rules inserted. The rule base contains 999 rules. 3417 rules in the queue.
15400 rules inserted. The rule base contains 1019 rules. 3449 rules in the queue.
15600 rules inserted. The rule base contains 1077 rules. 3537 rules in the queue.
15800 rules inserted. The rule base contains 1099 rules. 3574 rules in the queue.
16000 rules inserted. The rule base contains 1124 rules. 3614 rules in the queue.
16200 rules inserted. The rule base contains 1190 rules. 3707 rules in the queue.
16400 rules inserted. The rule base contains 1201 rules. 3734 rules in the queue.
16600 rules inserted. The rule base contains 1222 rules. 3766 rules in the queue.
16800 rules inserted. The rule base contains 1244 rules. 3798 rules in the queue.
17000 rules inserted. The rule base contains 1311 rules. 3907 rules in the queue.
17200 rules inserted. The rule base contains 1363 rules. 3987 rules in the queue.
17400 rules inserted. The rule base contains 1378 rules. 4003 rules in the queue.
17600 rules inserted. The rule base contains 1456 rules. 4111 rules in the queue.
17800 rules inserted. The rule base contains 1570 rules. 4287 rules in the queue.
18000 rules inserted. The rule base contains 1632 rules. 4383 rules in the queue.
18200 rules inserted. The rule base contains 1706 rules. 4495 rules in the queue.
18400 rules inserted. The rule base contains 1748 rules. 4537 rules in the queue.
18600 rules inserted. The rule base contains 1860 rules. 4716 rules in the queue.
18800 rules inserted. The rule base contains 1954 rules. 4860 rules in the queue.
19000 rules inserted. The rule base contains 2013 rules. 4937 rules in the queue.
19200 rules inserted. The rule base contains 2082 rules. 5041 rules in the queue.
19400 rules inserted. The rule base contains 2176 rules. 5184 rules in the queue.
19600 rules inserted. The rule base contains 2256 rules. 5304 rules in the queue.
19800 rules inserted. The rule base contains 2305 rules. 5365 rules in the queue.
20000 rules inserted. The rule base contains 2409 rules. 5525 rules in the queue.
20200 rules inserted. The rule base contains 2471 rules. 5621 rules in the queue.
20400 rules inserted. The rule base contains 2565 rules. 5765 rules in the queue.
20600 rules inserted. The rule base contains 2649 rules. 5892 rules in the queue.
20800 rules inserted. The rule base contains 2710 rules. 5969 rules in the queue.
21000 rules inserted. The rule base contains 2796 rules. 6094 rules in the queue.
21200 rules inserted. The rule base contains 2854 rules. 6174 rules in the queue.
21400 rules inserted. The rule base contains 2856 rules. 6168 rules in the queue.
21600 rules inserted. The rule base contains 2845 rules. 6135 rules in the queue.
21800 rules inserted. The rule base contains 2875 rules. 6167 rules in the queue.
22000 rules inserted. The rule base contains 2892 rules. 6183 rules in the queue.
22200 rules inserted. The rule base contains 2946 rules. 6251 rules in the queue.
22400 rules inserted. The rule base contains 3004 rules. 6339 rules in the queue.
22600 rules inserted. The rule base contains 3060 rules. 6417 rules in the queue.
22800 rules inserted. The rule base contains 3102 rules. 6473 rules in the queue.
23000 rules inserted. The rule base contains 3119 rules. 6489 rules in the queue.
23200 rules inserted. The rule base contains 3149 rules. 6521 rules in the queue.
23400 rules inserted. The rule base contains 3168 rules. 6534 rules in the queue.
23600 rules inserted. The rule base contains 3215 rules. 6586 rules in the queue.
23800 rules inserted. The rule base contains 3281 rules. 6680 rules in the queue.
24000 rules inserted. The rule base contains 3254 rules. 6638 rules in the queue.
24200 rules inserted. The rule base contains 3276 rules. 6662 rules in the queue.
24400 rules inserted. The rule base contains 3332 rules. 6740 rules in the queue.
24600 rules inserted. The rule base contains 3356 rules. 6764 rules in the queue.
24800 rules inserted. The rule base contains 3412 rules. 6842 rules in the queue.
25000 rules inserted. The rule base contains 3420 rules. 6834 rules in the queue.
25200 rules inserted. The rule base contains 3440 rules. 6860 rules in the queue.
25400 rules inserted. The rule base contains 3471 rules. 6889 rules in the queue.
25600 rules inserted. The rule base contains 3526 rules. 6958 rules in the queue.
25800 rules inserted. The rule base contains 3611 rules. 7083 rules in the queue.
26000 rules inserted. The rule base contains 3642 rules. 7101 rules in the queue.
26200 rules inserted. The rule base contains 3698 rules. 7181 rules in the queue.
26400 rules inserted. The rule base contains 3674 rules. 7163 rules in the queue.
26600 rules inserted. The rule base contains 3679 rules. 7157 rules in the queue.
26800 rules inserted. The rule base contains 3708 rules. 7189 rules in the queue.
27000 rules inserted. The rule base contains 3724 rules. 7203 rules in the queue.
27200 rules inserted. The rule base contains 3742 rules. 7215 rules in the queue.
27400 rules inserted. The rule base contains 3704 rules. 7162 rules in the queue.
27600 rules inserted. The rule base contains 3667 rules. 7108 rules in the queue.
27800 rules inserted. The rule base contains 3667 rules. 7108 rules in the queue.
28000 rules inserted. The rule base contains 3667 rules. 7108 rules in the queue.
28200 rules inserted. The rule base contains 3667 rules. 7108 rules in the queue.
28400 rules inserted. The rule base contains 3682 rules. 7129 rules in the queue.
28600 rules inserted. The rule base contains 3687 rules. 7136 rules in the queue.
28800 rules inserted. The rule base contains 3697 rules. 7150 rules in the queue.
29000 rules inserted. The rule base contains 3707 rules. 7164 rules in the queue.
29200 rules inserted. The rule base contains 3707 rules. 7164 rules in the queue.
29400 rules inserted. The rule base contains 3707 rules. 7164 rules in the queue.
29600 rules inserted. The rule base contains 3707 rules. 7164 rules in the queue.
29800 rules inserted. The rule base contains 3710 rules. 7155 rules in the queue.
30000 rules inserted. The rule base contains 3720 rules. 7160 rules in the queue.
30200 rules inserted. The rule base contains 3743 rules. 7182 rules in the queue.
30400 rules inserted. The rule base contains 3699 rules. 7131 rules in the queue.
30600 rules inserted. The rule base contains 3652 rules. 7085 rules in the queue.
30800 rules inserted. The rule base contains 3657 rules. 7092 rules in the queue.
31000 rules inserted. The rule base contains 3662 rules. 7099 rules in the queue.
31200 rules inserted. The rule base contains 3662 rules. 7099 rules in the queue.
31400 rules inserted. The rule base contains 3672 rules. 7113 rules in the queue.
31600 rules inserted. The rule base contains 3672 rules. 7113 rules in the queue.
31800 rules inserted. The rule base contains 3672 rules. 7113 rules in the queue.
32000 rules inserted. The rule base contains 3673 rules. 7108 rules in the queue.
32200 rules inserted. The rule base contains 3690 rules. 7123 rules in the queue.
32400 rules inserted. The rule base contains 3697 rules. 7116 rules in the queue.
32600 rules inserted. The rule base contains 3724 rules. 7149 rules in the queue.
32800 rules inserted. The rule base contains 3726 rules. 7141 rules in the queue.
33000 rules inserted. The rule base contains 3741 rules. 7143 rules in the queue.
33200 rules inserted. The rule base contains 3746 rules. 7147 rules in the queue.
33400 rules inserted. The rule base contains 3693 rules. 7101 rules in the queue.
33600 rules inserted. The rule base contains 3637 rules. 7062 rules in the queue.
33800 rules inserted. The rule base contains 3637 rules. 7062 rules in the queue.
34000 rules inserted. The rule base contains 3637 rules. 7062 rules in the queue.
34200 rules inserted. The rule base contains 3637 rules. 7062 rules in the queue.
34400 rules inserted. The rule base contains 3639 rules. 7060 rules in the queue.
34600 rules inserted. The rule base contains 3639 rules. 7060 rules in the queue.
34800 rules inserted. The rule base contains 3639 rules. 7060 rules in the queue.
35000 rules inserted. The rule base contains 3639 rules. 7060 rules in the queue.
35200 rules inserted. The rule base contains 3639 rules. 7060 rules in the queue.
35400 rules inserted. The rule base contains 3639 rules. 7060 rules in the queue.
35600 rules inserted. The rule base contains 3639 rules. 7060 rules in the queue.
35800 rules inserted. The rule base contains 3639 rules. 7060 rules in the queue.
36000 rules inserted. The rule base contains 3639 rules. 7060 rules in the queue.
36200 rules inserted. The rule base contains 3639 rules. 7060 rules in the queue.
36400 rules inserted. The rule base contains 3639 rules. 7060 rules in the queue.
36600 rules inserted. The rule base contains 3639 rules. 7060 rules in the queue.
36800 rules inserted. The rule base contains 3639 rules. 7060 rules in the queue.
37000 rules inserted. The rule base contains 3639 rules. 7060 rules in the queue.
37200 rules inserted. The rule base contains 3639 rules. 7060 rules in the queue.
37400 rules inserted. The rule base contains 3640 rules. 7059 rules in the queue.
37600 rules inserted. The rule base contains 3641 rules. 7058 rules in the queue.
37800 rules inserted. The rule base contains 3641 rules. 7058 rules in the queue.
38000 rules inserted. The rule base contains 3641 rules. 7058 rules in the queue.
38200 rules inserted. The rule base contains 3641 rules. 7058 rules in the queue.
38400 rules inserted. The rule base contains 3641 rules. 7058 rules in the queue.
38600 rules inserted. The rule base contains 3641 rules. 7058 rules in the queue.
38800 rules inserted. The rule base contains 3641 rules. 7058 rules in the queue.
39000 rules inserted. The rule base contains 3641 rules. 7058 rules in the queue.
39200 rules inserted. The rule base contains 3641 rules. 7058 rules in the queue.
39400 rules inserted. The rule base contains 3641 rules. 7058 rules in the queue.
39600 rules inserted. The rule base contains 3641 rules. 7058 rules in the queue.
39800 rules inserted. The rule base contains 3641 rules. 7058 rules in the queue.
40000 rules inserted. The rule base contains 3641 rules. 7058 rules in the queue.
40200 rules inserted. The rule base contains 3641 rules. 7058 rules in the queue.
40400 rules inserted. The rule base contains 3641 rules. 7058 rules in the queue.
40600 rules inserted. The rule base contains 3643 rules. 7056 rules in the queue.
40800 rules inserted. The rule base contains 3643 rules. 7056 rules in the queue.
41000 rules inserted. The rule base contains 3643 rules. 7056 rules in the queue.
41200 rules inserted. The rule base contains 3643 rules. 7056 rules in the queue.
41400 rules inserted. The rule base contains 3643 rules. 7056 rules in the queue.
41600 rules inserted. The rule base contains 3643 rules. 7056 rules in the queue.
41800 rules inserted. The rule base contains 3643 rules. 7056 rules in the queue.
42000 rules inserted. The rule base contains 3643 rules. 7056 rules in the queue.
42200 rules inserted. The rule base contains 3643 rules. 7056 rules in the queue.
42400 rules inserted. The rule base contains 3643 rules. 7056 rules in the queue.
42600 rules inserted. The rule base contains 3643 rules. 7056 rules in the queue.
42800 rules inserted. The rule base contains 3643 rules. 7056 rules in the queue.
43000 rules inserted. The rule base contains 3643 rules. 7056 rules in the queue.
43200 rules inserted. The rule base contains 3643 rules. 7056 rules in the queue.
43400 rules inserted. The rule base contains 3643 rules. 7056 rules in the queue.
43600 rules inserted. The rule base contains 3643 rules. 7056 rules in the queue.
43800 rules inserted. The rule base contains 3643 rules. 7056 rules in the queue.
44000 rules inserted. The rule base contains 3643 rules. 7056 rules in the queue.
44200 rules inserted. The rule base contains 3643 rules. 7056 rules in the queue.
44400 rules inserted. The rule base contains 3643 rules. 7056 rules in the queue.
44600 rules inserted. The rule base contains 3643 rules. 7056 rules in the queue.
44800 rules inserted. The rule base contains 3643 rules. 7056 rules in the queue.
45000 rules inserted. The rule base contains 3643 rules. 7056 rules in the queue.
45200 rules inserted. The rule base contains 3643 rules. 7056 rules in the queue.
45400 rules inserted. The rule base contains 3643 rules. 7056 rules in the queue.
45600 rules inserted. The rule base contains 3643 rules. 7056 rules in the queue.
45800 rules inserted. The rule base contains 3643 rules. 7056 rules in the queue.
46000 rules inserted. The rule base contains 3643 rules. 7056 rules in the queue.
46200 rules inserted. The rule base contains 3643 rules. 7056 rules in the queue.
46400 rules inserted. The rule base contains 3643 rules. 7056 rules in the queue.
46600 rules inserted. The rule base contains 3643 rules. 7056 rules in the queue.
46800 rules inserted. The rule base contains 3643 rules. 7056 rules in the queue.
47000 rules inserted. The rule base contains 3643 rules. 7056 rules in the queue.
47200 rules inserted. The rule base contains 3643 rules. 7056 rules in the queue.
47400 rules inserted. The rule base contains 3643 rules. 7056 rules in the queue.
47600 rules inserted. The rule base contains 3643 rules. 7056 rules in the queue.
47800 rules inserted. The rule base contains 3643 rules. 7056 rules in the queue.
48000 rules inserted. The rule base contains 3643 rules. 7056 rules in the queue.
48200 rules inserted. The rule base contains 3643 rules. 7056 rules in the queue.
48400 rules inserted. The rule base contains 3651 rules. 7056 rules in the queue.
48600 rules inserted. The rule base contains 3655 rules. 7056 rules in the queue.
48800 rules inserted. The rule base contains 3655 rules. 7056 rules in the queue.
49000 rules inserted. The rule base contains 3655 rules. 7056 rules in the queue.
49200 rules inserted. The rule base contains 3655 rules. 7056 rules in the queue.
49400 rules inserted. The rule base contains 3655 rules. 7056 rules in the queue.
49600 rules inserted. The rule base contains 3655 rules. 7056 rules in the queue.
49800 rules inserted. The rule base contains 3655 rules. 7056 rules in the queue.
50000 rules inserted. The rule base contains 3655 rules. 7056 rules in the queue.
50200 rules inserted. The rule base contains 3655 rules. 7056 rules in the queue.
50400 rules inserted. The rule base contains 3655 rules. 7056 rules in the queue.
50600 rules inserted. The rule base contains 3655 rules. 7056 rules in the queue.
50800 rules inserted. The rule base contains 3655 rules. 7056 rules in the queue.
51000 rules inserted. The rule base contains 3655 rules. 7056 rules in the queue.
51200 rules inserted. The rule base contains 3655 rules. 7056 rules in the queue.
51400 rules inserted. The rule base contains 3655 rules. 7056 rules in the queue.
51600 rules inserted. The rule base contains 3655 rules. 7056 rules in the queue.
51800 rules inserted. The rule base contains 3655 rules. 7056 rules in the queue.
52000 rules inserted. The rule base contains 3655 rules. 7056 rules in the queue.
52200 rules inserted. The rule base contains 3655 rules. 7056 rules in the queue.
52400 rules inserted. The rule base contains 3655 rules. 7056 rules in the queue.
52600 rules inserted. The rule base contains 3655 rules. 7056 rules in the queue.
52800 rules inserted. The rule base contains 3655 rules. 7056 rules in the queue.
53000 rules inserted. The rule base contains 3655 rules. 7056 rules in the queue.
53200 rules inserted. The rule base contains 3655 rules. 7056 rules in the queue.
53400 rules inserted. The rule base contains 3655 rules. 7056 rules in the queue.
53600 rules inserted. The rule base contains 3655 rules. 7056 rules in the queue.
53800 rules inserted. The rule base contains 3655 rules. 7056 rules in the queue.
54000 rules inserted. The rule base contains 3655 rules. 7056 rules in the queue.
54200 rules inserted. The rule base contains 3655 rules. 7056 rules in the queue.
54400 rules inserted. The rule base contains 3655 rules. 7056 rules in the queue.
54600 rules inserted. The rule base contains 3655 rules. 7056 rules in the queue.
54800 rules inserted. The rule base contains 3655 rules. 7056 rules in the queue.
55000 rules inserted. The rule base contains 3655 rules. 7056 rules in the queue.
55200 rules inserted. The rule base contains 3655 rules. 7056 rules in the queue.
55400 rules inserted. The rule base contains 3679 rules. 7056 rules in the queue.
55600 rules inserted. The rule base contains 3727 rules. 7056 rules in the queue.
55800 rules inserted. The rule base contains 3727 rules. 7056 rules in the queue.
56000 rules inserted. The rule base contains 3727 rules. 7056 rules in the queue.
56200 rules inserted. The rule base contains 3727 rules. 7056 rules in the queue.
56400 rules inserted. The rule base contains 3727 rules. 7056 rules in the queue.
56600 rules inserted. The rule base contains 3727 rules. 7056 rules in the queue.
56800 rules inserted. The rule base contains 3727 rules. 7056 rules in the queue.
57000 rules inserted. The rule base contains 3727 rules. 7056 rules in the queue.
57200 rules inserted. The rule base contains 3727 rules. 7056 rules in the queue.
57400 rules inserted. The rule base contains 3727 rules. 7056 rules in the queue.
57600 rules inserted. The rule base contains 3727 rules. 7056 rules in the queue.
57800 rules inserted. The rule base contains 3727 rules. 7056 rules in the queue.
58000 rules inserted. The rule base contains 3727 rules. 7056 rules in the queue.
58200 rules inserted. The rule base contains 3727 rules. 7056 rules in the queue.
58400 rules inserted. The rule base contains 3727 rules. 7056 rules in the queue.
58600 rules inserted. The rule base contains 3727 rules. 7056 rules in the queue.
58800 rules inserted. The rule base contains 3727 rules. 7056 rules in the queue.
59000 rules inserted. The rule base contains 3727 rules. 7056 rules in the queue.
59200 rules inserted. The rule base contains 3727 rules. 7056 rules in the queue.
59400 rules inserted. The rule base contains 3727 rules. 7056 rules in the queue.
59600 rules inserted. The rule base contains 3727 rules. 7056 rules in the queue.
59800 rules inserted. The rule base contains 3727 rules. 7056 rules in the queue.
60000 rules inserted. The rule base contains 3727 rules. 7056 rules in the queue.
60200 rules inserted. The rule base contains 3727 rules. 7056 rules in the queue.
60400 rules inserted. The rule base contains 3727 rules. 7056 rules in the queue.
60600 rules inserted. The rule base contains 3727 rules. 7056 rules in the queue.
60800 rules inserted. The rule base contains 3727 rules. 7056 rules in the queue.
61000 rules inserted. The rule base contains 3727 rules. 7056 rules in the queue.
61200 rules inserted. The rule base contains 3727 rules. 7056 rules in the queue.
61400 rules inserted. The rule base contains 3727 rules. 7056 rules in the queue.
61600 rules inserted. The rule base contains 3727 rules. 7056 rules in the queue.
61800 rules inserted. The rule base contains 3727 rules. 7056 rules in the queue.
62000 rules inserted. The rule base contains 3727 rules. 7056 rules in the queue.
62200 rules inserted. The rule base contains 3727 rules. 7056 rules in the queue.
62400 rules inserted. The rule base contains 3727 rules. 7056 rules in the queue.
62600 rules inserted. The rule base contains 3847 rules. 7038 rules in the queue.
62800 rules inserted. The rule base contains 3851 rules. 7038 rules in the queue.
63000 rules inserted. The rule base contains 3851 rules. 7038 rules in the queue.
63200 rules inserted. The rule base contains 3851 rules. 7038 rules in the queue.
63400 rules inserted. The rule base contains 3851 rules. 7038 rules in the queue.
63600 rules inserted. The rule base contains 3851 rules. 7038 rules in the queue.
63800 rules inserted. The rule base contains 3851 rules. 7038 rules in the queue.
64000 rules inserted. The rule base contains 3851 rules. 7038 rules in the queue.
64200 rules inserted. The rule base contains 3851 rules. 7038 rules in the queue.
64400 rules inserted. The rule base contains 3853 rules. 7038 rules in the queue.
64600 rules inserted. The rule base contains 3855 rules. 7038 rules in the queue.
64800 rules inserted. The rule base contains 3855 rules. 7038 rules in the queue.
65000 rules inserted. The rule base contains 3855 rules. 7038 rules in the queue.
65200 rules inserted. The rule base contains 3855 rules. 7038 rules in the queue.
65400 rules inserted. The rule base contains 3855 rules. 7038 rules in the queue.
65600 rules inserted. The rule base contains 3855 rules. 7038 rules in the queue.
65800 rules inserted. The rule base contains 3859 rules. 7038 rules in the queue.
66000 rules inserted. The rule base contains 3859 rules. 7038 rules in the queue.
66200 rules inserted. The rule base contains 3859 rules. 7038 rules in the queue.
66400 rules inserted. The rule base contains 3859 rules. 7038 rules in the queue.
66600 rules inserted. The rule base contains 3859 rules. 7038 rules in the queue.
66800 rules inserted. The rule base contains 3862 rules. 7038 rules in the queue.
67000 rules inserted. The rule base contains 3863 rules. 7038 rules in the queue.
67200 rules inserted. The rule base contains 3863 rules. 7038 rules in the queue.
67400 rules inserted. The rule base contains 3863 rules. 7038 rules in the queue.
67600 rules inserted. The rule base contains 3863 rules. 7038 rules in the queue.
67800 rules inserted. The rule base contains 3863 rules. 7038 rules in the queue.
68000 rules inserted. The rule base contains 3863 rules. 7038 rules in the queue.
68200 rules inserted. The rule base contains 3863 rules. 7038 rules in the queue.
68400 rules inserted. The rule base contains 3863 rules. 7038 rules in the queue.
68600 rules inserted. The rule base contains 3865 rules. 7038 rules in the queue.
68800 rules inserted. The rule base contains 3867 rules. 7038 rules in the queue.
69000 rules inserted. The rule base contains 3867 rules. 7038 rules in the queue.
69200 rules inserted. The rule base contains 3871 rules. 7038 rules in the queue.
69400 rules inserted. The rule base contains 3871 rules. 7038 rules in the queue.
69600 rules inserted. The rule base contains 3903 rules. 6925 rules in the queue.
69800 rules inserted. The rule base contains 3929 rules. 6911 rules in the queue.
70000 rules inserted. The rule base contains 3935 rules. 6905 rules in the queue.
70200 rules inserted. The rule base contains 3939 rules. 6901 rules in the queue.
70400 rules inserted. The rule base contains 3945 rules. 6895 rules in the queue.
70600 rules inserted. The rule base contains 3947 rules. 6893 rules in the queue.
70800 rules inserted. The rule base contains 3948 rules. 6892 rules in the queue.
71000 rules inserted. The rule base contains 3951 rules. 6889 rules in the queue.
71200 rules inserted. The rule base contains 3955 rules. 6885 rules in the queue.
71400 rules inserted. The rule base contains 3980 rules. 6867 rules in the queue.
71600 rules inserted. The rule base contains 3991 rules. 6861 rules in the queue.
71800 rules inserted. The rule base contains 3995 rules. 6857 rules in the queue.
72000 rules inserted. The rule base contains 4003 rules. 6849 rules in the queue.
72200 rules inserted. The rule base contains 4007 rules. 6845 rules in the queue.
72400 rules inserted. The rule base contains 4007 rules. 6845 rules in the queue.
72600 rules inserted. The rule base contains 4017 rules. 6835 rules in the queue.
72800 rules inserted. The rule base contains 4047 rules. 6817 rules in the queue.
73000 rules inserted. The rule base contains 4051 rules. 6813 rules in the queue.
73200 rules inserted. The rule base contains 4053 rules. 6811 rules in the queue.
73400 rules inserted. The rule base contains 4059 rules. 6805 rules in the queue.
73600 rules inserted. The rule base contains 4059 rules. 6805 rules in the queue.
73800 rules inserted. The rule base contains 4089 rules. 6787 rules in the queue.
74000 rules inserted. The rule base contains 4099 rules. 6777 rules in the queue.
74200 rules inserted. The rule base contains 4107 rules. 6769 rules in the queue.
74400 rules inserted. The rule base contains 4107 rules. 6769 rules in the queue.
74600 rules inserted. The rule base contains 4111 rules. 6765 rules in the queue.
74800 rules inserted. The rule base contains 4111 rules. 6765 rules in the queue.
75000 rules inserted. The rule base contains 4115 rules. 6761 rules in the queue.
75200 rules inserted. The rule base contains 4119 rules. 6757 rules in the queue.
75400 rules inserted. The rule base contains 4123 rules. 6753 rules in the queue.
75600 rules inserted. The rule base contains 4145 rules. 6743 rules in the queue.
75800 rules inserted. The rule base contains 4163 rules. 6725 rules in the queue.
76000 rules inserted. The rule base contains 4167 rules. 6721 rules in the queue.
76200 rules inserted. The rule base contains 4193 rules. 6707 rules in the queue.
76400 rules inserted. The rule base contains 4207 rules. 6693 rules in the queue.
76600 rules inserted. The rule base contains 4178 rules. 6504 rules in the queue.
76800 rules inserted. The rule base contains 4196 rules. 6460 rules in the queue.
77000 rules inserted. The rule base contains 4214 rules. 6410 rules in the queue.
77200 rules inserted. The rule base contains 4226 rules. 6372 rules in the queue.
77400 rules inserted. The rule base contains 4238 rules. 6346 rules in the queue.
77600 rules inserted. The rule base contains 4238 rules. 6334 rules in the queue.
77800 rules inserted. The rule base contains 4250 rules. 6308 rules in the queue.
78000 rules inserted. The rule base contains 4262 rules. 6274 rules in the queue.
78200 rules inserted. The rule base contains 4302 rules. 6214 rules in the queue.
78400 rules inserted. The rule base contains 4326 rules. 6160 rules in the queue.
78600 rules inserted. The rule base contains 4341 rules. 6119 rules in the queue.
78800 rules inserted. The rule base contains 4362 rules. 6066 rules in the queue.
79000 rules inserted. The rule base contains 4374 rules. 6034 rules in the queue.
79200 rules inserted. The rule base contains 4374 rules. 6030 rules in the queue.
79400 rules inserted. The rule base contains 4410 rules. 5964 rules in the queue.
79600 rules inserted. The rule base contains 4450 rules. 5892 rules in the queue.
79800 rules inserted. The rule base contains 4462 rules. 5860 rules in the queue.
80000 rules inserted. The rule base contains 4474 rules. 5830 rules in the queue.
80200 rules inserted. The rule base contains 4486 rules. 5794 rules in the queue.
80400 rules inserted. The rule base contains 4498 rules. 5764 rules in the queue.
80600 rules inserted. The rule base contains 4550 rules. 5680 rules in the queue.
80800 rules inserted. The rule base contains 4574 rules. 5626 rules in the queue.
81000 rules inserted. The rule base contains 4586 rules. 5586 rules in the queue.
81200 rules inserted. The rule base contains 4598 rules. 5560 rules in the queue.
81400 rules inserted. The rule base contains 4598 rules. 5550 rules in the queue.
81600 rules inserted. The rule base contains 4610 rules. 5524 rules in the queue.
81800 rules inserted. The rule base contains 4622 rules. 5484 rules in the queue.
82000 rules inserted. The rule base contains 4634 rules. 5460 rules in the queue.
82200 rules inserted. The rule base contains 4646 rules. 5420 rules in the queue.
82400 rules inserted. The rule base contains 4710 rules. 5322 rules in the queue.
82600 rules inserted. The rule base contains 4722 rules. 5282 rules in the queue.
82800 rules inserted. The rule base contains 4750 rules. 5226 rules in the queue.
83000 rules inserted. The rule base contains 4798 rules. 5144 rules in the queue.
83200 rules inserted. The rule base contains 4804 rules. 5014 rules in the queue.
83400 rules inserted. The rule base contains 4804 rules. 4880 rules in the queue.
83600 rules inserted. The rule base contains 4804 rules. 4750 rules in the queue.
83800 rules inserted. The rule base contains 4804 rules. 4705 rules in the queue.
84000 rules inserted. The rule base contains 4804 rules. 4606 rules in the queue.
84200 rules inserted. The rule base contains 4804 rules. 4538 rules in the queue.
84400 rules inserted. The rule base contains 4804 rules. 4456 rules in the queue.
84600 rules inserted. The rule base contains 4804 rules. 4324 rules in the queue.
84800 rules inserted. The rule base contains 4804 rules. 4184 rules in the queue.
85000 rules inserted. The rule base contains 4804 rules. 4074 rules in the queue.
85200 rules inserted. The rule base contains 4804 rules. 4021 rules in the queue.
85400 rules inserted. The rule base contains 4804 rules. 3897 rules in the queue.
85600 rules inserted. The rule base contains 4804 rules. 3766 rules in the queue.
85800 rules inserted. The rule base contains 4804 rules. 3693 rules in the queue.
86000 rules inserted. The rule base contains 4804 rules. 3586 rules in the queue.
86200 rules inserted. The rule base contains 4804 rules. 3490 rules in the queue.
86400 rules inserted. The rule base contains 4804 rules. 3348 rules in the queue.
86600 rules inserted. The rule base contains 4804 rules. 3220 rules in the queue.
86800 rules inserted. The rule base contains 4804 rules. 3144 rules in the queue.
87000 rules inserted. The rule base contains 4804 rules. 3083 rules in the queue.
87200 rules inserted. The rule base contains 4804 rules. 2998 rules in the queue.
87400 rules inserted. The rule base contains 4804 rules. 2902 rules in the queue.
87600 rules inserted. The rule base contains 4804 rules. 2786 rules in the queue.
87800 rules inserted. The rule base contains 4804 rules. 2653 rules in the queue.
88000 rules inserted. The rule base contains 4804 rules. 2514 rules in the queue.
88200 rules inserted. The rule base contains 4804 rules. 2370 rules in the queue.
88400 rules inserted. The rule base contains 4804 rules. 2204 rules in the queue.
88600 rules inserted. The rule base contains 4804 rules. 2062 rules in the queue.
88800 rules inserted. The rule base contains 4804 rules. 1922 rules in the queue.
89000 rules inserted. The rule base contains 4804 rules. 1754 rules in the queue.
89200 rules inserted. The rule base contains 4804 rules. 1612 rules in the queue.
89400 rules inserted. The rule base contains 4804 rules. 1450 rules in the queue.
89600 rules inserted. The rule base contains 4804 rules. 1304 rules in the queue.
89800 rules inserted. The rule base contains 4804 rules. 1138 rules in the queue.
90000 rules inserted. The rule base contains 4804 rules. 988 rules in the queue.
90200 rules inserted. The rule base contains 4804 rules. 854 rules in the queue.
90400 rules inserted. The rule base contains 4804 rules. 700 rules in the queue.
90600 rules inserted. The rule base contains 4804 rules. 520 rules in the queue.
90800 rules inserted. The rule base contains 4804 rules. 338 rules in the queue.
91000 rules inserted. The rule base contains 4804 rules. 156 rules in the queue.
Starting query not attacker(mCli(pub(skA[]),pub(skC[])))
goal reachable: attacker(mCli(pub(skA[]),pub(skC[])))
Abbreviations:
Nc_2141266 = Nc_798[UP_797 = UP_2141261,SP_796 = SP_2141260,Sess = C[],Disco = Disco_2141262,Cli = A[],!1 = @sid_2141263]
Ns_2141267 = Ns_6612[sigM1_6609 = sign(h((OpenSecureChannelRequest,pub(sk(Cli_2141238)),Nc_2141239)),sk(Cli_2141238)),em1_6608 = (OpenSecureChannelRequest,pub(sk(Cli_2141238)),Nc_2141239),Sess_5311 = C[],Disco_5310 = C[],Cli_5309 = Cli_2141238,!1 = @sid_2141240]
ST_2141268 = ST_6613[sigM1_6609 = sign(h((OpenSecureChannelRequest,pub(sk(Cli_2141238)),Nc_2141239)),sk(Cli_2141238)),em1_6608 = (OpenSecureChannelRequest,pub(sk(Cli_2141238)),Nc_2141239),Sess_5311 = C[],Disco_5310 = C[],Cli_5309 = Cli_2141238,!1 = @sid_2141240]
TTL_2141269 = TTL_6614[sigM1_6609 = sign(h((OpenSecureChannelRequest,pub(sk(Cli_2141238)),Nc_2141239)),sk(Cli_2141238)),em1_6608 = (OpenSecureChannelRequest,pub(sk(Cli_2141238)),Nc_2141239),Sess_5311 = C[],Disco_5310 = C[],Cli_5309 = Cli_2141238,!1 = @sid_2141240]

1. The attacker initially knows C[].
attacker(C[]).

2. The attacker has some term Cli_2141238.
attacker(Cli_2141238).

3. By 2, the attacker may know Cli_2141238.
By 1, the attacker may know C[].
By 1, the attacker may know C[].
Using the function 3-tuple the attacker may obtain (Cli_2141238,C[],C[]).
attacker((Cli_2141238,C[],C[])).

4. By 2, the attacker may know Cli_2141238.
Using the function sk the attacker may obtain sk(Cli_2141238).
attacker(sk(Cli_2141238)).

5. The attacker has some term Nc_2141239.
attacker(Nc_2141239).

6. By 4, the attacker may know sk(Cli_2141238).
Using the function pub the attacker may obtain pub(sk(Cli_2141238)).
attacker(pub(sk(Cli_2141238))).

7. Using the function OpenSecureChannelRequest the attacker may obtain OpenSecureChannelRequest.
attacker(OpenSecureChannelRequest).

8. By 7, the attacker may know OpenSecureChannelRequest.
By 6, the attacker may know pub(sk(Cli_2141238)).
By 5, the attacker may know Nc_2141239.
Using the function 3-tuple the attacker may obtain (OpenSecureChannelRequest,pub(sk(Cli_2141238)),Nc_2141239).
attacker((OpenSecureChannelRequest,pub(sk(Cli_2141238)),Nc_2141239)).

9. By 8, the attacker may know (OpenSecureChannelRequest,pub(sk(Cli_2141238)),Nc_2141239).
Using the function h the attacker may obtain h((OpenSecureChannelRequest,pub(sk(Cli_2141238)),Nc_2141239)).
attacker(h((OpenSecureChannelRequest,pub(sk(Cli_2141238)),Nc_2141239))).

10. By 9, the attacker may know h((OpenSecureChannelRequest,pub(sk(Cli_2141238)),Nc_2141239)).
By 4, the attacker may know sk(Cli_2141238).
Using the function sign the attacker may obtain sign(h((OpenSecureChannelRequest,pub(sk(Cli_2141238)),Nc_2141239)),sk(Cli_2141238)).
attacker(sign(h((OpenSecureChannelRequest,pub(sk(Cli_2141238)),Nc_2141239)),sk(Cli_2141238))).

11. By 6, the attacker may know pub(sk(Cli_2141238)).
By 8, the attacker may know (OpenSecureChannelRequest,pub(sk(Cli_2141238)),Nc_2141239).
By 10, the attacker may know sign(h((OpenSecureChannelRequest,pub(sk(Cli_2141238)),Nc_2141239)),sk(Cli_2141238)).
Using the function 3-tuple the attacker may obtain (pub(sk(Cli_2141238)),(OpenSecureChannelRequest,pub(sk(Cli_2141238)),Nc_2141239),sign(h((OpenSecureChannelRequest,pub(sk(Cli_2141238)),Nc_2141239)),sk(Cli_2141238))).
attacker((pub(sk(Cli_2141238)),(OpenSecureChannelRequest,pub(sk(Cli_2141238)),Nc_2141239),sign(h((OpenSecureChannelRequest,pub(sk(Cli_2141238)),Nc_2141239)),sk(Cli_2141238)))).

12. The message (Cli_2141238,C[],C[]) that the attacker may have by 3 may be received at input {5704}.
The message (pub(sk(Cli_2141238)),(OpenSecureChannelRequest,pub(sk(Cli_2141238)),Nc_2141239),sign(h((OpenSecureChannelRequest,pub(sk(Cli_2141238)),Nc_2141239)),sk(Cli_2141238))) that the attacker may have by 11 may be received at input {7313}.
We have Cli_2141238 <> C[] & Cli_2141238 <> B[] & Cli_2141238 <> A[].
So the message ((OpenSecureChannelResponse,Ns_2141267,ST_2141268,TTL_2141269),sign(h((OpenSecureChannelResponse,Ns_2141267,ST_2141268,TTL_2141269)),skC[])) may be sent to the attacker at output {7321}.
attacker(((OpenSecureChannelResponse,Ns_2141267,ST_2141268,TTL_2141269),sign(h((OpenSecureChannelResponse,Ns_2141267,ST_2141268,TTL_2141269)),skC[]))).

13. By 12, the attacker may know ((OpenSecureChannelResponse,Ns_2141267,ST_2141268,TTL_2141269),sign(h((OpenSecureChannelResponse,Ns_2141267,ST_2141268,TTL_2141269)),skC[])).
Using the function 1-proj-2-tuple the attacker may obtain (OpenSecureChannelResponse,Ns_2141267,ST_2141268,TTL_2141269).
attacker((OpenSecureChannelResponse,Ns_2141267,ST_2141268,TTL_2141269)).

14. By 13, the attacker may know (OpenSecureChannelResponse,Ns_2141267,ST_2141268,TTL_2141269).
Using the function 2-proj-4-tuple the attacker may obtain Ns_2141267.
attacker(Ns_2141267).

15. The attacker has some term Disco_2141262.
attacker(Disco_2141262).

16. The attacker initially knows A[].
attacker(A[]).

17. By 16, the attacker may know A[].
By 15, the attacker may know Disco_2141262.
By 1, the attacker may know C[].
Using the function 3-tuple the attacker may obtain (A[],Disco_2141262,C[]).
attacker((A[],Disco_2141262,C[])).

18. The attacker has some term UP_2141261.
attacker(UP_2141261).

19. The attacker has some term SP_2141260.
attacker(SP_2141260).

20. Using the function Sign the attacker may obtain Sign.
attacker(Sign).

21. The message pub(skC[]) may be sent to the attacker at output {6}.
attacker(pub(skC[])).

22. Using the function GetEndpointResponse the attacker may obtain GetEndpointResponse.
attacker(GetEndpointResponse).

23. By 22, the attacker may know GetEndpointResponse.
By 21, the attacker may know pub(skC[]).
By 20, the attacker may know Sign.
By 19, the attacker may know SP_2141260.
By 18, the attacker may know UP_2141261.
Using the function 5-tuple the attacker may obtain (GetEndpointResponse,pub(skC[]),Sign,SP_2141260,UP_2141261).
attacker((GetEndpointResponse,pub(skC[]),Sign,SP_2141260,UP_2141261)).

24. The message (A[],Disco_2141262,C[]) that the attacker may have by 17 may be received at input {8}.
The message (GetEndpointResponse,pub(skC[]),Sign,SP_2141260,UP_2141261) that the attacker may have by 23 may be received at input {325}.
We have Disco_2141262 <> C[] & Disco_2141262 <> B[] & Disco_2141262 <> A[].
So the message (pub(skA[]),(OpenSecureChannelRequest,pub(skA[]),Nc_2141266),sign(h((OpenSecureChannelRequest,pub(skA[]),Nc_2141266)),skA[])) may be sent to the attacker at output {328}.
attacker((pub(skA[]),(OpenSecureChannelRequest,pub(skA[]),Nc_2141266),sign(h((OpenSecureChannelRequest,pub(skA[]),Nc_2141266)),skA[]))).

25. By 24, the attacker may know (pub(skA[]),(OpenSecureChannelRequest,pub(skA[]),Nc_2141266),sign(h((OpenSecureChannelRequest,pub(skA[]),Nc_2141266)),skA[])).
Using the function 2-proj-3-tuple the attacker may obtain (OpenSecureChannelRequest,pub(skA[]),Nc_2141266).
attacker((OpenSecureChannelRequest,pub(skA[]),Nc_2141266)).

26. By 25, the attacker may know (OpenSecureChannelRequest,pub(skA[]),Nc_2141266).
Using the function 3-proj-3-tuple the attacker may obtain Nc_2141266.
attacker(Nc_2141266).

27. By 26, the attacker may know Nc_2141266.
By 14, the attacker may know Ns_2141267.
Using the function 2-tuple the attacker may obtain (Nc_2141266,Ns_2141267).
attacker((Nc_2141266,Ns_2141267)).

28. By 27, the attacker may know (Nc_2141266,Ns_2141267).
Using the function h the attacker may obtain h((Nc_2141266,Ns_2141267)).
attacker(h((Nc_2141266,Ns_2141267))).

29. The message (A[],Disco_2141262,C[]) that the attacker may have by 17 may be received at input {8}.
The message (GetEndpointResponse,pub(skC[]),Sign,SP_2141260,UP_2141261) that the attacker may have by 23 may be received at input {325}.
The message ((OpenSecureChannelResponse,Ns_2141267,ST_2141268,TTL_2141269),sign(h((OpenSecureChannelResponse,Ns_2141267,ST_2141268,TTL_2141269)),skC[])) that the attacker may have by 12 may be received at input {329}.
We have Disco_2141262 <> C[] & Disco_2141262 <> B[] & Disco_2141262 <> A[].
So the message senc(mCli(pub(skA[]),pub(skC[])),h((Nc_2141266,Ns_2141267))) may be sent to the attacker at output {334}.
attacker(senc(mCli(pub(skA[]),pub(skC[])),h((Nc_2141266,Ns_2141267)))).

30. By 29, the attacker may know senc(mCli(pub(skA[]),pub(skC[])),h((Nc_2141266,Ns_2141267))).
By 28, the attacker may know h((Nc_2141266,Ns_2141267)).
Using the function sdec the attacker may obtain mCli(pub(skA[]),pub(skC[])).
attacker(mCli(pub(skA[]),pub(skC[]))).


A more detailed output of the traces is available with
  set traceDisplay = long.

out(c, pub(skA)) at {2}

out(c, pub(skB)) at {4}

out(c, pub(skC)) at {6}

in(c, (A,a_2141272,C)) at {8} in copy a_2141273

out(c, GetEndpointRequest) at {324} in copy a_2141273

in(c, (GetEndpointResponse,pub(skC),Sign,a_2141271,a_2141270)) at {325} in copy a_2141273

new Nc_798 creating Nc_2141277 at {326} in copy a_2141273

out(c, (pub(skA),(OpenSecureChannelRequest,pub(skA),Nc_2141277),sign(h((OpenSecureChannelRequest,pub(skA),Nc_2141277)),skA))) at {328} in copy a_2141273

in(c, (a_2141274,C,C)) at {5704} in copy a_2141276

in(c, (pub(sk(a_2141274)),(OpenSecureChannelRequest,pub(sk(a_2141274)),a_2141275),sign(h((OpenSecureChannelRequest,pub(sk(a_2141274)),a_2141275)),sk(a_2141274)))) at {7313} in copy a_2141276

new Ns_6612 creating Ns_2141278 at {7317} in copy a_2141276

new ST_6613 creating ST_2141279 at {7318} in copy a_2141276

new TTL_6614 creating TTL_2141280 at {7319} in copy a_2141276

out(c, ((OpenSecureChannelResponse,Ns_2141278,ST_2141279,TTL_2141280),sign(h((OpenSecureChannelResponse,Ns_2141278,ST_2141279,TTL_2141280)),skC))) at {7321} in copy a_2141276

out(c, senc(mSrv(pub(sk(a_2141274)),pub(skC)),h((Ns_2141278,a_2141275)))) at {7323} in copy a_2141276

in(c, ((OpenSecureChannelResponse,Ns_2141278,ST_2141279,TTL_2141280),sign(h((OpenSecureChannelResponse,Ns_2141278,ST_2141279,TTL_2141280)),skC))) at {329} in copy a_2141273

out(c, senc(mCli(pub(skA),pub(skC)),h((Nc_2141277,Ns_2141278)))) at {334} in copy a_2141273

The attacker has the message mCli(pub(skA),pub(skC)).
A trace has been found.
RESULT not attacker(mCli(pub(skA[]),pub(skC[]))) is false.
